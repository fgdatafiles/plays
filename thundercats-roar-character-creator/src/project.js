window.__require=function t(e,o,i){function a(r,s){if(!o[r]){if(!e[r]){var c=r.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+r+"'")}}var h=o[r]={exports:{}};e[r][0].call(h.exports,function(t){return a(e[r][1][t]||t)},h,h.exports,t,e,o,i)}return o[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<i.length;r++)a(i[r]);return a}({AudioButton:[function(t,e,o){"use strict";cc._RF.push(e,"df945jlVMZKH54zfvtXafpl","AudioButton"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Audio/AudioScene"),a=t("../Singleton"),n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frameOn=null,e.frameOff=null,e}return __extends(e,t),e.prototype.onLoad=function(){this.instance=a.default.GetInstance(),this.button=this.node.getComponent(cc.Sprite)},e.prototype.start=function(){this.checkState()},e.prototype.checkState=function(){var t=this.instance.audioManager.enableAudio;this.button.spriteFrame=t?this.frameOn:this.frameOff},e.prototype.switchState=function(){this.instance.switchAudioState(),this.instance.audioManager.playSfx(i.SFXKey.button_menu),this.checkState()},__decorate([s(cc.SpriteFrame)],e.prototype,"frameOn",void 0),__decorate([s(cc.SpriteFrame)],e.prototype,"frameOff",void 0),e=__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../Audio/AudioScene":"AudioScene","../Singleton":"Singleton"}],AudioManager:[function(t,e,o){"use strict";cc._RF.push(e,"01118l5Xb9PppppJJX96tol","AudioManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./AudioScene"),a=function(t){function e(){var e=t.call(this)||this;return e.lockSfxPlayback=!1,e.currentMusic=null,e.singleSFXPlayingList={},e.musicId=null,e._musicVolume=1,e.music=[],e.audioSprite=null,e.enableAudio=!0,e.isChain=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"musicVolume",{get:function(){return this._musicVolume},set:function(t){this._musicVolume=t,this.currentMusic&&this.currentMusic.volume(t,this.musicId)},enumerable:!0,configurable:!0}),e.prototype.loadMusic=function(t,e){this.music[t]=new Howl({src:e,onload:this.onEndLoad.bind(this)})},e.prototype.loadAudioSprite=function(t,e){this.audioSprite=new Howl({src:t,onload:this.onEndLoad.bind(this),sprite:e})},e.prototype.onEndLoad=function(){this.emit("loaded")},e.prototype.enableAll=function(){this.enableAudio=!0,this.currentMusic&&(this.isChain?(this.currentMusic=null,this.playMusicChain(this.currentChain[0],this.currentChain[1])):this.currentMusic.play())},e.prototype.disableAll=function(){this.enableAudio=!1,this.currentMusic&&this.currentMusic.stop(),this.audioSprite&&this.audioSprite.stop()},e.prototype.pause=function(){this.currentMusic&&this.currentMusic.pause(),this.audioSprite&&this.audioSprite.pause()},e.prototype.resume=function(){!Howler.ctx||"suspended"!==Howler.ctx.state&&"interrupted"!==Howler.ctx.state||Howler.ctx.resume(),this.currentMusic&&this.unpause(this.currentMusic),this.audioSprite&&this.unpause(this.audioSprite)},e.prototype.playMusic=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=!0),this.isChain=!1,this._playMusic(t,e,o)},e.prototype.playMusicChain=function(t,e){this.isChain=!0,this.currentChain=[t,e];var o=this.music[t],i=this.music[e];o&&i&&o!==this.currentMusic&&i!==this.currentMusic&&(this._playMusic(t,0,!1),this.currentMusic.on("end",this._playMusic.bind(this,e,0,!0)))},e.prototype._playMusic=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=!0);var i=this.music[t];if(i&&i!==this.currentMusic&&(this.currentMusic&&this.currentMusic.stop(),this.currentMusic=i,this.enableAudio)){var a=this.currentMusic.play();this.musicId=a,this.currentMusic.loop(!!o,a),e>0&&this.currentMusic.fade(0,this.musicVolume,e,a)}},e.prototype.stopMusic=function(){this.currentMusic&&this.currentMusic.stop(),this.currentMusic=null},e.prototype.playSfx=function(t){if(this.audioSprite&&!this.lockSfxPlayback&&this.enableAudio){var e=this.audioSprite.play(i.SFXKey[t]);return null===e&&console.warn("El audiosprite no tiene: "+i.SFXKey[t]),e}},e.prototype.playSingleSfx=function(t){var e=this;if(this.audioSprite&&!this.singleSFXPlayingList[i.SFXKey[t]]){var o=this.playSfx(t);null!==o&&(this.singleSFXPlayingList[i.SFXKey[t]]=!0,this.audioSprite.once("end",function(){e.singleSFXPlayingList[i.SFXKey[t]]=!1},o))}},e.prototype.stopSfx=function(t){this.audioSprite&&null!==t&&this.enableAudio&&this.audioSprite.stop(t)},e.prototype.doOnceSfxFinish=function(t,e){this.audioSprite&&this.audioSprite.once("end",e,t)},e.prototype.mute=function(t){Howler.mute(t)},e.prototype.unpause=function(t){for(var e,o=0;o<t._sounds.length;o++)t._sounds[o]._paused&&!t._sounds[o]._ended&&(e=t._sounds[o]._id,t.play(e))},e}(cc.Node);o.default=a,cc._RF.pop()},{"./AudioScene":"AudioScene"}],AudioScene:[function(t,e,o){"use strict";cc._RF.push(e,"b6df5dvxUZO85Wrndib1wBN","AudioScene"),Object.defineProperty(o,"__esModule",{value:!0});var i,a=t("../Singleton"),n=cc._decorator,r=n.ccclass,s=n.property;(function(t){t[t.audiosprite=0]="audiosprite",t[t.musicGp1=1]="musicGp1",t[t.musicGp2=2]="musicGp2",t[t.musicMenu=3]="musicMenu"})(i=o.HowlsKey||(o.HowlsKey={})),function(t){t[t.button_menu=0]="button_menu",t[t.snarf_equipped=1]="snarf_equipped",t[t.final_photo=2]="final_photo",t[t.selection_item=3]="selection_item",t[t.selection_clothes=4]="selection_clothes",t[t.selection_color=5]="selection_color",t[t.button_arrow=6]="button_arrow",t[t.button_download=7]="button_download",t[t.popup_confirmation=8]="popup_confirmation"}(o.SFXKey||(o.SFXKey={}));var c=function(){function t(){this.id=i.audiosprite,this.nameFile="",this.isAudioSprite=!1,this.jsonAudioSprite=null}return __decorate([s({type:cc.Enum(i)})],t.prototype,"id",void 0),__decorate([s(cc.String)],t.prototype,"nameFile",void 0),__decorate([s(cc.Boolean)],t.prototype,"isAudioSprite",void 0),__decorate([s(cc.JsonAsset)],t.prototype,"jsonAudioSprite",void 0),t=__decorate([r("AudioResource")],t)}(),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playInPreview=!0,e.formats=["m4a","mp3","ogg"],e.audioResources=[],e.isAllLoaded=!1,e.fileLoaded=0,e}var o;return __extends(e,t),o=e,e.prototype.onLoad=function(){this.instance=a.default.GetInstance(),this.isAllLoaded=!1,this.playInPreview,this.initLoadAudio()},e.prototype.initLoadAudio=function(){this.fileLoaded=0,this.totalFiles=this.audioResources.length,this.loadHowl()},e.prototype.loadHowl=function(){var t;this.instance.audioManager.on("loaded",this.onLoadedHowl,this);for(var e=0,i=this.audioResources.length;e<i;e++){t=[];for(var a=0,n=this.formats.length;a<n;a++)t.push(o.pathAudio+this.audioResources[e].nameFile+"."+this.formats[a]);this.audioResources[e].isAudioSprite?this.instance.audioManager.loadAudioSprite(t,this.audioResources[e].jsonAudioSprite.json.sprite):this.instance.audioManager.loadMusic(this.audioResources[e].id,t)}},e.prototype.onLoadedHowl=function(){this.fileLoaded++,this.checkOnCompletedLoad()},e.prototype.checkOnCompletedLoad=function(){this.fileLoaded>=this.totalFiles&&(this.node.emit("loadAudio"),this.isAllLoaded=!0)},e.pathAudio="audios/",__decorate([s(cc.Boolean)],e.prototype,"playInPreview",void 0),__decorate([s([cc.String])],e.prototype,"formats",void 0),__decorate([s([c])],e.prototype,"audioResources",void 0),e=o=__decorate([r],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../Singleton":"Singleton"}],AvatarManager:[function(t,e,o){"use strict";cc._RF.push(e,"dfbc2mptxRJpYjUUjVUKn2O","AvatarManager"),Object.defineProperty(o,"__esModule",{value:!0});var i,a=t("../ColorList"),n=t("../EnumCategory"),r=cc._decorator,s=r.ccclass,c=r.property;o.numberElements=19,function(t){t[t["ARM FRONT"]=0]="ARM FRONT",t[t.FINGERS=1]="FINGERS",t[t.BODY=2]="BODY",t[t.HEAD=3]="HEAD",t[t._numberBodyParts=4]="_numberBodyParts"}(i||(i={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.partValue=new Array(o.numberElements+1),e.characterPrefab=[],e.characterSelected=0,e.character=[],e.preview=null,e.colorizeMaterial=null,e.defaultMaterial=null,e.lineaNegra=cc.Color.WHITE,e.colorListJSON=null,e.paletteJSON=null,e.scaleSelect=1.05,e.skinColors=null,e.allLayers=new Array(o.numberElements+1),e.colors=new Array(o.numberElements+1),e.paletteItems=[],e}return __extends(e,t),e.prototype.reset=function(){this.characterSelected=0;for(var t=0;t<this.partValue.length;t++)this.partValue[t]=0;this.changeBodyParts(),this.chargePreviewV2()},e.prototype.onLoad=function(){this.tweenScale=[],this.tweenOriginalScale=[],this.categoryNeedTween=-1,this.fillColorSkin(),this.lineaNegra.fromHEX(this.colorListJSON.json.colors[this.paletteJSON.json.lines]);for(var t=0;t<4;t++)this.character.push(cc.instantiate(this.characterPrefab[t])),this.character[t].active=!1;this.readDepths(),console.log(this.allLayers),this.fillPrevArr(),this.changeBodyParts(),this.chargePreviewV2()},e.prototype.fillColorSkin=function(){var t=this;this.skinColors=new a.default,this.skinColors.name="skins";var e=0;this.paletteJSON.json.body.split(";").forEach(function(o){t.skinColors.palettes.push(new a.Palette),t.skinColors.palettes[e].r.fromHEX(t.colorListJSON.json.colors[o.split(",")[0]]),t.skinColors.palettes[e].g.fromHEX(t.colorListJSON.json.colors[o.split(",")[1]]),e++})},e.prototype.readDepths=function(){var t=this;this.preview.children.forEach(function(e){var o=e.name.split(" ");n.Category[o[0]]&&(o[1]?t.allLayers[n.Category[o[0]]]?t.allLayers[n.Category[o[0]]].layers.push({layerName:o[1],node:e}):t.allLayers[n.Category[o[0]]]={category:o[0],layers:[{layerName:o[1],node:e}]}:t.allLayers[n.Category[o[0]]]?t.allLayers[n.Category[o[0]]].layers.push({layerName:"default",node:e}):t.allLayers[n.Category[o[0]]]={category:o[0],layers:[{layerName:"default",node:e}]})})},e.prototype.fillPrevArr=function(){for(var t=0;t<o.numberElements;t++)this.partValue[t]=0;this.partValue[o.numberElements]=0},e.prototype.getVal=function(t){return this.partValue[n.Category[t]]},e.prototype.change=function(t,e){this.categoryNeedTween=t;for(var o=0,i=this.tweenScale.length;o<i;o++)this.tweenScale[o].stop(),this.tweenScale[o]._target.scaleX=this.tweenOriginalScale[o].x,this.tweenScale[o]._target.scaleY=this.tweenOriginalScale[o].y;this.tweenScale=[],this.tweenOriginalScale=[],this.partValue[t]=e,this.chargePreviewV2(),this.changeBodyParts(),this.categoryNeedTween=-1},e.prototype.changeBodyParts=function(){for(var t=0;t<i._numberBodyParts;t++)this.preview.getChildByName(i[t]).position=this.character[this.characterSelected].getChildByName(i[t]).position,this.preview.getChildByName(i[t]).getComponent(cc.Sprite).spriteFrame=this.character[this.characterSelected].getChildByName(i[t]).getComponent(cc.Sprite).spriteFrame,this.colorize(this.preview.getChildByName(i[t]),this.skinColors.palettes[this.skinColors.index])},e.prototype.getColorList=function(t){if(this.paletteJSON.json[t]){if(this.paletteItems[t])return this.paletteItems[t];for(var e=new a.default,o=this.paletteJSON.json[t].split(";"),i=0;i<o.length;i++){var n=o[i].split(",");e.palettes.push(new a.Palette),n[0]&&e.palettes[i].r.fromHEX(this.colorListJSON.json.colors[Number(n[0])]),n[1]&&e.palettes[i].g.fromHEX(this.colorListJSON.json.colors[Number(n[1])]),n[2]&&e.palettes[i].b.fromHEX(this.colorListJSON.json.colors[Number(n[2])])}return console.log("this worked kind of fine"+e),this.paletteItems[t]=e,e}return null},e.prototype.chargePreviewV2=function(){for(var t,e=this,o=function(o){var a=i.character[i.characterSelected].getChildByName(n.Category[o]).children[i.partValue[o]];if(!a)return"continue";var r=a.name.split(" "),s=o;if(i.colors[o]=i.getColorList(r[0]),null===i.colors[o]&&(i.colors[o]=i.getColorList(n.Category[o])),a.getComponent(cc.Sprite))if(r.length>1){var c=!1,l="skin"===r[1]?"default":r[1];"default"===l&&(c=!0),r.length>2&&"skin"===r[2]&&(c=!0),i.allLayers[s].layers.forEach(function(i){i.layerName===l?(i.node.getComponent(cc.Sprite).spriteFrame=a.getComponent(cc.Sprite).spriteFrame,i.node.position=a.position.add(a.parent.position),i.node.angle=a.angle,i.node.scaleX=a.scaleX,i.node.scaleY=a.scaleY,o===e.categoryNeedTween&&(e.tweenOriginalScale.push({x:i.node.scaleX,y:i.node.scaleY}),t=cc.tween(i.node).to(.1,{scaleX:i.node.scaleX*e.scaleSelect,scaleY:i.node.scaleY*e.scaleSelect}).to(.1,{scaleX:i.node.scaleX,scaleY:i.node.scaleY}).start(),e.tweenScale.push(t)),c?e.colorize(i.node,e.skinColors.palettes[e.skinColors.index]):e.colors[o]?e.colorize(i.node,e.colors[o].palettes[e.colors[o].index]):i.node.getComponent(cc.Sprite).setMaterial(0,e.defaultMaterial)):(o===e.categoryNeedTween&&(e.tweenOriginalScale.push({x:i.node.scaleX,y:i.node.scaleY}),t=cc.tween(i.node).to(.1,{scaleX:i.node.scaleX*e.scaleSelect,scaleY:i.node.scaleY*e.scaleSelect}).to(.1,{scaleX:i.node.scaleX,scaleY:i.node.scaleY}).start(),e.tweenScale.push(t)),i.node.getComponent(cc.Sprite).spriteFrame=null)})}else i.allLayers[s].layers.forEach(function(i){"default"===i.layerName?(i.node.getComponent(cc.Sprite).spriteFrame=a.getComponent(cc.Sprite).spriteFrame,i.node.position=a.position.add(a.parent.position),i.node.angle=a.angle,i.node.scaleX=a.scaleX,i.node.scaleY=a.scaleY,o===e.categoryNeedTween&&(e.tweenOriginalScale.push({x:i.node.scaleX,y:i.node.scaleY}),t=cc.tween(i.node).to(.1,{scaleX:i.node.scaleX*e.scaleSelect,scaleY:i.node.scaleY*e.scaleSelect}).to(.1,{scaleX:i.node.scaleX,scaleY:i.node.scaleY}).start(),e.tweenScale.push(t)),e.colors[o]?e.colorize(i.node,e.colors[o].palettes[e.colors[o].index]):i.node.getComponent(cc.Sprite).setMaterial(0,e.defaultMaterial)):(o===e.categoryNeedTween&&(e.tweenOriginalScale.push({x:i.node.scaleX,y:i.node.scaleY}),t=cc.tween(i.node).to(.1,{scaleX:i.node.scaleX*e.scaleSelect,scaleY:i.node.scaleY*e.scaleSelect}).to(.1,{scaleX:i.node.scaleX,scaleY:i.node.scaleY}).start(),e.tweenScale.push(t)),i.node.getComponent(cc.Sprite).spriteFrame=null)});else{var h=[];i.allLayers[s].layers.forEach(function(i){i.node.getComponent(cc.Sprite).spriteFrame=null,a.children.forEach(function(n){var r=n.name.split(" ");i.layerName===r[0]&&(o===e.categoryNeedTween&&(e.tweenOriginalScale.push({x:i.node.scaleX,y:i.node.scaleY}),t=cc.tween(i.node).to(.1,{scaleX:i.node.scaleX*e.scaleSelect,scaleY:i.node.scaleY*e.scaleSelect}).to(.1,{scaleX:i.node.scaleX,scaleY:i.node.scaleY}).start(),e.tweenScale.push(t)),h.push(n.name),i.node.getComponent(cc.Sprite).spriteFrame=n.getComponent(cc.Sprite).spriteFrame,i.node.position=n.position.add(a.position).add(a.parent.position),i.node.angle=n.angle,i.node.scaleX=n.scaleX,i.node.scaleY=n.scaleY,r[1]?e.colorize(i.node,e.skinColors.palettes[e.skinColors.index]):e.colors[o]?e.colorize(i.node,e.colors[o].palettes[e.colors[o].index]):i.node.getComponent(cc.Sprite).setMaterial(0,e.defaultMaterial))})})}},i=this,a=1;a<this.partValue.length;a++)o(a)},e.prototype.colorize=function(t,e){t.getComponent(cc.Sprite).setMaterial(0,this.colorizeMaterial),t.getComponent(cc.Sprite).getMaterial(0).setProperty("color1",e.r),t.getComponent(cc.Sprite).getMaterial(0).setProperty("color2",e.g),t.getComponent(cc.Sprite).getMaterial(0).setProperty("color3",e.b),t.getComponent(cc.Sprite).getMaterial(0).setProperty("color0",this.lineaNegra)},e.prototype.colorizeBodyPart=function(t,e){t.getComponent(cc.Sprite).getMaterial(0).setProperty("color1",e.r),t.getComponent(cc.Sprite).getMaterial(0).setProperty("color2",e.g),t.getComponent(cc.Sprite).getMaterial(0).setProperty("color3",e.b),t.getComponent(cc.Sprite).getMaterial(0).setProperty("color0",this.lineaNegra)},__decorate([c([cc.Prefab])],e.prototype,"characterPrefab",void 0),__decorate([c(cc.Node)],e.prototype,"preview",void 0),__decorate([c(cc.Material)],e.prototype,"colorizeMaterial",void 0),__decorate([c(cc.Material)],e.prototype,"defaultMaterial",void 0),__decorate([c(cc.JsonAsset)],e.prototype,"colorListJSON",void 0),__decorate([c(cc.JsonAsset)],e.prototype,"paletteJSON",void 0),__decorate([c(cc.Float)],e.prototype,"scaleSelect",void 0),e=__decorate([s],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../ColorList":"ColorList","../EnumCategory":"EnumCategory"}],BootController:[function(t,e,o){"use strict";cc._RF.push(e,"4e5ecPD4xxHiYu7CKvEfevI","BootController"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Audio/AudioScene"),a=t("../Singleton"),n=cc._decorator,r=n.ccclass,s=n.property,c=0,l=1,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progressBar=null,e.startButton=null,e.TargetLevel="",e.LevelsToLoad=[],e.currentLoadingLevel=c,e.loaded=!1,e.maxLoadPerLevel=l,e}return __extends(e,t),e.prototype.onLoad=function(){cc.view.resizeWithBrowserSize(!0),cc.screen.fullScreen()&&cc.screen.exitFullScreen(),cc.view.enableAutoFullScreen(!1),this.audioScene=this.node.getComponent(i.default),this.node.on("loadAudio",this.checkLoadedCompleted,this),this.instance=a.default.GetInstance();this.loadLevel(this.LevelsToLoad[this.currentLoadingLevel]),this.maxLoadPerLevel=1/this.LevelsToLoad.length},e.prototype.loadLevel=function(t){var e=this;cc.director.preloadScene(t,function(t,o){e.levelLoading(t,o)},function(t,o){e.levelLoaded(t,o)})},e.prototype.levelLoaded=function(t,e){t&&(console.error("Error "+t.name+" while loading: "+e.name),this.loaded=!1);this.currentLoadingLevel===this.LevelsToLoad.length-1?(this.loaded=!0,this.checkLoadedCompleted()):(this.currentLoadingLevel++,this.loadLevel(this.LevelsToLoad[this.currentLoadingLevel]))},e.prototype.levelLoading=function(t,e){var o=t/e*this.maxLoadPerLevel+this.maxLoadPerLevel*this.currentLoadingLevel;this.progressBar&&(this.progressBar.progress=o)},e.prototype.checkLoadedCompleted=function(){var t=!this.audioScene||this.audioScene.isAllLoaded;this.loaded&&t&&(this.startButton.active=!0,this.progressBar.node.active=!1)},e.prototype.boot=function(){this.loaded&&cc.director.loadScene(this.TargetLevel)},__decorate([s(cc.ProgressBar)],e.prototype,"progressBar",void 0),__decorate([s(cc.Node)],e.prototype,"startButton",void 0),__decorate([s],e.prototype,"TargetLevel",void 0),__decorate([s([cc.String])],e.prototype,"LevelsToLoad",void 0),e=__decorate([r],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../Audio/AudioScene":"AudioScene","../Singleton":"Singleton"}],ButtonHoverScale:[function(t,e,o){"use strict";cc._RF.push(e,"9d9cdX3JW1DJZGvb7iyETof","ButtonHoverScale"),Object.defineProperty(o,"__esModule",{value:!0});var i,a=cc._decorator.ccclass;(function(t){t[t.NORMAL=0]="NORMAL",t[t.HOVER=1]="HOVER",t[t.PRESSED=2]="PRESSED",t[t.DISABLED=3]="DISABLED"})(i||(i={}));var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tweenScale=null,e}return __extends(e,t),e.prototype.start=function(){this.button=this.node.getComponent(cc.Button),this.isOver=!1},e.prototype.onHoverIn=function(){this.tweenScale&&this.tweenScale.stop(),this.tweenScale=cc.tween(this.node).to(.1,{scale:1.2}).start()},e.prototype.onHoverOut=function(){this.tweenScale&&this.tweenScale.stop(),this.tweenScale=cc.tween(this.node).to(.1,{scale:1}).start()},e.prototype.update=function(){var t=this.button._getButtonState();t!==i.HOVER||this.isOver?t!==i.HOVER&&t!==i.PRESSED&&this.isOver&&(this.isOver=!1,this.onHoverOut(),console.log("hoverOut")):(this.isOver=!0,this.onHoverIn(),console.log("hoverIn"))},e=__decorate([a],e)}(cc.Component);o.default=n,cc._RF.pop()},{}],CanvasResolutionManager:[function(t,e,o){"use strict";cc._RF.push(e,"a310dHZfLdFOKtrbJ+koEy1","CanvasResolutionManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Singleton"),a=t("./ResizeScreenManager"),n=cc._decorator.ccclass,r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){this.canvas=this.node.getComponent(cc.Canvas),i.default.GetInstance().resizeScreenManager.on(a.default.KEY_SIGNAL_RESIZE_PRIORITY,this.onResized,this),this.onResized()},e.prototype.onResized=function(){var t=cc.game.frame;t.clientWidth>t.clientHeight?(this.canvas.designResolution.height=640,this.canvas.designResolution.width=960,this.canvas.fitHeight=!0,this.canvas.fitWidth=!1,console.log("canvas landscape")):(console.log("canvas portrait"),this.canvas.designResolution.height=640,this.canvas.designResolution.width=640,this.canvas.fitHeight=!1,this.canvas.fitWidth=!0)},e.prototype.onDestroy=function(){i.default.GetInstance().resizeScreenManager.off(a.default.KEY_SIGNAL_RESIZE_PRIORITY,this.onResized,this)},e=__decorate([n],e)}(cc.Component);o.default=r,cc._RF.pop()},{"../Singleton":"Singleton","./ResizeScreenManager":"ResizeScreenManager"}],ColorList:[function(t,e,o){"use strict";cc._RF.push(e,"cf47c1t9qZBvYRRAvamyCRs","ColorList"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a=function(){function t(){this.r=cc.Color.WHITE,this.g=cc.Color.WHITE,this.b=cc.Color.WHITE}return t=__decorate([i("Palette")],t)}();o.Palette=a;var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=null,e.palettes=[],e.index=0,e}return __extends(e,t),e=__decorate([i],e)}(cc.Component);o.default=n,cc._RF.pop()},{}],EnumCategory:[function(t,e,o){"use strict";cc._RF.push(e,"0bc397U1ABNV5VnNmsejKve","EnumCategory"),Object.defineProperty(o,"__esModule",{value:!0}),o.Category=cc.Enum({bodyType:0,bottom:1,belt:2,shoulderPlate:3,complement:4,eyes:5,hats:6,glasses:7,mouth:8,nose:9,objects:10,objectsRight:11,symbol:12,shoes:13,skin:14,facialHair:15,hairTop:16,hairBottom:17,top:18,suit:19,background:20,sticker:21,gif:22}),cc._RF.pop()},{}],ExportManager:[function(t,e,o){"use strict";cc._RF.push(e,"9b354AKoMJHmJNEmbAl6u3K","ExportManager"),Object.defineProperty(o,"__esModule",{value:!0});var i,a=t("../Singleton"),n=cc._decorator,r=n.ccclass,s=n.property;(function(t){t[t.landscape=0]="landscape",t[t.square=1]="square",t[t.squareAlpha=2]="squareAlpha"})(i=o.TypeMask||(o.TypeMask={}));var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.screenHidder=null,e.camera=null,e.previewCharacter=null,e.previewSticker=null,e.previewBackground=null,e.groupLandscape=null,e.groupSquare=null,e.character=null,e.background=null,e.description=null,e.url=null,e.sticker=null,e.animation=null,e.animationClip=null,e.cullingMask=[-8,-12,-16,-30],e.filename="",e}var o;return __extends(e,t),o=e,e.prototype.start=function(){this.screenHidder.active=!1,this.textureLandscape=new cc.RenderTexture,this.textureLandscape.initWithSize(640,960,cc.gfx.RB_FMT_S8),this.textureSquare=new cc.RenderTexture,this.textureSquare.initWithSize(590,557,cc.gfx.RB_FMT_S8),this.camera.alignWithScreen=!1,this.camera.ortho=!0,this.camera.targetTexture=this.textureSquare,this.canvasGame=cc.find("Canvas")},e.prototype.exportSquareGIF=function(){this.filename=o.FILE_NAME_PHOTO_ANIMATED,this.groupSquare.active=!0,this.groupLandscape.active=!1,this.character=this.groupSquare.getChildByName("character"),this.sticker=this.groupSquare.getChildByName("sticker"),this.background=this.groupSquare.getChildByName("mask"),this.description=this.groupSquare.getChildByName("description").getComponent(cc.Label),this.url=this.groupSquare.getChildByName("web").getComponent(cc.Label),this.camera.targetTexture=this.textureSquare,this.camera.zoomRatio=this.canvasGame.height/557,this.camera.cullingMask=this.cullingMask[i.square],this.currentMask=i.square,this.exportGIF()},e.prototype.exportGIF=function(){this.initExport(),this.animation=this.background.children[0].getComponent(cc.Animation),this.animationClip=this.animation.getClips()[0],this.gif=new GIF({workerScript:"gif/gif.worker.js",workers:2,quality:1}),this.frames=0,this.totalFrames=this.animationClip.duration*this.animationClip.sample,this.timeFrame=1/this.animationClip.sample,this.captureNextFrame()},e.prototype.captureNextFrame=function(){this.animation.resume(),this.animation.play(this.animationClip.name,this.frames*this.timeFrame),setTimeout(this.captureImage.bind(this),100),this.frames++,this.frames<this.totalFrames&&setTimeout(this.captureNextFrame.bind(this),150)},e.prototype.captureImage=function(){if(this.isSticker=!1,this.animation.pause(),this.createCanvas(),this.gif.addFrame(this.canvas,{delay:1e3/this.animationClip.sample}),this.frames===this.totalFrames){this.animation.stop();var t=this;this.gif.on("finished",function(e){var o=document.createElement("a");o.href=URL.createObjectURL(e),o.setAttribute("target","_blank"),o.download=t.filename,document.body.appendChild(o),o.click(),document.body.removeChild(o)}),this.scheduleOnce(function(){this.screenHidder.active=!1,this.screenHidder.getComponent(cc.Animation).stop()},2),this.gif.render()}},e.prototype.initExport=function(){this.screenHidder.active=!0,this.screenHidder.getComponent(cc.Animation).play("loading Gif"),this.updateMessage(),this.clearSticker(),this.clearCharacter(),this.clearBackground(),this.updateCharacter(),this.updateBackground(),this.updateSticker()},e.prototype.updateMessage=function(){var t=window.message;this.description.string=""===t?"":a.default.GetInstance().localizationManager.getString(t),this.url.string=window.url},e.prototype.exportSquare=function(){this.filename=o.FILE_NAME_PHOTO,this.groupSquare.active=!0,this.groupLandscape.active=!1,this.character=this.groupSquare.getChildByName("character"),this.sticker=this.groupSquare.getChildByName("sticker"),this.background=this.groupSquare.getChildByName("mask"),this.description=this.groupSquare.getChildByName("description").getComponent(cc.Label),this.url=this.groupSquare.getChildByName("web").getComponent(cc.Label),this.camera.targetTexture=this.textureSquare,this.camera.zoomRatio=this.canvasGame.height/557,this.camera.cullingMask=this.cullingMask[i.square],this.currentMask=i.square,this.isSticker=!1,this.exportPNG()},e.prototype.exportSquareAlpha=function(){this.filename=o.FILE_NAME_STICKER,this.groupSquare.active=!0,this.groupLandscape.active=!1,this.character=this.groupSquare.getChildByName("character"),this.sticker=this.groupSquare.getChildByName("sticker"),this.background=this.groupSquare.getChildByName("mask"),this.description=this.groupSquare.getChildByName("description").getComponent(cc.Label),this.url=this.groupSquare.getChildByName("web").getComponent(cc.Label),this.camera.targetTexture=this.textureSquare,this.camera.zoomRatio=this.canvasGame.height/557,this.camera.cullingMask=this.cullingMask[i.squareAlpha],this.currentMask=i.squareAlpha,this.isSticker=!0,this.exportPNG()},e.prototype.exportLandscape=function(){this.filename=o.FILE_NAME_STORY,this.groupSquare.active=!1,this.groupLandscape.active=!0,this.character=this.groupLandscape.getChildByName("character"),this.sticker=this.groupLandscape.getChildByName("sticker"),this.background=this.groupLandscape.getChildByName("mask"),this.description=this.groupLandscape.getChildByName("description").getComponent(cc.Label),this.url=this.groupSquare.getChildByName("web").getComponent(cc.Label),this.camera.targetTexture=this.textureLandscape,this.camera.zoomRatio=this.canvasGame.height/960,this.camera.cullingMask=this.cullingMask[i.landscape],this.currentMask=i.landscape,this.isSticker=!1,this.exportPNG()},e.prototype.exportPNG=function(){this.initExport(),this.createCanvas();var t=document.createElement("a");t.href=this.canvas.toDataURL(),t.setAttribute("target","_blank"),t.download=this.filename,document.body.appendChild(t),t.click(),document.body.removeChild(t),this.scheduleOnce(function(){this.screenHidder.active=!1,this.screenHidder.getComponent(cc.Animation).stop()},2)},e.prototype.createCanvas=function(){var t=this.camera.targetTexture.width,e=this.camera.targetTexture.height;this.canvas=document.createElement("canvas"),this.canvas.width=t,this.canvas.height=e;var o=this.canvas.getContext("2d");this.camera.render();for(var i=this.camera.targetTexture.readPixels(),a=4*t,n=0;n<e;n++){for(var r=e-1-n,s=o.createImageData(t,1),c=r*t*4,l=0;l<a;l++)0!==i[c+l]&&(0!==l&&l%4==3&&(this.isSticker?n>88&&n<411&&l-4>0&&l+4<a&&i[c+l-4]>100&&i[c+l+4]>100&&(i[c+l]=255):i[c+l]=255),s.data[l]=i[c+l]);o.putImageData(s,0,n)}return this.canvas},e.prototype.updateCharacter=function(){for(var t,e=0,o=this.previewCharacter.children.length;e<o;e++)(t=cc.instantiate(this.previewCharacter.children[e])).group=this.character.group,this.character.addChild(t)},e.prototype.clearCharacter=function(){this.character.destroyAllChildren(),this.character.removeAllChildren()},e.prototype.setPrefabBackground=function(t){this.prefabBackGround=t},e.prototype.updateBackground=function(){var t;(t=cc.instantiate(this.prefabBackGround)).group=this.background.group,this.background.addChild(t),this.background.children[0].getComponent(cc.Animation).stop(),this.background.children[0].scale=.9},e.prototype.clearBackground=function(){this.background.destroyAllChildren(),this.background.removeAllChildren()},e.prototype.updateSticker=function(){for(var t,e=0,o=this.previewSticker.children.length;e<o;e++)this.previewSticker.children[e].active&&((t=cc.instantiate(this.previewSticker.children[e])).group=this.sticker.group,this.sticker.addChild(t))},e.prototype.clearSticker=function(){this.sticker.destroyAllChildren(),this.sticker.removeAllChildren()},e.FILE_NAME_PHOTO=window.FILE_NAME_PHOTO,e.FILE_NAME_PHOTO_ANIMATED=window.FILE_NAME_PHOTO_ANIMATED,e.FILE_NAME_STORY=window.FILE_NAME_STORY,e.FILE_NAME_STICKER=window.FILE_NAME_STICKER,__decorate([s(cc.Node)],e.prototype,"screenHidder",void 0),__decorate([s(cc.Camera)],e.prototype,"camera",void 0),__decorate([s(cc.Node)],e.prototype,"previewCharacter",void 0),__decorate([s(cc.Node)],e.prototype,"previewSticker",void 0),__decorate([s(cc.Node)],e.prototype,"previewBackground",void 0),__decorate([s(cc.Node)],e.prototype,"groupLandscape",void 0),__decorate([s(cc.Node)],e.prototype,"groupSquare",void 0),e=o=__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../Singleton":"Singleton"}],ExposedLocalizationImage:[function(t,e,o){"use strict";cc._RF.push(e,"bbf048hBt1Jna8+pmmljmTG","ExposedLocalizationImage"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./LocalizationImage"),a=cc._decorator.ccclass,n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"spriteComponent",{get:function(){return this.sprite},set:function(t){this.sprite=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.sprite.spriteFrame},set:function(t){this.sprite.spriteFrame=t},enumerable:!0,configurable:!0}),e=__decorate([a("ExposedLocalizationImage")],e)}(i.default);o.default=n,cc._RF.pop()},{"./LocalizationImage":"LocalizationImage"}],ExposedLocalizationText:[function(t,e,o){"use strict";cc._RF.push(e,"2c90fO5uKRJXI2NVZ36ZHe5","ExposedLocalizationText"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./LocalizationText"),a=cc._decorator.ccclass,n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"textComponent",{get:function(){return this._text},set:function(t){this._text=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._text.string},set:function(t){this._text.string=t},enumerable:!0,configurable:!0}),e=__decorate([a("ExposedLocalizationText")],e)}(i.default);o.default=n,cc._RF.pop()},{"./LocalizationText":"LocalizationText"}],FixShader:[function(t,e,o){"use strict";cc._RF.push(e,"312aaV+t+BPhIZJ6atWkRKa","FixShader"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,a=i.ccclass,n=i.property,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.preview=null,e.frameAlpha=null,e}return __extends(e,t),e.prototype.start=function(){var t,e=this,o=0;this.preview.children.slice().forEach(function(i){t=new cc.Node("ignore me"),t.addComponent(cc.Sprite).spriteFrame=e.frameAlpha,i.parent.addChild(t),i.zIndex=o,o++,t.zIndex=o,o++})},__decorate([n(cc.Node)],e.prototype,"preview",void 0),__decorate([n(cc.SpriteFrame)],e.prototype,"frameAlpha",void 0),e=__decorate([a],e)}(cc.Component);o.default=r,cc._RF.pop()},{}],FocusScreenManager:[function(t,e,o){"use strict";cc._RF.push(e,"259f63rZFhIdaMSIhF7yDGn","FocusScreenManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.isFocus=!0,cc.game.on(cc.game.EVENT_HIDE,e.onBlur,e),cc.game.on(cc.game.EVENT_SHOW,e.onFocus,e),window.onfocus=e.onFocus.bind(e),window.onclick=e.onFocus.bind(e),window.onblur=e.onBlur.bind(e),e}return __extends(e,t),e.prototype.onBlur=function(){this.isFocus&&(this.isFocus=!1,this.emit(e.KEY_SIGNAL_BLUR))},e.prototype.onFocus=function(){this.isFocus||(this.isFocus=!0,this.emit(e.KEY_SIGNAL_FOCUS))},e.KEY_SIGNAL_FOCUS="onFocus",e.KEY_SIGNAL_BLUR="onBlur",e}(cc.Node);o.default=i,cc._RF.pop()},{}],LocalizationAsset:[function(t,e,o){"use strict";cc._RF.push(e,"7d0fd9ILhNILLPX7TBpRZVn","LocalizationAsset"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},set:function(t){var e=this;this._key=t,this.getValue().then(function(t){t&&(e.target=t)})},enumerable:!0,configurable:!0}),e.prototype.getValue=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.localizationManager.getAsset(this.key,Object.getPrototypeOf(this.target).constructor)];case 1:return[2,t.sent()]}})})},e}(t("./LocalizationItem").default);o.default=i,cc._RF.pop()},{"./LocalizationItem":"LocalizationItem"}],LocalizationConfig:[function(t,e,o){"use strict";cc._RF.push(e,"94a6fEAO9NIbZot4vvenO3w","LocalizationConfig"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Singleton"),a=cc._decorator,n=a.ccclass,r=a.property,s=function(){function t(){this.font=null,this.locales=[]}return __decorate([r({type:cc.Font})],t.prototype,"font",void 0),__decorate([r({type:[cc.String]})],t.prototype,"locales",void 0),t=__decorate([n("FontLocale")],t)}();o.FontLocale=s;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.language="en",e.localesFonts=[],e}return __extends(e,t),e.prototype.onLoad=function(){this.instance=i.default.GetInstance(),this.instance.initLocalizationManager(this.language,this.localesFonts)},__decorate([r(cc.String)],e.prototype,"language",void 0),__decorate([r({type:[s]})],e.prototype,"localesFonts",void 0),e=__decorate([n],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../Singleton":"Singleton"}],LocalizationImageComponent:[function(t,e,o){"use strict";cc._RF.push(e,"619ffIqG8JLybEWkKKpOSgn","LocalizationImageComponent"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./ExposedLocalizationImage"),a=t("./LocalizationManager"),n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.localizationImage=new i.default,e}return __extends(e,t),Object.defineProperty(e.prototype,"spriteComponent",{get:function(){return this.localizationImage.spriteComponent},set:function(t){this.localizationImage.spriteComponent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.localizationImage.key},set:function(t){this.localizationImage.key=t},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.spriteComponent||(this.spriteComponent=this.node.getComponent(cc.Sprite)),this.localizationImage.key=this.key},e.prototype.onEnable=function(){var t=a.default.instance;t&&t.subscribeItem(this.localizationImage)},e.prototype.onDisable=function(){var t=a.default.instance;t&&t.unsubscribeItem(this.localizationImage)},__decorate([s({type:i.default,visible:!1})],e.prototype,"localizationImage",void 0),__decorate([s({type:cc.Sprite})],e.prototype,"spriteComponent",null),__decorate([s({type:cc.String})],e.prototype,"key",null),e=__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop()},{"./ExposedLocalizationImage":"ExposedLocalizationImage","./LocalizationManager":"LocalizationManager"}],LocalizationImage:[function(t,e,o){"use strict";cc._RF.push(e,"645daooSdZJ0431qDku7S4Z","LocalizationImage"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./LocalizationAsset"),a=cc._decorator.property,n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this.sprite.spriteFrame},set:function(t){this.sprite.spriteFrame=t},enumerable:!0,configurable:!0}),__decorate([a({type:cc.Sprite})],e.prototype,"sprite",void 0),e}(i.default);o.default=n,cc._RF.pop()},{"./LocalizationAsset":"LocalizationAsset"}],LocalizationItem:[function(t,e,o){"use strict";cc._RF.push(e,"6094eeTqURH5YIyNSAtykVx","LocalizationItem"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./LocalizationManager"),a=cc._decorator.property,n=function(){function t(){this._key=""}return Object.defineProperty(t.prototype,"key",{get:function(){return this._key},set:function(t){this._key=t;var e=this.getValue();e&&this.checkEqualType(e)&&(this.target=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localizationManager",{get:function(){return i.default.instance},enumerable:!0,configurable:!0}),t.prototype.checkEqualType=function(t){return Object.getPrototypeOf(t)===Object.getPrototypeOf(this.target)},__decorate([a(cc.String)],t.prototype,"_key",void 0),t}();o.default=n,cc._RF.pop()},{"./LocalizationManager":"LocalizationManager"}],LocalizationManager:[function(t,e,o){"use strict";cc._RF.push(e,"22974/OYc9AVYiskfsroJyM","LocalizationManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator.ccclass,a={type:cc.SpriteFrame,extension:"png",transform:function(t){return t?(t instanceof HTMLImageElement?(e=new cc.Texture2D).initWithElement(t):e=t,new cc.SpriteFrame(e)):null;var e}},n=function(){function t(t,o){void 0===t&&(t="en"),void 0===o&&(o=[]);var i,a=this;if(this.defaultLocale="en",this.localesFonts=[],this.localizationItems=[],this.localeData=null,this.localeImage=null,this.localeAssetCache={},this.defaultLocale=t,this.localesFonts=o,e.lm)return e.lm;window.localizationCode?this._locale=window.localizationCode:this._locale=this.defaultLocale,e.lm=this,(i=cc.loader.load.bind(cc.loader))("localization/localization.json",function(t,e){t?console.error(t):(e instanceof cc.JsonAsset?a.localeData=e.json:a.localeData=e,a.changeLocale())}),i("localization/localizationImage.json",function(t,e){t?console.error(t):(e instanceof cc.JsonAsset?a.localeImage=e.json:a.localeImage=e,a.changeLocale())})}var e;return e=t,Object.defineProperty(t.prototype,"locale",{get:function(){return this._locale},set:function(t){this._locale=t,this.changeLocale()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localeFont",{get:function(){return this.getFont(this._locale)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultFont",{get:function(){return this.getFont(this.defaultLocale)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return new e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localeStr",{get:function(){return this.locale},enumerable:!0,configurable:!0}),t.prototype.subscribeItem=function(t){this.localizationItems.indexOf(t)<0&&this.localizationItems.push(t)},t.prototype.unsubscribeItem=function(t){var e=this.localizationItems.indexOf(t);e>=0&&this.localizationItems.splice(e,1)},t.prototype.getString=function(t){var e=this.localeData[t];return e?e[this.localeStr]:null},t.prototype.getAsset=function(t,e,o,i){var a=this;return void 0===e&&(e=null),new Promise(function(e,n){a.localeAssetCache[t]?e(a.localeAssetCache[t]):cc.loader.load("localization/images/"+a._locale+"/"+t+"."+o,function(o,n){if(o)console.error(o);else if(i){var r=i(n);a.localeAssetCache[t]=r,e(r)}else a.localeAssetCache[t]=n,e(n)})})},t.prototype.changeLocale=function(){null!==this.localeImage&&null!==this.localeData&&(this.localeAssetCache={},this.preloadAssets(),this.updateAllItems())},t.prototype.preloadAssets=function(){if(this.localeImage)for(var t=0;t<this.localeImage.keys.length;t++)this.localeImage.keys[t],this.getAsset(this.localeImage.keys[t],a.type,a.extension,a.transform)},t.prototype.updateAllItems=function(){var t=this;this.localizationItems.forEach(function(e){if(e.target instanceof cc.Asset){var o=t.getAsset(e.key,Object.getPrototypeOf(e.target).constructor);o&&o.then(function(t){e.target=t})}else{var i=t.getString(e.key);i&&(e.target=i)}})},t.prototype.getFont=function(t){for(var e=0;e<this.localesFonts.length;++e){var o=this.localesFonts[e];if(-1!==o.locales.indexOf(t))return o.font}return null},t.lm=null,t=e=__decorate([i],t)}();o.default=n,cc._RF.pop()},{}],LocalizationTextComponent:[function(t,e,o){"use strict";cc._RF.push(e,"6daffzDoYVGV5POSBPqADP0","LocalizationTextComponent"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./LocalizationManager"),a=t("./ExposedLocalizationText"),n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._overrideFont=!0,e.localizationText=new a.default,e}return __extends(e,t),Object.defineProperty(e.prototype,"textComponent",{get:function(){return this.localizationText.textComponent},set:function(t){this.localizationText.textComponent=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.localizationText.text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.localizationText.key},set:function(t){this.localizationText.key=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overrideFont",{get:function(){return this._overrideFont},set:function(t){this._overrideFont!==t&&(this._overrideFont=t),this.swapFont(t)},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.textComponent||(this.textComponent=this.node.getComponent(cc.Label)),this.localizationText.key=this.key,this.swapFont(this._overrideFont)},e.prototype.onEnable=function(){var t=i.default.instance;t&&t.subscribeItem(this.localizationText)},e.prototype.onDisable=function(){var t=i.default.instance;t&&t.unsubscribeItem(this.localizationText)},e.prototype.swapFont=function(t){var e,o=i.default.instance;o&&((e=t?o.localeFont:o.defaultFont)&&(this.textComponent.font=e))},__decorate([s({visible:!0})],e.prototype,"_overrideFont",void 0),__decorate([s({type:a.default,visible:!1})],e.prototype,"localizationText",void 0),__decorate([s({type:cc.Label})],e.prototype,"textComponent",null),__decorate([s({type:cc.String})],e.prototype,"key",null),e=__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop()},{"./ExposedLocalizationText":"ExposedLocalizationText","./LocalizationManager":"LocalizationManager"}],LocalizationText:[function(t,e,o){"use strict";cc._RF.push(e,"6bb1aEP6eBOtrYPHqOCwG60","LocalizationText"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./LocalizationItem"),a=cc._decorator.property,n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._text=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this._text.string},set:function(t){this._text.string=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.target},enumerable:!0,configurable:!0}),e.prototype.checkEqualType=function(t){return typeof t==typeof this.target},e.prototype.getValue=function(){return this.localizationManager.getString(this.key)},__decorate([a({type:cc.Label})],e.prototype,"_text",void 0),e}(i.default);o.default=n,cc._RF.pop()},{"./LocalizationItem":"LocalizationItem"}],MainmenuController:[function(t,e,o){"use strict";cc._RF.push(e,"825c1V/vmFARKuz9unN+MZV","MainmenuController"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Audio/AudioScene"),a=t("../Singleton"),n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playButton=null,e.textInfo=null,e.audioManager=null,e}return __extends(e,t),e.prototype.start=function(){this.audioManager=a.default.GetInstance().audioManager,this.audioManager.playMusic(i.HowlsKey.musicMenu,0,!0);var t=window.message;this.textInfo.string=""===t?"":a.default.GetInstance().localizationManager.getString(t)},e.prototype.goToMain=function(){this.audioManager.playSfx(i.SFXKey.button_menu),this.playButton.interactable=!1,cc.director.loadScene("Main")},__decorate([s(cc.Button)],e.prototype,"playButton",void 0),__decorate([s(cc.Label)],e.prototype,"textInfo",void 0),e=__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../Audio/AudioScene":"AudioScene","../Singleton":"Singleton"}],ModifyWidget:[function(t,e,o){"use strict";cc._RF.push(e,"c9fbeRtLqpCEqVZzLIylZc7","ModifyWidget"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Singleton"),a=t("./Manager/ResizeScreenManager"),n=cc._decorator,r=n.ccclass,s=n.property,c=n.executeInEditMode,l=function(){function t(){this.bottom=0,this.top=0,this.left=0,this.right=0,this.isAlignBottom=!1,this.isAlignLeft=!1,this.isAlignRight=!1,this.isAlignTop=!1,this.isAlignHorizontalCenter=!1,this.isAlignVerticalCenter=!1,this.horizontalCenter=0,this.verticalCenter=0}return __decorate([s(cc.Float)],t.prototype,"bottom",void 0),__decorate([s(cc.Float)],t.prototype,"top",void 0),__decorate([s(cc.Float)],t.prototype,"left",void 0),__decorate([s(cc.Float)],t.prototype,"right",void 0),__decorate([s(cc.Float)],t.prototype,"isAlignBottom",void 0),__decorate([s(cc.Float)],t.prototype,"isAlignLeft",void 0),__decorate([s(cc.Float)],t.prototype,"isAlignRight",void 0),__decorate([s(cc.Float)],t.prototype,"isAlignTop",void 0),__decorate([s(cc.Float)],t.prototype,"isAlignHorizontalCenter",void 0),__decorate([s(cc.Float)],t.prototype,"isAlignVerticalCenter",void 0),__decorate([s(cc.Float)],t.prototype,"horizontalCenter",void 0),__decorate([s(cc.Float)],t.prototype,"verticalCenter",void 0),t=__decorate([r("widgetInfo")],t)}();o.WidgetInfo=l;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._landscape=!0,e._save=!1,e.widget=null,e}return __extends(e,t),Object.defineProperty(e.prototype,"landscape",{get:function(){return this._landscape},set:function(t){cc.log("change"),this._landscape=t,this.fixPosition()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"save",{get:function(){return this._save},set:function(t){cc.log("save"),this.saveWidget(!this._landscape)},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){this.widget=this.getComponent(cc.Widget)},e.prototype.start=function(){i.default.GetInstance().resizeScreenManager.on(a.default.KEY_SIGNAL_RESIZE,this.fixPositionOnPlay,this),this.fixPositionOnPlay()},e.prototype.fixPositionOnPlay=function(){cc.view.getVisibleSize().width>cc.view.getVisibleSize().height?this.loadWidget(this.landscapeWidget):this.loadWidget(this.portraitWidget)},e.prototype.saveWidget=function(t){t?(this.portraitWidget.bottom=this.widget.bottom,this.portraitWidget.top=this.widget.top,this.portraitWidget.left=this.widget.left,this.portraitWidget.right=this.widget.right,this.portraitWidget.isAlignBottom=this.widget.isAlignBottom,this.portraitWidget.isAlignLeft=this.widget.isAlignLeft,this.portraitWidget.isAlignRight=this.widget.isAlignRight,this.portraitWidget.isAlignTop=this.widget.isAlignTop,this.portraitWidget.isAlignHorizontalCenter=this.widget.isAlignHorizontalCenter,this.portraitWidget.isAlignVerticalCenter=this.widget.isAlignVerticalCenter,this.portraitWidget.verticalCenter=this.widget.verticalCenter,this.portraitWidget.horizontalCenter=this.widget.horizontalCenter):(this.landscapeWidget.bottom=this.widget.bottom,this.landscapeWidget.top=this.widget.top,this.landscapeWidget.left=this.widget.left,this.landscapeWidget.right=this.widget.right,this.landscapeWidget.isAlignBottom=this.widget.isAlignBottom,this.landscapeWidget.isAlignLeft=this.widget.isAlignLeft,this.landscapeWidget.isAlignRight=this.widget.isAlignRight,this.landscapeWidget.isAlignTop=this.widget.isAlignTop,this.landscapeWidget.isAlignHorizontalCenter=this.widget.isAlignHorizontalCenter,this.landscapeWidget.isAlignVerticalCenter=this.widget.isAlignVerticalCenter,this.landscapeWidget.verticalCenter=this.widget.verticalCenter,this.landscapeWidget.horizontalCenter=this.widget.horizontalCenter)},e.prototype.loadWidget=function(t){this.widget.bottom=t.bottom,this.widget.top=t.top,this.widget.left=t.left,this.widget.right=t.right,this.widget.isAlignBottom=t.isAlignBottom,this.widget.isAlignLeft=t.isAlignLeft,this.widget.isAlignRight=t.isAlignRight,this.widget.isAlignTop=t.isAlignTop,this.widget.isAlignHorizontalCenter=t.isAlignHorizontalCenter,this.widget.isAlignVerticalCenter=t.isAlignVerticalCenter,this.widget.verticalCenter=t.verticalCenter,this.widget.horizontalCenter=t.horizontalCenter,this.widget.updateAlignment()},e.prototype.fixPosition=function(){this._landscape?this.loadWidget(this.landscapeWidget):this.loadWidget(this.portraitWidget)},__decorate([s],e.prototype,"_landscape",void 0),__decorate([s],e.prototype,"landscape",null),__decorate([s],e.prototype,"_save",void 0),__decorate([s],e.prototype,"save",null),__decorate([s(cc.Widget)],e.prototype,"widget",void 0),__decorate([s(l)],e.prototype,"landscapeWidget",void 0),__decorate([s(l)],e.prototype,"portraitWidget",void 0),e=__decorate([r,c],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./Manager/ResizeScreenManager":"ResizeScreenManager","./Singleton":"Singleton"}],Orientation:[function(t,e,o){"use strict";cc._RF.push(e,"4d6bb572dZLM4JD2oEceCWi","Orientation"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Singleton"),a=t("./Manager/ResizeScreenManager"),n=cc._decorator,r=n.ccclass,s=n.property,c=n.executeInEditMode,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canvas=null,e._landscape=!0,e}return __extends(e,t),Object.defineProperty(e.prototype,"landscape",{get:function(){return this._landscape},set:function(t){cc.log("change"),this._landscape=t,this.setCanvas()},enumerable:!0,configurable:!0}),e.prototype.onLoad=function(){cc.log("load"),this.canvas=this.node.getComponent(cc.Canvas),i.default.GetInstance().resizeScreenManager.on(a.default.KEY_SIGNAL_RESIZE_PRIORITY,this.snapBorders,this)},e.prototype.start=function(){this.snapBorders()},e.prototype.snapBorders=function(){cc.view.getVisibleSize().width<=640&&this.canvas.fitHeight&&(this.canvas.fitWidth=!0,this.canvas.fitHeight=!1,this.canvas.designResolution={width:640,height:960},console.log(this.canvas.designResolution.width+"  and  "+this.canvas.designResolution.height)),cc.view.getVisibleSize().height<=640&&this.canvas.fitWidth&&(this.canvas.fitWidth=!1,this.canvas.fitHeight=!0,this.canvas.designResolution={width:960,height:640},console.log(this.canvas.designResolution.width+"  and  "+this.canvas.designResolution.height))},e.prototype.setCanvas=function(){cc.log("set canvas"),this._landscape?(this.canvas.designResolution={width:960,height:640},this.canvas.fitHeight=!0,this.canvas.fitWidth=!1):(this.canvas.designResolution={width:640,height:960},this.canvas.fitHeight=!1,this.canvas.fitWidth=!0)},e.prototype.onDestroy=function(){i.default.GetInstance().resizeScreenManager.off(a.default.KEY_SIGNAL_RESIZE_PRIORITY,this.snapBorders,this)},__decorate([s(cc.Canvas)],e.prototype,"canvas",void 0),__decorate([s],e.prototype,"_landscape",void 0),__decorate([s],e.prototype,"landscape",null),e=__decorate([r,c],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./Manager/ResizeScreenManager":"ResizeScreenManager","./Singleton":"Singleton"}],ResizeScreenManager:[function(t,e,o){"use strict";cc._RF.push(e,"b09cehEQURADZc+8YPGzD+w","ResizeScreenManager"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../Utils/Utils"),a=function(t){function e(){var e=t.call(this)||this;return e.initListener(),e}return __extends(e,t),e.prototype.initListener=function(){i.isMobile()?window.addEventListener("resize",this.onResized.bind(this)):cc.view.on("canvas-resize",this.onResized,this)},e.prototype.onResized=function(){this.emit(e.KEY_SIGNAL_RESIZE_PRIORITY),setTimeout(this.sendSignal.bind(this),1)},e.prototype.sendSignal=function(){this.emit(e.KEY_SIGNAL_RESIZE)},e.KEY_SIGNAL_RESIZE="resize",e.KEY_SIGNAL_RESIZE_PRIORITY="resizePriority",e}(cc.Node);o.default=a,cc._RF.pop()},{"../../Utils/Utils":"Utils"}],RotateScreenManager:[function(t,e,o){"use strict";cc._RF.push(e,"a7531td6blA6rNige5gv8Re","RotateScreenManager"),Object.defineProperty(o,"__esModule",{value:!0});var i,a=t("../../Utils/Utils");(function(t){t[t.css=0]="css",t[t.scene=1]="scene"})(i||(i={}));var n=function(t){function e(){var e=t.call(this)||this;return e.percentSizeImage=60,e.landscapeLocked=!1,e.portraitLocked=!0,e.idContainerRotation="orientation-screen",e.type=i.css,e.correctOrientation=!0,a.isMobile()&&(e.addCSS(),e.addDiv(),e.initListener()),e}return __extends(e,t),e.prototype.addCSS=function(){var t=document.createElement("style");t.innerHTML="#orientation-screen {\n            margin: 0 auto;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-image: url(rotate.png);\n            background-repeat: no-repeat;\n            background-position: center;\n            background-color: rgb(0, 0, 0);\n            z-index: 999;\n            display: none;\n        }",document.head.appendChild(t)},e.prototype.addDiv=function(){this.divRotate=document.createElement("Div"),this.divRotate.id=this.idContainerRotation,this.divRotate.style.display="none",this.landscapeLocked&&(this.divRotate.style.backgroundSize=this.percentSizeImage+"vw"),this.portraitLocked&&(this.divRotate.style.backgroundSize=this.percentSizeImage+"vh"),document.body.appendChild(this.divRotate)},e.prototype.initListener=function(){window.addEventListener("resize",this.checkOrientation.bind(this)),this.checkOrientation()},e.prototype.checkOrientation=function(){var t=cc.game.frame,e=t.clientWidth,o=t.clientHeight;this.landscapeLocked?e>o?this.handleCorrect():this.handleIncorrect():this.portraitLocked&&(e<o?this.handleCorrect():this.handleIncorrect())},e.prototype.handleCorrect=function(){this.divRotate&&this.type===i.css&&(this.divRotate.style.display="none",this.correctOrientation||(this.correctOrientation=!0,this.emit(e.KEY_SIGNAL_CORRECT)))},e.prototype.handleIncorrect=function(){this.divRotate&&this.type===i.css&&(this.divRotate.style.display="block",this.correctOrientation&&(this.correctOrientation=!1,this.emit(e.KEY_SIGNAL_INCORRECT)))},e.KEY_SIGNAL_CORRECT="handleCorrect",e.KEY_SIGNAL_INCORRECT="handleIncorrect",e}(cc.Node);o.default=n,cc._RF.pop()},{"../../Utils/Utils":"Utils"}],Scalable:[function(t,e,o){"use strict";cc._RF.push(e,"dc1a82Uz+FND66w8bBoxhri","Scalable"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Singleton"),a=t("./Manager/ResizeScreenManager"),n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fitHeight=!1,e.fitWidth=!1,e.heightResolution=640,e.widthResolution=960,e.maxScale=1.2,e.minScale=.8,e}return __extends(e,t),e.prototype.start=function(){i.default.GetInstance().resizeScreenManager.on(a.default.KEY_SIGNAL_RESIZE_PRIORITY,this.updateScale,this),this.updateScale()},e.prototype.updateScale=function(){var t;this.fitHeight&&(t=(t=(t=cc.view.getVisibleSize().height/this.heightResolution)>this.maxScale?this.maxScale:t)<this.minScale?this.minScale:t,this.node.scaleX=t,this.node.scaleY=t);this.fitWidth&&(t=(t=(t=cc.view.getVisibleSize().width/this.widthResolution)>this.maxScale?this.maxScale:t)<this.minScale?this.minScale:t,this.node.scaleX=t,this.node.scaleY=t)},__decorate([s],e.prototype,"fitHeight",void 0),__decorate([s],e.prototype,"fitWidth",void 0),__decorate([s],e.prototype,"heightResolution",void 0),__decorate([s],e.prototype,"widthResolution",void 0),__decorate([s],e.prototype,"maxScale",void 0),__decorate([s],e.prototype,"minScale",void 0),e=__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop()},{"./Manager/ResizeScreenManager":"ResizeScreenManager","./Singleton":"Singleton"}],ShownHide:[function(t,e,o){"use strict";cc._RF.push(e,"c0666adk81NboWGSl1f1BPg","ShownHide"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Singleton"),a=t("./Manager/ResizeScreenManager"),n=cc._decorator,r=n.ccclass,s=n.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.landscape=null,e.portrait=null,e}return __extends(e,t),e.prototype.start=function(){i.default.GetInstance().resizeScreenManager.on(a.default.KEY_SIGNAL_RESIZE,this.doYourThing,this),this.doYourThing()},e.prototype.doYourThing=function(){cc.view.getVisibleSize().width>cc.view.getVisibleSize().height?(this.landscape.active=!0,this.portrait.active=!1):(this.landscape.active=!1,this.portrait.active=!0)},__decorate([s(cc.Node)],e.prototype,"landscape",void 0),__decorate([s(cc.Node)],e.prototype,"portrait",void 0),e=__decorate([r],e)}(cc.Component);o.default=c,cc._RF.pop()},{"./Manager/ResizeScreenManager":"ResizeScreenManager","./Singleton":"Singleton"}],Singleton:[function(t,e,o){"use strict";cc._RF.push(e,"0ae1dzQPiFB2Ym8Oh1jLom3","Singleton"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Localization/LocalizationManager"),a=t("./Manager/ResizeScreenManager"),n=t("./Manager/RotateScreenManager"),r=t("./Audio/AudioManager"),s=t("./Manager/FocusScreenManager"),c=cc._decorator.ccclass,l=function(t){function e(){var e=t.call(this)||this;return e.isPause=!1,e.resizeScreenManager=new a.default,e.resizeScreenManager.on(a.default.KEY_SIGNAL_RESIZE,e.onResized,e),e.rotateScreen=new n.default,e.rotateScreen.on(n.default.KEY_SIGNAL_CORRECT,e.onChangeScreen,e),e.rotateScreen.on(n.default.KEY_SIGNAL_INCORRECT,e.onChangeScreen,e),e.focusManager=new s.default,e.focusManager.on(s.default.KEY_SIGNAL_BLUR,e.onChangeScreen,e),e.focusManager.on(s.default.KEY_SIGNAL_FOCUS,e.onChangeScreen,e),e.audioManager=new r.default,e}var o;return __extends(e,t),o=e,e.prototype.initLocalizationManager=function(t,e){void 0===e&&(e=[]),this.localizationManager=new i.default(t,e)},e.GetInstance=function(){return this.instance||(this.instance=new o),this.instance},e.prototype.onResized=function(){this.emit(a.default.KEY_SIGNAL_RESIZE)},e.prototype.onChangeScreen=function(){this.rotateScreen.correctOrientation&&this.focusManager.isFocus?this.resumeGame():this.pauseGame()},e.prototype.pauseGame=function(){this.isPause||(cc.game.pause(),this.audioManager.pause(),this.isPause=!0)},e.prototype.resumeGame=function(){this.isPause&&(this.rotateScreen.correctOrientation&&cc.game.resume(),this.audioManager.resume(),this.isPause=!1)},e.prototype.switchAudioState=function(){this.audioManager.enableAudio?this.audioManager.disableAll():this.audioManager.enableAll()},e.instance=null,e=o=__decorate([c],e)}(cc.Node);o.default=l,cc._RF.pop()},{"./Audio/AudioManager":"AudioManager","./Localization/LocalizationManager":"LocalizationManager","./Manager/FocusScreenManager":"FocusScreenManager","./Manager/ResizeScreenManager":"ResizeScreenManager","./Manager/RotateScreenManager":"RotateScreenManager"}],UIElementsManager:[function(t,e,o){"use strict";cc._RF.push(e,"30831qJcKNHIZMKUnmU1a/y","UIElementsManager"),Object.defineProperty(o,"__esModule",{value:!0});var i,a=t("../ModifyWidget"),n=t("../Singleton"),r=t("./ResizeScreenManager"),s=t("../../Utils/Utils"),c=cc._decorator.ccclass;(function(t){t[t.SelectBody=0]="SelectBody",t[t.SelectItems=1]="SelectItems",t[t.SelectDecoration=2]="SelectDecoration",t[t.SelectExport=3]="SelectExport"})(i=o.SectionType||(o.SectionType={}));var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){this.canvas=cc.find("Canvas"),this.preview=cc.find("Canvas/Preview"),this.background=cc.find("Canvas/background canvas"),this.stickers=cc.find("Canvas/Stickers"),this.colorBar=cc.find("Canvas/node_colors/node_colors portrait/colors"),this.nextButtom=cc.find("Canvas/bottom_r"),this.backButtom=cc.find("Canvas/bottom_l back"),this.previewModifyWidget=cc.instantiate(this.preview.getComponent(a.default)),this.buttomModifyWidget=cc.instantiate(this.nextButtom.getComponent(a.default)),n.default.GetInstance().resizeScreenManager.on(r.default.KEY_SIGNAL_RESIZE,this.resize,this)},e.prototype.setCurrentSection=function(t){this.currentSection=t,this.resize()},e.prototype.resize=function(){this.ratio=this.canvas.width/this.canvas.height;var t=cc.game.frame,e=t.clientWidth,o=t.clientHeight;this.landscape=e>o,console.log("ratio: "+this.ratio);var a="";if(!s.isMobile()&&this.landscape?a="landscape":s.isMobile()&&!this.landscape&&(a="portrait"),console.log(a),""!==a)switch(this.currentSection){case i.SelectBody:"landscape"===a?this.setSectionBodyLandscape():this.setSectionBodyPortrait();break;case i.SelectItems:"landscape"===a?this.setSectionItemsLandscape():this.setSectionItemsPortrait();break;case i.SelectDecoration:"landscape"===a?this.setSectionDecorationLandscape():this.setSectionDecorationPortrait();break;case i.SelectExport:"landscape"===a?this.setSectionExportLandscape():this.setSectionExportPortrait()}},e.prototype.setSectionBodyPortrait=function(){this.setOffsetButtoms(0),this.colorBar.position=cc.v2(0,220);var t=this.colorBar.parent.getComponent(cc.Widget);t.isAlignBottom=!0,t.isAlignTop=!1,t.updateAlignment(),console.log(this.colorBar.position.y)},e.prototype.setSectionBodyLandscape=function(){},e.prototype.setSectionItemsPortrait=function(){this.setOffsetButtoms(0);var t=this.colorBar.parent.getComponent(cc.Widget);t.isAlignBottom=!0,t.isAlignTop=!1,this.colorBar.position=cc.v2(0,275),this.setOffsetPreview(0,0),this.preview.scale=1,this.ratio>.71&&(t.isAlignBottom=!1,t.isAlignTop=!0,this.colorBar.position=cc.v2(0,-120)),t.updateAlignment()},e.prototype.setSectionItemsLandscape=function(){this.setOffsetPreview(0,0),this.preview.scale=1},e.prototype.setSectionDecorationPortrait=function(){if(this.background.scale=1,this.stickers.scale=1,this.background.y=21,this.setOffsetSticker(0),this.setOffsetPreview(-11,15),this.preview.scale=.92,this.setOffsetButtoms(0),this.ratio>.667&&(this.background.y=60,this.setOffsetPreview(0,60),this.setOffsetSticker(60)),this.ratio>.75){var t=1-2*(this.ratio-.75);this.background.scale=t,this.preview.scale=.92+t-1,this.stickers.scale=t}this.ratio<.64&&this.ratio>.46&&this.setOffsetButtoms(150)},e.prototype.setSectionDecorationLandscape=function(){this.setOffsetButtoms(0),this.background.scale=1,this.stickers.scale=1,this.background.y=21,this.setOffsetSticker(0),this.setOffsetPreview(-11,15),this.preview.scale=.92},e.prototype.setSectionExportPortrait=function(){this.setOffsetButtoms(-190),this.ratio>.8&&this.setOffsetButtoms(-60),this.background.scale=.85,this.stickers.scale=.85,this.background.y=62,this.setOffsetSticker(41),this.setOffsetPreview(-11,56),this.preview.scale=.92*this.background.scale},e.prototype.setSectionExportLandscape=function(){this.background.scale=.85,this.stickers.scale=.85,this.background.y=62,this.setOffsetSticker(41),this.setOffsetPreview(-11,56),this.preview.scale=.92*this.background.scale},e.prototype.setOffsetSticker=function(t){var e=this.stickers.getComponent(cc.Widget);e.verticalCenter=t,e.updateAlignment()},e.prototype.setOffsetPreview=function(t,e){var o=this.preview.getComponent(a.default);o.landscapeWidget.horizontalCenter=this.previewModifyWidget.landscapeWidget.horizontalCenter+t,o.landscapeWidget.verticalCenter=this.previewModifyWidget.landscapeWidget.verticalCenter+e,o.portraitWidget.horizontalCenter=this.previewModifyWidget.portraitWidget.horizontalCenter+t,o.portraitWidget.verticalCenter=this.previewModifyWidget.portraitWidget.verticalCenter+e,o.fixPositionOnPlay(),this.preview.getComponent(cc.Widget).updateAlignment()},e.prototype.setOffsetButtoms=function(t){var e=this.backButtom.getComponent(a.default),o=this.nextButtom.getComponent(a.default);e.landscapeWidget.bottom=this.buttomModifyWidget.landscapeWidget.bottom+t,e.portraitWidget.bottom=this.buttomModifyWidget.portraitWidget.bottom+t,o.landscapeWidget.bottom=this.buttomModifyWidget.landscapeWidget.bottom+t,o.portraitWidget.bottom=this.buttomModifyWidget.portraitWidget.bottom+t,e.fixPositionOnPlay(),o.fixPositionOnPlay(),this.backButtom.getComponent(cc.Widget).updateAlignment(),this.nextButtom.getComponent(cc.Widget).updateAlignment()},e.prototype.onDestroy=function(){n.default.GetInstance().resizeScreenManager.off(r.default.KEY_SIGNAL_RESIZE,this.resize,this)},e=__decorate([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../../Utils/Utils":"Utils","../ModifyWidget":"ModifyWidget","../Singleton":"Singleton","./ResizeScreenManager":"ResizeScreenManager"}],UIManager:[function(t,e,o){"use strict";cc._RF.push(e,"4fd3cai+8VE06sxOGKrKJI+","UIManager"),Object.defineProperty(o,"__esModule",{value:!0});var i,a=t("./EnumCategory"),n=t("../Utils/Utils"),r=t("./Singleton"),s=t("./Manager/AvatarManager"),c=t("./Audio/AudioScene"),l=t("./Manager/ExportManager"),h=t("./Manager/UIElementsManager"),d=cc._decorator,p=d.ccclass,u=d.property;(function(t){t[t.none=0]="none",t[t.items=1]="items",t[t.sticker=2]="sticker",t[t.background=3]="background"})(i||(i={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollViewElements=null,e.scrollViewCategories=null,e.scrollViewElements2=null,e.scrollViewCategories2=null,e.avatarManager=null,e.icons=null,e.icons2=null,e.nextButtom=null,e.backButtom=null,e.bodyContainer=null,e.categoriesContainer=null,e.messageNode=null,e.colorBar=null,e.colorBar2=null,e.background=null,e.extrasContainers=null,e.backContainer=null,e.backContainer2=null,e.extrasSelection=null,e.extrasSelection2=null,e.stickerContainer=null,e.stickerContainer2=null,e.stickers=null,e.photoDownload=null,e.buttonGifAnimation=null,e.backgroundPrefab=[],e.exportManager=null,e.preview=null,e.trashButtom=null,e.frameNextLandscape=null,e.frameBackLandscape=null,e.frameRetryLandscape=null,e.frameNextPortrait=null,e.frameBackPortrait=null,e.frameRetryPortrait=null,e.frameContainer=null,e.frameContainerMiddle=null,e.frameContainerSmall=null,e.bg=null,e.bgBlur=null,e.photoContainer=null,e.arrowNextCategory=null,e.arrowNextCategory2=null,e.delayAnimationHint=6,e.delayArrows=5.5,e.delayInit=.1,e.categorySelected=0,e.character=null,e.sticker1ButtomRight=null,e.sticker1ButtomLeft=null,e.sticker2ButtomRight=null,e.sticker2ButtomLeft=null,e.background2ButtomRight=null,e.background2ButtomLeft=null,e.instance=null,e.selectColor=cc.Color.WHITE,e.photoIndex=0,e.buttomRightContent=null,e.buttomLeftContent=null,e.buttomRightContent2=null,e.buttomLeftContent2=null,e.buttomRightElement=null,e.buttomLeftElement=null,e.contentElements=null,e.contentElements2=null,e.colors=[],e.stickerSelecter=0,e.landscapeStickerSize=73,e.currentBackGroundSelect=0,e.audioManager=null,e.bottomContianerItems=null,e.arrowsLoopLeft=[],e.arrowsLoopRight=[],e.lastPosC1=cc.v2(-1,0),e.lastPosC2=cc.v2(-1,0),e.lastPosE2=cc.v2(-1,0),e.lastPosS1=cc.v2(-1,0),e.lastPosS2=cc.v2(-1,0),e.lastPosB2=cc.v2(-1,0),e}return __extends(e,t),e.prototype.start=function(){this.uielementsManager=this.node.getComponent(h.default),this.confirmation=this.node.getChildByName("confirmation"),this.backgroundUI=this.node.getChildByName("bgGameplay"),this.spriteBackgroundUI=this.backgroundUI.getComponent(cc.Sprite),this.selectColor.fromHEX("00efa9"),this.photoContainer.getChildByName("photo_download_portrait").getChildByName("container").children[0].color=this.selectColor,this.photoContainer.getChildByName("photo_download_landscape").getChildByName("container").children[0].color=this.selectColor,this.audioManager=r.default.GetInstance().audioManager,this.audioManager.playMusicChain(c.HowlsKey.musicGp1,c.HowlsKey.musicGp2),this.instance=r.default.GetInstance(),this.contentElements=this.scrollViewElements.getChildByName("custom"),this.contentElements2=this.scrollViewElements2.node.getChildByName("custom"),this.bottomContianerItems=this.contentElements.parent.parent,this.scrollViewCategories.node.off(cc.Node.EventType.MOUSE_WHEEL),this.landscapeTileSize=69,this.portraitTileSize=128,this.landscapeElementTileSize=66,this.portraitElementTileSize=106,this.currentBackGroundSelect=-1,this.isShowMessage=!1,this.sticker1ButtomRight=this.stickerContainer.parent.parent.getChildByName("arrow_r"),this.sticker1ButtomLeft=this.stickerContainer.parent.parent.getChildByName("arrow_l"),this.sticker2ButtomRight=this.stickerContainer2.parent.parent.parent.getChildByName("arrow_r"),this.sticker2ButtomLeft=this.stickerContainer2.parent.parent.parent.getChildByName("arrow_l"),this.buttomRightContent=this.scrollViewCategories.node.getChildByName("arrow_r"),this.buttomLeftContent=this.scrollViewCategories.node.getChildByName("arrow_l"),this.buttomRightContent2=this.scrollViewCategories2.node.getChildByName("arrow_r"),this.buttomLeftContent2=this.scrollViewCategories2.node.getChildByName("arrow_l"),this.buttomRightElement=this.scrollViewElements2.node.parent.parent.getChildByName("arrow_r"),this.buttomLeftElement=this.scrollViewElements2.node.parent.parent.getChildByName("arrow_l"),this.background2ButtomRight=this.backContainer2.parent.parent.parent.getChildByName("arrow_r"),this.background2ButtomLeft=this.backContainer2.parent.parent.parent.getChildByName("arrow_l"),this.gifButton=this.background.getChildByName("gif_button"),this.containerLogo=this.background.getChildByName("photo"),this.descriptionPhoto=this.containerLogo.getChildByName("description"),this.urlPhoto=this.containerLogo.getChildByName("web"),this.updateMessage(),this.loadCategoryElements(),this.checkElement(0),this.fillBodyColors(),this.updateColors(),this.showMessage(0),this.setSectionBody(),this.selectBackground(0),this.isGifEnabled=!1,this.localizeConfirmation()},e.prototype.localizeConfirmation=function(){this.confirmation.getComponentInChildren(cc.Label).string=r.default.GetInstance().localizationManager.getString("confirmation")},e.prototype.updateMessage=function(){var t=window.message;this.descriptionPhoto.getComponent(cc.Label).string=""===t?"":r.default.GetInstance().localizationManager.getString(t),this.urlPhoto.getComponent(cc.Label).string=window.url},e.prototype.clearButtom=function(){r.default.GetInstance().audioManager.playSfx(c.SFXKey.button_menu),this.confirmation.active||r.default.GetInstance().audioManager.playSfx(c.SFXKey.popup_confirmation),this.confirmation.active=!this.confirmation.active},e.prototype.reset=function(){r.default.GetInstance().audioManager.playSfx(c.SFXKey.button_menu),this.avatarManager.colors.forEach(function(t){null!==t&&(t.index=0)}),this.avatarManager.paletteItems.forEach(function(t){null!==t&&(t.index=0)}),this.avatarManager.reset(),this.categorySelected=5,this.checkCategory(5),this.loadCategoryElements(),this.checkElement(0),this.scrollViewCategories.scrollToBottomLeft(0),this.scrollViewCategories2.scrollToBottomLeft(0);var t=0;this.avatarManager.skinColors.index=0,this.bodyContainer.children[0].children[0].children.forEach(function(e){e.children[0].active=0===t,t+=1}),t=0,this.bodyContainer.children[1].children[0].children.forEach(function(e){e.children[0].active=0===t,t+=1}),this.eventScrollView(),this.updateColors(),this.confirmation.active=!1,this.avatarManager.chargePreviewV2(),this.avatarManager.changeBodyParts(),this.setSectionSelectDecoration(),this.setSectionItems(),this.setSectionBody()},e.prototype.changeBody=function(t){r.default.GetInstance().audioManager.playSfx(c.SFXKey.selection_item);var e=Number(t.target.name.split("_")[1])-1;this.avatarManager.characterSelected=e,this.avatarManager.chargePreviewV2(),this.avatarManager.changeBodyParts();var o=0;this.bodyContainer.children[0].children[0].children.forEach(function(t){t.children[0].active=e===o,o+=1}),o=0,this.bodyContainer.children[1].children[0].children.forEach(function(t){t.children[0].active=e===o,o+=1}),t.target.children[0].active=!0},e.prototype.fillBodyColors=function(){var t=this;this.colorBar.active=!0,this.colorBar2.active=!0;var e=0;this.avatarManager.skinColors.palettes.forEach(function(o){t.colorBar.children[e].active=!0,t.colorBar.children[e].color=o.r,t.colorBar2.children[e].active=!0,t.colorBar2.children[e].color=o.r,e+=1}),this.colorBar.children[this.avatarManager.skinColors.index].getChildByName("check").active=!0,this.colorBar2.children[this.avatarManager.skinColors.index].getChildByName("check").active=!0},e.prototype.buttomNext=function(){r.default.GetInstance().audioManager.playSfx(c.SFXKey.button_menu),0===this.categorySelected?(this.hideMessage(),this.setSectionItems(),this.eventScrollView()):this.categorySelected>=1&&this.categorySelected<=19?(this.hideMessage(),this.setSectionSelectDecoration()):this.categorySelected>=20&&this.categorySelected<=21?(this.hideMessage(),r.default.GetInstance().audioManager.playSfx(c.SFXKey.final_photo),this.setSectionExport()):this.clearButtom()},e.prototype.buttomBack=function(){this.hideMessage(),r.default.GetInstance().audioManager.playSfx(c.SFXKey.button_menu),this.categorySelected>=1&&this.categorySelected<=19?this.setSectionBody():this.categorySelected>=20&&this.categorySelected<=21?(this.setSectionItems(),this.trashButtom.active=!0):this.setSectionSelectDecoration()},e.prototype.arrowLoop=function(t){if(this.stopArrowTutorial(),n.isMobile())switch(t){case i.items:this.arrowsLoopLeft.push(this.buttomLeftContent2),this.arrowsLoopRight.push(this.buttomRightContent2),this.arrowsLoopLeft.push(this.buttomLeftElement),this.arrowsLoopRight.push(this.buttomRightElement);break;case i.background:this.arrowsLoopRight.push(this.background2ButtomRight),this.arrowsLoopLeft.push(this.background2ButtomLeft);break;case i.sticker:this.arrowsLoopLeft.push(this.sticker2ButtomLeft),this.arrowsLoopRight.push(this.sticker2ButtomRight)}else switch(t){case i.items:this.arrowsLoopLeft.push(this.buttomLeftContent),this.arrowsLoopRight.push(this.buttomRightContent);break;case i.sticker:this.arrowsLoopLeft.push(this.sticker1ButtomLeft),this.arrowsLoopRight.push(this.sticker1ButtomRight)}this.arrowsLoopLeft.length>0&&this.initArrowTutorial()},e.prototype.stopArrowTutorial=function(){this.unscheduleAllCallbacks();for(var t=0,e=this.arrowsLoopLeft.length;t<e;t++)this.arrowsLoopLeft[t].getComponent(cc.Animation).stop("LOOP_arrow_l"),this.arrowsLoopLeft[t].scale=1;for(t=0,e=this.arrowsLoopRight.length;t<e;t++)this.arrowsLoopRight[t].getComponent(cc.Animation).stop("LOOP_arrow_r"),this.arrowsLoopRight[t].scaleY=1,this.arrowsLoopRight[t].scaleX=-1;this.arrowsLoopLeft=[],this.arrowsLoopRight=[]},e.prototype.initArrowTutorial=function(){for(var t,e=this.delayAnimationHint,o=this.delayArrows,i=this.delayInit,a=0,n=function(t,e){var n=t;r.scheduleOnce(function(){this.arrowsLoopLeft[n].getComponent(cc.Animation).play("LOOP_arrow_l"),console.log("k: "+n+" left")}.bind(r),i+a*o),a++,r.scheduleOnce(function(){this.arrowsLoopRight[n].getComponent(cc.Animation).play("LOOP_arrow_r"),console.log("k: "+n+" right")}.bind(r),i+a*o),a++},r=this,s=0,c=this.arrowsLoopLeft.length;s<c;s++)n(s);t=i+(a-1)*o,this.scheduleOnce(function(){console.log("init"),this.initArrowTutorial()}.bind(this),t+e)},e.prototype.setSectionBody=function(){this.nextButtom.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.frameNextLandscape,this.backButtom.active=!1,this.nextButtom.active=!0,this.bodyContainer.active=!0,this.categoriesContainer.active=!1,this.extrasContainers.active=!1,this.trashButtom.active=!0,this.categorySelected=0,this.fillBodyColors(),this.updateColors(),this.showMessage(0),this.uielementsManager.setCurrentSection(h.SectionType.SelectBody),this.arrowLoop(i.none)},e.prototype.setSectionItems=function(){this.nextButtom.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.frameNextLandscape,this.backButtom.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.frameBackLandscape,this.trashButtom.active=!0,this.backButtom.active=!0,this.nextButtom.active=!0,this.bodyContainer.active=!1,this.nextButtom.active=!0,this.background.active=!1,this.extrasContainers.active=!1,this.categoriesContainer.active=!0,this.categorySelected=5,this.updateColors(),this.loadCategoryElements(),this.checkElement(this.avatarManager.getVal(a.Category[this.categorySelected])),this.checkCategory(this.categorySelected),this.setContainerBar(),this.scrollViewCategories.scrollToBottomLeft(0),this.scrollViewCategories2.scrollToBottomLeft(0),this.stickers.active=!1,this.showMessage(1),this.uielementsManager.setCurrentSection(h.SectionType.SelectItems),this.arrowLoop(i.items)},e.prototype.setSectionSelectDecoration=function(){this.setSelectPhoto(0),this.hideMessage(),this.background.children[1].active=!0,this.trashButtom.active=!1,this.nextButtom.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.frameNextLandscape,this.backButtom.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.frameBackLandscape,this.backButtom.active=!0,this.nextButtom.active=!0,this.categoriesContainer.active=!1,this.background.active=!0,this.extrasContainers.active=!0,this.categorySelected=a.Category.background,this.backContainer.parent.parent.active=!0,this.backContainer2.parent.parent.parent.parent.active=!0,this.stickerContainer.parent.parent.active=!1,this.stickerContainer2.parent.parent.parent.parent.active=!1,this.stickers.active=!0,this.updateColors(),this.extrasSelection.children[0].color=this.selectColor,this.extrasSelection.children[1].color=cc.Color.WHITE,this.extrasSelection2.children[0].color=this.selectColor,this.extrasSelection2.children[1].color=cc.Color.WHITE,this.nextButtom.active=!0,this.photoDownload.active=!1,this.gifButton.active=!0,this.containerLogo.active=!1,this.uielementsManager.setCurrentSection(h.SectionType.SelectDecoration),this.arrowLoop(i.background)},e.prototype.setSectionExport=function(){this.nextButtom.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.frameRetryLandscape,this.backButtom.children[0].children[0].getComponent(cc.Sprite).spriteFrame=this.frameBackLandscape,this.showMessage(2),this.backButtom.active=!0,this.nextButtom.active=!0,this.containerLogo.active=!0,this.gifButton.active=!1,this.categorySelected=a.Category.gif,this.photoDownload.active=!0,this.extrasContainers.active=!1,this.uielementsManager.setCurrentSection(h.SectionType.SelectExport),this.arrowLoop(i.none)},e.prototype.loadCategoryElements=function(){var t=this;if(0===this.categorySelected);else{this.contentElements.children.forEach(function(t){t.getChildByName("check").active=!1,t.active=!1}),this.contentElements2.children.forEach(function(t){t.getChildByName("check").active=!1,t.active=!1});var e=0;this.avatarManager.character[this.avatarManager.characterSelected].getChildByName(a.Category[this.categorySelected]).children.forEach(function(o){t.contentElements.children[e].active=!0,t.contentElements2.children[e].active=!0;var i=o.name.split(" ")[0];t.contentElements.children[e].getComponent(cc.Sprite).spriteFrame=t.icons.getSpriteFrame(i),t.contentElements.children[e].width=t.landscapeElementTileSize,t.contentElements2.children[e].getComponent(cc.Sprite).spriteFrame=t.icons2.getSpriteFrame(i),t.contentElements2.children[e].width=t.portraitElementTileSize,e+=1}),this.countItemsCategory=e,this.countItemsCategory<=5?(this.scrollViewElements2.scrollToBottomLeft(0),this.buttomRightElement.active=!1,this.buttomLeftElement.active=!1,this.scrollViewElements2.enabled=!1):(this.scrollViewElements2.enabled=!0,this.buttomRightElement.active=!0,this.buttomLeftElement.active=!1,this.scrollViewElements2.scrollToBottomLeft(0))}},e.prototype.selectElement=function(t){if(this.hideMessage(),this.categorySelected===a.Category.background){r.default.GetInstance().audioManager.playSfx(c.SFXKey.selection_item);var e=Number(t.target.name.split(" ")[1]),o=0;this.backContainer.children.forEach(function(t){t.children[0].active=e===o,o+=1}),o=0,this.backContainer2.children.forEach(function(t){t.children[0].active=e===o,o+=1}),this.selectBackground(e)}else if(this.categorySelected===a.Category.sticker){r.default.GetInstance().audioManager.playSfx(c.SFXKey.selection_item),this.stickers.active=!0;var i=Number(t.target.name.split(" ")[1]);this.stickers.children.forEach(function(t){t.active=!1}),this.stickers.children[i].active=!0;var n=0;this.stickerContainer.children.forEach(function(t){t.getChildByName("check").active=n===i,n+=1}),n=0,this.stickerContainer2.children.forEach(function(t){t.getChildByName("check").active=n===i,n+=1})}else{var s=Number(t.target.name.split(" ")[1]);this.categorySelected===a.Category.objects&&4===s?r.default.GetInstance().audioManager.playSfx(c.SFXKey.snarf_equipped):r.default.GetInstance().audioManager.playSfx(c.SFXKey.selection_item),-1!==[1,2,3,4,6,7,10,11,12,13,18,19,20,21].indexOf(this.categorySelected)&&r.default.GetInstance().audioManager.playSfx(c.SFXKey.selection_clothes);var l=0;this.contentElements.children.forEach(function(t){t.getChildByName("check").active=l===s,l+=1}),l=0,this.contentElements2.children.forEach(function(t){t.getChildByName("check").active=l===s,l+=1}),this.avatarManager.change(this.categorySelected,s),this.updateColors()}},e.prototype.switchGifEnabled=function(){this.isGifEnabled=!this.isGifEnabled,this.buttonGifAnimation.stop(),r.default.GetInstance().audioManager.playSfx(c.SFXKey.button_menu),this.isGifEnabled?(this.currentBackgroundAnimation.play(this.currentBackgroundAnimation.getClips()[0].name),this.buttonGifAnimation.play("ON_gif")):(this.currentBackgroundAnimation.stop(),this.buttonGifAnimation.play("OFF_gif"))},e.prototype.selectBackground=function(t){if(this.currentBackGroundSelect!==t){this.currentBackGroundSelect=t;var e=cc.instantiate(this.backgroundPrefab[t]);e.scale=.9,this.currentBackgroundAnimation=e.getComponent(cc.Animation),this.background.getChildByName("mask").removeAllChildren(),this.background.getChildByName("mask").addChild(e),this.isGifEnabled?this.currentBackgroundAnimation.play(this.currentBackgroundAnimation.getClips()[0].name):this.currentBackgroundAnimation.stop()}},e.prototype.checkElement=function(t){this.contentElements.children[t].getChildByName("check").active=!0,this.contentElements2.children[t].getChildByName("check").active=!0},e.prototype.checkCategory=function(t){var e=this;this.scrollViewCategories.node.getChildByName("mask").getChildByName("content").children.forEach(function(o){o.color=o.name===a.Category[t]?e.selectColor:cc.Color.WHITE}),this.scrollViewCategories2.node.getChildByName("mask").getChildByName("content").children.forEach(function(o){o.color=o.name===a.Category[t]?e.selectColor:cc.Color.WHITE}),this.scrollViewElements2.scrollToBottomLeft(0),this.eventScrollView()},e.prototype.showMessage=function(t){var e;this.isShowMessage=!0,this.messageNode.getComponent(cc.Animation).stop("message_Show'nDisapear"),this.messageNode.active=!0,this.messageNode.children[0].opacity=255,0===t?(e="choose",this.messageNode.getComponent(cc.Animation).play("messege_up")):1===t?(e="customize",this.messageNode.getComponent(cc.Animation).play("messege_up")):2===t?(e="photo",this.messageNode.getComponent(cc.Animation).play("messege_down_photo")):3===t?(e="story",this.messageNode.getComponent(cc.Animation).play("messege_down_photo")):4===t&&(e="sticker",this.messageNode.getComponent(cc.Animation).play("messege_down_photo")),this.messageNode.children[0].children[0].getComponent(cc.Label).string=this.instance.localizationManager.getString(e)},e.prototype.hideMessage=function(t){void 0===t&&(t=!0),this.isShowMessage&&(this.isShowMessage=!1,t?this.messageNode.getComponent(cc.Animation).play("message_Show'nDisapear"):this.messageNode.active=!1)},e.prototype.selectCategory=function(t,e){var o=this;if(this.categorySelected=a.Category[e],r.default.GetInstance().audioManager.playSfx(c.SFXKey.selection_item),this.hideMessage(),this.categorySelected>=a.Category.background){var n=0;this.extrasSelection.children.forEach(function(t){t.color=n===o.categorySelected-a.Category.background?o.selectColor:cc.Color.WHITE,n+=1}),n=0,this.extrasSelection2.children.forEach(function(t){t.color=n===o.categorySelected-a.Category.background?o.selectColor:cc.Color.WHITE,n+=1}),this.categorySelected===a.Category.background&&(this.arrowLoop(i.background),this.backContainer.parent.parent.active=!0,this.backContainer2.parent.parent.parent.parent.active=!0,this.stickerContainer.parent.parent.active=!1,this.stickerContainer2.parent.parent.parent.parent.active=!1),this.categorySelected===a.Category.sticker&&(this.arrowLoop(i.sticker),this.backContainer.parent.parent.active=!1,this.backContainer2.parent.parent.parent.parent.active=!1,this.stickerContainer.parent.parent.active=!0,this.stickerContainer2.parent.parent.parent.parent.active=!0)}else this.checkCategory(this.categorySelected),this.loadCategoryElements(),this.checkElement(this.avatarManager.getVal(e)),this.setContainerBar(),this.updateColors()},e.prototype.setContainerBar=function(){var t=this.bottomContianerItems.getComponent(cc.Sprite);10===this.countItemsCategory?(this.contentElements.x=-175,t.spriteFrame=this.frameContainer):5===this.countItemsCategory?(t.spriteFrame=this.frameContainerSmall,this.contentElements.x=8):(t.spriteFrame=this.frameContainerMiddle,this.contentElements.x=-63)},e.prototype.selectColorButtom=function(t){var e=Number(t.target.name.split(" ")[1]);r.default.GetInstance().audioManager.playSfx(c.SFXKey.selection_color),0===this.categorySelected?(this.avatarManager.skinColors.index=e,this.avatarManager.changeBodyParts(),this.updateColors(),this.avatarManager.chargePreviewV2()):(this.avatarManager.colors[this.categorySelected].index=e,this.updateColors(),this.avatarManager.chargePreviewV2())},e.prototype.updateColors=function(){this.updateColorBar(this.colorBar),this.updateColorBar(this.colorBar2)},e.prototype.updateColorBar=function(t){if(t.children.forEach(function(t){t.active=!1,t.getChildByName("check").active=!1}),0===this.categorySelected)this.fillBodyColors();else if(this.avatarManager.colors[this.categorySelected]){t.active=!0;var e=0;this.avatarManager.colors[this.categorySelected].palettes.forEach(function(o){t.children[e].active=!0,t.children[e].color=o.r,e+=1}),t.children[this.avatarManager.colors[this.categorySelected].index].getChildByName("check").active=!0}else t.active=!1},e.prototype.buttomRight=function(t,e){var o;if(r.default.GetInstance().audioManager.playSfx(c.SFXKey.button_arrow),"elements"===e){this.scrollViewElements2.stopAutoScroll();var i=this.scrollViewElements2.getScrollOffset();o=Math.round(-i.x)+this.getOffsetX(this.portraitElementTileSize,i.x),this.scrollViewElements2.scrollToOffset(cc.v2(o,0),.1)}else if("sticker"===e){(a=this.stickerContainer.parent.getComponent(cc.ScrollView)).stopAutoScroll();i=a.getScrollOffset();o=Math.round(-i.x)+this.getOffsetX(this.landscapeStickerSize,i.x),a.scrollToOffset(cc.v2(o,0),.1),(a=this.stickerContainer2.parent.getComponent(cc.ScrollView)).stopAutoScroll(),i=a.getScrollOffset(),o=Math.round(-i.x)+this.getOffsetX(this.portraitElementTileSize,i.x),a.scrollToOffset(cc.v2(o,0),.1)}else if("background"===e){var a;(a=this.backContainer2.parent.getComponent(cc.ScrollView)).stopAutoScroll();i=a.getScrollOffset();o=Math.round(-i.x)+this.getOffsetX(this.landscapeStickerSize,i.x),a.scrollToOffset(cc.v2(o,0),.1)}else{this.scrollViewCategories.stopAutoScroll();i=this.scrollViewCategories.getScrollOffset();o=Math.round(-i.x)+this.getOffsetX(this.landscapeTileSize,i.x),this.scrollViewCategories.scrollToOffset(cc.v2(o,0),.1),i=this.scrollViewCategories2.getScrollOffset(),o=Math.round(-i.x)+this.getOffsetX(this.portraitTileSize,i.x),this.scrollViewCategories2.scrollToOffset(cc.v2(o,0),.1)}},e.prototype.buttomLeft=function(t,e){var o;if(r.default.GetInstance().audioManager.playSfx(c.SFXKey.button_arrow),"elements"===e){this.scrollViewElements2.stopAutoScroll();var i=this.scrollViewElements2.getScrollOffset();o=Math.round(-i.x)-this.getOffsetX(this.portraitElementTileSize,i.x,!1),this.scrollViewElements2.scrollToOffset(cc.v2(o,0),.1)}else if("sticker"===e){(a=this.stickerContainer.parent.getComponent(cc.ScrollView)).stopAutoScroll();i=a.getScrollOffset();o=Math.round(-i.x)-this.getOffsetX(this.landscapeStickerSize,i.x,!1),a.scrollToOffset(cc.v2(o,0),.1)}else if("background"===e){var a;(a=this.backContainer2.parent.getComponent(cc.ScrollView)).stopAutoScroll();i=a.getScrollOffset();o=Math.round(-i.x)-this.getOffsetX(this.landscapeStickerSize,i.x),a.scrollToOffset(cc.v2(o,0),.1)}else{this.scrollViewCategories.stopAutoScroll();i=this.scrollViewCategories.getScrollOffset();o=Math.round(-i.x)-this.getOffsetX(this.landscapeTileSize,i.x,!1),this.scrollViewCategories.scrollToOffset(cc.v2(o,0),.1),i=this.scrollViewCategories2.getScrollOffset(),o=Math.round(-i.x)-this.getOffsetX(this.portraitTileSize,i.x,!1),this.scrollViewCategories2.scrollToOffset(cc.v2(o,0),.1)}},e.prototype.getOffsetX=function(t,e,o){var i;return void 0===o&&(o=!0),i=Math.round(-e),console.log("offset current: "+i),i=o?t-i%t:i%t==0?t:i%t,console.log("offset  move: "+i),i},e.prototype.exportImageSquare=function(){this.isGifEnabled?(this.currentBackgroundAnimation.resume(),this.exportManager.exportSquareGIF()):this.exportManager.exportSquare()},e.prototype.exportImageAlpha=function(){this.currentBackgroundAnimation.pause(),this.exportManager.exportSquareAlpha()},e.prototype.exportImageLandscape=function(){this.currentBackgroundAnimation.pause(),this.exportManager.exportLandscape()},e.prototype.eventScrollView=function(){if(this.lastPosC1.y=this.lastPosC1.x,this.lastPosC1.x=this.scrollViewCategories.getScrollOffset().x,this.lastPosC2.y=this.lastPosC2.x,this.lastPosC2.x=this.scrollViewCategories2.getScrollOffset().x,this.lastPosE2.y=this.lastPosE2.x,this.lastPosE2.x=this.scrollViewElements2.getScrollOffset().x,this.lastPosS1.y=this.lastPosS1.x,this.lastPosS1.x=this.stickerContainer.parent.getComponent(cc.ScrollView).getScrollOffset().x,this.lastPosS2.y=this.lastPosS2.x,this.lastPosS2.x=this.stickerContainer2.parent.getComponent(cc.ScrollView).getScrollOffset().x,this.lastPosB2.y=this.lastPosB2.x,this.lastPosB2.x=this.backContainer2.parent.getComponent(cc.ScrollView).getScrollOffset().x,this.buttomRightContent.active=!(-this.lastPosC1.x>=this.scrollViewCategories.getMaxScrollOffset().x-1),this.buttomLeftContent.active=-this.lastPosC1.x>1,this.buttomLeftContent2.active=-this.lastPosC2.x>1,this.buttomRightContent2.active=!(-this.lastPosC2.x>=this.scrollViewCategories2.getMaxScrollOffset().x-1),this.countItemsCategory>5&&(this.buttomRightElement.active=!(Math.round(-this.lastPosE2.x)>=this.scrollViewElements2.getMaxScrollOffset().x),this.buttomLeftElement.active=-this.lastPosE2.x>1),this.sticker1ButtomRight.active=-this.lastPosS1.x<=this.stickerContainer.parent.getComponent(cc.ScrollView).getMaxScrollOffset().x-1,this.sticker1ButtomLeft.active=-this.lastPosS1.x>1,this.sticker2ButtomRight.active=-this.lastPosS2.x<=this.stickerContainer2.parent.getComponent(cc.ScrollView).getMaxScrollOffset().x-1,this.sticker2ButtomLeft.active=-this.lastPosS2.x>1,this.background2ButtomRight.active=-this.lastPosB2.x<=this.backContainer2.parent.getComponent(cc.ScrollView).getMaxScrollOffset().x-1,this.background2ButtomLeft.active=-this.lastPosB2.x>1,Math.abs(Math.abs(this.lastPosC1.x)-Math.abs(this.lastPosC1.y))<1&&!this.scrollViewCategories.isScrolling()){var t=void 0,e=this.scrollViewCategories.getScrollOffset();Math.round(e.x)%this.landscapeTileSize!=0&&((t=this.getOffsetX(this.landscapeTileSize,e.x))>this.landscapeTileSize/2&&(t=-this.getOffsetX(this.landscapeTileSize,e.x,!1)),this.scrollViewCategories.scrollToOffset(cc.v2(-e.x+t,0),.1))}if(Math.abs(Math.abs(this.lastPosC2.x)-Math.abs(this.lastPosC2.y))<1&&!this.scrollViewCategories2.isScrolling()){t=void 0,e=this.scrollViewCategories2.getScrollOffset();Math.round(e.x)%this.portraitTileSize!=0&&((t=this.getOffsetX(this.portraitTileSize,e.x))>this.portraitTileSize/2&&(t=-this.getOffsetX(this.portraitTileSize,e.x,!1)),this.scrollViewCategories2.scrollToOffset(cc.v2(-e.x+t,0),.1))}if(Math.abs(Math.abs(this.lastPosE2.x)-Math.abs(this.lastPosE2.y))<1&&!this.scrollViewElements2.isScrolling()){t=void 0,e=this.scrollViewElements2.getScrollOffset();Math.round(e.x)%this.portraitElementTileSize!=0&&((t=this.getOffsetX(this.portraitElementTileSize,e.x))>this.portraitElementTileSize/2&&(t=-this.getOffsetX(this.portraitElementTileSize,e.x,!1)),this.scrollViewElements2.scrollToOffset(cc.v2(-e.x+t,0),.1))}if(Math.abs(Math.abs(this.lastPosS1.x)-Math.abs(this.lastPosS1.y))<1&&!this.stickerContainer.parent.getComponent(cc.ScrollView).isScrolling()){t=void 0,e=this.stickerContainer.parent.getComponent(cc.ScrollView).getScrollOffset();Math.round(e.x)%this.landscapeStickerSize!=0&&((t=this.getOffsetX(this.landscapeStickerSize,e.x))>this.landscapeStickerSize/2&&(t=-this.getOffsetX(this.landscapeStickerSize,e.x,!1)),this.stickerContainer.parent.getComponent(cc.ScrollView).scrollToOffset(cc.v2(-e.x+t,0),.1))}},e.prototype.selectPhotoMode=function(t){r.default.GetInstance().audioManager.playSfx(c.SFXKey.selection_item),this.setSelectPhoto(Number(t.target.name.split(" ")[1])),0===this.photoIndex&&this.showMessage(2),1===this.photoIndex&&this.showMessage(3),2===this.photoIndex&&this.showMessage(4)},e.prototype.setSelectPhoto=function(t){var e=this;this.photoIndex=t;var o=0;this.photoContainer.getChildByName("photo_download_portrait").getChildByName("container").children.forEach(function(t){t.color=o===e.photoIndex?e.selectColor:cc.Color.WHITE,o+=1}),o=0,this.photoContainer.getChildByName("photo_download_landscape").getChildByName("container").children.forEach(function(t){t.color=o===e.photoIndex?e.selectColor:cc.Color.WHITE,o+=1}),0===this.photoIndex&&(this.currentBackgroundAnimation.resume(),this.background.children[1].active=!0,this.spriteBackgroundUI.spriteFrame=this.bg),1===this.photoIndex&&(this.currentBackgroundAnimation.pause(),this.background.children[1].active=!0,this.spriteBackgroundUI.spriteFrame=this.bgBlur),2===this.photoIndex&&(this.background.children[1].active=!1,this.spriteBackgroundUI.spriteFrame=this.bg)},e.prototype.download=function(){switch(r.default.GetInstance().audioManager.playSfx(c.SFXKey.button_download),this.exportManager.setPrefabBackground(this.backgroundPrefab[this.currentBackGroundSelect]),this.photoIndex){case 0:this.exportImageSquare();break;case 1:this.exportImageLandscape();break;case 2:this.exportImageAlpha()}},__decorate([u(cc.Node)],e.prototype,"scrollViewElements",void 0),__decorate([u(cc.ScrollView)],e.prototype,"scrollViewCategories",void 0),__decorate([u(cc.ScrollView)],e.prototype,"scrollViewElements2",void 0),__decorate([u(cc.ScrollView)],e.prototype,"scrollViewCategories2",void 0),__decorate([u(s.default)],e.prototype,"avatarManager",void 0),__decorate([u(cc.SpriteAtlas)],e.prototype,"icons",void 0),__decorate([u(cc.SpriteAtlas)],e.prototype,"icons2",void 0),__decorate([u(cc.Node)],e.prototype,"nextButtom",void 0),__decorate([u(cc.Node)],e.prototype,"backButtom",void 0),__decorate([u(cc.Node)],e.prototype,"bodyContainer",void 0),__decorate([u(cc.Node)],e.prototype,"categoriesContainer",void 0),__decorate([u(cc.Node)],e.prototype,"messageNode",void 0),__decorate([u(cc.Node)],e.prototype,"colorBar",void 0),__decorate([u(cc.Node)],e.prototype,"colorBar2",void 0),__decorate([u(cc.Node)],e.prototype,"background",void 0),__decorate([u(cc.Node)],e.prototype,"extrasContainers",void 0),__decorate([u(cc.Node)],e.prototype,"backContainer",void 0),__decorate([u(cc.Node)],e.prototype,"backContainer2",void 0),__decorate([u(cc.Node)],e.prototype,"extrasSelection",void 0),__decorate([u(cc.Node)],e.prototype,"extrasSelection2",void 0),__decorate([u(cc.Node)],e.prototype,"stickerContainer",void 0),__decorate([u(cc.Node)],e.prototype,"stickerContainer2",void 0),__decorate([u(cc.Node)],e.prototype,"stickers",void 0),__decorate([u(cc.Node)],e.prototype,"photoDownload",void 0),__decorate([u(cc.Animation)],e.prototype,"buttonGifAnimation",void 0),__decorate([u([cc.Prefab])],e.prototype,"backgroundPrefab",void 0),__decorate([u(l.default)],e.prototype,"exportManager",void 0),__decorate([u(cc.Node)],e.prototype,"preview",void 0),__decorate([u(cc.Node)],e.prototype,"trashButtom",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"frameNextLandscape",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"frameBackLandscape",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"frameRetryLandscape",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"frameNextPortrait",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"frameBackPortrait",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"frameRetryPortrait",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"frameContainer",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"frameContainerMiddle",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"frameContainerSmall",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"bg",void 0),__decorate([u(cc.SpriteFrame)],e.prototype,"bgBlur",void 0),__decorate([u(cc.Node)],e.prototype,"photoContainer",void 0),__decorate([u(cc.Node)],e.prototype,"arrowNextCategory",void 0),__decorate([u(cc.Node)],e.prototype,"arrowNextCategory2",void 0),__decorate([u(cc.Float)],e.prototype,"delayAnimationHint",void 0),__decorate([u(cc.Float)],e.prototype,"delayArrows",void 0),__decorate([u(cc.Float)],e.prototype,"delayInit",void 0),e=__decorate([p],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../Utils/Utils":"Utils","./Audio/AudioScene":"AudioScene","./EnumCategory":"EnumCategory","./Manager/AvatarManager":"AvatarManager","./Manager/ExportManager":"ExportManager","./Manager/UIElementsManager":"UIElementsManager","./Singleton":"Singleton"}],Utils:[function(t,e,o){"use strict";cc._RF.push(e,"fcf29pmuD1DoaqynyV30Ofd","Utils"),Object.defineProperty(o,"__esModule",{value:!0}),o.isMobile=function(){return(cc.sys.isMobile||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!window.MSStream},cc._RF.pop()},{}]},{},["AudioButton","AudioManager","AudioScene","ButtonHoverScale","ColorList","BootController","MainmenuController","EnumCategory","FixShader","ExposedLocalizationImage","ExposedLocalizationText","LocalizationAsset","LocalizationConfig","LocalizationImage","LocalizationImageComponent","LocalizationItem","LocalizationManager","LocalizationText","LocalizationTextComponent","AvatarManager","CanvasResolutionManager","ExportManager","FocusScreenManager","ResizeScreenManager","RotateScreenManager","UIElementsManager","ModifyWidget","Orientation","Scalable","ShownHide","Singleton","UIManager","Utils"]);