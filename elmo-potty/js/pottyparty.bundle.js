!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){(function(n){var i,o,r;o=[],void 0===(r="function"==typeof(i=function(){"use strict";function e(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){a(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function i(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function o(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,a=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype?function(t,n,a){var s=r.URL||r.webkitURL,c=document.createElement("a");n=n||t.name||"download",c.download=n,c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?o(c):i(c.href)?e(t,n,a):o(c,c.target="_blank")):(c.href=s.createObjectURL(t),setTimeout(function(){s.revokeObjectURL(c.href)},4e4),setTimeout(function(){o(c)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,r){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,r),n);else if(i(t))e(t,n,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout(function(){o(a)})}}:function(t,n,i,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,i);var a="application/octet-stream"===t.type,s=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||a&&s)&&"object"==typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},u.readAsDataURL(t)}else{var l=r.URL||r.webkitURL,h=l.createObjectURL(t);o?o.location=h:location.href=h,o=null,setTimeout(function(){l.revokeObjectURL(h)},4e4)}});r.saveAs=a.saveAs=a,t.exports=a})?i.apply(e,o):i)||(t.exports=r)}).call(this,n(1))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e);var i={};function o(t,e){return t(e={exports:{}},e.exports),e.exports}n.r(i),n.d(i,"exists",function(){return os}),n.d(i,"get",function(){return rs}),n.d(i,"getElse",function(){return as}),n.d(i,"getAssert",function(){return ss});var r=o(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),a=o(function(t){var e=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=e)}),s=(a.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),c=function(t){if(!s(t))throw TypeError(t+" is not an object!");return t},u=function(t){try{return!!t()}catch(t){return!0}},l=!u(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),h=r.document,f=s(h)&&s(h.createElement),p=function(t){return f?h.createElement(t):{}},y=!l&&!u(function(){return 7!=Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a}),d=function(t,e){if(!s(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!s(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!s(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!s(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")},v=Object.defineProperty,m={f:l?Object.defineProperty:function(t,e,n){if(c(t),e=d(e,!0),c(n),y)try{return v(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},g=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},b=l?function(t,e,n){return m.f(t,e,g(1,n))}:function(t,e,n){return t[e]=n,t},w={}.hasOwnProperty,k=function(t,e){return w.call(t,e)},O=0,S=Math.random(),P=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++O+S).toString(36))},C=o(function(t){var e=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(t.exports=function(t,n){return e[t]||(e[t]=void 0!==n?n:{})})("versions",[]).push({version:a.version,mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})}),_=C("native-function-to-string",Function.toString),x=o(function(t){var e=P("src"),n=(""+_).split("toString");a.inspectSource=function(t){return _.call(t)},(t.exports=function(t,i,o,a){var s="function"==typeof o;s&&(k(o,"name")||b(o,"name",i)),t[i]!==o&&(s&&(k(o,e)||b(o,e,t[i]?""+t[i]:n.join(String(i)))),t===r?t[i]=o:a?t[i]?t[i]=o:b(t,i,o):(delete t[i],b(t,i,o)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[e]||_.call(this)})}),j=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},E=function(t,e,n){if(j(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,o){return t.call(e,n,i,o)}}return function(){return t.apply(e,arguments)}},T=function(t,e,n){var i,o,s,c,u=t&T.F,l=t&T.G,h=t&T.S,f=t&T.P,p=t&T.B,y=l?r:h?r[e]||(r[e]={}):(r[e]||{}).prototype,d=l?a:a[e]||(a[e]={}),v=d.prototype||(d.prototype={});for(i in l&&(n=e),n)s=((o=!u&&y&&void 0!==y[i])?y:n)[i],c=p&&o?E(s,r):f&&"function"==typeof s?E(Function.call,s):s,y&&x(y,i,s,t&T.U),d[i]!=s&&b(d,i,c),f&&v[i]!=s&&(v[i]=s)};r.core=a,T.F=1,T.G=2,T.S=4,T.P=8,T.B=16,T.W=32,T.U=64,T.R=128;var A=T,R=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},I=function(t){return Object(R(t))},F=Math.ceil,L=Math.floor,M=function(t){return isNaN(t=+t)?0:(t>0?L:F)(t)},D=Math.max,N=Math.min,K=function(t,e){return(t=M(t))<0?D(t+e,0):N(t,e)},B=Math.min,V=function(t){return t>0?B(M(t),9007199254740991):0},z=[].copyWithin||function(t,e){var n=I(this),i=V(n.length),o=K(t,i),r=K(e,i),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?i:K(a,i))-r,i-o),c=1;for(r<o&&o<r+s&&(c=-1,r+=s-1,o+=s-1);s-- >0;)r in n?n[o]=n[r]:delete n[o],o+=c,r+=c;return n},U=o(function(t){var e=C("wks"),n=r.Symbol,i="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=i&&n[t]||(i?n:P)("Symbol."+t))}).store=e}),G=U("unscopables"),H=Array.prototype;null==H[G]&&b(H,G,{});var W=function(t){H[G][t]=!0};A(A.P,"Array",{copyWithin:z}),W("copyWithin");var q=function(t){for(var e=I(this),n=V(e.length),i=arguments.length,o=K(i>1?arguments[1]:void 0,n),r=i>2?arguments[2]:void 0,a=void 0===r?n:K(r,n);a>o;)e[o++]=t;return e};A(A.P,"Array",{fill:q}),W("fill");var X={}.toString,Y=function(t){return X.call(t).slice(8,-1)},J=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==Y(t)?t.split(""):Object(t)},Q=Array.isArray||function(t){return"Array"==Y(t)},$=U("species"),Z=function(t,e){return new(function(t){var e;return Q(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!Q(e.prototype)||(e=void 0),s(e)&&null===(e=e[$])&&(e=void 0)),void 0===e?Array:e}(t))(e)},tt=function(t,e){var n=1==t,i=2==t,o=3==t,r=4==t,a=6==t,s=5==t||a,c=e||Z;return function(e,u,l){for(var h,f,p=I(e),y=J(p),d=E(u,l,3),v=V(y.length),m=0,g=n?c(e,v):i?c(e,0):void 0;v>m;m++)if((s||m in y)&&(f=d(h=y[m],m,p),t))if(n)g[m]=f;else if(f)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:g.push(h)}else if(r)return!1;return a?-1:o||r?r:g}},et=tt(5),nt=!0;"find"in[]&&Array(1).find(function(){nt=!1}),A(A.P+A.F*nt,"Array",{find:function(t){return et(this,t,arguments.length>1?arguments[1]:void 0)}}),W("find");var it=tt(6),ot=!0;"findIndex"in[]&&Array(1).findIndex(function(){ot=!1}),A(A.P+A.F*ot,"Array",{findIndex:function(t){return it(this,t,arguments.length>1?arguments[1]:void 0)}}),W("findIndex");var rt=U("isConcatSpreadable");var at=function t(e,n,i,o,r,a,c,u){for(var l,h,f=r,p=0,y=!!c&&E(c,u,3);p<o;){if(p in i){if(l=y?y(i[p],p,n):i[p],h=!1,s(l)&&(h=void 0!==(h=l[rt])?!!h:Q(l)),h&&a>0)f=t(e,n,l,V(l.length),f,a-1)-1;else{if(f>=9007199254740991)throw TypeError();e[f]=l}f++}p++}return f};A(A.P,"Array",{flatMap:function(t){var e,n,i=I(this);return j(t),e=V(i.length),n=Z(i,0),at(n,i,i,e,0,1,t,arguments[1]),n}}),W("flatMap");var st=function(t,e,n,i){try{return i?e(c(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&c(o.call(t)),e}},ct={},ut=U("iterator"),lt=Array.prototype,ht=function(t){return void 0!==t&&(ct.Array===t||lt[ut]===t)},ft=function(t,e,n){e in t?m.f(t,e,g(0,n)):t[e]=n},pt=U("toStringTag"),yt="Arguments"==Y(function(){return arguments}()),dt=function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),pt))?n:yt?Y(e):"Object"==(i=Y(e))&&"function"==typeof e.callee?"Arguments":i},vt=U("iterator"),mt=a.getIteratorMethod=function(t){if(null!=t)return t[vt]||t["@@iterator"]||ct[dt(t)]},gt=U("iterator"),bt=!1;try{[7][gt]().return=function(){bt=!0}}catch(t){}var wt=function(t,e){if(!e&&!bt)return!1;var n=!1;try{var i=[7],o=i[gt]();o.next=function(){return{done:n=!0}},i[gt]=function(){return o},t(i)}catch(t){}return n};A(A.S+A.F*!wt(function(t){}),"Array",{from:function(t){var e,n,i,o,r=I(t),a="function"==typeof this?this:Array,s=arguments.length,c=s>1?arguments[1]:void 0,u=void 0!==c,l=0,h=mt(r);if(u&&(c=E(c,s>2?arguments[2]:void 0,2)),null==h||a==Array&&ht(h))for(n=new a(e=V(r.length));e>l;l++)ft(n,l,u?c(r[l],l):r[l]);else for(o=h.call(r),n=new a;!(i=o.next()).done;l++)ft(n,l,u?st(o,c,[i.value,l],!0):i.value);return n.length=l,n}});var kt=function(t){return J(R(t))},Ot=function(t){return function(e,n,i){var o,r=kt(e),a=V(r.length),s=K(i,a);if(t&&n!=n){for(;a>s;)if((o=r[s++])!=o)return!0}else for(;a>s;s++)if((t||s in r)&&r[s]===n)return t||s||0;return!t&&-1}},St=Ot(!0);A(A.P,"Array",{includes:function(t){return St(this,t,arguments.length>1?arguments[1]:void 0)}}),W("includes");var Pt=function(t,e){return{value:e,done:!!t}},Ct=C("keys"),_t=function(t){return Ct[t]||(Ct[t]=P(t))},xt=Ot(!1),jt=_t("IE_PROTO"),Et=function(t,e){var n,i=kt(t),o=0,r=[];for(n in i)n!=jt&&k(i,n)&&r.push(n);for(;e.length>o;)k(i,n=e[o++])&&(~xt(r,n)||r.push(n));return r},Tt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),At=Object.keys||function(t){return Et(t,Tt)},Rt=l?Object.defineProperties:function(t,e){c(t);for(var n,i=At(e),o=i.length,r=0;o>r;)m.f(t,n=i[r++],e[n]);return t},It=r.document,Ft=It&&It.documentElement,Lt=_t("IE_PROTO"),Mt=function(){},Dt=function(){var t,e=p("iframe"),n=Tt.length;for(e.style.display="none",Ft.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),Dt=t.F;n--;)delete Dt.prototype[Tt[n]];return Dt()},Nt=Object.create||function(t,e){var n;return null!==t?(Mt.prototype=c(t),n=new Mt,Mt.prototype=null,n[Lt]=t):n=Dt(),void 0===e?n:Rt(n,e)},Kt=m.f,Bt=U("toStringTag"),Vt=function(t,e,n){t&&!k(t=n?t:t.prototype,Bt)&&Kt(t,Bt,{configurable:!0,value:e})},zt={};b(zt,U("iterator"),function(){return this});var Ut=_t("IE_PROTO"),Gt=Object.prototype,Ht=Object.getPrototypeOf||function(t){return t=I(t),k(t,Ut)?t[Ut]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Gt:null},Wt=U("iterator"),qt=!([].keys&&"next"in[].keys()),Xt=function(){return this},Yt=function(t,e,n,i,o,r,a){!function(t,e,n){t.prototype=Nt(zt,{next:g(1,n)}),Vt(t,e+" Iterator")}(n,e,i);var s,c,u,l=function(t){if(!qt&&t in y)return y[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},h=e+" Iterator",f="values"==o,p=!1,y=t.prototype,d=y[Wt]||y["@@iterator"]||o&&y[o],v=d||l(o),m=o?f?l("entries"):v:void 0,w="Array"==e&&y.entries||d;if(w&&(u=Ht(w.call(new t)))!==Object.prototype&&u.next&&(Vt(u,h,!0),"function"==typeof u[Wt]||b(u,Wt,Xt)),f&&d&&"values"!==d.name&&(p=!0,v=function(){return d.call(this)}),!qt&&!p&&y[Wt]||b(y,Wt,v),ct[e]=v,ct[h]=Xt,o)if(s={values:f?v:l("values"),keys:r?v:l("keys"),entries:m},a)for(c in s)c in y||x(y,c,s[c]);else A(A.P+A.F*(qt||p),e,s);return s},Jt=Yt(Array,"Array",function(t,e){this._t=kt(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,Pt(1)):Pt(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");ct.Arguments=ct.Array,W("keys"),W("values"),W("entries"),A(A.S+A.F*u(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)ft(n,t,arguments[t++]);return n.length=e,n}});var Qt=U("species"),$t=function(t){var e=r[t];l&&e&&!e[Qt]&&m.f(e,Qt,{configurable:!0,get:function(){return this}})};$t("Array");var Zt=U("toPrimitive"),te=Date.prototype;Zt in te||b(te,Zt,function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return d(c(this),"number"!=t)});var ee=U("hasInstance"),ne=Function.prototype;ee in ne||m.f(ne,ee,{value:function(t){if("function"!=typeof this||!s(t))return!1;if(!s(this.prototype))return t instanceof this;for(;t=Ht(t);)if(this.prototype===t)return!0;return!1}});var ie=m.f,oe=Function.prototype,re=/^\s*function ([^ (]*)/;"name"in oe||l&&ie(oe,"name",{configurable:!0,get:function(){try{return(""+this).match(re)[1]}catch(t){return""}}});var ae=function(t,e,n){for(var i in e)x(t,i,e[i],n);return t},se=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t},ce=o(function(t){var e={},n={},i=t.exports=function(t,i,o,r,a){var s,u,l,h,f=a?function(){return t}:mt(t),p=E(o,r,i?2:1),y=0;if("function"!=typeof f)throw TypeError(t+" is not iterable!");if(ht(f)){for(s=V(t.length);s>y;y++)if((h=i?p(c(u=t[y])[0],u[1]):p(t[y]))===e||h===n)return h}else for(l=f.call(t);!(u=l.next()).done;)if((h=st(l,p,u.value,i))===e||h===n)return h};i.BREAK=e,i.RETURN=n}),ue=o(function(t){var e=P("meta"),n=m.f,i=0,o=Object.isExtensible||function(){return!0},r=!u(function(){return o(Object.preventExtensions({}))}),a=function(t){n(t,e,{value:{i:"O"+ ++i,w:{}}})},c=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!k(t,e)){if(!o(t))return"F";if(!n)return"E";a(t)}return t[e].i},getWeak:function(t,n){if(!k(t,e)){if(!o(t))return!0;if(!n)return!1;a(t)}return t[e].w},onFreeze:function(t){return r&&c.NEED&&o(t)&&!k(t,e)&&a(t),t}}}),le=(ue.KEY,ue.NEED,ue.fastKey,ue.getWeak,ue.onFreeze,function(t,e){if(!s(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}),he=m.f,fe=ue.fastKey,pe=l?"_s":"size",ye=function(t,e){var n,i=fe(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n},de={getConstructor:function(t,e,n,i){var o=t(function(t,r){se(t,o,e,"_i"),t._t=e,t._i=Nt(null),t._f=void 0,t._l=void 0,t[pe]=0,null!=r&&ce(r,n,t[i],t)});return ae(o.prototype,{clear:function(){for(var t=le(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[pe]=0},delete:function(t){var n=le(this,e),i=ye(n,t);if(i){var o=i.n,r=i.p;delete n._i[i.i],i.r=!0,r&&(r.n=o),o&&(o.p=r),n._f==i&&(n._f=o),n._l==i&&(n._l=r),n[pe]--}return!!i},forEach:function(t){le(this,e);for(var n,i=E(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!ye(le(this,e),t)}}),l&&he(o.prototype,"size",{get:function(){return le(this,e)[pe]}}),o},def:function(t,e,n){var i,o,r=ye(t,e);return r?r.v=n:(t._l=r={i:o=fe(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=r),i&&(i.n=r),t[pe]++,"F"!==o&&(t._i[o]=r)),t},getEntry:ye,setStrong:function(t,e,n){Yt(t,e,function(t,n){this._t=le(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?Pt(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,Pt(1))},n?"entries":"values",!n,!0),$t(e)}},ve={f:{}.propertyIsEnumerable},me=Object.getOwnPropertyDescriptor,ge={f:l?me:function(t,e){if(t=kt(t),e=d(e,!0),y)try{return me(t,e)}catch(t){}if(k(t,e))return g(!ve.f.call(t,e),t[e])}},be=function(t,e){if(c(t),!s(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},we={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=E(Function.call,ge.f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return be(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:be},ke=we.set,Oe=function(t,e,n){var i,o=e.constructor;return o!==n&&"function"==typeof o&&(i=o.prototype)!==n.prototype&&s(i)&&ke&&ke(t,i),t},Se=function(t,e,n,i,o,a){var c=r[t],l=c,h=o?"set":"add",f=l&&l.prototype,p={},y=function(t){var e=f[t];x(f,t,"delete"==t?function(t){return!(a&&!s(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(a&&!s(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return a&&!s(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof l&&(a||f.forEach&&!u(function(){(new l).entries().next()}))){var d=new l,v=d[h](a?{}:-0,1)!=d,m=u(function(){d.has(1)}),g=wt(function(t){new l(t)}),b=!a&&u(function(){for(var t=new l,e=5;e--;)t[h](e,e);return!t.has(-0)});g||((l=e(function(e,n){se(e,l,t);var i=Oe(new c,e,l);return null!=n&&ce(n,o,i[h],i),i})).prototype=f,f.constructor=l),(m||b)&&(y("delete"),y("has"),o&&y("get")),(b||v)&&y(h),a&&f.clear&&delete f.clear}else l=i.getConstructor(e,t,o,h),ae(l.prototype,n),ue.NEED=!0;return Vt(l,t),p[t]=l,A(A.G+A.W+A.F*(l!=c),p),a||i.setStrong(l,t,o),l},Pe=(Se("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=de.getEntry(le(this,"Map"),t);return e&&e.v},set:function(t,e){return de.def(le(this,"Map"),0===t?0:t,e)}},de,!0),Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}),Ce=Math.sqrt,_e=Math.acosh;A(A.S+A.F*!(_e&&710==Math.floor(_e(Number.MAX_VALUE))&&_e(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:Pe(t-1+Ce(t-1)*Ce(t+1))}});var xe=Math.asinh;A(A.S+A.F*!(xe&&1/xe(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}});var je=Math.atanh;A(A.S+A.F*!(je&&1/je(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}});var Ee=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1};A(A.S,"Math",{cbrt:function(t){return Ee(t=+t)*Math.pow(Math.abs(t),1/3)}}),A(A.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}});var Te=Math.exp;A(A.S,"Math",{cosh:function(t){return(Te(t=+t)+Te(-t))/2}});var Ae=Math.expm1,Re=!Ae||Ae(10)>22025.465794806718||Ae(10)<22025.465794806718||-2e-17!=Ae(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:Ae;A(A.S+A.F*(Re!=Math.expm1),"Math",{expm1:Re});var Ie=Math.pow,Fe=Ie(2,-52),Le=Ie(2,-23),Me=Ie(2,127)*(2-Le),De=Ie(2,-126),Ne=Math.fround||function(t){var e,n,i=Math.abs(t),o=Ee(t);return i<De?o*function(t){return t+1/Fe-1/Fe}(i/De/Le)*De*Le:(n=(e=(1+Le/Fe)*i)-(e-i))>Me||n!=n?o*(1/0):o*n};A(A.S,"Math",{fround:Ne});var Ke=Math.abs;A(A.S,"Math",{hypot:function(t,e){for(var n,i,o=0,r=0,a=arguments.length,s=0;r<a;)s<(n=Ke(arguments[r++]))?(o=o*(i=s/n)*i+1,s=n):o+=n>0?(i=n/s)*i:n;return s===1/0?1/0:s*Math.sqrt(o)}});var Be=Math.imul;A(A.S+A.F*u(function(){return-5!=Be(4294967295,5)||2!=Be.length}),"Math",{imul:function(t,e){var n=+t,i=+e,o=65535&n,r=65535&i;return 0|o*r+((65535&n>>>16)*r+o*(65535&i>>>16)<<16>>>0)}}),A(A.S,"Math",{log1p:Pe}),A(A.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}}),A(A.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}}),A(A.S,"Math",{sign:Ee});var Ve=Math.exp;A(A.S+A.F*u(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(Re(t)-Re(-t))/2:(Ve(t-1)-Ve(-t-1))*(Math.E/2)}});var ze=Math.exp;A(A.S,"Math",{tanh:function(t){var e=Re(t=+t),n=Re(-t);return e==1/0?1:n==1/0?-1:(e-n)/(ze(t)+ze(-t))}}),A(A.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}});var Ue=Tt.concat("length","prototype"),Ge={f:Object.getOwnPropertyNames||function(t){return Et(t,Ue)}},He="\t\n\v\f\r Â áá ââââââââââââ¯âã\u2028\u2029\ufeff",We="["+He+"]",qe=RegExp("^"+We+We+"*"),Xe=RegExp(We+We+"*$"),Ye=function(t,e,n){var i={},o=u(function(){return!!He[t]()||"âÂ"!="âÂ"[t]()}),r=i[t]=o?e(Je):He[t];n&&(i[n]=r),A(A.P+A.F*o,"String",i)},Je=Ye.trim=function(t,e){return t=String(R(t)),1&e&&(t=t.replace(qe,"")),2&e&&(t=t.replace(Xe,"")),t},Qe=Ye,$e=Ge.f,Ze=ge.f,tn=m.f,en=Qe.trim,nn=r.Number,on=nn,rn=nn.prototype,an="Number"==Y(Nt(rn)),sn="trim"in String.prototype,cn=function(t){var e=d(t,!1);if("string"==typeof e&&e.length>2){var n,i,o,r=(e=sn?e.trim():en(e,3)).charCodeAt(0);if(43===r||45===r){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+e}for(var a,s=e.slice(2),c=0,u=s.length;c<u;c++)if((a=s.charCodeAt(c))<48||a>o)return NaN;return parseInt(s,i)}}return+e};if(!nn(" 0o1")||!nn("0b1")||nn("+0x1")){nn=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof nn&&(an?u(function(){rn.valueOf.call(n)}):"Number"!=Y(n))?Oe(new on(cn(e)),n,nn):cn(e)};for(var un,ln=l?$e(on):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),hn=0;ln.length>hn;hn++)k(on,un=ln[hn])&&!k(nn,un)&&tn(nn,un,Ze(on,un));nn.prototype=rn,rn.constructor=nn,x(r,"Number",nn)}A(A.S,"Number",{EPSILON:Math.pow(2,-52)});var fn=r.isFinite;A(A.S,"Number",{isFinite:function(t){return"number"==typeof t&&fn(t)}});var pn=Math.floor,yn=function(t){return!s(t)&&isFinite(t)&&pn(t)===t};A(A.S,"Number",{isInteger:yn}),A(A.S,"Number",{isNaN:function(t){return t!=t}});var dn=Math.abs;A(A.S,"Number",{isSafeInteger:function(t){return yn(t)&&dn(t)<=9007199254740991}}),A(A.S,"Number",{MAX_SAFE_INTEGER:9007199254740991}),A(A.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991});var vn=r.parseFloat,mn=Qe.trim,gn=1/vn(He+"-0")!=-1/0?function(t){var e=mn(String(t),3),n=vn(e);return 0===n&&"-"==e.charAt(0)?-0:n}:vn;A(A.S+A.F*(Number.parseFloat!=gn),"Number",{parseFloat:gn});var bn=r.parseInt,wn=Qe.trim,kn=/^[-+]?0[xX]/,On=8!==bn(He+"08")||22!==bn(He+"0x16")?function(t,e){var n=wn(String(t),3);return bn(n,e>>>0||(kn.test(n)?16:10))}:bn;A(A.S+A.F*(Number.parseInt!=On),"Number",{parseInt:On});var Sn={f:Object.getOwnPropertySymbols},Pn=Object.assign,Cn=!Pn||u(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=Pn({},t)[n]||Object.keys(Pn({},e)).join("")!=i})?function(t,e){for(var n=I(t),i=arguments.length,o=1,r=Sn.f,a=ve.f;i>o;)for(var s,c=J(arguments[o++]),u=r?At(c).concat(r(c)):At(c),l=u.length,h=0;l>h;)a.call(c,s=u[h++])&&(n[s]=c[s]);return n}:Pn;A(A.S+A.F,"Object",{assign:Cn});var _n=!u(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r[t]});l&&A(A.P+_n,"Object",{__defineGetter__:function(t,e){m.f(I(this),t,{get:j(e),enumerable:!0,configurable:!0})}}),l&&A(A.P+_n,"Object",{__defineSetter__:function(t,e){m.f(I(this),t,{set:j(e),enumerable:!0,configurable:!0})}});var xn=ve.f,jn=function(t){return function(e){for(var n,i=kt(e),o=At(i),r=o.length,a=0,s=[];r>a;)xn.call(i,n=o[a++])&&s.push(t?[n,i[n]]:i[n]);return s}},En=jn(!0);A(A.S,"Object",{entries:function(t){return En(t)}});var Tn=function(t,e){var n=(a.Object||{})[t]||Object[t],i={};i[t]=e(n),A(A.S+A.F*u(function(){n(1)}),"Object",i)},An=ue.onFreeze;Tn("freeze",function(t){return function(e){return t&&s(e)?t(An(e)):e}});var Rn=ge.f;Tn("getOwnPropertyDescriptor",function(){return function(t,e){return Rn(kt(t),e)}});var In=r.Reflect,Fn=In&&In.ownKeys||function(t){var e=Ge.f(c(t)),n=Sn.f;return n?e.concat(n(t)):e};A(A.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,i=kt(t),o=ge.f,r=Fn(i),a={},s=0;r.length>s;)void 0!==(n=o(i,e=r[s++]))&&ft(a,e,n);return a}});var Ln=Ge.f,Mn={}.toString,Dn="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Nn={f:function(t){return Dn&&"[object Window]"==Mn.call(t)?function(t){try{return Ln(t)}catch(t){return Dn.slice()}}(t):Ln(kt(t))}};Tn("getOwnPropertyNames",function(){return Nn.f}),Tn("getPrototypeOf",function(){return function(t){return Ht(I(t))}});var Kn=ge.f;l&&A(A.P+_n,"Object",{__lookupGetter__:function(t){var e,n=I(this),i=d(t,!0);do{if(e=Kn(n,i))return e.get}while(n=Ht(n))}});var Bn=ge.f;l&&A(A.P+_n,"Object",{__lookupSetter__:function(t){var e,n=I(this),i=d(t,!0);do{if(e=Bn(n,i))return e.set}while(n=Ht(n))}});var Vn=ue.onFreeze;Tn("preventExtensions",function(t){return function(e){return t&&s(e)?t(Vn(e)):e}});var zn={};zn[U("toStringTag")]="z",zn+""!="[object z]"&&x(Object.prototype,"toString",function(){return"[object "+dt(this)+"]"},!0);var Un=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e};A(A.S,"Object",{is:Un}),Tn("isFrozen",function(t){return function(e){return!s(e)||!!t&&t(e)}}),Tn("isSealed",function(t){return function(e){return!s(e)||!!t&&t(e)}}),Tn("isExtensible",function(t){return function(e){return!!s(e)&&(!t||t(e))}}),Tn("keys",function(){return function(t){return At(I(t))}});var Gn=ue.onFreeze;Tn("seal",function(t){return function(e){return t&&s(e)?t(Gn(e)):e}});var Hn=jn(!1);A(A.S,"Object",{values:function(t){return Hn(t)}});var Wn,qn,Xn,Yn=U("species"),Jn=function(t,e){var n,i=c(t).constructor;return void 0===i||null==(n=c(i)[Yn])?e:j(n)},Qn=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)},$n=r.process,Zn=r.setImmediate,ti=r.clearImmediate,ei=r.MessageChannel,ni=r.Dispatch,ii=0,oi={},ri=function(){var t=+this;if(oi.hasOwnProperty(t)){var e=oi[t];delete oi[t],e()}},ai=function(t){ri.call(t.data)};Zn&&ti||(Zn=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return oi[++ii]=function(){Qn("function"==typeof t?t:Function(t),e)},Wn(ii),ii},ti=function(t){delete oi[t]},"process"==Y($n)?Wn=function(t){$n.nextTick(E(ri,t,1))}:ni&&ni.now?Wn=function(t){ni.now(E(ri,t,1))}:ei?(Xn=(qn=new ei).port2,qn.port1.onmessage=ai,Wn=E(Xn.postMessage,Xn,1)):r.addEventListener&&"function"==typeof postMessage&&!r.importScripts?(Wn=function(t){r.postMessage(t+"","*")},r.addEventListener("message",ai,!1)):Wn="onreadystatechange"in p("script")?function(t){Ft.appendChild(p("script")).onreadystatechange=function(){Ft.removeChild(this),ri.call(t)}}:function(t){setTimeout(E(ri,t,1),0)});var si={set:Zn,clear:ti},ci=si.set,ui=r.MutationObserver||r.WebKitMutationObserver,li=r.process,hi=r.Promise,fi="process"==Y(li);function pi(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=j(e),this.reject=j(n)}var yi,di,vi,mi,gi={f:function(t){return new pi(t)}},bi=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},wi=r.navigator,ki=wi&&wi.userAgent||"",Oi=function(t,e){if(c(t),s(e)&&e.constructor===t)return e;var n=gi.f(t);return(0,n.resolve)(e),n.promise},Si=si.set,Pi=function(){var t,e,n,i=function(){var i,o;for(fi&&(i=li.domain)&&i.exit();t;){o=t.fn,t=t.next;try{o()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(fi)n=function(){li.nextTick(i)};else if(!ui||r.navigator&&r.navigator.standalone)if(hi&&hi.resolve){var o=hi.resolve(void 0);n=function(){o.then(i)}}else n=function(){ci.call(r,i)};else{var a=!0,s=document.createTextNode("");new ui(i).observe(s,{characterData:!0}),n=function(){s.data=a=!a}}return function(i){var o={fn:i,next:void 0};e&&(e.next=o),t||(t=o,n()),e=o}}(),Ci=r.TypeError,_i=r.process,xi=_i&&_i.versions,ji=xi&&xi.v8||"",Ei=r.Promise,Ti="process"==dt(_i),Ai=function(){},Ri=di=gi.f,Ii=!!function(){try{var t=Ei.resolve(1),e=(t.constructor={})[U("species")]=function(t){t(Ai,Ai)};return(Ti||"function"==typeof PromiseRejectionEvent)&&t.then(Ai)instanceof e&&0!==ji.indexOf("6.6")&&-1===ki.indexOf("Chrome/66")}catch(t){}}(),Fi=function(t){var e;return!(!s(t)||"function"!=typeof(e=t.then))&&e},Li=function(t,e){if(!t._n){t._n=!0;var n=t._c;Pi(function(){for(var i=t._v,o=1==t._s,r=0,a=function(e){var n,r,a,s=o?e.ok:e.fail,c=e.resolve,u=e.reject,l=e.domain;try{s?(o||(2==t._h&&Ni(t),t._h=1),!0===s?n=i:(l&&l.enter(),n=s(i),l&&(l.exit(),a=!0)),n===e.promise?u(Ci("Promise-chain cycle")):(r=Fi(n))?r.call(n,c,u):c(n)):u(i)}catch(t){l&&!a&&l.exit(),u(t)}};n.length>r;)a(n[r++]);t._c=[],t._n=!1,e&&!t._h&&Mi(t)})}},Mi=function(t){Si.call(r,function(){var e,n,i,o=t._v,a=Di(t);if(a&&(e=bi(function(){Ti?_i.emit("unhandledRejection",o,t):(n=r.onunhandledrejection)?n({promise:t,reason:o}):(i=r.console)&&i.error&&i.error("Unhandled promise rejection",o)}),t._h=Ti||Di(t)?2:1),t._a=void 0,a&&e.e)throw e.v})},Di=function(t){return 1!==t._h&&0===(t._a||t._c).length},Ni=function(t){Si.call(r,function(){var e;Ti?_i.emit("rejectionHandled",t):(e=r.onrejectionhandled)&&e({promise:t,reason:t._v})})},Ki=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),Li(e,!0))},Bi=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw Ci("Promise can't be resolved itself");(e=Fi(t))?Pi(function(){var i={_w:n,_d:!1};try{e.call(t,E(Bi,i,1),E(Ki,i,1))}catch(t){Ki.call(i,t)}}):(n._v=t,n._s=1,Li(n,!1))}catch(t){Ki.call({_w:n,_d:!1},t)}}};Ii||(Ei=function(t){se(this,Ei,"Promise","_h"),j(t),yi.call(this);try{t(E(Bi,this,1),E(Ki,this,1))}catch(t){Ki.call(this,t)}},(yi=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=ae(Ei.prototype,{then:function(t,e){var n=Ri(Jn(this,Ei));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=Ti?_i.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Li(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),vi=function(){var t=new yi;this.promise=t,this.resolve=E(Bi,t,1),this.reject=E(Ki,t,1)},gi.f=Ri=function(t){return t===Ei||t===mi?new vi(t):di(t)}),A(A.G+A.W+A.F*!Ii,{Promise:Ei}),Vt(Ei,"Promise"),$t("Promise"),mi=a.Promise,A(A.S+A.F*!Ii,"Promise",{reject:function(t){var e=Ri(this);return(0,e.reject)(t),e.promise}}),A(A.S+A.F*!Ii,"Promise",{resolve:function(t){return Oi(this,t)}}),A(A.S+A.F*!(Ii&&wt(function(t){Ei.all(t).catch(Ai)})),"Promise",{all:function(t){var e=this,n=Ri(e),i=n.resolve,o=n.reject,r=bi(function(){var n=[],r=0,a=1;ce(t,!1,function(t){var s=r++,c=!1;n.push(void 0),a++,e.resolve(t).then(function(t){c||(c=!0,n[s]=t,--a||i(n))},o)}),--a||i(n)});return r.e&&o(r.v),n.promise},race:function(t){var e=this,n=Ri(e),i=n.reject,o=bi(function(){ce(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return o.e&&i(o.v),n.promise}}),A(A.P+A.R,"Promise",{finally:function(t){var e=Jn(this,a.Promise||r.Promise),n="function"==typeof t;return this.then(n?function(n){return Oi(e,t()).then(function(){return n})}:t,n?function(n){return Oi(e,t()).then(function(){throw n})}:t)}});var Vi=(r.Reflect||{}).apply,zi=Function.apply;A(A.S+A.F*!u(function(){Vi(function(){})}),"Reflect",{apply:function(t,e,n){var i=j(t),o=c(n);return Vi?Vi(i,e,o):zi.call(i,e,o)}});var Ui=[].slice,Gi={},Hi=function(t,e,n){if(!(e in Gi)){for(var i=[],o=0;o<e;o++)i[o]="a["+o+"]";Gi[e]=Function("F,a","return new F("+i.join(",")+")")}return Gi[e](t,n)},Wi=Function.bind||function(t){var e=j(this),n=Ui.call(arguments,1),i=function(){var o=n.concat(Ui.call(arguments));return this instanceof i?Hi(e,o.length,o):Qn(e,o,t)};return s(e.prototype)&&(i.prototype=e.prototype),i},qi=(r.Reflect||{}).construct,Xi=u(function(){function t(){}return!(qi(function(){},[],t)instanceof t)}),Yi=!u(function(){qi(function(){})});A(A.S+A.F*(Xi||Yi),"Reflect",{construct:function(t,e){j(t),c(e);var n=arguments.length<3?t:j(arguments[2]);if(Yi&&!Xi)return qi(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(Wi.apply(t,i))}var o=n.prototype,r=Nt(s(o)?o:Object.prototype),a=Function.apply.call(t,r,e);return s(a)?a:r}}),A(A.S+A.F*u(function(){Reflect.defineProperty(m.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){c(t),e=d(e,!0),c(n);try{return m.f(t,e,n),!0}catch(t){return!1}}});var Ji=ge.f;A(A.S,"Reflect",{deleteProperty:function(t,e){var n=Ji(c(t),e);return!(n&&!n.configurable)&&delete t[e]}}),A(A.S,"Reflect",{get:function t(e,n){var i,o,r=arguments.length<3?e:arguments[2];return c(e)===r?e[n]:(i=ge.f(e,n))?k(i,"value")?i.value:void 0!==i.get?i.get.call(r):void 0:s(o=Ht(e))?t(o,n,r):void 0}}),A(A.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return ge.f(c(t),e)}}),A(A.S,"Reflect",{getPrototypeOf:function(t){return Ht(c(t))}}),A(A.S,"Reflect",{has:function(t,e){return e in t}});var Qi=Object.isExtensible;A(A.S,"Reflect",{isExtensible:function(t){return c(t),!Qi||Qi(t)}}),A(A.S,"Reflect",{ownKeys:Fn});var $i=Object.preventExtensions;A(A.S,"Reflect",{preventExtensions:function(t){c(t);try{return $i&&$i(t),!0}catch(t){return!1}}}),A(A.S,"Reflect",{set:function t(e,n,i){var o,r,a=arguments.length<4?e:arguments[3],u=ge.f(c(e),n);if(!u){if(s(r=Ht(e)))return t(r,n,i,a);u=g(0)}if(k(u,"value")){if(!1===u.writable||!s(a))return!1;if(o=ge.f(a,n)){if(o.get||o.set||!1===o.writable)return!1;o.value=i,m.f(a,n,o)}else m.f(a,n,g(0,i));return!0}return void 0!==u.set&&(u.set.call(a,i),!0)}}),we&&A(A.S,"Reflect",{setPrototypeOf:function(t,e){we.check(t,e);try{return we.set(t,e),!0}catch(t){return!1}}});var Zi=U("match"),to=function(t){var e;return s(t)&&(void 0!==(e=t[Zi])?!!e:"RegExp"==Y(t))},eo=function(){var t=c(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e},no=m.f,io=Ge.f,oo=r.RegExp,ro=oo,ao=oo.prototype,so=/a/g,co=/a/g,uo=new oo(so)!==so;if(l&&(!uo||u(function(){return co[U("match")]=!1,oo(so)!=so||oo(co)==co||"/a/i"!=oo(so,"i")}))){oo=function(t,e){var n=this instanceof oo,i=to(t),o=void 0===e;return!n&&i&&t.constructor===oo&&o?t:Oe(uo?new ro(i&&!o?t.source:t,e):ro((i=t instanceof oo)?t.source:t,i&&o?eo.call(t):e),n?this:ao,oo)};for(var lo=function(t){t in oo||no(oo,t,{configurable:!0,get:function(){return ro[t]},set:function(e){ro[t]=e}})},ho=io(ro),fo=0;ho.length>fo;)lo(ho[fo++]);ao.constructor=oo,oo.prototype=ao,x(r,"RegExp",oo)}$t("RegExp"),l&&"g"!=/./g.flags&&m.f(RegExp.prototype,"flags",{configurable:!0,get:eo});var po=function(t){return function(e,n){var i,o,r=String(R(e)),a=M(n),s=r.length;return a<0||a>=s?t?"":void 0:(i=r.charCodeAt(a))<55296||i>56319||a+1===s||(o=r.charCodeAt(a+1))<56320||o>57343?t?r.charAt(a):i:t?r.slice(a,a+2):o-56320+(i-55296<<10)+65536}},yo=po(!0),vo=function(t,e,n){return e+(n?yo(t,e).length:1)},mo=RegExp.prototype.exec,go=function(t,e){var n=t.exec;if("function"==typeof n){var i=n.call(t,e);if("object"!=typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==dt(t))throw new TypeError("RegExp#exec called on incompatible receiver");return mo.call(t,e)},bo=RegExp.prototype.exec,wo=String.prototype.replace,ko=bo,Oo=function(){var t=/a/,e=/b*/g;return bo.call(t,"a"),bo.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),So=void 0!==/()??/.exec("")[1];(Oo||So)&&(ko=function(t){var e,n,i,o,r=this;return So&&(n=new RegExp("^"+r.source+"$(?!\\s)",eo.call(r))),Oo&&(e=r.lastIndex),i=bo.call(r,t),Oo&&i&&(r.lastIndex=r.global?i.index+i[0].length:e),So&&i&&i.length>1&&wo.call(i[0],n,function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)}),i});var Po=ko;A({target:"RegExp",proto:!0,forced:Po!==/./.exec},{exec:Po});var Co=U("species"),_o=!u(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),xo=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}(),jo=function(t,e,n){var i=U(t),o=!u(function(){var e={};return e[i]=function(){return 7},7!=""[t](e)}),r=o?!u(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[Co]=function(){return n}),n[i](""),!e}):void 0;if(!o||!r||"replace"===t&&!_o||"split"===t&&!xo){var a=/./[i],s=n(R,i,""[t],function(t,e,n,i,r){return e.exec===Po?o&&!r?{done:!0,value:a.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}}),c=s[0],l=s[1];x(String.prototype,t,c),b(RegExp.prototype,i,2==e?function(t,e){return l.call(t,this,e)}:function(t){return l.call(t,this)})}};jo("match",1,function(t,e,n,i){return[function(n){var i=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=i(n,t,this);if(e.done)return e.value;var o=c(t),r=String(this);if(!o.global)return go(o,r);var a=o.unicode;o.lastIndex=0;for(var s,u=[],l=0;null!==(s=go(o,r));){var h=String(s[0]);u[l]=h,""===h&&(o.lastIndex=vo(r,V(o.lastIndex),a)),l++}return 0===l?null:u}]});var Eo=Math.max,To=Math.min,Ao=Math.floor,Ro=/\$([$&`']|\d\d?|<[^>]*>)/g,Io=/\$([$&`']|\d\d?)/g,Fo=function(t){return void 0===t?t:String(t)};jo("replace",2,function(t,e,n,i){return[function(i,o){var r=t(this),a=null==i?void 0:i[e];return void 0!==a?a.call(i,r,o):n.call(String(r),i,o)},function(t,e){var r=i(n,t,this,e);if(r.done)return r.value;var a=c(t),s=String(this),u="function"==typeof e;u||(e=String(e));var l=a.global;if(l){var h=a.unicode;a.lastIndex=0}for(var f=[];;){var p=go(a,s);if(null===p)break;if(f.push(p),!l)break;""===String(p[0])&&(a.lastIndex=vo(s,V(a.lastIndex),h))}for(var y="",d=0,v=0;v<f.length;v++){p=f[v];for(var m=String(p[0]),g=Eo(To(M(p.index),s.length),0),b=[],w=1;w<p.length;w++)b.push(Fo(p[w]));var k=p.groups;if(u){var O=[m].concat(b,g,s);void 0!==k&&O.push(k);var S=String(e.apply(void 0,O))}else S=o(m,s,g,b,k,e);g>=d&&(y+=s.slice(d,g)+S,d=g+m.length)}return y+s.slice(d)}];function o(t,e,i,o,r,a){var s=i+t.length,c=o.length,u=Io;return void 0!==r&&(r=I(r),u=Ro),n.call(a,u,function(n,a){var u;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,i);case"'":return e.slice(s);case"<":u=r[a.slice(1,-1)];break;default:var l=+a;if(0===l)return n;if(l>c){var h=Ao(l/10);return 0===h?n:h<=c?void 0===o[h-1]?a.charAt(1):o[h-1]+a.charAt(1):n}u=o[l-1]}return void 0===u?"":u})}});var Lo=Math.min,Mo=[].push,Do=!u(function(){});jo("split",2,function(t,e,n,i){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!to(t))return n.call(i,t,e);for(var o,r,a,s=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,l=void 0===e?4294967295:e>>>0,h=new RegExp(t.source,c+"g");(o=Po.call(h,i))&&!((r=h.lastIndex)>u&&(s.push(i.slice(u,o.index)),o.length>1&&o.index<i.length&&Mo.apply(s,o.slice(1)),a=o[0].length,u=r,s.length>=l));)h.lastIndex===o.index&&h.lastIndex++;return u===i.length?!a&&h.test("")||s.push(""):s.push(i.slice(u)),s.length>l?s.slice(0,l):s}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,i){var r=t(this),a=null==n?void 0:n[e];return void 0!==a?a.call(n,r,i):o.call(String(r),n,i)},function(t,e){var r=i(o,t,this,e,o!==n);if(r.done)return r.value;var a=c(t),s=String(this),u=Jn(a,RegExp),l=a.unicode,h=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(Do?"y":"g"),f=new u(Do?a:"^(?:"+a.source+")",h),p=void 0===e?4294967295:e>>>0;if(0===p)return[];if(0===s.length)return null===go(f,s)?[s]:[];for(var y=0,d=0,v=[];d<s.length;){f.lastIndex=Do?d:0;var m,g=go(f,Do?s:s.slice(d));if(null===g||(m=Lo(V(f.lastIndex+(Do?0:d)),s.length))===y)d=vo(s,d,l);else{if(v.push(s.slice(y,d)),v.length===p)return v;for(var b=1;b<=g.length-1;b++)if(v.push(g[b]),v.length===p)return v;d=y=m}}return v.push(s.slice(y)),v}]}),jo("search",1,function(t,e,n,i){return[function(n){var i=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=i(n,t,this);if(e.done)return e.value;var o=c(t),r=String(this),a=o.lastIndex;Un(a,0)||(o.lastIndex=0);var s=go(o,r);return Un(o.lastIndex,a)||(o.lastIndex=a),null===s?-1:s.index}]});var No=/./.toString,Ko=function(t){x(RegExp.prototype,"toString",t,!0)};u(function(){return"/a/b"!=No.call({source:"a",flags:"b"})})?Ko(function(){var t=c(this);return"/".concat(t.source,"/","flags"in t?t.flags:!l&&t instanceof RegExp?eo.call(t):void 0)}):"toString"!=No.name&&Ko(function(){return No.call(this)});Se("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return de.def(le(this,"Set"),t=0===t?0:t,t)}},de);var Bo={f:U},Vo=m.f,zo=function(t){var e=a.Symbol||(a.Symbol=r.Symbol||{});"_"==t.charAt(0)||t in e||Vo(e,t,{value:Bo.f(t)})},Uo=ue.KEY,Go=ge.f,Ho=m.f,Wo=Nn.f,qo=r.Symbol,Xo=r.JSON,Yo=Xo&&Xo.stringify,Jo=U("_hidden"),Qo=U("toPrimitive"),$o={}.propertyIsEnumerable,Zo=C("symbol-registry"),tr=C("symbols"),er=C("op-symbols"),nr=Object.prototype,ir="function"==typeof qo,or=r.QObject,rr=!or||!or.prototype||!or.prototype.findChild,ar=l&&u(function(){return 7!=Nt(Ho({},"a",{get:function(){return Ho(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=Go(nr,e);i&&delete nr[e],Ho(t,e,n),i&&t!==nr&&Ho(nr,e,i)}:Ho,sr=function(t){var e=tr[t]=Nt(qo.prototype);return e._k=t,e},cr=ir&&"symbol"==typeof qo.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof qo},ur=function(t,e,n){return t===nr&&ur(er,e,n),c(t),e=d(e,!0),c(n),k(tr,e)?(n.enumerable?(k(t,Jo)&&t[Jo][e]&&(t[Jo][e]=!1),n=Nt(n,{enumerable:g(0,!1)})):(k(t,Jo)||Ho(t,Jo,g(1,{})),t[Jo][e]=!0),ar(t,e,n)):Ho(t,e,n)},lr=function(t,e){c(t);for(var n,i=function(t){var e=At(t),n=Sn.f;if(n)for(var i,o=n(t),r=ve.f,a=0;o.length>a;)r.call(t,i=o[a++])&&e.push(i);return e}(e=kt(e)),o=0,r=i.length;r>o;)ur(t,n=i[o++],e[n]);return t},hr=function(t){var e=$o.call(this,t=d(t,!0));return!(this===nr&&k(tr,t)&&!k(er,t))&&(!(e||!k(this,t)||!k(tr,t)||k(this,Jo)&&this[Jo][t])||e)},fr=function(t,e){if(t=kt(t),e=d(e,!0),t!==nr||!k(tr,e)||k(er,e)){var n=Go(t,e);return!n||!k(tr,e)||k(t,Jo)&&t[Jo][e]||(n.enumerable=!0),n}},pr=function(t){for(var e,n=Wo(kt(t)),i=[],o=0;n.length>o;)k(tr,e=n[o++])||e==Jo||e==Uo||i.push(e);return i},yr=function(t){for(var e,n=t===nr,i=Wo(n?er:kt(t)),o=[],r=0;i.length>r;)!k(tr,e=i[r++])||n&&!k(nr,e)||o.push(tr[e]);return o};ir||(x((qo=function(){if(this instanceof qo)throw TypeError("Symbol is not a constructor!");var t=P(arguments.length>0?arguments[0]:void 0),e=function(n){this===nr&&e.call(er,n),k(this,Jo)&&k(this[Jo],t)&&(this[Jo][t]=!1),ar(this,t,g(1,n))};return l&&rr&&ar(nr,t,{configurable:!0,set:e}),sr(t)}).prototype,"toString",function(){return this._k}),ge.f=fr,m.f=ur,Ge.f=Nn.f=pr,ve.f=hr,Sn.f=yr,l&&x(nr,"propertyIsEnumerable",hr,!0),Bo.f=function(t){return sr(U(t))}),A(A.G+A.W+A.F*!ir,{Symbol:qo});for(var dr="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),vr=0;dr.length>vr;)U(dr[vr++]);for(var mr=At(U.store),gr=0;mr.length>gr;)zo(mr[gr++]);A(A.S+A.F*!ir,"Symbol",{for:function(t){return k(Zo,t+="")?Zo[t]:Zo[t]=qo(t)},keyFor:function(t){if(!cr(t))throw TypeError(t+" is not a symbol!");for(var e in Zo)if(Zo[e]===t)return e},useSetter:function(){rr=!0},useSimple:function(){rr=!1}}),A(A.S+A.F*!ir,"Object",{create:function(t,e){return void 0===e?Nt(t):lr(Nt(t),e)},defineProperty:ur,defineProperties:lr,getOwnPropertyDescriptor:fr,getOwnPropertyNames:pr,getOwnPropertySymbols:yr}),Xo&&A(A.S+A.F*(!ir||u(function(){var t=qo();return"[null]"!=Yo([t])||"{}"!=Yo({a:t})||"{}"!=Yo(Object(t))})),"JSON",{stringify:function(t){for(var e,n,i=[t],o=1;arguments.length>o;)i.push(arguments[o++]);if(n=e=i[1],(s(e)||void 0!==t)&&!cr(t))return Q(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!cr(e))return e}),i[1]=e,Yo.apply(Xo,i)}}),qo.prototype[Qo]||b(qo.prototype,Qo,qo.prototype.valueOf),Vt(qo,"Symbol"),Vt(Math,"Math",!0),Vt(r.JSON,"JSON",!0),zo("asyncIterator");var br=/"/g,wr=function(t,e,n,i){var o=String(R(t)),r="<"+e;return""!==n&&(r+=" "+n+'="'+String(i).replace(br,"&quot;")+'"'),r+">"+o+"</"+e+">"},kr=function(t,e){var n={};n[t]=e(wr),A(A.P+A.F*u(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)};kr("anchor",function(t){return function(e){return t(this,"a","name",e)}}),kr("big",function(t){return function(){return t(this,"big","","")}}),kr("blink",function(t){return function(){return t(this,"blink","","")}}),kr("bold",function(t){return function(){return t(this,"b","","")}});var Or=po(!1);A(A.P,"String",{codePointAt:function(t){return Or(this,t)}});var Sr=function(t,e,n){if(to(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(R(t))},Pr=U("match"),Cr=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[Pr]=!1,!"/./"[t](e)}catch(t){}}return!0},_r="".endsWith;A(A.P+A.F*Cr("endsWith"),"String",{endsWith:function(t){var e=Sr(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,i=V(e.length),o=void 0===n?i:Math.min(V(n),i),r=String(t);return _r?_r.call(e,r,o):e.slice(o-r.length,o)===r}}),kr("fixed",function(t){return function(){return t(this,"tt","","")}}),kr("fontcolor",function(t){return function(e){return t(this,"font","color",e)}}),kr("fontsize",function(t){return function(e){return t(this,"font","size",e)}});var xr=String.fromCharCode,jr=String.fromCodePoint;A(A.S+A.F*(!!jr&&1!=jr.length),"String",{fromCodePoint:function(t){for(var e,n=[],i=arguments.length,o=0;i>o;){if(e=+arguments[o++],K(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?xr(e):xr(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}});A(A.P+A.F*Cr("includes"),"String",{includes:function(t){return!!~Sr(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}}),kr("italics",function(t){return function(){return t(this,"i","","")}});var Er=po(!0);Yt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=Er(e,n),this._i+=t.length,{value:t,done:!1})}),kr("link",function(t){return function(e){return t(this,"a","href",e)}});var Tr=function(t){var e=String(R(this)),n="",i=M(t);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(e+=e))1&i&&(n+=e);return n},Ar=function(t,e,n,i){var o=String(R(t)),r=o.length,a=void 0===n?" ":String(n),s=V(e);if(s<=r||""==a)return o;var c=s-r,u=Tr.call(a,Math.ceil(c/a.length));return u.length>c&&(u=u.slice(0,c)),i?u+o:o+u},Rr=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(ki);A(A.P+A.F*Rr,"String",{padStart:function(t){return Ar(this,t,arguments.length>1?arguments[1]:void 0,!0)}});var Ir=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(ki);A(A.P+A.F*Ir,"String",{padEnd:function(t){return Ar(this,t,arguments.length>1?arguments[1]:void 0,!1)}}),A(A.S,"String",{raw:function(t){for(var e=kt(t.raw),n=V(e.length),i=arguments.length,o=[],r=0;n>r;)o.push(String(e[r++])),r<i&&o.push(String(arguments[r]));return o.join("")}}),A(A.P,"String",{repeat:Tr}),kr("small",function(t){return function(){return t(this,"small","","")}});var Fr="".startsWith;A(A.P+A.F*Cr("startsWith"),"String",{startsWith:function(t){var e=Sr(this,t,"startsWith"),n=V(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return Fr?Fr.call(e,i,n):e.slice(n,n+i.length)===i}}),kr("strike",function(t){return function(){return t(this,"strike","","")}}),kr("sub",function(t){return function(){return t(this,"sub","","")}}),kr("sup",function(t){return function(){return t(this,"sup","","")}}),Qe("trimLeft",function(t){return function(){return t(this,1)}},"trimStart"),Qe("trimRight",function(t){return function(){return t(this,2)}},"trimEnd");for(var Lr,Mr=P("typed_array"),Dr=P("view"),Nr=!(!r.ArrayBuffer||!r.DataView),Kr=Nr,Br=0,Vr="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");Br<9;)(Lr=r[Vr[Br++]])?(b(Lr.prototype,Mr,!0),b(Lr.prototype,Dr,!0)):Kr=!1;var zr={ABV:Nr,CONSTR:Kr,TYPED:Mr,VIEW:Dr},Ur=function(t){if(void 0===t)return 0;var e=M(t),n=V(e);if(e!==n)throw RangeError("Wrong length!");return n},Gr=o(function(t,e){var n=Ge.f,i=m.f,o="prototype",a="Wrong index!",s=r.ArrayBuffer,c=r.DataView,h=r.Math,f=r.RangeError,p=r.Infinity,y=s,d=h.abs,v=h.pow,g=h.floor,w=h.log,k=h.LN2,O=l?"_b":"buffer",S=l?"_l":"byteLength",P=l?"_o":"byteOffset";function C(t,e,n){var i,o,r,a=new Array(n),s=8*n-e-1,c=(1<<s)-1,u=c>>1,l=23===e?v(2,-24)-v(2,-77):0,h=0,f=t<0||0===t&&1/t<0?1:0;for((t=d(t))!=t||t===p?(o=t!=t?1:0,i=c):(i=g(w(t)/k),t*(r=v(2,-i))<1&&(i--,r*=2),(t+=i+u>=1?l/r:l*v(2,1-u))*r>=2&&(i++,r/=2),i+u>=c?(o=0,i=c):i+u>=1?(o=(t*r-1)*v(2,e),i+=u):(o=t*v(2,u-1)*v(2,e),i=0));e>=8;a[h++]=255&o,o/=256,e-=8);for(i=i<<e|o,s+=e;s>0;a[h++]=255&i,i/=256,s-=8);return a[--h]|=128*f,a}function _(t,e,n){var i,o=8*n-e-1,r=(1<<o)-1,a=r>>1,s=o-7,c=n-1,u=t[c--],l=127&u;for(u>>=7;s>0;l=256*l+t[c],c--,s-=8);for(i=l&(1<<-s)-1,l>>=-s,s+=e;s>0;i=256*i+t[c],c--,s-=8);if(0===l)l=1-a;else{if(l===r)return i?NaN:u?-p:p;i+=v(2,e),l-=a}return(u?-1:1)*i*v(2,l-e)}function x(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function j(t){return[255&t]}function E(t){return[255&t,t>>8&255]}function T(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function A(t){return C(t,52,8)}function R(t){return C(t,23,4)}function I(t,e,n){i(t[o],e,{get:function(){return this[n]}})}function F(t,e,n,i){var o=Ur(+n);if(o+e>t[S])throw f(a);var r=t[O]._b,s=o+t[P],c=r.slice(s,s+e);return i?c:c.reverse()}function L(t,e,n,i,o,r){var s=Ur(+n);if(s+e>t[S])throw f(a);for(var c=t[O]._b,u=s+t[P],l=i(+o),h=0;h<e;h++)c[u+h]=l[r?h:e-h-1]}if(zr.ABV){if(!u(function(){s(1)})||!u(function(){new s(-1)})||u(function(){return new s,new s(1.5),new s(NaN),"ArrayBuffer"!=s.name})){for(var D,N=(s=function(t){return se(this,s),new y(Ur(t))})[o]=y[o],K=n(y),B=0;K.length>B;)(D=K[B++])in s||b(s,D,y[D]);N.constructor=s}var z=new c(new s(2)),U=c[o].setInt8;z.setInt8(0,2147483648),z.setInt8(1,2147483649),!z.getInt8(0)&&z.getInt8(1)||ae(c[o],{setInt8:function(t,e){U.call(this,t,e<<24>>24)},setUint8:function(t,e){U.call(this,t,e<<24>>24)}},!0)}else s=function(t){se(this,s,"ArrayBuffer");var e=Ur(t);this._b=q.call(new Array(e),0),this[S]=e},c=function(t,e,n){se(this,c,"DataView"),se(t,s,"DataView");var i=t[S],o=M(e);if(o<0||o>i)throw f("Wrong offset!");if(o+(n=void 0===n?i-o:V(n))>i)throw f("Wrong length!");this[O]=t,this[P]=o,this[S]=n},l&&(I(s,"byteLength","_l"),I(c,"buffer","_b"),I(c,"byteLength","_l"),I(c,"byteOffset","_o")),ae(c[o],{getInt8:function(t){return F(this,1,t)[0]<<24>>24},getUint8:function(t){return F(this,1,t)[0]},getInt16:function(t){var e=F(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=F(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return x(F(this,4,t,arguments[1]))},getUint32:function(t){return x(F(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return _(F(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return _(F(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){L(this,1,t,j,e)},setUint8:function(t,e){L(this,1,t,j,e)},setInt16:function(t,e){L(this,2,t,E,e,arguments[2])},setUint16:function(t,e){L(this,2,t,E,e,arguments[2])},setInt32:function(t,e){L(this,4,t,T,e,arguments[2])},setUint32:function(t,e){L(this,4,t,T,e,arguments[2])},setFloat32:function(t,e){L(this,4,t,R,e,arguments[2])},setFloat64:function(t,e){L(this,8,t,A,e,arguments[2])}});Vt(s,"ArrayBuffer"),Vt(c,"DataView"),b(c[o],zr.VIEW,!0),e.ArrayBuffer=s,e.DataView=c}),Hr=r.ArrayBuffer,Wr=Gr.ArrayBuffer,qr=Gr.DataView,Xr=zr.ABV&&Hr.isView,Yr=Wr.prototype.slice,Jr=zr.VIEW;A(A.G+A.W+A.F*(Hr!==Wr),{ArrayBuffer:Wr}),A(A.S+A.F*!zr.CONSTR,"ArrayBuffer",{isView:function(t){return Xr&&Xr(t)||s(t)&&Jr in t}}),A(A.P+A.U+A.F*u(function(){return!new Wr(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==Yr&&void 0===e)return Yr.call(c(this),t);for(var n=c(this).byteLength,i=K(t,n),o=K(void 0===e?n:e,n),r=new(Jn(this,Wr))(V(o-i)),a=new qr(this),s=new qr(r),u=0;i<o;)s.setUint8(u++,a.getUint8(i++));return r}}),$t("ArrayBuffer");var Qr=o(function(t){if(l){var e=r,n=u,i=A,o=zr,a=Gr,c=E,h=se,f=g,p=b,y=ae,v=M,w=V,O=Ur,S=K,C=d,_=k,x=dt,j=s,T=I,R=ht,F=Nt,L=Ht,D=Ge.f,N=mt,B=P,G=U,H=tt,W=Ot,X=Jn,Y=Jt,J=ct,Q=wt,$=$t,Z=q,et=z,nt=m,it=ge,ot=nt.f,rt=it.f,at=e.RangeError,st=e.TypeError,ut=e.Uint8Array,lt=Array.prototype,ft=a.ArrayBuffer,pt=a.DataView,yt=H(0),vt=H(2),gt=H(3),bt=H(4),kt=H(5),St=H(6),Pt=W(!0),Ct=W(!1),_t=Y.values,xt=Y.keys,jt=Y.entries,Et=lt.lastIndexOf,Tt=lt.reduce,At=lt.reduceRight,Rt=lt.join,It=lt.sort,Ft=lt.slice,Lt=lt.toString,Mt=lt.toLocaleString,Dt=G("iterator"),Kt=G("toStringTag"),Bt=B("typed_constructor"),Vt=B("def_constructor"),zt=o.CONSTR,Ut=o.TYPED,Gt=o.VIEW,Wt=H(1,function(t,e){return Zt(X(t,t[Vt]),e)}),qt=n(function(){return 1===new ut(new Uint16Array([1]).buffer)[0]}),Xt=!!ut&&!!ut.prototype.set&&n(function(){new ut(1).set({})}),Yt=function(t,e){var n=v(t);if(n<0||n%e)throw at("Wrong offset!");return n},Qt=function(t){if(j(t)&&Ut in t)return t;throw st(t+" is not a typed array!")},Zt=function(t,e){if(!(j(t)&&Bt in t))throw st("It is not a typed array constructor!");return new t(e)},te=function(t,e){return ee(X(t,t[Vt]),e)},ee=function(t,e){for(var n=0,i=e.length,o=Zt(t,i);i>n;)o[n]=e[n++];return o},ne=function(t,e,n){ot(t,e,{get:function(){return this._d[n]}})},ie=function(t){var e,n,i,o,r,a,s=T(t),u=arguments.length,l=u>1?arguments[1]:void 0,h=void 0!==l,f=N(s);if(null!=f&&!R(f)){for(a=f.call(s),i=[],e=0;!(r=a.next()).done;e++)i.push(r.value);s=i}for(h&&u>2&&(l=c(l,arguments[2],2)),e=0,n=w(s.length),o=Zt(this,n);n>e;e++)o[e]=h?l(s[e],e):s[e];return o},oe=function(){for(var t=0,e=arguments.length,n=Zt(this,e);e>t;)n[t]=arguments[t++];return n},re=!!ut&&n(function(){Mt.call(new ut(1))}),ce=function(){return Mt.apply(re?Ft.call(Qt(this)):Qt(this),arguments)},ue={copyWithin:function(t,e){return et.call(Qt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return bt(Qt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return Z.apply(Qt(this),arguments)},filter:function(t){return te(this,vt(Qt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return kt(Qt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return St(Qt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){yt(Qt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return Ct(Qt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return Pt(Qt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return Rt.apply(Qt(this),arguments)},lastIndexOf:function(t){return Et.apply(Qt(this),arguments)},map:function(t){return Wt(Qt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return Tt.apply(Qt(this),arguments)},reduceRight:function(t){return At.apply(Qt(this),arguments)},reverse:function(){for(var t,e=Qt(this).length,n=Math.floor(e/2),i=0;i<n;)t=this[i],this[i++]=this[--e],this[e]=t;return this},some:function(t){return gt(Qt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return It.call(Qt(this),t)},subarray:function(t,e){var n=Qt(this),i=n.length,o=S(t,i);return new(X(n,n[Vt]))(n.buffer,n.byteOffset+o*n.BYTES_PER_ELEMENT,w((void 0===e?i:S(e,i))-o))}},le=function(t,e){return te(this,Ft.call(Qt(this),t,e))},he=function(t){Qt(this);var e=Yt(arguments[1],1),n=this.length,i=T(t),o=w(i.length),r=0;if(o+e>n)throw at("Wrong length!");for(;r<o;)this[e+r]=i[r++]},fe={entries:function(){return jt.call(Qt(this))},keys:function(){return xt.call(Qt(this))},values:function(){return _t.call(Qt(this))}},pe=function(t,e){return j(t)&&t[Ut]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},ye=function(t,e){return pe(t,e=C(e,!0))?f(2,t[e]):rt(t,e)},de=function(t,e,n){return!(pe(t,e=C(e,!0))&&j(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?ot(t,e,n):(t[e]=n.value,t)};zt||(it.f=ye,nt.f=de),i(i.S+i.F*!zt,"Object",{getOwnPropertyDescriptor:ye,defineProperty:de}),n(function(){Lt.call({})})&&(Lt=Mt=function(){return Rt.call(this)});var ve=y({},ue);y(ve,fe),p(ve,Dt,fe.values),y(ve,{slice:le,set:he,constructor:function(){},toString:Lt,toLocaleString:ce}),ne(ve,"buffer","b"),ne(ve,"byteOffset","o"),ne(ve,"byteLength","l"),ne(ve,"length","e"),ot(ve,Kt,{get:function(){return this[Ut]}}),t.exports=function(t,r,a,s){var c=t+((s=!!s)?"Clamped":"")+"Array",u="get"+t,l="set"+t,f=e[c],y=f||{},d=f&&L(f),v=!f||!o.ABV,m={},g=f&&f.prototype,b=function(t,e){ot(t,e,{get:function(){return function(t,e){var n=t._d;return n.v[u](e*r+n.o,qt)}(this,e)},set:function(t){return function(t,e,n){var i=t._d;s&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),i.v[l](e*r+i.o,n,qt)}(this,e,t)},enumerable:!0})};v?(f=a(function(t,e,n,i){h(t,f,c,"_d");var o,a,s,u,l=0,y=0;if(j(e)){if(!(e instanceof ft||"ArrayBuffer"==(u=x(e))||"SharedArrayBuffer"==u))return Ut in e?ee(f,e):ie.call(f,e);o=e,y=Yt(n,r);var d=e.byteLength;if(void 0===i){if(d%r)throw at("Wrong length!");if((a=d-y)<0)throw at("Wrong length!")}else if((a=w(i)*r)+y>d)throw at("Wrong length!");s=a/r}else s=O(e),o=new ft(a=s*r);for(p(t,"_d",{b:o,o:y,l:a,e:s,v:new pt(o)});l<s;)b(t,l++)}),g=f.prototype=F(ve),p(g,"constructor",f)):n(function(){f(1)})&&n(function(){new f(-1)})&&Q(function(t){new f,new f(null),new f(1.5),new f(t)},!0)||(f=a(function(t,e,n,i){var o;return h(t,f,c),j(e)?e instanceof ft||"ArrayBuffer"==(o=x(e))||"SharedArrayBuffer"==o?void 0!==i?new y(e,Yt(n,r),i):void 0!==n?new y(e,Yt(n,r)):new y(e):Ut in e?ee(f,e):ie.call(f,e):new y(O(e))}),yt(d!==Function.prototype?D(y).concat(D(d)):D(y),function(t){t in f||p(f,t,y[t])}),f.prototype=g,g.constructor=f);var k=g[Dt],S=!!k&&("values"==k.name||null==k.name),P=fe.values;p(f,Bt,!0),p(g,Ut,c),p(g,Gt,!0),p(g,Vt,f),(s?new f(1)[Kt]==c:Kt in g)||ot(g,Kt,{get:function(){return c}}),m[c]=f,i(i.G+i.W+i.F*(f!=y),m),i(i.S,c,{BYTES_PER_ELEMENT:r}),i(i.S+i.F*n(function(){y.of.call(f,1)}),c,{from:ie,of:oe}),"BYTES_PER_ELEMENT"in g||p(g,"BYTES_PER_ELEMENT",r),i(i.P,c,ue),$(c),i(i.P+i.F*Xt,c,{set:he}),i(i.P+i.F*!S,c,fe),g.toString!=Lt&&(g.toString=Lt),i(i.P+i.F*n(function(){new f(1).slice()}),c,{slice:le}),i(i.P+i.F*(n(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!n(function(){g.toLocaleString.call([1,2])})),c,{toLocaleString:ce}),J[c]=S?k:P,S||p(g,Dt,P)}}else t.exports=function(){}});Qr("Int8",1,function(t){return function(e,n,i){return t(this,e,n,i)}}),Qr("Uint8",1,function(t){return function(e,n,i){return t(this,e,n,i)}}),Qr("Uint8",1,function(t){return function(e,n,i){return t(this,e,n,i)}},!0),Qr("Int16",2,function(t){return function(e,n,i){return t(this,e,n,i)}}),Qr("Uint16",2,function(t){return function(e,n,i){return t(this,e,n,i)}}),Qr("Int32",4,function(t){return function(e,n,i){return t(this,e,n,i)}}),Qr("Uint32",4,function(t){return function(e,n,i){return t(this,e,n,i)}}),Qr("Float32",4,function(t){return function(e,n,i){return t(this,e,n,i)}}),Qr("Float64",8,function(t){return function(e,n,i){return t(this,e,n,i)}});var $r=ue.getWeak,Zr=tt(5),ta=tt(6),ea=0,na=function(t){return t._l||(t._l=new ia)},ia=function(){this.a=[]},oa=function(t,e){return Zr(t.a,function(t){return t[0]===e})};ia.prototype={get:function(t){var e=oa(this,t);if(e)return e[1]},has:function(t){return!!oa(this,t)},set:function(t,e){var n=oa(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=ta(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}};var ra={getConstructor:function(t,e,n,i){var o=t(function(t,r){se(t,o,e,"_i"),t._t=e,t._i=ea++,t._l=void 0,null!=r&&ce(r,n,t[i],t)});return ae(o.prototype,{delete:function(t){if(!s(t))return!1;var n=$r(t);return!0===n?na(le(this,e)).delete(t):n&&k(n,this._i)&&delete n[this._i]},has:function(t){if(!s(t))return!1;var n=$r(t);return!0===n?na(le(this,e)).has(t):n&&k(n,this._i)}}),o},def:function(t,e,n){var i=$r(c(e),!0);return!0===i?na(t).set(e,n):i[t._i]=n,t},ufstore:na};o(function(t){var e,n=tt(0),i=le,o=!r.ActiveXObject&&"ActiveXObject"in r,a=ue.getWeak,c=Object.isExtensible,u=ra.ufstore,l=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},h={get:function(t){if(s(t)){var e=a(t);return!0===e?u(le(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return ra.def(le(this,"WeakMap"),t,e)}},f=t.exports=Se("WeakMap",l,h,ra,!0,!0);i&&o&&(e=ra.getConstructor(l,"WeakMap"),Cn(e.prototype,h),ue.NEED=!0,n(["delete","has","get","set"],function(t){var n=f.prototype,i=n[t];x(n,t,function(n,o){if(s(n)&&!c(n)){this._f||(this._f=new e);var r=this._f[t](n,o);return"set"==t?this:r}return i.call(this,n,o)})}))});Se("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return ra.def(le(this,"WeakSet"),t,!0)}},ra,!1,!0);var aa=[].slice,sa=/MSIE .\./.test(ki),ca=function(t){return function(e,n){var i=arguments.length>2,o=!!i&&aa.call(arguments,2);return t(i?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,n)}};A(A.G+A.B+A.F*sa,{setTimeout:ca(r.setTimeout),setInterval:ca(r.setInterval)}),A(A.G+A.B,{setImmediate:si.set,clearImmediate:si.clear});for(var ua=U("iterator"),la=U("toStringTag"),ha=ct.Array,fa={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},pa=At(fa),ya=0;ya<pa.length;ya++){var da,va=pa[ya],ma=fa[va],ga=r[va],ba=ga&&ga.prototype;if(ba&&(ba[ua]||b(ba,ua,ha),ba[la]||b(ba,la,va),ct[va]=ha,ma))for(da in Jt)ba[da]||x(ba,da,Jt[da],!0)}o(function(t){var e=function(t){var e,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n,i){var o=e&&e.prototype instanceof d?e:d,r=Object.create(o.prototype),a=new x(i||[]);return r._invoke=function(t,e,n){var i=l;return function(o,r){if(i===f)throw new Error("Generator is already running");if(i===p){if("throw"===o)throw r;return E()}for(n.method=o,n.arg=r;;){var a=n.delegate;if(a){var s=P(a,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===l)throw i=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=f;var c=u(t,e,n);if("normal"===c.type){if(i=n.done?p:h,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=p,n.method="throw",n.arg=c.arg)}}}(t,n,a),r}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l="suspendedStart",h="suspendedYield",f="executing",p="completed",y={};function d(){}function v(){}function m(){}var g={};g[r]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(j([])));w&&w!==n&&i.call(w,r)&&(g=w);var k=m.prototype=d.prototype=Object.create(g);function O(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function S(t){var e;this._invoke=function(n,o){function r(){return new Promise(function(e,r){!function e(n,o,r,a){var s=u(t[n],t,o);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&i.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,r,a)},function(t){e("throw",t,r,a)}):Promise.resolve(l).then(function(t){c.value=t,r(c)},function(t){return e("throw",t,r,a)})}a(s.arg)}(n,o,e,r)})}return e=e?e.then(r,r):r()}}function P(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method))return y;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=u(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var r=o.arg;return r?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function j(t){if(t){var n=t[r];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(i.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:E}}function E(){return{value:e,done:!0}}return v.prototype=k.constructor=m,m.constructor=v,m[s]=v.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},O(S.prototype),S.prototype[a]=function(){return this},t.AsyncIterator=S,t.async=function(e,n,i,o){var r=new S(c(e,n,i,o));return t.isGeneratorFunction(n)?r:r.next().then(function(t){return t.done?t.value:r.next()})},O(k),k[s]="Generator",k[r]=function(){return this},k.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=j,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(i,o){return s.type="throw",s.arg=t,n.next=i,o&&(n.method="next",n.arg=e),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var o=i.arg;_(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:j(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}});function wa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ka(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Oa(t,e,n){return e&&ka(t.prototype,e),n&&ka(t,n),t}function Sa(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function Pa(t){return(Pa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ca(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}var _a=function(){function t(){wa(this,t)}return Oa(t,null,[{key:"minLevel",value:function(e){t.initParams(),"number"!=typeof e?(e=e.toUpperCase(),t.isValidLevelName(e)?window[t.paramKey].minLevel=t.LEVEL[e]:window[t.paramKey].minLevel=t.LEVEL.GENERAL):window[t.paramKey].minLevel=e}},{key:"initParams",value:function(){window[t.paramKey]||(window[t.paramKey]={emitEnabled:!1,enabled:!0,minLevel:1})}},{key:"emit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Debugger";t.initParams(),t.params.emitEnabled&&window.dispatchEvent(new Event(e))}},{key:"meetsLevelRequirement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"GENERAL";return t.initParams(),!!(t.isValidLevelName(e)&&t.LEVEL[e]>=t.params.minLevel)}},{key:"log",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"log";if(t.initParams(),t.isEnabled()){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];switch(e.toLowerCase()){case"info":var r;return!!t.meetsLevelRequirement("INFO")&&((r=console).info.apply(r,i),t.emit(),!0);case"debug":var a;return!!t.meetsLevelRequirement("DEBUG")&&((a=console).debug.apply(a,i),t.emit(),!0);case"error":var s;return!!t.meetsLevelRequirement("ERROR")&&((s=console).error.apply(s,i),t.emit(),!0);case"warn":var c;return!!t.meetsLevelRequirement("WARN")&&((c=console).warn.apply(c,i),t.emit(),!0);case"log":case"general":default:var u;return!!t.meetsLevelRequirement("GENERAL")&&((u=console).log.apply(u,i),t.emit(),!0)}}}},{key:"isValidLevelName",value:function(e){return t.initParams(),"GENERAL"==e||"DEBUG"==e||"INFO"==e||"WARN"==e||"ERROR"==e}},{key:"assert",value:function(e){if(t.initParams(),!e)throw"Assert Error: ".concat(e)}},{key:"isEnabled",value:function(){return window[t.paramKey].enabled}},{key:"enable",value:function(e){t.initParams(),window[t.paramKey].enabled=e}},{key:"params",get:function(){return t.initParams(),window[t.paramKey]}},{key:"LEVEL",get:function(){return{GENERAL:1,DEBUG:2,INFO:3,WARN:4,ERROR:5}}},{key:"paramKey",get:function(){return"__spring_roll_debugger_params__"}}]),t}(),xa=!!window.MSInputMethodContext&&!!document.documentMode,ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ea=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Ta=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Aa=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},Ra=function(){function t(){Ea(this,t),this._listeners={}}return Ta(t,[{key:"on",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._listeners[t]||(this._listeners[t]=[]),e._priority=parseInt(n)||0,-1===this._listeners[t].indexOf(e)&&(this._listeners[t].push(e),this._listeners[t].length>1&&this._listeners[t].sort(this.listenerSorter))}},{key:"listenerSorter",value:function(t,e){return t._priority-e._priority}},{key:"off",value:function(t,e){if(void 0!==this._listeners[t])if(void 0!==e){var n=this._listeners[t].indexOf(e);-1<n&&this._listeners[t].splice(n,1)}else delete this._listeners[t]}},{key:"trigger",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof t&&(t={type:t,data:"object"===(void 0===e?"undefined":ja(e))&&null!==e?e:{}}),void 0!==this._listeners[t.type])for(var n=this._listeners[t.type].length-1;n>=0;n--)this._listeners[t.type][n](t)}},{key:"destroy",value:function(){this._listeners={}}}]),t}(),Ia=new(function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100*Math.random()|0;Ea(this,e);var n=Aa(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.id="BELLHOP:"+t,n.connected=!1,n.isChild=!0,n.connecting=!1,n.origin="*",n._sendLater=[],n.iframe=null,n.receive=n.receive.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Ra),Ta(e,[{key:"receive",value:function(t){if(this.target===t.source)if("connected"===t.data)this.onConnectionReceived(t.data);else{var e=t.data;if("string"==typeof e)try{e=JSON.parse(e)}catch(t){console.error("Bellhop error: ",t)}this.connected&&"object"===(void 0===e?"undefined":ja(e))&&e.type&&this.trigger(e)}}},{key:"onConnectionReceived",value:function(t){this.connecting=!1,this.connected=!0,this.isChild||this.target.postMessage(t,this.origin);for(var e=0;e<this._sendLater.length;e++){var n=this._sendLater[e],i=n.type,o=n.data;this.send(i,o)}this._sendLater.length=0,this.trigger("connected")}},{key:"connect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"*";this.connecting||(this.disconnect(),this.connecting=!0,t instanceof HTMLIFrameElement&&(this.iframe=t),this.isChild=void 0===t,this.supported=!0,this.isChild&&(this.supported=window!=t),this.origin=e,window.addEventListener("message",this.receive),this.isChild&&(window===this.target?this.trigger("failed"):this.target.postMessage("connected",this.origin)))}},{key:"disconnect",value:function(){this.connected=!1,this.connecting=!1,this.origin=null,this.iframe=null,this.isChild=!0,this._sendLater.length=0,window.removeEventListener("message",this.receive)}},{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof t)throw"The event type must be a string";var n={type:t,data:e};this.connecting?this._sendLater.push(n):this.target.postMessage(JSON.stringify(n),this.origin)}},{key:"fetch",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.connecting&&!this.connected)throw"No connection, please call connect() first";this.on(t,function t(i){o&&n.off(i.type,t),e(i)}),this.send(t,i)}},{key:"respond",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.on(t,function o(r){i&&e.off(r.type,o),e.send(t,"function"==typeof n?n():n)})}},{key:"destroy",value:function(){(function t(e,n,i){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:t(r,n,i)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.disconnect(),this._sendLater.length=0}},{key:"target",get:function(){return this.isChild?window.parent:this.iframe.contentWindow}}]),e}()),Fa=(function(){function t(){wa(this,t),this.listeners=[]}Oa(t,[{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3;t?(this.length=t,this.timer=setTimeout(this.dispatch.bind(this),t)):_a.log("warn","[IdleTimer.start()] must specify a time!")}},{key:"reset",value:function(){this.timer?(clearTimeout(this.timer),this.timer=setTimeout(this.dispatch.bind(this),this.length)):_a.log("warn","[IdleTimer.reset()] timer has not been started")}},{key:"stop",value:function(){this.timer?(clearTimeout(this.timer),this.timer=null):_a.log("warn","[IdleTimer.reset()] timer has not been started")}},{key:"dispatch",value:function(){for(var t=0;t<this.listeners.length;t++)this.listeners[t](this._value);this.reset()}},{key:"subscribe",value:function(t){this.listeners.push(t)}},{key:"unsubscribe",value:function(t){this.listeners=this.listeners.filter(function(e){return e!==t})}}])}(),function t(){wa(this,t),"function"!=typeof this.play&&console.error('Springroll Hint Player not implemented correctly. Please ensure you have a "play" function in your class.')}),La=function(t){function e(){var t;return wa(this,e),(t=Ca(this,Pa(e).call(this))).hints=[],t.index=0,t}return Sa(e,Fa),Oa(e,[{key:"play",value:function(){0!=this.hints.length?(this.index>=this.hints.length&&(this.index=0),this.hints[this.index](),this.index++):_a.log("warn","[HintSequencePlayer.play()] No hints?!")}},{key:"clear",value:function(){this.index=0,this.hints.length=0}},{key:"add",value:function(){for(var t=arguments.length,e=0;e<t;e++)this.hints.push(e<0||arguments.length<=e?void 0:arguments[e])}},{key:"remove",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(var o=n.length,r=function(e){t.hints=t.hints.filter(function(t){return t!==n[e]})},a=0;a<o;a++)r(a)}}]),e}(),Ma=function(){function t(e){wa(this,t),this._value=e,this.listeners=[]}return Oa(t,[{key:"subscribe",value:function(t){this.listeners.push(t)}},{key:"unsubscribe",value:function(t){this.listeners=this.listeners.filter(function(e){return e!==t})}},{key:"value",get:function(){return this._value},set:function(t){var e=this._value;this._value=t;for(var n=0;n<this.listeners.length;n++)this.listeners[n](this._value,e)}},{key:"hasListeners",get:function(){return this.listeners.length>0}}]),t}(),Da=Symbol("onReturn"),Na=(function(){function t(){wa(this,t)}Oa(t,null,[{key:Da,value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;return new Promise(function(i,o){var r=!1,a=0,s=function e(n){Ia.off(t,e),r=!0,i(n)};Ia.on(t,s),Ia.send(t,e);var c=setInterval(function(){r?clearInterval(c):(a>=n&&(clearInterval(c),Ia.off(t,s),o("No Response")),a++)},100)})}},{key:"read",value:function(t){var e="Could not complete read action for ".concat(t,". Bellhop is not connected.");return Ia.connected?this[Da]("userDataRead",{}):new Promise(function(t,n){return n(e)})}},{key:"write",value:function(t,e){var n="Could not complete write action for ".concat(t," with value ").concat(e,". Bellhop is not connected.");return Ia.connected?this[Da]("userDataWrite",{name:t,value:e}):new Promise(function(t,e){return e(n)})}},{key:"delete",value:function(t){var e="Could not complete delete action for ".concat(t,". Bellhop is not connected.");Ia.connected?Ia.send("userDataRemove",{name:t}):console.warn(e)}}])}(),function(){function t(e){wa(this,t),this.width=1,this.height=1,this.callback=e,this.onResize=this.onResize.bind(this),e instanceof Function&&this.enable(e)}Oa(t,[{key:"onResize",value:function(t){var e=this,n=function(){var n=t.target.innerWidth,i=t.target.innerHeight;e.callback({width:n,height:i,ratio:n/i}),e.width=n,e.height=i};n(),setTimeout(n,500)}},{key:"enable",value:function(t){t instanceof Function?(this.callback=t,window.addEventListener("resize",this.onResize)):console.warn("Scale Manager was not passed a function")}},{key:"disable",value:function(){window.removeEventListener("resize",this.onResize)}}])}(),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.voice,i=void 0===n?0:n,o=e.rate,r=void 0===o?1:o,a=e.pitch,s=void 0===a?0:a,c=e.volume,u=void 0===c?1:c;if(wa(this,t),window.speechSynthesis){this.voiceOptions=[],this.voicesLoaded=!1,this.queue=[],this.options={voice:{},rate:r,pitch:s,volume:u};var l=function(){this.voiceOptions=window.speechSynthesis.getVoices(),this.voice=this.setVoice(i),this.voicesLoaded=!0}.bind(this),h=window.speechSynthesis.getVoices();Array.isArray(h)&&0<h.length?l():window.speechSynthesis.addEventListener("voiceschanged",l,{once:!0})}else console.error("Springroll SpeechSynth is not supported on on this Device")}Oa(t,[{key:"pause",value:function(){this.speaking=!1,window.speechSynthesis.pause()}},{key:"resume",value:function(){this.speaking=!0,window.speechSynthesis.resume()}},{key:"cancel",value:function(){this.speaking=!1,this.pause(),this.queue.length=0,window.speechSynthesis.cancel()}},{key:"say",value:function(t){var e=this;if(!this.speaking&&this.voicesLoaded){this.speaking=!0;var n=new SpeechSynthesisUtterance(t);Object.assign(n,this.options),n.onend=function(){e.speaking=!1,0<e.queue.length&&e.say(e.queue.shift())},window.speechSynthesis.speak(n)}else this.queue.push(t)}},{key:"rangeLimit",value:function(t,e,n){return isNaN(n)?(console.warn("'".concat(n,"' is not a valid number!")),t):n>=e?e:t>=n?t:n}},{key:"setVoice",value:function(t){this.options.voice=this.voiceOptions[t]}},{key:"getVoice",value:function(){return this.options.voice}},{key:"rate",set:function(t){this.options.rate=this.rangeLimit(.1,10,t)},get:function(){return this.options.rate}},{key:"pitch",set:function(t){this.options.pitch=this.rangeLimit(0,2,t)},get:function(){return this.options.pitch}},{key:"volume",set:function(t){this.options.volume=this.rangeLimit(0,1,t)},get:function(){return this.options.volume}}])}(),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(wa(this,t),xa)console.error("Springroll ColorFilter is not supported on IE11");else{if(this.element=null,null===document.getElementById("color__filter__svg")){var i=document.createElement("div");i.style.width="0",i.style.height="0",i.style.position="absolute",i.style.opacity="0",i.innerHTML+='<svg id="color__filter__svg" style="width: 0; height: 0; position: absolute;" xmlns="http://www.w3.org/2000/svg"\n      version="1.1">\n      <defs>\n        <filter id="color__filter__protanopia">\n          <feColorMatrix\n            in="SourceGraphic"\n            type="matrix"\n            values="0.567, 0.433, 0,     0, 0\n                    0.558, 0.442, 0,     0, 0\n                    0,     0.242, 0.758, 0, 0\n                    0,     0,     0,     1, 0"/>\n        </filter>\n        <filter id="color__filter__protanomaly">\n          <feColorMatrix\n            in="SourceGraphic"\n            type="matrix"\n            values="0.817, 0.183, 0,     0, 0\n                    0.333, 0.667, 0,     0, 0\n                    0,     0.125, 0.875, 0, 0\n                    0,     0,     0,     1, 0"/>\n        </filter>\n        <filter id="color__filter__deuteranopia">\n          <feColorMatrix\n            in="SourceGraphic"\n            type="matrix"\n            values="0.625, 0.375, 0,   0, 0\n                    0.7,   0.3,   0,   0, 0\n                    0,     0.3,   0.7, 0, 0\n                    0,     0,     0,   1, 0"/>\n        </filter>\n        <filter id="color__filter__deuteranomaly">\n          <feColorMatrix\n            in="SourceGraphic"\n            type="matrix"\n            values="0.8,   0.2,   0,     0, 0\n                    0.258, 0.742, 0,     0, 0\n                    0,     0.142, 0.858, 0, 0\n                    0,     0,     0,     1, 0"/>\n        </filter>\n        <filter id="color__filter__tritanopia">\n          <feColorMatrix\n            in="SourceGraphic"\n            type="matrix"\n            values="0.95, 0.05,  0,     0, 0\n                    0,    0.433, 0.567, 0, 0\n                    0,    0.475, 0.525, 0, 0\n                    0,    0,     0,     1, 0"/>\n        </filter>\n        <filter id="color__filter__tritanomaly">\n          <feColorMatrix\n            in="SourceGraphic"\n            type="matrix"\n            values="0.967, 0.033, 0,     0, 0\n                    0,     0.733, 0.267, 0, 0\n                    0,     0.183, 0.817, 0, 0\n                    0,     0,     0,     1, 0"/>\n        </filter>\n        <filter id="color__filter__achromatopsia">\n          <feColorMatrix\n            in="SourceGraphic"\n            type="matrix"\n            values="0.299, 0.587, 0.114, 0, 0\n                    0.299, 0.587, 0.114, 0, 0\n                    0.299, 0.587, 0.114, 0, 0\n                    0,     0,     0,     1, 0"/>\n        </filter>\n        <filter id="color__filter__achromatomaly">\n          <feColorMatrix\n            in="SourceGraphic"\n            type="matrix"\n            values="0.618, 0.320, 0.062, 0, 0\n                    0.163, 0.775, 0.062, 0, 0\n                    0.163, 0.320, 0.516, 0, 0\n                    0,     0,     0,     1, 0"/>\n        </filter>\n      </defs>\n      </svg>\n      ',document.body.appendChild(i)}e instanceof HTMLElement&&"string"==typeof n&&this.applyFilter(e,n)}}Oa(t,[{key:"applyFilter",value:function(t,e){this.element=t,this.changeFilter(e)}},{key:"changeFilter",value:function(t){null!==this.element&&(this.element.style.filter="url(#color__filter__".concat(t,")"))}},{key:"removeFilter",value:function(){this.element.style.filter=null}},{key:"types",get:function(){return[{name:"Protanopia",value:"protanopia"},{name:"Protanomaly",value:"protanomaly"},{name:"Deuteranopia",value:"deuteranopia"},{name:"Deuteranomaly",value:"deuteranomaly"},{name:"Tritanopia",value:"tritanopia"},{name:"Tritanomaly",value:"tritanomaly"},{name:"Achromatopsia",value:"achromatopsia"},{name:"Achromatomaly",value:"achromatomaly"}]}}])}(),function(){function t(e,n,i){wa(this,t),this.key=e,this._state=0,this.actions={up:i,down:n}}return Oa(t,[{key:"updateState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t<3&&t>-1&&(this._state=t)}},{key:"action",value:function(){1===this.state?this.actions.down&&this.actions.down():2===this.state&&(this.actions.up&&this.actions.up(),this.updateState(0))}},{key:"state",get:function(){return this._state}}]),t}()),Ka=(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];wa(this,t),this.assignButtons(e),window.addEventListener("keydown",this.onKeyDown.bind(this)),window.addEventListener("keyup",this.onKeyUp.bind(this))}Oa(t,[{key:"update",value:function(){for(var t=0,e=this.keys.length;t<e;t++)this.buttons[this.keys[t]].action()}},{key:"onKeyDown",value:function(t){this.onKey(t,1)}},{key:"onKeyUp",value:function(t){this.onKey(t,2)}},{key:"assignButtons",value:function(t){this.buttons={},this.keys=[];for(var e=0,n=t.length;e<n;e++){var i=t[e].key.toLowerCase();this.keys.push(i),this.buttons[i]=new Na(i,t[e].down,t[e].up)}}},{key:"onKey",value:function(t,e){var n=t.key.toLowerCase();this.buttons[n]&&this.buttons[n].updateState(e)}}])}(),"pause"),Ba="captionsMuted",Va="soundVolume",za="musicVolume",Ua="voVolume",Ga="sfxVolume",Ha="playHelp",Wa=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.features,o=n.hintPlayer,r=void 0===o?new La:o;wa(this,t),this.state={ready:new Ma(!1),pause:new Ma(!1),captionsMuted:new Ma(!0),playOptions:new Ma({}),soundVolume:new Ma(1),musicVolume:new Ma(1),voVolume:new Ma(1),sfxVolume:new Ma(1)},this.features=Object.assign({captions:!1,sound:!1,vo:!1,music:!1,sfx:!1,soundVolume:!1,musicVolume:!1,voVolume:!1,sfxVolume:!1},i||{}),(this.features.vo||this.features.music||this.features.sfx)&&(this.features.sound=!0),this.container=Ia,this.container.connect(),this.container.send("features",this.features),this.container.send("keepFocus",!1);for(var a=[Va,za,Ua,Ga,Ba,Ka],s=a.length,c=function(t){var n=e.state[a[t]];e.container.on(a[t],function(t){return n.value=t.data})},u=0;u<s;u++)c(u);var l=[{mute:"soundMuted",volume:Va},{mute:"musicMuted",volume:za},{mute:"voMuted",volume:Ua},{mute:"sfxMuted",volume:Ga}],h=function(t){var n=e.state[l[t].volume];e.container.on(l[t].mute,function(t){var e=n._previousValue||1;n._previousValue=n.value,n.value=t.data?0:e})};for(u=0;u<l.length;u++)h(u);window.addEventListener("focus",function(){return e.container.send("focus",!0)}),window.addEventListener("blur",function(){return e.container.send("focus",!1)});var f=/playOptions=[^&$]*/.exec(window.location.search);if(null!==f){var p=f[0],y=decodeURIComponent(p.split("=")[1]);try{this.state.playOptions.value=JSON.parse(y)}catch(t){_a.log("warn","Failed to parse playOptions from query string:"+t.message)}}this.container.fetch("playOptions",function(t){return e.state.playOptions.value=t.data}),this.setupPlugins().catch(function(t){_a.log("warn",t)}).then(function(){e.validateListeners()}).catch(function(t){_a.log("warn",t)}).then(function(){e.container.send("loaded"),e.state.ready.value=!0}),this.hints=r,this.container.on(Ha,function(){e.hints?e.hints.play():_a.log("warn","[Springroll] Missing IHintPlayer see: https://github.com/SpringRoll/SpringRoll/tree/v2/src/hints")})}return Oa(t,[{key:"setupPlugins",value:function(){for(var e=this,n=[],i=function(i){t._plugins[i].preload&&n.push(t._plugins[i].preload(e).catch(function(e){t._plugins[i].preloadFailed=!0,console.warn(t._plugins[i].name,"Preload Failed:",e)}))},o=0;o<t._plugins.length;o++)i(o);return Promise.all(n).then(function(){t._plugins=t._plugins.filter(function(t){return!0!==t.preloadFailed});for(var n=0;n<t._plugins.length;n++)t._plugins[n].init&&t._plugins[n].init(e);for(var i=0;i<t._plugins.length;i++)t._plugins[i].start&&t._plugins[i].start(e)})}},{key:"getPlugin",value:function(e){return t.getPlugin(e)}},{key:"validateListeners",value:function(){for(var t=[],e={captions:Ba,sound:Va,music:za,vo:Ua,sfx:Ga},n=Object.keys(e),i=0;i<n.length;i++){var o=e[n[i]];this.features[n[i]]&&!this.state[o].hasListeners&&t.push(o)}if(this.state.pause.hasListeners||t.push("pause"),t.length)throw new Error("Application state is missing required listeners: "+t.join(", ")+".")}}]),t}();Wa._plugins=[],Wa.uses=function(t){Wa._plugins.push(t)},Wa.getPlugin=function(t){return Wa._plugins.find(function(e){return e.name===t})};var qa=function(){function t(e){wa(this,t),this.lines=e,this.lines.sort(function(t,e){return t.endTime<e.endTime?-1:t.endTime>e.endTime?1:0}),this.reset()}return Oa(t,[{key:"reset",value:function(){this.time=0,this.lineIndex=0,this.renderer=null}},{key:"update",value:function(t){var e=this.time+1e3*t;e!==this.time&&(this.updateState(e,this.time),this.time=e)}},{key:"updateState",value:function(t,e){if(!this.isFinished()){for(t>this.lines[this.lineIndex].endTime&&this.renderer.lineEnd();t>this.lines[this.lineIndex].endTime;)if(this.lineIndex++,this.isFinished())return;var n=this.lines[this.lineIndex];t>=n.startTime&&e<n.startTime&&this.renderer.lineBegin(n)}}},{key:"isFinished",value:function(){return this.lineIndex>=this.lines.length}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{lineBegin:function(){},lineEnd:function(){}};this.reset(),this.renderer=e,this.updateTimeIndex(t),this.updateState(this.time,this.lines[this.lineIndex].startTime-1)}},{key:"updateTimeIndex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.time=t,!this.isFinished())for(var e=this.lines.length-1;e>-1;e--)if(this.lines[e].startTime<=t){this.lineIndex=e;break}}}]),t}(),Xa=function(){function t(e,n,i){wa(this,t),this.startTime=e||0,this.endTime=n||0,this.content="",this.setContent(i)}return Oa(t,[{key:"setContent",value:function(t){this.content=t}}]),t}(),Ya=function(){function t(){wa(this,t)}return Oa(t,null,[{key:"createCaptionMap",value:function(t){var e={};for(var n in t){var i=this.createCaption(t[n]);i?e[n]=i:_a.log("error","[CaptionFactory.createCaptionMap] failed to create caption:",n)}return e}},{key:"createCaption",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var o=this.createLine(t[n]);o&&e.push(o)}if(!(e.length<=0))return new qa(e);_a.log("error","[CaptionFactory.createCaption] captions should not have 0 lines.")}},{key:"createLine",value:function(t){if("number"==typeof t.start)if("number"==typeof t.end)if("string"==typeof t.content){if(""!==t.content)return new Xa(t.start,t.end,t.content);_a.log("warn","[CaptionFactory.createLine] lineData.content should not be empty","Its recommended to add time to the start of the next line to add delays.")}else _a.log("error","[CaptionFactory.createLine] lineData.content must be defined as a string");else _a.log("error","[CaptionFactory.createLine] lineData.end must be defined as a number");else _a.log("error","[CaptionFactory.createLine] lineData.start must be defined as a number")}}]),t}(),Ja=function(){function t(e,n){wa(this,t),this.captions=Ya.createCaptionMap(e),this.renderer=n,this.activeCaption=null}return Oa(t,[{key:"update",value:function(t){this.activeCaption&&(this.activeCaption.update(t),this.activeCaption.isFinished()&&this.stop())}},{key:"start",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.stop(),this.activeCaption=this.captions[t],this.activeCaption)return this.renderer.start(n),void this.activeCaption.start(e,this.renderer);_a.log("warn","[CaptionPlayer.Start()] caption ".concat(t," not found"))}},{key:"stop",value:function(){this.activeCaption&&this.renderer.stop&&this.renderer.stop(),this.activeCaption=null}}]),t}(),Qa=function t(){wa(this,t),"function"==typeof this.start&&"function"==typeof this.stop&&"function"==typeof this.lineBegin&&"function"==typeof this.lineEnd||console.error('Springroll Caption Renderer not implemented corrected. Please ensure you have a "start", "end", "lineBegin", and "lineEnd" function in your class.')},$a=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return wa(this,e),n=Ca(this,Pa(e).call(this)),t instanceof HTMLElement||console.error("Invalid html element provided to renderer"),n.renderTarget=t,n.templateVariables=i,n}return Sa(e,Qa),Oa(e,[{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderTarget.style.visibility="visible",this.templateVariables=t}},{key:"stop",value:function(){this.renderTarget.style.visibility="hidden",this.templateVariables={}}}]),e}();function Za(t,e){return t.replace(/{{([a-zA-Z][A-Za-z0-9]*)}}/g,function(t,n){return e[n]||t})}var ts=function(t){function e(){return wa(this,e),Ca(this,Pa(e).apply(this,arguments))}return Sa(e,$a),Oa(e,[{key:"lineBegin",value:function(t){this.renderTarget.innerHTML=Za(t.content,this.templateVariables)}},{key:"lineEnd",value:function(){this.renderTarget.innerHTML=""}}]),e}();(function(t){function e(){return wa(this,e),Ca(this,Pa(e).apply(this,arguments))}Sa(e,$a),Oa(e,[{key:"lineBegin",value:function(t){this.renderTarget.innerText=this.sanitize(Za(t.content,this.templateVariables))}},{key:"lineEnd",value:function(){this.renderTarget.textContent=""}},{key:"sanitize",value:function(t){var e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""}}])})(),function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};wa(this,t),this.locales=e.locales,this.setPrimaryLocale(n.language||this.getBrowsersLocaleKey()||e.default),this.setFallbackLocale(n.fallback||e.default)}Oa(t,[{key:"resolve",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.language?this.getLocaleKey(e.language):this.primaryLanguage,i=this.getLocaleKey(e.fallback)||this.fallbackLanguage,o=this.locales[n],r=this.locales[i];return o?{path:o.path+t,language:n}:r?{path:r.path+t,language:i}:void 0}},{key:"setPrimaryLocale",value:function(t){var e=this.getLocaleKey(t);return!!e&&(this.primaryLanguage=e,!0)}},{key:"setFallbackLocale",value:function(t){var e=this.getLocaleKey(t);return!!e&&(this.fallbackLanguage=e,!0)}},{key:"getLocaleKey",value:function(t){if(t){var e=t.toLowerCase();if(this.locales[e])return e;if(e.indexOf("-")>0)return e=e.split("-")[0],this.getLocaleKey(e)}}},{key:"getBrowsersLocaleKey",value:function(){for(var t=this.getBrowserLanguages(),e=0,n=t.length;e<n;e++){var i=this.getLocaleKey(t[e]);if(i)return i}}},{key:"getBrowserLanguages",value:function(){return navigator.languages?navigator.languages:navigator.language?[navigator.language||navigator.userLanguage]:[]}}])}(),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(wa(this,t),void 0===e.name)throw new Error("Application plugin not provided a name field");this.name=e.name}Oa(t,[{key:"preload",value:function(){return Promise.resolve()}},{key:"init",value:function(){}},{key:"start",value:function(){}}])}();function es(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ns=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"numbers",value:function(t,e){return t=Math.min(t,e),e=Math.max(t,e),Array(e-t+1).fill(0).map(function(e,n){return t+n})}},{key:"clamp",value:function(t,e,n){return e=Math.min(e,n),n=Math.max(e,n),Math.min(Math.max(t,e),n)}},{key:"lerp",value:function(t,e,n){return(1-n)*t+n*e}},{key:"distance",value:function(t,e,n,i){var o=t-n,r=e-i;return this.magnitude(o,r)}},{key:"sign",value:function(t){return 0===t?0:t>0?1:-1}},{key:"calculateArcFrom",value:function(t,e,n,i){var o=Math.abs(e-t),r=Math.abs(i-n);return.5*r+o*o/(8*r)}},{key:"mod",value:function(t,e){return(e+t%e)%e}},{key:"magnitude",value:function(t,e){return Math.sqrt(t*t+e*e)}},{key:"normalize",value:function(t,e){var n=this.magnitude(t,e);return{x:t/n,y:e/n}}},{key:"clampMagnitude",value:function(t,e,n){var i=this.magnitude(t,e);if(i>n){var o=n/i;t*=o,e*=o}return{x:t,y:e}}},{key:"bresenhamLine",value:function(t,e,n,i){var o=[],r=(n|=0)-(t|=0),a=(i|=0)-(e|=0),s=Math.abs(r),c=Math.abs(a);if(c<=s){if(r<0){var u=t;t=n,e=i,n=u}o.push({x:t,y:e});for(var l=2*c-s,h=t;h<n;h++)++t,l<0?l+=2*c:(r<0&&a<0||r>0&&a>0?++e:--e,l+=2*(c-s)),o.push({x:t,y:e})}else{if(a<0){var f=e;t=n,e=i,i=f}o.push({x:t,y:e});for(var p=2*s-c,y=e;y<i;y++)++e,p<=0?p+=2*s:(r<0&&a<0||r>0&a>0?++t:--t,p+=2*(s-c)),o.push({x:t,y:e})}return o}}])&&es(e.prototype,n),i&&es(e,i),t}());function is(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Assertion Failed";throw new Error(t)}function os(t){return null!=t}function rs(t){var e=null,n=null;for(e=t.shift();t.length>0;){if(n=t.shift(),!os(e)||!os(n)||!os(e[n]))return null;e=e[n]}return e}function as(t,e){var n=rs(t);return null!==n?n:e}function ss(t,e){var n=rs(t);return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Assertion Failed";if(t)return t;throw new Error(e)}(os(n),e),n}var cs=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=null!=n?n.index+n.duration:0,this.duration=rs([e,"duration"]),this.symbolName=rs([e,"ref"]),this.label=rs([e,"label"]);var i=as([e,"loc"],[0,0]),o=as([e,"scale"],[1,1]),r=as([e,"skew"],[0,0]),a=as([e,"pivot"],[0,0]);this.x=i[0],this.y=i[1],this.scaleX=o[0],this.scaleY=o[1],this.skewX=r[0],this.skewY=r[1],this.pivotX=a[0],this.pivotY=a[1],this.alpha=as([e,"alpha"],1),this.ease=as([e,"ease"],0),this.visible=as([e,"visible"],!0),this.tweened=as([e,"tweened"],!0)};function us(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ls=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=ss([e,"name"],"[FlumpLayerSymbol] Cannot find FlumpLayerSymbol name");var n=ss([e,"keyframes"],"[FlumpLayerSymbol] Cannot find keyframes."),i=as([n,"length"],0);this.keyframes=new Array(i),this.frames=0;for(var o=null,r=0;r<i;r++)o=new cs(n[r],o),this.keyframes[r]=o;this.frames=null!=o?o.index+o.duration:0}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){if(null!=this.keyframes){for(;this.keyframes.length>0;)this.keyframes[0]=null,this.keyframes.shift();this.keyframes=null}this.game=null}}])&&us(e.prototype,n),i&&us(e,i),t}();function hs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var fs=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=ss([n,"id"],"[FlumpMovieSymbol] Cannot find id."),this.frames=0;var i=ss([n,"layers"],"[FlumpMovieSymbol] Cannot find layers."),o=as([i,"length"],0);this.layers=new Array(o);for(var r=0;r<o;r++){var a=new ls(i[r]);this.layers[r]=a,this.frames=Math.max(a.frames,this.frames)}this.frameRate=e.frameRate,this.duration=this.frames/this.frameRate}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){if(null!=this.layers)for(;this.layers.length>0;)this.layers[0].destroy(),this.layers.shift();this.game=null}}])&&hs(e.prototype,n),i&&hs(e,i),t}();function ps(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ys=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e;var o=ss([i,"rect"],"[FlumpTextureSymbol] Cannot find texture rect in json."),r=ss([o,0],"[FlumpTextureSymbol] Cannot find rect x in json."),a=ss([o,1],"[FlumpTextureSymbol] Cannot find rect y in json."),s=ss([o,2],"[FlumpTextureSymbol] Cannot find rect with in json."),c=ss([o,3],"[FlumpTextureSymbol] Cannot find rect height in json.");this.name=ss([i,"symbol"],"[FlumpTextureSymbol] Cannot find texture name."),this.rect=o,this.origin=[ss([i,"origin",0],"[FlumpTextureSymbol] Cannot find origin x."),ss([i,"origin",1],"[FlumpTextureSymbol] Cannot find origin y.")],this.bitmap=e.make.bitmapData(s,c),this.bitmap.copyRect(n,new Phaser.Rectangle(r,a,s,c),0,0),e.cache.addBitmapData(this.name,this.bitmap)}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){this.game.cache.removeBitmapData(this.name),this.bitmap.destroy(),this.bitmap=null,this.game=null}}])&&ps(e.prototype,n),i&&ps(e,i),t}();function ds(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var vs=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);ss([n,"file"],"[FlumpAtlasSymbol] Cannot find file in atlas data.");var o=ss([n,"textures"],"[FlumpAtlasSymbol] Cannot find textures in atlas data."),r=as([o,"length"],0);this.atlas=e.cache.getImage(i+n.file),this.textureMap=new Array(r),this.textures={};for(var a=0;a<r;a++)this.textureMap[a]=o[a].symbol,this.textures[this.textureMap[a]]=new ys(e,this.atlas,o[a])}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){if(this.atlas=null,null!=this.textureMap){for(;this.textureMap.length>0;)null!=this.textures&&this.textures.hasOwnProperty(this.textureMap[0])&&(this.textures[this.textureMap[0]].destroy(),delete this.textures[this.textureMap[0]]),this.textureMap.shift();this.textureMap=null,this.textures=null}this.game=null}}])&&ds(e.prototype,n),i&&ds(e,i),t}();function ms(t){return(ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function bs(t,e){return!e||"object"!==ms(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ws(t,e,n){return(ws="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ks(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ks(t){return(ks=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Os(t,e){return(Os=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ss=function(t){function e(t,n,i,o){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=bs(this,ks(e).call(this,t))).flumpLibrary=o,r.currentSprite=null,r.skewX=0,r.skewY=0,r.name="FlumpLayer",r.setupLayer(n,i),r}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Os(t,e)}(e,Phaser.Image),n=e,(i=[{key:"destroy",value:function(t){this.flumpLibrary=null,this.movieClip=null,this.layer=null,ws(ks(e.prototype),"destroy",this).call(this,t)}},{key:"setupLayer",value:function(t,e){this.layer=t,this.keyframes=this.layer.keyframes,this.finalFrame=this.keyframes.length-1,this.movieClip=e,this.frameRate=this.movieClip.frameRate,this.duration=this.movieClip.duration,this.playbackSpeed=1,this._paused=!1,this.visible=!0,this.enabled=!0,this.setActive(!0),this.currentFrame=0,this.currentIndex=0,this.currentKeyFrame=this.keyframes[this.currentIndex],this.currentDuration=0,this.currentTime=0,this.nextKeyframe(),this.updateChildTransform(this.currentKeyFrame.x,this.currentKeyFrame.y,this.currentKeyFrame.pivotX,this.currentKeyFrame.pivotY,this.currentKeyFrame.skewX,this.currentKeyFrame.skewY,this.currentKeyFrame.scaleX,this.currentKeyFrame.scaleY,this.currentKeyFrame.alpha)}},{key:"changeFrame",value:function(t){this.currentSprite!=t&&(this.currentSprite=t,null!=this.currentSprite?(this.loadTexture(this.game.cache.getBitmapData(this.currentSprite)),this.visible=!0):this.visible=!1)}},{key:"goto",value:function(t,e,n){this.playbackSpeed=e,this.currentFrame!=t&&(t<this.currentFrame&&(this.currentIndex=0,this.currentDuration=0,this.currentFrame=0,this.currentTime-=this.currentKeyFrame.duration,this.nextKeyframe()),this.composeFrame(t,n))}},{key:"composeFrame",value:function(t,e){if(this.currentFrame=t,t>=this.layer.frames)return this.visible=!1,this.currentIndex=this.finalFrame,void(this.keyframeUpdate=!0);for(;this.currentDuration<=this.currentFrame;)this.currentIndex++,this.nextKeyframe();var n=this.keyframes[this.currentIndex],i=n.visible&&null!=n.symbolName;if(this.visible=i,i){var o=n.x,r=n.y,a=n.scaleX,s=n.scaleY,c=n.skewX,u=n.skewY,l=n.alpha;if(n.tweened&&this.currentIndex<this.finalFrame&&null!=this.keyframes[this.currentIndex+1].symbolName){var h=(this.currentFrame-n.index)/n.duration,f=n.ease;if(0!=f){var p;if(f<0){var y=1-h;p=1-y*y,f=-f}else p=h*h;h=f*p+(1-f)*h}var d=this.keyframes[this.currentIndex+1];o+=(d.x-o)*h,r+=(d.y-r)*h,a+=(d.scaleX-a)*h,s+=(d.scaleY-s)*h,c+=(d.skewX-c)*h,u+=(d.skewY-u)*h,l+=(d.alpha-l)*h}this.updateChildTransform(o,r,this.currentKeyFrame.pivotX,this.currentKeyFrame.pivotY,c,u,a,s,l)}}},{key:"nextKeyframe",value:function(){this.currentIndex>=this.keyframes.length?(this.currentIndex=0,this.currentDuration=0,this.currentFrame=0,this.currentTime-=this.currentKeyFrame.duration):this.currentTime=0,this.currentKeyFrame=this.keyframes[this.currentIndex],this.currentDuration+=this.currentKeyFrame.duration,null!=this.currentKeyFrame.symbolName?(this.visible=!0,this.changeFrame(this.currentKeyFrame.symbolName)):this.visible=!1}},{key:"updateChildTransform",value:function(t,e,n,i,o,r,a,s,c){this.visible&&(this.position.set(t,e),this.pivot.set(n,i),this.skewX=o,this.skewY=r,this.scale.set(a,s),this.alpha=c)}},{key:"setActive",value:function(t){this.visible=t,this.enabled=t}},{key:"checkSpriteExist",value:function(t){return this.game.cache.checkBitmapDataKey(t)}},{key:"setChildVisible",value:function(t,e){null!=t&&(t.visible=e)}},{key:"updateTransform",value:function(t){if(t||this.parent||this.game){var e=this.parent;t?e=t:this.parent||(e=this.game.world);var n,i,o,r,a,s,c=e.worldTransform,u=this.worldTransform;this.rotation%PIXI.PI_2||this.skewX||this.skewY?(n=this.scale.x*Math.cos(this.rotation+this.skewY),i=this.scale.x*Math.sin(this.rotation+this.skewY),o=this.scale.y*Math.sin(-this.rotation-this.skewX),r=this.scale.y*Math.cos(this.rotation+this.skewX),a=this.position.x,s=this.position.y,(this.pivot.x||this.pivot.y)&&(a-=this.pivot.x*n+this.pivot.y*o,s-=this.pivot.x*i+this.pivot.y*r),u.a=n*c.a+i*c.c,u.b=n*c.b+i*c.d,u.c=o*c.a+r*c.c,u.d=o*c.b+r*c.d,u.tx=a*c.a+s*c.c+c.tx,u.ty=a*c.b+s*c.d+c.ty):(n=this.scale.x,r=this.scale.y,a=this.position.x-this.pivot.x*n,s=this.position.y-this.pivot.y*r,u.a=n*c.a,u.b=n*c.b,u.c=r*c.c,u.d=r*c.d,u.tx=a*c.a+s*c.c+c.tx,u.ty=a*c.b+s*c.d+c.ty),this.worldAlpha=this.alpha*e.worldAlpha,this.worldPosition.set(u.tx,u.ty),this.worldScale.set(Math.sqrt(u.a*u.a+u.b*u.b),Math.sqrt(u.c*u.c+u.d*u.d)),this.worldRotation=Math.atan2(-u.c,u.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,u,c)}}},{key:"paused",get:function(){return this._paused},set:function(t){this._paused=t}}])&&gs(n.prototype,i),o&&gs(n,o),e}();function Ps(t){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _s(t,e){return!e||"object"!==Ps(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xs(t,e,n){return(xs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=js(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function js(t){return(js=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Es(t,e){return(Es=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ts=function(t){function e(t,n,i){var o,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=_s(this,js(e).call(this,t))).movieClips=n,o.flumpLibrary=i,o.name="FlumpClip",o.layers=[],o.currentLayers=[],o.subSprites=[],o.subClips=[],o.currentClip=null,o.playbackSpeed=1,o.looping=0,o._paused=!1,o.framePosition=0,o.duration=0,o.fallbackLoop=null,o.skewX=0,o.skewY=0,o.onComplete=new Phaser.Signal,o.onLoop=new Phaser.Signal,null!=r&&o.playClip(r),o}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Es(t,e)}(e,Phaser.Image),n=e,(i=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.flumpLibrary=null,this.movieClips=null,this.currentClip=null,this.layers=null,this.currentLayers=null,this.subSprites=null,this.subClips=null,null!=this.onComplete&&(this.onComplete.dispose(),this.onComplete=null),null!=this.onLoop&&(this.onLoop.dispose(),this.onLoop=null),xs(js(e.prototype),"destroy",this).call(this,t)}},{key:"play",value:function(t){t=this.setDefaults(t,{clip:null,looping:0,restart:!1,fallback:null,callback:null}),(null!=this.currentClip&&t.clip!=this.currentClip.name||t.restart)&&(this.looping=t.looping,this.onComplete.removeAll(),t.callback&&this.onComplete.addOnce(t.callback.listener,t.callback.context),0!=this.looping&&null==this.fallbackLoop?this.fallbackLoop=this.currentClip.name:this.fallbackLoop=t.fallback,this.playClip(t.clip))}},{key:"playOnce",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(null!=this.currentClip&&t!=this.currentClip.name||n)&&(0==e&&(this.fallbackLoop=null),this.looping=0,this.playClip(t))}},{key:"loop",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(null!=this.currentClip&&t!=this.currentClip.name||null==this.currentClip||e)&&(this.looping=-1,this.playClip(t),this.fallbackLoop=this.currentClip.name)}},{key:"update",value:function(){if(xs(js(e.prototype),"update",this).call(this),!this._paused&&null!=this.currentClip){this.framePosition+=this.game.time.elapsedMS/1e3*this.playbackSpeed;var t=this.framePosition*this.currentClip.frameRate;this.framePosition>this.duration-1/this.currentClip.frameRate*.5?(this.framePosition=this.framePosition%this.duration,0==this.looping?(null==this.fallbackLoop?(this.framePosition=this.duration-1/this.currentClip.frameRate,t=this.framePosition*this.currentClip.frameRate,this.updateSubSprites(t),this._paused=!0):(this.loop(this.fallbackLoop),this.fallbackLoop=null),this.onComplete.dispatch()):(this.looping>0&&this.looping--,this.onLoop.dispatch())):this.updateSubSprites(t)}}},{key:"updateSubSprites",value:function(t){for(var e=0;e<this.subSprites.length;e++)this.subSprites[e].enabled&&this.subSprites[e].goto(t,this.playbackSpeed);for(e=0;e<this.subClips.length;e++)this.subClips[e].enabled&&(this.subClips[e].update(),this.subClips[e].goto(t,this.playbackSpeed))}},{key:"playClip",value:function(t){var e=this.movieClips[t];if(null!=e){for(var n=0,i=0,o=0;o<e.layers.length;o++)if(this.isSubClip(e.layers[o])){if(n<this.subClips.length)this.subClips[n].setupClip(e.layers[o],e),this.setChildIndex(this.subClips[n],o);else{var r=this.flumpLibrary.createSubClip(e.layers[o].keyframes[0].symbolName,e.layers[o],e);r.visible=!1,this.subClips.push(r),this.addChild(r),this.setChildIndex(r,o)}n++}else{if(i<this.subSprites.length)this.subSprites[i].setupLayer(e.layers[o],e),this.setChildIndex(this.subSprites[i],o);else{var a=new Ss(this.game,e.layers[o],e,this.flumpLibrary);this.subSprites.push(a),this.addChild(a),this.setChildIndex(a,o)}i++}if(this.subClips.length>n)for(o=n;o<this.subClips.length;o++)this.subClips[o].setActive(!1);if(this.subSprites.length>i)for(o=i;o<this.subSprites.length;o++)this.subSprites[o].setActive(!1);this._paused=!1,this.duration=e.duration,this.framePosition=0,this.currentClip=e}else is("Animation ".concat(t," not found."))}},{key:"isSubClip",value:function(t){for(var e=0;e<t.keyframes.length;e++)if(null!=t.keyframes[e].symbolName&&!this.checkSpriteExist(t.keyframes[e].symbolName))return!0;return!1}},{key:"checkSpriteExist",value:function(t){return this.game.cache.checkBitmapDataKey(t)}},{key:"setDefaults",value:function(t,e){for(var n in e)e.hasOwnProperty(n)&&null==t[n]&&(t[n]=e[n]);return t}},{key:"displayObjectUpdateTransform",value:function(t){if(t||this.parent||this.game){var e=this.parent;t?e=t:this.parent||(e=this.game.world);var n,i,o,r,a,s,c=e.worldTransform,u=this.worldTransform;this.rotation%PIXI.PI_2||this.skewX||this.skewY?(n=this.scale.x*Math.cos(this.rotation+this.skewY),i=this.scale.x*Math.sin(this.rotation+this.skewY),o=this.scale.y*Math.sin(-this.rotation-this.skewX),r=this.scale.y*Math.cos(this.rotation+this.skewX),a=this.position.x,s=this.position.y,(this.pivot.x||this.pivot.y)&&(a-=this.pivot.x*n+this.pivot.y*o,s-=this.pivot.x*i+this.pivot.y*r),u.a=n*c.a+i*c.c,u.b=n*c.b+i*c.d,u.c=o*c.a+r*c.c,u.d=o*c.b+r*c.d,u.tx=a*c.a+s*c.c+c.tx,u.ty=a*c.b+s*c.d+c.ty):(n=this.scale.x,r=this.scale.y,a=this.position.x-this.pivot.x*n,s=this.position.y-this.pivot.y*r,u.a=n*c.a,u.b=n*c.b,u.c=r*c.c,u.d=r*c.d,u.tx=a*c.a+s*c.c+c.tx,u.ty=a*c.b+s*c.d+c.ty),this.worldAlpha=this.alpha*e.worldAlpha,this.worldPosition.set(u.tx,u.ty),this.worldScale.set(Math.sqrt(u.a*u.a+u.b*u.b),Math.sqrt(u.c*u.c+u.d*u.d)),this.worldRotation=Math.atan2(-u.c,u.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,u,c)}}},{key:"paused",get:function(){return this._paused},set:function(t){this._paused=t;for(var e=0;e<this.subSprites.length;e++)this.subSprites[e].paused=this._paused;for(e=0;e<this.subClips.length;e++)this.subClips[e].paused(this._paused)}}])&&Cs(n.prototype,i),o&&Cs(n,o),e}();function As(t){return(As="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Is(t,e){return!e||"object"!==As(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fs(t,e,n){return(Fs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ls(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ls(t){return(Ls=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ms(t,e){return(Ms=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ds=function(t){function e(t,n,i,o,r,a){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(s=Is(this,Ls(e).call(this,t,n,i,o))).setupClip(r,a),s}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ms(t,e)}(e,Ts),n=e,(i=[{key:"destroy",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.movieClip=null,Fs(Ls(e.prototype),"destroy",this).call(this,t)}},{key:"setupClip",value:function(t,e){this.layer=t,this.keyframes=this.layer.keyframes,this.finalFrame=this.keyframes.length-1,this.movieClip=e,this.frameRate=this.movieClip.frameRate,this.duration=this.movieClip.duration,this.playbackSpeed=1,this._paused=!1,this.visible=!0,this.enabled=!0,this.setActive(!0),this.currentFrame=0,this.currentIndex=0,this.currentKeyFrame=this.keyframes[this.currentIndex],this.currentDuration=0,this.currentTime=0,this.nextKeyframe(!0),this.updateChildTransform(this.currentKeyFrame.x,this.currentKeyFrame.y,this.currentKeyFrame.pivotX,this.currentKeyFrame.pivotY,this.currentKeyFrame.skewX,this.currentKeyFrame.skewY,this.currentKeyFrame.scaleX,this.currentKeyFrame.scaleY,this.currentKeyFrame.alpha)}},{key:"goto",value:function(t,e,n){this.playbackSpeed=e,this.currentFrame!=t&&(t<this.currentFrame&&(this.currentIndex=0,this.currentDuration=0,this.currentFrame=0,this.currentTime-=this.currentKeyFrame.duration,this.nextKeyframe()),this.composeFrame(t,n))}},{key:"composeFrame",value:function(t,e){if(this.currentFrame=t,t>=this.layer.frames)return this.visible=!1,this.currentIndex=this.finalFrame,void(this.keyframeUpdate=!0);for(;this.currentDuration<=this.currentFrame;)this.currentIndex++,this.nextKeyframe();var n=this.keyframes[this.currentIndex],i=n.visible&&null!=n.symbolName;if(this.visible=i,i){var o=n.x,r=n.y,a=n.scaleX,s=n.scaleY,c=n.skewX,u=n.skewY,l=n.alpha;if(n.tweened&&this.currentIndex<this.finalFrame&&null!=this.keyframes[this.currentIndex+1].symbolName){var h=(this.currentFrame-n.index)/n.duration,f=n.ease;if(0!=f){var p;if(f<0){var y=1-h;p=1-y*y,f=-f}else p=h*h;h=f*p+(1-f)*h}var d=this.keyframes[this.currentIndex+1];o+=(d.x-o)*h,r+=(d.y-r)*h,a+=(d.scaleX-a)*h,s+=(d.scaleY-s)*h,c+=(d.skewX-c)*h,u+=(d.skewY-u)*h,l+=(d.alpha-l)*h}this.updateChildTransform(o,r,this.currentKeyFrame.pivotX,this.currentKeyFrame.pivotY,c,u,a,s,l)}}},{key:"nextKeyframe",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.currentIndex>=this.keyframes.length?(this.currentIndex=0,this.currentDuration=0,this.currentFrame=0,this.currentTime-=this.currentKeyFrame.duration):this.currentTime=0,this.currentKeyFrame=this.keyframes[this.currentIndex],this.currentDuration+=this.currentKeyFrame.duration,null!=this.currentKeyFrame.symbolName?(this.loop(this.currentKeyFrame.symbolName,t),this.visible=!0):this.visible=!1}},{key:"updateChildTransform",value:function(t,e,n,i,o,r,a,s,c){this.position.set(t,e),this.pivot.set(n,i),this.skewX=o,this.skewY=r,this.scale.set(a,s),this.alpha=c}},{key:"setActive",value:function(t){this.visible=t,this.enabled=t}},{key:"paused",get:function(){return this._paused},set:function(t){this._paused=t}}])&&Rs(n.prototype,i),o&&Rs(n,o),e}();function Ns(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ks=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.frameRate=ss([n,"frameRate"],"[FlumpLibrary] Cannot find frame rate value in library.json."),this.movieClips={};var o=ss([n,"movies","length"],"[FlumpLibrary] Cannot find frame rate value in library.json.");this.movieSymbols=new Array(o),this.game=e;for(var r=0;r<n.movies.length;r++)this.movieSymbols[r]=n.movies[r].id,this.movieClips[this.movieSymbols[r]]=new fs(this,n.movies[r]);var a=n.textureGroups;this.atlases=new Array;for(var s=0;s<a[0].atlases.length;s++)this.atlases.push(new vs(this.game,a[0].atlases[s],i))}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){if(null!=this.movieClips){for(var t=0;t<this.movieSymbols.length;t++)this.movieClips.hasOwnProperty(this.movieSymbols[t])&&(this.movieClips[this.movieSymbols[t]].destroy(),delete this.movieClips[this.movieSymbols[t]]);this.movieSymbols=null,this.movieClips=null}if(null!=this.atlases){for(;this.atlases.length>0;)this.atlases[0].destroy(),this.atlases.shift();this.atlases=null}this.game=null}},{key:"createClip",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Ts(this.game,this.movieClips,this,t)}},{key:"createSubClip",value:function(t,e,n){return new Ds(this.game,this.movieClips,this,t,e,n)}},{key:"getTexture",value:function(t){for(var e=0;e<this.atlases.length;e++)if(void 0!==this.atlases[e].textures[t])return this.atlases[e].textures[t].bitmap;return null}}])&&Ns(e.prototype,n),i&&Ns(e,i),t}();function Bs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Vs=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.libraries={}}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){for(var t=Object.keys(this.libraries);t.length>0;)this.removeLibrary(t.shift())}},{key:"addLibrary",value:function(t,e,n){os(this.libraries[e])?is("[Flump] Library with ".concat(e," already exists. Be careful of memory leaks.")):this.libraries[e]=new Ks(t,t.cache.getJSON(e),n)}},{key:"removeLibrary",value:function(t){os(this.libraries[t])&&(this.libraries[t].destroy(),delete this.libraries[t])}}])&&Bs(e.prototype,n),i&&Bs(e,i),t}();function zs(t){return(zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Us(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Gs(t,e){return!e||"object"!==zs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hs(t,e,n){return(Hs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ws(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ws(t){return(Ws=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qs(t,e){return(qs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xs=function(t){function e(t,n,i,o,r){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=Gs(this,Ws(e).call(this,t,n,i,o,r))).display=null,a}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qs(t,e)}(e,Phaser.Sprite),n=e,(i=[{key:"update",value:function(){if(Hs(Ws(e.prototype),"update",this).call(this),this.alive&&this.children.length>0)for(var t=0;t<this.children.length;t++)this.children[t].update()}}])&&Us(n.prototype,i),o&&Us(n,o),e}(),Ys=new Vs,Js="gamePlay",Qs="gameTimeoutPlay",$s="gameTOReEngage",Zs="gameQuit",tc="gameAchievement",ec="gameCharacterSelect",nc="gameSkip",ic="gameReplay",oc="gameComponentStart",rc="gameComponentComplete",ac="gameRoundStart",sc="gameRoundComplete",cc="gamePlaythroughComplete",uc="gameQuestionCA",lc="gameQuestionWA",hc="gameInteraction",fc="gameMenuClick",pc="TimeoutPlay",yc="TOReEngage",dc="Achievement",vc="Play",mc="RoundStart",gc="Quit",bc="ObjectClick",wc="MenuClick",kc="Skip",Oc="CharacterSelect",Sc="Replay",Pc="RoundComplete",Cc="PlaythroughComplete",_c="ComponentStart",xc="ComponentComplete",jc="QuestionCA",Ec="QuestionW",Tc="Playthrough Complete";function Ac(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Rc=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"init",value:function(t,e){this.game=t,this.gameName=i.getElse([e,"gameName"],"Untitled Game"),this.initialScene=i.getElse([e,"initialScene"],"title"),this.version=i.getElse([e,"version"],{major:0,minor:0,build:0}),this.localeCodes=i.getElse([e,"localeCodes"],{en_US:"English"}),this.debugFlags=i.getElse([e,"debugFlags"],{}),this.cursor=i.getElse([e,"cursor"],{}),this.buttonMap=i.getElse([e,"buttonMap"],{}),this.audioMap=i.getElse([e,"audioMap"],{}),this.contentUrls=i.getElse([e,"contentUrls"],{}),this.transition=i.getElse([e,"transition"],{}),this.character=i.getElse([e,"initialCharacter"],this.characterOptions.elmo),this.potty=i.getElse([e,"initialPotty"],{color:"white",seat:0}),this.elmo=i.getElse([e,"elmo"],{}),this.abby=i.getElse([e,"abby"],{}),this.pottyFlump=i.getElse([e,"pottyFlump"],{}),this.accidentProgress=i.getElse([e,"initialAccidentProgress"],0),this.tips=i.getElse([e,"tips"],{}),this.lyrics=i.getElse([e,"lyrics"],{}),this.captionMap=i.getElse([e,"captionMap"],{}),this.pottyColors=i.getElse([e,"pottyColors"],{}),this.pottySeats=i.getElse([e,"pottySeats"],[]),this.accident=i.getElse([e,"accident"],[]),this.songs=i.getElse([e,"songs"],{}),this.accidentIncrements=i.getElse([e,"accidentIncrements"],[]),this.pottyDanceCount=i.getElse([e,"pottyDanceCount"],1),this.urgentPottyDance=i.getElse([e,"urgentPottyDance"],0),this.appParameters=i.getElse([e,"appParameters"],{pbs:{key:"",value:""},sesame:{key:"",value:""}}),this.locale=this.detectUserLocale(),this.currentScene="",this.currentChartRow=0,this.currentAccident=0,this.currentPottyDance=0,this.playroomState=void 0,this.firstVisit={customization:!0,customizePotty:!0,playroom:!0,playroomLesson1:!0,findPotty:!0,waitingPotty:!0},this.screenName=void 0,this.roundName="Potty Round",this.roundStartTime=0,this.playthroughCount=0,this.playroomObjectMap={elmo:"Elmo",abby:"Abby Cadabby",radio:{on:"Radio On",off:"Radio Off"},snacks:"Food",ball:"Ball",teddy:"Teddy Bear",books:"Books",train:"Train",globe:"Globe",flowers:"Flowers",blocks:"Blocks"},this.waitingObjectMap={soap:"Soap",mirror:"Mirror",towels:"Towel",duckie:"Rubber Duckie",stool:"Step Stool",brush:"Hair Brush",toothbrush:"Toothbrush",decorations:"Picture",basket:"Basket"}}},{key:"detectUserLocale",value:function(){return window.navigator&&(window.navigator.language||window.navigator.userLanguage)&&(window.navigator.language||window.navigator.userLanguage).indexOf("es")>=0?"es_US":"en_US"}},{key:"startRound",value:function(){this.roundStartTime=Date.now(),this.playthroughCount++}},{key:"getRoundDuration",value:function(){return(Date.now()-this.roundStartTime)/1e3}},{key:"isInApp",get:function(){if(this.isDesktop)return!1;var t=window.location.href.split("?");if(t.length>1){var e=t[1].split("&");if(e.length>0)for(var n=0;n<e.length;n++){var i=e[n].split("=");if(i[0]===this.appParameters.pbs.key&&i[1]===this.appParameters.pbs.value)return!0;if(i[0]===this.appParameters.sesame.key&&i[1]===this.appParameters.sesame.value)return!0}}return!1}},{key:"isDesktop",get:function(){return this.game.device.desktop}},{key:"isMobile",get:function(){return!this.game.device.desktop}},{key:"characterOptions",get:function(){return{elmo:"elmo",abby:"abby"}}},{key:"pottyLessonScenes",get:function(){return["findPotty","waitingPotty","wiping","flushPotty","washHands"]}},{key:"requiresPottyScenes",get:function(){return["customization","waitingPotty","wiping","flushPotty"]}},{key:"accidentAudioKeys",get:function(){return this.accident[this.currentAccident][this.character]}}])&&Ac(e.prototype,n),o&&Ac(e,o),t}());function Ic(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Lc(t,e,n){return e&&Fc(t.prototype,e),n&&Fc(t,n),t}var Mc=new(function(){function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.musicPool={},this.sfxPool={},this.voPool={},this.music={},this.sfx={},this.vo={},this.masterAudioMap={},this.fades={},this.volumeControls=(Ic(e={master:1},this.channels.Music,1),Ic(e,this.channels.SFX,1),Ic(e,this.channels.VO,1),e),this.channelPlayed=new Phaser.Signal,this.channelStopped=new Phaser.Signal}return Lc(t,[{key:"channels",get:function(){return{Music:"music",SFX:"sfx",VO:"vo"}}}]),Lc(t,[{key:"init",value:function(t,e){this.game=t,this.masterAudioMap=e,this.audioMap=JSON.parse(JSON.stringify(e))}},{key:"setMasterVolume",value:function(t){this.volumeControls.master=t,this.updatePlayingChannelVolume(this.channels.Music),this.updatePlayingChannelVolume(this.channels.SFX),this.updatePlayingChannelVolume(this.channels.VO)}},{key:"setChannelVolume",value:function(t,e){this.volumeControls[t]=e,this.updatePlayingChannelVolume(t)}},{key:"setMasterMute",value:function(t){this.volumeControls.master=t,this.updatePlayingChannelVolume(this.channels.Music),this.updatePlayingChannelVolume(this.channels.SFX),this.updatePlayingChannelVolume(this.channels.VO)}},{key:"pauseAudio",value:function(t){this.pauseChannel(this.channels.Music,t),this.pauseChannel(this.channels.SFX,t),this.pauseChannel(this.channels.VO,t)}},{key:"pauseChannel",value:function(t,e){var n=this;Object.keys(this[t]).forEach(function(i){n[t][i].forEach(function(t){try{e?t.pause():t.resume()}catch(t){}})})}},{key:"updatePlayingChannelVolume",value:function(t){var e=this;Object.keys(this[t]).forEach(function(n){var i=e.audioMap[t].tracks[n];e[t][n].forEach(function(n){var o=e.getAppliedChannelVolume(t)*i.volume;n.volume=ns.clamp(o,0,1)})})}},{key:"play",value:function(t,e,n){var i=this;if(e=e||function(){},n=n||null,0===(t=Array.isArray(t)?t.slice():[t]).length||!t[0])return e.call(n),!1;var o=t.shift(),r=void 0;for(var a in this.audioMap)if(void 0!==this.audioMap[a].tracks[o]){r=a;break}if(void 0===r||r===this.channels.VO&&!Rc.debugFlags.playVO)return e.call(n),!1;var s=this.audioMap[r],c=s.tracks[o];if(s.single&&this.isChannelPlaying(r)){if(!this.allowInterrupt(r,o))return!1;this.stopChannel(r)}if(this[r][o]){if(c.restart&&this[r][o].length>0)return this[r][o][0].restart(),!0;if(void 0!==c.max&&this[r][o].length>=c.max)return!1}var u=this.getAppliedChannelVolume(r)*c.volume,l=ns.clamp(u,0,1),h=this["".concat(r,"Pool")]||{},f=void 0;return void 0!==h[o]&&h[o].length>0?(f=h[o].shift()).volume=l:f=this.game.add.audio(o,l),this[r][o]=this[r][o]||[],this[r][o].push(f),c.loop?f.onStop.add(function(){return f.play()}):f.onStop.addOnce(function(){var a=i[r][o].indexOf(f);i[r][o].splice(a,1),h[o]=h[o]||[],h[o].push(f),i.channelStopped.dispatch(r,o),void 0!==s.duck&&i.restoreFromDuck(r),i.play(t,e,n)}),this.channelPlayed.dispatch(r,o),Rc.debugFlags.audioPlayer&&console.log("AudioPlayer: Playing -",o),f.play(),void 0!==s.duck&&this.applyDuck(r),!0}},{key:"playRandom",value:function(t,e,n){return this.play(Phaser.ArrayUtils.getRandomItem(t),e,n)}},{key:"stopTrack",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0!==t){var n=void 0;for(var i in this.audioMap)if(void 0!==this.audioMap[i].tracks[t]){n=i;break}void 0!==n&&this.stop(n,t,e)}}},{key:"stop",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.channelStopped.dispatch(t,e),void 0!==this[t]&&void 0!==this[t][e])for(Rc.debugFlags.audioPlayer&&this[t][e].length>0&&console.log("AudioPlayer: Stopping -",e),n&&this[t][e].length>0&&void 0!==this.audioMap[t].duck&&this.restoreFromDuck(t);this[t][e].length>0;){var i=this[t][e].shift();i.onStop.removeAll(),i.stop();var o="".concat(t,"Pool");this[o][e]=this[o][e]||[],this[o][e].push(i)}}},{key:"stopChannel",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0!==this[t])for(var n in this[t])this.stopChannelFade(t),this.stop(t,n,e)}},{key:"stopMusic",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stopChannel(this.channels.Music,t)}},{key:"stopSFX",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stopChannel(this.channels.SFX,t)}},{key:"stopVO",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stopChannel(this.channels.VO,t)}},{key:"stopAll",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stopMusic(t),this.stopSFX(t),this.stopVO(t)}},{key:"clearChannels",value:function(){for(var t in this.stopAll(!1),this.stopChannelFade(this.channels.Music),this.stopChannelFade(this.channels.VO),this.stopChannelFade(this.channels.SFX),this.musicPool)for(var e=0;e<this.musicPool[t].length;e++)this.musicPool[t][e].destroy();for(var n in this.musicPool={},this.music={},this.sfxPool)for(var i=0;i<this.sfxPool[n].length;i++)this.sfxPool[n][i].destroy();for(var o in this.sfxPool={},this.sfx={},this.voPool)for(var r=0;r<this.voPool[o].length;r++)this.voPool[o][r].destroy();this.voPool={},this.vo={}}},{key:"getAppliedChannelVolume",value:function(t){return this.audioMap[t].channelVolume*this.volumeControls[t]*this.volumeControls.master}},{key:"isPlaying",value:function(t,e){return void 0===e&&(e=t,t=this.findChannelFor(e)),void 0!==this[t]&&void 0!==this[t][e]&&this[t][e].length>0}},{key:"addCallbackTo",value:function(t,e,n){var i=this.findChannelFor(t);void 0!==i&&this[i][t][0].onStop.addOnce(e,n)}},{key:"findChannelFor",value:function(t){for(var e in this.audioMap)if(void 0!==this.audioMap[e].tracks[t])return e}},{key:"isChannelPlaying",value:function(t){if(void 0!==this[t])for(var e in this[t])if(this[t][e].length>0)return!0;return!1}},{key:"allowInterrupt",value:function(t,e){if(void 0!==this[t]){var n=this.audioMap[t],i=n.tracks[e];for(var o in this[t]){var r=n.tracks[o];if(i.priority<=r.priority)return!1}return!0}return!1}},{key:"applyDuck",value:function(t){var e=this,n=this.audioMap[t].duck;void 0!==n&&n.forEach(function(t){e.fadeChannel(t.channel,t.volume,t.fadeOut)})}},{key:"restoreFromDuck",value:function(t){var e=this,n=this.audioMap[t].duck;void 0!==n&&n.forEach(function(t){e.fadeChannel(t.channel,e.masterAudioMap[e.channels.Music].channelVolume,t.fadeIn)})}},{key:"fadeChannel",value:function(t,e,n){var i=this;void 0!==this.fades[t]&&this.stopChannelFade(t),Rc.debugFlags.audioPlayer&&(this.audioMap[t].channelVolume<e?console.log("AudioPlayer: Restoring -",t,"-",e):console.log("AudioPlayer: Ducking -",t,"-",e));var o=function(){Object.keys(i[t]).forEach(function(e){var n=i.audioMap[t].tracks[e],o=i.getAppliedChannelVolume(t)*n.volume;i[t][e].forEach(function(t){return t.volume=o})})};this.fades[t]=this.game.add.tween(this.audioMap[t]),this.fades[t].onComplete.addOnce(function(){i.stopChannelFade(t),o()}),this.fades[t].onUpdateCallback(function(){return o()}),this.fades[t].to({channelVolume:e},1e3*n),this.fades[t].start()}},{key:"stopChannelFade",value:function(t){void 0!==this.fades[t]&&(this.game.tweens.removeFrom(this.audioMap[t]),this.fades[t]=void 0)}}]),t}());function Dc(t){return(Dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Bc(t,e,n){return e&&Kc(t.prototype,e),n&&Kc(t,n),t}function Vc(t,e){return!e||"object"!==Dc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zc(t){return(zc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uc(t,e){return(Uc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gc=function(t){function e(t,n){var i;return Nc(this,e),(i=Vc(this,zc(e).call(this,t))).captions=n,i.intialized=!1,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uc(t,e)}(e,Phaser.Group),Bc(e,[{key:"update",value:function(){this.captions.update()}}]),e}(),Hc=new(function(){function t(){Nc(this,t)}return Bc(t,[{key:"init",value:function(t,e){this.game=t,this.intialized=!0,this.muted=!0,this.captionElement=document.getElementById("gameCaptions"),this.player=new Ja(this.formatConfig(e),new ts(this.captionElement)),this.updater=new Gc(t,this),t.stage.add(this.updater),Mc.channelPlayed.add(this.onVOPlayed,this),Mc.channelStopped.add(this.onVOStopped,this)}},{key:"update",value:function(){this.intialized&&!this.muted&&this.player.update(.001*this.game.time.elapsedMS)}},{key:"setCaptionMute",value:function(t){if(this.intialized)if(this.muted=t,this.muted)this.player.stop();else if(Mc.isChannelPlaying(Mc.channels.VO))for(var e=Object.keys(Mc.vo),n=0;n<e.length;n++)if(Mc.vo[e[n]].length>0)return void this.player.start(e[n],Mc.vo[e[n]][0].position)}},{key:"onVOPlayed",value:function(t,e){this.intialized&&!this.muted&&void 0!==this.player.captions[e]&&this.player.start(e,0)}},{key:"onVOStopped",value:function(t,e){this.intialized&&!this.muted&&void 0!==this.player.captions[e]&&this.player.stop()}},{key:"formatConfig",value:function(t){return Object.keys(t).forEach(function(e){Array.isArray(t[e])||(t[e]=Rc.isDesktop?t[e].desktop:t[e].mobile)}),t}}]),t}());function Wc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var qc=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="GoogleAnalytics",this.panel=document.createElement("div"),this.logs=document.createElement("div")}var e,n;return e=t,(n=[{key:"start",value:function(t){this.app=t,this.loggingPanel=t.getPlugin("LoggingPanel"),void 0!==this.loggingPanel&&(this.render=this.loggingPanel.addPanel({name:"Google Analytics"}),this.logs.className="container",this.logs.style.overflowY="scroll",this.logs.style.maxHeight="80vh",this.panel.appendChild(this.logs),this.render(this.panel))}},{key:"render",value:function(t){}},{key:"getFormattedDate",value:function(){var t=new Date,e=t.getHours()+":",n=t.getMinutes();e+=n<10?"0".concat(n):n,e+=":";var i=t.getSeconds();return e+(i<10?"0".concat(i):i)}},{key:"event",value:function(t,e,n,i){var o={hitType:"event"};void 0!==t&&(o.eventCategory=t),void 0!==e&&(o.eventAction=e),void 0!==n&&(o.eventLabel=n),void 0!==i&&(o.eventValue=i),this.app.container.connected&&this.app.container.send("googleAnalyticsEvent",o),this.renderRecord("Event",[t,e,n,i])}},{key:"renderRecord",value:function(t,e){if(void 0!==this.loggingPanel){var n=document.createElement("div");n.className="container";var i=document.createElement("div");i.className="bg-dkblue container";var o=document.createElement("div");o.className="half-width bold",o.innerText=t.toUpperCase(),i.appendChild(o);var r=document.createElement("div");r.innerText=this.getFormattedDate(),r.className="half-width bold",i.appendChild(r);var a=document.createElement("div");a.className="clear--both",i.appendChild(a),n.appendChild(i);var s=document.createElement("div");s.className="bg-blue full-width container",s.style.textAlign="center",s.innerText=e.filter(function(t){return void 0!==t}).join(" â "),n.appendChild(s);var c=document.createElement("div");c.className="clear--both",n.appendChild(c),this.logs.insertBefore(n,this.logs.firstChild),this.render(this.panel)}}}])&&Wc(e.prototype,n),t}();function Xc(t){return(Xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Qc(t,e,n){return e&&Jc(t.prototype,e),n&&Jc(t,n),t}function $c(t,e){return!e||"object"!==Xc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zc(t){return(Zc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tu(t,e){return(tu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var eu=function(t){function e(t){var n;return Yc(this,e),(n=$c(this,Zc(e).call(this,t))).events={onInputDown:new Phaser.Signal,onInputUp:new Phaser.Signal},n.isDown=!1,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tu(t,e)}(e,Phaser.Group),Qc(e,[{key:"initCursor",value:function(t){var e=t.idle,n=void 0===e?"":e,i=t.rollOver,o=void 0===i?"":i;document.getElementById("gameTarget").style.cursor="none",this.cursorIdle=n,this.cursorOver=o,this.cursorImg=this.game.make.image(this.game.input.x,this.game.input.y,this.cursorIdle),this.cursorImg.anchor.set(.5),this.game.stage.add(this.cursorImg)}},{key:"setCursorState",value:function(t){void 0!==this.cursorImg&&this.cursorImg.loadTexture(t)}},{key:"update",value:function(){var t=this.game.input.activePointer;void 0!==t&&(t.isDown&&!this.isDown?(this.isDown=!0,this.events.onInputDown.dispatch()):t.isUp&&this.isDown&&(this.isDown=!1,this.events.onInputUp.dispatch())),void 0!==this.cursorImg&&this.cursorImg.position.set(this.game.input.x,this.game.input.y)}},{key:"checkRect",value:function(t,e,n,i){return this.game.input.x>t&&this.game.input.x<e&&this.game.input.y>n&&this.game.input.y<i}}]),e}(),nu=new(function(){function t(){Yc(this,t)}return Qc(t,[{key:"initialize",value:function(t,e,n,i,o){var r=this;this.game=t,this.container=document.getElementById("gameTarget"),this.game.width=i,this.game.height=o,this.min={x:e,y:n},this.max={x:i,y:o},this.safeArea={x:0,y:0,width:0,height:0,left:0,right:0,top:0,bottom:0},this.game.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.resize=new Phaser.Signal,window.onresize=function(){return r.resizeGame()},Phaser.Device.iOS?this.iOSRefresh():this.resizeGame(),this.input=new eu(t),this.game.stage.add(this.input)}},{key:"drawDimensions",value:function(){var t=this.game.make.graphics();t.lineStyle(2,16711680),t.drawRect(0,0,this.max.x-1,this.max.y-1),t.lineStyle(2,65280),t.drawRect((this.max.x-this.min.x)/2,(this.max.y-this.min.y)/2,this.min.x-1,this.min.y-1),this.game.stage.add(t)}},{key:"iOSRefresh",value:function(){var t=this;this.resizeGame(),setTimeout(function(){return t.iOSRefresh()},1e3)}},{key:"resizeGame",value:function(){var t,e;Phaser.Device.iOS?window.orientation%180==0?(t=window.screen.width,e=window.screen.height):(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):(t=window.innerWidth,e=window.innerHeight),this.container.style.width="".concat(t,"px"),this.container.style.height="".concat(e,"px"),this.scale=Math.min(t/this.min.x,e/this.min.y),this.game.scale.setUserScale(this.scale,this.scale),this.game.scale.refresh();var n=t/this.scale,i=e/this.scale;this.safeArea.left=Math.max(.5*-(n-this.max.x),0),this.safeArea.top=Math.max(.5*-(i-this.max.y),0),this.safeArea.right=Math.min(this.safeArea.left+n,this.max.x),this.safeArea.bottom=Math.min(this.safeArea.top+i,this.max.y),this.safeArea.x=this.safeArea.left,this.safeArea.y=this.safeArea.top,this.safeArea.width=this.safeArea.right-this.safeArea.left,this.safeArea.height=this.safeArea.bottom-this.safeArea.top,this.resize.dispatch()}}]),t}()),iu=n(0);function ou(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ru=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"init",value:function(t,e){this.game=t,this.contentUrls=e}},{key:"printImage",value:function(t){if(this.checkContent(t)){var e=window.open(this.contentUrls[Rc.character][t]);e.focus(),e.print()}else console.error("Cannot find content for '".concat(t,"'."))}},{key:"downloadImage",value:function(t,e){if(e=e||function(){},this.checkContent(t))if(Rc.isMobile)window.open(this.contentUrls[Rc.character][t]).focus();else{var n=this.contentUrls[Rc.character][t],i=n.substring(n.lastIndexOf(".")+1),o=n.substring(n.lastIndexOf("/")+1,n.lastIndexOf("."));Object(iu.saveAs)(n,"".concat(o,".").concat(i))}else console.error("Cannot find content for '".concat(t,"'.")),e()}},{key:"checkContent",value:function(t){return void 0!==this.contentUrls[Rc.character][t]}}])&&ou(e.prototype,n),i&&ou(e,i),t}());function au(t){return(au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function su(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cu(t,e){return!e||"object"!==au(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function uu(t){return(uu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function hu(t,e,n){return e&&lu(t.prototype,e),n&&lu(t,n),t}function fu(t,e){return(fu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pu=function(t){function e(t,n){var i;return su(this,e),(i=cu(this,uu(e).call(this,t))).display=Ys.libraries[n.flump.library].createClip(n.flump.animations.outIdle),i.addChild(i.display),i.position.set(n.position.x,n.position.y),i._playOnce=i.display.playClip.bind(i.display),i._loop=i.display.playClip.bind(i.display),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fu(t,e)}(e,Xs),hu(e,[{key:"playOnce",get:function(){return this._playOnce}},{key:"loop",get:function(){return this._loop}},{key:"onComplete",get:function(){return this.display.onComplete}}]),hu(e,[{key:"update",value:function(){this.visible&&this.display.update()}}]),e}(),yu=new(function(){function t(){su(this,t)}return hu(t,[{key:"init",value:function(t,e){this.config=e,this.animation=new pu(t,e),t.stage.add(this.animation)}},{key:"showScreen",value:function(){this.animation.visible=!1}},{key:"hideScreen",value:function(){this.animation.visible=!0,this.animation.playOnce(this.config.flump.animations.outIdle)}},{key:"transitionOut",value:function(t){var e=this;this.animation.onComplete.removeAll(),this.animation.onComplete.addOnce(function(){e.animation.loop(e.config.flump.animations.outIdle),void 0!==t&&t()}),this.animation.visible=!0,this.animation.playOnce(this.config.flump.animations.out)}},{key:"transitionIn",value:function(t){var e=this;this.animation.onComplete.removeAll(),this.animation.onComplete.addOnce(function(){e.animation.loop(e.config.flump.animations.inIdle),void 0!==t&&t(),e.animation.visible=!1}),this.animation.visible=!0,this.animation.playOnce(this.config.flump.animations.in)}}]),t}());function du(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vu(t,e){var n=t.gameName,i=t.roundName,o=t.screenName,r=t.locale,a=t.debugFlags,s=mu(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){du(t,e,n[e])})}return t}({gameName:n,screenName:o,roundName:i,timestamp:Date.now(),language:r},e));window.dataLayer=window.dataLayer||[],window.dataLayer.push(s),a&&a.analytics&&console.log("Sesame - ".concat(s.event," - ").concat(JSON.stringify(s)),s),function(t,e){var n,i,o,r="Game_".concat(t.gameName);switch(t.event){case Js:n=vc,i=t.buttonName;break;case Qs:n=pc,i="ScreenName_".concat(t.screenName);break;case $s:n=yc,i="ScreenName_".concat(t.screenName),o=t.duration;break;case Zs:n=gc,i=t.screenName,o=t.duration;break;case tc:n=dc,i="Achievement_".concat(t.achievementType);break;case ec:n=Oc,i=t.characterName;break;case nc:n=kc,i="ScreenName_".concat(t.screenName),o=t.duration;break;case ic:n=Sc,i="Replay_ScreenName_".concat(t.screenName);break;case oc:n=_c,i=t.componentType;break;case rc:n=xc,i=t.componentType,o=t.duration;break;case ac:n=mc,i="RoundNumber_".concat(t.roundNumber,"_RoundName_").concat(t.roundName,"_ScreenName_").concat(t.screenName);break;case sc:n=Pc,i="RoundNumber_".concat(t.roundNumber,"_RoundName_").concat(t.roundName,"_ScreenName_").concat(t.screenName),o=t.duration;break;case cc:n=Cc,i=Tc,o=t.duration;break;case uc:n=jc,i="QuestionAsked_".concat(t.questionAsked,"_QuestionSequence_").concat(t.questionNumber,"_PlayerAnswer_").concat(t.playerAnswer);break;case lc:n=Ec,i="QuestionAsked_".concat(t.questionAsked,"_QuestionSequence_").concat(t.questionNumber,"_PlayerAnswer_").concat(t.playerAnswer);break;case hc:n=bc,i="Object_".concat(t.objectName,"_ScreenName_").concat(t.screenName);break;case fc:n=wc,i="MenuButton_".concat(t.buttonName,"_ScreenName_").concat(t.screenName)}if(e){var a=mu({category:r,action:n,label:i,value:o});console.log("PBS - ".concat(t.event," - ").concat(JSON.stringify(a)),a)}xv.getPlugin("GoogleAnalytics").event(r,n,i,o)}(s,a&&a.analytics||!1)}function mu(t){return Object.keys(t).forEach(function(e){void 0===t[e]&&delete t[e]}),t}function gu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var bu=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.length=1,this.clearLength=0,this.isTimedOut=!1,this.timeoutEvent=void 0,this.timeoutClearEvent=void 0,this.timeoutBegin=new Phaser.Signal,this.timeoutEnd=new Phaser.Signal,this.startTime=0,this.stateIgnoreMap={}}var e,n,i;return e=t,(n=[{key:"init",value:function(t,e){this.game=t,void 0!==e&&this.ignoreState(e)}},{key:"setTimeoutLength",value:function(t){this.length=t||this.length}},{key:"setTimeoutClearLength",value:function(t){this.clearLength=t}},{key:"start",value:function(){var t=this;this.stop(),this.allowTimeout()&&(this.timeoutEvent=this.game.time.events.loop(1e3*this.length,function(){t.allowTimeout()?(t.isTimedOut||vu(Rc,{event:Qs}),t.startTime=Date.now(),t.timeoutBegin.dispatch(),t.isTimedOut=!0,void 0!==t.timeoutClearEvent&&(t.game.time.events.remove(t.timeoutClearEvent),t.timeoutClearEvent=void 0),t.timeoutClearEvent=t.game.time.events.add(1e3*t.clearLength,function(){t.game.time.events.remove(t.timeoutClearEvent),t.timeoutClearEvent=void 0,t.allowTimeout()&&t.timeoutEnd.dispatch()})):(t.game.time.events.remove(t.timeoutClearEvent),t.timeoutClearEvent=void 0,t.stop())}),this.isTimedOut=!1)}},{key:"stop",value:function(){if(void 0!==this.timeoutEvent){if(this.isTimedOut){var t=(Date.now()-this.startTime)/1e3;Math.floor(t/60)>30&&(t=1800),vu(Rc,{event:$s,duration:t}),this.timeoutEnd.dispatch()}this.game.time.events.remove(this.timeoutEvent),this.timeoutEvent=void 0,void 0!==this.timeoutClearEvent&&(this.game.time.events.remove(this.timeoutClearEvent),this.timeoutClearEvent=void 0),this.isTimedOut=!1}}},{key:"reset",value:function(){this.start()}},{key:"allowTimeout",value:function(){return!this.stateIgnoreMap.hasOwnProperty(this.game.state.current)||!0===this.stateIgnoreMap[this.game.state.current]}},{key:"ignoreState",value:function(t){Array.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++)this.stateIgnoreMap[t[e]]=!0}}])&&gu(e.prototype,n),i&&gu(e,i),t}());function wu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var ku=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.images=null,this.json=null,this.flump=null,this.audio=null,this.jsonAtlasHash=null,this.bitmapFonts=null}var e,n,i;return e=t,(n=[{key:"dispose",value:function(){this.images=null,this.json=null,this.flump=null,this.audio=null,this.jsonAtlasHash=null,this.bitmapFonts=null}}])&&wu(e.prototype,n),i&&wu(e,i),t}();function Ou(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Su=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.assetPacks={}}var e,n,i;return e=t,(n=[{key:"destroy",value:function(){for(var t=Object.keys(this.assetPacks);t.length>0;)this.assetPacks[t[0]].destroy(),delete this.assetPacks[t[0]],t.shift()}},{key:"replaceFilePathTags",value:function(t){for(var e in this.assetPacks)for(var n in this.assetPacks[e])for(var i=0;i<this.assetPacks[e][n].length;i++){var o=this.assetPacks[e][n][i];for(var r in t){var a=new RegExp(r,"gi");if(void 0!==o.url)if(Array.isArray(o.url))for(var s=0;s<o.url.length;s++)o.url[s]=o.url[s].replace(a,t[r]);else o.url=o.url.replace(a,t[r]);else if(void 0!==o.pngs)for(var c=0;c<o.pngs.length;c++)o.pngs[c]=o.pngs[c].replace(a,t[r])}this.assetPacks[e][n][i]=o}}},{key:"preloadAssetPacks",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=0;n<e.length;n++){var i=e[n];os(this.assetPacks[i])&&(this.addImageLoaders(t,this.assetPacks[i].images),this.addJsonLoaders(t,this.assetPacks[i].json),this.addFlumpLoaders(t,this.assetPacks[i].flump),this.addAudioLoaders(t,this.assetPacks[i].audio),this.addJsonHashAtlasLoaders(t,this.assetPacks[i].jsonAtlasHash),this.addBitmapFonts(t,this.assetPacks[i].bitmapFonts))}}},{key:"loadAssetPacks",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.preloadAssetPacks(t,e),t.load.start()}},{key:"unloadAssetPacks",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=0;n<e.length;n++){var i=e[n];os(this.assetPacks[i])&&(this.unloadImages(t,this.assetPacks[i].images),this.unloadJson(t,this.assetPacks[i].json),this.unloadFlump(t,this.assetPacks[i].flump),this.unloadAudio(t,this.assetPacks[i].audio),this.unloadJsonAtlasHash(t,this.assetPacks[i].jsonAtlasHash),this.unloadBitmapFonts(t,this.assetPacks[i].bitmapFonts))}}},{key:"addStartCallback",value:function(t,e,n){t.load.onLoadStart.addOnce(e,n)}},{key:"addProgressCallback",value:function(t,e,n){t.load.onFileComplete.add(e,n)}},{key:"addCompleteCallback",value:function(t,e,n){t.load.onLoadComplete.addOnce(e,n)}},{key:"removeStartCallback",value:function(t,e,n){t.load.onLoadStart.remove(e,n)}},{key:"removeProgressCallback",value:function(t,e,n){t.load.onFileComplete.remove(e,n)}},{key:"removeCompleteCallback",value:function(t,e,n){t.load.onLoadComplete.remove(e,n)}},{key:"parseManifest",value:function(t){if(os(t))for(var e in t)this.assetPacks[e]=(n=t[e],i=void 0,(i=new ku).images=as([n,"images"],[]),i.json=as([n,"json"],[]),i.flump=as([n,"flump"],[]),i.audio=as([n,"audio"],[]),i.jsonAtlasHash=as([n,"jsonAtlasHash"],[]),i.bitmapFonts=as([n,"bitmapFonts"],[]),i);var n,i}},{key:"addImageLoaders",value:function(t,e){e.forEach(function(e){os(e.key)&&os(e.url)?t.load.image(e.key,e.url):is("[AssetLoader] Provided image key or url is missing from: ".concat(e))})}},{key:"addJsonLoaders",value:function(t,e){e.forEach(function(e){os(e.key)&&os(e.url)?t.load.json(e.key,e.url):is("[AssetLoader] Provided image key or url is missing from: ".concat(e))})}},{key:"addFlumpLoaders",value:function(t,e){e.forEach(function(e){if(os(e.key)&&os(e.pngs)&&os(e.library)){for(var n=as([e.pngs,"length"],0),i=0;i<n;i++)t.load.image(e.pngs[i],e.pngs[i]);t.load.json(e.key,e.library)}else is("[AssetLoader] Provided flump key, pngs, or library is missing from: ".concat(e))})}},{key:"addAudioLoaders",value:function(t,e){e.forEach(function(e){os(e.key)&&os(e.url)?t.load.audio(e.key,e.url):is("[AssetLoader] Provided audio key "+e.key+" or url "+e.url+" is missing from: ".concat(e))})}},{key:"addJsonHashAtlasLoaders",value:function(t,e){e.forEach(function(e){os(e.key)&&os(e.png)&&os(e.json)?t.load.atlasJSONHash(e.key,e.png,e.json):is("[AssetLoader] Provided atlas key, png, or json is missing from: ".concat(e))})}},{key:"addBitmapFonts",value:function(t,e){e.forEach(function(e){os(e.key)&&os(e.image)&&os(e.xml)?t.load.bitmapFont(e.key,e.image,e.xml):is("[AssetLoader] Provided bitmap font key or url is missing from: ".concat(e))})}},{key:"unloadImages",value:function(t,e){e.forEach(function(e){os(e.key)?t.cache.removeImage(e.key,!0):is("[AssetLoader] Cannot unload image ".concat(e))})}},{key:"unloadJson",value:function(t,e){e.forEach(function(e){os(e.key)?t.cache.removeJSON(e.key,!0):is("[AssetLoader] Cannot unload json ".concat(e))})}},{key:"unloadFlump",value:function(t,e){e.forEach(function(e){if(os(e.key)&&os(e.pngs)&&os(e.library)){for(var n=as([e.pngs,"length"],0),i=0;i<n;i++)t.cache.removeImage(e.pngs[i],!0);t.cache.removeJSON(e.key)}else is("[AssetLoader] Cannot unload flump ".concat(e))})}},{key:"unloadAudio",value:function(t,e){e.forEach(function(e){os(e.key)?t.cache.removeSound(e.key):is("[AssetLoader] Cannot unload audio ".concat(e))})}},{key:"unloadJsonAtlasHash",value:function(t,e){e.forEach(function(e){os(e.key)?t.cache.removeTextureAtlas(e.key):is("[AssetLoader] Cannot unload atlas ".concat(e))})}},{key:"unloadBitmapFonts",value:function(t,e){e.forEach(function(e){os(e.key)?t.cache.removeBitmapFont(e.key):is("[AssetLoader] Cannot unload bitmap font ".concat(e))})}}])&&Ou(e.prototype,n),i&&Ou(e,i),t}();function Pu(t){return(Pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cu(t,e){return!e||"object"!==Pu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _u(t){return(_u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xu(t,e){return(xu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ju=new(function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Cu(this,_u(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xu(t,e)}(e,Su),e}());function Eu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Tu=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"init",value:function(t){this.game=t}},{key:"clear",value:function(t){void 0!==t&&this.game.tweens.removeFrom(t)}},{key:"fadeIn",value:function(t){if(void 0!==(t=t||{}).target){var e=t.callback||function(){};this.game.tweens.removeFrom(t.target);var n=this.game.add.tween(t.target);n.to({alpha:1},125),n.onComplete.addOnce(e),n.start()}}},{key:"fadeOut",value:function(t){if(void 0===(t=t||{}).target)throw new Error("No tween target provided");var e=t.callback||function(){};this.game.tweens.removeFrom(t.target);var n=this.game.add.tween(t.target);n.to({alpha:0},125),n.onComplete.addOnce(e),n.start()}}])&&Eu(e.prototype,n),i&&Eu(e,i),t}());function Au(t){return(Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ru(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Iu(t,e){return!e||"object"!==Au(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fu(t){return(Fu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Lu(t,e){return(Lu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Iu(this,Fu(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lu(t,e)}(e,Phaser.State),n=e,(i=[{key:"preload",value:function(){ju.replaceFilePathTags({"%PLATFORM%":this.game.device.desktop?"desktop":"mobile"}),ju.preloadAssetPacks(this.game,["main"])}},{key:"create",value:function(){var t,e,n,i,o,r,a,s,c;Ys.addLibrary(this.game,"mainLibrary","assets/main/flump/"),Rc.init(this.game,this.cache.getJSON("mainConfig")),Hc.init(this.game,this.cache.getJSON("captions")),Mc.init(this.game,Rc.audioMap),ru.init(this.game,Rc.contentUrls),yu.init(this.game,Rc.transition),bu.init(this.game,["boot","loading","intro"]),Tu.init(this.game),Rc.isDesktop&&nu.input.initCursor(Rc.cursor),Rc.debugFlags.gameArea&&nu.drawDimensions(),Rc.debugFlags.version&&(t=this.game,e=Rc.version,n=nu.safeArea,i=e.major,o=e.minor,r=e.build,a=n.bottom,s=n.left,c=t.make.text(0,0,"".concat(Rc.gameName," - v").concat(i,".").concat(o,".").concat(r," - ").concat(Rc.locale),{fontSize:18,fill:"#ffffff"}),t.stage.add(c),c.anchor.set(0,1),c.position.set(10+s,a),nu.resize.add(function(){c.position.set(10+nu.safeArea.left,nu.safeArea.bottom)})),this.state.start("loading",!0,!1,Rc.initialScene,[Rc.initialScene])}}])&&Ru(n.prototype,i),o&&Ru(n,o),e}();function Du(t){return(Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ku(t,e){return!e||"object"!==Du(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bu(t){return(Bu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vu(t,e){return(Vu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ku(this,Bu(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vu(t,e)}(e,Phaser.State),n=e,(i=[{key:"init",value:function(t,e,n){this.nextState=t,this.loadList=e||[],this.unloadList=n||[]}},{key:"create",value:function(){var t=this;if("parentMenu"===this.nextState&&(this.cache.checkJSONKey(Rc.elmo.flumpLibrary.key)&&ju.unloadFlump(this.game,[Rc.elmo.flumpManifest]),this.cache.checkJSONKey(Rc.abby.flumpLibrary.key)&&ju.unloadFlump(this.game,[Rc.abby.flumpManifest])),Rc.pottyLessonScenes.indexOf(this.nextState)>=0&&(Rc.character===Rc.characterOptions.elmo&&this.cache.checkJSONKey(Rc.abby.flumpLibrary.key)&&ju.unloadFlump(this.game,[Rc.abby.flumpManifest]),Rc.character===Rc.characterOptions.abby&&this.cache.checkJSONKey(Rc.elmo.flumpLibrary.key)&&ju.unloadFlump(this.game,[Rc.elmo.flumpManifest])),ju.unloadAssetPacks(this.game,this.unloadList),Rc.requiresPottyScenes.indexOf(this.nextState)>=0){var e=Rc.pottyFlump.flumpLibrary.key;this.cache.checkJSONKey(e)||ju.addFlumpLoaders(this.game,[Rc.pottyFlump.flumpManifest])}else{var n=Rc.pottyFlump.flumpLibrary.key;this.cache.checkJSONKey(n)&&ju.unloadFlump(this.game,[Rc.pottyFlump.flumpManifest])}if(Rc.pottyLessonScenes.indexOf(this.nextState)>=0){var i=Rc[Rc.character].flumpLibrary.key;if(!this.cache.checkJSONKey(i)){var o=Rc[Rc.character].flumpManifest;ju.addFlumpLoaders(this.game,[o])}}else"customization"!==this.nextState&&"playroom"!==this.nextState||(this.cache.checkJSONKey(Rc.elmo.flumpLibrary.key)||ju.addFlumpLoaders(this.game,[Rc.elmo.flumpManifest]),this.cache.checkJSONKey(Rc.abby.flumpLibrary.key)||ju.addFlumpLoaders(this.game,[Rc.abby.flumpManifest]));ju.loadAssetPacks(this.game,this.loadList),ju.addCompleteCallback(this.game,function(){t.state.start(t.nextState)})}}])&&Nu(n.prototype,i),o&&Nu(n,o),e}();function Uu(t){return(Uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t,e){return!e||"object"!==Uu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hu(t){return(Hu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wu(t,e){return(Wu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qu=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Gu(this,Hu(e).call(this,t))).config=n,i.display=Ys.libraries[n.flump.library].createClip(n.flump.animations.idle),i.addChild(i.display),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wu(t,e)}(e,Xs),e}();function Xu(t){return(Xu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yu(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ju(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qu(t,e,n){return(Qu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$u(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function $u(t){return($u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zu(t,e){return(Zu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tl=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Xu(e)&&"function"!=typeof e?Ju(t):e}(this,$u(e).call(this,t))).config=n,i.inputEnabled=!0,i.disabled=void 0!==n.disabled&&n.disabled,i.initializeHitArea(),i.initializeTimeoutAnimation(),i.initializeRollOver(),i.active=!0,i.isTimedOut=!1,i.allowHighlight=!0,i.events.onInputOver.add(i.onOver,Ju(i)),i.events.onInputOut.add(i.onOut,Ju(i)),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zu(t,e)}(e,Xs),n=e,(i=[{key:"destroy",value:function(){this.timeout=void 0,this.rollOver=void 0,Qu($u(e.prototype),"destroy",this).call(this)}},{key:"update",value:function(){if(Qu($u(e.prototype),"update",this).call(this),this.isTimedOut&&this.config.wigglesOnTimeout){var t=Math.sin(.0025*this.game.time.time);this.rotation=10*t*Phaser.Math.DEG_TO_RAD}if(!this.disabled&&this.active&&Rc.isDesktop){var n=this.checkInput();this.allowHighlight&&this.setRollOver(n?1:0),n&&nu.input.setCursorState(nu.input.cursorOver)}else this.setRollOver(0)}},{key:"addChild",value:function(t){Qu($u(e.prototype),"addChild",this).call(this,t),Rc.debugFlags.hitAreas&&void 0!==this.debugDisplay&&Qu($u(e.prototype),"addChild",this).call(this,this.debugDisplay)}},{key:"beginTimeout",value:function(){this.active&&this.allowHighlight&&(this.checkInput()?(Tu.clear(this.rollOver),Tu.clear(this.timeout),this.setRollOver(0),this.setTimeout(1)):void 0!==this.timeout&&Tu.fadeIn({target:this.timeout})),this.isTimedOut=!0}},{key:"endTimeout",value:function(){this.rotation=0,this.active&&this.allowHighlight&&(this.checkInput()?this.active&&(Tu.clear(this.rollOver),Tu.clear(this.timeout),this.setTimeout(0),this.setRollOver(1)):void 0!==this.timeout&&(Tu.clear(this.timeout),Tu.fadeOut({target:this.timeout}))),this.isTimedOut=!1}},{key:"onOver",value:function(){}},{key:"onOut",value:function(){nu.input.setCursorState(nu.input.cursorIdle)}},{key:"initializeTimeoutAnimation",value:function(){void 0!==this.config.timeout&&(this.timeout=new qu(this.game,this.config.timeout),this.addChild(this.timeout),this.timeout.alpha=0)}},{key:"initializeHitArea",value:function(){if(void 0!==this.config.hitArea){var t=this.config.hitArea||{};this.hitArea=new Phaser.Rectangle(t.x||0,t.y||0,t.width||0,t.height||0),Rc.debugFlags.hitAreas&&(this.debugDisplay=this.game.make.graphics(),this.debugDisplay.beginFill(65280,.5),this.debugDisplay.drawRect(this.hitArea.x,this.hitArea.y,this.hitArea.width,this.hitArea.height),this.debugDisplay.endFill(),this.addChild(this.debugDisplay))}}},{key:"initializeRollOver",value:function(){if(void 0!==this.config.rollOver){var t=this.config.rollOver||{};this.rollOver=Ys.libraries[t.flump.library].createClip(t.flump.animations.idle),this.addChild(this.rollOver),this.rollOver.alpha=0}}},{key:"setTimeout",value:function(t){Tu.clear(this.timeout),void 0!==this.timeout&&(this.timeout.alpha=t)}},{key:"setRollOver",value:function(t){Tu.clear(this.rollOver),void 0!==this.rollOver&&(this.rollOver.alpha=t)}},{key:"checkInput",value:function(){if(void 0===this.hitArea||void 0===this.rollOver)return!1;var t=this.getBounds(),e=t.x+this.hitArea.x,n=e+this.hitArea.width,i=t.y+this.hitArea.y,o=i+this.hitArea.height;return nu.input.checkRect(e,n,i,o)}}])&&Yu(n.prototype,i),o&&Yu(n,o),e}();function el(t){return(el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function il(t,e,n){return(il="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ol(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ol(t){return(ol=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function al(t,e,n){return e&&rl(t.prototype,e),n&&rl(t,n),t}function sl(t,e){return(sl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var cl=function(t){function e(t,n){var i;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==el(e)&&"function"!=typeof e?nl(t):e}(this,ol(e).call(this,t,n))).initializeDisplay(),void 0===n.anchor){var o=n.position||{x:0,y:0};i.position.set(o.x,o.y)}else i.anchorButton(),nu.resize.add(i.anchorButton,nl(i));return i.events.onInputDown.add(i.onDown,nl(i)),i.events.onInputUp.add(i.onUp,nl(i)),i.isPressed=!1,i.clicked=new Phaser.Signal,i.setState(i.states.up),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sl(t,e)}(e,tl),al(e,[{key:"states",get:function(){return{up:"up",down:"down",over:"over",out:"out"}}}]),al(e,[{key:"destroy",value:function(){nu.resize.remove(this.anchorButton,this),this.clicked.dispose(),this.clicked=void 0,il(ol(e.prototype),"destroy",this).call(this)}},{key:"onDown",value:function(){this.active?(this.isPressed=!0,this.setState(this.states.down),bu.stop(),this.setRollOver(0)):this.isPressed=!1}},{key:"onUp",value:function(){this.active&&this.isPressed&&(this.isPressed=!1,this.setState(this.states.up),bu.start(),void 0!==this.config.audioKeys&&void 0!==this.config.audioKeys.click&&Mc.play(this.config.audioKeys.click),this.clicked.dispatch(this))}},{key:"setState",value:function(t){this.buttonState=t,void 0!==this.config.flump.animations[t]&&this.display.loop(this.config.flump.animations[t])}},{key:"anchorButton",value:function(){switch(this.config.anchor){case"topLeft":this.position.set(nu.safeArea.left+.6*this.config.hitArea.width,nu.safeArea.top+.6*this.config.hitArea.height);break;case"topRight":this.position.set(nu.safeArea.right-.6*this.config.hitArea.width,nu.safeArea.top+.6*this.config.hitArea.height);break;case"bottomLeft":this.position.set(nu.safeArea.left+.6*this.config.hitArea.width,nu.safeArea.bottom-.6*this.config.hitArea.height);break;case"bottomRight":this.position.set(nu.safeArea.right-.6*this.config.hitArea.width,nu.safeArea.bottom-.6*this.config.hitArea.height);break;case"centerRight":this.position.set(nu.safeArea.right-.6*this.config.hitArea.width,nu.safeArea.top+.45*nu.safeArea.height)}var t=this.config.offset||{x:0,y:0};this.x+=t.x,this.y+=t.y}},{key:"initializeDisplay",value:function(){this.display=Ys.libraries[this.config.flump.library].createClip(),this.display.loop(this.config.flump.animations.up),this.addChild(this.display)}}]),e}();function ul(t){return(ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ll(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function hl(t,e){return!e||"object"!==ul(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fl(t,e,n){return(fl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=pl(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function pl(t){return(pl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yl(t,e){return(yl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),hl(this,pl(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yl(t,e)}(e,cl),n=e,(o=[{key:"initializeDisplay",value:function(){fl(pl(e.prototype),"initializeDisplay",this).call(this),this.content=this.game.make.group(),this.addChild(this.content)}},{key:"setState",value:function(t){fl(pl(e.prototype),"setState",this).call(this,t);var n=i.getElse([this.config,"contentStates",t,"position"],{x:this.content.position.x,y:this.content.position.y});this.content.position.set(n.x,n.y)}}])&&ll(n.prototype,o),r&&ll(n,r),e}();function vl(t){return(vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ml(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function gl(t,e){return!e||"object"!==vl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bl(t,e,n){return(bl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wl(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function wl(t){return(wl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kl(t,e){return(kl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ol=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),gl(this,wl(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kl(t,e)}(e,dl),n=e,(i=[{key:"initializeDisplay",value:function(){bl(wl(e.prototype),"initializeDisplay",this).call(this),this.bmf=Gy.create(this.game,this.config.text),this.content.add(this.bmf)}},{key:"text",get:function(){return this.bmf.text},set:function(t){this.bmf.text=t}}])&&ml(n.prototype,i),o&&ml(n,o),e}();function Sl(t){return(Sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Cl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _l(t,e,n){return(_l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xl(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function xl(t){return(xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jl(t,e){return(jl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var El=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Sl(e)&&"function"!=typeof e?Cl(t):e}(this,xl(e).call(this,t))).config=n,i.allowInput=!1,i.isOpened=!1,i.screenOverlay=t.make.graphics(),i.addChild(i.screenOverlay),i.screenOverlay.beginFill(n.overlay.color,1),i.screenOverlay.drawRect(0,0,t.width,t.height),i.screenOverlay.endFill(),i.content=t.make.group(),i.addChild(i.content),i.content.position.set(t.width/2,t.height/2),i.isOpened=!1,i.content.visible=!1,i.screenOverlay.visible=!1,i.inputEnabled=!0,i.opened=new Phaser.Signal,i.closed=new Phaser.Signal,i.events.onInputUp.add(i.overlayClicked,Cl(i)),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jl(t,e)}(e,Xs),n=e,(i=[{key:"destroy",value:function(){this.opened.dispose(),this.opened=void 0,this.closed.dispose(),this.closed=void 0,_l(xl(e.prototype),"destroy",this).call(this)}},{key:"open",value:function(){nu.input.setCursorState(nu.input.cursorIdle),this.screenOverlay.alpha=0,this.screenOverlay.visible=!0;var t=this.game.add.tween(this.screenOverlay).to({alpha:this.config.overlay.alpha},250);t.onComplete.add(this.showContent,this),t.start(),this.isOpened=!0}},{key:"close",value:function(){var t=this;nu.input.setCursorState(nu.input.cursorIdle),this.toggleInput(!1),this.hideContent(function(){t.screenOverlay.alpha=t.config.overlay.alpha,t.screenOverlay.visible=!0;var e=t.game.add.tween(t.screenOverlay).to({alpha:0},250);e.onComplete.add(function(){t.screenOverlay.visible=!1,t.closed.dispatch(),t.isOpened=!1}),e.start()})}},{key:"showContent",value:function(){this.content.visible=!0}},{key:"hideContent",value:function(t){this.content.visible=!1,void 0!==t&&t()}},{key:"overlayClicked",value:function(){this.allowInput&&this.close()}},{key:"toggleInput",value:function(t){this.allowInput=t}}])&&Pl(n.prototype,i),o&&Pl(n,o),e}();function Tl(t){return(Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Al(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Rl(t,e){return!e||"object"!==Tl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Il(t){return(Il=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fl(t,e){return(Fl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ll=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Rl(this,Il(e).call(this,t,n))).isTimeouted=!1,i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fl(t,e)}(e,cl),n=e,(i=[{key:"initializeDisplay",value:function(){this.display=Ys.libraries[this.config.flump.library].createClip(),this.addChild(this.display),this.playIdle()}},{key:"playIdle",value:function(){this.display.loop(this.config.flump.animations.idle)}},{key:"playAction",value:function(){this.display.loop(this.config.flump.animations.action)}},{key:"playPottyIdle",value:function(){this.display.loop(this.config.flump.animations.pottyIdle)}}])&&Al(n.prototype,i),o&&Al(n,o),e}();function Ml(t){return(Ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Nl(t,e){return!e||"object"!==Ml(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kl(t){return(Kl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bl(t,e){return(Bl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Vl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Nl(this,Kl(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bl(t,e)}(e,cl),n=e,(i=[{key:"initializeDisplay",value:function(){this.current=0,this.current=this.findCurrentState(),this.display=Ys.libraries[this.config.states[this.current].flump.library].createClip(),this.display.loop(this.config.states[this.current].flump.animations.idle),this.addChild(this.display)}},{key:"onUp",value:function(){var t=this;this.active&&this.isPressed&&(this.current=ns.mod(this.current+1,this.config.states.length),this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){t.display.playOnce(t.config.states[t.current].flump.animations.idle)}),this.display.playOnce(this.config.states[this.current].flump.animations.press),this.isPressed=!1,this.clicked.dispatch(this),Mc.play(this.config.audioKeys.click),bu.start())}},{key:"setState",value:function(){}},{key:"findCurrentState",value:function(){return"color"===this.config.type?Object.keys(Rc.pottyColors).indexOf(Rc.potty.color):Rc.potty.seat}}])&&Dl(n.prototype,i),o&&Dl(n,o),e}();function zl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ul=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"uuid",value:function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"".concat(t()).concat(t(),"-").concat(t(),"-").concat(t(),"-").concat(t(),"-").concat(t()).concat(t()).concat(t())}},{key:"shuffle",value:function(t){for(var e=(t=t.slice()).length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=[t[n],t[e]];t[e]=i[0],t[n]=i[1]}return t}},{key:"between",value:function(t,e){return t=Math.min(t,e),e=Math.max(t,e),t+Math.round(Math.random()*(e-t))}},{key:"item",value:function(t){if(0!==t.length)return t[this.between(0,t.length-1)]}}])&&zl(e.prototype,n),i&&zl(e,i),t}());function Gl(t){return(Gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Wl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ql(t,e,n){return(ql="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xl(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Xl(t){return(Xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yl(t,e){return(Yl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jl=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Gl(e)&&"function"!=typeof e?Wl(t):e}(this,Xl(e).call(this,t,n))).enteredNumbers=[],i.correctAnswer=[],i.keypad=[],i.codeOptions=[],i.currentInput=0,i.display=Ys.libraries[n.panel.flump.library].createClip(n.panel.flump.animations.idle),i.content.add(i.display),i.heading=Gy.create(t,n.heading),i.content.add(i.heading),i.display.inputEnabled=!0,i.codeText=Gy.create(t,n.code.label),i.codeText.position.set(n.code.position.x,n.code.position.y),i.codeText.anchor.set(.5),i.codeText.align="center",i.content.add(i.codeText),Object.keys(n.buttonMap).forEach(function(t){i.codeOptions.push(t);var e=i.config.buttonMap[t],o=zy.create(i.game,n.buttonConfig);o.text=e.value,o.active=!1,o.clicked.add(function(){return i.onButtonDown(parseInt(e.value))}),o.position.set(e.position.x,e.position.y),i.content.add(o),i.keypad.push(o)}),i.btnClose=zy.create(i.game,"btnModalClose"),i.content.add(i.btnClose),i.btnClose.position.set(n.close.position.x,n.close.position.y),i.btnClose.clicked.add(i.close,Wl(i)),i.success=new Phaser.Signal,i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yl(t,e)}(e,El),n=e,(i=[{key:"destroy",value:function(){bu.timeoutBegin.remove(this.onTimeoutBegin,this),bu.timeoutEnd.remove(this.onTimeoutEnd,this),this.success.dispose(),this.success=void 0,ql(Xl(e.prototype),"destroy",this).call(this)}},{key:"toggleInput",value:function(t){ql(Xl(e.prototype),"toggleInput",this).call(this,t),this.btnClose.active=t,this.keypad.forEach(function(e){return e.active=t})}},{key:"showContent",value:function(){var t=this;this.content.visible=!0,this.content.position.set(this.content.x,-this.game.height/2),this.generateCode(),this.currentInput=0;var e=this.game.add.tween(this.content).to({y:this.game.height/2},500,Phaser.Easing.Back.Out);e.onComplete.add(function(){bu.timeoutBegin.add(t.onTimeoutBegin,t),bu.timeoutEnd.add(t.onTimeoutEnd,t),t.toggleInput(!0),t.opened.dispatch()}),e.start()}},{key:"hideContent",value:function(t){bu.timeoutBegin.remove(this.onTimeoutBegin,this),bu.timeoutEnd.remove(this.onTimeoutEnd,this),this.keypad.forEach(function(t){return t.active=!1}),this.content.visible=!0,this.content.position.set(this.content.x,this.game.height/2);var e=this.game.add.tween(this.content).to({y:-this.game.height/2},500,Phaser.Easing.Back.In);e.onComplete.add(function(){void 0!==t&&t()}),e.start()}},{key:"generateCode",value:function(){this.currentInput=0,this.enteredNumbers=[],this.correctAnswer=Ul.shuffle(ns.numbers(1,this.codeOptions.length)).slice(0,this.config.code.codeLength);for(var t=[],e=0;e<this.correctAnswer.length;e++)t.push(this.codeOptions[this.correctAnswer[e]-1].toUpperCase());this.codeText.text=t.join(" "),this.codeText.anchor.set(.5)}},{key:"onTimeoutBegin",value:function(){this.btnClose.beginTimeout(),this.keypad.forEach(function(t){return t.beginTimeout()})}},{key:"onTimeoutEnd",value:function(){this.btnClose.endTimeout(),this.keypad.forEach(function(t){return t.endTimeout()})}},{key:"onButtonDown",value:function(t){var e=this;if(this.currentInput<this.config.code.codeLength)if(this.correctAnswer[this.currentInput]===t)this.currentInput++,this.currentInput>=this.config.code.codeLength&&this.success.dispatch();else{this.toggleInput(!1),this.content.x=this.game.width/2-50;var n=this.game.add.tween(this.content).to({x:this.game.width/2},500,Phaser.Easing.Elastic.Out);n.onComplete.add(function(){return e.toggleInput(!0)}),n.start(),this.generateCode()}}},{key:"close",value:function(){Mc.stopVO(),ql(Xl(e.prototype),"close",this).call(this)}}])&&Hl(n.prototype,i),o&&Hl(n,o),e}();function Ql(t){return(Ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Zl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function th(t,e,n){return(th="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=eh(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function eh(t){return(eh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nh(t,e){return(nh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ih=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Ql(e)&&"function"!=typeof e?Zl(t):e}(this,eh(e).call(this,t,n))).initializeDisplay(),i.position.set(n.position.x,n.position.y),i.actionBegin=new Phaser.Signal,i.actionEnd=new Phaser.Signal,i.isPressed=!1,i.events.onInputDown.add(i.onDown,Zl(i)),i.events.onInputUp.add(i.onUp,Zl(i)),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nh(t,e)}(e,tl),n=e,(i=[{key:"destroy",value:function(){this.actionBegin.dispose(),this.actionBegin=void 0,this.actionEnd.dispose(),this.actionEnd=void 0,th(eh(e.prototype),"destroy",this).call(this)}},{key:"onDown",value:function(){!this.disabled&&this.active&&(this.isPressed=!0)}},{key:"onUp",value:function(){!this.disabled&&this.active&&this.isPressed&&(this.isPressed=!1,this.playAction())}},{key:"onOut",value:function(){th(eh(e.prototype),"onOut",this).call(this),this.isPressed=!1}},{key:"playIdle",value:function(){this.display.onComplete.removeAll(),this.display.loop(this.config.flump.animations.idle)}},{key:"playAction",value:function(){var t=this;this.setRollOver(0),this.setTimeout(0),this.active=!1,this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){t.active=!0,t.playIdle(),t.actionEnd.dispatch(t),t.active&&t.checkInput()&&t.setRollOver(1)}),this.display.playOnce(this.config.flump.animations.action),this.actionBegin.dispatch(this),void 0!==this.config.audioKeys&&Mc.play(this.config.audioKeys.action)}},{key:"initializeDisplay",value:function(){this.display=Ys.libraries[this.config.flump.library].createClip(),this.addChild(this.display),this.playIdle()}}])&&$l(n.prototype,i),o&&$l(n,o),e}();function oh(t){return(oh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ah(t,e,n){return(ah="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sh(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function sh(t){return(sh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ch(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function uh(t,e,n){return e&&ch(t.prototype,e),n&&ch(t,n),t}function lh(t,e){return(lh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hh=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==oh(e)&&"function"!=typeof e?rh(t):e}(this,sh(e).call(this,t,n))).gottaGo=!1,i.voReactions=n.voReactions||[],i.reactingToVO=!1,Mc.channelPlayed.add(i.onVOPlayed,rh(i)),Mc.channelStopped.add(i.onVOStopped,rh(i)),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lh(t,e)}(e,ih),uh(e,[{key:"states",get:function(){return{playtime:0,gottaGo:1}}}]),uh(e,[{key:"destroy",value:function(){Mc.channelPlayed.remove(this.onVOPlayed,this),Mc.channelStopped.remove(this.onVOStopped,this),ah(sh(e.prototype),"destroy",this).call(this)}},{key:"onVOPlayed",value:function(t,e){this.voReactions.indexOf(e)>=0&&(this.display.onComplete.removeAll(),this.gottaGo?(this.display.loop(this.config.flump.animations.pottyDanceIdleFlap[Rc.currentPottyDance]),this.updateHighlights()):this.display.loop(this.config.flump.animations.idleFlap),this.reactingToVO=!0)}},{key:"onVOStopped",value:function(t,e){this.voReactions.indexOf(e)>=0&&(this.reactingToVO=!1,this.playIdle())}},{key:"playPottyDance",value:function(){var t=this;this.gottaGo=!0,this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){return t.playIdle()}),this.display.playOnce(this.config.flump.animations.pottyDance[Rc.currentPottyDance]),this.updateHighlights()}},{key:"playIdle",value:function(){this.display.onComplete.removeAll(),this.state===this.states.playtime?this.display.loop(this.config.flump.animations.idle):this.display.loop(this.config.flump.animations.pottyDanceIdle[Rc.currentPottyDance]),this.updateHighlights()}},{key:"playAction",value:function(){this.reactingToVO||ah(sh(e.prototype),"playAction",this).call(this)}},{key:"playEndReaction",value:function(){this.display.onComplete.removeAll(),this.display.playOnce(this.config.flump.animations.action)}},{key:"updateHighlights",value:function(){this.state===this.states.playtime?this.timeout.display.loop(this.config.timeout.flump.animations.idle):this.timeout.display.loop(this.config.timeout.flump.animations.pottyIdle[Rc.currentPottyDance])}},{key:"beginTimeout",value:function(){this.gottaGo||ah(sh(e.prototype),"beginTimeout",this).call(this)}},{key:"initializeDisplay",value:function(){this.state=this.states.playtime,ah(sh(e.prototype),"initializeDisplay",this).call(this)}}]),e}();function fh(t){return(fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ph(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yh(t,e,n){return(yh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=dh(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function dh(t){return(dh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function mh(t,e,n){return e&&vh(t.prototype,e),n&&vh(t,n),t}function gh(t,e){return(gh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var bh=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==fh(e)&&"function"!=typeof e?ph(t):e}(this,dh(e).call(this,t,n))).characterConfig=n[Rc.character],i.initializeRollOver(),i.initializeTimeoutAnimation(),i.initializeHitArea(),i.display=Ys.libraries[i.characterConfig.flump.library].createClip(),i.addChild(i.display),i.position.set(n.position.x,n.position.y),i.playIdle(),i.updateHighlights(),i.onCollision=new Phaser.Signal,i.isMoving=!1,i.isSwappingDirections=!1,i.isVOLipFlap=!1,i.facing=0,t.physics.enable(ph(i)),i.voReactions=i.characterConfig.voReactions||[],Mc.channelPlayed.add(i.onVOPlayed,ph(i)),Mc.channelStopped.add(i.onVOStopped,ph(i)),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gh(t,e)}(e,tl),mh(e,[{key:"bounds",get:function(){return{x:this.hitArea.x,y:this.hitArea.y,width:this.hitArea.width,height:this.hitArea.height,left:this.position.x+this.hitArea.x,right:this.position.x+this.hitArea.x+this.hitArea.width,top:this.position.y+this.hitArea.y,bottom:this.position.y+this.hitArea.y+this.hitArea.height}}}]),mh(e,[{key:"destroy",value:function(){this.onCollision.dispose(),this.onCollision=void 0,Mc.channelPlayed.remove(this.onVOPlayed,this),Mc.channelStopped.remove(this.onVOStopped,this),yh(dh(e.prototype),"destroy",this).call(this)}},{key:"onVOPlayed",value:function(t,e){this.voReactions.indexOf(e)>=0&&(this.display.onComplete.removeAll(),this.display.loop(this.characterConfig.flump.animations.idleFlap[Rc.currentPottyDance]),this.isVOLipFlap=!0)}},{key:"onVOStopped",value:function(t,e){this.voReactions.indexOf(e)>=0&&(this.isVOLipFlap=!1,this.playIdle())}},{key:"update",value:function(){yh(dh(e.prototype),"update",this).call(this);var t=this.keepInSafeArea(this.position.x,this.position.y);this.position.set(t.x,t.y);var n=this.characterConfig.collider.middle;this.facing<0?n=this.characterConfig.collider.left:this.facing>0&&(n=this.characterConfig.collider.right),this.body.setSize(n.width,n.height,n.x,n.y)}},{key:"playIdle",value:function(){if(!this.isMoving){this.display.onComplete.removeAll();var t=this.isVOLipFlap?this.characterConfig.flump.animations.idleFlap[Rc.currentPottyDance]:this.characterConfig.flump.animations.idle[Rc.currentPottyDance];this.display.loop(t,!1),this.facing=0}this.updateHighlights()}},{key:"playWalk",value:function(t){var e=this,n=function(){e.display.onComplete.removeAll(),-1===e.facing?e.display.loop(e.characterConfig.flump.animations.move.left,!1):e.display.loop(e.characterConfig.flump.animations.move.right,!1)};this.facing!==t?(this.facing=t,this.isSwappingDirections=!0,this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){e.isSwappingDirections=!1,n()}),this.display.playOnce(this.characterConfig.flump.animations.move.middle)):this.isSwappingDirections||n()}},{key:"playBump",value:function(){this.display.onComplete.removeAll(),-1===this.facing?this.display.loop(this.characterConfig.flump.animations.bump.left,!1):this.display.loop(this.characterConfig.flump.animations.bump.right,!1)}},{key:"initializeTimeoutAnimation",value:function(){void 0!==this.characterConfig&&(this.timeout=new qu(this.game,this.characterConfig.timeout),this.addChild(this.timeout),this.timeout.alpha=0)}},{key:"initializeHitArea",value:function(){if(void 0!==this.characterConfig){var t=this.characterConfig.hitArea||{};this.hitArea=new Phaser.Rectangle(t.x||0,t.y||0,t.width||0,t.height||0),Rc.debugFlags.hitAreas&&(this.debug=this.game.make.graphics(),this.debug.beginFill(65280,.5),this.debug.drawRect(this.hitArea.x,this.hitArea.y,this.hitArea.width,this.hitArea.height),this.debug.endFill(),this.addChild(this.debug))}}},{key:"keepInSafeArea",value:function(t,e){var n=this.characterConfig.collider.middle;this.facing<0?n=this.characterConfig.collider.left:this.facing>0&&(n=this.characterConfig.collider.right);var i=t+n.x,o=i+n.width,r=e+n.y,a=r+n.height;return i<nu.safeArea.left&&(t=nu.safeArea.left-n.x),o>nu.safeArea.right&&(t=nu.safeArea.right-(n.x+n.width)),r<this.config.maxHeight&&(e=this.config.maxHeight-n.y),r<nu.safeArea.top&&(e=nu.safeArea.top-n.y),a>nu.safeArea.bottom&&(e=nu.safeArea.bottom-(n.y+n.height)),{x:t,y:e}}},{key:"updateHighlights",value:function(){this.timeout.display.loop(this.characterConfig.timeout.flump.animations.pottyIdle[Rc.currentPottyDance])}}]),e}();function wh(t){return(wh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Oh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sh(t,e,n){return(Sh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ph(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ph(t){return(Ph=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ch(t,e){return(Ch=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _h=function(t){function e(t,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==wh(e)&&"function"!=typeof e?Oh(t):e}(this,Ph(e).call(this,t))).config=n,i.display=Ys.libraries[n.flump.library].createClip(n.flump.animations.idle),i.addChild(i.display),i.position.set(n.position.x,n.position.y);var o=n.hitArea||{};return i.hitArea=new Phaser.Rectangle(o.x||0,o.y||0,o.width||0,o.height||0),t.physics.enable(Oh(i)),i.body.setSize(n.collider.width,n.collider.height,n.collider.x,n.collider.y),i.body.immovable=!0,i.collisionTracker=0,i.collisionCooldownElapsed=0,i.collisionCooldown=!1,i.requiresCorrection=!1,i.cooldownComplete=new Phaser.Signal,i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ch(t,e)}(e,Xs),n=e,(i=[{key:"destroy",value:function(){this.cooldownComplete.dispose(),this.cooldownComplete=void 0,Sh(Ph(e.prototype),"destroy",this).call(this)}},{key:"update",value:function(){this.collisionCooldown&&(this.collisionCooldownElapsed+=.001*this.game.time.elapsedMS,this.collisionCooldownElapsed>=3&&(this.collisionCooldownElapsed=0,this.collisionTracker=0,this.collisionCooldown=!1,this.cooldownComplete.dispatch()))}}])&&kh(n.prototype,i),o&&kh(n,o),e}();function xh(t){return(xh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Eh(t,e){return!e||"object"!==xh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Th(t){return(Th=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ah(t,e){return(Ah=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rh=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Eh(this,Th(e).call(this,t))).sortedLayer=t.make.group(),i.config=n,i.layout=Ul.item(i.config.layouts),i.initializeObstacles(),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ah(t,e)}(e,Xs),n=e,(i=[{key:"initializeObstacles",value:function(){var t=this;this.obstacles=[],this.layout.obstacles.forEach(function(e){var n=new _h(t.game,{position:e.position,collider:t.config.obstacles[e.key].collider,flump:t.config.obstacles[e.key].flump});t.sortedLayer.add(n)})}}])&&jh(n.prototype,i),o&&jh(n,o),e}();function Ih(t){return(Ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Lh(t){return(Lh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dh(t,e){return(Dh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nh=function(t){function e(t,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Ih(e)&&"function"!=typeof e?Mh(t):e}(this,Lh(e).call(this,t))).config=n,i.timeout=new qu(i.game,i.config.timeout),i.addChild(i.timeout),i.timeout.alpha=0;var o=i.config.timeout.position||{x:0,y:0};i.timeout.position.set(o.x,o.y),i.display=Ys.libraries[n.flump.library].createClip(n.flump.animations.idle),i.addChild(i.display),i.position.set(n.position.x,n.position.y);var r=n.hitArea||{};return i.hitArea=new Phaser.Rectangle(r.x||0,r.y||0,r.width||0,r.height||0),Rc.debugFlags.hitAreas&&(i.debug=t.make.graphics(),i.debug.beginFill(65280,.5),i.debug.drawRect(i.hitArea.x,i.hitArea.y,i.hitArea.width,i.hitArea.height),i.debug.endFill(),i.addChild(i.debug)),t.physics.enable(Mh(i)),i.body.setSize(n.collider.width,n.collider.height,n.collider.x,n.collider.y),i.body.immovable=!0,i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dh(t,e)}(e,Xs),n=e,(i=[{key:"beginTimeout",value:function(){Tu.fadeIn({target:this.timeout})}},{key:"endTimeout",value:function(){Tu.fadeOut({target:this.timeout})}},{key:"openDoor",value:function(){this.display.playOnce(this.config.flump.animations.action)}}])&&Fh(n.prototype,i),o&&Fh(n,o),e}();function Kh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Bh(t,e,n){return e&&Kh(t.prototype,e),n&&Kh(t,n),t}var Vh=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e,this.state=n,this.enabled=!0,this.isDown=!1,this.useKeyboard=!1,this.isDragging=!1,this.allowAnimChange=!0,this.facing=1,this.keyDirections={x:0,y:0},this.offset={x:0,y:0},this.moveToPoint=void 0,this.lastPos=void 0,this.lastInput=void 0,nu.input.events.onInputDown.add(this.onInputDown,this),nu.input.events.onInputUp.add(this.onInputUp,this),this.state.character.onCollision.add(this.onCharacterCollision,this)}return Bh(t,[{key:"leftKeyState",get:function(){return this.game.input.keyboard.isDown(Phaser.Keyboard.LEFT)}},{key:"rightKeyState",get:function(){return this.game.input.keyboard.isDown(Phaser.Keyboard.RIGHT)}},{key:"upKeyState",get:function(){return this.game.input.keyboard.isDown(Phaser.Keyboard.UP)}},{key:"downKeyState",get:function(){return this.game.input.keyboard.isDown(Phaser.Keyboard.DOWN)}}]),Bh(t,[{key:"destroy",value:function(){this.game=void 0,this.state=void 0}},{key:"update",value:function(){this.enabled&&(Rc.isDesktop&&this.checkArrowKeys(),this.useKeyboard?this.updateKeyboardMovement():void 0!==this.moveToPoint?this.updateMoveTo():this.updateDraggingMovement(),this.updateCharacterAnimationState())}},{key:"updateKeyboardMovement",value:function(){var t=0,e=0;this.leftKeyState&&t--,this.rightKeyState&&t++,this.upKeyState&&e--,this.downKeyState&&e++;var n=ns.clampMagnitude(t,e,1),i=this.state.config.maxSpeed*(.001*this.game.time.elapsedMS);this.state.character.x+=n.x*i,this.state.character.y+=n.y*i}},{key:"updateMoveTo",value:function(){var t={x:this.moveToPoint.x-this.state.character.x,y:this.moveToPoint.y-this.state.character.y},e=Math.atan2(t.y,t.x),n=Math.cos(e),i=Math.sin(e),o=this.state.config.maxSpeed*(.001*this.game.time.elapsedMS);this.state.character.x+=n*o,this.state.character.y+=i*o,ns.distance(this.moveToPoint.x,this.moveToPoint.y,this.state.character.x,this.state.character.y)<o&&(this.state.character.x=this.moveToPoint.x,this.state.character.y=this.moveToPoint.y,this.moveToPoint=void 0)}},{key:"updateDraggingMovement",value:function(){var t,e,n,i,o={x:this.game.input.x-this.offset.x,y:this.game.input.y-this.offset.y};this.isDown&&ns.distance(o.x,o.y,this.state.character.x,this.state.character.y)>25&&(t={x:o.x-this.state.character.x,y:o.y-this.state.character.y},e=Math.atan2(t.y,t.x),n={x:Math.cos(e),y:Math.sin(e)},i=this.state.config.maxSpeed*(.001*this.game.time.elapsedMS),this.state.character.x+=n.x*i,this.state.character.y+=n.y*i,ns.distance(o.x,o.y,this.state.character.x-this.offset.x,this.state.character.y-this.offset.y)<i&&(this.state.character.x=o.x,this.state.character.y=o.y))}},{key:"updateCharacterAnimationState",value:function(){void 0===this.lastPos&&(this.lastPos={x:this.state.character.x,y:this.state.character.y});var t={x:this.state.character.x-this.lastPos.x,y:this.state.character.y-this.lastPos.y},e=Math.floor(ns.magnitude(t.x,t.y));this.allowAnimChange&&(this.allowAnimChange=!1,this.setWalkTimer(),e<3?this.state.character.playIdle():(this.facing=t.x<0?-1:1,this.state.character.playWalk(this.facing))),0!==e?(bu.reset(),this.state.character.setRollOver(0),this.state.character.isMoving=!0):this.state.character.isMoving=!1,this.lastPos.x=this.state.character.x,this.lastPos.y=this.state.character.y}},{key:"setWalkTimer",value:function(){var t=this;this.killWalkTimer(),this.walkTimer=this.game.time.events.add(125,function(){t.killWalkTimer(),t.allowAnimChange=!0})}},{key:"killWalkTimer",value:function(){void 0!==this.walkTimer&&(this.game.time.events.remove(this.walkTimer),this.walkTimer=void 0)}},{key:"checkArrowKeys",value:function(){!this.useKeyboard&&(this.leftKeyState||this.rightKeyState||this.upKeyState||this.downKeyState)&&(this.useKeyboard=!0,this.isDown=!1,this.lastPos=void 0,this.lastInput=void 0)}},{key:"clearVelocity",value:function(){}},{key:"onCharacterCollision",value:function(){this.moveToPoint=void 0}},{key:"onInputDown",value:function(){if(this.enabled&&!this.isDown){this.useKeyboard=!1;var t=this.state.character.bounds;nu.input.checkRect(t.left,t.right,t.top,t.bottom)&&(this.moveToPoint=void 0,this.isDown=!0),bu.stop(),this.offset.x=this.game.input.x-this.state.character.x,this.offset.y=this.game.input.y-this.state.character.y,this.moveToPoint=void 0}}},{key:"onInputUp",value:function(){this.enabled&&(this.isDragging||this.isDown||(this.moveToPoint=this.state.character.keepInSafeArea(this.game.input.x,this.game.input.y)),Rc.isMobile&&(this.isDown=!1,bu.start())),this.isDragging=!1,this.lastPos=void 0,this.lastInput=void 0}}]),t}();function zh(t){return(zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Uh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Gh(t,e){return!e||"object"!==zh(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Hh(t,e,n){return(Hh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Wh(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Wh(t){return(Wh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qh(t,e){return(qh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xh=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Gh(this,Wh(e).call(this,t))).config=n,i.display=Ys.libraries[n.frame.flump.library].createClip(n.frame.flump.animations.idle),i.addChild(i.display),i.fill=Ys.libraries[n.fill.flump.library].createClip(n.fill.flump.animations.idle),i.addChild(i.fill),i.fill.mask=i.game.make.graphics(),i.fill.mask.beginFill(16711680,1),i.fill.mask.drawRect(n.mask.bounds.x,n.mask.bounds.y,n.mask.bounds.width,n.mask.bounds.height),i.fill.mask.endFill(),i.fill.addChild(i.fill.mask),i.fillTween=void 0,i.fillTarget=i.getFillTarget(),i.fill.mask.y=i.fillTarget,i.tweenFill=!0,i.position.set(n.position.x,n.position.y),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qh(t,e)}(e,Xs),n=e,(i=[{key:"destroy",value:function(){this.killFillTween(),Hh(Wh(e.prototype),"destroy",this).call(this)}},{key:"update",value:function(){if(this.tweenFill){var t=this.getFillTarget();this.fillTarget!==t&&(this.fillTarget=t,this.startFillTween())}else this.fill.mask.y=this.getFillTarget()}},{key:"startFillTween",value:function(){this.killFillTween(),this.fillTween=this.game.add.tween(this.fill.mask).to({y:this.fillTarget},500,Phaser.Easing.Quadratic.Out),this.fillTween.onComplete.addOnce(this.killFillTween,this),this.fillTween.start()}},{key:"killFillTween",value:function(){void 0!==this.fillTween&&(this.game.tweens.remove(this.fillTween),this.fillTween=void 0)}},{key:"getFillTarget",value:function(){var t=this.config.mask.bounds.height;return t-t*Rc.accidentProgress}}])&&Uh(n.prototype,i),o&&Uh(n,o),e}();function Yh(t){return(Yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jh(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Qh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $h(t,e,n){return($h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zh(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Zh(t){return(Zh=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tf(t,e){return(tf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ef=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Yh(e)&&"function"!=typeof e?Qh(t):e}(this,Zh(e).call(this,t))).config=n,i.characterConfig=n[Rc.character],i.display=Ys.libraries[i.characterConfig.flump.library].createClip(),i.addChild(i.display),i.playIdle(),i.position.set(n.position.x,n.position.y),i.voReactions=i.characterConfig.voReactions||[],Mc.channelPlayed.add(i.onVOPlayed,Qh(i)),Mc.channelStopped.add(i.onVOStopped,Qh(i)),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tf(t,e)}(e,Xs),n=e,(i=[{key:"destroy",value:function(){Mc.channelPlayed.remove(this.onVOPlayed,this),Mc.channelStopped.remove(this.onVOStopped,this),$h(Zh(e.prototype),"destroy",this).call(this)}},{key:"onVOPlayed",value:function(t,e){this.voReactions.indexOf(e)>=0&&(this.display.onComplete.removeAll(),this.display.loop(this.characterConfig.flump.animations.lipFlap))}},{key:"onVOStopped",value:function(t,e){this.voReactions.indexOf(e)>=0&&this.playIdle()}},{key:"playIdle",value:function(){this.display.onComplete.removeAll(),this.display.loop(this.characterConfig.flump.animations.idle)}},{key:"playAction",value:function(){var t=this;this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){t.playIdle()}),this.display.playOnce(this.characterConfig.flump.animations.action)}}])&&Jh(n.prototype,i),o&&Jh(n,o),e}();function nf(t){return(nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function of(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function rf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function af(t,e,n){return(af="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sf(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function sf(t){return(sf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cf(t,e){return(cf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var uf=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==nf(e)&&"function"!=typeof e?rf(t):e}(this,sf(e).call(this,t))).config=n,i.characterConfig=n[Rc.character],i.display=Ys.libraries[i.characterConfig.flump.library].createClip(),i.addChild(i.display),i.playIdle(),i.position.set(n.position.x,n.position.y),Mc.channelPlayed.add(i.onVOPlayed,rf(i)),Mc.channelStopped.add(i.onVOStopped,rf(i)),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cf(t,e)}(e,Xs),n=e,(i=[{key:"destroy",value:function(){Mc.channelPlayed.remove(this.onVOPlayed,this),Mc.channelStopped.remove(this.onVOStopped,this),af(sf(e.prototype),"destroy",this).call(this)}},{key:"onVOPlayed",value:function(t,e){this.characterConfig.voReactions.indexOf(e)>=0&&(this.display.onComplete.removeAll(),this.display.loop(this.characterConfig.flump.animations.idleFlap))}},{key:"onVOStopped",value:function(t,e){this.characterConfig.voReactions.indexOf(e)>=0&&this.playIdle()}},{key:"playIdle",value:function(){this.display.onComplete.removeAll(),this.display.loop(this.characterConfig.flump.animations.idle)}},{key:"playActionStart",value:function(t){var e=this;t=t||function(){},this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){t(),e.playActionIdle()}),this.display.playOnce(this.characterConfig.flump.animations.actionStart)}},{key:"playActionIdle",value:function(){this.display.onComplete.removeAll(),this.display.playOnce(this.characterConfig.flump.animations.actionIdle)}},{key:"playActionEnd",value:function(t){t=t||function(){},this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){t()}),this.display.playOnce(this.characterConfig.flump.animations.actionEnd)}}])&&of(n.prototype,i),o&&of(n,o),e}();function lf(t){return(lf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ff(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pf(t,e,n){return(pf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yf(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function yf(t){return(yf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function df(t,e){return(df=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vf=function(t){function e(t,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==lf(e)&&"function"!=typeof e?ff(t):e}(this,yf(e).call(this,t,n))).underlay=Ys.libraries[n.underlay.flump.library].createClip(n.underlay.flump.animations.idle),i.addChild(i.underlay),i.toiletPaperContainer=t.make.group(),i.addChild(i.toiletPaperContainer),i.overlay=Ys.libraries[n.overlay.flump.library].createClip(n.overlay.flump.animations.idle),i.addChild(i.overlay);var o=i.createToiletPaperPiece();return i.toiletPaperContainer.add(o),i.toiletPaperContainer.mask=t.make.graphics(),i.toiletPaperContainer.mask.beginFill(),i.toiletPaperContainer.mask.drawRect(i.hitArea.x,0,i.hitArea.width,i.game.height),i.toiletPaperContainer.mask.endFill(),i.addChild(i.toiletPaperContainer.mask),i.isDown=!1,i.isDragging=!1,i.animating=!1,i.lastPointer=void 0,i.toiletPaperAnchorPoint={x:0,y:0},i.position.set(n.position.x,n.position.y),i.events.onInputDown.add(i.onInputDown,ff(i)),i.events.onInputUp.add(i.onInputUp,ff(i)),i.objectiveMet=new Phaser.Signal,i.squareAdded=new Phaser.Signal,i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&df(t,e)}(e,tl),n=e,(i=[{key:"destroy",value:function(){this.objectiveMet.dispose(),this.objectiveMet=void 0,this.squareAdded.dispose(),this.squareAdded=void 0,pf(yf(e.prototype),"destroy",this).call(this)}},{key:"update",value:function(){if(pf(yf(e.prototype),"update",this).call(this),this.active&&this.isDown){var t={x:this.game.input.x,y:this.game.input.y};this.lastPointer=this.lastPointer||t;var n={x:t.x-this.lastPointer.x,y:t.y-this.lastPointer.y};this.lastPointer=t,this.toiletPaperContainer.y+=n.y,this.isDragging=this.isDragging||ns.magnitude(n.x,n.y)>0}else this.toiletPaperContainer.y=ns.lerp(this.toiletPaperContainer.y,this.toiletPaperAnchorPoint.y,.1);if(this.toiletPaperContainer.y=Math.ceil(100*this.toiletPaperContainer.y)/100,Math.abs(this.toiletPaperContainer.y-this.toiletPaperAnchorPoint.y)<.2&&(this.toiletPaperContainer.y=this.toiletPaperAnchorPoint.y),this.toiletPaperContainer.y>=this.toiletPaperAnchorPoint.y?this.animating=!1:this.animating=!0,this.active){var i=this.toiletPaperContainer.length*this.config.toiletPaperHeight-this.config.toiletPaperOffset.y;this.toiletPaperContainer.y>i&&(this.isDragging&&(this.toiletPaperAnchorPoint.y+=this.config.toiletPaperHeight),this.squareAdded.dispatch(this.toiletPaperContainer.length),this.toiletPaperContainer.add(this.createToiletPaperPiece()),this.toiletPaperContainer.length-1>=this.objective&&this.completeObjective())}}},{key:"createToiletPaperPiece",value:function(){var t=Ys.libraries[this.config.toiletPaper.flump.library].createClip(this.config.toiletPaper.flump.animations.idle);return t.position.set(this.config.toiletPaperOffset.x,-this.config.toiletPaperHeight*this.toiletPaperContainer.length+this.config.toiletPaperOffset.y),t}},{key:"onInputDown",value:function(){this.active&&!this.animating&&(bu.stop(),this.isDown=!0)}},{key:"onInputUp",value:function(){this.active&&(!this.isDown||this.isDragging||this.animating||(this.toiletPaperAnchorPoint.y+=this.config.toiletPaperHeight),this.isDragging=!1,this.isDown=!1,this.lastPointer=void 0,bu.start())}},{key:"setObjective",value:function(t){this.objective=t}},{key:"completeObjective",value:function(){var t=this;this.active=!1,this.isDown=!1,this.isDragging=!1,this.lastPointer=void 0,this.game.time.events.add(1e3,function(){t.objectiveMet.dispatch(t.toiletPaperContainer)})}},{key:"reset",value:function(){this.toiletPaperContainer.y=0,this.toiletPaperAnchorPoint.y=0;for(var t=this.toiletPaperContainer.length,e=0;e<t;e++)this.toiletPaperContainer.getAt(e).y=-this.config.toiletPaperHeight*e+this.config.toiletPaperOffset.y}}])&&hf(n.prototype,i),o&&hf(n,o),e}();function mf(t){return(mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function bf(t,e){return!e||"object"!==mf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wf(t){return(wf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kf(t,e){return(kf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Of=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=bf(this,wf(e).call(this,t))).config=n,i.characterConfig=n[Rc.character],i.display=Ys.libraries[i.characterConfig.flump.library].createClip(),i.addChild(i.display),i.playIdle(),i.position.set(n.position.x,n.position.y),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kf(t,e)}(e,Xs),n=e,(i=[{key:"playIdle",value:function(){this.display.onComplete.removeAll(),this.display.loop(this.characterConfig.flump.animations.idle)}},{key:"playAction",value:function(){var t=this;this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){t.playIdle()}),this.display.loop(this.characterConfig.flump.animations.action)}}])&&gf(n.prototype,i),o&&gf(n,o),e}();function Sf(t){return(Sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Cf(t,e){return!e||"object"!==Sf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _f(t){return(_f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xf(t,e){return(xf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jf=function(t){function e(t,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Cf(this,_f(e).call(this,t))).config=n,i.characterConfig=n[Rc.character],i.stages=i.characterConfig.bubbleStages,i.progress=0,i.display=Ys.libraries[i.characterConfig.flump.library].createClip(i.characterConfig.flump.animations.offScreenIdle),i.addChild(i.display),i.position.set(n.position.x,n.position.y);var o=n.hitArea||{};return i.hitArea=new Phaser.Rectangle(o.x||0,o.y||0,o.width||0,o.height||0),Rc.debugFlags.hitAreas&&(i.debug=t.make.graphics(),i.debug.beginFill(65280,.5),i.debug.drawRect(i.hitArea.x,i.hitArea.y,i.hitArea.width,i.hitArea.height),i.debug.endFill(),i.addChild(i.debug)),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xf(t,e)}(e,Xs),n=e,(i=[{key:"playEnterScreen",value:function(t){var e=this;this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){e.playIdle(!0),void 0!==t&&t()}),this.display.playOnce(this.characterConfig.flump.animations.enterScreen)}},{key:"playExitScreen",value:function(t){var e=this;this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){e.playIdle(!1),void 0!==t&&t()}),this.display.playOnce(this.characterConfig.flump.animations.exitScreen)}},{key:"playIdle",value:function(t){var e=t?this.characterConfig.flump.animations.idle:this.characterConfig.flump.animations.offScreenIdle;this.display.loop(e)}},{key:"incrementBubbleProgress",value:function(){this.progress+=.001*this.game.time.elapsedMS;var t=ns.clamp(Math.floor(this.progress),0,this.stages.length-1);return this.currentStage!==t&&(this.transitionToStage(t),!0)}},{key:"transitionToStage",value:function(t){var e=this;this.currentStage!==t&&(this.currentStage=t,this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){e.display.loop(e.stages[t].flump.animations.idle)}),this.display.playOnce(this.stages[t].flump.animations.transition))}},{key:"washAwayBubbles",value:function(t){var e=this;this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){e.playIdle(!0),void 0!==t&&t()}),this.display.playOnce(this.stages[this.currentStage].flump.animations.washAway)}}])&&Pf(n.prototype,i),o&&Pf(n,o),e}();function Ef(t){return(Ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Af(t,e){return!e||"object"!==Ef(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rf(t){return(Rf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function If(t,e){return(If=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ff=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Af(this,Rf(e).call(this,t))).config=n,i.display=Ys.libraries[n.flump.library].createClip(),i.addChild(i.display),i.position.set(n.position.x,n.position.y),i.playIdle(!1),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&If(t,e)}(e,Xs),n=e,(i=[{key:"playTurnOn",value:function(t){var e=this;this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){e.playIdle(!0),void 0!==t&&t()}),this.display.playOnce(this.config.flump.animations.on)}},{key:"playTurnOff",value:function(t){var e=this;this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){e.playIdle(!1),void 0!==t&&t()}),this.display.playOnce(this.config.flump.animations.off)}},{key:"playIdle",value:function(t){var e=t?this.config.flump.animations.onIdle:this.config.flump.animations.offIdle;this.display.loop(e)}}])&&Tf(n.prototype,i),o&&Tf(n,o),e}();function Lf(t){return(Lf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Df(t,e,n){return(Df="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Nf(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Nf(t){return(Nf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Bf(t,e,n){return e&&Kf(t.prototype,e),n&&Kf(t,n),t}function Vf(t,e){return(Vf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zf=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Lf(e)&&"function"!=typeof e?Mf(t):e}(this,Nf(e).call(this,t,n))).config=n,i.display=Ys.libraries[n.soap.flump.library].createClip(),i.addChild(i.display),i.position.set(n.position.x,n.position.y),i.events.onInputDown.add(i.onInputDown,Mf(i)),i.events.onInputUp.add(i.onInputUp,Mf(i)),i.isDown=!1,i.didBeginDragging=!1,i.dragOffset=void 0,i.delta={x:0,y:0},i.lastPoint=void 0,i.draggingStarted=new Phaser.Signal,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vf(t,e)}(e,tl),Bf(e,[{key:"states",get:function(){return{soap:"soap",towel:"towel"}}}]),Bf(e,[{key:"destroy",value:function(){this.draggingStarted.dispose(),this.draggingStarted=void 0,Df(Nf(e.prototype),"destroy",this).call(this)}},{key:"update",value:function(){if(this.active&&this.isDown){var t=this.keepInSafeArea(this.game.input.x-this.dragOffset.x,this.game.input.y-this.dragOffset.y);this.position.set(t.x,t.y);var e={x:this.game.input.x,y:this.game.input.y};void 0===this.lastPoint&&(this.lastPoint=e),this.delta.x=this.lastPoint.x-e.x,this.delta.y=this.lastPoint.y-e.y,this.lastPoint=e,this.didBeginDragging||0===this.delta.x&&0===this.delta.y||(this.didBeginDragging=!0,this.draggingStarted.dispatch())}}},{key:"enterState",value:function(t,e){var n=this;this.scale.set(0),this.position.set(this.config.position.x,this.config.position.y),this.state=t,this.isDown=!1,this.delta={x:0,y:0};var i=this.config[t];this.display.loop(i.flump.animations.idle);var o=this.game.add.tween(this.scale).to({x:1,y:1},250,Phaser.Easing.Back.Out);o.onComplete.addOnce(function(){n.isDown=!1,void 0!==e&&e()}),o.start()}},{key:"exitState",value:function(t){this.scale.set(1);var e=this.game.add.tween(this.scale).to({x:0,y:0},250,Phaser.Easing.Back.In);e.onComplete.addOnce(function(){void 0!==t&&t()}),e.start()}},{key:"onInputUp",value:function(){Rc.isMobile&&(this.isDown=!1,this.delta={x:0,y:0})}},{key:"onInputDown",value:function(){this.active&&(this.dragOffset={x:this.game.input.x-this.x,y:this.game.input.y-this.y},this.isDown=!0,this.didBeginDragging=!1)}},{key:"keepInSafeArea",value:function(t,e){var n=t+this.hitArea.x,i=n+this.hitArea.width,o=e+this.hitArea.y,r=o+this.hitArea.height;return n<nu.safeArea.left&&(t=nu.safeArea.left+this.hitArea.width/2),i>nu.safeArea.right&&(t=nu.safeArea.right-this.hitArea.width/2),o<nu.safeArea.top&&(e=nu.safeArea.top+this.hitArea.height/2),r>nu.safeArea.bottom&&(e=nu.safeArea.bottom-this.hitArea.height/2),{x:t,y:e}}}]),e}();function Uf(t){return(Uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Wf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qf(t,e,n){return(qf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xf(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Xf(t){return(Xf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yf(t,e){return(Yf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jf=function(t){function e(t,n){var i;return Gf(this,e),(i=function(t,e){return!e||"object"!==Uf(e)&&"function"!=typeof e?Wf(t):e}(this,Xf(e).call(this,t,n))).back=Ys.libraries[n.flump.library].createClip(n.flump.animations[n.back]),i.addChild(i.back),i.display=Ys.libraries[n.flump.library].createClip(n.flump.animations[n.sticker]),i.addChild(i.display),i.display.visible=!1,i.active=!1,i.position.set(n.position.x,n.position.y),i.events.onInputDown.add(i.onDown,Wf(i)),i.complete=new Phaser.Signal,i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yf(t,e)}(e,tl),n=e,(i=[{key:"destroy",value:function(){this.complete.dispose(),this.complete=void 0,qf(Xf(e.prototype),"destroy",this).call(this)}},{key:"playComplete",value:function(){var t=this;new Qf(this).actionComplete.addOnce(function(){return t.complete.dispatch()})}},{key:"setComplete",value:function(){this.display.visible=!0}},{key:"onDown",value:function(){}}])&&Hf(n.prototype,i),o&&Hf(n,o),e}(),Qf=function t(e){var n=this;Gf(this,t);var i=!1,o=!1,r=function(){i&&o&&(n.actionComplete.dispatch(),n.actionComplete.dispose())};this.actionComplete=new Phaser.Signal,e.display.visible=!0,e.display.scale.set(0);var a=e.game.add.tween(e.display.scale).to({x:1,y:1},250,Phaser.Easing.Back.Out);a.onComplete.addOnce(function(){o=!0,r()}),a.start(),Mc.play(e.config.audioKeys.complete,function(){i=!0,r()})};function $f(t){return($f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zf(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ep(t,e){return!e||"object"!==$f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function np(t,e,n){return(np="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ip(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ip(t){return(ip=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function op(t,e){return(op=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rp=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=ep(this,ip(e).call(this,t))).config=n,i.display=Ys.libraries[n.flump.library].createClip(),i.addChild(i.display),i.heading=Ys.libraries[n.flump.library].createClip(n.flump.animations.heading[Rc.character]),i.addChild(i.heading),i.heading.position.set(n.heading.position.x,n.heading.position.y),i.display.loop(n.flump.animations.idle),i.position.set(n.position.x,n.position.y),i.interactives=[],i.initializeStepColumns(),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&op(t,e)}(e,Xs),n=e,(i=[{key:"destroy",value:function(){this.steps=void 0,np(ip(e.prototype),"destroy",this).call(this)}},{key:"playRowCompletion",value:function(t,e){var n=this;if(t<0||t>=this.steps[0].length)throw new Error("Invalid chart row: "+t);!function i(o){if(o>=n.steps.length)void 0!==e&&e();else{var r=n.steps[o][t];r.complete.addOnce(function(){n.game.time.events.add(250,function(){i(o+1)})}),r.playComplete()}}(0)}},{key:"enableInteractives",value:function(){for(var t=0;t<this.interactives.length;t++)this.interactives[t].active=!0}},{key:"initializeStepColumns",value:function(){var t=this;this.steps=Array(this.config.steps.length).fill([]).map(function(e,n){var i=t.config.steps[n],o=t.game.make.group();o.position.set(i.position.x,i.position.y),t.addChild(o);var r=new tl(t.game,i);return r.events.onInputDown.add(function(){r.active&&Mc.play(i.audioKeys.action)}),r.active=!1,o.add(r),t.interactives.push(r),i.sockets.map(function(e,n){var i=new Jf(t.game,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){Zf(t,e,n[e])})}return t}({},e,t.config.socket));return o.add(i),n<Rc.currentChartRow&&i.setComplete(),i})})}}])&&tp(n.prototype,i),o&&tp(n,o),e}();function ap(t){return(ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function cp(t,e){return!e||"object"!==ap(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function up(t){return(up=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lp(t,e){return(lp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hp=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=cp(this,up(e).call(this,t,n.unselected))).masterConfig=n,i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lp(t,e)}(e,cl),n=e,(i=[{key:"initializeDisplay",value:function(){this.display=Ys.libraries[this.config.flump.library].createClip(),this.display.loop(this.config.flump.animations.up),this.addChild(this.display)}},{key:"select",value:function(){this.config=this.masterConfig.selected,this.display.loop(this.config.flump.animations.up)}},{key:"deselect",value:function(){this.config=this.masterConfig.unselected,this.display.loop(this.config.flump.animations.up)}}])&&sp(n.prototype,i),o&&sp(n,o),e}();function fp(t){return(fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yp(t,e){return!e||"object"!==fp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dp(t,e,n){return(dp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vp(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function vp(t){return(vp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function gp(t,e,n){return e&&mp(t.prototype,e),n&&mp(t,n),t}function bp(t,e){return(bp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wp=function(t){function e(t,n){var i;pp(this,e),(i=yp(this,vp(e).call(this,t))).config=n,i.content=t.make.group(),i.addChild(i.content),i.content.mask=t.make.graphics(),i.content.mask.beginFill(0),i.content.mask.drawRect(n.mask.x,n.mask.y,n.mask.width,n.mask.height),i.content.mask.endFill(),i.addChild(i.content.mask);var o=Object.keys(n.buttons);return i.buttons=o.map(function(e){var o=zy.create(t,n.buttons[e]);return i.addChild(o),o.clicked.add(function(){return i.onCarouselButtonClicked(e)}),o}),i.itemPool={default:[],songScrolling:[]},i.dots=[],i.focused=0,i.focusedItem=i.createItem(i.focused),i.scroller=new kp,i.initializePageDots(),i.content.add(i.focusedItem),i.position.set(n.position.x,n.position.y),i.buttonClicked=new Phaser.Signal,i.itemsScrolled=new Phaser.Signal,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bp(t,e)}(e,Xs),gp(e,[{key:"buttonNames",get:function(){return{previous:"previous",next:"next"}}}]),gp(e,[{key:"destroy",value:function(){var t=this;this.scroller.destroy(),this.scroller=void 0,this.buttonClicked.dispose(),this.buttonClicked=void 0,this.itemsScrolled.dispose(),this.itemsScrolled=void 0,Object.keys(this.itemPool).forEach(function(e){t.itemPool[e].forEach(function(t){return t.destroy()})}),this.itemPool=void 0,this.focusedItem=void 0,this.buttons=void 0,dp(vp(e.prototype),"destroy",this).call(this)}},{key:"toggleInput",value:function(t){this.buttons.forEach(function(e){return e.active=t}),this.dots.forEach(function(e){return e.active=t}),this.dots[this.focused].active=!1}},{key:"onCarouselButtonClicked",value:function(t){t===this.buttonNames.previous?this.scrollItems(-1):t===this.buttonNames.next&&this.scrollItems(1)}},{key:"scrollItems",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.itemsScrolled.dispatch(),this.toggleInput(!1);var i=this.focused,o=this.focusedItem;this.dots[this.focused].deselect(),this.focused=ns.mod(this.focused+n*t,this.config.items.length),this.dots[this.focused].select(),this.focusedItem=this.createItem(this.focused),this.focusedItem.position.set(500*t,0),this.focusedItem.alpha=0,this.content.add(this.focusedItem),this.scroller.scroll({animator:o.animator,to:{x:500*-t,alpha:0},time:250,ease:Phaser.Easing.Quadratic.Out},{animator:this.focusedItem.animator,to:{x:0,alpha:1},time:250,ease:Phaser.Easing.Quadratic.Out}),this.scroller.complete.addOnce(function(){e.itemPool[e.config.items[i].class||"default"].push(o),e.content.remove(o),o.cleanUp(),e.toggleInput(!0)})}},{key:"createItem",value:function(t){var e=this.config.items[t],n=this.itemPool[e.class||"default"];return n.length>0?n.shift().draw(this.config.items[t]):Hy.create(this.game,this.config.items[t]).draw(this.config.items[t])}},{key:"initializePageDots",value:function(){for(var t=this.config.items.length/2,e=0;e<this.config.items.length;e++){var n=new hp(this.game,this.config.pageDot);this.addChild(n),n.clicked.add(this.onDotUp,this);var i=this.config.pageDot.position.x+(e-t)*this.config.pageDot.spacing+.5*this.config.pageDot.spacing,o=this.config.pageDot.position.y;e===this.focused&&n.select(),n.position.set(i,o),this.dots.push(n)}}},{key:"onDotUp",value:function(t){var e=this.dots.indexOf(t);if(e!=this.focused){var n=e-this.focused;this.scrollItems(ns.sign(n),Math.abs(n))}}}]),e}(),kp=function(){function t(){pp(this,t),this.complete=new Phaser.Signal,this.itemsComplete=0}return gp(t,[{key:"destroy",value:function(){this.complete.dispose(),this.complete=void 0}},{key:"scroll",value:function(t,e){this.itemsComplete=0,t.animator.onComplete.removeAll(),e.animator.onComplete.removeAll(),t.animator.timeline=[],e.animator.timeline=[],t.animator.to(t.to,t.time,t.ease,!0),t.animator.onComplete.addOnce(this.checkComplete,this),e.animator.to(e.to,e.time,e.ease,!0),e.animator.onComplete.addOnce(this.checkComplete,this)}},{key:"checkComplete",value:function(){this.itemsComplete++,2===this.itemsComplete&&this.complete.dispatch()}}]),t}();function Op(t){return(Op="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Pp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Cp(t,e,n){return(Cp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_p(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _p(t){return(_p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xp(t,e){return(xp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jp=function(t){function e(t,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,e){return!e||"object"!==Op(e)&&"function"!=typeof e?Pp(t):e}(this,_p(e).call(this,t))).config=n,o.addChild(Gy.create(t,n.heading));var r=Object.keys(n.buttons);o.buttons={};for(var a=Rc.isInApp,s=function(e){var s=r[e];if(!i.getElse([n.buttons[s],"allowInApp"],!0)&&a)return"continue";var c=zy.create(t,i.getElse([n.buttons[s],"key"],n.buttons[s]));c.clicked.add(function(){return o.screenButtonClicked.dispatch(o.screenName,s)}),o.addChild(c),o.buttons[s]=c},c=0;c<r.length;c++)s(c);var u=(r=Object.keys(o.buttons)).length/2;for(c=0;c<r.length;c++){var l=r[c],h=n.buttons[l].position.x+(c-u)*n.buttonSpacing+.5*n.buttonSpacing,f=n.buttons[l].position.y;o.buttons[l].position.set(h,f)}return o.closeButton=zy.create(t,n.closeButton.key),o.closeButton.position.set(n.closeButton.position.x,n.closeButton.position.y),o.closeButton.clicked.add(function(){return o.screenButtonClicked.dispatch(o.screenName,"close")}),o.addChild(o.closeButton),o.carousel=new wp(t,n.carousel),o.addChild(o.carousel),o.carousel.itemsScrolled.add(o.onItemsScrolled,Pp(o)),o.screenButtonClicked=new Phaser.Signal,o.downloadSongLyrics=new Phaser.Signal,o}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xp(t,e)}(e,Xs),n=e,(o=[{key:"destroy",value:function(){this.screenButtonClicked.dispose(),this.screenButtonClicked=void 0,this.closeButton=void 0,this.buttons=void 0,Cp(_p(e.prototype),"destroy",this).call(this)}},{key:"onItemsScrolled",value:function(){Mc.stopVO(),Mc.stopMusic(),Mc.restoreFromDuck(Mc.channels.VO)}},{key:"toggleScreenInput",value:function(t){var e=this;Object.keys(this.buttons).forEach(function(n){return e.buttons[n].active=t}),this.carousel.toggleInput(t),this.closeButton.active=t}}])&&Sp(n.prototype,o),r&&Sp(n,r),e}();function Ep(t){return(Ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ap(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rp(t,e,n){return(Rp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ip(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ip(t){return(Ip=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fp(t,e){return(Fp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lp=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Ep(e)&&"function"!=typeof e?Ap(t):e}(this,Ip(e).call(this,t,n))).active=!1,i.actionBegin=new Phaser.Signal,i.actionEnd=new Phaser.Signal,i.display=t.make.image(0,0,Ys.libraries[n.flump.library].getTexture(n.flump.textureKey)),i.display.anchor.set(.5,.9471),i.addChild(i.display),i.water=Ys.libraries[n.water.flump.library].createClip(),i.addChild(i.water),i.water.loop(n.water.flump.animations.idle),i.seat=Ys.libraries[n.flump.library].createClip(),i.addChild(i.seat),i.setColor("white"),i.setSeat(0),i.setScale(1),i.position.set(n.position.x,n.position.y),i.events.onInputUp.add(i.onInputUp,Ap(i)),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fp(t,e)}(e,tl),n=e,(i=[{key:"destroy",value:function(){this.actionBegin.dispose(),this.actionBegin=void 0,this.actionEnd.dispose(),this.actionEnd=void 0,Rp(Ip(e.prototype),"destroy",this).call(this)}},{key:"playFlush",value:function(){var t=this;this.water.onComplete.removeAll(),this.water.onComplete.addOnce(function(){t.water.loop(t.config.water.flump.animations.idle),t.actionEnd.dispatch()}),this.water.playOnce(this.config.water.flump.animations.action),this.actionBegin.dispatch()}},{key:"playIdleFlush",value:function(){this.water.onComplete.removeAll(),this.water.loop(this.config.water.flump.animations.idle2)}},{key:"setCustomPotty",value:function(){this.setColor(Rc.potty.color),this.setSeat(Rc.potty.seat)}},{key:"setColor",value:function(t){this.display.tint=Rc.pottyColors[t]}},{key:"setSeat",value:function(t){this.seat.onComplete.removeAll(),this.seat.loop(Rc.pottySeats[t])}},{key:"setScale",value:function(t){this.scale.set(t)}},{key:"onInputUp",value:function(){this.active&&this.playFlush()}}])&&Tp(n.prototype,i),o&&Tp(n,o),e}();function Mp(t){return(Mp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Np(t,e){return!e||"object"!==Mp(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kp(t,e,n){return(Kp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Bp(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Bp(t){return(Bp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vp(t,e){return(Vp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zp=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=Np(this,Bp(e).call(this,t,n))).isToggled=!1,i.radioOff=new Phaser.Signal,i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vp(t,e)}(e,ih),n=e,(i=[{key:"destroy",value:function(){this.radioOff.dispose(),this.radioOff=void 0,Kp(Bp(e.prototype),"destroy",this).call(this)}},{key:"playIdle",value:function(){this.display.onComplete.removeAll();var t=this.isToggled?this.config.flump.animations.action:this.config.flump.animations.idle;this.display.loop(t)}},{key:"playAction",value:function(){var t=this;this.actionBegin.dispatch(this),this.actionEnd.dispatch(this),void 0!==this.config.audioKeys&&Mc.play(this.config.audioKeys.action),this.isToggled?(Mc.stopTrack(this.config.audioKeys.song),this.radioOff.dispatch()):(Mc.stopMusic(),Mc.play(this.config.audioKeys.song,function(){t.radioOff.dispatch(),t.isToggled=!1,t.playIdle()})),this.isToggled=!this.isToggled,this.playIdle()}}])&&Dp(n.prototype,i),o&&Dp(n,o),e}();function Up(t){return(Up="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Hp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wp(t,e,n){return(Wp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qp(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function qp(t){return(qp=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xp(t,e){return(Xp=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yp=function(t){function e(t,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=function(t,e){return!e||"object"!==Up(e)&&"function"!=typeof e?Hp(t):e}(this,qp(e).call(this,t,n))).chart=new Ty.Chart(t,n.pottyChart),i.content.add(i.chart),i.chart.position.set(0,0),i.chart.enableInteractives(),i.chart.inputEnabled=!0,i.btnClose=zy.create(i.game,"btnModalClose"),i.content.add(i.btnClose),i.btnClose.position.set(n.close.position.x,n.close.position.y),i.btnClose.clicked.add(i.close,Hp(i)),i.toggleInput(!1),i}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xp(t,e)}(e,El),n=e,(i=[{key:"showContent",value:function(){var t=this;this.content.visible=!0,this.content.position.set(this.content.x,-this.game.height/2);var e=this.game.add.tween(this.content).to({y:this.game.height/2},500,Phaser.Easing.Back.Out);e.onComplete.add(function(){t.toggleInput(!0),t.opened.dispatch()}),e.start()}},{key:"hideContent",value:function(t){this.content.visible=!0,this.content.position.set(this.content.x,this.game.height/2);var e=this.game.add.tween(this.content).to({y:-this.game.height/2},500,Phaser.Easing.Back.In);e.onComplete.add(function(){void 0!==t&&t()}),e.start()}},{key:"toggleInput",value:function(t){this.btnClose.active=t,Wp(qp(e.prototype),"toggleInput",this).call(this,t)}},{key:"close",value:function(){Mc.stopVO(),Wp(qp(e.prototype),"close",this).call(this)}}])&&Gp(n.prototype,i),o&&Gp(n,o),e}();function Jp(t){return(Jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function $p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zp(t,e,n){return(Zp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ty(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ty(t){return(ty=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ey(t,e){return(ey=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ny=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==Jp(e)&&"function"!=typeof e?$p(t):e}(this,ty(e).call(this,t))).animator=t.add.tween($p(n)),n}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ey(t,e)}(e,Phaser.Group),n=e,(i=[{key:"destroy",value:function(){this.game.tweens.remove(this.animator),this.animator=void 0,Zp(ty(e.prototype),"destroy",this).call(this)}},{key:"draw",value:function(t){this.key=t.key,this.header=this.header||Gy.create(this.game,t.header),this.add(this.header),this.body&&this.body.destroy(),this.body=Gy.create(this.game,t.body),this.add(this.body);var e=Rc[t.type][t.key];return this.header.anchor.set(.5,1),this.body.anchor.set(.5,0),this.header.text=e.header,this.body.text=e.body,this}},{key:"cleanUp",value:function(){}}])&&Qp(n.prototype,i),o&&Qp(n,o),e}();function iy(t){return(iy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oy(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ry(t,e){return!e||"object"!==iy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ay(t,e,n){return(ay="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sy(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function sy(t){return(sy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function cy(t,e){return(cy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var uy=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ry(this,sy(e).call(this,t))).scrollingTween=void 0,n}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&cy(t,e)}(e,ny),n=e,(i=[{key:"draw",value:function(t){return ay(sy(e.prototype),"draw",this).call(this,t),this.type=t.type,this.scroll=t.scroll,this.bodyOrigin=t.body.position,"songs"===this.type&&(Mc.channelPlayed.add(this.onAudioPlayed,this),Mc.channelStopped.add(this.onAudioStopped,this)),this.body.mask=this.body.mask||this.game.make.graphics(),this.body.mask.clear(),this.body.mask.beginFill(0,1),this.body.mask.drawRect(t.mask.x,t.mask.y,t.mask.width,t.mask.height),this.body.mask.endFill(),this.addChild(this.body.mask),this}},{key:"destroy",value:function(){"songs"===this.type&&(Mc.channelPlayed.remove(this.onAudioPlayed,this),Mc.channelStopped.remove(this.onAudioStopped,this)),ay(sy(e.prototype),"destroy",this).call(this)}},{key:"cleanUp",value:function(){ay(sy(e.prototype),"cleanUp",this).call(this),"songs"===this.type&&(Mc.channelPlayed.remove(this.onAudioPlayed,this),Mc.channelStopped.remove(this.onAudioStopped,this)),this.killScrollingTween(),this.removeChild(this.body.mask)}},{key:"onAudioPlayed",value:function(t,e){Rc.songs[this.key].audioKey===e&&this.beginScrolling(t,e)}},{key:"onAudioStopped",value:function(t,e){Rc.songs[this.key].audioKey===e&&(this.killScrollingTween(),this.body.position.set(this.bodyOrigin.x,this.bodyOrigin.y))}},{key:"beginScrolling",value:function(t,e){var n=this;this.killScrollingTween(),this.game.time.events.add(30,function(){var i=n.body.x+n.scroll.x,o=n.body.y+n.scroll.y,r=750*(Mc[t][e][0].duration-n.scroll.startDelay);n.scrollingTween=n.game.add.tween(n.body).to({x:i,y:o},r,"Linear",!0,1e3*n.scroll.startDelay)})}},{key:"killScrollingTween",value:function(){void 0!==this.scrollingTween&&(this.game.tweens.remove(this.scrollingTween),this.scrollingTween=void 0)}}])&&oy(n.prototype,i),o&&oy(n,o),e}();function ly(t){return(ly="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hy(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function fy(t,e){return!e||"object"!==ly(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function py(t){return(py=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yy(t,e){return(yy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dy=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),fy(this,py(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yy(t,e)}(e,ih),n=e,(i=[{key:"playAction",value:function(){var t=this;this.setRollOver(0),this.active=!1,this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){t.actionEnd.dispatch(t)}),this.display.playOnce(this.config.flump.animations.action),this.actionBegin.dispatch(this),void 0!==this.config.audioKeys&&audio.play(this.config.audioKeys.action)}}])&&hy(n.prototype,i),o&&hy(n,o),e}();function vy(t){return(vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function my(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function gy(t,e){return!e||"object"!==vy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function by(t,e,n){return(by="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wy(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function wy(t){return(wy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ky(t,e){return(ky=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Oy={Interactive:tl,Button:cl,ContentButton:dl,TextButton:Ol,Modal:El,TimeoutAnimation:qu,Clickable:ih,CycleClickable:function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),gy(this,wy(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ky(t,e)}(e,ih),n=e,(i=[{key:"initializeDisplay",value:function(){this.current=0,by(wy(e.prototype),"initializeDisplay",this).call(this)}},{key:"playIdle",value:function(){this.display.onComplete.removeAll(),this.display.loop(this.config.flump.animations[this.current].idle)}},{key:"playAction",value:function(){var t=this;this.setRollOver(0),this.active=!1,this.display.onComplete.removeAll(),this.display.onComplete.addOnce(function(){t.active=!0,t.current=ns.mod(t.current+1,t.config.flump.animations.length),t.playIdle(),t.actionEnd.dispatch(t)}),this.display.playOnce(this.config.flump.animations[this.current].action),this.actionBegin.dispatch(this),void 0!==this.config.audioKeys&&Mc.play(this.config.audioKeys.action)}}])&&my(n.prototype,i),o&&my(n,o),e}(),PottyMeter:Xh,Potty:Lp},Sy={Character:Ll,Option:Vl},Py={BabyGate:Jl,PottyChart:Yp,Character:hh,Radio:zp,Door:dy},Cy={Character:bh,Layout:Rh,Door:Nh,Input:Vh},_y={Character:ef},xy={Character:uf,ToiletPaperRoll:vf},jy={Character:Of},Ey={Character:jf,Faucet:Ff,Draggable:zf},Ty={Chart:rp},Ay={Screen:jp,CarouselItem:ny,SongScrollingItem:uy};function Ry(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Iy(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Fy(t,e,n){return e&&Iy(t.prototype,e),n&&Iy(t,n),t}var Ly={default:Oy.Button,text:Oy.TextButton},My={default:Oy.Clickable,cycle:Oy.CycleClickable,playroomElmo:Py.Character,playroomAbby:Py.Character,radio:Py.Radio,playroomDoor:Py.Door},Dy={default:Ay.CarouselItem,songScrolling:Ay.SongScrollingItem},Ny=function(){function t(){Ry(this,t)}return Fy(t,[{key:"create",value:function(t,e){var n;if(void 0===(n="string"==typeof e?Rc.buttonMap[e]:e))throw Error("Cannot find button config in main/config.json for '".concat(e,"'"));return new(0,Ly[n.type||"default"])(t,n)}}]),t}(),Ky=function(){function t(){Ry(this,t)}return Fy(t,[{key:"create",value:function(t,e){return new(0,My[e.type||"default"])(t,e)}}]),t}(),By=function(){function t(){Ry(this,t)}return Fy(t,[{key:"create",value:function(t,e){var n=e.position||{x:0,y:0},i=t.make.bitmapText(n.x,n.y,e.font,e.str||"",e.size);return i.anchor.set(.5),i.align="center",void 0!==e.tint&&(i.tint=e.tint),void 0!==e.maxWidth&&(i.maxWidth=e.maxWidth),i}}]),t}(),Vy=function(){function t(){Ry(this,t)}return Fy(t,[{key:"create",value:function(t,e){return new(0,Dy[e.class||"default"])(t)}}]),t}(),zy=new Ny,Uy=new Ky,Gy=new By,Hy=new Vy;function Wy(t){return(Wy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qy(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xy(t,e){return!e||"object"!==Wy(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yy(t){return(Yy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jy(t,e){return(Jy=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Qy=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Xy(this,Yy(e).apply(this,arguments))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jy(t,e)}(e,Phaser.State),n=e,(o=[{key:"init",value:function(){nu.input.setCursorState(nu.input.cursorIdle),Rc.currentScene=this.currentScene}},{key:"create",value:function(){void 0!==this.configKey&&(this.config=this.cache.getJSON(this.configKey),void 0!==this.config.background&&this.add.image(0,0,this.config.background)),this.addFlumpLibraries(),this.startTime=Date.now(),void 0!==this.config?(bu.setTimeoutLength(this.config.timeoutLength||10),bu.setTimeoutClearLength(this.config.timeoutClearLength||5)):(bu.setTimeoutLength(10),bu.setTimeoutClearLength(5)),bu.timeoutBegin.add(this.onTimeoutBegin,this),bu.timeoutEnd.add(this.onTimeoutEnd,this),Mc.play(i.get([this.config,"audioKeys","music"]))}},{key:"shutdown",value:function(){Mc.clearChannels(),nu.input.setCursorState(nu.input.cursorIdle),bu.timeoutBegin.remove(this.onTimeoutBegin,this),bu.timeoutEnd.remove(this.onTimeoutEnd,this),this.removeFlumpLibraries()}},{key:"onTimeoutBegin",value:function(){}},{key:"onTimeoutEnd",value:function(){}},{key:"enterScene",value:function(){var t=this;yu.transitionIn(function(){return t.startScene()})}},{key:"startScene",value:function(){}},{key:"stopScene",value:function(){var t=this;yu.transitionOut(function(){return t.exitScene()})}},{key:"exitScene",value:function(){}},{key:"addFlumpLibraries",value:function(){var t=this;if(void 0!==this.configKey&&void 0!==this.config.flumpLibraries&&this.config.flumpLibraries.forEach(function(e){return Ys.addLibrary(t.game,e.key,e.root)}),Rc.pottyLessonScenes.indexOf(this.state.current)>=0){var e=Rc[Rc.character].flumpLibrary;void 0===Ys.libraries[e.key]&&Ys.addLibrary(this.game,e.key,e.root)}else"customization"!==this.state.current&&"playroom"!==this.state.current||(void 0===Ys.libraries[Rc.elmo.flumpLibrary.key]&&Ys.addLibrary(this.game,Rc.elmo.flumpLibrary.key,Rc.elmo.flumpLibrary.root),void 0===Ys.libraries[Rc.abby.flumpLibrary.key]&&Ys.addLibrary(this.game,Rc.abby.flumpLibrary.key,Rc.abby.flumpLibrary.root))}},{key:"removeFlumpLibraries",value:function(){void 0!==this.configKey&&void 0!==this.config.flumpLibraries&&this.config.flumpLibraries.forEach(function(t){return Ys.removeLibrary(t.key)}),"playroom"===this.state.current&&("parentMenu"===this.nextScene?(Ys.removeLibrary(Rc.abby.flumpLibrary.key),Ys.removeLibrary(Rc.elmo.flumpLibrary.key)):Rc.character===Rc.characterOptions.elmo?Ys.removeLibrary(Rc.abby.flumpLibrary.key):Rc.character===Rc.characterOptions.abby&&Ys.removeLibrary(Rc.elmo.flumpLibrary.key))}}])&&qy(n.prototype,o),r&&qy(n,r),e}();function $y(t){return($y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zy(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function td(t,e){return!e||"object"!==$y(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ed(t,e,n){return(ed="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=nd(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function nd(t){return(nd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function id(t,e){return(id=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var od=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),td(this,nd(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&id(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){ed(nd(e.prototype),"init",this).call(this),this.configKey="titleConfig",Rc.screenName="Title Screen"}},{key:"create",value:function(){ed(nd(e.prototype),"create",this).call(this),this.btnStart=zy.create(this.game,"btnStart"),this.world.add(this.btnStart),this.btnStart.active=!1,this.btnStart.clicked.addOnce(this.onBtnClicked,this),this.enterScene()}},{key:"update",value:function(){nu.input.setCursorState(nu.input.cursorOver)}},{key:"shutdown",value:function(){nu.input.events.onInputUp.remove(this.onBtnClicked,this),this.btnStart=void 0,ed(nd(e.prototype),"shutdown",this).call(this)}},{key:"startScene",value:function(){var t=this;Mc.play(this.config.audioKeys.title,function(){t.btnStart.beginTimeout(),Mc.play(t.config.audioKeys.timeout,function(){t.game.time.events.add(3e3,function(){void 0!==t.btnStart&&t.btnStart.endTimeout()}),bu.start()})}),nu.input.events.onInputUp.addOnce(this.onScreenClicked,this),this.btnStart.active=!0}},{key:"stopScene",value:function(){Mc.stopVO(),nu.input.events.onInputUp.remove(this.onScreenClicked,this),this.btnStart.clicked.remove(this.onBtnClicked,this),this.btnStart.active=!1,bu.stop(),ed(nd(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,"intro",["intro"],[this.state.current])}},{key:"onTimeoutBegin",value:function(){this.btnStart.beginTimeout()}},{key:"onTimeoutEnd",value:function(){this.btnStart.endTimeout()}},{key:"onScreenClicked",value:function(){vu(Rc,{event:Js,buttonName:"NotPlayButton"}),this.stopScene()}},{key:"onBtnClicked",value:function(){vu(Rc,{event:Js,buttonName:"PlayButton"}),this.stopScene()}}])&&Zy(n.prototype,i),o&&Zy(n,o),e}();function rd(t){return(rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ad(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function sd(t,e){return!e||"object"!==rd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cd(t,e,n){return(cd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ud(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ud(t){return(ud=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ld(t,e){return(ld=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hd=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),sd(this,ud(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ld(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){cd(ud(e.prototype),"init",this).call(this),this.configKey="introConfig",Rc.screenName="Intro Screen"}},{key:"create",value:function(){var t=this;cd(ud(e.prototype),"create",this).call(this),this.characters=Ys.libraries[this.config.initialState.flump.library].createClip(this.config.initialState.flump.animations.idle),this.world.add(this.characters),this.characters.position.set(this.game.width/2,this.game.height/2),this.btnSkip=zy.create(this.game,"btnSkip"),this.world.add(this.btnSkip),this.btnSkip.active=!1,this.btnSkip.clicked.addOnce(this.onBtnClicked,this),this.btnSkip.events.onInputOver.add(function(){t.btnSkip.beginTimeout()},this),this.btnSkip.events.onInputOut.add(function(){t.btnSkip.endTimeout()},this),this.startTime=Date.now(),this.current=0,this.game.time.events.add(1e3,function(){t.enterScene()}),this.btnSkip.allowHighlight=Rc.isDesktop}},{key:"shutdown",value:function(){this.characters=void 0,cd(ud(e.prototype),"shutdown",this).call(this)}},{key:"startScene",value:function(){this.playNext(),this.btnSkip.active=!0}},{key:"stopScene",value:function(){Mc.stopChannel(Mc.channels.VO),this.btnSkip.active=!1,cd(ud(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,"customization",["customization"],[this.state.current])}},{key:"playNext",value:function(){var t=this;this.current<this.config.cutscene.length?(Mc.play(this.config.cutscene[this.current].audioKey,function(){return t.playNext()}),this.characters.playOnce(this.config.cutscene[this.current].flump.animations.idle),this.current++):this.stopScene()}},{key:"onBtnClicked",value:function(){this.btnSkip.active=!1,vu(Rc,{event:nc,duration:(Date.now()-this.startTime)/1e3}),this.stopScene()}}])&&ad(n.prototype,i),o&&ad(n,o),e}();function fd(t){return(fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function yd(t,e){return!e||"object"!==fd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dd(t,e,n){return(dd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vd(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function vd(t){return(vd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function md(t,e){return(md=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gd=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yd(this,vd(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&md(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){dd(vd(e.prototype),"init",this).call(this),this.configKey="customizationConfig",Rc.startRound(),Rc.playroomState=void 0,Rc.currentAccident=0}},{key:"create",value:function(){var t=this;dd(vd(e.prototype),"create",this).call(this),this.btnNext=zy.create(this.game,"btnNext"),this.world.add(this.btnNext),this.initializeCharacterSelection(),this.selected=void 0,this.current=this.states.character,this.pottyButtonClicks=0,this.timeoutAudioKeys=this.config.audioKeys[this.current].timeout.slice(),this.game.time.events.add(1e3,function(){t.enterScene()})}},{key:"shutdown",value:function(){this.selected=void 0,this.characters=void 0,this.btnNext=void 0,this.pottyOptions=void 0,dd(vd(e.prototype),"shutdown",this).call(this)}},{key:"startScene",value:function(){var t=this;for(var e in vu(Rc,{event:ac,roundNumber:Rc.playthroughCount}),Rc.firstVisit.customization||vu(Rc,{event:ic}),Rc.firstVisit.customization=!1,Mc.play(this.config.audioKeys.character.intro,function(){t.characters.abby.beginTimeout(),Mc.play(t.config.audioKeys.character.introAbby,function(){t.characters.abby.endTimeout(),t.characters.elmo.beginTimeout(),Mc.play(t.config.audioKeys.character.introElmo,function(){return t.characters.elmo.endTimeout()})})}),this.characters)this.characters[e].active=!0;bu.start()}},{key:"stopScene",value:function(){this.btnNext.active=!1,bu.stop(),dd(vd(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,"playroom",["playroom"],[this.state.current])}},{key:"onTimeoutBegin",value:function(){0===this.timeoutAudioKeys.length&&(this.timeoutAudioKeys=this.config.audioKeys[this.current].timeout.slice());var t=this.timeoutAudioKeys.shift();if(this.pottyButtonClicks>=this.config.maxPottyButtonClicks&&"PP_2.0_17"===t)this.onTimeoutBegin();else{if("PP_2.0_18"===t){if(!this.btnNext.visible){for(var e in this.timeoutAudioKeys.push(t),Mc.play("PP_2.0_11"),this.characters)this.selected!==this.characters[e]&&this.characters[e].beginTimeout();return}this.btnNext.beginTimeout()}else if("PP_2.0_11"===t)for(var n in this.characters)this.selected!==this.characters[n]&&this.characters[n].beginTimeout();else if("PP_2.0_17"===t)for(var i in this.pottyOptions)this.pottyOptions[i].beginTimeout();Mc.play(t)}}},{key:"onTimeoutEnd",value:function(){for(var t in this.btnNext.endTimeout(),this.characters)this.characters[t].endTimeout();for(var e in this.pottyOptions)this.pottyOptions[e].endTimeout()}},{key:"onCharacterSelectionConfirmed",value:function(){var t=this;for(var e in bu.stop(),Rc.character=this.selected.config.type,vu(Rc,{event:ec,characterName:Rc.playroomObjectMap[Rc.character]}),this.btnNext.active=!1,this.characters)this.characters[e].active=!1;Mc.play("sparkleFanfare",function(){yu.transitionOut(function(){t.uninitializeCharacterSelection(),t.initializePottyCustomization(),yu.transitionIn(function(){for(var e in t.btnNext.active=!0,t.pottyOptions)t.pottyOptions[e].active=!0;if(Rc.firstVisit.customizePotty){for(var n in t.pottyOptions)t.pottyOptions[n].beginTimeout();Mc.play(t.config.audioKeys.potty.intro,function(){for(var e in t.pottyOptions)t.pottyOptions[e].endTimeout();t.btnNext.beginTimeout(),Mc.play(t.config.audioKeys.potty.nextBtnIntro,function(){t.btnNext.endTimeout(),bu.start()})})}else Mc.play(t.config.audioKeys.potty.returnIntro,function(){return bu.start()});Rc.firstVisit.customizePotty=!1})})})}},{key:"onPottyCustomizationConfirmed",value:function(){var t=this;for(var e in Mc.play("button"),this.btnNext.active=!1,this.btnNext.setRollOver(0),this.btnNext.setTimeout(0),this.pottyOptions)this.pottyOptions[e].active=!1,this.pottyOptions[e].setRollOver(0),this.pottyOptions[e].setTimeout(0);Mc.stopVO(),Mc.play(this.config.audioKeys.potty.complete[Rc.character],function(){Mc.play("sparkleFanfare",function(){return t.stopScene()})})}},{key:"onCharacterClicked",value:function(t){var e=this;for(var n in Mc.play("button"),Mc.stopVO(),Mc.play(this.config.audioKeys.character[t.config.type],function(){return e.onCharacterSelectionConfirmed()}),this.selected=t,this.selected.playAction(),this.selected.setRollOver(0),this.selected.setTimeout(0),this.selected.active=!1,this.characters)this.characters[n].active=!1}},{key:"onPottyOptionClicked",value:function(t){"color"===t.config.type?Mc.play(this.config.audioKeys.potty.pottyChange):Mc.play(this.config.audioKeys.potty.seatChange),Rc.isMobile&&t.setRollOver(0),this.pottyButtonClicks++,Rc.potty[t.config.type]=t.config.states[t.current].value,this.potty.setCustomPotty()}},{key:"initializeCharacterSelection",value:function(){Rc.screenName="Character Select Screen",this.btnNext.active=!1,this.btnNext.visible=!1,this.initializeCharacters()}},{key:"uninitializeCharacterSelection",value:function(){this.uninitializeCharacters()}},{key:"initializePottyCustomization",value:function(){Rc.screenName="Potty Customization Screen",this.current=this.states.potty,this.timeoutAudioKeys=this.config.audioKeys[this.current].timeout.slice(),this.btnNext.active=!1,this.btnNext.clicked.addOnce(this.onPottyCustomizationConfirmed,this),this.potty=new Oy.Potty(this.game,this.config.potty),this.world.add(this.potty),this.potty.setCustomPotty(),this.initializePottyCustomizationOptions()}},{key:"initializeCharacters",value:function(){var t=this;this.characters={},this.config.characters.forEach(function(e){var n=new Sy.Character(t.game,e);t.world.add(n),n.active=!1,n.clicked.add(t.onCharacterClicked,t),t.characters[e.type]=n})}},{key:"uninitializeCharacters",value:function(){for(var t in this.characters)this.characters[t].destroy();this.characters=void 0}},{key:"initializePottyCustomizationOptions",value:function(){var t=this;this.pottyOptions={},this.config.options.forEach(function(e){var n=new Sy.Option(t.game,e);t.world.add(n),n.active=!1,n.clicked.add(t.onPottyOptionClicked,t),t.pottyOptions[e.type]=n}),this.btnNext.visible=!0,this.btnNext.active=!1}},{key:"states",get:function(){return{character:"character",potty:"potty"}}}])&&pd(n.prototype,i),o&&pd(n,o),e}();function bd(t){return(bd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wd(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Od(t,e){return!e||"object"!==bd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sd(t,e,n){return(Sd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Pd(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Pd(t){return(Pd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Cd(t,e){return(Cd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _d=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Od(this,Pd(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Cd(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){Sd(Pd(e.prototype),"init",this).call(this),Rc.accidentProgress=0,Rc.screenName="Playroom Screen",this.clickablesToIgnore=[],this.configKey="playroomConfig"}},{key:"create",value:function(){var t=this;Sd(Pd(e.prototype),"create",this).call(this),this.initializeClickables(),this.selectedCharacter=this.clickables[Rc.character],this.btnParentMenu=zy.create(this.game,this.config.btnParentMenu),this.world.add(this.btnParentMenu),this.btnParentMenu.active=!1,this.btnParentMenu.clicked.add(this.onBtnParentMenuClicked,this),this.btnPottyChart=zy.create(this.game,this.config.btnPottyChart),this.world.add(this.btnPottyChart),this.btnPottyChart.active=!1,this.btnPottyChart.clicked.add(this.onBtnPottyChartClicked,this),this.babyGate=new Py.BabyGate(this.game,this.config.babyGate),this.world.add(this.babyGate),this.pottyChart=new Py.PottyChart(this.game,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){wd(t,e,n[e])})}return t}({},this.config.pottyChart,this.cache.getJSON("pottyChartConfig"))),this.world.add(this.pottyChart),this.clickables.radio.radioOff.add(this.onRadioOff,this),void 0===Rc.playroomState?(Rc.currentPottyDance=-1,this.clickTracker=0,this.totalLessonClicks=0,this.meterFillElapsed=0,this.requiredClicksToStart=Ul.between(this.config.clickRange.min,this.config.clickRange.max),this.lessonState=this.lessonStates.playtime,this.lessons=this.config.lessons,this.lessons.forEach(function(t){return t.played=!1}),this.currentLesson=0):(this.clickTracker=Rc.playroomState.clickTracker,this.totalLessonClicks=Rc.playroomState.totalLessonClicks,this.lessonState=Rc.playroomState.lessonState,this.lessons=Rc.playroomState.lessons,this.currentLesson=Rc.playroomState.currentLesson,this.meterFillElapsed=Rc.playroomState.meterFillElapsed,this.lessonState===this.lessonStates.gottaGo&&(this.selectedCharacter.state=this.selectedCharacter.states.gottaGo,this.selectedCharacter.playIdle(),this.clickables.door.active=!0),this.currentLesson>=Rc.urgentPottyDance&&(Mc.stopTrack(this.config.audioKeys.music),Mc.play(this.config.audioKeys.urgent))),this.lessonPaused=!0,this.songList=Object.keys(Rc.songs),this.currentSong=void 0,this.sceneCompleted=!1,this.game.time.events.add(1e3,function(){return t.enterScene()})}},{key:"shutdown",value:function(){this.btnParentMenu=void 0,this.btnPottyChart=void 0,this.selectedCharacter=void 0,this.babyGate=void 0,this.pottyChart=void 0,this.clickables=void 0,this.songList=void 0,this.lessons=void 0,Sd(Pd(e.prototype),"shutdown",this).call(this)}},{key:"update",value:function(){if(this.lessonState==this.lessonStates.gottaGo&&!this.lessonPaused)if(this.meterFillElapsed+=.001*this.game.time.elapsedMS,Rc.accidentProgress=ns.clamp(this.meterFillElapsed/this.config.totalFillTime,0,1),this.meterFillElapsed>=this.config.totalFillTime)this.unsuccessfullyFinishPottyTrainingLesson();else if(this.currentLesson<this.lessons.length&&!this.lessons[this.currentLesson].played){var t=this.meterFillElapsed/this.config.totalFillTime;Rc.accidentIncrements[this.currentLesson]<=t&&(this.lessons[this.currentLesson].played=!0,this.playPottyTrainingLesson())}}},{key:"startScene",value:function(){var t=this;vu(Rc,{event:oc,componentType:"Simulation"}),Rc.firstVisit.playroom?Mc.play(this.config.audioKeys.intro,function(){t.lessonPaused=!1,bu.start()}):Mc.play(Ul.item(this.config.audioKeys.returnIntro),function(){t.lessonPaused=!1,bu.start()}),Rc.firstVisit.playroom=!1,this.btnParentMenu.active=!0,this.btnPottyChart.active=!0,Object.keys(this.clickables).forEach(function(e){t.clickables[e].active=!0,t.clickables[e]===t.clickables.door&&t.lessonState===t.lessonStates.playtime&&(t.clickables.door.active=!1)})}},{key:"stopScene",value:function(){var t=this;this.lessonPaused=!0,this.btnParentMenu.active=!1,this.btnPottyChart.active=!1,this.meterFillElapsed=0,Object.keys(this.clickables).forEach(function(e){return t.clickables[e].active=!1}),bu.stop(),Sd(Pd(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.nextScene===this.state.current?this.state.restart():this.state.start("loading",!0,!1,this.nextScene,[this.nextScene],[this.state.current])}},{key:"onRadioOff",value:function(){this.currentLesson>=Rc.urgentPottyDance?Mc.play(this.config.audioKeys.urgent):Mc.play(this.config.audioKeys.music)}},{key:"onTimeoutBegin",value:function(){var t=this;if(!this.babyGate.isOpened)switch(this.lessonState){case this.lessonStates.playtime:Mc.play(this.config.audioKeys.timeout.playtime),Object.keys(this.clickables).forEach(function(e){return t.clickables[e].beginTimeout()});break;case this.lessonStates.gottaGo:this.selectedCharacter.beginTimeout()}}},{key:"onTimeoutEnd",value:function(){var t=this;Object.keys(this.clickables).forEach(function(e){return t.clickables[e].endTimeout()})}},{key:"onBtnParentMenuClicked",value:function(){var t=this;vu(Rc,{event:hc,objectName:"Grown-Ups"}),vu(Rc,{event:fc,buttonName:"Grown-Ups"}),this.lessonPaused=!0,Mc.stopVO(),bu.stop(),Mc.play("Grownups");var e=function(){t.babyGate.opened.removeAll(),t.babyGate.closed.removeAll(),t.babyGate.success.removeAll()};this.babyGate.open(),this.babyGate.opened.addOnce(function(){Mc.play(t.config.audioKeys.parentsMenu),bu.start()}),this.babyGate.closed.addOnce(function(){Mc.stopVO(),e(),bu.start(),t.lessonPaused=!1}),this.babyGate.success.addOnce(function(){Mc.stopVO(),e(),t.babyGate.toggleInput(!1),t.nextScene="parentMenu",Rc.playroomState={clickTracker:t.clickTracker,totalLessonClicks:t.totalLessonClicks,lessonState:t.lessonState,lessons:t.lessons,currentLesson:t.currentLesson,meterFillElapsed:t.meterFillElapsed},t.stopScene()})}},{key:"onBtnPottyChartClicked",value:function(){var t=this;Mc.play("sparkleFanfare"),this.lessonPaused=!0,Mc.stopVO(),bu.stop(),this.btnPottyChart.onOut(),this.pottyChart.open(),this.pottyChart.opened.addOnce(function(){Mc.play(t.config.audioKeys.pottyChart)}),this.pottyChart.closed.addOnce(function(){t.pottyChart.opened.removeAll(),t.pottyChart.closed.removeAll(),Mc.stopVO(),bu.start(),t.lessonPaused=!1})}},{key:"onClickableActionBegin",value:function(t){bu.stop(),this.handleClickable(t),this.lessonPaused||this.playClickableReactionVO(t)}},{key:"onClickableActionEnd",value:function(t){this.lessonPaused||bu.start()}},{key:"incrementClickTracker",value:function(t){-1===this.clickablesToIgnore.indexOf(t.name)&&(this.clickTracker++,this.totalLessonClicks++)}},{key:"handleClickable",value:function(t){var e=Rc.playroomObjectMap[t.name];switch(void 0!==e&&("radio"===t.name?vu(Rc,{event:hc,objectName:t.isToggled?e.on:e.off}):vu(Rc,{event:hc,objectName:e})),this.incrementClickTracker(t),this.lessonState){case this.lessonStates.playtime:this.clickTracker>=this.requiredClicksToStart&&(this.lessonState=this.lessonStates.gottaGo,this.clickables.door.active=!0,this.playPottyTrainingLesson());break;case this.lessonStates.gottaGo:t.name!==this.selectedCharacter.name&&"door"!==t.name||(this.selectedCharacter.playEndReaction(),this.successfullyFinishPottyTrainingLesson())}}},{key:"playPottyTrainingLesson",value:function(){var t=this;this.lessonPaused=!0;var e=this.lessons[this.currentLesson];Mc.stopVO(),Rc.currentPottyDance=ns.clamp(Rc.currentPottyDance+1,0,Rc.pottyDanceCount),this.selectedCharacter.state=this.selectedCharacter.states.gottaGo,this.selectedCharacter.playPottyDance(),Mc.play(e.audioKeys.lesson[Rc.character],function(){t.sceneCompleted||(t.selectedCharacter.active=!0,t.clickables.door.active=!0,t.lessonPaused=!1,bu.start())}),bu.stop(),this.currentLesson!==Rc.urgentPottyDance||Mc.isPlaying("PP_3.0_24")||(Mc.stopTrack(this.config.audioKeys.music),Mc.play(this.config.audioKeys.urgent)),this.currentLesson++}},{key:"successfullyFinishPottyTrainingLesson",value:function(){var t=this;vu(Rc,{event:rc,componentType:"Simulation",duration:(Date.now()-this.startTime)/1e3}),this.lessonPaused=!0,this.btnParentMenu.active=!1,this.btnPottyChart.active=!1,this.selectedCharacter.active=!1,this.clickables.door.active=!1,this.sceneCompleted=!0,bu.stop(),Mc.play("sparkleFanfare",function(){t.nextScene="findPotty",Rc.playroomState=void 0,t.stopScene()})}},{key:"unsuccessfullyFinishPottyTrainingLesson",value:function(){var t=this;vu(Rc,{event:lc,questionAsked:"Accident",questionNumber:0,playerAnswer:"Accident"}),Mc.stopMusic(),this.lessonPaused=!0,this.btnParentMenu.active=!1,this.btnPottyChart.active=!1,this.selectedCharacter.active=!1,bu.stop(),Mc.stopVO(),Mc.play(Rc.accidentAudioKeys,function(){Rc.currentAccident=ns.mod(Rc.currentAccident+1,Rc.accident.length),t.nextScene="playroom",Rc.playroomState=void 0,t.stopScene()})}},{key:"initializeClickables",value:function(){var t=this;this.clickables={},this.reactionTrackers={},Object.keys(this.config.clickables).forEach(function(e){var n=Uy.create(t.game,t.config.clickables[e]);t.world.add(n),n.name=e,n.active=!1,n.actionBegin.add(t.onClickableActionBegin,t),n.actionEnd.add(t.onClickableActionEnd,t),t.clickables[e]=n,t.reactionTrackers[e]=0,t.config.clickables[e].ignoreClickTracker&&t.clickablesToIgnore.push(e)})}},{key:"playClickableReactionVO",value:function(t){var e=this,n=this.config.audioKeys.characterReacts,i=function(){e.reactionTrackers[t.name]=(e.reactionTrackers[t.name]+1)%2},o=function(t,e){return Mc.play(t,function(){return e.active=!0})};if(this.lessonState===this.lessonStates.playtime)if(t.name===this.selectedCharacter.name)this.reactionTrackers[t.name]%2==0?o(n[t.name].noPotty,t)&&i():o(n[t.name].altReact,t)&&i();else if(void 0!==Rc.characterOptions[t.name])this.reactionTrackers[t.name]%2==0?o(n[t.name].altReact,t)&&i():i();else{var r=function(){for(var e in n)if(void 0!==n[e][t.name])return e}();void 0!==r&&(this.reactionTrackers[t.name]%2==0?o(n[r][t.name],this.clickables[r])&&i():i())}}},{key:"lessonStates",get:function(){return{playtime:"playtime",gottaGo:"gottaGo"}}}])&&kd(n.prototype,i),o&&kd(n,o),e}();function xd(t){return(xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ed(t,e){return!e||"object"!==xd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Td(t,e,n){return(Td="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ad(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Ad(t){return(Ad=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Rd(t,e){return(Rd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Id=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ed(this,Ad(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rd(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){Td(Ad(e.prototype),"init",this).call(this),Rc.screenName="Grown-Ups Screen",this.configKey="parentMenuConfig"}},{key:"create",value:function(){var t=this;Td(Ad(e.prototype),"create",this).call(this),this.screens={},this.background=this.game.add.image(0,0),Object.keys(this.config.screens).forEach(function(e){t.screens[e]=new Ay.Screen(t.game,t.config.screens[e]),t.world.add(t.screens[e]),t.screens[e].screenName=e,t.screens[e].visible=!1,t.screens[e].toggleScreenInput(!1),t.screens[e].screenButtonClicked.add(t.onScreenButtonClicked,t)}),this.currentScreen=this.config.initialScreen,this.screens[this.currentScreen].visible=!0,this.background.loadTexture(this.screens[this.currentScreen].config.background),this.enterScene()}},{key:"startScene",value:function(){vu(Rc,{event:oc,componentType:"Other"}),this.screens[this.currentScreen].toggleScreenInput(!0),bu.start()}},{key:"stopScene",value:function(){vu(Rc,{event:rc,componentType:"Other",duration:(Date.now()-this.startTime)/1e3}),this.screens[this.currentScreen].toggleScreenInput(!1),bu.stop(),Td(Ad(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,"playroom",["playroom"],[this.state.current])}},{key:"onTimeoutBegin",value:function(){}},{key:"onTimeoutEnd",value:function(){}},{key:"onScreenButtonClicked",value:function(t,e){Mc.stopMusic(),Mc.stopVO(),t===this.screenNames.info?e===this.buttonNames.close?this.stopScene():e===this.buttonNames.songs?this.switchScreens(this.screenNames.lyrics):e===this.buttonNames.chart&&ru.downloadImage(e):t===this.screenNames.lyrics&&(e===this.buttonNames.close?this.switchScreens(this.screenNames.info):e===this.buttonNames.print?ru.downloadImage(this.screens[this.currentScreen].carousel.focusedItem.key):e===this.buttonNames.listen&&Mc.play(Rc.songs[this.screens[this.currentScreen].carousel.focusedItem.key].audioKey))}},{key:"switchScreens",value:function(t){var e=this;this.screens[this.currentScreen].toggleScreenInput(!1),yu.transitionOut(function(){e.screens[e.currentScreen].visible=!1,e.screens[t].visible=!0,e.background.loadTexture(e.screens[t].config.background),yu.transitionIn(function(){e.screens[t].toggleScreenInput(!0),e.currentScreen=t})})}},{key:"screenNames",get:function(){return{info:"info",lyrics:"lyrics"}}},{key:"buttonNames",get:function(){return{songs:"songs",chart:"chart",listen:"listen",print:"print",close:"close"}}}])&&jd(n.prototype,i),o&&jd(n,o),e}();function Fd(t){return(Fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ld(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Md(t,e){return!e||"object"!==Fd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Dd(t,e,n){return(Dd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Nd(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Nd(t){return(Nd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kd(t,e){return(Kd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bd=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Md(this,Nd(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kd(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){Dd(Nd(e.prototype),"init",this).call(this),this.configKey="findPottyConfig",Rc.screenName="Maze Screen"}},{key:"create",value:function(){var t=this;Dd(Nd(e.prototype),"create",this).call(this),this.game.physics.startSystem(Phaser.Physics.ARCADE),this.door=new Cy.Door(this.game,this.config.door),this.world.add(this.door),this.layout=new Cy.Layout(this.game,{layouts:this.config.layouts,obstacles:this.config.obstacles}),this.world.add(this.layout),this.world.add(this.layout.sortedLayer),this.character=new Cy.Character(this.game,this.config.character),this.layout.sortedLayer.add(this.character),this.gameInput=new Cy.Input(this.game,this),this.character.active=!1,this.gameInput.enabled=!1,this.updateAccidentProgress=!1,this.meterFillElapsed=this.config.totalFillTime*Rc.accidentProgress,this.timeoutAudioKeys=this.config.audioKeys.timeout[Rc.character].slice(),bu.timeoutBegin.add(this.onTimeoutBegin,this),bu.timeoutEnd.add(this.onTimeoutEnd,this),Rc.currentPottyDance===Rc.urgentPottyDance&&(Mc.stopTrack(this.config.audioKeys.music),Mc.play(this.config.audioKeys.urgent)),this.game.time.events.add(1e3,function(){t.enterScene()})}},{key:"shutdown",value:function(){this.gameInput.destroy(),this.gameInput=void 0,this.layout=void 0,this.character=void 0,Dd(Nd(e.prototype),"shutdown",this).call(this)}},{key:"update",value:function(){if(this.gameInput.update(),this.gameInput.enabled&&(this.game.physics.arcade.overlap(this.character,this.layout.sortedLayer,this.characterObstacleHandleOverlap,this.characterObstacleProcessOverlap,this),this.game.physics.arcade.overlap(this.character,this.door,this.characterDoorHandleOverlap,null,this),this.updateAccidentProgress))if(this.meterFillElapsed+=.001*this.game.time.elapsedMS,Rc.accidentProgress=ns.clamp(this.meterFillElapsed/this.config.totalFillTime,0,1),this.meterFillElapsed>=this.config.totalFillTime)this.unsuccessfullyFinishPottyLesson();else{var t=Math.floor(this.meterFillElapsed/this.config.totalFillTime*100)/100;Rc.accidentIncrements[Rc.currentPottyDance+1]<=t&&(Rc.currentPottyDance=ns.clamp(Rc.currentPottyDance+1,0,Rc.pottyDanceCount),this.character.playIdle(),Rc.currentPottyDance===Rc.urgentPottyDance&&(Mc.stopTrack(this.config.audioKeys.music),Mc.play(this.config.audioKeys.urgent)))}this.layout.sortedLayer.sort("y",Phaser.Group.SORT_ASCENDING)}},{key:"render",value:function(){var t=this;Rc.debugFlags.physics&&(this.layout.sortedLayer.forEach(function(e){return t.game.debug.body(e)}),this.game.debug.body(this.door))}},{key:"startScene",value:function(){var t=this;vu(Rc,{event:oc,componentType:"Maze"});var e="";e=Rc.firstVisit.findPotty?this.config.audioKeys.intro[Rc.character]:this.config.audioKeys.returnIntro[Rc.character],this.door.beginTimeout(),Mc.play(e,function(){t.door.endTimeout(),t.updateAccidentProgress=!0}),Rc.firstVisit.findPotty=!1,this.character.active=!0,this.gameInput.enabled=!0,bu.start()}},{key:"stopScene",value:function(){this.character.active=!1,this.gameInput.enabled=!1,bu.stop(),Dd(Nd(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,this.nextScene,[this.nextScene],[this.state.current])}},{key:"playTimeoutAudio",value:function(){0===this.timeoutAudioKeys.length&&(this.timeoutAudioKeys=this.config.audioKeys.timeout[Rc.character].slice());var t=this.timeoutAudioKeys.shift();Mc.play(t)}},{key:"onTimeoutBegin",value:function(){this.character.beginTimeout(),this.door.beginTimeout(),this.playTimeoutAudio()}},{key:"onTimeoutEnd",value:function(){this.character.endTimeout(),this.door.endTimeout()}},{key:"onBtnClicked",value:function(){this.stopScene()}},{key:"successfullyFinishPottyLesson",value:function(){var t=this;vu(Rc,{event:rc,componentType:"Maze",duration:(Date.now()-this.startTime)/1e3}),this.character.isMoving=!1,this.character.playIdle(),this.gameInput.enabled=!1,this.character.active=!1,this.door.openDoor(),Mc.play("sparkleFanfare",function(){Mc.play("Door"),t.nextScene="waitingPotty",t.stopScene()})}},{key:"unsuccessfullyFinishPottyLesson",value:function(){var t=this;vu(Rc,{event:lc,questionAsked:"Accident",questionNumber:0,playerAnswer:"Accident"}),this.character.isMoving=!1,this.character.playIdle(),this.gameInput.enabled=!1,this.character.active=!1,Mc.stopVO(),Mc.stopMusic(),Mc.play(Rc.accidentAudioKeys,function(){Rc.currentAccident=ns.mod(Rc.currentAccident+1,Rc.accident.length),t.nextScene="playroom",t.stopScene()})}},{key:"characterDoorHandleOverlap",value:function(t,e){this.successfullyFinishPottyLesson()}},{key:"characterObstacleHandleOverlap",value:function(t,e){this.playCharacterBump(t,e)}},{key:"characterObstacleProcessOverlap",value:function(t,e){return!e.collisionCooldown&&(e.requiresCorrection?(e.requiresCorrection=!1,!0):(e.collisionTracker++,!0))}},{key:"playCharacterBump",value:function(t,e){var n=this;t.onCollision.dispatch(),this.gameInput.enabled=!1;var i=t.body.position.x,o=i+t.body.width,r=t.body.position.y,a=r+t.body.height,s=e.position.x+e.config.collider.x,c=s+e.config.collider.width,u=e.position.y+e.config.collider.y,l=[{x:i-c,y:0},{x:o-s,y:0},{x:0,y:r-(u+e.config.collider.height)},{x:0,y:a-u}];l.sort(function(t,e){return ns.magnitude(t.x,t.y)-ns.magnitude(e.x,e.y)});var h={x:l[0].x,y:l[0].y};0!==h.x&&(h.x+=this.config.bumpDistance*ns.sign(h.x)),0!==h.y&&(h.y+=this.config.bumpDistance*ns.sign(h.y));var f=t.keepInSafeArea(t.x-h.x,t.y-h.y),p=ns.magnitude(t.position.x-f.x,t.position.y-f.y)/this.config.bumpPPS,y=this.game.add.tween(t).to(f,p*this.config.bumpTime,Phaser.Easing.Quadratic.Out);this.character.playBump(),Mc.play(this.config.audioKeys.bumpSFX),y.onComplete.add(function(){e.collisionTracker>=n.config.maxBumps&&(e.collisionCooldown=!0,e.cooldownComplete.addOnce(function(){return e.requiresCorrection=n.game.physics.arcade.intersects(t.body,e.body)}),n.playTimeoutAudio()),n.gameInput.clearVelocity(),n.gameInput.enabled=!0,n.character.playIdle()}),y.start()}}])&&Ld(n.prototype,i),o&&Ld(n,o),e}();function Vd(t){return(Vd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ud(t,e){return!e||"object"!==Vd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gd(t,e,n){return(Gd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hd(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Hd(t){return(Hd=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wd(t,e){return(Wd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qd=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ud(this,Hd(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wd(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){Gd(Hd(e.prototype),"init",this).call(this),this.configKey="waitingPottyConfig",Rc.screenName="Waiting Screen"}},{key:"create",value:function(){Gd(Hd(e.prototype),"create",this).call(this),this.potty=new Oy.Potty(this.game,this.config.potty),this.world.add(this.potty),this.character=new _y.Character(this.game,this.config.character),this.world.add(this.character),this.potty.setCustomPotty(),this.initializeClickables(),this.potty.setScale(.7),this.correctAudioKeys=this.config.audioKeys.correct.slice(),this.searchItems=Ul.shuffle(this.config.descriptors).slice(),this.currentSearchItem=void 0,this.clickableName=void 0,this.reactCount=0,this.elapsedSeconds=0,this.lessonPaused=!0,this.itemFound=!1,this.timeup=!1,this.gameStart=!1,this.currentDescriptor=void 0,this.continueISpyEvent=void 0,this.itemCount=0,this.ispyVO=this.config.audioKeys.ispy.slice(),this.enterScene()}},{key:"shutdown",value:function(){this.clickables=void 0,this.potty=void 0,this.character=void 0,this.continueISpyEvent=void 0,Gd(Hd(e.prototype),"shutdown",this).call(this)}},{key:"update",value:function(){this.gameStart&&(this.elapsedSeconds+=.001*this.game.time.elapsedMS,this.elapsedSeconds>this.config.duration&&(this.timeup=!0),this.timeup&&!this.lessonPaused&&this.finishPottyLesson())}},{key:"startScene",value:function(){var t=this;if(vu(Rc,{event:oc,componentType:"Look and Find"}),Rc.firstVisit.waitingPotty){var e=this.config.audioKeys.introCharacter[Rc.character];Mc.play([e,this.config.audioKeys.intro],function(){return t.introVOComplete()})}else{var n=this.config.audioKeys.returnIntro[Rc.character];Mc.play(n,function(){return t.introVOComplete()})}Rc.firstVisit.waitingPotty=!1}},{key:"stopScene",value:function(){var t=this;vu(Rc,{event:rc,componentType:"Look and Find",duration:(Date.now()-this.startTime)/1e3}),Object.keys(this.clickables).forEach(function(e){return t.clickables[e].active=!1}),bu.stop(),Gd(Hd(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,"wiping",["wiping"],[this.state.current])}},{key:"introVOComplete",value:function(){this.gameStart=!0,this.pickNextItem()}},{key:"onTimeoutBegin",value:function(){this.playHint()}},{key:"onTimeoutEnd",value:function(){var t=this;Object.keys(this.clickables).forEach(function(e){return t.clickables[e].endTimeout()})}},{key:"playHint",value:function(){var t=this;void 0!==this.currentDescriptor&&(Mc.play([this.config.audioKeys.timeout,this.currentDescriptor.audioKey]),this.currentDescriptor.clickables.forEach(function(e){return t.clickables[e].beginTimeout()}))}},{key:"onClickableActionBegin",value:function(t){var e=this;if(bu.stop(),void 0!==this.currentDescriptor){if(this.currentDescriptor.clickables.indexOf(t.name)>=0){Object.keys(this.clickables).forEach(function(t){return e.clickables[t].active=!1}),this.lessonPaused=!0,t.endTimeout(),Mc.play(this.config.audioKeys.correctSFX);var n=function(){0===e.correctAudioKeys.length&&(e.correctAudioKeys=e.config.audioKeys.correct.slice()),Mc.stopVO(),Mc.play(e.correctAudioKeys.shift(),function(){return e.continueISpy()}),e.character.playAction()},i=this.config.audioKeys[t.name];Rc.isDesktop&&Mc.isPlaying(i)?Mc.addCallbackTo(i,n):(Mc.stopVO(),Mc.play(i,n)),vu(Rc,{event:uc,questionAsked:Rc.waitingObjectMap[this.currentDescriptor.clickables[0]],questionNumber:this.itemCount,playerAnswer:Rc.waitingObjectMap[t.name]})}else Mc.play(this.config.audioKeys.incorrectSFX),this.currentDescriptor.clickables.forEach(function(t){return e.clickables[t].setTimeout(1)}),t.playIdle(),Mc.stopVO(),this.playHint(),vu(Rc,{event:lc,questionAsked:Rc.waitingObjectMap[this.currentDescriptor.clickables[0]],questionNumber:this.itemCount,playerAnswer:Rc.waitingObjectMap[t.name]});vu(Rc,{event:hc,objectName:Rc.waitingObjectMap[t.name]})}}},{key:"shouldPlayCharacterReact",value:function(){var t=!1;return this.reactCount++,this.reactCount%2==0&&(t=Mc.play(this.config.audioKeys.characterReacts[Rc.character])),t&&(this.reactCount=0),t}},{key:"onClickableActionEnd",value:function(t){this.lessonPaused||bu.start(),t.active=!this.lessonPaused}},{key:"onClickableHover",value:function(t){t.active&&Rc.isDesktop&&Mc.play(this.config.audioKeys[t.name])}},{key:"continueISpy",value:function(){var t=this;this.lessonPaused=!1,this.timeup||(this.continueISpyEvent=this.game.time.events.add(1e3,function(){t.pickNextItem()}))}},{key:"pickNextItem",value:function(){var t=this;if(!this.timeup){this.lessonPaused=!0,this.itemCount++,0===this.ispyVO.length&&(this.ispyVO=this.config.audioKeys.ispy.slice()),0===this.searchItems.length&&(this.searchItems=Ul.shuffle(this.config.descriptors).slice());var e=this.ispyVO.shift();this.currentDescriptor=this.searchItems.shift(),this.clickableName=this.currentDescriptor.clickables[0],Mc.play([e,this.currentDescriptor.audioKey],function(){t.lessonPaused=!1,Object.keys(t.clickables).forEach(function(e){return t.clickables[e].active=!0}),bu.start()})}}},{key:"finishPottyLesson",value:function(){var t=this;this.gameStart=!1,this.lessonPaused=!0,bu.stop(),Object.keys(this.clickables).forEach(function(e){t.clickables[e].endTimeout(),t.clickables[e].setRollOver(0),t.clickables[e].active=!1}),this.game.time.events.remove(this.continueISpyEvent),Mc.stopVO(),Mc.play([this.config.audioKeys.characterComplete[Rc.character],this.config.audioKeys.complete,"sparkleFanfare"],function(){return t.stopScene()})}},{key:"initializeClickables",value:function(){var t=this;this.clickables={},Object.keys(this.config.clickables).forEach(function(e){var n=Uy.create(t.game,t.config.clickables[e]);t.world.add(n),n.name=e,n.active=!1,n.actionBegin.add(t.onClickableActionBegin,t),n.actionEnd.add(t.onClickableActionEnd,t),n.events.onInputOver.add(function(){return t.onClickableHover(n)}),t.clickables[e]=n})}}])&&zd(n.prototype,i),o&&zd(n,o),e}();function Xd(t){return(Xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Jd(t,e){return!e||"object"!==Xd(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qd(t,e,n){return(Qd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$d(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function $d(t){return($d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zd(t,e){return(Zd=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tv=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Jd(this,$d(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zd(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){Qd($d(e.prototype),"init",this).call(this),this.configKey="wipingConfig",Rc.screenName="Wiping Screen"}},{key:"create",value:function(){Qd($d(e.prototype),"create",this).call(this),this.potty=new Oy.Potty(this.game,this.config.potty),this.world.add(this.potty),this.potty.setCustomPotty(),this.character=new xy.Character(this.game,this.config.character),this.world.add(this.character),this.toiletPaperRoll=new xy.ToiletPaperRoll(this.game,this.config.toiletPaperRoll),this.world.add(this.toiletPaperRoll),this.objective=Ul.between(this.config.objectiveRange.min,this.config.objectiveRange.max),this.squareCount=0,this.toiletPaperRoll.active=!1,this.toiletPaperRoll.setObjective(this.objective),this.toiletPaperRoll.objectiveMet.add(this.onToiletPaperObjectiveMet,this),this.toiletPaperRoll.squareAdded.add(this.onSquareAdded,this),this.enterScene()}},{key:"startScene",value:function(){var t=this;vu(Rc,{event:oc,componentType:"Other"}),this.toiletPaperRoll.active=!0,Mc.play([this.config.audioKeys.intro1,this.config.audioKeys.intro2],function(){t.toiletPaperRoll.beginTimeout();var e=t.config.audioKeys.characterIntro[Rc.character],n=t.config.audioKeys.objective[t.objective-1][Rc.character];Mc.play([e,n],function(){t.toiletPaperRoll.endTimeout(),bu.start()})})}},{key:"stopScene",value:function(){vu(Rc,{event:rc,componentType:"Other",duration:(Date.now()-this.startTime)/1e3}),bu.stop(),Qd($d(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,"flushPotty",["flushPotty"],[this.state.current])}},{key:"onTimeoutBegin",value:function(){this.toiletPaperRoll.beginTimeout(),this.squareCount!==this.objective&&this.squareCount>0?Mc.play(this.config.audioKeys.characterTimeout[Rc.character]):Mc.play(this.config.audioKeys.timeout)}},{key:"onTimeoutEnd",value:function(){this.toiletPaperRoll.endTimeout()}},{key:"onToiletPaperObjectiveMet",value:function(t){var e=this;Mc.stopChannel(Mc.channels.VO),Mc.play(this.config.audioKeys.rip),Mc.play(this.config.audioKeys.countComplete[this.squareCount-1],function(){e.character.playActionStart(function(){var n=e.game.add.group();n.position.set(e.toiletPaperRoll.x+t.x,e.toiletPaperRoll.y+t.y);for(var i=t.children.slice(0,e.toiletPaperRoll.objective);i.length>0;){var o=i.shift();t.remove(o),n.add(o)}e.toiletPaperRoll.reset();var r=e.game.add.tween(n).to({x:e.config.toiletPaperEnd.x,y:e.config.toiletPaperEnd.y},500);e.game.add.tween(n.scale).to({x:.75,y:.75},500).start(),r.start(),r.onComplete.addOnce(function(){var t=e.game.add.tween(n).to({alpha:0},125);t.start(),t.onComplete.addOnce(function(){n.destroy(),e.character.playActionEnd(function(){return e.successfullyFinishPottyLesson()})})})})})}},{key:"onSquareAdded",value:function(t){this.squareCount=t,Mc.play(this.config.audioKeys.counting[this.squareCount-1]),Mc.play(this.config.audioKeys.select)}},{key:"successfullyFinishPottyLesson",value:function(){var t=this;Mc.play(this.config.audioKeys.characterComplete[Rc.character],function(){Mc.play("sparkleFanfare",function(){return t.stopScene()})})}}])&&Yd(n.prototype,i),o&&Yd(n,o),e}();function ev(t){return(ev="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nv(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function iv(t,e){return!e||"object"!==ev(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ov(t,e,n){return(ov="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rv(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function rv(t){return(rv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function av(t,e){return(av=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sv=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),iv(this,rv(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&av(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){ov(rv(e.prototype),"init",this).call(this),this.configKey="flushPottyConfig",Rc.screenName="Flushing Screen"}},{key:"create",value:function(){ov(rv(e.prototype),"create",this).call(this),this.potty=new Oy.Potty(this.game,this.config.potty),this.world.add(this.potty),this.potty.active=!0,this.potty.setCustomPotty(),this.potty.playIdleFlush(),this.potty.actionBegin.addOnce(this.onPottyActionBegin,this),this.potty.actionEnd.addOnce(this.onPottyActionEnd,this),this.character=new jy.Character(this.game,this.config.character),this.world.add(this.character),this.enterScene()}},{key:"startScene",value:function(){vu(Rc,{event:oc,componentType:"Simulation"}),Mc.play(this.config.audioKeys.intro,function(){bu.start()})}},{key:"stopScene",value:function(){vu(Rc,{event:rc,componentType:"Simulation",duration:(Date.now()-this.startTime)/1e3}),bu.stop(),ov(rv(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,"washHands",["washHands"],[this.state.current])}},{key:"onTimeoutBegin",value:function(){Mc.play(this.config.audioKeys.timeout),this.potty.beginTimeout()}},{key:"onTimeoutEnd",value:function(){this.potty.endTimeout()}},{key:"onPottyActionBegin",value:function(){this.potty.active=!1,this.character.playAction(),Mc.play(this.config.audioKeys.flush)}},{key:"onPottyActionEnd",value:function(){this.successfullyFinishPottyLesson()}},{key:"successfullyFinishPottyLesson",value:function(){var t=this;Mc.play([this.config.audioKeys.complete,"sparkleFanfare"],function(){return t.stopScene()})}}])&&nv(n.prototype,i),o&&nv(n,o),e}();function cv(t){return(cv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uv(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function lv(t,e){return!e||"object"!==cv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hv(t,e,n){return(hv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fv(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function fv(t){return(fv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pv(t,e){return(pv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yv=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),lv(this,fv(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pv(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){hv(fv(e.prototype),"init",this).call(this),this.configKey="washHandsConfig",Rc.screenName="Washing Screen"}},{key:"create",value:function(){var t=this;hv(fv(e.prototype),"create",this).call(this),this.faucet=new Ey.Faucet(this.game,this.config.faucet),this.world.add(this.faucet),this.character=new Ey.Character(this.game,this.config.character),this.world.add(this.character),this.handWater=Ys.libraries[this.config.handWater.flump.library].createClip(this.config.handWater.flump.animations.idle),this.handWater.visible=!1,this.handWater.position.set(this.config.handWater.position.x,this.config.handWater.position.y),this.world.addChild(this.handWater),this.draggable=new Ey.Draggable(this.game,this.config.draggable),this.world.add(this.draggable),this.draggable.active=!1,this.isABCs=!1,this.isDrying=!1,this.dryingTimeElapsed=0,this.activeDryingTime=this.config.dryingTime,this.dryingSFXTimer=void 0,this.game.time.events.add(1e3,function(){return t.enterScene()})}},{key:"update",value:function(){var t=this;this.isABCs?0===this.draggable.delta.x&&0===this.draggable.delta.y||this.character.incrementBubbleProgress()&&Mc.play(this.config.audioKeys.soap):this.isDrying&&(0!==this.draggable.delta.x||0!==this.draggable.delta.y?(bu.reset(),this.activeDryingTime-=.001*this.game.time.elapsedMS,this.handWater.alpha=this.activeDryingTime/this.config.dryingTime,ns.magnitude(this.draggable.delta.x,this.draggable.delta.y)>=10&&(void 0!==this.dryingSFXTimer&&(this.game.time.events.remove(this.dryingSFXTimer),this.dryingSFXTimer=void 0),Mc.play(this.config.audioKeys.dry))):void 0===this.dryingSFXTimer&&(this.dryingSFXTimer=this.game.time.events.add(250,function(){return Mc.stopTrack(t.config.audioKeys.dry)})),this.dryingTimeElapsed+=.001*this.game.time.elapsedMS,this.dryingTimeElapsed>=this.config.dryingTime&&this.onDryingComplete())}},{key:"startScene",value:function(){var t=this;vu(Rc,{event:oc,componentType:"Simulation"}),this.faucet.playTurnOn(function(){t.character.playEnterScreen(function(){t.draggable.enterState(t.draggable.states.soap),Mc.play(t.config.audioKeys.characterIntro[Rc.character]),bu.start(),t.draggable.active=!0,t.isABCs=!0,t.draggable.draggingStarted.addOnce(function(){bu.stop(),Mc.stopVO(),Mc.stopTrack(t.config.audioKeys.music),Mc.play(t.config.audioKeys.abc,function(){return t.onABCsComplete()})})})})}},{key:"stopScene",value:function(){bu.stop(),hv(fv(e.prototype),"stopScene",this).call(this)}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,"pottyChart",["pottyChart"],[this.state.current])}},{key:"onTimeoutBegin",value:function(){this.isABCs?Mc.play(this.config.audioKeys.timeout.abc[Rc.character]):Mc.play(this.config.audioKeys.timeout.drying[Rc.character])}},{key:"onTimeoutEnd",value:function(){}},{key:"onABCsComplete",value:function(){var t=this;vu(Rc,{event:rc,componentType:"Simulation",duration:(Date.now()-this.startTime)/1e3}),Mc.play(this.config.audioKeys.music),this.isABCs=!1,this.draggable.active=!1,this.draggable.exitState(function(){Mc.play("sparkleFanfare",function(){Mc.play(t.config.audioKeys.squeak),t.game.time.events.add(t.config.waterStartDelay,function(){return Mc.play(t.config.audioKeys.water)}),t.game.time.events.add(t.config.faucetOffDelay,function(){return Mc.play(t.config.audioKeys.squeak)}),t.game.time.events.add(t.config.waterStopDelay,function(){return Mc.stopTrack(t.config.audioKeys.water)}),t.character.washAwayBubbles(function(){t.handWater.visible=!0,t.faucet.playTurnOff(function(){return t.beginDrying()})})})})}},{key:"beginDrying",value:function(){var t=this;Rc.screenName="Drying Screen",this.startTime=Date.now(),vu(Rc,{event:oc,componentType:"Simulation"}),Mc.play(this.config.audioKeys.introDry,function(){Mc.play(t.config.audioKeys.towel),t.draggable.enterState(t.draggable.states.towel,function(){Mc.play(t.config.audioKeys.drySong,function(){bu.start()}),t.draggable.active=!0,t.draggable.draggingStarted.addOnce(function(){t.isDrying=!0})})})}},{key:"onDryingComplete",value:function(){var t=this;void 0!==this.dryingSFXTimer&&(this.game.time.events.remove(this.dryingSFXTimer),this.dryingSFXTimer=void 0),Mc.stopTrack(this.config.audioKeys.dry),vu(Rc,{event:rc,componentType:"Simulation",duration:(Date.now()-this.startTime)/1e3}),bu.stop(),this.draggable.active=!1,this.isDrying=!1,this.draggable.exitState(function(){if(t.handWater.alpha>0){var e=t.game.add.tween(t.handWater).to({alpha:0},500*t.handWater.alpha);e.onComplete.addOnce(t.finishDrying,t),e.start()}else t.finishDrying()})}},{key:"finishDrying",value:function(){var t=this;Mc.play("sparkleFanfare"),this.character.playExitScreen(function(){t.successfullyFinishPottyLesson()})}},{key:"successfullyFinishPottyLesson",value:function(){var t=this;this.game.time.events.add(1e3,function(){t.stopScene()})}}])&&uv(n.prototype,i),o&&uv(n,o),e}();function dv(t){return(dv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vv(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function mv(t,e){return!e||"object"!==dv(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gv(t,e,n){return(gv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=bv(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function bv(t){return(bv=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wv(t,e){return(wv=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var kv=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),mv(this,bv(e).apply(this,arguments))}var n,i,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wv(t,e)}(e,Qy),n=e,(i=[{key:"init",value:function(){gv(bv(e.prototype),"init",this).call(this),this.configKey="pottyChartConfig",Rc.screenName="Potty Chart Screen"}},{key:"create",value:function(){gv(bv(e.prototype),"create",this).call(this),this.chart=new Ty.Chart(this.game,this.config.pottyChart),this.world.add(this.chart),this.enterScene()}},{key:"startScene",value:function(){var t=this;Mc.play(this.config.audioKeys.intro,function(){var e=Rc.currentChartRow;t.chart.playRowCompletion(e,function(){e+1<t.config.maxRows?(Rc.currentChartRow++,t.onChartAnimationsComplete()):(Rc.currentChartRow=0,t.playAllRowsComplete())})})}},{key:"exitScene",value:function(){this.state.start("loading",!0,!1,"customization",["customization"],[this.state.current])}},{key:"playAllRowsComplete",value:function(){var t=this;Mc.play("fanfare");var e=Ys.libraries[this.config.completeFX.flump.library].createClip();this.world.add(e),e.position.set(this.game.width/2,this.game.height/2),e.onComplete.addOnce(function(){return t.onChartAnimationsComplete()}),e.playOnce(this.config.completeFX.flump.animations.idle)}},{key:"onChartAnimationsComplete",value:function(){var t=this;Mc.play(this.config.audioKeys.outro,function(){var e=Rc.getRoundDuration();vu(Rc,{event:cc,duration:e}),vu(Rc,{event:sc,roundNumber:Rc.playthroughCount,duration:e}),vu(Rc,{event:tc,achievementType:"Potty Complete"}),t.stopScene()})}}])&&vv(n.prototype,i),o&&vv(n,o),e}();function Ov(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Sv=Date.now(),Pv=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,(n=[{key:"init",value:function(){var t,e=this,n=this;this.game=new Phaser.Game(1320,780,/webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?Phaser.CANVAS:Phaser.AUTO,"gameTarget",{init:function(){window.addEventListener("unload",function(){var t=(Date.now()-Sv)/1e3;vu(Rc,{event:Zs,duration:t})}),this.game.stage.disableVisibilityChange=!0,nu.initialize(this.game,1024,660,1320,780)},preload:function(){this.load.json("manifest","assets/manifest.json")},create:function(){ju.parseManifest(this.cache.getJSON("manifest")),this.game.onBlur.add(n.onBlur,n),this.game.onFocus.add(n.onFocus,n),this.game.input.onUp.add(n.onFocus,n),this.game.input.onDown.add(n.onFocus,n),this.game.input.onTap.add(n.onFocus,n),this.game.input.onHold.add(n.onFocus,n),this.state.add("loading",zu),this.state.add("title",od),this.state.add("intro",hd),this.state.add("customization",gd),this.state.add("playroom",_d),this.state.add("parentMenu",Id),this.state.add("findPotty",Bd),this.state.add("waitingPotty",qd),this.state.add("wiping",tv),this.state.add("flushPotty",sv),this.state.add("washHands",yv),this.state.add("pottyChart",kv),this.state.add("boot",Mu,!0)}}),this.hidden=void 0,this.originalPauseValue=void 0,void 0!==document.hidden?(this.hidden="hidden",t="visibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",t="webkitvisibilitychange"),void 0!==document.addEventListener&&null!=this.hidden&&document.addEventListener(t,function(){return e.handleVisibilityChange()},!1),window.addEventListener("onpagehide",function(){return e.onBlur()},!1),window.addEventListener("pageshow",function(){return e.onFocus()},!1)}},{key:"handleVisibilityChange",value:function(){document[this.hidden]?this.onBlur():this.onFocus()}},{key:"onBlur",value:function(){document[this.hidden]&&void 0===this.originalPauseValue&&(this.originalPauseValue=this.game.paused,this.pauseGame(!0))}},{key:"onFocus",value:function(){void 0!==this.originalPauseValue&&(this.pauseGame(this.originalPauseValue),this.originalPauseValue=void 0)}},{key:"pauseGame",value:function(t){this.game.paused=t,Mc.pauseAudio(t)}}])&&Ov(e.prototype,n),i&&Ov(e,i),t}();Wa.uses(new qc("UA-3999779-2"));var Cv=new Wa({features:{captions:!0,vo:!0,music:!0,sfx:!0}}),_v=new Pv;Cv.state.ready.subscribe(function(t){t&&_v.init()}),Cv.state.pause.subscribe(function(t){return _v.pauseGame(t)}),Cv.state.captionsMuted.subscribe(function(t){return Hc.setCaptionMute(t)}),Cv.state.soundVolume.subscribe(function(t){return Mc.setMasterVolume(t)}),Cv.state.voVolume.subscribe(function(t){return Mc.setChannelVolume(Mc.channels.VO,t)}),Cv.state.musicVolume.subscribe(function(t){return Mc.setChannelVolume(Mc.channels.Music,t)}),Cv.state.sfxVolume.subscribe(function(t){return Mc.setChannelVolume(Mc.channels.SFX,t)});var xv=e.default=Cv}]);