(function(){'use strict';var re=Math.atan2,ae=Math.LN2,oe=Math.round,ne=Math.max,ie=Math.ceil,se=Math.log,le=Math.pow,de=Math.exp,ce=Math.expm1,ue=Math.floor,pe=Math.min,me=Math.PI,fe=Math.sin,ge=Math.cos,ye=Math.abs,he=Math.sqrt;function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t,r,a,o,n,i){try{var s=e[n](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,o)}function r(e){return function(){var r=this,a=arguments;return new Promise(function(o,n){function i(e){t(l,o,n,i,s,"next",e)}function s(e){t(l,o,n,i,s,"throw",e)}var l=e.apply(r,a);i(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0,a;r<t.length;r++)a=t[r],a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}function n(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return t&&("object"==typeof t||"function"==typeof t)?t:d(e)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=s(e),null!==e););return e}function p(e,t,r){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var a=u(e,t);if(a){var o=Object.getOwnPropertyDescriptor(a,t);return o.get?o.get.call(r):o.value}},p(e,t,r||e)}function m(e){throw new Error("\""+e+"\" is read-only")}function f(e,t){return h(e)||x(e,t)||b()}function g(e){return y(e)||v(e)||_()}function y(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function h(e){if(Array.isArray(e))return e}function v(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function x(e,t){var r=[],a=!0,o=!1,n=void 0;try{for(var i=e[Symbol.iterator](),s;!(a=(s=i.next()).done)&&(r.push(s.value),!(t&&r.length===t));a=!0);}catch(e){o=!0,n=e}finally{try{a||null==i["return"]||i["return"]()}finally{if(o)throw n}}return r}function _(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function b(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function S(){var e=new be(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function E(){var e=new be(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function A(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function T(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function k(e,t){if(e===t){var r=t[1],a=t[2],o=t[3],n=t[6],i=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=a,e[9]=n,e[11]=t[14],e[12]=o,e[13]=i,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function B(e,t){var r=t[0],a=t[1],o=t[2],n=t[3],i=t[4],s=t[5],l=t[6],d=t[7],c=t[8],u=t[9],p=t[10],m=t[11],f=t[12],g=t[13],y=t[14],h=t[15],v=r*s-a*i,x=r*l-o*i,_=r*d-n*i,b=a*l-o*s,S=a*d-n*s,E=o*d-n*l,A=c*g-u*f,T=c*y-p*f,k=c*h-m*f,B=u*y-p*g,O=u*h-m*g,w=p*h-m*y,I=v*w-x*O+_*B+b*k-S*T+E*A;return I?(I=1/I,e[0]=(s*w-l*O+d*B)*I,e[1]=(o*O-a*w-n*B)*I,e[2]=(g*E-y*S+h*b)*I,e[3]=(p*S-u*E-m*b)*I,e[4]=(l*k-i*w-d*T)*I,e[5]=(r*w-o*k+n*T)*I,e[6]=(y*_-f*E-h*x)*I,e[7]=(c*E-p*_+m*x)*I,e[8]=(i*O-s*k+d*A)*I,e[9]=(a*k-r*O-n*A)*I,e[10]=(f*S-g*_+h*v)*I,e[11]=(u*_-c*S-m*v)*I,e[12]=(s*T-i*B-l*A)*I,e[13]=(r*B-a*T+o*A)*I,e[14]=(g*x-f*b-y*v)*I,e[15]=(c*b-u*x+p*v)*I,e):null}function O(e,t,r){var a=t[0],o=t[1],n=t[2],i=t[3],s=t[4],l=t[5],d=t[6],c=t[7],u=t[8],p=t[9],m=t[10],f=t[11],g=t[12],y=t[13],h=t[14],v=t[15],x=r[0],_=r[1],b=r[2],S=r[3];return e[0]=x*a+_*s+b*u+S*g,e[1]=x*o+_*l+b*p+S*y,e[2]=x*n+_*d+b*m+S*h,e[3]=x*i+_*c+b*f+S*v,x=r[4],_=r[5],b=r[6],S=r[7],e[4]=x*a+_*s+b*u+S*g,e[5]=x*o+_*l+b*p+S*y,e[6]=x*n+_*d+b*m+S*h,e[7]=x*i+_*c+b*f+S*v,x=r[8],_=r[9],b=r[10],S=r[11],e[8]=x*a+_*s+b*u+S*g,e[9]=x*o+_*l+b*p+S*y,e[10]=x*n+_*d+b*m+S*h,e[11]=x*i+_*c+b*f+S*v,x=r[12],_=r[13],b=r[14],S=r[15],e[12]=x*a+_*s+b*u+S*g,e[13]=x*o+_*l+b*p+S*y,e[14]=x*n+_*d+b*m+S*h,e[15]=x*i+_*c+b*f+S*v,e}function w(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function I(e,t){var r=t[0],a=t[1],o=t[2],n=t[4],i=t[5],s=t[6],l=t[8],d=t[9],c=t[10];return e[0]=he(r*r+a*a+o*o),e[1]=he(n*n+i*i+s*s),e[2]=he(l*l+d*d+c*c),e}function C(e,t){var r=t[0]+t[5]+t[10],a=0;return 0<r?(a=2*he(r+1),e[3]=.25*a,e[0]=(t[6]-t[9])/a,e[1]=(t[8]-t[2])/a,e[2]=(t[1]-t[4])/a):t[0]>t[5]&&t[0]>t[10]?(a=2*he(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/a,e[0]=.25*a,e[1]=(t[1]+t[4])/a,e[2]=(t[8]+t[2])/a):t[5]>t[10]?(a=2*he(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/a,e[0]=(t[1]+t[4])/a,e[1]=.25*a,e[2]=(t[6]+t[9])/a):(a=2*he(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/a,e[0]=(t[8]+t[2])/a,e[1]=(t[6]+t[9])/a,e[2]=.25*a),e}function M(e,t,r,a){var o=t[0],n=t[1],i=t[2],s=t[3],l=o+o,d=n+n,c=i+i,u=o*l,p=o*d,m=o*c,f=n*d,g=n*c,y=i*c,h=s*l,v=s*d,x=s*c,_=a[0],b=a[1],S=a[2];return e[0]=(1-(f+y))*_,e[1]=(p+x)*_,e[2]=(m-v)*_,e[3]=0,e[4]=(p-x)*b,e[5]=(1-(u+y))*b,e[6]=(g+h)*b,e[7]=0,e[8]=(m+v)*S,e[9]=(g-h)*S,e[10]=(1-(u+f))*S,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function P(e,t,r,a,o){var n=Math.tan,i=1/n(t/2),s=1/(a-o);return e[0]=i/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(o+a)*s,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*o*a*s,e[15]=0,e}function D(e,t,r,a,o,n,i){var s=1/(t-r),l=1/(a-o),d=1/(n-i);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*d,e[11]=0,e[12]=(t+r)*s,e[13]=(o+a)*l,e[14]=(i+n)*d,e[15]=1,e}function L(e,t,r,a){var o=t[0],n=t[1],i=t[2],s=a[0],l=a[1],d=a[2],c=r[0],u=r[1],p=r[2],m,f,g,y,h,v,x,_,b,S;return ye(o-c)<_e&&ye(n-u)<_e&&ye(i-p)<_e?T(e):(x=o-c,_=n-u,b=i-p,S=1/he(x*x+_*_+b*b),x*=S,_*=S,b*=S,m=l*b-d*_,f=d*x-s*b,g=s*_-l*x,S=he(m*m+f*f+g*g),S?(S=1/S,m*=S,f*=S,g*=S):(m=0,f=0,g=0),y=_*g-b*f,h=b*m-x*g,v=x*f-_*m,S=he(y*y+h*h+v*v),S?(S=1/S,y*=S,h*=S,v*=S):(y=0,h=0,v=0),e[0]=m,e[1]=y,e[2]=x,e[3]=0,e[4]=f,e[5]=h,e[6]=_,e[7]=0,e[8]=g,e[9]=v,e[10]=b,e[11]=0,e[12]=-(m*o+f*n+g*i),e[13]=-(y*o+h*n+v*i),e[14]=-(x*o+_*n+b*i),e[15]=1,e)}function F(e,t,r,a){var o=t[0],n=t[1],i=t[2],s=a[0],l=a[1],d=a[2],c=o-r[0],u=n-r[1],p=i-r[2],m=c*c+u*u+p*p;0<m&&(m=1/he(m),c*=m,u*=m,p*=m);var f=l*p-d*u,g=d*c-s*p,y=s*u-l*c;return m=f*f+g*g+y*y,0<m&&(m=1/he(m),f*=m,g*=m,y*=m),e[0]=f,e[1]=g,e[2]=y,e[3]=0,e[4]=u*y-p*g,e[5]=p*f-c*y,e[6]=c*g-u*f,e[7]=0,e[8]=c,e[9]=u,e[10]=p,e[11]=0,e[12]=o,e[13]=n,e[14]=i,e[15]=1,e}function H(){var e=new be(3);return e[0]=0,e[1]=0,e[2]=0,e}function R(e,t,r){var a=new be(3);return a[0]=e,a[1]=t,a[2]=r,a}function N(e,t){var r=t[0]-e[0],a=t[1]-e[1],o=t[2]-e[2];return he(r*r+a*a+o*o)}function U(e,t){var r=t[0],a=t[1],o=t[2],n=r*r+a*a+o*o;return 0<n&&(n=1/he(n),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n),e}function G(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function V(e,t,r){var a=t[0],o=t[1],n=t[2],i=r[0],s=r[1],l=r[2];return e[0]=o*l-n*s,e[1]=n*i-a*l,e[2]=a*s-o*i,e}function X(e,t,a,o){var n=[],i=[];return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],i[0]=n[0],i[1]=n[1]*ge(o)-n[2]*fe(o),i[2]=n[1]*fe(o)+n[2]*ge(o),e[0]=i[0]+a[0],e[1]=i[1]+a[1],e[2]=i[2]+a[2],e}function Y(e,t,a,o){var n=[],i=[];return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],i[0]=n[2]*fe(o)+n[0]*ge(o),i[1]=n[1],i[2]=n[2]*ge(o)-n[0]*fe(o),e[0]=i[0]+a[0],e[1]=i[1]+a[1],e[2]=i[2]+a[2],e}function W(e,t,a,o){var n=[],i=[];return n[0]=t[0]-a[0],n[1]=t[1]-a[1],n[2]=t[2]-a[2],i[0]=n[0]*ge(o)-n[1]*fe(o),i[1]=n[0]*fe(o)+n[1]*ge(o),i[2]=n[2],e[0]=i[0]+a[0],e[1]=i[1]+a[1],e[2]=i[2]+a[2],e}function z(){var e=new be(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function j(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function K(e,t,r){var a=t[0],o=t[1],n=t[2],i=t[3];return e[0]=r[0]*a+r[4]*o+r[8]*n+r[12]*i,e[1]=r[1]*a+r[5]*o+r[9]*n+r[13]*i,e[2]=r[2]*a+r[6]*o+r[10]*n+r[14]*i,e[3]=r[3]*a+r[7]*o+r[11]*n+r[15]*i,e}function Q(){var e=new be(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function q(e,t,r){r*=.5;var a=fe(r);return e[0]=a*t[0],e[1]=a*t[1],e[2]=a*t[2],e[3]=ge(r),e}function J(e,r,a,o){var t=Math.acos,n=r[0],i=r[1],s=r[2],l=r[3],d=a[0],c=a[1],u=a[2],p=a[3],m,f,g,y,h;return f=n*d+i*c+s*u+l*p,0>f&&(f=-f,d=-d,c=-c,u=-u,p=-p),1e-6<1-f?(m=t(f),g=fe(m),y=fe((1-o)*m)/g,h=fe(o*m)/g):(y=1-o,h=o),e[0]=y*n+h*d,e[1]=y*i+h*c,e[2]=y*s+h*u,e[3]=y*l+h*p,e}function $(e,t){var r=t[0]+t[4]+t[8],a;if(0<r)a=he(r+1),e[3]=.5*a,a=.5/a,e[0]=(t[5]-t[7])*a,e[1]=(t[6]-t[2])*a,e[2]=(t[1]-t[3])*a;else{var o=0;t[4]>t[0]&&(o=1),t[8]>t[3*o+o]&&(o=2);var n=(o+1)%3,s=(o+2)%3;a=he(t[3*o+o]-t[3*n+n]-t[3*s+s]+1),e[o]=.5*a,a=.5/a,e[3]=(t[3*n+s]-t[3*s+n])*a,e[n]=(t[3*n+o]+t[3*o+n])*a,e[s]=(t[3*s+o]+t[3*o+s])*a}return e}function ee(e,t,r,a){var o=.5*me/180;t*=o,r*=o,a*=o;var n=fe(t),i=ge(t),s=fe(r),l=ge(r),d=fe(a),c=ge(a);return e[0]=n*l*c-i*s*d,e[1]=i*s*c+n*l*d,e[2]=i*l*d-n*s*c,e[3]=i*l*c+n*s*d,e}function te(){var e=new be(2);return e[0]=0,e[1]=0,e}(function d(c,e,t){function r(i,o){if(!e[i]){if(!c[i]){var s="function"==typeof require&&require;if(!o&&s)return s(i,!0);if(n)return n(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var u=e[i]={exports:{}};c[i][0].call(u.exports,function(t){var e=c[i][1][t];return r(e?e:t)},u,u.exports,d,c,e,t)}return e[i].exports}for(var n="function"==typeof require&&require,a=0;a<t.length;a++)r(t[a]);return r})({1:[function(e){(function(t){function r(e,t,r){e[t]||Object.defineProperty(e,t,{writable:!0,configurable:!0,value:r})}if(e(327),e(328),e(2),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;r(String.prototype,"padLeft","".padStart),r(String.prototype,"padRight","".padEnd),["pop","reverse","shift","keys","values","entries","indexOf","every","some","forEach","map","filter","find","findIndex","includes","join","slice","concat","push","splice","unshift","sort","lastIndexOf","reduce","reduceRight","copyWithin","fill"].forEach(function(e){[][e]&&r(Array,e,Function.call.bind([][e]))})}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{2:2,327:327,328:328}],2:[function(e,t){e(130),t.exports=e(23).RegExp.escape},{130:130,23:23}],3:[function(e,t){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],4:[function(e,t){var r=e(18);t.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},{18:18}],5:[function(e,t){var r=e(128)("unscopables"),a=Array.prototype;a[r]==null&&e(42)(a,r,{}),t.exports=function(e){a[r][e]=!0}},{128:128,42:42}],6:[function(e,t){t.exports=function(e,t,r,a){if(!(e instanceof t)||a!==void 0&&a in e)throw TypeError(r+": incorrect invocation!");return e}},{}],7:[function(e,t){var r=e(51);t.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},{51:51}],8:[function(e,t){var r=e(119),a=e(114),o=e(118);t.exports=[].copyWithin||function(e,t){var n=r(this),i=o(n.length),s=a(e,i),l=a(t,i),d=2<arguments.length?arguments[2]:void 0,c=pe((d===void 0?i:a(d,i))-l,i-s),u=1;for(l<s&&s<l+c&&(u=-1,l+=c-1,s+=c-1);0<c--;)l in n?n[s]=n[l]:delete n[s],s+=u,l+=u;return n}},{114:114,118:118,119:119}],9:[function(e,t){var r=e(119),a=e(114),o=e(118);t.exports=function(e){for(var t=r(this),n=o(t.length),i=arguments.length,s=a(1<i?arguments[1]:void 0,n),l=2<i?arguments[2]:void 0,d=void 0===l?n:a(l,n);d>s;)t[s++]=e;return t}},{114:114,118:118,119:119}],10:[function(e,t){var r=e(39);t.exports=function(e,t){var a=[];return r(e,!1,a.push,a,t),a}},{39:39}],11:[function(e,t){var r=e(117),a=e(118),o=e(114);t.exports=function(e){return function(t,n,i){var s=r(t),l=a(s.length),d=o(i,l),c;if(e&&n!=n){for(;l>d;)if(c=s[d++],c!=c)return!0;}else for(;l>d;d++)if((e||d in s)&&s[d]===n)return e||d||0;return!e&&-1}}},{114:114,117:117,118:118}],12:[function(e,t){var r=e(25),a=e(47),o=e(119),n=e(118),i=e(15);t.exports=function(e,t){var s=1==e,l=4==e,d=6==e,c=t||i;return function(t,i,u){for(var p=o(t),m=a(p),g=r(i,u,3),f=n(m.length),y=0,h=s?c(t,f):2==e?c(t,0):void 0,v,x;f>y;y++)if((5==e||d||y in m)&&(v=m[y],x=g(v,y,p),e))if(s)h[y]=x;else if(x)switch(e){case 3:return!0;case 5:return v;case 6:return y;case 2:h.push(v);}else if(l)return!1;return d?-1:3==e||l?l:h}}},{118:118,119:119,15:15,25:25,47:47}],13:[function(e,t){var r=e(3),a=e(119),o=e(47),n=e(118);t.exports=function(e,t,s,l,d){r(t);var c=a(e),u=o(c),p=n(c.length),m=d?p-1:0,f=d?-1:1;if(2>s)for(;;){if(m in u){l=u[m],m+=f;break}if(m+=f,d?0>m:p<=m)throw TypeError("Reduce of empty array with no initial value")}for(;d?0<=m:p>m;m+=f)m in u&&(l=t(l,u[m],m,c));return l}},{118:118,119:119,3:3,47:47}],14:[function(e,t){var r=e(51),a=e(49),o=e(128)("species");t.exports=function(e){var t;return a(e)&&(t=e.constructor,"function"==typeof t&&(t===Array||a(t.prototype))&&(t=void 0),r(t)&&(t=t[o],null===t&&(t=void 0))),void 0===t?Array:t}},{128:128,49:49,51:51}],15:[function(e,t){var r=e(14);t.exports=function(e,t){return new(r(e))(t)}},{14:14}],16:[function(e,t){var r=e(3),a=e(51),o=e(46),n=[].slice,s={},l=function(e,t,r){if(!(t in s)){for(var a=[],o=0;o<t;o++)a[o]="a["+o+"]";s[t]=Function("F,a","return new F("+a.join(",")+")")}return s[t](e,r)};t.exports=Function.bind||function(e){var t=r(this),i=n.call(arguments,1),s=function r(){var a=i.concat(n.call(arguments));return this instanceof r?l(t,a.length,a):o(t,a,e)};return a(t.prototype)&&(s.prototype=t.prototype),s}},{3:3,46:46,51:51}],17:[function(e,t){var r=e(18),a=e(128)("toStringTag"),o="Arguments"==r(function(){return arguments}()),n=function(e,t){try{return e[t]}catch(t){}};t.exports=function(e){var t,i,s;return e===void 0?"Undefined":null===e?"Null":"string"==typeof(i=n(t=Object(e),a))?i:o?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},{128:128,18:18}],18:[function(e,t){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],19:[function(e,t){var r=e(72).f,a=e(71),o=e(93),n=e(25),i=e(6),s=e(39),l=e(55),d=e(57),c=e(100),u=e(29),p=e(66).fastKey,m=e(125),f=u?"_s":"size",g=function(e,t){var r=p(t),a;if("F"!==r)return e._i[r];for(a=e._f;a;a=a.n)if(a.k==t)return a};t.exports={getConstructor:function(e,t,l,d){var c=e(function(e,r){i(e,c,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[f]=0,null!=r&&s(r,l,e[d],e)});return o(c.prototype,{clear:function(){for(var e=m(this,t),r=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete r[a.i];e._f=e._l=void 0,e[f]=0},delete:function(e){var r=m(this,t),a=g(r,e);if(a){var o=a.n,n=a.p;delete r._i[a.i],a.r=!0,n&&(n.n=o),o&&(o.p=n),r._f==a&&(r._f=o),r._l==a&&(r._l=n),r[f]--}return!!a},forEach:function(e){m(this,t);for(var r=n(e,1<arguments.length?arguments[1]:void 0,3),a;a=a?a.n:this._f;)for(r(a.v,a.k,this);a&&a.r;)a=a.p},has:function(e){return!!g(m(this,t),e)}}),u&&r(c.prototype,"size",{get:function(){return m(this,t)[f]}}),c},def:function(e,t,r){var a=g(e,t),o,n;return a?a.v=r:(e._l=a={i:n=p(t,!0),k:t,v:r,p:o=e._l,n:void 0,r:!1},!e._f&&(e._f=a),o&&(o.n=a),e[f]++,"F"!==n&&(e._i[n]=a)),e},getEntry:g,setStrong:function(e,t,r){l(e,t,function(e,r){this._t=m(e,t),this._k=r,this._l=void 0},function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?"keys"==t?d(0,r.k):"values"==t?d(0,r.v):d(0,[r.k,r.v]):(e._t=void 0,d(1))},r?"entries":"values",!r,!0),c(t)}}},{100:100,125:125,25:25,29:29,39:39,55:55,57:57,6:6,66:66,71:71,72:72,93:93}],20:[function(e,t){var r=e(17),a=e(10);t.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},{10:10,17:17}],21:[function(e,t){var r=e(93),a=e(66).getWeak,o=e(7),n=e(51),i=e(6),s=e(39),l=e(12),d=e(41),c=e(125),u=l(5),p=l(6),m=0,f=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},y=function(e,t){return u(e.a,function(e){return e[0]===t})};g.prototype={get:function(e){var t=y(this,e);if(t)return t[1]},has:function(e){return!!y(this,e)},set:function(e,t){var r=y(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=p(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},t.exports={getConstructor:function(e,t,o,l){var u=e(function(e,r){i(e,u,t,"_i"),e._t=t,e._i=m++,e._l=void 0,null!=r&&s(r,o,e[l],e)});return r(u.prototype,{delete:function(e){if(!n(e))return!1;var r=a(e);return!0===r?f(c(this,t))["delete"](e):r&&d(r,this._i)&&delete r[this._i]},has:function(e){if(!n(e))return!1;var r=a(e);return!0===r?f(c(this,t)).has(e):r&&d(r,this._i)}}),u},def:function(e,t,r){var n=a(o(t),!0);return!0===n?f(e).set(t,r):n[e._i]=r,e},ufstore:f}},{12:12,125:125,39:39,41:41,51:51,6:6,66:66,7:7,93:93}],22:[function(e,t){var r=e(40),a=e(33),o=e(94),n=e(93),i=e(66),s=e(39),l=e(6),d=e(51),c=e(35),u=e(56),p=e(101),m=e(45);t.exports=function(e,t,f,g,y,h){var v=r[e],x=v,_=y?"set":"add",b=x&&x.prototype,S={},E=function(e){var t=b[e];o(b,e,"delete"==e?function(e){return(!h||d(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return(!h||d(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return h&&!d(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"!=typeof x||!(h||b.forEach&&!c(function(){new x().entries().next()})))x=g.getConstructor(t,e,y,_),n(x.prototype,f),i.NEED=!0;else{var A=new x,T=A[_](h?{}:-0,1)!=A,k=c(function(){A.has(1)}),B=u(function(e){new x(e)}),O=!h&&c(function(){for(var e=new x,t=5;t--;)e[_](t,t);return!e.has(-0)});B||(x=t(function(t,r){l(t,x,e);var a=m(new v,t,x);return null!=r&&s(r,y,a[_],a),a}),x.prototype=b,b.constructor=x),(k||O)&&(E("delete"),E("has"),y&&E("get")),(O||T)&&E(_),h&&b.clear&&delete b.clear}return p(x,e),S[e]=x,a(a.G+a.W+a.F*(x!=v),S),h||g.setStrong(x,e,y),x}},{101:101,33:33,35:35,39:39,40:40,45:45,51:51,56:56,6:6,66:66,93:93,94:94}],23:[function(e,t){var r=t.exports={version:"2.5.0"};"number"==typeof __e&&(__e=r)},{}],24:[function(e,t){var r=e(72),a=e(92);t.exports=function(e,t,o){t in e?r.f(e,t,a(0,o)):e[t]=o}},{72:72,92:92}],25:[function(e,t){var r=e(3);t.exports=function(e,t,a){return(r(e),void 0===t)?e:1===a?function(r){return e.call(t,r)}:2===a?function(r,a){return e.call(t,r,a)}:3===a?function(r,a,o){return e.call(t,r,a,o)}:function(){return e.apply(t,arguments)}}},{3:3}],26:[function(e,t){var r=e(35),a=Date.prototype.getTime,o=Date.prototype.toISOString,n=function(e){return 9<e?e:"0"+e};t.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(a.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),o=0>t?"-":9999<t?"+":"";return o+("00000"+ye(t)).slice(o?-6:-4)+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+(99<r?r:"0"+n(r))+"Z"}:o},{35:35}],27:[function(e,t){var r=e(7),a=e(120),o="number";t.exports=function(e){if("string"!==e&&e!==o&&"default"!==e)throw TypeError("Incorrect hint");return a(r(this),e!=o)}},{120:120,7:7}],28:[function(e,t){t.exports=function(e){if(e==null)throw TypeError("Can't call method on  "+e);return e}},{}],29:[function(e,t){t.exports=!e(35)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{35:35}],30:[function(e,t){var r=e(51),a=e(40).document,o=r(a)&&r(a.createElement);t.exports=function(e){return o?a.createElement(e):{}}},{40:40,51:51}],31:[function(e,t){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],32:[function(e,t){var r=e(81),a=e(78),o=e(82);t.exports=function(e){var t=r(e),n=a.f;if(n)for(var s=n(e),l=o.f,d=0,c;s.length>d;)l.call(e,c=s[d++])&&t.push(c);return t}},{78:78,81:81,82:82}],33:[function(e,t){var r=e(40),a=e(23),o=e(42),n=e(94),i=e(25),s="prototype",l=function e(t,l,d){var c=t&e.F,u=t&e.G,p=t&e.S,m=t&e.P,f=t&e.B,g=u?r:p?r[l]||(r[l]={}):(r[l]||{})[s],y=u?a:a[l]||(a[l]={}),h=y[s]||(y[s]={}),v,x,_,b;for(v in u&&(d=l),d)x=!c&&g&&void 0!==g[v],_=(x?g:d)[v],b=f&&x?i(_,r):m&&"function"==typeof _?i(Function.call,_):_,g&&n(g,v,_,t&e.U),y[v]!=_&&o(y,v,b),m&&h[v]!=_&&(h[v]=_)};r.core=a,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},{23:23,25:25,40:40,42:42,94:94}],34:[function(e,t){var r=e(128)("match");t.exports=function(e){var t=/./;try{"/./"[e](t)}catch(a){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},{128:128}],35:[function(e,t){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],36:[function(e,t){var r=e(42),a=e(94),o=e(35),n=e(28),i=e(128);t.exports=function(e,t,s){var l=i(e),d=s(n,l,""[e]),c=d[0],u=d[1];o(function(){var t={};return t[l]=function(){return 7},7!=""[e](t)})&&(a(String.prototype,e,c),r(RegExp.prototype,l,2==t?function(e,t){return u.call(e,this,t)}:function(e){return u.call(e,this)}))}},{128:128,28:28,35:35,42:42,94:94}],37:[function(e,t){var r=e(7);t.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},{7:7}],38:[function(e,t){function r(e,t,l,d,c,u,p,m){for(var f=c,g=0,y=!!p&&i(p,m,3),h,v;g<d;){if(g in l){if(h=y?y(l[g],g,t):l[g],v=!1,o(h)&&(v=h[s],v=void 0===v?a(h):!!v),v&&0<u)f=r(e,t,h,n(h.length),f,u-1)-1;else{if(9007199254740991<=f)throw TypeError();e[f]=h}f++}g++}return f}var a=e(49),o=e(51),n=e(118),i=e(25),s=e(128)("isConcatSpreadable");t.exports=r},{118:118,128:128,25:25,49:49,51:51}],39:[function(e,t,r){var a=e(25),o=e(53),n=e(48),i=e(7),s=e(118),l=e(129),d={},c={},r=t.exports=function(e,t,r,u,p){var m=p?function(){return e}:l(e),g=a(r,u,t?2:1),f=0,y,h,v,x;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(n(m)){for(y=s(e.length);y>f;f++)if(x=t?g(i(h=e[f])[0],h[1]):g(e[f]),x===d||x===c)return x;}else for(v=m.call(e);!(h=v.next()).done;)if(x=o(v,g,h.value,t),x===d||x===c)return x};r.BREAK=d,r.RETURN=c},{118:118,129:129,25:25,48:48,53:53,7:7}],40:[function(e,t){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],41:[function(e,t){var r={}.hasOwnProperty;t.exports=function(e,t){return r.call(e,t)}},{}],42:[function(e,t){var r=e(72),a=e(92);t.exports=e(29)?function(e,t,o){return r.f(e,t,a(1,o))}:function(e,t,r){return e[t]=r,e}},{29:29,72:72,92:92}],43:[function(e,t){var r=e(40).document;t.exports=r&&r.documentElement},{40:40}],44:[function(e,t){t.exports=!e(29)&&!e(35)(function(){return 7!=Object.defineProperty(e(30)("div"),"a",{get:function(){return 7}}).a})},{29:29,30:30,35:35}],45:[function(e,t){var r=e(51),a=e(99).set;t.exports=function(e,t,o){var n=t.constructor,i;return n!==o&&"function"==typeof n&&(i=n.prototype)!==o.prototype&&r(i)&&a&&a(e,i),e}},{51:51,99:99}],46:[function(e,t){t.exports=function(e,t,r){var a=r===void 0;switch(t.length){case 0:return a?e():e.call(r);case 1:return a?e(t[0]):e.call(r,t[0]);case 2:return a?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return a?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return a?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3]);}return e.apply(r,t)}},{}],47:[function(e,t){var r=e(18);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},{18:18}],48:[function(e,t){var r=e(58),a=e(128)("iterator"),o=Array.prototype;t.exports=function(e){return e!==void 0&&(r.Array===e||o[a]===e)}},{128:128,58:58}],49:[function(e,t){var r=e(18);t.exports=Array.isArray||function(e){return"Array"==r(e)}},{18:18}],50:[function(e,t){var r=e(51);t.exports=function(e){return!r(e)&&isFinite(e)&&ue(e)===e}},{51:51}],51:[function(t,r){r.exports=function(t){return"object"===e(t)?null!==t:"function"==typeof t}},{}],52:[function(e,t){var r=e(51),a=e(18),o=e(128)("match");t.exports=function(e){var t;return r(e)&&((t=e[o])===void 0?"RegExp"==a(e):!!t)}},{128:128,18:18,51:51}],53:[function(e,t){var r=e(7);t.exports=function(t,a,e,o){try{return o?a(r(e)[0],e[1]):a(e)}catch(a){var n=t["return"];throw void 0!==n&&r(n.call(t)),a}}},{7:7}],54:[function(e,t){var r=e(71),a=e(92),o=e(101),n={};e(42)(n,e(128)("iterator"),function(){return this}),t.exports=function(e,t,i){e.prototype=r(n,{next:a(1,i)}),o(e,t+" Iterator")}},{101:101,128:128,42:42,71:71,92:92}],55:[function(e,t){var r=e(60),a=e(33),o=e(94),n=e(42),i=e(41),s=e(58),l=e(54),d=e(101),c=e(79),u=e(128)("iterator"),p=!([].keys&&"next"in[].keys()),m="keys",f="values",g=function(){return this};t.exports=function(e,t,y,h,v,x,_){l(y,t,h);var b=function(e){return!p&&e in T?T[e]:e===m?function(){return new y(this,e)}:e===f?function(){return new y(this,e)}:function(){return new y(this,e)}},S=t+" Iterator",E=v==f,A=!1,T=e.prototype,k=T[u]||T["@@iterator"]||v&&T[v],B=k||b(v),O=v?E?b("entries"):B:void 0,w="Array"==t?T.entries||k:k,I,C,M;if(w&&(M=c(w.call(new e)),M!==Object.prototype&&M.next&&(d(M,S,!0),!r&&!i(M,u)&&n(M,u,g))),E&&k&&k.name!==f&&(A=!0,B=function(){return k.call(this)}),(!r||_)&&(p||A||!T[u])&&n(T,u,B),s[t]=B,s[S]=g,v)if(I={values:E?B:b(f),keys:x?B:b(m),entries:O},_)for(C in I)C in T||o(T,C,I[C]);else a(a.P+a.F*(p||A),t,I);return I}},{101:101,128:128,33:33,41:41,42:42,54:54,58:58,60:60,79:79,94:94}],56:[function(e,t){var r=e(128)("iterator"),a=!1;try{var o=[7][r]();o["return"]=function(){a=!0}}catch(t){}t.exports=function(e,t){if(!t&&!a)return!1;var o=!1;try{var n=[7],i=n[r]();i.next=function(){return{done:o=!0}},n[r]=function(){return i},e(n)}catch(t){}return o}},{128:128}],57:[function(e,t){t.exports=function(e,t){return{value:t,done:!!e}}},{}],58:[function(e,t){t.exports={}},{}],59:[function(e,t){var r=e(81),a=e(117);t.exports=function(e,t){for(var o=a(e),n=r(o),i=n.length,s=0,l;i>s;)if(o[l=n[s++]]===t)return l}},{117:117,81:81}],60:[function(e,t){t.exports=!1},{}],61:[function(e,t){var r=ce;t.exports=!r||22025.465794806718<r(10)||22025.465794806718>r(10)||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:-1e-6<e&&1e-6>e?e+e*e/2:de(e)-1}:r},{}],62:[function(e,t){var r=e(65),a=le,o=a(2,-52),n=a(2,-23),i=a(2,127)*(2-n),s=a(2,-126),l=function(e){return e+1/o-1/o};t.exports=Math.fround||function(e){var t=ye(e),d=r(e),c,u;return t<s?d*l(t/s/n)*s*n:(c=(1+n/o)*t,u=c-(c-t),u>i||u!=u?d*(1/0):d*u)}},{65:65}],63:[function(e,t){t.exports=Math.log1p||function(e){return-1e-8<(e=+e)&&1e-8>e?e-e*e/2:se(1+e)}},{}],64:[function(e,t){t.exports=Math.scale||function(e,t,r,a,o){return 0===arguments.length||e!=e||t!=t||r!=r||a!=a||o!=o?NaN:e===1/0||e===-Infinity?e:(e-t)*(o-a)/(r-t)+a}},{}],65:[function(e,t){t.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:0>e?-1:1}},{}],66:[function(t,r){var a=t(124)("meta"),o=t(51),n=t(41),i=t(72).f,s=0,l=Object.isExtensible||function(){return!0},d=!t(35)(function(){return l(Object.preventExtensions({}))}),c=function(e){i(e,a,{value:{i:"O"+ ++s,w:{}}})},u=function(t,r){if(!o(t))return"symbol"==e(t)?t:("string"==typeof t?"S":"P")+t;if(!n(t,a)){if(!l(t))return"F";if(!r)return"E";c(t)}return t[a].i},p=r.exports={KEY:a,NEED:!1,fastKey:u,getWeak:function(e,t){if(!n(e,a)){if(!l(e))return!0;if(!t)return!1;c(e)}return e[a].w},onFreeze:function(e){return d&&p.NEED&&l(e)&&!n(e,a)&&c(e),e}}},{124:124,35:35,41:41,51:51,72:72}],67:[function(t,r){var a=t(160),o=t(33),n=t(103)("metadata"),i=n.store||(n.store=new(t(266))),s=function(e,t,r){var o=i.get(e);if(!o){if(!r)return;i.set(e,o=new a)}var n=o.get(t);if(!n){if(!r)return;o.set(t,n=new a)}return n},l=function(t){return t===void 0||"symbol"==e(t)?t:t+""};r.exports={store:i,map:s,has:function(e,t,r){var a=s(t,r,!1);return a!==void 0&&a.has(e)},get:function(e,t,r){var a=s(t,r,!1);return a===void 0?void 0:a.get(e)},set:function(e,t,r,a){s(r,a,!0).set(e,t)},keys:function(e,t){var r=s(e,t,!1),a=[];return r&&r.forEach(function(e,t){a.push(t)}),a},key:l,exp:function(e){o(o.S,"Reflect",e)}}},{103:103,160:160,266:266,33:33}],68:[function(e,t){var r=e(40),a=e(113).set,o=r.MutationObserver||r.WebKitMutationObserver,n=r.process,i=r.Promise,s="process"==e(18)(n);t.exports=function(){var e=function(){var e,r;for(s&&(e=n.domain)&&e.exit();t;){r=t.fn,t=t.next;try{r()}catch(r){throw t?d():l=void 0,r}}l=void 0,e&&e.enter()},t,l,d;if(s)d=function(){n.nextTick(e)};else if(o){var c=!0,u=document.createTextNode("");new o(e).observe(u,{characterData:!0}),d=function(){u.data=c=!c}}else if(i&&i.resolve){var p=i.resolve();d=function(){p.then(e)}}else d=function(){a.call(r,e)};return function(e){var r={fn:e,next:void 0};l&&(l.next=r),t||(t=r,d()),l=r}}},{113:113,18:18,40:40}],69:[function(e,t){function r(e){var t,r;this.promise=new e(function(e,a){if(t!==void 0||r!==void 0)throw TypeError("Bad Promise constructor");t=e,r=a}),this.resolve=a(t),this.reject=a(r)}var a=e(3);t.exports.f=function(e){return new r(e)}},{3:3}],70:[function(e,t){var r=e(81),a=e(78),o=e(82),n=e(119),i=e(47),s=Object.assign;t.exports=!s||e(35)(function(){var e={},t={},r=Symbol(),a="abcdefghijklmnopqrst";return e[r]=7,a.split("").forEach(function(e){t[e]=e}),7!=s({},e)[r]||Object.keys(s({},t)).join("")!=a})?function(e){for(var t=n(e),s=arguments.length,l=1,d=a.f,c=o.f;s>l;)for(var u=i(arguments[l++]),p=d?r(u).concat(d(u)):r(u),m=p.length,f=0,g;m>f;)c.call(u,g=p[f++])&&(t[g]=u[g]);return t}:s},{119:119,35:35,47:47,78:78,81:81,82:82}],71:[function(e,t){var r=e(7),a=e(73),o=e(31),n=e(102)("IE_PROTO"),i=function(){},s="prototype",l=function(){var t=e(30)("iframe"),r=o.length,a="<",n=">",d;for(t.style.display="none",e(43).appendChild(t),t.src="javascript:",d=t.contentWindow.document,d.open(),d.write(a+"script"+n+"document.F=Object"+a+"/script"+n),d.close(),l=d.F;r--;)delete l[s][o[r]];return l()};t.exports=Object.create||function(e,t){var o;return null===e?o=l():(i[s]=r(e),o=new i,i[s]=null,o[n]=e),void 0===t?o:a(o,t)}},{102:102,30:30,31:31,43:43,7:7,73:73}],72:[function(e,t,r){var a=e(7),o=e(44),n=e(120),i=Object.defineProperty;r.f=e(29)?Object.defineProperty:function(e,t,r){if(a(e),t=n(t,!0),a(r),o)try{return i(e,t,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},{120:120,29:29,44:44,7:7}],73:[function(e,t){var r=e(72),a=e(7),o=e(81);t.exports=e(29)?Object.defineProperties:function(e,t){a(e);for(var n=o(t),s=n.length,l=0,d;s>l;)r.f(e,d=n[l++],t[d]);return e}},{29:29,7:7,72:72,81:81}],74:[function(e,t){t.exports=e(60)||!e(35)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete e(40)[t]})},{35:35,40:40,60:60}],75:[function(e,t,r){var a=e(82),o=e(92),n=e(117),i=e(120),s=e(41),l=e(44),d=Object.getOwnPropertyDescriptor;r.f=e(29)?d:function(e,t){if(e=n(e),t=i(t,!0),l)try{return d(e,t)}catch(t){}return s(e,t)?o(!a.f.call(e,t),e[t]):void 0}},{117:117,120:120,29:29,41:41,44:44,82:82,92:92}],76:[function(t,r){var a=t(117),o=t(77).f,n={}.toString,i="object"==("undefined"==typeof window?"undefined":e(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return o(e)}catch(t){return i.slice()}};r.exports.f=function(e){return i&&"[object Window]"==n.call(e)?s(e):o(a(e))}},{117:117,77:77}],77:[function(e,t,r){var a=e(80),o=e(31).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return a(e,o)}},{31:31,80:80}],78:[function(e,t,r){r.f=Object.getOwnPropertySymbols},{}],79:[function(e,t){var r=e(41),a=e(119),o=e(102)("IE_PROTO"),n=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=a(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?n:null}},{102:102,119:119,41:41}],80:[function(e,t){var r=e(41),a=e(117),o=e(11)(!1),n=e(102)("IE_PROTO");t.exports=function(e,t){var s=a(e),l=0,d=[],c;for(c in s)c!=n&&r(s,c)&&d.push(c);for(;t.length>l;)r(s,c=t[l++])&&(~o(d,c)||d.push(c));return d}},{102:102,11:11,117:117,41:41}],81:[function(e,t){var r=e(80),a=e(31);t.exports=Object.keys||function(e){return r(e,a)}},{31:31,80:80}],82:[function(e,t,r){r.f={}.propertyIsEnumerable},{}],83:[function(e,t){var r=e(33),a=e(23),o=e(35);t.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],i={};i[e]=t(n),r(r.S+r.F*o(function(){n(1)}),"Object",i)}},{23:23,33:33,35:35}],84:[function(e,t){var r=e(81),a=e(117),o=e(82).f;t.exports=function(e){return function(t){for(var n=a(t),s=r(n),l=s.length,d=0,c=[],u;l>d;)o.call(n,u=s[d++])&&c.push(e?[u,n[u]]:n[u]);return c}}},{117:117,81:81,82:82}],85:[function(e,t){var r=e(77),a=e(78),o=e(7),n=e(40).Reflect;t.exports=n&&n.ownKeys||function(e){var t=r.f(o(e)),n=a.f;return n?t.concat(n(e)):t}},{40:40,7:7,77:77,78:78}],86:[function(e,t){var r=e(40).parseFloat,a=e(111).trim;t.exports=1/r(e(112)+"-0")==-Infinity?r:function(e){var t=a(e+"",3),o=r(t);return 0===o&&"-"==t.charAt(0)?-0:o}},{111:111,112:112,40:40}],87:[function(e,t){var r=e(40).parseInt,a=e(111).trim,o=e(112),n=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(e,t){var o=a(e+"",3);return r(o,t>>>0||(n.test(o)?16:10))}:r},{111:111,112:112,40:40}],88:[function(e,t){var r=e(89),a=e(46),o=e(3);t.exports=function(){for(var e=o(this),t=arguments.length,n=Array(t),s=0,l=r._,d=!1;t>s;)(n[s]=arguments[s++])===l&&(d=!0);return function(){var r=this,o=arguments.length,i=0,s=0,c;if(!d&&!o)return a(e,n,r);if(c=n.slice(),d)for(;t>i;i++)c[i]===l&&(c[i]=arguments[s++]);for(;o>s;)c.push(arguments[s++]);return a(e,c,r)}}},{3:3,46:46,89:89}],89:[function(e,t){t.exports=e(40)},{40:40}],90:[function(e,t){t.exports=function(e){try{return{e:!1,v:e()}}catch(t){return{e:!0,v:t}}}},{}],91:[function(e,t){var r=e(69);t.exports=function(e,t){var a=r.f(e),o=a.resolve;return o(t),a.promise}},{69:69}],92:[function(e,t){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],93:[function(e,t){var r=e(94);t.exports=function(e,t,a){for(var o in t)r(e,o,t[o],a);return e}},{94:94}],94:[function(e,t){var r=e(40),a=e(42),o=e(41),n=e(124)("src"),i="toString",s=Function[i],l=(""+s).split(i);e(23).inspectSource=function(e){return s.call(e)},(t.exports=function(e,t,i,s){var d="function"==typeof i;d&&(o(i,"name")||a(i,"name",t));e[t]===i||(d&&(o(i,n)||a(i,n,e[t]?""+e[t]:l.join(t+""))),e===r?e[t]=i:s?e[t]?e[t]=i:a(e,t,i):(delete e[t],a(e,t,i)))})(Function.prototype,i,function(){return"function"==typeof this&&this[n]||s.call(this)})},{124:124,23:23,40:40,41:41,42:42}],95:[function(e,t){t.exports=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return(t+"").replace(e,r)}}},{}],96:[function(e,t){t.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},{}],97:[function(e,t){var r=e(33),a=e(3),o=e(25),i=e(39);t.exports=function(e){r(r.S,e,{from:function(e){var t=arguments[1],r,s,l,d;return(a(this),r=void 0!==t,r&&a(t),null==e)?new this:(s=[],r?(l=0,d=o(t,arguments[2],2),i(e,!1,function(e){s.push(d(e,l++))})):i(e,!1,s.push,s),new this(s))}})}},{25:25,3:3,33:33,39:39}],98:[function(e,t){var r=e(33);t.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},{33:33}],99:[function(e,t){var r=e(51),a=e(7),o=function(e,t){if(a(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,r,a){try{a=e(25)(Function.call,e(75).f(Object.prototype,"__proto__").set,2),a(t,[]),r=!(t instanceof Array)}catch(t){r=!0}return function(e,t){return o(e,t),r?e.__proto__=t:a(e,t),e}}({},!1):void 0),check:o}},{25:25,51:51,7:7,75:75}],100:[function(e,t){var r=e(40),a=e(72),o=e(29),n=e(128)("species");t.exports=function(e){var t=r[e];o&&t&&!t[n]&&a.f(t,n,{configurable:!0,get:function(){return this}})}},{128:128,29:29,40:40,72:72}],101:[function(e,t){var r=e(72).f,a=e(41),o=e(128)("toStringTag");t.exports=function(e,t,n){e&&!a(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},{128:128,41:41,72:72}],102:[function(e,t){var r=e(103)("keys"),a=e(124);t.exports=function(e){return r[e]||(r[e]=a(e))}},{103:103,124:124}],103:[function(e,t){var r=e(40),a="__core-js_shared__",o=r[a]||(r[a]={});t.exports=function(e){return o[e]||(o[e]={})}},{40:40}],104:[function(e,t){var r=e(7),a=e(3),o=e(128)("species");t.exports=function(e,t){var n=r(e).constructor,i;return n===void 0||(i=r(n)[o])==null?t:a(i)}},{128:128,3:3,7:7}],105:[function(e,t){var r=e(35);t.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},{35:35}],106:[function(e,t){var r=e(116),o=e(28);t.exports=function(e){return function(t,n){var d=o(t)+"",s=r(n),i=d.length,l,c;return 0>s||s>=i?e?"":void 0:(l=d.charCodeAt(s),55296>l||56319<l||s+1===i||56320>(c=d.charCodeAt(s+1))||57343<c?e?d.charAt(s):l:e?d.slice(s,s+2):(l-55296<<10)+(c-56320)+65536)}}},{116:116,28:28}],107:[function(e,t){var r=e(52),a=e(28);t.exports=function(e,t,o){if(r(t))throw TypeError("String#"+o+" doesn't accept regex!");return a(e)+""}},{28:28,52:52}],108:[function(e,t){var r=e(33),a=e(35),o=e(28),n=/"/g,i=function(e,t,r,a){var i=o(e)+"",s="<"+t;return""!==r&&(s+=" "+r+"=\""+(a+"").replace(n,"&quot;")+"\""),s+">"+i+"</"+t+">"};t.exports=function(e,t){var o={};o[e]=t(i),r(r.P+r.F*a(function(){var t=""[e]("\"");return t!==t.toLowerCase()||3<t.split("\"").length}),"String",o)}},{28:28,33:33,35:35}],109:[function(e,t){var r=e(118),a=e(110),o=e(28);t.exports=function(e,t,n,i){var s=o(e)+"",l=s.length,d=void 0===n?" ":n+"",c=r(t);if(c<=l||""==d)return s;var u=c-l,p=a.call(d,ie(u/d.length));return p.length>u&&(p=p.slice(0,u)),i?p+s:s+p}},{110:110,118:118,28:28}],110:[function(e,t){var r=e(116),a=e(28);t.exports=function(e){var t=a(this)+"",o="",i=r(e);if(0>i||i==1/0)throw RangeError("Count can't be negative");for(;0<i;(i>>>=1)&&(t+=t))1&i&&(o+=t);return o}},{116:116,28:28}],111:[function(e,t){var r=e(33),a=e(28),o=e(35),n=e(112),i="["+n+"]",s="\u200B\x85",l=RegExp("^"+i+i+"*"),d=RegExp(i+i+"*$"),c=function(e,t,a){var i={},l=o(function(){return!!n[e]()||s[e]()!=s}),d=i[e]=l?t(u):n[e];a&&(i[a]=d),r(r.P+r.F*l,"String",i)},u=c.trim=function(e,t){return e=a(e)+"",1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(d,"")),e};t.exports=c},{112:112,28:28,33:33,35:35}],112:[function(e,t){t.exports="\t\n\x0B\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF"},{}],113:[function(e,t){var r=e(25),a=e(46),o=e(43),n=e(30),i=e(40),s=i.process,l=i.setImmediate,d=i.clearImmediate,c=i.MessageChannel,u=i.Dispatch,p=0,m={},f="onreadystatechange",g=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},y=function(e){g.call(e.data)},h,v,x;l&&d||(l=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return m[++p]=function(){a("function"==typeof e?e:Function(e),t)},h(p),p},d=function(e){delete m[e]},"process"==e(18)(s)?h=function(e){s.nextTick(r(g,e,1))}:u&&u.now?h=function(e){u.now(r(g,e,1))}:c?(v=new c,x=v.port2,v.port1.onmessage=y,h=r(x.postMessage,x,1)):i.addEventListener&&"function"==typeof postMessage&&!i.importScripts?(h=function(e){i.postMessage(e+"","*")},i.addEventListener("message",y,!1)):f in n("script")?h=function(e){o.appendChild(n("script"))[f]=function(){o.removeChild(this),g.call(e)}}:h=function(e){setTimeout(r(g,e,1),0)}),t.exports={set:l,clear:d}},{18:18,25:25,30:30,40:40,43:43,46:46}],114:[function(e,t){var r=e(116);t.exports=function(e,t){return e=r(e),0>e?ne(e+t,0):pe(e,t)}},{116:116}],115:[function(e,t){var r=e(116),a=e(118);t.exports=function(e){if(e===void 0)return 0;var t=r(e),o=a(t);if(t!==o)throw RangeError("Wrong length!");return o}},{116:116,118:118}],116:[function(e,t){t.exports=function(e){return isNaN(e=+e)?0:(0<e?ue:ie)(e)}},{}],117:[function(e,t){var r=e(47),a=e(28);t.exports=function(e){return r(a(e))}},{28:28,47:47}],118:[function(e,t){var r=e(116);t.exports=function(e){return 0<e?pe(r(e),9007199254740991):0}},{116:116}],119:[function(e,t){var r=e(28);t.exports=function(e){return Object(r(e))}},{28:28}],120:[function(e,t){var r=e(51);t.exports=function(e,t){if(!r(e))return e;var a,o;if(t&&"function"==typeof(a=e.toString)&&!r(o=a.call(e)))return o;if("function"==typeof(a=e.valueOf)&&!r(o=a.call(e)))return o;if(!t&&"function"==typeof(a=e.toString)&&!r(o=a.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},{51:51}],121:[function(t,r){if(t(29)){var a=t(60),o=t(40),n=t(35),i=t(33),s=t(123),l=t(122),d=t(25),c=t(6),u=t(92),p=t(42),m=t(93),f=t(116),g=t(118),y=t(115),h=t(114),v=t(120),x=t(41),_=t(17),b=t(51),S=t(119),E=t(48),A=t(71),T=t(79),k=t(77).f,B=t(129),O=t(124),w=t(128),I=t(12),C=t(11),M=t(104),P=t(141),D=t(58),L=t(56),F=t(100),H=t(9),R=t(8),N=t(72),U=t(75),G=N.f,V=U.f,X=o.RangeError,Y=o.TypeError,W=o.Uint8Array,z="ArrayBuffer",j="Shared"+z,K="BYTES_PER_ELEMENT",Z="prototype",Q=Array[Z],q=l.ArrayBuffer,J=l.DataView,$=I(0),ee=I(2),te=I(3),re=I(4),ae=I(5),ne=I(6),ie=C(!0),se=C(!1),le=P.values,de=P.keys,ce=P.entries,pe=Q.lastIndexOf,me=Q.reduce,fe=Q.reduceRight,ge=Q.join,ye=Q.sort,he=Q.slice,ve=Q.toString,xe=Q.toLocaleString,_e=w("iterator"),be=w("toStringTag"),Se=O("typed_constructor"),Ee=O("def_constructor"),Ae=s.CONSTR,Te=s.TYPED,ke=s.VIEW,Be="Wrong length!",Oe=I(1,function(e,t){return Pe(M(e,e[Ee]),t)}),we=n(function(){return 1===new W(new Uint16Array([1]).buffer)[0]}),Ie=!!W&&!!W[Z].set&&n(function(){new W(1).set({})}),Ce=function(e,t){var r=f(e);if(0>r||r%t)throw X("Wrong offset!");return r},Me=function(e){if(b(e)&&Te in e)return e;throw Y(e+" is not a typed array!")},Pe=function(e,t){if(!(b(e)&&Se in e))throw Y("It is not a typed array constructor!");return new e(t)},De=function(e,t){return Le(M(e,e[Ee]),t)},Le=function(e,t){for(var r=0,a=t.length,o=Pe(e,a);a>r;)o[r]=t[r++];return o},Fe=function(e,t,r){G(e,t,{get:function(){return this._d[r]}})},He=function(e){var t=S(e),r=arguments.length,a=1<r?arguments[1]:void 0,o=a!==void 0,n=B(t),s,l,c,u,p,m;if(n!=null&&!E(n)){for(m=n.call(t),c=[],s=0;!(p=m.next()).done;s++)c.push(p.value);t=c}for(o&&2<r&&(a=d(a,arguments[2],2)),s=0,l=g(t.length),u=Pe(this,l);l>s;s++)u[s]=o?a(t[s],s):t[s];return u},Re=function(){for(var e=0,t=arguments.length,r=Pe(this,t);t>e;)r[e]=arguments[e++];return r},Ne=!!W&&n(function(){xe.call(new W(1))}),Ue=function(){return xe.apply(Ne?he.call(Me(this)):Me(this),arguments)},Ge={copyWithin:function(e,t){return R.call(Me(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return re(Me(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(){return H.apply(Me(this),arguments)},filter:function(e){return De(this,ee(Me(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return ae(Me(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return ne(Me(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){$(Me(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return se(Me(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return ie(Me(this),e,1<arguments.length?arguments[1]:void 0)},join:function(){return ge.apply(Me(this),arguments)},lastIndexOf:function(){return pe.apply(Me(this),arguments)},map:function(e){return Oe(Me(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(){return me.apply(Me(this),arguments)},reduceRight:function(){return fe.apply(Me(this),arguments)},reverse:function(){for(var e=this,t=Me(e).length,r=ue(t/2),a=0,o;a<r;)o=e[a],e[a++]=e[--t],e[t]=o;return e},some:function(e){return te(Me(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return ye.call(Me(this),e)},subarray:function(e,t){var r=Me(this),a=r.length,o=h(e,a);return new(M(r,r[Ee]))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,g((t===void 0?a:h(t,a))-o))}},Ve=function(e,t){return De(this,he.call(Me(this),e,t))},Xe=function(e){Me(this);var t=Ce(arguments[1],1),r=this.length,a=S(e),o=g(a.length),n=0;if(o+t>r)throw X(Be);for(;n<o;)this[t+n]=a[n++]},Ye={entries:function(){return ce.call(Me(this))},keys:function(){return de.call(Me(this))},values:function(){return le.call(Me(this))}},We=function(t,r){return b(t)&&t[Te]&&"symbol"!=e(r)&&r in t&&+r+""==r+""},ze=function(e,t){return We(e,t=v(t,!0))?u(2,e[t]):V(e,t)},je=function(e,t,r){return We(e,t=v(t,!0))&&b(r)&&x(r,"value")&&!x(r,"get")&&!x(r,"set")&&!r.configurable&&(!x(r,"writable")||r.writable)&&(!x(r,"enumerable")||r.enumerable)?(e[t]=r.value,e):G(e,t,r)};Ae||(U.f=ze,N.f=je),i(i.S+i.F*!Ae,"Object",{getOwnPropertyDescriptor:ze,defineProperty:je}),n(function(){ve.call({})})&&(ve=xe=function(){return ge.call(this)});var Ke=m({},Ge);m(Ke,Ye),p(Ke,_e,Ye.values),m(Ke,{slice:Ve,set:Xe,constructor:function(){},toString:ve,toLocaleString:Ue}),Fe(Ke,"buffer","b"),Fe(Ke,"byteOffset","o"),Fe(Ke,"byteLength","l"),Fe(Ke,"length","e"),G(Ke,be,{get:function(){return this[Te]}}),r.exports=function(e,t,r,l){l=!!l;var d=e+(l?"Clamped":"")+"Array",u=o[d],m=u||{},f=u&&T(u),h=!u||!s.ABV,v={},x=u&&u[Z],S=function(r,a){var o=r._d;return o.v["get"+e](a*t+o.o,we)},E=function(r,a,o){var n=r._d;l&&(o=0>(o=oe(o))?0:255<o?255:255&o),n.v["set"+e](a*t+n.o,o,we)},B=function(e,t){G(e,t,{get:function(){return S(this,t)},set:function(e){return E(this,t,e)},enumerable:!0})};h?(u=r(function(e,r,a,o){c(e,u,d,"_d");var n=0,i=0,s,l,m,f;if(!b(r))m=y(r),l=m*t,s=new q(l);else if(r instanceof q||(f=_(r))==z||f==j){s=r,i=Ce(a,t);var h=r.byteLength;if(void 0===o){if(h%t)throw X(Be);if(l=h-i,0>l)throw X(Be)}else if(l=g(o)*t,l+i>h)throw X(Be);m=l/t}else return Te in r?Le(u,r):He.call(u,r);for(p(e,"_d",{b:s,o:i,l:l,e:m,v:new J(s)});n<m;)B(e,n++)}),x=u[Z]=A(Ke),p(x,"constructor",u)):(!n(function(){u(1)})||!n(function(){new u(-1)})||!L(function(e){new u,new u(null),new u(1.5),new u(e)},!0))&&(u=r(function(e,r,a,o){c(e,u,d);var n;return b(r)?r instanceof q||(n=_(r))==z||n==j?void 0===o?void 0===a?new m(r):new m(r,Ce(a,t)):new m(r,Ce(a,t),o):Te in r?Le(u,r):He.call(u,r):new m(y(r))}),$(f===Function.prototype?k(m):k(m).concat(k(f)),function(e){e in u||p(u,e,m[e])}),u[Z]=x,!a&&(x.constructor=u));var O=x[_e],w=!!O&&("values"==O.name||O.name==null),I=Ye.values;p(u,Se,!0),p(x,Te,d),p(x,ke,!0),p(x,Ee,u),(l?new u(1)[be]!=d:!(be in x))&&G(x,be,{get:function(){return d}}),v[d]=u,i(i.G+i.W+i.F*(u!=m),v),i(i.S,d,{BYTES_PER_ELEMENT:t}),i(i.S+i.F*n(function(){m.of.call(u,1)}),d,{from:He,of:Re}),K in x||p(x,K,t),i(i.P,d,Ge),F(d),i(i.P+i.F*Ie,d,{set:Xe}),i(i.P+i.F*!w,d,Ye),a||x.toString==ve||(x.toString=ve),i(i.P+i.F*n(function(){new u(1).slice()}),d,{slice:Ve}),i(i.P+i.F*(n(function(){return[1,2].toLocaleString()!=new u([1,2]).toLocaleString()})||!n(function(){x.toLocaleString.call([1,2])})),d,{toLocaleString:Ue}),D[d]=w?O:I,a||w||p(x,_e,I)}}else r.exports=function(){}},{100:100,104:104,11:11,114:114,115:115,116:116,118:118,119:119,12:12,120:120,122:122,123:123,124:124,128:128,129:129,141:141,17:17,25:25,29:29,33:33,35:35,40:40,41:41,42:42,48:48,51:51,56:56,58:58,6:6,60:60,71:71,72:72,75:75,77:77,79:79,8:8,9:9,92:92,93:93}],122:[function(e,t,r){function a(t,r,a){var o=Array(a),n=8*a-r-1,l=(1<<n)-1,d=l>>1,u=23===r?N(2,-24)-N(2,-77):0,p=0,f=0>t||0===t&&0>1/t?1:0,s,g,y;for(t=R(t),t!=t||t===F?(g=t==t?0:1,s=l):(s=U(G(t)/V),1>t*(y=N(2,-s))&&(s--,y*=2),t+=1<=s+d?u/y:u*N(2,1-d),2<=t*y&&(s++,y/=2),s+d>=l?(g=0,s=l):1<=s+d?(g=(t*y-1)*N(2,r),s+=d):(g=t*N(2,d-1)*N(2,r),s=0));8<=r;o[p++]=255&g,g/=256,r-=8);for(s=s<<r|g,n+=r;0<n;o[p++]=255&s,s/=256,n-=8);return o[--p]|=128*f,o}function o(t,r,a){var o=8*a-r-1,n=(1<<o)-1,l=n>>1,d=o-7,c=a-1,u=t[c--],p=127&u,f;for(u>>=7;0<d;p=256*p+t[c],c--,d-=8);for(f=p&(1<<-d)-1,p>>=-d,d+=r;0<d;f=256*f+t[c],c--,d-=8);if(0===p)p=1-l;else{if(p===n)return f?NaN:u?-F:F;f+=N(2,r),p-=l}return(u?-1:1)*f*N(2,p-r)}function n(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function i(e){return[255&e]}function s(e){return[255&e,255&e>>8]}function l(e){return[255&e,255&e>>8,255&e>>16,255&e>>24]}function d(e){return a(e,52,8)}function c(e){return a(e,23,4)}function u(e,t,r){k(e.prototype,t,{get:function(){return this[r]}})}function p(e,t,r,a){var o=A(+r);if(o+t>e[K])throw L("Wrong index!");var n=e[z]._b,i=o+e[Z],s=n.slice(i,i+t);return a?s:s.reverse()}function m(e,t,r,a,o,n){var s=A(+r);if(s+t>e[K])throw L("Wrong index!");for(var l=e[z]._b,d=s+e[Z],c=a(+o),u=0;u<t;u++)l[d+u]=c[n?u:t-u-1]}var f=e(40),g=e(29),y=e(60),h=e(123),v=e(42),x=e(93),_=e(35),b=e(6),S=e(116),E=e(118),A=e(115),T=e(77).f,k=e(72).f,B=e(9),O=e(101),w="ArrayBuffer",I="DataView",C="prototype",M=f[w],P=f[I],D=f.Math,L=f.RangeError,F=f.Infinity,H=M,R=ye,N=le,U=ue,G=se,V=ae,X="buffer",Y="byteLength",W="byteOffset",z=g?"_b":X,K=g?"_l":Y,Z=g?"_o":W;if(!h.ABV)M=function(e){b(this,M,w);var t=A(e);this._b=B.call(Array(t),0),this[K]=t},P=function(e,t,r){b(this,P,I),b(e,M,I);var a=e[K],o=S(t);if(0>o||o>a)throw L("Wrong offset!");if(r=void 0===r?a-o:E(r),o+r>a)throw L("Wrong length!");this[z]=e,this[Z]=o,this[K]=r},g&&(u(M,Y,"_l"),u(P,X,"_b"),u(P,Y,"_l"),u(P,W,"_o")),x(P[C],{getInt8:function(e){return p(this,1,e)[0]<<24>>24},getUint8:function(e){return p(this,1,e)[0]},getInt16:function(e){var t=p(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=p(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return n(p(this,4,e,arguments[1]))},getUint32:function(e){return n(p(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return o(p(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return o(p(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){m(this,1,e,i,t)},setUint8:function(e,t){m(this,1,e,i,t)},setInt16:function(e,t){m(this,2,e,s,t,arguments[2])},setUint16:function(e,t){m(this,2,e,s,t,arguments[2])},setInt32:function(e,t){m(this,4,e,l,t,arguments[2])},setUint32:function(e,t){m(this,4,e,l,t,arguments[2])},setFloat32:function(e,t){m(this,4,e,c,t,arguments[2])},setFloat64:function(e,t){m(this,8,e,d,t,arguments[2])}});else{if(!_(function(){M(1)})||!_(function(){new M(-1)})||_(function(){return new M,new M(1.5),new M(NaN),M.name!=w})){M=function(e){return b(this,M),new H(A(e))};for(var Q=M[C]=H[C],q=T(H),J=0,$;q.length>J;)($=q[J++])in M||v(M,$,H[$]);y||(Q.constructor=M)}var ee=new P(new M(2)),te=P[C].setInt8;ee.setInt8(0,2147483648),ee.setInt8(1,2147483649),(ee.getInt8(0)||!ee.getInt8(1))&&x(P[C],{setInt8:function(e,t){te.call(this,e,t<<24>>24)},setUint8:function(e,t){te.call(this,e,t<<24>>24)}},!0)}O(M,w),O(P,I),v(P[C],h.VIEW,!0),r[w]=M,r[I]=P},{101:101,115:115,116:116,118:118,123:123,29:29,35:35,40:40,42:42,6:6,60:60,72:72,77:77,9:9,93:93}],123:[function(e,t){for(var r=e(40),a=e(42),o=e(124),n=o("typed_array"),s=o("view"),l=!!(r.ArrayBuffer&&r.DataView),d=l,c=0,u=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"],p;c<9;)(p=r[u[c++]])?(a(p.prototype,n,!0),a(p.prototype,s,!0)):d=!1;t.exports={ABV:l,CONSTR:d,TYPED:n,VIEW:s}},{124:124,40:40,42:42}],124:[function(e,t){var r=0,a=Math.random();t.exports=function(e){return"Symbol(".concat(e===void 0?"":e,")_",(++r+a).toString(36))}},{}],125:[function(e,t){var r=e(51);t.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},{51:51}],126:[function(e,t){var r=e(40),a=e(23),o=e(60),n=e(127),i=e(72).f;t.exports=function(e){var t=a.Symbol||(a.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||i(t,e,{value:n.f(e)})}},{127:127,23:23,40:40,60:60,72:72}],127:[function(e,t,r){r.f=e(128)},{128:128}],128:[function(e,t){var r=e(103)("wks"),a=e(124),o=e(40).Symbol,n="function"==typeof o,i=t.exports=function(e){return r[e]||(r[e]=n&&o[e]||(n?o:a)("Symbol."+e))};i.store=r},{103:103,124:124,40:40}],129:[function(e,t){var r=e(17),a=e(128)("iterator"),o=e(58);t.exports=e(23).getIteratorMethod=function(e){if(e!=null)return e[a]||e["@@iterator"]||o[r(e)]}},{128:128,17:17,23:23,58:58}],130:[function(e){var t=e(33),r=e(95)(/[\\^$*+?.()|[\]{}]/g,"\\$&");t(t.S,"RegExp",{escape:function(e){return r(e)}})},{33:33,95:95}],131:[function(e){var t=e(33);t(t.P,"Array",{copyWithin:e(8)}),e(5)("copyWithin")},{33:33,5:5,8:8}],132:[function(e){var t=e(33),r=e(12)(4);t(t.P+t.F*!e(105)([].every,!0),"Array",{every:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],133:[function(e){var t=e(33);t(t.P,"Array",{fill:e(9)}),e(5)("fill")},{33:33,5:5,9:9}],134:[function(e){var t=e(33),r=e(12)(2);t(t.P+t.F*!e(105)([].filter,!0),"Array",{filter:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],135:[function(e){var t=e(33),r=e(12)(6),a="findIndex",o=!0;a in[]&&[,][a](function(){o=!1}),t(t.P+t.F*o,"Array",{findIndex:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0)}}),e(5)(a)},{12:12,33:33,5:5}],136:[function(e){var t=e(33),r=e(12)(5),a="find",o=!0;a in[]&&[,][a](function(){o=!1}),t(t.P+t.F*o,"Array",{find:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0)}}),e(5)(a)},{12:12,33:33,5:5}],137:[function(e){var t=e(33),r=e(12)(0),a=e(105)([].forEach,!0);t(t.P+t.F*!a,"Array",{forEach:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],138:[function(e){var t=e(25),r=e(33),a=e(119),o=e(53),n=e(48),i=e(118),s=e(24),l=e(129);r(r.S+r.F*!e(56)(function(){}),"Array",{from:function(e){var r=a(e),d="function"==typeof this?this:Array,c=arguments.length,u=1<c?arguments[1]:void 0,p=void 0!==u,m=0,f=l(r),g,y,h,v;if(p&&(u=t(u,2<c?arguments[2]:void 0,2)),null!=f&&!(d==Array&&n(f)))for(v=f.call(r),y=new d;!(h=v.next()).done;m++)s(y,m,p?o(v,u,[h.value,m],!0):h.value);else for(g=i(r.length),y=new d(g);g>m;m++)s(y,m,p?u(r[m],m):r[m]);return y.length=m,y}})},{118:118,119:119,129:129,24:24,25:25,33:33,48:48,53:53,56:56}],139:[function(e){var t=e(33),r=e(11)(!1),a=[].indexOf,o=!!a&&0>1/[1].indexOf(1,-0);t(t.P+t.F*(o||!e(105)(a)),"Array",{indexOf:function(e){return o?a.apply(this,arguments)||0:r(this,e,arguments[1])}})},{105:105,11:11,33:33}],140:[function(e){var t=e(33);t(t.S,"Array",{isArray:e(49)})},{33:33,49:49}],141:[function(e,t){var r=e(5),a=e(57),o=e(58),n=e(117);t.exports=e(55)(Array,"Array",function(e,t){this._t=n(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,a(1)):"keys"==t?a(0,r):"values"==t?a(0,e[r]):a(0,[r,e[r]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},{117:117,5:5,55:55,57:57,58:58}],142:[function(e){var t=e(33),r=e(117),a=[].join;t(t.P+t.F*(e(47)!=Object||!e(105)(a)),"Array",{join:function(e){return a.call(r(this),e===void 0?",":e)}})},{105:105,117:117,33:33,47:47}],143:[function(e){var t=e(33),r=e(117),a=e(116),o=e(118),n=[].lastIndexOf,i=!!n&&0>1/[1].lastIndexOf(1,-0);t(t.P+t.F*(i||!e(105)(n)),"Array",{lastIndexOf:function(e){if(i)return n.apply(this,arguments)||0;var t=r(this),s=o(t.length),l=s-1;for(1<arguments.length&&(l=pe(l,a(arguments[1]))),0>l&&(l=s+l);0<=l;l--)if(l in t&&t[l]===e)return l||0;return-1}})},{105:105,116:116,117:117,118:118,33:33}],144:[function(e){var t=e(33),r=e(12)(1);t(t.P+t.F*!e(105)([].map,!0),"Array",{map:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],145:[function(e){var t=e(33),r=e(24);t(t.S+t.F*e(35)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,a=new("function"==typeof this?this:Array)(t);t>e;)r(a,e,arguments[e++]);return a.length=t,a}})},{24:24,33:33,35:35}],146:[function(e){var t=e(33),r=e(13);t(t.P+t.F*!e(105)([].reduceRight,!0),"Array",{reduceRight:function(e){return r(this,e,arguments.length,arguments[1],!0)}})},{105:105,13:13,33:33}],147:[function(e){var t=e(33),r=e(13);t(t.P+t.F*!e(105)([].reduce,!0),"Array",{reduce:function(e){return r(this,e,arguments.length,arguments[1],!1)}})},{105:105,13:13,33:33}],148:[function(e){var t=e(33),r=e(43),a=e(18),o=e(114),n=e(118),s=[].slice;t(t.P+t.F*e(35)(function(){r&&s.call(r)}),"Array",{slice:function(e,t){var r=n(this.length),l=a(this);if(t=void 0===t?r:t,"Array"==l)return s.call(this,e,t);for(var d=o(e,r),c=o(t,r),u=n(c-d),p=Array(u),m=0;m<u;m++)p[m]="String"==l?this.charAt(d+m):this[d+m];return p}})},{114:114,118:118,18:18,33:33,35:35,43:43}],149:[function(e){var t=e(33),r=e(12)(3);t(t.P+t.F*!e(105)([].some,!0),"Array",{some:function(e){return r(this,e,arguments[1])}})},{105:105,12:12,33:33}],150:[function(e){var t=e(33),r=e(3),a=e(119),o=e(35),n=[].sort,i=[1,2,3];t(t.P+t.F*(o(function(){i.sort(void 0)})||!o(function(){i.sort(null)})||!e(105)(n)),"Array",{sort:function(e){return e===void 0?n.call(a(this)):n.call(a(this),r(e))}})},{105:105,119:119,3:3,33:33,35:35}],151:[function(e){e(100)("Array")},{100:100}],152:[function(e){var t=e(33);t(t.S,"Date",{now:function(){return new Date().getTime()}})},{33:33}],153:[function(e){var t=e(33),r=e(26);t(t.P+t.F*(Date.prototype.toISOString!==r),"Date",{toISOString:r})},{26:26,33:33}],154:[function(e){var t=e(33),r=e(119),a=e(120);t(t.P+t.F*e(35)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(){var e=r(this),t=a(e);return"number"!=typeof t||isFinite(t)?e.toISOString():null}})},{119:119,120:120,33:33,35:35}],155:[function(e){var t=e(128)("toPrimitive"),r=Date.prototype;t in r||e(42)(r,t,e(27))},{128:128,27:27,42:42}],156:[function(e){var t=Date.prototype,r="Invalid Date",a="toString",o=t[a],n=t.getTime;new Date(NaN)+""!=r&&e(94)(t,a,function(){var e=n.call(this);return e===e?o.call(this):r})},{94:94}],157:[function(e){var t=e(33);t(t.P,"Function",{bind:e(16)})},{16:16,33:33}],158:[function(e){var t=e(51),r=e(79),a=e(128)("hasInstance"),o=Function.prototype;a in o||e(72).f(o,a,{value:function(e){if("function"!=typeof this||!t(e))return!1;if(!t(this.prototype))return e instanceof this;for(;e=r(e);)if(this.prototype===e)return!0;return!1}})},{128:128,51:51,72:72,79:79}],159:[function(e){var t=e(72).f,r=Function.prototype,a=/^\s*function ([^ (]*)/,o="name";o in r||e(29)&&t(r,o,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},{29:29,72:72}],160:[function(e,t){var r=e(19),a=e(125),o="Map";t.exports=e(22)(o,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(a(this,o),e);return t&&t.v},set:function(e,t){return r.def(a(this,o),0===e?0:e,t)}},r,!0)},{125:125,19:19,22:22}],161:[function(e){var t=e(33),r=e(63),a=he,o=Math.acosh;t(t.S+t.F*!(o&&710==ue(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(e){return 1>(e=+e)?NaN:94906265.62425156<e?se(e)+ae:r(e-1+a(e-1)*a(e+1))}})},{33:33,63:63}],162:[function(e){function t(e){return isFinite(e=+e)&&0!=e?0>e?-t(-e):se(e+he(e*e+1)):e}var r=e(33),a=Math.asinh;r(r.S+r.F*!(a&&0<1/a(0)),"Math",{asinh:t})},{33:33}],163:[function(e){var t=e(33),r=Math.atanh;t(t.S+t.F*!(r&&0>1/r(-0)),"Math",{atanh:function(e){return 0==(e=+e)?e:se((1+e)/(1-e))/2}})},{33:33}],164:[function(e){var t=e(33),r=e(65);t(t.S,"Math",{cbrt:function(e){return r(e=+e)*le(ye(e),1/3)}})},{33:33,65:65}],165:[function(e){var t=e(33);t(t.S,"Math",{clz32:function(e){return(e>>>=0)?31-ue(se(e+.5)*Math.LOG2E):32}})},{33:33}],166:[function(e){var t=e(33),r=de;t(t.S,"Math",{cosh:function(e){return(r(e=+e)+r(-e))/2}})},{33:33}],167:[function(e){var t=e(33),r=e(61);t(t.S+t.F*(r!=ce),"Math",{expm1:r})},{33:33,61:61}],168:[function(e){var t=e(33);t(t.S,"Math",{fround:e(62)})},{33:33,62:62}],169:[function(e){var t=e(33);t(t.S,"Math",{hypot:function(){for(var e=0,t=0,r=arguments.length,a=0,o,n;t<r;)o=ye(arguments[t++]),a<o?(n=a/o,e=e*n*n+1,a=o):0<o?(n=o/a,e+=n*n):e+=o;return a===1/0?1/0:a*he(e)}})},{33:33}],170:[function(e){var t=e(33),r=Math.imul;t(t.S+t.F*e(35)(function(){return-5!=r(4294967295,5)||2!=r.length}),"Math",{imul:function(e,t){var r=+e,a=+t,o=65535&r,n=65535&a;return 0|o*n+((65535&r>>>16)*n+o*(65535&a>>>16)<<16>>>0)}})},{33:33,35:35}],171:[function(e){var t=e(33);t(t.S,"Math",{log10:function(e){return se(e)*Math.LOG10E}})},{33:33}],172:[function(e){var t=e(33);t(t.S,"Math",{log1p:e(63)})},{33:33,63:63}],173:[function(e){var t=e(33);t(t.S,"Math",{log2:function(e){return se(e)/ae}})},{33:33}],174:[function(e){var t=e(33);t(t.S,"Math",{sign:e(65)})},{33:33,65:65}],175:[function(e){var t=e(33),r=e(61),a=de;t(t.S+t.F*e(35)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return 1>ye(e=+e)?(r(e)-r(-e))/2:(a(e-1)-a(-e-1))*(Math.E/2)}})},{33:33,35:35,61:61}],176:[function(e){var t=e(33),r=e(61),o=de;t(t.S,"Math",{tanh:function(e){var t=r(e=+e),a=r(-e);return t==1/0?1:a==1/0?-1:(t-a)/(o(e)+o(-e))}})},{33:33,61:61}],177:[function(e){var t=e(33);t(t.S,"Math",{trunc:function(e){return(0<e?ue:ie)(e)}})},{33:33}],178:[function(e){var t=e(40),r=e(41),a=e(18),o=e(45),n=e(120),i=e(35),s=e(77).f,l=e(75).f,d=e(72).f,c=e(111).trim,u="Number",p=t[u],m=p,f=p.prototype,g=a(e(71)(f))==u,y="trim"in String.prototype,h=function(e){var t=n(e,!1);if("string"==typeof t&&2<t.length){t=y?t.trim():c(t,3);var r=t.charCodeAt(0),a,o,s;if(43===r||45===r){if(a=t.charCodeAt(2),88===a||120===a)return NaN;}else if(48===r){switch(t.charCodeAt(1)){case 66:case 98:o=2,s=49;break;case 79:case 111:o=8,s=55;break;default:return+t;}for(var d=t.slice(2),u=0,p=d.length,l;u<p;u++)if(l=d.charCodeAt(u),48>l||l>s)return NaN;return parseInt(d,o)}}return+t};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(e){var t=1>arguments.length?0:e,r=this;return r instanceof p&&(g?i(function(){f.valueOf.call(r)}):a(r)!=u)?o(new m(h(t)),r,p):h(t)};for(var v=e(29)?s(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0,_;v.length>x;x++)r(m,_=v[x])&&!r(p,_)&&d(p,_,l(m,_));p.prototype=f,f.constructor=p,e(94)(t,u,p)}},{111:111,120:120,18:18,29:29,35:35,40:40,41:41,45:45,71:71,72:72,75:75,77:77,94:94}],179:[function(e){var t=e(33);t(t.S,"Number",{EPSILON:le(2,-52)})},{33:33}],180:[function(e){var t=e(33),r=e(40).isFinite;t(t.S,"Number",{isFinite:function(e){return"number"==typeof e&&r(e)}})},{33:33,40:40}],181:[function(e){var t=e(33);t(t.S,"Number",{isInteger:e(50)})},{33:33,50:50}],182:[function(e){var t=e(33);t(t.S,"Number",{isNaN:function(e){return e!=e}})},{33:33}],183:[function(e){var t=e(33),r=e(50);t(t.S,"Number",{isSafeInteger:function(e){return r(e)&&9007199254740991>=ye(e)}})},{33:33,50:50}],184:[function(e){var t=e(33);t(t.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{33:33}],185:[function(e){var t=e(33);t(t.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{33:33}],186:[function(e){var t=e(33),r=e(86);t(t.S+t.F*(Number.parseFloat!=r),"Number",{parseFloat:r})},{33:33,86:86}],187:[function(e){var t=e(33),r=e(87);t(t.S+t.F*(Number.parseInt!=r),"Number",{parseInt:r})},{33:33,87:87}],188:[function(e){var t=e(33),r=e(116),a=e(4),o=e(110),n=1 .toFixed,s=ue,l=[0,0,0,0,0,0],d="Number.toFixed: incorrect invocation!",c="0",u=function(e,t){for(var r=-1,a=t;6>++r;)a+=e*l[r],l[r]=a%1e7,a=s(a/1e7)},p=function(e){for(var t=6,r=0;0<=--t;)r+=l[t],l[t]=s(r/e),r=1e7*(r%e)},g=function(){for(var e=6,r="";0<=--e;)if(""!==r||0===e||0!==l[e]){var a=l[e]+"";r=""===r?a:r+o.call(c,7-a.length)+a}return r},y=function e(t,r,a){return 0===r?a:1==r%2?e(t,r-1,a*t):e(t*t,r/2,a)},h=function(e){for(var t=0,r=e;4096<=r;)t+=12,r/=4096;for(;2<=r;)t+=1,r/=2;return t};t(t.P+t.F*(!!n&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==1000000000000000100 .toFixed(0))||!e(35)(function(){n.call({})})),"Number",{toFixed:function(t){var n=a(this,d),i=r(t),l="",f=c,v,_,b,S;if(0>i||20<i)throw RangeError(d);if(n!=n)return"NaN";if(-1e21>=n||1e21<=n)return n+"";if(0>n&&(l="-",n=-n),1e-21<n)if(v=h(n*y(2,69,1))-69,_=0>v?n*y(2,-v,1):n/y(2,v,1),_*=4503599627370496,v=52-v,0<v){for(u(0,_),b=i;7<=b;)u(1e7,0),b-=7;for(u(y(10,b,1),0),b=v-1;23<=b;)p(8388608),b-=23;p(1<<b),u(1,1),p(2),f=g()}else u(0,_),u(1<<-v,0),f=g()+o.call(c,i);return 0<i?(S=f.length,f=l+(S<=i?"0."+o.call(c,i-S)+f:f.slice(0,S-i)+"."+f.slice(S-i))):f=l+f,f}})},{110:110,116:116,33:33,35:35,4:4}],189:[function(e){var t=e(33),r=e(35),a=e(4),o=1 .toPrecision;t(t.P+t.F*(r(function(){return"1"!==o.call(1,void 0)})||!r(function(){o.call({})})),"Number",{toPrecision:function(e){var t=a(this,"Number#toPrecision: incorrect invocation!");return e===void 0?o.call(t):o.call(t,e)}})},{33:33,35:35,4:4}],190:[function(e){var t=e(33);t(t.S+t.F,"Object",{assign:e(70)})},{33:33,70:70}],191:[function(e){var t=e(33);t(t.S,"Object",{create:e(71)})},{33:33,71:71}],192:[function(e){var t=e(33);t(t.S+t.F*!e(29),"Object",{defineProperties:e(73)})},{29:29,33:33,73:73}],193:[function(e){var t=e(33);t(t.S+t.F*!e(29),"Object",{defineProperty:e(72).f})},{29:29,33:33,72:72}],194:[function(e){var t=e(51),r=e(66).onFreeze;e(83)("freeze",function(e){return function(a){return e&&t(a)?e(r(a)):a}})},{51:51,66:66,83:83}],195:[function(e){var t=e(117),r=e(75).f;e(83)("getOwnPropertyDescriptor",function(){return function(e,a){return r(t(e),a)}})},{117:117,75:75,83:83}],196:[function(e){e(83)("getOwnPropertyNames",function(){return e(76).f})},{76:76,83:83}],197:[function(e){var t=e(119),r=e(79);e(83)("getPrototypeOf",function(){return function(e){return r(t(e))}})},{119:119,79:79,83:83}],198:[function(e){var t=e(51);e(83)("isExtensible",function(e){return function(r){return!!t(r)&&(!e||e(r))}})},{51:51,83:83}],199:[function(e){var t=e(51);e(83)("isFrozen",function(e){return function(r){return!t(r)||!!e&&e(r)}})},{51:51,83:83}],200:[function(e){var t=e(51);e(83)("isSealed",function(e){return function(r){return!t(r)||!!e&&e(r)}})},{51:51,83:83}],201:[function(e){var t=e(33);t(t.S,"Object",{is:e(96)})},{33:33,96:96}],202:[function(e){var t=e(119),r=e(81);e(83)("keys",function(){return function(e){return r(t(e))}})},{119:119,81:81,83:83}],203:[function(e){var t=e(51),r=e(66).onFreeze;e(83)("preventExtensions",function(e){return function(a){return e&&t(a)?e(r(a)):a}})},{51:51,66:66,83:83}],204:[function(e){var t=e(51),r=e(66).onFreeze;e(83)("seal",function(e){return function(a){return e&&t(a)?e(r(a)):a}})},{51:51,66:66,83:83}],205:[function(e){var t=e(33);t(t.S,"Object",{setPrototypeOf:e(99).set})},{33:33,99:99}],206:[function(e){var t=e(17),r={};r[e(128)("toStringTag")]="z","[object z]"!=r+""&&e(94)(Object.prototype,"toString",function(){return"[object "+t(this)+"]"},!0)},{128:128,17:17,94:94}],207:[function(e){var t=e(33),r=e(86);t(t.G+t.F*(parseFloat!=r),{parseFloat:r})},{33:33,86:86}],208:[function(e){var t=e(33),r=e(87);t(t.G+t.F*(parseInt!=r),{parseInt:r})},{33:33,87:87}],209:[function(e){var t=e(60),r=e(40),a=e(25),o=e(17),n=e(33),i=e(51),s=e(3),l=e(6),d=e(39),c=e(104),u=e(113).set,p=e(68)(),m=e(69),f=e(90),g=e(91),y="Promise",h=r.TypeError,v=r.process,_=r[y],b="process"==o(v),S=function(){},E=D=m.f,A=!!function(){try{var t=_.resolve(1),r=(t.constructor={})[e(128)("species")]=function(e){e(S,S)};return(b||"function"==typeof PromiseRejectionEvent)&&t.then(S)instanceof r}catch(t){}}(),T=t?function(e,t){return e===t||e===_&&t===F}:function(e,t){return e===t},k=function(e){var t;return!!(i(e)&&"function"==typeof(t=e.then))&&t},B=function(e,t){if(!e._n){e._n=!0;var r=e._c;p(function(){for(var a=e._v,o=1==e._s,n=0,s=function(t){var r=o?t.ok:t.fail,n=t.resolve,i=t.reject,s=t.domain,l,d;try{r?(!o&&(2==e._h&&I(e),e._h=1),!0===r?l=a:(s&&s.enter(),l=r(a),s&&s.exit()),l===t.promise?i(h("Promise-chain cycle")):(d=k(l))?d.call(l,n,i):n(l)):i(a)}catch(t){i(t)}};r.length>n;)s(r[n++]);e._c=[],e._n=!1,t&&!e._h&&O(e)})}},O=function(e){u.call(r,function(){var t=e._v,a=w(e),o,n,i;if(a&&(o=f(function(){b?v.emit("unhandledRejection",t,e):(n=r.onunhandledrejection)?n({promise:e,reason:t}):(i=r.console)&&i.error&&i.error("Unhandled promise rejection",t)}),e._h=b||w(e)?2:1),e._a=void 0,a&&o.e)throw o.v})},w=function e(t){if(1==t._h)return!1;for(var r=t._a||t._c,a=0,o;r.length>a;)if(o=r[a++],o.fail||!e(o.promise))return!1;return!0},I=function(e){u.call(r,function(){var t;b?v.emit("rejectionHandled",e):(t=r.onrejectionhandled)&&t({promise:e,reason:e._v})})},C=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,!t._a&&(t._a=t._c.slice()),B(t,!0))},M=function e(t){var r=this,o;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw h("Promise can't be resolved itself");(o=k(t))?p(function(){var n={_w:r,_d:!1};try{o.call(t,a(e,n,1),a(C,n,1))}catch(t){C.call(n,t)}}):(r._v=t,r._s=1,B(r,!1))}catch(t){C.call({_w:r,_d:!1},t)}}},P,D,L,F;A||(_=function(e){l(this,_,y,"_h"),s(e),P.call(this);try{e(a(M,this,1),a(C,this,1))}catch(e){C.call(this,e)}},P=function(){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},P.prototype=e(93)(_.prototype,{then:function(e,t){var r=E(c(this,_));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=b?v.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&B(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),L=function(){var e=new P;this.promise=e,this.resolve=a(M,e,1),this.reject=a(C,e,1)},m.f=E=function(e){return T(_,e)?new L(e):D(e)}),n(n.G+n.W+n.F*!A,{Promise:_}),e(101)(_,y),e(100)(y),F=e(23)[y],n(n.S+n.F*!A,y,{reject:function(e){var t=E(this),r=t.reject;return r(e),t.promise}}),n(n.S+n.F*(t||!A),y,{resolve:function(e){return e instanceof _&&T(e.constructor,this)?e:g(this,e)}}),n(n.S+n.F*!(A&&e(56)(function(e){_.all(e)["catch"](S)})),y,{all:function(e){var t=this,r=E(t),a=r.resolve,o=r.reject,n=f(function(){var r=[],n=0,i=1;d(e,!1,function(e){var s=n++,l=!1;r.push(void 0),i++,t.resolve(e).then(function(e){l||(l=!0,r[s]=e,--i||a(r))},o)}),--i||a(r)});return n.e&&o(n.v),r.promise},race:function(e){var t=this,r=E(t),a=r.reject,o=f(function(){d(e,!1,function(e){t.resolve(e).then(r.resolve,a)})});return o.e&&a(o.v),r.promise}})},{100:100,101:101,104:104,113:113,128:128,17:17,23:23,25:25,3:3,33:33,39:39,40:40,51:51,56:56,6:6,60:60,68:68,69:69,90:90,91:91,93:93}],210:[function(e){var t=e(33),r=e(3),a=e(7),o=(e(40).Reflect||{}).apply,n=Function.apply;t(t.S+t.F*!e(35)(function(){o(function(){})}),"Reflect",{apply:function(e,t,i){var s=r(e),l=a(i);return o?o(s,t,l):n.call(s,t,l)}})},{3:3,33:33,35:35,40:40,7:7}],211:[function(e){var t=e(33),r=e(71),a=e(3),o=e(7),n=e(51),i=e(35),s=e(16),l=(e(40).Reflect||{}).construct,d=i(function(){function e(){}return!(l(function(){},[],e)instanceof e)}),c=!i(function(){l(function(){})});t(t.S+t.F*(d||c),"Reflect",{construct:function(e,t){a(e),o(t);var i=3>arguments.length?e:a(arguments[2]);if(c&&!d)return l(e,t,i);if(e==i){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);}var u=[null];return u.push.apply(u,t),new(s.apply(e,u))}var p=i.prototype,m=r(n(p)?p:Object.prototype),f=Function.apply.call(e,m,t);return n(f)?f:m}})},{16:16,3:3,33:33,35:35,40:40,51:51,7:7,71:71}],212:[function(e){var t=e(72),r=e(33),a=e(7),o=e(120);r(r.S+r.F*e(35)(function(){Reflect.defineProperty(t.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,r,n){a(e),r=o(r,!0),a(n);try{return t.f(e,r,n),!0}catch(t){return!1}}})},{120:120,33:33,35:35,7:7,72:72}],213:[function(e){var t=e(33),r=e(75).f,a=e(7);t(t.S,"Reflect",{deleteProperty:function(e,t){var o=r(a(e),t);return(!o||o.configurable)&&delete e[t]}})},{33:33,7:7,75:75}],214:[function(e){var t=e(33),r=e(7),a=function(e){this._t=r(e),this._i=0;var t=this._k=[],a;for(a in e)t.push(a)};e(54)(a,"Object",function(){var e=this,t=e._k,r;do if(e._i>=t.length)return{value:void 0,done:!0};while(!((r=t[e._i++])in e._t));return{value:r,done:!1}}),t(t.S,"Reflect",{enumerate:function(e){return new a(e)}})},{33:33,54:54,7:7}],215:[function(e){var t=e(75),r=e(33),a=e(7);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(e,r){return t.f(a(e),r)}})},{33:33,7:7,75:75}],216:[function(e){var t=e(33),r=e(79),a=e(7);t(t.S,"Reflect",{getPrototypeOf:function(e){return r(a(e))}})},{33:33,7:7,79:79}],217:[function(e){function t(e,n){var l=3>arguments.length?e:arguments[2],d,c;return s(e)===l?e[n]:(d=r.f(e,n))?o(d,"value")?d.value:void 0===d.get?void 0:d.get.call(l):i(c=a(e))?t(c,n,l):void 0}var r=e(75),a=e(79),o=e(41),n=e(33),i=e(51),s=e(7);n(n.S,"Reflect",{get:t})},{33:33,41:41,51:51,7:7,75:75,79:79}],218:[function(e){var t=e(33);t(t.S,"Reflect",{has:function(e,t){return t in e}})},{33:33}],219:[function(e){var t=e(33),r=e(7),a=Object.isExtensible;t(t.S,"Reflect",{isExtensible:function(e){return r(e),!a||a(e)}})},{33:33,7:7}],220:[function(e){var t=e(33);t(t.S,"Reflect",{ownKeys:e(85)})},{33:33,85:85}],221:[function(e){var t=e(33),r=e(7),a=Object.preventExtensions;t(t.S,"Reflect",{preventExtensions:function(e){r(e);try{return a&&a(e),!0}catch(t){return!1}}})},{33:33,7:7}],222:[function(e){var t=e(33),r=e(99);r&&t(t.S,"Reflect",{setPrototypeOf:function(e,t){r.check(e,t);try{return r.set(e,t),!0}catch(t){return!1}}})},{33:33,99:99}],223:[function(e){function t(e,i,c){var u=4>arguments.length?e:arguments[3],p=a.f(l(e),i),m,f;if(!p){if(d(f=o(e)))return t(f,i,c,u);p=s(0)}return n(p,"value")?!!(!1!==p.writable&&d(u))&&(m=a.f(u,i)||s(0),m.value=c,r.f(u,i,m),!0):void 0!==p.set&&(p.set.call(u,c),!0)}var r=e(72),a=e(75),o=e(79),n=e(41),i=e(33),s=e(92),l=e(7),d=e(51);i(i.S,"Reflect",{set:t})},{33:33,41:41,51:51,7:7,72:72,75:75,79:79,92:92}],224:[function(e){var t=e(40),r=e(45),a=e(72).f,o=e(77).f,n=e(52),s=e(37),l=t.RegExp,d=l,c=l.prototype,u=/a/g,p=/a/g,m=new l(u)!==u;if(e(29)&&(!m||e(35)(function(){return p[e(128)("match")]=!1,l(u)!=u||l(p)==p||"/a/i"!=l(u,"i")}))){l=function(e,t){var a=this instanceof l,o=n(e),i=t===void 0;return!a&&o&&e.constructor===l&&i?e:r(m?new d(o&&!i?e.source:e,t):d((o=e instanceof l)?e.source:e,o&&i?s.call(e):t),a?this:c,l)};for(var f=function(e){(e in l)||a(l,e,{configurable:!0,get:function(){return d[e]},set:function(t){d[e]=t}})},g=o(d),y=0;g.length>y;)f(g[y++]);c.constructor=l,l.prototype=c,e(94)(t,"RegExp",l)}e(100)("RegExp")},{100:100,128:128,29:29,35:35,37:37,40:40,45:45,52:52,72:72,77:77,94:94}],225:[function(e){e(29)&&"g"!=/./g.flags&&e(72).f(RegExp.prototype,"flags",{configurable:!0,get:e(37)})},{29:29,37:37,72:72}],226:[function(e){e(36)("match",1,function(e,t,r){return[function(r){var a=e(this),o=r==null?void 0:r[t];return o===void 0?new RegExp(r)[t](a+""):o.call(r,a)},r]})},{36:36}],227:[function(e){e(36)("replace",2,function(e,t,r){return[function(a,o){var n=e(this),i=a==null?void 0:a[t];return i===void 0?r.call(n+"",a,o):i.call(a,n,o)},r]})},{36:36}],228:[function(e){e(36)("search",1,function(e,t,r){return[function(r){var a=e(this),o=r==null?void 0:r[t];return o===void 0?new RegExp(r)[t](a+""):o.call(r,a)},r]})},{36:36}],229:[function(e){e(36)("split",2,function(t,r,a){var o=e(52),n=a,s=[].push,l="split",d="length",c="lastIndex";if("c"=="abbc"[l](/(b)*/)[1]||4!="test"[l](/(?:)/,-1)[d]||2!="ab"[l](/(?:ab)*/)[d]||4!="."[l](/(.?)(.?)/)[d]||1<"."[l](/()()/)[d]||""[l](/.?/)[d]){var u=/()??/.exec("")[1]===void 0;a=function(e,t){var r=this+"";if(void 0===e&&0===t)return[];if(!o(e))return n.call(r,e,t);var a=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),p=0,m=void 0===t?4294967295:t>>>0,f=new RegExp(e.source,l+"g"),g,y,h,v,x;for(u||(g=new RegExp("^"+f.source+"$(?!\\s)",l));(y=f.exec(r))&&(h=y.index+y[0][d],!(h>p&&(a.push(r.slice(p,y.index)),!u&&1<y[d]&&y[0].replace(g,function(){for(x=1;x<arguments[d]-2;x++)void 0===arguments[x]&&(y[x]=void 0)}),1<y[d]&&y.index<r[d]&&s.apply(a,y.slice(1)),v=y[0][d],p=h,a[d]>=m)));)f[c]===y.index&&f[c]++;return p===r[d]?(v||!f.test(""))&&a.push(""):a.push(r.slice(p)),a[d]>m?a.slice(0,m):a}}else"0"[l](void 0,0)[d]&&(a=function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)});return[function(e,o){var n=t(this),i=e==null?void 0:e[r];return i===void 0?a.call(n+"",e,o):i.call(e,n,o)},a]})},{36:36,52:52}],230:[function(e){e(225);var t=e(7),r=e(37),a=e(29),o="toString",n=/./[o],i=function(t){e(94)(RegExp.prototype,o,t,!0)};e(35)(function(){return"/a/b"!=n.call({source:"a",flags:"b"})})?i(function(){var e=t(this);return"/".concat(e.source,"/","flags"in e?e.flags:!a&&e instanceof RegExp?r.call(e):void 0)}):n.name!=o&&i(function(){return n.call(this)})},{225:225,29:29,35:35,37:37,7:7,94:94}],231:[function(e,t){var r=e(19),a=e(125),o="Set";t.exports=e(22)(o,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return r.def(a(this,o),e=0===e?0:e,e)}},r)},{125:125,19:19,22:22}],232:[function(e){e(108)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},{108:108}],233:[function(e){e(108)("big",function(e){return function(){return e(this,"big","","")}})},{108:108}],234:[function(e){e(108)("blink",function(e){return function(){return e(this,"blink","","")}})},{108:108}],235:[function(e){e(108)("bold",function(e){return function(){return e(this,"b","","")}})},{108:108}],236:[function(e){var t=e(33),r=e(106)(!1);t(t.P,"String",{codePointAt:function(e){return r(this,e)}})},{106:106,33:33}],237:[function(e){var t=e(33),r=e(118),a=e(107),o="endsWith",n=""[o];t(t.P+t.F*e(34)(o),"String",{endsWith:function(e){var t=a(this,e,o),n=1<arguments.length?arguments[1]:void 0,i=r(t.length),s=n===void 0?i:pe(r(n),i),l=e+"";return t.slice(s-l.length,s)===l}})},{107:107,118:118,33:33,34:34}],238:[function(e){e(108)("fixed",function(e){return function(){return e(this,"tt","","")}})},{108:108}],239:[function(e){e(108)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},{108:108}],240:[function(e){e(108)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},{108:108}],241:[function(e){var t=e(33),r=e(114),a=String.fromCharCode,o=String.fromCodePoint;t(t.S+t.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(){for(var e=[],t=arguments.length,o=0,n;t>o;){if(n=+arguments[o++],r(n,1114111)!==n)throw RangeError(n+" is not a valid code point");e.push(65536>n?a(n):a(((n-=65536)>>10)+55296,n%1024+56320))}return e.join("")}})},{114:114,33:33}],242:[function(e){var t=e(33),r=e(107),a="includes";t(t.P+t.F*e(34)(a),"String",{includes:function(e){return!!~r(this,e,a).indexOf(e,1<arguments.length?arguments[1]:void 0)}})},{107:107,33:33,34:34}],243:[function(e){e(108)("italics",function(e){return function(){return e(this,"i","","")}})},{108:108}],244:[function(e){var t=e(106)(!0);e(55)(String,"String",function(e){this._t=e+"",this._i=0},function(){var e=this._t,r=this._i,a;return r>=e.length?{value:void 0,done:!0}:(a=t(e,r),this._i+=a.length,{value:a,done:!1})})},{106:106,55:55}],245:[function(e){e(108)("link",function(e){return function(t){return e(this,"a","href",t)}})},{108:108}],246:[function(e){var t=e(33),r=e(117),a=e(118);t(t.S,"String",{raw:function(e){for(var t=r(e.raw),o=a(t.length),n=arguments.length,s=[],l=0;o>l;)s.push(t[l++]+""),l<n&&s.push(arguments[l]+"");return s.join("")}})},{117:117,118:118,33:33}],247:[function(e){var t=e(33);t(t.P,"String",{repeat:e(110)})},{110:110,33:33}],248:[function(e){e(108)("small",function(e){return function(){return e(this,"small","","")}})},{108:108}],249:[function(e){var t=e(33),r=e(118),a=e(107),o="startsWith",n=""[o];t(t.P+t.F*e(34)(o),"String",{startsWith:function(e){var t=a(this,e,o),n=r(pe(1<arguments.length?arguments[1]:void 0,t.length)),i=e+"";return t.slice(n,n+i.length)===i}})},{107:107,118:118,33:33,34:34}],250:[function(e){e(108)("strike",function(e){return function(){return e(this,"strike","","")}})},{108:108}],251:[function(e){e(108)("sub",function(e){return function(){return e(this,"sub","","")}})},{108:108}],252:[function(e){e(108)("sup",function(e){return function(){return e(this,"sup","","")}})},{108:108}],253:[function(e){e(111)("trim",function(e){return function(){return e(this,3)}})},{111:111}],254:[function(t){var r=t(40),a=t(41),o=t(29),n=t(33),i=t(94),s=t(66).KEY,l=t(35),d=t(103),c=t(101),u=t(124),p=t(128),m=t(127),f=t(126),g=t(59),y=t(32),h=t(49),v=t(7),x=t(117),_=t(120),b=t(92),S=t(71),E=t(76),A=t(75),T=t(72),B=t(81),O=A.f,w=T.f,I=E.f,C=r.Symbol,M=r.JSON,P=M&&M.stringify,D="prototype",L=p("_hidden"),F=p("toPrimitive"),H={}.propertyIsEnumerable,R=d("symbol-registry"),N=d("symbols"),U=d("op-symbols"),G=Object[D],V="function"==typeof C,X=r.QObject,Y=!X||!X[D]||!X[D].findChild,W=o&&l(function(){return 7!=S(w({},"a",{get:function(){return w(this,"a",{value:7}).a}})).a})?function(e,t,r){var a=O(G,t);a&&delete G[t],w(e,t,r),a&&e!==G&&w(G,t,a)}:w,z=function(e){var t=N[e]=S(C[D]);return t._k=e,t},K=V&&"symbol"==e(C.iterator)?function(t){return"symbol"==e(t)}:function(e){return e instanceof C},Z=function(e,t,r){return e===G&&Z(U,t,r),v(e),t=_(t,!0),v(r),a(N,t)?(r.enumerable?(a(e,L)&&e[L][t]&&(e[L][t]=!1),r=S(r,{enumerable:b(0,!1)})):(!a(e,L)&&w(e,L,b(1,{})),e[L][t]=!0),W(e,t,r)):w(e,t,r)},Q=function(e,t){v(e);for(var r=y(t=x(t)),a=0,o=r.length,n;o>a;)Z(e,n=r[a++],t[n]);return e},q=function(e){var t=H.call(this,e=_(e,!0));return(this!==G||!a(N,e)||a(U,e))&&(!(t||!a(this,e)||!a(N,e)||a(this,L)&&this[L][e])||t)},J=function(e,t){if(e=x(e),t=_(t,!0),e!==G||!a(N,t)||a(U,t)){var r=O(e,t);return r&&a(N,t)&&!(a(e,L)&&e[L][t])&&(r.enumerable=!0),r}},$=function(e){for(var t=I(x(e)),r=[],o=0,n;t.length>o;)a(N,n=t[o++])||n==L||n==s||r.push(n);return r},ee=function(e){for(var t=e===G,r=I(t?U:x(e)),o=[],n=0,s;r.length>n;)a(N,s=r[n++])&&(!t||a(G,s))&&o.push(N[s]);return o};V||(C=function(){if(this instanceof C)throw TypeError("Symbol is not a constructor!");var e=u(0<arguments.length?arguments[0]:void 0);return o&&Y&&W(G,e,{configurable:!0,set:function t(r){this===G&&t.call(U,r),a(this,L)&&a(this[L],e)&&(this[L][e]=!1),W(this,e,b(1,r))}}),z(e)},i(C[D],"toString",function(){return this._k}),A.f=J,T.f=Z,t(77).f=E.f=$,t(82).f=q,t(78).f=ee,o&&!t(60)&&i(G,"propertyIsEnumerable",q,!0),m.f=function(e){return z(p(e))}),n(n.G+n.W+n.F*!V,{Symbol:C});for(var te=["hasInstance","isConcatSpreadable","iterator","match","replace","search","species","split","toPrimitive","toStringTag","unscopables"],re=0;te.length>re;)p(te[re++]);for(var ae=B(p.store),oe=0;ae.length>oe;)f(ae[oe++]);n(n.S+n.F*!V,"Symbol",{for:function(e){return a(R,e+="")?R[e]:R[e]=C(e)},keyFor:function(e){if(K(e))return g(R,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),n(n.S+n.F*!V,"Object",{create:function(e,t){return t===void 0?S(e):Q(S(e),t)},defineProperty:Z,defineProperties:Q,getOwnPropertyDescriptor:J,getOwnPropertyNames:$,getOwnPropertySymbols:ee}),M&&n(n.S+n.F*(!V||l(function(){var e=C();return"[null]"!=P([e])||"{}"!=P({a:e})||"{}"!=P(Object(e))})),"JSON",{stringify:function(e){if(!(void 0===e||K(e))){for(var t=[e],r=1,a,o;arguments.length>r;)t.push(arguments[r++]);return a=t[1],"function"==typeof a&&(o=a),(o||!h(a))&&(a=function(e,t){if(o&&(t=o.call(this,e,t)),!K(t))return t}),t[1]=a,P.apply(M,t)}}}),C[D][F]||t(42)(C[D],F,C[D].valueOf),c(C,"Symbol"),c(Math,"Math",!0),c(r.JSON,"JSON",!0)},{101:101,103:103,117:117,120:120,124:124,126:126,127:127,128:128,29:29,32:32,33:33,35:35,40:40,41:41,42:42,49:49,59:59,60:60,66:66,7:7,71:71,72:72,75:75,76:76,77:77,78:78,81:81,82:82,92:92,94:94}],255:[function(e){var t=e(33),r=e(123),a=e(122),o=e(7),n=e(114),i=e(118),s=e(51),l=e(40).ArrayBuffer,d=e(104),c=a.ArrayBuffer,u=a.DataView,p=r.ABV&&l.isView,m=c.prototype.slice,f=r.VIEW,g="ArrayBuffer";t(t.G+t.W+t.F*(l!==c),{ArrayBuffer:c}),t(t.S+t.F*!r.CONSTR,g,{isView:function(e){return p&&p(e)||s(e)&&f in e}}),t(t.P+t.U+t.F*e(35)(function(){return!new c(2).slice(1,void 0).byteLength}),g,{slice:function(e,t){if(m!==void 0&&t===void 0)return m.call(o(this),e);for(var r=o(this).byteLength,a=n(e,r),s=n(void 0===t?r:t,r),l=new(d(this,c))(i(s-a)),p=new u(this),f=new u(l),g=0;a<s;)f.setUint8(g++,p.getUint8(a++));return l}}),e(100)(g)},{100:100,104:104,114:114,118:118,122:122,123:123,33:33,35:35,40:40,51:51,7:7}],256:[function(e){var t=e(33);t(t.G+t.W+t.F*!e(123).ABV,{DataView:e(122).DataView})},{122:122,123:123,33:33}],257:[function(e){e(121)("Float32",4,function(e){return function(t,r,a){return e(this,t,r,a)}})},{121:121}],258:[function(e){e(121)("Float64",8,function(e){return function(t,r,a){return e(this,t,r,a)}})},{121:121}],259:[function(e){e(121)("Int16",2,function(e){return function(t,r,a){return e(this,t,r,a)}})},{121:121}],260:[function(e){e(121)("Int32",4,function(e){return function(t,r,a){return e(this,t,r,a)}})},{121:121}],261:[function(e){e(121)("Int8",1,function(e){return function(t,r,a){return e(this,t,r,a)}})},{121:121}],262:[function(e){e(121)("Uint16",2,function(e){return function(t,r,a){return e(this,t,r,a)}})},{121:121}],263:[function(e){e(121)("Uint32",4,function(e){return function(t,r,a){return e(this,t,r,a)}})},{121:121}],264:[function(e){e(121)("Uint8",1,function(e){return function(t,r,a){return e(this,t,r,a)}})},{121:121}],265:[function(e){e(121)("Uint8",1,function(e){return function(t,r,a){return e(this,t,r,a)}},!0)},{121:121}],266:[function(e,t){var r=e(12)(0),a=e(94),o=e(66),n=e(70),i=e(21),s=e(51),l=e(35),d=e(125),c="WeakMap",u=o.getWeak,p=Object.isExtensible,m=i.ufstore,f={},g=function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},y={get:function(e){if(s(e)){var t=u(e);return!0===t?m(d(this,c)).get(e):t?t[this._i]:void 0}},set:function(e,t){return i.def(d(this,c),e,t)}},h=t.exports=e(22)(c,g,y,i,!0,!0),v;l(function(){return 7!=new h().set((Object.freeze||Object)(f),7).get(f)})&&(v=i.getConstructor(g,c),n(v.prototype,y),o.NEED=!0,r(["delete","has","get","set"],function(e){var t=h.prototype,r=t[e];a(t,e,function(t,a){if(s(t)&&!p(t)){this._f||(this._f=new v);var o=this._f[e](t,a);return"set"==e?this:o}return r.call(this,t,a)})}))},{12:12,125:125,21:21,22:22,35:35,51:51,66:66,70:70,94:94}],267:[function(e){var t=e(21),r=e(125),a="WeakSet";e(22)(a,function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return t.def(r(this,a),e,!0)}},t,!1,!0)},{125:125,21:21,22:22}],268:[function(e){var t=e(33),r=e(38),a=e(119),o=e(118),n=e(3),i=e(15);t(t.P,"Array",{flatMap:function(e){var t=a(this),s,l;return n(e),s=o(t.length),l=i(t,0),r(l,t,t,s,0,1,e,arguments[1]),l}}),e(5)("flatMap")},{118:118,119:119,15:15,3:3,33:33,38:38,5:5}],269:[function(e){var t=e(33),r=e(38),a=e(119),o=e(118),n=e(116),i=e(15);t(t.P,"Array",{flatten:function(){var e=arguments[0],t=a(this),s=o(t.length),l=i(t,0);return r(l,t,t,s,0,void 0===e?1:n(e)),l}}),e(5)("flatten")},{116:116,118:118,119:119,15:15,33:33,38:38,5:5}],270:[function(e){var t=e(33),r=e(11)(!0);t(t.P,"Array",{includes:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0)}}),e(5)("includes")},{11:11,33:33,5:5}],271:[function(e){var t=e(33),r=e(68)(),a=e(40).process,o="process"==e(18)(a);t(t.G,{asap:function(e){var t=o&&a.domain;r(t?t.bind(e):e)}})},{18:18,33:33,40:40,68:68}],272:[function(e){var t=e(33),r=e(18);t(t.S,"Error",{isError:function(e){return"Error"===r(e)}})},{18:18,33:33}],273:[function(e){var t=e(33);t(t.G,{global:e(40)})},{33:33,40:40}],274:[function(e){e(97)("Map")},{97:97}],275:[function(e){e(98)("Map")},{98:98}],276:[function(e){var t=e(33);t(t.P+t.R,"Map",{toJSON:e(20)("Map")})},{20:20,33:33}],277:[function(e){var t=e(33);t(t.S,"Math",{clamp:function(e,t,r){return pe(r,ne(t,e))}})},{33:33}],278:[function(e){var t=e(33);t(t.S,"Math",{DEG_PER_RAD:me/180})},{33:33}],279:[function(e){var t=e(33);t(t.S,"Math",{degrees:function(e){return e*(180/me)}})},{33:33}],280:[function(e){var t=e(33),r=e(64),a=e(62);t(t.S,"Math",{fscale:function(e,t,o,n,i){return a(r(e,t,o,n,i))}})},{33:33,62:62,64:64}],281:[function(e){var t=e(33);t(t.S,"Math",{iaddh:function(e,t,r,a){var o=e>>>0,n=r>>>0;return 0|(t>>>0)+(a>>>0)+((o&n|(o|n)&~(o+n>>>0))>>>31)}})},{33:33}],282:[function(e){var t=e(33);t(t.S,"Math",{imulh:function(e,r){var a=+e,o=+r,n=a&65535,i=o&65535,s=a>>16,l=o>>16,d=(s*i>>>0)+(n*i>>>16);return s*l+(d>>16)+((n*l>>>0)+(d&65535)>>16)}})},{33:33}],283:[function(e){var t=e(33);t(t.S,"Math",{isubh:function(e,t,r,a){var o=e>>>0,n=r>>>0;return 0|(t>>>0)-(a>>>0)-((~o&n|~(o^n)&o-n>>>0)>>>31)}})},{33:33}],284:[function(e){var t=e(33);t(t.S,"Math",{RAD_PER_DEG:180/me})},{33:33}],285:[function(e){var t=e(33);t(t.S,"Math",{radians:function(e){return e*(me/180)}})},{33:33}],286:[function(e){var t=e(33);t(t.S,"Math",{scale:e(64)})},{33:33,64:64}],287:[function(e){var t=e(33);t(t.S,"Math",{signbit:function(e){return(e=+e)==e?0==e?1/e==1/0:0<e:e}})},{33:33}],288:[function(e){var t=e(33);t(t.S,"Math",{umulh:function(e,r){var a=+e,o=+r,n=a&65535,i=o&65535,s=a>>>16,l=o>>>16,d=(s*i>>>0)+(n*i>>>16);return s*l+(d>>>16)+((n*l>>>0)+(d&65535)>>>16)}})},{33:33}],289:[function(e){var t=e(33),r=e(119),a=e(3),o=e(72);e(29)&&t(t.P+e(74),"Object",{__defineGetter__:function(e,t){o.f(r(this),e,{get:a(t),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],290:[function(e){var t=e(33),r=e(119),a=e(3),o=e(72);e(29)&&t(t.P+e(74),"Object",{__defineSetter__:function(e,t){o.f(r(this),e,{set:a(t),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],291:[function(e){var t=e(33),r=e(84)(!0);t(t.S,"Object",{entries:function(e){return r(e)}})},{33:33,84:84}],292:[function(e){var t=e(33),r=e(85),a=e(117),o=e(75),n=e(24);t(t.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t=a(e),s=o.f,l=r(t),d={},c=0,u,p;l.length>c;)p=s(t,u=l[c++]),void 0!==p&&n(d,u,p);return d}})},{117:117,24:24,33:33,75:75,85:85}],293:[function(e){var t=e(33),r=e(119),a=e(120),o=e(79),n=e(75).f;e(29)&&t(t.P+e(74),"Object",{__lookupGetter__:function(e){var t=r(this),i=a(e,!0),s;do if(s=n(t,i))return s.get;while(t=o(t))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],294:[function(e){var t=e(33),r=e(119),a=e(120),o=e(79),n=e(75).f;e(29)&&t(t.P+e(74),"Object",{__lookupSetter__:function(e){var t=r(this),i=a(e,!0),s;do if(s=n(t,i))return s.set;while(t=o(t))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],295:[function(e){var t=e(33),r=e(84)(!1);t(t.S,"Object",{values:function(e){return r(e)}})},{33:33,84:84}],296:[function(e){var t=e(33),r=e(40),a=e(23),o=e(68)(),n=e(128)("observable"),i=e(3),s=e(7),l=e(6),d=e(93),c=e(42),u=e(39),p=u.RETURN,f=function(e){return null==e?void 0:i(e)},g=function(e){var t=e._c;t&&(e._c=void 0,t())},y=function(e){return e._o===void 0},h=function(e){y(e)||(e._o=void 0,g(e))},v=function(t,r){s(t),this._c=void 0,this._o=t,t=new x(this);try{var a=r(t),o=a;null!=a&&("function"==typeof a.unsubscribe?a=function(){o.unsubscribe()}:i(a),this._c=a)}catch(r){return void t.error(r)}y(this)&&g(this)};v.prototype=d({},{unsubscribe:function(){h(this)}});var x=function(e){this._s=e};x.prototype=d({},{next:function(e){var t=this._s;if(!y(t)){var r=t._o;try{var a=f(r.next);if(a)return a.call(r,e)}catch(r){try{h(t)}finally{throw r}}}},error:function(e){var t=this._s;if(y(t))throw e;var r=t._o;t._o=void 0;try{var a=f(r.error);if(!a)throw e;e=a.call(r,e)}catch(r){try{g(t)}finally{throw r}}return g(t),e},complete:function(e){var t=this._s;if(!y(t)){var r=t._o;t._o=void 0;try{var a=f(r.complete);e=a?a.call(r,e):void 0}catch(r){try{g(t)}finally{throw r}}return g(t),e}}});var _=function(e){l(this,_,"Observable","_f")._f=i(e)};d(_.prototype,{subscribe:function(e){return new v(e,this._f)},forEach:function(e){var t=this;return new(a.Promise||r.Promise)(function(r,a){i(e);var o=t.subscribe({next:function(t){try{return e(t)}catch(t){a(t),o.unsubscribe()}},error:a,complete:r})})}}),d(_,{from:function(e){var t="function"==typeof this?this:_,r=f(s(e)[n]);if(r){var a=s(r.call(e));return a.constructor===t?a:new t(function(e){return a.subscribe(e)})}return new t(function(t){var r=!1;return o(function(){if(!r){try{if(u(e,!1,function(e){if(t.next(e),r)return p})===p)return}catch(a){if(r)throw a;return void t.error(a)}t.complete()}}),function(){r=!0}})},of:function(){for(var e=0,t=arguments.length,r=Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:_)(function(e){var t=!1;return o(function(){if(!t){for(var a=0;a<r.length;++a)if(e.next(r[a]),t)return;e.complete()}}),function(){t=!0}})}}),c(_.prototype,n,function(){return this}),t(t.G,{Observable:_}),e(100)("Observable")},{100:100,128:128,23:23,3:3,33:33,39:39,40:40,42:42,6:6,68:68,7:7,93:93}],297:[function(e){var t=e(33),r=e(23),a=e(40),o=e(104),n=e(91);t(t.P+t.R,"Promise",{finally:function(t){var i=o(this,r.Promise||a.Promise),e="function"==typeof t;return this.then(e?function(e){return n(i,t()).then(function(){return e})}:t,e?function(r){return n(i,t()).then(function(){throw r})}:t)}})},{104:104,23:23,33:33,40:40,91:91}],298:[function(e){var t=e(33),r=e(69),a=e(90);t(t.S,"Promise",{try:function(e){var t=r.f(this),o=a(e);return(o.e?t.reject:t.resolve)(o.v),t.promise}})},{33:33,69:69,90:90}],299:[function(e){var t=e(67),r=e(7),a=t.key,o=t.set;t.exp({defineMetadata:function(e,t,n,i){o(e,t,r(n),a(i))}})},{67:67,7:7}],300:[function(e){var t=e(67),r=e(7),a=t.key,o=t.map,n=t.store;t.exp({deleteMetadata:function(e,t){var i=3>arguments.length?void 0:a(arguments[2]),s=o(r(t),i,!1);if(void 0===s||!s["delete"](e))return!1;if(s.size)return!0;var l=n.get(t);return l["delete"](i),!!l.size||n["delete"](t)}})},{67:67,7:7}],301:[function(e){var t=e(231),r=e(10),a=e(67),o=e(7),n=e(79),i=a.keys,s=a.key,l=function e(a,o){var s=i(a,o),l=n(a);if(null===l)return s;var d=e(l,o);return d.length?s.length?r(new t(s.concat(d))):d:s};a.exp({getMetadataKeys:function(e){return l(o(e),2>arguments.length?void 0:s(arguments[1]))}})},{10:10,231:231,67:67,7:7,79:79}],302:[function(e){var t=e(67),r=e(7),a=e(79),o=t.has,n=t.get,i=t.key,s=function e(t,r,i){var s=o(t,r,i);if(s)return n(t,r,i);var l=a(r);return null===l?void 0:e(t,l,i)};t.exp({getMetadata:function(e,t){return s(e,r(t),3>arguments.length?void 0:i(arguments[2]))}})},{67:67,7:7,79:79}],303:[function(e){var t=e(67),r=e(7),a=t.keys,o=t.key;t.exp({getOwnMetadataKeys:function(e){return a(r(e),2>arguments.length?void 0:o(arguments[1]))}})},{67:67,7:7}],304:[function(e){var t=e(67),r=e(7),a=t.get,o=t.key;t.exp({getOwnMetadata:function(e,t){return a(e,r(t),3>arguments.length?void 0:o(arguments[2]))}})},{67:67,7:7}],305:[function(e){var t=e(67),r=e(7),a=e(79),o=t.has,n=t.key,i=function e(t,r,n){var i=o(t,r,n);if(i)return!0;var s=a(r);return null!==s&&e(t,s,n)};t.exp({hasMetadata:function(e,t){return i(e,r(t),3>arguments.length?void 0:n(arguments[2]))}})},{67:67,7:7,79:79}],306:[function(e){var t=e(67),r=e(7),a=t.has,o=t.key;t.exp({hasOwnMetadata:function(e,t){return a(e,r(t),3>arguments.length?void 0:o(arguments[2]))}})},{67:67,7:7}],307:[function(e){var t=e(67),r=e(7),a=e(3),o=t.key,n=t.set;t.exp({metadata:function(e,t){return function(i,s){n(e,t,(s===void 0?a:r)(i),o(s))}}})},{3:3,67:67,7:7}],308:[function(e){e(97)("Set")},{97:97}],309:[function(e){e(98)("Set")},{98:98}],310:[function(e){var t=e(33);t(t.P+t.R,"Set",{toJSON:e(20)("Set")})},{20:20,33:33}],311:[function(e){var t=e(33),r=e(106)(!0);t(t.P,"String",{at:function(e){return r(this,e)}})},{106:106,33:33}],312:[function(e){var t=e(33),r=e(28),a=e(118),o=e(52),n=e(37),i=RegExp.prototype,s=function(e,t){this._r=e,this._s=t};e(54)(s,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),t(t.P,"String",{matchAll:function(e){if(r(this),!o(e))throw TypeError(e+" is not a regexp!");var t=this+"",l="flags"in i?e.flags+"":n.call(e),d=new RegExp(e.source,~l.indexOf("g")?l:"g"+l);return d.lastIndex=a(e.lastIndex),new s(d,t)}})},{118:118,28:28,33:33,37:37,52:52,54:54}],313:[function(e){var t=e(33),r=e(109);t(t.P,"String",{padEnd:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0,!1)}})},{109:109,33:33}],314:[function(e){var t=e(33),r=e(109);t(t.P,"String",{padStart:function(e){return r(this,e,1<arguments.length?arguments[1]:void 0,!0)}})},{109:109,33:33}],315:[function(e){e(111)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},{111:111}],316:[function(e){e(111)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},{111:111}],317:[function(e){e(126)("asyncIterator")},{126:126}],318:[function(e){e(126)("observable")},{126:126}],319:[function(e){var t=e(33);t(t.S,"System",{global:e(40)})},{33:33,40:40}],320:[function(e){e(97)("WeakMap")},{97:97}],321:[function(e){e(98)("WeakMap")},{98:98}],322:[function(e){e(97)("WeakSet")},{97:97}],323:[function(e){e(98)("WeakSet")},{98:98}],324:[function(e){for(var t=e(141),r=e(81),a=e(94),o=e(40),n=e(42),s=e(58),l=e(128),d=l("iterator"),c=l("toStringTag"),u=s.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},m=r(p),f=0;f<m.length;f++){var g=m[f],y=p[g],h=o[g],v=h&&h.prototype,x;if(v&&(v[d]||n(v,d,u),v[c]||n(v,c,g),s[g]=u,y))for(x in t)v[x]||a(v,x,t[x],!0)}},{128:128,141:141,40:40,42:42,58:58,81:81,94:94}],325:[function(e){var t=e(33),r=e(113);t(t.G+t.B,{setImmediate:r.set,clearImmediate:r.clear})},{113:113,33:33}],326:[function(e){var t=e(40),r=e(33),a=e(46),o=e(88),n=t.navigator,i=!!n&&/MSIE .\./.test(n.userAgent),s=function(e){return i?function(t,r){return e(a(o,[].slice.call(arguments,2),"function"==typeof t?t:Function(t)),r)}:e};r(r.G+r.B+r.F*i,{setTimeout:s(t.setTimeout),setInterval:s(t.setInterval)})},{33:33,40:40,46:46,88:88}],327:[function(e,t){e(254),e(191),e(193),e(192),e(195),e(197),e(202),e(196),e(194),e(204),e(203),e(199),e(200),e(198),e(190),e(201),e(205),e(206),e(157),e(159),e(158),e(208),e(207),e(178),e(188),e(189),e(179),e(180),e(181),e(182),e(183),e(184),e(185),e(186),e(187),e(161),e(162),e(163),e(164),e(165),e(166),e(167),e(168),e(169),e(170),e(171),e(172),e(173),e(174),e(175),e(176),e(177),e(241),e(246),e(253),e(244),e(236),e(237),e(242),e(247),e(249),e(232),e(233),e(234),e(235),e(238),e(239),e(240),e(243),e(245),e(248),e(250),e(251),e(252),e(152),e(154),e(153),e(156),e(155),e(140),e(138),e(145),e(142),e(148),e(150),e(137),e(144),e(134),e(149),e(132),e(147),e(146),e(139),e(143),e(131),e(133),e(136),e(135),e(151),e(141),e(224),e(230),e(225),e(226),e(227),e(228),e(229),e(209),e(160),e(231),e(266),e(267),e(255),e(256),e(261),e(264),e(265),e(259),e(262),e(260),e(263),e(257),e(258),e(210),e(211),e(212),e(213),e(214),e(217),e(215),e(216),e(218),e(219),e(220),e(221),e(223),e(222),e(270),e(268),e(269),e(311),e(314),e(313),e(315),e(316),e(312),e(317),e(318),e(292),e(295),e(291),e(289),e(290),e(293),e(294),e(276),e(310),e(275),e(309),e(321),e(323),e(274),e(308),e(320),e(322),e(273),e(319),e(272),e(277),e(278),e(279),e(280),e(281),e(283),e(282),e(284),e(285),e(286),e(288),e(287),e(297),e(298),e(299),e(300),e(302),e(301),e(304),e(303),e(305),e(306),e(307),e(271),e(296),e(326),e(325),e(324),t.exports=e(23)},{131:131,132:132,133:133,134:134,135:135,136:136,137:137,138:138,139:139,140:140,141:141,142:142,143:143,144:144,145:145,146:146,147:147,148:148,149:149,150:150,151:151,152:152,153:153,154:154,155:155,156:156,157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,23:23,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:256,257:257,258:258,259:259,260:260,261:261,262:262,263:263,264:264,265:265,266:266,267:267,268:268,269:269,270:270,271:271,272:272,273:273,274:274,275:275,276:276,277:277,278:278,279:279,280:280,281:281,282:282,283:283,284:284,285:285,286:286,287:287,288:288,289:289,290:290,291:291,292:292,293:293,294:294,295:295,296:296,297:297,298:298,299:299,300:300,301:301,302:302,303:303,304:304,305:305,306:306,307:307,308:308,309:309,310:310,311:311,312:312,313:313,314:314,315:315,316:316,317:317,318:318,319:319,320:320,321:321,322:322,323:323,324:324,325:325,326:326}],328:[function(t,r){(function(t){!function(t){function a(e,t,r,a){var o=t&&t.prototype instanceof n?t:n,i=Object.create(o.prototype),s=new f(a||[]);return i._invoke=c(e,r,s),i}function o(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function n(){}function i(){}function s(){}function l(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function d(r){function a(t,n,i,s){var l=o(r[t],r,n);if("throw"===l.type)s(l.arg);else{var d=l.arg,c=d.value;return c&&"object"===e(c)&&v.call(c,"__await")?Promise.resolve(c.__await).then(function(e){a("next",e,i,s)},function(e){a("throw",e,i,s)}):Promise.resolve(c).then(function(e){d.value=e,i(d)},s)}}function n(e,t){function r(){return new Promise(function(r,o){a(e,t,r,o)})}return i=i?i.then(r,r):r()}"object"===e(t.process)&&t.process.domain&&(a=t.process.domain.bind(a));var i;this._invoke=n}function c(e,t,r){var a="suspendedStart";return function(n,i){if(a==="executing")throw new Error("Generator is already running");if("completed"===a){if("throw"===n)throw i;return y()}for(r.method=n,r.arg=i;;){var s=r.delegate;if(s){var l=u(s,r);if(l){if(l===T)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===a)throw a="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a="executing";var d=o(e,t,r);if("normal"===d.type){if(a=r.done?"completed":"suspendedYield",d.arg===T)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(a="completed",r.method="throw",r.arg=d.arg)}}}function u(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=void 0,u(e,t),"throw"===t.method))return T;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return T}var a=o(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,T;var n=a.arg;if(!n)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,T;if(n.done)t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0);else return n;return t.delegate=null,T}function p(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function m(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function f(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(p,this),this.reset(!0)}function g(e){if(e){var t=e[_];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(v.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:y}}function y(){return{value:void 0,done:!0}}var h=Object.prototype,v=h.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},_=x.iterator||"@@iterator",b=x.asyncIterator||"@@asyncIterator",S=x.toStringTag||"@@toStringTag",E="object"===e(r),A=t.regeneratorRuntime;if(A)return void(E&&(r.exports=A));A=t.regeneratorRuntime=E?r.exports:{},A.wrap=a;var T={},k={};k[_]=function(){return this};var B=Object.getPrototypeOf,O=B&&B(B(g([])));O&&O!==h&&v.call(O,_)&&(k=O);var w=s.prototype=n.prototype=Object.create(k);i.prototype=w.constructor=s,s.constructor=i,s[S]=i.displayName="GeneratorFunction",A.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===i||"GeneratorFunction"===(t.displayName||t.name))},A.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,!(S in e)&&(e[S]="GeneratorFunction")),e.prototype=Object.create(w),e},A.awrap=function(e){return{__await:e}},l(d.prototype),d.prototype[b]=function(){return this},A.AsyncIterator=d,A.async=function(e,t,r,o){var n=new d(a(e,t,r,o));return A.isGeneratorFunction(t)?n:n.next().then(function(e){return e.done?e.value:n.next()})},l(w),w[S]="Generator",w[_]=function(){return this},w.toString=function(){return"[object Generator]"},A.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var a=t.pop();if(a in e)return r.value=a,r.done=!1,r}return r.done=!0,r}},A.values=g,f.prototype={constructor:f,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(m),!e)for(var t in this)"t"===t.charAt(0)&&v.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,a){return n.type="throw",n.arg=e,r.next=t,a&&(r.method="next",r.arg=void 0),!!a}if(this.done)throw e;for(var r=this,a=this.tryEntries.length-1;0<=a;--a){var o=this.tryEntries[a],n=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var s=v.call(o,"catchLoc"),l=v.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);}else if(!l)throw new Error("try statement without catch or finally");else if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1,a;0<=r;--r)if(a=this.tryEntries[r],a.tryLoc<=this.prev&&v.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var n=o?o.completion:{};return n.type=e,n.arg=t,o?(this.method="next",this.next=o.finallyLoc,T):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),T},finish:function(e){for(var t=this.tryEntries.length-1,r;0<=t;--t)if(r=this.tryEntries[t],r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),m(r),T},catch:function(e){for(var t=this.tryEntries.length-1,r;0<=t;--t)if(r=this.tryEntries[t],r.tryLoc===e){var a=r.completion;if("throw"===a.type){var o=a.arg;m(r)}return o}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:g(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),T}}}("object"===e(t)?t:"object"===("undefined"==typeof window?"undefined":e(window))?window:"object"===("undefined"==typeof self?"undefined":e(self))?self:this)}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}]},{},[1]),function(){function t(e,r){function o(e,t){return function(){return e.apply(t,arguments)}}var n;if(r=r||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=r.touchBoundary||10,this.layer=e,this.tapDelay=r.tapDelay||200,this.tapTimeout=r.tapTimeout||700,!t.notNeeded(e)){for(var s=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],d=this,c=0,u=s.length;void 0>c;c++)d[s[c]]=o(d[s[c]],d);a&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,r,a){var o=Node.prototype.removeEventListener;"click"===t?o.call(e,t,r.hijacked||r,a):o.call(e,t,r,a)},e.addEventListener=function(t,r,a){var o=Node.prototype.addEventListener;"click"===t?o.call(e,t,r.hijacked||(r.hijacked=function(e){e.propagationStopped||r(e)}),a):o.call(e,t,r,a)}),"function"==typeof e.onclick&&(n=e.onclick,e.addEventListener("click",function(e){n(e)},!1),e.onclick=null)}}var r=0<=navigator.userAgent.indexOf("Windows Phone"),a=0<navigator.userAgent.indexOf("Android")&&!r,o=/iP(ad|hone|od)/.test(navigator.userAgent)&&!r,n=o&&/OS 4_\d(_\d)?/.test(navigator.userAgent),i=o&&/OS [6-7]_\d/.test(navigator.userAgent),s=0<navigator.userAgent.indexOf("BB10");t.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(o&&"file"===e.type||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0;}return /\bneedsclick\b/.test(e.className)},t.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!a;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1;}return!e.disabled&&!e.readOnly;default:return /\bneedsfocus\b/.test(e.className);}},t.prototype.sendClick=function(e,t){var r,a;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),a=t.changedTouches[0],r=document.createEvent("MouseEvents"),r.initMouseEvent(this.determineEventType(e),!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),r.forwardedTouchEvent=!0,e.dispatchEvent(r)},t.prototype.determineEventType=function(e){return a&&"select"===e.tagName.toLowerCase()?"mousedown":"click"},t.prototype.focus=function(e){var t;o&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type&&"month"!==e.type?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},t.prototype.updateScrollParent=function(e){var t,r;if(t=e.fastClickScrollParent,!t||!t.contains(e)){r=e;do{if(r.scrollHeight>r.offsetHeight){t=r,e.fastClickScrollParent=r;break}r=r.parentElement}while(r)}t&&(t.fastClickLastScrollTop=t.scrollTop)},t.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},t.prototype.onTouchStart=function(e){var t,r,a;if(1<e.targetTouches.length)return!0;if(t=this.getTargetElementFromEventTarget(e.target),r=e.targetTouches[0],o){if(a=window.getSelection(),a.rangeCount&&!a.isCollapsed)return!0;if(!n){if(r.identifier&&r.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=r.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=r.pageX,this.touchStartY=r.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},t.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],r=this.touchBoundary;return!!(ye(t.pageX-this.touchStartX)>r||ye(t.pageY-this.touchStartY)>r)},t.prototype.onTouchMove=function(e){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0)},t.prototype.findControl=function(e){return void 0===e.control?e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea"):e.control},t.prototype.onTouchEnd=function(e){var t=this.targetElement,r,s,l,d,c;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,s=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,i&&(c=e.changedTouches[0],t=document.elementFromPoint(c.pageX-window.pageXOffset,c.pageY-window.pageYOffset)||t,t.fastClickScrollParent=this.targetElement.fastClickScrollParent),l=t.tagName.toLowerCase(),"label"===l){if(r=this.findControl(t),r){if(this.focus(t),a)return!1;t=r}}else if(this.needsFocus(t))return 100<e.timeStamp-s||o&&window.top!==window&&"input"===l?(this.targetElement=null,!1):(this.focus(t),this.sendClick(t,e),o&&"select"===l||(this.targetElement=null,e.preventDefault()),!1);return!!(o&&!n&&(d=t.fastClickScrollParent,d&&d.fastClickLastScrollTop!==d.scrollTop))||(this.needsClick(t)||(e.preventDefault(),this.sendClick(t,e)),!1)},t.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},t.prototype.onMouse=function(e){return!this.targetElement||!!e.forwardedTouchEvent||!e.cancelable||this.needsClick(this.targetElement)&&!this.cancelNextClick||(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1)},t.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):!("submit"!==e.target.type||0!==e.detail)||(t=this.onMouse(e),t||(this.targetElement=null),t)},t.prototype.destroy=function(){var e=this.layer;a&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},t.notNeeded=function(e){var t,r,o,n;if("undefined"==typeof window.ontouchstart)return!0;if(r=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],r){if(!a)return!0;if(t=document.querySelector("meta[name=viewport]"),t){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(31<r&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(s&&(o=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),10<=o[1]&&3<=o[2]&&(t=document.querySelector("meta[name=viewport]"),t))){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===e.style.msTouchAction||"manipulation"===e.style.touchAction||(n=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],!!(27<=n&&(t=document.querySelector("meta[name=viewport]"),t&&(-1!==t.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth)))||"none"===e.style.touchAction||"manipulation"===e.style.touchAction)},t.attach=function(e,r){return new t(e,r)},"function"==typeof define&&"object"===e(define.amd)&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports?(module.exports=t.attach,module.exports.FastClick=t):window.FastClick=t}(),!function(){var s=function(){this.init()};s.prototype={init:function(){var t=this||x;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(i){var s=this||x;if(i=parseFloat(i),s.ctx||n(),void 0!==i&&0<=i&&1>=i){if(s._volume=i,s._muted)return s;s.usingWebAudio&&s.masterGain.gain.setValueAtTime(i,x.ctx.currentTime);for(var o=0;o<s._howls.length;o++)if(!s._howls[o]._webAudio)for(var l=s._howls[o]._getSoundIds(),r=0,d;r<l.length;r++)d=s._howls[o]._soundById(l[r]),d&&d._node&&(d._node.volume=d._volume*i);return s}return s._volume},mute:function(i){var e=this||x;e.ctx||n(),e._muted=i,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(i?0:e._volume,x.ctx.currentTime);for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var s=e._howls[o]._getSoundIds(),r=0,l;r<s.length;r++)l=e._howls[o]._soundById(s[r]),l&&l._node&&(l._node.muted=!!i||l._muted);return e},unload:function(){for(var t=this||x,e=t._howls.length-1;0<=e;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,n()),t},codecs:function(t){return(this||x)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||x;if(t.state=t.ctx?t.ctx.state||"suspended":"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{var e=new Audio;void 0===e.oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{var e=new Audio;e.muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var i=this||x,e=null;try{e="undefined"==typeof Audio?null:new Audio}catch(e){return i}if(!e||"function"!=typeof e.canPlayType)return i;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),t=i._navigator&&i._navigator.userAgent.match(/OPR\/([0-6].)/g),r=t&&33>parseInt(t[0].split("/")[1],10);return i._codecs={mp3:!r&&(n||e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType("audio/ogg; codecs=\"opus\"").replace(/^no$/,""),ogg:!!e.canPlayType("audio/ogg; codecs=\"vorbis\"").replace(/^no$/,""),oga:!!e.canPlayType("audio/ogg; codecs=\"vorbis\"").replace(/^no$/,""),wav:!!e.canPlayType("audio/wav; codecs=\"1\"").replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!e.canPlayType("audio/webm; codecs=\"vorbis\"").replace(/^no$/,""),webm:!!e.canPlayType("audio/webm; codecs=\"vorbis\"").replace(/^no$/,""),dolby:!!e.canPlayType("audio/mp4; codecs=\"ec-3\"").replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var s=this||x;if(!s._audioUnlocked&&s.ctx){s._audioUnlocked=!1,s.autoUnlock=!1,s._mobileUnloaded||44100===s.ctx.sampleRate||(s._mobileUnloaded=!0,s.unload()),s._scratchBuffer=s.ctx.createBuffer(1,1,22050);var e=function e(){for(var o=0;o<s.html5PoolSize;o++)try{var n=new Audio;n._unlocked=!0,s._releaseHtml5Audio(n)}catch(e){s.noAudio=!0}for(var o=0;o<s._howls.length;o++)if(!s._howls[o]._webAudio)for(var r=s._howls[o]._getSoundIds(),a=0,l;a<r.length;a++)l=s._howls[o]._soundById(r[a]),l&&l._node&&!l._node._unlocked&&(l._node._unlocked=!0,l._node.load());s._autoResume();var c=s.ctx.createBufferSource();c.buffer=s._scratchBuffer,c.connect(s.ctx.destination),void 0===c.start?c.noteOn(0):c.start(0),"function"==typeof s.ctx.resume&&s.ctx.resume(),c.onended=function(){c.disconnect(0),s._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0);for(var t=0;t<s._howls.length;t++)s._howls[t]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),s}},_obtainHtml5Audio:function(){var t=this||x;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=new Audio().play();return e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)&&e["catch"](function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(t){var e=this||x;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var r=this;if(r.autoSuspend&&r.ctx&&void 0!==r.ctx.suspend&&x.usingWebAudio){for(var e=0;e<r._howls.length;e++)if(r._howls[e]._webAudio)for(var a=0;a<r._howls[e]._sounds.length;a++)if(!r._howls[e]._sounds[a]._paused)return r;return r._suspendTimer&&clearTimeout(r._suspendTimer),r._suspendTimer=setTimeout(function(){r.autoSuspend&&(r._suspendTimer=null,r.state="suspending",r.ctx.suspend().then(function(){r.state="suspended",r._resumeAfterSuspend&&(delete r._resumeAfterSuspend,r._autoResume())}))},3e4),r}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&x.usingWebAudio)return"running"===t.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state?(t.ctx.resume().then(function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")}),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var x=new s,e=function(t){var e=this;return t.src&&0!==t.src.length?void e.init(t):void console.error("An array of source files must be passed with any new Howl.")};e.prototype={init:function(t){var e=this;return x.ctx||n(),e._autoplay=t.autoplay||!1,e._format="string"==typeof t.format?[t.format]:t.format,e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!=typeof t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"==typeof t.src?[t.src]:t.src,e._volume=void 0===t.volume?1:t.volume,e._xhrWithCredentials=t.xhrWithCredentials||!1,e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=x.usingWebAudio&&!e._html5,void 0!==x.ctx&&x.ctx&&x.autoUnlock&&x._unlockAudio(),x._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&e.load(),e},load:function(){var a=this,e=null;if(x.noAudio)return void a._emit("loaderror",null,"No audio support.");"string"==typeof a._src&&(a._src=[a._src]);for(var n=0;n<a._src.length;n++){var s,d;if(a._format&&a._format[n])s=a._format[n];else{if("string"!=typeof(d=a._src[n])){a._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}s=/^data:audio\/([^;,]+);/i.exec(d),s||(s=/\.([^.]+)$/.exec(d.split("?",1)[0])),s&&(s=s[1].toLowerCase())}if(s||console.warn("No file extension was found. Consider using the \"format\" property or specify an extension."),s&&x.codecs(s)){e=a._src[n];break}}return e?(a._src=e,a._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(a._html5=!0,a._webAudio=!1),new l(a),a._webAudio&&t(a),a):void a._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(n,b){var o=this,t=null;if("number"==typeof n)t=n,n=null;else{if("string"==typeof n&&"loaded"===o._state&&!o._sprite[n])return null;if(void 0===n&&(n="__default",!o._playLock)){for(var S=0,E=0;E<o._sounds.length;E++)o._sounds[E]._paused&&!o._sounds[E]._ended&&(S++,t=o._sounds[E]._id);1==S?n=null:t=null}}var T=t?o._soundById(t):o._inactiveSound();if(!T)return null;if(t&&!n&&(n=T._sprite||"__default"),"loaded"!==o._state){T._sprite=n,T._ended=!1;var i=T._id;return o._queue.push({event:"play",action:function(){o.play(i)}}),i}if(t&&!T._paused)return b||o._loadQueue("play"),T._id;o._webAudio&&x._autoResume();var d=ne(0,0<T._seek?T._seek:o._sprite[n][0]/1e3),_=ne(0,(o._sprite[n][0]+o._sprite[n][1])/1e3-d),s=1e3*_/ye(T._rate),l=o._sprite[n][0]/1e3,c=(o._sprite[n][0]+o._sprite[n][1])/1e3,f=T._loop||o._sprite[n][2];T._sprite=n,T._ended=!1;var p=function(){T._paused=!1,T._seek=d,T._start=l,T._stop=c,T._loop=f};if(d>=c)return void o._ended(T);var m=T._node;if(o._webAudio){var v=function(){o._playLock=!1,p(),o._refreshBuffer(T);var t=T._muted||o._muted?0:T._volume;m.gain.setValueAtTime(t,x.ctx.currentTime),T._playStart=x.ctx.currentTime,void 0===m.bufferSource.start?T._loop?m.bufferSource.noteGrainOn(0,d,86400):m.bufferSource.noteGrainOn(0,d,_):T._loop?m.bufferSource.start(0,d,86400):m.bufferSource.start(0,d,_),s!=1/0&&(o._endTimers[T._id]=setTimeout(o._ended.bind(o,T),s)),b||setTimeout(function(){o._emit("play",T._id),o._loadQueue()},0)};"running"===x.state?v():(o._playLock=!0,o.once("resume",v),o._clearTimer(T._id))}else{var h=function(){m.currentTime=d,m.muted=T._muted||o._muted||x._muted||m.muted,m.volume=T._volume*x.volume(),m.playbackRate=T._rate;try{var e=m.play();if(e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)?(o._playLock=!0,p(),e.then(function(){o._playLock=!1,m._unlocked=!0,b||(o._emit("play",T._id),o._loadQueue())})["catch"](function(){o._playLock=!1,o._emit("playerror",T._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),T._ended=!0,T._paused=!0})):b||(o._playLock=!1,p(),o._emit("play",T._id),o._loadQueue()),m.playbackRate=T._rate,m.paused)return void o._emit("playerror",T._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==n||T._loop?o._endTimers[T._id]=setTimeout(o._ended.bind(o,T),s):(o._endTimers[T._id]=function(){o._ended(T),m.removeEventListener("ended",o._endTimers[T._id],!1)},m.addEventListener("ended",o._endTimers[T._id],!1))}catch(t){o._emit("playerror",T._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=o._src,m.load());var y=window&&window.ejecta||!m.readyState&&x._navigator.isCocoonJS;if(3<=m.readyState||y)h();else{o._playLock=!0;var g=function e(){h(),m.removeEventListener(x._canPlayEvent,e,!1)};m.addEventListener(x._canPlayEvent,g,!1),o._clearTimer(T._id)}}return T._id},pause:function(a){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(a)}}),e;for(var n=e._getSoundIds(a),o=0;o<n.length;o++){e._clearTimer(n[o]);var i=e._soundById(n[o]);if(i&&!i._paused&&(i._seek=e.seek(n[o]),i._rateSeek=0,i._paused=!0,e._stopFade(n[o]),i._node))if(e._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),e._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();arguments[1]||e._emit("pause",i?i._id:null)}return e},stop:function(i,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(i)}}),n;for(var o=n._getSoundIds(i),t=0;t<o.length;t++){n._clearTimer(o[t]);var s=n._soundById(o[t]);s&&(s._seek=s._start||0,s._rateSeek=0,s._paused=!0,s._ended=!0,n._stopFade(o[t]),s._node&&(n._webAudio?s._node.bufferSource&&(void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),n._cleanBuffer(s._node)):isNaN(s._node.duration)&&s._node.duration!==1/0||(s._node.currentTime=s._start||0,s._node.pause(),s._node.duration===1/0&&n._clearSound(s._node))),e||n._emit("stop",s._id))}return n},mute:function(n,e){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"mute",action:function(){o.mute(n,e)}}),o;if(void 0===e){if("boolean"!=typeof n)return o._muted;o._muted=n}for(var t=o._getSoundIds(e),r=0,i;r<t.length;r++)i=o._soundById(t[r]),i&&(i._muted=n,i._interval&&o._stopFade(i._id),o._webAudio&&i._node?i._node.gain.setValueAtTime(n?0:i._volume,x.ctx.currentTime):i._node&&(i._node.muted=!!x._muted||n),o._emit("mute",i._id));return o},volume:function(){var n=this,t=arguments,r,i;if(0===t.length)return n._volume;1===t.length||2===t.length&&void 0===t[1]?0<=n._getSoundIds().indexOf(t[0])?i=parseInt(t[0],10):r=parseFloat(t[0]):2<=t.length&&(r=parseFloat(t[0]),i=parseInt(t[1],10));var s;if(!(void 0!==r&&0<=r&&1>=r))return s=i?n._soundById(i):n._sounds[0],s?s._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,t)}}),n;void 0===i&&(n._volume=r),i=n._getSoundIds(i);for(var l=0;l<i.length;l++)(s=n._soundById(i[l]))&&(s._volume=r,t[2]||n._stopFade(i[l]),n._webAudio&&s._node&&!s._muted?s._node.gain.setValueAtTime(r,x.ctx.currentTime):s._node&&!s._muted&&(s._node.volume=r*x.volume()),n._emit("volume",s._id));return n},fade:function(n,l,c,p){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(n,l,c,p)}}),r;n=parseFloat(n),l=parseFloat(l),c=parseFloat(c),r.volume(n,p);for(var a=r._getSoundIds(p),u=0,m;u<a.length;u++)if(m=r._soundById(a[u]),m){if(p||r._stopFade(a[u]),r._webAudio&&!m._muted){var f=x.ctx.currentTime,g=f+c/1e3;m._volume=n,m._node.gain.setValueAtTime(n,f),m._node.gain.linearRampToValueAtTime(l,g)}r._startFadeInterval(m,n,l,c,a[u],void 0===p)}return r},_startFadeInterval:function(c,e,n,o,t,p){var a=this,u=e,m=n-e,r=ye(m/.01),d=ne(4,0<r?o/r:o),s=Date.now();c._fadeTo=n,c._interval=setInterval(function(){var t=(Date.now()-s)/o;s=Date.now(),u+=m*t,u=ne(0,u),u=pe(1,u),u=oe(100*u)/100,a._webAudio?c._volume=u:a.volume(u,c._id,!0),p&&(a._volume=u),(n<e&&u<=n||n>e&&u>=n)&&(clearInterval(c._interval),c._interval=null,c._fadeTo=null,a.volume(n,c._id),a._emit("fade",c._id))},d)},_stopFade:function(r){var e=this,a=e._soundById(r);return a&&a._interval&&(e._webAudio&&a._node.gain.cancelScheduledValues(x.ctx.currentTime),clearInterval(a._interval),a._interval=null,e.volume(a._fadeTo,r),a._fadeTo=null,e._emit("fade",r)),e},loop:function(){var i=this,t=arguments,r,s,l;if(0===t.length)return i._loop;if(1===t.length){if("boolean"!=typeof t[0])return!!(l=i._soundById(parseInt(t[0],10)))&&l._loop;r=t[0],i._loop=r}else 2===t.length&&(r=t[0],s=parseInt(t[1],10));for(var d=i._getSoundIds(s),a=0;a<d.length;a++)(l=i._soundById(d[a]))&&(l._loop=r,i._webAudio&&l._node&&l._node.bufferSource&&(l._node.bufferSource.loop=r,r&&(l._node.bufferSource.loopStart=l._start||0,l._node.bufferSource.loopEnd=l._stop)));return i},rate:function(){var n=this,t=arguments,r,c;if(0===t.length)c=n._sounds[0]._id;else if(1===t.length){var p=n._getSoundIds(),a=p.indexOf(t[0]);0<=a?c=parseInt(t[0],10):r=parseFloat(t[0])}else 2===t.length&&(r=parseFloat(t[0]),c=parseInt(t[1],10));var u;if("number"!=typeof r)return u=n._soundById(c),u?u._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,t)}}),n;void 0===c&&(n._rate=r),c=n._getSoundIds(c);for(var m=0;m<c.length;m++)if(u=n._soundById(c[m])){n.playing(c[m])&&(u._rateSeek=n.seek(c[m]),u._playStart=n._webAudio?x.ctx.currentTime:u._playStart),u._rate=r,n._webAudio&&u._node&&u._node.bufferSource?u._node.bufferSource.playbackRate.setValueAtTime(r,x.ctx.currentTime):u._node&&(u._node.playbackRate=r);var f=n.seek(c[m]),g=(n._sprite[u._sprite][0]+n._sprite[u._sprite][1])/1e3-f,s=1e3*g/ye(u._rate);!n._endTimers[c[m]]&&u._paused||(n._clearTimer(c[m]),n._endTimers[c[m]]=setTimeout(n._ended.bind(n,u),s)),n._emit("rate",u._id)}return n},seek:function(){var n=this,t=arguments,r,p;if(0===t.length)p=n._sounds[0]._id;else if(1===t.length){var m=n._getSoundIds(),a=m.indexOf(t[0]);0<=a?p=parseInt(t[0],10):n._sounds.length&&(p=n._sounds[0]._id,r=parseFloat(t[0]))}else 2===t.length&&(r=parseFloat(t[0]),p=parseInt(t[1],10));if(void 0===p)return n;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"seek",action:function(){n.seek.apply(n,t)}}),n;var u=n._soundById(p);if(u){if(!("number"==typeof r&&0<=r)){if(n._webAudio){var i=n.playing(p)?x.ctx.currentTime-u._playStart:0,d=u._rateSeek?u._rateSeek-u._seek:0;return u._seek+(d+i*ye(u._rate))}return u._node.currentTime}var f=n.playing(p);f&&n.pause(p,!0),u._seek=r,u._ended=!1,n._clearTimer(p),n._webAudio||!u._node||isNaN(u._node.duration)||(u._node.currentTime=r);var s=function(){n._emit("seek",p),f&&n.play(p,!0)};if(f&&!n._webAudio){var l=function e(){n._playLock?setTimeout(e,0):s()};setTimeout(l,0)}else s()}return n},playing:function(r){var e=this;if("number"==typeof r){var a=e._soundById(r);return!!a&&!a._paused}for(var o=0;o<e._sounds.length;o++)if(!e._sounds[o]._paused)return!0;return!1},duration:function(r){var e=this,a=e._duration,n=e._soundById(r);return n&&(a=e._sprite[n._sprite][1]/1e3),a},state:function(){return this._state},unload:function(){for(var r=this,n=r._sounds,o=0;o<n.length;o++)n[o]._paused||r.stop(n[o]._id),r._webAudio||(r._clearSound(n[o]._node),n[o]._node.removeEventListener("error",n[o]._errorFn,!1),n[o]._node.removeEventListener(x._canPlayEvent,n[o]._loadFn,!1),x._releaseHtml5Audio(n[o]._node)),delete n[o]._node,r._clearTimer(n[o]._id);var i=x._howls.indexOf(r);0<=i&&x._howls.splice(i,1);var a=!0;for(o=0;o<x._howls.length;o++)if(x._howls[o]._src===r._src||0<=r._src.indexOf(x._howls[o]._src)){a=!1;break}return c&&a&&delete c[r._src],x.noAudio=!1,r._state="unloaded",r._sounds=[],r=null,null},on:function(i,e,n,o){var t=this,r=t["_on"+i];return"function"==typeof e&&r.push(o?{id:n,fn:e,once:o}:{id:n,fn:e}),t},off:function(s,e,l){var d=this,t=d["_on"+s],r=0;if("number"==typeof e&&(l=e,e=null),e||l)for(r=0;r<t.length;r++){var c=l===t[r].id;if(e===t[r].fn&&c||!e&&c){t.splice(r,1);break}}else if(s)d["_on"+s]=[];else{var u=Object.keys(d);for(r=0;r<u.length;r++)0===u[r].indexOf("_on")&&Array.isArray(d[u[r]])&&(d[u[r]]=[])}return d},once:function(r,e,a){var o=this;return o.on(r,e,a,1),o},_emit:function(i,s,n){for(var e=this,t=e["_on"+i],r=t.length-1;0<=r;r--)t[r].id&&t[r].id!==s&&"load"!==i||(setTimeout(function(t){t.call(this,s,n)}.bind(e,t[r].fn),0),t[r].once&&e.off(i,t[r].fn,t[r].id));return e._loadQueue(i),e},_loadQueue:function(t){var e=this;if(0<e._queue.length){var r=e._queue[0];r.event===t&&(e._queue.shift(),e._loadQueue()),t||r.action()}return e},_ended:function(n){var e=this,o=n._sprite;if(!e._webAudio&&n._node&&!n._node.paused&&!n._node.ended&&n._node.currentTime<n._stop)return setTimeout(e._ended.bind(e,n),100),e;var t=n._loop||e._sprite[o][2];if(e._emit("end",n._id),!e._webAudio&&t&&e.stop(n._id,!0).play(n._id),e._webAudio&&t){e._emit("play",n._id),n._seek=n._start||0,n._rateSeek=0,n._playStart=x.ctx.currentTime;var r=1e3*(n._stop-n._start)/ye(n._rate);e._endTimers[n._id]=setTimeout(e._ended.bind(e,n),r)}return e._webAudio&&!t&&(n._paused=!0,n._ended=!0,n._seek=n._start||0,n._rateSeek=0,e._clearTimer(n._id),e._cleanBuffer(n._node),x._autoSuspend()),e._webAudio||t||e.stop(n._id,!0),e},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var r=e._soundById(t);r&&r._node&&r._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,r=0;r<e._sounds.length;r++)if(t===e._sounds[r]._id)return e._sounds[r];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new l(t)},_drain:function(){var r=this,e=r._pool,a=0,n=0;if(!(r._sounds.length<e)){for(n=0;n<r._sounds.length;n++)r._sounds[n]._ended&&a++;for(n=r._sounds.length-1;0<=n;n--){if(a<=e)return;r._sounds[n]._ended&&(r._webAudio&&r._sounds[n]._node&&r._sounds[n]._node.disconnect(0),r._sounds.splice(n,1),a--)}}},_getSoundIds:function(r){var e=this;if(void 0===r){for(var a=[],o=0;o<e._sounds.length;o++)a.push(e._sounds[o]._id);return a}return[r]},_refreshBuffer:function(t){var e=this;return t._node.bufferSource=x.ctx.createBufferSource(),t._node.bufferSource.buffer=c[e._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,x.ctx.currentTime),e},_cleanBuffer:function(r){var e=this,a=x._navigator&&0<=x._navigator.vendor.indexOf("Apple");if(x._scratchBuffer&&r.bufferSource&&(r.bufferSource.onended=null,r.bufferSource.disconnect(0),a))try{r.bufferSource.buffer=x._scratchBuffer}catch(t){}return r.bufferSource=null,e},_clearSound:function(t){/MSIE |Trident\//.test(x._navigator&&x._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var l=function(t){this._parent=t,this.init()};l.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++x._counter,e._sounds.push(t),t.create(),t},create:function(){var r=this,e=r._parent,a=x._muted||r._muted||r._parent._muted?0:r._volume;return e._webAudio?(r._node=void 0===x.ctx.createGain?x.ctx.createGainNode():x.ctx.createGain(),r._node.gain.setValueAtTime(a,x.ctx.currentTime),r._node.paused=!0,r._node.connect(x.masterGain)):(r._node=x._obtainHtml5Audio(),r._errorFn=r._errorListener.bind(r),r._node.addEventListener("error",r._errorFn,!1),r._loadFn=r._loadListener.bind(r),r._node.addEventListener(x._canPlayEvent,r._loadFn,!1),r._node.src=e._src,r._node.preload="auto",r._node.volume=a*x.volume(),r._node.load()),r},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++x._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,e=t._parent;e._duration=ie(10*t._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),t._node.removeEventListener(x._canPlayEvent,t._loadFn,!1)}};var c={},t=function s(l){var e=l._src;if(c[e])return l._duration=c[e].duration,void i(l);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),o=new Uint8Array(n.length),s=0;s<n.length;++s)o[s]=n.charCodeAt(s);u(o.buffer,l)}else{var t=new XMLHttpRequest;t.open("GET",e,!0),t.withCredentials=l._xhrWithCredentials,t.responseType="arraybuffer",t.onload=function(){var e=(t.status+"")[0];return"0"!==e&&"2"!==e&&"3"!==e?void l._emit("loaderror",null,"Failed loading audio file with status: "+t.status+"."):void u(t.response,l)},t.onerror=function(){l._webAudio&&(l._html5=!0,l._webAudio=!1,l._sounds=[],delete c[e],l.load())},r(t)}},r=function(t){try{t.send()}catch(e){t.onerror()}},u=function(r,n){var o=function(){n._emit("loaderror",null,"Decoding audio data failed.")},e=function(t){t&&0<n._sounds.length?(c[n._src]=t,i(n,t)):o()};"undefined"!=typeof Promise&&1===x.ctx.decodeAudioData.length?x.ctx.decodeAudioData(r).then(e)["catch"](o):x.ctx.decodeAudioData(r,e,o)},i=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},n=function(){if(x.usingWebAudio){try{"undefined"==typeof AudioContext?"undefined"==typeof webkitAudioContext?x.usingWebAudio=!1:x.ctx=new webkitAudioContext:x.ctx=new AudioContext}catch(t){x.usingWebAudio=!1}x.ctx||(x.usingWebAudio=!1);var a=/iP(hone|od|ad)/.test(x._navigator&&x._navigator.platform),e=x._navigator&&x._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),o=e?parseInt(e[1],10):null;if(a&&o&&9>o){var t=/safari/.test(x._navigator&&x._navigator.userAgent.toLowerCase());(x._navigator&&x._navigator.standalone&&!t||x._navigator&&!x._navigator.standalone&&!t)&&(x.usingWebAudio=!1)}x.usingWebAudio&&(x.masterGain=void 0===x.ctx.createGain?x.ctx.createGainNode():x.ctx.createGain(),x.masterGain.gain.setValueAtTime(x._muted?0:1,x.ctx.currentTime),x.masterGain.connect(x.ctx.destination)),x._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:x,Howl:e}}),"undefined"!=typeof exports&&(exports.Howler=x,exports.Howl=e),"undefined"==typeof window?"undefined"!=typeof global&&(global.HowlerGlobal=s,global.Howler=x,global.Howl=e,global.Sound=l):(window.HowlerGlobal=s,window.Howler=x,window.Howl=e,window.Sound=l)}(),!function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(r){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var a=e._howls.length-1;0<=a;a--)e._howls[a].stereo(r);return e},HowlerGlobal.prototype.pos=function(a,e,o){var i=this;return i.ctx&&i.ctx.listener?(e="number"==typeof e?e:i._pos[1],o="number"==typeof o?o:i._pos[2],"number"==typeof a?(i._pos=[a,e,o],void 0===i.ctx.listener.positionX?i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]):(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)),i):i._pos):i},HowlerGlobal.prototype.orientation=function(l,e,d,c,u,p){var m=this;if(!m.ctx||!m.ctx.listener)return m;var a=m._orientation;return e="number"==typeof e?e:a[1],d="number"==typeof d?d:a[2],c="number"==typeof c?c:a[3],u="number"==typeof u?u:a[4],p="number"==typeof p?p:a[5],"number"==typeof l?(m._orientation=[l,e,d,c,u,p],void 0===m.ctx.listener.forwardX?m.ctx.listener.setOrientation(l,e,d,c,u,p):(m.ctx.listener.forwardX.setTargetAtTime(l,Howler.ctx.currentTime,.1),m.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),m.ctx.listener.forwardZ.setTargetAtTime(d,Howler.ctx.currentTime,.1),m.ctx.listener.upX.setTargetAtTime(l,Howler.ctx.currentTime,.1),m.ctx.listener.upY.setTargetAtTime(e,Howler.ctx.currentTime,.1),m.ctx.listener.upZ.setTargetAtTime(d,Howler.ctx.currentTime,.1)),m):a},Howl.prototype.init=function(r){return function(e){var a=this;return a._orientation=e.orientation||[1,0,0],a._stereo=e.stereo||null,a._pos=e.pos||null,a._pannerAttr={coneInnerAngle:void 0===e.coneInnerAngle?360:e.coneInnerAngle,coneOuterAngle:void 0===e.coneOuterAngle?360:e.coneOuterAngle,coneOuterGain:void 0===e.coneOuterGain?0:e.coneOuterGain,distanceModel:void 0===e.distanceModel?"inverse":e.distanceModel,maxDistance:void 0===e.maxDistance?1e4:e.maxDistance,panningModel:void 0===e.panningModel?"HRTF":e.panningModel,refDistance:void 0===e.refDistance?1:e.refDistance,rolloffFactor:void 0===e.rolloffFactor?1:e.rolloffFactor},a._onstereo=e.onstereo?[{fn:e.onstereo}]:[],a._onpos=e.onpos?[{fn:e.onpos}]:[],a._onorientation=e.onorientation?[{fn:e.onorientation}]:[],r.call(this,e)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var t=this;if(!t._webAudio)return t;if("loaded"!==t._state)return t._queue.push({event:"stereo",action:function(){t.stereo(e,n)}}),t;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return t._stereo;t._stereo=e,t._pos=[e,0,0]}for(var o=t._getSoundIds(n),i=0,l;i<o.length;i++)if(l=t._soundById(o[i]),l){if("number"!=typeof e)return l._stereo;l._stereo=e,l._pos=[e,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",l._panner&&l._panner.pan||a(l,r),"spatial"==r?void 0===l._panner.positionX?l._panner.setPosition(e,0,0):(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),t._emit("stereo",l._id)}return t},Howl.prototype.pos=function(e,n,l,d){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(e,n,l,d)}}),o;if(n="number"==typeof n?n:0,l="number"==typeof l?l:-.5,void 0===d){if("number"!=typeof e)return o._pos;o._pos=[e,n,l]}for(var i=o._getSoundIds(d),c=0,u;c<i.length;c++)if(u=o._soundById(i[c]),u){if("number"!=typeof e)return u._pos;u._pos=[e,n,l],u._node&&(u._panner&&!u._panner.pan||a(u,"spatial"),void 0===u._panner.positionX?u._panner.setPosition(e,n,l):(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(l,Howler.ctx.currentTime))),o._emit("pos",u._id)}return o},Howl.prototype.orientation=function(e,n,l,d){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(e,n,l,d)}}),o;if(n="number"==typeof n?n:o._orientation[1],l="number"==typeof l?l:o._orientation[2],void 0===d){if("number"!=typeof e)return o._orientation;o._orientation=[e,n,l]}for(var i=o._getSoundIds(d),c=0,u;c<i.length;c++)if(u=o._soundById(i[c]),u){if("number"!=typeof e)return u._orientation;u._orientation=[e,n,l],u._node&&(u._panner||(u._pos||(u._pos=o._pos||[0,0,-.5]),a(u,"spatial")),void 0===u._panner.orientationX?u._panner.setOrientation(e,n,l):(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(l,Howler.ctx.currentTime))),o._emit("orientation",u._id)}return o},Howl.prototype.pannerAttr=function(){var l=this,o=arguments,i,d,u;if(!l._webAudio)return l;if(0===o.length)return l._pannerAttr;if(1===o.length){if("object"!=e(o[0]))return u=l._soundById(parseInt(o[0],10)),u?u._pannerAttr:l._pannerAttr;i=o[0],void 0===d&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),l._pannerAttr={coneInnerAngle:void 0===i.pannerAttr.coneInnerAngle?l._coneInnerAngle:i.pannerAttr.coneInnerAngle,coneOuterAngle:void 0===i.pannerAttr.coneOuterAngle?l._coneOuterAngle:i.pannerAttr.coneOuterAngle,coneOuterGain:void 0===i.pannerAttr.coneOuterGain?l._coneOuterGain:i.pannerAttr.coneOuterGain,distanceModel:void 0===i.pannerAttr.distanceModel?l._distanceModel:i.pannerAttr.distanceModel,maxDistance:void 0===i.pannerAttr.maxDistance?l._maxDistance:i.pannerAttr.maxDistance,refDistance:void 0===i.pannerAttr.refDistance?l._refDistance:i.pannerAttr.refDistance,rolloffFactor:void 0===i.pannerAttr.rolloffFactor?l._rolloffFactor:i.pannerAttr.rolloffFactor,panningModel:void 0===i.pannerAttr.panningModel?l._panningModel:i.pannerAttr.panningModel})}else 2===o.length&&(i=o[0],d=parseInt(o[1],10));for(var m=l._getSoundIds(d),f=0;f<m.length;f++)if(u=l._soundById(m[f])){var g=u._pannerAttr;g={coneInnerAngle:void 0===i.coneInnerAngle?g.coneInnerAngle:i.coneInnerAngle,coneOuterAngle:void 0===i.coneOuterAngle?g.coneOuterAngle:i.coneOuterAngle,coneOuterGain:void 0===i.coneOuterGain?g.coneOuterGain:i.coneOuterGain,distanceModel:void 0===i.distanceModel?g.distanceModel:i.distanceModel,maxDistance:void 0===i.maxDistance?g.maxDistance:i.maxDistance,refDistance:void 0===i.refDistance?g.refDistance:i.refDistance,rolloffFactor:void 0===i.rolloffFactor?g.rolloffFactor:i.rolloffFactor,panningModel:void 0===i.panningModel?g.panningModel:i.panningModel};var y=u._panner;y?(y.coneInnerAngle=g.coneInnerAngle,y.coneOuterAngle=g.coneOuterAngle,y.coneOuterGain=g.coneOuterGain,y.distanceModel=g.distanceModel,y.maxDistance=g.maxDistance,y.refDistance=g.refDistance,y.rolloffFactor=g.rolloffFactor,y.panningModel=g.panningModel):(u._pos||(u._pos=l._pos||[0,0,-.5]),a(u,"spatial"))}return l},Sound.prototype.init=function(r){return function(){var e=this,a=e._parent;e._orientation=a._orientation,e._stereo=a._stereo,e._pos=a._pos,e._pannerAttr=a._pannerAttr,r.call(this),e._stereo?a.stereo(e._stereo):e._pos&&a.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(r){return function(){var e=this,a=e._parent;return e._orientation=a._orientation,e._stereo=a._stereo,e._pos=a._pos,e._pannerAttr=a._pannerAttr,e._stereo?a.stereo(e._stereo):e._pos?a.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,a._refreshBuffer(e)),r.call(this)}}(Sound.prototype.reset);var a=function(e,t){t=t||"spatial","spatial"===t?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0===e._panner.positionX?e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]):(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)),void 0===e._panner.orientationX?e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2]):(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime))):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}();var ve=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{elementId:null,alertOnError:!1},r=t.elementId,o=void 0===r?o:r,n=t.alertOnError,i=void 0===n?i:n;a(this,e),this.register(),this.errors=[],this.alertOnError=i,o&&(this.consoleElement=document.getElementById(o),this.consoleElement.style.display="none",this.consoleElement.style.position="absolute",this.consoleElement.style.width="100%",this.consoleElement.style.background="rgba(0,0,0,0.8)",this.consoleElement.style.color="#FFFFFF",this.consoleElement.style.fontFamily="monospace",this.consoleElement.style.maxHeight="256px",this.consoleElement.style.overflowY="scroll",!this.consoleElement&&console.warn("ElementID '".concat(o,"' not found while trying to register Error Console")))}return n(e,[{key:"register",value:function(){window.onerror=this.handleError.bind(this)}},{key:"handleError",value:function(e,t,r,a,o){(t||r||a)&&(this.errors.push({msg:e,url:t,line:r,col:a,error:o}),this.alertOnError&&alert(e+"\n\n"+o),this.updateConsoleElement())}},{key:"handleRejection",value:function(e){console.log(arguments),this.handleError.bind(this)("Unhandled rejection","","","",e.reason)}},{key:"hideConsole",value:function(){this.consoleElement.display="none"}},{key:"showConsole",value:function(){this.consoleElement.display="block",this.updateConsoleElement()}},{key:"updateConsoleElement",value:function(){if(this.consoleElement){this.consoleElement.innerHTML="",this.errors.length&&(this.consoleElement.style.display="");var e=!0,t=!1,r=void 0;try{for(var a=this.errors[Symbol.iterator](),o,n;!(e=(o=a.next()).done);e=!0)n=o.value,this.consoleElement.innerHTML+="".concat(n.msg," <br/>\n                                            &nbsp;&nbsp;&nbsp; in ").concat(n.url," <br/>\n                                            &nbsp;&nbsp;&nbsp; at line ").concat(n.line,", column ").concat(n.col," </br>")}catch(e){t=!0,r=e}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}}}}]),e}(),xe={AUTO_DETECT_DEVICE_PIXEL_RATIO:!0,AUTO_DETECT_TEXTURE_COMPRESSION_AVAILABILITY:!1,LIGHTING_ENABLED:!0,DIRECTIONAL_SHADOWS_ENABLED:!0,POINT_SHADOWS_ENABLED:!1,SHADOWS_VSM_ENABLED:!1,DEFAULT_SHADOW_BIAS:2e-5,MAX_BONES:8,MAX_LIGHTS:4,AVAILABLE_EXTENSIONS:[]},_e=1e-6,be="undefined"==typeof Float32Array?Array:Float32Array,Se=O,Ee=function(e){var t=e[0],r=e[1],a=e[2];return he(t*t+r*r+a*a)},Ae=function(){var e=H();return function(t,r,a,o,n,s){var d,c;for(r||(r=3),a||(a=0),c=o?pe(o*r+a,t.length):t.length,d=a;d<c;d+=r)e[0]=t[d],e[1]=t[d+1],e[2]=t[d+2],n(e,e,s),t[d]=e[0],t[d+1]=e[1],t[d+2]=e[2];return t}}(),Te=function(){var e=z();return function(t,r,a,o,n,s){var d,c;for(r||(r=4),a||(a=0),c=o?pe(o*r+a,t.length):t.length,d=a;d<c;d+=r)e[0]=t[d],e[1]=t[d+1],e[2]=t[d+2],e[3]=t[d+3],n(e,e,s),t[d]=e[0],t[d+1]=e[1],t[d+2]=e[2],t[d+3]=e[3];return t}}(),ke=function(e,t){var r=t[0],a=t[1],o=t[2],n=t[3],i=r*r+a*a+o*o+n*n;return 0<i&&(i=1/he(i),e[0]=r*i,e[1]=a*i,e[2]=o*i,e[3]=n*i),e},Be=function(){var e=H(),t=R(1,0,0),r=R(0,1,0);return function(o,n,a){var i=G(n,a);return-.999999>i?(V(e,t,n),1e-6>Ee(e)&&V(e,r,n),U(e,e),q(o,e,Math.PI),o):.999999<i?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(V(e,n,a),o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=1+i,ke(o,o))}}(),Oe=function(){var e=Q(),r=Q();return function(o,n,a,i,s,l){return J(e,n,s,l),J(r,a,i,l),J(o,e,r,2*l*(1-l)),o}}(),we=function(){var e=S();return function(t,r,a,o){return e[0]=a[0],e[3]=a[1],e[6]=a[2],e[1]=o[0],e[4]=o[1],e[7]=o[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],ke(t,$(t,e))}}(),Ie=function(){var e=te();return function(t,r,a,o,n,s){var d,c;for(r||(r=2),a||(a=0),c=o?pe(o*r+a,t.length):t.length,d=a;d<c;d+=r)e[0]=t[d],e[1]=t[d+1],n(e,e,s),t[d]=e[0],t[d+1]=e[1];return t}}(),Ce=E(),Me=0,Pe=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.id,o=void 0===r?"Component_"+Me++:r,n=t.enabled,i=t.transform,s=void 0===i?new Dt:i,l=t.visible;a(this,e),this.id=o,this.enabled=void 0===n||n,this.transform=s,this.visible=void 0===l||l}return n(e,[{key:"update",value:function(){}},{key:"render",value:function(){}}]),e}(),De=0,Le=0,Fe=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.id,o=void 0===r?De++:r,n=t.components,i=void 0===n?[]:n,s=t.enabled,l=t.visible,d=t.pointerEvents,c=t.transform,u=void 0===c?new Dt:c;a(this,e),this._priv||(this._priv={events:[]}),this._priv.events||(this._priv.events=[]),this.id=o,this.index=Le++,this.enabled=void 0===s||s,this.visible=void 0===l||l,this.opacity=1,this.pointerEvents=void 0===d||d,this.parentScene=null,this.components=i,this.transform=u,this.inputState={mouseOver:!1},this.tMatrix=E()}return n(e,[{key:"update",value:function(e,t){if(this.enabled)for(var r=0;r<this.components.length;r++)this.components[r].enabled&&this.components[r].update(e,t,this)}},{key:"render",value:function(e,t,r,a,o,n,s,l,d){if(this.visible){o.push(this),s?Se(this.tMatrix,s,this.transform.localMatrix):A(this.tMatrix,this.transform.localMatrix);for(var c=0;c<this.components.length;c++)this.components[c].visible&&this.components[c].render(e,t,r,a,o,n,this.tMatrix,l,d);o.pop()}}},{key:"addComponent",value:function(e){return this.components.push(e),e.parentScene=this.parentScene,e}},{key:"removeComponent",value:function(e){if(!(-1>=this.components.indexOf(e)))return this.components.splice(this.components.indexOf(e),1),e}},{key:"renderPick",value:function(e,t,r){if(this.visible&&this.pointerEvents)for(var a=0;a<this.components.length;a++)this.components[a].visible&&this.components[a].renderPick&&this.components[a].renderPick(e,t,this,r)}},{key:"findByIndex",value:function(e){if(this.index===e)return this;for(var t=0;t<this.components.length;t++){if(this.components[t].index===e)return this.components[t];if(this.components[t].findByIndex&&this.components[t].findByIndex(e))return this.components[t].findByIndex(e)}}},{key:"registerHandler",value:function(){}},{key:"unregisterHandler",value:function(){}},{key:"onload",value:function(){var e=!0,t=!1,r=void 0;try{for(var a=this._priv.events[Symbol.iterator](),o,n;!(e=(o=a.next()).done);e=!0)n=o.value,this.registerHandler(n)}catch(e){t=!0,r=e}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}}},{key:"onunload",value:function(){var e=!0,t=!1,r=void 0;try{for(var a=this._priv.events[Symbol.iterator](),o,n;!(e=(o=a.next()).done);e=!0)n=o.value,this.unregisterHandler(n)}catch(e){t=!0,r=e}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}}},{key:"onSpawn",value:function(e){this.parentScene=e}},{key:"onDestroy",value:function(){}},{key:"onMouseDown",value:function(){}},{key:"onMouseUp",value:function(){}},{key:"onMouseOver",value:function(){}},{key:"onMouseExit",value:function(){}},{key:"onMouseDrop",value:function(){}},{key:"setTimeout",value:function(e,t){var r=this,a=new Gt;return this.addComponent(a),a.setTimeout(function(){r.removeComponent(a),e&&e()},t),a}},{key:"setInterval",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=new Gt;return this.addComponent(a),a.setInterval(function(){e&&e()},t,r),a}},{key:"setModulate",value:function(e,t){var r=new Gt;return this.addComponent(r),r.setModulate(function(t,r,a){e&&e(t,r,a)},t),r}},{key:"setTween",value:function(e){var r=this,a=e.propParent,o=void 0===a?this:a,n=e.property,i=e.to,s=e.from,l=e.duration,d=e.method,c=e.onComplete,u=e.onUpdate,p=new Xt({propParent:o,property:n,to:i,from:s,duration:l,method:d,onUpdate:u,callback:function(){c&&c(),r.removeComponent(p)}});return this.addComponent(p),p}},{key:"sortComponentsByZ",value:function(e){e?this.components.sort(function(e,t){return e.transform&&t.transform&&e.transform.z-t.transform.z}):this.components.sort(function(e,t){return!e.transform||!t.transform||t.transform.z-e.transform.z})}},{key:"emit",value:function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var o=!0,n=!1,i=void 0;try{for(var s=this._priv.events[Symbol.iterator](),l,d;!(o=(l=s.next()).done);o=!0)d=l.value,d.event==e&&d.target[d.property].apply(this,r)}catch(e){n=!0,i=e}finally{try{o||null==s["return"]||s["return"]()}finally{if(n)throw i}}}}],[{key:"resetIndex",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;Le=e}},{key:"getIndex",value:function(){return Le}}]),e}(),He={},Re=function(e){return e&&0==(e&e-1)},Ne=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.src,o=void 0===r?"":r,n=t.flipY,i=t.textureType,s=void 0===i?"TEXTURE_2D":i,l=t.magFilter,d=void 0===l?"LINEAR":l,c=t.minFilter,u=void 0===c?"LINEAR_MIPMAP_LINEAR":c,p=t.generateMipmap,m=t.img,f=t.buffer,g=t.wrap,y=void 0===g?{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"}:g;a(this,e),this.src=o,this._loadPromise=null,this.loaded=!1,this.texture=[],this.img=m,this.buffer=f,this.flipY=void 0===n||n,this.magFilter=d,this.minFilter=u,this.textureType=s,this._generateMipmap=void 0===p||p,this.wrap=y,this.compressionFormat="",this.src.includes(".")||this.autoDetectFormat()}return n(e,[{key:"width",get:function(){return this.img.naturalWidth||this.img.width},set:function(e){return this.img.width=e}},{key:"height",get:function(){return this.img.naturalHeight||this.img.height},set:function(e){return this.img.height=e}}]),n(e,[{key:"autoDetectFormat",value:function(){this.compressionFormat="",xe.AVAILABLE_EXTENSIONS.includes("WEBGL_compressed_texture_pvrtc")&&(this.compressionFormat="pvrtc"),xe.AVAILABLE_EXTENSIONS.includes("WEBGL_compressed_texture_s3tc")&&(this.compressionFormat="dtx"),xe.AVAILABLE_EXTENSIONS.includes("WEBGL_compressed_texture_atc")&&(this.compressionFormat="atc"),xe.AVAILABLE_EXTENSIONS.includes("WEBGL_compressed_texture_etc1")&&(this.compressionFormat="etc"),this.compressionFormat&&(this.src=this.src.replace(".png",".ktx"),this.src=this.src.replace(".ktx","-".concat(this.compressionFormat,".ktx")))}},{key:"load",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return this._loadPromise?this._loadPromise:(He[this.src]?(this.img=He[this.src],this._loadPromise=new Promise(function(r){if(e.loaded=!0,e._loadPromise=null,t)if(Array.isArray(t)){var a=!0,o=!1,n=void 0;try{for(var i=t[Symbol.iterator](),s,l;!(a=(s=i.next()).done);a=!0)l=s.value,e.setAsTexture(l)}catch(e){o=!0,n=e}finally{try{a||null==i["return"]||i["return"]()}finally{if(o)throw n}}}else e.setAsTexture(t);r(e)})):this.compressionFormat?this._loadPromise=this.loadTexture(t):this._loadPromise=this.loadImage(t),this._loadPromise)}},{key:"loadImage",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,a){r.img=new Image,r.img.onload=function(){if(r.loaded=!0,r._loadPromise=null,He[r.src]=r.img,Re(r.img.width)&&Re(r.img.height)||(r._generateMipmap=!1),t)if(Array.isArray(t)){var a=!0,o=!1,n=void 0;try{for(var i=t[Symbol.iterator](),s,l;!(a=(s=i.next()).done);a=!0)l=s.value,r.setAsTexture(l)}catch(e){o=!0,n=e}finally{try{a||null==i["return"]||i["return"]()}finally{if(o)throw n}}}else r.setAsTexture(t);e(r)},r.img.onerror=function(){r.loaded=!1,r._loadPromise=null,a("Error loading image file: '".concat(r.img.src,"'"))},r.img.src=r.src}));case 1:case"end":return e.stop();}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"loadTexture",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=r(regeneratorRuntime.mark(function e(r){var o,n,i,s,l,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(a.src).then(function(e){return e.arrayBuffer()});case 2:if(a.buffer=e.sent,!t){e.next=27;break}if(!Array.isArray(t)){e.next=26;break}for(o=!0,n=!1,i=void 0,e.prev=8,s=t[Symbol.iterator]();!(o=(l=s.next()).done);o=!0)d=l.value,a.setAsTexture(d);e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](8),n=!0,i=e.t0;case 16:e.prev=16,e.prev=17,o||null==s["return"]||s["return"]();case 19:if(e.prev=19,!n){e.next=22;break}throw i;case 22:return e.finish(19);case 23:return e.finish(16);case 24:e.next=27;break;case 26:a.setAsTexture(t);case 27:r(a);case 28:case"end":return e.stop();}},e,null,[[8,12,16,24],[17,,19,23]])}));return function(){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop();}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"unload",value:function(e){e.webgl.deleteTexture(this.texture[e.id])}},{key:"createTexture",value:function(e){if(this.texture[e.id]=e.webgl.createTexture(),e.webgl.bindTexture(e.webgl[this.textureType],this.texture[e.id]),e.webgl.pixelStorei(e.webgl.UNPACK_FLIP_Y_WEBGL,this.flipY),"TEXTURE_CUBE_MAP"===this.textureType)for(var t=0;6>t;t++)e.webgl.texImage2D(e.webgl.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,e.webgl.RGBA,e.webgl.RGBA,e.webgl.UNSIGNED_BYTE,this.img);else e.webgl.texImage2D(e.webgl[this.textureType],0,e.webgl.RGBA,e.webgl.RGBA,e.webgl.UNSIGNED_BYTE,this.img)}},{key:"updateTexture",value:function(e){this._generateMipmap&&e.webgl.generateMipmap(e.webgl[this.textureType])}},{key:"setAsTexture",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return this.img?this.loaded?e._currentTexture[t]==this?void 0:(this.texture[e.id]||(this.createTexture(e),this.updateTexture(e)),e.webgl.activeTexture(e.webgl["TEXTURE"+t]),e.webgl.bindTexture(e.webgl[this.textureType],this.texture[e.id]),e.webgl.texParameteri(e.webgl[this.textureType],e.webgl.TEXTURE_WRAP_S,e.webgl[this.wrap.s]),e.webgl.texParameteri(e.webgl[this.textureType],e.webgl.TEXTURE_WRAP_T,e.webgl[this.wrap.t]),e.webgl.texParameteri(e.webgl[this.textureType],e.webgl.TEXTURE_MAG_FILTER,e.webgl[this.magFilter]),e.webgl.texParameteri(e.webgl[this.textureType],e.webgl.TEXTURE_MIN_FILTER,e.webgl[this.minFilter]),r&&e.webgl.uniform1i(r,t),e._currentTexture[t]=this,!0):(console.warn("Texture image not yet loaded"),!1):(console.error("Texture has no image loaded"),!1)}}]),e}(),Ue=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.name,o=void 0===r?"":r,n=t.tracks,i=void 0===n?[]:n,s=t.loop,l=t.enabled,d=t.rate,c=void 0===d?1:d,u=t.paused;a(this,e),this.name=o,this.tracks=i,this.enabled=void 0!==l&&l,this.paused=void 0!==u&&u,this.rate=c,this.currentTime=0,this.loop=void 0===s||s}return n(e,[{key:"update",value:function(e){if(this.enabled&&!this.paused&&this.rate){this.currentTime+=e*this.rate;for(var t=!0,r=0;r<this.tracks.length;r++)this.tracks[r].update(e*this.rate,this.currentTime),this.tracks[r].complete||(t=!1);t&&(this.loop?this.reset():this.stop())}}},{key:"pause",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!this.paused;this.paused=e}},{key:"stop",value:function(){this.reset(),this.enabled=!1}},{key:"play",value:function(){this.enabled&&this.reset(),this.enabled=!0}},{key:"reset",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].reset();this.currentTime=0}}]),e}(),Ge=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.name,o=void 0===r?"":r,n=t.values,i=void 0===n?[[]]:n,s=t.times,l=void 0===s?[]:s,d=t.type,c=void 0===d?"position":d,u=t.parent,p=void 0===u?null:u;a(this,e),this.name=o,this.values=i,this.times=l,this.type=c,this.parent=p,this.currentTime=0,this.currentFrameStartTime=0,this.currentFrameIndex=0,this.currentFrameValues=this.values[0],this.currentFrameTime=this.times[0],this.nextFrameIndex=0,this.nextFrameValues=this.values[0],this.nextFrameTime=this.times[0],this.complete=!1,this.reset()}return n(e,[{key:"update",value:function(e,t){if(!this.complete){if(this.currentTime+=e,t>=this.nextFrameTime&&(this.currentFrameStartTime=this.currentFrameTime,this.currentFrameIndex=this.nextFrameIndex,this.currentFrameValues=this.nextFrameValues,this.currentFrameTime=this.nextFrameTime,this.nextFrameIndex++,this.nextFrameValues=this.values[this.nextFrameIndex],this.nextFrameTime=this.times[this.nextFrameIndex],this.nextFrameIndex>=this.times.length))return void(this.complete=!0);var r=(t-this.currentFrameTime)/(this.nextFrameTime-this.currentFrameTime);(r==1/0||r==-Infinity)&&(r=0),this.interpolateLinear(this.currentFrameValues,this.nextFrameValues,r)}}},{key:"interpolateLinear",value:function(e,t,r){if(this.parent)switch(this.type){case"position":this.parent.transform.xyz=[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r];break;case"scale":this.parent.transform.sxyz=[e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r];break;case"rotation2":this.parent.transform.rotateFromEuler(e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r);break;case"rotation":switch(t[3]){case"ZYX":this.parent.transform.rotateToZYX(e[2]+(t[2]-e[2])*r,e[1]+(t[1]-e[1])*r,e[0]+(t[0]-e[0])*r);break;case"XYZ":default:this.parent.transform.rotateToXYZ(e[0]+(t[0]-e[0])*r,e[1]+(t[1]-e[1])*r,e[2]+(t[2]-e[2])*r);}break;case"quaternion":var a=[];J(a,e,t,r),this.parent.transform.rotationQuat=a;}}},{key:"reset",value:function(){this.currentTime=null,this.currentFrameIndex=0,this.currentFrameValues=this.values[this.currentFrameIndex],this.currentFrameTime=this.times[this.currentFrameIndex],this.nextFrameIndex=0,this.nextFrameValues=this.values[this.nextFrameIndex],this.nextFrameTime=this.times[this.nextFrameIndex],this.update(0,0),this.complete=!1}}]),e}(),Ve=E(),Xe=0,Ye=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.name,o=void 0===r?"":r,n=t.id,i=void 0===n?Xe++:n,s=t.parent,l=void 0===s?null:s,d=t.children,c=void 0===d?[]:d,u=t.isRoot,p=t.inheritTransform,m=t.transform,f=void 0===m?new Dt:m;a(this,e),this.name=o,this.id=i,this.children=c,this.isRoot=void 0!==u&&u,this.parent=l,this.inheritTransform=void 0===p||p,this.transform=f,this.bindpose=E(),this.inverseBindpose=E(),this.offsetMatrix=E()}return n(e,[{key:"update",value:function(){}},{key:"add",value:function(e){this.children.add(e),e.parent=this}},{key:"calcBindPose",value:function(){this.calcAbsolutePosition(this.bindpose),B(this.inverseBindpose,this.bindpose)}},{key:"calcAbsolutePosition",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Ve;if(this.parent&&this.inheritTransform&&this.parent.calcAbsolutePosition){var t=new Float32Array(16);this.parent.calcAbsolutePosition(t),O(e,t,this.transform.localMatrix)}else A(e,this.transform.localMatrix)}},{key:"getFlatMatrix",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];this.calcAbsolutePosition(Ve),O(Ve,Ve,this.inverseBindpose);for(var a=0;16>a;a++)e[16*t+a]=Ve[a];if(t++,r)for(var o=0;o<this.children.length;o++)t=this.children[o].getFlatMatrix(e,t,!0);return t}}]),e}(),We=E(),ze=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.nearPlane,o=void 0===r?1:r,n=e.farPlane,i=void 0===n?1e3:n,l=e.fov,d=void 0===l?.872665:l,u=e.projectionType,p=void 0===u?"projection":u,m=e.followType,f=void 0===m?"STATIC":m,g=e.stiffness,y=void 0===g?.65:g,h;return a(this,t),h=c(this,s(t).apply(this,arguments)),h._nearPlane=o,h._farPlane=i,h._projectionType=p,h.fov=d,h.viewports=[],h.shaderPasses=[],h.mvTransform=new Dt,h.followEntity=null,h.followOffset=[0,0,0],h.followType=f,h.stiffness=y,h.limit={minimum:{x:null,y:null,z:null},maximum:{x:null,y:null,z:null}},h.velocity=[0,0,0],h.dampening=[0,0,0],h.lock=[null,null,null],h}return i(t,e),n(t,[{key:"nearPlane",get:function(){return this._nearPlane},set:function(e){return this._nearPlane=e,this._nearPlane}},{key:"farPlane",get:function(){return this._farPlane},set:function(e){return this._farPlane=e,this._farPlane}},{key:"projectionType",get:function(){return this._projectionType},set:function(e){return this._projectionType=e,this._projectionType}}]),n(t,[{key:"render",value:function(e,t,r,a,o,n,i){a.push(this),Se(We,o,this.transform.localMatrixInversed);var s=!0,l=!1,d=void 0;try{for(var c=t.entities[Symbol.iterator](),u,p;!(s=(u=c.next()).done);s=!0)p=u.value,p!==this&&p.visible&&p.render(e,t,r,this,a,We,null,n,i)}catch(e){l=!0,d=e}finally{try{s||null==c["return"]||c["return"]()}finally{if(l)throw d}}a.pop()}},{key:"renderScenePick",value:function(e){for(var t=0;t<this.scene.entities.length;t++)this.scene.entities[t].renderPick(e,this,t)}},{key:"update",value:function(){if(this.followEntity){var e=this.transform.x-this.followOffset[0],t=this.transform.y-this.followOffset[1],r=this.transform.z-this.followOffset[2],a=this.followEntity.transform.x,o=this.followEntity.transform.y,n=this.followEntity.transform.z;switch(this.followType.toUpperCase()){case"EASEIN":e+=oe((a-e)*le(this.stiffness,2)),t+=oe((o-t)*le(this.stiffness,2)),r+=oe((n-r)*le(this.stiffness,2));break;case"EASEOUT":e+=oe((a-e)*this.stiffness),t+=oe((o-t)*this.stiffness),r+=oe((n-r)*this.stiffness);break;case"SPRING":var i={x:this.followEntity.transform.x+this.followOffset[0]-this.transform.x,y:this.followEntity.transform.y+this.followOffset[1]-this.transform.y,z:this.followEntity.transform.z+this.followOffset[2]-this.transform.z};e+=5.5*i.x,t+=6.5*i.y,r+=5.5*i.z;break;case"STATIC":default:e=a,t=o,r=n;}e+=this.followOffset[0],t+=this.followOffset[1],r+=this.followOffset[2],null!==this.limit.minimum.x&&e<this.limit.minimum.x&&(e=this.limit.minimum.x),null!==this.limit.minimum.y&&t<this.limit.minimum.y&&(t=this.limit.minimum.y),null!==this.limit.minimum.z&&r<this.limit.minimum.z&&(r=this.limit.minimum.z),null!==this.limit.maximum.x&&e>this.limit.maximum.x&&(e=this.limit.maximum.x),null!==this.limit.maximum.y&&t>this.limit.maximum.y&&(t=this.limit.maximum.y),null!==this.limit.maximum.z&&r>this.limit.maximum.z&&(r=this.limit.maximum.z),this.transform.translateTo(e,t,r)}null!==this.lock[0]&&this.transform.translateToX(this.lock[0]),null!==this.lock[1]&&this.transform.translateToY(this.lock[1]),null!==this.lock[2]&&this.transform.translateToY(this.lock[2]),this.transform.x-=this.velocity[0],this.transform.y-=this.velocity[1],this.transform.z-=this.velocity[2],this.velocity[0]*=this.dampening[0],this.velocity[1]*=this.dampening[1],this.velocity[2]*=this.dampening[2],null!==this.limit.minimum.x&&this.transform.x<this.limit.minimum.x&&(this.transform.x=this.limit.minimum.x),null!==this.limit.minimum.y&&this.transform.y<this.limit.minimum.y&&(this.transform.y=this.limit.minimum.y),null!==this.limit.minimum.z&&this.transform.z<this.limit.minimum.z&&(this.transform.z=this.limit.minimum.z),null!==this.limit.maximum.x&&this.transform.x>this.limit.maximum.x&&(this.transform.x=this.limit.maximum.x),null!==this.limit.maximum.y&&this.transform.y>this.limit.maximum.y&&(this.transform.y=this.limit.maximum.y),null!==this.limit.maximum.z&&this.transform.z>this.limit.maximum.z&&(this.transform.z=this.limit.maximum.z)}},{key:"addViewport",value:function(e){this.viewports.push(e)}},{key:"follow",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[this.transform.x,this.transform.y,this.transform.z];this.followEntity=e,this.followOffset=t}},{key:"lockX",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.transform.x;this.lock[0]=e}},{key:"unlockX",value:function(){this.lock[0]=null}},{key:"lockY",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.transform.y;this.lock[1]=e}},{key:"unlockY",value:function(){this.lock[1]=null}},{key:"lockZ",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.transform.z;this.lock[1]=e}},{key:"unlockZ",value:function(){this.lock[0]=null}},{key:"getFrustum",value:function(e){var t=[[-1,-1,-1,1],[-1,-1,1,1],[-1,1,-1,1],[-1,1,1,1],[1,-1,-1,1],[1,-1,1,1],[1,1,-1,1],[1,1,1,1]],r=[];A(r,e.projectionMatrix),O(r,r,this.transform.localMatrixInversed),B(r,r);for(var a=0,o=t,n;a<o.length;a++)n=o[a],K(n,n,r),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[3]/=n[3];return t}},{key:"unproject",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,o=this.farPlane;this._farPlane=this.transform.z,e.evaluate(!1);var n=z(),i=this.parallax?this.transform.getInverseParallax(this):this.transform.localMatrixInversed,s=this.mvTransform.localMatrix,l=e.projectionMatrix,d=[0,0,e.contextElement.width,e.contextElement.height],c=E();A(c,l),O(c,c,i),O(c,c,s),B(c,c),n[0]=2*((t-d[0])/d[2])-1,n[1]=2*((r-d[1])/d[3])-1,n[2]=2*a-1,n[3]=1;var u=z();return(K(u,n,c),this._farPlane=o,e.evaluate(!1),0==u[3])?null:(u[3]=1/u[3],[u[0]*u[3],u[1]*u[3],u[2]*u[3]])}},{key:"project",value:function(e,t){var r=e.parallax?this.transform.getInverseParallax(this):this.transform.localMatrixInversed,a=this.mvTransform.localMatrix,o=e.projectionMatrix,n=E();A(n,o),O(n,n,r),O(n,n,a);var i=[],s=t.xyz[0],l=t.xyz[1],d=t.xyz[2],c=n[0]*s+n[4]*l+n[8]*d+n[12],u=n[1]*s+n[5]*l+n[9]*d+n[13],p=n[3]*s+n[7]*l+n[11]*d+n[15];return i[0]=(c/p+1)/2,i[1]=1-(u/p+1)/2,i[0]=oe(i[0]*e.contextElement.width),i[1]=oe(i[1]*e.contextElement.height),i}},{key:"getParallaxOffset",value:function(e){return this.transform.getParallaxOffset(e.xyz?e.xyz:e,this)}}]),t}(Fe),je;(function(){if(je=window&&!1!="performance"in window?window.performance:{},!1=="now"in je){var e=new Date().getTime();je.timing&&je.timing.navigationStart&&(e=je.timing.navigationStart),je.now=function(){return new Date().getTime()-e}}})();var Ke,Ze;(function(){window&&window.requestAnimationFrame&&(Ke=window.requestAnimationFrame);for(var e=0,t=["ms","moz","webkit","o"],r=0;r<t.length&&!Ke;++r)Ke=window[t[r]+"RequestAnimationFrame"],Ze=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"];Ke||(Ke=function(t){var r=new Date().getTime(),a=ne(0,16-(r-e)),o=setTimeout(function(){t(r+a)},a);return e=r+a,o}),Ze||(Ze=function(e){clearTimeout(e)})})();var Qe=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.targetCyclesPerSecond,o=void 0===r?60:r,n=t.targetFramesPerSecond,i=void 0===n?60:n,s=t.autoRun;a(this,e),this._running=!1,this.targetCyclesPerSecond=o,this.targetFramesPerSecond=i,this.frameAccumulatorRemainderThreshold=16,this.renderEnabled=!0,this.stats={fps:0,cps:0,framesThisSecond:0,cyclesThisSecond:0,droppedFramesThisSecond:0,framesSkippedThisSecond:0,renderExecutionTime:0,updateExecutionTime:0,currentGameTime:0,lastUpdate:je.now(),lastRender:je.now(),lastFrame:je.now()},this._r={i:null,newTime:je.now(),deltaTime:1e3*(1/this.targetCyclesPerSecond),renderDeltaTime:1e3*(1/this.targetFramesPerSecond),frameAccumulator:0},this.scenes=[],this.viewports=[],(void 0===s||s)&&this.start()}return n(e,[{key:"start",value:function(){this._running||(this._running=!0,this.update())}},{key:"stop",value:function(){this._running=!1}},{key:"resetAccumulator",value:function(){this.stats.lastFrame=je.now(),this._r.frameAccumulator=0}},{key:"update",value:function(){if(this._running){this._r.newTime=je.now(),this._r.frameTime=this._r.newTime-this.stats.lastFrame,1e3<this._r.frameTime&&(this._r.frameTime=1e3),this.stats.lastFrame=this._r.newTime,this._r.frameAccumulator+=this._r.frameTime,this.stats.cyclesThisFrame=0,this._r.i=ue(this._r.frameAccumulator/this._r.deltaTime);for(var e=je.now();0<=this._r.i--;){var t=!0,r=!1,a=void 0;try{for(var o=this.scenes[Symbol.iterator](),n,i;!(t=(n=o.next()).done);t=!0)i=n.value,i.enabled&&i.update(this._r.deltaTime)}catch(e){r=!0,a=e}finally{try{t||null==o["return"]||o["return"]()}finally{if(r)throw a}}if(this.stats.currentGameTime+=100*this._r.deltaTime,this.stats.cyclesThisFrame++,!this._running)return}if(this.stats.updateExecutionTime=je.now()-e,this.stats.cyclesThisSecond+=this.stats.cyclesThisFrame,this._r.frameAccumulator-=this.stats.cyclesThisFrame*this._r.deltaTime,this.stats.droppedFramesThisSecond+=this.stats.cyclesThisSecond-1,this.stats.frameAccumulatorRemainder=this._r.frameAccumulator,e=je.now(),this.renderEnabled&&this.stats.cyclesThisFrame){var s=!0,l=!1,d=void 0;try{for(var c=this.scenes[Symbol.iterator](),u,p;!(s=(u=c.next()).done);s=!0)p=u.value,p.render(je.now()-this.stats.lastRender)}catch(e){l=!0,d=e}finally{try{s||null==c["return"]||c["return"]()}finally{if(l)throw d}}this.stats.lastRender=je.now(),this.stats.framesThisSecond++}else this.stats.framesSkippedThisSecond++;this.stats.renderExecutionTime=je.now()-e,1e3<je.now()-this.stats.lastUpdate&&(this.stats.fps=this.stats.framesThisSecond,this.stats.cps=this.stats.cyclesThisSecond,this.stats.framesThisSecond=0,this.stats.cyclesThisSecond=0,this.stats.framesSkippedThisSecond=0,this.stats.lastUpdate=je.now()),Ke(this.update.bind(this))}}},{key:"cyclesToMilliseconds",value:function(e){return e*this._r.deltaTime}},{key:"millisecondsToCycles",value:function(e){return e/this._r.deltaTime}},{key:"add",value:function(e){this.scenes.push(e)}},{key:"remove",value:function(e){this.scenes.splice(this.scenes.indexOf(e),1)}}]),e}(),qe=function(){function e(){a(this,e),this.set.apply(this,arguments),this._color3Float32Array=new Float32Array(3),this._color4Float32Array=new Float32Array(4)}return n(e,[{key:"red",get:function(){return this.color[0]},set:function(e){return this.color[0]=e}},{key:"green",get:function(){return this.color[1]},set:function(e){return this.color[1]=e}},{key:"blue",get:function(){return this.color[2]},set:function(e){return this.color[2]=e}},{key:"alpha",get:function(){return this.color[3]},set:function(e){return this.color[3]=e}}]),n(e,[{key:"set",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if("string"==typeof e){var o=this.parseHex(e);this.color=new Float32Array([o[0],o[1],o[2],o[3]])}else e instanceof Array?(void 0===e[3]&&(e[3]=1),this.color=new Float32Array([e[0],e[1],e[2],e[3]])):this.color=new Float32Array([e,t,r,a])}},{key:"toArray",value:function(){return this.color}},{key:"toVec3Array",value:function(){return this._color3Float32Array.set([this.color[0],this.color[1],this.color[2]]),this._color3Float32Array}},{key:"toRGBAArray",value:function(){return this._color4Float32Array.set([255*this.color[0],255*this.color[1],255*this.color[2],this.color[3]]),this._color4Float32Array}},{key:"parseHex",value:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,r,a){return t+t+r+r+a+a});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r&&(this.color[0]=parseInt(r[1],16)/255,this.color[1]=parseInt(r[2],16)/255,this.color[2]=parseInt(r[3],16)/255),this}},{key:"adjustHSL",value:function(e,t,r){var a=this.rgbToHsl();return a[0]+=(e||0)/100,a[1]+=(t||0)/100,a[2]+=(r||0)/100,0>a[0]&&(a[0]=0),0>a[1]&&(a[1]=0),0>a[2]&&(a[2]=0),1<a[0]&&(a[0]=1),1<a[1]&&(a[1]=1),1<a[2]&&(a[2]=1),a=this.hslToRgb(a[0],a[1],a[2]),this.set(a[0],a[1],a[2],this.alpha),this}},{key:"adjustHue",value:function(e){var t=this.rgbToHsl();return t[0]+=(e||0)/100,t=this.hslToRgb(t[0],t[1],t[2]),this.set(t[0],t[1],t[2],this.alpha),this}},{key:"adjustSaturation",value:function(e){var t=this.rgbToHsl();return t[1]+=(e||0)/100,t=this.hslToRgb(t[0],t[1],t[2]),this.set(t[0],t[1],t[2],this.alpha),this}},{key:"adjustLightness",value:function(e){var t=this.rgbToHsl();return t[2]+=(e||0)/100,t=this.hslToRgb(t[0],t[1],t[2]),this.set(t[0],t[1],t[2],this.alpha),this}},{key:"rgbToHsl",value:function(e,t,a){null==e&&(e=this.red,t=this.green,a=this.blue);var o=ne(e,t,a),n=pe(e,t,a),i=(o+n)/2,l,c;if(o==n)l=c=0;else{var u=o-n;c=.5<i?u/(2-o-n):u/(o+n),o===e?l=(t-a)/u+(t<a?6:0):o===t?l=(a-e)/u+2:o===a?l=(e-t)/u+4:void 0,l/=6}return[l,c,i]}},{key:"hslToRgb",value:function(e,t,a){var o,n,i;if(null==e)return[this.red,this.green,this.blue];if(0==t)o=n=i=a;else{var s=.5>a?a*(1+t):a+t-a*t,l=2*a-s;o=this.hue2rgb(l,s,e+1/3),n=this.hue2rgb(l,s,e),i=this.hue2rgb(l,s,e-1/3)}return[oe(o),oe(n),oe(i)]}},{key:"hue2rgb",value:function(e,r,a){return 0>a&&(a+=1),1<a&&(a-=1),a<1/6?e+6*(r-e)*a:a<1/2?r:a<2/3?e+6*((r-e)*(2/3-a)):e}}]),e}(),Je=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.count,o=void 0===r?1e3:r,n=e.life,i=void 0===n?1e3:n,l=e.rate,d=void 0===l?1e3:l,u=e.offset,p=void 0===u?[0,0,0]:u,m=e.velocity,f=void 0===m?[0,0,0]:m,g=e.entityCreate,y;return a(this,t),y=c(this,s(t).call(this)),y._r={i:null,frameTime:0,timeAccumulator:0},y.warmed=!1,y.rate=d,y.life=i,y.offset=p,y.velocity=f,y.particles=[],y.particleAge=[],y.count=o,y}return i(t,e),n(t,[{key:"count",get:function(){return this.particles.length},set:function(e){this.particles.length=e,this.particleAge.length=e,this.warmed=!1}}]),n(t,[{key:"render",value:function(e,r,a,o,n){p(s(t.prototype),"render",this).call(this,e,r,a,o,n);for(var l=0;l<this.particles.length;l++)this.particles[l].visible&&this.particles[l].render(e,r,a,o,n,this)}},{key:"update",value:function(e,r,a){p(s(t.prototype),"update",this).call(this,e,r,a),this.warmed||this.prewarm();for(var o=0;o<this.particles.length;o++)this.particles[o].enabled&&(this.particles[o].transform.translate(this.velocity[0],this.velocity[1],this.velocity[2]),this.particleAge[o]+=e,this.particleAge[o]>=this.life&&(this.particles[o].enabled=!1,this.particles[o].visible=!1));if(this.rate)for(this._r.timeAccumulator+=e,this._r.i=ue(this._r.timeAccumulator/this.rate);0<=this._r.i--;)this.emit(),this._r.timeAccumulator-=this.rate}},{key:"entityCreate",value:function(){}},{key:"prewarm",value:function(){for(var e=0;e<this.particles.length;e++)this.particles[e]||(this.particles[e]=this.entityCreate(e),this.particles[e].enabled=!1,this.particles[e].visible=!1,this.particleAge[e]=0);this.warmed=!0}},{key:"emit",value:function(){for(var e=0;e<this.particles.length;e++)if(!this.particles[e].enabled)return this.particles[e].enabled=!0,this.particles[e].visible=!0,this.particleAge[e]=0,void this.particles[e].transform.translateTo(this.offset[0],this.offset[1],this.offset[2])}}]),t}(Pe),$e=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.width,o=void 0===r?1024:r,n=e.height,i=void 0===n?1024:n,l=e.flipY,d=e.textureType,u=void 0===d?"TEXTURE_2D":d,p=e.magFilter,m=void 0===p?"LINEAR":p,f=e.minFilter,g=void 0===f?"LINEAR":f,y=e.generateMipmap,h=e.wrap,v=void 0===h?{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"}:h,x;return a(this,t),x=c(this,s(t).apply(this,arguments)),x.framebuffer=null,x.framebufferWidth=o,x.framebufferHeight=i,x.flipY=void 0!==l&&l,x.magFilter=m,x.minFilter=g,x.textureType=u,x.wrap=v,x.generateMipmap=void 0!==y&&y,x.useDepthBuffer=!0,x.loaded=!0,x}return i(t,e),n(t,[{key:"width",get:function(){return this.framebufferWidth},set:function(e){return this.framebufferWidth=e}},{key:"height",get:function(){return this.framebufferHeight},set:function(e){return this.framebufferHeight=e}}]),n(t,[{key:"bind",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.width,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:this.height,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:e.webgl[this.textureType];this.texture[e.id]&&r===this.width&&a===this.height||(this.width=r,this.height=a,this.texture[e.id]&&this.unload(e),this.createTexture(e)),e.webgl.bindTexture(e.webgl[this.textureType],this.texture[e.id]),this.framebuffer||(this.framebuffer=e.webgl.createFramebuffer(),this.width=r,this.height=a),this.img=this.framebuffer,e.webgl.bindFramebuffer(e.webgl.FRAMEBUFFER,this.framebuffer),e.webgl.framebufferRenderbuffer(e.webgl.FRAMEBUFFER,e.webgl.DEPTH_ATTACHMENT,e.webgl.RENDERBUFFER,this.depthBuffer),e.webgl.viewport(0,0,this.width,this.height),e.webgl.framebufferTexture2D(e.webgl.FRAMEBUFFER,e.webgl.COLOR_ATTACHMENT0,o,this.texture[e.id],0),e._currentTexture[t]=this}},{key:"unbind",value:function(e){e.webgl.bindFramebuffer(e.webgl.FRAMEBUFFER,null),e.webgl.viewport(0,0,e.width,e.height)}},{key:"createTexture",value:function(e){this.texture[e.id]=e.webgl.createTexture(),e.webgl.bindTexture(e.webgl[this.textureType],this.texture[e.id]),e.webgl.pixelStorei(e.webgl.UNPACK_FLIP_Y_WEBGL,this.flipY);var t=this.framebufferWidth,r=this.framebufferHeight,a=0,o=e.webgl.RGBA,n=0,s=e.webgl.RGBA,l=e.webgl.UNSIGNED_BYTE,d=null;if("TEXTURE_CUBE_MAP"===this.textureType)for(var c=0;6>c;c++)e.webgl.texImage2D(e.webgl.TEXTURE_CUBE_MAP_POSITIVE_X+c,a,o,t,r,n,s,l,d);else e.webgl.texImage2D(e.webgl[this.textureType],a,o,t,r,n,s,l,d);this.useDepthBuffer&&(this.depthBuffer=e.webgl.createRenderbuffer(),e.webgl.bindRenderbuffer(e.webgl.RENDERBUFFER,this.depthBuffer),e.webgl.renderbufferStorage(e.webgl.RENDERBUFFER,e.webgl.DEPTH_COMPONENT16,t,r))}},{key:"updateTexture",value:function(){}}]),t}(Ne),et=function(){function e(t){a(this,e),this.program=t.webgl.createProgram(),this.attribute={},this.uniform={},this.fragmentShader="",this.vertexShader=""}return n(e,[{key:"addVertexShader",value:function(e,t){var r=e.webgl.createShader(e.webgl.VERTEX_SHADER);if(e.webgl.shaderSource(r,t),e.webgl.compileShader(r),e.webgl.attachShader(this.program,r),!e.webgl.getShaderParameter(r,e.webgl.COMPILE_STATUS))throw"An error occurred compiling the vertex shader: "+e.webgl.getShaderInfoLog(r);this.vertexShader=t}},{key:"addFragmentShader",value:function(e,t){var r=e.webgl.createShader(e.webgl.FRAGMENT_SHADER);if(e.webgl.shaderSource(r,t),e.webgl.compileShader(r),e.webgl.attachShader(this.program,r),!e.webgl.getShaderParameter(r,e.webgl.COMPILE_STATUS))throw"An error occurred compiling the fragment shader: "+e.webgl.getShaderInfoLog(r);this.fragmentShader=t}},{key:"getAttributesFromShaders",value:function(e){for(var t=e.webgl.getProgramParameter(this.program,e.webgl.ACTIVE_ATTRIBUTES),r=0,a;r<t;r++)a=e.webgl.getActiveAttrib(this.program,r),this.attribute[a.name]=e.webgl.getAttribLocation(this.program,a.name),0>this.attribute[a.name]&&delete this.attribute[a.name]}},{key:"getUniformLocations",value:function(e){for(var t=e.webgl.getProgramParameter(this.program,e.webgl.ACTIVE_UNIFORMS),r=0,a;r<t;r++)a=e.webgl.getActiveUniform(this.program,r),this.uniform[a.name]=e.webgl.getUniformLocation(this.program,a.name),0>this.uniform[a.name]&&delete this.uniform[a.name]}},{key:"use",value:function(e){e.webgl.useProgram(this.program)}}]),e}(),tt=E(),rt=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,o=e.transform,n=void 0===o?new Dt:o,i=e.ambientColor,l=void 0===i?new qe(0,0,0,1):i,d=e.diffuseColor,u=void 0===d?new qe(1,1,1,1):d,p=e.specularColor,m=void 0===p?new qe(1,1,1,1):p,f=e.intensity,g=void 0===f?1:f,y=e.maxDistance,h=void 0===y?128:y,v;return a(this,t),v=c(this,s(t).apply(this,arguments)),v.ambientColor=l,v.diffuseColor=u,v.specularColor=m,v.intensity=g,v.maxDistance=h,v.projectionMatrix=E(),T(v.projectionMatrix),v}return i(t,e),n(t,[{key:"getMVPMatrix",value:function(e,t){return P(this.projectionMatrix,1.5708,1,.01,this.maxDistance),A(tt,this.projectionMatrix),t&&Se(tt,tt,t),Se(tt,tt,this.transform.localMatrixInversed),e&&Se(tt,tt,e),tt}}]),t}(Fe),at=E(),ot=E(),nt=E(),it=E(),st=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,o=e.vector,n=void 0===o?[0,-1,0]:o,i;return a(this,t),i=c(this,s(t).apply(this,arguments)),i.vector=n,i.maxShadowDistance=50,i}return i(t,e),n(t,[{key:"getMVPMatrix",value:function(e,t){var r=1/0,a=-Infinity,o=1/0,n=-Infinity,s=1/0,l=-Infinity,d=t.camera.getFrustum(t),c=ye(d[7][0]-d[0][0])/this.maxShadowDistance,u=ye(d[7][1]-d[0][1])/this.maxShadowDistance,p=ye(d[7][2]-d[0][2])/this.maxShadowDistance,m=[0,0,0],f=!0,g=!1,y=void 0;try{for(var h=d[Symbol.iterator](),v,x;!(f=(v=h.next()).done);f=!0)x=v.value,m[0]+=x[0],m[1]+=x[1],m[2]+=x[2]}catch(e){g=!0,y=e}finally{try{f||null==h["return"]||h["return"]()}finally{if(g)throw y}}for(var _=0;3>_;_++)m[_]/=8;var b=[];U(b,this.vector),b[0]+=m[0],b[1]+=m[1],b[2]+=m[2],L(ot,m,b,[0,1,0]);var S=!0,E=!1,A=void 0;try{for(var T=d[Symbol.iterator](),k,B;!(S=(k=T.next()).done);S=!0)B=k.value,K(B,B,ot),r=pe(r,B[0]),a=ne(a,B[0]),o=pe(o,B[1]),n=ne(n,B[1]),s=pe(s,B[2]),l=ne(l,B[2])}catch(e){E=!0,A=e}finally{try{S||null==T["return"]||T["return"]()}finally{if(E)throw A}}t._currentTexture[0]?t._currentTexture[0].width:512;D(nt,-1,1,-1,1,s,l),c=pe(2/(a-r),2/this.maxShadowDistance),u=pe(2/(n-o),2/this.maxShadowDistance),p=pe(1/(l-s),1/this.maxShadowDistance);var O=-.5*(r+a)*c,w=-.5*(o+n)*u,I=-s*p;return it[0]=c,it[5]=u,it[10]=p,it[12]=O,it[13]=w,it[14]=I,Se(at,it,nt),Se(at,at,ot),e&&Se(at,at,e),at}}]),t}(rt),lt=E(),dt=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,o=e.intensity,n=e.maxDistance,i;return a(this,t),i=c(this,s(t).apply(this,arguments)),i.constantAttenuation=1,i.linearAttenuation=1,i.quadraticAttenuation=1,i}return i(t,e),n(t,[{key:"getMVPMatrix",value:function(e,t,r){return P(this.projectionMatrix,1.5708,1,.01,this.maxDistance),A(lt,this.projectionMatrix),r&&Se(lt,lt,r),Se(lt,lt,this.transform.localMatrixInversed),e&&Se(lt,lt,e),lt}}]),t}(rt),ct=E(),ut=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,o=e.intensity,n=e.maxDistance,i;return a(this,t),i=c(this,s(t).apply(this,arguments)),i.spotDirection=[0,-1,0],i.spotExponent=1,i.spotCutoff=1,i.constantAttenuation=1,i.linearAttenuation=1,i.quadraticAttenuation=1,i}return i(t,e),n(t,[{key:"getMVPMatrix",value:function(e,t){return P(this.projectionMatrix,1.5708,1,.01,this.maxDistance),A(ct,this.projectionMatrix),t&&Se(ct,ct,t),Se(ct,ct,this.transform.localMatrixInversed),e&&Se(ct,ct,e),ct}}]),t}(rt),pt=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,o=e.arcLengthDivisions,n=void 0===o?5:o,i=e.controlPoints,l=void 0===i?[]:i,d=e.degree,u=void 0===d?3:d,p=e.knots,m=void 0===p?[]:p,f=e.startKnot,g=void 0===f?0:f,y=e.endKnot,h=void 0===y?m.length-1:y,v;return a(this,t),v=c(this,s(t).apply(this,arguments)),v.arcLengthDivisions=n,v.controlPoints=l,v.degree=u,v.knots=m,v.startKnot=g,v.endKnot=h,v.valid=!0,v}return i(t,e),n(t,[{key:"calcBasisFunctions",value:function(e,t,a,o){var n=[],i=[],s=[];n[0]=1;for(var l=1;l<=a;++l){i[l]=t-o[e+1-l],s[l]=o[e+l]-t;for(var d=0,c=0;c<l;++c){var u=s[c+1],p=i[l-c],m=n[c]/(u+p);n[c]=d+u*m,d=p*m}n[l]=d}return n}},{key:"calcBSplinePoint",value:function(e,t,r,a){for(var o=this.findSpan(e,a,t),n=this.calcBasisFunctions(o,a,e,t),i=[0,0,0,0],s=0;s<=e;++s){var l=r[o-e+s],d=n[s],c=l[3]*d;i[0]+=l[0]*c,i[1]+=l[1]*c,i[2]+=l[2]*c,i[3]+=l[3]*d}return i}},{key:"findSpan",value:function(e,t,r){var a=r.length-e-1;if(t>=r[a])return r.indexOf(r[a])-1;if(t<=r[e])return e;for(var o=e,n=a,i=ue((o+n)/2);t<r[i]||t>=r[i+1];)t<r[i]?n=i:o=i,i=ue((o+n)/2);return i}},{key:"getLengths",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&this.valid)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],r=this.getPoint(0),a=0,o,n;for(t.push(0),n=1;n<=e;n++)o=this.getPoint(n/e),a+=N(o,r),t.push(a),r=o;return this.cacheArcLengths=t,t}},{key:"getPoint",value:function(e){var t=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),r=this.calcBSplinePoint(this.degree,this.knots,this.controlPoints,t);return 1!=r[3]&&j(r,r,1/r[3]),[r[0],r[1],r[2],r[3]]}},{key:"getPointAt",value:function(e){var r=this.getUtoTmapping(e);return this.getPoint(r)}},{key:"getUtoTmapping",value:function(e,r){var a=this.getLengths(),o=0,n=a.length,s;s=r?r:e*a[n-1];for(var l=0,d=n-1,c;l<=d;)if(o=ue(l+(d-l)/2),c=a[o]-s,0>c)l=o+1;else if(0<c)d=o-1;else{d=o;break}if(o=d,a[o]===s)return o/(n-1);var u=a[o],p=a[o+1],m=(s-u)/(p-u),f=(o+m)/(n-1);return f}}]),t}(Pe),mt=[-1,-1,0,1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,1,0],ft=E(),gt=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.name,o=void 0===r?"":r,n=t.depthTest,i=t.depthFunc,s=void 0===i?"LEQUAL":i,l=t.depthMask,d=t.depthRangeNear,c=void 0===d?0:d,u=t.depthRangeFar,p=void 0===u?1:u,m=t.cullFace,f=t.cullFaceMode,g=void 0===f?"BACK":f,y=t.frontFace,h=void 0===y?"CCW":y;a(this,e),this.name=o,this.program=[],this.vbuffer=null,this.blend=!0,this.depthTest=void 0===n||n,this.depthFunc=s,this.depthMask=void 0===l||l,this.depthRangeNear=c,this.depthRangeFar=p,this.cullFace=void 0===m||m,this.cullFaceMode=g,this.frontFace=h,this.timeOffset=0,this.buffers={screenVertices:[]}}return n(e,[{key:"render",value:function(e,t,r,a,o,n,i){this.program[r.id]||(this.program[r.id]=r.createProgram(this)),r.useProgram(this.program[r.id]),this.blend?(r.webgl.enable(r.webgl.BLEND),r.webgl.blendFuncSeparate(r.webgl.SRC_ALPHA,r.webgl.ONE_MINUS_SRC_ALPHA,r.webgl.ZERO,r.webgl.ONE)):r.webgl.disable(r.webgl.BLEND),this.depthTest?(r.webgl.enable(r.webgl.DEPTH_TEST),r.webgl.depthMask(this.depthMask),r.webgl.depthFunc(r.webgl[this.depthFunc]),r.webgl.depthRange(this.depthRangeNear,this.depthRangeFar)):r.webgl.disable(r.webgl.DEPTH_TEST),this.cullFace?(r.webgl.enable(r.webgl.CULL_FACE),r.webgl.cullFace(r.webgl[this.cullFaceMode]),r.webgl.frontFace(r.webgl[this.frontFace])):r.webgl.disable(r.webgl.CULL_FACE),void 0!==r.program.attribute.aVertexScreenPosition&&(!this.buffers.screenVertices[r.id]&&(this.buffers.screenVertices[r.id]=r.webgl.createBuffer(),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.screenVertices[r.id]),r.webgl.bufferData(r.webgl.ARRAY_BUFFER,new Float32Array(mt),r.webgl.STATIC_DRAW)),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.screenVertices[r.id]),r.webgl.vertexAttribPointer(r.program.attribute.aVertexScreenPosition,3,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexScreenPosition)),void 0!==r.program.uniform.uMVCPMatrix&&(Se(ft,n,i),r.webgl.uniformMatrix4fv(r.program.uniform.uMVCPMatrix,!1,ft)),void 0!==r.program.uniform.uCMatrix&&r.webgl.uniformMatrix4fv(r.program.uniform.uCMatrix,!1,a.transform.localMatrixInversed),void 0!==r.program.uniform.uMVMatrix&&r.webgl.uniformMatrix4fv(r.program.uniform.uMVMatrix,!1,a.mvTransform.localMatrix),void 0!==r.program.uniform.uVMatrix&&r.webgl.uniformMatrix4fv(r.program.uniform.uVMatrix,!1,n),void 0!==r.program.uniform.uMMatrix&&r.webgl.uniformMatrix4fv(r.program.uniform.uMMatrix,!1,i),void 0!==r.program.uniform.uCameraPosition&&r.webgl.uniform3fv(r.program.uniform.uCameraPosition,a.transform.xyz),void 0!==r.program.uniform.iTime&&r.webgl.uniform1f(r.program.uniform.iTime,(t.clock.stats.currentGameTime+this.timeOffset)/1e5),void 0!==r.program.uniform.uNormalMatrix&&(B(ft,i),k(ft,ft),r.webgl.uniformMatrix4fv(r.program.uniform.uNormalMatrix,!1,ft)),void 0!==r.program.uniform.uTMatrix&&(r.parallax?r.webgl.uniformMatrix4fv(r.program.uniform.uTMatrix,!1,entity.transform.getParallaxMat4(a)):r.webgl.uniformMatrix4fv(r.program.uniform.uTMatrix,!1,entity.transform.localMatrix))}},{key:"setValues",value:function(){}}]),e}(),yt=E(),ht=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,o=e.material,n=void 0===o?new hr:o,i=e.vertices,l=void 0===i?new Float32Array(0):i,d=e.uvs,u=void 0===d?new Float32Array(0):d,p=e.normals,m=void 0===p?new Float32Array(0):p,f=e.weights,g=void 0===f?new Float32Array(0):f,y=e.weightIndices,h=void 0===y?new Float32Array(0):y,v=e.parameters,x=e.faces,_=e.bufferUsage,b=void 0===_?{vertices:"STATIC_DRAW",uvs:"STATIC_DRAW",normals:"STATIC_DRAW",weights:"STATIC_DRAW",weightIndices:"STATIC_DRAW"}:_,S;return a(this,t),S=c(this,s(t).apply(this,arguments)),S.material=n,S.vertices=l,S.uvs=u,S.normals=m,S.weights=g,S.weightIndices=h,S.castShadow=!0,S.receiveShadow=!0,S.buffers={vertices:[],uvs:[],normals:[],weights:[],weightIndices:[]},S.valid={vertices:[],uvs:[],normals:[],weights:[],weightIndices:[]},S.bufferUsage=b,S}return i(t,e),n(t,[{key:"update",value:function(){}},{key:"render",value:function(e,t,r,a,o,n,i){var s=7<arguments.length&&void 0!==arguments[7]?arguments[7]:this.material,l=8<arguments.length?arguments[8]:void 0;s&&this.vertices.length&&(o.push(this),Se(yt,i,this.transform.localMatrix),!1===s.render(e,t,r,a,o,n,yt,l)||(void 0!==r.program.attribute.aVertexPosition&&(!this.buffers.vertices[r.id]&&(this.buffers.vertices[r.id]=r.webgl.createBuffer()),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.vertices[r.id]),!this.valid.vertices[r.id]&&(r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.vertices,r.webgl[this.bufferUsage.vertices]),this.valid.vertices[r.id]=!0),r.webgl.vertexAttribPointer(r.program.attribute.aVertexPosition,3,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexPosition)),void 0!==r.program.attribute.aTextureCoord&&(!this.buffers.uvs[r.id]&&(this.buffers.uvs[r.id]=r.webgl.createBuffer()),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.uvs[r.id]),!this.valid.uvs[r.id]&&(r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.uvs,r.webgl[this.bufferUsage.uvs]),this.valid.uvs[r.id]=!0),r.webgl.vertexAttribPointer(r.program.attribute.aTextureCoord,2,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aTextureCoord)),void 0!==r.program.attribute.aVertexNormal&&(!this.buffers.normals[r.id]&&(this.buffers.normals[r.id]=r.webgl.createBuffer()),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.normals[r.id]),!this.valid.normals[r.id]&&(r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.normals,r.webgl[this.bufferUsage.normals]),this.valid.normals[r.id]=!0),r.webgl.vertexAttribPointer(r.program.attribute.aVertexNormal,3,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexNormal)),void 0!==r.program.attribute.aVertexWeights&&(!this.buffers.weights[r.id]&&(this.buffers.weights[r.id]=r.webgl.createBuffer()),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.weights[r.id]),!this.valid.weights[r.id]&&(r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.weights,r.webgl[this.bufferUsage.weights]),this.valid.weights[r.id]=!0),r.webgl.vertexAttribPointer(r.program.attribute.aVertexWeights,4,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexWeights)),void 0!==r.program.attribute.aVertexWeightIndices&&(!this.buffers.weightIndices[r.id]&&(this.buffers.weightIndices[r.id]=r.webgl.createBuffer()),r.webgl.bindBuffer(r.webgl.ARRAY_BUFFER,this.buffers.weightIndices[r.id]),!this.valid.weightIndices[r.id]&&(r.webgl.bufferData(r.webgl.ARRAY_BUFFER,this.weightIndices,r.webgl[this.bufferUsage.weightIndices]),this.valid.weightIndices[r.id]=!0),r.webgl.vertexAttribPointer(r.program.attribute.aVertexWeightIndices,4,r.webgl.FLOAT,!1,0,0),r.webgl.enableVertexAttribArray(r.program.attribute.aVertexWeightIndices)),void 0!==r.program.uniform["uDeformMatrix[0]"]&&r.webgl.uniformMatrix4fv(r.program.uniform["uDeformMatrix[0]"],!1,o[o.length-2].skeleton.getFlatMatrix(o[o.length-3].transform.localMatrix)),r.webgl.drawArrays(r.webgl.TRIANGLES,0,this.vertices.length/3),o.pop()))}},{key:"invalidate",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],a=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],o=!(4<arguments.length&&void 0!==arguments[4])||arguments[4];this.valid={vertices:e?[]:this.valid.vertices,uvs:t?[]:this.valid.uvs,normals:r?[]:this.valid.normals,weights:a?[]:this.valid.weights,weightIndices:o?[]:this.valid.weightIndices}}},{key:"addPlane",value:function(e,t){function r(e,t){var r=e.length,a=new Float32Array(r+t.length);return a.set(e),a.set(t,r),a}return this.vertices=r(this.vertices,[0,0,0,1*e,0,0,1*e,1*t,0,0,1*t,0,0,0,0,1*e,1*t,0]),this.uvs=r(this.uvs,[0,1,1,1,1,0,0,0,0,1,1,0]),this.normals=r(this.normals,[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]),this.invalidate(),this}},{key:"addCube",value:function(){function e(e,t){var r=e.length,a=new Float32Array(r+t.length);return a.set(e),a.set(t,r),a}return this.vertices=e(this.vertices,[-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5]),this.uvs=e(this.vertices,[0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,1,1,0,1,1,0,1,0,0,1,0,0,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1]),this.normals=e(this.vertices,[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),this.invalidate(),this}}]),t}(Pe),vt=E(),xt=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.materials,o=e.meshes,n=void 0===o?[]:o,i=e.bones,l=void 0===i?[]:i,d=e.skeleton,u=void 0===d?null:d,p=e.skeletalAnimations,m=void 0===p?[]:p,f=e.animationClips,g=void 0===f?[]:f,y;return a(this,t),y=c(this,s(t).apply(this,arguments)),y.meshes=n,y.animationClips=g,y.bones=l,y.skeleton=u,y.skeletalAnimations=m,y}return i(t,e),n(t,[{key:"update",value:function(e){this.skeleton&&this.skeleton.update(e);for(var t=0;t<this.animationClips.length;t++)this.animationClips[t].update(e)}},{key:"render",value:function(e,t,r,a,o,n,s,l,d){o.push(this),Se(vt,s,this.transform.localMatrix);for(var c=0;c<this.meshes.length;c++)this.meshes[c].render(e,t,r,a,o,n,vt,l,d);o.pop()}},{key:"renderPick",value:function(e,t,r,a){}},{key:"calcParentMatrix",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:vt}}]),t}(Pe),_t=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.count,o=e.life,n=e.rate,i=e.velocity,l=e.offset,d=e.spriteOptions,u=void 0===d?{}:d,p;return a(this,t),p=c(this,s(t).call(this,arguments[0])),p.sprites=[],p.spriteOptions=u,p}return i(t,e),n(t,[{key:"entityCreate",value:function(e){return this.sprites[e]||(this.sprites[e]=new Ct(this.spriteOptions)),this.sprites[e]}}]),t}(Je),bt=function(){function e(){a(this,e)}return n(e,[{key:"preloadTextures",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length?arguments[1]:void 0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},n=e.length,i=[];return new Promise(function(){var s=r(regeneratorRuntime.mark(function r(s,l){var d,c,u,p,m,f,y,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n||s(),r.prev=1,d=!0,c=!1,u=void 0,r.prev=5,p=e[Symbol.iterator]();case 7:if(d=(m=p.next()).done){r.next=20;break}return f=m.value,o.src=f,y=new Ne(o),r.next=13,y.load(a);case 13:i.push(y),n--,t&&(h=(e.length-n)/e.length,t(h,e.length-n)),n||s(i);case 17:d=!0,r.next=7;break;case 20:r.next=26;break;case 22:r.prev=22,r.t0=r["catch"](5),c=!0,u=r.t0;case 26:r.prev=26,r.prev=27,d||null==p["return"]||p["return"]();case 29:if(r.prev=29,!c){r.next=32;break}throw u;case 32:return r.finish(29);case 33:return r.finish(26);case 34:r.next=39;break;case 36:r.prev=36,r.t1=r["catch"](1),l.apply(void 0,g(r.t1));case 39:case"end":return r.stop();}},r,null,[[1,36],[5,22,26,34],[27,,29,33]])}));return function(){return s.apply(this,arguments)}}())}}]),e}(),St=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.renderPasses,o=void 0===r?[]:r,n=t.frameBufferTexture,i=void 0===n?null:n,s=t.viewportClear;a(this,e),this.renderPasses=o,this.frameBufferTexture=i,this.viewportClear=void 0===s||s}return n(e,[{key:"render",value:function(e,t,r,a,o){var n=6<arguments.length&&void 0!==arguments[6]?arguments[6]:[];this.frameBufferTexture?(n.push(this.frameBufferTexture),this.frameBufferTexture.bind(r,0,r.width,r.height),this.viewportClear&&r.clear(),r.render(e,t,a,o,void 0,n),this.frameBufferTexture.unbind(r)):(this.viewportClear&&r.clear(),r.render(e,t,a,o,void 0,n));var i=!0,s=!1,l=void 0;try{for(var d=this.renderPasses[Symbol.iterator](),c,u;!(i=(c=d.next()).done);i=!0)u=c.value,u.render(e,t,r,a,o,void 0,n)}catch(e){s=!0,l=e}finally{try{i||null==d["return"]||d["return"]()}finally{if(s)throw l}}this.frameBufferTexture&&n.pop()}}]),e}(),Et=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.material,o=void 0===r?null:r,n;return a(this,t),n=c(this,s(t).apply(this,arguments)),n.material=o,n}return i(t,e),n(t,[{key:"render",value:function(e,t,r,a,o){var n=6<arguments.length&&void 0!==arguments[6]?arguments[6]:[];this.frameBufferTexture?(n.push(this.frameBufferTexture),this.frameBufferTexture.bind(r,0,"TEXTURE_2D",r.width,r.height),this.viewportClear&&r.clear(),this.material.render(e,t,r,a,o,n),this.frameBufferTexture.unbind(r)):(this.viewportClear&&r.clear(),this.material.render(e,t,r,a,o,n));var i=!0,s=!1,l=void 0;try{for(var d=this.renderPasses[Symbol.iterator](),c,u;!(i=(c=d.next()).done);i=!0)u=c.value,u.render(e,t,r,a,o,n)}catch(e){s=!0,l=e}finally{try{i||null==d["return"]||d["return"]()}finally{if(s)throw l}}this.frameBufferTexture&&n.pop()}}]),t}(St),At=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{map:[],clock:null};a(this,e),this.map=t.map,this.currentController=[],this.clock=t.clock,this.routeViews=[],this.scenes=[],this.queryDOM()}return n(e,[{key:"navigate",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=r.view,o=void 0===a?"main":a;this.routeUnload(this.currentController[o],o);var n=this.map[e];if(!n)return!1;this.queryDOM();var i=!0,s=!1,l=void 0;try{for(var d=this.routeViews[Symbol.iterator](),c,u;!(i=(c=d.next()).done);i=!0)u=c.value,o&&o!=u.id&&o.id!=u||n.module.populateDOM(u)}catch(e){s=!0,l=e}finally{try{i||null==d["return"]||d["return"]()}finally{if(s)throw l}}return n.module.onload(t),n.module.start(),this.currentController[o]=n.module,this.currentRoute=n,this.clock&&!n.module.clock&&(this.clock.add(n.module),this.clock.resetAccumulator()),!0}},{key:"modal",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},a=3<arguments.length?arguments[3]:void 0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},n=o.view,i=void 0===n?"main":n,s=this.map[e];if(!s)return!1;this.queryDOM();var l=!0,d=!1,c=void 0;try{for(var u=this.routeViews[Symbol.iterator](),p,m;!(l=(p=u.next()).done);l=!0)m=p.value,i&&i!=m.id&&i.id!=m||s.module.populateDOM(m)}catch(e){d=!0,c=e}finally{try{l||null==u["return"]||u["return"]()}finally{if(d)throw c}}return s.module.onload(a),s.module.start(),s.module._modal={callee:this,module:s.module,view:i,onResolve:t,onReject:r},this.currentController[i]=s.module,this.currentRoute=s,this.clock&&(this.clock.add(s.module),this.clock.resetAccumulator()),s.module._modal}},{key:"modalResult",value:function(e,t){var r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];t&&(r&&this.routeUnload(t.module,t.view),e?t.onResolve():t.onReject())}},{key:"modalUnload",value:function(e){e&&this.routeUnload(e.module,e.view)}},{key:"queryDOM",value:function(){this.routeViews=[];for(var e=document.getElementsByTagName("onyx-route-view"),t=0;t<e.length;t++)this.routeViews.push(e[t]);!this.routeViews.length&&document.getElementById("onyx-route-view")&&this.routeViews.push(document.getElementById("onyx-route-view"))}},{key:"routeUnload",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(e){e.stop(),this.clock&&this.clock.remove(e);var r=!0,a=!1,o=void 0;try{for(var n=this.routeViews[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)s=i.value,t&&t!=s.id&&t.id!=s||(e.onunload(s),e.clearDom(s))}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}}}}]),e}(),Tt=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.template,o=void 0===r?null:r,n=e.templateURL,i=void 0===n?null:n,l=e.sceneURL,u=void 0===l?null:l,p=e.element,m=void 0===p?"":p,f=e.clock,g=void 0===f?null:f,y;return a(this,t),y=c(this,s(t).call(this)),y.viewports=[],y.viewportElements=[],y.entities=[],y.removeEntities=[],y.cameras=[],y.lights=[],y.renderPasses=[new tr({renderPasses:[new St]})],y.templateURL=i,y.sceneURL=u,y.template=o,y.clock=g,y.ambientLightColor=new qe(.05,.05,.05,1),y.directionalLight=new st({id:"DirectionalLight_Default",diffuseColor:new qe(.5,.5,.5,1),intensity:2,vector:[-.85,-.8,-.75]}),y.fogColor=new qe(1,1,1,1),y.fogDensity=0,m&&(y.element=document.querySelector(m),!y.element&&console.warn("[Onyx] Element '".concat(m,"' not found"))),g&&g.add(d(y)),y.queryDOM(y.element),y.loadSceneURL(),y.loadTemplateURL(),y}return i(t,e),n(t,[{key:"registerHandler",value:function(e){var t=this,r=e.elementId?document.getElementById(e.elementId):document.body;return r?void window.setTimeout(function(){e.callback=e.target[e.property].bind(t),r.addEventListener?r.addEventListener(e.event,e.callback):r[e.event]=e.callback},0):void console.warn("[Onyx] Element \"".concat(e.elementId,"\" not found"))}},{key:"unregisterHandler",value:function(e){var t=e.elementId?document.getElementById(e.elementId):document.body;return t?void(t.addEventListener?t.removeEventListener(e.event,e.callback):t[e.event]=null):void console.warn("[Onyx] Element \"".concat(e.elementId,"\" not found"))}},{key:"modalResult",value:function(e,t){this._modal&&this._modal.callee.modalResult(e,this._modal,t)}},{key:"modalUnload",value:function(){this._modal&&this._modal.callee.modalUnload(this._modal)}},{key:"loadSceneURL",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.sceneURL;return!!t&&void this.fetchTemplate(t).then(function(t){e.scene=t})}},{key:"loadTemplateURL",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.templateURL;return!!t&&void this.fetchTemplate(t).then(function(t){e.template=t})}},{key:"onload",value:function(){for(var e=arguments.length,r=Array(e),a=0,o;a<e;a++)r[a]=arguments[a];(o=p(s(t.prototype),"onload",this)).call.apply(o,[this].concat(r)),this.element&&this.queryDOM(this.element)}},{key:"onunload",value:function(){for(var e=arguments.length,r=Array(e),a=0,o;a<e;a++)r[a]=arguments[a];(o=p(s(t.prototype),"onunload",this)).call.apply(o,[this].concat(r)),this.entities=[],this.viewports=[],this.viewportElements=[],this.components=[],this.element&&(this.element.innerHTML="",this.element.style.display="none")}},{key:"populateDOM",value:function(e){null!==this.template&&void 0!==this.template&&(e.innerHTML=this.template),this.element&&(this.element.style.display="block"),this.queryDOM(this.element)}},{key:"clearDom",value:function(e){e&&(e.innerHTML="")}},{key:"queryDOM",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document.body;this.viewportElements=[];for(var t=e.getElementsByTagName("onyx-viewport"),r=0;r<t.length;r++)this.viewportElements.push(t[r]);if("undefined"!=typeof document.querySelectorAll&&!navigator.isCocoonJS){t=e.querySelectorAll("[onyx-viewport]");for(var r=0;r<t.length;r++)this.viewportElements.push(t[r])}else{t=e.getElementsByTagName("*");for(var r=0,a;r<t.length;r++)a=t[r],("undefined"!=typeof a["onyx-viewport"]||a.hasAttribute&&a.hasAttribute("onyx-viewport"))&&this.viewportElements.push(a)}var o=!0,n=!1,s=void 0;try{for(var l=this.viewportElements[Symbol.iterator](),d,c;!(o=(d=l.next()).done);o=!0)c=d.value,this.viewports.push(new qt(c))}catch(e){n=!0,s=e}finally{try{o||null==l["return"]||l["return"]()}finally{if(n)throw s}}}},{key:"render",value:function(e){if(this.visible){var t=!0,r=!1,a=void 0;try{for(var o=this.renderPasses[Symbol.iterator](),n;!(t=(n=o.next()).done);t=!0){var i=n.value,s=!0,l=!1,d=void 0;try{for(var c=this.viewports[Symbol.iterator](),u,p;!(s=(u=c.next()).done);s=!0)p=u.value,i.render(e,this,p,[this],this.transform.localMatrix)}catch(e){l=!0,d=e}finally{try{s||null==c["return"]||c["return"]()}finally{if(l)throw d}}}}catch(e){r=!0,a=e}finally{try{t||null==o["return"]||o["return"]()}finally{if(r)throw a}}}}},{key:"update",value:function(e){if(p(s(t.prototype),"update",this).call(this,e,this),!!this.enabled){var r=!0,a=!1,o=void 0;try{for(var n=this.entities[Symbol.iterator](),i,l;!(r=(i=n.next()).done);r=!0)l=i.value,l.update(e,this)}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}var d=!0,c=!1,u=void 0;try{for(var m=this.removeEntities[Symbol.iterator](),f,g;!(d=(f=m.next()).done);d=!0)g=f.value,this.remove(g,!1)}catch(e){c=!0,u=e}finally{try{d||null==m["return"]||m["return"]()}finally{if(c)throw u}}this.removeEntities=[]}}},{key:"add",value:function(e){this.entities.push(e),e.onSpawn&&e.onSpawn(this),e instanceof ze&&this.cameras.push(e),(e instanceof rt||e instanceof dt||e instanceof ut)&&(this.lights.push(e),this.lights.length>xe.MAX_LIGHTS&&console.warn("[Onyx] Warning: Light count greater than MAX_LIGHTS."))}},{key:"addRenderPass",value:function(e){this.renderPasses.push(e)}},{key:"remove",value:function(e,t){t?this.removeEntities.push(e):-1<this.entities.indexOf(e)&&(this.entities.splice(this.entities.indexOf(e),1),e.onDestroy&&e.onDestroy(this))}},{key:"findByIndex",value:function(e){p(s(t.prototype),"findByIndex",this).call(this,e);for(var r=0;r<this.entities.length;r++){if(this.entities[r].index===e)return this.entities[r];if(this.entities[r].findByIndex(e))return this.entities[r].findByIndex(e)}}},{key:"start",value:function(){this.clock&&this.clock.start()}},{key:"stop",value:function(){this.clock&&this.clock.stop()}},{key:"sortEntitiesByZ",value:function(e){e?this.entities.sort(function(e,t){return e.transform&&t.transform&&e.transform.z-t.transform.z}):this.entities.sort(function(e,t){return!e.transform||!t.transform||t.transform.z-e.transform.z})}},{key:"fetchTemplate",value:function(t){return fetch(t,{"Content-Type":"text/html"}).then(function(e){if(!e.ok)throw Error(e.statusText,e.url);return e.text()}).then(function(e){return e})["catch"](function(r){console.error("Error fetching template '".concat(t,"'."),r)})}}]),t}(Fe),kt=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.transform,o=void 0===r?new Dt:r,n=e.children,i=void 0===n?[]:n,l;return a(this,t),l=c(this,s(t).call(this)),l.transform=o,l.children=i,l.matrixBuffer=new Float32Array(16*xe.MAX_BONES),l}return i(t,e),n(t,[{key:"calcBindPose",value:function(){for(var e=0;e<this.children.length;e++)this.children[e].calcBindPose(!0)}},{key:"flattenChildren",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.children,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=!0,a=!1,o=void 0;try{for(var n=e[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)s=i.value,t.push(s),this.flattenChildren(s.children,t)}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}return t}},{key:"getFlatMatrix",value:function(){for(var e=0,t=0;t<this.children.length;t++)e=this.children[t].getFlatMatrix(this.matrixBuffer,e,!1);return this.matrixBuffer}}]),t}(Pe),Bt=E(),Ot=[0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,1,1,0],wt=[0,1,1,1,1,0,0,0,0,1,1,0],It=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],Ct=function(t){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.src,o=void 0===t?"":t,n=e.transform,i=void 0===n?new Dt:n,l=e.textures,d=void 0===l?[]:l,u=e.material,p=void 0===u?null:u,m=e.magFilter,f=void 0===m?"LINEAR":m,g=e.minFilter,y=void 0===g?"LINEAR_MIPMAP_LINEAR":g,h=e.wrap,v=void 0===h?{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"}:h,x=e.flipX,_=e.flipY,b=e.pivot,S=void 0===b?[0,0]:b,E=e.lighting,A=void 0===E?0:E,T=e.width,k=void 0===T?0:T,B=e.height,O=void 0===B?0:B,w=e.shadowCastingMode,I=void 0===w?1:w,C=e.pixelsPerUnit,M=void 0===C?1:C,P;if(a(this,r),P=c(this,s(r).apply(this,arguments)),P.transform=i,P._pixelsPerUnit=1,P.textures=d,P._minFilter=y,P._magFilter=f,P._wrap=v,P._src=o,P._materialIndex=0,P.flipX=void 0!==x&&x,P.flipY=void 0!==_&&_,P.pivot=S,P.width=k,P.height=O,P.animations={},p||(p=new hr({name:"SPRITE_"+o,lighting:A,shadowCastingMode:I})),P.mesh=new ht({id:"MESH_SPRITE_"+P.id,material:p,vertices:new Float32Array(Ot),uvs:new Float32Array(wt),normals:new Float32Array(It),bufferUsage:{vertices:"DYNAMIC_DRAW",uvs:"DYNAMIC_DRAW",normals:"STATIC_DRAW",weights:"STATIC_DRAW",weightIndices:"STATIC_DRAW"}}),!d.length)P.src=o,P.pixelsPerUnit=M;else for(var D in P.pixelsPerUnit=M,o)P.fitToTexture(D);return P}return i(r,t),n(r,[{key:"src",get:function(){return this._src},set:function(t){var r=this;if(!t)return this.textures=[],this.mesh.material.diffuseTexture=this.textures[0],void(this._src=t);Array.isArray(t)||(t=[t]);var a=function(e){var a=!0,o=!1,n=void 0;try{for(var i=r.textures[Symbol.iterator](),s,l;!(a=(s=i.next()).done);a=!0)if(l=s.value,l.src==t)return{v:void 0}}catch(e){o=!0,n=e}finally{try{a||null==i["return"]||i["return"]()}finally{if(o)throw n}}r.textures[e]=new Ne({src:t[e],flipY:!1,magFilter:r._magFilter,minFilter:r._minFilter}),r.mesh.material.diffuseTexture=r.textures[e],r.mesh.material.buildProgram(),r.textures[e].load().then(function(){r.fitToTexture(e)})};for(var o in t){var n=a(o);if("object"===e(n))return n.v}return this._src=t,t}},{key:"minFilter",get:function(){return this._minFilter},set:function(e){this._minFilter=e;var t=!0,r=!1,a=void 0;try{for(var o=this.textures[Symbol.iterator](),n,i;!(t=(n=o.next()).done);t=!0)i=n.value,i.minFilter=e}catch(e){r=!0,a=e}finally{try{t||null==o["return"]||o["return"]()}finally{if(r)throw a}}}},{key:"magFilter",get:function(){return this._magFilter},set:function(e){this._magFilter=e;var t=!0,r=!1,a=void 0;try{for(var o=this.textures[Symbol.iterator](),n,i;!(t=(n=o.next()).done);t=!0)i=n.value,i.magFilter=e}catch(e){r=!0,a=e}finally{try{t||null==o["return"]||o["return"]()}finally{if(r)throw a}}}},{key:"pixelsPerUnit",get:function(){return this._pixelsPerUnit},set:function(e){if(!this.textures[0])return void this.mesh.vertices.set(new Float32Array(Ot));for(var t=e/this._pixelsPerUnit,r=0;r<this.mesh.vertices.length;r++)this.mesh.vertices[r]*=t;return this._pixelsPerUnit=e,this.mesh.invalidate(!0),this._pixelsPerUnit}}]),n(r,[{key:"loadTextures",value:function(e){var t=this,r=this.textures.length;return new Promise(function(a){var o=!0,n=!1,i=void 0;try{for(var s=t.textures[Symbol.iterator](),l,d;!(o=(l=s.next()).done);o=!0)d=l.value,d.load(e).then(function(){1==r--&&a()})}catch(e){n=!0,i=e}finally{try{o||null==s["return"]||s["return"]()}finally{if(n)throw i}}})}},{key:"render",value:function(e,t,r,a,o,n,i,s,l){o.push(this),Se(Bt,i,this.transform.localMatrix),this.mesh.render(e,t,r,a,o,n,Bt,s,l),o.pop()}},{key:"update",value:function(e,t,a){p(s(r.prototype),"update",this).call(this,e,t,a),this.currentAnimation&&this.currentAnimation.update(e,t,a,this)}},{key:"addAnimation",value:function(e,t){this.animations[e]=t,t.sprite=this}},{key:"playAnimation",value:function(e,t){return this.animations[e]?void(this.currentAnimation=this.animations[e],this.currentAnimation.play(t)):console.warn("Animation '".concat(e,"' not found"))}},{key:"selectAnimation",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.animations[e]?void(this.currentAnimation=this.animations[e],this.currentAnimation.setFrame(t)):console.warn("Animation '".concat(e,"' not found"))}},{key:"fitToTexture",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.selectFrame(0,0,this.textures[e].width,this.textures[e].height,this.pivot[0],this.pivot[1],e,!0)}},{key:"selectFrame",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:this.pivot[0],n=5<arguments.length&&void 0!==arguments[5]?arguments[5]:this.pivot[1],i=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,s=!!(9<arguments.length&&void 0!==arguments[9])&&arguments[9];this._materialIndex=i,this.mesh.material.diffuseTexture=this.textures[i];var l=this.mesh.material.diffuseTexture;if(l){var d=e/l.width,c=(e+r)/l.width,u=t/l.height,p=(t+a)/l.height;if(this.flipX){var m=[c,d];d=m[0],c=m[1]}if(this.flipY){var f=[u,p];p=f[0],u=f[1]}this.mesh.uvs.set([d,p,c,p,c,u,d,u,d,p,c,u]),r*=this._pixelsPerUnit,a*=this._pixelsPerUnit,r!=this.width||a!=this.height||s?(this.mesh.vertices[0]=Ot[0]*r+-o*r,this.mesh.vertices[3]=Ot[3]*r+-o*r,this.mesh.vertices[6]=Ot[6]*r+-o*r,this.mesh.vertices[9]=Ot[9]*r+-o*r,this.mesh.vertices[12]=Ot[12]*r+-o*r,this.mesh.vertices[15]=Ot[15]*r+-o*r,this.mesh.vertices[1]=Ot[1]*a+-n*a,this.mesh.vertices[4]=Ot[4]*a+-n*a,this.mesh.vertices[7]=Ot[7]*a+-n*a,this.mesh.vertices[10]=Ot[10]*a+-n*a,this.mesh.vertices[13]=Ot[13]*a+-n*a,this.mesh.vertices[16]=Ot[16]*a+-n*a,this.mesh.invalidate(!0,!0,!1,!1,!1)):this.mesh.invalidate(!1,!0,!1,!1,!1),this.width=r,this.height=a,this.pivot=[o,n]}}}]),r}(Pe),Mt=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.loop,o=t.frames,n=void 0===o?[]:o,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;a(this,e),this.sprite=i,this.frames=[],this.state=0,this.loop=void 0===r||r,this.currentTime=0,this.currentFrame=null,this.currentFrameIndex=0,this.callback=null;var s=!0,l=!1,d=void 0;try{for(var c=n[Symbol.iterator](),u,p;!(s=(u=c.next()).done);s=!0)p=u.value,this.addFrame(p)}catch(e){l=!0,d=e}finally{try{s||null==c["return"]||c["return"]()}finally{if(l)throw d}}}return n(e,[{key:"update",value:function(e){if(this.state){var t=this.currentFrame.speed||0;if(this.currentTime+e>t){var r=this.currentFrame;if(this.currentFrameIndex++,!this.frames[this.currentFrameIndex])if(this.callback&&this.callback(),this.loop)this.currentFrameIndex=0;else return this.state=0,void(r.onComplete&&r.onComplete());this.setFrame(),r.onComplete&&r.onComplete(),this.currentFrame.onStart&&this.currentFrame.onStart(),this.currentTime=0}this.currentTime+=e}}},{key:"pause",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.state?0:1;this.state=e}},{key:"play",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.loop;this.state=1,this.loop=t,this.callback=e,this.reset(),this.setFrame()}},{key:"reset",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.currentTime=0,this.currentFrame=this.frames[e],this.currentFrameIndex=e}},{key:"addFrame",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=void 0===t?"":t,a=e.x,o=void 0===a?0:a,n=e.y,i=void 0===n?0:n,s=e.width,l=void 0===s?0:s,d=e.height,c=void 0===d?0:d,u=e.offsetX,p=void 0===u?0:u,m=e.offsetY,f=void 0===m?0:m,g=e.pivotX,y=void 0===g?0:g,h=e.pivotY,v=void 0===h?0:h,x=e.speed,_=void 0===x?0:x,b=e.materialIndex,S=void 0===b?0:b;this.frames.push({name:r,x:o,y:i,width:l,height:c,pivotX:y,pivotY:v,offsetX:p,offsetY:f,speed:_,materialIndex:S})}},{key:"setFrame",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.currentFrameIndex;this.currentTime=0,this.currentFrame=this.frames[e],this.currentFrameIndex=e,this.sprite.selectFrame(this.currentFrame.x,this.currentFrame.y,this.currentFrame.width,this.currentFrame.height,this.currentFrame.pivotX,this.currentFrame.pivotY,this.currentFrame.offsetX,this.currentFrame.offsetY,this.currentFrame.materialIndex)}}]),e}(),Pt=E(),Dt=function(){var t=Math.asin;function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.position,o=void 0===r?[0,0,0,1]:r,n=t.rotation,i=void 0===n?[0,0,0,1]:n,s=t.scale,l=void 0===s?[1,1,1]:s;a(this,e),this.valid={mat4:!1,translation:!1,rotation:!1,rotationQuat:!1,scale:!1,inverse:!1,inverseTransposed:!1},this._temp={mat4:E(),inverseMat4:E(),inverseTransposeMat4:E(),translation:R(o[0]||0,o[1]||0,o[2]||0,void 0===o[3]?1:o[3]),rotation:R(i[0]||0,i[1]||0,i[2]||0,void 0===i[3]?1:i[3]),rotationQuat:Q(),scale:R(void 0===l[0]?1:l[0],void 0===l[1]?1:l[1],void 0===l[2]?1:l[2])}}return n(e,[{key:"invalidate",value:function(){this.valid={mat4:!1,translation:!1,rotation:!1,rotationQuat:!1,scale:!1,inverse:!1,inverseTransposed:!1}}},{key:"targetTo",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,1,0];F(Pt,this.xyz,e,r),C(this._temp.rotationQuat,Pt);var a=this._temp.rotationQuat[0],o=this._temp.rotationQuat[1],n=this._temp.rotationQuat[2],i=this._temp.rotationQuat[3];this.yaw=re(2*o*i-2*a*n,1-2*o*o-2*n*n),this.pitch=re(2*a*i-2*o*n,1-2*a*a-2*n*n),this.roll=t(2*a*o+2*n*i),this.valid.mat4=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"lookAt",value:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,1,0];L(Pt,this.xyz,e,r),C(this._temp.rotationQuat,Pt);var a=this._temp.rotationQuat[0],o=this._temp.rotationQuat[1],n=this._temp.rotationQuat[2],i=this._temp.rotationQuat[3];this.yaw=re(2*o*i-2*a*n,1-2*o*o-2*n*n),this.pitch=re(2*a*i-2*o*n,1-2*a*a-2*n*n),this.roll=t(2*a*o+2*n*i),this.valid.mat4=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"orbitX",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0];X(this._temp.translation,this._temp.translation,t,e),this.valid.mat4=!1,this.valid.inverse=!1,this.valid.translation=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"orbitY",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0];Y(this._temp.translation,this._temp.translation,t,e),this.valid.mat4=!1,this.valid.inverse=!1,this.valid.translation=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"orbitZ",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0];W(this._temp.translation,this._temp.translation,t,e),this.valid.mat4=!1,this.valid.inverse=!1,this.valid.translation=!1,this.valid.rotation=!1,this.valid.rotationQuat=!1}},{key:"localMatrix",get:function(){return this.valid.mat4||(M(this._temp.mat4,this.rotationQuat,this._temp.translation,this._temp.scale),this.valid.mat4=!0),this._temp.mat4},set:function(e){this._temp.mat4=e,this.invalidate(),this.valid.mat4=!0}},{key:"localMatrixInversed",get:function(){return this.valid.inverse&&this.valid.mat4||(B(this._temp.inverseMat4,this.localMatrix),this.valid.inverse=!0),this._temp.inverseMat4}},{key:"localMatrixInversedTransposed",get:function(){return this.valid.inverseTransposed&&this.valid.inverse&&this.valid.mat4||(k(this._temp.inverseTransposeMat4,this.localMatrixInversed),this.valid.inverseTransposed=!0),this._temp.inverseTransposeMat4}},{key:"rotationQuat",get:function(){return this.valid.rotationQuat||(ee(this._temp.rotationQuat,this._temp.rotation[0]*(180/me),this._temp.rotation[1]*(180/me),this._temp.rotation[2]*(180/me)),this.valid.rotationQuat=!0,this.valid.mat4=!1),this._temp.rotationQuat},set:function(){this._temp.rotationQuat=this._temp.rotationQuat,this.valid.rotationQuat=!0}},{key:"x",get:function(){return this.valid.translation||(w(this._temp.translation,this.localMatrix),this.valid.translation=!0),this._temp.translation[0]},set:function(e){return this._temp.translation[0]===e?e:(this._temp.translation[0]=e,this.valid.mat4=!1,e)}},{key:"y",get:function(){return this.valid.translation||(w(this._temp.translation,this.localMatrix),this.valid.translation=!0),this._temp.translation[1]},set:function(e){return this._temp.translation[1]===e?e:(this._temp.translation[1]=e,this.valid.mat4=!1,e)}},{key:"z",get:function(){return this.valid.translation||(w(this._temp.translation,this.localMatrix),this.valid.translation=!0),this._temp.translation[2]},set:function(e){return this._temp.translation[2]===e?e:(this._temp.translation[2]=e,this.valid.mat4=!1,this._temp.translation[2])}},{key:"xyz",get:function(){return this.valid.translation||(w(this._temp.translation,this.localMatrix),this.valid.translation=!0),this._temp.translation},set:function(e){return this._temp.translation[0]===e[0]&&this._temp.translation[1]===e[1]&&this._temp.translation[2]===e[2]?e:(this._temp.translation[0]=e[0],this._temp.translation[1]=e[1],this._temp.translation[2]=e[2],this.valid.mat4=!1,this._temp.translation)}},{key:"sx",get:function(){return this.valid.scale||(I(this._temp.scale,this.localMatrix),this.valid.scale=!0),this._temp.scale[0]},set:function(e){return this._temp.scale[0]===e?e:(this._temp.scale[0]=e,this.valid.mat4=!1,this._temp.scale[0])}},{key:"sy",get:function(){return this.valid.scale||(I(this._temp.scale,this.localMatrix),this.valid.scale=!0),this._temp.scale[1]},set:function(e){return this._temp.scale[1]===e?e:(this._temp.scale[1]=e,this.valid.mat4=!1,this._temp.scale[1])}},{key:"sz",get:function(){return this.valid.scale||(I(this._temp.scale,this.localMatrix),this.valid.scale=!0),this._temp.scale[2]},set:function(e){return this._temp.scale[2]===e?e:(this._temp.scale[2]=e,this.valid.mat4=!1,this._temp.scale[2])}},{key:"sxyz",get:function(){return this.valid.scale||(I(this._temp.scale,this.localMatrix),this.valid.scale=!0),this._temp.scale},set:function(e){return this._temp.scale[0]===e[0]&&this._temp.scale[1]===e[1]&&this._temp.scale[2]===e[2]?e:(this._temp.scale[0]=e[0],this._temp.scale[1]=e[1],this._temp.scale[2]=e[2],this.valid.mat4=!1,this._temp.scale)}},{key:"pitch",get:function(){return this.valid.rotation||(C(this._temp.rotation,this.localMatrix),this.valid.rotation=!0),this._temp.rotation[0]},set:function(e){return this._temp.rotation[0]===e?e:(this._temp.rotation[0]=e,this.valid.rotationQuat=!1,this.valid.mat4=!1,this._temp.rotation[0])}},{key:"yaw",get:function(){return this.valid.rotation||(C(this._temp.rotation,this.localMatrix),this.valid.rotation=!0),this._temp.rotation[1]},set:function(e){return this._temp.rotation[1]===e?e:(this._temp.rotation[1]=e,this.valid.rotationQuat=!1,this.valid.mat4=!1,this._temp.rotation[1])}},{key:"roll",get:function(){return this.valid.rotation||(C(this._temp.rotation,this.localMatrix),this.valid.rotation=!0),this._temp.rotation[2]},set:function(e){return this._temp.rotation[2]===e?e:(this._temp.rotation[2]=e,this.valid.rotationQuat=!1,this.valid.mat4=!1,this._temp.rotation[2])}}]),e}(),Lt=E(),Ft=[0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,1,1,0],Ht=[0,1,1,1,1,0,0,0,0,1,1,0],Rt=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],Nt=0,Ut=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.id,o=void 0===r?Nt++:r,n=e.transform,i=void 0===n?new Dt:n,l=e.map,d=void 0===l?"":l,u=e.atlas,p=void 0===u?"":u,m=e.pixelsPerUnit,f=void 0===m?1:m,g=e.tileSize,y=void 0===g?[16,16]:g,h=e.atlasPadding,v=e.magFilter,x=void 0===v?"LINEAR":v,_=e.minFilter,b=void 0===_?"LINEAR_MIPMAP_LINEAR":_,S=e.wrap,E;return a(this,t),E=c(this,s(t).apply(this,arguments)),E.id=o,E.mesh=new ht({material:new vr("TILEMAP_"+o,{atlas:null,map:null}),vertices:new Float32Array(Ft),uvs:new Float32Array(Ht),normals:new Float32Array(Rt)}),E.transform=i,E._minFilter=b,E._magFilter=x,E._pixelsPerUnit=f,E._tileSize=y,E.map=d,E.atlas=p,E.tileSize=y,E}return i(t,e),n(t,[{key:"atlas",get:function(){return this._atlas},set:function(e){var t=this;return e?(this._atlas=new Ne({src:e,flipY:!1,magFilter:this._magFilter,minFilter:this._minFilter,generateMipmap:!1}),this.mesh.material.atlas=this._atlas,this._atlas.load().then(function(){t.pixelsPerUnit=t._pixelsPerUnit}),this._atlas):(this._atlas=null,void(this.mesh.material.atlas=this._atlas))}},{key:"map",get:function(){return this._map},set:function(e){var t=this;return e?(this._map=new Ne({src:e,flipY:!1,magFilter:this._magFilter,minFilter:this._minFilter,wrap:{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"},generateMipmap:!1}),this.mesh.material.map=this._map,this._map.load().then(function(){t.pixelsPerUnit=t._pixelsPerUnit}),this._map):(this._map=null,void(this.mesh.material.map=this.map))}},{key:"pixelsPerUnit",get:function(){return this._pixelsPerUnit},set:function(e){this._pixelsPerUnit=e,this.mesh.vertices[0]=0,this.mesh.vertices[3]=this._map.img.width*this._pixelsPerUnit,this.mesh.vertices[6]=this._map.img.width*this._pixelsPerUnit,this.mesh.vertices[9]=0,this.mesh.vertices[12]=0,this.mesh.vertices[15]=this._map.img.width*this._pixelsPerUnit,this.mesh.vertices[1]=0,this.mesh.vertices[4]=0,this.mesh.vertices[7]=this._map.img.height*this._pixelsPerUnit,this.mesh.vertices[10]=this._map.img.height*this._pixelsPerUnit,this.mesh.vertices[13]=0,this.mesh.vertices[16]=this._map.img.height*this._pixelsPerUnit,this.mesh.invalidate(!0,!0)}},{key:"tileSize",get:function(){return this._tileSize},set:function(e){!1==e instanceof Array&&(e=[e,e]),this._tileSize=e}},{key:"minFilter",get:function(){return this._minFilter},set:function(e){this._minFilter=e,this._atlas.minFilter=e,this._map.minFilter=e}},{key:"magFilter",get:function(){return this._magFilter},set:function(e){this._magFilter=e,this._atlas.magFilter=e,this._map.magFilter=e}}]),n(t,[{key:"render",value:function(e,t,r,a,o,n,i){o.push(this),Se(Lt,i,this.transform.localMatrix),this.mesh.render(e,t,r,a,o,n,Lt),o.pop()}}]),t}(Pe),Gt=function(e){function t(){var e;return a(this,t),e=c(this,s(t).call(this)),e.currentTime=0,e.interval=0,e.currentIntervalCount=0,e.intervalCount=-1,e.mode="timeout",e.direction=1,e.enabled=!0,e.callback=function(){},e}return i(t,e),n(t,[{key:"update",value:function(e,t){if(this.enabled)switch(this.currentTime+=e*this.direction,this.mode){case"timeout":this.currentTime>this.interval&&(this.callback(t),this.enabled=!1);break;case"interval":this.currentTime>this.interval&&(this.currentTime=0+(this.currentTime-this.interval),this.callback(t),this.currentIntervalCount++,0<this.intervalCount&&this.currentIntervalCount>=this.intervalCount&&(this.enabled=!1));break;case"modulate":this.currentTime>this.interval?(this.currentTime=this.interval-(this.currentTime-this.interval),this.direction=-1,this.currentIntervalCount++):0>this.currentTime&&(this.currentTime=0-this.currentTime,this.direction=1,this.currentIntervalCount++),this.callback(e,this.currentTime/this.interval,this.currentIntervalCount);}}},{key:"setTimeout",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.interval=t,this.callback=e,this.mode="timeout",this.currentTime=0,this.enabled=!0}},{key:"setInterval",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.interval=t,this.intervalCount=r,this.callback=e,this.mode="interval",this.currentTime=0,this.currentIntervalCount=0,this.enabled=!0}},{key:"setModulate",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.interval=t,this.callback=e,this.mode="modulate",this.currentTime=0,this.currentIntervalCount=0,this.enabled=!0}},{key:"restart",value:function(){this.currentTime=0}}]),t}(Fe),Vt={linear:function(e){return e},easeIn:function(e){return-ge(e*me)/2+.5},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return .5>e?2*e*e:-1+(4-2*e)*e},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return .5>e?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return .5>e?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return .5>e?16*e*e*e*e*e:1+16*--e*e*e*e*e},easeInElastic:function(e){return(.04-.04/e)*fe(25*e)+1},easeOutElastic:function(e){return .04*e/--e*fe(25*e)},easeInOutElastic:function(e){return 0>(e-=.5)?(.02+.01/e)*fe(50*e):(.02-.01/e)*fe(50*e)+1}},Xt=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.propParent,o=e.property,n=e.to,i=e.from,l=e.duration,d=e.direction,u=e.callback,p=e.method,m=void 0===p?"linear":p,f=e.onUpdate,g=void 0===f?function(){}:f,y;return a(this,t),y=c(this,s(t).call(this)),y.set(r,o,n,i,l,d,u,m,g),y}return i(t,e),n(t,[{key:"update",value:function(e){this.enabled&&1!==this.percentComplete&&(this.currentTime+=e*this.direction,this.percentComplete=pe(this.currentTime/this.duration,1),1===this.percentComplete&&this.callback?(this.propParent[this.property]=this.to,this.callback()):(this.propParent[this.property]=this.from+(this.to-this.from)*this.method(this.percentComplete),this.onUpdate(this.propParent[this.property])))}},{key:"set",value:function(e,t,r,a,o){var n=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,i=6<arguments.length?arguments[6]:void 0,s=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"linear",l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:function(){};this.duration=o,this.direction=n,this.propParent=e,this.property=t,this.from=a,this.to=r,this.callback=i,this.onUpdate=l,this.method=Vt[s],this.currentTime=0,this.percentComplete=0,void 0===a&&e&&(a=e[t])}},{key:"linear",value:function(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:e[prop],o=4<arguments.length?arguments[4]:void 0,n=5<arguments.length?arguments[5]:void 0;this.set(e,t,r,a,o,n,"linear")}},{key:"easeIn",value:function(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:e[prop],o=4<arguments.length?arguments[4]:void 0,n=5<arguments.length?arguments[5]:void 0;this.set(e,t,r,a,o,n,"easeIn")}}]),t}(Pe),Yt=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;a(this,e),this.x=t,this.y=r}return n(e,[{key:"set",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.x=e[0]||0,this.y=e[1]||0}},{key:"copy",value:function(t){return t?(t.x=t.x,t.y=t.y):t=new e(this.x,this.y),t}}]),e}(),Wt=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n;return a(this,t),n=c(this,s(t).call(this,e,r)),n.z=o,n}return i(t,e),n(t,[{key:"set",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.x=e[0]||0,this.y=e[1]||0,this.z=e[2]||0}},{key:"copy",value:function(e){return e?(e.x=e.x,e.y=e.y,e.z=e.z):e=new t(this.x,this.y,this.z),e}}]),t}(Yt),zt=new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0,0,0,0,1,1,0]),jt=new Float32Array([0,0,1,0,1,1,0,1,0,0,1,1]),Kt=function(e){function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:32,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:32,n;return a(this,t),n=c(this,s(t).call(this)),n.width=r,n.height=o,n.unitScale=1,n.centered=!1,n.flipX=!1,n.flipY=!1,n.antiAliasing=!0,n.mesh=new ht,n.mesh.addMaterial("video",zt,{uvs:jt,texture:e}),n.mesh.materials[0].textureLoad.then(function(){n.mesh.materials[0].texture.flipY=!0,n.antiAliasing||(n.mesh.materials[0].texture.magFilter="NEAREST",n.mesh.materials[0].texture.minFilter="NEAREST"),r=n.width*n.unitScale,o=n.height*n.unitScale,n.mesh.materials[0].vertices[3]=r,n.mesh.materials[0].vertices[6]=r,n.mesh.materials[0].vertices[15]=r,n.mesh.materials[0].vertices[7]=o,n.mesh.materials[0].vertices[10]=o,n.mesh.materials[0].vertices[16]=o,n.centered&&(n.mesh.materials[0].vertices[0]-=r/2,n.mesh.materials[0].vertices[3]-=r/2,n.mesh.materials[0].vertices[6]-=r/2,n.mesh.materials[0].vertices[9]-=r/2,n.mesh.materials[0].vertices[12]-=r/2,n.mesh.materials[0].vertices[15]-=r/2,n.mesh.materials[0].vertices[1]-=o/2,n.mesh.materials[0].vertices[4]-=o/2,n.mesh.materials[0].vertices[7]-=o/2,n.mesh.materials[0].vertices[10]-=o/2,n.mesh.materials[0].vertices[13]-=o/2,n.mesh.materials[0].vertices[16]-=o/2)}),n}return i(t,e),n(t,[{key:"update",value:function(){}},{key:"render",value:function(e,t,r){this.mesh.render(e,t,r)}},{key:"renderPick",value:function(e,t,r,a){this.mesh.renderPick(e,t,r,a)}},{key:"play",value:function(){this.mesh.materials[0].texture.video.play()}}]),t}(Pe),Zt=0,Qt=E(),qt=function(){function e(t){var r=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=o.listenForMouseEvents;if(a(this,e),this._currentTexture=[],this.id=Zt++,this.mouseEventViewport=null,this.mouseEventRadius=1,this.mouseEventRenderPick=!0,this.mouseEventHover=!1,this.materialClick=new ar,this.camera=null,this.contextElement=t,this._clearColor=new qe(0,0,0,1),this.clearOnRender=!0,this.programs=[],this.program=null,this.enabledExtensions={},this.frameBufferTextures=[],this._prerenderCalls=[],this.projectionMatrix=E(),this.orthoWidth=1*t.getAttribute("ortho-width")||0,this.orthoHeight=1*t.getAttribute("ortho-height")||0,this.parallax="true"==t.getAttribute("parallax"),!window.WebGLRenderingContext)throw new Error("[Onyx] WebGL is not supported by this browser.");var i={alpha:!0,antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!1,powerPreference:"default",premultipliedAlpha:!0,preserveDrawingBuffer:!0,stencil:!0};"false"==t.getAttribute("alpha")&&(i.alpha=!1),"false"==t.getAttribute("antialias")&&(i.antialias=!1),"false"==t.getAttribute("depth")&&(i.depth=!1),"true"==t.getAttribute("fail-if-major-performance-caveat")&&(i.failIfMajorPerformanceCaveat=!0),t.getAttribute("power-preference")&&(i.powerPreference=t.getAttribute("powerPreference")),"false"==t.getAttribute("premultiplied-alpha")&&(i.premultipliedAlpha=!1),"false"==t.getAttribute("preserve-drawing-buffer")&&(i.preserveDrawingBuffer=!1),"false"==t.getAttribute("stencil")&&(i.stencil=!1);try{this.webgl=t.getContext("webgl",i)||t.getContext("experimental-webgl",i),this.webgl.id=this.id}catch(t){throw new Error("[Onyx] Couldn't initialize WebGL")}if(!this.webgl){throw new Error("[Onyx] WebGL appears to be disabled")}this.webgl.viewport(0,0,t.width,t.height),this.webgl.clearColor(this._clearColor.color[0],this._clearColor.color[1],this._clearColor.color[2],this._clearColor.color[3]),this.webgl.blendFuncSeparate(this.webgl.SRC_ALPHA,this.webgl.ONE_MINUS_SRC_ALPHA,this.webgl.ZERO,this.webgl.ONE),this.projectionMatrix=E(),xe.AVAILABLE_EXTENSIONS.length||(xe.AVAILABLE_EXTENSIONS=this.webgl.getSupportedExtensions()),this.enableExtension("OES_standard_derivatives"),this.clear(),window.addEventListener("resize",function(){r.evaluate()}),void 0!==n&&n&&this.listenForMouseEvents(),this.evaluate()}return n(e,[{key:"clearColor",get:function(){return this._clearColor},set:function(e){return this._clearColor=e,this.webgl.clearColor(this._clearColor.color[0],this._clearColor.color[1],this._clearColor.color[2],this._clearColor.color[3]),this._clearColor}},{key:"width",get:function(){return this.contextElement.clientWidth*this.getDevicePixelRatio(this.webgl)}},{key:"height",get:function(){return this.contextElement.clientHeight*this.getDevicePixelRatio(this.webgl)}}]),n(e,[{key:"clear",value:function(){this.webgl.clearColor(this._clearColor.color[0],this._clearColor.color[1],this._clearColor.color[2],this._clearColor.color[3]),this.webgl.clear(this.webgl.COLOR_BUFFER_BIT|this.webgl.DEPTH_BUFFER_BIT)}},{key:"enableExtension",value:function(e){this.enabledExtensions[e]||(this.enabledExtensions[e]=this.webgl.getExtension(e)),this.enabledExtensions[e]||console.warn("Extension \"".concat(e,"\" not available."))}},{key:"evaluate",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(e){var t=this.getDevicePixelRatio(this.webgl);navigator.isCocoonJS?(this.contextElement.width=window.innerWidth*t,this.contextElement.height=window.innerHeight*t):this.contextElement.clientWidth&&this.contextElement.clientHeight&&(this.contextElement.width=this.contextElement.clientWidth*t,this.contextElement.height=this.contextElement.clientHeight*t)}else this.contextElement.clientWidth&&this.contextElement.clientHeight&&(this.contextElement.width!==this.contextElement.clientWidth*devicePixelRatio&&(this.contextElement.width=this.contextElement.clientWidth*devicePixelRatio),this.contextElement.height!==this.contextElement.clientHeight*devicePixelRatio&&(this.contextElement.height=this.contextElement.clientHeight*devicePixelRatio));if(this.webgl.viewport(0,0,this.webgl.drawingBufferWidth,this.webgl.drawingBufferHeight),!!this.camera)if("orthographic"==this.camera._projectionType.toLowerCase()){var r=this.orthoWidth,a=this.orthoHeight;if(!r&&!a)r=this.contextElement.clientWidth,a=this.contextElement.clientHeight;else{var o=this.webgl.drawingBufferWidth/this.webgl.drawingBufferHeight;r?!a&&(a=r/o):r=a*o}D(this.projectionMatrix,0,r,0,a,this.camera._nearPlane,this.camera._farPlane)}else P(this.projectionMatrix,this.camera.fov,this.webgl.drawingBufferWidth/this.webgl.drawingBufferHeight,this.camera._nearPlane,this.camera._farPlane)}},{key:"getDevicePixelRatio",value:function(){return xe.AUTO_DETECT_DEVICE_PIXEL_RATIO&&"devicePixelRatio"in window?1<window.devicePixelRatio?window.devicePixelRatio:1:1}},{key:"render",value:function(e,t,r,a,o,n){if(this.camera){for(;this._prerenderCalls.length;)this._prerenderCalls[0](),this._prerenderCalls.splice(0,1);Se(Qt,a,this.projectionMatrix),this.camera.render(e,t,this,r,Qt,o,n)}}},{key:"renderPick",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length?arguments[1]:void 0,r=2<arguments.length?arguments[2]:void 0,a=3<arguments.length?arguments[3]:void 0,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:this.materialClick,n=5<arguments.length?arguments[5]:void 0,s=6<arguments.length?arguments[6]:void 0,l=7<arguments.length?arguments[7]:void 0,d=8<arguments.length?arguments[8]:void 0,c=9<arguments.length&&void 0!==arguments[9]?arguments[9]:1,u=10<arguments.length?arguments[10]:void 0;if(this.camera){if(this.mouseEventViewport.camera=this.camera,this.mouseEventViewport.contextElement.width=this.contextElement.width,this.mouseEventViewport.contextElement.height=this.contextElement.height,this.mouseEventViewport.orthoHeight=this.orthoHeight,this.mouseEventViewport.orthoWidth=this.orthoWidth,this.mouseEventViewport.evaluate(!0),this.mouseEventViewport.canvas2d.width=this.mouseEventViewport.contextElement.width,this.mouseEventViewport.canvas2d.height=this.mouseEventViewport.contextElement.height,this.mouseEventViewport.webgl.clear(this.webgl.COLOR_BUFFER_BIT|this.webgl.DEPTH_BUFFER_BIT),Se(Qt,a,this.projectionMatrix),this.camera.render(e,t,this.mouseEventViewport,r,Qt,o,n),void 0===d.offsetX){this.contextElement.getBoundingClientRect();d.offsetX=s,d.offsetY=l}c=ne(0|c,1);var p=this.getDevicePixelRatio(this.webgl);s*=p,l*=p,s-=c/2,l-=c/2,l=this.contextElement.height-l;var m=new Uint8Array(4*(c*c));this.mouseEventViewport.webgl.readPixels(0|s,0|l,c,c,this.webgl.RGBA,this.webgl.UNSIGNED_BYTE,m);for(var f=[],g=0;g<m.length;g+=4){var y=m[g]+255*m[g+1]-1,h=this.camera.parentScene.findByIndex(y);h&&(!f[y]&&(f[y]=0),f[y]++)}var v=0,x=0;for(var _ in f)f[_]>v&&(v=f[_],x=1*_);var b=t.findByIndex(x);b||(b=t),"mousedown"===d.type||"touchstart"===d.type?b.onMouseDown(d):"mouseup"===d.type||"touchend"===d.type?b.onMouseUp(d):"mousemove"===d.type?b.onMouseOver(d):"mousedrop"===d.type&&b.onMouseDrop(d),u&&u()}}},{key:"createProgram",value:function(e){var t=!0,r=!1,a=void 0;try{for(var o=this.programs[Symbol.iterator](),n,i;!(t=(n=o.next()).done);t=!0)if(i=n.value,i.vertexShader==e.vertexShader&&i.fragmentShader==e.fragmentShader)return i}catch(e){r=!0,a=e}finally{try{t||null==o["return"]||o["return"]()}finally{if(r)throw a}}this.programs.push(new et(this));var s=this.programs[this.programs.length-1];if(s.addVertexShader(this,e.vertexShader),s.addFragmentShader(this,e.fragmentShader),this.webgl.linkProgram(s.program),!this.webgl.getProgramParameter(s.program,this.webgl.LINK_STATUS))throw"Unable to initialize the shader program. "+this.webgl.getProgramInfoLog(s.program);return s.getAttributesFromShaders(this,e.shaderAttributes),s.getUniformLocations(this,e.shaderUniforms),s}},{key:"useProgram",value:function(e){this.program===e||(this.program=e,this.program.use(this))}},{key:"bindToCamera",value:function(e){this.camera=e,e.addViewport(this),this.evaluate()}},{key:"listenForMouseEvents",value:function(){var t=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=r.scene,o=void 0===a?null:a,n=r.mouseRadius,i=void 0===n?1:n,s=r.renderPick,l=r.mouseEventHover;if(o){var d=document.createElement("canvas");this.mouseEventViewport=new e(d),this.mouseEventRadius=i,this.mouseEventRenderPick=void 0===s||s,this.mouseEventHover=void 0!==l&&l;var c=0,u=0,p=1;try{this.mouseEventViewport.canvas2d=document.createElement("canvas"),this.mouseEventViewport.context2d=this.mouseEventViewport.canvas2d.getContext("2d"),this.canvas2d=document.createElement("canvas"),this.context2d=this.canvas2d.getContext("2d")}catch(t){console.error("Couldn't initialize 2D")}this.contextElement.addEventListener("mousedown",function(e){t._prerenderCalls.push(function(){var r=t.contextElement.getBoundingClientRect();c=oe(e.clientX-r.left),u=oe(e.clientY-r.top),p=t.mouseEventRadius,t.mouseEventRenderPick&&t.renderPick(0,o,[o],o.transform.localMatrix,void 0,void 0,c,u,e,p)})}),this.contextElement.addEventListener("touchstart",function(e){t._prerenderCalls.push(function(){var r=t.contextElement.getBoundingClientRect();c=oe(e.targetTouches[0].pageX-r.left),u=oe(e.targetTouches[0].pageY-r.top),p=e.targetTouches[0].radiusX,t.mouseEventRenderPick&&t.renderPick(0,o,[o],o.transform.localMatrix,void 0,void 0,c,u,e,p)})}),this.contextElement.addEventListener("mousemove",function(e){var r=t.contextElement.getBoundingClientRect();c=oe(e.clientX-r.left),u=oe(e.clientY-r.top),t.mouseEventHover&&t._prerenderCalls.push(function(){t.renderPick(0,o,[o],o.transform.localMatrix,void 0,void 0,c,u,e,p)})}),this.contextElement.addEventListener("touchmove",function(e){var r=t.contextElement.getBoundingClientRect();c=oe(e.targetTouches[0].pageX-r.left),u=oe(e.targetTouches[0].pageY-r.top),t.mouseEventHover&&t._prerenderCalls.push(function(){t.renderPick(0,o,[o],o.transform.localMatrix,void 0,void 0,c,u,e,p)})}),this.contextElement.addEventListener("mouseup",function(e){t.mouseEventRenderPick&&t._prerenderCalls.push(function(){t.renderPick(0,o,[o],o.transform.localMatrix,void 0,void 0,c,u,e,p)})}),this.contextElement.addEventListener("touchend",function(e){t.mouseEventRenderPick&&t._prerenderCalls.push(function(){t.renderPick(0,o,[o],o.transform.localMatrix,void 0,void 0,c,u,e,p)})})}}},{key:"addFrameBufferTexture",value:function(e){this.frameBufferTextures.push(e)}},{key:"removeFrameBufferTexture",value:function(e){-1<this.frameBufferTextures.indexOf(e)&&this.frameBufferTextures.splice(this.frameBufferTextures.indexOf(e),1)}}]),e}(),Jt=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.renderPasses,o=e.shader,n=void 0===o?null:o,i;return a(this,t),i=c(this,s(t).apply(this,arguments)),i.frameBufferTextures=[],i.shader=n,i}return i(t,e),n(t,[{key:"render",value:function(e,t,r,a,o){var n=5<arguments.length&&void 0!==arguments[5]?arguments[5]:[];this.viewportClear&&r.clear(),this.shader&&this.shader.render(e,t,r,t.cameras[0],a,o,n);var i=!0,s=!1,l=void 0;try{for(var d=this.renderPasses[Symbol.iterator](),c,u;!(i=(c=d.next()).done);i=!0)u=c.value,u.render(e,t,r,a,o,n)}catch(e){s=!0,l=e}finally{try{i||null==d["return"]||d["return"]()}finally{if(s)throw l}}}}]),t}(St),$t=E(),er=E(),tr=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.renderPasses,o=e.width,n=void 0===o?1024:o,i=e.height,l=void 0===i?1024:i,d;return a(this,t),d=c(this,s(t).apply(this,arguments)),d.width=n,d.height=l,d.frameBufferTextures=[],d.material=new or,d.materialSkinned=new ir,d}return i(t,e),n(t,[{key:"render",value:function(e,t,r,a,o){var n=5<arguments.length&&void 0!==arguments[5]?arguments[5]:[];if(!xe.DIRECTIONAL_SHADOWS_ENABLED&&!xe.POINT_SHADOWS_ENABLED){var i=!0,s=!1,l=void 0;try{for(var d=this.renderPasses[Symbol.iterator](),c,u;!(i=(c=d.next()).done);i=!0)u=c.value,u.render(e,t,r,a,o,n)}catch(e){s=!0,l=e}finally{try{i||null==d["return"]||d["return"]()}finally{if(s)throw l}}}else{var p=0;if(xe.DIRECTIONAL_SHADOWS_ENABLED){this.frameBufferTextures[p]||(this.frameBufferTextures[p]=new $e({height:this.width,width:this.height,magFilter:"NEAREST",minFilter:"NEAREST",textureType:"TEXTURE_2D",flipY:!0,wrap:{s:"CLAMP_TO_EDGE",t:"CLAMP_TO_EDGE"}})),this.frameBufferTextures[p].bind(r,0,r.webgl.TEXTURE_2D),r.clear(),r.webgl.clearColor(0,0,0,0),r.webgl.clearDepth(1),r.webgl.clear(r.webgl.COLOR_BUFFER_BIT|r.webgl.DEPTH_BUFFER_BIT);var m=!0,f=!1,g=void 0;try{for(var y=t.entities[Symbol.iterator](),h,v;!(m=(h=y.next()).done);m=!0)v=h.value,!1==v instanceof ze&&v.visible&&(v.components[0]&&v.components[0].meshes&&v.components[0].meshes[0].material.skeletal?v.render(e,t,r,t.directionalLight,a,er,null,this.materialSkinned):v.render(e,t,r,t.directionalLight,a,er,null,this.material))}catch(e){f=!0,g=e}finally{try{m||null==y["return"]||y["return"]()}finally{if(f)throw g}}this.frameBufferTextures[p].unbind(r),p++}n.push(this.frameBufferTextures);var x=!0,_=!1,b=void 0;try{for(var S=this.renderPasses[Symbol.iterator](),E,A;!(x=(E=S.next()).done);x=!0)A=E.value,A.render(e,t,r,a,o,n)}catch(e){_=!0,b=e}finally{try{x||null==S["return"]||S["return"]()}finally{if(_)throw b}}n.pop()}}}]),t}(St),rr=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.vertexShader="\n    attribute vec3 aVertexPosition;\n\n    uniform mat4 uMVCPMatrix;\n\n    void main(void) {\n        gl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n    }\n",e.fragmentShader="\n\tprecision mediump float;\n\n    void main(void) {\n        gl_FragColor = vec4(1.0);\n    }\n",e}return i(t,e),t}(gt),ar=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.vertexShader="\n    #define TEXTURES_ENABLED\n\n    attribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uMVCPMatrix; // Model View Camera Projection Matrix\n    \n    varying float vDepth;\n\tvarying vec2 vTextureCoord;\n\n    void main(void) {\n        gl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n\n        // Set texture coordinate\n        #ifdef TEXTURES_ENABLED\n            vTextureCoord = aTextureCoord;\n\t\t#endif\n    }\n",e.fragmentShader="\n    #extension GL_OES_standard_derivatives: enable\n\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n        precision highp float;\n    #else\n        precision mediump float;\n    #endif\n\n    #define TEXTURES_ENABLED\n\n    uniform sampler2D uDiffuseTexture;\n    uniform float uEntityIndex;\n    \n\tvarying vec2 vTextureCoord;\n\n    vec2 packDepthVec2(const in float depth) {\n        const vec2 bitShift = vec2(255.0, 1.0);\n        const vec2 bitMask = vec2(0.0, 1.0 / 255.0);\n      \n        vec2 res = fract(depth * bitShift);\n        res -= res.xy * bitMask;\n      \n        return res;\n    }\n\n    vec3 packDepthVec3(const in float depth) {\n        const vec3 bitShift = vec3(255.0 * 255.0, 255.0, 1.0);\n        const vec3 bitMask = vec3(0.0, 1.0 / 255.0, 1.0 / 255.0);\n      \n        vec3 res = fract(depth * bitShift);\n        res -= res.xyz * bitMask;\n      \n        return res;\n    }\n\n    void main(void) {\n        // Packs normalized fragment's Z-Coordinate which is in [0,1] interval.\n        gl_FragColor = vec4(mod(uEntityIndex, 255.0) / 255.0, floor(uEntityIndex / 255.0) / 255.0, 1.0, 1.0);\n        // gl_FragColor = vec4(packDepthVec3(uEntityIndex), 1.0);\n\n        #ifdef TEXTURES_ENABLED\n            gl_FragColor.a = ceil(texture2D(uDiffuseTexture, vTextureCoord).a);\n        #endif\n        \n        if(gl_FragColor.a == 0.0) discard;\n    }\n",e.blend=!0,e.depthTest=!0,e.cullFace=!1,e}return i(t,e),n(t,[{key:"render",value:function(e,r,a,o,n,i,l,d){var c=n[n.length-3];if(!c.pointerEvents)return!1;var u=c.index;if(!(0>u)){p(s(t.prototype),"render",this).call(this,e,r,a,o,n,i,l,d);var m=n[n.length-1].material;m.diffuseTexture&&!1===m.diffuseTexture.setAsTexture(a,0,a.program.uniform.uDiffuseTexture)||(a.webgl.uniform1f(a.program.uniform.uEntityIndex,u+1),a.webgl.blendFunc(a.webgl.SRC_ALPHA,a.webgl.ONE_MINUS_SRC_ALPHA),a.webgl.enable(a.webgl.BLEND))}}}]),t}(gt),or=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.vertexShader="\n    attribute vec3 aVertexPosition;\n\n    uniform mat4 uLMVMatrix;\n    \n    varying float vDepth;\n\n    void main(void) {\n        gl_Position = uLMVMatrix * vec4(aVertexPosition, 1.0);\n\n        float zBuf = gl_Position.z / gl_Position.w;  // between -1 and 1\n        vDepth = 0.5 + (zBuf * 0.5);           // between 0 and 1\n    }\n",e.fragmentShader="\n    #extension GL_OES_standard_derivatives: enable\n\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n        precision highp float;\n    #else\n        precision mediump float;\n    #endif\n\n    #ifdef GL_OES_standard_derivatives\n        #define USE_SVM\n    #endif\n\n    varying float vDepth;\n\n    vec2 packDepthVec2(const in float depth) {\n        const vec2 bitShift = vec2(255.0, 1.0);\n        const vec2 bitMask = vec2(0.0, 1.0 / 255.0);\n      \n        vec2 res = fract(depth * bitShift);\n        res -= res.xy * bitMask;\n      \n        return res;\n    }\n\n    vec3 packDepthVec3(const in float depth) {\n        const vec3 bitShift = vec3(255.0 * 255.0, 255.0, 1.0);\n        const vec3 bitMask = vec3(0.0, 1.0 / 255.0, 1.0 / 255.0);\n      \n        vec3 res = fract(depth * bitShift);\n        res -= res.xyz * bitMask;\n      \n        return res;\n    }\n\n    vec4 packDepthVec4(const in float depth) {\n        const vec4 bitShift = vec4(255.0 * 255.0 * 255.0, 255.0 * 255.0, 255.0, 1.0);\n        const vec4 bitMask = vec4(0.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);\n      \n        vec4 res = fract(depth * bitShift);\n        res -= res.xxyz * bitMask;\n      \n        return res;\n    }\n\n    void main(void) {\n        #ifdef USE_SVM\n            float depth2 = pow(vDepth, 2.0);\n\n            // approximate the spatial average of vDepth^2\n            float dx = dFdx(vDepth);\n            float dy = dFdy(vDepth);\n            float depth2Avg = depth2 + 0.25 * (dx*dx + dy*dy);\n\n            // depth saved in red and green channels while average depth^2 is\n            // stored in the blue and alpha channels\n            gl_FragColor = vec4(packDepthVec3(vDepth), depth2Avg);\n        #else\n            // Packs normalized fragment's Z-Coordinate which is in [0,1] interval.\n            \n            gl_FragColor = packDepthVec4(gl_FragCoord.z);\n        #endif\n    }\n",xe.SHADOWS_VSM_ENABLED||(e.fragmentShader=e.fragmentShader.replace("#define USE_SVM","")),e.blend=!1,e.cullFaceMode="FRONT",e}return i(t,e),n(t,[{key:"render",value:function(e,r,a,o,n,i,l){var d=n[n.length-1];return!!(d&&d.material.shadowCastingMode)&&void(p(s(t.prototype),"render",this).call(this,e,r,a,o,n),a.webgl.disable(a.webgl.CULL_FACE),a.webgl.uniformMatrix4fv(a.program.uniform.uLMVMatrix,!1,o.getMVPMatrix(l,a,i)))}}]),t}(gt),nr="\n    #define MAX_BONES ".concat(xe.MAX_BONES,"\n    \n    attribute vec3 aVertexPosition;\n\tattribute vec4 aVertexWeights;\n\tattribute vec4 aVertexWeightIndices;\n\n    uniform mat4 uLMVMatrix;\n\n    uniform mat4 uDeformMatrix[MAX_BONES]; // Bone matrices\n    \n    varying float vDepth;\n\n    mat4 boneTransformMat4() {\n\t\tmat4 ret;\n\n\t\t// Weight normalization factor\n\t\tfloat normfac = 1.0 / (aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3]);\n\n\t\t// Weight1 * Bone1 + Weight2 * Bone2\n\t\tret = normfac * aVertexWeights[0] * uDeformMatrix[int(floor(aVertexWeightIndices[0] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[1] * uDeformMatrix[int(floor(aVertexWeightIndices[1] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[2] * uDeformMatrix[int(floor(aVertexWeightIndices[2] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[3] * uDeformMatrix[int(floor(aVertexWeightIndices[3] + 0.5))];\n\n\t\treturn ret;\n\t}\n\n    void main(void) {\n\t\t// Set the position\n        if(aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3] > 0.0){\n            mat4 bt = boneTransformMat4();\n\n            gl_Position = uLMVMatrix * bt * vec4(aVertexPosition, 1.0);\n        }else{\n            gl_Position = uLMVMatrix * vec4(aVertexPosition, 1.0);\n        }\n\n        float zBuf = gl_Position.z / gl_Position.w;  // between -1 and 1\n        vDepth = 0.5 + (zBuf * 0.5);           // between 0 and 1\n    }\n"),ir=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.vertexShader=nr,e}return i(t,e),t}(or),sr=[-1,-1,0,1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,1,0],lr=[0,0,1,0,1,1,0,1,0,0,1,1],dr=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.vertexShader="\n    attribute vec3 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    varying vec2 vTextureCoord;\n\n    void main(void) {\n        vTextureCoord = aTextureCoord;\n\n        gl_Position = vec4(aVertexPosition, 1.0);\n    }\n",e.fragmentShader="\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n        precision highp float;\n    #else\n        precision mediump float;\n    #endif\n\n    varying vec2 vTextureCoord;\n\n    uniform sampler2D uTexture;\n\n    void main(void) {\n        gl_FragColor = texture2D(uTexture, vTextureCoord);\n    }\n",e.vertices=new Float32Array(sr),e.uvs=new Float32Array(lr),e.buffers={vertices:[],uvs:[],normals:[],weights:[],weightIndices:[]},e.valid={vertices:[],uvs:[],normals:[],weights:[],weightIndices:[]},e}return i(t,e),n(t,[{key:"render",value:function(e,r,a,o,n,i){this.vertices.length&&(p(s(t.prototype),"render",this).apply(this,arguments),void 0!==a.program.attribute.aVertexPosition&&((!this.buffers.vertices[a.id]||!this.valid.vertices[a.id])&&(this.buffers.vertices[a.id]=a.webgl.createBuffer(),a.webgl.bindBuffer(a.webgl.ARRAY_BUFFER,this.buffers.vertices[a.id]),a.webgl.bufferData(a.webgl.ARRAY_BUFFER,this.vertices,a.webgl.STATIC_DRAW),this.valid.vertices[a.id]=!0),a.webgl.bindBuffer(a.webgl.ARRAY_BUFFER,this.buffers.vertices[a.id]),a.webgl.vertexAttribPointer(a.program.attribute.aVertexPosition,3,a.webgl.FLOAT,!1,0,0),a.webgl.enableVertexAttribArray(a.program.attribute.aVertexPosition)),void 0!==a.program.attribute.aTextureCoord&&((!this.buffers.uvs[a.id]||!this.valid.uvs[a.id])&&(this.buffers.uvs[a.id]=a.webgl.createBuffer(),a.webgl.bindBuffer(a.webgl.ARRAY_BUFFER,this.buffers.uvs[a.id]),a.webgl.bufferData(a.webgl.ARRAY_BUFFER,this.uvs,a.webgl.STATIC_DRAW),this.valid.uvs[a.id]=!0),a.webgl.bindBuffer(a.webgl.ARRAY_BUFFER,this.buffers.uvs[a.id]),a.webgl.vertexAttribPointer(a.program.attribute.aTextureCoord,2,a.webgl.FLOAT,!1,0,0),a.webgl.enableVertexAttribArray(a.program.attribute.aTextureCoord)),!1===i[i.length-1].setAsTexture(a,0,a.program.uniform.uTexture)||a.webgl.drawArrays(a.webgl.TRIANGLES,0,this.vertices.length/3))}}]),t}(gt),cr=new Float32Array(3*xe.MAX_LIGHTS),ur=new Float32Array(16*xe.MAX_LIGHTS),pr=new Float32Array(3*xe.MAX_LIGHTS),mr=Array(xe.MAX_LIGHTS),fr=Array(xe.MAX_LIGHTS),gr="\n\tprecision highp float;\n\n\t#define MAX_BONES ".concat(xe.MAX_BONES,"\n\t#define MAX_LIGHTS ").concat(xe.MAX_LIGHTS,"\n\n\t#define SKELETAL_ENABLED\n\t#define TEXTURES_ENABLED\n\t#if MAX_LIGHTS > 0\n\t#define SHADOWS_ENABLED\n\t#endif\n\n\tattribute vec4 aVertexPosition;\n\tattribute vec3 aVertexNormal;\n\tattribute vec2 aTextureCoord;\n\tattribute vec4 aVertexWeights;\n\tattribute vec4 aVertexWeightIndices;\n\n\tuniform mat4 uMVCPMatrix; // Model View Camera Projection Matrix\n\tuniform mat4 uMMatrix; // World Matrix\n\tuniform mat4 uViewMatrix; // View Matrix\n\tuniform mat4 uNormalMatrix;\n\n\tuniform mat4 uDeformMatrix[MAX_BONES]; // Bone matrices\n\n\tuniform mat4 uDirectionalLightMVPMatrix; // Light MVP Matrix\n\tvarying vec4 vDirectionalShadowPos;\n\n\t#if MAX_LIGHTS > 0\n\tuniform mat4 uLightMVPMatrix[MAX_LIGHTS]; // Light MVP Matrix\n\tvarying vec4 vShadowPos[MAX_LIGHTS];\n\t#endif\n\n\tvarying vec3 vPositionCoord;\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tconst mat4 texUnitConverter = mat4(0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, 0.5, 0.5, 0.5, 1.0);\n\t\n\tmat4 boneTransformMat4() {\n\t\tmat4 ret;\n\n\t\t// Weight normalization factor\n\t\tfloat normfac = 1.0 / (aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3]);\n\n\t\t// Weight1 * Bone1 + Weight2 * Bone2\n\t\tret = normfac * aVertexWeights[0] * uDeformMatrix[int(floor(aVertexWeightIndices[0] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[1] * uDeformMatrix[int(floor(aVertexWeightIndices[1] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[2] * uDeformMatrix[int(floor(aVertexWeightIndices[2] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[3] * uDeformMatrix[int(floor(aVertexWeightIndices[3] + 0.5))];\n\n\t\treturn ret;\n\t}\n\n\tvoid main() {\n\t\t// Set the position\n\t\t#ifdef SKELETAL_ENABLED\n\t\t\tif(aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3] > 0.0){\n\t\t\t\tmat4 bt = boneTransformMat4();\n\t\t\t\tvNormal = normalize((bt * vec4(aVertexNormal, 0.0)).xyz);\n\n\t\t\t\tgl_Position = uMVCPMatrix * bt * aVertexPosition;\n\t\t\t}else{\n\t\t\t\tvNormal = normalize(mat3(uNormalMatrix) * aVertexNormal);\n\n\t\t\t\tgl_Position = uMVCPMatrix * aVertexPosition;\n\t\t\t}\n\t\t#else\n\t\t\tvNormal = normalize(mat3(uNormalMatrix) * aVertexNormal);\n\n\t\t\tgl_Position = uMVCPMatrix * aVertexPosition;\n\t\t#endif\n\n\t\tvPositionCoord = vec3(uMMatrix * aVertexPosition);\n\t\t\n        // Set texture coordinate\n        #ifdef TEXTURES_ENABLED\n            vTextureCoord = aTextureCoord;\n\t\t#endif\n\n\t\t#ifdef SHADOWS_ENABLED\n\t\t\tvDirectionalShadowPos = texUnitConverter * uDirectionalLightMVPMatrix * aVertexPosition;\n\n\t\t\tfor(int i=0; i < ").concat(xe.MAX_LIGHTS,"; ++i){\n\t\t\t\tvShadowPos[i] = uLightMVPMatrix[i] * aVertexPosition;\n\t\t\t\t// vShadowPos[i] = aVertexPosition.xyz - uLightPosition[i];\n\t\t\t}\n\t\t#endif\n\t}\n"),yr="\n\t#extension GL_OES_standard_derivatives: enable\n\n\t#ifdef GL_FRAGMENT_PRECISION_HIGH\n\t\tprecision highp float;\n\t\t// precision highp int;\n\t#else\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\t#endif\n\n\t#define MAX_LIGHTS ".concat(xe.MAX_LIGHTS,"\n\n    #ifdef GL_OES_standard_derivatives\n        #define USE_SVM\n    #endif\n\n\t#if MAX_LIGHTS > 0\n\t#define POINT_LIGHTING_ENABLED\n\t#define DIRECTIONAL_SHADOWS_ENABLED\n\t#define POINT_SHADOWS_ENABLED\n\t#endif\n\t#define DIRECTIONAL_LIGHTING_ENABLED\n\t#define SHADOW_BIAS 0.0007\n\t#define FOG_ENABLED\n\t#define TEXTURE_DIFFUSE_ENABLED\n\t#define TEXTURE_SPECULAR_COLOR_ENABLED\n\t#define TEXTURE_AMBIENT_ENABLED\n\t#define TEXTURE_AMBIENT_BLEND_MODE 1 // 0: Additive | 1: Multiply | 2: Screen\n\t#define TEXTURE_AMBIENT_COORDINATES 0 // 0: Use UVs | 1: Use World Coordinates XY | 2: Use World Coordinates XZ\n\t#define TEXTURE_AMBIENT_SIZE 1024.00\n\t#define TEXTURE_AMBIENT_SCALE 1.0\n\t#define TEXTURE_AMBIENT_FLIPY\n\t#define TEXTURE_EMIT_ENABLED\n\n\tvarying vec3 vPositionCoord;\n\tvarying vec2 vTextureCoord;\n\tvarying vec3 vNormal;\n\n\tvarying vec4 vDirectionalShadowPos;\n\t#if MAX_LIGHTS > 0\n\tvarying vec4 vShadowPos[MAX_LIGHTS];\n\t#endif\n\n\tuniform vec3 uCameraPosition;\n\n\tuniform vec3 uSceneAmbientLightColor;\n\n\tuniform vec3 uDirectionalLightColor;\n\tuniform vec3 uDirectionalLightVector;\n\tuniform float uDirectionalLightIntensity;\n\t\n\tuniform sampler2D uDiffuseTexture;\n\tuniform sampler2D uSpecularColorTexture;\n\tuniform sampler2D uSpecularHighlightTexture;\n\tuniform sampler2D uAmbientTexture; // TODO: Should be global illumination texture\n\tuniform sampler2D uEmitTexture;\n\n\tuniform vec4 uFogColor;\n\tuniform float uFogDensity;\n\tuniform float uFogDistance;\n\n\t#if MAX_LIGHTS > 0\n\tuniform vec3 uLightPosition[MAX_LIGHTS]; // Light positions\n\tuniform vec3 uLightColor[MAX_LIGHTS];\n\tuniform float uLightIntensity[MAX_LIGHTS];\n\tuniform float uLightMaxDistance[MAX_LIGHTS];\n\tuniform samplerCube uPointLightDepth[MAX_LIGHTS];\n\t#endif\n\tuniform sampler2D uDirectionalLightDepth;\n\tuniform float uDirectionalLightDepthSize;\n\n\tuniform vec3 uMaterialDiffuseColor;\n\tuniform vec3 uMaterialSpecularColor;\n\tuniform vec3 uMaterialAmbientColor;\n\tuniform vec3 uMaterialEmitColor;\n\tuniform vec3 uMaterialTransmissionFilter;\n\tuniform float uMaterialDissolve;\n\tuniform float uMaterialSpecularExponent;\n\tuniform float uMaterialEmitExponent;\n\n\tuniform float uShadowBias;\n\n\tfloat unpackDepthVec2(in vec2 color) {\n\t\tconst vec2 bitShift = vec2(1.0 / 255.0, 1.0);\n\t\treturn dot(color, bitShift);\n\t}\n\n\tfloat unpackDepthVec3(in vec3 color) {\n\t\tconst vec3 bitShift = vec3(1.0 / (255.0 * 255.0), 1.0 / 255.0, 1.0);\n\t\treturn dot(color, bitShift);\n\t}\n\n\tfloat unpackDepthVec4(in vec4 color) {\n\t\tconst vec4 bitShift = vec4(1.0 / (255.0 * 255.0 * 255.0), 1.0 / (255.0 * 255.0), 1.0 / 255.0, 1.0);\n\t\treturn dot(color, bitShift);\n\t}\n\n\tvec4 shadow_filter(vec2 uv_shadowMap, in sampler2D depthColorTexture){\n        // if (!use_filter) {\n        \t// return texture2D(depthColorTexture, uv_shadowMap);\n\t\t// }\n\t\t\n        vec4 result = vec4(0.0);\n\t\t\n\t\tfor (int x = -1; x <= 1; x++) {\n        \tfor (int y = -1; y <= 1; y++) {\n        \t\tfloat x_l = (uv_shadowMap.x - float(x) / uDirectionalLightDepthSize);\n        \t\tfloat y_l = (uv_shadowMap.y - float(y) / uDirectionalLightDepthSize);\n        \t\tvec2 lookup = vec2(x_l, y_l);\n        \t\tresult += texture2D(depthColorTexture, lookup).rgba; //get(x,y);\n        \t}\n\t\t}\n\t\t\n        return result / 9.0;\n\t}\n\t\n\tfloat linstep(float low, float high, float v){\n\t\treturn clamp((v-low)/(high-low), 0.0, 1.0);\n\t}\n\n\tfloat directionalShadow(in vec4 shadowPosition, in sampler2D depthColorTexture) {\n\t\t#ifdef USE_SVM\n\t\t\tvec4 shadowMapColor = shadow_filter(shadowPosition.xy, depthColorTexture);\n\t\t\tfloat distance = shadowPosition.z;\n\t\t\tfloat mean = unpackDepthVec3(shadowMapColor.rgb);\n\n\t\t\t// Surface is fully lit\n\t\t\tif(distance < mean) return 1.0;\n\n\t\t\tfloat depth_2 = shadowMapColor.a;\n\n\t\t\t// The fragment is either in shadow or penumbra. We now use chebyshev's upperBound to check\n\t\t\t// How likely this pixel is to be lit (p_max)\n\t\t\tfloat variance = depth_2 - pow(mean, 2.00);\n\t\t\tvariance = max(variance, uShadowBias);\n\n\t\t\tfloat d = distance - mean;\n\t\t\tfloat p_max = variance / (variance + d*d);\n\t\t\tp_max = clamp(p_max, 0.0, 1.0);\n\t\t\tfloat p = smoothstep(distance - 0.02, distance, mean);\n\n\t\t\treturn p_max;\n\t\t\t\n\t\t\t// float p_max = linstep(0.2, 1.0, variance / (variance + d*d));\n\t\t\t// float p = smoothstep(distance - 0.02, distance, mean);\n\t\t\t// return (max(p, p_max) > 1.0 - uShadowBias)?1.0:0.0;\n\t\t\t// return clamp(max(p, p_max), 0.0, 1.0);\n\t\t\t// shadowCoeff = 0 = shadow\n\t\t\t// shadowCoeff = 1 = no shadow\n\t\t#else\n\t\t\tvec3 fragmentDepth = shadowPosition.xyz;\n\t\t\tfragmentDepth.z -= uShadowBias;\n\n\t\t\tfloat texelDepth = unpackDepthVec4(texture2D(depthColorTexture, fragmentDepth.xy));\n\t\t\treturn (fragmentDepth.z < texelDepth) ? 1.0 : 0.0;\n\n\t\t\t// float texelSize = 1.0 / 1024.0;\n\t\t\t// float amountInLight = 0.0;\n\n\t\t\t// for (int x = -1; x <= 1; x++) {\n\t\t\t// \tfor (int y = -1; y <= 1; y++) {\n\t\t\t// \t\tfloat texelDepth = unpackDepthVec4(texture2D(depthColorTexture, fragmentDepth.xy + vec2(x, y) * texelSize));\n\n\t\t\t// \t\tif (fragmentDepth.z < texelDepth) {\n\t\t\t// \t\t\tamountInLight += 1.0;\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// }\n\t\t\t// amountInLight /= 9.0;\n\n\t\t\t// return amountInLight;\n\t\t#endif\n\t}\n\n\tfloat omnidirectionalShadow(in vec3 direction, in samplerCube sampler) {\n\t\tdirection *= vec3(1.0, -1.0, 1.0);\n\t\tfloat vertexDepth = clamp(length(direction), 0.0, 1.0);\n\t\tfloat shadowMapDepth = unpackDepthVec4(textureCube(sampler, direction)) + SHADOW_BIAS;\n\n\t\treturn (vertexDepth > shadowMapDepth) ? 0.0 : 1.0;\n\t}\n\n\tfloat calculateFog(){\n\t\t// get the distance of the pixel\n\t\tfloat perspective_far = uFogDistance;\n\t\tfloat fog_cord = (gl_FragCoord.z / gl_FragCoord.w) / perspective_far;\n\n\t\t// density of fog\n\t\tfloat fog_density = uFogDensity;\n\n\t\t// increase fog by density\n\t\t// fog also thickens with distance\n\t\treturn fog_cord * fog_density;\n\t}\n\n\tvoid main(void) {\n\t\tvec3 N = normalize(vNormal);\n\t\tvec3 V = normalize(uCameraPosition); // we are in Eye Coordinates, so EyePos is (0,0,0) \n\n\t\t#if defined(DIRECTIONAL_LIGHTING_ENABLED) || defined(POINT_LIGHTING_ENABLED)\n\n\t\t\t// Calculate lighting\n\t\t\tvec4 Iamb = vec4(0.0);\n\t\t\tvec4 Ispec = vec4(0.0);\n\t\t\tvec4 Idiff = vec4(0.0);\n\t\t\tvec4 Iemit = vec4(0.0);\n\n\t\t\t#ifdef DIRECTIONAL_LIGHTING_ENABLED\n\t\t\t\tvec3 L = normalize(-uDirectionalLightVector); \n\t\t\t\tvec3 R = normalize(-reflect(L,N)); \n\t\t\t\n\t\t\t\t//calculate Ambient Term: \n\t\t\t\tIamb += vec4(uSceneAmbientLightColor, 0.0); \n\n\t\t\t\t#ifdef DIRECTIONAL_SHADOWS_ENABLED\n\t\t\t\t\tfloat shadow = directionalShadow(vDirectionalShadowPos, uDirectionalLightDepth);\n\t\t\t\t#else\n\t\t\t\t\tfloat shadow = 1.0;\n\t\t\t\t#endif\n\t\t\t\t\n\t\t\t\t//calculate Diffuse Term: \n\t\t\t\tIdiff += vec4(clamp(shadow * uDirectionalLightColor * max(dot(N,L), 0.0), 0.0, 1.0), 0.0);\n\t\t\t\n\t\t\t\t// calculate Specular Term:\n\t\t\t\tIspec += vec4(clamp(shadow * uDirectionalLightColor * pow(max(dot(R,V),0.0),0.3*uMaterialSpecularExponent), 0.0, 1.0), 0.0);\n\t\t\t#endif\n\t\t\t\n\t\t\t#ifdef POINT_LIGHTING_ENABLED\n\t\t\t\tfor (int i=0; i<MAX_LIGHTS; i++){\n\n\t\t\t\t\tvec3 L = normalize(uLightPosition[i] - vPositionCoord); \n\n\t\t\t\t\tif(length(L) > 0.0){\n\t\t\t\t\t\tvec3 R = normalize(-reflect(L,N)); \n\n\t\t\t\t\t\t#ifdef POINT_SHADOWS_ENABLED\n\t\t\t\t\t\t\tfloat shadow = omnidirectionalShadow(L, uPointLightDepth[i]); //lightPosition, in samplerCube sampler\n\t\t\t\t\t\t\tif(shadow <= 0.0) continue;\n\t\t\t\t\t\t#else\n\t\t\t\t\t\t\tfloat shadow = 1.0;\n\t\t\t\t\t\t#endif\n\n\t\t\t\t\t\t//calculate Ambient Term: \n\t\t\t\t\t\t// vec4 Iamb = vec4(uMaterialAmbientColor, 1.0); \n\t\t\t\t\t\t\n\t\t\t\t\t\t//calculate Diffuse Term: \n\t\t\t\t\t\tIdiff += vec4(clamp(uLightColor[i] * max(dot(N,L), 0.0), 0.0, 1.0), 0.0);\n\t\t\t\t\t\n\t\t\t\t\t\t// calculate Specular Term:\n\t\t\t\t\t\tIspec += vec4(clamp(uLightColor[i] * pow(max(dot(R,V),0.0),0.3*uMaterialSpecularExponent), 0.0, 1.0), 0.0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t#endif\n\n\t\t\t#if defined(TEXTURE_AMBIENT_ENABLED) || defined(TEXTURE_DIFFUSE_ENABLED)\n\t\t\t\t#if defined(TEXTURE_AMBIENT_ENABLED)\n\t\t\t\t\t\tIamb *= texture2D(uAmbientTexture, vTextureCoord);\n\t\t\t\t\t#endif\n\t\t\t\t#if defined(TEXTURE_DIFFUSE_ENABLED)\n\t\t\t\t\tIamb *= texture2D(uDiffuseTexture, vTextureCoord);\n\t\t\t\t#endif\n\t\t\t#else\n\t\t\t\tIamb *= vec4(uSceneAmbientLightColor * uMaterialAmbientColor, 1.0);\n\t\t\t#endif\n\n\t\t\t#ifdef TEXTURE_DIFFUSE_ENABLED\n\t\t\t\tIdiff *= texture2D(uDiffuseTexture, vTextureCoord);\n\t\t\t#else\n\t\t\t\tIdiff *= vec4(uMaterialDiffuseColor, 1.0);\n\t\t\t#endif\n\n\t\t\t#ifdef TEXTURE_SPECULAR_COLOR_ENABLED\n\t\t\t\tIspec *= texture2D(uSpecularColorTexture, vTextureCoord);\n\t\t\t#else\n\t\t\t\tIspec *= vec4(uMaterialSpecularColor, 1.0);\n\t\t\t#endif\n\n\t\t\t#ifdef TEXTURE_EMIT_ENABLED\n\t\t\t\tIemit += texture2D(uEmitTexture, vTextureCoord);\n\t\t\t#else\n\t\t\t\tIemit += vec4(uMaterialEmitColor, 1.0);\n\t\t\t#endif\n\t\t\tIemit.rgb *= uMaterialEmitExponent;\n\n\t\t\t// Final Color = Diffuse + Specular + Ambient + Emit\n\t\t\tgl_FragColor = Idiff + Ispec + Iamb + Iemit; \n\t\t  \tgl_FragColor.a *= uMaterialDissolve;\n\t\t#else\n\t\t\t#ifdef TEXTURE_DIFFUSE_ENABLED\n\t\t\t\tgl_FragColor = texture2D(uDiffuseTexture, vTextureCoord);\n\t\t\t#else\n\t\t\t\tgl_FragColor = vec4(uMaterialDiffuseColor, 1.0);\n\t\t\t#endif\n\t\t#endif\n\n\t\t// Discard if there's no pixel to show. This helps when there's empty space background\n\t\t// TODO: Is there a way to optimize this?\n\t\tif (gl_FragColor.a == 0.0) discard;\n\n\t\t#ifdef FOG_ENABLED\n\t\t\tfloat fog = calculateFog();\n\n\t\t\t// mix together the frag color with the fog color\n\t\t\tgl_FragColor = mix(uFogColor, gl_FragColor, clamp(1.0-fog,0.0,1.0));\n\t\t#endif\n\t}\n"),hr=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.ambientColor,o=void 0===r?new qe(0,0,0,1):r,n=e.diffuseColor,i=void 0===n?new qe(1,1,1,1):n,l=e.specularColor,d=void 0===l?new qe(0,0,0,1):l,u=e.specularExponent,p=void 0===u?128:u,m=e.emitColor,f=void 0===m?new qe(0,0,0,0):m,g=e.emitExponent,y=void 0===g?1:g,h=e.transmissionFilter,v=void 0===h?new qe(1,1,1,1):h,x=e.dissolve,_=void 0===x?1:x,b=e.lighting,S=void 0===b?1:b,E=e.shadowCastingMode,A=void 0===E?1:E,T=e.receiveShadows,k=e.shadowBias,B=void 0===k?xe.DEFAULT_SHADOW_BIAS:k,O=e.skeletal,w=e.ambientTextureCoordinateSpace,I=void 0===w?"UVtoXZ":w,C=e.ambientTextureFlipY,M=e.receivesFog,P=e.ambientTexture,D=void 0===P?null:P,L=e.diffuseTexture,F=void 0===L?null:L,H=e.specularColorTexture,R=void 0===H?null:H,N=e.specularHighlightTexture,U=void 0===N?null:N,G=e.emitTexture,V=void 0===G?null:G,X=e.alphaTexture,Y=void 0===X?null:X,W=e.bumpMapTexture,z=void 0===W?null:W,j=e.displacementTexture,K=void 0===j?null:j,Z=e.decalTexture,Q=void 0===Z?null:Z,q;return a(this,t),q=c(this,s(t).apply(this,arguments)),q.vertexShader=gr,q.fragmentShader=yr,q.ambientColor=o,q.diffuseColor=i,q.specularColor=d,q.emitColor=f,q.specularExponent=p,q.emitExponent=y,q.transmissionFilter=v,q.dissolve=_,q.ambientTexture=D,q.diffuseTexture=F,q.specularColorTexture=R,q.specularHighlightTexture=U,q.emitTexture=V,q.alphaTexture=Y,q.bumpMapTexture=z,q.displacementTexture=K,q.decalTexture=Q,q.shadowBias=B,q.lighting=S,q.skeletal=void 0!==O&&O,q.shadowCastingMode=A,q.receiveShadows=void 0===T||T,q.receivesFog=void 0===M||M,q.ambientTextureCoordinateSpace=I,q.ambientTextureFlipY=void 0!==C&&C,q.buildProgram(),q}return i(t,e),n(t,[{key:"render",value:function(e,r,a,o,n,i,l,d){if((p(s(t.prototype),"render",this).call(this,e,r,a,o,n,i,l,d),!(this.diffuseTexture&&!1===this.diffuseTexture.setAsTexture(a,0,a.program.uniform.uDiffuseTexture)))&&!(this.ambientTexture&&!1===this.ambientTexture.setAsTexture(a,1,a.program.uniform.uAmbientTexture))&&!(this.specularColorTexture&&!1===this.specularColorTexture.setAsTexture(a,2,a.program.uniform.uSpecularColorTexture))&&!(this.specularHighlightTexture&&!1===this.specularHighlightTexture.setAsTexture(a,3,a.program.uniform.uSpecularHighlightTexture))&&!(this.emitTexture&&!1===this.emitTexture.setAsTexture(a,4,a.program.uniform.uEmitTexture))){a.webgl.uniform4fv(a.program.uniform.uDiffuseColor,this.diffuseColor.toArray()),a.webgl.uniform3fv(a.program.uniform.uMaterialDiffuseColor,this.diffuseColor.toVec3Array()),a.webgl.uniform3fv(a.program.uniform.uMaterialSpecularColor,this.specularColor.toVec3Array()),a.webgl.uniform3fv(a.program.uniform.uMaterialAmbientColor,this.ambientColor.toVec3Array()),a.webgl.uniform3fv(a.program.uniform.uMaterialEmitColor,this.emitColor.toVec3Array()),a.webgl.uniform3fv(a.program.uniform.uMaterialTransmissionFilter,this.transmissionFilter.toVec3Array()),a.webgl.uniform1f(a.program.uniform.uMaterialSpecularExponent,this.specularExponent),a.webgl.uniform1f(a.program.uniform.uMaterialEmitExponent,this.emitExponent),a.webgl.uniform1f(a.program.uniform.uMaterialDissolve,this.dissolve);var c=0;if(a.webgl.uniform3fv(a.program.uniform.uSceneAmbientLightColor,r.ambientLightColor.toVec3Array()),a.webgl.uniform3fv(a.program.uniform.uDirectionalLightColor,r.directionalLight.diffuseColor.toVec3Array()),a.webgl.uniform3fv(a.program.uniform.uDirectionalLightVector,r.directionalLight.vector),a.webgl.uniform1f(a.program.uniform.uShadowBias,this.shadowBias),xe.DIRECTIONAL_SHADOWS_ENABLED){if(a.program.uniform.uDirectionalLightDepth&&d[d.length-1]){if(!1===d[d.length-1][c].setAsTexture(a,5+c,a.program.uniform.uDirectionalLightDepth))return;a.webgl.uniform1f(a.program.uniform.uDirectionalLightDepthSize,d[d.length-1][c].width)}a.webgl.uniformMatrix4fv(a.program.uniform.uDirectionalLightMVPMatrix,!1,r.directionalLight.getMVPMatrix(l,a)),c++}if(void 0!==a.program.uniform["uLightPosition[0]"]){cr.fill(0),ur.fill(0),pr.fill(0),mr.fill(0),fr.fill(0);for(var u=0,m;u<xe.MAX_LIGHTS;u++)if(m=r.lights[u],m&&m.enabled){for(var f=0;3>f;f++)cr[3*u+f]=m.transform.xyz[f];for(var g=m.getMVPMatrix(l,a),f=0;16>f;f++)ur[16*u+f]=g[f];for(var f=0;3>f;f++)pr[3*u+f]=m.diffuseColor.toArray()[f];mr[u]=1*m.intensity,fr[u]=1*m.maxDistance}c+=xe.MAX_LIGHTS,a.webgl.uniform3fv(a.program.uniform["uLightPosition[0]"],cr),a.webgl.uniformMatrix4fv(a.program.uniform["uLightMVPMatrix[0]"],!1,ur),a.webgl.uniform3fv(a.program.uniform["uLightColor[0]"],pr)}a.webgl.uniform4fv(a.program.uniform.uFogColor,r.fogColor.toArray()),a.webgl.uniform1f(a.program.uniform.uFogDensity,r.fogDensity),a.webgl.uniform1f(a.program.uniform.uFogDistance,a.camera._farPlane),a.webgl.blendFunc(a.webgl.SRC_ALPHA,a.webgl.ONE_MINUS_SRC_ALPHA),a.webgl.enable(a.webgl.BLEND)}}},{key:"buildProgram",value:function(){switch(this.vertexShader=gr,this.fragmentShader=yr,xe.SHADOWS_VSM_ENABLED||(this.fragmentShader=this.fragmentShader.replace("#define USE_SVM","")),this.vertexShader=this.vertexShader.replace("#define POINT_SHADOWS_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define POINT_SHADOWS_ENABLED",""),xe.LIGHTING_ENABLED||(this.vertexShader=this.vertexShader.replace("#define DIRECTIONAL_SHADOWS_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define DIRECTIONAL_SHADOWS_ENABLED",""),this.vertexShader=this.vertexShader.replace("#define POINT_SHADOWS_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define POINT_SHADOWS_ENABLED",""),this.vertexShader=this.vertexShader.replace("#define DIRECTIONAL_LIGHTING_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define DIRECTIONAL_LIGHTING_ENABLED",""),this.vertexShader=this.vertexShader.replace("#define POINT_LIGHTING_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define POINT_LIGHTING_ENABLED","")),this.lighting){case 1:break;case 0:default:this.vertexShader=this.vertexShader.replace("#define DIRECTIONAL_LIGHTING_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define DIRECTIONAL_LIGHTING_ENABLED",""),this.vertexShader=this.vertexShader.replace("#define POINT_LIGHTING_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define POINT_LIGHTING_ENABLED",""),this.vertexShader=this.vertexShader.replace("#define SHADOWS_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define SHADOWS_ENABLED","");}if(this.ambientTexture||this.diffuseTexture||this.specularColorTexture||this.specularHighlightTexture||this.alphaTexture||this.bumpMapTexture||this.displacementTexture||this.decalTexture||(this.vertexShader=this.vertexShader.replace("#define TEXTURES_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define TEXTURES_ENABLED","")),!this.ambientTexture)this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_ENABLED","");else{switch(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_SIZE 1024.00","#define TEXTURE_AMBIENT_SIZE "+this.ambientTexture.width.toFixed(2)),this.ambientTexture.scale&&(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_SCALE 1.0","#define TEXTURE_AMBIENT_SCALE "+this.ambientTexture.scale.toFixed(2))),this.ambientTextureCoordinateSpace){case"UV":this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_COORDINATES 0","#define TEXTURE_AMBIENT_COORDINATES 0");break;case"UVtoXY":this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_COORDINATES 0","#define TEXTURE_AMBIENT_COORDINATES 1");break;case"UVtoXZ":this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_COORDINATES 0","#define TEXTURE_AMBIENT_COORDINATES 2");}"WORLD"!==this.ambientTextureCoordinateSpace&&(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_COORDINATES 1","#define TEXTURE_AMBIENT_COORDINATES 0")),this.ambientTextureFlipY||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_AMBIENT_FLIPY",""))}this.diffuseTexture||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_DIFFUSE_ENABLED","")),this.specularColorTexture||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_SPECULAR_COLOR_ENABLED","")),this.specularHighlightTexture||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_SPECULAR_HIGHLIGHT_ENABLED","")),this.emitTexture||(this.fragmentShader=this.fragmentShader.replace("#define TEXTURE_EMIT_ENABLED","")),this.skeletal||(this.vertexShader=this.vertexShader.replace("#define SKELETAL_ENABLED","")),this.receivesFog||(this.fragmentShader=this.fragmentShader.replace("#define FOG_ENABLED","")),this.receiveShadows||(this.vertexShader=this.vertexShader.replace("#define SHADOWS_ENABLED",""),this.fragmentShader=this.fragmentShader.replace("#define SHADOWS_ENABLED",""))}}]),t}(gt),vr=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=r.cullFace,n=r.cullFaceMode,i=void 0===n?"BACK":n,l=r.frontFace,d=void 0===l?"CCW":l,u;return a(this,t),u=c(this,s(t).call(this,e)),u.vertexShader="\n\tprecision highp float;\n\n\tattribute vec3 aVertexPosition;\n\tattribute vec2 aTextureCoord;\n\n\tuniform mat4 uMVCPMatrix; // Model View Camera Projection Matrix\n\n\tuniform vec2 uAtlasSize;\n\tuniform vec2 uMapSize;\n\tuniform vec2 uTileSize;\n\t\n\tvarying vec2 vPixelCoord;\n\tvarying vec2 vTexCoord;\n\n\tvarying vec2 vAtlasSize;\n\tvarying vec2 vMapSize;\n\tvarying vec2 vTileSize;\n\n\tvoid main() {\n\t\tvPixelCoord = aTextureCoord;\n\t\tvTexCoord = vPixelCoord * (uAtlasSize / (uAtlasSize / uMapSize)) * uTileSize;\n\n\t\tvTileSize = uTileSize;\n\t\tvAtlasSize = uAtlasSize;\n\n\t\tgl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n\t}\n",u.fragmentShader="\n\t#ifdef GL_FRAGMENT_PRECISION_HIGH\n\t\tprecision highp float;\n\t#else\n\t\tprecision mediump float;\n\t#endif\n\n\tuniform sampler2D uAtlasTexture;\n\tuniform sampler2D uMapTexture;\n\n\tvarying vec2 vPixelCoord;\n\tvarying vec2 vTexCoord;\n\n\tvarying vec2 vAtlasSize;\n\tvarying vec2 vMapSize;\n\tvarying vec2 vTileSize;\n\n\tvoid main(void) {\n\t\t// Grab the tile number (x,y)\n\t\tvec4 tile = texture2D(uMapTexture, vPixelCoord);\n\t\tif(tile.a == 0.0 || (tile.x == 1.0 && tile.y == 1.0)) {\n\t\t\tdiscard;\n\t\t}\n\t\t// gl_FragColor = vec4(tile.x * 30.0, tile.y * 30.0, 0.0, 1.0);\n\t\t\n\t\t// Grab the tile's texture frag color\n\t\tvec2 spriteOffset = floor(tile.xy * 256.0) * vTileSize;\n\t\tvec2 spriteCoord = mod(vTexCoord, vTileSize);\n\t\tgl_FragColor = tile.a * texture2D(uAtlasTexture, (spriteOffset + spriteCoord) / vAtlasSize);\n\t}\n",u.cullFace=void 0!==o&&o,u.cullFaceMode=i,u.frontFace=d,u}return i(t,e),n(t,[{key:"render",value:function(e,r,a,o,n,i,l,d){p(s(t.prototype),"render",this).call(this,e,r,a,o,n,i,l,d),this.map&&!1===this.map.setAsTexture(a,0,a.program.uniform.uMapTexture)||this.atlas&&!1===this.atlas.setAsTexture(a,1,a.program.uniform.uAtlasTexture)||(this.cullFace?(a.webgl.enable(a.webgl.CULL_FACE),a.webgl.cullFace(a.webgl[this.cullFaceMode]),a.webgl.frontFace(a.webgl[this.frontFace])):a.webgl.disable(a.webgl.CULL_FACE),a.webgl.uniform2fv(a.program.uniform.uAtlasSize,[this.atlas.width,this.atlas.height]),a.webgl.uniform2fv(a.program.uniform.uMapSize,[this.map.width,this.map.height]),a.webgl.uniform2fv(a.program.uniform.uTileSize,n[n.length-2].tileSize))}}]),t}(gt),xr="\n\t#define SKELETAL_ENABLED\n\n\tattribute vec3 aVertexPosition, barycentric;\n\tattribute vec4 aVertexWeights;\n\tattribute vec4 aVertexWeightIndices;\n\n\tuniform mat4 uMVCPMatrix; // Model View Camera Projection Matrix\n\tuniform mat4 uMMatrix; // Model\n\tuniform mat4 uTMatrix; // Entity\n\tuniform mat4 uCMatrix; // Camera\n\tuniform mat4 uMVMatrix;// Inverse Camera\n\tuniform mat4 uPMatrix; // Projection\n\tuniform mat4 uNormalMatrix;\n\tuniform mat4 uDeformMatrix[".concat(64,"]; // Bone matrices\n\t\n\tvarying vec4 vPositionCoord;\n\tvarying vec3 vBC;\n\t\n\tmat4 boneTransformMat4() {\n\t\tmat4 ret;\n\n\t\t// Weight normalization factor\n\t\tfloat normfac = 1.0 / (aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3]);\n\n\t\t// Weight1 * Bone1 + Weight2 * Bone2\n\t\tret = normfac * aVertexWeights[0] * uDeformMatrix[int(floor(aVertexWeightIndices[0] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[1] * uDeformMatrix[int(floor(aVertexWeightIndices[1] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[2] * uDeformMatrix[int(floor(aVertexWeightIndices[2] + 0.5))]\n\t\t\t+ normfac * aVertexWeights[3] * uDeformMatrix[int(floor(aVertexWeightIndices[3] + 0.5))];\n\n\t\treturn ret;\n\t}\n\n\tvoid main() {\n\t\tvBC = barycentric;\n\n\t\t// Set the position\n\t\t#ifdef SKELETAL_ENABLED\n\t\t\tif(aVertexWeights[0] + aVertexWeights[1] + aVertexWeights[2] + aVertexWeights[3] > 0.0){\n\t\t\t\tmat4 bt = boneTransformMat4();\n\t\t\t\tgl_Position = uMVCPMatrix * bt * vec4(aVertexPosition, 1.0);\n\n\t\t\t\tvNormal = (bt * vec4(aVertexNormal, 0.0)).xyz;\n\t\t\t}else{\n\t\t\t\tgl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n\t\t\t}\n\t\t#else\n\t\t\tgl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n\t\t#endif\n\t}\n"),_r="\n\t#extension GL_OES_standard_derivatives : enable\n\n\tprecision mediump float;\n\n\tvarying vec4 vPositionCoord;\n\tvarying vec3 vBC;\n    \n    float edgeFactor(){\n        vec3 d = fwidth(vBC);\n        vec3 a3 = smoothstep(vec3(0.0), d*1.5, vBC);\n        return min(min(a3.x, a3.y), a3.z);\n    }\n\n\tvoid main(void) {\n        gl_FragColor.rgb = mix(vec3(0.0), vec3(0.5), edgeFactor());\n\t}\n",br=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=r.lighting,n=r.skeletal,i;return a(this,t),i=c(this,s(t).call(this,e)),i.vertexShader=xr,i.fragmentShader=_r,i.shaderAttributes=g(ATTRIBUTES),i.shaderUniforms=g(UNIFORMS),i.buildProgram(),i}return i(t,e),n(t,[{key:"buildProgram",value:function(){this.shaderAttributes=g(ATTRIBUTES),this.shaderUniforms=g(UNIFORMS),this.vertexShader=xr,this.fragmentShader=_r,this.skeletal||(this.vertexShader=this.vertexShader.replace("#define SKELETAL_ENABLED",""),-1<this.shaderUniforms.indexOf("uDeformMatrix")&&this.shaderUniforms.splice(this.shaderUniforms.indexOf("uDeformMatrix"),1))}}]),t}(gt),Sr=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.options=t}return n(e,null,[{key:"load",value:function(){var e=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop();}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"loadFromURL",value:function(){var e=r(regeneratorRuntime.mark(function e(t,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:if(r.src=t,r.srcPath=t.substr(0,t.lastIndexOf("/")),void 0===r.resPath&&(r.resPath=r.srcPath),r.srcFilename=t.split("/").pop(),!(a&&a[t]&&a[t].input)){e.next=10;break}return e.abrupt("return",r.input=a[t].input);case 10:return e.abrupt("return",this.fetchFromURL(t).then(function(e){r.input=e,a&&(a[t]={input:e})}));case 11:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"fetchFromURL",value:function(){var e=r(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(t,{"Content-Type":"text/html"}).then(function(e){if(!e.ok)throw Error(e.statusText,e.url);return e.text()}).then(function(e){return e})["catch"](function(r){console.error("Error fetching template '".concat(t,"'."),r)}));case 1:case"end":return e.stop();}},e)}));return function(){return e.apply(this,arguments)}}()}]),e}(),Er={},Ar=function(e){function t(){return a(this,t),c(this,s(t).apply(this,arguments))}return i(t,e),n(t,null,[{key:"clearCache",value:function(){Er={}}},{key:"load",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t=arguments,r,a,o,n,i,s,l,d,c,u,p,m,f,g,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0<t.length&&void 0!==t[0]?t[0]:{},a=r,void 0===a.resPath&&r.src&&(a.resPath=r.src.substr(0,r.src.lastIndexOf("/"))),e.next=5,this.loadFromURL(r.src,a,Er);case 5:if(Er[r.src].materials){e.next=95;break}o=[],n=a.input.split("\n"),i=null,s=[],l=!0,d=!1,c=void 0,e.prev=13,u=n[Symbol.iterator]();case 15:if(l=(p=u.next()).done){e.next=78;break}m=p.value,s=m.split(" "),e.t0=s[0].toLowerCase(),e.next="newmtl"===e.t0?21:"illum"===e.t0?24:"ka"===e.t0?25:"kd"===e.t0?27:"ks"===e.t0?29:"ns"===e.t0?31:"ke"===e.t0?33:"tf"===e.t0?35:"d"===e.t0?37:"map_ka"===e.t0?39:"map_kd"===e.t0?43:"map_ks"===e.t0?47:"map_ke"===e.t0?51:"map_ns"===e.t0?55:"map_d"===e.t0?59:"map_bump"===e.t0?63:"bump"===e.t0?63:"disp"===e.t0?67:"decal"===e.t0?71:75;break;case 21:return o.push(new hr({name:s[1].trim(),lighting:1})),i=o[o.length-1],e.abrupt("break",75);case 24:return e.abrupt("break",75);case 25:return i.ambientColor.set(1*s[1],1*s[2],1*s[3]),e.abrupt("break",75);case 27:return i.diffuseColor.set(1*s[1],1*s[2],1*s[3]),e.abrupt("break",75);case 29:return i.specularColor.set(1*s[1],1*s[2],1*s[3]),e.abrupt("break",75);case 31:return i.specularExponent=1*s[1],e.abrupt("break",75);case 33:return i.emitColor.set(1*s[1],1*s[2],1*s[3]),e.abrupt("break",75);case 35:return i.transmissionFilter.set(1*s[1],void 0===s[2]?1*s[1]:1*s[2],void 0===s[3]?1*s[1]:1*s[3]),e.abrupt("break",75);case 37:return i.dissolve=1*s[1],e.abrupt("break",75);case 39:return i.ambientTexture=new Ne({src:a.resPath+"/"+s[s.length-1]}),e.next=42,i.ambientTexture.load();case 42:return e.abrupt("break",75);case 43:return i.diffuseTexture=new Ne({src:a.resPath+"/"+s[s.length-1]}),e.next=46,i.diffuseTexture.load();case 46:return e.abrupt("break",75);case 47:return i.specularColorTexture=new Ne({src:a.resPath+"/"+s[s.length-1]}),e.next=50,i.specularColorTexture.load();case 50:return e.abrupt("break",75);case 51:return i.emitTexture=new Ne({src:a.resPath+"/"+s[s.length-1]}),e.next=54,i.emitTexture.load();case 54:return e.abrupt("break",75);case 55:return i.specularHighlightTexture=new Ne({src:a.resPath+"/"+s[s.length-1]}),e.next=58,i.specularHighlightTexture.load();case 58:return e.abrupt("break",75);case 59:return i.alphaTexture=new Ne({src:a.resPath+"/"+s[s.length-1]}),e.next=62,i.alphaTexture.load();case 62:return e.abrupt("break",75);case 63:return i.bumpMapTexture=new Ne({src:a.resPath+"/"+s[s.length-1]}),e.next=66,i.bumpMapTexture.load();case 66:return e.abrupt("break",75);case 67:return i.displacementTexture=new Ne({src:a.resPath+"/"+s[s.length-1]}),e.next=70,i.displacementTexture.load();case 70:return e.abrupt("break",75);case 71:return i.decalTexture=new Ne({src:a.resPath+"/"+s[s.length-1]}),e.next=74,i.decalTexture.load();case 74:return e.abrupt("break",75);case 75:l=!0,e.next=15;break;case 78:e.next=84;break;case 80:e.prev=80,e.t1=e["catch"](13),d=!0,c=e.t1;case 84:e.prev=84,e.prev=85,l||null==u["return"]||u["return"]();case 87:if(e.prev=87,!d){e.next=90;break}throw c;case 90:return e.finish(87);case 91:return e.finish(84);case 92:for(f=0,g=o;f<g.length;f++)y=g[f],y.buildProgram();Er[r.src].materials=o,delete Er[r.src].input;case 95:return e.abrupt("return",Er[r.src].materials);case 96:case"end":return e.stop();}},e,this,[[13,80,84,92],[85,,87,91]])}));return function(){return e.apply(this,arguments)}}()}]),t}(Sr),Tr={},kr=function(e){function t(){return a(this,t),c(this,s(t).apply(this,arguments))}return i(t,e),n(t,null,[{key:"clearCache",value:function(){Tr={}}},{key:"load",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t=arguments,r,a,o,n,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0<t.length&&void 0!==t[0]?t[0]:{},a={},e.next=4,this.loadFromURL(r.src,a,Tr);case 4:return this.options=r,Tr[r.src].model||(o=JSON.parse(Tr[r.src].input),n=this.cloneMeshes(o.model.meshes,a),i=this.cloneSkeleton(o.model.bones,a),i.children=i.flattenChildren(),i.children=this.sortBones(i.children,o.model.meshes[0].boneOrder),s=this.cloneAnimationClips(o.model.animationClips,i,a),Tr[r.src].model=new xt({meshes:n,skeleton:i,animationClips:s}),delete Tr[r.src].input),e.abrupt("return",Tr[r.src].model);case 8:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cloneModel",value:function(e,t){var r=this.cloneMeshes(e.meshes,t),a=this.cloneSkeleton(e.skeleton,t),o=this.cloneAnimationClips(e.animationClips,a,t);return new xt({meshes:r,skeleton:a,animationClips:o})}},{key:"cloneMeshes",value:function(e,t){var r=[],a=!0,o=!1,n=void 0;try{for(var i=e[Symbol.iterator](),s;!(a=(s=i.next()).done);a=!0){var l=s.value,d=null;l.material.diffuseTexture&&(l.material.diffuseTexture instanceof Ne?d=l.material.diffuseTexture:d=new Ne({src:t.resPath+"/"+l.material.diffuseTexture.src})),r.push(new ht({id:"MESH_COPY",material:new hr(l.material),vertices:new Float32Array(l.vertices),uvs:new Float32Array(l.uvs),normals:new Float32Array(l.normals),weights:new Float32Array(l.weights),weightIndices:new Float32Array(l.weightIndices)})),r[r.length-1].material.buildProgram()}}catch(e){o=!0,n=e}finally{try{a||null==i["return"]||i["return"]()}finally{if(o)throw n}}return r}},{key:"cloneSkeleton",value:function(e){if(e){var t=new kt({children:this.cloneBones(e)});return t.calcBindPose(),t}}},{key:"sortBones",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=[];t.forEach(function(t){var a=!1;e=e.filter(function(e){return!!(a||e.id!=t)||(r.push(e),a=!0,!1)})});var a=!0,o=!1,n=void 0;try{for(var i=e[Symbol.iterator](),s,l;!(a=(s=i.next()).done);a=!0)l=s.value,0>r.indexOf(l)&&r.push(l)}catch(e){o=!0,n=e}finally{try{a||null==i["return"]||i["return"]()}finally{if(o)throw n}}return r}},{key:"cloneBones",value:function(e,t){function r(e,t){var r=!0,a=!1,o=void 0;try{for(var n=t[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)if(s=i.value,s.id==e)return s}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}}var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],o=[],n=!0,i=!1,s=void 0;try{for(var l=(e.children||e)[Symbol.iterator](),d;!(n=(d=l.next()).done);n=!0){var c=d.value,u=r(c.id,a);if(!u){var p=new Dt;if(c.matrixWorld)p.localMatrix=new Float32Array(c.matrix);else if(c.transform.translation)switch(p.translate.xyz=[c.transform.translation[0],c.transform.translation[1],c.transform.translation[2]],p.sxyz=[c.transform.scale[0],c.transform.scale[1],c.transform.scale[2]],c.transform.rotation[3]){case"ZYX":p.rotateToZYX(c.transform.rotation[2],c.transform.rotation[1],c.transform.rotation[0]);break;case"XYZ":default:p.rotateToXYZ(c.transform.rotation[0],c.transform.rotation[1],c.transform.rotation[2]);}else p.localMatrix=new Float32Array(c.transform.localMatrix);u=new Ye({name:c.name,id:c.id||c.FBXID,parent:t,inheritTransform:c.inheritTransform,transform:p}),u.children=this.cloneBones(c,u,a)}o.push(u),a.push(u)}}catch(e){i=!0,s=e}finally{try{n||null==l["return"]||l["return"]()}finally{if(i)throw s}}return o}},{key:"cloneAnimationClips",value:function(e,t){var r=[],a=!0,o=!1,n=void 0;try{for(var i=e[Symbol.iterator](),s,l;!(a=(s=i.next()).done);a=!0)l=s.value,r.push(new Ue({name:l.name,loop:l.loop,enabled:l.enabled,tracks:this.cloneAnimationTracks(l.tracks,t)}))}catch(e){o=!0,n=e}finally{try{a||null==i["return"]||i["return"]()}finally{if(o)throw n}}return r}},{key:"cloneAnimationTracks",value:function(e,t){function r(e,t){var r=!0,a=!1,o=void 0;try{for(var n=t.children[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)if(s=i.value,s.id==e)return s}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}}function a(e,t){var r=!0,a=!1,o=void 0;try{for(var n=t.children[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)if(s=i.value,s.name==e)return s}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}}var o=[],n=!0,i=!1,s=void 0;try{for(var l=e[Symbol.iterator](),d;!(n=(d=l.next()).done);n=!0){var c=d.value,u=null;u=c.parent.id?r(c.parent.id,t):a(c.parent,t),o.push(new Ge({name:c.name,type:c.type,times:c.times.slice(),values:c.values.slice(),parent:u}))}}catch(e){i=!0,s=e}finally{try{n||null==l["return"]||l["return"]()}finally{if(i)throw s}}return o}}]),t}(Sr),Br={},Or=function(e){function t(){return a(this,t),c(this,s(t).apply(this,arguments))}return i(t,e),n(t,[{key:"setIlluminationMode",value:function(){}}],[{key:"clearCache",value:function(){Br={}}},{key:"load",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t=arguments,r,a,o,n,i,s,l,d,c,u,p,m,f,g,y,h,v,x;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0<t.length&&void 0!==t[0]?t[0]:{},a={},e.next=4,this.loadFromURL(r.src,a,Br);case 4:if(this.options=r,Br[r.src].model){e.next=68;break}o=a.input.split("\n"),n=null,i=[],s=[],l=[],d=[],c=[],u=[],p=[],m=!0,f=!1,g=void 0,e.prev=18,y=o[Symbol.iterator]();case 20:if(m=(h=y.next()).done){e.next=52;break}v=h.value,p=v.split(" "),""===p[1]&&p.splice(1,1),e.t0=p[0],e.next="o"===e.t0?27:"g"===e.t0?27:"mtllib"===e.t0?32:"usemtl"===e.t0?36:"v"===e.t0?38:"vt"===e.t0?40:"vn"===e.t0?42:"vp"===e.t0?44:"f"===e.t0?46:"s"===e.t0?48:49;break;case 27:if("default"!=p[p.length-1]){e.next=29;break}return e.abrupt("continue",49);case 29:return n=this.getMaterialById(p[p.length-1],i),n||(x=new ht({id:p[p.length-1],material:null,vertices:[],uvs:[],normals:[]}),i.push(x),n=x),e.abrupt("break",49);case 32:return e.next=34,Ar.load({resPath:a.resPath,src:a.resPath+"/"+p[1].trim()});case 34:return s=e.sent,e.abrupt("break",49);case 36:return n.material=this.getMaterialByName(p[1].trim(),s),e.abrupt("break",49);case 38:return this.parseGeometricVertices(p,l),e.abrupt("break",49);case 40:return this.parseTextureCoordinates(p,d),e.abrupt("break",49);case 42:return this.parseVertexNormals(p,c),e.abrupt("break",49);case 44:return this.parseParameterSpaceVertices(p,u),e.abrupt("break",49);case 46:return this.parsePolygonalFaces(p,l,d,c,u,n),e.abrupt("break",49);case 48:return e.abrupt("break",49);case 49:m=!0,e.next=20;break;case 52:e.next=58;break;case 54:e.prev=54,e.t1=e["catch"](18),f=!0,g=e.t1;case 58:e.prev=58,e.prev=59,m||null==y["return"]||y["return"]();case 61:if(e.prev=61,!f){e.next=64;break}throw g;case 64:return e.finish(61);case 65:return e.finish(58);case 66:Br[r.src].model=new xt({meshes:i}),delete Br[r.src].input;case 68:return e.abrupt("return",this.cloneModel(Br[r.src].model));case 69:case"end":return e.stop();}},e,this,[[18,54,58,66],[59,,61,65]])}));return function(){return e.apply(this,arguments)}}()},{key:"getMeshById",value:function(e,t){var r=!0,a=!1,o=void 0;try{for(var n=t[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)if(s=i.value,s.id===e)return s}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}return null}},{key:"getMaterialById",value:function(e,t){var r=!0,a=!1,o=void 0;try{for(var n=t[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)if(s=i.value,s.id===e)return s}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}return null}},{key:"getMeshByName",value:function(e,t){var r=!0,a=!1,o=void 0;try{for(var n=t[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)if(s=i.value,s.name===e)return s}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}return null}},{key:"getMaterialByName",value:function(e,t){var r=!0,a=!1,o=void 0;try{for(var n=t[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)if(s=i.value,s.name===e)return s}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}return null}},{key:"parseGeometricVertices",value:function(e,t){void 0===e[4]&&(e[4]=1),t.push(1*e[1],1*e[2],1*e[3])}},{key:"parseTextureCoordinates",value:function(e,t){void 0===e[3]?t.push(1*e[1],1*e[2]):t.push(1*e[1],1*e[2])}},{key:"parseVertexNormals",value:function(e,t){t.push(1*e[1],1*e[2],1*e[3])}},{key:"parseParameterSpaceVertices",value:function(e,t){t.push(1*e[1],1*e[2],1*e[3])}},{key:"parsePolygonalFaces",value:function(e,t,r,a,o,n){for(var s=[],l=1;l<e.length;l++)s[l-1]=e[l].split("/");for(var l=0;l<s.length;l++)2>s[l].length&&s.splice(l,1);3===s.length?(n.vertices.push(t[3*(1*s[0][0]-1)+0],t[3*(1*s[0][0]-1)+1],t[3*(1*s[0][0]-1)+2],t[3*(1*s[1][0]-1)+0],t[3*(1*s[1][0]-1)+1],t[3*(1*s[1][0]-1)+2],t[3*(1*s[2][0]-1)+0],t[3*(1*s[2][0]-1)+1],t[3*(1*s[2][0]-1)+2]),""!==s[0][1]&&n.uvs.push(r[2*(1*s[0][1]-1)+0],r[2*(1*s[0][1]-1)+1],r[2*(1*s[1][1]-1)+0],r[2*(1*s[1][1]-1)+1],r[2*(1*s[2][1]-1)+0],r[2*(1*s[2][1]-1)+1]),""!==s[0][2]&&n.normals.push(a[3*(1*s[0][2]-1)+0],a[3*(1*s[0][2]-1)+1],a[3*(1*s[0][2]-1)+2],a[3*(1*s[1][2]-1)+0],a[3*(1*s[1][2]-1)+1],a[3*(1*s[1][2]-1)+2],a[3*(1*s[2][2]-1)+0],a[3*(1*s[2][2]-1)+1],a[3*(1*s[2][2]-1)+2])):(n.vertices.push(t[3*(1*s[0][0]-1)+0],t[3*(1*s[0][0]-1)+1],t[3*(1*s[0][0]-1)+2],t[3*(1*s[1][0]-1)+0],t[3*(1*s[1][0]-1)+1],t[3*(1*s[1][0]-1)+2],t[3*(1*s[2][0]-1)+0],t[3*(1*s[2][0]-1)+1],t[3*(1*s[2][0]-1)+2],t[3*(1*s[0][0]-1)+0],t[3*(1*s[0][0]-1)+1],t[3*(1*s[0][0]-1)+2],t[3*(1*s[2][0]-1)+0],t[3*(1*s[2][0]-1)+1],t[3*(1*s[2][0]-1)+2],t[3*(1*s[3][0]-1)+0],t[3*(1*s[3][0]-1)+1],t[3*(1*s[3][0]-1)+2]),""!==s[0][1]&&n.uvs.push(r[2*(1*s[0][1]-1)+0],r[2*(1*s[0][1]-1)+1],r[2*(1*s[1][1]-1)+0],r[2*(1*s[1][1]-1)+1],r[2*(1*s[2][1]-1)+0],r[2*(1*s[2][1]-1)+1],r[2*(1*s[0][1]-1)+0],r[2*(1*s[0][1]-1)+1],r[2*(1*s[2][1]-1)+0],r[2*(1*s[2][1]-1)+1],r[2*(1*s[3][1]-1)+0],r[2*(1*s[3][1]-1)+1]),""!==s[0][2]&&n.normals.push(a[3*(1*s[0][2]-1)+0],a[3*(1*s[0][2]-1)+1],a[3*(1*s[0][2]-1)+2],a[3*(1*s[1][2]-1)+0],a[3*(1*s[1][2]-1)+1],a[3*(1*s[1][2]-1)+2],a[3*(1*s[2][2]-1)+0],a[3*(1*s[2][2]-1)+1],a[3*(1*s[2][2]-1)+2],a[3*(1*s[0][2]-1)+0],a[3*(1*s[0][2]-1)+1],a[3*(1*s[0][2]-1)+2],a[3*(1*s[2][2]-1)+0],a[3*(1*s[2][2]-1)+1],a[3*(1*s[2][2]-1)+2],a[3*(1*s[3][2]-1)+0],a[3*(1*s[3][2]-1)+1],a[3*(1*s[3][2]-1)+2]))}},{key:"cloneModel",value:function(e){var t=this.cloneMeshes(e.meshes),r=this.cloneSkeleton(e.skeleton),a=this.cloneAnimationClips(e.animationClips,r);return new xt({id:e.id,meshes:t,skeleton:r,animationClips:a})}},{key:"cloneMeshes",value:function(e){var t=[],r=!0,a=!1,o=void 0;try{for(var n=e[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)s=i.value,s.material&&t.push(new ht({id:s.id,material:new hr(s.material),vertices:new Float32Array(s.vertices),uvs:new Float32Array(s.uvs),normals:new Float32Array(s.normals),weights:new Float32Array(s.weights),weightIndices:new Float32Array(s.weightIndices)}))}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}return t}},{key:"cloneSkeleton",value:function(e){return e?new Skeleton({children:this.cloneBones(e)}):void 0}},{key:"cloneBones",value:function(e,t){function r(e,t){var r=!0,a=!1,o=void 0;try{for(var n=t[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)if(s=i.value,s.id==e)return s}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}}var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],o=[],n=!0,i=!1,s=void 0;try{for(var l=e.children[Symbol.iterator](),d;!(n=(d=l.next()).done);n=!0){var c=d.value,u=r(c.id,a);if(!u){var p=new Transform;p.localMatrix=new Float32Array(c.transform.localMatrix),p.generateTranslationRotationScale(),u=new Bone({name:c.name,id:c.id||c.FBXID,parent:t,inheritTransform:c.inheritTransform,transform:p}),u.children=this.cloneBones(c,u,a)}o.push(u),a.push(u)}}catch(e){i=!0,s=e}finally{try{n||null==l["return"]||l["return"]()}finally{if(i)throw s}}return o}},{key:"cloneAnimationClips",value:function(e,t){var r=[],a=!0,o=!1,n=void 0;try{for(var i=e[Symbol.iterator](),s,l;!(a=(s=i.next()).done);a=!0)l=s.value,r.push(new AnimationClip({name:l.name,loop:l.loop,enabled:l.enabled,tracks:this.cloneAnimationTracks(l.tracks,t)}))}catch(e){o=!0,n=e}finally{try{a||null==i["return"]||i["return"]()}finally{if(o)throw n}}return r}},{key:"cloneAnimationTracks",value:function(e,t){function r(e,t){var r=!0,a=!1,o=void 0;try{for(var n=t.children[Symbol.iterator](),i,s;!(r=(i=n.next()).done);r=!0)if(s=i.value,s.id==e)return s}catch(e){a=!0,o=e}finally{try{r||null==n["return"]||n["return"]()}finally{if(a)throw o}}}var a=[],o=!0,n=!1,i=void 0;try{for(var s=e[Symbol.iterator](),l,d;!(o=(l=s.next()).done);o=!0)d=l.value,a.push(new AnimationTrack({name:d.name,type:d.type,times:d.times.slice(),values:d.values.slice(),parent:r(d.parent.id,t)}))}catch(e){n=!0,i=e}finally{try{o||null==s["return"]||s["return"]()}finally{if(n)throw i}}return a}}]),t}(Sr),wr={},Ir=function(e){function t(){return a(this,t),c(this,s(t).apply(this,arguments))}return i(t,e),n(t,null,[{key:"clearCache",value:function(){wr={}}},{key:"load",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t=arguments,r,a,o,n,i,s,l,d,c,u,p,m,y,h,v,x,_,b,S,E,A,T,k,B,O,w,I,C,M,P,D,L,F,H,R,N,U,G,V,X,Y,W,z,j,K,Z,Q,q,J,$,ee,te;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=0<t.length&&void 0!==t[0]?t[0]:{},Array.isArray(r.src)||(r.src=[r.src]),a={},a.options=r,wr[r.src[0]]&&wr[r.src[0]].sprite){e.next=128;break}o={},n=r.src[0].substring(0,r.src[0].lastIndexOf("/")+1),r.defaultPivot||(r.defaultPivot=[.5,.5]),i=!0,s=!1,l=void 0,e.prev=11,d=r.src[Symbol.iterator]();case 13:if(i=(c=d.next()).done){e.next=23;break}if(u=c.value,p=u.split("/").pop(),wr[u]&&wr[u].sprite){e.next=20;break}return e.next=19,this.loadFromURL(n+p,a,wr);case 19:o[p]||(o[p]=JSON.parse(a.input),o[p].meta.related_multi_packs&&(m=r.src).push.apply(m,g(o[p].meta.related_multi_packs)));case 20:i=!0,e.next=13;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e["catch"](11),s=!0,l=e.t0;case 29:e.prev=29,e.prev=30,i||null==d["return"]||d["return"]();case 32:if(e.prev=32,!s){e.next=35;break}throw l;case 35:return e.finish(32);case 36:return e.finish(29);case 37:for(y=r.src,r.src=[],(h=0,v=Object.values(o));h<v.length;h++)x=v[h],r.src.push(a.resPath+"/"+x.meta.image);if(!r.textures){e.next=86;break}_=[],b=!0,S=!1,E=void 0,e.prev=45,A=r.src[Symbol.iterator]();case 47:if(b=(T=A.next()).done){e.next=71;break}for(k=T.value,B=!0,O=!1,w=void 0,e.prev=52,I=r.textures[Symbol.iterator]();!(B=(C=I.next()).done);B=!0)M=C.value,M.src===k&&_.push(M);e.next=60;break;case 56:e.prev=56,e.t1=e["catch"](52),O=!0,w=e.t1;case 60:e.prev=60,e.prev=61,B||null==I["return"]||I["return"]();case 63:if(e.prev=63,!O){e.next=66;break}throw w;case 66:return e.finish(63);case 67:return e.finish(60);case 68:b=!0,e.next=47;break;case 71:e.next=77;break;case 73:e.prev=73,e.t2=e["catch"](45),S=!0,E=e.t2;case 77:e.prev=77,e.prev=78,b||null==A["return"]||A["return"]();case 80:if(e.prev=80,!S){e.next=83;break}throw E;case 83:return e.finish(80);case 84:return e.finish(77);case 85:r.textures=_;case 86:return P=new Ct(r),e.next=89,P.loadTextures();case 89:r.src=y,D=-1,L=0,F=Object.values(o);case 92:if(!(L<F.length)){e.next=125;break}if(H=F[L],D++,R=H.meta.image.split(".")[0],!(H.frames instanceof Array)){e.next=118;break}for(N=!0,U=!1,G=void 0,e.prev=100,V=H.frames[Symbol.iterator]();!(N=(X=V.next()).done);N=!0)Y=X.value,W=R,Y.filename.indexOf("/")&&(W=Y.filename.substring(0,Y.filename.lastIndexOf("/"))),z=P.animations[W],z||(z=new Mt({loop:!0}),P.addAnimation(W,z)),j=a.options.speed||15/1e3,Y.userData&&Y.userData.speed&&(j=Y.userData.speed),z.addFrame({speed:j,name:Y.filename.substring(Y.filename.lastIndexOf("/")+1),x:1*Y.frame.x,y:1*Y.frame.y,width:1*Y.frame.w,height:1*Y.frame.h,offsetX:Y.spriteSourceSize.x,offsetY:Y.spriteSourceSize.y,pivotX:Y.pivot?1*Y.pivot.x:r.defaultPivot[0],pivotY:Y.pivot?1-1*Y.pivot.y:r.defaultPivot[1],materialIndex:D});e.next=108;break;case 104:e.prev=104,e.t3=e["catch"](100),U=!0,G=e.t3;case 108:e.prev=108,e.prev=109,N||null==V["return"]||V["return"]();case 111:if(e.prev=111,!U){e.next=114;break}throw G;case 114:return e.finish(111);case 115:return e.finish(108);case 116:e.next=122;break;case 118:for(K=R,Z=new Mt({loop:!0}),P.addAnimation(K,Z),(Q=0,q=Object.entries(H.frames));Q<q.length;Q++)J=f(q[Q],2),$=J[0],ee=J[1],te=a.options.speed||15/1e3,ee.userData&&ee.userData.speed&&(te=ee.userData.speed),Z.addFrame({speed:te,x:1*ee.frame.x,y:1*ee.frame.y,width:1*ee.frame.w,height:1*ee.frame.h,pivotX:ee.pivot?1*ee.pivot.x:r.defaultPivot[0],pivotY:ee.pivot?1-1*ee.pivot.y:r.defaultPivot[1],materialIndex:D});case 122:L++,e.next=92;break;case 125:wr[r.src[0]].sprite=P,delete wr[r.src[0]].sprite.id,delete wr[r.src[0]].input;case 128:return a.sprite=this.cloneSprite(wr[r.src[0]].sprite),void 0!==a.options.defaultAnimation&&(a.options.autoplay||void 0===a.options.autoplay?a.sprite.playAnimation(a.options.defaultAnimation):a.sprite.selectAnimation(a.options.defaultAnimation)),e.abrupt("return",a.sprite);case 131:case"end":return e.stop();}},e,this,[[11,25,29,37],[30,,32,36],[45,73,77,85],[52,56,60,68],[61,,63,67],[78,,80,84],[100,104,108,116],[109,,111,115]])}));return function(){return e.apply(this,arguments)}}()},{key:"cloneSprite",value:function(e,t){var r;if(t){var a=e.textures,o=e.mesh.material.diffuseTexture,n=e.src;e.src=null,r=new Ct(e),r.textures=a,r.mesh.material.diffuseTexture=o,r._src=n,e.textures=a,e.mesh.material.diffuseTexture=o,e._src=n}else r=new Ct(e);return this.cloneSpriteAnimations(r,e.animations),r.transform=new Dt(e.transform),r}},{key:"cloneSpriteAnimations",value:function(e,t){for(var r=0,a=Object.entries(t);r<a.length;r++){var o=f(a[r],2),n=o[0],i=o[1],s=new Mt(i);e.addAnimation(n,s)}return t}}]),t}(Sr),Cr={audio:{music:["res/audio/music/AO-CN-Intro.mp3","res/audio/music/AO-MU-bonus-1.mp3","res/audio/music/AO-Music.mp3","res/audio/music/SO-GameOver.mp3"],sfx:["res/audio/sfx/0000.mp3","res/audio/sfx/0137.mp3","res/audio/sfx/0149.mp3","res/audio/sfx/0252.mp3","res/audio/sfx/0259.mp3","res/audio/sfx/0306.mp3","res/audio/sfx/0340.mp3","res/audio/sfx/0415.mp3","res/audio/sfx/0441.mp3","res/audio/sfx/0447.mp3","res/audio/sfx/0457.mp3","res/audio/sfx/0509.mp3","res/audio/sfx/0514.mp3","res/audio/sfx/0527.mp3","res/audio/sfx/0529.mp3","res/audio/sfx/0543.mp3","res/audio/sfx/0618.mp3","res/audio/sfx/0714.mp3","res/audio/sfx/0722.mp3","res/audio/sfx/0732.mp3","res/audio/sfx/0803.mp3","res/audio/sfx/0804.mp3","res/audio/sfx/0844.mp3","res/audio/sfx/0848.mp3","res/audio/sfx/0921.mp3","res/audio/sfx/0939.mp3","res/audio/sfx/1004.mp3","res/audio/sfx/1013.mp3","res/audio/sfx/1030.mp3","res/audio/sfx/1031.mp3","res/audio/sfx/AO-10-Duck-04-A.mp3","res/audio/sfx/AO-10-Duck-05-duckling.mp3","res/audio/sfx/AO-10-Duck-06-B.mp3","res/audio/sfx/AO-10-Duck-07-C.mp3","res/audio/sfx/AO-OB-select.mp3","res/audio/sfx/AO-OB-selectEnd.mp3","res/audio/sfx/AO-SO-BedShake.mp3","res/audio/sfx/OB-Cal-Flip.mp3","res/audio/sfx/SO-Box100.mp3","res/audio/sfx/SO-BreakMug_mix01.mp3","res/audio/sfx/SO-ButtonPress.mp3","res/audio/sfx/SO-eagle-B.mp3","res/audio/sfx/SO-Eagle-Hit.mp3","res/audio/sfx/SO-GoldTrophy.mp3","res/audio/sfx/SO-OB-MugDrip.mp3","res/audio/sfx/SO-PaperAirplane-X.mp3","res/audio/sfx/SO-ScoringBox.mp3","res/audio/sfx/SO-Scratch.mp3","res/audio/sfx/TB-DropItem.mp3"]},videos:[],images:["res/textures/ao-jp-0.png","res/textures/ao-jp-1.png","res/textures/ao-jp-2.png","res/textures/ao-jp-3.png","res/textures/ao-jp-4.png","res/textures/ao-jp-5.png","res/textures/ao-jp-glyphs.png","res/textures/cn-preloader-black.png","res/textures/TC-Background.png","res/textures/TC-LOGO-MnR.png","res/textures/transition_circle_black.png","res/textures/transition_pixel.png"],models:[],spritesheets:["res/textures/ao-jp-0.json","res/textures/ao-jp-glyphs.json","res/textures/cn-preloader-black.json"]},Mr=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.vertexShader="\n    attribute vec3 aVertexPosition;\n    attribute vec2 aTextureCoord;\n\n    // uniform mat4 uMVCPMatrix; // Model View Camera Projection Matrix\n    uniform mat4 uVMatrix;\n    uniform mat4 uMMatrix;\n    \n\tvarying vec2 vTextureCoord;\n    \n    void main(void) {\n        // gl_Position = uMVCPMatrix * vec4(aVertexPosition, 1.0);\n        gl_Position = uVMatrix * uMMatrix * vec4(aVertexPosition, 1.0);\n\n        vTextureCoord = aTextureCoord;\n    }\n",e.fragmentShader="\n    #extension GL_OES_standard_derivatives: enable\n\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n        precision highp float;\n    #else\n        precision mediump float;\n    #endif\n\n    uniform sampler2D uDiffuseTexture;\n    \n\tuniform vec3 uHSLAdjust;\n\tuniform float uOpacity;\n    \n    varying vec2 vTextureCoord;\n    \n    // All components are in the range [0\u20261], including hue.\n    vec3 rgb2hsv(vec3 c) {\n        vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n        vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n        float d = q.x - min(q.w, q.y);\n        float e = 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n    }\n    \n\n    // All components are in the range [0\u20261], including hue.\n    vec3 hsv2rgb(vec3 c) {\n        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n    }\n\n    void main(void) {\n        vec4 color = texture2D(uDiffuseTexture, vTextureCoord);\n\n        // Convert to HSV\n        color.rgb = rgb2hsv(color.rgb);\n\n        // Adjust\n        color.r += uHSLAdjust.r;\n        color.g += uHSLAdjust.g;\n        color.b += uHSLAdjust.b;\n\n        // Convert to RGB\n        color.rgb = hsv2rgb(color.rgb);\n\n        color.a *= uOpacity;\n\n        gl_FragColor = color;\n        // gl_FragColor = vec4(1.,1.,0.,1.);\n        \n        // if(gl_FragColor.a == 0.0) discard;\n    }\n",e.blend=!1,e.depthTest=!0,e.cullFace=!1,e}return i(t,e),n(t,[{key:"render",value:function(e,r,a,o,n,i,l,d){p(s(t.prototype),"render",this).call(this,e,r,a,o,n,i,l,d);var c=n[n.length-3],u=n[n.length-2];!1===u.textures[u._materialIndex].setAsTexture(a,0,a.program.uniform.uDiffuseTexture)||(c.HSV&&a.webgl.uniform3fv(a.program.uniform.uHSLAdjust,c.HSV),a.webgl.uniform1f(a.program.uniform.uOpacity,void 0===c.opacity?1:c.opacity),a.webgl.blendFunc(a.webgl.SRC_ALPHA,a.webgl.ONE_MINUS_SRC_ALPHA),a.webgl.enable(a.webgl.BLEND))}}]),t}(gt),Pr={DUCKINGS:{x:{min:40,max:50},y:{min:30,max:35}},HYPER_HIGH:{x:{min:13,max:17},y:{min:48,max:52}},SUPER_HIGH:{x:{min:17,max:22},y:{min:42,max:45}},DYNAMIC_HIGH:{x:{min:20,max:20},y:{min:30,max:45}},HIGH_2:{x:{min:16,max:21},y:{min:40,max:42}},HIGH:{x:{min:18,max:23},y:{min:35,max:40}},MEDIUM:{x:{min:20,max:30},y:{min:30,max:40}},MEDIUM_RARE:{x:{min:23,max:30},y:{min:27,max:35}},LOW:{x:{min:30,max:33},y:{min:25,max:30}},DYNAMIC:{x:{min:18,max:40},y:{min:22,max:35}},SUPER_LOW:{x:{min:30,max:30},y:{min:25,max:25}},SOCCER_KICK:{x:{min:34,max:38},y:{min:17,max:50}},SOCCER_KICK_REVERSE:{x:{min:0,max:-38},y:{min:17,max:50}},BASKET_THROW:{x:{min:18,max:23},y:{min:35,max:40}},MUG:{x:{min:7,max:12},y:{min:19,max:21}}},Dr={HIGH:[Pr.HIGH,Pr.HIGH_2,Pr.SUPER_HIGH],MEDIUM:[Pr.MEDIUM_RARE,Pr.MEDIUM,Pr.LOW],LOW:[Pr.MEDIUM_RARE,Pr.MEDIUM_RARE,Pr.LOW,Pr.SUPER_LOW],MUG:[Pr.MUG]},Lr={HAT:"HAT",BALL:"BALL",BONE:"BONE",CAN:"CAN",SOCK:"SOCK",CUP:"CUP",BOOK:"BOOK",CONE:"CONE"},Fr={SUPER_FAST:{min:.4,max:.4},FAST:{min:.3,max:.3},MEDIUM:{min:.2,max:.2},SLOW:{min:.1,max:.1},NONE:{min:0,max:0}},Hr=function(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},t=e.order,r=void 0===t?0:t,a=e.delay,o=void 0===a?0:a,n=e.offset,i=e.isFast,s=void 0!==i&&i?"OB-Eagle-Fast":"OB-Eagle";return{delay:o,items:[s],order:r,followUps:[]}},Rr=function(e){var t=e.order,r=void 0===t?0:t,a=e.delay,o=void 0===a?5e3:a,n=e.mainItem,s=void 0===n?"OB-Sock":n,l=e.firstItem,d=void 0===l?null:l,c=e.followUpItem,u=void 0===c?null:c,p=e.offsetXY,m=void 0===p?35:p,f=e.amount,g=void 0===f?10:f,y=e.velocityArcs,h=void 0===y?[Pr.MEDIUM]:y;m*=2;for(var v=[],x=0;x<g-1;x++)v.push({velocity:Ur(h,s),offset:Gr(m),delay:0,items:[s]});null!==u&&v.push({velocity:Ur(h,u),offset:Gr(m,u),delay:750,items:[u]});var _=null===d?s:d;return{order:r,velocity:Ur(h,_),delay:o,items:[_],followUps:v}},Nr=function(e){for(var t=e.delay,r=void 0===t?5e3:t,a=e.minMaxDelay,o=void 0===a?[100,700]:a,n=e.order,s=void 0===n?0:n,l=e.items,d=void 0===l?["OB-Sock"]:l,c=e.lastItem,u=void 0===c?null:c,p=e.lastItemDealy,g=void 0===p?null:p,y=e.amount,h=void 0===y?10:y,v=e.velocityArcs,x=void 0===v?[Pr.MEDIUM]:v,_=[],b=0,S=1,E;S<h;S++)E=d[b],_.push({velocity:Ur(x,E),delay:Xr(o),items:[E]}),void 0===d[b]&&(b=(m("itemIndex"),0));null!==u&&_.push({velocity:Ur(x,u),delay:g?g:Xr(o),items:[u]});var A=f(d,1),T=A[0],k={velocity:Ur(x,T),delay:r,items:[T],order:s,followUps:_};return k},Ur=function(e,t){if("OB-Duckling"===t)return Pr.DUCKINGS;var r=pe(ue(Math.random()*e.length),e.length-1);return e[r]},Gr=function(e){return[-Vr(e),Vr(e)]},Vr=function(e){return ue(Math.random()*e)},Xr=function(e){var t=f(e,2),r=t[0],a=t[1],o=Math.random()*a,n=ne(o,r);return n};({levelId:"CLUMP TEST",music:"AO-Music",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1.1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:800,randomizeGroups:!0,groups:[{delay:800,items:["OB-PaperAirplane"],order:-1,followUps:[{delay:200,velocity:Pr.MEDIUM,offset:[-30,-30],items:["OB-Sock"]}]},{delay:800,items:["OB-Eagle"],followUps:[{delay:200,velocity:Pr.MEDIUM,offset:[-30,-30],items:["OB-Sock"]}]},Nr({delay:500,minMaxDelay:[400,800],items:["OB-Sock"],amount:10,velocityArcs:[Pr.MEDIUM]}),Rr({delay:1500,mainItem:"OB-Sneaker",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:10,offsetXY:50}),Rr({delay:1500,mainItem:"OB-Sock",secondaryItem:"OB-Sock",followUpItem:"OB-Can-2",velocityArcs:Dr.LOW,amount:15,offsetXY:60}),Rr({delay:1500,mainItem:"OB-Can",secondaryItem:"OB-Sock",velocityArcs:Dr.LOW,amount:15,offsetXY:30}),Rr({delay:1500,mainItem:"OB-Can-2",secondaryItem:"OB-Can",velocityArcs:Dr.HIGH,amount:4,offsetXY:30}),Rr({delay:1500,mainItem:"OB-Sneaker",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:15,offsetXY:90}),Rr({delay:1500,mainItem:"OB-Sock",secondaryItem:"OB-Sock",followUpItem:"OB-Can-2",velocityArcs:Dr.MEDIUM,amount:20,offsetXY:60}),Rr({delay:1500,mainItem:"OB-Can",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:8,offsetXY:40}),Rr({delay:1500,mainItem:"OB-Can-2",secondaryItem:"OB-Can",velocityArcs:Dr.HIGH,amount:10,offsetXY:30})]},actors:[{cls:"Background-1-Sky-Night",position:[0,0,-2],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1-Sky-Day",position:[0,0,-1.5],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1",position:[0,0,0],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Apple",position:[365,382,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Onion",position:[1042,426,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-LG",position:[700,148,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-SM",position:[263,196,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Cat",position:[310,251,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Duck",position:[0,0,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}}]});var Yr={levelId:"LEVEL 1",music:"AO-Music",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1.1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:800,randomizeGroups:!0,groups:[{delay:800,items:["OB-Sock"],order:-1,followUps:[{delay:400,velocity:Pr.MEDIUM,offset:[0,0],items:["OB-Sock"]},{delay:800,velocity:Pr.HIGH,offset:[0,0],items:["OB-Sneaker"]},{delay:400,velocity:Pr.LOW,offset:[0,0],items:["OB-Sneaker"]}]},Nr({delay:1500,order:1,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({delay:1e3,order:2,items:["OB-SoftDrink"],amount:1,velocityArcs:Dr.LOW}),Nr({delay:1e3,order:2,items:["OB-SoftDrink"],amount:1,velocityArcs:Dr.HIGH}),Rr({delay:1500,order:2,mainItem:"OB-Sneaker",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:2,offsetXY:90}),Rr({delay:1500,order:2,mainItem:"OB-Sock",secondaryItem:"OB-Sock",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:60}),Nr({order:2,delay:1500,items:["OB-Duckling"],amount:2,velocityArcs:Dr.HIGH}),Rr({order:3,delay:2e3,mainItem:"OB-Sneaker",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:2,offsetXY:90}),Nr({order:3,delay:2e3,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({delay:1200,order:4,items:["OB-SoftDrink"],amount:1,velocityArcs:Dr.HIGH}),Nr({order:4,delay:1500,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Rr({delay:1500,order:4,mainItem:"OB-Sock",secondaryItem:"OB-Sock",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:60}),Rr({order:4,delay:2e3,mainItem:"OB-Sneaker",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:2,offsetXY:90}),Nr({delay:1800,order:5,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({delay:1200,order:6,items:["OB-SoftDrink"],amount:1,velocityArcs:Dr.HIGH})]},actors:[{cls:"Background-1-Sky-Night",position:[0,0,-2],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1-Sky-Day",position:[0,0,-1.5],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1",position:[0,0,0],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Apple",position:[365,382,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Onion",position:[1042,426,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-LG",position:[700,148,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-SM",position:[263,196,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Cat",position:[310,251,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Duck",position:[0,0,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}}]},Wr={levelId:"LEVEL 2",music:"AO-Music",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1.1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:1e3,randomizeGroups:!0,groups:[Nr({order:1,delay:800,items:["OB-Can-2","OB-Can"],amount:3,velocityArcs:Dr.LOW}),Rr({delay:800,order:1,mainItem:"OB-Can",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:70}),Nr({order:1,delay:500,items:["OB-Can","OB-Can-2"],amount:3,velocityArcs:Dr.HIGH}),Nr({order:1,delay:500,items:["OB-Boot"],lastItem:"OB-Duckling",amount:2,velocityArcs:Dr.MEDIUM}),Nr({order:1,delay:500,items:["OB-Duckling"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:1,delay:1e3,items:["OB-Duckling"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:1,delay:1500,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:1,delay:1e3,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Rr({delay:2e3,order:2,mainItem:"OB-Sneaker",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:100}),Nr({order:3,delay:1e3,items:["OB-CatThrone-LG"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:5,delay:800,items:["OB-Can-2","OB-Can"],amount:6,velocityArcs:Dr.LOW}),Rr({delay:800,order:2,mainItem:"OB-Can",velocityArcs:Dr.MEDIUM,amount:4,offsetXY:100}),Rr({delay:800,order:2,mainItem:"OB-Boot",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:70}),Nr({order:5,delay:800,items:["OB-Can-2","OB-Can-2"],amount:6,velocityArcs:Dr.HIGH}),Nr({order:5,delay:1200,items:["OB-Duckling"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:5,delay:1200,items:["OB-Duckling"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:5,delay:1200,items:["OB-Duckling"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:5,delay:1500,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:5,delay:1500,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:9,delay:2400,items:["OB-CatThrone-LG"],amount:1,velocityArcs:Dr.MEDIUM}),Rr({delay:1e3,order:10,mainItem:"OB-Sneaker",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:100})]},actors:[{cls:"Background-1-Sky-Night",position:[0,0,-2],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1-Sky-Day",position:[0,0,-1.5],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1",position:[0,0,0],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Apple",position:[365,382,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Onion",position:[1042,426,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-LG",position:[700,148,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-SM",position:[263,196,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Cat",position:[310,251,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Duck",position:[0,0,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}}]},zr={levelId:"LEVEL 3",music:"AO-Music",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1.1,gravity:1.05,speed:.06,playerHealth:5,firstThrowDelay:550,randomizeGroups:!0,groups:[{delay:700,items:["OB-Ball-Basket"],followUps:[{delay:450,items:["OB-Ball-CatToy"]},{delay:450,items:["OB-Ball-Basket"]},{delay:450,items:["OB-Ball-Kids"]}]},Rr({order:2,delay:1200,mainItem:"OB-Ball-Kids",velocityArcs:Dr.HIGH,amount:5,offsetXY:90}),Rr({delay:1200,order:2,mainItem:"OB-Ball-Soccer",velocityArcs:Dr.LOW,amount:3,offsetXY:90}),Nr({delay:1500,order:2,items:["OB-Ball-Soccer"],amount:5,velocityArcs:Dr.LOW}),Nr({delay:1e3,order:2,items:["OB-Ball-Soccer"],amount:5,velocityArcs:Dr.LOW}),Hr({delay:800,order:2,offsetXY:[0,20]}),Hr({delay:400,order:2,offsetXY:[0,20]}),Nr({delay:1200,order:2,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Rr({delay:1200,order:2,mainItem:"OB-Ball-Soccer",velocityArcs:Dr.LOW,amount:3,offsetXY:90}),Nr({delay:500,order:2,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Rr({order:5,delay:3e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Rr({order:12,delay:1500,mainItem:"OB-Ball-Kids",velocityArcs:Dr.HIGH,amount:3,offsetXY:90}),Rr({order:12,delay:1200,mainItem:"OB-Ball-Kids",velocityArcs:Dr.HIGH,amount:5,offsetXY:90}),Rr({delay:1200,order:12,mainItem:"OB-Ball-Basket",velocityArcs:Dr.LOW,amount:3,offsetXY:90}),Rr({delay:1200,order:12,mainItem:"OB-Ball-Basket",velocityArcs:Dr.LOW,amount:4,offsetXY:90}),Nr({delay:2e3,order:12,items:["OB-Ball-Soccer"],amount:3,velocityArcs:Dr.MEDIUM}),Nr({delay:2e3,order:12,items:["OB-Ball-Soccer"],amount:3,velocityArcs:Dr.MEDIUM}),Nr({delay:2e3,order:12,items:["OB-Ball-CatToy"],amount:5,velocityArcs:Dr.LOW}),Hr({delay:800,order:12,offsetXY:[0,20]}),Hr({delay:800,order:12,offsetXY:[0,20]}),Hr({delay:800,order:12,offsetXY:[0,20]}),Hr({delay:800,order:12,offsetXY:[0,20]}),Nr({delay:1500,order:12,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Nr({delay:1500,order:12,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Nr({delay:1500,order:12,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Rr({delay:1500,order:12,mainItem:"OB-Ball-Soccer",velocityArcs:Dr.LOW,amount:3,offsetXY:90}),Rr({order:15,delay:3e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Nr({order:15,delay:3e3,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Rr({order:15,delay:3e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Nr({order:15,delay:3e3,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM})]},actors:[{cls:"Background-1-Sky-Night",position:[0,0,-2],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1-Sky-Day",position:[0,0,-1.5],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1",position:[0,0,0],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Apple",position:[365,382,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Onion",position:[1042,426,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-LG",position:[700,148,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-SM",position:[263,196,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Cat",position:[310,251,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Duck",position:[0,0,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}}]},jr={levelId:"LEVEL 4",music:"AO-Music",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1.1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:800,randomizeGroups:!0,groups:[{delay:800,items:["OB-Sneaker"],order:-1,followUps:[{delay:500,velocity:Pr.MEDIUM,offset:[-300,200],items:["OB-PaperAirplane"]}]},Rr({order:1,delay:2e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Rr({order:1,delay:1200,mainItem:"OB-Sneaker",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:2,offsetXY:90}),Rr({order:1,delay:1200,mainItem:"OB-Sneaker",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:2,offsetXY:90}),Rr({order:1,delay:1500,mainItem:"OB-Sock",secondaryItem:"OB-Sock",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:60}),Nr({order:1,delay:500,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Nr({order:1,delay:1200,items:["OB-Duckling"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:1,delay:1200,items:["OB-CoffeeMug-Low"],amount:3,velocityArcs:Dr.MUG}),Nr({order:1,delay:1200,items:["OB-CoffeeMug-Low"],amount:3,velocityArcs:Dr.MUG}),Rr({order:1,delay:1200,mainItem:"OB-Recorder",velocityArcs:Dr.MEDIUM,amount:1}),Nr({order:7,delay:2e3,items:["OB-Katamari-B"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Rr({order:10,delay:2e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Rr({order:10,delay:2e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Rr({order:10,delay:1200,mainItem:"OB-Sneaker",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:4,offsetXY:90}),Rr({order:10,delay:1e3,mainItem:"OB-Sneaker",secondaryItem:"OB-Sock",velocityArcs:Dr.HIGH,amount:4,offsetXY:90}),Rr({order:10,delay:1200,mainItem:"OB-Sock",secondaryItem:"OB-Sock",velocityArcs:Dr.MEDIUM,amount:5,offsetXY:120}),Nr({order:10,delay:500,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Nr({order:10,delay:500,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Nr({order:10,delay:500,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Nr({order:10,delay:500,items:["OB-Duckling"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:10,delay:1200,items:["OB-CoffeeMug-Low"],amount:4,velocityArcs:Dr.MUG}),Nr({order:10,delay:1200,items:["OB-CoffeeMug-Low"],amount:4,velocityArcs:Dr.MUG}),Nr({order:10,delay:1200,items:["OB-CoffeeMug-Low"],amount:4,velocityArcs:Dr.MUG}),Nr({order:10,delay:1e3,items:["OB-Katamari-B"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:10,delay:1e3,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:10,delay:1e3,items:["OB-Katamari-B"],amount:1,velocityArcs:Dr.MEDIUM}),Rr({order:10,delay:500,mainItem:"OB-Recorder",velocityArcs:Dr.HIGH,amount:1}),Rr({order:10,delay:500,mainItem:"OB-Recorder",velocityArcs:Dr.LOW,amount:1}),Rr({order:11,delay:2e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:1,offsetXY:90})]},actors:[{cls:"Background-1-Sky-Night",position:[0,0,-2],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1-Sky-Day",position:[0,0,-1.5],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1",position:[0,0,0],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Apple",position:[365,382,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Onion",position:[1042,426,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-LG",position:[700,148,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-SM",position:[263,196,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Cat",position:[310,251,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Duck",position:[0,0,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}}]},Kr={levelId:"LEVEL 5",music:"AO-Music",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1.1,gravity:1.05,speed:.06,playerHealth:5,firstThrowDelay:550,randomizeGroups:!0,groups:[{delay:700,items:["OB-Duckling"],followUps:[]},Nr({delay:1e3,order:1,items:["OB-WaterBottle-A"],amount:3,velocityArcs:Dr.HIGH}),Nr({order:1,delay:1e3,items:["OB-WaterBottle-B"],amount:5,velocityArcs:Dr.LOW}),Nr({order:1,delay:600,items:["OB-WaterBottle-B"],amount:3,velocityArcs:Dr.HIGH}),Nr({order:1,delay:1e3,items:["OB-WaterBottle-A"],amount:5,velocityArcs:Dr.LOW}),Rr({order:1,delay:2e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:2,offsetXY:120}),Nr({order:1,delay:900,items:["OB-Milk"],amount:5,velocityArcs:Dr.MEDIUM}),Nr({order:1,delay:1e3,items:["OB-Milk"],amount:7,velocityArcs:Dr.MEDIUM}),Nr({order:1,delay:600,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Nr({order:1,delay:600,items:["OB-Duckling"],amount:1,velocityArcs:Dr.HIGH}),Nr({order:1,delay:1e3,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:1,delay:2e3,items:["OB-Katamari-B"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:1,delay:2e3,items:["OB-BreadSlice"],amount:3,velocityArcs:Dr.BREAD}),Nr({order:1,delay:2e3,items:["OB-BreadSlice-2"],amount:3,velocityArcs:Dr.BREAD}),Rr({order:1,delay:900,mainItem:"OB-Duckling",velocityArcs:Dr.MEDIUM,amount:6,offsetXY:100}),Hr({delay:500,order:1,offsetXY:[0,-50]}),Hr({delay:500,order:1,offsetXY:[0,-50]}),Hr({delay:500,order:1,offsetXY:[0,-50]}),Rr({order:4,delay:3e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Rr({order:5,delay:3e3,mainItem:"OB-DuffelBagFast",velocityArcs:Dr.HIGH,amount:2,offsetXY:120}),Hr({delay:600,order:5,offsetXY:[0,-50]}),Nr({order:5,delay:600,items:["OB-Duckling"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:5,delay:2e3,items:["OB-BreadSlice"],amount:3,velocityArcs:Dr.BREAD}),Nr({order:5,delay:2e3,items:["OB-BreadSlice-2"],amount:3,velocityArcs:Dr.BREAD}),Rr({order:6,delay:3e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:3,offsetXY:120}),Nr({delay:1e3,order:7,items:["OB-WaterBottle-A"],amount:3,velocityArcs:Dr.HIGH})]},actors:[{cls:"Background-1-Sky-Night",position:[0,0,-2],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1-Sky-Day",position:[0,0,-1.5],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1",position:[0,0,0],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Apple",position:[365,382,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Onion",position:[1042,426,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-LG",position:[700,148,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-SM",position:[263,196,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Cat",position:[310,251,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Duck",position:[0,0,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}}]},Zr={levelId:"LEVEL 6",music:"AO-Music",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1.1,gravity:1.05,speed:.06,playerHealth:5,firstThrowDelay:550,randomizeGroups:!0,groups:[{delay:700,items:["OB-Extinguisher-2"],followUps:[]},Hr({delay:800,order:2,offsetXY:[0,20]}),Hr({delay:1200,order:2,offsetXY:[0,-50]}),Rr({delay:800,order:1,mainItem:"OB-Hat-Grey",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:20}),Rr({delay:800,order:1,mainItem:"OB-Hat-Police",velocityArcs:Dr.HIGH,amount:1,offsetXY:20}),Rr({delay:800,order:1,mainItem:"OB-Hat-Cap",velocityArcs:Dr.HIGH,amount:1,offsetXY:20}),Nr({order:1,delay:1e3,items:["OB-CoffeeMug-Low"],amount:3,velocityArcs:Dr.MUG}),Nr({order:5,delay:3e3,items:["OB-Katamari-C"],amount:1,velocityArcs:Dr.MEDIUM}),Rr({delay:800,order:5,mainItem:"OB-Extinguisher-1",velocityArcs:Dr.HIGH,amount:3,offsetXY:20}),Rr({delay:800,order:5,mainItem:"OB-Hat-Brown",velocityArcs:Dr.HIGH,amount:4,offsetXY:20}),Rr({delay:800,order:5,mainItem:"OB-Hat-Apple",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:20}),Rr({delay:800,order:5,mainItem:"OB-Hat-Grey",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:20}),Rr({delay:800,order:5,mainItem:"OB-Hat-Police",velocityArcs:Dr.LOW,amount:1,offsetXY:20}),Rr({delay:800,order:5,mainItem:"OB-Hat-Cap",velocityArcs:Dr.HIGH,amount:1,offsetXY:20}),Nr({delay:3e3,items:["OB-Katamari-C"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({delay:1500,order:1,items:["OB-Duckling"],amount:1,velocityArcs:Dr.LOW}),Nr({delay:1500,order:5,items:["OB-Duckling"],amount:1,velocityArcs:Dr.LOW}),Hr({delay:800,order:6,offsetXY:[0,20]}),Hr({delay:1200,order:6,offsetXY:[0,-50]}),Nr({order:8,delay:1e3,items:["OB-CoffeeMug-Low"],amount:3,velocityArcs:Dr.MUG}),Rr({delay:1e3,order:8,mainItem:"OB-CoffeeMug",velocityArcs:Dr.MUG,amount:3}),Rr({delay:800,order:8,mainItem:"OB-Extinguisher-1",velocityArcs:Dr.HIGH,amount:3,offsetXY:20}),Nr({delay:1500,order:8,items:["OB-Duckling"],amount:1,velocityArcs:Dr.LOW}),Nr({delay:1500,order:8,items:["OB-Duckling"],amount:1,velocityArcs:Dr.LOW}),Rr({delay:800,order:8,mainItem:"OB-Hat-Brown",velocityArcs:Dr.LOW,amount:4,offsetXY:20}),Rr({delay:800,order:8,mainItem:"OB-Hat-Grey",velocityArcs:Dr.MEDIUM,amount:2,offsetXY:20}),Rr({delay:800,order:8,mainItem:"OB-Hat-Police",velocityArcs:Dr.HIGH,amount:1,offsetXY:20}),Rr({delay:800,order:8,mainItem:"OB-Hat-Cap",velocityArcs:Dr.HIGH,amount:1,offsetXY:20}),Nr({order:8,delay:2e3,items:["OB-Katamari-C"],amount:1,velocityArcs:Dr.MEDIUM}),Rr({delay:800,order:10,mainItem:"OB-Katamari-C",velocityArcs:Dr.MEDIUM,amount:1,offsetXY:20}),Rr({delay:800,order:10,mainItem:"OB-Extinguisher-1",velocityArcs:Dr.HIGH,amount:3,offsetXY:20}),Hr({delay:800,order:11,offsetXY:[0,20]})]},actors:[{cls:"Background-1-Sky-Night",position:[0,0,-2],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1-Sky-Day",position:[0,0,-1.5],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1",position:[0,0,0],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Apple",position:[365,382,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Onion",position:[1042,426,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-LG",position:[700,148,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-SM",position:[263,196,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Cat",position:[310,251,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Duck",position:[0,0,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}}]},Qr={levelId:"LEVEL 7",music:"AO-Music",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1.1,gravity:1.05,speed:.06,playerHealth:5,firstThrowDelay:550,randomizeGroups:!0,groups:[{delay:700,items:["OB-Katamari-B"],followUps:[]},Rr({delay:1e3,order:1,mainItem:"OB-Popsicle-A",followUpItem:"OB-Skateboard",velocityArcs:Dr.LOW,amount:1,offsetXY:20}),Rr({delay:1200,order:1,mainItem:"OB-Duckling",followUpItem:"OB-Skateboard",velocityArcs:Dr.MEDIUM,amount:1,offsetXY:90}),Rr({delay:1200,order:1,mainItem:"OB-Duckling",followUpItem:"OB-Skateboard",velocityArcs:Dr.MEDIUM,amount:1,offsetXY:90}),Rr({delay:1e3,order:1,mainItem:"OB-CatThrone-SM",followUpItem:"OB-Popsicle-B",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Nr({delay:1e3,order:1,items:["OB-Katamari-B"],amount:1,velocityArcs:Dr.MEDIUM}),Hr({delay:800,order:2,offsetXY:[0,20]}),Hr({delay:1200,order:2,offsetXY:[0,-50]}),Rr({delay:1e3,order:3,mainItem:"OB-Duckling",velocityArcs:Dr.MEDIUM,amount:3,offsetXY:120}),Rr({order:4,delay:3e3,mainItem:"OB-DuffelBag",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Nr({order:7,delay:800,items:["OB-Book","OB-Book-2"],amount:5,velocityArcs:Dr.LOW}),Nr({order:7,delay:800,items:["OB-Book","OB-Book-2"],amount:7,velocityArcs:Dr.LOW}),Nr({order:7,delay:1e3,items:["OB-Book","OB-Book-2"],amount:3,velocityArcs:Dr.LOW}),Nr({order:7,delay:1200,items:["OB-CoffeeMug-Low"],amount:3,velocityArcs:Dr.MUG}),Nr({order:7,delay:750,items:["OB-Popsicle-A"],lastItem:"OB-Duckling",amount:7,velocityArcs:Dr.MEDIUM}),Nr({order:7,delay:750,items:["OB-Popsicle-A"],lastItem:"OB-Duckling",amount:5,velocityArcs:Dr.MEDIUM}),Rr({delay:1e3,order:7,mainItem:"OB-Popsicle-A",followUpItem:"OB-Skateboard",velocityArcs:Dr.LOW,amount:1,offsetXY:20}),Rr({delay:1200,order:7,mainItem:"OB-Duckling",followUpItem:"OB-Skateboard",velocityArcs:Dr.MEDIUM,amount:1,offsetXY:90}),Rr({delay:1200,order:7,mainItem:"OB-Duckling",followUpItem:"OB-Skateboard",velocityArcs:Dr.MEDIUM,amount:1,offsetXY:90}),Rr({delay:1e3,order:7,mainItem:"OB-CatThrone-SM",followUpItem:"OB-Popsicle-B",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Nr({delay:2e3,order:7,items:["OB-Katamari-A"],amount:1,velocityArcs:Dr.MEDIUM}),Hr({delay:800,order:7,offsetXY:[0,20]}),Hr({delay:1200,order:7,offsetXY:[0,-50]}),Nr({delay:2e3,order:7,items:["OB-Katamari-B"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Nr({order:8,delay:800,items:["OB-PaperAirplane"],amount:1,velocityArcs:Dr.LOW}),Rr({delay:1e3,order:9,mainItem:"OB-Duckling",velocityArcs:Dr.MEDIUM,amount:4,offsetXY:120}),Rr({delay:1e3,order:9,mainItem:"OB-CatThrone-LG",followUpItem:"OB-Skateboard",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Rr({delay:1e3,order:9,mainItem:"OB-Skateboard",followUpItem:"OB-CatThrone-SM",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Rr({delay:900,order:9,mainItem:"OB-Duckling",velocityArcs:Dr.MEDIUM,amount:4,offsetXY:120}),Nr({delay:1e3,order:9,items:["OB-Katamari-B"],amount:1,velocityArcs:Dr.MEDIUM}),Hr({delay:800,order:11,offsetXY:[0,20]}),Hr({delay:1200,order:12,offsetXY:[0,-50]}),Hr({delay:1200,order:12,offsetXY:[0,-50]}),Rr({delay:900,order:12,mainItem:"OB-Duckling",velocityArcs:Dr.MEDIUM,amount:1,offsetXY:120}),Rr({delay:1e3,order:12,mainItem:"OB-CatThrone-LG",followUpItem:"OB-Skateboard",velocityArcs:Dr.HIGH,amount:1,offsetXY:90}),Rr({delay:1e3,order:12,mainItem:"OB-Skateboard",followUpItem:"OB-Skateboard",velocityArcs:Dr.HIGH,amount:2,offsetXY:90}),Nr({order:12,delay:1200,items:["OB-CoffeeMug-Low"],amount:3,velocityArcs:Dr.MUG}),Rr({delay:1e3,order:12,mainItem:"OB-Skateboard",followUpItem:"OB-CatThrone-LG",velocityArcs:Dr.HIGH,amount:3,offsetXY:90}),Rr({delay:900,order:12,mainItem:"OB-Duckling",velocityArcs:Dr.MEDIUM,amount:1,offsetXY:120}),Nr({delay:1e3,order:12,items:["OB-Skateboard"],amount:5,velocityArcs:Dr.MEDIUM}),Nr({delay:2e3,order:12,items:["OB-Katamari-B"],amount:1,velocityArcs:Dr.MEDIUM}),Nr({delay:2e3,order:12,items:["OB-Katamari-B"],amount:1,velocityArcs:Dr.MEDIUM}),Rr({order:14,delay:1e3,mainItem:"OB-DuffelBagFast",velocityArcs:Dr.HIGH,amount:2,offsetXY:120}),Hr({delay:1200,order:15,offsetXY:[0,-50]}),Hr({delay:1200,order:15,offsetXY:[0,-50]}),Hr({delay:1200,order:15,offsetXY:[0,-50]}),Hr({delay:1200,order:15,offsetXY:[0,-50]}),Rr({order:15,delay:1e3,mainItem:"OB-DuffelBagFast",velocityArcs:Dr.HIGH,amount:2,offsetXY:120})]},actors:[{cls:"Background-1-Sky-Night",position:[0,0,-2],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1-Sky-Day",position:[0,0,-1.5],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"Background-1",position:[0,0,0],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Apple",position:[365,382,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"CH-Onion",position:[1042,426,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-LG",position:[700,148,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Box-SM",position:[263,196,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Cat",position:[310,251,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}},{cls:"OB-Duck",position:[0,0,1],scale:[1,1,1],flipX:!1,flipY:!1,roll:0,state:"idle",data:{}}]},qr=function(e){function t(e){var r=e.width,o=void 0===r?128:r,n=e.height,i=void 0===n?128:n,l=e.gravityScale,d=void 0===l?2:l,u=e.restitution,p=void 0===u?.5:u,m=e.friction,f=void 0===m?.25:m,g=e.velocity,y=void 0===g?[0,0,0]:g,h=e.terminalVelocity,v=void 0===h?100:h,x=e.limitedToWorld,_=e.limitedToUpperBounds,b=e.collidable,S=e.solidBody,E=e.isSensor,A=e.bounds,T=void 0===A?{left:-Infinity,right:1/0,top:1/0,bottom:-Infinity}:A,k;return a(this,t),k=c(this,s(t).call(this)),k.gravityScale=d,k.terminalVelocity=v,k.velocity=y,k.collidable=void 0===b||b,k.restitution=p,k.friction=f,k.solidBody=void 0===S||S,k.isSensor=void 0!==E&&E,k.width=o,k.height=i,k.bottom=0,k.left=0,k.speed=1,k.bounds=T,k.limitedToWorld=void 0===x||x,k.transformPreviousFrame=null,k.parentEntity=null,k.limitedToUpperBounds=void 0===_||_,k}return i(t,e),n(t,[{key:"update",value:function(e,r,a){p(s(t.prototype),"update",this).apply(this,arguments),this.enabled&&(a.transformPreviousFrame={x:a.transform.x,y:a.transform.y,z:a.transform.z},this.parentEntity=a)}},{key:"applyForce",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this.velocity[0]+=e,this.velocity[1]+=t,this.velocity[2]+=r}},{key:"applyImpulse",value:function(){}},{key:"applyVelocity",value:function(e){ye(this.velocity[0])>this.terminalVelocity&&(this.velocity[0]=this.terminalVelocity*(0>this.velocity[0]?-1:1)),ye(this.velocity[1])>this.terminalVelocity&&(this.velocity[1]=this.terminalVelocity*(0>this.velocity[1]?-1:1)),ye(this.velocity[2])>this.terminalVelocity&&(this.velocity[2]=this.terminalVelocity*(0>this.velocity[2]?-1:1)),this.parentEntity&&(this.parentEntity.transform.x+=this.velocity[0]*e*this.speed,this.parentEntity.transform.y+=this.velocity[1]*e*this.speed,this.parentEntity.transform.z+=this.velocity[2]*e*this.speed)}},{key:"setVelocity",value:function(e,t,r){null==e&&(e=this.velocity[0]),null==t&&(t=this.velocity[1]),null==r&&(r=this.velocity[2]),this.velocity=[e,t,r]}},{key:"isSleeping",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5;return ye(this.velocity[0])<e&&ye(this.velocity[1])<e&&ye(this.velocity[2])<e}}]),t}(Pe),Jr=new Mr,$r=function(t){function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r;a(this,o),r=c(this,s(o).call(this)),e=o.extend({sprite:{src:"res/textures/ao-jp-0.json"},animations:{},states:{},audio:{},events:{},collidable:!0,opacity:1,spriteSpeed:125,pointerEvents:!0,draggable:!1,physics:!0,interactive:!0,gravityScale:2,restitution:.5,terminalVelocity:100,autoGroundLevel:!0,defaultState:"idle",limitedToWorld:!0,limitedToUpperBounds:!0,sortableY:!0,canHold:[],canUse:[],HSV:[0,0,0],scale:[1,1,1],state:null,flipX:!1,flipY:!1,isDraggable:void 0,hasPointerEvents:void 0,isPersistent:!0,position:[0,0,0],roll:0,velocity:[0,0,0],animationStartFrame:0,cls:"actor",data:{}},e),o.extend(e,t),r.constructorName="Actor",r.transform.xyz=g(e.position),r.interactive=e.interactive,r.pointerEvents=void 0===e.hasPointerEvents?e.pointerEvents:e.hasPointerEvents,r.draggable=void 0===e.isDraggable?e.draggable:e.isDraggable,r.physics=e.physics,r.gravityScale=e.gravityScale,r.restitution=e.restitution,r.data=JSON.parse(JSON.stringify(e.data)),r.isPersistent=e.isPersistent,r.physics&&(r.body=r.addComponent(new qr({gravityScale:e.gravityScale,restitution:e.restitution,terminalVelocity:e.terminalVelocity,collidable:e.collidable,limitedToWorld:e.limitedToWorld,limitedToUpperBounds:e.limitedToUpperBounds,velocity:e.velocity,isSensor:!0})),void 0!==r.data.speed&&(r.body.speed=r.data.speed)),r.className=e.cls,r.states=e.states,r._state=e.state||e.defaultState,r.audio=e.audio,r.isOnGround=!1,r.sortableY=e.sortableY,r.autoGroundLevel=e.autoGroundLevel,r.posMouseDownStart={x:0,y:0},r.zoom=1,r._zoom=1,r.holdZoom=0,r.spriteSpeed=e.spriteSpeed,r.velocityX=0,r.velocityY=0,r.opacity=e.opacity,e.sprite.flipX=e.flipX,e.sprite.flipY=e.flipY,Array.isArray(e.sprite.src)||"json"==e.sprite.src.split(".").pop()?r.loadTexturePacker(e.sprite,e.animations,e.scale):r.loadSprite(sprite,e.animations,e.scale);for(var n=0,i=Object.keys(e.events),l;n<i.length;n++)l=i[n],r[l]=e.events[l];return r.canHold=e.canHold,r.canUse=e.canUse,r.heldItems=[],r.parentItems=[],r.roll=e.roll?me/2:0,r.HSV=new Float32Array(3),r.HSV.set(e.HSV),r.transform.roll=e.roll,r.isReady=!1,r.animationStartFrame=e.animationStartFrame,r}return i(o,t),n(o,[{key:"state",get:function(){return this._state},set:function(e){var t=this._state;if(this._state=e,this.states[e]){if(this.sprite){if(!Array.isArray(this.states[e]))this.sprite.selectAnimation(this.states[e]);else{if("HIDDEN"===this.states[e][0])return void(this.sprite.visible=!1);this.sprite.visible=!0;var r=ue(Math.random()*this.states[e].length);this.sprite.selectAnimation(this.states[e][r])}this.sprite.currentAnimation.play()}e!==t&&this.onStateChange(e,t)}else console.warn("State '".concat(e,"' not found."),this)}}]),n(o,[{key:"render",value:function(){this.sprite&&(this.sprite.mesh.material.diffuseTexture=this.sprite.textures[this.sprite._materialIndex],p(s(o.prototype),"render",this).apply(this,arguments))}},{key:"update",value:function(){p(s(o.prototype),"update",this).apply(this,arguments),this.enabled&&this.sprite&&this.parentScene&&(this.onUpdate(),this.setPhysicsBody())}},{key:"onSpawn",value:function(){p(s(o.prototype),"onSpawn",this).apply(this,arguments),this.onReady()}},{key:"onReady",value:function(){return!!(this.sprite&&this.parentScene)&&void(this.setPhysicsBody(),this.setGroundLevel(0),this.sortComponentsByZ(!0),this.isReady=!0)}},{key:"setPhysicsBody",value:function(){if(this.physics&&this.body&&this.sprite){if(this.body.width=this.sprite.width*this.sprite.transform.sx,this.body.height=this.sprite.height*this.sprite.transform.sy,this.sprite.currentAnimation?(this.body.left=-this.body.width*this.sprite.currentAnimation.currentFrame.pivotX,this.body.bottom=-this.body.height*this.sprite.currentAnimation.currentFrame.pivotY):(this.body.left=-(this.body.width/2),this.body.bottom=-(this.body.height/2)),this.roll);this.prevBottom&&this.body.bottom!==this.prevBottom&&this.autoGroundLevel&&this.setGroundLevel(0),this.prevBottom=this.body.bottom}else this.sprite&&(this.width=this.sprite.width*this.sprite.transform.sx,this.height=this.sprite.height*this.sprite.transform.sy,this.sprite.currentAnimation?(this.left=-this.width*this.sprite.currentAnimation.currentFrame.pivotX,this.bottom=-this.height*this.sprite.currentAnimation.currentFrame.pivotY):(this.left=-(this.width/2),this.bottom=-(this.height/2)))}},{key:"loadSprite",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r=arguments,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=1<r.length&&void 0!==r[1]?r[1]:{},o=2<r.length&&void 0!==r[2]?r[2]:[1,1,1],this.sprite=new Ct(t),this.initSprite(this.sprite,a,o),this.addComponent(this.sprite,a,o),this.state=this._state,this.onReady();case 7:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadTexturePacker",value:function(){var e=r(regeneratorRuntime.mark(function e(t,r){var a=arguments,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=2<a.length&&void 0!==a[2]?a[2]:[1,1,1],Object.keys(game.spritesheets[t.src.split("/").pop()].animations).length&&(Ga=game.spritesheets[t.src.split("/").pop()].animations,game.spritesheets[t.src.split("/").pop()].animations={}),e.next=4,Ir.cloneSprite(game.spritesheets[t.src.split("/").pop()],!0);case 4:return this.sprite=e.sent,this.sprite.flipX=t.flipX,this.sprite.flipY=t.flipY,e.next=9,this.initSprite(this.sprite,r,o);case 9:this.addComponent(this.sprite,r,o),this.state=this._state,this.sprite.currentAnimation&&this.sprite.currentAnimation.setFrame(this.animationStartFrame),this.onReady();case 13:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"initSprite",value:function(){var e=r(regeneratorRuntime.mark(function e(t,r){var a=this,o=arguments,n,s,l,d,c,u,p,m,f,g,y,h,v,x,_,b,S,E,A,T;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=2<o.length&&void 0!==o[2]?o[2]:[1,1,1],t.transform.sxyz=[n[0]*game.SPRITE_SCALE,n[1]*game.SPRITE_SCALE,n[2]*game.SPRITE_SCALE],t.animations={},this.sprite.mesh.material=Jr,s=[],l=0,d=Object.values(this.states);case 6:if(!(l<d.length)){e.next=30;break}for(c=d[l],u=!0,p=!1,m=void 0,e.prev=11,f=c[Symbol.iterator]();!(u=(g=f.next()).done);u=!0)y=g.value,s.push(y.split("=")[0]);e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](11),p=!0,m=e.t0;case 19:e.prev=19,e.prev=20,u||null==f["return"]||f["return"]();case 22:if(e.prev=22,!p){e.next=25;break}throw m;case 25:return e.finish(22);case 26:return e.finish(19);case 27:l++,e.next=6;break;case 30:for(h=0,v=Object.keys(r);h<v.length;h++){for(b in x=v[h],_=Ga[x],r[x].timing)_.frames[b].speed=r[x].timing[b];void 0!==r[x].loop&&(_.loop=r[x].loop)}S=function(){var e=A[E],r=e.split("=")[0];if(0>s.indexOf(r))return"continue";var o=Ga[e];t.animations[r]=new Mt(o,t),o=t.animations[r];var n=!0,i=!1,l=void 0;try{for(var d=o.frames[Symbol.iterator](),c,u;!(n=(c=d.next()).done);n=!0)u=c.value,u.speed=a.spriteSpeed}catch(e){i=!0,l=e}finally{try{n||null==d["return"]||d["return"]()}finally{if(i)throw l}}var p=o.frames.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0});if(-1<e.indexOf("=")){var m=e.split("=")[1].split(",");isNaN(m[0])||(o.frames=[]);var f=!0,g=!1,y=void 0;try{for(var h=m[Symbol.iterator](),v,x;!(f=(v=h.next()).done);f=!0)(x=v.value,""!=x)&&function(){switch(x[0].toUpperCase()){case"E":case"S":o.loop=!1;break;case"P":var e=o.frames[o.frames.length-1],t=x.replace("P","").split("-");t[1]?e.onStart=function(){e.speed=1e3*(Math.random()*t[1]+t[0])}:e.speed=1e3*t[0];break;case"R":var r=x.replace("R","")-1;o.frames[o.frames.length-1].onComplete=function(){o.setFrame(r)};break;case"L":o.loop=!0;break;default:o.frames.push(Object.assign({},p[x-1]));}}()}catch(e){g=!0,y=e}finally{try{f||null==h["return"]||h["return"]()}finally{if(g)throw y}}}},E=0,A=Object.keys(Ga);case 33:if(!(E<A.length)){e.next=40;break}if(T=S(),"continue"!==T){e.next=37;break}return e.abrupt("continue",37);case 37:E++,e.next=33;break;case 40:case"end":return e.stop();}},e,this,[[11,15,19,27],[20,,22,26]])}));return function(){return e.apply(this,arguments)}}()},{key:"save",value:function(){return this.isPersistent?{cls:this.className,position:g(this.transform.xyz),scale:g(this.sprite.transform.sxyz),flipX:this.sprite.flipX,flipY:this.sprite.flipY,roll:this.roll,state:this.state,data:this.data}:void 0}},{key:"onStateChange",value:function(){}},{key:"setGroundLevel",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-100;this.body&&(this.body.bounds.bottom=pe(this.transform.y+this.body.bottom+e,this.parentScene.groundEndY))}},{key:"onUpdate",value:function(){}},{key:"onStartDrag",value:function(){this.isOnGround=!1}},{key:"onHitFloor",value:function(){this.isOnGround=!0}},{key:"onCollide",value:function(){}}],[{key:"extend",value:function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(r).forEach(function(a){"_id"===a||(Array.isArray(r[a])?t[a]=g(r[a]):null!==r[a]&&"object"===e(r[a])?(t[a]={},o.extend(t[a],r[a])):t[a]=r[a])}),t}}]),o}(Fe),ea=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Apple",e.body.gravityScale=0,e.body.isSensor=!0,e.body.bottom=-170,e.body.height=62,e.body.left=-176,e.body.width=280,e.isShaking=!1,e}return i(t,e),n(t,[{key:"setPhysicsBody",value:function(){}},{key:"onReady",value:function(){if(!1===p(s(t.prototype),"onReady",this).call(this))return!1;this.dance=this.parentScene.addActor({cls:"CH-"+this.constructorName+"-Dance",position:[0,0,0],scale:[1,1,1]},!1),this.dance.visible=!1,this.addComponent(this.dance);var e="Apple"===this.constructorName?-200:137;this.blanket=this.parentScene.addActor({cls:"CH-"+this.constructorName+"-Blanket",position:[this.transform.x+e,this.transform.y+180,2],scale:[1,1,1]},!0),this.blanket.visible=!1}},{key:"setPhysicsBody",value:function(){}},{key:"dance",value:function(){this.state="Empty",this.dance.visible=!0}},{key:"wakeup",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"DB";this.state="wakeup",this.dance.visible=!1,this.blanket.visible=!1,this.sprite.currentAnimation.frames[8].onStart=function(){e.flingJunk&&e.flingJunk()},this.sprite.currentAnimation.frames[10].onStart=function(){e.state="empty-bed",e.dance.visible=!0,e.dance.state=t,e.blanket.visible=!0,e.blanket.state="fall",e.parentScene.sortEntitiesByZ(!0)}}},{key:"shakeBed",value:function(){var e=this;this.isShaking||(this.isShaking=!0,this.setTween({propParent:this.sprite.transform,property:"y",to:-10,from:0,method:"easeIn",duration:100,onComplete:function(){e.setTween({propParent:e.sprite.transform,property:"y",to:15,from:-10,method:"easeIn",duration:100,onComplete:function(){e.setTween({propParent:e.sprite.transform,property:"y",to:0,from:15,method:"easeIn",duration:100,onComplete:function(){e.isShaking=!1}})}})}}))}}]),t}($r),ta=[20,.5,0],ra=5,aa=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Junk",e.selected=!1,e.missed=!1,e.collected=!1,e.isRain=!1,e.rotationSpeed=0,e}return i(t,e),n(t,[{key:"onReady",value:function(){return!1!==p(s(t.prototype),"onReady",this).call(this)&&void(this.defaultHSV=g(this.HSV),this.selectedHSV=[].concat(ta),this.isRain&&(this.body.limitedToWorld=!1,this.body.bounds.bottom=-500,this.kata.data.junkGravityScale&&(this.body.gravityScale=this.kata.data.junkGravityScale)))}},{key:"onUpdate",value:function(){this.pointerEvents&&this.parentScene.mouseState.buttons[0]&&(this.body?this.boxCollision(this.transform.x+this.body.left,this.transform.y+this.body.bottom,this.body.width,this.body.height,this.parentScene.mouseState.position.x-ra,this.parentScene.mouseState.position.y-ra,ra,ra)&&this.select():this.boxCollision(this.transform.x+this.left,this.transform.y+this.bottom,this.width,this.height,this.parentScene.mouseState.position.x-ra,this.parentScene.mouseState.position.y-ra,ra,ra)&&this.select()),this.isRain&&!this.isHit&&(this.body.velocity[1]=-50),-200>this.transform.y&&this.onMissed(),!this.isRain&&this.body&&this.body.isSleeping(.1)?!this.missed&&(this.enabled=!1,this.missed=!0,this.unselect()):this.transform.roll+=this.rotationSpeed}},{key:"onSelected",value:function(){var e=this.parentScene.getItemsByClass("Box")[0];this.rotationSpeed=(this.data.rotation.min+Math.random()*(this.data.rotation.max-this.data.rotation.min))*(.5<Math.random()?1:-1),this.collected=!0,this.sendToBox(e)}},{key:"onMissed",value:function(){this.parentScene.removeActor(this),this.parentScene.addMissedItem(this,!1)}},{key:"onCollide",value:function(){}},{key:"onMouseOver",value:function(){this.select()}},{key:"select",value:function(){this.collected||this.missed||this.parentScene.isGameover||(this.selected=!0,this.parentScene.selectedObjects.push(this),this.onSelected())}},{key:"unselect",value:function(){this.selected=!1,this.HSV.set(this.defaultHSV)}},{key:"boxCollision",value:function(e,t,r,a,o,n,i,s){return!(t+a<=n||t>=n+s||e>=o+i||e+r<=o)}},{key:"newCombo",value:function(){var e={count:1,type:this.data.category?this.data.category:this.className};this.parentScene.currentCombo=e}},{key:"sendToBox",value:function(e){var t=this;this.body&&(this.body.enabled=!1),this.unselect();this.data.category?this.data.category:this.className;this.parentScene.currentCombo?(this.parentScene.currentCombo.count++,game.playSFX("AO-OB-select")):(this.newCombo(e),game.playSFX("AO-OB-selectEnd")),"PaperAirplane"!==this.constructorName&&this.parentScene.showScore("x"+this.parentScene.currentCombo.count,this,.5,[this.parentScene.currentCombo.count/12,0,0],1.5),this.parentScene.currentCombo.prevItem=this,this.parentScene.combo=this.parentScene.currentCombo.count;var r=this.parentScene.currentCombo.count;this.setTween({propParent:this.transform,property:"x",method:"easeIn",to:e.transform.x,from:this.transform.x,duration:Ba.meta.itemZoomToBoxDuration,onComplete:function(){var a=t.data.value*r,o=0<=a?"+":"";t.parentScene.showScore(o+a,e,.5+r/50/2,[r/100,0,0]),t.parentScene.score+=a,e.addItem(t)}}),this.setTween({propParent:this.transform,property:"y",method:"easeIn",to:e.transform.y,from:this.transform.y,duration:Ba.meta.itemZoomToBoxDuration})}}]),t}($r),oa=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Kata",e}return i(t,e),n(t,[{key:"onReady",value:function(){return!1!==p(s(t.prototype),"onReady",this).apply(this,arguments)&&void(void 0===this.data.junkCount&&(this.data.junkCount=10),void 0===this.data.junkClasses&&(this.data.junkClasses=["OB-Sock"]),"Kata"===this.constructorName&&this.onSelected())}},{key:"onSelected",value:function(){var e=this;this.collected||(this.collected=!0,this.body.enabled=!1,this.setTween({propParent:this.transform,property:"y",from:this.transform.y,to:this.parentScene.height+100,method:"easeIn",duration:1500,onComplete:function(){e.rainItems(),e.setTimeout(function(){e.parentScene.removeActor(e)},500)}}))}},{key:"rainItems",value:function(){for(var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=0,r=0;r<this.data.junkCount;r++){var a=100*Math.random(),o=.1,n=Math.random()*(this.parentScene.width-this.parentScene.width*(2*o))+this.parentScene.width*o,s=this.parentScene.height+t+a,l=this.parentScene.addActor({cls:this.data.junkClasses[oe(Math.random()*(this.data.junkClasses.length-1))],position:[n,s,50],isPersistent:!1,collidable:e},!0);l.body.limitedToWorld=!1,l.body.bounds.bottom=100*Math.random(),l.isRain=!0,l.kata=this,t+=a}}}]),t}(aa),na=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="AppleBonus",e.collected=!0,e}return i(t,e),n(t,[{key:"onReady",value:function(){var e=this;return void 0===this.data.junkCount&&(this.data.junkCount=100),void 0===this.data.junkClasses&&(this.data.junkClasses=["OB-WaterBottle-Bonus"]),!1!==p(s(t.prototype),"onReady",this).call(this)&&void(this.state="toss",this.sprite.currentAnimation.frames[30].onStart=function(){var t=e.parentScene.addActor({cls:"OB-WaterBottle-Bonus",position:[e.transform.x,e.transform.y+200,e.transform.z],isPersistent:!1,collidable:!1,pointerEvents:!1},!0);t.setTween({propParent:t.transform,property:"y",from:t.transform.y,to:1e3,duration:500,onComplete:function(){e.parentScene.removeActor(t),e.setTimeout(function(){e.rainItems(!1),e.setTimeout(function(){e.parentScene.junkComplete()},7e3)},1e3)}})},this.sprite.currentAnimation.callback=function(){e.state="idle"})}},{key:"onUpdate",value:function(){if(p(s(t.prototype),"onUpdate",this).apply(this,arguments),"idle"===this.state){var e=function(e,t,r,a){var o=re(a-t,r-e);return o*=180/me,o};this.sprite.currentAnimation.pause(!0);var r=this.sprite.currentAnimation.frames.length,a=e(this.parentScene.mouseState.position.x,this.parentScene.mouseState.position.y,this.transform.x,this.transform.y),o=ue(a/(360/r))+r/2;this.sprite.currentAnimation.setFrame(o)}}}]),t}(oa),ia=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Box",e}return i(t,e),n(t,[{key:"onReady",value:function(){return!1!==p(s(t.prototype),"onReady",this).call(this)&&void(this.intiialScale=1*this.sprite.transform.sx)}},{key:"addItem",value:function(e){var t=this;this.parentScene.removeActor(e),this.tX=this.setTween({propParent:this.sprite.transform,property:"sx",to:1.25*this.intiialScale,from:this.intiialScale,duration:100,onUpdate:function(){t.sprite.transform.sy=t.sprite.transform.sx},onComplete:function(){t.tX=t.setTween({propParent:t.sprite.transform,property:"sx",to:t.intiialScale,from:1.25*t.intiialScale,duration:100,onUpdate:function(){t.sprite.transform.sy=t.sprite.transform.sx}})}})}},{key:"close",value:function(){var e=this;this.setTimeout(function(){e.state="close",e.sprite.currentAnimation.callback=function(){e.parentScene.addActor({cls:"FX-BoxDust",position:[e.transform.x,e.transform.y,e.transform.z]},!0)},e.setTimeout(function(){e.parentScene.score+=Ba.meta.allItemsCaughtBonus,e.parentScene.showScore(Ba.meta.allItemsCaughtBonus,e,1.5,[.87,.2,0]),game.playSFX("SO-Box100")},1e3)},500)}}]),t}($r),sa=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Toast",e}return i(t,e),n(t,[{key:"select",value:function(){}},{key:"onSelected",value:function(){}},{key:"onMouseDown",value:function(){this.use()}},{key:"use",value:function(){var e=this,t=this.parentScene.getItemsByClass("OB-Duck")[0];if(t){var r={x:1200,y:450};this.enabled=!1;this.rotationSpeed=-.1,this.setTween({propParent:this.transform,property:"x",method:"easeIn",to:r.x,from:this.transform.x,duration:1000,onComplete:function(){t.state="idle";var r=e.parentScene.getItemsByClass("OB-Duckling");r.forEach(function(t){return e.parentScene.removeActor(t)}),e.parentScene.removeActor(e)}}),this.setTween({propParent:this.transform,property:"y",method:"easeIn",to:r.y,from:this.transform.y,duration:1000})}}}]),t}(aa),la=new Mr,da=[],ca=function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.glyphSpriteSheet,o=e.glyphAnimation,n=void 0===o?"":o,i=e.glyphCharacters,l=void 0===i?"":i,d=e.text,u=void 0===d?"":d,p=e.align,m=void 0===p?"left":p,f=e.alignVertical,g=void 0===f?"middle":f,y=e.tracking,h=void 0===y?4:y,v=e.HSV,x=void 0===v?[0,0,0]:v,_=e.pointerEvents,b;return a(this,t),b=c(this,s(t).apply(this,arguments)),b.glyphSpriteSheet=r,b.glyphAnimation=n,b.glyphCharacters=l,b.sprites=[],b.characters=[],b.width=0,b.height=0,b.align=m,b.alignVertical=g,b.tracking=h,b.value=u,b.HSV=x,b}return i(t,e),n(t,[{key:"value",get:function(){return this.characters.join("")},set:function(e){e.toString()===this.characters.join("")||(this.characters=e.toString().split(""),this.buildSprites())}}]),n(t,[{key:"newSprite",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!da[0]){e.next=4;break}t=da.pop(),e.next=7;break;case 4:return e.next=6,Ir.cloneSprite(this.glyphSpriteSheet,!0);case 6:t=e.sent;case 7:return t.mesh.material=la,e.abrupt("return",t);case 9:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"buildSprites",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r,a,o,n,s,l,d,c,u,p,m,f,g,y,h,v,x,_,b,S,E,A,T,k,B,O,w;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.width=0,this.height=0,t=this.characters.length-this.sprites.length;case 3:if(!(0<t)){e.next=12;break}return e.next=6,this.newSprite();case 6:r=e.sent,this.addComponent(r),this.sprites.push(r);case 9:t--,e.next=3;break;case 12:for(a=this.sprites.length-this.characters.length;0<a;a--)this.removeComponent(this.sprites[a]),da.push(this.sprites[a]),this.sprites.splice(a,1);for(o in this.characters)n=this.sprites[o],n.transform.x=this.width,n.selectAnimation(this.glyphAnimation,this.glyphCharacters.indexOf(this.characters[o])),this.width+=n.currentAnimation.currentFrame.width+this.tracking,this.height=ne(this.height,n.currentAnimation.currentFrame.height);this.width-=this.tracking,e.t0=this.align,e.next="center"===e.t0?18:"right"===e.t0?38:58;break;case 18:for(s=!0,l=!1,d=void 0,e.prev=21,c=this.sprites[Symbol.iterator]();!(s=(u=c.next()).done);s=!0)p=u.value,p.transform.x+=-this.width/2;e.next=29;break;case 25:e.prev=25,e.t1=e["catch"](21),l=!0,d=e.t1;case 29:e.prev=29,e.prev=30,s||null==c["return"]||c["return"]();case 32:if(e.prev=32,!l){e.next=35;break}throw d;case 35:return e.finish(32);case 36:return e.finish(29);case 37:return e.abrupt("break",58);case 38:for(m=!0,f=!1,g=void 0,e.prev=41,y=this.sprites[Symbol.iterator]();!(m=(h=y.next()).done);m=!0)v=h.value,v.transform.x+=-this.width;e.next=49;break;case 45:e.prev=45,e.t2=e["catch"](41),f=!0,g=e.t2;case 49:e.prev=49,e.prev=50,m||null==y["return"]||y["return"]();case 52:if(e.prev=52,!f){e.next=55;break}throw g;case 55:return e.finish(52);case 56:return e.finish(49);case 57:return e.abrupt("break",58);case 58:e.t3=this.alignVertical,e.next="bottom"===e.t3?61:81;break;case 61:for(x=!0,_=!1,b=void 0,e.prev=64,S=this.sprites[Symbol.iterator]();!(x=(E=S.next()).done);x=!0)E.value;e.next=72;break;case 68:e.prev=68,e.t4=e["catch"](64),_=!0,b=e.t4;case 72:e.prev=72,e.prev=73,x||null==S["return"]||S["return"]();case 75:if(e.prev=75,!_){e.next=78;break}throw b;case 78:return e.finish(75);case 79:return e.finish(72);case 80:return e.abrupt("break",101);case 81:for(A=!0,T=!1,k=void 0,e.prev=84,B=this.sprites[Symbol.iterator]();!(A=(O=B.next()).done);A=!0)w=O.value,w.transform.y+=this.height+w.currentAnimation.currentFrame.offsetY;e.next=92;break;case 88:e.prev=88,e.t5=e["catch"](84),T=!0,k=e.t5;case 92:e.prev=92,e.prev=93,A||null==B["return"]||B["return"]();case 95:if(e.prev=95,!T){e.next=98;break}throw k;case 98:return e.finish(95);case 99:return e.finish(92);case 100:return e.abrupt("break",101);case 101:case"end":return e.stop();}},e,this,[[21,25,29,37],[30,,32,36],[41,45,49,57],[50,,52,56],[64,68,72,80],[73,,75,79],[84,88,92,100],[93,,95,99]])}));return function(){return e.apply(this,arguments)}}()}]),t}(Fe),ua=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Calendar",e}return i(t,e),n(t,[{key:"onReady",value:function(){var e=this;return!1!==p(s(t.prototype),"onReady",this).call(this)&&void(this.flip=this.parentScene.addActor({cls:"UI-Calendar-Flip",position:[0,0,2],scale:this.sprite.transform.sxyz},!1),this.addComponent(this.flip),this.txtDate=new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"Calendar",glyphCharacters:"0123456789",text:ne(this.parentScene.dayCount-1,1),align:"center",alignVertical:"bottom",tracking:-1,transform:new Dt({position:[0,-30*this.sprite.transform.sy,.1],scale:this.sprite.transform.sxyz})}),this.addComponent(this.txtDate),this.flyIn(),1<this.parentScene.dayCount?this.setTimeout(function(){e.pageFlip()},1e3):this.setTimeout(function(){e.flyAway()},2e3))}},{key:"flyIn",value:function(){var e=this;this.state="blur",this.setTween({propParent:this.transform,property:"x",to:this.transform.x,from:1300,duration:150,method:"easeIn",onComplete:function(){e.state="idle"}}),this.setTween({propParent:this,property:"opacity",to:1,from:0,method:"easeIn",duration:150})}},{key:"flyAway",value:function(){var e=this;this.state="blur",this.setTween({propParent:this.transform,property:"x",to:-100,from:this.transform.x,duration:150,method:"easeIn",onComplete:function(){e.parentScene.remove(e)}}),this.setTween({propParent:this,property:"opacity",to:0,from:1,method:"easeIn",duration:150})}},{key:"pageFlip",value:function(){var e=this;game.playSFX("OB-Cal-Flip"),this.flip.state="flip",this.flip.sprite.currentAnimation.frames[2].onStart=function(){e.txtDate.value=e.parentScene.dayCount},this.flip.sprite.currentAnimation.callback=function(){e.flip.visible=!1,e.setTimeout(function(){e.flyAway()},200)}}}]),t}($r),pa=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="CalendarMini",e}return i(t,e),n(t,[{key:"onReady",value:function(){var e=this;return!1!==p(s(t.prototype),"onReady",this).call(this)&&void this.setTimeout(function(){e.txtDate.value=e.parentScene.dayCount},32)}},{key:"flyIn",value:function(){}},{key:"flyAway",value:function(){}},{key:"pageFlip",value:function(){}}]),t}(ua),ma=0,fa=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Cat",e.junkGroups=[],e.pending=0,e}return i(t,e),n(t,[{key:"onReady",value:function(){return!1!==p(s(t.prototype),"onReady",this).call(this)&&void(this.getNewJunkGroups(),this.state="enter",this.sprite.currentAnimation.pause())}},{key:"onUpdate",value:function(){p(s(t.prototype),"onUpdate",this).apply(this,arguments),this.junkGroups.length||this.pending||this.parentScene.junkComplete()}},{key:"enterRoom",value:function(){var e=this;this.state="enter",this.visible=!0,this.sprite.currentAnimation.callback=function(){e.state="idle",e.setTimeout(function(){e.spawnJunk()},e.parentScene.layout.config.firstThrowDelay)},game.playSFX(["0149","0340","0921"][0|3*Math.random()])}},{key:"getNewJunkGroups",value:function(){if(this.junkGroups=JSON.parse(JSON.stringify(this.parentScene.layout.config.groups)),this.junkGroups.sort(function(e,t){return(e.order||0)-(t.order||0)}),1>this.parentScene.week){var e=!0,t=!1,r=void 0;try{for(var a=this.junkGroups[Symbol.iterator](),o,n;!(e=(o=a.next()).done);e=!0)n=o.value,this.filterGroup(n)&&this.junkGroups.splice(this.junkGroups.indexOf(n),1)}catch(e){t=!0,r=e}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}}var i=this.junkGroups[0];this.parentScene.layout.config.randomizeGroups&&this.parentScene.randomizeList(this.junkGroups),this.junkGroups.sort(function(e,t){return e===i?-1:(e.order||0)-(t.order||0)})}},{key:"filterGroup",value:function(e){for(var t=["OB-Duckling","OB-Eagle"],r=e.items.length;0<=r;r--)0<=t.indexOf(e.items[r])&&e.items.splice(r,1);if(e.followUps){var a=!0,o=!1,n=void 0;try{for(var s=e.followUps[Symbol.iterator](),l,d;!(a=(l=s.next()).done);a=!0)d=l.value,this.filterGroup(d)||e.followUps.splice(e.followUps.indexOf(d),1)}catch(e){o=!0,n=e}finally{try{a||null==s["return"]||s["return"]()}finally{if(o)throw n}}}var c=0===e.items.length&&(!e.followUps||!e.followUps.length);return c}},{key:"spawnJunk",value:function(){var e=this;if(!(this.parentScene.isGameover||this.parentScene.isJunkComplete||this.parentScene.isLevelComplete||!this.junkGroups[0])){var t=this.junkGroups[0];this.junkGroups.shift(),this.pending++,this.setTimeout(function(){e.pending--,e.throwGroup(t),t.followUps&&function(){var r=0,a=t.followUps.length,o=!0,n=!1,i=void 0;try{for(var s=function(){var t=d.value;r+=t.delay,e.setTimeout(function(){e.throwGroup(t),a--,a||e.spawnJunk()},r)},l=t.followUps[Symbol.iterator](),d;!(o=(d=l.next()).done);o=!0)s()}catch(e){n=!0,i=e}finally{try{o||null==l["return"]||l["return"]()}finally{if(n)throw i}}}(),t.followUps&&t.followUps.length||e.spawnJunk()},t.delay)}}},{key:"throwGroup",value:function(e){var t=this;this.parentScene.isGameover||this.parentScene.isLevelComplete||(this.state="idle",this.state="fast",this.pending++,this.setTimeout(function(){t.pending--;for(var r=0;r<e.items.length;r++){if(null==t.parentScene.CONFIG.classes[e.items[r]])return void console.log("not found:"+e.items[r]);var a=t.parentScene.CONFIG.classes[e.items[r]].data,o=e.velocity||a.velocity||{x:{min:0,max:0},y:{min:0,max:0}},n=e.offset||[0,0];o instanceof Array&&(o=o[0|Math.random()*o.length]),t.parentScene.addActor({cls:e.items[r],position:[t.transform.x+n[0],t.transform.y+n[1],3+ma/1e3],velocity:[o.x.min+Math.random()*(o.x.max-o.x.min),o.y.min+Math.random()*(o.y.max-o.y.min),0],isPersistent:!1},!0),ma++}t.parentScene.sortEntitiesByZ(!0)},100))}}]),t}($r),ga=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Duck",e}return i(t,e),t}($r),ya=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Duckling",e}return i(t,e),n(t,[{key:"onReady",value:function(){var e=this;return!1!==p(s(t.prototype),"onReady",this).call(this)&&(1>this.parentScene.week?this.parentScene.removeActor(this,!0):void(this.selectedHSV=[0,0,0],game.playSFX("AO-10-Duck-05-duckling"),this.enabled=!1,this.visible=!1,this.parentScene.setTimeout(function(){e.enabled=!0,e.visible=!0},500)))}},{key:"onSelected",value:function(){if(!(this.collected||this.parentScene.isGameOver||this.parentScene.isLevelComplete)){this.collected=!0,this.dropFeathers();var e=this.parentScene.getItemsByClass("CH-Onion")[0];e.shakeBed();var t=this.parentScene.getItemsByClass("Duck")[0];this.parentScene.health-=this.data.damage,t.state="quack",game.playSFX("AO-10-Duck-07-C"),this.parentScene.addActor({cls:"FX-Hit",position:[this.transform.x,this.transform.y,this.transform.z]},!0),game.playSFX("AO-10-Duck-05-duckling")}}},{key:"onUpdate",value:function(){p(s(t.prototype),"onUpdate",this).apply(this,arguments),1222>this.transform.x&&(this.transform.z=50),1222<this.transform.x&&445<this.transform.y&&500>this.transform.y&&(this.transform.z=-1,this.sortableY=!1,this.parentScene.sortEntitiesByZ(!0)),1522<this.transform.x&&this.parentScene.removeActor(this)}},{key:"dropFeathers",value:function(){var e=this,t=this.parentScene.addActor({cls:"FX-Feather",position:[this.transform.x,this.transform.y,this.transform.z],scale:[1,1,1]},!0);t.setTimeout(function(){e.parentScene.removeActor(t)},2500)}}]),t}(aa),ha=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Duffel",e}return i(t,e),n(t,[{key:"onReady",value:function(){!1===p(s(t.prototype),"onReady",this).apply(this,arguments)||(void 0===this.data.junkCount&&(this.data.junkCount=10),void 0===this.data.junkClasses&&(this.data.junkClasses=["OB-Sock"]))}},{key:"onSelected",value:function(){this.collected||(p(s(t.prototype),"onSelected",this).apply(this,arguments),this.throwJunk())}},{key:"throwJunk",value:function(){for(var e=this,t=function(){var t=e.parentScene.addActor({cls:e.data.junkClasses[oe(Math.random()*(e.data.junkClasses.length-1))],position:g(e.transform.xyz),velocity:[80*Math.random()-40,40*Math.random(),0],isPersistent:!1},!0);t.pointerEvents=!1,e.setTimeout(function(){for(t.pointerEvents=!0;t.body.isSleeping();)t.body.velocity[0]=80*Math.random()-40,t.body.velocity[1]=40*Math.random()},200)},r=0;r<this.data.junkCount;r++)t(r)}}]),t}(aa),va=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="PaperAirplane",e.twnX=null,e.twnY=null,e.modLoop=null,e.zPos=0,e}return i(t,e),n(t,[{key:"onReady",value:function(){var e=this;return!1!==p(s(t.prototype),"onReady",this).call(this)&&void(this.zPos=this.transform.z,this.twnX=this.setTween({propParent:this.transform,property:"x",from:0,to:this.parentScene.width,duration:this.data.flightDuration,onComplete:function(){e.parentScene.removeActor(e)}}),this.twnY=this.setTween({propParent:this.transform,property:"y",from:470,to:470,duration:this.data.flightDuration}),this.data.loopDeLoopInterval&&this.setTimeout(function(){e.doLoop()},this.data.loopDeLoopInterval))}},{key:"doLoop",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.data.loopDeLoopDuration,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.data.loopDeLoopRadius;this.twnX.enabled=!1,this.twnY.enabled=!1;var a=this.transform.x,o=this.transform.y+r;this.modLoop=this.setModulate(function(t,n,i){return e.collected?e.removeComponent(e.modLoop):void(e.transform.x=a+fe(-(n-.5)*(2*me))*r,e.transform.y=o+ge((n-.5)*(2*me))*r,e.transform.roll=n*(2*me),1<=i&&(e.twnX.enabled=!0,e.twnY.enabled=!0,e.transform.roll=0,e.removeComponent(e.modLoop),e.setTimeout(function(){e.doLoop()},e.data.loopDeLoopInterval)))},t)}},{key:"onUpdate",value:function(){if(p(s(t.prototype),"onUpdate",this).apply(this,arguments),!(1222<this.transform.x||130>this.transform.x))this.transform.z=this.zPos,this.sortableY=!1,this.parentScene.sortEntitiesByZ(!0);else if(this.transform.z=-1,this.sortableY=!1,this.parentScene.sortEntitiesByZ(!0),1222<this.transform.x&&!this.collected&&"PaperAirplane"===this.constructorName){this.collected=!0;var e=this.data.missValue;this.parentScene.score+=e,this.parentScene.showScore("+"+e,this,1,[0,0,0],1,[-120,0,0])}}},{key:"onSelected",value:function(){p(s(t.prototype),"onSelected",this).apply(this,arguments),this.state="crumpled",this.parentScene.currentCombo=null,game.playSFX("SO-PaperAirplane-X")}}]),t}(aa),xa=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Eagle",e}return i(t,e),n(t,[{key:"onReady",value:function(){var e=this;return!1!==p(s(t.prototype),"onReady",this).call(this)&&(1>this.parentScene.week?this.parentScene.removeActor(this,!0):void(this.selectedHSV=[0,0,0],game.playSFX("SO-eagle-B"),this.enabled=!1,this.visible=!1,this.parentScene.setTimeout(function(){e.enabled=!0,e.visible=!0},500)))}},{key:"dropFeathers",value:function(){var e=this,t=this.parentScene.addActor({cls:"FX-Feather",position:[this.transform.x,this.transform.y,this.transform.z],scale:[1,1,1],isPersistent:!1},!0);t.HSV.set([.77,-.85,-.53]),t.setTimeout(function(){e.parentScene.removeActor(t)},2500)}},{key:"onSelected",value:function(){if(!this.collected){this.collected=!0,game.playSFX("SO-Eagle-Hit"),this.dropFeathers(),this.parentScene.health-=this.data.damage;var e=this.parentScene.getItemsByClass("CH-Onion")[0];e.shakeBed(),this.parentScene.addActor({cls:"FX-Hit",position:[this.transform.x,this.transform.y,this.transform.z]},!0)}}}]),t}(va),_a=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="FaceTransition",e}return i(t,e),n(t,[{key:"onReady",value:function(){return!1!==p(s(t.prototype),"onReady",this).apply(this,arguments)&&void this.show()}},{key:"show",value:function(){var e=this;this.state="show",this.sprite.currentAnimation.callback=function(){e.state="idle"}}}]),t}($r),ba=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="FX",e}return i(t,e),n(t,[{key:"onReady",value:function(){var e=this;!1==!p(s(t.prototype),"onReady",this).apply(this,arguments)||(this.sprite&&!this.sprite.currentAnimation.callback&&(this.sprite.currentAnimation.callback=function(){e.parentScene.removeActor(e,!0)}),this.body&&(this.body.limitedToWorld=!1),this.sortableY=!1,this.isDraggable=!1)}},{key:"save",value:function(){return null}}]),t}($r),Sa=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Instructions",e}return i(t,e),n(t,[{key:"onReady",value:function(){return!1!==p(s(t.prototype),"onReady",this).call(this)&&void(this.flyIn(),this.button=new $r(Ba.classes["TC-Button"],{position:[-600,-345,1]}),this.addComponent(this.button),this.setInterval(function(){game.playSFX(["0259","0447","0514","0618","0306"][0|5*Math.random()])},2e4))}},{key:"flyIn",value:function(){var e=this;this.setTween({propParent:this.transform,property:"x",to:this.transform.x,from:1e3,duration:150,method:"easeIn",onComplete:function(){e.state="idle"}}),this.setTween({propParent:this,property:"opacity",to:1,from:0,method:"easeIn",duration:150})}},{key:"flyAway",value:function(){var e=this;this.setTween({propParent:this.transform,property:"x",to:-100,from:this.transform.x,duration:150,method:"easeIn",onComplete:function(){e.parentScene.remove(e)}}),this.setTween({propParent:this,property:"opacity",to:0,from:1,method:"easeIn",duration:150}),this.button.visible=!1}}]),t}($r),Ea=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Mug",e}return i(t,e),n(t,[{key:"onReady",value:function(){var e=this;return!1!==p(s(t.prototype),"onReady",this).call(this)&&void(game.playSFX("SO-OB-MugDrip"),this.enabled=!1,this.visible=!1,this.parentScene.setTimeout(function(){e.enabled=!0,e.visible=!0},500))}},{key:"break",value:function(){var e=this;if("broken"!==this.state){this.state="broken",this.parentScene.health-=this.data.damage,game.playSFX("SO-BreakMug_mix01");var t=this.parentScene.getItemsByClass("CH-Onion")[0];t.shakeBed(),this.sprite.currentAnimation.callback=function(){e.parentScene.removeActor(e)},this.parentScene.addActor({cls:"FX-Hit",position:[this.transform.x,this.transform.y,this.transform.z]},!0)}}},{key:"onHitFloor",value:function(){this["break"]()}}]),t}(aa),Aa=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Onion",e.body.gravityScale=0,e.body.isSensor=!0,e.body.bottom=-170,e.body.height=62,e.body.left=-176,e.body.width=280,e.isShaking=!1,e.zs=[],e}return i(t,e),n(t,[{key:"onReady",value:function(){if(!1===p(s(t.prototype),"onReady",this).call(this))return!1;for(var e=0,r;e<this.parentScene.health;e++)r=this.parentScene.addActor({cls:"FX-Z",position:[-150,0,0],data:{offset:e}},!1),this.addComponent(r),this.zs.push(r)}},{key:"onUpdate",value:function(){p(s(t.prototype),"onUpdate",this).apply(this,arguments);var e=ne(pe(this.parentScene.health,5),0);if(this.parentScene.isGameOver||this.parentScene.isLevelComplete)for(var r=0;r<this.zs.length;r++)r<e&&"pop"!==this.zs[r].state&&this.zs[r].fadeOut();else for(var a=0;a<this.zs.length;a++)a>=e&&"pop"!==this.zs[a].state&&(this.zs[a].state="pop")}},{key:"onCollide",value:function(e,t){var r=t.isHit;"FX-Feather"!==t.className&&((e.direction.left||e.direction.right)&&(t.body.velocity[0]=-t.body.velocity[0]*t.body.restitution,t.body.velocity[1]*=.1),e.direction.top||e.direction.bottom?(t.body.velocity[0]*=.1,t.body.velocity[1]=-t.body.velocity[1]*t.body.restitution):-.5>t.body.velocity[1]&&-1<t.body.velocity[1]&&(t.enabled=!1,t.missed=!0),t["break"]&&t["break"](),void 0===r&&(this.parentScene.addMissedItem(t),this.parentScene.currentCombo=null,t.isHit=!0,!this.parentScene.isGameover&&game.playSFX("AO-SO-BedShake"),this.shakeBed(),this.parentScene.addActor({cls:"FX-Hit",position:[t.transform.x,t.transform.y,t.transform.z]},!0)))}},{key:"flingJunk",value:function(){var e=[].concat(g(this.parentScene.getItemsByClass("Junk")),g(this.parentScene.getItemsByClass("Duffel")),g(this.parentScene.getItemsByClass("Duckling"))),t=!0,r=!1,a=void 0;try{for(var o=e[Symbol.iterator](),n,i;!(t=(n=o.next()).done);t=!0)i=n.value,90>this.transform.y-i.transform.y&&0<this.transform.y-i.transform.y&&(i.enabled=!0,i.body.velocity[0]=(i.transform.x-this.transform.x)/5,i.body.velocity[1]=25+15*Math.random(),i.body.limitedToWorld=!1)}catch(e){r=!0,a=e}finally{try{t||null==o["return"]||o["return"]()}finally{if(r)throw a}}}}]),t}(ea),Ta=6e3,ka=function(e){function t(){var e;return a(this,t),e=c(this,s(t).apply(this,arguments)),e.constructorName="Z",e.complete=!1,e}return i(t,e),n(t,[{key:"onReady",value:function(){var e=this;!1==!p(s(t.prototype),"onReady",this).apply(this,arguments)||(this.setModulate(function(t,r){var a=(me-0)*(-ge(r*me)/2+0);e.sprite.transform.x=14*a},Ta/3),this.offsetScale=1+.1*this.data.offset,this.sprite.transform.sxyz=[this.offsetScale,this.offsetScale,this.offsetScale],this.transform.x+=this.data.offset*(18*(1+.06*this.data.offset)),this.transform.y+=15*(1+.5*this.data.offset),this.floatUp())}},{key:"floatUp",value:function(){var e=this;this.complete||(this.sprite.transform.y=0,this.sprite.transform.sx=1,this.sprite.transform.sy=1,this.sprite.transform.opacity=1,this.setTween({propParent:this.sprite.transform,property:"y",from:0,to:200,duration:Ta,method:"linear",onComplete:function(){e.floatUp()}}),this.setTween({propParent:this.sprite.transform,property:"sx",from:1*this.offsetScale,to:.5*this.offsetScale,duration:Ta,method:"linear",onUpdate:function(){e.sprite.transform.sy=e.sprite.transform.sx}}),this.fadeOutTween=this.setTween({propParent:this,property:"opacity",from:10,to:0,duration:Ta,method:"easeInQuad"}))}},{key:"fadeOut",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100;this.removeComponent(this.fadeOutTween),this.complete=!0,this.setTween({propParent:this,property:"opacity",from:pe(this.opacity,1),to:0,duration:e,method:"easeIn"})}},{key:"onStateChange",value:function(e){var t=this;"pop"===e&&(this.sprite.currentAnimation.frames[2].onComplete=function(){t.visible=!1},game.playSFX("0441"))}}]),t}($r),Z=[0,0,-.15],Ba={meta:{title:"APPLE & ONION - MESSIN'ROUND",version:"20.01.13.1",startingBreadCount:0,allLevelsPlayedSpeedMultiplier:1.1,itemZoomToBoxDuration:500,daysBetweenBonusLevels:7,allItemsCaughtBonus:1e5,defaultHighScores:[1e7,5e6,2e6,1e6,75e4,5e5,25e4,1e5,5e4,25e3]},layouts:{"Stage-1":Yr,"Stage-2":Wr,"Stage-3":zr,"Stage-4":jr,"Stage-5":Kr,"Stage-6":Zr,"Stage-7":Qr,"Stage-Bonus-1":{levelId:"BONUS TEST",music:"AO-MU-bonus-1",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:800,randomizeGroups:!0,groups:[]},actors:[{cls:"Background-Bonus-01"},{cls:"OB-Box-LG",position:[1e3,188,1],scale:[.6,.6,1]},{cls:"CH-Apple-Bonus",position:[655,178,1]},{cls:"AO-TRANS",position:[0,0,90]}]},"Stage-Bonus-2":{levelId:"BONUS TEST",music:"AO-MU-bonus-1",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:800,randomizeGroups:!0,groups:[]},actors:[{cls:"Background-Bonus-02"},{cls:"OB-Box-LG",position:[1e3,188,1],scale:[.6,.6,1]},{cls:"CH-Apple-Bonus",position:[655,178,1]},{cls:"AO-TRANS",position:[0,0,90]}]},"Stage-Bonus-3":{levelId:"BONUS TEST",music:"AO-MU-bonus-1",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:800,randomizeGroups:!0,groups:[]},actors:[{cls:"Background-Bonus-03"},{cls:"OB-Box-LG",position:[1e3,188,1],scale:[.6,.6,1]},{cls:"CH-Apple-Bonus",position:[655,178,1]},{cls:"AO-TRANS",position:[0,0,90]}]},"Stage-Bonus-4":{levelId:"BONUS TEST",music:"AO-MU-bonus-1",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:800,randomizeGroups:!0,groups:[]},actors:[{cls:"Background-Bonus-04"},{cls:"OB-Box-LG",position:[1e3,188,1],scale:[.6,.6,1]},{cls:"CH-Apple-Bonus",position:[655,178,1]},{cls:"AO-TRANS",position:[0,0,90]}]},"Stage-Bonus-5":{levelId:"BONUS TEST",music:"AO-MU-bonus-1",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:800,randomizeGroups:!0,groups:[]},actors:[{cls:"Background-Bonus-05"},{cls:"OB-Box-LG",position:[1e3,188,1],scale:[.6,.6,1]},{cls:"CH-Apple-Bonus",position:[655,178,1]},{cls:"AO-TRANS",position:[0,0,90]}]},"Stage-Bonus-6":{levelId:"BONUS TEST",music:"AO-MU-bonus-1",bounds:{left:68,right:1307,bottom:38,top:872},cameraPosition:[0,0,100],cameraScale:[1,1,1],groundEndY:0,config:{zoom:1,gravity:1,speed:.07,playerHealth:5,firstThrowDelay:800,randomizeGroups:!0,groups:[]},actors:[{cls:"Background-Bonus-06"},{cls:"OB-Box-LG",position:[1e3,188,1],scale:[.6,.6,1]},{cls:"CH-Apple-Bonus",position:[655,178,1]},{cls:"AO-TRANS",position:[0,0,90]}]}},classes:{"Background-1":{states:{idle:["BG/BG-Scene-0"]},pointerEvents:!1,physics:!1,HSV:Z},"Background-1-Sky-Night":{states:{idle:["BG/BG-Scene-0-Sky-Night"]},pointerEvents:!1,physics:!1},"Background-1-Sky-Day":{states:{idle:["BG/BG-Scene-0-Sky-Day"]},opacity:0,pointerEvents:!1,physics:!1},"Background-Intro-Base":{states:{idle:["BG/BG-Intro-Base"]},scale:[820/770,820/770,1],pointerEvents:!1,physics:!1},"Background-Intro-Buildings":{states:{idle:["BG/BG-Intro-Buildings"]},scale:[820/770,820/770,1],pointerEvents:!1,physics:!1},"Background-Bonus-01":{states:{idle:["BG/BG-Bonus-01"]},scale:[875/768,875/768,1],pointerEvents:!1,physics:!1},"Background-Bonus-02":{states:{idle:["BG/BG-Bonus-01"]},scale:[875/768,875/768,1],pointerEvents:!1,physics:!1},"Background-Bonus-03":{states:{idle:["BG/BG-Bonus-01"]},scale:[875/768,875/768,1],pointerEvents:!1,physics:!1},"Background-Bonus-04":{states:{idle:["BG/BG-Bonus-01"]},scale:[875/768,875/768,1],pointerEvents:!1,physics:!1},"Background-Bonus-05":{states:{idle:["BG/BG-Bonus-01"]},scale:[875/768,875/768,1],pointerEvents:!1,physics:!1},"Background-Bonus-06":{states:{idle:["BG/BG-Bonus-01"]},scale:[875/768,875/768,1],pointerEvents:!1,physics:!1},"Background-Bonus-07":{states:{idle:["BG/BG-Bonus-01"]},scale:[875/768,875/768,1],pointerEvents:!1,physics:!1},"Background-Bonus-08":{states:{idle:["BG/BG-Bonus-01"]},scale:[875/768,875/768,1],pointerEvents:!1,physics:!1},"Background-Gameover":{states:{idle:["BG/BG-Gameover"]},scale:[768/336,768/336,1],pointerEvents:!0,physics:!1},"AO-TRANS":{states:{idle:["HIDDEN"],show:["FX/AO-TRANS"]},scale:[2*(875/768),2*(875/768),1],pointerEvents:!1,physics:!1,behavior:_a},"FX-BoxDust":{states:{idle:["FX/FX-BoxDust"]},pointerEvents:!1,physics:!1,limitedToWorld:!1,behavior:ba},"FX-Feather":{states:{idle:["FX/FX-Feather"]},pointerEvents:!1,physics:!0,limitedToWorld:!1},"FX-Hit":{states:{idle:["FX/FX-Hit"]},pointerEvents:!1,physics:!1,limitedToWorld:!1,behavior:ba},"FX-Line":{states:{idle:["FX/FX-Line"]},pointerEvents:!1,physics:!1},"TC-Trophy-1":{states:{idle:["TC/TC-Trophy1"]},pointerEvents:!0,physics:!1},"TC-Trophy-1-Shadow":{states:{idle:["TC/TC-Trophy1-Shadow"]},pointerEvents:!1,physics:!1},"TC-Trophy-2":{states:{idle:["TC/TC-Trophy2"]},pointerEvents:!0,physics:!1},"TC-Trophy-2-Shadow":{states:{idle:["TC/TC-Trophy2-Shadow"]},pointerEvents:!1,physics:!1},"FX-Z":{states:{idle:["FX/FX-Z"],pop:["FX/UI-Z-POP"]},pointerEvents:!0,physics:!1,behavior:ka},"CH-Apple":{states:{idle:["CH/CH-Apple/idle"],womp:["CH/CH-Apple/CH-AP-Womp"],wakeup:["CH/CH-Apple/CH-AP-WakeUp"],"wakeup-gameover":["CH/CH-Apple/CH-AP-WakeUp-Gameover"],"empty-bed":["OB/OB-Bed-AP"]},pointerEvents:!0,physics:!0,behavior:ea,HSV:Z},"CH-Apple-Blanket":{states:{idle:["HIDDEN"],fall:["OB/OB-Blanket"]},pointerEvents:!0,physics:!1},"CH-Apple-Bonus":{states:{idle:["CH/CH-Apple/CH-B-LookAround"],toss:["CH/CH-Apple/CH-AP-Bonus"]},pointerEvents:!0,physics:!1,behavior:na},"CH-Apple-Dance":{states:{idle:["HIDDEN"],0:["CH/CH-Apple/CH-D-02ap"],1:["CH/CH-Apple/CH-D-01ap"],2:["CH/CH-Apple/CH-D-03ap"],3:["CH/CH-Apple/CH-D-05ap"],4:["CH/CH-Apple/CH-D-06ap"],5:["CH/CH-Apple/CH-D-08ap"],6:["CH/CH-Apple/CH-D-09ap"],DB:["CH/CH-Apple/CH-DB-A"],DJ:["CH/CH-Apple/CH-DJ-A"],DW:["CH/CH-Apple/CH-DW-A"]},pointerEvents:!0,physics:!1},"CH-Onion":{states:{idle:["CH/CH-Onion/idle"],womp:["CH/CH-Onion/CH-ON-Womp"],wakeup:["CH/CH-Onion/CH-ON-WakeUp"],"wakeup-gameover":["CH/CH-Onion/CH-ON-WakeUp-Gameover"],"empty-bed":["OB/OB-Bed-ON"]},pointerEvents:!0,physics:!0,behavior:Aa,HSV:Z},"CH-Onion-Blanket":{states:{idle:["HIDDEN"],fall:["OB/OB-Blanket"]},pointerEvents:!0,physics:!1},"CH-Onion-Dance":{states:{idle:["HIDDEN"],0:["CH/CH-Onion/CH-D-02on"],1:["CH/CH-Onion/CH-D-01on"],2:["CH/CH-Onion/CH-D-03on"],3:["CH/CH-Onion/CH-D-05on"],4:["CH/CH-Onion/CH-D-06on"],5:["CH/CH-Onion/CH-D-08on"],6:["CH/CH-Onion/CH-D-09on"],DB:["CH/CH-Onion/CH-DB-O"],DJ:["CH/CH-Onion/CH-DJ-O"],DW:["CH/CH-Onion/CH-DW-O"]},pointerEvents:!0,physics:!1},"OB-Box-SM":{states:{idle:["OB/OB-Box-SM"]},pointerEvents:!0,physics:!1},"OB-Box-LG":{states:{idle:["OB/OB-Box-LG"],close:["OB/OB-Box100"]},pointerEvents:!0,physics:!1,behavior:ia},"OB-Boot":{states:{idle:["OB/OB-Boot"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.SOCK,value:100,damage:1,speed:1.1,rotation:Fr.SLOW,velocity:Pr.LOW}},"OB-Ball-Basket":{states:{idle:["OB/OB-Ball-Basket"]},pointerEvents:!0,physics:!0,limitedToUpperBounds:!1,behavior:aa,HSV:[0,0,0],data:{category:Lr.BALL,value:500,damage:1,speed:4,rotation:Fr.MEDIUM,velocity:Pr.BASKET_THROW}},"OB-Ball-CatToy":{states:{idle:["OB/OB-Ball-CatToy"]},pointerEvents:!0,physics:!0,limitedToUpperBounds:!1,behavior:aa,HSV:[0,0,0],data:{category:Lr.BALL,value:500,damage:1,speed:3,rotation:Fr.MEDIUM,velocity:Pr.BASKET_THROW}},"OB-Ball-Kids":{states:{idle:["OB/OB-Ball-Kids"]},pointerEvents:!0,physics:!0,limitedToUpperBounds:!1,behavior:aa,HSV:[0,0,0],data:{category:Lr.BALL,value:500,damage:1,speed:2,rotation:Fr.MEDIUM,velocity:Pr.BASKET_THROW}},"OB-Ball-Soccer":{states:{idle:["OB/OB-Ball-Soccer"]},pointerEvents:!0,physics:!0,limitedToUpperBounds:!1,behavior:aa,HSV:[0,0,0],data:{category:Lr.BALL,value:1e3,damage:1,speed:6,rotation:Fr.SUPER_FAST,velocity:Pr.HYPER_HIGH}},"OB-Ball-Soccer-R":{states:{idle:["OB/OB-Ball-Soccer"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.BALL,value:1e3,damage:1,speed:6,rotation:Fr.SUPER_FAST,velocity:Pr.SOCCER_KICK_REVERSE}},"OB-Blanket":{states:{idle:["OB/OB-Blanket"]},pointerEvents:!0,physics:!0},"OB-Book":{states:{idle:["OB/OB-Book"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.BOOK,value:100,damage:1,speed:2.9,rotation:Fr.FAST,velocity:Pr.MEDIUM_RARE}},"OB-Book-2":{states:{idle:["OB/OB-Book-2"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.BOOK,value:100,damage:1,speed:2.7,rotation:Fr.FAST,velocity:Pr.HIGH}},"OB-Bread":{states:{idle:["OB/OB-Bread"]},pointerEvents:!0,physics:!1,behavior:sa,data:{category:Lr.CAN,value:200,damage:1,speed:5,rotation:Fr.FAST,velocity:Pr.DYNAMIC_HIGH}},"OB-BreadSlice":{states:{idle:["OB/OB-BreadSlice"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:200,damage:1,speed:5,rotation:Fr.FAST,velocity:Pr.DYNAMIC_HIGH}},"OB-BreadSlice-2":{states:{idle:["OB/OB-Breadslice-2"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:200,damage:1,speed:5,rotation:Fr.FAST,velocity:Pr.DYNAMIC_HIGH}},"OB-Can":{states:{idle:["OB/OB-Can"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.CAN,value:200,damage:1,speed:2,rotation:Fr.FAST,velocity:Pr.DYNAMIC_HIGH}},"OB-Can-2":{states:{idle:["OB/OB-Can-2"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[5,0,0],data:{category:Lr.CAN,value:1500,damage:1,speed:3,rotation:Fr.FAST,velocity:Pr.HIGH_2}},"OB-Cat":{states:{idle:["OB/OB-Cat/OB-Cat-Static"],enter:["OB/OB-Cat/OB-Cat-Enters"],sleep:["OB/OB-Cat/OB-Cat-Sleep"],slow:["OB/OB-Cat/OB-Cat-Slow"],fast:["OB/OB-Cat/OB-Cat-Fast"]},pointerEvents:!0,physics:!1,behavior:fa,HSV:Z},"OB-Cat-1":{states:{idle:["OB/OB-Cat-1"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:2,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Cat-2":{states:{idle:["OB/OB-Cat-2"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:3,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-CatThrone-LG":{states:{idle:["OB/OB-CatThrone-LG"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:2,rotation:Fr.NONE,velocity:Pr.HIGH}},"OB-CatThrone-SM":{states:{idle:["OB/OB-CatThrone-SM"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:4,rotation:Fr.NONE,velocity:Pr.HIGH}},"OB-CoffeeMug":{states:{idle:["OB/OB-CoffeeMug"],broken:["FX/FX-MugBreak"]},pointerEvents:!0,physics:!0,behavior:Ea,HSV:[0,0,0],data:{category:Lr.CUP,value:5e3,damage:1,speed:3,rotation:Fr.SLOW,velocity:Pr.HIGH}},"OB-CoffeeMug-Low":{states:{idle:["OB/OB-CoffeeMug"],broken:["FX/FX-MugBreak"]},pointerEvents:!0,physics:!0,behavior:Ea,HSV:[0,0,0],scale:[1.25,1.25,1],data:{category:Lr.CUP,value:5e3,damage:1,speed:3,rotation:Fr.SLOW,velocity:Pr.SUPER_LOW}},"OB-Cone-LG":{states:{idle:["OB/OB-Cone-LG"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],scale:[1.25,1.25,1],data:{category:Lr.CONE,value:500,damage:1,speed:2,rotation:Fr.SLOW,velocity:Pr.SUPER_LOW}},"OB-Cone-SM":{states:{idle:["OB/OB-Cone-SM"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.CONE,value:500,damage:1,speed:3,rotation:Fr.SLOW,velocity:Pr.MEDIUM}},"OB-Duck":{states:{idle:["HIDDEN"],waiting:["OB/OB-Duck/OB-Duck"],quack:["OB/OB-Duck/OB-DuckQuack"]},limitedToWorld:!1,pointerEvents:!0,physics:!1,behavior:ga},"OB-Duckling":{states:{idle:["OB/OB-Duckling"]},limitedToWorld:!1,pointerEvents:!0,physics:!0,behavior:ya,HSV:[0,0,0],data:{instaKill:!0,value:-1e3,damage:10,speed:.7,rotation:Fr.NONE,velocity:Pr.DUCKINGS}},"OB-DuffelBag":{states:{idle:["OB/OB-DuffelBag"]},pointerEvents:!0,physics:!0,behavior:ha,HSV:[0,0,0],data:{value:100,damage:2,speed:4,rotation:Fr.NONE,velocity:Pr.MEDIUM}},"OB-DuffelBagFast":{states:{idle:["OB/OB-DuffelBag"]},pointerEvents:!0,physics:!0,behavior:ha,HSV:[0,0,0],data:{value:100,damage:2,speed:6,rotation:Fr.NONE,velocity:Pr.MEDIUM}},"OB-Dummy-Apple":{states:{idle:["OB/OB-Dummy-Apple"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:2e3,damage:2,speed:2,rotation:{min:.05,max:.05},velocity:{x:{min:27,max:32},y:{min:35,max:40}}}},"OB-Dummy-Onion":{states:{idle:["OB/OB-Dummy-Onion"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:2e3,damage:2,speed:2,rotation:{min:.05,max:.05},velocity:{x:{min:27,max:32},y:{min:35,max:40}}}},"OB-Eagle":{states:{idle:["OB/OB-Eagle"]},pointerEvents:!0,physics:!1,behavior:xa,HSV:[0,0,0],scale:[.8,.8,1],data:{value:100,damage:100,rotation:{min:.05,max:.05},flightDuration:2e3,loopDeLoopInterval:0,loopDeLoopRadius:0,loopDeLoopDuration:0}},"OB-Eagle-Fast":{states:{idle:["OB/OB-Eagle"]},pointerEvents:!0,physics:!1,behavior:xa,HSV:[0,0,0],scale:[.8,.8,1],data:{value:100,damage:100,rotation:{min:.05,max:.05},flightDuration:1600,loopDeLoopInterval:0,loopDeLoopRadius:0,loopDeLoopDuration:0}},"OB-Extinguisher-1":{states:{idle:["OB/OB-Extinguisher-1"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:2e3,damage:1,speed:5,rotation:{min:.05,max:.05},velocity:{x:{min:22,max:32},y:{min:35,max:40}}}},"OB-Extinguisher-2":{states:{idle:["OB/OB-Extinguisher-2"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:2e3,damage:1,speed:5,rotation:{min:.05,max:.05},velocity:{x:{min:22,max:32},y:{min:35,max:40}}}},"OB-Hat-Apple":{states:{idle:["OB/OB-Hat-Apple"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.HAT,value:2e3,damage:1,speed:5,rotation:{min:.05,max:.05},velocity:{x:{min:22,max:32},y:{min:35,max:40}}}},"OB-Hat-Brown":{states:{idle:["OB/OB-Hat-Brown"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.HAT,value:2e3,damage:1,speed:3,rotation:{min:.05,max:.05},velocity:{x:{min:22,max:32},y:{min:35,max:40}}}},"OB-Hat-Cap":{states:{idle:["OB/OB-Hat-Cap"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.HAT,value:2e3,damage:1,speed:3,rotation:{min:.05,max:.05},velocity:{x:{min:22,max:32},y:{min:35,max:40}}}},"OB-Hat-Grey":{states:{idle:["OB/OB-Hat-Grey"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.HAT,value:2e3,damage:1,speed:6,rotation:{min:.05,max:.05},velocity:{x:{min:22,max:32},y:{min:35,max:40}}}},"OB-Hat-Police":{states:{idle:["OB/OB-Hat-Police"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.HAT,value:2e3,damage:1,speed:6,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Helmet-A":{states:{idle:["OB/OB-Helmet-A"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:2e3,damage:1,speed:1,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Helmet-A+B":{states:{idle:["OB/OB-Helmet-A+B"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:2e3,damage:1,speed:1,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Helmet-B":{states:{idle:["OB/OB-Helmet-B"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:2e3,damage:1,speed:1,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Katamari-A":{states:{idle:["OB/OB-Katamari-A"]},pointerEvents:!0,physics:!0,behavior:oa,HSV:[0,0,0],data:{value:100,damage:1,speed:1,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}},junkCount:10,junkClasses:["OB-Sock"]}},"OB-Katamari-B":{states:{idle:["OB/OB-Katamari-B"]},pointerEvents:!0,physics:!0,behavior:oa,HSV:[0,0,0],data:{value:100,damage:1,speed:1,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}},junkCount:9,junkClasses:["OB-Sock","OB-Sock","OB-Sock","OB-Cone-LG"]}},"OB-Katamari-C":{states:{idle:["OB/OB-Katamari-B"]},pointerEvents:!0,physics:!0,behavior:oa,HSV:[0,0,0],data:{value:100,damage:1,speed:1,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}},junkCount:9,junkClasses:["OB-Sock","OB-Sock","OB-Sock","OB-Sock","OB-Sock","OB-Sock","OB-Sock","OB-Sock","OB-Sock","OB-Sock","OB-Sock","OB-Sock","OB-Dummy-Apple","OB-Dummy-Onion"]}},"OB-Milk":{states:{idle:["OB/OB-Milk"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:1e3,damage:1,speed:3,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Paper":{states:{idle:["OB/OB-Paper"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:1,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-PaperAirplane":{states:{idle:["OB/OB-PaperAirplane"],crumpled:["OB/OB-PaperAirplane-X"]},pointerEvents:!0,physics:!1,behavior:va,HSV:[0,0,0],data:{value:100,missValue:1e4,damage:1,speed:1,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}},flightDuration:5e3,loopDeLoopInterval:1800,loopDeLoopRadius:100,loopDeLoopDuration:1800}},"OB-Popcicle":{states:{idle:["OB/OB-Popcicle"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:5,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Popsicle-A":{states:{idle:["OB/OB-Popsicle-A"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:5,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Popsicle-B":{states:{idle:["OB/OB-Popsicle-B"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:5,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Recorder":{states:{idle:["OB/OB-Recorder"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:500,damage:2,speed:6,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-Skateboard":{states:{idle:["OB/OB-Skateboard"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:500,damage:2,speed:6,rotation:{min:.01,max:.01},velocity:{x:{min:20,max:30},y:{min:30,max:40}}}},"OB-SkeletonArm-A":{states:{idle:["OB/OB-SkeletonArm-A"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.BONE,value:500,damage:1,speed:2,rotation:Fr.MEDIUM,velocity:Pr.MEDIUM_RARE}},"OB-SkeletonArm-B":{states:{idle:["OB/OB-SkeletonArm-B"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.BONE,value:500,damage:1,speed:2,rotation:Fr.MEDIUM,velocity:Pr.HIGH}},"OB-Skull":{states:{idle:["OB/OB-Skull"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.BONE,value:500,damage:1,speed:4,rotation:Fr.MEDIUM,velocity:Pr.HIGH}},"OB-Sneaker":{states:{idle:["OB/OB-Sneaker"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:3,rotation:Fr.MEDIUM,velocity:Pr.HIGH}},"OB-Sock":{states:{idle:["OB/OB-Sock-A","OB/OB-Sock-B","OB/OB-Sock-C","OB/OB-Sock-D","OB/OB-Sock-E","OB/OB-Sock-F"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{category:Lr.SOCK,value:100,damage:1,speed:1.1,rotation:Fr.SLOW,velocity:Pr.LOW}},"OB-SoftDrink":{states:{idle:["OB/OB-SoftDrink"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:100,damage:1,speed:3,rotation:Fr.MEDIUM,velocity:Pr.HIGH}},"OB-WaterBottle-A":{states:{idle:["OB/OB-WaterBottle-A"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:300,damage:1,speed:3.5,rotation:Fr.MEDIUM,velocity:Pr.SUPER_HIGH}},"OB-WaterBottle-B":{states:{idle:["OB/OB-WaterBottle-B"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],data:{value:300,damage:1,speed:4,rotation:Fr.MEDIUM,velocity:Pr.MEDIUM_RARE}},"OB-WaterBottle-Bonus":{states:{idle:["OB/OB-WaterBottle-A"]},pointerEvents:!0,physics:!0,behavior:aa,HSV:[0,0,0],scale:[2,2,2],data:{value:1e3,damage:1,speed:3.5,rotation:Fr.MEDIUM,velocity:Pr.SUPER_HIGH}},"GO-Butt":{states:{idle:["GO/GO-Butt-Rest"],select:["GO/GO-Butt-Select"]},pointerEvents:!0,physics:!1},"GO-CatTail":{states:{idle:["GO/GO-CatTail"]},pointerEvents:!1,physics:!1},"GO-Continue-X1":{states:{idle:["GO/GO-Continue-X1-Rest"],select:["GO/GO-Continue-X1-Select"]},pointerEvents:!0,physics:!1},"GO-Continue-X2":{states:{idle:["GO/GO-Continue-X2-Rest"],select:["GO/GO-Continue-X2-Select"]},pointerEvents:!0,physics:!1},"GO-Continue-X3":{states:{idle:["GO/GO-Continue-X3-Rest"],select:["GO/GO-Continue-X3-Select"]},pointerEvents:!0,physics:!1},"UI-Trophy-1":{states:{idle:["GO/UI-Trophy"]},pointerEvents:!0,physics:!1},"UI-Trophy-2":{states:{idle:["FX/FX-Trophy2"]},pointerEvents:!0,physics:!1},"UI-Calendar":{states:{idle:["UI/UI-Calendar-Base"],blur:["UI/UI-Calendar-Blur"]},pointerEvents:!1,physics:!1,behavior:ua},"UI-Calendar-Flip":{states:{idle:["HIDDEN"],flip:["UI/UI-Calendar-Flip"]},pointerEvents:!1,physics:!1},"UI-Calendar-Mini":{states:{idle:["UI/UI-Calendar-Base"]},pointerEvents:!1,physics:!1,behavior:pa},"UI-Instructions":{states:{idle:["UI/AO-INS-A-Static"],blur:["UI/AO-INS-A-Blur"]},pointerEvents:!0,physics:!1,behavior:Sa},"TC-Button":{states:{idle:["TC/TC-Butt"],press:["TC/TC-Butt-Press"]},pointerEvents:!1,physics:!1},"TC-Cat":{states:{idle:["TC/TC-Cat"]},pointerEvents:!1,physics:!1}}},Oa=new Mr,wa=1e3,Ia=623,Ca=3,Ma=function(e){function t(){var e;return a(this,t),e=c(this,s(t).call(this)),e.renderPasses=[new St({viewportClear:!0})],e.complete=!1,e.currentPercent=0,e.sprites={},e.assets={},e}return i(t,e),n(t,[{key:"onload",value:function(){var e=this;p(s(t.prototype),"onload",this).call(this),console.log("%c ".concat(Ba.meta.title," v.").concat(Ba.meta.version," "),"background: #222; color: #bada55; font-weight: bold"),console.log("%c Created by THIS IS POP ","background: #EA177E; color: #FFF; font-weight: bold"),this.viewports[0].listenForMouseEvents({scene:game.router.map.game.module,renderPick:!0}),this.renderPasses=[new St],this.progress=0;var r=Cr.images.length+Cr.audio.music.length+Cr.audio.sfx.length+Cr.spritesheets.length,a=0;this.showBackgroundGraphics().then(function(){e.preloadTextures(Cr,function(t,o){e.showProgress((o+a)/r)},function(){a+=Cr.images.length,e.preloadMusic(Cr,function(t,o){e.showProgress((o+a)/r)},function(){a+=Cr.audio.music.length,e.preloadSFX(Cr,function(t,o){e.showProgress((o+a)/r)},function(){a+=Cr.audio.sfx.length,e.preloadSpritesheets(Cr,function(t,o){e.showProgress((a+o)/r)},function(){a+=Cr.spritesheets.length,e.showProgress(a/r)})})})})})}},{key:"update",value:function(){for(var e=arguments.length,r=Array(e),a=0,o;a<e;a++)r[a]=arguments[a];(o=p(s(t.prototype),"update",this)).call.apply(o,[this].concat(r)),this.currentPercent<100*this.progress&&(this.currentPercent+=1);this.viewports[0].orthoHeight;if(this.sprites.bar&&(this.sprites.bar.components[0].transform.x=200+3.52*this.currentPercent),this.sprites["bar-background-1"]&&this.sprites["bar-background-2"])for(var n=Ia,l=1,d;2>=l;l++)d=this.sprites["bar-background-"+l].components[0].transform,d.x+=5,d.x>=n&&(d.x=-n+Ca);this.complete||router.clock.stats.currentGameTime<165e3||100==this.currentPercent&&!this.complete&&(this.currentPercent=100,this.complete=!0,this.onLoadComplete())}},{key:"onLoadComplete",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showLogo();case 2:this.setTimeout(function(){t.spriteModel.mesh.material.diffuseTexture.unload(t.viewports[0]),router.navigate("title")},150);case 3:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showBackgroundGraphics",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.camera=new ze({projectionType:"orthographic",transform:new Dt({position:[0,0,99]})}),this.add(this.camera),this.viewports[0].bindToCamera(this.camera),this.viewports[0].clearColor.set(0,0,0),t=this.viewports[0].orthoHeight,r=t*(16/9),a=t/768,o=r/(768*(16/9)),game.materialColorized=Oa,e.next=11,this.newSprite("bar-background-1",0,0,0,0,[o,a,1]);case 11:return e.next=13,this.newSprite("bar-background-2",0,-Ia+Ca,0,0,[o,a,1]);case 13:return e.next=15,this.newSprite("bar",1,0,0,1,[o,a,1]);case 15:return e.next=17,this.newSprite("overlay-mask-l",1,-545,0,1,[o,a,1]);case 17:return e.next=19,this.newSprite("overlay-mask-r",1,555,0,1,[o,a,1]);case 19:return e.next=21,this.newSprite("overlay",2,0,0,2,[o,a,1]);case 21:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"newSprite",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r=arguments,a,o,n,i,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=1<r.length&&void 0!==r[1]?r[1]:0,o=2<r.length&&void 0!==r[2]?r[2]:0,n=3<r.length&&void 0!==r[3]?r[3]:0,i=4<r.length&&void 0!==r[4]?r[4]:0,s=5<r.length&&void 0!==r[5]?r[5]:[1,1,1],this.spriteModel){e.next=9;break}return e.next=8,Ir.load({src:"res/textures/cn-preloader-black.json",autoplay:!1,speed:0,defaultPivot:[0,0],pixelsPerUnit:1,minFilter:"LINEAR_MIPMAP_NEAREST",magFilter:"LINEAR"});case 8:this.spriteModel=e.sent;case 9:return l=Ir.cloneSprite(this.spriteModel,!0),e.next=12,l.loadTextures();case 12:return l.mesh.material=game.materialColorized,l.transform=new Dt({position:[o,n,i],scale:s}),l.selectAnimation(""),l.currentAnimation.setFrame(a),this.sprites[t]=new Fe({components:[l]}),this.add(this.sprites[t]),e.abrupt("return",this.sprites[t]);case 19:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showLogo",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t=this,a,o,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=0,o=Object.values(this.sprites);a<o.length;a++)n=o[a],this.remove(n);return e.abrupt("return",new Promise(function(){var e=r(regeneratorRuntime.mark(function e(r){var a,o,n,i,s,l,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=13,o=0,n=t.viewports[0].orthoHeight,i=n*(16/9),s=n/768,l=i/(768*(16/9)),e.next=8,t.newSprite("logo",3,i/2,n/2,3,[l,s,1]);case 8:d=e.sent,t.setInterval(function(){o++,d.components[0].currentAnimation.setFrame(3+o),o===a-1&&t.setTimeout(function(){r()},400)},1e3/15,a-1);case 10:case"end":return e.stop();}},e)}));return function(){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"preloadTextures",value:function(e,t,r){var a=this,o=new bt;o.preloadTextures(e.images,t,[this.viewports[0],this.viewports[0].mouseEventViewport],{flipY:!1,minFilter:"LINEAR_MIPMAP_NEAREST",magFilter:"LINEAR"}).then(function(e){r&&r(),game.textures=e})["catch"](function(o){console.log(o),window.setTimeout(function(){a.preloadTextures(e,t,r)},wa)})}},{key:"preloadSpritesheets",value:function(e,t,a){for(var o=this,n=0,s=!1,l=0;l<e.spritesheets.length;l++)n++,function(i){Ir.load({src:i,material:Oa,minFilter:"LINEAR_MIPMAP_NEAREST",magFilter:"LINEAR",autoplay:!1,speed:1e3/24,defaultPivot:[0,0],pixelsPerUnit:1,textures:game.textures}).then(function(){var o=r(regeneratorRuntime.mark(function r(o){var s,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:s=i.split("/").pop().replace(".png",""),game.spritesheets[s]=o,n--,t&&(l=(e.spritesheets.length-n)/e.spritesheets.length,t(l,e.spritesheets.length-n)),!n&&a&&a();case 5:case"end":return r.stop();}},r)}));return function(){return o.apply(this,arguments)}}())["catch"](function(r){s||(s=!0,console.log(r),window.setTimeout(function(){o.preloadSpritesheets(e,t,a)},wa))})}(e.spritesheets[l])}},{key:"preloadMusic",value:function(e,t,r){for(var a=this,o=0,n=!1,s=0;s<e.audio.music.length;s++){o++;var l=e.audio.music[s].split("/").pop().replace(".mp3","");game.music[l]=new Howl({src:[e.audio.music[s],e.audio.music[s].replace(".mp3",".ogg")],loop:!0,onload:function(){if(o--,t){var a=(e.audio.music.length-o)/e.audio.music.length;t(a,e.audio.music.length-o)}!o&&r&&r()},onloaderror:function(o){n||(n=!0,console.warn("Failed to load music. "+o),window.setTimeout(function(){console.warn("Retrying music load."),a.preloadMusic(e,t,r)},wa))}})}}},{key:"preloadSFX",value:function(e,t,r){for(var a=this,o=0,n=!1,s=0;s<e.audio.sfx.length;s++){o++;var l=e.audio.sfx[s].split("/").pop().replace(".mp3","");game.sfx[l]=new Howl({src:[e.audio.sfx[s],e.audio.sfx[s].replace(".mp3",".ogg")],html5:!!navigator.isCocoonJS,onload:function(){if(o--,t){var a=(e.audio.sfx.length-o)/e.audio.sfx.length;t(a,e.audio.sfx.length-o)}!o&&r&&r()},onloaderror:function(o){n||(n=!0,console.warn("Failed to load sound effects. "+o),window.setTimeout(function(){console.warn("Retrying sound effects load."),a.preloadSFX(e,t,r)},wa))}})}}},{key:"showProgress",value:function(e){this.progress=e}}]),t}(Tt),Pa=function(e){function t(e){var r;return a(this,t),r=c(this,s(t).call(this)),r.covered=!0,r.size=1242,r.currentTweens=[],r.center=new Ct({id:"background",src:"res/textures/transition_circle_black.png",pixelsPerUnit:1,minFilter:"LINEAR_MIPMAP_NEAREST",magFilter:"LINEAR",pivot:[.5,.5]}),r.center.mesh.material=game.materialColorized,r.addComponent(r.center),r.top=new Ct({id:"background",src:"res/textures/transition_pixel.png",pixelsPerUnit:1,minFilter:"LINEAR_MIPMAP_NEAREST",magFilter:"LINEAR",pivot:[.5,.5]}),r.top.mesh.material=game.materialColorized,r.addComponent(r.top),r.bottom=new Ct({id:"background",src:"res/textures/transition_pixel.png",pixelsPerUnit:1,minFilter:"LINEAR_MIPMAP_NEAREST",magFilter:"LINEAR",pivot:[.5,.5]}),r.bottom.mesh.material=game.materialColorized,r.addComponent(r.bottom),r.left=new Ct({id:"background",src:"res/textures/transition_pixel.png",pixelsPerUnit:1,minFilter:"LINEAR_MIPMAP_NEAREST",magFilter:"LINEAR",pivot:[.5,.5]}),r.left.mesh.material=game.materialColorized,r.addComponent(r.left),r.right=new Ct({id:"background",src:"res/textures/transition_pixel.png",pixelsPerUnit:1,minFilter:"LINEAR_MIPMAP_NEAREST",magFilter:"LINEAR",pivot:[.5,.5]}),r.right.mesh.material=game.materialColorized,r.addComponent(r.right),r.transform.z=e,r}return i(t,e),n(t,[{key:"onSpawn",value:function(){p(s(t.prototype),"onSpawn",this).apply(this,arguments),this.alignCenter()}},{key:"alignCenter",value:function(){var e=this.parentScene.viewports[0].orthoHeight*this.parentScene.cameras[0].transform.sy,t=this.parentScene.viewports[0].orthoWidth?this.parentScene.viewports[0].orthoWidth*this.parentScene.cameras[0].transform.sx:e*(16/9);this.size=2*ne(t,e),this.transform.xyz=[this.parentScene.cameras[0].transform.x+t/2,this.parentScene.cameras[0].transform.y+e/2,this.transform.z],this.transform.z=99,this.top.transform.xyz=[0,this.size/2,0],this.bottom.transform.xyz=[0,-this.size/2,0],this.left.transform.xyz=[-this.size/2,0,0],this.right.transform.xyz=[this.size/2,0,0],this.top.transform.sx=this.size,this.bottom.transform.sx=this.size,this.left.transform.sy=this.size,this.right.transform.sy=this.size,this.covered?(this.center.transform.sxyz=[0,0,1],this.top.transform.sy=this.size,this.bottom.transform.sy=this.size,this.left.transform.sx=this.size,this.right.transform.sx=this.size):(this.center.transform.sxyz=[this.size/512,this.size/512,1],this.top.transform.sy=0,this.bottom.transform.sy=0,this.left.transform.sx=0,this.right.transform.sx=0),this.parentScene.sortEntitiesByZ(!0)}},{key:"cover",value:function(e){var r=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:484;this.alignCenter(),this.covered=!0,this.visible=!0;var o=!0,n=!1,i=void 0;try{for(var s=this.currentTweens[Symbol.iterator](),l,d;!(o=(l=s.next()).done);o=!0)d=l.value,this.removeComponent(d)}catch(e){n=!0,i=e}finally{try{o||null==s["return"]||s["return"]()}finally{if(n)throw i}}this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.center.transform,property:"sx",to:0,from:this.size/512,duration:a,onComplete:function(){e&&r.setTimeout(function(){e()},64)}})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.center.transform,property:"sy",to:0,from:this.size/512,duration:a})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.top.transform,property:"sy",to:this.size,from:0,duration:a})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.bottom.transform,property:"sy",to:this.size,from:0,duration:a})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.left.transform,property:"sx",to:this.size,from:0,duration:a})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.right.transform,property:"sx",to:this.size,from:0,duration:a}))}},{key:"uncover",value:function(e){var r=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:484;this.alignCenter(),this.covered=!1,this.visible=!0;var o=!0,n=!1,i=void 0;try{for(var s=this.currentTweens[Symbol.iterator](),l,d;!(o=(l=s.next()).done);o=!0)d=l.value,this.removeComponent(d)}catch(e){n=!0,i=e}finally{try{o||null==s["return"]||s["return"]()}finally{if(n)throw i}}this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.center.transform,property:"sx",to:this.size/512,from:0,duration:a,onComplete:function(){e?r.setTimeout(function(){e(),r.visible=!1},64):r.visible=!1}})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.center.transform,property:"sy",to:this.size/512,from:0,duration:a})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.top.transform,property:"sy",to:0,from:this.size,duration:a})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.bottom.transform,property:"sy",to:0,from:this.size,duration:a})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.left.transform,property:"sx",to:0,from:this.size,duration:a})),this.currentTweens.push(this.setTween({method:"easeIn",propParent:this.right.transform,property:"sx",to:0,from:this.size,duration:a}))}},{key:"reset",value:function(){var e=!0,t=!1,r=void 0;try{for(var a=this.currentTweens[Symbol.iterator](),o,n;!(e=(o=a.next()).done);e=!0)n=o.value,this.removeComponent(n)}catch(e){t=!0,r=e}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}this.alignCenter()}}]),t}(Fe),Da=function(e){function t(){var e;return a(this,t),e=c(this,s(t).call(this)),e.renderPasses=[new St({viewportClear:!0})],e.sprites={},e.mouseDown=!1,e.listenerClick={handleEvent:function(t){return e.onClick(t)}},e.listenerMouseDown={handleEvent:function(t){return e.onMouseDown(t)}},e}return i(t,e),n(t,[{key:"onload",value:function(){var e=this;this.viewports[0].id=0,this.viewports[0].listenForMouseEvents({scene:game.router.map.title.module,renderPick:!0}),this.viewports[0].mouseEventHover=!1;var t=new ze({projectionType:"orthographic",transform:new Dt({position:[0,0,100]})});this.add(t),this.viewports[0].bindToCamera(t),this.renderPasses=[new St],this.loadScene().then(function(){e.transitionCircle.uncover()})}},{key:"onunload",value:function(){var e=["TC-Background","TC-LOGO-MnR"],t=!0,r=!1,a=void 0;try{for(var o=game.textures[Symbol.iterator](),n,i;!(t=(n=o.next()).done);t=!0)i=n.value,0<=e.indexOf(i.src.replace("res/textures/","").replace(".png",""))&&(i.unload(this.viewports[0]),i.unload(game.router.map.preloader.module.viewports[0]))}catch(e){r=!0,a=e}finally{try{t||null==o["return"]||o["return"]()}finally{if(r)throw a}}}},{key:"onMouseDown",value:function(){this.mouseDown=!0,this.button.state="press",this.cat.sprite.currentAnimation.setFrame(3),game.playSFX("SO-ButtonPress")}},{key:"onMouseUp",value:function(){this.mouseDown=!1,this.button.state="idle",this.onClick(),this.trophy&&(this.trophy.sprite.transform.y=0)}},{key:"onClick",value:function(e){var t=this;this.complete||(this.complete=!0,this.mouseDown=!1,this.button.state="idle",game.playSFX("0000"),game.stopMusic("AO-Music",1e3),this.transitionCircle.cover(function(){t.onunload(),t.complete=!1,e?(t.trophyClick=!0,router.navigate("game")):router.navigate("intro"),t.trophy&&(t.trophy.sprite.transform.y=0)}))}},{key:"loadScene",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t=this,r,a,o,n,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=this.viewports[0].orthoHeight,a=r*(16/9),o=[a/1024,a/1024,1],this.transitionCircle=new Pa(a/2,r/2,10,a*game.SPRITE_SCALE),this.add(this.transitionCircle),this.newSprite({src:"TC-Background",x:0,y:0,pivot:[0,0],scale:o}),this.newSprite({src:"TC-LOGO-MnR",x:0,y:0,pivot:[0,0],scale:o}),n=window.localStorage.getItem("ao_mnr_highscore")&&window.localStorage.getItem("ao_mnr_highscore")!==JSON.stringify(Ba.meta.defaultHighScores),i=game.router.map.game.module.highscores[0]!==Ba.meta.defaultHighScores[0],n&&(i&&(this.txtScore=new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"NU",glyphCharacters:"0123456789,-+./x",text:game.router.map.game.module.highscores[0]+"",align:"center",alignVertical:"bottom",tracking:-2}),this.txtScore.transform.xyz=[700,540,80],this.txtScore.transform.sxyz=[.7,.7,.7],this.add(this.txtScore)),this.add(new $r(Ba.classes["TC-Trophy-1-Shadow"],{position:[700,650,11]})),this.trophy=new $r(Ba.classes["TC-Trophy-1"],{position:[700,660,11],events:{onMouseDown:function(){t.trophy.sprite.transform.y=-10},onMouseUp:function(){t.trophy.sprite.transform.y=0,t.onClick(!0)}}}),this.add(this.trophy)),s=new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"TC",glyphCharacters:"0123456789.v",text:"v."+Ba.meta.version,align:"left",alignVertical:"bottom",tracking:-2}),s.transform.xyz=[30,30,8],this.add(s),this.button=new $r(Ba.classes["TC-Button"],{position:[95,0,10]}),this.add(this.button),this.cat=new $r(Ba.classes["TC-Cat"],{position:[95,0,11]}),this.add(this.cat);case 17:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"newSprite",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var r,a,o,n,i,s,l,d,c,u,p,m,f,g,h,v,_,b,S,E;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.src,a=void 0===r?"":r,o=t.id,n=void 0===o?a:o,i=t.frame,s=t.x,l=void 0===s?0:s,d=t.y,c=void 0===d?0:d,u=t.z,p=void 0===u?0:u,m=t.scale,f=void 0===m?[1,1,1]:m,g=t.pivot,h=void 0===g?[0,0]:g,v=t.visible,_=void 0===v||v,b=t.onMouseDown,S=t.onMouseUp,E=new Ct({id:n,src:"res/textures/"+a+".png",pixelsPerUnit:1,minFilter:"LINEAR_MIPMAP_NEAREST",magFilter:"LINEAR",pivot:h}),this.sprites[n]=new Fe({components:[E],transform:new Dt({position:[l,c,p],scale:f})}),this.add(this.sprites[n]),this.sprites[n].visible=_,b&&(this.sprites[n].onMouseDown=b),S&&(this.sprites[n].onMouseUp=S),b||S||(this.sprites[n].pointerEvents=!1);case 8:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(Tt),La=4500,Fa=function(e){function t(){var e;return a(this,t),e=c(this,s(t).call(this)),e.renderPasses=[new St({viewportClear:!0})],e.mouseDown=!1,e.defaultZoom=0,e.listenerClick={handleEvent:function(t){return e.onClick(t)}},e.listenerMouseDown={handleEvent:function(t){return e.onMouseDown(t)}},e}return i(t,e),n(t,[{key:"onload",value:function(){var e=this;this.viewports[0].id=0,this.camera?game.router.map.game.module.isNextLevelBonus()?this.animateBonus():this.animate():(this.camera=new ze({projectionType:"orthographic",transform:new Dt({position:[0,0,100]})}),this.add(this.camera),this.viewports[0].bindToCamera(this.camera),this.renderPasses=[new St],this.loadScene().then(function(){e.animate()})),this.viewportElements[0].addEventListener("mousedown",this.listenerMouseDown,!1),this.viewportElements[0].addEventListener("touchstart",this.listenerMouseDown,!1),this.viewportElements[0].addEventListener("mouseup",this.listenerClick,!1),this.viewportElements[0].addEventListener("touchend",this.listenerClick,!1)}},{key:"onunload",value:function(){this.viewportElements[0].removeEventListener("mousedown",this.listenerMouseDown,!1),this.viewportElements[0].removeEventListener("touchstart",this.listenerMouseDown,!1),this.viewportElements[0].removeEventListener("mouseup",this.listenerClick,!1),this.viewportElements[0].removeEventListener("touchend",this.listenerClick,!1)}},{key:"onComplete",value:function(){var e=!0,t=!1,r=void 0;try{for(var a=this.components[Symbol.iterator](),o,n;!(e=(o=a.next()).done);e=!0)n=o.value,this.removeComponent(n)}catch(e){t=!0,r=e}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}var i=["TC-Background","TC-LOGO-MnR"],s=!0,l=!1,d=void 0;try{for(var c=game.textures[Symbol.iterator](),u,p;!(s=(u=c.next()).done);s=!0)p=u.value,i.includes(p.src.replace("res/textures/","").replace(".png",""))&&p.unload(this.viewports[0])}catch(e){l=!0,d=e}finally{try{s||null==c["return"]||c["return"]()}finally{if(l)throw d}}}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onClick",value:function(){game.playSFX("0000"),this.next(750)}},{key:"next",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3;this.complete||(this.complete=!0,this.onunload(),game.stopMusic("AO-CN-Intro",t),this.transitionCircle.cover(function(){e.onComplete(),e.complete=!1,router.navigate("game")}))}},{key:"loadScene",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.viewports[0].orthoHeight,r=t*(16/9),this.transitionCircle=new Pa(r/2,t/2,10,r*game.SPRITE_SCALE),this.add(this.transitionCircle),this.bgLayer0=new $r(Ba.classes["Background-Intro-Base"],{position:[r/2,t/2,10]}),this.add(this.bgLayer0),this.bgLayer1=new $r(Ba.classes["Background-Intro-Buildings"],{position:[r/2,t/2,11]}),this.add(this.bgLayer1);case 8:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"animate",value:function(){var e=this,t=this.viewports[0].orthoHeight;game.playMusic("AO-CN-Intro"),this.setTween({propParent:this.bgLayer0.transform,property:"sx",to:1.2,from:1.05,duration:La,method:"easeIn",onUpdate:function(){e.bgLayer0.transform.sy=e.bgLayer0.transform.sx},onComplete:function(){e.next()}}),this.setTween({propParent:this.bgLayer1.transform,property:"sx",to:1.31,from:1.05,duration:La,method:"easeIn",onUpdate:function(){e.bgLayer1.transform.sy=e.bgLayer1.transform.sx}}),this.setTween({propParent:this.bgLayer1.transform,property:"y",to:t/2-25,from:t/2,duration:La,method:"easeIn"}),this.transitionCircle.uncover()}}]),t}(Tt),Ha=[],Ra=function(e){function t(e){var r=e.gravity,o=void 0===r?1:r,n=e.speed,i=void 0===n?1:n,l=e.bounds,d=void 0===l?{left:-Infinity,right:1/0,top:1/0,bottom:-Infinity}:l,u;return a(this,t),u=c(this,s(t).call(this)),u.gravity=o,u.bounds=d,u.speed=i,u}return i(t,e),n(t,[{key:"update",value:function(e,r){p(s(t.prototype),"update",this).apply(this,arguments);var a=this.speed*(e/(1e3/60));Ha=g(r.entities);var o=!0,n=!1,i=void 0;try{for(var l=Ha[Symbol.iterator](),d;!(o=(d=l.next()).done);o=!0){var c=d.value,u=c.body;if(u&&u.enabled&&c.enabled){this.applyGravity(u,a),u.applyVelocity(a),u.limitedToWorld&&0>=u.velocity[1]&&c.transform.y+u.bottom<this.bounds.bottom?(!u.onHitFloor&&u.velocity[1]&&(u.isOnFloor=!0,c.onHitFloor({bodyA:u,entityA:c})),c.transform.y=this.bounds.bottom-u.bottom,u.velocity[1]=-u.velocity[1]*u.restitution,u.velocity[0]*=u.friction):0>=u.velocity[1]&&c.transform.y+u.bottom<u.bounds.bottom?(!u.onHitFloor&&u.velocity[1]&&(u.isOnFloor=!0,c.onHitFloor({bodyA:u,entityA:c})),c.transform.y=u.bounds.bottom-u.bottom,u.velocity[1]=-u.velocity[1]*u.restitution,u.velocity[0]*=u.friction):u.isOnFloor=!1,u.limitedToWorld&&u.limitedToUpperBounds&&0<=u.velocity[1]&&c.transform.y+u.height>this.bounds.top?(c.transform.y=this.bounds.top-u.height,u.velocity[1]=-u.velocity[1]*u.restitution,u.velocity[0]*=u.friction):0<=u.velocity[1]&&c.transform.y+u.height>u.bounds.top?(c.transform.y=u.bounds.top-u.height,u.velocity[1]=-u.velocity[1]*u.restitution,u.velocity[0]*=u.friction):u.isOnFloor=!1,u.limitedToWorld&&c.transform.x+u.left<this.bounds.left?(c.transform.x=this.bounds.left-u.left,u.velocity[0]=-u.velocity[0]*u.restitution):u.limitedToWorld&&c.transform.x+(u.width+u.left)>this.bounds.right&&(c.transform.x=this.bounds.right-(u.width+u.left),u.velocity[0]=-u.velocity[0]*u.restitution);var m=!0,f=!1,y=void 0;try{for(var h=Ha[Symbol.iterator](),v,x;!(m=(v=h.next()).done);m=!0)if(x=v.value,c!==x&&x.enabled){var _=x.body;if(_&&_.enabled&&u.collidable&&_.collidable&&this.boxCollision(c.transform.x+u.left,c.transform.y+u.bottom,u.width,u.height,x.transform.x+_.left,x.transform.y+_.bottom,_.width,_.height)){var b={entityA:c,entityB:x,bodyA:u,bodyB:_,world:this,direction:{}};u.solidBody&&_.solidBody&&"undefined"!=typeof c.transformPreviousFrame&&"undefined"!=typeof x.transformPreviousFrame&&c.transformPreviousFrame&&x.transformPreviousFrame&&(b.direction=this.getCollisionDirection(b),!u.isSensor&&!_.isSensor&&((b.direction.left||b.direction.right)&&(u.velocity[0]=-u.velocity[0]*u.restitution),(b.direction.top||b.direction.bottom)&&(u.velocity[1]=-u.velocity[1]*u.restitution),(b.direction.left||b.direction.right)&&(u.velocity[0]*=u.friction),(b.direction.top||b.direction.bottom)&&(u.velocity[1]*=u.friction),(b.direction.left||b.direction.right)&&(c.transform.x+u.left+u.width/2>x.transform.x+_.left+_.width/2?c.transform.x=x.transform.x+_.left+_.width-u.left:c.transform.x+u.left+u.width/2<x.transform.x+_.left+_.width/2&&(c.transform.x=x.transform.x+_.left-(u.left+u.width))),(b.direction.top||b.direction.bottom)&&(c.transform.y+u.bottom+u.height/2>x.transform.y+_.bottom+_.height/2?c.transform.y=x.transform.y+_.bottom+_.height-u.bottom:c.transform.y+u.bottom+u.height/2<x.transform.y+_.bottom+_.height/2&&(c.transform.y=x.transform.y+_.bottom-(u.bottom+u.height))))),c.onCollide&&c.onCollide.bind(c)(b,x),x.onCollide&&x.onCollide.bind(x)(b,c)}}}catch(e){f=!0,y=e}finally{try{m||null==h["return"]||h["return"]()}finally{if(f)throw y}}}}}catch(e){n=!0,i=e}finally{try{o||null==l["return"]||l["return"]()}finally{if(n)throw i}}}},{key:"applyGravity",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;e.solidBody&&e.applyForce(0,-this.gravity*e.gravityScale*t*e.speed)}},{key:"boxCollision",value:function(e,t,r,a,o,n,i,s){return!(t+a<=n||t>=n+s||e>=o+i||e+r<=o)}},{key:"getCollisionDirection",value:function(e){return{left:e.entityA.transformPreviousFrame.x+e.bodyA.left+e.bodyA.width<=e.entityB.transform.x+e.bodyB.left&&e.entityA.transform.x+e.bodyA.left+e.bodyA.width>e.entityB.transform.x+e.bodyB.left,right:e.entityA.transformPreviousFrame.x+e.bodyA.left>e.entityB.transform.x+e.bodyB.left+e.bodyB.width&&e.entityA.transform.x+e.bodyA.left<=e.entityB.transform.x+e.bodyB.left+e.bodyB.width,top:e.entityA.transformPreviousFrame.y+e.bodyA.bottom>=e.entityB.transform.y+e.bodyB.bottom+e.bodyB.height&&e.entityA.transform.y+e.bodyA.bottom<e.entityB.transform.y+e.bodyB.bottom+e.bodyB.height,bottom:e.entityA.transformPreviousFrame.y+e.bodyA.bottom+e.bodyA.height<e.entityB.transform.y+e.bodyB.bottom&&e.entityA.transform.y+e.bodyA.bottom+e.bodyA.height>=e.entityB.transform.y+e.bodyB.bottom}}}]),t}(Pe),Na=function(e){function t(){var e;a(this,t),e=c(this,s(t).call(this)),e.CONFIG=Ba,e.editMode=!1,e.showDebug=!1,e.actors={},e.classes={},e.selectedObject=null,e.selectedPointerStartPos=[0,0],e.selectedActorStartPos=[0,0],e.hoverItem=null,e.hasSeenInstructions=!1,e.mouseState={isTouch:!1,position:{x:0,y:0},buttons:[]},e.killHits=0,e.score=0,e.combo=1,e.health=1,e.breadCount=Ba.meta.startingBreadCount,e.currentCombo=null,e.missedItems=[],e.isGameover=!1,e.isJunkComplete=!1,e.isLevelComplete=!1,e.highscores=[];var r=window.localStorage.getItem("ao_mnr_highscore");e.highscores=r?JSON.parse(r):g(Ba.meta.defaultHighScores),e.selectedObjects=[],e.lines=[],e.levelsPlayed=[],e.dayCount=0,e.bonusLevelCount=0,e.week=0;var o=location.search.substring(1);return e.URLparams=o?JSON.parse("{\""+decodeURI(o).replace(/"/g,"\\\"").replace(/&/g,"\",\"").replace(/=/g,"\":\"")+"\"}"):{},e}return i(t,e),n(t,[{key:"onload",value:function(){var e=this;this.viewports=game.router.map.preloader.module.viewports,this.camera?this.loadScene():(this.camera=new ze({projectionType:"orthographic",transform:new Dt({position:[0,0,100]})}),this.add(this.camera),this.viewports[0].bindToCamera(this.camera),this.renderPasses=[new St],this.camera.velocityX=0,this.camera.velocityY=0,this.viewports[0].clearColor.set(0,0,0),game.router.map.title.module.trophyClick?(this.loadScoreboard(),this.transitionCircle=new Pa(0,0,10,2*this.viewports[0].orthoHeight),this.add(this.transitionCircle),this.setTimeout(function(){e.transitionCircle.uncover()},100)):this.loadScene(),this.setupListeners(),this.camera.visible=!1)}},{key:"loadScene",value:function(){var e=r(regeneratorRuntime.mark(function e(t){var a=this,o=arguments,n,s,l,d,c,u,p,m,f,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=1<o.length&&void 0!==o[1]?o[1]:Ba.layouts[t],s=!(2<o.length&&void 0!==o[2])||o[2],l=!1,Fe.resetIndex(100),t||n||(t=this.getNextLevel(),n=Ba.layouts[t],l=-1<t.indexOf("Bonus"),!l&&this.dayCount++),28<this.dayCount&&(this.dayCount=1),s&&this.levelsPlayed.push(t),this.layout=n,this.combo=1,this.currentCombo=null,this.health=1>=this.week?n.config.playerHealth:ne(n.config.playerHealth-(this.week-1),1),this.killHits=0,this.missedItems=[],this.isGameover=!1,this.isJunkComplete=!1,this.isLevelComplete=!1,this.world=this.addComponent(new Ra({bounds:n.bounds,speed:n.config.speed*le(Ba.meta.allLevelsPlayedSpeedMultiplier,this.week)})),this.width=this.world.bounds.right,this.height=this.world.bounds.top,this.groundEndY=n.groundEndY,this.cameras[0].transform.xyz=n.cameraPosition,this.cameras[0].transform.sxyz=n.cameraScale||[1,1,1],this.transform.sxyz=[1,1,1],d=this.viewports[0].orthoHeight*this.cameras[0].transform.sy,c=d*(16/9),(u=0,p=Object.values(n.actors));u<p.length;u++)m=p[u],this.addActor(m);for(this.transitionCircle?this.transitionCircle.reset():(this.transitionCircle=new Pa(0,0,10,2*this.viewports[0].orthoHeight),this.add(this.transitionCircle)),this.txtScore=new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"NU",glyphCharacters:"0123456789,-+./x",text:(this.score+"").padStart(6,0),align:"center",alignVertical:"bottom",tracking:-2}),this.txtScore.transform.xyz=[700,60,80],this.txtScore.transform.sxyz=[1,1,1],this.add(this.txtScore),this.txtCombo=new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"NU",glyphCharacters:"0123456789,-+./x",text:"x1",align:"center",alignVertical:"bottom",tracking:-2}),this.txtCombo.transform.xyz=[700,118,80],this.txtCombo.transform.sxyz=[.5,.5,1],this.bread=[],f=0;f<this.breadCount;f++)this.addBread();return 0<this.week&&(g=this.getItemsByClass("Duck")[0],g&&(g.state="waiting")),l||this.addActor({cls:"UI-Calendar-Mini",position:[810,380,.5],scale:[.3,.3,1],HSV:[0,0,-.2]}),e.abrupt("return",new Promise(function(e){a.transitionCircle.transform.xyz=[a.cameras[0].transform.x*a.cameras[0].transform.sx+c/2,a.cameras[0].transform.y*a.cameras[0].transform.sy+d/2,99],a.setTimeout(function(){a.music||(a.music=n.music,game.playMusic(a.music)),a.transitionCircle.uncover(r(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a.transitionCircle.visible=!1,a.changeZoom(n.config.zoom),a.setTimeout(r(regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.hasSeenInstructions){t.next=3;break}return t.next=3,a.showInstructions();case 3:a.hasSeenInstructions=!0,l||a.addActor({cls:"UI-Calendar",position:[a.cameras[0].transform.x*a.cameras[0].transform.sx+c/2,a.cameras[0].transform.y*a.cameras[0].transform.sy+d/2,80]}),a.viewports[0].mouseEventRenderPick=!1,a.viewports[0].mouseEventHover=!1,r=a.getItemsByClass("OB-Cat")[0],r&&r.enterRoom(),e();case 10:case"end":return t.stop();}},t)})),1e3);case 3:case"end":return t.stop();}},t)})))},500)}));case 39:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showInstructions",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t=this,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.viewports[0].orthoHeight*this.cameras[0].transform.sy,a=r*(16/9),e.abrupt("return",new Promise(function(e){t.addActor({cls:"UI-Instructions",position:[t.cameras[0].transform.x*t.cameras[0].transform.sx+a/2,t.cameras[0].transform.y*t.cameras[0].transform.sy+r/2,85],events:{onMouseDown:function(){this.flyAway(),e()}}})}));case 3:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"unloadScene",value:function(){var e=r(regeneratorRuntime.mark(function e(){var t=this,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.viewports[0].orthoHeight*this.cameras[0].transform.sy,a=r*(16/9),e.abrupt("return",new Promise(function(e){t.music&&(game.stopMusic(t.music,250),t.music=null),t.transitionCircle.transform.xyz=[t.cameras[0].transform.x*t.cameras[0].transform.sx+a/2,t.cameras[0].transform.y*t.cameras[0].transform.sy+r/2,99],t.transitionCircle.cover(function(){t.removeComponent(t.world);for(var r=0,a=Object.values(t.actors);r<a.length;r++){var o=a[r],n=!0,i=!1,s=void 0;try{for(var l=o[Symbol.iterator](),d,c;!(n=(d=l.next()).done);n=!0)c=d.value,t.remove(c)}catch(e){i=!0,s=e}finally{try{n||null==l["return"]||l["return"]()}finally{if(i)throw s}}}t.remove(t.txtScore),t.remove(t.txtCombo);var u=!0,p=!1,m=void 0;try{for(var f=t.entities[Symbol.iterator](),g,y;!(u=(g=f.next()).done);u=!0)y=g.value,y instanceof ca&&t.remove(y,!0)}catch(e){p=!0,m=e}finally{try{u||null==f["return"]||f["return"]()}finally{if(p)throw m}}var h=!0,v=!1,x=void 0;try{for(var _=t.components[Symbol.iterator](),b,S;!(h=(b=_.next()).done);h=!0)S=b.value,S instanceof Xt&&t.removeComponent(S)}catch(e){v=!0,x=e}finally{try{h||null==_["return"]||_["return"]()}finally{if(v)throw x}}var E=!0,A=!1,T=void 0;try{for(var k=t.components[Symbol.iterator](),B,O;!(E=(B=k.next()).done);E=!0)O=B.value,O instanceof Gt&&t.removeComponent(O)}catch(e){A=!0,T=e}finally{try{E||null==k["return"]||k["return"]()}finally{if(A)throw T}}t.actors={},e()})}));case 3:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"changeScenes",value:function(){var e=r(regeneratorRuntime.mark(function e(t,r,a){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadScene();case 2:return e.next=4,this.loadScene(t,r,a);case 4:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showIntro",value:function(){var e=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadScene();case 2:router.navigate("intro"),document.getElementById("debug")&&(document.getElementById("debug").innerHTML="");case 4:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"restartGame",value:function(){var e=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadScene();case 2:this.levelsPlayed=[],this.dayCount=0,this.week=0,this.score=0,this.breadCount=Ba.meta.startingBreadCount,this.showIntro();case 8:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"continueGame",value:function(){var e=r(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.unloadScene();case 2:this.changeScenes(void 0,this.layout,!1);case 3:case"end":return e.stop();}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getNextLevel",value:function(){if(this.isNextLevelBonus())return Ba.layouts["Stage-Bonus-"+(this.bonusLevelCount+1)]||(this.bonusLevelCount=0),"Stage-Bonus-"+(this.bonusLevelCount+1);var e=Object.keys(Ba.layouts).filter(function(e){return 0>e.indexOf("Bonus")});this.levelsPlayed.filter(function(e){return 0>e.indexOf("Bonus")}).length===e.length&&(this.levelsPlayed=[],this.week++);var t=!0,r=!1,a=void 0;try{for(var o=e[Symbol.iterator](),n,i;!(t=(n=o.next()).done);t=!0)if(i=n.value,0>this.levelsPlayed.indexOf(i))return i}catch(e){r=!0,a=e}finally{try{t||null==o["return"]||o["return"]()}finally{if(r)throw a}}}},{key:"isNextLevelBonus",value:function(){return(!this.layout||0>this.layout.levelId.toLowerCase().indexOf("bonus"))&&0<this.dayCount&&0==this.dayCount%Ba.meta.daysBetweenBonusLevels}},{key:"addActor",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],r=e.cls,a;return void 0===Ba.classes[r]?void console.log("Actor class \"".concat(r,"\" does not exist.")):(a=Ba.classes[r].behavior?new Ba.classes[r].behavior(Ba.classes[r],e):new $r(Ba.classes[r],e),this.actors[r]||(this.actors[r]=[]),this.actors[r].push(a),t&&this.add(a),a)}},{key:"removeActor",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(e){var r=this.actors[e.className].indexOf(e);this.actors[e.className].splice(r,1),t&&this.remove(e)}}},{key:"setupListeners",value:function(){var e=this,t=function(t){var r=e.viewports[0].orthoHeight,a=r*(16/9),o=e.viewports[0].contextElement.getBoundingClientRect(),n=r/o.height,i=t.clientX,s=t.clientY;t.targetTouches&&t.targetTouches[0]&&(i=t.targetTouches[0].clientX,s=t.targetTouches[0].clientY),i-=o.left,s-=o.top,s=o.height-s,i*=n*e.cameras[0].transform.sx,s*=n*e.cameras[0].transform.sy,i/=e.transform.sx,s/=e.transform.sy,i-=(a-a*e.transform.sx)/2,s-=(r-r*e.transform.sy)/2,e.mouseState.position.x=i,e.mouseState.position.y=s};window.addEventListener("mousedown",function(r){e.mouseState.isTouch=!1,t(r),e.mouseState.buttons[0]=1}),window.addEventListener("mouseup",function(t){e.mouseState.buttons[0]=0,t.target!==e.viewports[0].contextElement&&(e.selectedObject=null)}),window.addEventListener("touchstart",function(r){e.mouseState.isTouch=!0,t(r),e.mouseState.buttons[0]=1}),window.addEventListener("touchend",function(t){t.target!==e.viewports[0].contextElement&&(e.selectedObject=null),console.log(1),e.mouseState.position.x=-10,e.mouseState.position.y=-10,e.mouseState.buttons[0]=0});var r=function(){e.cameraPanLeft=!1,e.cameraPanRight=!1};this.viewports[0].contextElement.addEventListener("mouseleave",r),this.viewports[0].contextElement.addEventListener("touchleave",r);var a=function(r){e.mouseState.buttons[0]=1,t(r)};this.viewports[0].contextElement.addEventListener("mousemove",a),this.viewports[0].contextElement.addEventListener("touchmove",a),window.addEventListener("keypress",function(t){return void("S"===t.key&&t.shiftKey&&(e.highscores=g(Ba.meta.defaultHighScores),window.localStorage.setItem("ao_mnr_highscore",JSON.stringify(e.highscores))));var r=t.code.replace("Digit","")}),this.viewports[0].contextElement.style.cursor="pointer"}},{key:"update",value:function(){var e=this;this.editMode||p(s(t.prototype),"update",this).apply(this,arguments);var r=[].concat(g(this.getItemsByClass("Junk")),g(this.getItemsByClass("Kata")),g(this.getItemsByClass("Duffel")),g(this.getItemsByClass("Duckling"))),a=!0,o=!0,n=!1,i=void 0;try{for(var l=r[Symbol.iterator](),d,c;!(o=(d=l.next()).done);o=!0)if(c=d.value,!c.body.isSleeping()&&!c.isHit){a=!1;break}}catch(e){n=!0,i=e}finally{try{o||null==l["return"]||l["return"]()}finally{if(n)throw i}}if(!this.isGameover&&!this.isLevelComplete&&this.isJunkComplete&&a&&(this.levelComplete(),this.setTimeout(function(){e.changeScenes()},5e3)),this.health=ne(this.health,0),this.score=ne(this.score,0),!this.isGameover&&0>=this.health&&this.gameover(),this.cameraPanLeft&&(this.cameras[0].velocity[0]+=1.2),this.cameraPanRight&&(this.cameras[0].velocity[0]-=1.2),this.txtScore){var u=1*this.txtScore.value.replace(",","");u!=this.score&&(this.txtScore.value=u+oe((this.score-u)/4)+""),this.txtScore.visible=0<this.score,5>ye(u-this.score)&&(this.txtScore.value=this.score+"")}if(this.txtCombo){var m=this.currentCombo?this.currentCombo.count:1;this.txtCombo.value="x"+m,this.txtCombo.HSV[0]=m/12}}},{key:"sortEntitiesByY",value:function(){var e=!0,t=!1,r=void 0;try{for(var a=this.entities[Symbol.iterator](),o,n;!(e=(o=a.next()).done);e=!0)if(n=o.value,n.className&&n.sortableY){var i=0;i=n.body?n.body.bounds.bottom:n.transform.y;var s=3-i/1e4;-1<n.className.indexOf("Particle")&&(s+=1),this.selectedObject===n&&(s+=1),n.transform.z=s}}catch(e){t=!0,r=e}finally{try{e||null==a["return"]||a["return"]()}finally{if(t)throw r}}this.sortEntitiesByZ(!0)}},{key:"addBread",value:function(){var e=this.bread.length,t=this.addActor({cls:"OB-Bread",position:[1200-(20*e+5*Math.random()),100,80-e],isPersistent:!1},!0);this.bread.push(t)}},{key:"getItemsByClass",value:function(e){var t=[];this.actors[e]&&t.push.apply(t,g(this.actors[e]));for(var r=0,a=Object.values(this.actors),o;r<a.length;r++)o=a[r],o.length&&o[0].constructorName===e&&t.push.apply(t,g(o));return t}},{key:"randomizeList",value:function(e){for(var t=e.length-1;0<t;t--){var r=ue(Math.random()*(t+1)),a=e[t];e[t]=e[r],e[r]=a}}},{key:"onMouseUp",value:function(e){this.selectedObject&&(this.selectedObject.setGroundLevel(),this.selectedObject.onMouseUp(e),this.selectedObject=null)}},{key:"onMouseOver",value:function(){this.hoverItem=null}},{key:"changeZoom",value:function(e){this.setTween({propParent:this.transform,property:"sx",method:"easeInCubic",to:e,from:this.transform.sx,duration:1e3}),this.setTween({propParent:this.transform,property:"sy",method:"easeInCubic",to:e,from:this.transform.sx,duration:1e3})}},{key:"lineComplete",value:function(){var e=this,t=this.getItemsByClass("Box")[0],r="",a=1,o=0,n=!0,i=!1,s=void 0;try{for(var l=this.selectedObjects[Symbol.iterator](),d,c;!(n=(d=l.next()).done);n=!0)if(c=d.value,c.selected&&!c.collected){var u=c.data.value;c.collected=!0,c.className===r?a++:a=1,r=c.className,console.log("Bonus x".concat(a,".")),u*=a,this.score+=u,o+=u,this.showScore(u,c),c.sendToBox(t)}}catch(e){i=!0,s=e}finally{try{n||null==l["return"]||l["return"]()}finally{if(i)throw s}}var p=!0,m=!1,f=void 0;try{for(var g=this.lines[Symbol.iterator](),y,h;!(p=(y=g.next()).done);p=!0)h=y.value,this.removeActor(h)}catch(e){m=!0,f=e}finally{try{p||null==g["return"]||g["return"]()}finally{if(m)throw f}}o&&this.setTimeout(function(){e.showScore(o,t)},500),this.selectedObjects=[],console.log("Add score: ".concat(score,". Total score: ").concat(this.score))}},{key:"showScore",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3,r=1<arguments.length?arguments[1]:void 0,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[0,0,0],n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,i=5<arguments.length&&void 0!==arguments[5]?arguments[5]:[0,0,0],s=new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"NU",glyphCharacters:"0123456789,-+./x",text:t,align:"center",tracking:-2});s.transform.xyz=[r.transform.x+i[0],r.transform.y+i[1],99],s.transform.sxyz=[a,a,1],s.HSV=o,this.add(s),this.setTween({propParent:s.transform,property:"y",from:r.transform.y+10,to:r.transform.y+80,duration:1e3*n,method:"easeIn",onComplete:function(){e.remove(s)}})}},{key:"levelComplete",value:function(){var e=this.getItemsByClass("CH-Apple")[0],t=this.getItemsByClass("CH-Onion")[0],r=this.getItemsByClass("OB-Cat")[0],a=this.getItemsByClass("OB-Duck")[0],o=this.getItemsByClass("UI-Calendar-Mini")[0],n=this.getItemsByClass("Background-1")[0],i=this.getItemsByClass("Background-1-Sky-Day")[0];if(this.isLevelComplete=!0,this.changeZoom(1),e&&t&&r){var s=this.levelsPlayed.length%7;if(e.wakeup(s),t.wakeup(s),r.state="sleep",this.setTween({propParent:n.HSV,property:[2],to:0,from:n.HSV[2],duration:1e3,onUpdate:function(a){e.HSV[2]=a,t.HSV[2]=a,r.HSV[2]=a,o.HSV[2]=a}}),this.setTween({propParent:i,property:"opacity",to:1,from:0,duration:1e3}),a&&this.setTween({propParent:a,property:"opacity",to:0,from:1,duration:1e3}),!this.missedItems.length){var l=this.getItemsByClass("OB-Box-LG")[0];l&&l.close()}}}},{key:"gameover",value:function(){var e=this,t=this.getItemsByClass("CH-Apple")[0],a=this.getItemsByClass("CH-Onion")[0],o=this.getItemsByClass("OB-Cat")[0];t&&a&&o&&(this.isGameover=!0,this.setTimeout(function(){t.state="wakeup-gameover",a.state="wakeup-gameover",o.state="sleep",game.playSFX("SO-Scratch"),game.playSFX(["0527","0529","0722","0732","0803","0804"][0|6*Math.random()])},750),this.setTimeout(function(){},1500),this.setTimeout(r(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.unloadScene();case 2:e.loadScoreboard(),e.transitionCircle.uncover();case 4:case"end":return t.stop();}},t)})),3e3),game.stopMusic(this.music,0),this.music=null,this.changeZoom(1))}},{key:"loadScoreboard",value:function(){this.viewports[0].mouseEventRenderPick=!0,this.viewports[0].mouseEventHover=!0,this.highscores.push(this.score),this.highscores.sort(function(e,t){return t-e}),this.highscores.splice(10,1e3),window.localStorage.setItem("ao_mnr_highscore",JSON.stringify(this.highscores));var e=this.addActor({cls:"GO-Butt",position:[240,410,10],scale:[1.1,1.1,1],events:{onMouseDown:function(){this.state="select",this.components[1].transform.x=55,this.components[1].transform.y=-60},onMouseUp:function(){this.state="idle",this.components[1].transform.x=35,this.components[1].transform.y=-40,game.stopMusic("SO-GameOver"),game.playSFX("SO-ButtonPress"),game.router.map.game.module.restartGame()},onMouseOver:function(){this.transform.sxyz=[1.15,1.15,1.15]}}},!0),t=this.addActor({cls:"GO-Butt",position:[1140,410,10],scale:[1.1,1.1,1],flipX:!0,events:{onMouseDown:function(){this.state="select",this.components[1].transform.x=-55,this.components[1].transform.y=-60,this.components[0].transform.x=-20,this.components[2].transform.x=-65,this.components[2].transform.y=116},onMouseUp:function(){this.state="idle",this.components[1].transform.x=-35,this.components[1].transform.y=-40,this.components[0].transform.x=0,this.components[2].transform.x=-45,this.components[2].transform.y=136,game.stopMusic("SO-GameOver"),game.playSFX("SO-ButtonPress"),game.router.map.game.module.continueGame()},onMouseOver:function(){this.transform.sxyz=[1.15,1.15,1.15]}}},!0);this.dayCount||(t.visible=!1),this.bkgGameover=this.addActor({cls:"Background-Gameover",events:{onMouseOver:function(){e.components[1].transform.x=35,e.components[1].transform.y=-40,e.transform.sxyz=[1,1,1],t.components[0].transform.x=0,t.components[1].transform.x=-35,t.components[1].transform.y=-40,t.components[2].transform.x=-45,t.components[2].transform.y=136,t.transform.sxyz=[1,1,1],e.state="idle",t.state="idle"}}},!0),e.addComponent(new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"Calendar",glyphCharacters:"0123456789",text:"1",align:"center",alignVertical:"bottom",tracking:-2,pointerEvents:!1,transform:new Dt({position:[35,-40,10],scale:[1,1,1]})})),t.addComponent(new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"Calendar",glyphCharacters:"0123456789",text:this.dayCount,align:"center",alignVertical:"bottom",tracking:-2,pointerEvents:!1,transform:new Dt({position:[-35,-40,10],scale:[1,1,1]})})),t.addComponent(this.addActor({cls:"GO-CatTail",position:[-45,136,10]},!1));var r=this.highscores.indexOf(this.score)+1,a=[];a=1===r?["0415"]:1<r?["0137","0457","0844","0848","0939","1004","1013","1031"]:["0252","0509","0543","1030"],this.score||(a=["0714"]),this.dayCount&&game.playSFX(a[0|Math.random()*a.length]),0<r&&this.addActor({cls:1===r?"UI-Trophy-2":"UI-Trophy-1",position:[700,680,10],scale:[1.1,1.1,1],onMouseDown:function(){game.playSFX("SO-GoldTrophy")}},!0);for(var o=0;o<this.highscores.length;o++){var n=(o+1+"").padEnd(10,"."),s=[0,-1,0];this.highscores[o]===this.score&&(s=[.05,1,0]),this.add(new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"NU",glyphCharacters:"0123456789,-+./x",text:n,align:"left",alignVertical:"bottom",tracking:-2,HSV:s,transform:new Dt({position:[550,540-37*o,80],scale:[.62,.62,1]})})),this.add(new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"NU",glyphCharacters:"0123456789,-+./x",text:this.highscores[o],align:"right",alignVertical:"bottom",tracking:-2,HSV:s,transform:new Dt({position:[850,540-37*o,80],scale:[.62,.62,1]})}))}this.txtScore=new ca({glyphSpriteSheet:game.spritesheets["ao-jp-glyphs.json"],glyphAnimation:"NU",glyphCharacters:"0123456789,-+./x",text:this.score+"",align:"center",alignVertical:"bottom",tracking:-2}),this.txtScore.transform.xyz=[700,60,80],this.txtScore.transform.sxyz=[1,1,1],this.add(this.txtScore),this.sortEntitiesByZ(!0),game.playMusic("SO-GameOver")}},{key:"junkComplete",value:function(){this.isJunkComplete=!0}},{key:"addMissedItem",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.missedItems.push(e);var r=e.data.damage;t&&(this.health-=r)}},{key:"shakeCamera",value:function(){var e=this,t=20,r=1;this.setInterval(function(){var a=Math.random()*me*r,o=ge(a)*t,n=fe(a)*t;e.cameras[0].transform.x+=o,e.cameras[0].transform.y+=n,t*=.95,r=1===r?-1:1},0,5e3/(1e3/60))}},{key:"save",value:function(){var e=JSON.parse(JSON.stringify(this.layout.config));e.speed=this.world.speed,e.gravity=this.world.gravity;for(var t={levelId:this.layout.levelId,music:this.music,gravity:this.world.gravity,bounds:this.world.bounds,cameraPosition:g(this.cameras[0].transform.xyz),cameraScale:g(this.cameras[0].transform.sxyz),groundEndY:this.groundEndY,actors:[],config:e},r=0,a=Object.keys(this.actors);r<a.length;r++){var o=a[r],n=!0,i=!1,s=void 0;try{for(var l=this.actors[o][Symbol.iterator](),d,c;!(n=(d=l.next()).done);n=!0)c=d.value,c.save()&&t.actors.push(c.save())}catch(e){i=!0,s=e}finally{try{n||null==l["return"]||l["return"]()}finally{if(i)throw s}}}document.getElementById("json").value="export default "+JSON.stringify(t)}},{key:"load",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:document.getElementById("json").value;if(t)try{var r=JSON.parse(t.replace("export default ",""));this.toggleEditor(),this.setTimeout(function(){return e.changeScenes(void 0,r)})}catch(t){}}},{key:"toggleEditor",value:function(){this.editMode=!this.editMode;var e=document.getElementById("editor");e.style.display=this.editMode?"":"none"}},{key:"addActorToScene",value:function(e){var t=document.getElementById("actor-classes").value,r=1;"OB-Apple"===t&&(r=.35),this.addActor({cls:t,position:[this.cameras[0].transform.x+this.width/2,this.cameras[0].transform.y+this.height/2,1],scale:[r,r,1],flipX:e},!0)}},{key:"togglePhysics",value:function(){this.world.enabled=!this.world.enabled}}]),t}(Tt),Ua=new ve({elementId:"error-console",alertOnError:!1}),Ga;xe.AUTO_DETECT_DEVICE_PIXEL_RATIO=!0,xe.SHADOWS_VSM_ENABLED=!1,xe.LIGHTING_ENABLED=!1,xe.DIRECTIONAL_SHADOWS_ENABLED=!1,xe.DEFAULT_SHADOW_BIAS=1e-6,xe.MAX_LIGHTS=2;var Va=function(){function e(){a(this,e),this.music=[],this.sfx=[],this.spritesheets=[],this.textures={},this.SPRITE_SCALE=1366/1560/.75,this.router=new At({clock:new Qe,map:{preloader:{module:new Ma},title:{module:new Da},intro:{module:new Fa},game:{module:new Na}}})}return n(e,[{key:"toggleMute",value:function(){Howler.mute(!Howler._muted),document.getElementById("snd-btn").classList=Howler._muted?"off":"on"}},{key:"start",value:function(){this.router.navigate("preloader")}},{key:"playSFX",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length?arguments[2]:void 0;if(!this.sfx[e])return void console.warn("SFX '".concat(e,"' not found."));var a=this.sfx[e].play();return this.sfx[e].fade(0,1,t,r),a}},{key:"stopSFX",value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length?arguments[2]:void 0;this.sfx[e].once("fade",function(){t.sfx[e].stop(a)},a),this.sfx[e].fade(1,0,r,a)}},{key:"playMusic",value:function(e,t){t&&this.sfx[e].stop();var r=this.music[e].play();return this.music[e].volume(1,r),r}},{key:"stopMusic",value:function(e){var t=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,a=2<arguments.length?arguments[2]:void 0;this.music[e].fade(1,0,r,a),r&&window.setTimeout(function(){t.music[e].stop(),t.music[e].volume(1)},r)}},{key:"toggleErrorConsole",value:function(){"none"==Ua.consoleElement.display?Ua.hideConsole():Ua.showConsole()}}]),e}(),Xa,Ya,Wa;"undefined"==typeof document.hidden?"undefined"!=typeof document.msHidden&&(Xa="msHidden",Wa="msvisibilitychange",Ya="msVisibilityState"):(Xa="hidden",Wa="visibilitychange",Ya="visibilityState");var za=document[Xa];document.addEventListener(Wa,function(){za!=document[Xa]&&(document[Xa]?Howler.mute(!0):Howler.mute(!1),za=document[Xa])}),window.game=new Va,window.router=window.game.router,window.game.start()})();
