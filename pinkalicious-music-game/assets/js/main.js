!function(){var a=include("createjs.Tween"),b=include("createjs.Bitmap"),c=include("createjs.Container"),d=function(){},e=d.prototype;e.startHeadBob=function(b){var c=2e3+2500*Math.random(),d=c+2e3+2e3*Math.random(),e=1e3;a.get(b,{loop:!0}).wait(200).to({rotation:-1.5},1*e,createjs.Ease.getPowOut(3)).to({rotation:0},1*e,createjs.Ease.getPowOut(3)).to({rotation:2},1*e,createjs.Ease.getPowOut(1)).to({rotation:0},1*e,createjs.Ease.getPowOut(3)).wait(c).to({rotation:-3},1*e,createjs.Ease.getPowOut(3)).to({rotation:0},1*e,createjs.Ease.getPowOut(3)).to({rotation:4},1*e,createjs.Ease.getPowOut(1)).to({rotation:0},1*e,createjs.Ease.getPowOut(3)).wait(d)},e.startBodySway=function(b){var c=2e3+5e3*Math.random(),d=1e3;a.get(b,{loop:!0}).wait(c).to({rotation:-1},1.2*d,createjs.Ease.getPowOut(3)).to({rotation:1.2},1.8*d,createjs.Ease.getPowOut(3)).to({rotation:0},1*d,createjs.Ease.getPowOut(3))},e.setMouth=function(a,b){var c=app.voPlayer.getElapsed()/app.voPlayer.currentDuration,d=b[parseInt(c*b.length)];null===d||void 0===d||c>1||a.gotoAndStop(d)},e.startBlink=function(b){var c=1500+2e3*Math.random(),d=c+4e3+1e3*Math.random();a.get(b,{loop:!0}).wait(c).call(function(){b.framerate=6,b.gotoAndStop("blink")}).wait(d).call(function(){b.framerate=6,b.gotoAndPlay("blink")})},e.sparkleMeMany=function(c,d,f,g){var h=300;images.Sparkle&&(c.spark1=new b(images.Sparkle),c.spark1.regX=c.spark1.image.width/2,c.spark1.regY=c.spark1.image.width/2,d.addChild(c.spark1),e.setPosition(c.spark1,f.x,f.y),g||(c.spark1.scaleX=c.spark1.scaleY=1.5,a.get(c.spark1).wait(f.init_pause_fact*h).to({scaleX:.5,scaleY:.5,rotation:63,x:c.spark1.x+200*Math.random()-100,y:c.spark1.y+200*Math.random()-100},2*h).call(function(){d.removeChildAt(0)})))},e.sparkleMe1=function(d,f,g){var h=300;images.Sparkle&&(d.sparkles=new c,d.spark1=new b(images.Sparkle),d.spark1.regX=d.spark1.image.width/2,d.spark1.regY=d.spark1.image.width/2,d.sparkles.addChild(d.spark1),d.addChild(d.sparkles),e.setPosition(d.spark1,0,0),f.x?e.setPosition(d.sparkles,f.x,f.y):e.setPosition(d.sparkles,940,620),g||(d.spark1.scaleX=d.spark1.scaleY=0,a.get(d.spark1).wait(f.init_pause_fact*h).to({scaleX:1,scaleY:1,x:75,y:75},0).wait(h).to({scaleX:0,scaleY:0,x:10,y:10},0).to({scaleX:.5,scaleY:.5,rotation:21},h).to({scaleX:1,scaleY:1,rotation:63},2*h).to({rotation:230},2*h).to({rotation:430,alpha:0,scaleX:1.5,scaleY:1.5},h)))},e.sparkleMe3=function(d,f,g){var h=300,i=.75,j=.6;images.Sparkle&&(d.sparkles=new c,d.spark1=new b(images.Sparkle),d.spark2=new b(images.Sparkle),d.spark3=new b(images.Sparkle),d.spark1.regX=d.spark2.regX=d.spark3.regX=d.spark1.image.width/2,d.spark1.regY=d.spark2.regY=d.spark3.regY=d.spark1.image.width/2,d.spark2.rotation=22,d.spark3.rotation=-10,d.sparkles.addChild(d.spark1,d.spark2,d.spark3),d.addChild(d.sparkles),e.setPosition(d.spark1,0,0),e.setPosition(d.spark2,90,10),e.setPosition(d.spark3,-25,40),f?e.setPosition(d.sparkles,f.x,f.y):e.setPosition(d.sparkles,890,670),g||(d.spark1.scaleX=d.spark1.scaleY=0,d.spark2.scaleX=d.spark2.scaleY=0,d.spark3.scaleX=d.spark3.scaleY=0,a.get(d.spark1).wait(2.6*h).to({scaleX:1,scaleY:1,x:75,y:75},0).wait(h).to({scaleX:0,scaleY:0,x:10,y:10},0).to({scaleX:.5,scaleY:.5,rotation:21},h).to({scaleX:1,scaleY:1,rotation:63},2*h).to({rotation:230},2*h).to({rotation:430,alpha:0,scaleX:1.5,scaleY:1.5},h),a.get(d.spark2).wait(1.5*h).to({scaleX:1,scaleY:1},0).wait(h).to({scaleX:0,scaleY:0},0).to({scaleX:.5*i,scaleY:.5*i,rotation:21},.85*h).to({scaleX:1*i,scaleY:1*i,rotation:63},1.7*h).to({rotation:230},1.7*h).to({rotation:430,alpha:0,scaleX:2*i,scaleY:2*i},.85*h),a.get(d.spark3).to({scaleX:1,scaleY:1},0).wait(h).to({scaleX:0,scaleY:0},0).to({scaleX:.5*j,scaleY:.5*j,rotation:21},1.2*h).to({scaleX:1*j,scaleY:1*j,rotation:63},2.4*h).to({rotation:230},2.4*h).to({rotation:430,alpha:0,scaleX:2*j,scaleY:2*j},1.2*h)))},e.setPosition=function(a,b,c,d){a.x=b,a.y=c,d&&(d.x=b,d.y=c)},namespace("WGBH").SharedAnimation=d}(),function(){var a=include("createjs.Container"),b=include("createjs.Tween"),c=include("createjs.Bitmap"),d=function(){},e=d.prototype;e.swayAnimation=function(a,c,d,e,f){a.rotation=e,b.get(a,{loop:!0,override:!0}).to({rotation:c},f,createjs.Ease.getPowOut(2)).to({rotation:e},f,createjs.Ease.getPowIn(2)).to({rotation:d},f,createjs.Ease.getPowOut(2)).to({rotation:e},f,createjs.Ease.getPowIn(2))},e.pinkContinueAnimation=function(a,b,c,d){a.PinkMouths.gotoAndStop("play"),e.swayAnimation(a.PinkBodyAll,8,-8,0,450),b.audioChannels[c].volume=d,params={x:80,y:-90,yfloat:-60,init_pause_fact:0,breeze:30},e.sparkleNotes(a.PinkNotesAll,params,!1)},e.stopSparkleNotes=function(a){a.s1&&(b.hasActiveTweens(a.s1)&&b.removeTweens(a.s1),b.hasActiveTweens(a.s2)&&b.removeTweens(a.s2),b.hasActiveTweens(a.s3)&&b.removeTweens(a.s3),b.hasActiveTweens(a.n1)&&b.removeTweens(a.n1),b.hasActiveTweens(a.n2)&&b.removeTweens(a.n2),b.hasActiveTweens(a.n3)&&b.removeTweens(a.n3),b.hasActiveTweens(a.n4)&&b.removeTweens(a.n4),b.get(a.s1).to({alpha:0,y:a.s1.y-50},400,createjs.Ease.getPowOut(3)),b.get(a.s2).to({alpha:0,y:a.s2.y-50},400,createjs.Ease.getPowOut(3)),b.get(a.s3).to({alpha:0,y:a.s3.y-50},400,createjs.Ease.getPowOut(3)),b.get(a.n1).to({alpha:0,y:a.n1.y-50},400,createjs.Ease.getPowOut(3)),b.get(a.n2).to({alpha:0,y:a.n2.y-50},400,createjs.Ease.getPowOut(3)),b.get(a.n3).to({alpha:0,y:a.n3.y-50},400,createjs.Ease.getPowOut(3)),b.get(a.n4).to({alpha:0,y:a.n4.y-50},400,createjs.Ease.getPowOut(3)))},e.sparkleNotes=function(d,f,g){var h=500,i=.3,j=30,k=-90,l=1,m=0;f.yfloat&&(k=f.yfloat),f.breeze&&(m=f.breeze),f.spread&&(l=-1.1),j*=1/i,k*=1/i,images.Sparkle&&(d.removeAllChildren(),d.sparkles=new a,d.s1=new c(images.Sparkle),d.s2=new c(images.Sparkle),d.s3=new c(images.Sparkle),d.n1=new c(images.MusicNote1),d.n2=new c(images.MusicNote2),d.n3=new c(images.MusicNote2),d.n4=new c(images.MusicNote2),d.s1.regX=d.s2.regX=d.s1.image.width/2,d.s1.regY=d.s2.regY=d.s1.image.height/2,d.n1.regX=d.n2.regX=d.n3.regX=d.n4.regX=d.n1.image.width/2,d.n1.regY=d.n2.regY=d.n3.regY=d.n4.regY=d.n1.image.height/2,d.sparkles.addChild(d.s1,d.s2,d.n1,d.n2,d.n3,d.n4),d.addChild(d.sparkles),f.x&&e.setPosition(d.sparkles,f.x,f.y),d.s2.scaleX=d.s2.scaleY=.75,d.sparkles.scaleX=d.sparkles.scaleY=.3,g||(b.get(d.s1,{loop:!0}).to({alpha:0,x:0,y:0}).wait(h/6.1).to({x:j+l*m,y:k,rotation:60,alpha:1},h).to({x:-j+2*l*m,y:2*k,rotation:120},h).to({x:j+3*l*m,y:3*k,rotation:180},h).to({x:-j+3*l*m,y:4*k,rotation:240,alpha:0},h),b.get(d.s2,{loop:!0}).to({alpha:0,x:20,y:10}).wait(h/1.88).to({x:j+m,y:k,rotation:60,alpha:1},h).to({x:-j+1.5*m,y:2*k,rotation:120},h).to({x:j+2*m,y:3*k,rotation:180},h).to({x:-j+3*m,y:4*k,rotation:240,alpha:0},h),b.get(d.s3,{loop:!0}).to({alpha:0,x:5,y:5}).wait(2.2*h).to({x:.5*j+l*m,y:.75*k,rotation:30,alpha:1},h).to({x:-.5*j+2*l*m,y:1.5*k,rotation:20},h).to({x:.5*j+3*l*m,y:2.25*k,rotation:-7},h).to({x:-.5*j+3*l*m,y:3*k,rotation:40,alpha:0},h),b.get(d.n1,{loop:!0}).to({alpha:1,x:0,y:0}).to({x:.5*j+m,y:.5*k,rotation:40,alpha:1},h).to({x:-.5*j+2*m,y:1*k,rotation:80},h).to({x:.5*j+3*m,y:1.5*k,rotation:30},h).to({x:-.5*j+3*m,y:2*k,rotation:-10,alpha:0},h),b.get(d.n2,{loop:!0}).to({alpha:0,x:5,y:5}).wait(h/9.9).to({x:.5*j+l*m,y:.75*k,rotation:40,alpha:1},h).to({x:-.5*j+2*l*m,y:1.5*k,rotation:70},h).to({x:.5*j+3*l*m,y:2.25*k,rotation:0},h).to({x:-.5*j+3*l*m,y:3*k,rotation:-30,alpha:0},h),b.get(d.n3,{loop:!0}).to({alpha:0,x:5,y:5}).wait(1.5*h).to({alpha:1,x:0,y:0}).to({x:.5*j+m,y:.5*k,rotation:-40,alpha:1},h).to({x:-.5*j+2*m,y:1*k,rotation:-10},h).to({x:.5*j+3*m,y:1.5*k,rotation:20},h).to({x:-.5*j+3*m,y:2*k,rotation:-80,alpha:0},h),b.get(d.n4).to({alpha:0})))},e.StartCharacter=function(a,c,d){var f;switch(a){case 1:e.swayAnimation(c.PeterBodyAll,10,-10,0,450),e.swayAnimation(c.PeterArmsAll,10,-10,0,450),e.swayAnimation(c.PeterArmLeftAll,10,-20,-5,125),e.swayAnimation(c.PeterArmRightAll,15,-15,0,125),e.swayAnimation(c.PeterHandLeft,-25,40,-10,125),e.swayAnimation(c.PeterHandRight,40,-15,0,125),f={x:1,y:75,init_pause_fact:0,breeze:150,spread:!0},e.sparkleNotes(c.PeterNotesAll,f,!1);break;case 2:b.hasActiveTweens(c.PinkBodyAll)&&b.removeTweens(c.PinkBodyAll),b.hasActiveTweens(c.PinkArm)&&b.removeTweens(c.PinkArm),b.get(c.PinkArm).to({rotation:-60},600,createjs.Ease.getPowOut(3)).call(e.pinkContinueAnimation,[c,d,a,d.audioChannels[a].volume]),d.audioChannels[a].volume=0;break;case 3:e.swayAnimation(c.JasmineBodyAll,8,-8,0,450),e.swayAnimation(c.JasmineHand2,30,3,15,225),e.swayAnimation(c.JasmineHand1,-18,0,-9,320),f={x:25,y:-10,yfloat:-70,init_pause_fact:0,breeze:100},e.sparkleNotes(c.JasmineNotesAll,f,!1)}},e.StopCharacter=function(a,c){switch(a){case 1:b.removeTweens(c.PeterBodyAll),b.removeTweens(c.PeterArmsAll),b.removeTweens(c.PeterArmLeftAll),b.removeTweens(c.PeterArmRightAll),b.removeTweens(c.PeterHandLeft),b.removeTweens(c.PeterHandRight),b.get(c.PeterArmLeftAll).to({rotation:0},400,createjs.Ease.getPowOut(3)),b.get(c.PeterArmRightAll).to({rotation:0},400,createjs.Ease.getPowOut(3)),b.get(c.PeterHandLeft).to({rotation:0},400,createjs.Ease.getPowOut(3)),b.get(c.PeterHandRight).to({rotation:0},400,createjs.Ease.getPowOut(3)),b.get(c.PeterBodyAll).to({rotation:0},800,createjs.Ease.getPowOut(3)),b.get(c.PeterArmsAll).to({rotation:0},800,createjs.Ease.getPowOut(3)),e.stopSparkleNotes(c.PeterNotesAll);break;case 2:c.PinkMouths.gotoAndStop("idle"),b.hasActiveTweens(c.PinkBodyAll)&&b.removeTweens(c.PinkBodyAll),b.hasActiveTweens(c.PinkArm)&&b.removeTweens(c.PinkArm),b.get(c.PinkBodyAll).to({rotation:0},800,createjs.Ease.getPowOut(3)),b.get(c.PinkArm).to({rotation:0},1e3,createjs.Ease.getPowOut(3)),e.stopSparkleNotes(c.PinkNotesAll);break;case 3:b.removeTweens(c.JasmineBodyAll),b.removeTweens(c.JasmineHand1),b.removeTweens(c.JasmineHand2),b.get(c.JasmineBodyAll).to({rotation:0},800,createjs.Ease.getPowOut(3)),b.get(c.JasmineHand2).to({rotation:15},800,createjs.Ease.getPowOut(3)),b.get(c.JasmineHand1).to({rotation:-12},800,createjs.Ease.getPowOut(3)),e.stopSparkleNotes(c.JasmineNotesAll)}},e.setPosition=function(a,b,c,d){a.x=b,a.y=c,d&&(d.x=b,d.y=c)},namespace("WGBH").BandAnimation=d}(),function(){var a=include("createjs.Tween"),b=include("WGBH.SharedAnimation"),c=function(){d.SharedAnimation=new b},d=c.prototype;d.InstrumentBounce=function(b){var c,e,f,g=500,h=b,i=h.HarpButton,j=h.DrumButton,k=h.XylophoneButton;a.get(i).wait(.5*g).to({y:i.y-50},g,createjs.Ease.getPowOut(3)).call(function(){e=i,e&&(f=e.children[0].image,c={x:e.x+f.width/4,y:e.y+f.width/1.5,init_pause_fact:0},d.SharedAnimation.sparkleMeMany(h,h.sparklepanel,c,!1),c={x:e.x+f.width/2,y:e.y+f.width/4,init_pause_fact:0},d.SharedAnimation.sparkleMeMany(h,h.sparklepanel,c,!1))}).to({y:i.y},1.5*g,createjs.Ease.bounceOut),a.get(j).wait(1.25*g).to({y:j.y-50},g,createjs.Ease.getPowOut(3)).call(function(){e=j,e&&(f=e.children[0].image,c={x:e.x+f.width/4,y:e.y+f.width/1.5,init_pause_fact:0},d.SharedAnimation.sparkleMeMany(h,h.sparklepanel,c,!1),c={x:e.x+f.width/2,y:e.y+f.width/4,init_pause_fact:0},d.SharedAnimation.sparkleMeMany(h,h.sparklepanel,c,!1))}).to({y:j.y},1.5*g,createjs.Ease.bounceOut),a.get(k).wait(2*g).to({y:k.y-50},g,createjs.Ease.getPowOut(3)).call(function(){e=k,e&&(f=e.children[0].image,c={x:e.x+f.width/4,y:e.y+f.width/1.5,init_pause_fact:0},d.SharedAnimation.sparkleMeMany(h,h.sparklepanel,c,!1),c={x:e.x+f.width/2,y:e.y+f.width/4,init_pause_fact:0},d.SharedAnimation.sparkleMeMany(h,h.sparklepanel,c,!1))}).to({y:k.y},1.5*g,createjs.Ease.bounceOut)},d.PlayBounce=function(b){var c,e,f=500,g=b,h=g.PlayButton;a.get(h).wait(3e3).to({y:h.y-50},f,createjs.Ease.getPowOut(3)).call(function(){if(e=h){if(!(e.children.length>0))return;img=e.children[0].image,c={x:e.x+img.width/4,y:e.y+img.width/1.5,init_pause_fact:0},d.SharedAnimation.sparkleMeMany(g,g.sparklepanel,c,!1),c={x:e.x+img.width/2,y:e.y+img.width/4,init_pause_fact:0},d.SharedAnimation.sparkleMeMany(g,g.sparklepanel,c,!1)}}).to({y:h.y},1.5*f,createjs.Ease.bounceOut)},d.setPosition=function(a,b,c,d){a.x=b,a.y=c,d&&(d.x=b,d.y=c)},namespace("WGBH").InstrumentsAnimation=c}(),function(){var a=function(){this.gamedata=app.config.gameData},b=a.prototype;b.readSavedData=function(){return app.savedData=springroll.SavedData.read("PinkProgressData_3f"),app.showCreateTutorial=!0,app.showBandTutorial=!0,app.currentInstrument="",app.lastState="",app.sInstrumentsClicked="",app.iMenuVOPlayed1=!1,app.iMenuVOPlayed2=!1,app.savedData?"updated":(app.savedData={iCurrentSong:0,iProgress:0,iCurrentFeedback:0,lastCompleteInstrument:"",isTutorialCancellable:!1,aFilledNames:{Harp:"",Drum:"",Xylo:""}},"initialized")},b.write2SavedData=function(){springroll.SavedData.write("PinkProgressData_3f",app.savedData,!1)},b.setGAPageview=function(a){var c=window.ga;c?(b.logit("We have GA !!!!!!!!!: page = "+a),c("set","page",a),c("send","pageview")):b.logit("####### Try again for GA, ref = "+a)},b.setPosition=function(a,b,c,d){a.x=b,a.y=c,d&&(d.x=b,d.y=c)},b.logit=function(a){window.console},b.playVO=function(a,c){b.logit("the VO str = "+a),app.voPlayer.play(a,c)},namespace("WGBH").Utilities=a}(),function(){var a=include("springroll.easeljs.BasePanel"),b=include("WGBH.Utilities"),c=include("createjs.Container"),d=include("createjs.Bitmap"),e=include("springroll.easeljs.SoundButton"),f=function(){a.call(this)},g=a.prototype,h=extend(f,a);h.setup=function(){h.Utils=new b,h.Utils.logit("[BandPanel].EnterFunction"),h.data=app.config.gameData.Instruments[app.currentInstrument];var a,f,g,i=.25;for(this.scaleContainer=new c,this.leftContainer=new c,this.addChild(this.leftContainer),this.background1=new d(images.BandBackground1),this.background2=new d(images.BandBackground2),this.background3=new d(images.BandBackground3),this.BackButton=new e(images.BackButton),this.leftContainer.addChild(this.BackButton),this.MaterialsContainer=new c,this.Hit=new createjs.Shape,this.Hit.graphics.beginFill("#ffff00").rect(h.data.BandFills[0],h.data.BandFills[1],h.data.BandFills[2],h.data.BandFills[3]),a=h.data.BandZones.length-1;a>=0;a--)f=h.data.BandZones[a],this["rect"+(a+1)]=new createjs.Rectangle(f.rect[0],f.rect[1],f.rect[2],f.rect[3]),this["s"+(a+1)]=new createjs.Shape,this["s"+(a+1)].graphics.beginFill("#ff0000").rect(f.rect[0],f.rect[1],f.rect[2],f.rect[3]),this["s"+(a+1)].alpha=i,this[h.data.materialtype+(a+1)+"Container"]=new c,h.data.BandZones[a].scalefact&&(this[h.data.materialtype+(a+1)+"Container"].scaleX=this[h.data.materialtype+(a+1)+"Container"].scaleY=h.data.BandZones[a].scalefact),"Drum"!=h.data.name&&(this[h.data.materialtype+(a+1)+"Container"].hitArea=this.Hit,this[h.data.materialtype+(a+1)+"Container"].mask=this["s"+(a+1)]),this.MaterialsContainer.addChild(this[h.data.materialtype+(a+1)+"Container"]),h.Utils.setPosition(this[h.data.materialtype+(a+1)+"Container"],f.rect[0],f.rect[1]);for(a=h.data.Materials.length-1;a>=0;a--){g=h.data.Materials[a];for(var j=h.data.BandZones.length;j>=1;j--)this[g.name+h.data.materialtype+j]=new d(images[g.name+h.data.materialtype])}var k={images:[images.CharacterEyes],frames:{width:35,height:6},animations:{idle:[0,0],blink:[0,1,"idle"]}},l=new createjs.SpriteSheet(k);this.PeterEyes=new createjs.Sprite(l,"blink"),this.PinkEyes=new createjs.Sprite(l,"blink"),this.JasmineEyes=new createjs.Sprite(l,"blink"),this.PeterEyes.framerate=this.PinkEyes.framerate=this.JasmineEyes.framerate=8;var m={images:[images.CharacterMouths],frames:{width:30,height:18},animations:{idle:[0,0],happy:[3,3],play:[5,5]}},n=new createjs.SpriteSheet(m);for(this.PinkMouths=new createjs.Sprite(n,"play"),this.PinkMouths.framerate=3,this.PeterShadow=new d(images.CharacterShadow),this.PinkShadow=new d(images.CharacterShadow),this.JasmineShadow=new d(images.CharacterShadow),this.PeterBody=new d(images.PeterBody),this.PeterLegs=new d(images.PeterLegs),this.PeterArmRight=new d(images.PeterArm),this.PeterArmLeft=new d(images.PeterArm),this.PeterHandRight=new d(images.PeterHand),this.PeterHandLeft=new d(images.PeterHand),this.PeterDrum=new d(images.PeterDrum),this.btnPlayer1=new c,this.PeterBodyAll=new c,this.PeterArmsAll=new c,this.PeterArmLeftAll=new c,this.PeterArmRightAll=new c,this.PeterNotesAll=new c,this.btnPlayer1.addChild(this.PeterShadow,this.PeterLegs,this.PeterBodyAll,this.PeterDrum,this.PeterArmsAll,this.PeterNotesAll),this.PeterArmsAll.addChild(this.PeterArmLeftAll,this.PeterArmRightAll),this.PeterArmLeftAll.addChild(this.PeterHandLeft,this.PeterArmLeft),this.PeterArmRightAll.addChild(this.PeterHandRight,this.PeterArmRight),this.PeterBodyAll.addChild(this.PeterBody,this.PeterEyes),this.PeterArmLeftAll.regX=this.PeterArmLeftAll.width/2,this.PeterArmLeftAll.scaleX=-1,this.PeterArmLeftAll.regX=this.PeterArmLeftAll.regY=8,this.PeterArmRightAll.regX=this.PeterArmRightAll.regY=8,this.PeterHandLeft.regX=this.PeterHandRight.regX=7,this.PeterHandLeft.regY=this.PeterHandRight.regY=20,h.Utils.setPosition(this.PeterArmRightAll,10,110),h.Utils.setPosition(this.PeterArmLeftAll,105,112),h.Utils.setPosition(this.PeterHandLeft,36,37),h.Utils.setPosition(this.PeterHandRight,36,37),this.PeterBodyAll.regX=this.PeterLegs.regX=this.PeterArmsAll.regX=60,this.PeterBodyAll.regY=this.PeterLegs.regY=this.PeterArmsAll.regY=134,h.Utils.setPosition(this.PeterLegs,20,150),h.Utils.setPosition(this.PeterEyes,42,36),h.Utils.setPosition(this.PeterDrum,-50,20),h.Utils.setPosition(this.btnPlayer1,140+this.PeterBodyAll.regX,190+this.PeterBodyAll.regY),this.PinkBody=new d(images.PinkBody),this.PinkLegs=new d(images.PinkLegs),this.PinkArm=new d(images.PinkArm),this.btnPlayer2=new c,this.PinkBodyAll=new c,this.PinkNotesAll=new c,this.btnPlayer2.addChild(this.PinkShadow,this.PinkLegs,this.PinkBodyAll,this.PinkNotesAll),this.PinkBodyAll.addChild(this.PinkBody,this.PinkEyes,this.PinkMouths,this.PinkArm),this.PinkBodyAll.regX=this.PinkLegs.regX=93,this.PinkBodyAll.regY=this.PinkLegs.regY=172,this.PinkArm.regX=11,this.PinkArm.regY=37,h.Utils.setPosition(this.PinkArm,113+this.PinkArm.regX,81+this.PinkArm.regY),h.Utils.setPosition(this.PinkLegs,56,193),h.Utils.setPosition(this.PinkEyes,78,56),h.Utils.setPosition(this.PinkMouths,82,74),h.Utils.setPosition(this.btnPlayer2,380+this.PinkBodyAll.regX,90+this.PinkBodyAll.regY),this.JasmineBody=new d(images.JasmineBody),this.JasmineHand1=new d(images.JasmineHand1),this.JasmineHand2=new d(images.JasmineHand2),this.JasmineLegs=new d(images.JasmineLegs),this.btnPlayer3=new c,this.JasmineBodyAll=new c,this.JasmineNotesAll=new c,this.btnPlayer3.addChild(this.JasmineShadow,this.JasmineLegs,this.JasmineBodyAll,this.JasmineNotesAll),this.JasmineBodyAll.addChild(this.JasmineBody,this.JasmineEyes,this.JasmineHand1,this.JasmineHand2),this.JasmineBodyAll.rotation=0,this.JasmineHand1.rotation=-12,this.JasmineHand2.rotation=15,this.JasmineBodyAll.regX=this.JasmineLegs.regX=62,this.JasmineBodyAll.regY=this.JasmineLegs.regY=139.5,this.JasmineHand1.regX=2,this.JasmineHand1.regY=18,h.Utils.setPosition(this.JasmineEyes,45,38),h.Utils.setPosition(this.JasmineHand2,53,135),h.Utils.setPosition(this.JasmineHand1,144+this.JasmineHand1.regX,100+this.JasmineHand1.regY),h.Utils.setPosition(this.JasmineLegs,32,245),h.Utils.setPosition(this.btnPlayer3,660+this.JasmineBodyAll.regX,105+this.JasmineBodyAll.regY),h.Utils.setPosition(this.PeterShadow,-45-this.PeterBodyAll.regX,240-this.PeterBodyAll.regY),h.Utils.setPosition(this.PinkShadow,-10-this.PinkBodyAll.regX,350-this.PinkBodyAll.regY),h.Utils.setPosition(this.JasmineShadow,-40-this.JasmineBodyAll.regX,255-this.JasmineBodyAll.regX),this.TuteHand=new d(images.TuteHand),this.MusicBox=new d(images.MusicBox),this.MusicBoxDots=new d(images.MusicBoxDots),this.MusicBoxDrumStands=new d(images.MusicBoxDrumStands),this.HarpButton=new e(images.HarpButton),this.DrumButton=new e(images.DrumButton),this.XyloButton=new e(images.XyloButton),this.AvatarContainer=new c,this.AvatarContainer.addChild(this.HarpButton),this.MusicStand=new d(images.MusicStand),h.Utils.setPosition(this.MusicBox,92,555),h.Utils.setPosition(this.MusicBoxDots,this.MusicBox.x+316,this.MusicBox.y+9),h.Utils.setPosition(this.MusicBoxDrumStands,this.MusicBoxDots.x,this.MusicBox.y+130),h.Utils.setPosition(this.AvatarContainer,118,583),h.Utils.setPosition(this.MusicStand,840,175),h.Utils.setPosition(this.BackButton,8,4),this.TuteHand.regX=74,this.TuteHand.regY=30,this.TuteHand.scaleX=this.TuteHand.scaleY=.8,h.Utils.setPosition(this.TuteHand,400,512),this.FullAreaTute=new createjs.Container,this.TuteHide=new createjs.Shape,this.TuteHide.graphics.beginFill("#ffffff").rect(0,0,1536,768),this.FullAreaTute.alpha=.01,this.FullAreaTute.addChild(this.TuteHide),this.FullArea=new createjs.Container,this.x1=new createjs.Shape,this.x1.graphics.beginFill("#660000").rect(0,0,1536,728),this.FullArea.addChild(this.background1),this.addChildAt(this.FullArea,0),this.addChild(this.scaleContainer),this.scaleContainer.addChild(this.MusicBox,this.AvatarContainer),"Drum"==h.data.name&&this.scaleContainer.addChild(this.MusicBoxDrumStands),this.scaleContainer.addChild(this.MaterialsContainer),a=h.data.BandZones.length-1;a>=0;a--)this.scaleContainer.addChild(this["s"+(a+1)]);"Drum"!=h.data.name&&this.scaleContainer.addChild(this.MusicBoxDots),this.scaleContainer.addChild(this.MusicStand,this.btnPlayer1,this.btnPlayer2,this.btnPlayer3),this.scaleContainer.addChild(this.TuteHand),this.addChild(this.FullAreaTute),this.sparklepanel=new c,this.scaleContainer.addChild(this.sparklepanel)},h.teardown=function(){for(g.teardown.call(this),this.background=null,this.BackButton=null,this.MaterialsContainer=null,i=h.data.BandZones.length-1;i>=0;i--)this[h.data.materialtype+(i+1)+"Container"]=null},namespace("WGBH").BandPanel=f}(),function(){var a=include("springroll.easeljs.BasePanel"),b=include("WGBH.Utilities"),c=include("createjs.Container"),d=include("createjs.Bitmap"),e=include("springroll.easeljs.SoundButton"),f=function(){a.call(this)},g=a.prototype,h=extend(f,a);h.setup=function(){h.Utils=new b,h.Utils.logit("[GamePanel].setup: set the app data"),h.data=app.config.gameData.Instruments[app.currentInstrument];var a,f,g,i,j=.25;for(this.scaleContainer=new c,this.addChild(this.scaleContainer),this.rightContainer=new c,this.addChild(this.rightContainer),this.leftContainer=new c,this.addChild(this.leftContainer),this.FullAreaTute=new createjs.Container,this.addChild(this.FullAreaTute),this.FullArea=new createjs.Container,this.addChildAt(this.FullArea,0),h[h.data.Images.back]=new d(images[h.data.Images.back]),h[h.data.Images.front]=new d(images[h.data.Images.front]),a=h.data.Materials.length-1;a>=0;a--){g=h.data.Materials[a],h[g.name]=new d(images[g.name]),h[g.name+"back"]=new d(images[g.name]),h[g.name+"back"].alpha=j,h.data.materialscale&&(h[g.name].scaleX=h[g.name].scaleY=h.data.materialscale,h[g.name+"back"].scaleX=h[g.name+"back"].scaleY=h.data.materialscale),h[g.name].index=a;for(var k=h.data.DropZones.length;k>=1;k--)this[g.name+h.data.materialtype+k]=new d(images[g.name+h.data.materialtype]),h.data.DropZones[k-1].scalefact&&(this[g.name+h.data.materialtype+k].scaleX=this[g.name+h.data.materialtype+k].scaleY=h.data.DropZones[k-1].scalefact)}for(this.DropContainer=new c,a=h.data.DropZones.length-1;a>=0;a--)i=h.data.VisibleZones?h.data.VisibleZones[a]:h.data.DropZones[a],f=h.data.DropZones[a],this["mask"+(a+1)]=new createjs.Shape,this["mask"+(a+1)].graphics.beginFill("#ff0000").rect(i.rect[0],i.rect[1],i.rect[2],i.rect[3]),this["default"+(a+1)]=new d(images[h.data.name+h.data.materialtype+"Default"]),this["s"+(a+1)]=new c,this["s"+(a+1)].mask=this["mask"+(a+1)],this["s"+(a+1)].addChild(this["default"+(a+1)]),h.data.DropZones[a].scalefact&&(this["default"+(a+1)].scaleX=this["default"+(a+1)].scaleY=h.data.DropZones[a].scalefact),this["rect"+(a+1)]=new createjs.Rectangle(f.rect[0],f.rect[1],f.rect[2],f.rect[3]),this["Hit"+a]=new createjs.Shape,this["Hit"+a].graphics.beginFill("#ffff00").rect(0,0,f.rect[2],f.rect[3]),this[h.data.materialtype+(a+1)+"Container"]=new c,this[h.data.materialtype+(a+1)+"Container"].hitArea=this["Hit"+a],this[h.data.materialtype+(a+1)+"Container"].mask=this["s"+(a+1)],this.DropContainer.addChild(this[h.data.materialtype+(a+1)+"Container"]),h.Utils.setPosition(this[h.data.materialtype+(a+1)+"Container"],f.rect[0],f.rect[1]),h.Utils.setPosition(this["s"+(a+1)],i.rect[0],i.rect[1]);for(this.background=new d(images.GameBackground),this.bgGlow=new d(images.GameGlow),this.BackButton=new e(images.BackButton),this.NextButtonInactive=new d(images.NextButtonInactive),this.NextButton=new e(images.NextButtonActive),this.TuteHand=new d(images.TuteHand),h.setDefaultObjectPostions(),h.Utils.setPosition(this.BackButton,8,4),h.Utils.setPosition(this.NextButtonInactive,900,640),h.Utils.setPosition(this.NextButton,900,638),h.Utils.setPosition(this.bgGlow,350,0),this.TuteHand.regX=74,this.TuteHand.regY=30,h.Utils.setPosition(this.TuteHand,400,512),this.TuteHide=new createjs.Shape,this.TuteHide.graphics.beginFill("#ffffff").rect(0,0,1536,768),this.FullAreaTute.alpha=.01,this.FullAreaTute.addChild(this.TuteHide),this.FullArea.addChild(this.background),this.scaleContainer.addChild(this.bgGlow),this.scaleContainer.addChild(h[h.data.name]),this.scaleContainer.addChild(this.DropContainer),a=h.data.DropZones.length-1;a>=0;a--)this.scaleContainer.addChild(this["s"+(a+1)]);for(this.scaleContainer.addChild(h[h.data.Images.front]),a=h.data.Materials.length-1;a>=0;a--)g=h.data.Materials[a],this.scaleContainer.addChild(h[g.name+"back"],h[g.name]);this.leftContainer.addChild(this.BackButton),this.rightContainer.addChild(this.NextButton,this.NextButtonInactive),this.scaleContainer.addChild(this.TuteHand),this.sparklepanel=new c,this.scaleContainer.addChild(this.sparklepanel)},h.setDefaultObjectPostions=function(){for(h.Utils.setPosition(h[h.data.Images.back],h.data.position[0],h.data.position[1],h[h.data.Images.front]),i=h.data.Materials.length-1;i>=0;i--)m=h.data.Materials[i],h.Utils.setPosition(h[m.name],m.position[0],m.position[1],h[m.name+"back"])},h.teardown=function(){for(g.teardown.call(this),this.BackButton=null,this.NextButton=null,this.NextButtonInactive=null,i=h.data.DropZones.length-1;i>=0;i--)this[h.data.materialtype+(i+1)+"Container"]=null},namespace("WGBH").GamePanel=f}(),function(){var a=include("springroll.easeljs.BasePanel"),b=include("WGBH.Utilities"),c=include("createjs.Container"),d=include("createjs.Bitmap"),e=include("springroll.easeljs.SoundButton"),f=include("springroll.easeljs.Button"),g=function(){a.call(this)},h=a.prototype,i=extend(g,a);i.setup=function(){i.Utils=new b,i.Utils.logit("Instruments Panel Setup"),this.background=new d(images.InstrumentsBackground),this.addChildAt(this.background,0),this.scaleContainer=new c,this.addChild(this.scaleContainer),this.leftContainer=new c,this.addChild(this.leftContainer),this.BackButton=new e(images.BackButton),this.HarpButton=new f(images.HarpButton),this.DrumButton=new f(images.DrumButton),this.XylophoneButton=new f(images.XylophoneButton),this.PlayButton=new f(images.PlayButton),this.PlayButtonInactive=new d(images.PlayButtonInactive),this.sparklepanel=new c,this.leftContainer.addChild(this.BackButton),this.scaleContainer.addChild(this.HarpButton,this.DrumButton,this.XylophoneButton,this.PlayButton,this.PlayButtonInactive,this.sparklepanel),i.Utils.setPosition(this.BackButton,8,4),i.Utils.setPosition(this.HarpButton,34,157),i.Utils.setPosition(this.DrumButton,374,75),i.Utils.setPosition(this.XylophoneButton,714,157),i.Utils.setPosition(this.PlayButton,374,456,this.PlayButtonInactive)},i.teardown=function(){h.teardown.call(this),this.background=null,this.HarpButton=null,this.DrumButton=null,this.XylophoneButton=null,this.PlayButton=null,this.PlayButtonInactive=null},namespace("WGBH").InstrumentsPanel=g}(),function(){var a=include("springroll.easeljs.BasePanel"),b=include("WGBH.Utilities"),c=include("createjs.Container"),d=include("createjs.Bitmap"),e=include("springroll.easeljs.SoundButton"),f=function(){a.call(this)},g=a.prototype,h=extend(f,a);h.setup=function(){h.Utils=new b,h.Utils.logit("Intro Panel Setup"),this.background=new d(images.IntroBackground),this.addChildAt(this.background,0),this.scaleContainer=new c,this.addChild(this.scaleContainer),this.rightContainer=new c,this.addChild(this.rightContainer),this.table=new d(images.IntroTable),this.NextButton=new e(images.NextButton),this.rightContainer.addChild(this.NextButton);var a={images:[images.CharacterEyes],frames:{width:38,height:6},animations:{idle:[0,0],blink:[0,1,"idle"]}},f=new createjs.SpriteSheet(a);this.PeterEyes=new createjs.Sprite(f,"blink"),this.PinkEyes=new createjs.Sprite(f,"blink"),this.JasmineEyes=new createjs.Sprite(f,"blink"),this.PeterEyes.framerate=this.PinkEyes.framerate=this.JasmineEyes.framerate=8;var g={images:[images.CharacterMouths],frames:{width:33,height:18},animations:{idle:[0,0],happy:[3,3],play:[5,5]}},i=new createjs.SpriteSheet(g);this.PinkMouth=new createjs.Sprite(i,"idle"),this.PinkMouthSide=new createjs.Sprite(i,"idle"),this.PinkMouth.framerate=3,this.PinkMouthSide.framerate=3,this.PeterShadow=new d(images.CharacterShadow),this.PinkShadow=new d(images.CharacterShadow),this.JasmineShadow=new d(images.CharacterShadow),this.PeterBody=new d(images.PeterBody),this.PeterHeadForward=new d(images.PeterHeadForward),this.PeterHeadTurn=new d(images.PeterHeadTurn),this.PeterHeadAll=new c,this.PeterHeadAll.addChild(this.PeterHeadForward,this.PeterEyes),this.PinkTorso=new d(images.PinkTorso),this.PinkWings=new d(images.PinkWings),this.PinkArmLower=new d(images.PinkArmLower),this.PinkArmUpper=new d(images.PinkArmUpper),this.PinkHandOpen=new d(images.PinkHandOpen),this.PinkHeadForward=new d(images.PinkHeadForward),this.PinkLegs=new d(images.PinkLegs),this.PinkHeadTurnL=new d(images.PinkHeadTurnL),this.PinkAll=new c,this.PinkUpperAll=new c,this.PinkTorsoAll=new c,this.PinkArmAll=new c,this.PinkArmUpperAll=new c,this.PinkArmLowerAll=new c,this.PinkHeadAll=new c,this.PinkHeadTalkAll=new c,this.PinkHeadTalkSideAll=new c,this.PinkAll.addChild(this.PinkShadow,this.PinkLegs,this.PinkUpperAll),this.PinkUpperAll.addChild(this.PinkTorsoAll,this.PinkHeadAll),this.PinkTorsoAll.addChild(this.PinkWings,this.PinkArmAll,this.PinkTorso),this.PinkArmAll.addChild(this.PinkArmUpperAll,this.PinkArmLowerAll),this.PinkArmUpperAll.addChild(this.PinkArmUpper),this.PinkArmLowerAll.addChild(this.PinkArmLower,this.PinkHandOpen),this.PinkHeadAll.addChild(this.PinkHeadTalkAll,this.PinkHeadTalkSideAll),this.PinkHeadTalkAll.addChild(this.PinkHeadForward,this.PinkEyes,this.PinkMouth),this.PinkHeadTalkSideAll.addChild(this.PinkHeadTurnL,this.PinkMouthSide),this.JasmineBody=new d(images.JasmineBody),this.JasmineHeadForward=new d(images.JasmineHeadForward),this.JasmineHeadTurn=new d(images.JasmineHeadTurn),this.JasmineHeadAll=new c,this.JasmineHeadAll.addChild(this.JasmineHeadForward,this.JasmineEyes),this.scaleContainer.addChild(this.PeterShadow,this.PeterBody,this.PeterHeadTurn,this.PeterHeadAll,this.JasmineShadow,this.JasmineBody,this.JasmineHeadTurn,this.JasmineHeadAll,this.PinkAll),this.scaleContainer.addChild(this.table),this.PeterHeadAll.regX=this.PeterHeadTurn.regX=65,this.PeterHeadAll.regY=this.PeterHeadTurn.regY=95;var j=-50;h.Utils.setPosition(this.PeterBody,275+j,412),h.Utils.setPosition(this.PeterHeadAll,259+j+this.PeterHeadAll.regX,325+this.PeterHeadAll.regY,this.PeterHeadTurn),h.Utils.setPosition(this.PeterEyes,47,42),this.PeterHeadForward.alpha=1,this.PeterHeadTurn.alpha=0,this.PinkUpperAll.regX=70,this.PinkUpperAll.regY=200,this.PinkHeadTalkAll.regX=70,this.PinkHeadTalkAll.regY=115,this.JasmineHeadAll.regX=70,this.JasmineHeadAll.regY=85,h.Utils.setPosition(this.PinkAll,388,210),h.Utils.setPosition(this.PinkUpperAll,this.PinkUpperAll.regX,this.PinkUpperAll.regY),h.Utils.setPosition(this.PinkHeadTalkAll,this.PinkHeadTalkAll.regX,this.PinkHeadTalkAll.regY),h.Utils.setPosition(this.PinkTorsoAll,-29,107),h.Utils.setPosition(this.PinkWings,35,-9),h.Utils.setPosition(this.PinkLegs,29,319),h.Utils.setPosition(this.PinkHeadTalkSideAll,2,0),this.PinkHeadTalkSideAll.alpha=0,this.PinkArmAll.regX=12,this.PinkArmAll.regY=14,this.PinkArmAll.rotation=30,h.Utils.setPosition(this.PinkArmAll,126,24),
this.PinkArmLowerAll.regX=6,this.PinkArmLowerAll.regY=46,h.Utils.setPosition(this.PinkArmLowerAll,58,50),this.PinkArmLowerAll.rotation=100,this.PinkHandOpen.regX=7,this.PinkHandOpen.regY=26,h.Utils.setPosition(this.PinkHandOpen,24,4),h.Utils.setPosition(this.PinkEyes,54,64),h.Utils.setPosition(this.PinkMouth,56,84),h.Utils.setPosition(this.PinkMouthSide,43,84),this.PinkMouthSide.scaleX=.8,h.Utils.setPosition(this.JasmineBody,592,325),h.Utils.setPosition(this.JasmineHeadAll,599+this.JasmineHeadAll.regX,240+this.JasmineHeadAll.regY),h.Utils.setPosition(this.JasmineHeadTurn,613,233),h.Utils.setPosition(this.JasmineEyes,46,42),this.JasmineHeadForward.alpha=1,this.JasmineHeadTurn.alpha=0,h.Utils.setPosition(this.PinkShadow,-24,394),h.Utils.setPosition(this.PeterShadow,170,605),h.Utils.setPosition(this.JasmineShadow,566,609),h.Utils.setPosition(this.table,105,382),h.Utils.setPosition(this.NextButton,860,649)},h.teardown=function(){g.teardown.call(this),this.background=null,this.NextButton=null},namespace("WGBH").IntroPanel=f}(),function(){var a=include("springroll.easeljs.BasePanel"),b=include("WGBH.Utilities"),c=include("createjs.Container"),d=include("createjs.Bitmap"),e=include("springroll.easeljs.SoundButton"),f=function(){a.call(this)},g=a.prototype,h=extend(f,a);h.setup=function(){h.Utils=new b,this.background=new d(images.TitleBackground),this.addChildAt(this.background,0),this.scaleContainer=new c,this.addChild(this.scaleContainer),this.PlayButton=new e(images.PlayButton),this.scaleContainer.addChild(this.PlayButton),this.sparklepanel=new c,this.scaleContainer.addChild(this.sparklepanel),h.Utils.setPosition(this.PlayButton,393,286),h.Utils.logit("Title Panel Setup")},h.teardown=function(){g.teardown.call(this),this.background=null,this.PlayButton=null},namespace("WGBH").TitlePanel=f}(),function(){var a,b,c,d=include("springroll.easeljs.BaseState"),e=include("createjs.Tween"),f=include("WGBH.Utilities"),g=include("WGBH.SharedAnimation"),h=include("WGBH.BandAnimation"),i=include("WGBH.BandPanel"),j=function(a){d.call(this,new i,a),this.onBack=this.onBack.bind(this),this.onCreate=this.onCreate.bind(this),this.update=this.update.bind(this),app.on("update",this.update)},k=extend(j,d),l=.5,m=!1,n=!1,o=null,p=null,q=[0,0,0,0,0,1,2,2,3,1,0,0,0,1,0,1,1,2,1,0,0,0,0,1,1,1,0,0,0,0,0,2,3,2,1,0,0,0,2,3,3,1,0,0,0,1,1,1,2,3,3,2,0,0,0,0,0,1,2,1,0,0,0,0,0,0,0,1,1,2,2,1,1,0,0,0,1,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];k.onAssetsLoaded=function(){if(k.SharedAnimation=new g,k.Utils=new f,k.Anim=new h,k.Utils.logit("[BandState.onAssetsLoaded]: enter Function!"),k.panel=this.panel,c=this.panel,b=k.panel.data.materialtype,m=!1,k.SongData=app.config.gameData.Songs,k.iLastMaterialHit=-1,k.trackPlaying=[-1,!1,!1,!1],k.audioChannels=[null,null,null,null],k.panel.BackButton.addEventListener("click",this.onBack),k.panel.BackButton.cursor="pointer",k.panel.AvatarContainer.addEventListener("click",this.onCreate),k.panel.AvatarContainer.cursor="pointer",createjs.Touch.isSupported()){for(a=k.panel.data.BandZones.length-1;a>=0;a--)k.panel[b+(a+1)+"Container"].on("pressmove",k.checkMaterialHit,null,!1,{mypanel:k.panel});k.panel.FullArea.on("pressmove",k.checkMaterialHit,null,!1,{mypanel:k.panel}),k.panel.AvatarContainer.on("pressmove",k.checkMaterialHit,null,!1,{mypanel:k.panel})}this.panel.FullAreaTute.on("pressmove",function(){app.savedData.isTutorialCancellable&&k.endTutorial()}),this.panel.FullAreaTute.on("click",function(){app.savedData.isTutorialCancellable&&k.endTutorial()});var d="";for(a=app.savedData.aFilledNames[app.currentInstrument].length-1;a>=1;a--)d=app.savedData.aFilledNames[app.currentInstrument][a]+b,k.panel[b+a+"Container"].on("click",k.playOnceSoundData,null,!1,{name:app.savedData.aFilledNames[app.currentInstrument][a],index:a}),createjs.Touch.isSupported()||k.panel[b+a+"Container"].on("mouseover",k.playOnceSoundData,null,!1,{name:app.savedData.aFilledNames[app.currentInstrument][a],index:a}),k.panel[b+a+"Container"].addChild(k.panel[d+a]),k.panel["s"+a].alpha=0,k.panel[b+a+"Container"].numChildren>0&&(k.panel[b+a+"Container"].getChildAt(0).x=k.panel.data.offsets[0]);k.panel.AvatarContainer.removeAllChildren(),k.panel.AvatarContainer.addChild(k.panel[app.currentInstrument+"Button"]),k.panel.MusicStand.on("click",k.updateSong,null,!1,{bFirst:!1,start_volume:l}),k.panel.MusicStand.cursor="pointer",k.updateSong(null,{bFirst:!0,start_volume:0}),k.showButtons(),k.SharedAnimation.startBlink(k.panel.PeterEyes),k.SharedAnimation.startBlink(k.panel.JasmineEyes),k.SharedAnimation.startBlink(k.panel.PinkEyes),k.panel.PinkMouths.gotoAndStop("idle"),createjs.Touch.enable(stage)},k.enterDone=function(){k.Utils.logit("[BandState.enterDone]: enter Function!"),app.savedData.aFilledNames[app.currentInstrument]&&(k.Utils.logit("got some saved instrument settings for "+app.currentInstrument),k.Utils.logit(app.savedData.aFilledNames[app.currentInstrument][1])),app.on("update",this.update),c.FullAreaTute.alpha=app.showBandTutorial?c.FullAreaTute.alpha:0,c.TuteHand.alpha=app.showBandTutorial?c.TuteHand.alpha:0,k.startIntroduction(),k.Utils.setGAPageview("/play-mode-"+app.currentInstrument+"-"+app.lastState+".html")},k.startIntroduction=function(){if(app.showBandTutorial){k.Utils.logit("Band: Start Tutorial");var a=c.TuteHand,b=1200,d={x:c.MusicBox.x+250,y:c.MusicBox.y+c.MusicBox.image.height/3},f={x:c.MusicBox.x+c.MusicBox.image.width-50,y:c.MusicBox.y+c.MusicBox.image.height/3},g={x:c.btnPlayer1.x+15,y:c.btnPlayer1.y},h={x:c.btnPlayer2.x,y:c.btnPlayer2.y},i={x:c.btnPlayer3.x,y:c.btnPlayer3.y},j={x:c.MusicStand.x+c.MusicStand.image.width/2,y:c.MusicStand.y+c.MusicStand.image.height/5},l=[0,0,0,0,0,0,0,0,1,1,1,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,1,3,2,2,2,2,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,0,0,0,0,0,2,2,2,2,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0],m=[0,0,0,0,0,1,2,3,2,2,0,0,2,2,2,1,0,0,0,0,1,3,3,2,2,1,1,0,0,0,0,0,1,1,0,0,0,1,2,2,1,0,0,0,1,2,2,3,2,2,1,1,1,1,0,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0],r=[0,0,0,0,0,0,3,3,3,2,1,1,1,2,1,0,0,0,0,0,0,1,1,2,1,2,3,3,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0];p=q,o=c.PinkMouths,k.Utils.playVO("mg-play-make-music"),e.get(a).to({alpha:1,x:d.x,y:d.y},0*b).wait(2.5*b).to({alpha:1},.25*b).wait(.25*b).call(function(){p=q,k.Utils.playVO("mg-play-tutorial-instrument")}).to({x:f.x,y:f.y},1.2*b).to({x:d.x+200,y:d.y},1.2*b).wait(.25*b).call(function(){p=m,k.Utils.playVO("mg-play-tutorial-tap-me")}).to({x:g.x,y:g.y},.5*b).wait(.25*b).to({x:h.x,y:h.y},.75*b).wait(.5*b).to({x:i.x,y:i.y},.5*b).wait(1*b).call(function(){p=l,k.Utils.playVO("mg-play-tutorial-song")}).to({x:j.x,y:j.y},.5*b).wait(3400).call(function(){p=r,k.Utils.playVO("mg-play-tutorial-yourturn")}).wait(500).to({alpha:0},.25*b).wait(1500).call(function(){k.endTutorial()})}else p=q,o=c.PinkMouths,n=!0,app.voPlayer.play(["mg-play-make-music",function(){n=!1}])},k.endTutorial=function(){app.showBandTutorial&&(k.Utils.logit("endTutorial: really!"),k.panel.PinkMouths.gotoAndStop("idle"),app.savedData.isTutorialCancellable=!0,app.showBandTutorial=!1,app.voPlayer.stop(),e.removeTweens(c.TuteHand),c.TuteHand.alpha=0,c.FullAreaTute.alpha=0,c.FullAreaTute.removeAllEventListeners("pressmove"),c.FullAreaTute.removeAllEventListeners("click"))},k.updateSong=function(b,d){var e=k.bandTracks;for(app.iCurrentSong++,app.iCurrentSong=d.bFirst||app.iCurrentSong>=k.SongData.length?0:app.iCurrentSong,k.bandTracks=k.SongData[app.iCurrentSong],a=k.trackPlaying.length-1;a>=1;a--)k.trackPlaying[a]&&(k.Utils.logit("should stop the track for "+a),app.sound.stop(e[a])),k.audioChannels[a]=app.sound.play(k.bandTracks[a],{loop:-1,volume:d.start_volume*k.trackPlaying[a]});if(k.Utils.logit(app.iCurrentSong),c.FullArea.removeAllChildren(),c.FullArea.addChild(c["background"+(app.iCurrentSong+1)]),!d.bFirst){var f={x:880,y:175,init_pause_fact:0};k.SharedAnimation.sparkleMe1(c.scaleContainer,f,!1)}},k.update=function(a){app.voPlayer.playing&&p&&k.SharedAnimation.setMouth(o,p),m&&k.fadeAllSound()},k.showButtons=function(){for(var a=k.trackPlaying.length-1;a>=1;a--)k.panel["btnPlayer"+a].on("click",k.playMusic,null,!1,{track:a}),k.panel["btnPlayer"+a].cursor="pointer"},k.playMusic=function(a,b){if(k.endTutorial(),k.trackPlaying[b.track])k.Utils.logit("STOP song "+k.bandTracks[b.track]),k.audioChannels[b.track].volume=0,k.Anim.StopCharacter(b.track,k.panel);else{if(k.Utils.logit("OK, Pink is index = "+b.track),n&&2===b.track)return;k.Utils.logit("playing song "+k.bandTracks[b.track]),k.audioChannels[b.track].volume=l,k.Anim.StartCharacter(b.track,k.panel,k)}k.trackPlaying[b.track]=!k.trackPlaying[b.track]},k.fadeAllSound=function(){for(var a,b=45,c=l/b,d=k.audioChannels.length-1;d>=1;d--)a=k.audioChannels[d].volume-c,0>=a?(app.sound.stop(k.bandTracks[d]),k.trackPlaying[d]=!1):k.audioChannels[d].volume=a},k.playOnceSoundData=function(a,b){var c=b.name?b.name:app.savedData.aFilledNames[app.currentInstrument][b.index];k.iLastMaterialHit=-1,k.playOnceSound(c,b.index)},k.playOnceSound=function(a,b){if(k.endTutorial(),k.iLastMaterialHit!=b&&a.toString().toLowerCase()){var d="pink_music_"+app.currentInstrument.toString().toLowerCase()+"_"+a.toString().toLowerCase()+"-"+b;app.sound.play(d),k.iLastMaterialHit=b;var e=c["s"+b].graphics.command;e&&(params={x:e.x+e.w/2,y:e.y+e.h/2,init_pause_fact:0},k.SharedAnimation.sparkleMeMany(c,c.sparklepanel,params,!1))}},k.checkMaterialHit=function(a,b){var c=b.mypanel.scaleContainer.globalToLocal(a.stageX,a.stageY),d=c.x,e=c.y,f=b.mypanel.rect1.contains(d,e),g=b.mypanel.rect2.contains(d,e),h=b.mypanel.rect3.contains(d,e),i=b.mypanel.rect4.contains(d,e);f?k.playOnceSound(app.savedData.aFilledNames[app.currentInstrument][1],"1"):g?k.playOnceSound(app.savedData.aFilledNames[app.currentInstrument][2],"2"):h?k.playOnceSound(app.savedData.aFilledNames[app.currentInstrument][3],"3"):i?k.playOnceSound(app.savedData.aFilledNames[app.currentInstrument][4],"4"):k.iLastMaterialHit=-1},k.onCreate=function(){this.manager.state="game"},k.onBack=function(){this.previousState()},k.exitStart=function(){m=!0,app.voPlayer.stop()},k.exit=function(){k.panel.BackButton.removeEventListener("click",this.onBack),k.panel.AvatarContainer.removeEventListener("click",this.onCreate),k.panel.FullAreaTute.removeAllEventListeners("click"),k.panel.MusicStand.removeAllEventListeners("click");for(var a=k.trackPlaying.length-1;a>=1;a--)app.sound.stop(k.bandTracks[a]),k.trackPlaying[a]=!1;m=!1,k.Utils.write2SavedData(),app.lastState="play",app.off("update",this.update)},namespace("WGBH").BandState=j}(),function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=include("springroll.easeljs.BaseState"),q=include("createjs.Tween"),r=include("WGBH.Utilities"),s=include("WGBH.SharedAnimation"),t=include("WGBH.GamePanel"),u=function(a){p.call(this,new t,a),this.onNext=this.onNext.bind(this),this.onBack=this.onBack.bind(this),this.update=this.update.bind(this)},v=extend(u,p);v.onAssetsLoaded=function(){for(v.SharedAnimation=new s,v.Utils=new r,v.Utils.logit("[GameState.onAssetsLoaded]: enter Function!"),j=this.panel,k=j.data.materialtype,n=!0,v.Utils.logit("piece = "+k),this.panel.BackButton.addEventListener("click",this.onBack),this.panel.NextButton.addEventListener("click",this.onNext),this.panel.NextButtonInactive.addEventListener("click",this.onNext),this.DragManager=new springroll.DragManager(app.display,this.onDragStart.bind(this),this.onDragEnd.bind(this)),this.DragManager.multitouch=!1,this.DragManager.isStickyClick=!0,this.DragManager.dragStartThreshold=14,/Mobi/.test(navigator.userAgent)&&(this.DragManager.allowStickyClick=!1),h=this.panel.data.Materials.length-1;h>=0;h--)i=this.panel.data.Materials[h],this[i.name]=this.panel[i.name],this[i.name].name=[i.name],this.DragManager.addObject(this[i.name]),this[i.name].enableDrag(),this[i.name+"back"]=this.panel[i.name+"back"];if(createjs.Touch.isSupported()){for(h=this.panel.data.DropZones.length-1;h>=0;h--)a=this.panel.data.DropZones[h],this.panel[this.panel.data.materialtype+(h+1)+"Container"].on("pressmove",v.checkMaterialHit,null,!1,{mypanel:this.panel});this.panel.FullArea.on("pressmove",v.checkMaterialHit,null,!1,{mypanel:this.panel})}this.panel.FullAreaTute.on("pressmove",function(){app.savedData.isTutorialCancellable&&v.endTutorial()}),this.panel.FullAreaTute.on("click",function(){app.savedData.isTutorialCancellable&&v.endTutorial()}),createjs.Touch.enable(stage),j.FullAreaTute.alpha=app.showCreateTutorial?j.FullAreaTute.alpha:0,j.TuteHand.alpha=app.showCreateTutorial?j.TuteHand.alpha:0},v.enterDone=function(){if(v.Utils.logit("[GameState.enterDone]: enter Function!"),v.initValues(this.panel),app.on("update",this.update),app.savedData.aFilledNames[app.currentInstrument]){v.Utils.logit("enterDone: retrieve something "+app.savedData.aFilledNames[app.currentInstrument][1]),e=app.savedData.aFilledNames[app.currentInstrument];for(var a="",b=e.length-1;b>=1;b--)""!==e[b]&&(this.panel["s"+b].full=!0,a=e[b]+k,this.panel["s"+b].removeAllChildren(),this.panel[k+b+"Container"].on("click",v.playOnceSoundData,null,!1,{name:e[b],index:b}),createjs.Touch.isSupported()||this.panel[k+b+"Container"].on("mouseover",v.playOnceSoundData,null,!1,{name:e[b],index:b}),this.panel["s"+b].addChild(this.panel[a+b]),this.panel["s"+b].alpha=1);v.setNextButton(this.panel)}else v.Utils.logit("enterDone: set something "+e[0]),app.savedData.aFilledNames[app.currentInstrument]=e;n=!1,v.startIntroduction(),v.Utils.setGAPageview("/create-mode-"+app.currentInstrument+".html")},v.startIntroduction=function(){if(app.showCreateTutorial){var a,d=j.TuteHand,e={x:450,y:512},g=1200,h={x:j.s1.x+j.s1.mask.graphics.command.w/2,y:j.s1.y+j.s1.mask.graphics.command.h/2},k={x:j.s2.x+j.s2.mask.graphics.command.w/2,y:j.s2.y+j.s2.mask.graphics.command.h/2},l={x:j.s3.x+j.s3.mask.graphics.command.w/2,y:j.s3.y+j.s3.mask.graphics.command.h/2},m={x:j.s4.x+j.s4.mask.graphics.command.w/2,y:j.s4.y+j.s4.mask.graphics.command.h/2};i=j.data.Materials[j.data.Materials.length-4],a=j[i.name],v.Utils.playVO("mg-tutorial-drag"),q.get(d).wait(.8*g).to({x:a.x+a.image.width/3,y:a.y+a.image.height/3,scaleX:.8,scaleY:.8},.6*g,createjs.Ease.getPowOut(2)).to({x:h.x,y:h.y},.75*g).to({x:k.x,y:k.y},.25*g).to({x:l.x,y:l.y},.25*g).to({x:m.x,y:m.y},.25*g).wait(.25*g).to({x:l.x,y:l.y},.25*g).to({x:k.x,y:k.y},.25*g).wait(.5*g).call(function(){v.Utils.playVO("mg-tutorial-letgo")}).wait(1*g).to({scaleX:1,scaleY:1},.25*g).wait(.25*g).to({x:e.x,y:e.y},.25*g).wait(1.5*g).call(function(){v.Utils.playVO("mg-tutorial-tap")}).wait(1.5*g).to({x:k.x,y:k.y},.25*g).to({scaleX:.8,scaleY:.8},.25*g).call(function(){f=-1,v.Utils.logit(j[i.name]),v.playOnceSound(a.name,"2")}).to({scaleX:1,scaleY:1},.25*g).to({x:e.x,y:e.y},.25*g).wait(1*g).to({alpha:0},.25*g).call(function(){v.endTutorial(),v.Utils.playVO("mg-tutorial-add")}),q.get(a).wait(1.4*g).call(function(){c=a,b=!0}).call(function(){v.playAllMaterials(a,{x:-a.image.width/3,y:-a.image.height/3,s1:h,s2:k,s3:l,s4:m,duration:g})}).wait(4*g).call(function(){v.onDragEnd(a)})}else v.Utils.logit("no tute, play VO for "+app.currentInstrument.toString().toLowerCase()),v.Utils.playVO("mg-create-"+app.currentInstrument.toString().toLowerCase()+"-intro")},v.playAllMaterials=function(a,b){v.Utils.logit("playAllMaterials: Enter Function "),q.get(a).to({x:b.s1.x+b.x,y:b.s1.y+b.y},.75*b.duration).to({x:b.s2.x+b.x,y:b.s2.y+b.y},.25*b.duration).to({x:b.s3.x+b.x,y:b.s3.y+b.y},.25*b.duration).to({x:b.s4.x+b.x,y:b.s4.y+b.y},.25*b.duration).wait(.25*b.duration).to({x:b.s3.x+b.x,y:b.s3.y+b.y},.25*b.duration).to({x:b.s2.x+b.x,y:b.s2.y+b.y},.25*b.duration)},v.endTutorial=function(){app.showCreateTutorial&&(app.showCreateTutorial=!1,app.voPlayer.stop(),b=!1,q.removeTweens(j.TuteHand),j.TuteHand.alpha=0,i=j.data.Materials[j.data.Materials.length-4],q.removeTweens(j[i.name]),j.setDefaultObjectPostions(),j.FullAreaTute.alpha=0,j.FullAreaTute.removeAllEventListeners("pressmove"),j.FullAreaTute.removeAllEventListeners("click"))},v.playOnceSoundData=function(a,b){if(g===b.index)return void(g=-1);var c=b.name?b.name:e[b.index];f=-1,v.playOnceSound(c,b.index)},v.playOnceSound=function(a,b){if(f!=b&&a.toString().toLowerCase()){var c="pink_music_"+app.currentInstrument.toString().toLowerCase()+"_"+a.toString().toLowerCase()+"-"+b;v.Utils.logit("[playOnceSound]: the str = "+c),app.sound.play(c),f=b;var d=j["s"+b].mask.graphics.command;d&&(params={x:d.x+d.w/2,y:d.y+d.h/2,init_pause_fact:0},v.SharedAnimation.sparkleMeMany(j,j.sparklepanel,params,!1))}},v.update=function(a){if(b){var e=c.getBounds(),g=c.x+.5*e.width*c.scaleX,h=c.y+.5*e.height*c.scaleY,i=this.panel.rect1.contains(g,h),j=this.panel.rect2.contains(g,h),k=this.panel.rect3.contains(g,h),l=this.panel.rect4.contains(g,h);this.panel.s1.alpha=i?.5:1,this.panel.s2.alpha=j?.5:1,this.panel.s3.alpha=k?.5:1,this.panel.s4.alpha=l?.5:1,i?(d=this.panel.s1,d.index=1,v.playOnceSound(c.name,"1")):j?(d=this.panel.s2,d.index=2,v.playOnceSound(c.name,"2")):k?(d=this.panel.s3,d.index=3,v.playOnceSound(c.name,"3")):l?(d=this.panel.s4,d.index=4,v.playOnceSound(c.name,"4")):(d=null,f=-1)}},v.onDragStart=function(a,d){app.showCreateTutorial&&v.endTutorial(),b=!0,c=a,v.Utils.logit("[GameState,onDragStart]: enter Function")},v.onDragEnd=function(a){if(b=!1,c=null,v.Utils.logit("[GameState.onDragEnd]: enter Function!"),d){d.full=!0;var f="";j[k+d.index+"Container"].removeAllEventListeners("click"),a&&(v.Utils.logit("NEW great, we got a "+a.name),v.Utils.setPosition(a,j.data.Materials[a.index].position[0],j.data.Materials[a.index].position[1]),f=a.name+k,j[k+d.index+"Container"].on("click",v.playOnceSoundData,null,!1,{name:a.name,index:d.index}),createjs.Touch.isSupported()||(g=d.index,j[k+d.index+"Container"].removeAllEventListeners("mouseover"),j[k+d.index+"Container"].on("mouseover",v.playOnceSoundData,null,!1,{name:a.name,index:d.index})),e[d.index]=a.name),j["s"+d.index].removeAllChildren(),j[k+d.index+"Container"].removeAllChildren(),j["s"+d.index].addChild(j[f+d.index]),j["s"+d.index].getChildAt(0).x=j.data.offsets[0],j["s"+d.index].alpha=1,v.setNextButton(j),v.isFilled(1)?(v.Utils.logit("We are on the third hit"),v.playFeedback(),l=!1):v.isFilled(0)&&l&&!app.showCreateTutorial&&(v.playFeedback(),l=!1)}j.setDefaultObjectPostions()},v.playFeedback=function(){o||(o=!0,app.savedData.iCurrentFeedback++,app.savedData.iCurrentFeedback>3&&(app.savedData.iCurrentFeedback=1),app.voPlayer.play(["mg-create-feedback"+app.savedData.iCurrentFeedback,function(){o=!1}]))},v.setNextButton=function(a){var b=v.isFilled(0);if(v.Utils.logit("All filled? = "+b),a.NextButtonInactive.visible=b?!1:!0,a.NextButton.visible=b?!0:!1,b&&app.showBandTutorial&&m&&!n&&!app.showCreateTutorial){v.Utils.logit("Tutorial Done - play checkmark");var c={x:900,y:660,init_pause_fact:2.6};v.SharedAnimation.sparkleMe1(a.rightContainer,c,!1),v.Utils.playVO("mg-tutorial-done"),m=!1}},v.isFilled=function(a){for(var b=0,c=e.length-1;c>=1;c--)e[c]&&b++;return b==e.length-1-a},v.checkMaterialHit=function(a,b){var c=b.mypanel.scaleContainer.globalToLocal(a.stageX,a.stageY),d=c.x,g=c.y,h=b.mypanel.rect1.contains(d,g),i=b.mypanel.rect2.contains(d,g),j=b.mypanel.rect3.contains(d,g),k=b.mypanel.rect4.contains(d,g);h?v.playOnceSound(e[1],"1"):i?v.playOnceSound(e[2],"2"):j?v.playOnceSound(e[3],"3"):k?v.playOnceSound(e[4],"4"):f=-1},v.onNext=function(){v.isFilled(0)?(app.savedData.iProgress=2,app.savedData.lastCompleteInstrument=app.currentInstrument,this.nextState()):o||(o=!0,app.voPlayer.play(["mg-create-add-all",function(){o=!1}]))},v.onBack=function(){this.previousState()},v.onReset=function(){for(v.initValues(this.panel),this.panel.setDefaultObjectPostions(),h=this.panel.data.DropZones.length;h>=1;h--)this.panel[k+h+"Container"].removeAllChildren(),this.panel[k+h+"Container"].removeAllEventListeners("click"),this.panel["s"+h].removeAllChildren(),this.panel["s"+h].removeAllEventListeners("click")},v.initValues=function(a){for(b=!1,c=null,d=null,e=["empty","","","",""],f=-1,l=!0,m=!app.savedData.isTutorialCancellable,o=!1,h=a.data.DropZones.length;h>=1;h--)a["s"+h].alpha=1,a["s"+h].full=!1;v.setNextButton(a)},v.clearListeners=function(a){for(h=a.data.DropZones.length;h>=1;h--)a[k+h+"Container"].removeAllChildren(),a[k+h+"Container"].removeAllEventListeners("click"),a[k+h+"Container"].removeAllEventListeners("pressmove"),a["s"+h].removeAllChildren(),a["s"+h].removeAllEventListeners("click");a.FullArea.removeAllEventListeners("pressmove"),a.NextButtonInactive.removeEventListener("click",this.onNext),a.NextButton.removeEventListener("click",this.onNext),a.BackButton.removeEventListener("click",this.onBack)},v.exitStart=function(){this.DragManager.destroy(),v.isFilled(0)?(v.Utils.logit("full, set filled slots"),app.savedData.aFilledNames[app.currentInstrument]=e):v.Utils.logit("not full, let app stay"),v.endTutorial(),app.voPlayer.stop()},v.exit=function(){q.removeAllTweens(),v.initValues(this.panel),v.clearListeners(this.panel),v.Utils.write2SavedData(),app.lastState="create",app.off("update",this.update)},namespace("WGBH").GameState=u}(),function(){var a,b,c,d=include("springroll.easeljs.BaseState"),e=include("WGBH.InstrumentsAnimation"),f=include("WGBH.Utilities"),g=include("WGBH.InstrumentsPanel"),h=function(a){d.call(this,new g,a),this.onBack=this.onBack.bind(this),this.onHarp=this.onHarp.bind(this),this.onDrum=this.onDrum.bind(this),this.onXylophone=this.onXylophone.bind(this),this.onPlay=this.onPlay.bind(this),this.onNoPlay=this.onNoPlay.bind(this),this.update=this.update.bind(this)},i=extend(h,d);i.onAssetsLoaded=function(){i.Utils=new f,i.Utils.logit("[InstrumentsState.onAssetsLoaded]: enter Function!"),i.Anim=new e,b=this,c=b.panel,createjs.Touch.enable(stage)},i.enterDone=function(){a=!1,i.enableButtons(),app.savedData.iProgress<1?(i.enableNoPlay(),app.iMenuVOPlayed1||(i.Anim.InstrumentBounce(c),app.voPlayer.play([500,"mg-chooser-pick-instrument"]),app.iMenuVOPlayed1=!0),""!==app.savedData.lastCompleteInstrument&&(app.savedData.iProgress=1)):(i.enablePlay(),app.iMenuVOPlayed2||(i.Anim.InstrumentBounce(c),i.Anim.PlayBounce(c),app.voPlayer.play(["mg-chooser-pick-play"]),app.iMenuVOPlayed2=!0)),i.Utils.logit("[InstrumentsState.enterDone]: enter Function!"),app.on("update",this.update)},i.enableButtons=function(){c.HarpButton.addEventListener("click",b.onHarp.bind(b)),c.DrumButton.addEventListener("click",b.onDrum.bind(b)),c.XylophoneButton.addEventListener("click",b.onXylophone.bind(b)),c.BackButton.addEventListener("click",b.onBack.bind(b)),c.PlayButton.addEventListener("click",b.onPlay.bind(b)),c.PlayButtonInactive.addEventListener("click",b.onNoPlay.bind(b))},i.enableNoPlay=function(){c.PlayButtonInactive.visible=!0,c.PlayButton.visible=!1},i.enablePlay=function(){c.PlayButtonInactive.visible=!1,c.PlayButton.visible=!0},i.update=function(a){},i.onBack=function(){a||b.previousState()},i.onHarp=function(){a||(a=!0,app.voPlayer.stop(),app.currentInstrument="Harp",currentInstrumentHasBeenClicked()?(app.sound.play("ButtonClick"),b.nextState()):app.voPlayer.play(["mg-menu-harp",b.nextState.bind(b)]))},i.onDrum=function(){a||(a=!0,app.voPlayer.stop(),app.currentInstrument="Drum",currentInstrumentHasBeenClicked()?(app.sound.play("ButtonClick"),b.nextState()):app.voPlayer.play(["mg-menu-drums",b.nextState.bind(b)]))},i.onXylophone=function(){a||(a=!0,app.voPlayer.stop(),app.currentInstrument="Xylo",currentInstrumentHasBeenClicked()?(app.sound.play("ButtonClick"),b.nextState()):app.voPlayer.play(["mg-menu-xylophone",b.nextState.bind(b)]))},i.onNoPlay=function(){a||(a=!0,app.voPlayer.stop(),i.Anim.InstrumentBounce(c),app.voPlayer.play(["mg-chooser-need-make",function(){a=!1}]))},i.onPlay=function(){a||(a=!0,app.voPlayer.stop(),""!==app.savedData.lastCompleteInstrument&&(app.currentInstrument=app.savedData.lastCompleteInstrument),app.sound.play("ButtonClick"),b.manager.state="band")},currentInstrumentHasBeenClicked=function(){return i.Utils.logit("[currentInstrumentHasBeenClicked]: app.currentInstrument "+app.currentInstrument),i.Utils.logit(app.sInstrumentsClicked.indexOf(app.currentInstrument)),-1!==app.sInstrumentsClicked.indexOf(app.currentInstrument)?!0:(app.sInstrumentsClicked+=app.currentInstrument,i.Utils.logit("[currentInstrumentHasBeenClicked]: app.sInstrumentsClicked "+app.sInstrumentsClicked),!1)},i.exit=function(){c.BackButton.removeEventListener("click",this.onBack),c.HarpButton.removeEventListener("click",this.onHarp),c.DrumButton.removeEventListener("click",this.onDrum),c.XylophoneButton.removeEventListener("click",this.onXylophone),c.PlayButtonInactive.removeEventListener("click",this.onNoPlay),c.PlayButton.removeEventListener("click",this.onPlay),app.voPlayer.stop(),i.Utils.write2SavedData(),app.lastState="menu",app.off("update",this.update)},namespace("WGBH").InstrumentsState=h}(),function(){var a,b=include("springroll.easeljs.BaseState"),c=include("createjs.Tween"),d=include("WGBH.Utilities"),e=include("WGBH.SharedAnimation"),f=include("WGBH.IntroPanel"),g=function(a){b.call(this,new f,a),this.onPlay=this.onPlay.bind(this),this.update=this.update.bind(this)},h=extend(g,b),i=null,j=null,k=null;h.onAssetsLoaded=function(){h.SharedAnimation=new e,h.Utils=new d,h.Utils.logit("[IntroState.onAssetsLoaded]: enter Function!"),a=this.panel,createjs.Touch.enable(stage)},h.enterDone=function(){this.panel.NextButton.addEventListener("click",this.onPlay),this.panel.background.addEventListener("buttonPress",this.onPlay),this.panel.NextButton.cursor="pointer",h.Utils.logit("[IntroState.enterDone]: enter Function!"),h.SharedAnimation.startBlink(a.PeterEyes),h.SharedAnimation.startBlink(a.PinkEyes),h.SharedAnimation.startBlink(a.JasmineEyes),h.introAnimation(),app.on("update",this.update)},h.introAnimation=function(){h.Utils.logit("Intro Animation: START");var b=(a.TuteHand,1e3);c.get(a.NextButton).wait(b).call(function(){j=a.PinkMouth,k=[0,0,0,0,2,3,3,2,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,2,2,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,2,1,0,0,1,1,0,1,1,2,3,3,2,0,0,0,0,0,0,0,1,1,2,2,1,1,1,0,0,0,1,1,0,0,1,2,1,0,0,0,0,0,0,0,0,0,0,1,1,2,1,1,0,0,0,0,0,0,0,0,2,0,1,1,2,1,1,0,0,0,0,0,0,1,2,2,2,2,1,0,0,0,0,0,0,0,0,0,0,0,1,2,2,1,2,3,3,1,0,0,0,0,1,1,1,2,1,2,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,1,0,0,1,2,1,1,0,0,1,1,0,1,2,1,0,0,0,0,0,0,0,0,1,2,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,2,1,0,0,0,0,0,1,2,2,2,2,1,1,0,0,0,0,0,0,0,0],i=app.voPlayer.play(["mg-intro",h.sparkleAnimation.bind(this)])}),c.get(a.PinkArmAll).wait(.5*b).to({rotation:0},.6*b,createjs.Ease.getPowOut(3)).wait(1.6*b).to({rotation:30},1*b,createjs.Ease.getPowOut(3)),c.get(a.PinkArmLowerAll).wait(.5*b).to({rotation:-10},.8*b).to({rotation:20},.3*b).to({rotation:-10},.3*b).to({rotation:10},.6*b).to({rotation:100},.5*b),c.get(a.PinkUpperAll).to({rotation:.05},.5*b,createjs.Ease.getPowOut(3)).to({rotation:-5},1*b,createjs.Ease.getPowOut(3)).to({rotation:-4.95},.4*b,createjs.Ease.getPowOut(3)).to({rotation:0},1.8*b,createjs.Ease.getPowOut(3)),c.get(a.PinkHeadTalkAll).wait(.25*b).to({rotation:-3},.6*b,createjs.Ease.getPowOut(3)).wait(.4*b).to({rotation:3},1*b,createjs.Ease.getPowOut(3)).wait(.4*b).to({rotation:0},1*b,createjs.Ease.getPowOut(3)).wait(2*b).to({rotation:-4},1*b,createjs.Ease.getPowOut(1)).to({rotation:0},1*b,createjs.Ease.getPowOut(3)).wait(2*b).to({rotation:3},1*b,createjs.Ease.getPowOut(1)).to({rotation:0},1*b,createjs.Ease.getPowOut(3)).call(function(){h.SharedAnimation.startHeadBob(a.PinkHeadTalkAll),h.SharedAnimation.startHeadBob(a.PeterHeadAll)}),h.SharedAnimation.startHeadBob(a.JasmineHeadAll),h.SharedAnimation.startHeadBob(a.PeterHeadAll),c.get(a.PeterHeadAll).wait(4*b).call(function(){a.PinkHeadTalkAll.alpha=0,a.PinkHeadTalkSideAll.alpha=1,j=a.PinkMouthSide}).wait(.25*b).call(function(){a.PeterHeadAll.alpha=0,a.PeterHeadTurn.alpha=1}).wait(.5*b).call(function(){a.PeterHeadAll.alpha=1,a.PeterHeadTurn.alpha=0,a.PinkHeadTalkAll.alpha=1,a.PinkHeadTalkSideAll.alpha=0,j=a.PinkMouth}).wait(.75*b).call(function(){a.JasmineHeadAll.alpha=0,a.JasmineHeadTurn.alpha=1}).wait(1*b).call(function(){a.JasmineHeadAll.alpha=1,a.JasmineHeadTurn.alpha=0}).wait(2.5*b).call(function(){a.PeterHeadAll.alpha=0,a.PeterHeadTurn.alpha=1}).wait(1*b).call(function(){a.PeterHeadAll.alpha=1,a.PeterHeadTurn.alpha=0})},h.sparkleAnimation=function(){c.get(a.NextButton).wait(500).call(function(){h.SharedAnimation.sparkleMe3(a.rightContainer,!1)})},h.update=function(a){app.voPlayer.playing&&k&&h.SharedAnimation.setMouth(j,k)},h.onPlay=function(){this.nextState()},h.exitStart=function(){app.voPlayer.stop(),c.removeAllTweens()},h.exit=function(){this.panel.NextButton.removeEventListener("click",this.onPlay),this.panel.background.removeEventListener("buttonPress",this.onPlay),h.Utils.write2SavedData(),app.lastState="intro",app.off("update",this.update)},namespace("WGBH").IntroState=g}(),function(){var a=include("springroll.easeljs.BaseState"),b=include("createjs.Tween"),c=include("WGBH.Utilities"),d=include("WGBH.SharedAnimation"),e=include("WGBH.TitlePanel"),f=function(b){a.call(this,new e,b),this.onPlay=this.onPlay.bind(this)},g=extend(f,a),h=this.panel,i={x:500,y:364,init_pause_fact:0};g.onAssetsLoaded=function(){g.SharedAnimation=new d,g.Utils=new c,g.Utils.logit("[TitleState.onAssetsLoaded]: enter Function!"),h=this.panel,createjs.Touch.enable(stage)},g.enterDone=function(){this.panel.PlayButton.addEventListener("click",this.onPlay),this.panel.background.addEventListener("click",this.onPlay),this.panel.background.cursor="pointer",app.savedData||g.Utils.readSavedData(),app.voPlayer.play(["mg-title",2e3,g.sparkleAnimation.bind(this)]),g.sparkleAnimation(),g.Utils.setGAPageview("/splash.html")},g.sparkleAnimation=function(){b.get(h.PlayButton).wait(200).call(function(){g.SharedAnimation.sparkleMe1(h.scaleContainer,i,!1),i={x:450,y:384,init_pause_fact:0}})},g.onPlay=function(){this.nextState()},g.exitStart=function(){app.voPlayer.stop()},g.exit=function(){this.panel.background.cursor=null,this.panel.background.removeEventListener("click",this.onPlay),this.panel.PlayButton.removeEventListener("click",this.onPlay),app.lastState="title"},namespace("WGBH").TitleState=f}(),function(){var a=include("WGBH.TitleState"),b=include("WGBH.IntroState"),c=include("WGBH.InstrumentsState"),d=include("WGBH.GameState"),e=include("WGBH.BandState"),f=include("springroll.Application"),g=include("lib.Transition"),h=include("springroll.easeljs.EaselJSDisplay"),i=function(a,b){window.images[b.id]=a},j=new f({fps:60,name:"springrolltest",state:"title",canvasId:"stage",configPath:"assets/config/config.json",manifestsPath:"assets/config/manifests.json",display:h,displayOptions:{clearView:!0},preload:[{id:"pink_loader_sprite",src:"assets/images/loading/pink_loader_sprite.png",complete:i},{id:"pink_loader_bg",src:"assets/images/loading/pink_loader_bg.jpg",complete:i},{id:"pink_loader_heart",src:"assets/images/loading/pink_loader_heart.png",complete:i},{id:"pink_loader_bee",src:"assets/images/loading/pink_loader_bee.png",complete:i}]});j.on("init",function(){var f=this.config.assets,h=this.config.scaling;this.manifests;this.transition=new g,this.transition.framerate=30,this.states={title:new a({next:"intro",preload:f.title,scaling:h.title}),intro:new b({next:"instruments",previous:"title",preload:f.intro,scaling:h.intro}),instruments:new c({next:"game",previous:"intro",preload:f.instruments,scaling:h.instruments}),game:new d({next:"band",previous:"instruments",preload:f.game,scaling:h.game}),band:new e({next:"game",previous:"instruments",preload:f.band,scaling:h.band})}}),window.app=j}();