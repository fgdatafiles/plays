!function(){var t=include("springroll.easeljs.BasePanel"),i=include("createjs.Container"),e=include("springroll.easeljs.Button"),a=function(){t.call(this)},s=t.prototype,n=extend(a,t);n.setup=function(){this.roundCont=new i,this.roundCont.name="roundContainer",this.homeBtn=new e(images.btn_pause),this.homeBtn.name="homeButton",this.roundTxt=new createjs.Text("Round 1 of "+app.config.gameData.ROUND_TOTAL,"45px Hooligan",app.config.gameData.fontColorArr[app.actionArr[app.actionIndx]]),this.roundTxt.name="roundText",this.roundTxt.x=100,this.roundTxt.y=70,this.roundTxt.textBaseline="bottom",this.roundCont.addChild(this.roundTxt,this.homeBtn),this.drawPromptTxt=new createjs.Text("",app.config.gameData.fontSizeArr[0]+"px Hooligan",app.config.gameData.fontColorArr[0]),this.drawPromptTxt.textAlign="right",this.drawPromptTxt.textBaseline="bottom",this.drawPromptTxt.name="drawingPromptText",this.drawPromptTxt.visible=!1,this.uiContainer=new i,this.uiContainer.name="uiContainer",this.uiLeftContainer=new i,this.uiLeftContainer.name="uiLeftContainer",this.mainContainer=new i,this.mainContainer.name="mainContainer",this.mainTopContainer=new i,this.mainTopContainer.name="mainTopContainer",this.categoryContainer=new WGBH.CategoryScreen(this),this.gameContainer=new WGBH.GameScreen(this,this.uiContainer,this.uiLeftContainer),this.spinContainer=new WGBH.SpinScreen(this),this.scoreContainer=new WGBH.ScoreScreen(this,this.uiContainer,this.gameContainer),this.gameOverContainer=new WGBH.GameOverScreen(this),this.homeOverlay=new WGBH.SettingsScreen(this),this.homeOverlay.visible=!1,this.sparklesCont=new i,this.mainContainer.addChild(this.gameContainer,this.categoryContainer,this.scoreContainer),this.mainTopContainer.addChild(this.spinContainer,this.gameOverContainer,this.homeOverlay,this.sparklesCont),this.addChild(this.mainContainer,this.uiContainer,this.uiLeftContainer,this.roundCont,this.drawPromptTxt,this.mainTopContainer)},n.teardown=function(){s.teardown.call(this),this.roundCont=null,this.homeBtn=null,this.roundTxt=null,this.drawPromptTxt=null,this.uiContainer=null,this.uiLeftContainer=null,this.mainContainer=null,this.mainTopContainer=null,this.categoryContainer=null,this.gameContainer=null,this.spinContainer=null,this.scoreContainer=null,this.gameOverContainer=null,this.homeOverlay=null},namespace("WGBH").GamePanel=a}(),function(){var t=include("springroll.easeljs.BasePanel"),i=include("createjs.Bitmap"),e=include("springroll.easeljs.Button"),a=function(){t.call(this)},s=t.prototype,n=extend(a,t);n.setup=function(){this.background=new i(images.TitleBackground),this.addChildAt(this.background,0),this.intro=new lib.Intro,this.nextBtn=new e(images.NextButton),this.nextBtn.regX=images.NextButton.width/2,this.nextBtn.regY=images.NextButton.height/6,this.addChild(this.intro,this.nextBtn)},n.teardown=function(){s.teardown.call(this),this.background=null,this.intro=null,this.nextBtn=null},namespace("WGBH").IntroPanel=a}(),function(){var t=include("springroll.easeljs.BasePanel"),i=include("createjs.Bitmap"),e=include("springroll.easeljs.Button"),a=function(){t.call(this)},s=t.prototype,n=extend(a,t);n.setup=function(){this.background=new i(images.TitleBackground),this.addChildAt(this.background,0),this.playerContainer=new createjs.Container,this.addChild(this.playerContainer),this.boxCont=new createjs.Container,this.contWidth=app.startOver?580:560;var t=new i(app.startOver?images.BG_playagain:images.BG_players);this.boxCont.x=app.startOver?222:232,this.boxCont.y=260,this.txt=new createjs.Text(app.startOver?"Play again with":"How many players?","90px Hooligan","white"),this.txt.textAlign="center",this.txt.textBaseline="bottom",this.txt.x=this.contWidth/2,this.txt.y=-50,this.numTxt=new createjs.Text(app.playerTotal,"160px Hooligan",app.config.gameData.PINK_COLOR),this.numTxt.textAlign="center",this.numTxt.textBaseline="bottom",this.numTxt.x=this.txt.x,this.numTxt.y=230,this.minusBtnInactive=new i(images.btn_minus_inactive),this.minusBtn=new e(images.btn_minus),this.minusBtn.regX=this.minusBtnInactive.regX=46,this.minusBtn.regY=this.minusBtnInactive.regY=46,this.addBtnInactive=new i(images.btn_add_inactive),this.addBtn=new e(images.btn_add),this.addBtn.regX=this.addBtnInactive.regX=46,this.addBtn.regY=this.addBtnInactive.regY=46,this.minusBtn.x=this.minusBtnInactive.x=this.numTxt.x-170,this.addBtn.x=this.addBtnInactive.x=this.numTxt.x+170,this.minusBtn.y=this.addBtn.y=this.minusBtnInactive.y=this.addBtnInactive.y=this.numTxt.y-100,this.nextBtn=new e(images.btn_check),this.nextBtn.regX=70,this.nextBtn.regY=70,this.nextBtn.x=this.boxCont.x+this.contWidth/2,this.nextBtn.y=670,this.sameBtn=new e(images.btn_same),this.sameBtn.regX=156,this.newBtn=new e(images.btn_new),this.newBtn.regX=155,this.newBtn.x=this.sameBtn.x=this.txt.x,this.newBtn.y=this.playerContainer.y+56,this.sameBtn.y=this.newBtn.y+120,app.startOver?(this.numTxt.visible=!1,this.minusBtn.visible=!1,this.minusBtnInactive.visible=!1,this.addBtn.visible=!1,this.addBtnInactive.visible=!1,this.nextBtn.visible=!1):(this.newBtn.visible=!1,this.sameBtn.visible=!1),this.playerIconCont=new createjs.Container,this.playerBG=new createjs.Bitmap(images.BG1),this.playerBG.regX=467,this.playerBG.x=512,this.playerBG.y=120,this.playerTxt=new createjs.Text("PLAYER 1","70px Hooligan",app.config.gameData.PINK_COLOR),this.playerTxt.textAlign="center",this.playerTxt.textBaseline="bottom",this.playerTxt.x=517,this.playerTxt.y=250,this.playerIconCont.addChild(this.playerBG,this.playerTxt),this.playerIconCont.visible=!1,this.playerIconBtnArr=[];for(var a=280,s=this.playerTxt.y+105,n=0;n<8;n++){var r=new createjs.Sprite(ss.game,"player_icon"+n);r.cursor="pointer",this.playerIconCont.addChild(r),r.regX=55.5,r.regY=56,this.playerIconBtnArr.push(r),r.x=a,r.y=s,r.indx=n,3==n?(a=280,s+=140):a+=150}this.playerIcon=new createjs.Sprite(ss.game,"player_icon0"),this.playerIcon.x=this.playerTxt.x-180,this.playerIcon.y=this.playerTxt.y-77,this.playerIcon.scaleX=this.playerIcon.scaleY=.65,this.playerIconCont.addChild(this.playerIcon),this.selectedBtn=new createjs.Sprite(ss.game,"player_icon_selected"),this.selectedBtn.regX=90,this.selectedBtn.regY=86,this.playerIconCont.addChildAt(this.selectedBtn,1),this.selectedBtn.x=this.playerIconBtnArr[0].x,this.selectedBtn.y=this.playerIconBtnArr[0].y,this.btn_settings=new e(images.btn_gear),this.btn_settings.regX=41,this.btn_settings.regY=41,this.settingsCont=new WGBH.SettingsScreen(this),this.settingsCont.visible=!1,this.sparklesCont=new createjs.Container,this.boxCont.addChild(t,this.txt,this.numTxt,this.minusBtn,this.addBtn,this.minusBtnInactive,this.addBtnInactive,this.newBtn,this.sameBtn),this.playerContainer.addChild(this.boxCont,this.playerIconCont,this.nextBtn,this.settingsCont),this.addChild(this.btn_settings,this.sparklesCont)},n.teardown=function(){s.teardown.call(this),this.background=null},namespace("WGBH").PlayersPanel=a}(),function(){var t=include("springroll.easeljs.BasePanel"),i=include("createjs.Bitmap"),e=include("springroll.easeljs.Button"),a=function(){t.call(this)},s=t.prototype,n=extend(a,t);n.setup=function(){this.background=new i(images.TitleBackground),this.addChildAt(this.background,0),this.playButton=new e(images.PlayButton),this.addChild(this.background,this.playButton)},n.teardown=function(){s.teardown.call(this),this.background=null,this.playButton=null},namespace("WGBH").TitlePanel=a}(),function(){var t=include("springroll.easeljs.BaseState"),i=include("WGBH.GamePanel"),e=function(e){t.call(this,new i,e),this.showSpin=this.showSpin.bind(this),this.startGame=this.startGame.bind(this),this.stopGame=this.stopGame.bind(this),this.endTurn=this.endTurn.bind(this),this.nextRound=this.nextRound.bind(this),this.nextTurn=this.nextTurn.bind(this),this.tallyScore=this.tallyScore.bind(this),this.chooseUnicornChallenge=this.chooseUnicornChallenge.bind(this),this.shufflePrompts=this.shufflePrompts.bind(this),this.pauseGame=this.pauseGame.bind(this),this.resumeGame=this.resumeGame.bind(this),this.newGame=this.newGame.bind(this),this.getNextPrompt=this.getNextPrompt.bind(this),this.gotWords=this.gotWords.bind(this)},a=extend(e,t);a.enterDone=function(){this.utils=new WGBH.Utilities,app.eventDispatcher.on("START_SPIN",this.showSpin),app.eventDispatcher.on("GOT_WORDS",this.gotWords),app.eventDispatcher.on("SPIN_DONE",this.startGame),app.eventDispatcher.on("END_GAME",this.stopGame),app.eventDispatcher.on("STOP_GAME",this.stopGame),app.eventDispatcher.on("SCORE_CHOSEN",this.endTurn),app.eventDispatcher.on("SHOW_EMOJI",this.tallyScore),app.eventDispatcher.on("NEW_GAME_DIFF_PLAYERS",this.newGame),app.eventDispatcher.on("RESUME_GAME",this.resumeGame),this.panel.homeBtn.addEventListener("mousedown",this.pauseGame),app.turnCount=0,app.musicIndxArr=[0,0,0,0],this.chooseUnicornChallenge(),this.shufflePrompts(),this.panel.gameContainer.setBG(),this.panel.gameContainer.visible=!1,this.panel.categoryContainer.setup(),this.panel.spinContainer.visible=!1},a.shufflePrompts=function(){app.songIndx=0,app.itemsSingIndx=0,app.itemsAllIndx=0,app.itemsDanceIndx=0,app.situationsIndx=0,app.songs=this.utils.shuffleArray(app.songs),app.itemsSing=this.utils.shuffleArray(app.itemsSing),app.itemsAll=this.utils.shuffleArray(app.itemsAll),app.itemsDance=this.utils.shuffleArray(app.itemsDance),app.situations=this.utils.shuffleArray(app.situations)},a.chooseUnicornChallenge=function(){var t=app.playerTotal*app.types.length-1;app.ucIndx=this.utils.getRandomInt(0,t)},a.showSpin=function(t){this.panel.homeBtn.visible=!1,this.panel.spinContainer.setup(),this.panel.roundTxt.visible=!1},a.gotWords=function(t){this.panel.gameContainer.hideIt()},a.startGame=function(t){this.panel.homeBtn.visible=!0,this.panel.roundTxt.visible=!0,this.panel.categoryContainer.hideIt(),this.panel.spinContainer.visible=!1,this.panel.gameContainer.setupGame()},a.stopGame=function(t){app.playerTotal>1?0===app.actionArr[app.actionIndx]?this.panel.scoreContainer.setup(this.panel.gameContainer.getDrawing()):this.panel.scoreContainer.setup():this.nextRound()},a.getNextPrompt=function(){"dance"==app.types[app.actionArr[app.actionIndx]]?(app.itemsDanceIndx++,app.itemsDanceIndx>=app.itemsDance.length&&(app.itemsDance[app.itemsDanceIndx-1],app.itemsDance=this.utils.shuffleArray(app.itemsDance),app.itemsDanceIndx=0)):"sing"==app.types[app.actionArr[app.actionIndx]]?(app.songIndx++,app.songIndx>=app.songs.length&&(app.songs=this.utils.shuffleArray(app.songs),app.songIndx=0),app.itemsSingIndx++,app.itemsSingIndx>=app.itemsSing.length&&(app.itemsSing[app.itemsSingIndx-1],app.itemsSing=this.utils.shuffleArray(app.itemsSing),app.itemsSingIndx=0)):(app.itemsAllIndx++,app.itemsAllIndx>=app.itemsAll.length&&(app.itemsAll[app.itemsAllIndx-1],app.itemsAll=this.utils.shuffleArray(app.itemsAll),app.itemsAllIndx=0),app.situationIndx++,app.situationIndx>=app.situations.length&&(app.situations=this.utils.shuffleArray(app.situations),app.situationIndx=0))},a.tallyScore=function(){this.panel.drawPromptTxt.visible=!1},a.nextRound=function(){this.getNextPrompt(),this.panel.drawPromptTxt.text="",this.panel.gameContainer.hideIt(),app.actionIndx++,app.roundIndx++,app.playerIndx=0,app.turnCount++,app.musicArr[3]=this.utils.shuffleArray(app.musicArr[3]),this.panel.roundTxt.text="Round "+(app.roundIndx+1)+" of "+app.config.gameData.ROUND_TOTAL,this.panel.roundTxt.color=app.config.gameData.fontColorArr[app.actionArr[app.actionIndx]],app.actionIndx==app.actions.length?this.panel.gameOverContainer.setup():(this.panel.gameContainer.setBG(),this.panel.categoryContainer.setup())},a.nextTurn=function(){this.getNextPrompt(),app.turnCount++,this.panel.drawPromptTxt.text="",app.playerIndx++,app.musicIndxArr[app.actionArr[app.actionIndx]]++,app.musicIndxArr[app.actionArr[app.actionIndx]]>=app.musicArr[app.actionArr[app.actionIndx]].length&&(app.musicIndxArr[app.actionArr[app.actionIndx]]=0),this.panel.categoryContainer.setup()},a.endTurn=function(t){this.panel.scoreContainer.closeIt(),this.panel.roundTxt.color=app.config.gameData.fontColorArr[app.actionArr[app.actionIndx]],this.panel.drawPromptTxt.visible=!0,app.playerIndx==app.playerTotal-1?this.nextRound():this.nextTurn()},a.pauseGame=function(){this.panel.homeOverlay.visible||(this.panel.homeBtn.visible=!1,app.sound.play("sfx_click"),this.panel.homeBtn.enabled=!1,createjs.Tween.pauseAllTweens(),app.gamePaused=!0,this.panel.gameContainer.pauseGame(),this.panel.categoryContainer.visible?(this.VOList=[this.panel.categoryContainer.currentVO],this.currentVO=this.panel.categoryContainer.currentVO):(this.VOList=app.voPlayer.voList,this.currentVO=app.voPlayer._currentVO),this.VOCallback=app.voPlayer._callback,this.currentMusic=app.music,app.music="",this.panel.homeOverlay.setup("settings"))},a.resumeGame=function(){if(app.voPlayer.stop(),app.sound.play("sfx_click"),this.panel.homeBtn.visible=!0,this.panel.homeBtn.enabled=!0,createjs.Tween.resumeAllTweens(),this.panel.homeOverlay.visible=!1,app.gamePaused=!1,this.panel.gameContainer.resumeGame(),app.music=this.currentMusic,this.VOList&&this.VOList.length>0&&null!=this.currentVO){var t=this.VOList.indexOf(this.currentVO);app.voPlayer.play(this.VOList.slice(t,this.VOList.length),this.VOCallback)}this.panel.spinContainer.visible&&this.panel.spinContainer.resumeGame()},a.newGame=function(){app.voPlayer.stop(),app.sound.play("sfx_click"),this.nextState()},a.exitStart=function(){this.panel.gameContainer.exit(),this.panel.categoryContainer.exit(),this.panel.spinContainer.exit(),this.panel.scoreContainer.exit(),this.panel.gameOverContainer.exit(),app.eventDispatcher.off("START_SPIN",this.showSpin),app.eventDispatcher.off("SPIN_DONE",this.startGame),app.eventDispatcher.off("END_GAME",this.stopGame),app.eventDispatcher.off("STOP_GAME",this.stopGame),app.eventDispatcher.off("SCORE_CHOSEN",this.endTurn),app.eventDispatcher.off("SHOW_EMOJI",this.tallyScore),app.eventDispatcher.off("NEW_GAME_DIFF_PLAYERS",this.newGame),app.eventDispatcher.off("RESUME_GAME",this.resumeGame),this.panel.homeBtn.removeEventListener("mousedown",this.pauseGame)},namespace("WGBH").GameState=e}(),function(){var t=include("springroll.easeljs.BaseState"),i=include("WGBH.IntroPanel"),e=function(e){t.call(this,new i,e),this.onPlay=this.onPlay.bind(this),this.soundDone=this.soundDone.bind(this),this.update=this.update.bind(this),this.audioStarted=this.audioStarted.bind(this)},a=extend(e,t);a.enterDone=function(){this.sharedAnim=new WGBH.SharedAnimation,this.introCharArr=["peter","pink","pink","peter","pink","peter"],this.introPlayedArr=[!1,!1,!1,!1,!1,!1],this.introIndx=0,app.voPlayer.on("start",this.audioStarted),this.panel.nextBtn.addEventListener("mousedown",this.onPlay),this.currentVO="fg_"+this.introCharArr[this.introIndx]+"_intro"+(this.introIndx+1),app.voPlayer.play(this.currentVO,this.soundDone),app.on("update",this.update)},a.audioStarted=function(t){switch(t){case"fg_peter_intro1":app.animator.play(this.panel.intro.peter,"intro1"),app.animator.play(this.panel.intro.peter.body,"intro1",function(){app.animator.play(this.panel.intro.peter.body,"intro2")}.bind(this)),app.animator.play(this.panel.intro.pink,"intro1"),app.animator.play(this.panel.intro.mom,"intro1"),app.animator.play(this.panel.intro.dad,"intro1");break;case"fg_pink_intro2":app.animator.play(this.panel.intro.pink,"intro2",function(){app.animator.play(this.panel.intro.pink,"clap"),this.panel.intro.pink.armL_lower.visible=!1,this.panel.intro.pink.armL_lower_bottom.visible=!0,this.panel.intro.pink.armL_lower_bottom.gotoAndPlay("clap")}.bind(this)),app.animator.play(this.panel.intro.mom,"intro2"),app.animator.play(this.panel.intro.dad,"intro2"),app.sound.play("sfx_clap",{volume:.3});break;case"fg_pink_intro3":app.sound.stop("sfx_clap"),app.animator.play(this.panel.intro.pink,"intro3"),app.animator.play(this.panel.intro.peter.body,"intro3"),app.animator.play(this.panel.intro.pink.armL_lower,"intro3"),app.animator.play(this.panel.intro.peter,"intro3"),app.animator.play(this.panel.intro.mom,"intro3"),app.animator.play(this.panel.intro.mom.armR,"intro3"),app.animator.play(this.panel.intro.dad,"intro3"),app.animator.play(this.panel.intro.dad.armL,"intro3");break;case"fg_peter_intro4":app.animator.play(this.panel.intro.pink,"intro4"),app.animator.play(this.panel.intro.peter,"intro4"),app.animator.play(this.panel.intro.mom,"intro4"),app.animator.play(this.panel.intro.dad,"intro4");break;case"fg_pink_intro5":app.animator.play(this.panel.intro.pink,"intro5",function(){app.animator.play(this.panel.intro.pink,"look")}.bind(this)),app.animator.play(this.panel.intro.peter,"intro5"),app.animator.play(this.panel.intro.mom,"intro5"),app.animator.play(this.panel.intro.dad,"intro5"),this.panel.intro.goldie.visible=!0,this.panel.intro.goldie.alpha=0,createjs.Tween.get(this.panel.intro.goldie).wait(2300).call(function(){app.animator.play(this.panel.intro.goldie,"goldie"),app.animator.play(this.panel.intro.mom,"look",function(t){app.animator.play(this.panel.intro.mom,"idle")}.bind(this)),app.animator.play(this.panel.intro.dad,"look",function(t){app.animator.play(this.panel.intro.dad,"idle")}.bind(this))}.bind(this)).to({alpha:1},1500).wait(1500).to({alpha:0},866);break;case"fg_peter_intro6":app.animator.play(this.panel.intro.peter,"intro6"),app.animator.play(this.panel.intro.pink,"idle")}},a.soundDone=function(t){this.introIndx++,this.currentVO="",this.introIndx<this.introCharArr.length?(this.currentVO="fg_"+this.introCharArr[this.introIndx]+"_intro"+(this.introIndx+1),app.voPlayer.play(this.currentVO,this.soundDone)):(app.off("update",this.update),this.sharedAnim.flashButton(this.panel.nextBtn),this.sharedAnim.sparkleMe3(this.panel,{x:this.panel.nextBtn.x-this.panel.nextBtn.width/3,y:this.panel.nextBtn.y-this.panel.nextBtn.height/3},!1))},a.update=function(t){if(this.introIndx<this.introCharArr.length){var i="pink"==this.introCharArr[this.introIndx]?this.panel.intro.pink.head:this.panel.intro.peter.body.head;this.sharedAnim.setMouth(i.front.mouth,app.config.lipsync[this.currentVO]),this.sharedAnim.setMouth(i.side.mouth,app.config.lipsync[this.currentVO])}},a.onPlay=function(){app.off("update",this.update),createjs.Tween.removeAllTweens(),app.animator.stop(this.panel.intro.peter,!0),app.animator.stop(this.panel.intro.peter.body,!0),app.animator.stop(this.panel.intro.pink,!0),app.animator.stop(this.panel.intro.pink.armL_lower,!0),app.animator.stop(this.panel.intro.mom.armR,!0),app.animator.stop(this.panel.intro.mom,!0),app.animator.stop(this.panel.intro.dad,!0),app.animator.stop(this.panel.intro.dad.armL,!0),app.sound.stopAll(),app.voPlayer.stop(),app.voPlayer.off("start",this.audioStarted),app.sound.play("sfx_click"),this.nextState()},a.exit=function(){app.voPlayer.off("start",this.audioStarted),this.panel.nextBtn.removeEventListener("mousedown",this.onPlay)},namespace("WGBH").IntroState=e}(),function(){var t=include("springroll.easeljs.BaseState"),i=include("WGBH.PlayersPanel"),e=function(e){t.call(this,new i,e),this.onPlay=this.onPlay.bind(this),this.checkButtons=this.checkButtons.bind(this),this.minusPlayer=this.minusPlayer.bind(this),this.addPlayer=this.addPlayer.bind(this),this.selectIcon=this.selectIcon.bind(this),this.startGame=this.startGame.bind(this),this.newGame=this.newGame.bind(this),this.showSettings=this.showSettings.bind(this),this.closeSettings=this.closeSettings.bind(this),this.audioStarted=this.audioStarted.bind(this)},a=extend(e,t);a.enterDone=function(){app.playerScreen++,app.playerIndx=0,app.actionIndx=0,app.roundIndx=0,app.turnCount=0,app.ucIndx=-1,app.isUC=!1,app.gamePaused=!1,app.scoreArr=[],this.currentState="selectNum",this.playerIndx=0,app.startOver||this.checkButtons(),this.sharedAnim=new WGBH.SharedAnimation,this.utils=new WGBH.Utilities,app.voPlayer.on("start",this.audioStarted),this.panel.nextBtn.addEventListener("mousedown",this.onPlay),this.panel.minusBtn.addEventListener("mousedown",this.minusPlayer),this.panel.addBtn.addEventListener("mousedown",this.addPlayer),this.panel.btn_settings.addEventListener("mousedown",this.showSettings),this.panel.sameBtn.addEventListener("mousedown",this.startGame),this.panel.newBtn.addEventListener("mousedown",this.newGame),app.eventDispatcher.on("RESUME_GAME",this.closeSettings),app.playerScreen>1&&app.parentHint?app.startOver?app.voPlayer.play(["fg_addplayers_parents"]):app.voPlayer.play(["fg_addplayers_parents","fg_addplayers_howmany"]):this.panel.numTxt.visible&&app.voPlayer.play(["fg_addplayers_howmany"])},a.audioStarted=function(t){switch(t){case"fg_addplayers_checkmark":this.sharedAnim.flashButton(this.panel.nextBtn,{wait:100,loop:!0});break;case"fg_addplayers_parents":app.parentHint&&(app.parentHint=!1,this.sharedAnim.flashButton(this.panel.btn_settings,{loop:!0,wait:100}),this.sharedAnim.sparkleMeMany(this.panel,this.panel.sparklesCont,{x:20,y:-10,init_pause_fact:0,init_scale:.9},!1),this.sharedAnim.sparkleMeMany(this.panel,this.panel.sparklesCont,{x:-20,y:60,init_pause_fact:0,init_scale:.5},!1))}},a.checkButtons=function(){this.panel.numTxt.text=app.playerTotal,this.panel.minusBtn.visible=!0,this.panel.addBtn.visible=!0,this.panel.minusBtnInactive.visible=!1,this.panel.addBtnInactive.visible=!1,1==app.playerTotal?(this.panel.minusBtn.visible=!1,this.panel.minusBtnInactive.visible=!0):app.playerTotal==app.config.gameData.MAX_PLAYERS&&(this.panel.addBtn.visible=!1,this.panel.addBtnInactive.visible=!0)},a.minusPlayer=function(t){this.panel.settingsCont.visible||(app.sound.play("sfx_click_hi"),app.playerTotal>1&&app.playerTotal--,this.checkButtons())},a.addPlayer=function(t){this.panel.settingsCont.visible||(app.sound.play("sfx_click_hi"),app.playerTotal<app.config.gameData.MAX_PLAYERS&&app.playerTotal++,this.checkButtons())},a.onPlay=function(){if(!this.panel.settingsCont.visible)if(app.sound.play("sfx_click"),app.voPlayer.stop(),createjs.Tween.removeTweens(this.panel.nextBtn),this.panel.nextBtn.scaleX=this.panel.nextBtn.scaleY=1,this.panel.boxCont.visible){this.utils.setGAEvent("playerNum"),this.currentState="selectPlayer",app.voPlayer.play([100,"fg_addplayers_icon"],function(){app.voPlayer.play("fg_addplayers_checkmark")}.bind(this)),this.bgIndx=1,this.panel.boxCont.visible=!1,this.panel.playerIconCont.visible=!0;var t=0;for(app.iconArr=[],t=0;t<app.playerTotal;t++)app.scoreArr.push([]),app.iconArr.push(t);for(this.panel.playerTxt.text="PLAYER 1",this.panel.playerTxt.color=app.config.gameData.scoreColorArr[0],this.panel.playerBG.image=images.BG1,this.panel.selectedBtn.x=this.panel.playerIconBtnArr[0].x,this.panel.selectedBtn.y=this.panel.playerIconBtnArr[0].y,t=0;t<this.panel.playerIconBtnArr.length;t++)this.panel.playerIconBtnArr[t].addEventListener("mousedown",this.selectIcon);this.panel.playerIconCont.y=800,this.panel.nextBtn.visible=!1,createjs.Tween.get(this.panel.playerIconCont).to({y:0},300).call(function(){this.panel.nextBtn.visible=!0}.bind(this))}else this.playerIndx++,this.currentState="selectPlayer",this.playerIndx<app.playerTotal?(app.voPlayer.play(["fg_player"+(this.playerIndx+1),"fg_addplayers_choose"],function(){app.voPlayer.play("fg_addplayers_checkmark")}.bind(this)),this.panel.nextBtn.visible=!1,createjs.Tween.get(this.panel.playerIconCont).to({y:800},300).call(function(){this.panel.playerTxt.text="PLAYER "+(this.playerIndx+1),this.panel.playerIconBtnArr[app.iconArr[this.playerIndx-1]].alpha=.25,this.panel.playerIconBtnArr[app.iconArr[this.playerIndx-1]].cursor="default";var t=this.getNextIcon();this.panel.selectedBtn.x=this.panel.playerIconBtnArr[t].x,this.panel.selectedBtn.y=this.panel.playerIconBtnArr[t].y,app.iconArr[this.playerIndx]=t,this.panel.playerIcon.gotoAndStop("player_icon"+t),this.bgIndx=this.bgIndx<3?this.bgIndx+1:1,this.panel.playerBG.image=images["BG"+this.bgIndx],this.panel.playerTxt.color=app.config.gameData.scoreColorArr[this.bgIndx-1]}.bind(this)).to({y:0},300).call(function(){this.panel.nextBtn.visible=!0}.bind(this))):this.nextState()},a.getNextIcon=function(){for(var t=0;t<this.panel.playerIconBtnArr.length;t++)if(1==this.panel.playerIconBtnArr[t].alpha)return t},a.selectIcon=function(t){1!=t.currentTarget.alpha||this.panel.settingsCont.visible?app.sound.play("sfx_icon_inactive"):(app.sound.play("sfx_icon_active"),this.panel.playerIcon.gotoAndStop("player_icon"+t.currentTarget.indx),app.iconArr[this.playerIndx]=t.currentTarget.indx,this.panel.selectedBtn.x=t.currentTarget.x,this.panel.selectedBtn.y=t.currentTarget.y)},a.showSettings=function(t){createjs.Tween.removeTweens(this.panel.nextBtn),this.panel.nextBtn.scaleX=this.panel.nextBtn.scaleY=1,this.panel.txt.visible=!1,this.panel.boxCont.visible=!1,this.VOList=app.voPlayer.voList,this.VOCallback=app.voPlayer._callback,this.currentVO=app.voPlayer._currentVO,app.voPlayer.stop(),app.sound.play("sfx_click"),this.panel.btn_settings.visible=!1,this.panel.settingsCont.setup("parents")},a.closeSettings=function(t){if("selectNum"==this.currentState?(this.panel.txt.visible=!0,this.panel.playerIconCont.visible=!1,this.panel.boxCont.visible=!0):(this.panel.boxCont.visible=!1,this.panel.playerIconCont.visible=!0),this.panel.btn_settings.visible=!0,this.panel.settingsCont.visible=!1,this.VOList&&this.VOList.length>0&&null!=this.currentVO){var i=this.VOList.indexOf(this.currentVO);app.voPlayer.play(this.VOList.slice(i,this.VOList.length),this.VOCallback)}app.sound.play("sfx_click")},a.startGame=function(t){this.panel.settingsCont.visible||(app.voPlayer.stop(),app.sound.play("sfx_click"),app.startOver=!1,app.manager.state="game")},a.newGame=function(t){this.panel.settingsCont.visible||(app.voPlayer.stop(),app.sound.play("sfx_click"),app.playerTotal=1,app.startOver=!1,app.manager.state="players")},a.exit=function(){var t;for(createjs.Tween.removeAllTweens(),app.voPlayer.off("start",this.audioStarted),app.eventDispatcher.off("RESUME_GAME",this.closeSettings),this.panel.settingsCont.exit(),this.panel.sameBtn.removeEventListener("mousedown",this.startGame),this.panel.newBtn.removeEventListener("mousedown",this.newGame),this.panel.btn_settings.removeEventListener("mousedown",this.showSettings),this.panel.nextBtn.removeEventListener("mousedown",this.onPlay),this.panel.minusBtn.removeEventListener("mousedown",this.minusPlayer),this.panel.addBtn.removeEventListener("mousedown",this.addPlayer),t=0;t<this.panel.playerIconBtnArr.length;t++)this.panel.playerIconBtnArr[t].removeEventListener("mousedown",this.selectIcon);this.panel.background.removeEventListener("mousedown",this.onPlay)},namespace("WGBH").PlayersState=e}(),function(){var t=include("springroll.easeljs.BaseState"),i=include("WGBH.TitlePanel"),e=function(e){t.call(this,new i,e),this.onPlay=this.onPlay.bind(this)},a=extend(e,t);a.enterDone=function(){this.panel.playButton.addEventListener("mousedown",this.onPlay),app.hasTouch||app.voPlayer.play("fg_title"),this.sharedAnim=new WGBH.SharedAnimation,this.sharedAnim.sparkleMe1(this.panel,{x:this.panel.playButton.x+this.panel.playButton.width/3,y:this.panel.playButton.y+this.panel.playButton.height/5},!1)},a.onPlay=function(){createjs.Tween.removeAllTweens(),app.sound.play("sfx_click"),app.voPlayer.stop(),this.nextState()},a.exit=function(){this.panel.playButton.removeEventListener("mousedown",this.onPlay)},namespace("WGBH").TitleState=e}(),function(){var t=include("WGBH.TitleState"),i=include("WGBH.IntroState"),e=include("WGBH.PlayersState"),a=include("WGBH.GameState"),s=include("springroll.Application"),n=include("lib.Transition"),r=include("springroll.easeljs.EaselJSDisplay"),p=include("springroll.EventDispatcher"),o=function(t,i){window.images[i.id]=t},h=function(t,i){ss[i.id]=new createjs.SpriteSheet(t),i.id},l=new s({fps:60,name:"web_family_game",state:"title",canvasId:"stage",configPath:"assets/config/config.json",manifestsPath:"assets/config/manifests.json",captionsPath:"assets/config/captions.json",audioTypes:["ogg","mp3"],display:r,displayOptions:{clearView:!0},enableHiDPI:!0,preload:[{id:"pink_loader_sprite",src:"assets/images/loading/pink_loader_sprite.png",complete:o},{id:"pink_loader_bg",src:"assets/images/loading/pink_loader_bg.jpg",complete:o},{id:"pink_loader_heart",src:"assets/images/loading/pink_loader_heart.png",complete:o},{id:"pink_loader_bee",src:"assets/images/loading/pink_loader_bee.png",complete:o},{id:"game",src:"assets/images/game_sprites.json",complete:h},{id:"Game_atlas_",src:"assets/images/Game_atlas_.json",complete:h},{id:"Game_atlas_2",src:"assets/images/Game_atlas_2.json",complete:h},{id:"Game_atlas_3",src:"assets/images/Game_atlas_3.json",complete:h},{id:"Game_atlas_4",src:"assets/images/Game_atlas_4.json",complete:h},{id:"Intro_atlas_",src:"assets/images/Intro_atlas_.json",complete:h}]});l.musicIndxArr=[0,0,0,0],l.musicArr=[[1,2],[1,2],[],[2,5]],l.actionArr=[0,1,2,3],l.types=["draw","act","sing","dance"],l.actions=["Draw","Act like","Sing","Do a dance"],l.songs=[{title:"Mary Had a Little",played:!1},{title:"Row Row Row Your",played:!1},{title:"Twinkle Twinkle Little",played:!1},{title:"The Itsy Bitsy",played:!1},{title:"Old MacDonald Had a",played:!1},{title:"Rockabye",played:!1},{title:"Ring Around the",played:!1}],l.itemsSing=[["a","cupcake"],["a","bird"],["a","planet"],["a","superhero"],["a","puppy"],["a","butterfly"],["a","kitten"],["a","pirate"],["an","airplane"],["a","fairy"],["a","crab"],["an","astronaut"],["a","firework"],["a","robot"],["a","mouse"],["a","dinosaur"],["a","kangaroo"],["an","elephant"],["a","balloon"],["a","teddy bear"],["a","tiger"],["a","snowflake"],["a","dragon"],["a","horse"],["a","bumblebee"],["a","rockstar"],["a","pumpkin"],["a","pizza"],["a","cloud"],["a","rainbow"],["the","tooth fairy"],["a","mermaid"],["an","artist"],["a","giraffe"],["a","worm"],["a","giant"]],l.itemsDance=[["a","flower"],["a","fish"],["a","tree"]],l.itemsDance=l.itemsDance.concat(l.itemsSing),l.itemsAll=[["a","princess"],["a","baby"],["a","farmer"],["a","teacher"],["a","shooting star"],["a","ballerina"]],l.itemsAll=l.itemsAll.concat(l.itemsSing),l.situations=["jumping for joy","at a party","playing hopscotch","playing soccer","reading a bedtime story","painting a picture","flipping pancakes","washing dishes","moving in slow motion","riding a bike","picking flowers","planting flowers","playing catch","flying a kite","playing the drums","riding a scooter","jumping rope","rowing a boat","doing ballet","floating in space","digging for treasure","opening a present","riding a roller coaster","at a carnival","at the beach","on vacation","eating ice cream","baking a birthday cake","playing with a yo-yo","playing basketball","surfing","playing frisbee","knitting a scarf","going camping","trick-or-treating","playing on a playground","hula hooping","roller skating","tip toeing around","rolling around in mud","talking on the phone","driving a car","food shopping","swimming in cold water","eating a marshmallow","climbing a tree","juggling","playing tug of war","lifting weights","ice skating","in a marching band","playing baseball","eating soup","building a tower","running a race","going fishing","blowing bubbles","playing guitar","playing the piano","walking on gum","walking on marshmallows","building a sand castle"],l.eventDispatcher=new p,l.scoreArr=[],l.iconArr=[],l.playerIndx=0,l.playerTotal=1,l.actionIndx=0,l.itemsAllIndx=0,l.itemsDanceIndx=0,l.itemsSingIndx=0,l.songIndx=0,l.situationIndx=0,l.roundIndx=0,l.turnCount=0,l.ucIndx=-1,l.isUC=!1,l.gamePaused=!1,l.timerIndx=2,l.timeOn=!0,l.playerScreen=0,l.startOver=!1,l.parentHint=!0,l.on("init",(function(){var s=this.config.assets,r=this.config.scaling;this.transition=new n,this.transition.framerate=30,this.states={title:new t({next:"intro",preload:s.title,scaling:r.title}),intro:new i({next:"players",preload:s.intro,scaling:r.intro}),players:new e({next:"game",preload:s.players,scaling:r.players}),game:new a({next:"players",previous:"title",preload:s.game,scaling:r.game})}})),window.app=l}(),function(){var t=include("createjs.Tween"),i=include("createjs.Bitmap"),e=include("createjs.Container"),a=function(){},s=a.prototype;s.sparkleMeMany=function(e,a,n,r){images.Sparkle1&&(e.spark1=new i(images[n.sparkle?n.sparkle:"Sparkle1"]),e.spark1.regX=e.spark1.image.width/2,e.spark1.regY=e.spark1.image.width/2,a.addChild(e.spark1),s.setPosition(e.spark1,n.x,n.y),r||(e.spark1.initScale=n.init_scale?n.init_scale:1,e.spark1.scaleX=e.spark1.scaleY=1.5*e.spark1.initScale,t.get(e.spark1).wait(300*n.init_pause_fact).to({scaleX:0,scaleY:0,rotation:63,x:e.spark1.x+200*Math.random()-100,y:e.spark1.y+200*Math.random()-100},750).call((function(){n.keep||a.removeChildAt(0)}))))},s.sparkle1Simple=function(e,a,n,r){images.Sparkle1&&(e.spark1=new i(images[n.sparkle?n.sparkle:"Sparkle1"]),e.spark1.regX=e.spark1.image.width/2,e.spark1.regY=e.spark1.image.height/2,a.addChild(e.spark1),s.setPosition(e.spark1,n.x,n.y),e.spark1.initScale=n.init_scale?n.init_scale:1,e.spark1.scaleX=e.spark1.scaleY=e.spark1.initScale,e.spark1.rotation=n.init_rot?n.init_rot:0,r||(e.spark1.scaleX=e.spark1.scaleY=0,t.get(e.spark1).wait(500*n.init_pause_fact).to({scaleX:e.spark1.initScale,scaleY:e.spark1.initScale},1e3).call((function(){n.keep||a.removeChildAt(0)})),t.get(e.spark1).wait(500*n.init_pause_fact+750).to({alpha:0},250)))},s.sparkle2Simple=function(e,a,n,r){images.Sparkle1&&(e.spark1=new i(images[n.sparkle?n.sparkle:"Sparkle1"]),e.spark1.regX=e.spark1.image.width/2,e.spark1.regY=e.spark1.image.height/2,a.addChild(e.spark1),s.setPosition(e.spark1,n.x,n.y),e.spark1.initScale=n.init_scale?n.init_scale:1,e.spark1.scaleX=e.spark1.scaleY=e.spark1.initScale,r||(e.spark1.scaleX=e.spark1.scaleY=0,t.get(e.spark1).wait(400*n.init_pause_fact).to({scaleX:2*e.spark1.initScale,scaleY:2*e.spark1.initScale,x:n.x+n.endX,y:n.y+n.endY},800).call((function(){n.keep||a.removeChildAt(0)})),t.get(e.spark1).wait(400*n.init_pause_fact+600).to({alpha:0},200)))},s.sparkleMe1=function(a,n,r){images.Sparkle1&&(a.sparkles=new e,a.spark1=new i(images.Sparkle1),a.spark1.regX=a.spark1.image.width/2,a.spark1.regY=a.spark1.image.width/2,a.sparkles.addChild(a.spark1),a.addChild(a.sparkles),s.setPosition(a.spark1,0,0),n.x?s.setPosition(a.sparkles,n.x,n.y):s.setPosition(a.sparkles,940,620),r||(a.spark1.initScale=n.init_scale?n.init_scale:1,a.spark1.scaleX=a.spark1.scaleY=0,t.get(a.spark1).wait(300*n.init_pause_fact).to({scaleX:1*a.spark1.initScale,scaleY:1*a.spark1.initScale,x:75,y:75},0).wait(300).to({scaleX:0,scaleY:0,x:10,y:10},0).to({scaleX:.5*a.spark1.initScale,scaleY:.5*a.spark1.initScale,rotation:21},300).to({scaleX:1*a.spark1.initScale,scaleY:1*a.spark1.initScale,rotation:63},600).to({rotation:230},600).to({rotation:430,alpha:0,scaleX:1.5*a.spark1.initScale,scaleY:1.5*a.spark1.initScale},300)))},s.sparkleLoop=function(t,i){if(t.scaleX=t.scaleY=t.maxScale,!i){t.scaleX=t.scaleY=0,t.alpha=1;var e=t.wait?t.wait:0,a=t.length?t.length:900,s=(t.maxTime?t.maxTime:4e3)-e-a;createjs.Tween.get(t,{loop:!0}).wait(e).to({scaleX:t.maxScale,scaleY:t.maxScale},a).wait(s),createjs.Tween.get(t,{loop:!0}).wait(e+.6*a).to({alpha:0},.4*a).wait(s)}},s.sparkleStar=function(t,i){t.scaleX=t.scaleY=t.maxScale,i||(t.scaleX=t.scaleY=0,t.x=t.initPos.x,t.y=t.initPos.y,t.alpha=1,createjs.Tween.get(t).wait(t.waitTime).to({x:t.destPos.x,y:t.destPos.y},1100),createjs.Tween.get(t).wait(t.waitTime).to({scaleX:t.maxScale,scaleY:t.maxScale},300).to({alpha:0},800))},s.sparkleMe3=function(a,n,r){images.Sparkle1&&(a.sparkles=new e,a.spark1=new i(images.Sparkle1),a.spark2=new i(images.Sparkle2),a.spark3=new i(images.Sparkle3),a.spark1.regX=a.spark2.regX=a.spark3.regX=a.spark1.image.width/2,a.spark1.regY=a.spark2.regY=a.spark3.regY=a.spark1.image.width/2,a.spark2.rotation=22,a.spark3.rotation=-10,a.sparkles.addChild(a.spark1,a.spark2,a.spark3),a.addChild(a.sparkles),s.setPosition(a.spark1,0,0),s.setPosition(a.spark2,90,10),s.setPosition(a.spark3,-25,40),n?s.setPosition(a.sparkles,n.x,n.y):s.setPosition(a.sparkles,890,670),r||(a.spark1.scaleX=a.spark1.scaleY=0,a.spark2.scaleX=a.spark2.scaleY=0,a.spark3.scaleX=a.spark3.scaleY=0,t.get(a.spark1).wait(780).to({scaleX:1,scaleY:1,x:75,y:75},0).wait(300).to({scaleX:0,scaleY:0,x:10,y:10},0).to({scaleX:.5,scaleY:.5,rotation:21},300).to({scaleX:1,scaleY:1,rotation:63},600).to({rotation:230},600).to({rotation:430,alpha:0,scaleX:1.5,scaleY:1.5},300),t.get(a.spark2).wait(450).to({scaleX:1,scaleY:1},0).wait(300).to({scaleX:0,scaleY:0},0).to({scaleX:.375,scaleY:.375,rotation:21},255).to({scaleX:.75,scaleY:.75,rotation:63},510).to({rotation:230},510).to({rotation:430,alpha:0,scaleX:1.5,scaleY:1.5},255),t.get(a.spark3).to({scaleX:1,scaleY:1},0).wait(300).to({scaleX:0,scaleY:0},0).to({scaleX:.3,scaleY:.3,rotation:21},360).to({scaleX:.6,scaleY:.6,rotation:63},720).to({rotation:230},720).to({rotation:430,alpha:0,scaleX:1.2,scaleY:1.2},360)))},s.setPosition=function(t,i,e,a){t.x=i,t.y=e,a&&(a.x=i,a.y=e)},s.flashButton=function(t,i){var e=t.scaleX,a=t.scaleY,s=i&&i.wait?i.wait:0;!(!i||!i.loop)?createjs.Tween.get(t).wait(s).to({scaleX:1.1*e,scaleY:1.1*a},500).to({scaleX:1*e,scaleY:1*a},500).to({scaleX:1.1*e,scaleY:1.1*a},500).to({scaleX:1*e,scaleY:1*a},500):createjs.Tween.get(t).wait(s).to({scaleX:1.1*e,scaleY:1.1*a},500).to({scaleX:1*e,scaleY:1*a},500)},s.setMouth=function(t,i){var e=app.voPlayer.getElapsed()/app.voPlayer.currentDuration,a=i[parseInt(e*i.length)];null==a||e>1||t.gotoAndStop(a)},namespace("WGBH").SharedAnimation=a}(),function(){var t=include("createjs.Container"),i=include("createjs.Sprite"),e=include("createjs.Bitmap"),a=function(i){t.call(this),this.showSpinScreen=this.showSpinScreen.bind(this),this.getNextScreen=this.getNextScreen.bind(this),this.moveRope=this.moveRope.bind(this),this.startRopeDrag=this.startRopeDrag.bind(this),this.audioDone=this.audioDone.bind(this),this.exit=this.exit.bind(this),this.update=this.update.bind(this),this.audioStarted=this.audioStarted.bind(this),this.init(i)},s=(t.prototype,extend(a,t));s.init=function(a){this.panel=a,this.sharedAnim=new WGBH.SharedAnimation,this.bg=new e(images["BG_"+app.types[app.actionArr[app.actionIndx]]]),this.bg.x=-(app.config.scalingSize.maxWidth-app.config.scalingSize.width)/2,this.categoryTitle=new createjs.Text("DRAW","180px Hooligan",app.config.gameData.PINK_COLOR),this.categoryTitle.textAlign="center",this.categoryTitle.textBaseline="middle",this.categoryTitle.x=app.config.scalingSize.width/2+10,this.categoryTitle.y=app.config.scalingSize.height/2-20,this.char1=new lib["Char_"+app.config.gameData.characters[app.actionArr[app.actionIndx]]],this.char1.x=200,this.char1.y=768,this.char2=new lib.Char_pink,this.char2.x=860,this.char2.y=768,this.nextBtn=new t,this.nextBtn.mouseChildren=!1,this.ropeBtn=new t;var s=new i(ss.game,"rope");this.ropeBtn.x=-133,this.glow=new i(ss.game,"star_glow"),this.glow.x=-20,this.glow.y=440,this.glow.alpha=0,this.ropeBtn.addChild(this.glow,s);var n=new createjs.Shape;n.graphics.f("white").dr(-143,470,300,300),n.alpha=.01,this.nextBtn.cursor="pointer",this.nextBtn.addChild(this.ropeBtn,n),this.nextBtn.x=this.categoryTitle.x,this.nextBtn.y=-1e3,this.nextBtn.on("mousedown",this.startRopeDrag),this.nextBtn.on("pressmove",this.moveRope),this.nextBtn.on("pressup",this.showSpinScreen),this.nextSparkleStatic=new e(images.sparkleStar),this.nextSparkleStatic.x=this.nextBtn.x,this.nextSparkleStatic.y=270,this.nextSparkleStatic.regX=213,this.sparkleCont=new t,this.sparklesArr=[];for(var r=[{img:"3",x:432,y:334,wait:0,length:700,maxScale:.4},{img:"3",x:620,y:302,wait:1400,length:1200},{img:"2",x:420,y:500,wait:1300,length:900},{img:"2",x:540,y:400,wait:2300,length:900},{img:"2",x:500,y:280,wait:1900,length:900}],p=0;p<r.length;p++){var o=new e(images["Sparkle"+r[p].img]);o.regX=o.image.width/2,o.regY=o.image.height/2,o.x=r[p].x,o.y=r[p].y,o.scaleX=o.scaleY=.6,o.maxScale=.6,o.wait=r[p].wait,o.length=r[p].length,o.maxTime=r[r.length-1].wait+r[r.length-1].length,this.sparkleCont.addChild(o),this.sparklesArr.push(o)}this.playerCont=new t,this.playerTxt=new createjs.Text("PLAYER 1","60px Hooligan",app.config.gameData.PINK_COLOR),this.playerTxt.textAlign="left",this.playerTxt.textBaseline="bottom",this.playerTxt.y=30,this.playerIcon=new createjs.Sprite(ss.game,"player_icon1"),this.playerIcon.scaleX=this.playerIcon.scaleY=.7,this.playerIcon.x=-95,this.playerIcon.y=-45,this.playerCont.x=this.categoryTitle.x-30,this.playerCont.y=620,this.playerCont.addChild(this.playerTxt,this.playerIcon),this.addChild(this.bg,this.nextSparkleStatic,this.nextBtn,this.sparkleCont,this.categoryTitle,this.char1,this.char2,this.playerCont)},s.setup=function(){app.voPlayer.on("start",this.audioStarted),app.isUC=app.ucIndx==app.turnCount,this.nextBtn.visible=!0,this.nextBtn.y=-1e3,this.canPullRope=!0,this.glow.alpha=0,this.nextSparkleStatic.alpha=0,this.nextSparkleStatic.visible=!1,this.sparkleCont.visible=!0;for(var t=0;t<this.sparklesArr.length;t++)this.sparklesArr[t].scaleX=this.sparklesArr[t].scaleY=0,this.sparklesArr[t].alpha=1;this.bg.image=images["BG_"+app.types[app.actionArr[app.actionIndx]]],this.removeChild(this.char1),this.char1=new lib["Char_"+app.config.gameData.characters[app.actionArr[app.actionIndx]]],this.char1.x=140,this.char1.y=768,this.addChild(this.char1),this.char2.gotoAndStop(0),this.char2.body.gotoAndStop(0),this.char2.body.armL.gotoAndStop(0),this.char2.body.armL.lower.gotoAndStop(0),this.char1.gotoAndStop(0),this.char2.body.head.side.mouth.gotoAndStop(0),this.char2.body.head.front.mouth.gotoAndStop(0),this.head1="peter"==app.config.gameData.characters[app.actionArr[app.actionIndx]]||"lila"==app.config.gameData.characters[app.actionArr[app.actionIndx]]?this.char1.body.head:this.char1.head,this.head2=this.char2.body.head,this.categoryTitle.visible=!0,this.categoryTitle.text=app.types[app.actionArr[app.actionIndx]].toUpperCase()+"!",this.categoryTitle.color=app.config.gameData.fontColorArr[app.actionArr[app.actionIndx]];var i="PLAYER "+(app.playerIndx+1);this.playerTxt.text=i.toUpperCase(),this.playerIcon.gotoAndStop("player_icon"+app.iconArr[app.playerIndx]),this.playerCont.visible=!1,this.visible=!0,this.categoryTitle.scaleX=this.categoryTitle.scaleY=0,createjs.Tween.get(this.char1).wait(100).call(function(){app.animator.play(this.char1,"up",function(){"draw"!=app.types[app.actionArr[app.actionIndx]]&&"sing"!=app.types[app.actionArr[app.actionIndx]]||app.animator.play(this.char1,"loop")}.bind(this)),"act"==app.types[app.actionArr[app.actionIndx]]||"dance"==app.types[app.actionArr[app.actionIndx]]?(app.animator.play(this.char2,"up"),app.animator.play(this.char2.body,"up",function(){app.animator.play(this.char2.body,"idle1")}.bind(this))):(app.animator.play(this.char2,"start"),app.animator.play(this.char2.body,"start",function(){app.animator.play(this.char2.body,"idle1")}.bind(this))),createjs.Tween.get(this.categoryTitle).to({scaleX:1,scaleY:1},1e3,createjs.Ease.backOut)}.bind(this));this.currentVO="",0==app.playerIndx?(0==app.actionIndx?this.currentVO="fg_challenge_firstround":app.actionIndx==app.types.length-1?this.currentVO="fg_challenge_lastround":this.currentVO="fg_challenge_"+app.types[app.actionArr[app.actionIndx]]+"1",app.voPlayer.play(this.currentVO,this.audioDone)):createjs.Tween.get(this).wait(1500).call(this.getNextScreen),app.on("update",this.update)},s.audioStarted=function(t){switch(t){case"fg_spin_tapstar":case"fg_spin_tapstar_short":app.animator.play(this.char2.body,"down",function(){app.animator.play(this.char2.body,"loop")}.bind(this)),app.animator.play(this.char2,"down")}},s.audioDone=function(){"fg_challenge_firstround"==this.currentVO||"fg_challenge_lastround"==this.currentVO?(this.currentVO="fg_challenge_"+app.types[app.actionArr[app.actionIndx]]+"1",app.voPlayer.play(this.currentVO,this.audioDone)):this.currentVO=="fg_challenge_"+app.types[app.actionArr[app.actionIndx]]+"1"?(this.currentVO="fg_challenge_"+app.types[app.actionArr[app.actionIndx]]+"2",app.voPlayer.play(this.currentVO,this.getNextScreen)):this.currentVO=="fg_"+app.config.gameData.characters[app.actionArr[app.actionIndx]]+"_player"+(app.playerIndx+1)?(0==app.actionIndx?this.currentVO="fg_spin_tapstar":this.currentVO="fg_spin_tapstar_short",app.voPlayer.play(this.currentVO,this.audioDone)):this.currentVO="voDone"},s.startRopeDrag=function(t){if(this.canPullRope&&!app.gamePaused){createjs.Tween.removeTweens(this.ropeBtn),createjs.Tween.removeTweens(this.glow),createjs.Tween.removeTweens(this.nextSparkleStatic);for(var i=0;i<this.sparklesArr.length;i++)createjs.Tween.removeTweens(this.sparklesArr[i]),this.sparklesArr[i].scaleX=this.sparklesArr[i].scaleY=0;this.glow.alpha=0,this.nextSparkleStatic.alpha=0,this.nextSparkleStatic.visible=!1,this.ropeBtn.rotation=0,this.ropeDiff=this.nextBtn.y-t.stageY,this.dragY=t.stageY}},s.moveRope=function(t){if(this.canPullRope&&!app.gamePaused){var i=t.stageY-this.dragY-200;this.nextBtn.y>-50||t.stageY>.8*app.realHeight?this.showSpinScreen():(this.nextBtn.y=i>this.nextBtn.y?i:this.nextBtn.y,this.panel.spinContainer.dragSpin(this.nextBtn.y))}},s.getNextScreen=function(){this.currentVO="fg_"+app.config.gameData.characters[app.actionArr[app.actionIndx]]+"_player"+(app.playerIndx+1),app.voPlayer.play("fg_"+app.config.gameData.characters[app.actionArr[app.actionIndx]]+"_player"+(app.playerIndx+1),this.audioDone),this.categoryTitle.visible=!1,this.playerCont.visible=!0,this.playerCont.scaleX=this.playerCont.scaleY=0,this.nextBtn.y=-1e3,this.ropeBtn.rotation=0,app.animator.play(this.char2,"look"),app.animator.play(this.char2.body,"look"),app.animator.play(this.char1,"down",function(){"draw"==app.types[app.actionArr[app.actionIndx]]?app.animator.play(this.char1,"idle"):"sing"==app.types[app.actionArr[app.actionIndx]]&&app.animator.play(this.char1,"loop")}.bind(this)),this.nextSparkleStatic.alpha=0,this.nextSparkleStatic.visible=!0,this.sparkleCont.visible=!0,createjs.Tween.get(this.nextSparkleStatic,{loop:!0}).to({alpha:1},600).to({alpha:.2},700).to({alpha:1},1e3).wait(1e3).to({alpha:0},300);for(var t=0;t<this.sparklesArr.length;t++)this.sharedAnim.sparkleLoop(this.sparklesArr[t],!1);createjs.Tween.get(this.nextBtn).to({y:-240},500,createjs.Ease.backOut).call(function(){createjs.Tween.get(this.playerCont).to({scaleX:1,scaleY:1},300,createjs.Ease.backOut),createjs.Tween.get(this.ropeBtn,{loop:!0}).to({rotation:-3},2e3).to({rotation:0},2e3).to({rotation:3},2e3).to({rotation:0},2e3),createjs.Tween.get(this.glow,{loop:!0}).to({alpha:1},4e3).to({alpha:0},4e3)}.bind(this))},s.showSpinScreen=function(){this.canPullRope&&!app.gamePaused&&(app.voPlayer.stop(),this.currentVO="",app.off("update",this.update),this.canPullRope=!1,createjs.Tween.get(this.nextBtn).to({y:app.config.gameData.spinnerPullDist+this.nextBtn.y},app.config.gameData.spinnerPullTime),app.sound.play("sfx_star"),app.animator.stop(this.char1,!0),app.animator.stop(this.char2,!0),app.animator.stop(this.char2.body,!0),app.eventDispatcher.trigger("START_SPIN"))},s.update=function(){"fg_challenge_firstround"==this.currentVO||"fg_challenge_lastround"==this.currentVO||"fg_challenge_act2"==this.currentVO||"fg_challenge_draw2"==this.currentVO||"fg_challenge_dance2"==this.currentVO||"fg_challenge_sing2"==this.currentVO||"fg_spin_tapstar"==this.currentVO||"fg_spin_tapstar_short"==this.currentVO?(this.sharedAnim.setMouth(this.head2.side.mouth,app.config.lipsync[this.currentVO]),this.sharedAnim.setMouth(this.head2.front.mouth,app.config.lipsync[this.currentVO])):"fg_challenge_act1"==this.currentVO||"fg_challenge_draw1"==this.currentVO||"fg_challenge_dance1"==this.currentVO||"fg_challenge_sing1"==this.currentVO||this.currentVO=="fg_"+app.config.gameData.characters[app.actionArr[app.actionIndx]]+"_player"+(app.playerIndx+1)?(this.sharedAnim.setMouth(this.head1.side.mouth,app.config.lipsync[this.currentVO]),this.sharedAnim.setMouth(this.head1.front.mouth,app.config.lipsync[this.currentVO])):"voDone"==this.currentVO&&app.off("update",this.update)},s.hideIt=function(){this.visible=!1,this.currentVO="",app.animator.stop(this.char1,!0),app.animator.stop(this.char2,!0),app.animator.stop(this.char2.body,!0),app.off("update",this.update),app.voPlayer.off("start",this.audioStarted)},s.exit=function(){app.off("update",this.update),app.voPlayer.off("start",this.audioStarted),this.nextBtn.off("mousedown",this.startRopeDrag),this.nextBtn.off("pressmove",this.moveRope),this.nextBtn.off("pressup",this.showSpinScreen)},namespace("WGBH").CategoryScreen=a}(),function(){var t=include("createjs.Container"),i=include("springroll.DelayedCall"),e=function(){t.call(this),this.degreeToRadian=this.degreeToRadian.bind(this),this.updateTimer=this.updateTimer.bind(this),this.startTimer=this.startTimer.bind(this),this.stopTimer=this.stopTimer.bind(this),this.setup()},a=(t.prototype,extend(e,t));a.setup=function(){this.MAX_TIME=60,this.FILL_COLOR="white",this.STROKE_COLOR="white",this.count=0,this.delay=null,this.oX=-6,this.oY=-6,this.r=98,this.updatePct=0,this.TICK=100,this.cumulativeAngle=1.5*Math.PI,this.timerOn=!1,this.basePie=new createjs.Sprite(ss.game,"timer_clock"),this.basePie.regX=117.5,this.basePie.regY=119,this.pie=new createjs.Shape,this.pct=0,this.pie.graphics.f(this.FILL_COLOR).ss(1).s(this.STROKE_COLOR).mt(this.oX,this.oY).a(this.oX,this.oY,this.r,this.cumulativeAngle,this.cumulativeAngle+this.degreeToRadian(this.pct)),this.pie.graphics.closePath(),this.pie.cache(-238,-238,475,476),this.outline=new createjs.Shape,this.outline.graphics.ss(3).s(this.STROKE_COLOR).dc(this.oX,this.oY,this.r),this.outline.visible=!1,this.arrow1=new createjs.Sprite(ss.game,"timer_arrow"),this.arrow1.regX=18,this.arrow1.regY=98,this.arrow1.y=-5,this.arrow1.x=-5,this.arrow2=new createjs.Sprite(ss.game,"timer_arrow"),this.arrow2.regX=18,this.arrow2.regY=95,this.arrow2.y=-8,this.arrow2.x=-5,this.addChild(this.basePie,this.pie,this.outline,this.arrow1,this.arrow2)},a.startTimer=function(t){var e=app.isUC?"_unicorn":"";this.basePie.gotoAndStop("timer_clock"+e),this.timerOn=!0,this.visible=!0,this.totalTime=t,this.updatePct=1/(this.totalTime/this.TICK),this.pct=0,this.pie.graphics.clear().f(this.FILL_COLOR).ss(1).s(this.STROKE_COLOR).mt(this.oX,this.oY).a(this.oX,this.oY,this.r,this.cumulativeAngle,this.cumulativeAngle+this.degreeToRadian(this.pct)),0!=this.pie.cacheID&&this.pie.updateCache(),this.arrow2.rotation=360*this.pct,this.delay=new i(this.updateTimer,this.TICK)},a.resumeTimer=function(){this.timerOn&&(this.delay=new i(this.updateTimer,this.TICK))},a.stopTimer=function(){this.timerOn=!1,this.delay&&this.delay.destroy(),this.delay=null},a.updateTimer=function(){app.gamePaused||(this.pct+=this.updatePct,this.pie.graphics.f(this.FILL_COLOR).ss(1).s(this.STROKE_COLOR).mt(this.oX,this.oY).a(this.oX,this.oY,this.r,this.cumulativeAngle,this.cumulativeAngle+this.degreeToRadian(this.pct)),this.pie.graphics.closePath(),0!=this.pie.cacheID&&(this.pie.updateCache("source-overlay"),this.pie.graphics.clear()),this.arrow2.rotation=360*this.pct,this.pct<1?this.delay=new i(this.updateTimer,this.TICK):(this.timerOn=!1,this.delay=null,app.eventDispatcher.trigger("TIMER_TIMES_UP")))},a.degreeToRadian=function(t){return t*(2*Math.PI)},namespace("WGBH").CountdownTimer=e}(),function(){var t=include("createjs.Container"),i=include("springroll.easeljs.Button"),e=function(i){t.call(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.undoDrawing=this.undoDrawing.bind(this),this.setup=this.setup.bind(this),this.startDrawing=this.startDrawing.bind(this),this.setup(i)},a=(t.prototype,extend(e,t));a.setup=function(e){this.panel=e,this.IDLE_TIME=2e4,this.padWidth=922,this.padHeight=495,this.padOffsetX=(app.config.scalingSize.width-this.padWidth)/2,this.padOffsetY=125,this.brushOffset=0,this.colorIndx=0,this.selectedStroke=1,this.drawingIndx=0,this.didMove=!1,this.strokeStyle=10,this.eraseIt=!1,this.timePassed=0,this.touchID=0,this.waitTime=0,this.colorsArr=["#ff8de6"],this.keepMoving=!1,this.drawingOutline=new createjs.Bitmap(images.Draw_Frame),this.drawingOutline.x=-256,this.drawingOutline.y=this.padOffsetY-10,this.drawingOutline.cache(0,0,1536,521),this.drawingOutline.name="frame",this.drawingCanvas=new t,this.maskShape=new createjs.Shape,this.maskShape.graphics.f("#cccccc").dr(this.padOffsetX,this.padOffsetY,this.padWidth,this.padHeight),this.drawingCanvas.hitArea=new createjs.Shape((new createjs.Graphics).f("#000").dr(0,0,this.padWidth,this.padHeight)),this.drawingCanvas.mouseChildren=!1,this.drawingCanvas.mask=this.maskShape,this.drawingCanvas.x=this.padOffsetX,this.drawingCanvas.y=this.padOffsetY,this.drawingCanvas.name="drawingCanvas",this.drawingCanvas.cache(0,0,this.padWidth,this.padHeight),this.undoBtn=new i(images.UndoButton),this.undoBtn.regX=43,this.undoBtn.regY=43,this.undoBtn.x=977,this.undoBtn.y=this.padOffsetY,this.undoBtn.name="undo",this.undoBtn.on("mousedown",this.undoDrawing),this.undoBtnInactive=new createjs.Bitmap(images.UndoButtonInactive),this.undoBtnInactive.regX=43,this.undoBtnInactive.regY=43,this.undoBtnInactive.x=this.undoBtn.x,this.undoBtnInactive.y=this.undoBtn.y,this.undoBtnInactive.name="undoInactive",this.undoBtnInactive.on("mousedown",this.undoDrawing),this.addChild(this.drawingCanvas,this.drawingOutline,this.undoBtn,this.undoBtnInactive),this.visible=!1},a.startDrawing=function(){if(this.keepMoving=!1,this.touchID=0,this.isDrawing=!1,this.visible=!0,this.pt1=0,this.pt2=0,this.drawingOutline.visible=!0,this.drawingCanvas.visible=!0,this.drawingCanvas.numChildren>0){for(;this.drawingCanvas.numChildren>0;)this.drawingCanvas.removeChildAt(this.drawingCanvas.numChildren-1);this.drawingCanvas.updateCache()}this.undoBtn.scaleX=this.undoBtn.scaleY=1,this.undoBtnInactive.visible=!0,this.undoBtn.visible=!1,this.didMove=!1,this.drawingCanvas.addEventListener("mousedown",this.handleMouseDown,!1),app.display.stage.addEventListener("stagemouseup",this.handleMouseUp,!1),app.display.stage.addEventListener("stagemousemove",this.handleMouseMove,!1)},a.undoDrawing=function(t){app.gamePaused||t.currentTarget==this.undoBtnInactive||(t.preventDefault(),t.stopPropagation(),app.sound.play("sfx_click"),this.undoBtn.visible&&this.drawingCanvas.numChildren>0&&(this.drawingCanvas.removeChildAt(this.drawingCanvas.numChildren-1),this.drawingCanvas.updateCache(),0==this.drawingCanvas.numChildren&&(this.undoBtnInactive.visible=!0,this.undoBtn.visible=!1)))},a.setListeners=function(t,i){this.finishedDrawingFunc=t},a.handleMouseDown=function(t){0!==this.touchID||app.gamePaused||(this.touchID=app.hasTouch?t.pointerID:100,this.pt1=this.globalToLocal(t.stageX,t.stageY),this.lastPt={x:this.pt1.x-this.padOffsetX-this.brushOffset,y:this.pt1.y-this.padOffsetY-this.brushOffset},this.isDrawing=!0,this.didMove=!1,this.currentDrawing=new createjs.Shape,this.currentDrawing.graphics.f(this.colorsArr[this.colorIndx]).dc(this.lastPt.x,this.lastPt.y,this.strokeStyle/2),this.currentDrawing.cache(0,0,this.padWidth,this.padHeight),this.drawingCanvas.addChild(this.currentDrawing),this.drawingCanvas.updateCache(),this.startTime=Date.now())},a.handleMouseUp=function(t){app.hasTouch&&this.touchID!=t.pointerID||app.gamePaused||!this.isDrawing||(app.hasTouch?(this.touchID=0,this.isDrawing=!1,this.didMove&&(this.timePassed+=Date.now()-this.startTime),this.currentDrawing.graphics.es(),this.currentDrawing.updateCache(),this.drawingCanvas.updateCache("source-over"),this.currentDrawing.graphics.clear()):this.didMove?(this.keepMoving=!this.keepMoving,this.isDrawing=this.keepMoving,this.isDrawing||(this.touchID=0,this.currentDrawing&&(this.currentDrawing.graphics.es(),this.currentDrawing.updateCache(),this.drawingCanvas.updateCache("source-over"),this.currentDrawing.graphics.clear()))):(this.touchID=0,this.isDrawing=!1,this.keepMoving=!1,this.currentDrawing&&(this.currentDrawing.graphics.es(),this.currentDrawing.updateCache(),this.drawingCanvas.updateCache(),this.currentDrawing.graphics.clear())),this.drawingCanvas.numChildren>0&&(this.undoBtnInactive.visible=!1,this.undoBtn.visible=!0))},a.handleMouseMove=function(t){app.hasTouch&&this.touchID!=t.pointerID||app.gamePaused||this.isDrawing&&this.currentDrawing&&(this.didMove=!0,this.currentDrawing.updateCache(),this.drawingCanvas.updateCache("source-over"),this.pt1=this.globalToLocal(t.stageX,t.stageY),this.pt2={x:this.pt1.x-this.padOffsetX-this.brushOffset,y:this.pt1.y-this.padOffsetY-this.brushOffset},this.currentDrawing.graphics.s(this.colorsArr[this.colorIndx]).ss(this.strokeStyle,"round","round").mt(this.lastPt.x,this.lastPt.y).lt(this.pt2.x,this.pt2.y),this.lastPt=this.pt2)},a.stopDrawing=function(t){return t&&(this.visible=!1),this.undoBtnInactive.visible=!1,this.undoBtn.visible=!1,this.drawingCanvas.removeEventListener("mousedown",this.handleMouseDown,!1),app.display.stage.removeEventListener("stagemouseup",this.handleMouseUp,!1),app.display.stage.removeEventListener("stagemousemove",this.handleMouseMove,!1),this.getDrawing()},a.getDrawing=function(){this.drawingCanvas.visible=!0,this.drawingOutline.visible=!1;var t=new createjs.Bitmap(this.drawingCanvas.cacheCanvas);return t.cache(0,0,this.padWidth,this.padHeight),t},namespace("WGBH").DrawingPad=e}(),function(){var t=include("createjs.Container"),i=function(i,e){t.call(this),this.playEmoji=this.playEmoji.bind(this),this.update=this.update.bind(this),this.init(i,e)},e=(t.prototype,extend(i,t));e.init=function(t,i){this.indx=t,this.emoji=new lib.Emoji,this.addChild(this.emoji),this.setIcon(this.indx),i&&this.emoji.cache(-132,-116,264,232),this.mouseChildren=!1},e.setIcon=function(t,i){this.indx=t;var e=app.isUC?"_unicorn":"";this.emoji.gotoAndStop("emoji"+t+e)},e.playEmoji=function(){var t=app.isUC?"_unicorn":"";app.sound.play("sfx_emoji"+this.indx),app.animator.play(this.emoji,"emoji"+this.indx+t),app.animator.play(this.emoji.sparkleAnim,0)},e.update=function(){this.emoji.updateCache()},namespace("WGBH").Emoji=i}(),function(){var t=include("createjs.Container"),i=include("springroll.easeljs.Button"),e=include("createjs.Bitmap"),a=function(i){t.call(this),this.getNextScreenSame=this.getNextScreenSame.bind(this),this.getNextScreenNew=this.getNextScreenNew.bind(this),this.showButtons=this.showButtons.bind(this),this.update=this.update.bind(this),this.exit=this.exit.bind(this),this.audioDone=this.audioDone.bind(this),this.init(i)},s=(t.prototype,extend(a,t));s.init=function(a){var s,n;for(this.panel=a,this.utils=new WGBH.Utilities,this.sharedAnim=new WGBH.SharedAnimation,this.bg=new e(images.BG_act),this.bg.x=-(app.config.scalingSize.maxWidth-app.config.scalingSize.width)/2,this.confettiCont=new t,this.confettiArr=[],this.newPlayerAnim=!1,this.samePlayerAnim=!1,s=0;s<150;s++){var r=new createjs.Sprite(ss.game,"confetti"+s%23);this.confettiCont.addChild(r),r.x=this.utils.getRandomNumber(-220,1540),r.y=this.utils.getRandomNumber(-900,-20),r.scaleX=r.scaleY=this.utils.getRandomNumber(.3,.7),r.rotation=this.utils.getRandomInt(0,360),r.speed=this.utils.getRandomNumber(9,13),r.initX=r.x,r.initY=r.y,n=ss.game.getAnimation(r.currentAnimation).frames[0],ss.game.getFrameBounds(n),this.confettiArr.push(r)}for(s=0;s<20;s++){var p=this.utils.getRandomInt(0,3),o=new WGBH.Emoji(p,this);o.x=this.utils.getRandomNumber(-220,1540),o.y=this.utils.getRandomNumber(-900,-20),o.scaleX=o.scaleY=this.utils.getRandomNumber(.2,.5),o.rotation=this.utils.getRandomInt(0,360),o.speed=this.utils.getRandomNumber(9,13),o.initX=o.x,o.initY=o.y,this.confettiCont.addChild(o),o.cache(-132,-116,264,232),this.confettiArr.push(o)}this.categoryTitle=new createjs.Text("Take a bow!","120px Hooligan","white"),this.categoryTitle.textAlign="center",this.categoryTitle.textBaseline="middle",this.categoryTitle.regY=65,this.categoryTitle.x=app.config.scalingSize.width/2,this.categoryTitle.y=app.config.scalingSize.height/2,this.sameBtn=new i(images.btn_same),this.sameBtn.regX=156.5,this.sameBtn.x=this.categoryTitle.x,this.sameBtn.y=this.categoryTitle.y+40,this.sameBtn.on("mousedown",this.getNextScreenSame),this.newBtn=new i(images.btn_new),this.newBtn.regX=156.5,this.newBtn.x=this.categoryTitle.x,this.newBtn.y=this.sameBtn.y+120,this.newBtn.on("mousedown",this.getNextScreenNew),this.sameBtn.visible=!1,this.newBtn.visible=!1,this.char1=new lib.Char_peter,this.char1.x=140,this.char1.y=768,this.char1.gotoAndStop(0),this.char2=new lib.Char_pink,this.char2.x=860,this.char2.y=768,this.char2.gotoAndStop(0),this.addChild(this.bg,this.confettiCont,this.sameBtn,this.newBtn,this.categoryTitle,this.char1,this.char2),this.visible=!1},s.exit=function(){this.sameBtn.off("mousedown",this.getNextScreenSame),this.newBtn.off("mousedown",this.getNextScreenNew)},s.setup=function(){this.visible=!0,this.newPlayerAnim=!1,this.samePlayerAnim=!1,this.confettiCont.visible=!0,this.categoryTitle.text="Take a bow!",this.categoryTitle.font="100px Hooligan",this.categoryTitle.y=app.config.scalingSize.height/2+40,this.sameBtn.visible=!1,this.newBtn.visible=!1,this.currentVO="fg_gameend",app.voPlayer.play(this.currentVO,this.audioDone);for(var t=0;t<this.confettiArr.length;t++)this.confettiArr[t].x=this.confettiArr[t].initX,this.confettiArr[t].y=this.confettiArr[t].initY;this.char1.body.head.front.mouth.gotoAndStop(0),this.char1.body.head.side.mouth.gotoAndStop(0),this.char2.body.head.front.mouth.gotoAndStop(0),this.char2.body.head.side.mouth.gotoAndStop(0),app.animator.play(this.char1,"up"),app.animator.play(this.char2,"up"),app.on("update",this.update),this.utils=new WGBH.Utilities,this.utils.setGAEvent("end")},s.audioDone=function(){switch(this.currentVO){case"fg_gameend":this.currentVO="fg_oneplayer2",app.voPlayer.play(this.currentVO,this.audioDone);break;case"fg_oneplayer2":this.currentVO="fg_recap_peter1",app.voPlayer.play(this.currentVO,this.audioDone);break;case"fg_recap_peter1":this.showButtons(),this.currentVO="fg_playagain",app.voPlayer.play(this.currentVO,this.audioDone);break;default:this.currentVO=""}},s.update=function(t){"fg_gameend"==this.currentVO||"fg_oneplayer2"==this.currentVO||"fg_playagain"==this.currentVO?(this.sharedAnim.setMouth(this.char2.body.head.front.mouth,app.config.lipsync[this.currentVO]),this.sharedAnim.setMouth(this.char2.body.head.side.mouth,app.config.lipsync[this.currentVO]),"fg_playagain"==this.currentVO&&(app.voPlayer.currentPosition>2200&&!this.samePlayerAnim?(this.samePlayerAnim=!0,this.sharedAnim.flashButton(this.sameBtn,{wait:0,loop:!1})):app.voPlayer.currentPosition>500&&!this.newPlayerAnim&&(this.newPlayerAnim=!0,this.sharedAnim.flashButton(this.newBtn,{wait:0,loop:!1})))):"fg_recap_peter1"==this.currentVO&&(this.sharedAnim.setMouth(this.char1.body.head.front.mouth,app.config.lipsync[this.currentVO]),this.sharedAnim.setMouth(this.char1.body.head.side.mouth,app.config.lipsync[this.currentVO]));for(var i=0;i<this.confettiArr.length;i++)this.confettiArr[i].y<900&&(this.confettiArr[i].y+=this.confettiArr[i].speed)},s.showButtons=function(t){this.confettiCont.visible=!1,this.categoryTitle.text="Play again with",this.categoryTitle.font="80px Hooligan",this.categoryTitle.y=app.config.scalingSize.height/2-70,this.sameBtn.y=this.categoryTitle.y+10,this.newBtn.y=this.sameBtn.y+120,this.sameBtn.visible=!0,this.newBtn.visible=!0},s.getNextScreenSame=function(){app.off("update",this.update),app.voPlayer.stop(),app.sound.play("sfx_click"),app.playerIndx=0,app.actionIndx=0,app.roundIndx=0,app.turnCount=0,app.ucIndx=-1,app.isUC=!1,app.gamePaused=!1,app.manager.state="game"},s.getNextScreenNew=function(){app.off("update",this.update),app.voPlayer.stop(),app.sound.play("sfx_click"),app.off("update",this.update),app.manager.state="players"},namespace("WGBH").GameOverScreen=a}(),function(){var t=include("createjs.Container"),i=include("springroll.easeljs.Button"),e=include("createjs.Bitmap"),a=function(i,e,a){t.call(this),this.init=this.init.bind(this),this.startGame=this.startGame.bind(this),this.stopGame=this.stopGame.bind(this),this.getDrawing=this.getDrawing.bind(this),this.drawingStop=this.drawingStop.bind(this),this.timesUp=this.timesUp.bind(this),this.setupGame=this.setupGame.bind(this),this.setBG=this.setBG.bind(this),this.endGame=this.endGame.bind(this),this.exit=this.exit.bind(this),this.update=this.update.bind(this),this.init(i,e,a)},s=(t.prototype,extend(a,t));s.init=function(a,s,n){var r;for(this.panel=a,this.uiCont=s,this.uiLeftCont=n,this.utils=new WGBH.Utilities,this.sharedAnim=new WGBH.SharedAnimation,this.isActive=!1,this.recapPinkTxt=["Take a bow!","Pinkcredible!","Pink, pink, hooray!","Pinkamazing!","Round of applause!"],this.recapCharTxt=["Take a bow!","Round of applause!","That was awesome!","Hooray!","Amazing!"],this.recapPinkArr=[1,2,3,4,5],this.recapPinkIndx=0,this.recapCharArr=[1,2,3,4,5],this.recapCharIndx=0,this.isPink=!0,this.recapPinkArr=this.utils.shuffleArray(this.recapPinkArr),this.recapCharArr=this.utils.shuffleArray(this.recapCharArr),this.myDrawing=null,this.gameBG=new e(images.BG_draw),this.gameBG.x=-(app.config.scalingSize.maxWidth-app.config.scalingSize.width)/2,this.gameBG.name="gameBG",this.drawTxt=new createjs.Text("","45px Hooligan","black"),this.drawTxt.textAlign="center",this.drawTxt.textBaseline="bottom",this.drawTxt.lineWidth=app.config.gameData.promptLineWidth,this.drawTxt.lineHeight=85,this.drawTxt.x=app.config.scalingSize.width/2,this.drawTxt.y=app.config.gameData.promptY,this.drawTxt.name="promptTxt",this.gameSetupScreen=new WGBH.GameSetupScreen,this.gameSetupScreen.visible=!1,this.gameSetupScreen.name="gameSetupScreen",this.drawContainer=new WGBH.DrawingPad(this.panel),this.drawContainer.visible=!1,this.drawContainer.name="drawingPad",this.actContainer=new t,this.actContainer.visible=!1,this.actContainer.name="actContainer",this.singContainer=new t,this.singContainer.visible=!1,this.singContainer.name="singContainer",this.danceContainer=new t,this.danceContainer.visible=!1,this.danceContainer.name="danceContainer",this.contArr=[this.drawContainer,this.actContainer,this.singContainer,this.danceContainer],this.gameTimer=new WGBH.CountdownTimer,this.gameTimer.x=100,this.gameTimer.y=660,this.gameTimer.visible=!1,this.gameTimer.name="gameTimer",this.congratsTxt=new createjs.Text("Pinkamazing!",app.config.gameData.fontSizeArr[1]+"px Hooligan","white"),this.congratsTxt.textAlign="center",this.congratsTxt.textBaseline="middle",this.congratsTxt.x=512,this.congratsTxt.y=402,this.congratsTxt.name="congratsText",this.doneBtn=new i(images.btn_check),this.doneBtn.regX=70,this.doneBtn.regY=71,this.doneBtn.x=900,this.doneBtn.y=700,this.doneBtn.on("mousedown",this.timesUp),this.doneBtn.visible=!1,this.doneBtn.name="doneButton",this.confettiCont=new t,this.confettiCont.name="confettiContainer",this.confettiArr=[],this.confettiCount=0,r=0;r<30;r++){var p=r>=27?"confetti24":"confetti"+r%23,o=new createjs.Sprite(ss.game,p);o.x=this.congratsTxt.x,o.y=this.congratsTxt.y,o.initX=o.x,o.initY=o.y,o.scaleX=o.scaleY=this.utils.getRandomNumber(.5,.9),o.initScale=o.scaleX,o.rotation=this.utils.getRandomInt(0,360),o.initRot=o.rotation,o.wait=this.utils.getRandomInt(0,300),o.count=0,o.accelY=this.utils.getRandomNumber(14,26),o.accelX=this.utils.getRandomNumber(3,10),o.speed=36*Math.random()*(Math.random()<=.5?-1:1),o.direction=Math.random()<=.5?-1:1,o.vy=o.accelY,this.confettiCont.addChild(o),this.confettiArr.push(o)}this.confettiCont.visible=!1,this.staticSparkles=new e(images.sparkleStar),this.staticSparkles.regX=this.staticSparkles.image.width/2,this.staticSparkles.regY=this.staticSparkles.image.height/2,this.staticSparkles.x=this.gameTimer.x,this.staticSparkles.y=this.gameTimer.y,this.staticSparkles.visible=!1,this.staticSparkles.name="staticSparkles",this.sparkleCont=new t,this.sparkleCont.name="sparklesContainer",this.sparklesArr=[];var h=[{img:"3",x:10,y:15,wait:0,length:700,maxScale:.9},{img:"2",x:240,y:170,wait:2200,length:900,maxScale:.9},{img:"2",x:30,y:200,wait:4200,length:900,maxScale:.6}];for(r=0;r<h.length;r++){var l=new e(images["Sparkle"+h[r].img]);l.regX=l.image.width/2,l.regY=l.image.height/2,l.x=h[r].x,l.y=h[r].y,l.scaleX=l.scaleY=.4,l.maxScale=h[r].maxScale,l.wait=h[r].wait,l.maxTime=1.1*(h[h.length-1].length+h[h.length-1].wait),l.length=h[r].length,this.sparkleCont.addChild(l),this.sparklesArr.push(l)}this.addChild(this.gameBG,this.drawContainer,this.actContainer,this.staticSparkles,this.gameTimer,this.sparkleCont,this.doneBtn,this.title,this.drawTxt,this.congratsTxt,this.gameSetupScreen,this.confettiCont),app.eventDispatcher.on("START_GAME",this.startGame),app.eventDispatcher.on("TIMER_TIMES_UP",this.timesUp)},s.update=function(t){for(var i=0;i<this.confettiArr.length;i++)this.confettiArr[i].y<900&&this.confettiArr[i].count>=this.confettiArr[i].wait?(this.confettiArr[i].x-=this.confettiArr[i].accelX*this.confettiArr[i].direction,this.confettiArr[i].y-=this.confettiArr[i].vy,this.confettiArr[i].vy=Math.min(30,this.confettiArr[i].vy-1)):this.confettiArr[i].count<this.confettiArr[i].wait?this.confettiArr[i].count+=t:this.confettiArr[i].y>900&&(this.confettiArr[i].visible=!1,this.confettiCount++)},s.setBG=function(){this.gameBG.image=images["BG_"+app.types[app.actionArr[app.actionIndx]]]},s.hideIt=function(){this.isActive=!1,this.visible=!1},s.setupGame=function(){this.visible=!0,this.isActive=!0,this.congratsTxt.alpha=0,this.congratsTxt.scaleX=this.congratsTxt.scaleY=1,this.congratsTxt.visible=!1,this.gameDone=!1,this.drawTxt.text="",this.gameTimer.visible=!1,this.staticSparkles.visible=!1,this.sparkleCont.visible=!1,this.panel.roundTxt.color=app.config.gameData.fontColorArr[app.actionArr[app.actionIndx]],this.setBG(),this.gameSetupScreen.setup()},s.startGame=function(t){this.doneBtn.scaleX=this.doneBtn.scaleY=1,this.gameSetupScreen.visible=!1,this.doneBtn.visible=!0,this.drawTxt.text=this.utils.capitalizeFirstLetter(app.actions[app.actionArr[app.actionIndx]])+" "+app.goalStr;for(var i=0;i<this.contArr.length;i++)this.contArr[i].visible=i==app.actionArr[app.actionIndx];if(this.drawTxt.font=app.config.gameData.fontSizeArr[app.actionArr[app.actionIndx]]+"px Hooligan",this.drawTxt.color=app.config.gameData.fontColorArr[app.actionArr[app.actionIndx]],this.drawTxt.y=app.config.gameData.promptY-(this.drawTxt.getMeasuredHeight()-this.drawTxt.lineHeight),this.drawTxt.initY=this.drawTxt.y,"draw"==app.types[app.actionArr[app.actionIndx]]?(this.drawTxt.visible=!1,this.panel.drawPromptTxt.visible=!0,this.panel.drawPromptTxt.text=this.drawTxt.text,this.gameTimer.x=100,this.gameTimer.y=700,this.gameTimer.scaleX=this.gameTimer.scaleY=.56,this.doneBtn.x=920,this.doneBtn.y=700,this.doneBtn.scaleX=this.doneBtn.scaleY=.9,this.addChild(this.gameTimer,this.doneBtn),this.drawContainer.startDrawing()):(this.panel.drawPromptTxt.visible=!1,this.drawTxt.visible=!0,this.drawTxt.alpha=1,this.drawTxt.scaleX=this.drawTxt.scaleY=1,this.gameTimer.x=this.drawTxt.x,this.gameTimer.y=app.config.gameData.timerY,this.gameTimer.scaleX=this.gameTimer.scaleY=1,this.addChild(this.gameTimer),this.doneBtn.x=80,this.doneBtn.y=50,this.doneBtn.scaleX=this.doneBtn.scaleY=1,this.uiCont.addChild(this.doneBtn)),"sing"!=app.types[app.actionArr[app.actionIndx]]){var e=app.musicIndxArr[app.actionArr[app.actionIndx]];app.music="music_"+app.types[app.actionArr[app.actionIndx]]+app.musicArr[app.actionArr[app.actionIndx]][e]}if(0!=app.timerIndx)for(this.gameTimer.visible=!0,this.gameTimer.startTimer(app.config.gameData.timer[app.timerIndx][app.actionArr[app.actionIndx]]),this.staticSparkles.visible=!0,this.staticSparkles.x=this.gameTimer.x,this.staticSparkles.y=this.gameTimer.y,this.sparkleCont.visible=!0,this.sparkleCont.x=this.gameTimer.x-117*this.gameTimer.scaleX,this.sparkleCont.y=this.gameTimer.y-117*this.gameTimer.scaleX,this.staticSparkles.scaleX=this.staticSparkles.scaleY=this.gameTimer.scaleX,this.sparkleCont.scaleX=this.sparkleCont.scaleY=this.gameTimer.scaleX,i=0;i<this.sparklesArr.length;i++){this.sparklesArr[i].scaleX=this.sparklesArr[i].scaleY=0,this.sparklesArr[i].x="draw"==app.types[app.actionArr[app.actionIndx]]?this.congratsTxt.x:this.gameTimer.x,this.sparklesArr[i].y="draw"==app.types[app.actionArr[app.actionIndx]]?this.congratsTxt.y:this.gameTimer.y,this.sparklesArr[i].initX=this.sparklesArr[i].x,this.sparklesArr[i].initY=this.sparklesArr[i].y,this.sparklesArr[i].alpha=1;this.sparklesArr[this.sparklesArr.length-1].length,this.sparklesArr[this.sparklesArr.length-1].wait,this.sparklesArr[i].length,this.sparklesArr[i].wait;this.sharedAnim.sparkleLoop(this.sparklesArr[i],!1)}else this.gameTimer.visible=!1,this.staticSparkles.visible=!1,this.sparkleCont.visible=!1;this.utils.setGAEvent("userjourney",{start:!0,currentGame:app.types[app.actionArr[app.actionIndx]]})},s.timesUp=function(t){this.drawContainer.visible&&this.drawContainer.isDrawing&&t||app.gamePaused||this.gameDone||(t&&t.target&&t.target==this.doneBtn&&app.sound.play("sfx_click"),app.sound.play("sfx_timesup"),this.stopGame())},s.drawingStop=function(t){this.stopGame(),app.eventDispatcher.trigger("STOP_GAME")},s.stopGame=function(){this.gameDone=!0,app.music="",this.gameTimer.stopTimer(),createjs.Tween.get(this.gameTimer).to({scaleX:0,scaleY:0},500),createjs.Tween.get(this.doneBtn).to({scaleX:0,scaleY:0},300),this.staticSparkles.visible=!1;var t=this.isPink?"pink":app.config.gameData.characters[app.actionArr[app.actionIndx]],i=this.isPink?this.recapPinkArr:this.recapCharArr,e=this.isPink?this.recapPinkIndx:this.recapCharIndx;for(a=0;a<this.sparklesArr.length;a++)createjs.Tween.removeTweens(this.sparklesArr[a]);this.sparkleCont.visible=!1,this.staticSparkles.visible=!1,app.sound.play("sfx_applause"),app.voPlayer.play([500,"fg_recap_"+t+i[e]],this.endGame),this.congratsTxt.text=this.isPink?this.recapPinkTxt[i[e]-1]:this.recapCharTxt[i[e]-1],this.isPink?(this.recapPinkIndx++,this.recapPinkIndx>=this.recapPinkArr.length&&(this.recapPinkIndx=0,this.recapPinkArr=this.utils.shuffleArray(this.recapPinkArr))):(this.recapCharIndx++,this.recapCharIndx>=this.recapCharArr.length&&(this.recapCharIndx=0,this.recapCharArr=this.utils.shuffleArray(this.recapCharArr))),this.isPink=!this.isPink,0===app.actionArr[app.actionIndx]?(this.myDrawing=this.drawContainer.stopDrawing(),createjs.Tween.get(this.drawContainer.undoBtn).to({scaleX:0,scaleY:0},300)):(this.drawTxt.alpha=1,createjs.Tween.get(this.drawTxt).to({alpha:0},300),this.congratsTxt.visible=!0,this.congratsTxt.alpha=0,createjs.Tween.get(this.congratsTxt).wait(800).to({alpha:1},300)),this.confettiCount=0;for(var a=0;a<this.confettiArr.length;a++)this.confettiArr[a].x=this.confettiArr[a].initX,this.confettiArr[a].y=this.confettiArr[a].initY,this.confettiArr[a].vy=this.confettiArr[a].accelY,this.confettiArr[a].count=0,this.confettiArr[a].visible=!0,this.confettiArr[a].scaleX=this.confettiArr[a].scaleY=0,createjs.Tween.get(this.confettiArr[a]).wait(this.confettiArr[a].wait).to({scaleX:this.confettiArr[a].initScale,scaleY:this.confettiArr[a].initScale},300);if(this.confettiCont.visible=!0,app.on("update",this.update),"draw"!=app.types[app.actionArr[app.actionIndx]]){var s,n=.5*this.congratsTxt.getMeasuredWidth();s={x:this.congratsTxt.x+1.1*n,y:this.congratsTxt.y+35,init_pause_fact:.1,init_scale:.5,init_rot:0,sparkle:"Sparkle2"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1),s={x:this.congratsTxt.x-.2*n,y:this.congratsTxt.y-90,init_pause_fact:.6,init_scale:.4,init_rot:60,sparkle:"Sparkle1"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1),s={x:this.congratsTxt.x-1.3*n,y:this.congratsTxt.y,init_pause_fact:.8,init_scale:.3,init_rot:90,sparkle:"Sparkle1"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1),s={x:this.congratsTxt.x-.4*n,y:this.congratsTxt.y+100,init_pause_fact:1,init_scale:.5,init_rot:0,sparkle:"Sparkle2"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1),s={x:this.congratsTxt.x+n,y:this.congratsTxt.y-70,init_pause_fact:1.5,init_scale:.4,init_rot:100,sparkle:"Sparkle2"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1),s={x:this.congratsTxt.x+1.3*n,y:this.congratsTxt.y+70,init_pause_fact:1.6,init_scale:.5,init_rot:90,sparkle:"Sparkle1"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1),s={x:this.congratsTxt.x-1.5*n,y:this.congratsTxt.y+50,init_pause_fact:1.8,init_scale:.3,init_rot:20,sparkle:"Sparkle1"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1),s={x:this.congratsTxt.x+1.5*n,y:this.congratsTxt.y-20,init_pause_fact:2,init_scale:.6,init_rot:0,sparkle:"Sparkle2"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1),s={x:this.congratsTxt.x,y:this.congratsTxt.y-80,init_pause_fact:2.2,init_scale:.5,init_rot:90,sparkle:"Sparkle1"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1),s={x:this.congratsTxt.x-1.55*n,y:this.congratsTxt.y+120,init_pause_fact:2.4,init_scale:.3,init_rot:20,sparkle:"Sparkle2"},this.sharedAnim.sparkle1Simple(this,this.panel.sparklesCont,s,!1)}this.utils.setGAEvent("userjourney",{start:!1,currentGame:app.types[app.actionArr[app.actionIndx]]})},s.endGame=function(){this.confettiCont.visible=!1,this.drawContainer.visible=!1,this.gameTimer.visible=!1,this.doneBtn.visible=!1,createjs.Tween.get(this.congratsTxt).to({alpha:0},200),0!=app.actionArr[app.actionIndx]&&(this.drawTxt.visible=!0,this.drawTxt.scaleX=this.drawTxt.scaleY=1,this.drawTxt.y=this.congratsTxt.y,createjs.Tween.get(this.drawTxt).to({alpha:1},200)),app.off("update",this.update),app.eventDispatcher.trigger("STOP_GAME")},s.pauseGame=function(){this.isActive&&(this.visible=!1)},s.resumeGame=function(){this.isActive&&(this.visible=!0),this.gameTimer.resumeTimer()},s.getDrawing=function(){return this.myDrawing},s.exit=function(){app.eventDispatcher.off("START_GAME",this.startGame),app.eventDispatcher.off("TIMER_TIMES_UP",this.timesUp),this.gameSetupScreen.exit(),this.doneBtn.off("mousedown",this.timesUp)},namespace("WGBH").GameScreen=a}(),function(){var t=include("createjs.Container"),i=include("springroll.easeljs.Button"),e=include("createjs.Bitmap"),a=include("springroll.DelayedCall"),s=function(){t.call(this),this.startGame=this.startGame.bind(this),this.playIdle=this.playIdle.bind(this),this.exit=this.exit.bind(this),this.audioStarted=this.audioStarted.bind(this),this.DELAY_TIME=15e3,this.countdown=!1,this.init()},n=(t.prototype,extend(s,t));n.init=function(){this.utils=new WGBH.Utilities,this.sharedAnim=new WGBH.SharedAnimation,this.goalTxt=new createjs.Text("","80px Hooligan",app.config.gameData.PINK_COLOR),this.goalTxt.lineHeight=85,this.goalTxt.textAlign="center",this.goalTxt.textBaseline="bottom",this.goalTxt.x=app.config.scalingSize.width/2,this.goalTxt.y=app.config.gameData.promptY,this.goalTxt.lineWidth=app.config.gameData.promptLineWidth,this.goalTxt.visible=!1,this.playBtn=new i(images.btn_play),this.playBtn.regX=117,this.playBtn.regY=117,this.playBtn.x=this.goalTxt.x,this.playBtn.y=app.config.gameData.timerY,this.playBtn.visible=!1,this.playBtn.on("mousedown",this.startGame),this.playBtnUnicorn=new i(images.btn_play_unicorn),this.playBtnUnicorn.regX=117,this.playBtnUnicorn.regY=117,this.playBtnUnicorn.x=this.goalTxt.x,this.playBtnUnicorn.y=this.playBtn.y,this.playBtnUnicorn.visible=!1,this.playBtnUnicorn.on("mousedown",this.startGame),this.playCountdownBtn=new lib.btn_countdown,this.playCountdownBtn.x=this.playBtn.x,this.playCountdownBtn.y=this.playBtn.y,this.staticSparkles=new e(images.sparkleStar),this.staticSparkles.regX=this.staticSparkles.image.width/2,this.staticSparkles.regY=this.staticSparkles.image.height/2,this.staticSparkles.x=this.playBtn.x,this.staticSparkles.y=this.playBtn.y,this.sparkleCont=new t,this.sparklesArr=[];for(var a=[{img:"3",x:10,y:15,wait:0,length:700,maxScale:.9},{img:"3",x:180,y:170,wait:600,length:900,maxScale:.8},{img:"2",x:30,y:200,wait:1600,length:900,maxScale:.6},{img:"3",x:220,y:10,wait:2500,length:1200,maxScale:.7},{img:"2",x:50,y:55,wait:4e3,length:700,maxScale:.6},{img:"2",x:240,y:170,wait:4900,length:900,maxScale:.9}],s=0;s<a.length;s++){var n=new e(images["Sparkle"+a[s].img]);n.regX=n.image.width/2,n.regY=n.image.height/2,n.x=a[s].x,n.y=a[s].y,n.scaleX=n.scaleY=.4,n.maxScale=a[s].maxScale,n.wait=a[s].wait,n.length=a[s].length,n.maxTime=a[a.length-1].length+a[a.length-1].wait,this.sparkleCont.addChild(n),this.sparklesArr.push(n)}this.sparkleCont.x=this.playBtn.x-this.playBtn.regX,this.sparkleCont.y=this.playBtn.y-this.playBtn.regY,this.goldie=new lib.Char_goldie,this.goldie.x=960,this.goldie.y=800,this.delay=null,this.addChild(this.goldie,this.goalTxt,this.staticSparkles,this.playBtn,this.playBtnUnicorn,this.playCountdownBtn,this.sparkleCont),app.voPlayer.on("start",this.audioStarted)},n.audioStarted=function(t){"fg_countdown"==t&&app.animator.play(this.playCountdownBtn,"countdown")},n.setup=function(){this.visible=!0,this.countdown=!1,this.playBtn.enabled=!0,this.playBtnUnicorn.enabled=!0,this.playCountdownBtn.visible=!1,app.isUC?(this.goldie.visible=!0,app.animator.play(this.goldie,"idle"),this.playBtn.visible=!1,this.playBtnUnicorn.visible=!0):(this.goldie.visible=!1,this.playBtn.visible=!0,this.playBtnUnicorn.visible=!1),this.goalTxt.text=this.utils.capitalizeFirstLetter(app.actions[app.actionArr[app.actionIndx]])+" "+app.goalStr,this.goalTxt.y=app.config.gameData.promptY-(this.goalTxt.getMeasuredHeight()-this.goalTxt.lineHeight),this.goalTxt.visible=!0,0===app.actionArr[app.actionIndx]?this.goalTxt.color=app.config.gameData.PINK_COLOR:this.goalTxt.color="white";var t=[];0==app.actionIndx?(t.push("fg_promptintro_tapplay"),"draw"!=app.types[app.actionArr[0]]&&t.push("fg_promptintro_buddy")):("draw"==app.types[app.actionArr[0]]&&1==app.actionIndx&&t.push("fg_promptintro_buddy"),this.delay=new a(this.playIdle,this.DELAY_TIME)),t.length>0&&app.voPlayer.play(t),this.staticSparkles.alpha=0,createjs.Tween.get(this.staticSparkles,{loop:!0}).to({alpha:1},1800).to({alpha:0},1800),this.sparkleCont.visible=!0;for(var i=0;i<this.sparklesArr.length;i++)this.sparklesArr[i].scaleX=this.sparklesArr[i].scaleY=0,this.sparklesArr[i].alpha=1,this.sharedAnim.sparkleLoop(this.sparklesArr[i],!1)},n.playIdle=function(t){app.voPlayer.play("fg_promptintro_tapplay")},n.startGame=function(){if(!app.gamePaused&&!this.countdown){this.playBtn.enabled=!1,this.playBtnUnicorn.enabled=!1,this.playBtn.visible=!1,this.playBtnUnicorn.visible=!1,this.countdown=!0,app.sound.play("sfx_click"),app.voPlayer.stop(),this.delay&&(this.delay.destroy(),this.delay=null),this.goldie.gotoAndStop(0),this.playCountdownBtn.visible=!0,this.playCountdownBtn.btn.gotoAndStop(app.isUC?1:0),this.playCountdownBtn.gotoAndStop(0),createjs.Tween.get(this.playCountdownBtn).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100);var t=[];"act"!=app.types[app.actionArr[app.actionIndx]]&&"dance"!=app.types[app.actionArr[app.actionIndx]]||t.push("fg_countdown_"+app.types[app.actionArr[app.actionIndx]]),t.push("fg_countdown","fg_countdown_go"),app.voPlayer.play(t,function(){createjs.Tween.removeTweens(this.staticSparkles);for(var t=0;t<this.sparklesArr.length;t++)createjs.Tween.removeTweens(this.sparklesArr[t]);app.eventDispatcher.trigger("START_GAME")}.bind(this))}},n.exit=function(){this.playBtn.off("mousedown",this.startGame)},namespace("WGBH").GameSetupScreen=s}(),function(){var t=include("createjs.Container"),e=include("springroll.easeljs.Button"),a=include("createjs.Bitmap"),s=function(i,e,a){t.call(this),this.setup=this.setup.bind(this),this.pickScore=this.pickScore.bind(this),this.emojiEnd=this.emojiEnd.bind(this),this.votingDone=this.votingDone.bind(this),this.showCard=this.showCard.bind(this),this.showEmojiShower=this.showEmojiShower.bind(this),this.playEmoji=this.playEmoji.bind(this),this.exit=this.exit.bind(this),this.init(i,e,a)},n=(t.prototype,extend(s,t));n.init=function(i,s,n){var r;for(this.panel=i,this.uiCont=s,this.gameCont=n,this.selectedScore=-1,this.selectedPlayerIndx=-1,this.emojiCount=0,this.bgIndx=1,this.utils=new WGBH.Utilities,this.art=null,this.bg=new a(images.BG_draw_score),this.bg.x=-(app.config.scalingSize.maxWidth-app.config.scalingSize.width)/2,this.nextBtn=new e(images.PlayButton),this.nextBtn.x=900,this.nextBtn.y=630,this.nextBtn.visible=!1,this.addChild(this.bg,this.nextBtn),this.passTxt=new createjs.Text("PASS IT BACK TO","75px Hooligan","white"),this.addChild(this.passTxt),this.passTxt.textAlign="center",this.passTxt.textBaseline="bottom",this.passTxt.x=512,this.passTxt.y=400,this.passTxt.initY=this.passTxt.y,this.passTxt.destY=this.passTxt.y-120,this.passTxt.visible=!1,this.btnContainer=new t,this.addChild(this.btnContainer),this.btnContainer.x=45,this.btnContainer.y=404,this.btnContainer.initY=this.btnContainer.y,this.btnContainer.initX=this.btnContainer.x,this.btnBG=new createjs.Bitmap(images.BG1),this.btnContainer.addChild(this.btnBG),this.playerTxt=new createjs.Text("","60px Hooligan","white"),this.playerTxt.textAlign="left",this.playerTxt.textBaseline="bottom",this.playerTxt.x=345,this.playerTxt.y=122,this.btnContainer.addChild(this.playerTxt),this.playerIcon=new createjs.Sprite(ss.game,"player_icon1"),this.playerIcon.x=this.playerTxt.x-85,this.playerIcon.y=this.playerTxt.y-73,this.playerIcon.scaleX=this.playerIcon.scaleY=.6,this.btnContainer.addChild(this.playerIcon),this.recapContainer=new t,this.bg2=new a(images.BG_act),this.bg2.x=-(app.config.scalingSize.maxWidth-app.config.scalingSize.width)/2,this.recapPlayerCont=new t,this.recapText=new createjs.Text("PLAYER 1","100px Hooligan","white"),this.recapText.textAlign="left",this.recapText.textBaseline="bottom",this.recapText.x=-70,this.recapIcon=new createjs.Sprite(ss.game,"player_icon1"),this.recapIcon.scaleX=this.recapIcon.scaleY=.9,this.recapIcon.x=this.recapText.x-120,this.recapIcon.y=-105,this.recapPlayerCont.x=512,this.recapPlayerCont.y=this.passTxt.y+120,this.recapPlayerCont.initY=this.recapPlayerCont.y,this.recapPlayerCont.addChild(this.recapText,this.recapIcon),this.recapPlayerCont.visible=!1,this.bigEmoji=new WGBH.Emoji(1),this.bigEmoji.x=512,this.bigEmoji.y=384,this.bigEmoji.scaleX=this.bigEmoji.scaleY=0,this.bigEmoji.cursor="pointer",this.bigEmoji.addEventListener("mousedown",this.playEmoji),this.recapContainer.addChild(this.bg2,this.bigEmoji),this.addChild(this.recapContainer,this.recapPlayerCont),this.recapContainer.visible=!1,this.emojiArr=[],this.emojiCont=new t,r=0;r<20;r++){var p=new WGBH.Emoji(1,!0);this.emojiCont.addChild(p),p.x=this.bg.x+76*r,p.y=-100-50*r,p.initPos={x:p.x,y:p.y},this.emojiArr.push(p)}this.emojiArr=this.utils.shuffleArray(this.emojiArr),this.addChild(this.emojiCont),this.emojiCont.visible=!1;var o=155,h=[-5,3,-6,15];for(this.scoreEmojiArr=[],r=0;r<4;r++){var l=new WGBH.Emoji(r);this.btnContainer.addChild(l),l.x=o,l.y=this.playerTxt.y+100,l.scaleX=l.scaleY=.78,l.indx=r,l.rotation=h[r],l.setIcon(r,!0),l.cursor="pointer",l.addEventListener("mousedown",this.pickScore),this.scoreEmojiArr.push(l),o+=205}this.nextBtnCont=new t,this.nextPlayerTxt=new createjs.Text("PLAYER 2","60px Hooligan","white"),this.nextPlayerTxt.textBaseline="bottom",this.nextPlayerTxt.x=-185,this.nextPlayerTxt.y=85,this.nextPlayerIcon=new createjs.Sprite(ss.game,"player_icon1"),this.nextPlayerIcon.regX=47,this.nextPlayerIcon.regY=47,this.nextPlayerIcon.scaleX=this.nextPlayerIcon.scaleY=.6,this.nextPlayerIcon.x=this.nextPlayerTxt.x-90*this.nextPlayerIcon.scaleX,this.nextPlayerIcon.y=this.nextPlayerTxt.y-40,this.nextBtn=new e(images.PlayButton),this.nextBtnCont.addChild(this.nextBtn,this.nextPlayerTxt,this.nextPlayerIcon),this.nextBtn.addEventListener("mousedown",this.votingDone),this.uiCont.addChild(this.nextBtnCont),this.nextBtnCont.visible=!1,this.visible=!1},n.setup=function(t){this.scorePicked=!1,0==app.actionArr[app.actionIndx]?this.padding=32:this.padding=0,this.recapContainer.visible=!1,this.emojiCont.visible=!1,this.visible=!0,this.bg.image=images["BG_"+app.types[app.actionArr[app.actionIndx]]],this.bg2.image=images["BG_"+app.types[app.actionArr[app.actionIndx]]],this.bg.visible=!1,this.bigEmoji.scaleX=this.bigEmoji.scaleY=0,this.nextBtnCont.visible=!1,this.playerTxt.color=app.config.gameData.fontColorArr[app.actionArr[app.actionIndx]],this.passTxt.color=this.playerTxt.color,this.passTxt.visible=!1,this.recapPlayerCont.visible=!1,"draw"==app.types[app.actionArr[app.actionIndx]]&&(this.art=t,this.art.scaleX=this.art.scaleY=1,this.art.y=125,this.art.x=(1024-920*this.art.scaleX)/2,this.addChildAt(this.art,1));for(var i=0;i<this.scoreEmojiArr.length;i++)this.scoreEmojiArr[i].setIcon(i);this.recapText.color=app.config.gameData.fontColorArr[app.actionArr[app.actionIndx]],this.nextPlayerTxt.color=this.recapText.color,this.panel.roundTxt.color=this.recapText.color,this.selectedPlayerIndx=app.playerIndx,this.btnContainer.x=this.btnContainer.initX,this.btnContainer.y=this.btnContainer.initY+this.padding,app.scoreArr[app.playerIndx]=[0,0,0,0],this.choosePlayer(),this.bgIndx=this.selectedPlayerIndx+1,this.bgIndx=this.bgIndx>3?this.bgIndx-3:this.bgIndx,this.btnBG.image=images["BG"+this.bgIndx],this.playerIcon.gotoAndStop("player_icon"+app.iconArr[this.selectedPlayerIndx]),this.playerTxt.text="PLAYER "+(this.selectedPlayerIndx+1)+" VOTE!",this.playerTxt.color=app.config.gameData.scoreColorArr[this.bgIndx-1],this.btnContainer.x=this.btnContainer.initX,this.btnContainer.y=800;app.isUC;app.voPlayer.play(["fg_vote_"+app.types[app.actionArr[app.actionIndx]]],this.showCard)},n.showCard=function(){var t=[];if(app.playerTotal>2&&t.push("fg_vote_first"),t.push("fg_player"+(this.selectedPlayerIndx+1),"fg_vote_bear"),app.voPlayer.play(t),"draw"==app.types[app.actionArr[app.actionIndx]]){createjs.Tween.get(this.art).to({scaleX:.7,scaleY:.7,y:80,x:190},100)}else createjs.Tween.get(this.gameCont.drawTxt).to({y:this.gameCont.drawTxt.initY+25},100);createjs.Tween.get(this.btnContainer).to({y:this.btnContainer.initY+this.padding},100)},n.choosePlayer=function(){var t=!1;if(this.selectedPlayerIndx++,app.playerIndx!=this.selectedPlayerIndx)if(t=!0,this.selectedPlayerIndx>=app.playerTotal&&0!=app.playerIndx)this.selectedPlayerIndx=0;else if(this.selectedPlayerIndx==app.playerTotal)return!1;return t},n.pickScore=function(t){app.gamePaused||this.scorePicked||(this.scorePicked=!0,app.voPlayer.stop(),app.sound.play("sfx_emoji"+t.target.indx),t.target.playEmoji(),app.scoreArr[app.playerIndx][t.target.indx]++,this.gotIt=this.choosePlayer(),createjs.Tween.get(this.btnContainer).wait(1e3).to({x:-800},100).wait(100).call(function(){if(this.btnContainer.x=this.btnContainer.initX,this.btnContainer.y=800,this.gotIt){for(this.scorePicked=!1,this.bgIndx=3==this.bgIndx?1:this.bgIndx+1,this.btnBG.image=images["BG"+this.bgIndx],this.playerIcon.gotoAndStop("player_icon"+app.iconArr[this.selectedPlayerIndx]),this.playerTxt.text="PLAYER "+(this.selectedPlayerIndx+1)+" VOTE!",this.playerTxt.color=app.config.gameData.scoreColorArr[this.bgIndx-1],i=0;i<this.scoreEmojiArr.length;i++)this.scoreEmojiArr[i].setIcon(i);createjs.Tween.get(this.btnContainer).to({y:this.btnContainer.initY+this.padding},100),app.voPlayer.play(["fg_player"+(this.selectedPlayerIndx+1),"fg_vote_bear"])}else app.voPlayer.play(["fg_passback","fg_player"+(app.playerIndx+1),"fg_vote_letssee"],function(){this.showEmojiShower()}.bind(this)),this.recapPlayerCont.visible=!0,this.recapText.text="PLAYER "+(app.playerIndx+1),this.recapIcon.gotoAndStop("player_icon"+app.iconArr[app.playerIndx]),this.passTxt.y=this.passTxt.initY,this.passTxt.alpha=1,this.recapPlayerCont.y=this.recapPlayerCont.initY,this.passTxt.visible=!0,createjs.Tween.get(this.recapPlayerCont).wait(2e3).to({y:this.passTxt.initY},500),createjs.Tween.get(this.passTxt).wait(2e3).to({y:this.passTxt.destY,alpha:0},500),this.gameCont.drawTxt.visible=!1,this.panel.drawPromptTxt.visible=!1,"draw"==app.types[app.actionArr[app.actionIndx]]&&(this.art.visible=!1)}.bind(this)))},n.showEmojiShower=function(){this.passTxt.visible=!1,app.eventDispatcher.trigger("SHOW_EMOJI");var t=0,e=[];for(i=0;i<app.scoreArr[app.playerIndx].length;i++)app.scoreArr[app.playerIndx][i]>0&&e.push(i),app.scoreArr[app.playerIndx][i]>app.scoreArr[app.playerIndx][t]&&(t=i);this.recapContainer.visible=!0,this.emojiCont.visible=!0,this.emojiCount=0;var a=0;app.scoreArr[app.playerIndx].length;for(this.bigEmoji.setIcon(t),i=0;i<this.emojiArr.length;i++){var s=this.emojiArr[i];createjs.Tween.removeTweens(s),s.setIcon(e[a]),s.scaleX=s.scaleY=this.utils.getRandomNumber(.2,.7),s.rotation=this.utils.getRandomNumber(0,360),s.x=s.initPos.x,s.y=s.initPos.y,s.speed=this.utils.getRandomNumber(1e3,5e3),createjs.Tween.get(s).to({y:900},s.speed).call(this.emojiEnd),a=a<e.length-1?a+1:0,this.emojiArr[i].update()}app.sound.play("sfx_applause"),app.sound.play("sfx_yay")},n.emojiEnd=function(t){this.emojiCount++,t.y=t.target.initPos.y,this.emojiCount>=this.emojiArr.length&&(this.emojiCont.visible=!1,this.bigEmoji.scaleX=this.bigEmoji.scaleY=0,this.recapPlayerCont.visible=!1,createjs.Tween.get(this.bigEmoji).to({scaleX:1,scaleY:1},500,createjs.Ease.backOut).call(function(){this.bigEmoji.playEmoji();var t=app.playerIndx<app.playerTotal-1?app.playerIndx+1:0;app.actionIndx==app.actions.length-1&&app.playerIndx==app.playerTotal-1?(this.nextPlayerTxt.visible=!1,this.nextPlayerIcon.visible=!1):(this.nextPlayerTxt.visible=!0,this.nextPlayerIcon.visible=!0),this.nextPlayerTxt.text="PLAYER "+(t+1),this.nextPlayerIcon.gotoAndStop("player_icon"+app.iconArr[t]),this.nextBtnCont.visible=!0}.bind(this)))},n.playEmoji=function(t){this.bigEmoji.playEmoji()},n.votingDone=function(t){app.sound.play("sfx_click"),this.nextBtnCont.visible=!1,app.eventDispatcher.trigger("SCORE_CHOSEN")},n.closeIt=function(){this.visible=!1,this.art&&(this.removeChild(this.art),this.art=null)},n.exit=function(){this.nextBtn.removeEventListener("mousedown",this.votingDone),this.bigEmoji.removeEventListener("mousedown",this.playEmoji)},namespace("WGBH").ScoreScreen=s}(),function(){var t=include("createjs.Container"),e=include("springroll.easeljs.Button"),a=function(i){t.call(this),this.init=this.init.bind(this),this.setup=this.setup.bind(this),this.goLeft=this.goLeft.bind(this),this.goRight=this.goRight.bind(this),this.resumeGame=this.resumeGame.bind(this),this.newGame=this.newGame.bind(this),this.exit=this.exit.bind(this),this.init(i)},s=(t.prototype,extend(a,t));s.init=function(a){this.panel=a,this.utils=new WGBH.Utilities,this.settingsBG=new createjs.Bitmap(images.BG1),this.addChild(this.settingsBG),this.settingsBG.x=-256,this.settingsCont=new createjs.Container,this.pausedBG=new createjs.Bitmap(images.BG1),this.pausedBG.x=45,this.pausedBG.y=220;var s=new createjs.Text("GAME PAUSED","60px Hooligan",app.config.gameData.PINK_COLOR);s.textAlign="center",s.textBaseline="bottom",s.x=this.pausedBG.x+472,s.y=this.pausedBG.y+190;var n=new createjs.Sprite(ss.game,"parents_pause");n.x=s.x-200,n.y=s.y-65,this.btn_cont=new e(images.btn_cont),this.btn_cont.regX=172,this.newBtn=new e(images.btn_reset),this.newBtn.regX=172,this.newBtn.x=this.pausedBG.x+280,this.newBtn.y=this.pausedBG.y+270,this.btn_cont.x=this.newBtn.x+380,this.btn_cont.y=this.newBtn.y,this.btn_cont.addEventListener("click",this.resumeGame),this.newBtn.addEventListener("click",this.newGame),this.settingsCont.addChild(this.pausedBG,s,n,this.btn_cont,this.newBtn),this.parentsCont=new createjs.Container,this.parentsBG=new createjs.Bitmap(images.BG1),this.parentsBG.x=45,this.parentsBG.y=120,this.parentsCont.addChild(this.parentsBG),xpos=this.parentsBG.x+150,ypos=330;var r=new createjs.Text("SETTINGS","60px Hooligan",app.config.gameData.PINK_COLOR);r.textAlign="center",r.textBaseline="bottom",r.x=this.parentsBG.x+467,r.y=this.parentsBG.y+120;var p=new createjs.Sprite(ss.game,"parents_gear");p.x=r.x-140,p.y=r.y-55,this.parentsCont.addChild(p,r);var o,h,l,c,d,g=new createjs.Text("Rounds:","40px Hooligan",r.color),m=new createjs.Text("Timer Speed:","40px Hooligan",r.color);for(this.parentsCont.addChild(g,m),g.textBaseline="bottom",m.textBaseline="bottom",g.x=m.x=xpos-60,g.y=ypos-10,this.roundBtnArr=[],i=0;i<app.types.length;i++){var u=new createjs.Sprite(ss.game,"parents_num"+(i+1));this.parentsCont.addChild(u),u.x=xpos-64,u.y=ypos+15,o=new t,h=new createjs.Sprite(ss.game,"bg_rounds"),(l=new createjs.Text(app.types[app.actionArr[i]].toUpperCase(),"45px Hooligan",app.config.gameData.PINK_COLOR)).textAlign="center",l.textBaseline="bottom",l.maxWidth=304,l.name="text",l.x=152,l.y=75,(c=new e(images.btn_left)).x=8,c.y=7,(d=new e(images.btn_right)).x=237,d.y=7,c.addEventListener("mousedown",this.goLeft),d.addEventListener("mousedown",this.goRight),o.addChild(h,l,c,d),o.x=xpos,o.y=ypos,o.indx=i,o.type=app.actionArr[i],o.kind="round",this.parentsCont.addChild(o),this.roundBtnArr.push(o),i%2==0?ypos+=100:(xpos+=400,ypos=330)}this.timerBtnArr=[],o=new t,h=new createjs.Sprite(ss.game,"bg_timer"),(l=new createjs.Text(app.config.gameData.TIME_TYPES[app.timerIndx].toUpperCase(),"45px Hooligan",app.config.gameData.PINK_COLOR)).textAlign="center",l.textBaseline="bottom",l.maxWidth=264,l.name="text",l.x=183,l.y=75,(c=new e(images.btn_left)).x=8,c.y=7,(d=new e(images.btn_right)).x=300,d.y=7,c.addEventListener("mousedown",this.goLeft),d.addEventListener("mousedown",this.goRight),o.addChild(h,l,c,d),o.x=this.parentsBG.x+100,o.y=ypos+290,o.indx=app.timerIndx,o.type=app.timerIndx,o.kind="timer",this.parentsCont.addChild(o),m.y=o.y-10,this.btn_done=new e(images.btn_save),this.btn_done.x=this.parentsBG.x+520,this.btn_done.y=o.y-10,this.btn_done.addEventListener("mousedown",this.resumeGame),this.parentsCont.addChild(this.btn_done),this.parentsCont.visible=!1,this.addChild(this.parentsCont,this.settingsCont)},s.setup=function(t){app.gamePaused=!0,this.visible=!0,this.parentsCont.visible=!1,this.settingsCont.visible=!1,"parents"==t?(this.lastTimer=app.timerIndx,this.lastOrder=app.actionArr.clone(),this.settingsBG.image=images.TitleBackground,this.parentsCont.visible=!0,app.voPlayer.play(["fg_settings1","fg_settings2"])):(this.settingsBG.image=images["BG_"+app.types[app.actionArr[app.actionIndx]]],this.settingsCont.visible=!0,app.voPlayer.play("fg_startover"))},s.showIt=function(){this.parentsCont.visible?app.voPlayer.play(["fg_settings1","fg_settings2"]):app.voPlayer.play("fg_startover")},s.goLeft=function(t){app.sound.play("sfx_click_hi");var i=t.target.parent,e=i.type>0?i.type-1:app.types.length-1;i.type=e,"round"==i.kind?(app.actionArr[i.indx]=e,i.getChildByName("text").text=app.types[e].toUpperCase()):(app.timerIndx=e,i.getChildByName("text").text=app.config.gameData.TIME_TYPES[app.timerIndx].toUpperCase())},s.goRight=function(t){app.sound.play("sfx_click_hi");var i=t.target.parent,e=i.type<app.types.length-1?i.type+1:0;i.type=e,"round"==i.kind?(app.actionArr[i.indx]=e,i.getChildByName("text").text=app.types[e].toUpperCase()):(app.timerIndx=e,i.getChildByName("text").text=app.config.gameData.TIME_TYPES[app.timerIndx].toUpperCase())},s.resumeGame=function(t){if(app.voPlayer.stop(),this.parentsCont.visible){this.gaSettings={order:!1,timer:this.lastTimer!=app.timerIndx};for(var i=0;i<app.actionArr.length&&(this.gaSettings.order=app.actionArr[i]!=this.lastOrder[i],!this.gaSettings.order);i++);this.utils.setGAEvent("settings",this.gaSettings)}app.eventDispatcher.trigger("RESUME_GAME"),app.gamePaused=!1},s.newGame=function(t){app.sound.play("sfx_click"),app.startOver=!0,app.music="",app.eventDispatcher.trigger("NEW_GAME_DIFF_PLAYERS"),app.gamePaused=!1},s.exit=function(){this.btn_done.removeEventListener("mousedown",this.resumeGame),this.btn_cont.removeEventListener("click",this.resumeGame),this.newBtn.removeEventListener("click",this.newGame)},namespace("WGBH").SettingsScreen=a}(),function(){var t=include("createjs.Container"),i=include("springroll.easeljs.Button"),e=include("createjs.Bitmap"),a=include("springroll.DelayedCall"),s=function(){t.call(this),this.spinIt=this.spinIt.bind(this),this.startGame=this.startGame.bind(this),this.updateSpinner=this.updateSpinner.bind(this),this.gotWord=this.gotWord.bind(this),this.audioDone=this.audioDone.bind(this),this.addSparkle=this.addSparkle.bind(this),this.playAudioAndHighlight=this.playAudioAndHighlight.bind(this),this.exit=this.exit.bind(this),this.init()},n=(t.prototype,extend(s,t));n.init=function(){var a=1024/3/2;this.utils=new WGBH.Utilities,this.sharedAnim=new WGBH.SharedAnimation,this.spinnerCont=new t,this.spinArr=this.utils.shuffleArray([1,2,3,4]),this.spinIndx=0,this.spinTxtArr=[],this.spinBgArr=[],this.spinnerArr=[],this.gotSound=!1,this.gotAnimation=!1,this.sparkleContainer=new t,this.colorsArr=["#ffae29","#f45ca5","#8f5ca6"];for(var s=0;s<3;s++){var n=new t,r=new createjs.Shape;r.name="bg",r.graphics.f(this.colorsArr[s]).dr(0,0,1024/3,768),r.x=-1024/3/2,txt=new createjs.Text("Draw","70px Hooligan","white"),txt.textAlign="center",txt.y=350,txt.initY=txt.y,txt.lineWidth=1024/3-60,txt.lineHeight=80,txt.name="text",txt.textBaseline="middle";var p=new e(images.sparkleStar);p.name="sparkle",p.regX=p.image.width/2,p.regY=p.image.height/2,p.y=txt.y-10,p.alpha=0,n.addChild(r,p,txt),this.spinTxtArr.push(txt),this.spinBgArr.push(r),n.x=a,n.y=0,a+=1024/3,this.spinnerCont.addChild(n),this.spinnerArr.push(n)}this.unicornCont=new t;var o=new e(images.BG_unicorn);this.goldie=new createjs.Sprite(ss.game,"goldie"),this.goldie.framerate=8,this.unicornCont.addChild(o),this.unicornCont.x=-256,this.goldie.x=-500,this.goldie.y=300,this.goldie.initPos={x:this.goldie.x,y:this.goldie.y},this.spinnerCont.addChild(this.unicornCont),this.unicornCont.visible=!1,this.unicornSparklesArr=[];var h=[{sparkle:"Sparkle2",x:1396,y:126,maxScale:.3,length:460,wait:667},{sparkle:"Sparkle2",x:156,y:592,maxScale:.3,length:460,wait:730},{sparkle:"Sparkle2",x:666,y:598,maxScale:.3,length:460,wait:800},{sparkle:"Sparkle2",x:1082,y:174,maxScale:.3,length:460,wait:860},{sparkle:"Sparkle2",x:364,y:412,maxScale:.3,length:460,wait:930},{sparkle:"Sparkle1",x:178,y:446,maxScale:.3,length:460,wait:1130},{sparkle:"Sparkle1",x:1166,y:172,maxScale:.3,length:460,wait:1130},{sparkle:"Sparkle2",x:1238,y:594,maxScale:.3,length:460,wait:1200},{sparkle:"Sparkle2",x:912,y:350,maxScale:.3,length:460,wait:1267}],l=h[h.length-1].wait+h[h.length-1].length;for(s=0;s<h.length;s++){var c=new createjs.Bitmap(images[h[s].sparkle]);c.regX=c.image.width/2,c.regY=c.image.height/2,c.scaleX=c.scaleY=0,c.maxScale=h[s].maxScale,c.length=h[s].length,c.wait=h[s].wait,c.maxTime=l,c.x=h[s].x,c.y=h[s].y,c.alpha=1,this.unicornCont.addChild(c),this.unicornSparklesArr.push(c)}this.unicornCont.addChild(this.goldie),this.starArr=[];var d=[[222,530],[280,482],[406,530],[476,430],[566,436],[592,472],[816,444],[874,364],[1028,342],[1282,354]],g=[[-54,546],[32,472],[130,546],[176,452],[376,476],[412,522],[536,532],[630,418],[848,392],[984,384]],m=[.4,1,.65,.65,.4,1,.4,.65,1,.65],u=[123,0,123,36,123,0,123,123,0,36],x=[1e3,1100,1300,1600,1800,2050,2300,2300,2600,3e3];for(s=0;s<d.length;s++){var y=new createjs.Sprite(ss.game,"confetti24");y.x=d[s][0],y.y=d[s][1],y.initPos={x:y.x,y:y.y},y.destPos={x:g[s][0],y:g[s][1]},y.rotation=u[s],y.maxScale=m[s],y.waitTime=x[s],y.scaleX=y.scaleY=0,this.unicornCont.addChild(y),this.starArr.push(y)}this.startBtn=new i(images.btn_next),this.startBtn.x=900,this.startBtn.y=620,this.startBtn.regX=142,this.startBtn.addEventListener("mousedown",this.startGame),this.spinnerCont.visible=!1,this.addChild(this.spinnerCont,this.sparkleContainer)},n.updateSpinner=function(){for(var t=this.parent.x,i=(app.config.scalingSize.width,app.realWidth/app.realHeight*app.config.scalingSize.height),e=i/3,a=i>app.config.scalingSize.width?-(i-app.config.scalingSize.width)/2+e/2:e/2,s=0;s<this.spinBgArr.length;s++)this.spinBgArr[s].graphics.clear().f(this.colorsArr[s]).dr(0,0,e,768),this.spinBgArr[s].parent.x=a,this.spinBgArr[s].x=-e/2,a+=e;this.startBtn.x=a-e/2-10},n.setup=function(){this.gotSound=!1,this.gotAnimation=!1,app.isUC=app.ucIndx==app.turnCount,this.updateSpinner(),this.unicornCont.visible=!1,this.goldie.x=this.goldie.initPos.x,this.visible=!0,this.spinnerCont.visible=!0,app.on("resize",this.updateSpinner);for(var t=0;t<this.spinnerArr.length;t++)this.spinnerArr[t].y=-app.config.gameData.spinnerPullDist,this.spinTxtArr[t].alpha=1,this.spinnerArr[t].getChildByName("sparkle").alpha=0;this.wordCount=0,this.startBtn.visible=!1,app.sound.play("sfx_spin"),this.spinIt()},n.spinIt=function(t){this.spinTxtArr[0].text=app.actions[app.actionArr[app.actionIndx]];var i=this.utils.getPromptFileName(app.situations[app.situationIndx]),e=app.isUC?"fg_prompt_unicorn":"";if(this.spinAudioArr=[],"sing"!=app.types[app.actionArr[app.actionIndx]]&&this.spinAudioArr.push("fg_spin_"+app.types[app.actionArr[app.actionIndx]]),"draw"==app.types[app.actionArr[app.actionIndx]]||"act"==app.types[app.actionArr[app.actionIndx]])this.spinTxtArr[1].text=app.isUC?"a unicorn":app.itemsAll[app.itemsAllIndx][0]+" "+app.itemsAll[app.itemsAllIndx][1],this.spinTxtArr[2].text=app.situations[app.situationIndx],app.isUC||(e="fg_prompt_noun_"+this.utils.getPromptFileName(app.itemsAll[app.itemsAllIndx][1])),this.spinAudioArr.push(e+"1","fg_prompt_situation_"+i);else if("sing"==app.types[app.actionArr[app.actionIndx]])this.spinTxtArr[1].text=app.songs[app.songIndx].title,this.spinTxtArr[2].text=app.isUC?"Unicorn":this.utils.capitalizeFirstLetterOfAllWords(app.itemsSing[app.itemsSingIndx][1]),app.isUC||(e="fg_prompt_noun_"+this.utils.getPromptFileName(app.itemsSing[app.itemsSingIndx][1])),app.songs[app.songIndx].played?this.spinAudioArr.push("fg_spin_sing","fg_prompt_song_"+this.utils.getPromptFileName(this.spinTxtArr[1].text),e+"2"):(app.songs[app.songIndx].played=!0,this.spinAudioArr.push("fg_spin_sing_"+this.utils.getPromptFileName(this.spinTxtArr[1].text),"fg_prompt_song_"+this.utils.getPromptFileName(this.spinTxtArr[1].text),e+"2"));else if("dance"==app.types[app.actionArr[app.actionIndx]]){var a=app.isUC?"unicorn":app.itemsDance[app.itemsDanceIndx][1];this.spinTxtArr[1].text="called the",this.spinTxtArr[2].text=a,app.isUC||(e="fg_prompt_noun_"+this.utils.getPromptFileName(app.itemsDance[app.itemsDanceIndx][1])),this.spinAudioArr.push(e+"2")}app.goalStr=this.spinTxtArr[1].text+" "+this.spinTxtArr[2].text;for(var s=0;s<this.spinnerArr.length;s++)this.spinTxtArr[s].y=this.spinTxtArr[s].initY-(this.spinTxtArr[s].getMeasuredHeight()-this.spinTxtArr[s].lineHeight)/2,this.spinnerArr[s].y=-app.config.gameData.spinnerPullDist,createjs.Tween.get(this.spinnerArr[s]).wait(app.config.gameData.spinnerWaitArr[s]).to({y:0},app.config.gameData.spinnerPullTime).call(this.gotWord);this.spinnerCont.visible=!0},n.dragSpin=function(t){for(var i=0;i<this.spinnerArr.length;i++)this.spinnerArr[i].y=t-app.config.gameData.spinnerWaitArr[i]+100},n.gotWord=function(t){this.wordCount++,t.target.getChildByName("sparkle").alpha=1,3==this.wordCount&&(app.eventDispatcher.trigger("GOT_WORDS"),this.startBtn.visible=!0,app.isUC?(this.goldie.x=this.goldie.initPos.x,this.goldie.y=this.goldie.initPos.y,this.audioReady=!1,this.playAudioAndHighlight(),this.spinIndx++,this.spinIndx>=this.spinArr.length&&(this.spinIndx=0,this.spinArr=this.utils.shuffleArray(this.spinArr))):app.gamePaused||(this.audioReady=!0,this.playAudioAndHighlight()))},n.playAudioAndHighlight=function(){"dance"!=app.types[app.actionArr[app.actionIndx]]?(this.addSparkle(this.spinnerArr[0],this.spinTxtArr[0]),app.voPlayer.play(this.spinAudioArr[0],function(){this.addSparkle(this.spinnerArr[1],this.spinTxtArr[1]),app.voPlayer.play(this.spinAudioArr[1],function(){this.addSparkle(this.spinnerArr[2],this.spinTxtArr[2]),app.voPlayer.play(this.spinAudioArr[2],this.audioDone)}.bind(this))}.bind(this))):(this.addSparkle(this.spinnerArr[0],this.spinTxtArr[0]),createjs.Tween.get(this).wait(1e3).call(function(){this.addSparkle(this.spinnerArr[1],this.spinTxtArr[1])}.bind(this)),app.voPlayer.play(this.spinAudioArr[0],function(){this.addSparkle(this.spinnerArr[2],this.spinTxtArr[2]),app.voPlayer.play(this.spinAudioArr[1],this.audioDone)}.bind(this)))},n.audioDone=function(t){if(this.audioReady=!0,app.isUC){app.voPlayer.play(["fg_unicorn_spin"+this.spinArr[this.spinIndx],"fg_unicorn_follow"],function(){this.gotSound=!0,this.gotAnimation&&this.startGame()}.bind(this)),this.unicornCont.alpha=0,this.unicornCont.visible=!0;for(var i=0;i<this.spinTxtArr.length;i++)createjs.Tween.get(this.spinTxtArr[i]).to({alpha:0},500),createjs.Tween.get(this.spinnerArr[i].getChildByName("sparkle")).to({alpha:0},500);for(createjs.Tween.get(this.unicornCont).to({alpha:1},1e3).wait(300),i=0;i<this.unicornSparklesArr.length;i++)this.unicornSparklesArr[i].alpha=1,this.unicornSparklesArr[i].scaleX=this.unicornSparklesArr[i].scaleY=0,this.sharedAnim.sparkleLoop(this.unicornSparklesArr[i],!1);this.goldie.scaleX=this.goldie.scaleY=.8,this.goldie.x=this.goldie.initPos.x,this.goldie.y=this.goldie.initPos.y,this.goldie.rotation=0;var e=app.config.scalingSize.maxWidth;createjs.Tween.get(this.goldie).wait(1500).call(function(){for(this.goldie.gotoAndPlay("goldie"),app.sound.play("sfx_goldie_sparkle"),app.sound.play("sfx_goldie_music"),i=0;i<this.starArr.length;i++)this.sharedAnim.sparkleStar(this.starArr[i],!1)}.bind(this)).to({rotation:-5,x:e/5,y:260,scaleX:.85,scaleY:.85},1200).to({rotation:-10,x:e/2,y:110,scaleX:.9,scaleY:.9},1e3).to({rotation:-3,x:.8*e,y:80,scaleX:.95,scaleY:.95},1200).to({rotation:1.5,x:e+300,y:220,scaleX:1,scaleY:1},1400).call(function(){this.gotAnimation=!0,this.gotSound&&this.startGame()}.bind(this))}else this.startGame()},n.addSparkle=function(t,i){var e,a=t.getChildByName("sparkle");e={x:t.x,y:a.y,init_pause_fact:0,init_scale:.3,endX:this.utils.getRandomNumber(-130,130),endY:this.utils.getRandomNumber(-90,-60),sparkle:"Sparkle3"},this.sharedAnim.sparkle2Simple(this,this.sparkleContainer,e,!1),e={x:t.x-this.utils.getRandomNumber(30,180),y:a.y+this.utils.getRandomNumber(30,60),init_pause_fact:0,init_scale:.4,endX:this.utils.getRandomNumber(-130,130),endY:this.utils.getRandomNumber(100,130),sparkle:"Sparkle2"},this.sharedAnim.sparkle2Simple(this,this.sparkleContainer,e,!1),e={x:t.x+this.utils.getRandomNumber(50,180),y:a.y+this.utils.getRandomNumber(10,100),init_pause_fact:0,init_scale:.3,endX:this.utils.getRandomNumber(-130,130),endY:this.utils.getRandomNumber(70,100),sparkle:"Sparkle2"},this.sharedAnim.sparkle2Simple(this,this.sparkleContainer,e,!1),i&&createjs.Tween.get(i).to({scaleX:1.1,scaleY:1.1},300).to({scaleX:1,scaleY:1},300)},n.resumeGame=function(){3==this.wordCount&&(this.delay=new a(this.startGame,2e3))},n.startGame=function(t){if(this.audioReady){this.goldie.gotoAndStop("goldie"),app.off("resize",this.updateSpinner),this.visible=!1,createjs.Tween.removeAllTweens();for(var i=0;i<this.unicornSparklesArr.length;i++)this.unicornSparklesArr[i].alpha=1,this.unicornSparklesArr[i].scaleX=this.unicornSparklesArr[i].scaleY=0;app.eventDispatcher.trigger("SPIN_DONE")}},n.exit=function(){app.off("resize",this.updateSpinner),this.startBtn.removeEventListener("mousedown",this.startGame)},namespace("WGBH").SpinScreen=s}(),function(){var t=function(){},i=t.prototype;i.capitalizeFirstLetter=function(t){return t[0].toUpperCase()+t.slice(1)},i.capitalizeFirstLetterOfAllWords=function(t){return t.replace(/(^|\s)([a-z])/g,(function(t,i,e){return i+e.toUpperCase()}))},i.getRandomNumber=function(t,i){return Math.random()*(i-t)+t},i.getRandomInt=function(t,i){return Math.floor(Math.random()*(i-t+1))+t},i.shuffleArray=function(t){for(var e,a,s=t[t.length-1],n=t.length;n;e=Math.floor(Math.random()*n),a=t[--n],t[n]=t[e],t[e]=a);var r=i.getRandomInt(1,t.length-1);return t[0]==s&&(t[0]=t[r]),t},i.getPromptFileName=function(t){return t.replace(/[^A-Za-z0-9]/g,"").toLowerCase()},i.setGAEvent=function(t,i){var e,a,s,n=window.ga;if(n)if("playerNum"==t)n("send","event",e=app.config.gameData.GAME_TITLE+" - Number of People Playing",a=app.playerTotal.toString());else if("settings"==t){if(e=app.config.gameData.GAME_TITLE+" - Parent Settings",a=i.order?"Round Changed Yes":"Round Changed No",s="",i.order){for(var r=0;r<app.actionArr.length;r++)r>0&&(s+=", "),s+=app.types[app.actionArr[r]];n("send","event",e,a,s)}else n("send","event",e,a);a=i.timer?"Timer Changed Yes":"Timer Changed No",s=i.timer?app.config.gameData.TIME_TYPES[app.timerIndx]:"",i.timer?n("send","event",e,a,s):n("send","event",e,a)}else"end"==t?n("send","event",e=app.config.gameData.GAME_TITLE+" - Game End Screen",a="viewed"):"userjourney"==t&&n("send","event",e=app.config.gameData.GAME_TITLE+" - User Journey",a=i.start?"Start":"End",s=i.currentGame)};var e=[];createjs.Tween.pauseAllTweens=function(){var t,i=0,a=createjs.Tween._tweens.slice().reverse();for(i=0;i<a.length;i++)t=a[i],e.push(t),t.setPaused(!0)},createjs.Tween.resumeAllTweens=function(){var t=0;for(t=0;t<e.length;t++)e[t].setPaused(!1);e.length=0},namespace("WGBH").Utilities=t}();