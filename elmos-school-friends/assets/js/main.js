!function(){var a=new springroll.ApplicationPlugin;a.setup=function(){this.shuffle=a.shuffle.bind(this)},a.shuffle=function(a){var b,c,d=a.length;if(0!==d)for(;--d;)b=Math.floor(Math.random()*(d+1)),c=a[d],a[d]=a[b],a[b]=c},a.teardown=function(){}}(),function(){function a(a,b){return a.start-b.start}var b,c,d,e,f=include("createjs.Container"),g=function(g){if(d||(b=include("springroll.Debug",!1),d=include("springroll.Application"),e=include("springroll.Sound"),c=include("springroll.easeljs.BitmapUtils")),f.call(this),!g)throw"Need options to create Cutscene";this._display=g.display;this.width=g.width,this.height=g.height,this._elapsedTime=0,this._audio=g.audio?g.audio.slice():[],this._audio.sort(a),this._audioIndex=0;var h=this._clip=g.clip;this._activeSyncAudio=[],this._soundStartTime=-1,this._activeAudio=[],this._audioFinished=!1,this._functionCalls=g.functions?g.functions:[],this._endCallback=null,this._parent=g.parent;var i=this._captions=g.captions;i&&(i.selfUpdate=!1),this.update=this.update.bind(this),h.mouseEnabled=!1,h.tickEnabled=!1,h.gotoAndPlay(0),h.loop=!1,this.addChild(this._parent?this._parent:h)},h=extend(g,f);h.resize=function(a,b){if(this._clip){var c,d=this.width/this.height,e=a/b;d>e?(c=a/this.width,this.x=0,this.y=.5*(b-this.height*c)):(c=b/this.height,this.x=.5*(a-this.width*c),this.y=0),this._parent?this._parent.scaleX=this._parent.scaleY=c:this._clip.scaleX=this._clip.scaleY=c}},h.start=function(a){this._endCallback=a,this._elapsedTime=0,this._animFinished=!1,this._audioFinished=!this._audio.length;for(var b=0;b<this._audio.length;++b){var c=this._audio[b];if(0!==c.start)break;var f=c.alias,g={};if(c.sync){var h=e.instance.play(f,this._audioCallback.bind(this,g));try{this._activeSyncAudio.unshift(h),g.instance=h,h._audioData=c,this._soundStartTime=c.start,this._captions&&this._captions.play(f)}catch(i){}}else{var j=e.instance.play(f,this._audioCallback.bind(this,g));g.instance=j,this._activeAudio.push(j)}++this._audioIndex}d.instance.on("update",this.update)},h._audioCallback=function(a){var b=this._activeSyncAudio.indexOf(a.instance);if(-1!=b)if(0===b?this._activeSyncAudio.shift():this._activeSyncAudio.splice(b,1),this._activeSyncAudio.length<1)this._audioFinished=!0,this._soundStartTime=-1,this._captions&&this._captions.stop(),this._animFinished&&this.stop(!0);else try{var c=this._activeSyncAudio[0]._audioData;this._soundStartTime=c.start,this._captions&&this._captions.play(c.alias)}catch(d){}else b=this._activeAudio.indexOf(a.instance),-1!=b&&this._activeAudio.splice(b,1)},h.update=function(a){if(!this._animFinished){this._activeSyncAudio.length||(this._elapsedTime+=.001*a);for(var b=this._audioIndex;b<this._audio.length;++b){var c=this._audio[b];if(!(c.start<=this._elapsedTime))break;var d=c.alias,f={};if(c.sync){this._audioFinished=!1;var g=e.instance.play(d,this._audioCallback.bind(this,f));try{this._activeSyncAudio.unshift(g),f.instance=g,g._audioData=c,this._elapsedTime=this._soundStartTime=c.start,this._captions&&this._captions.play(d)}catch(h){}}else{var i=e.instance.play(d,{complete:this._audioCallback.bind(this,f),offset:1e3*(this._elapsedTime-c.start)});f.instance=i,this._activeAudio.push(i)}++this._audioIndex}for(var j=0;j<this._functionCalls.length;j++){var k=this._functionCalls[j];k.hasRun||k.time<=this._elapsedTime&&(k.hasRun=!0,k["function"]())}if(this._activeSyncAudio.length)try{var l=.001*this._activeSyncAudio[0].position;0===this._elapsedTime&&l>2*a||(this._elapsedTime=this._soundStartTime+l)}catch(h){}if(this._captions&&this._soundStartTime>=0&&this._captions.seek(this._activeSyncAudio[0].position),!this._animFinished){var m=this._clip.timeline&&1!=this._clip.timeline.duration?this._clip:this._clip.getChildAt(0);m.elapsedTime=this._elapsedTime,m.advance(),m.currentFrame==m.timeline.duration&&(this._animFinished=!0,this._audioFinished&&this.stop(!0))}}},h.stop=function(a){d.instance.off("update",this.update);var b;for(b=0;b<this._activeSyncAudio.length;++b)try{this._activeSyncAudio[b].stop()}catch(c){}for(b=0;b<this._activeAudio.length;++b)this._activeAudio[b].stop();this._activeAudio.length=this._activeSyncAudio.length=0,this._captions&&this._captions.stop(),a&&(this.dispatchEvent("complete"),this._endCallback&&(this._endCallback(),this._endCallback=null))},h.destroy=function(){this.stop(),this.dispatchEvent("destroy"),d.instance.off("resize",this.resize),this.removeAllChildren(!0),this._activeSyncAudio=this._activeAudio=this._audio=this._display=this._endCallback=this._clip=this._captions=null,this.parent&&this.parent.removeChild(this),this.removeAllEventListeners()},namespace("BackToSchool").Cutscene=g}(),function(a){var b=include("springroll.Task"),c=include("BackToSchool.Cutscene"),d=include("springroll.Application"),e=function(a){b.call(this,a,a.animClass);var c=d.instance;this.anim=a.anim,this.fps=a.fps||c.options.fps,this.animClass=a.animClass,this.width=a.width,this.height=a.height,this.audio=a.audio,this.images=a.images,this.libName=a.libName||"lib",this.imagesName=a.imagesName||"images",this.display="string"==typeof a.display?c.getDisplay(a.display):c.display},f=b.prototype,g=b.extend(e);e.test=function(a){return!!a.anim&&a.anim.search(/\.js$/i)>-1&&!!a.animClass&&a.width&&a.height},g.start=function(a){var b={_anim:{src:this.anim,libName:this.libName,images:this.images,imagesName:this.imagesName,type:"easeljs",format:"springroll.easeljs.FlashArt"}};if(this.audio){var e=[];this.audio.forEach(function(a){e.push(a.alias)}),b._audio={sounds:e}}var f=d.instance;f.load(b,function(b){var d=include(this.libName+"."+this.animClass),e=new d;e.framerate=this.fps;var g=new c({clip:e,width:this.width,height:this.height,display:this.display,captions:f.captions||null,audio:this.audio});g.addEventListener("destroy",function(){b._anim.destroy(),b._audio&&b._audio.destroy()}),a(g)}.bind(this))},g.destroy=function(){this.display=null,this.images=null,this.audio=null,f.destroy.call(this)},namespace("BackToSchool").CutsceneTask=e}(window),function(){var a=include("createjs.MovieClip"),b=new springroll.ApplicationPlugin;b.setup=function(){a.prototype.gotoAndPlayThenStop=function(a){var b=this;b.gotoAndPlay(a);for(var c=-1,d=0;d<b.labels.length;d++){var e=b.labels[d];if(e.label===a){c=d;break}}if(0>c);else var f=b.on("tick",function(){if(b.currentLabel!==a||b.paused){var d=b.currentFrame;c<b.labels.length-1?(c++,d=b.labels[c].position-1):d=b.duration-1,b.gotoAndStop(d),b.off("tick",f)}})}},b.teardown=function(){}}(),function(){var a=include("springroll.easeljs.BasePanel"),b=include("springroll.easeljs.BaseState"),c=include("springroll.DelayedCall"),d=function(b){a.call(this),this.skinObject=b},e=extend(d,a);e.setup=function(){this.skin=new this.skinObject,this.addChild(this.skin),this.homeButton=this.skin.instance.homeButton,this.homeButton.cursor="pointer",this.restartButton=this.skin.instance.restartButton,this.restartButton.cursor="pointer"},e.teardown=function(){a.prototype.teardown.call(this),this.background=null,this.homeButton=null,this.restartButton=null};var f=function(a){b.call(this,new d(a.skin),a),this.panel.state=this},g=extend(f,b);g.loaded=function(){},g.enterDone=function(){app.state=this,this.setActivitySpecificSettings(),$(this.panel.homeButton).on("click",app.onHomeTap),$(this.panel.restartButton).on("click",function(a){app.sound.play("home");var b=app.config.data.activityCodes[app.config.data.currentActivity]+"_replay",c=GA_obj.valueToPaddedString(app.config.data.consecutivePlays.count),d="Replays_"+c;GA_obj.trackEvent(b,d,app.config.data.consecutivePlays.count),app.state.nextState()}),app.homeButton&&(app.homeButton.visible=!1),app.state.timeoutCount=0,app.state.timeoutStartTime=0,app.state.startTimeout(),app.sound.play("ta-dahscene"),app.sound.play("gameplay_music"),app.state.enableMouseOvers(),app.state.enableMouseOuts(),app.config.data.currentScreen=app.config.data.activityCodes[app.config.data.currentActivity]+"_Complete"},g.setActivitySpecificSettings=function(){if(this.panel.skin.instance.photo)this.panel.skin.instance.photo.jack.head.gotoAndStop(app.config.data.boyCostume[0]+1),this.panel.skin.instance.photo.jack.body.gotoAndStop(app.config.data.boyCostume[1]+1),this.panel.skin.instance.photo.jack.feet.gotoAndStop(app.config.data.boyCostume[2]+1),this.panel.skin.instance.photo.jill.head.gotoAndStop(app.config.data.girlCostume[0]+1),this.panel.skin.instance.photo.jill.body.gotoAndStop(app.config.data.girlCostume[1]+1),this.panel.skin.instance.photo.jill.feet.gotoAndStop(app.config.data.girlCostume[2]+1);else if(this.panel.skin.instance.towers){this.panel.skin.instance.towers.gotoAndStop(app.config.data.blockTowerDesign);for(var a="blocks"+(app.config.data.blockTowerDesign+1),b=0;b<app.config.data.blockTowerAltColors.length;b++){var c="block_"+(b+1);this.panel.skin.instance.towers._updateTimeline(),this.panel.skin.instance.towers[a]._updateTimeline(),this.panel.skin.instance.towers[a][c]._updateTimeline(),app.config.data.blockTowerAltColors[b]===!0?this.panel.skin.instance.towers[a][c].gotoAndStop(5):this.panel.skin.instance.towers[a][c].gotoAndStop(1)}}else app.voPlayer.play("BTS _94")},g.enableMouseOvers=function(){$(this.panel.restartButton).on("mouseover",function(){app.state.panel.restartButton.scaleX=1.1,app.state.panel.restartButton.scaleY=1.1,(app.voPlayer.playing!==!0||-1!==app.voPlayer.voList.indexOf("BTS_53"))&&app.voPlayer.play("BTS_52")}),$(this.panel.homeButton).on("mouseover",function(){app.state.panel.homeButton.scaleX=1.1,app.state.panel.homeButton.scaleY=1.1,(app.voPlayer.playing!==!0||-1!==app.voPlayer.voList.indexOf("BTS_52"))&&app.voPlayer.play("BTS_53")})},g.enableMouseOuts=function(){$(this.panel.restartButton).on("mouseout",function(){app.state.panel.restartButton.scaleX=1,app.state.panel.restartButton.scaleY=1}),$(this.panel.homeButton).on("mouseout",function(){app.state.panel.homeButton.scaleX=1,app.state.panel.homeButton.scaleY=1})},g.startTimeout=function(a){if("undefined"==typeof a&&(a=!0),this.timeout&&this.timeout.destroy(),a){if(app.state.timeoutCount>0){var b=Math.round((Date.now()-app.state.timeoutStartTime)/1e3);GA_obj.trackEvent("TOReEngage",app.config.data.currentScreen,b)}app.state.timeoutCount=0}else app.state.timeoutCount+=1;this.timeout=new c(function(){var a,b;if(app.voPlayer.playing===!0)return void app.state.startTimeout(!0);var c=[];c.push("BTS_48"),c.push(500),c.push("BTS_49"),app.voPlayer.play(c,function(){app.state.startTimeout(!1)}),createjs.Tween.get(app.state.panel.restartButton).to({scaleX:1.1,scaleY:1.1},200).wait(1300).to({scaleX:1,scaleY:1},200),createjs.Tween.get(app.state.panel.homeButton).wait(1500).to({scaleX:1.1,scaleY:1.1},200).wait(1300).to({scaleX:1,scaleY:1},200),app.state.timeoutStartTime=Date.now(),a=GA_obj.valueToPaddedString(app.state.timeoutCount+1),b=app.config.data.currentScreen+" Timeout_"+a,GA_obj.trackEvent("TimeoutPlay",b)},1e4)},g.goToState=function(a){var b=this._nextState;this._nextState=a,this.nextState(),this._nextState=b},g.exitStart=function(){app.homeButton&&(app.homeButton.visible=!0),app.state.timeout&&app.state.timeout.destroy(),$(app.state.panel.homeButton).off("mouseover"),$(app.state.panel.homeButton).off("mouseout"),$(app.state.panel.restartButton).off("mouseover"),$(app.state.panel.restartButton).off("mouseout"),app.voPlayer.stop(),app.state.timeoutCount=0,app.state.timeoutStartTime=0,createjs.Tween.removeTweens(app.state.panel.restartButton),createjs.Tween.removeTweens(app.state.panel.homeButton),app.sound.stop("gameplay_music")},g.exit=function(){},namespace("BackToSchool").ActivityEndPanel=d,namespace("BackToSchool").ActivityEndState=f}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){function a(a,b,c,d){this.block=a,this.block.mouseChildren=!1,this.block.block=this,this.alternateColor=d,this.expand(),this.required=b,this.spots=c,this.block.cursor="pointer",$(this.block).on("mousedown",this.dragStart.bind(this)),$(this.block).on("pressup",this.onRelease.bind(this)),this.placedSpot=null,this.originalPosition={x:this.block.x,y:this.block.y},this.block.y=-300,this.isDragged=!1,$(app.display.stage).on("stagemousemove",this.tick.bind(this))}var b=include("springroll.easeljs.BasePanel"),c=include("springroll.easeljs.BaseState"),d=include("springroll.DelayedCall"),e=function(){b.call(this)},f=extend(e,b);f.setup=function(){this.structureIndex=app.config.blockGameData.structureOrder[0],app.config.blockGameData.structureOrder.push(app.config.blockGameData.structureOrder.shift()),app.config.data.blockTowerDesign=this.structureIndex-1,this.structureData=app.config.blockGameData.blockLists[this.structureIndex-1],this.skin=new lib.blockGame,this.addChild(this.skin),this.skin.gotoAndStop(1),this.skin.instance.gotoAndStop(this.structureIndex),this.skin.instance["blocks"+this.structureIndex].gotoAndStop(0);var b=this.skin.instance["blocks"+this.structureIndex].children;this.skin.instance["blockSlots"+this.structureIndex].gotoAndStop(0),this.blockSlots=this.skin.instance["blockSlots"+this.structureIndex].children;var c=0;for(c=0;c<this.blockSlots.length;c++)this.blockSlots[c].gotoAndStop(2),this.blockSlots[c].slotName=app.config.blockGameData.slotNames[this.structureIndex-1][c];for(this.structureDropArea=this.skin.instance["blockSlots"+this.structureIndex].nominalBounds,this.allBlocks=[],c=0;c<this.structureData.length;c++){for(var d=[],e=[],f=0;f<this.structureData[c].requiredSlots.length;f++)try{d.push(this.blockSlots[this.structureData[c].requiredSlots[f]])}catch(g){continue}for(var h=0;h<this.structureData[c].potentialSpots.length;h++)e.push(this.blockSlots[this.structureData[c].potentialSpots[h]]);var i=new a(b[this.structureData[c].childIndex],d,e,!1);this.allBlocks.push(i)}this.arm=this.skin.instance.timmyArm;var j=this.skin.instance.globalToLocal(1524,530);this.arm.x=j.x,this.arm.y=j.y},f.teardown=function(){b.prototype.teardown.call(this),this.background=null,this.backButton=null,this.outlineContainer=null,this.blockOutline=null,this.blockPools=null,this.blockSpots=null,this.stoplight=null};var g=function(a){c.call(this,new e,a)},h=extend(g,c);h.loaded=function(){},h.enterDone=function(){app.state=this,this.placedBlocks=[],app.config.data.blockTowerAltColors=[],this.availableBlocks=[],this.otherTurn=!1,this.otherTurnDelay=null,this.actionCount=0,this.interactionLocked=!0,this.holdingBlock=!1,this.firstEncouragementFired=!1,app.state.timeoutCount=0,app.state.timeoutStartTime=0,app.config.data.currentScreen="Blocks";var a=["BTS_130","BTS_132","BTS_133","BTS_131"],b=[500,"BTS_42",a[this.panel.structureIndex-1],200,"BTS_43"];app.voPlayer.play(b,function(){app.sound.play("gameplay_music"),app.state.startTimeout()},!0),app.state.calculateAvailableBlocks(),app.state.placeAvailableBlocks(),app.state.interactionLocked=!1,"blocks"!==app.config.data.consecutivePlays.activity?(app.config.data.consecutivePlays.activity="blocks",app.config.data.consecutivePlays.count=1):(app.config.data.consecutivePlays.count+=1,app.config.data.totalPlays.blocks+=1)},h.blockReleased=function(a){var b=a.getClosestSpot();a.getIsOverBlueprint()===!0?this.placeBlock(a,b):a["return"]()},h.calculateAvailableBlocks=function(){for(var a=0;a<this.panel.allBlocks.length;a++){var b=this.panel.allBlocks[a];if(this.placedBlocks.indexOf(b)<0&&this.availableBlocks.indexOf(b)<0){for(var c=!0,d=0;d<b.required.length;d++)if("undefined"==typeof b.required[d].filled||b.required[d].filled===!1){c=!1;break}c&&this.availableBlocks.push(b)}}1===this.availableBlocks.length&&this.otherTurn&&this.makeClone(this.availableBlocks[0])},h.placeAvailableBlocks=function(){for(var a,b,c=0;c<this.availableBlocks.length;c++){var d=(c-(this.availableBlocks.length-1)/2,this.availableBlocks[c]);0===c?(a=150+d.block.nominalBounds.width/2,b=20+d.block.nominalBounds.height/2):d.block.nominalBounds.width+this.availableBlocks[c-1].block.x+this.availableBlocks[c-1].block.nominalBounds.width<450?(a=a+this.availableBlocks[c-1].block.nominalBounds.width+50,b=b):(a=50+d.block.nominalBounds.width/2,b=b+this.availableBlocks[c-1].block.nominalBounds.height+50),createjs.Tween.get(d.block).to({x:a,y:b},800,createjs.Ease.cubicOut)}app.state.startTimeout()},h.placeBlock=function(a,b){if(this.placedBlocks.push(a),this.availableBlocks.splice(this.availableBlocks.indexOf(a),1),a.setSpot(b),this.destroyClone(),this.calculateAvailableBlocks(),app.state.availableBlocks.length>0&&(app.state.otherTurn?app.state.playEncouragement(!1):(app.state.playEncouragement(!0),this.interactionLocked=!0)),!this.otherTurn&&this.availableBlocks.length>0)var c=this.availableBlocks[0];var d=b.parent.localToLocal(b.x,b.y,a.block.parent);createjs.Tween.get(a.block).to({x:d.x,y:d.y},800,createjs.Ease.cubicOut).call(function(){app.state.availableBlocks.length>0?app.state.otherTurn?(app.state.otherTurn=!1,app.state.placeAvailableBlocks()):(app.state.placeAvailableBlocks(),app.state.doOtherTurn(c)):(app.sound.play("blocksuccess"),app.voPlayer.play(["BTS_44",500],function(){app.state.nextState()},!0))})},h.playEncouragement=function(a){return this.actionCount+=1,this.firstEncouragementFired||a||app.voPlayer.playing?void(this.actionCount%3===1&&app.voPlayer.playing!==!0&&(a?(app.voPlayer.play(app.config.blockGameData.playerEncouragement[0]),app.config.blockGameData.playerEncouragement.push(app.config.blockGameData.playerEncouragement.shift())):(app.voPlayer.play(app.config.blockGameData.timmyEncouragement[0]),app.config.blockGameData.timmyEncouragement.push(app.config.blockGameData.timmyEncouragement.shift())))):(app.voPlayer.play("BTS_98"),void(this.firstEncouragementFired=!0))},h.doOtherTurn=function(a){app.state.otherTurnDelay=new d(function(){this.otherTurn=!0;for(var b=null,c=0;c<a.spots.length;c++)if(!("filled"in a.spots[c])){b=a.spots[c];break}var d=a.block.parent.localToLocal(a.block.x,a.block.y,this.panel.arm.parent),e={x:this.panel.arm.x,y:this.panel.arm.y},f={x:d.x,y:d.y},g=b.parent.localToLocal(b.x,b.y,this.panel.arm.parent);createjs.Tween.get(this.panel.arm).to({x:f.x,y:f.y},800,createjs.Ease.cubicOut).call(function(){app.state.placeBlock(a,b)}).to({x:g.x,y:g.y},800,createjs.Ease.cubicOut).to({x:e.x,y:e.y},800,createjs.Ease.cubicOut).call(function(){app.state.interactionLocked=!1})}.bind(this),800)},h.makeClone=function(b){var c=app.config.blockGameData.blockLists[this.panel.structureIndex-1][this.panel.allBlocks.indexOf(b)],d=this.panel.skin.instance["blockSlots"+this.panel.structureIndex].children,e=c.constructorName,f=new lib[e];f.scaleX=b.block.scaleX,f.scaleY=b.block.scaleY,f.regX=b.block.regX,f.regY=b.block.regY,this.panel.skin.instance["blocks"+this.panel.structureIndex].addChild(f);for(var g=[],h=[],i=0;i<c.requiredSlots.length;i++)try{g.push(d[c.requiredSlots[i]])}catch(j){continue}for(var k=0;k<c.potentialSpots.length;k++)h.push(this.panel.skin.instance["blockSlots"+this.panel.structureIndex].children[c.potentialSpots[k]]);var l=new a(f,g,h,!0);this.panel.allBlocks.push(l),this.availableBlocks.push(l)},h.destroyClone=function(){for(var a=0;a<this.availableBlocks.length;a++){var b=!0;null!==this.availableBlocks[a].placedSpot&&(b=!1);for(var c=0;c<this.availableBlocks[a].spots.length;c++)("undefined"==typeof this.availableBlocks[a].spots[c].filled||this.availableBlocks[a].spots[c].filled===!1)&&(b=!1);if(b){var d=this.availableBlocks[a];return createjs.Tween.get(d.block).to({x:d.block.x,y:-400},800,createjs.Ease.cubicOut),this.placedBlocks.push(d),void this.availableBlocks.splice(a,1)}}},h.startTimeout=function(a){if("undefined"==typeof a&&(a=!0),this.timeout&&this.timeout.destroy(),a){if(app.state.timeoutCount>0){var b=Math.round((Date.now()-app.state.timeoutStartTime)/1e3);GA_obj.trackEvent("TOReEngage",app.config.data.currentScreen,b)}app.state.timeoutCount=0}else app.state.timeoutCount+=1;this.timeout=new d(function(){if(app.voPlayer.playing===!0)return void app.state.startTimeout(!1);if(app.hasTouch)app.voPlayer.play(["BTS_45"]),app.state.pulseBlocks(),app.state.startTimeout(!1);else{for(var a=!1,b=0;b<app.state.availableBlocks.length;b++)app.state.availableBlocks[b].isDragged&&(a=!0);a?app.voPlayer.play(["BTS_47"]):(app.voPlayer.play(["BTS_46"]),app.state.pulseBlocks()),app.state.startTimeout(!1)}app.state.timeoutCount<1&&(app.state.timeoutStartTime=Date.now());var c=GA_obj.valueToPaddedString(app.state.timeoutCount+1),d=app.config.data.currentScreen+" Timeout_"+c;GA_obj.trackEvent("TimeoutPlay",d)},1e4)},h.pulseBlocks=function(){for(var a=0;a<app.state.availableBlocks.length;a++)createjs.Tween.get(app.state.availableBlocks[a]).call(function(){this.highlight()}).wait(2e3).call(function(){null!==this.placedSpot||this.isDragged===!0?this.flatten():this.expand()})},h.goToState=function(a){var b=this._nextState;this._nextState=a,this.nextState(),this._nextState=b},h.exitStart=function(){app.voPlayer.stop(),this.timeout&&this.timeout.destroy(),this.otherTurnDelay&&this.otherTurnDelay.destroy(),this.actionCount=0,this.firstEncouragementFired=!1,app.sound.stop("gameplay_music"),createjs.Tween.removeTweens(app.state.panel.arm);for(var a=0;a<app.state.availableBlocks.length;a++)createjs.Tween.removeTweens(app.state.availableBlocks[a]),createjs.Tween.removeTweens(app.state.availableBlocks[a].block)},h.exit=function(){},namespace("BackToSchool").BlockGamePanel=e,namespace("BackToSchool").BlockGameState=g,a.prototype.dragStart=function(a){this.isDragged||app.state.interactionLocked!==!1||app.state.holdingBlock!==!1||(this.originalPosition={x:this.block.x,y:this.block.y},this.clickTimer=a.timeStamp,this.placedSpot=null,this.flatten(),this.isDragged=!0,app.state.startTimeout(),app.sound.play("grabblock"),app.state.holdingBlock=!0)},a.prototype.tick=function(a){if(this.isDragged){var b=this.block.parent.globalToLocal(app.display.stage.mouseX,app.display.stage.mouseY);this.block.x=b.x,this.block.y=b.y,this.getIsOverBlueprint()===!0?this.highlight():this.flatten()}},a.prototype.onRelease=function(a){a.timeStamp-this.clickTimer<200||this.isDragged&&app.state.interactionLocked===!1&&(this.isDragged=!1,app.state.blockReleased(this),app.state.startTimeout(),app.sound.play("placeblock1"),app.state.holdingBlock=!1)},a.prototype["return"]=function(){this.expand();var a=this.originalPosition;createjs.Tween.get(this.block).to({x:a.x,y:a.y},800,createjs.Ease.cubicOut);var b=this.getClosestSpot().slotName,c=app.config.blockGameData.structureNames[app.state.panel.structureIndex-1]+" Block_"+b;GA_obj.trackEvent("Blocks WA Place",c,app.state.foundItems)},a.prototype.getDistance=function(a){var b=a.parent.localToLocal(a.x,a.y,this.block.parent);return Math.abs(b.x-this.block.x)+Math.abs(b.y-this.block.y)},a.prototype.getIsOverBlueprint=function(){var a=this.block.nominalBounds,b=app.state.panel.skin.instance["blockSlots"+app.state.panel.structureIndex],c=b.nominalBounds,d=this.block.parent.localToLocal(this.block.x,this.block.y,b);return d.x<c.x+c.width*b.scaleX+b.regX*b.scaleX&&d.x+a.width>c.x&&d.y<c.y+c.height*b.scaleY+b.regY*b.scaleY&&d.y+a.height>c.y},a.prototype.getClosestSpot=function(){for(var a=null,b=1e9,c=0;c<this.spots.length;c++){var d=this.spots[c],e=this.getDistance(d);b>e&&!("filled"in d)&&(b=e,a=d)}return a},a.prototype.flatten=function(){this.alternateColor===!0?this.block.gotoAndStop(4):this.block.gotoAndStop(0)},a.prototype.expand=function(){this.alternateColor===!0?this.block.gotoAndStop(5):this.block.gotoAndStop(1)},a.prototype.highlight=function(){this.alternateColor===!0?this.block.gotoAndStop(7):this.block.gotoAndStop(3)},a.prototype.scaleToSize=function(a){},a.prototype.setSpot=function(a){this.flatten(),this.placedSpot=a,this.placedSpot.filled=!0,this.block.mouseEnabled=!1,app.config.data.blockTowerAltColors[app.state.panel.blockSlots.indexOf(a)]=this.alternateColor;var b=app.config.blockGameData.structureNames[app.state.panel.structureIndex-1]+" Block_"+this.placedSpot.slotName;GA_obj.trackEvent("Blocks CA Place",b,app.state.foundItems)}}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){function a(a,b){this.cutscene=a,this.scenes=b}var b=include("springroll.easeljs.BasePanel"),c=include("springroll.easeljs.BaseState"),d=include("springroll.DelayedCall"),e=include("BackToSchool.Cutscene"),f=function(a,c,d){b.call(this),this.skinObject=a,this.cutsceneInfo=c,this.scenes=d},g=extend(f,b);g.setup=function(){var a="lib_"+this.scenes.choice;this.skin=new window[a][this.scenes.choice],this.addChild(this.skin),this.skin.framerate=24,this.skin.stop(),this.skin.visible=!1,this.buttons=[],this.buttons.push(this.skin.instance.option1),this.buttons.push(this.skin.instance.option2),this.buttons.push(this.skin.instance.option3);var b="lib_"+this.scenes.intro;this.cutscene=new window[b][this.scenes.intro],this.cutscene.framerate=24},g.teardown=function(){b.prototype.teardown.call(this),this.background=null,this.buttonContainer=null,this.buttons=null};var h=function(a){c.call(this,new f(a.skin,a.cutsceneInfo,a.scenes),a),this.panel.state=this,this.introVO=a.introVO,this.mouseOverVO=a.mouseOverVO,this.resolutionAudio=a.resolutionAudio,this.buttonClick=this.buttonClick.bind(this),this.choiceDelays=a.choiceDelays,this.playIntro=this.playIntro.bind(this),this.playSelectThree=this.playSelectThree.bind(this),this.playChoice=this.playChoice.bind(this),this.pulseChoices=this.pulseChoices.bind(this),this.startTimeout=this.startTimeout.bind(this)},i=extend(h,c);i.loaded=function(){},i.enterDone=function(){app.state=this,this.setButtonsVisible(!1),this.playIntro(),this.auditionCount=[0,0,0],this.buttonInitialScales=[0,0,0],app.state.timeoutCount=0,app.state.timeoutStartTime=0,app.config.data.currentScreen=app.config.data.activityCodes[app.config.data.currentActivity]+"_Help"},i.playIntro=function(){this.introCutscene=new e({clip:this.panel.cutscene,parent:this.panel.cutscene,width:1320,height:780,display:app.display,audio:[{start:0,alias:this.introVO[0],sync:!0}],functions:[]}),this.panel.addChild(this.introCutscene),this.introCutscene.start(function(){app.state.playSelectThree()})},i.playSelectThree=function(){this.panel.cutscene.stop(),this.panel.cutscene.visible=!1,this.panel.skin.visible=!0,this.panel.skin.play(),app.sound.play("thoughtbubblesappear"),this.setButtonsVisible(!0);for(var a=0;a<this.panel.buttons.length;a++){var b=this.panel.buttons[a];b.mouseChildren=!1,b.state=this,b.cursor="pointer",$(b).on("click",this.buttonClick);b.scaleX}this.buttonDelay=new d(function(){this.panel.skin.gotoAndStop("end"),this.pulseChoices()}.bind(this),2500),this.voPlayer.play(this.introVO[1],function(){for(var a=0;a<this.panel.buttons.length;a++){var b=this.panel.buttons[a];this.buttonInitialScales[a]=b.scaleX,$(b).on("mouseover",this.mouseOverButton.bind(this)),$(b).on("mouseout",this.mouseOutButton.bind(this)),app.state.startTimeout()}}.bind(this))},i.playChoice=function(a){var b="lib_"+this.panel.scenes.resolutions[a];this.panel.removeChild(this.panel.cutscene),this.panel.cutscene=null,this.panel.helpCutscene=new window[b][this.panel.scenes.resolutions[a]],this.panel.helpCutscene.framerate=24,this.panel.helpCutscene.visible=!0,this.cutsceneObject=new e({clip:this.panel.helpCutscene,parent:this.panel.helpCutscene,width:1320,height:780,display:app.display,audio:this.resolutionAudio[a],functions:[]}),this.panel.addChild(this.cutsceneObject),this.scaling.removeItems(this.panel,this.scalingItems),this.scaling.addItems(this.panel,this.scalingItems),this.cutsceneObject.start(function(){app.state.onChoiceComplete()}),app.state.timeout&&app.state.timeout.destroy();var c=app.config.data.activityCodes[app.config.data.currentActivity]+"_help",d=app.config.data.pickThreeOptions[app.config.data.currentActivity][a];GA_obj.trackEvent(c,d)},i.onChoiceComplete=function(){app.state.nextState()},i.mouseOverButton=function(a){var b=this.panel.buttons.indexOf(a.target);if(this.panel.buttons[b].scaleX=this.buttonInitialScales[b]+.1,this.panel.buttons[b].scaleY=this.buttonInitialScales[b]+.1,!(app.voPlayer.playing&&app.voPlayer.voList.indexOf(this.mouseOverVO[b])>-1)){this.auditionCount[b]+=1;var c=app.config.data.activityCodes[app.config.data.currentActivity]+"_audition",d=app.config.data.pickThreeOptions[app.config.data.currentActivity][b];GA_obj.trackEvent(c,d,this.auditionCount[b]),app.voPlayer.play(this.mouseOverVO[b])}},i.mouseOutButton=function(a){var b=this.panel.buttons.indexOf(a.target);this.panel.buttons[b].scaleX=this.buttonInitialScales[b],this.panel.buttons[b].scaleY=this.buttonInitialScales[b]},i.setButtonsVisible=function(a){for(var b=0;b<this.panel.buttons.length;b++)this.panel.buttons[b].visible=a},i.unbindButtonEvents=function(){for(var a=0;a<this.panel.buttons.length;a++)this.panel.buttons[a].mouseEnabled=!1},i.buttonClick=function(a){var b=this.panel.buttons.indexOf(a.target);this.setButtonsVisible(!1),this.unbindButtonEvents(),a.target.visible=!0,app.sound.play("choosebubble"),app.voPlayer.stop(),app.state.startTimeout(!0),app.state.buttonDelay&&app.state.buttonDelay.destroy(),this.playChoice(b)},i.pulseChoices=function(a){"undefined"==typeof a&&(a=0);for(var b=0;b<this.panel.buttons.length;b++){var c=this.panel.buttons[b],d=c.scaleX;createjs.Tween.get(c,{override:!0}).wait(this.choiceDelays[b]+a).to({scaleX:d+.1,scaleY:d+.1},200).wait(500).to({scaleX:d,scaleY:d},200)}},i.startTimeout=function(a){if("undefined"==typeof a&&(a=!0),this.timeout&&this.timeout.destroy(),a){if(app.state.timeoutCount>0){var b=Math.round((Date.now()-app.state.timeoutStartTime)/1e3);GA_obj.trackEvent("TOReEngage",app.config.data.currentScreen,b)}app.state.timeoutCount=0}else app.state.timeoutCount+=1;this.timeout=new d(function(){var a,b;if(app.voPlayer.playing===!0)return void app.state.startTimeout(!0);var c=[];app.state.timeoutCount>0&&("ispy"===app.config.data.currentActivity?c.push("BTS_81"):"dressup"===app.config.data.currentActivity?c.push("BTS_59"):"blocks"===app.config.data.currentActivity&&c.push("BTS_31"),app.state.pulseChoices(2e3)),app.hasTouch?c.push("BTS_29"):c.push("BTS_30"),app.voPlayer.play(c,function(){app.state.startTimeout(!1)}),app.state.timeoutStartTime=Date.now(),a=GA_obj.valueToPaddedString(app.state.timeoutCount+1),b=app.config.data.currentScreen+" Timeout_"+a,GA_obj.trackEvent("TimeoutPlay",b)}.bind(this),1e4)},i.exitStart=function(){for(var a=0;a<this.panel.buttons.length;a++){var b=this.panel.buttons[a];$(b).off("mouseover"),$(b).off("mouseout"),createjs.Tween.removeTweens(b)}this.buttonDelay&&this.buttonDelay.destroy(),this.panel.helpCutscene&&(this.panel.helpCutscene=null),app.state.timeout&&app.state.timeout.destroy()},i.exit=function(){},a.prototype.play=function(a){this.cutscene.visible=!0;for(var b=0,c=0;c<this.scenes.length;c++){var d=this.scenes[c];createjs.Tween.get(this).wait(b).call(this.playScene,[d],this),b+=d.length+d.post}createjs.Tween.get(this).wait(b).call(a)},a.prototype.playScene=function(a){this.cutscene.gotoAndStop(a.frame),""!==a.audio&&app.voPlayer.play(a.audio)},namespace("BackToSchool").ChooseThreePanel=f,namespace("BackToSchool").ChooseThreeState=h}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){function a(a){this.index=-1,this.item=a,this.item.hitArea=a.paddedHitArea,a.paddedHitArea.visible=!1,this.shadow=a.shadow,this.costume=a.item,this.highlight=a.highlight,this.setHighlight(!1),this.item.mouseChildren=!1,this.item.on("mousedown",this.dragStart.bind(this)),app.display.stage.on("stagemousemove",this.tick.bind(this)),app.display.stage.on("stagemouseup",this.onRelease.bind(this)),this.originalPosition={x:this.item.x,y:this.item.y},this.initialScale={x:this.item.scaleX,y:this.item.scaleY},this.isDragged=!1}function b(a,b,c,d){this.body=a,this.hat=b,this.suit=c,this.shoes=d,this.body.mouseChildren=!1,this.body.character=this;for(var e=0;e<this.body.children.length;e++)this.body.children[e].mouseEnabled=!1;var f=new createjs.Shape;f.graphics.beginFill("#000").drawRect(-100,-250,200,500),this.body.hitArea=f,this.hat.mouseEnabled=!1,this.suit.mouseEnabled=!1,this.shoes.mouseEnabled=!1,
this.hat.visible=!1,this.suit.visible=!1,this.shoes.visible=!1,this.hovered=!1}var c=include("springroll.easeljs.BasePanel"),d=include("springroll.easeljs.BaseState"),e=include("springroll.DelayedCall"),f=function(){c.call(this)},g=extend(f,c);g.setup=function(){this.skin=new lib_dressUpGame.dressUpGame,this.addChild(this.skin),this.skin.gotoAndStop(0),this.girl=new b(this.skin.instance.jill,this.skin.instance.girlHat,this.skin.instance.girlSuit,this.skin.instance.girlShoes),this.boy=new b(this.skin.instance.jack,this.skin.instance.boyHat,this.skin.instance.boySuit,this.skin.instance.boyShoes),this.hatChoices=[],this.hatChoices.push(new a(this.skin.instance.hatOption1)),this.hatChoices.push(new a(this.skin.instance.hatOption2)),this.hatChoices.push(new a(this.skin.instance.hatOption3)),this.hatChoices.push(new a(this.skin.instance.hatOption4)),this.suitChoices=[],this.suitChoices.push(new a(this.skin.instance.suitOption1)),this.suitChoices.push(new a(this.skin.instance.suitOption2)),this.suitChoices.push(new a(this.skin.instance.suitOption3)),this.suitChoices.push(new a(this.skin.instance.suitOption4)),this.shoeChoices=[],this.shoeChoices.push(new a(this.skin.instance.shoeOption1)),this.shoeChoices.push(new a(this.skin.instance.shoeOption2)),this.shoeChoices.push(new a(this.skin.instance.shoeOption3)),this.shoeChoices.push(new a(this.skin.instance.shoeOption4))},g.teardown=function(){c.prototype.teardown.call(this),this.background=null,this.backButton=null};var h=function(a){d.call(this,new f,a)},i=extend(h,d);i.loaded=function(){},i.enterDone=function(){app.state=this,app.config.data.currentScreen="Dress-up",this.currentItem=0,this.actionCount=0,this.rejectedItems=0,app.state.timeoutCount=0,app.state.timeoutStartTime=0,this.holdingCostume=!1,this.currentCostumes=this.getNewCostumeSet(),app.config.dressupGameData.lastSet=this.currentCostumes,app.config.data.dressUpPlaythroughs+=1,this.setChoicesVisible(this.panel.hatChoices,!1),this.setChoicesVisible(this.panel.suitChoices,!1),this.setChoicesVisible(this.panel.shoeChoices,!1),this.setCostumeChoices(this.panel.hatChoices),this.setCostumeChoices(this.panel.suitChoices),this.setCostumeChoices(this.panel.shoeChoices),app.state.setChoicesVisible(app.state.panel.hatChoices,!0),app.voPlayer.play(["BTS_70",400],function(){app.sound.play("gameplay_music"),app.voPlayer.play("BTS_71"),app.state.startTimeout()},!0),"dressup"!==app.config.data.consecutivePlays.activity?(app.config.data.consecutivePlays.activity="dressup",app.config.data.consecutivePlays.count=1):(app.config.data.consecutivePlays.count+=1,app.config.data.totalPlays.dressup+=1)},i.getNewCostumeSet=function(){var a=[],b=0,c=[];for(b=0;b<app.config.dressupGameData.allCostumeChoices.length;b++)app.config.dressupGameData.lastSet.indexOf(app.config.dressupGameData.allCostumeChoices[b])>-1||a.push(app.config.dressupGameData.allCostumeChoices[b]);for(app.shuffle(a);c.length<4;)6!==a[0]&&8!==a[0]||!(c.indexOf(6)>-1||c.indexOf(8)>-1)?c.push(a.shift()):a.shift();return c},i.setCostumeChoices=function(a){for(var b=0;b<a.length;b++)a[b].setCostume(this.currentCostumes[b])},i.setChoicesVisible=function(a,b){for(var c=0;c<a.length;c++)a[c].setVisible(b)},i.checkHoveredCharacters=function(a,b){var c=app.display.stage.getObjectsUnderPoint(a,b,1);c.indexOf(this.panel.boy.body)>-1?(this.panel.boy.hovered=!0,this.panel.girl.hovered=!1):c.indexOf(this.panel.girl.body)>-1?(this.panel.boy.hovered=!1,this.panel.girl.hovered=!0):(this.panel.boy.hovered=!1,this.panel.girl.hovered=!1)},i.getHoveredCharacter=function(a){var b=a.item.parent.localToGlobal(a.item.x,a.item.y);return this.panel.boy.isHovered(b.x,b.y)?this.panel.boy.hasItem(this.currentItem)?!1:this.panel.boy:this.panel.girl.isHovered(b.x,b.y)?this.panel.girl.hasItem(this.currentItem)?!1:this.panel.girl:null},i.costumeDragEnd=function(a){var b,c=this.getHoveredCharacter(a);if(null===c)a["return"]();else if(c===!1){app.sound.play("wrong"),app.state.rejectedItems+=1;var d=GA_obj.valueToPaddedString(app.state.rejectedItems);b="Rejects_"+d,GA_obj.trackEvent("Dress-up Rejected",b,app.state.rejectedItems),a["return"]()}else this.playEncouragement(),app.sound.play("clothesappear"),b=a.itemName+"_0"+(this.currentItem+1),GA_obj.trackEvent("Dress-up Place",b),a.setVisible(!1),c.placeItem(this.currentItem,a.index),this.panel.girl.hasItem(this.currentItem)&&this.panel.boy.hasItem(this.currentItem)&&this.nextItem()},i.nextItem=function(){0===this.currentItem?(this.setChoicesVisible(this.panel.hatChoices,!1),this.setChoicesVisible(this.panel.suitChoices,!0)):1===this.currentItem?(this.setChoicesVisible(this.panel.suitChoices,!1),this.setChoicesVisible(this.panel.shoeChoices,!0)):(this.setChoicesVisible(this.panel.shoeChoices,!1),app.voPlayer.play(["BTS_72",400],function(){app.config.data.boyCostume=[app.state.panel.boy.hat.currentFrame,app.state.panel.boy.suit.currentFrame,app.state.panel.boy.shoes.currentFrame],app.config.data.girlCostume=[app.state.panel.girl.hat.currentFrame,app.state.panel.girl.suit.currentFrame,app.state.panel.girl.shoes.currentFrame],app.state.nextState()},!0)),this.currentItem++},i.startTimeout=function(a){if("undefined"==typeof a&&(a=!0),this.timeout&&this.timeout.destroy(),a){if(app.state.timeoutCount>0){var b=Math.round((Date.now()-app.state.timeoutStartTime)/1e3);GA_obj.trackEvent("TOReEngage",app.config.data.currentScreen,b)}app.state.timeoutCount=0}else app.state.timeoutCount+=1;this.timeout=new e(function(){if(app.voPlayer.playing===!0)return void app.state.startTimeout(!1);var a=[];app.hasTouch?(a.push("BTS_73"),a.push(app.state.getAvailableCharacterVo(!1)),app.voPlayer.play(a),app.state.pulseCostumes(),app.state.startTimeout(!1)):(app.state.isCostumeBeingDragged()?(a.push("BTS_75"),a.push(app.state.getAvailableCharacterVo(!0)),app.voPlayer.play(a)):(a.push("BTS_74"),a.push(app.state.getAvailableCharacterVo(!1)),app.voPlayer.play(a),app.state.pulseCostumes()),app.state.startTimeout(!1)),app.state.timeoutCount<1&&(app.state.timeoutStartTime=Date.now());var b=GA_obj.valueToPaddedString(app.state.timeoutCount+1),c=app.config.data.currentScreen+" Timeout_"+b;GA_obj.trackEvent("TimeoutPlay",c)},1e4)},i.getAvailableCharacterVo=function(a){var b;return this.panel.girl.hasItem(this.currentItem)?a?"BTS_122":(b=["BTS_124","BTS_126","BTS_128"],b[this.currentItem]):a?"BTS_123":(b=["BTS_125","BTS_127","BTS_129"],b[this.currentItem])},i.getCurrentVisibleChoices=function(){var a;return a=0===this.currentItem?this.panel.hatChoices:1===this.currentItem?this.panel.suitChoices:this.panel.shoeChoices},i.isCostumeBeingDragged=function(){for(var a=app.state.getCurrentVisibleChoices(),b=0;b<a.length;b++)if(a[b].isDragged)return!0;return!1},i.pulseCostumes=function(){for(var a=app.state.getCurrentVisibleChoices(),b=0;b<a.length;b++)createjs.Tween.get(a[b]).call(function(){this.setHighlight(!0)}).wait(2e3).call(function(){this.setHighlight(!1)})},i.playEncouragement=function(){this.actionCount+=1,this.actionCount%3===1&&app.voPlayer.playing!==!0&&(app.voPlayer.play(app.config.dressupGameData.playerEncouragement[0]),app.config.dressupGameData.playerEncouragement.push(app.config.dressupGameData.playerEncouragement.shift()))},i.goToState=function(a){var b=this._nextState;this._nextState=a,this.nextState(),this._nextState=b},i.exitStart=function(){this.timeout&&this.timeout.destroy(),this.rejectedItems=0,this.actionCount=0,$(this.panel.homeButton).off("click"),app.sound.stop("gameplay_music");for(var a=app.state.getCurrentVisibleChoices(),b=0;b<a.length;b++)createjs.Tween.removeTweens(a[b]),createjs.Tween.removeTweens(a[b].item)},i.exit=function(){},a.prototype.dragStart=function(a){this.isDragged||app.state.holdingCostume!==!1||(this.item.mouseEnabled=!1,this.originalPosition={x:this.item.x,y:this.item.y},this.clickTimer=a.timeStamp,this.showShadow(!1),this.isDragged=!0,createjs.Tween.get(this.item).to({scaleX:1.3*this.initialScale.x,scaleY:1.3*this.initialScale.y},500,createjs.Ease.cubicOut),app.state.startTimeout(),app.sound.play("touchcostume"),app.state.holdingCostume=!0)},a.prototype.tick=function(a){if(this.isDragged){app.state.checkHoveredCharacters(app.display.stage.mouseX,app.display.stage.mouseY);var b=this.item.parent.globalToLocal(app.display.stage.mouseX,app.display.stage.mouseY);this.item.x=b.x,this.item.y=b.y,app.state.getHoveredCharacter(this)?this.setHighlight(!0):this.setHighlight(!1)}},a.prototype.onRelease=function(a){this.isDragged&&(a.timeStamp-this.clickTimer<200||(this.isDragged=!1,this.item.mouseEnabled=!0,app.state.costumeDragEnd(this),app.state.startTimeout(),app.state.holdingCostume=!1))},a.prototype["return"]=function(){this.showShadow(!0);var a=this.originalPosition;createjs.Tween.get(this.item).to({scaleX:this.initialScale.x,scaleY:this.initialScale.y,x:a.x,y:a.y},800,createjs.Ease.cubicOut)},a.prototype.setCostume=function(a){this.index=a,this.shadow.gotoAndStop(a),this.costume.gotoAndStop(a),this.highlight.gotoAndStop(a),this.itemName=app.config.dressupGameData.costumeChoiceNames[this.costume.currentFrame]},a.prototype.setHighlight=function(a){this.highlight.visible=a},a.prototype.showShadow=function(a){this.shadow.visible=a},a.prototype.setVisible=function(a){this.item.visible=a},b.prototype.isHovered=function(){return this.hovered},b.prototype.getCostumePiece=function(a){return 0===a?this.hat:1===a?this.suit:2===a?this.shoes:null},b.prototype.hasItem=function(a){return this.getCostumePiece(a).visible},b.prototype.placeItem=function(a,b){var c=this.getCostumePiece(a);c.visible=!0,c.gotoAndStop(b)},namespace("BackToSchool").DressUpGamePanel=f,namespace("BackToSchool").DressUpGameState=h}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){function a(a,b,c){this.item=a,this.itemName=c,this.item.gotoAndStop(0),this.item.hitArea=this.item.hitbox,this.item.hitbox.visible=!1,this.item.iSpy=this,this.outline=b,this.outline.hitbox.visible=!1,$(this.item).on("mousedown",this.findItem.bind(this)),$(this.item).on("pressmove",this.drag.bind(this)),$(this.item).on("pressup",this.moveToOutline.bind(this))}var b=include("springroll.easeljs.BasePanel"),c=include("springroll.easeljs.BaseState"),d=function(){b.call(this)},e=extend(d,b);e.setup=function(){this.skin=new lib_iSpyGame.iSpyGame,this.addChild(this.skin),this.setupItems(),this.skin.stop(),app.config.data.iSpyPlaythroughs+=1},e.setupItems=function(){switch(app.config.ispyGameData.itemSetOrder[0]){case 0:this.skin.instance.toySet_1.visible=!0,this.skin.instance.toySet_2.visible=!1,this.skin.instance.toySet_3.visible=!1,this.skin.instance.toySet_4.visible=!1,this.addItems(this.skin.instance.toySet_1);break;case 1:this.skin.instance.toySet_1.visible=!1,this.skin.instance.toySet_2.visible=!0,this.skin.instance.toySet_3.visible=!1,this.skin.instance.toySet_4.visible=!1,this.addItems(this.skin.instance.toySet_2);break;case 2:this.skin.instance.toySet_1.visible=!1,this.skin.instance.toySet_2.visible=!1,this.skin.instance.toySet_3.visible=!0,this.skin.instance.toySet_4.visible=!1,this.addItems(this.skin.instance.toySet_3);break;case 3:this.skin.instance.toySet_1.visible=!1,this.skin.instance.toySet_2.visible=!1,this.skin.instance.toySet_3.visible=!1,this.skin.instance.toySet_4.visible=!0,this.addItems(this.skin.instance.toySet_4)}app.config.ispyGameData.itemSetOrder.push(app.config.ispyGameData.itemSetOrder.shift())},e.addItems=function(b){for(this.items=[],this.items.push(new a(b.toy1_hidden,b.toy1,app.config.ispyGameData.itemSetNames[app.config.ispyGameData.itemSetOrder[0]][0])),this.items.push(new a(b.toy2_hidden,b.toy2,app.config.ispyGameData.itemSetNames[app.config.ispyGameData.itemSetOrder[0]][1])),this.items.push(new a(b.toy3_hidden,b.toy3,app.config.ispyGameData.itemSetNames[app.config.ispyGameData.itemSetOrder[0]][2])),this.items.push(new a(b.toy4_hidden,b.toy4,app.config.ispyGameData.itemSetNames[app.config.ispyGameData.itemSetOrder[0]][3])),b.toy5&&this.items.push(new a(b.toy5_hidden,b.toy5,app.config.ispyGameData.itemSetNames[app.config.ispyGameData.itemSetOrder[0]][4])),i=0;i<this.items.length;i++)this.skin._updateTimeline(),b._updateTimeline(),this.items[i].outline._updateTimeline(),this.items[i].setFrame()},e.teardown=function(){b.prototype.teardown.call(this),this.background=null,this.backButton=null,this.items=null};var f=function(a){c.call(this,new d,a)},g=extend(f,c);g.loaded=function(){},g.enterDone=function(){app.state=this,this.foundItems=0,this.incorrectItems=0,this.actionCount=0,this.timeoutCount=0,app.state.timeoutStartTime=0,app.config.data.currentScreen="Show-and-Tell",this.setIncorrectAnswers(),"ispy"!==app.config.data.consecutivePlays.activity?(app.config.data.consecutivePlays.activity="ispy",app.config.data.consecutivePlays.count=1):(app.config.data.consecutivePlays.count+=1,app.config.data.totalPlays.ispy+=1);var a=0;if(app.config.data.consecutivePlays.count<2){for(a=0;a<app.state.panel.items.length;a++)app.state.panel.items[a].setFrame();app.voPlayer.play(["BTS_92",300],function(){app.state.pulseBox(),app.state.startTimeout(!0),app.voPlayer.play(["BTS_93"]),app.sound.play("gameplay_music")},!0)}else{for(app.voPlayer.play("BTS_92"),a=0;a<app.state.panel.items.length;a++)app.state.panel.items[a].setFrame();app.state.pulseBox(),app.state.startTimeout(!0),app.sound.play("gameplay_music")}},g.setIncorrectAnswers=function(){this.panel.waList=[{item:this.panel.skin.instance.wa_guitar,name:"Guitar"},{item:this.panel.skin.instance.wa_beachball,name:"Beach Ball"},{item:this.panel.skin.instance.wa_bat,name:"Bat"},{item:this.panel.skin.instance.wa_globe,name:"Globe"},{item:this.panel.skin.instance.wa_backpack,name:"Backpack"},{item:this.panel.skin.instance.wa_backpack2,name:"Backpack"},{item:this.panel.skin.instance.wa_garage,name:"Garage"},{item:this.panel.skin.instance.wa_calendar,name:"Calendar"},{item:this.panel.skin.instance.wa_vase,name:"Flower Vase"},{item:this.panel.skin.instance.wa_blocks,name:"Blocks"},{item:this.panel.skin.instance.wa_hat,name:"Hat"},{item:this.panel.skin.instance.wa_clay,name:"Clay"},{item:this.panel.skin.instance.wa_dogdrawing,name:"Dog Drawing"},{item:this.panel.skin.instance.wa_toycar1,name:"Toy Car"},{item:this.panel.skin.instance.wa_toycar2,name:"Toy Car"},{item:this.panel.skin.instance.wa_tree1,name:"Tree"},{item:this.panel.skin.instance.wa_tree2,name:"Tree"},{item:this.panel.skin.instance.wa_tree3,name:"Tree"},{item:this.panel.skin.instance.wa_chalk,name:"Chalk"},{item:this.panel.skin.instance.wa_ruler,name:"Ruler"},{item:this.panel.skin.instance.wa_crayons,name:"Crayons"},{item:this.panel.skin.instance.wa_eraser,name:"Eraser"},{item:this.panel.skin.instance.wa_lunchbox,name:"Lunchbox"},{item:this.panel.skin.instance.wa_books1,name:"Books"},{item:this.panel.skin.instance.wa_books2,name:"Books"},{item:this.panel.skin.instance.wa_books3,name:"Books"}];for(var a=0;a<this.panel.waList.length;a++){this.panel.waList[a].item.hitArea=this.panel.waList[a].item.shape,this.panel.waList[a].item.shape.visible=!1;var b=this.panel.waList[a].name;this.panel.waList[a].item.on("click",app.state.onIncorrect,null,!1,{item:b})}},g.startTimeout=function(a){if("undefined"==typeof a&&(a=!0),this.timeout&&this.timeout.destroy(),a){if(app.state.timeoutCount>0){var b=Math.round((Date.now()-app.state.timeoutStartTime)/1e3);GA_obj.trackEvent("TOReEngage",app.config.data.currentScreen,b)}app.state.timeoutCount=0}else app.state.timeoutCount+=1;this.timeout=app.setTimeout(function(){var a,b;if(0===app.state.timeoutCount)app.voPlayer.play("BTS_90B"),app.state.timeoutStartTime=Date.now(),a=GA_obj.valueToPaddedString(app.state.timeoutCount+1),b=app.config.data.currentScreen+" Timeout_"+a,GA_obj.trackEvent("TimeoutPlay",b);else if(1===app.state.timeoutCount)app.hasTouch?app.voPlayer.play(["BTS_119","BTS_95"]):app.voPlayer.play(["BTS_120","BTS_95"]),a=GA_obj.valueToPaddedString(app.state.timeoutCount+1),b=app.config.data.currentScreen+" Timeout_"+a,GA_obj.trackEvent("TimeoutPlay",b);else if(app.state.timeoutCount>1){app.voPlayer.play("BTS_96");for(var c=0;c<app.state.panel.items.length;c++){var d=app.state.panel.items[c];if(!d.found){d.wiggle();break}}a=GA_obj.valueToPaddedString(app.state.timeoutCount+1),b=app.config.data.currentScreen+" Timeout_"+a,GA_obj.trackEvent("TimeoutPlay",b)}app.state.startTimeout(!1)},1e4)},g.pulseBox=function(){createjs.Tween.get(this.panel.skin.instance.box).to({scaleX:1.3,scaleY:1.3},600,createjs.Ease.cubicInOut).to({scaleX:1,scaleY:1},600,createjs.Ease.cubicInOut)},g.itemFound=function(a){a.found||(a.found=!0,this.foundItems++,this.playEncouragement(),this.foundItems==this.panel.items.length?(this.timeout&&this.timeout.destroy(),app.state.nextState()):app.state.startTimeout(!0))},g.onIncorrect=function(a,b){"undefined"==typeof b.item&&(b.item="Other"),app.state.incorrectItems+=1,app.state.startTimeout(!0),GA_obj.trackEvent("Show-and-Tell WA Item",b.item,app.state.incorrectItems)},g.playEncouragement=function(){this.actionCount+=1,this.actionCount%3===1&&app.voPlayer.playing!==!0&&(app.voPlayer.play(app.config.ispyGameData.playerEncouragement[0]),app.config.ispyGameData.playerEncouragement.push(app.config.ispyGameData.playerEncouragement.shift()))},g.goToState=function(a){var b=this._nextState;this._nextState=a,this.nextState(),this._nextState=b},g.exitStart=function(){this.actionCount=0,this.timeoutCount=0,this.incorrectItems=0,$(this.panel.homeButton).off("click"),app.sound.stop("gameplay_music"),this.timeout&&this.timeout.destroy(),createjs.Tween.removeTweens(this.panel.skin.instance.box);for(var a=0;a<app.state.panel.items.length;a++)createjs.Tween.removeTweens(app.state.panel.items[a]),createjs.Tween.removeTweens(app.state.panel.items[a].item)},g.exit=function(){},a.prototype.setFrame=function(){this.outline.visible=!0,this.outline.advance(),this.outline.gotoAndStop(1)},a.prototype.findItem=function(){var a=this.item.parent.localToLocal(this.item.x,this.item.y,this.outline.parent);app.sound.play("touchobject"),this.outline.parent.addChild(this.item),this.item.x=a.x,this.item.y=a.y,this.item.mouseEnabled=!1},a.prototype.wiggle=function(){createjs.Tween.get(this.item).to({rotation:this.item.rotation+30},300,createjs.Ease.cubicInOut).to({rotation:this.item.rotation-30},300,createjs.Ease.cubicInOut).to({rotation:this.item.rotation},300,createjs.Ease.cubicInOut)},a.prototype.drag=function(a){var b=this.item.parent.globalToLocal(a.originalEvent.stageX,a.originalEvent.stageY);this.item.x=b.x,this.item.y=b.y},a.prototype.moveToOutline=function(){createjs.Tween.get(this.item).to({x:this.outline.x,y:this.outline.y,scaleX:this.outline.scaleX,scaleY:this.outline.scaleY,rotation:this.outline.rotation},500,createjs.Ease.cubicOut).call(function(){this.iSpy.outline.visible=!1,app.state.itemFound(this.iSpy),app.sound.play("placeobject")});var a=GA_obj.valueToPaddedString(app.state.foundItems+1),b=GA_obj.valueToPaddedString(app.state.incorrectItems),c=this.itemName+" Order_"+a+" WAs_"+b;GA_obj.trackEvent("Show-and-Tell CA Item",c,app.state.foundItems)},namespace("BackToSchool").ISpyGamePanel=d,namespace("BackToSchool").ISpyGameState=f}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("createjs.Bitmap"),b=include("springroll.easeljs.BasePanel"),c=include("springroll.easeljs.BaseState"),d=include("springroll.DelayedCall"),e=function(){b.call(this)},f=extend(e,b);f.setup=function(){this.background=new a(images.MainBackground),this.addChild(this.background),this.skin=new lib_mainMenu.mainMenu,this.addChild(this.skin),this.iSpyButton=this.skin.instance.iSpyButton,this.iSpyButton.hitArea=this.iSpyButton.hitbox,this.iSpyButton.hitbox.visible=!1,this.iSpyButton.art.mouseEnabled=!1,this.iSpyButton.art.stop(),this.iSpyButton.highlightIspy.mouseEnabled=!1,this.iSpyButton.cursor="pointer",this.iSpyButton.mouseChildren=!1,this.blockButton=this.skin.instance.blocksButton,this.blockButton.hitArea=this.blockButton.hitbox,this.blockButton.hitbox.visible=!1,this.blockButton.art.mouseEnabled=!1,this.blockButton.art.stop(),this.blockButton.highlightBlocks.mouseEnabled=!1,this.blockButton.cursor="pointer",this.blockButton.mouseChildren=!1,this.dressUpButton=this.skin.instance.dressUpButton,this.dressUpButton.hitArea=this.dressUpButton.hitbox,this.dressUpButton.hitbox.visible=!1,this.dressUpButton.art.mouseEnabled=!1,this.dressUpButton.art.stop(),this.dressUpButton.highlightDressup.mouseEnabled=!1,this.dressUpButton.cursor="pointer",this.dressUpButton.mouseChildren=!1,this.skin.instance.dressUpButton.highlightDressup.visible=!1,this.skin.instance.blocksButton.highlightBlocks.visible=!1,this.skin.instance.iSpyButton.highlightIspy.visible=!1,this.easterEggs=[],this.easterEggs.push(this.skin.instance.elmo),this.easterEggs.push(this.skin.instance.painting),this.easterEggs.push(this.skin.instance.train),this.easterEggs.push(this.skin.instance.sandbox),this.easterEggs.push(this.skin.instance.plants),this.easterEggs.push(this.skin.instance.fish);for(var b=0;b<this.easterEggs.length;b++)this.easterEggs[b].framerate=24,this.easterEggs[b].cursor="pointer",this.easterEggs[b].stop(),this.easterEggs[b].hitArea=this.easterEggs[b].hitbox,this.easterEggs[b].hitbox.visible=!1},f.teardown=function(){b.prototype.teardown.call(this),this.background=null,this.blockButton=null,this.dressUpButton=null,this.iSpyButton=null};var g=function(a){c.call(this,new e,a),this.panel.state=this},h=extend(g,c);h.loaded=function(){},h.enterDone=function(){app.homeButton&&(app.homeButton.visible=!1),app.config.data.currentScreen="Classroom",app.state=this,app.state.enableButtons(),app.state.enableEasterEggs(),app.state.timeoutCount=0,app.state.timeoutStartTime=0,app.state.auditionCount={ispy:0,blocks:0,dressup:0},app.config.data.consecutivePlays.activity="",app.sound.stop("gameplay_music"),"intro"in app?app.voPlayer.play("BTS_17",function(){try{app.state.enableMouseOvers(),app.state.enableMouseOuts(),app.state.startTimeout(!0),app.sound.play("gameplay_music")}catch(a){}},!0):(app.intro=!0,app.voPlayer.play(["BTS_7","BTS_8"],function(){try{app.state.enableMouseOvers(),app.state.enableMouseOuts(),app.state.startTimeout(!0),app.voPlayer.play("BTS_9"),app.state.highlightActivities(!1,0),app.sound.play("gameplay_music")}catch(a){}}))},h.enableButtons=function(){$(this.panel.blockButton).on("click",function(){app.state.disableButtons(),app.state.panel.skin.instance.blocksButton.highlightBlocks.visible=!0,app.voPlayer.play("BTS_21",function(){app.state.goToState("chooseThree_blocks")}),app.state.startTimeout(!0),app.config.data.currentActivity="blocks",app.config.data.totalPlays.blocks+=1;var a=GA_obj.valueToPaddedString(app.config.data.totalPlays.blocks),b="Classroom_Blocks_Plays_"+a;GA_obj.trackEvent("button",b,app.config.data.totalPlays.blocks),app.sound.play("activate area")}),$(this.panel.dressUpButton).on("click",function(){app.state.disableButtons(),app.state.panel.skin.instance.dressUpButton.highlightDressup.visible=!0,app.voPlayer.play("BTS_54",function(){app.state.goToState("chooseThree_dressUp")}),app.state.startTimeout(!0),app.config.data.currentActivity="dressup",app.config.data.totalPlays.dressup+=1;var a=GA_obj.valueToPaddedString(app.config.data.totalPlays.dressup),b="Classroom_Dress-up_Plays_"+a;GA_obj.trackEvent("button",b,app.config.data.totalPlays.dressup),app.sound.play("activate area")}),$(this.panel.iSpyButton).on("click",function(){app.state.disableButtons(),app.state.panel.skin.instance.iSpyButton.highlightIspy.visible=!0,app.voPlayer.play("BTS_76",function(){app.state.goToState("chooseThree_iSpy")}),app.state.startTimeout(!0),app.config.data.currentActivity="ispy",app.config.data.totalPlays.ispy+=1;var a=GA_obj.valueToPaddedString(app.config.data.totalPlays.ispy),b="Classroom_Show-and-Tell_Plays_"+a;GA_obj.trackEvent("button",b,app.config.data.totalPlays.ispy),app.sound.play("activate area")})},h.enableEasterEggs=function(){$(this.panel.skin.instance.elmo).on("click",function(){app.voPlayer.playing!==!0&&(GA_obj.trackEvent("button","Animation_Elmo"),app.voPlayer.play(["BTS_9A",200],function(){app.state.timeout._timer=0}),this.play(),app.state.startTimeout(!0))}),$(this.panel.skin.instance.painting).on("click",function(){this.play(),app.state.startTimeout(!0),GA_obj.trackEvent("button","Animation_Easel")}),$(this.panel.skin.instance.train).on("click",function(){this.play(),app.state.startTimeout(!0),GA_obj.trackEvent("button","Animation_Train")}),$(this.panel.skin.instance.sandbox).on("click",function(){this.play(),app.state.startTimeout(!0),GA_obj.trackEvent("button","Animation_Sandbox")}),$(this.panel.skin.instance.plants).on("click",function(){this.play(),app.state.startTimeout(!0),GA_obj.trackEvent("button","Animation_Windowsill")}),$(this.panel.skin.instance.fish).on("click",function(){this.play(),app.state.startTimeout(!0),GA_obj.trackEvent("button","Animation_Fish Tank")})},h.enableMouseOvers=function(){$(this.panel.dressUpButton).on("mouseover",function(){if(app.state.panel.skin.instance.dressUpButton.highlightDressup.visible=!0,!app.voPlayer.playing||-1!==app.voPlayer.voList.indexOf("BTS_11")||-1!==app.voPlayer.voList.indexOf("BTS_13")){app.state.auditionCount.dressup+=1;var a="Classroom_Dress-up_audition",b=GA_obj.valueToPaddedString(app.state.auditionCount.dressup);app.voPlayer.play("BTS_12",function(){GA_obj.trackEvent(a,b,app.state.auditionCount.dressup)})}}),$(this.panel.blockButton).on("mouseover",function(){if(app.state.panel.skin.instance.blocksButton.highlightBlocks.visible=!0,!app.voPlayer.playing||-1!==app.voPlayer.voList.indexOf("BTS_12")||-1!==app.voPlayer.voList.indexOf("BTS_13")){app.state.auditionCount.blocks+=1;var a="Classroom_Blocks_audition",b=GA_obj.valueToPaddedString(app.state.auditionCount.blocks);app.voPlayer.play("BTS_11",function(){GA_obj.trackEvent(a,b,app.state.auditionCount.blocks)})}}),$(this.panel.iSpyButton).on("mouseover",function(){if(app.state.panel.skin.instance.iSpyButton.highlightIspy.visible=!0,!app.voPlayer.playing||-1!==app.voPlayer.voList.indexOf("BTS_11")||-1!==app.voPlayer.voList.indexOf("BTS_12")){app.state.auditionCount.ispy+=1;var a="Classroom_Show-and-Tell_audition",b=GA_obj.valueToPaddedString(app.state.auditionCount.ispy);app.voPlayer.play("BTS_13",function(){GA_obj.trackEvent(a,b,app.state.auditionCount.ispy)})}})},h.enableMouseOuts=function(){$(this.panel.dressUpButton).on("mouseout",function(){app.state.panel.skin.instance.dressUpButton.highlightDressup.visible=!1}),$(this.panel.blockButton).on("mouseout",function(){app.state.panel.skin.instance.blocksButton.highlightBlocks.visible=!1}),$(this.panel.iSpyButton).on("mouseout",function(){app.state.panel.skin.instance.iSpyButton.highlightIspy.visible=!1})},h.startTimeout=function(a){if("undefined"==typeof a&&(a=!0),this.timeout&&this.timeout.destroy(),a){if(app.state.timeoutCount>0){var b=Math.round((Date.now()-app.state.timeoutStartTime)/1e3);GA_obj.trackEvent("TOReEngage",app.config.data.currentScreen,b)}app.state.timeoutCount=0}else app.state.timeoutCount+=1;this.timeout=new d(function(){var a,b;if(app.voPlayer.playing===!0)return void app.state.startTimeout(!0);var c=[];app.state.timeoutCount<1?(c.push("BTS_14"),c.push(500),app.hasTouch?c.push("BTS_119"):c.push("BTS_120"),c.push("BTS_15"),app.state.highlightActivities(!1,2e3),app.state.timeoutStartTime=Date.now(),a=GA_obj.valueToPaddedString(app.state.timeoutCount+1),b=app.config.data.currentScreen+" Timeout_"+a,GA_obj.trackEvent("TimeoutPlay",b)):(app.hasTouch?c.push("BTS_119"):c.push("BTS_120"),c.push("BTS_16"),app.state.highlightActivities(!0,2500),a=GA_obj.valueToPaddedString(app.state.timeoutCount+1),b=app.config.data.currentScreen+" Timeout_"+a,GA_obj.trackEvent("TimeoutPlay",b)),app.voPlayer.play(c,function(){app.state.startTimeout(!1)})},1e4)},h.highlightActivities=function(a,b){"undefined"==typeof a&&(a=!1),"undefined"==typeof b&&(b=2e3),a===!0?createjs.Tween.get(app.state.panel.skin.instance).wait(b).call(function(){this.iSpyButton.highlightIspy.visible=!0}).wait(1500).call(function(){this.iSpyButton.highlightIspy.visible=!1,this.blocksButton.highlightBlocks.visible=!0}).wait(1e3).call(function(){this.blocksButton.highlightBlocks.visible=!1,this.dressUpButton.highlightDressup.visible=!0}).wait(1e3).call(function(){this.dressUpButton.highlightDressup.visible=!1}):createjs.Tween.get(app.state.panel.skin.instance).wait(b).call(function(){this.dressUpButton.highlightDressup.visible=!0,this.blocksButton.highlightBlocks.visible=!0,this.iSpyButton.highlightIspy.visible=!0}).wait(2e3).call(function(){this.dressUpButton.highlightDressup.visible=!1,this.blocksButton.highlightBlocks.visible=!1,this.iSpyButton.highlightIspy.visible=!1})},h.disableButtons=function(){$(this.panel.blockButton).off("click"),$(this.panel.dressUpButton).off("click"),$(this.panel.iSpyButton).off("click"),$(this.panel.blockButton).off("mouseover"),$(this.panel.dressUpButton).off("mouseover"),$(this.panel.iSpyButton).off("mouseover"),$(this.panel.blockButton).off("mouseout"),$(this.panel.dressUpButton).off("mouseout"),$(this.panel.iSpyButton).off("mouseout")},h.exitStart=function(){this.timeout&&this.timeout.destroy(),this.disableButtons(),app.sound.stop("gameplay_music"),app.homeButton&&(app.homeButton.visible=!0),app.state.timeoutCount=0,app.state.timeoutStartTime=0,createjs.Tween.removeTweens(app.state.panel.skin.instance)},h.exit=function(){},h.goToState=function(a){this._nextState=a,this.nextState()},namespace("BackToSchool").MainMenuPanel=e,namespace("BackToSchool").MainMenuState=g}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("springroll.easeljs.SoundButton"),b=include("createjs.Bitmap"),c=include("springroll.easeljs.BasePanel"),d=include("springroll.easeljs.BaseState"),e=include("springroll.DelayedCall"),f=include("createjs.Ticker"),g=function(){c.call(this)},h=extend(g,c);h.setup=function(){this.background=new b(images.TitleBackground),this.playButton=new a(images.PlayButton),this.addChild(this.background),this.addChild(this.playButton)},h.teardown=function(){c.prototype.teardown.call(this),this.background=null,this.playButton=null,this.particleSystem=null};var i=function(a){d.call(this,new g,a),this.panel.state=this,this.update=this.update.bind(this)},j=extend(i,d);j.loaded=function(){},j.enterDone=function(){app.homeButton&&(app.homeButton.visible=!1),app.state=this;var a=[];a.push("BTS_3"),a.push(500),a.push("BTS_4"),app.voPlayer.play(a,function(){app.state.startTimeout()}),app.state.timeoutCount=0,app.state.timeoutStartTime=0,this.panel.playButton.addEventListener("buttonPress",app.state.goToMainMenu),this.panel.background.addEventListener("click",app.state.goToMainMenu),f.addEventListener("tick",this.update)},j.update=function(){},j.startTimeout=function(a){if("undefined"==typeof a&&(a=!0),this.timeout&&this.timeout.destroy(),a){if(app.state.timeoutCount>0){var b=Math.round((Date.now()-app.state.timeoutStartTime)/1e3);GA_obj.trackEvent("TOReEngage",app.config.data.currentScreen,b)}app.state.timeoutCount=0}else app.state.timeoutCount+=1;this.timeout=new e(function(){if(app.voPlayer.playing===!0)return void app.state.startTimeout(!0);var a=[];a.push("BTS_4"),app.voPlayer.play(a,function(){app.state.startTimeout(!1)}),app.state.timeoutStartTime=Date.now(),paddedNumber=GA_obj.valueToPaddedString(app.state.timeoutCount+1),eventString=app.config.data.currentScreen+" Timeout_"+paddedNumber,GA_obj.trackEvent("TimeoutPlay",eventString)},1e4)},j.exitStart=function(){this.timeout&&this.timeout.destroy(),app.voPlayer.stop(),this.panel.background.removeEventListener("click",app.state.goToMainMenu),this.panel.playButton.removeEventListener("click",app.state.goToMainMenu),f.removeEventListener("tick",this.update)},j.exit=function(){},j.goToMainMenu=function(a){app.state.startTimeout(!0),a.target===app.state.panel.playButton?GA_obj.trackEvent("start","StartButton"):GA_obj.trackEvent("start","NotStartButton"),app.state._nextState="mainMenu",app.state.nextState()},namespace("BackToSchool").TitlePanel=g,
namespace("BackToSchool").TitleState=i}(lib=lib||{},images=images||{},createjs=createjs||{},ss=ss||{});var lib,images,createjs,ss;!function(){var a=include("springroll.Application"),b=include("createjs.Container"),c=include("BackToSchool.TitleState"),d=include("BackToSchool.MainMenuState"),e=include("BackToSchool.BlockGameState"),f=include("BackToSchool.DressUpGameState"),g=include("BackToSchool.ISpyGameState"),h=include("BackToSchool.ChooseThreeState"),i=include("BackToSchool.ActivityEndState"),j=include("createjs.Bitmap"),k=include("springroll.easeljs.Button"),l=function(){a.call(this,{name:"BackToSchool",fps:60,state:"title",canvasId:"stage",configPath:"assets/config/config.json",debug:!0,display:springroll.EaselJSDisplay,displayOptions:{clearView:!0,mouseOverRate:15}}),this.once("configLoaded",n.bind(this)),this.once("init",o.bind(this)),this.onWindowUnload=this.onWindowUnload.bind(this),window.addEventListener("unload",this.onWindowUnload)},m=extend(l,a);m.onWindowUnload=function(){window.removeEventListener("unload",this.onWindowUnload),this.destroy()};var n=function(a,b){this.hasTouch||(b.push(this.config.assets.cursor[0]),b.push(this.config.assets.cursor[1])),b.push({id:"QuitButton",src:"assets/images/closebutton.png"}),b.push({id:"HomeButton",src:"assets/images/homebutton.png"}),app.config.data.gameStartTime=Date.now()},o=function(){this.cursor=null;var a=this.display,l=(a.canvas,this.config.assets),m=this.config.scaling;this.config.manifests;this.shuffle(app.config.blockGameData.structureOrder),this.shuffle(app.config.blockGameData.playerEncouragement),this.shuffle(app.config.blockGameData.timmyEncouragement),this.shuffle(app.config.dressupGameData.playerEncouragement),this.shuffle(app.config.ispyGameData.playerEncouragement),this.shuffle(app.config.ispyGameData.itemSetOrder),this.states={title:new c({next:"mainMenu",preload:l.title,scaling:m.title}),mainMenu:new d({scaling:m.mainMenu,preload:l.mainMenu}),chooseThree_blocks:new h({scaling:m.chooseThree_blocks,next:"blockGame",previous:"mainMenu",scenes:{intro:"blocks_start",choice:"blocks_choices",resolutions:["blocks_askadult","blocks_plan","blocks_count"]},choiceDelays:[0,1500,3e3],introVO:["BTS_22","BTS_23"],mouseOverVO:["BTS_26","BTS_27","BTS_28"],resolutionAudio:[[{start:0,alias:"BTS_32",sync:!0},{start:6.7,alias:"BTS_33",sync:!0},{start:13,alias:"BTS_34",sync:!0},{start:22.8,alias:"BTS_41",sync:!0}],[{start:0,alias:"BTS_35",sync:!0},{start:6.5,alias:"BTS_36",sync:!0},{start:10.4,alias:"BTS_37",sync:!0},{start:14.4,alias:"BTS_41",sync:!0}],[{start:0,alias:"BTS_38",sync:!0},{start:6.7,alias:"BTS_39",sync:!0},{start:15,alias:"BTS_40",sync:!0},{start:22.2,alias:"BTS_41",sync:!0}]]}),blockGame:new e({scaling:m.blockGame,next:"activityEnd_blocks",previous:"mainMenu"}),activityEnd_blocks:new i({scaling:m.activityEnd_blocks,next:"blockGame",previous:"mainMenu",skin:lib_blocks_final.blocks_final}),chooseThree_dressUp:new h({preload:[],scaling:m.chooseThree_blocks,next:"dressUpGame",previous:"mainMenu",scenes:{intro:"costume_start",choice:"costume_choices",resolutions:["costume_share","costume_turns","costume_askadult"]},choiceDelays:[0,1500,4e3],introVO:["BTS_55","BTS_56"],mouseOverVO:["BTS_57","BTS_58","BTS_26"],resolutionAudio:[[{start:0,alias:"BTS_60",sync:!0},{start:6.2,alias:"BTS_61",sync:!0},{start:9.9,alias:"BTS_62",sync:!0},{start:12.8,alias:"BTS_69",sync:!0}],[{start:0,alias:"BTS_63",sync:!0},{start:7.7,alias:"BTS_64",sync:!0},{start:9.2,alias:"BTS_65",sync:!0},{start:13.5,alias:"BTS_69",sync:!0}],[{start:0,alias:"BTS_66",sync:!0},{start:8.9,alias:"BTS_67",sync:!0},{start:15.8,alias:"BTS_68",sync:!0},{start:18.7,alias:"BTS_69",sync:!0}]]}),dressUpGame:new f({scaling:m.dressUpGame,next:"activityEnd_dressUp",previous:"mainMenu"}),activityEnd_dressUp:new i({scaling:m.activityEnd_blocks,next:"dressUpGame",previous:"mainMenu",skin:lib_costume_final.costume_final}),chooseThree_iSpy:new h({scaling:m.chooseThree_blocks,next:"iSpyGame",previous:"mainMenu",scenes:{intro:"ispy_start",choice:"ispy_choices",resolutions:["ispy_askadult","ispy_breath","ispy_hug"]},choiceDelays:[0,1500,3200],introVO:["BTS_77","BTS_78"],mouseOverVO:["BTS_26","BTS_79","BTS_80"],resolutionAudio:[[{start:0,alias:"BTS_82",sync:!0},{start:8.7,alias:"BTS_83",sync:!0},{start:12.9,alias:"BTS_84",sync:!0},{start:21.2,alias:"BTS_91",sync:!0}],[{start:0,alias:"BTS_85",sync:!0},{start:8.8,alias:"BTS_86",sync:!0},{start:19.5,alias:"BTS_87",sync:!0},{start:26,alias:"BTS_91",sync:!0}],[{start:0,alias:"BTS_88",sync:!0},{start:8.6,alias:"BTS_89",sync:!0},{start:14.7,alias:"BTS_90",sync:!0},{start:17.5,alias:"BTS_91",sync:!0}]]}),iSpyGame:new g({scaling:m.iSpyGame,next:"activityEnd_iSpy",previous:"mainMenu"}),activityEnd_iSpy:new i({scaling:m.activityEnd_blocks,next:"iSpyGame",previous:"mainMenu",skin:lib_activityEnd_iSpy.activityEnd_iSpy})};var n=a.stage;this.homeButton=new k(app.assetManager.cache.read("HomeButton")),this.onHomeTap=this.onHomeTap.bind(this),this.homeButton.addEventListener("click",this.onHomeTap),this.scaling.addItem(this.homeButton,{align:"top-left",x:10,y:10}),this.homeButton.visible=!1,n.addChild(this.homeButton),"undefined"!=typeof global_doNotDisplayClose&&global_doNotDisplayClose===!1&&(this.quitButton=new j(app.assetManager.cache.read("QuitButton")),this.onQuitTap=this.onQuitTap.bind(this),this.quitButton.addEventListener("click",this.onQuitTap),this.quitButton.regX=28,this.quitButton.regY=28,this.scaling.addItem(this.quitButton,{x:980,y:80,align:"top-right"}),n.addChild(this.quitButton)),this.hasTouch||(n.addEventListener("mouseleave",this.stageOut.bind(this)),n.addEventListener("mouseenter",this.stageIn.bind(this)),n.addEventListener("stagemousemove",this.onMouseMove.bind(this)),n.addEventListener("changecursor",this.onCursorChange.bind(this)),this.display.canvas.style.cursor="none",this.cursor=new b,this.cursorDefault=new j(app.assetManager.cache.read("CursorDefault")),this.cursor.addChild(this.cursorDefault),this.cursorPointer=new j(app.assetManager.cache.read("CursorOver")),this.cursor.addChild(this.cursorPointer),this.cursorPointer.visible=!1,this.cursorDefault.regX=18,this.cursorDefault.regY=18,this.cursorPointer.regX=18,this.cursorPointer.regY=18,n.addChild(this.cursor),this.currentDragged=this.currentDraggedOffset=null),this.display.visible=!0,GA_obj.trackEvent("load","Complete")};m.stageOut=function(){this.cursor&&(this.cursor.visible=!1)},m.stageIn=function(){this.cursor&&(this.cursor.visible=!0)},m.onCursorChange=function(a){this.cursorPointer.visible="pointer"==a.cursor,this.cursorDefault.visible="pointer"!=a.cursor},m.onMouseMove=function(a){this._lastStageX=a.stageX,this._lastStageY=a.stageY,this.currentDragged||(this.cursor.x=a.stageX,this.cursor.y=a.stageY)},m.onHomeTap=function(){GA_obj.trackEvent("button home",app.config.data.currentScreen),app.sound.stop("gameplay_music"),app.sound.play("home"),this.state._prevState="mainMenu",this.state.previousState()},m.onQuitTap=function(){GA_obj.trackEvent("button exit",GA_obj.gameID),window.close()},m.destroy=function(){var b=Math.round((Date.now()-app.config.data.gameStartTime)/1e3);GA_obj.trackEvent("Quit",app.config.data.currentScreen),GA_obj.trackEvent("QuitInfo","GameDuration",b),this.quitButton&&this.quitButton.removeEventListener("click",this.onQuitTap),this.quitButton=null,a.prototype.destroy.call(this)},window.app=new l}();