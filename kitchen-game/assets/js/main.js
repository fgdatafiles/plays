!function(){function a(a,b){a.copyframes||(a.copyframes=[].concat(a.frames)),a.copyimages||(a.copyimages=[].concat(a.images));for(var d in a.copyimages)"string"==typeof a.copyimages[d]&&(a.images[d]=images[a.copyimages[d]]);b||(b="all");var f=[],g=a.animations[b].frames;for(var h in g)f[h]=a.copyframes[g[h]];return a.frames=f,new c(new e(a))}var b=include("createjs.Container"),c=include("createjs.Sprite"),d=include("createjs.Bitmap"),e=include("createjs.SpriteSheet"),f=include("springroll.EventDispatcher"),g=function(a){this.init(a)},h=extend(g,b);h.init=function(c){b.call(this),this.events=new f;var e=app.config.ruffintro;this.eyes=a(e,"ruff_eyes"),this.eyes.framerate=12,this.ears=a(e,"ruff_ears"),this.ears.framerate=8,this.mouth=a(e,"ruff_mouth"),this.ipad=new d(images.intro_ipad);var g="ruff_intro_body";c.body&&(g=c.body);var h=c.layout;this.body=new d(images[g]),this.lipsyncobject=app.config.lipsync;for(var i in h)this[i]&&(this[i].x=h[i].frame.x,this[i].y=h[i].frame.y,h[i].frame.scale&&(this[i].scaleX=this[i].scaleY=h[i].frame.scale));this.addChild(this.ipad),this.addChild(this.body),this.addChild(this.ears),this.addChild(this.eyes),this.addChild(this.mouth),this.voplayer=app.voPlayer,this.update=this.update.bind(this),this.audioend=this.audioend.bind(this),this.saynext=this.saynext.bind(this),app.off("update",this.update),this.voplayer.off("end",this.audioend),app.on("update",this.update),this.voplayer.on("end",this.audioend)},h.blink=function(){this.eyes.play()},h.wiggle=function(){this.ears.play()},h.setmouth=function(a){null!==a&&void 0!==a&&this.mouth.gotoAndStop(a)},h.saythings=function(a,b){this.talking=!0,this.sentence=[].concat(a),this.aftersound=b,this.saynext()},h.saynext=function(){if(this.sentence){var a=this.saynext;this.sentence.length<2&&(a=this.aftersound),this.saything(this.sentence.shift(),a)}},h.saything=function(a,b){this.talking=!0,this.voplayer.play(a,b),this.syncarray=this.lipsyncobject[a]},h.audioend=function(){this.talking=!1,this.events.trigger("audioend")},h.update=function(){this.talking&&this.syncarray&&(this.voplayer.playing=!0,this.vopos=this.voplayer.getElapsed()/this.voplayer.currentDuration,this.setmouth(this.syncarray[parseInt(this.vopos*this.syncarray.length)]))},namespace("WGBH").RuffIntro=g}(),function(){var a=include("createjs.Container"),b=include("createjs.Sprite"),c=include("createjs.SpriteSheet"),d=include("springroll.easeljs.DisplayAdapter"),e=include("createjs.Tween"),f=include("createjs.Ease"),g=include("springroll.EventDispatcher"),h=function(a){this.init(a)},i=extend(h,a),j=90,k=null;h.E=315,h.N=225,h.W=135,h.S=45,h.corner=360,h.makeMovieClipFromZoeSpritesheet=function(a,d){a.copyframes||(a.copyframes=[].concat(a.frames)),a.copyimages||(a.copyimages=[].concat(a.images));for(var e in a.copyimages)"string"==typeof a.copyimages[e]&&(a.images[e]=images[a.copyimages[e]]);d||(d="all");var f=[],g=a.animations[d].frames;for(var h in g)f[h]=a.copyframes[g[h]];return a.frames=f,new b(new c(a))},h.anglefromcompass=function(a){if("corner"===a)return h.corner;var b,c,d=a.split(""),e=0;for(var f in d)"S"===d[f]?b=!0:"E"===d[f]&&(c=!0),e+=h[d[f]];return b&&c&&(e-=h.corner),angle=e/d.length,angle},i.init=function(b){return k=app.config.RuffPointer,k&&k.spritedef?(a.call(this),this.events=new g,this.ruffhead=new a,this.ruff=h.makeMovieClipFromZoeSpritesheet(k.spritedef,"ruff"),this.ruffhead.addChild(this.ruff),d.setPivot(this.ruffhead,{x:k.positions.head.pivot.x,y:k.positions.head.pivot.y}),d.setPosition(this.ruffhead,{x:k.positions.head.x,y:k.positions.head.y}),this.defaultduration=500,this.pointer=h.makeMovieClipFromZoeSpritesheet(k.spritedef,"pointer"),this.rotation=h.corner,this.ruffhead.rotation=0,this.addChild(this.pointer),this.addChild(this.ruffhead),this.happymouth=h.makeMovieClipFromZoeSpritesheet(k.spritedef,"happymouth"),this.sadmouth=h.makeMovieClipFromZoeSpritesheet(k.spritedef,"sadmouth"),this.mouth=this.happymouth,d.setPosition(this.mouth,{x:k.positions.mouth.x,y:k.positions.mouth.y}),this.ruffhead.addChild(this.mouth),this.interactive=!0,this.animatedparts=[],this.incorner=!0,this.checkwidth=k.positions.width*app.scaling._scale,this.voplayer=app.voPlayer,this.lipsyncobject=app.config.lipsync,this.itempath=app.states.game.panel,b&&(b.voplayer&&(this.voplayer=b.voplayer),b.lipsync&&(this.lipsyncobject=b.lipsync),b.itempath&&(this.itempath=b.itempath)),this.update=this.update.bind(this),this.clickedme=this.clickedme.bind(this),this.audioend=this.audioend.bind(this),this.nextmove=this.nextmove.bind(this),this.nextevent=this.nextevent.bind(this),this.saynext=this.saynext.bind(this),app.on("update",this.update),this.voplayer.on("end",this.audioend),void this.on("click",this.clickedme)):null},i.clickedme=function(){this.events.trigger("click")},i.saythings=function(a,b){return this.audiocallback=b,"string"==typeof a?void this.saything(a,b):(this.audiosets=[],this.audiosets=this.audiosets.concat(a),void this.saynext())},i.saything=function(a,b){b&&(this.audiocallback=b),this.audiosets=[a],this.saynext()},i.stoptalking=function(){this.syncarray=null,this.talking=!1,this.voplayer.stop(),this.setmouth(0)},i.saynext=function(){this.audiosets.length>1?this.aftersound=this.saynext:this.aftersound=this.audiocallback,this.sayoneaudio(this.audiosets.shift(),this.aftersound)},i.skipall=function(){this.stoptalking(),this.nextmoves=null,this.audiosets=null,this.afteraudio=null;var a;for(a in this.movetimers)this.movetimers[a].destroy();for(a in this.eventtimers)this.eventtimers[a].destroy();this.backtocorner()},i.sayoneaudio=function(a,b){var c;return a?void("string"==typeof a?(c=a,this.voplayer.play(a,b),this.talking=!0,this.voplayer.playing=!0,this.syncarray=this.lipsyncobject[c]):"number"==typeof a?b&&app.setTimeout(b,a):"function"==typeof a?(a(),b&&b()):(c=a.audio,"string"==typeof a.audio&&(this.syncarray=this.lipsyncobject[a.audio],this.voplayer.play(a.audio,b)),this.talking=!0)):void(b&&b())},i.backtocorner=function(a){this.incorner||(a=0===a?0:a?a:this.defaultduration,this.pointat({x:0,y:0},a,"corner"),this.following=null,this.incorner=!0,this.nooutline())},i.nooutline=function(){this.pointer.gotoAndStop(0),d.setPosition(this.ruffhead,{x:k.positions.head.x,y:k.positions.head.y})},i.outline=function(){this.pointer.gotoAndStop(1),d.setPosition(this.ruffhead,{x:k.positions.head.x+k.positions.outline,y:k.positions.head.y+k.positions.outline})},i.rotateto=function(a,b){0===b||b||(b=750),this.rotation>h.corner?(this.rotation-=h.corner,this.ruffhead.rotation+=h.corner):-1*this.rotation>h.corner&&(this.rotation+=h.corner,this.ruffhead.rotation-=h.corner);var c=a-this.rotation;(c>j||-1*c>j)&&(a>this.rotation?a-=h.corner:a+=h.corner),e.get(this).to({rotation:a},b),e.get(this.ruffhead,{override:!0}).to({rotation:h.corner-a},b)},i.displayposition=function(){return this},i.pointat=function(a,b,c){if(a.localToGlobal?a=a.pointerspot?a.localToGlobal(a.pointerspot.x,a.pointerspot.y):a.localToGlobal(0,0):a.length&&2===a.length?a={x:a[0],y:a[1]}:a.x&&a.y||(a={x:0,y:0}),0===b||b||(b=this.defaultduration),e.get(this.displayposition(),{override:!0}).to({x:a.x,y:a.y},b,f.quadInOut),void 0===c&&(c="auto"),"auto"===c){var d="";a.y<this.checkwidth?d="S":a.y>app.realHeight-this.checkwidth&&(d="N"),a.x<this.checkwidth?d+="E":a.x>app.realWidth-this.checkwidth&&(d+="W"),""===d&&(d="N"),c=h.anglefromcompass(d)}else"string"==typeof c?c=h.anglefromcompass(c):c+=h.N;this.rotateto(c,b),app.setTimeout(b,this.finishedmoving),this.incorner=!1,this.outline()},i.pulseitem=function(a,b){if(this.events.trigger("pointedat",a),a.hasOwnProperty("scaleX")&&a.pulse!==!1){b||(b=.25);var c=f.cubicOut,d=f.cubicOut,g=a.getBounds();if(e.get(a).to({scaleX:a.scaleX+a.scaleX*b,scaleY:a.scaleY+a.scaleY*b},500,c).to({scaleX:a.scaleX,scaleY:a.scaleY},500,d),!a.anchor||.5!==a.anchor.x||.5!==a.anchor.y){var h={x:a.x-b*g.width/2,y:a.y-b*g.height/2};e.get(a).to({x:h.x,y:h.y},500,c).to({x:a.x,y:a.y},500,d)}}},i.follow=function(a,b){return a?(this.incorner=!1,this.following=a,void(this.pointfrom=b)):void(this.following=null)},i.setblink=function(){this.nextblink=100+parseInt(200*Math.random()),this.animatedparts.push([this.glasses,this.glasses.blinkframes.copy()])},i.setmouth=function(a){null!==a&&void 0!==a&&this.mouth.gotoAndStop(a)},i.update=function(){if(this.talking&&this.syncarray&&(this.voplayer.playing=!0,this.vopos=this.voplayer.getElapsed()/this.voplayer.currentDuration,this.setmouth(this.syncarray[parseInt(this.vopos*this.syncarray.length)])),this.animatedparts.length>0){for(var a=this.animatedparts.length-1,b=a;b>=0;b--){var c=this.animatedparts[b][0],d=this.animatedparts[b][1].shift();c.gotoAndStop(d),this.animatedparts[b][1].length<1&&this.animatedparts.splice(b,1)}this.nextblink--,this.nextblink<0&&this.setblink()}this.following&&this.pointat(this.following,0,this.pointfrom)},i.makemoves=function(a){if(a){var b,c,d;this.nextmoves=[],this.movetimers=[];var e=this;for(var f in a){var g=a[f];if(b=0===g.duration?0:g.duration?g.duration:this.defaultduration,g.corner)d="corner";else if(g.object){var h=g.object.split(".");d=g.object;var i=this.itempath;for(var j in h)i=i[h[j]];d=i,g.pointerspot&&(d.pointerspot=g.pointerspot)}else g.point&&(d=g.point);c=g.start?g.start:0,loc=g.location?g.location:"auto",this.nextmoves.push([d,b,loc]),this.movetimers.push(app.setTimeout(e.nextmove,c))}}},i.nextmove=function(){if(this.nextmoves&&!(this.nextmoves.length<1)){var a=this.nextmoves.shift();if("corner"===a[0])this.backtocorner(a[1]);else{this.follow(!1),this.pointat(a[0],a[1],a[2]);var b=this;app.setTimeout(function(){b.pulseitem(a[0])},a[1])}}},i.makeevents=function(a){if(a){var b,c,d;this.nextevents=[],this.eventtimers=[];var e=this;for(var f in a){var g=a[f];c=g.start?g.start:0,d=g.name?g.name:"event",g.hasOwnProperty("data")&&(b=g.data),this.nextevents.push([d,b]),this.eventtimers.push(app.setTimeout(e.nextevent,c))}}},i.nextevent=function(){if(this.nextevents&&!(this.nextevents.length<1)){var a=this.nextevents.shift();this.events.trigger(a[0],a[1])}},i.audioend=function(){this.talking=!1,this.events.trigger("audioend")},i.teardown=function(){app.off("update",this.update),this.voplayer.off("end",this.audioend),this.off("click",this.clickedme)},namespace("WGBH.createjs").RuffPointer=h}(),function(){var a=include("springroll.easeljs.BasePanel"),b=include("createjs.Bitmap"),c=include("createjs.Container"),d=include("springroll.easeljs.Button"),e=include("WGBH.createjs.RuffPointer"),f=function(){a.call(this)},g=a.prototype,h=extend(f,a),i={visible:!1};h.setup=function(){this.building_bg=new b(app.getCache("building_bg")).set(i),this.addChild(this.building_bg),this.mixing_bg=new b(app.getCache("mixing_bg")).set(i),this.addChild(this.mixing_bg),this.baking_bg=new b(app.getCache("baking_bg")).set(i),this.addChild(this.baking_bg),this.fishy_bg=new b(app.getCache("fishy_bg")),this.addChild(this.fishy_bg),this.testing_bg=new b(app.getCache("testing_bg")).set(i),this.addChild(this.testing_bg),this.decorate_bg=new b(app.getCache("decorate_bg")).set(i),this.addChild(this.decorate_bg),this.menuCont=new c,this.addChild(this.menuCont),this.buildCont=(new c).set(i),this.addChild(this.buildCont),this.mixCont=(new c).set(i),this.addChild(this.mixCont),this.bakingCont=(new c).set(i),this.addChild(this.bakingCont),this.leftCont=(new c).set(i),this.addChild(this.leftCont),this.testCont=(new c).set(i),this.addChild(this.testCont),this.nameCont=(new c).set(i),this.addChild(this.nameCont),this.challCont=(new c).set(i),this.addChild(this.challCont),this.chooseCont=(new c).set(i),this.addChild(this.chooseCont),this.decorCont=(new c).set(i),this.addChild(this.decorCont),this.payoffCont=(new c).set(i),this.addChild(this.payoffCont),this.delivCont=(new c).set(i),this.addChild(this.delivCont),this.bookCont=(new c).set(i),this.addChild(this.bookCont),this.toolsCont=(new c).set(i),this.addChild(this.toolsCont),this.rightCont=(new c).set(i),this.addChild(this.rightCont),this.ruffpointer=new e,this.addChild(this.ruffpointer),this.homebutton=new d(app.getCache("homebutton")).set(i),this.homebutton.name="btn_home",this.addChild(this.homebutton)},h.hideAll=function(){for(var a=this.numChildren,b=0;a>b;b++){var c=this.getChildAt(b);c.visible=!1}},h.teardown=function(){g.teardown.call(this)},namespace("WGBH").GamePanel=f}(),function(){var a=include("springroll.easeljs.BasePanel"),b=include("createjs.Bitmap"),c=include("springroll.easeljs.Button"),d=include("WGBH.RuffIntro"),e=function(){a.call(this)},f=a.prototype,g=extend(e,a);g.setup=function(){this.background=new b(images.intro_bg),this.addChildAt(this.background,0);var a=app.config.layouts.intro;this.ruff=new d({body:"ruff_intro_body",layout:a.ruff}),this.addChild(this.ruff),this.splash=new b(images.ruffs_cookie_creator_splashscreen),this.addChild(this.splash),this.playbutton=new c(images.playbutton),this.playbutton.x=a.playbutton.frame.x,this.playbutton.y=a.playbutton.frame.y,this.addChild(this.playbutton)},g.teardown=function(){f.teardown.call(this),this.background=null,this.playbutton=null},namespace("WGBH").IntroPanel=e}(),function(){function a(){}function b(){ad=Cb.scaleX;var a=app.config.scalingSize,b=app.realHeight/app.realWidth,c=(a.normRatio-b)/(a.normRatio-a.wideRatio);Ud.x=Ud.origX-Pc/2*c,Vd.x=Vd.origX-Pc/6*c,Wd.x=Wd.origX+Pc/6*c,Xd.x=Xd.origX+Pc/2*c,bd=(app.realWidth-app.realHeight*a.normRatioInv)/2,Va.set({scaleX:ad,scaleY:ad}),Hc.update()}function c(a){var b=app.config.spritesheets[a];for(var c in b.images)if("string"==typeof b.images[c]){var d=b.images[c];b.images[c]=app.getCache(d)}return new Ha(b)}function d(a){Ta=a.currentTarget,Ta.alpha=.2,l(!1);var b=Ta.parent.globalToLocal(a.stageX,a.stageY),c={x:Ta.x-b.x,y:Ta.y-b.y};Ua.gotoAndStop(Ta.name);var d=Ua.getBounds();Ua.set({visible:!0,regX:d.width/2,regY:d.height/2,x:a.stageX+c.x*ad,y:a.stageY+c.y*ad,scaleX:ad,scaleY:ad}),Hc.update(),Sa.multitouch=!1,Sa.startDrag(Ua,a),null!==Pd&&(Pd.destroy(),Pd=null),sd?app.trackevent("startDrag",{idorder:["coordinates","drag_type","current_recipe","target_recipe"],coordinates:{x:b.x,y:b.y,stage_width:app.display.width,stage_height:app.display.height},drag_type:Sa.isStickyClick?"click":"drag",current_recipe:{eggs:od[0],butter:od[1],sugar:od[2],salt:od[3]},target_recipe:{eggs:Bd[Qc][0],butter:Bd[Qc][1],sugar:Bd[Qc][2],salt:Bd[Qc][3]}}):(ud||(pa("label-"+Ta.name)?ua("label-"+Ta.name):pa("tip-"+Ta.name)&&ua("tip-"+Ta.name)),app.trackevent("startDragBuild",{idorder:["coordinates","drag_type","current_recipe"],coordinates:{x:b.x,y:b.y,stage_width:app.display.width,stage_height:app.display.height},drag_type:Sa.isStickyClick?"click":"drag",current_recipe:{eggs:od[0],butter:od[1],sugar:od[2],salt:od[3]}})),app.learning.startTimer("drag_time")}function e(){var a=Cb.globalToLocal(Ua.x,Ua.y);if(qe.contains(a.x,a.y)){ud||(sd?1===Rc&&pa("recipe-exactsame")?(Qd={type:"Instruction",descrip:"Cookie-making prompt to follow the recipe (numbers shown on card).",id:10,dur:app.captions.getLength("recipe-exactsame")},ua("recipe-exactsame"),wa("recipecard2")):Rc>1&&pa("follow-numbers")&&(Qd={type:"Instruction",descrip:"Cookie-making prompt to follow the recipe (numbers shown on card).",id:10,dur:app.captions.getLength("follow-numbers")},ua("follow-numbers")):pa("recipe1")&&(ua("recipe1"),Ab.changednumber=Ed[Ta.idx],wa("recipenumbers"))),Dd[Ta.idx][od[Ta.idx]].visible=!0;for(var b=++od[Ta.idx],c=0;b-1>=c;c++)Dd[Ta.idx][c].x=fd[b-1][c];sd?app.trackevent("selectAnswer",{idorder:["coordinates","over_recipe","ingredient","drag_type","duration","current_recipe","target_recipe"],coordinates:{x:a.x,y:a.y,stage_width:app.display.width,stage_height:app.display.height},over_recipe:b>Bd[Qc][Ta.idx],ingredient:we[Ta.idx],drag_type:Sa.isStickyClick?"click":"drag",duration:app.learning.stopTimer("drag_time"),current_recipe:{eggs:od[0],butter:od[1],sugar:od[2],salt:od[3]},target_recipe:{eggs:Bd[Qc][0],butter:Bd[Qc][1],sugar:Bd[Qc][2],salt:Bd[Qc][3]}}):(Ed[Ta.idx].gotoAndStop("card_num_"+b),app.trackevent("selectAnswerBuild",{idorder:["coordinates","ingredient","drag_type","duration","current_recipe"],coordinates:{x:a.x,y:a.y,stage_width:app.display.width,stage_height:app.display.height},ingredient:we[Ta.idx],drag_type:Sa.isStickyClick?"click":"drag",duration:app.learning.stopTimer("drag_time"),current_recipe:{eggs:od[0],butter:od[1],sugar:od[2],salt:od[3]}})),5===b?fa(Ta,!1):Ta.alpha=1,Cc.mouseEnabled||fa(Cc,!0),wd||-1!==od.slice(0,4).indexOf(0)||(T(),sd||ud||!pa("continue-add")||(Qd={type:"Instruction",descrip:"Prompt to tap Blossom to go to the mixing screen or else keep adding ingredients.",id:2,dur:app.captions.getLength("continue-add")},ua("continue-add"))),od.slice(0,4).every(function(a){return 5===a})&&!ud&&pa("all-used")&&ua("all-used"),Xa.set(Ee[Ta.idx]).set({visible:!0,alpha:1}).gotoAndPlay(Ta.name),app.sound.play("add_"+Ta.name)}else Ta.alpha=1,l(!0),app.trackevent("endDragOutside",{idorder:["coordinates","ingredient","drag_type","duration"],coordinates:{x:a.x,y:a.y,stage_width:app.display.width,stage_height:app.display.height},ingredient:we[Ta.idx],drag_type:Sa.isStickyClick?"click":"drag",duration:app.learning.stopTimer("drag_time")});Ua.visible=!1,zd=!0}function f(a){a.target.stop(),l(!0),Fa.get(a.target).to({alpha:0},9).set(hd)}function g(){qb.stop(),Fa.get(be).to({x:0,y:-590},1200).call(h),Fa.get(Rd).to({x:Rd.origX,y:Rd.origY,scaleX:1,scaleY:1},900,ld),Fa.get($d).set(gd).to({x:0},850,ld),Fa.get(Ud).set(gd).wait(100).to({y:Ud.origY},750,ld),Fa.get(Vd).set(gd).wait(100).to({y:Vd.origY},750,ld),Fa.get(Wd).set(gd).wait(100).to({y:Wd.origY},750,ld),Fa.get(Xd).set(gd).wait(100).to({y:Xd.origY},750,ld)}function h(){qb.gotoAndStop("pour_flour"),be.visible=qb.visible=!1}function i(){tb.visible=!1,tb.gotoAndStop("flip"),vd||Fa.get(Gc).set({visible:!0,y:769,mouseEnabled:!1}).to({y:Gc.origY},500,ld).set(id)}function j(){if(mouthSpr.gotoAndStop(xd?"mouth_happy":"mouth_sad"),tc.visible=!xd,T(),Fa.get(be).set(gd).to({x:247,y:83},1300,ld).call(X),app.sound.play("drone_whoosh",{volume:.25,delay:25}),xd){app.sound.play("solved",{volume:.5});var a="";a=Rc%2===0?"great-job-1-"+(2===Tc?"she":"he"):"great-job-"+(Rc+3)%4,Qd={type:"CorrectFeedback",descrip:"Correctly created and served customer's requested cookie!",id:11,dur:app.captions.getLength("great-job")+250+app.captions.getLength(a)},ra([900,"great-job",250,a,Da])}else Qd={type:"IncorrectFeedback",descrip:"Failed to make cookie requested by the customer!",id:12,dur:app.captions.getLength("not-right")+600+app.captions.getLength(oe)+800+app.captions.getLength("try-again3")},ra(["not-right",600,oe,800,"try-again3",Da])}function k(a){app.sound.play("clickey",{volume:.4}),fa(Cc,!1),wd&&U(),Yc++,od=[0,0,0,0,0];for(var b=0;4>b;b++){for(var c=0;5>c;c++)Dd[b][c].visible=!1;sd||Ed[b].gotoAndStop("card_num_0")}if(fa(yc,!0),fa(Bc,!0),fa(Ac,!0),fa(zc,!0),null!==a){var d="zig"===ke?"bone":"zig";Sd.getChildByName("skin").gotoAndStop("bowl_fg_"+d),Fa.get(Rd).to({x:Rd.origX+1024,alpha:0},1e3,ld).call(function(){Rd.getChildByName("skin").gotoAndStop("bowl_fg_"+d),Rd.set({x:Rd.origX,alpha:1}),Sd.set({x:Sd.origX,alpha:0,visible:!1}),ke=d}),Fa.get(Sd).set(gd).to({x:Sd.origX+1024,alpha:1},1e3,ld),app.trackevent(sd?"clickReplay":"clickReplayBuild",{idorder:["coordinates","current_recipe"],coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height},current_recipe:{eggs:od[0],butter:od[1],sugar:od[2],salt:od[3]}})}}function l(a){a&&1!==yc.alpha||(yc.mouseEnabled=a),a&&1!==Bc.alpha||(Bc.mouseEnabled=a),a&&1!==Ac.alpha||(Ac.mouseEnabled=a),a&&1!==zc.alpha||(zc.mouseEnabled=a)}function m(){0===ue.length&&(ue=se.slice().shuffle()),ve.length<2&&(ve=te.slice().shuffle()),me=ue.shift(),ne=ve.shift();var a=!1,b=0;for(b=0;b<Fd.length-1;b+=2)if(Fd[b]===me&&Fd[b+1]===ne){a=!0;break}if(a)for(ne=ve.shift(),b=0;b<Fd.length-1;b+=2)if(Fd[b]===me&&Fd[b+1]===ne){a=!0;break}return a?(ue.unshift(me),m()):(Fd.push(me,ne),me+" "+ne)}function n(a){app.sound.play("clickey",{volume:.4});var b=a.target;b===Lc?(Kc.mouseEnabled||ga(Kc,!0),Uc++,4===Uc&&ga(b,!1)):(Uc--,0===Uc&&ga(b,!1),Lc.mouseEnabled||ga(Lc,!0)),Id.text=Gd[Uc],oa();var c=ma(Gd[Uc]);sa([125,"n1-"+c[0],"n2-"+c[1]])}function o(a){app.trackevent("selectBuild",{idorder:["coordinates"],coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height}}),sd=!1,z()}function p(a){app.trackevent("selectChallenge",{idorder:["coordinates"],coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height}}),Sc=Rc,J()}function q(a){$c=parseInt(a.stageX),_c=parseInt(a.stageY),app.sound.play("clickey",{volume:.4}),U();var b=""+ye,c="";ye===xe.building?(F(),c+=xe.mixing):ye===xe.mixing?(G(),c+=xe.baking):ye===xe.baking?(Ic.mouseEnabled=Jc.mouseEnabled=!1,W(),Fa.get(Ic).to({alpha:0},500),Fa.get(Jc).to({alpha:0},500),Fa.get(Ab.baking_bg).to({scaleX:1.5*ad,scaleY:1.5*ad},1e3),Fa.get(Td).to({scaleX:1.41,scaleY:1.41,x:27,y:-114},1e3),Fa.get(pb).wait(500).set(gd).to({alpha:1},900).wait(1720).call(w),null!==Od&&(Od.destroy(),Od=null),app.sound.play("oven_sounds2",{volume:.5}),++ed===cd.length&&(ed=0),ta([150,"yummy-bake"+cd[ed],qa]),la(),c+=sd?xe.challTest:xe.testing):ye===xe.testing?(W(),Fa.get(fe).to({y:-274},650,kd).wait(100).call(function(){Fb.removeChildAt(Fb.numChildren-1),vd?I():x()}),app.sound.play("slide_whoosh",{volume:.325}),c+=xe.naming):ye===xe.naming?(Ab.testing_bg.visible=Gb.visible=!1,C(),z(),c+=xe.building):ye===xe.challenge?(Ab.fishy_bg.visible=Hb.visible=!1,qd.uncache(),Fa.removeTweens(be),K(),c+=xe.choose):ye===xe.challTest?(Ab.fishy_bg.visible=Hb.visible=!1,qd.uncache(),rd.uncache(),Fa.removeTweens(be),xd?(C(),M(),c+=xe.decorate):(fe.visible=!1,z(),c+=xe.building)):ye===xe.deliver&&(Ab.fishy_bg.visible=delivCont.visible=Nb.visible=!1,y(),c+=xe.menu),app.trackevent("selectNext",{idorder:["coordinates","new_screen","prev_screen"],coordinates:{x:$c,y:_c,stage_width:app.display.width,stage_height:app.display.height},new_screen:c,prev_screen:b})}function r(a){ye===xe.building?(qb.removeEventListener("animationend",g),qb.stop(),h()):ye===xe.naming?(tb.removeEventListener("animationend",i),tb.stop(),tb.visible=!1):ye===xe.challTest&&(mouthSpr.removeEventListener("animationend",j),mouthSpr.stop()),app.sound.stopAll(),app.sound.play("hop5",{volume:.4}),va(),Fa.removeAllTweens(),Ab.hideAll(),Gc.visible=Fc.visible=!1,Ab.ruffpointer.visible=!0,y()}function s(a){app.sound.play("clickey",{volume:.4}),a.target.visible=!1,Nd=null;var b=Object.keys(je);""!==pe&&b.push(pe),app.trackevent("finishDecorating",{idorder:["serving_round","decorations","duration"],serving_round:Rc,decorations:b,duration:app.learning.stopTimer("decor_time")}),app.trackevent("selectNext",{idorder:["coordinates","new_screen","prev_screen"],coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height},new_screen:""+xe.payoff,prev_screen:""+ye}),N()}function t(a){app.sound.play("clickey",{volume:.4}),a.target.visible=Ab.testing_bg.visible=Gb.visible=!1,ia(),C(),app.trackevent("endRoundBuild",{idorder:["making_round","recipe_name","known_recipes","return_home","resets"],making_round:Bd.length-Xc,recipe_name:od[5],known_recipes:Bd.length,return_home:Bd.length>1,resets:Yc});var b=""+ye,c="";Bd.length<2?(z(),c+=xe.building):(y(),c+=xe.menu),app.trackevent("selectNext",{idorder:["coordinates","new_screen","prev_screen"],coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height},new_screen:c,prev_screen:b})}function u(a,b){app.sound.play("clickey",{volume:.4}),od[4]+=b.step;var c=od[4];b.opp.mouseEnabled||ga(b.opp,!0),(0===c||c===b.max)&&ga(this,!1),pd.text=c,sd?app.trackevent("changeBakeTime",{idorder:["coordinates","direction","bake_time","target_time"],coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height},direction:b.step>0?"increase":"decrease",bake_time:c,target_time:Bd[Qc][4]}):(ib.gotoAndStop("card_num_"+c),app.trackevent("changeBakeTimeBuild",{idorder:["coordinates","direction","bake_time"],coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height},direction:b.step>0?"increase":"decrease",bake_time:c})),wd||T(),ha(0!==c),0!==c?null===Od?Od=app.setTimeout(function(){sa("minute"+od[4])},750,!1,!1):Od.restart():null!==Od&&(Od.destroy(),Od=null)}function v(a){app.sound.play("clickey",{volume:.4}),a.target.visible=delivCont.visible=!1,app.trackevent("selectNext",{idorder:["coordinates","new_screen","prev_screen"],coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height},new_screen:""+xe.challenge,prev_screen:""+ye}),J()}function w(){sd?L():H(),null!==Od&&(Od.destroy(),Od=null)}function x(){function a(){ce.visible=be.visible=!1,ce.removeAllChildren(),Fb.removeChildAt(Fb.numChildren-1),I()}wb.visible=xb.visible=!0,Fb.addChild(ce),ce.addChild(be),Fa.get(be).set({visible:!0,scaleX:1,scaleY:1,x:-675-bd,y:140}).to({x:1024+bd},4e3).call(a),Fa.get(ce).set(gd).wait(1350).to({y:20},600).to({y:-20},1100).to({y:0},800),app.sound.play("new_recipe5",{volume:.6,delay:250})}function y(){ye=xe.menu,Bb.visible=Ab.fishy_bg.visible=!0,Ab.homebutton.visible=Nb.visible=!1,xc.set({scaleX:1,scaleY:1}),va(),Fa.removeAllTweens(),na(),C(),D(),2===Bd.length&&(fa(xc,!0),pa("have-enough")&&(ua("have-enough",150),wa("servecustomers"))),xd=!0,app.learning.removeTimer("round_time"),app.learning.removeTimer("dwell_time"),app.learning.removeTimer("decor_time"),app.learning.removeTimer("drag_time")}function z(){if(Ab.decorate_bg.visible=Ab.fishy_bg.visible=Bb.visible=$d.visible=_d.visible=Xd.visible=Wd.visible=Vd.visible=Ud.visible=wb.visible=xb.visible=qd.visible=rd.visible=!1,Ab.homebutton.visible=Nb.visible=qb.visible=be.visible=Ab.building_bg.visible=Cb.visible=Lb.visible=$d.visible=!0,ae.set(ze).set(Be),$d.x=-295,Ud.y=832,Vd.y=832,Wd.y=840,Xd.y=830,Rd.set({x:278,y:411,scaleX:1.15,scaleY:1.15}),Rd.addChildAt(be,1),rb.rotation=22,qb.addEventListener("animationend",g),Fa.get(be).set({scaleX:.62826,scaleY:.62826,x:-791-bd,y:-320}).to({x:-191,y:-295},1e3,ld).call(function(){qb.play()}),Fa.get(rb).wait(1050).to({rotation:0},220),app.sound.play("drone_whoosh",{volume:.25}),ye=xe.building,k(null),sd){Kb.visible=Ab.testing_bg.visible=!1;for(var b=0;4>b;b++)Ed[b].gotoAndStop("card_num_"+Bd[Qc][b]);pa("choose-again")?ua("choose-again",150):xd||(ta([150,"copy-card",qa]),wa("recipecopy"))}else{Yc=0,Jd.text="	RECIPE:";pa("chet-helped")?(Qd={type:"Instruction",descrip:"Initial instructions for the Make Cookies game mode: prompt to drag ingredients to bowl.",id:1,dur:app.captions.getLength("chet-helped")+250+app.captions.getLength("intro-adding")+500+app.captions.getLength("drag-to-bowl")+600+app.captions.getLength("intro-more")},ta(["chet-helped",250,"intro-adding",500,function(){wa("ingredients")},"drag-to-bowl",function(){ie["chet-helped"]=!0},600,"intro-more",qa,3e3,A])):yd&&ta([150,"another",qa]),app.trackevent("startRoundBuild",{idorder:["making_round","known_recipes"],making_round:Bd.length-Xc+1,known_recipes:Bd.length})}Sa=new springroll.easeljs.DragManager(app.display,a,e),Sa.dragStartThreshold=14}function A(){Pd=app.setTimeout(B,50)}function B(){wd||ud||ta(["need-one",qa]),Pd.destroy(),Pd=null}function C(){null!==fe.cacheCanvas&&fe.uncache(),null!==fe.parent&&fe.parent.removeChild(fe),fe.removeAllChildren()}function D(){null!==qd.cacheCanvas&&qd.uncache(),null!==rd.cacheCanvas&&rd.uncache(),null!==Md&&null!==Md.cacheCanvas&&Md.uncache(),null!==fe.cacheCanvas&&fe.uncache()}function E(){Ec.mouseEnabled=!1,app.sound.play("mix_dough",{volume:.5}),++dd===cd.length&&(dd=0),sa([800,"yummy-mix"+cd[dd]]);var a={rotation:-30},b={rotation:14},c=340;Fa.get(Mc).to({y:497,rotation:14},250).to(a,c).to(b,c).to(a,c).to(b,c).to(a,c).to(b,c).to(a,c).to(b,c).to(a,c).to(b,c).to(a,c).to(b,c).to(a,c).to(b,c),Fa.get(Zd).wait(250).to({rotation:1230},4760).call(T),Fa.get(kb).wait(250).to({rotation:1260},4760),Fa.get(ob).wait(250).to({alpha:0},1500),Fa.get(mb).wait(250).to({alpha:0},1500),Fa.get(nb).wait(1e3).to({alpha:1},666).wait(1100).to({alpha:0},500),Fa.get(lb).wait(1e3).to({alpha:1},666).wait(1100).to({alpha:0},500)}function F(){Sa.destroy(),ye=xe.mixing,Ab.building_bg.visible=Cb.visible=Lb.visible=$d.visible=!1,Ab.mixing_bg.visible=Db.visible=vb.visible=ub.visible=Zd.visible=kb.visible=Mc.visible=!0,pa("what-happen-mix")&&(qa(),ua("what-happen-mix",150)),ae.set(Be),Mc.set({y:293,rotation:-2}),ob.alpha=mb.alpha=.9,nb.alpha=lb.alpha=0,Zd.rotation=-30,kb.rotation=0,Ec.mouseEnabled=!0,vb.gotoAndStop("mix_bowl_"+ke),vb.set("zig"===ke?{x:316.5,y:534.5}:{x:363.5,y:545.5})}function G(){if(ye=xe.baking,Ab.mixing_bg.visible=Db.visible=pb.visible=Hd.visible=!1,Ab.baking_bg.visible=Eb.visible=Lb.visible=jb.visible=ib.visible=!0,sd)pa("recipe-time")&&(Qd={type:"Instruction",descrip:"Oven screen: Prompt to refer to recipe card for correct baking time in minutes.",id:4,dur:app.captions.getLength("recipe-time")},ua("recipe-time",150),wa("recipetime"));else if(pa("what-happen-bake")){var a={type:"Instruction",descrip:"Oven screen: Prompts to think about how what baking does and how long to cook the dough.",id:3,dur:app.captions.getLength("what-happen-bake")+300+app.captions.getLength("baking-choose")};sa([150,"what-happen-bake",function(){ie["what-happen-bake"]=!0},300,"baking-choose",Da],a)}else pa("baking-choose")&&(Qd={type:"Instruction",descrip:"Oven screen: Prompt to think about how long to bake cookie.",id:3,dur:app.captions.getLength("baking-choose")},ua("baking-choose",150));_d.set(Ce),Ab.baking_bg.set({scaleX:ad,scaleY:ad}),Td.set({x:167,y:145,scaleX:1,scaleY:1}),pb.alpha=0,Ic.alpha=Jc.alpha=1,ga(Ic,!1),ga(Jc,!0),pd.text="0",Kd.visible=sd,sd&&(Kd.text=Jd.text),ib.gotoAndStop("card_num_"+(sd?Bd[Qc][4]:"0")),jb.y=sd?110.5:87.5,ib.y=sd?106:83}function H(){ye=xe.testing,Ab.baking_bg.visible=Eb.visible=jb.visible=ib.visible=ce.visible=!1,Ab.testing_bg.visible=Fb.visible=Hd.visible=fe.visible=!0;var a=[1e3];pa("turned-into-cookie")?(a.push("turned-into-cookie",325,V,"lets-look"),ie["turned-into-cookie"]=!0):a.push(V,"lets-look"),a.push(function(){wa("feedback")});var b=-1,c=od[0],d=od[1],e=od[2],f=od[3],g=Math.ceil(od[4]/10),h=!1;1===g&&3>d&&(2!==c?(b=0,i=Ad[b][c-1]):h=!0),h||(-1===b&&(c>3&&d>1&&5>d?b=0:(1===d||5===d)&&4>c?b=1:2===c&3!==d?b=1:3===d&2!==c?b=0:2!==c&&3!==d&&(b=window.Math.randomInt(1))),5===g&&0===b&&c>2?b=3>d?1:-1:5===g&&1===b&&d>3&&(b=1===c?0:-1));var i="",j="";-1!==b?(i=Ad[b][od[b]-1],a.push("fback-"+we[b]+"-"+od[b],200),b=(1===e||5===e)&&f>1&&5>f?2:(1===f&&3>e||5===f)&&e>1&&5>e?3:1===f&&e>2?2:window.Math.randomInt(2,3),j=Ad[b][od[b]-1],a.push("fback-"+we[b]+"-"+od[b],200)):1===f&&e>2?(j=Ad[2][e-1],a.push("fback-"+we[2]+"-"+e,200)):(i=Ad[2][e-1],a.push("fback-"+we[2]+"-"+e,200),j=Ad[3][f-1],a.push("fback-"+we[3]+"-"+f,200));var k=Ad[4][g-1];a.push("fback-bake-"+g,1200,T),vd||(pa("recipe-save")?(a.push("recipe-save"),ie["recipe-save"]=!0):a.push("recipe-save2")),Hd.text=(""!==i?"•"+i+"\n•":"•")+j+"\n•"+k,S(od);var l=fe.getBounds();fe.set({regX:l.width/2,regY:l.height/2,x:568,y:1017,scaleX:.82,scaleY:.82}),Fb.addChild(fe),Fa.get(fe).to({y:446},680,ld),app.sound.play("slide_whoosh",{volume:.3});var m={type:"CorrectFeedback",descrip:"Newly created cookie is described, highlighting several attributes. Player is prompted to save it in recipe book.",id:5,dur:a.reduce(function(a,b){return"string"==typeof b?a+app.captions.getLength(b):"number"==typeof b?a+b:a})};a.push(Da),sa(a,m),app.trackevent("submitAnswerBuild",{idorder:["coordinates","new_recipe","current_recipe","known_recipes"],coordinates:{x:$c,y:_c,stage_width:app.display.width,stage_height:app.display.height},new_recipe:!vd,current_recipe:{eggs:od[0],butter:od[1],sugar:od[2],salt:od[3],bake_time:od[4]},known_recipes:Bd.length})}function I(){if(ye=xe.naming,Fb.visible=!1,
Gb.visible=sb.visible=!0,ga(Kc,!1),vd){var a=ma(Id.text);Qd={type:"IncorrectFeedback",descrip:"Warning about duplicate cookie (made one that was already in recipe book).",id:7,dur:12e3},ra(["already-made","n1-"+a[0],"n2-"+a[1],350,T,"already-made2",Da])}else{Gd=[m(),m(),m(),m(),m()],Uc=0,Id.text=Gd[0];var b=ma(Id.text);pa("refresh-name")?(ra([150,"n1-"+b[0],"n2-"+b[1],function(){wa("recipename")},"refresh-name",Da]),ie["refresh-name"]=!0):ra([150,"lets-name",150,"n1-"+b[0],"n2-"+b[1],Da]),Qd={type:"Instruction",descrip:"Hear current random cookie name; Prompt to choose/change name of the cookie.",id:6,dur:3e3}}ga(Lc,!vd),oa(),fe.set({scaleX:.54,scaleY:.54,x:251,y:540}),Yd.addChildAt(fe,1),tb.gotoAndStop("flip"),tb.addEventListener("animationend",i),Yd.set({y:1121,rotation:-12}),Fa.get(Yd).to({y:431,rotation:0},675,ld).wait(400).call(function(){sb.visible=!1,tb.visible=!0,tb.play()}),app.sound.play("slide_whoosh",{volume:.3})}function J(){ye=xe.challenge,sd=!0,Bb.visible=Ab.fishy_bg.visible=rd.visible=!1,Ab.homebutton.visible=Ab.fishy_bg.visible=Hb.visible=Nb.visible=be.visible=wb.visible=qd.visible=!0,Zc=0,Yc=0,qd.y=263,ae.set(ze).set(Be),T(500),ka(),Tc=Rc%3+1,Nc.gotoAndStop("cust"+Tc+"_order"),Nc.set(Fe[Tc-1]),mouthSpr.set(He[Tc-1]).gotoAndStop("mouth_closed"),Fa.get(de).set({y:80,scaleX:.925,scaleY:.925}).wait(50).to({y:0,scaleX:1,scaleY:1},750,md),S(Bd[Qc]);var a=fe.getBounds();fe.set({regX:a.width/2,regY:a.height/2,x:466,y:410,scaleX:.36,scaleY:.36}),be.addChild(fe),Hb.addChild(be),Fa.get(be).set({x:-100,y:-535,scaleX:.78,scaleY:.78}).to({x:247,y:83},1300,ld).call(X),app.sound.play("drone_whoosh",{volume:.25,delay:25});var b=ma(Bd[Qc][5]);Qd={type:"Instruction",descrip:"A new customer is here with an order for cookie: "+Bd[Qc][5],id:8,dur:app.captions.getLength("heres-cust"+Tc)+1966+app.captions.getLength("n1-"+b[0])+app.captions.getLength("n2-"+b[1])},sa(["heres-cust"+Tc,266,2===Tc?"she-wants":"he-wants",500,"n1-"+b[0],"n2-"+b[1],Da]),app.trackevent("startRound",{idorder:["serving_round","target_recipe","recipe_name"],serving_round:Rc,target_recipe:{eggs:Bd[Qc][0],butter:Bd[Qc][1],sugar:Bd[Qc][2],salt:Bd[Qc][3],bake_time:Bd[Qc][4]},recipe_name:Bd[Qc][5]}),app.learning.startTimer("round_time")}function K(){ye=xe.choose,Hb.visible=Nb.visible=!1,Kb.visible=Ab.testing_bg.visible=!0,fe.set({scaleX:.55,scaleY:.55,x:245.5,y:325.5}),ee.addChild(fe),ee.set({y:1113,rotation:-6}),Fa.get(ee).wait(100).to({y:448},600,ld),Fa.get(ee).wait(200).to({rotation:0},550,md),app.sound.play("slide_whoosh",{volume:.35,delay:120}),ra(150,"recipe-book")}function L(){ye=xe.challTest,Eb.visible=Ab.baking_bg.visible=Lb.visible=be.visible=!1,Ab.fishy_bg.visible=Hb.visible=Nb.visible=wb.visible=qd.visible=rd.visible=fe.visible=Nb.visible=!0,mouthSpr.gotoAndStop("mouth_closed"),Hb.addChild(be),be.set({x:-100,y:-535,scaleX:.78,scaleY:.78}),be.addChild(fe),fe.set({x:466,y:423,scaleX:.34,scaleY:.34});var b=[];xd=!0;for(var c=0;5>c;c++)od[c]!==Bd[Qc][c]&&(xd=!1,b.push((od[c]<Bd[Qc][c]?"more-":"less-")+we[c]));if(xd)qd.text="That’s a perfect";else{Zc++,oe=b[Math.floor(Math.random()*b.length)],qd.text="Not quite a";var d=rd.text.charAt();("A"===d||"E"===d||"I"===d||"O"===d||"U"===d)&&(qd.text+="n")}qd.y=256,rd.visible=!0,rd.color=xd?"#83c658":"#ff7d7b",null!==qd.cacheCanvas&&qd.uncache(),null!==rd.cacheCanvas&&rd.uncache();var e=qd.getMetrics();qd.cache(.5*-e.width-2,-e.height-2,e.width+4,e.height+14),e=rd.getMetrics(),rd.cache(.5*-e.width-2,-e.height-2,e.width+4,e.height+14);var f=od[0],g=Math.ceil(od[4]/10);Wa=new Ga(4>g?Tb:Ub,"e"+f+"_t"+g),e=Wa.getBounds(),Wa.set({visible:!1,regX:.75*e.width,regY:.9*e.height,scaleX:.18*ad,scaleY:.18*ad}),Ab.addChild(Wa),btnDragCookie.gotoAndStop("b_e"+f+"_t"+g),e=btnDragCookie.getBounds(),btnDragCookie.set({regX:e.width/2,regY:e.height/2,y:838}),btnDragCookie.visible=!0,Fa.get(btnDragCookie).wait(100).to({y:692},500,ld).call(R),Sa=new springroll.easeljs.DragManager(app.display,a,Q),Sa.dragStartThreshold=14,ra([150,"customer-feed"]),app.trackevent("submitAnswer",{idorder:["coordinates","correct","current_recipe","target_recipe"],coordinates:{x:$c,y:_c,stage_width:app.display.width,stage_height:app.display.height},correct:xd,current_recipe:{eggs:od[0],butter:od[1],sugar:od[2],salt:od[3],bake_time:od[4]},target_recipe:{eggs:Bd[Qc][0],butter:Bd[Qc][1],sugar:Bd[Qc][2],salt:Bd[Qc][3],bake_time:Bd[Qc][4]}})}function M(){ye=xe.decorate,Ab.testing_bg.visible=Hb.visible=!1,Ab.decorate_bg.visible=Ib.visible=Mb.visible=Fc.visible=!0,Fc.y=Fc.origY,Qd={type:"Instruction",descrip:"Prompt to decorate the cookie.",id:9,dur:app.captions.getLength("lets-decorate")},pa("lets-decorate")?ua("lets-decorate",150):ta([150,"decorate",qa]),ie["loving-this"]=!1,Wc=0,null===Md&&(Md=new Ia,Md.set({x:308,y:114}).setBounds(0,0,594,600),Md.addEventListener("mousedown",_),app.hasTouch||(Md.addEventListener("rollover",ca),Md.addEventListener("rollout",da)),Ib.addChild(Md),ac=new Ga(Sb,"btn_icing_on").set({x:42,y:205.5,name:"btn_icing",cursor:"pointer"}),_b=new Ga(Sb,"btn_candy").set({x:17,y:348,name:"btn_candy",cursor:"pointer"}),$b=new Ga(Sb,"btn_sprinkles").set({x:36.5,y:485.5,name:"btn_sprinkles",cursor:"pointer"}),ac.addEventListener("mousedown",Y),_b.addEventListener("mousedown",Y),$b.addEventListener("mousedown",Y),app.hasTouch||(ya(ac),ya(_b),ya($b)),bc=new Ga(Sb,"palette_bg"),Zb=new Ga(Sb,"pointer"),qc=new Ga(Sb,"icing_white_btn_on").set({x:165,y:139,name:"icing_white",cursor:"pointer"}),pc=new Ga(Sb,"icing_orange_btn").set({x:165,y:236,name:"icing_orange",cursor:"pointer"}),oc=new Ga(Sb,"icing_magenta_btn").set({x:165,y:333,name:"icing_magenta",cursor:"pointer"}),nc=new Ga(Sb,"icing_blue_btn").set({x:165,y:430,name:"icing_blue",cursor:"pointer"}),mc=new Ga(Sb,"icing_purple_btn").set({x:165,y:527,name:"icing_purple",cursor:"pointer"}),lc=new Ga(Sb,"peppermint_btn_on").set({x:179,y:173,name:"peppermint",cursor:"pointer",visible:!1}),kc=new Ga(Sb,"heart_btn").set({x:185,y:267,name:"heart",cursor:"pointer",visible:!1}),jc=new Ga(Sb,"snowflake_btn").set({x:179,y:352,name:"snowflake",cursor:"pointer",visible:!1}),ic=new Ga(Sb,"flower_btn").set({x:182,y:447,name:"flower",cursor:"pointer",visible:!1}),hc=new Ga(Sb,"candy_corn_btn").set({x:181,y:562,name:"candy_corn",cursor:"pointer",visible:!1}),gc=new Ga(Sb,"choc_chip_btn_on").set({x:180,y:199,name:"choc_chip",cursor:"pointer",visible:!1}),fc=new Ga(Sb,"star_btn").set({x:186,y:292,name:"star",cursor:"pointer",visible:!1}),ec=new Ga(Sb,"rainbow_btn").set({x:176,y:375,name:"rainbow",cursor:"pointer",visible:!1}),dc=new Ga(Sb,"sprinkles_btn").set({x:174,y:458,name:"sprinkles",cursor:"pointer",visible:!1}),cc=new Ga(Sb,"color_balls_btn").set({x:174,y:594,name:"color_balls",cursor:"pointer",visible:!1}),qc.addEventListener("mousedown",Z),pc.addEventListener("mousedown",Z),oc.addEventListener("mousedown",Z),nc.addEventListener("mousedown",Z),mc.addEventListener("mousedown",Z),lc.addEventListener("mousedown",Z),kc.addEventListener("mousedown",Z),jc.addEventListener("mousedown",Z),ic.addEventListener("mousedown",Z),hc.addEventListener("mousedown",Z),gc.addEventListener("mousedown",Z),fc.addEventListener("mousedown",Z),ec.addEventListener("mousedown",Z),dc.addEventListener("mousedown",Z),cc.addEventListener("mousedown",Z),he={btn_icing:[qc,pc,oc,nc,mc],btn_candy:[lc,kc,jc,ic,hc],btn_sprinkles:[gc,fc,ec,dc,cc]},Mb.addChild(ac,_b,$b,bc,Zb,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc)),bc.set({x:156,y:111}),Zb.set({x:142,y:249}),ac.gotoAndStop(ac.name+"_on"),ac.mouseEnabled=!1,_b.gotoAndStop(_b.name),_b.mouseEnabled=!0,$b.gotoAndStop($b.name),$b.mouseEnabled=!0;var b={mouseEnabled:!0,visible:!0,alpha:1},c={mouseEnabled:!1,visible:!1},d={mouseEnabled:!0,visible:!1};qc.gotoAndStop(qc.name+"_btn_on"),qc.set({mouseEnabled:!1,visible:!0,alpha:1}),pc.gotoAndStop(pc.name+"_btn"),pc.set(b),oc.gotoAndStop(oc.name+"_btn"),oc.set(b),nc.gotoAndStop(nc.name+"_btn"),nc.set(b),mc.gotoAndStop(mc.name+"_btn"),mc.set(b),lc.gotoAndStop(lc.name+"_btn_on"),lc.set(c),kc.gotoAndStop(kc.name+"_btn"),kc.set(d),jc.gotoAndStop(jc.name+"_btn"),jc.set(d),ic.gotoAndStop(ic.name+"_btn"),ic.set(d),hc.gotoAndStop(hc.name+"_btn"),hc.set(d),gc.gotoAndStop(gc.name+"_btn_on"),gc.set(c),fc.gotoAndStop(fc.name+"_btn"),fc.set(d),ec.gotoAndStop(ec.name+"_btn"),ec.set(d),dc.gotoAndStop(dc.name+"_btn"),dc.set(d),cc.gotoAndStop(cc.name+"_btn"),cc.set(d),Yb=ac,ge={btn_icing:qc,btn_candy:lc,btn_sprinkles:gc},le="icing_white",td=!1,Nd=null;var e={};switch(od[0]){case 1:e={x:0,y:0};break;case 2:e={x:34,y:38};break;case 3:e={x:50,y:43};break;case 4:e={x:35,y:10};break;case 5:e={x:35,y:24}}var f=Math.ceil(od[4]/10),g=new Ga(4>f?Tb:Ub,"e"+od[0]+"_t"+f).set(e),h=g.getBounds();Md.addChild(g);var i=od[2],j=od[3];if(i>1){var k=new Ga(Ub,"sug"+i),l=k.getBounds();k.set({regX:l.width/2,regY:l.height/2,x:e.x+h.width/2,y:e.y+h.height/2-5}),Md.addChild(k)}if(j>1){var m=new Ga(Ub,"sal"+j),n=m.getBounds();m.set({regX:n.width/2,regY:n.height/2,x:e.x+h.width/2,y:e.y+h.height/2-25}),Md.addChild(m)}Md.icingIdx=Md.numChildren,Va.gotoAndStop("icing_white_drag");var o=Va.getBounds();Va.set({visible:!1,regX:o.width/2,regY:o.height/2,rotation:0,scaleX:ad,scaleY:ad}),Sa=new springroll.easeljs.DragManager(app.display,a,$),Sa.dragStartThreshold=14,Sa.multitouch=!1,pe="",je={},app.trackevent("startDecorating",{idorder:["serving_round"],serving_round:Rc}),app.learning.startTimer("decor_time")}function N(){ye=xe.payoff,Va.visible=Ib.visible=Mb.visible=Fc.visible=!1,Jb.visible=!0,Sa.destroy();var a=Md.getBounds();Md.cache(0,0,a.width,a.height,.23);var b=Md.cacheCanvas,c=new Ja(b).set({x:261,y:204}),d=new Ja(b).set({x:434,y:204}),e=new Ja(b).set({x:607,y:204}),f=new Ja(b).set({x:261,y:358}),g=new Ja(b).set({x:434,y:358}),h=new Ja(b).set({x:607,y:358}),i=new Ja(b).set({x:261,y:512}),j=new Ja(b).set({x:434,y:512}),k=new Ja(b).set({x:607,y:512});Jb.addChild(yb,c,d,e,f,g,h,i,j,k,zb),ra("nice-job"),Fa.get(zb).set({scaleX:2.25,scaleY:2.25,alpha:0}).wait(1500).to({scaleX:1,scaleY:1,alpha:1},2e3,kd).wait(1400).call(O),Fa.get(zb).wait(1500).to({alpha:1},750)}function O(){if(ye=xe.deliver,Ab.decorate_bg.visible=Jb.visible=!1,Ab.fishy_bg.visible=delivCont.visible=Nb.visible=!0,Jb.removeAllChildren(),Md.uncache(),Md.removeAllChildren(),Oc.gotoAndStop("cust"+Tc+"_payoff"),Oc.set(Ge[Tc-1]),Rc-Sc===2)uc.visible=vc.visible=wc.visible=!1,T(),ra("make-more");else{var a=(Rc+1)%3;uc.visible=0===a,vc.visible=1===a,wc.visible=2===a,ra("tap-to-serve")}app.trackevent("endRound",{idorder:["serving_round","duration","misses","resets","return_home"],serving_round:Rc,duration:app.learning.stopTimer("round_time"),misses:Zc,resets:Yc,return_home:Rc-Sc===2})}function P(a){btnDragCookie.set({visible:!1,scaleX:1,scaleY:1}),Fa.removeTweens(btnDragCookie),mouthSpr.gotoAndStop("mouth_open"),app.sound.play("pick_up",{volume:.4}),Wa.set({visible:!0,x:a.stageX,y:a.stageY}),Sa.multitouch=!1,Sa.startDrag(Wa,a)}function Q(){var a=Hb.globalToLocal(Wa.x,Wa.y);re.contains(a.x,a.y)?(mouthSpr.addEventListener("animationend",j),mouthSpr.gotoAndPlay("chew"),Sa.destroy(),Ab.removeChild(Wa),Wa=null,app.sound.play("chew_cookie")):(app.sound.play("drop_bad",{volume:.8}),mouthSpr.gotoAndStop("mouth_closed"),btnDragCookie.visible=!0,Wa.visible=!1),zd=!0}function R(){Fa.get(btnDragCookie,{loop:!0}).to({scaleX:.925,scaleY:.925},900).to({scaleX:1,scaleY:1},900)}function S(a){var b=a[0],c=(a[1],a[2]),d=a[3],e=Math.ceil(a[4]/10),f=new Ga(4>e?Tb:Ub,"e"+b+"_t"+e),g=f.getBounds();if(fe.addChild(f),c>1){var h=new Ga(Ub,"sug"+c),i=h.getBounds();h.set({regX:i.width/2,regY:i.height/2,x:g.width/2,y:g.height/2-5}),fe.addChild(h)}if(d>1){var j=new Ga(Ub,"sal"+d),k=j.getBounds();j.set({regX:k.width/2,regY:k.height/2,x:g.width/2,y:g.height/2-25}),fe.addChild(j)}fe.cache(0,0,g.width,g.height)}function T(a){wd=!0,void 0===a&&(a=0),Fa.get(ae).wait(a).set(gd).to(Ae,275,ld).set(id)}function U(){wd=!1,Fa.get(ae).set(jd).to(Be,250,kd).set(hd,tc).set(hd)}function V(){Fa.get(_d).set(gd).wait(1100).to(Ce,400,ld)}function W(){Fa.get(_d).to(De,285,kd).set(hd)}function X(){Fa.get(be,{loop:!0}).to({y:73},3350).to({y:83},3350)}function Y(a){var b=a.target;Yb.gotoAndStop(Yb.name),Yb.mouseEnabled=!0,b.gotoAndStop(b.name+"_on"),b.mouseEnabled=!1,he[Yb.name].forEach(function(a,b,c){a.visible=!1}),he[b.name].forEach(function(a,c,d){a.visible=!0,"btn_icing"===b.name?null!==Nd&&(a.mouseEnabled=a.name!==Nd.currentAnimation,a.alpha=a.mouseEnabled?1:.2):(a.mouseEnabled=!0,a.alpha=a.mouseEnabled?1:.2)}),"btn_icing"===b.name?(bc.y=111,Zb.y=249):"btn_candy"===b.name?(bc.y=141,Zb.y=391):"btn_sprinkles"===b.name&&(bc.y=171,Zb.y=524),Yb=b,le=ge[Yb.name].name,Va.gotoAndStop("btn_icing"===Yb.name?le+"_drag":le);var c=Va.getBounds();Va.set({visible:!1,regX:c.width/2,regY:c.height/2,rotation:"btn_icing"===Yb.name?0:window.Math.randomInt(359),scaleX:ad,scaleY:ad})}function Z(a){var b=a.target;b.name!=le&&(ge[Yb.name].gotoAndStop(ge[Yb.name].name+"_btn"),ge[Yb.name].mouseEnabled=!0,b.gotoAndStop(b.name+"_btn_on"),ge[Yb.name]=b,le=b.name),b.alpha=.2,ba(!1);var c="btn_icing"===Yb.name;c&&td&&(td=!1),Va.gotoAndStop(c?le+"_drag":le);var d=Va.getBounds(),e={visible:!0,regX:d.width/2,regY:d.height/2,x:a.stageX,y:a.stageY,scaleX:ad,scaleY:ad};e.rotation=c?0:window.Math.randomInt(359),Va.set(e),Hc.update(),Sa.multitouch=!1,Sa.startDrag(Va,a),Md.mouseEnabled=!1,app.sound.play("pick_up",{volume:.4})}function $(){var a=Md.globalToLocal(Va.x,Va.y);Md.hitTest(a.x,a.y)?_(null,a):(Va.visible=!1,ba(!0)),Md.mouseEnabled=!0,zd=!0}function _(a,b){if(Dc.mouseEnabled||fa(Dc,!0),app.sound.play("drop",{volume:.4}),"btn_icing"===Yb.name)null===Nd?(Nd=new Ga(Sb,le).set({x:71,y:63}),Md.addChildAt(Nd,Md.icingIdx)):Nd.currentAnimation!==le&&Nd.gotoAndStop(le),ge[Yb.name].gotoAndStop(ge[Yb.name].name+"_btn"),td=!0,app.hasTouch||da(),pe=le;else{var c=null!==a?new Oa(a.localX,a.localY):b,d=new Ga(Sb,le),e=d.getBounds();d.set({regX:e.width/2,regY:e.height/2,x:c.x,y:c.y,rotation:Va.rotation}),Va.rotation=window.Math.randomInt(359),Md.addChild(d),pa("loving-this")&&!ud&&++Wc>2&&ua("loving-this"),je[le]=!0}app.hasTouch&&(Va.visible=!1),ba(!0)}function aa(){app.sound.play("clickey",{volume:.4}),Nd=null;for(var a=Md.numChildren-1;a>=Md.icingIdx;a--)Md.removeChildAt(a);fa(Dc,!1),ie["loving-this"]=!1,Wc=0}function ba(a){a?he[Yb.name].forEach(function(a,b,c){a.mouseEnabled="btn_icing"!==Yb.name||null===Nd||a.name!==Nd.currentAnimation,a.alpha=a.mouseEnabled?1:.2}):he[Yb.name].forEach(function(a,b,c){a.mouseEnabled=!1})}function ca(a){"btn_icing"===Yb.name&&td||(Va.visible=!0,ea(a),Hc.update(),Hc.addEventListener("stagemousemove",ea))}function da(){Va.visible=!1,Hc.hasEventListener("stagemousemove")&&Hc.removeEventListener("stagemousemove",ea)}function ea(a){Va.set({x:a.stageX,y:a.stageY})}function fa(a,b){a.mouseEnabled=b,a.alpha=b?1:.275}function ga(a,b){a.mouseEnabled=b,a.getChildAt(1).alpha=b?1:.2}function ha(a){ae.mouseEnabled=a,sc.visible=!a}function ia(){yd||(yd=!0),od[5]=Gd[Uc];var a=Bd.push(od.slice())-1;Vc=Cd.push(a)-1,xa()}function ja(){Cd=Array.apply(null,Array(Bd.length)).map(function(a,b){return b}),Vc=-1}function ka(){Rc++,0===Cd.length&&ja(),Qc=Cd.splice(Vc>-1?Vc:Math.floor(Math.random()*Cd.length),1)[0],Vc=-1,Jd.text=qd.text=rd.text=Ld.text=Bd[Qc][5];var a=qd.getMetrics();qd.cache(.5*-a.width-2,-a.height-2,a.width+4,a.height+14)}function la(){vd=!1;for(var a=Bd.length;--a>=0;)if(Bd[a][0]===od[0]&&Bd[a][1]===od[1]&&Bd[a][2]===od[2]&&Bd[a][3]===od[3]&&Bd[a][4]===od[4]){vd=!0;break}vd&&(Id.text=Bd[a][5])}function ma(a){return a.toLowerCase().split(" ",2)}function na(){qb.visible=wb.visible=qd.visible=rd.visible=xb.visible=!1,rb.rotation=0}function oa(){Id.y=Id.getMetrics().lines.length>1?294:314}function pa(a){return!ie.hasOwnProperty(a)||!ie[a]}function qa(){ud=!1,Da()}function ra(a){Ab.ruffpointer.stoptalking(),Ab.ruffpointer.saythings(a),null!==Qd&&Ca()}function sa(a,b){qa(),Ab.ruffpointer.stoptalking(),Ab.ruffpointer.saythings(a),void 0!==b&&(Qd=b,Ca())}function ta(a){ud=!0,Ab.ruffpointer.stoptalking(),Ab.ruffpointer.saythings(a),null!==Qd&&Ca()}function ua(a,b){ud=!0;var c=void 0!==b?[b,a,qa]:[a,qa];Ab.ruffpointer.stoptalking(),Ab.ruffpointer.saythings(c),ie[a]=!0,null!==Qd&&Ca()}function va(){qa(),Ab.ruffpointer.stoptalking()}function wa(a){var b=app.config.ruffmoves[a];b&&Ab.ruffpointer.makemoves(b)}function xa(){app.saveuserdata("recipeBook",Bd)}function ya(a){a.addEventListener("rollover",za),a.addEventListener("rollout",Aa),a.addEventListener("mousedown",Aa)}function za(){app.learning.startTimer("dwell_time")}function Aa(a){if(void 0!==app.learning._timers.dwell_time){var b=app.learning.stopTimer("dwell_time");!isNaN(parseInt(b))&&b>1e3&&app.trackevent("dwellTime",{idorder:["dwell_time","object"],dwell_time:b,object:a.target.name||"N/A"})}}function Ba(a){zd?zd=!1:app.trackevent("offClick",{idorder:["coordinates"],coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height}})}function Ca(){app.trackevent("start"+Qd.type,{idorder:["description","identifier","media_type","total_duration"],description:Qd.descrip,identifier:""+Qd.id,media_type:"audio",total_duration:Qd.dur})}function Da(){null!==Qd&&(null!==app.learning._feedback&&app.trackevent("end"+Qd.type),Qd=null)}var Ea=include("springroll.easeljs.BaseState"),Fa=include("createjs.Tween"),Ga=include("createjs.Sprite"),Ha=include("createjs.SpriteSheet"),Ia=include("createjs.Container"),Ja=include("createjs.Bitmap"),Ka=include("springroll.easeljs.Button"),La=include("createjs.Shape"),Ma=include("createjs.Graphics"),Na=include("createjs.Text"),Oa=include("createjs.Point"),Pa=include("WGBH.GamePanel"),Qa=function(a){Ea.call(this,new Pa,a)},Ra=extend(Qa,Ea);Ra.enterDone=function(){Hc=app.display.stage,Ab=this.panel,this.beginGame(),b(),app.on("resize",b)};var Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,_b,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,Ac,Bc,Cc,Dc,Ec,Fc,Gc,Hc,Ic,Jc,Kc,Lc,Mc,Nc,Oc,Pc=80,Qc=0,Rc=0,Sc=0,Tc=0,Uc=0,Vc=-1,Wc=0,Xc=0,Yc=0,Zc=0,$c=0,_c=0,ad=1,bd=0,cd=[0,3,1,2,1,3,0,2,1,2,0,3,0,2,1,3,2,0,3,1,2,1,3,0,3,1,2,0,3,0,2,1],dd=window.Math.randomInt(cd.length-1),ed=window.Math.randomInt(cd.length-1),fd=[[60],[45,75],[30,60,90],[15,45,75,105],[0,30,60,90,120]],gd={visible:!0},hd={visible:!1},id={mouseEnabled:!0},jd={mouseEnabled:!1},kd=createjs.Ease.circIn,ld=createjs.Ease.circOut,md=(createjs.Ease.circInOut,createjs.Ease.backOut),nd="#202b7a",od=[0,0,0,0,0,""],pd=new Na("0","bold 60px poppins,helvetica,arial","#fff").set({x:347,y:76,textAlign:"center",textBaseline:"alphabetic"}),qd=new Na("","600 35px poppins,helvetica,arial",nd).set({x:466,textAlign:"center",textBaseline:"alphabetic"}),rd=new Na("","bold 34px poppins,helvetica,arial").set({x:466,y:300,textAlign:"center",textBaseline:"alphabetic"}),sd=!1,td=!1,ud=!1,vd=!1,wd=!1,xd=!0,yd=!1,zd=!1,Ad=[["Puffy","","Chewy","Runny","Very runny"],["Very hard","Hard","","Soft","Very soft"],["Not sweet","A little sweet","Sweet","Very sweet","Super sweet"],["A bit plain","Slightly salty","Salty","Very salty","Super salty"],["Raw","Light brown","Golden","Dark brown","Pretty burnt"]],Bd=[],Cd=[],Dd=[],Ed=[],Fd=[],Gd=[],Hd=new Na("","600 33px poppins,helvetica,arial",nd).set({x:27,y:52,lineHeight:58,textBaseline:"alphabetic"}),Id=new Na("","bold 33px poppins,helvetica,arial",nd).set({x:249,textAlign:"center",lineHeight:40,lineWidth:262,textBaseline:"alphabetic"}),Jd=new Na("","bold 26px poppins,helvetica,arial",nd).set({x:9,y:185,textBaseline:"alphabetic"}),Kd=new Na("","bold 27px poppins,helvetica,arial",nd).set({x:12,y:60,textBaseline:"alphabetic"}),Ld=new Na("","bold 35px poppins,helvetica,arial",nd).set({x:245,y:99,textAlign:"center",textBaseline:"alphabetic"}),Md=null,Nd=null,Od=null,Pd=null,Qd=null,Rd=new Ia,Sd=new Ia,Td=new Ia,Ud=new Ia,Vd=new Ia,Wd=new Ia,Xd=new Ia,Yd=(new Ia,new Ia),Zd=new Ia,$d=new Ia,_d=new Ia,ae=new Ia,be=new Ia,ce=new Ia,de=new Ia,ee=new Ia,fe=new Ia,ge={},he={},ie={},je={},ke="zig",le="",me="",ne="",oe="",pe="",qe=new createjs.Rectangle(280,28,564,506),re=new createjs.Rectangle(28,144,449,489),se=["Ample","Aromatic","Baked","Bitter","Blended","Buttery","Candied","Cheesy","Chilled","Choice","Classic","Classy","Cool","Creamy","Crisp","Crumbly","Crunchy","Dazzling","Dreamy","Drizzled","Edible","Famous","Fizzy","Flaky","Fresh","Gourmet","Greasy","Intense","Juicy","Jumbo","Lush","Mellow","Minty","Mushy","Organic","Savory","Silky","Special","Sticky","Superb","Topped","Velvety","Yummy","Zingy"],te=["Bazinga","Beaker","Bockle","Bonanza","Campus","Coddler","Daddle","Dasher","Doggle","Flimble","Foodle","Gardy","Gorgon","Gruffin","Gubbin","Gulpy","Higgle","Hoople","Jabber","Jibber","Lunker","Malark","Noddy","Noggin","Podge","Puppy","Razzle","Rumpus","Skibbet","Scuttle","Skimmer","Snolly","Squee","Switch","Taloonk","Wobble","Woggle","Wombat"],ue=se.slice().shuffle(),ve=te.slice().shuffle(),we=["eggs","butter","sugar","salt","bake"],xe=new springroll.Enum("menu","building","mixing","baking","testing","naming","challenge","decorate","payoff","deliver","book","challTest","choose"),ye=xe.menu,ze={visible:!1,mouseEnabled:!1},Ae={x:111,y:421,scaleX:1,scaleY:1,rotation:0},Be={x:335,y:400,scaleX:1.2,scaleY:1.2,rotation:15},Ce={x:0,scaleX:1,scaleY:1,rotation:0,visible:!0},De={x:-375,scaleX:1.1,scaleY:1.1,rotation:-7},Ee=[{x:477.5,y:86},{x:474,y:92.5},{x:472.5,y:4.5},{x:544,y:10.5}],Fe=[{regX:188.5,regY:210.5,x:249.5,y:456.5},{regX:282,regY:313,x:240,y:451},{regX:243.5,regY:277.5,x:236.5,y:427.5}],Ge=[{x:243,y:290},{x:121,y:101},{x:166,y:108}],He=[{x:193,y:374,rotation:-3,scaleX:.85,scaleY:.85},{x:175,y:389,rotation:-4,scaleX:1,scaleY:1},{x:200,y:388,rotation:2,scaleX:1,scaleY:1}];Ra.beginGame=function(){Ob=new c("buildSprites"),Qb=new c("bowlSprites"),Rb=new c("ovenSprites"),Sb=new c("decorSprites"),Tb=new c("cookieSprites123"),Ub=new c("cookeSprites45"),Pb=new c("ingredSprites"),Vb=new c("charSprites"),Wb=new c("droneSprites"),Xb=new c("bookSprites"),Bb=Ab.menuCont,Cb=Ab.buildCont,Db=Ab.mixCont,Eb=Ab.bakingCont,Fb=Ab.testCont,Gb=Ab.nameCont,Hb=Ab.challCont,Kb=Ab.chooseCont,Ib=Ab.decorCont,Jb=Ab.payoffCont,delivCont=Ab.delivCont,Lb=Ab.leftCont,Mb=Ab.toolsCont,Nb=Ab.rightCont;var a=app.hasTouch?"mousedown":"click",b=new Ka(app.getCache("menu_btn_make")).set({x:123,y:279,name:"btn_make"});b.addEventListener(a,o),xc=new Ka(app.getCache("menu_btn_serve")).set({x:554,y:279,name:"btn_serve"}),xc.addEventListener(a,p),fa(xc,!1),Bb.addChild(b,xc,new Ja(app.getCache("counter_menu")).set({regX:682.5,x:512,y:652})),Ab.homebutton.addEventListener(a,r);var e=new Ga(Wb,"drone_chet"),g=new Ga(Wb,"drone_blades").set({y:44,framerate:15});rb=new Ga(Wb,"drone_claw_sm").set({regX:4,regY:18,x:449,y:158}),qb=new Ga(Wb,"pour_flour").set({x:432,y:173,scaleX:1.5916977,scaleY:1.5916977,paused:!0,framerate:15}),wb=new Ga(Wb,"drone_pad_sq").set({x:259,y:173}),xb=new Ga(Xb,"new_recipe").set({x:285,y:205}),be.addChild(e,g,qb,wb,qd,rd,xb,rb);var h=new Ga(Qb,"bowl_bg").set({x:2}),i=new Ga(Qb,"bowl_fg_zig").set({y:21,name:"skin"});Rd.addChild(h,i),Rd.set({origX:313,origY:237}),Cb.addChild(Rd),Sd.set({x:Rd.origX-1024,y:Rd.origY,visible:!1,alpha:0,origX:Rd.origX-1024}),Sd.addChild(h.clone(),i.clone()),Cb.addChild(Sd),Ud.set({x:158,origX:158,origY:626}),Vd.set({x:356,origX:356,origY:626}),Wd.set({x:570,origX:570,origY:634}),Xd.set({x:775,origX:775,origY:624});var j=new Ga(Ob,"marker_full").set({y:89,visible:!1}),l=j.clone().set({y:89}),m=j.clone().set({y:81}),w=j.clone().set({y:91});Dd=[[j,j.clone(),j.clone(),j.clone(),j.clone()],[l,l.clone(),l.clone(),l.clone(),l.clone()],[m,m.clone(),m.clone(),m.clone(),m.clone()],[w,w.clone(),w.clone(),w.clone(),w.clone()]];var x=0;for(x=0;5>x;x++)Ud.addChild(Dd[0][x]);for(x=0;5>x;x++)Vd.addChild(Dd[1][x]);for(x=0;5>x;x++)Wd.addChild(Dd[2][x]);for(x=0;5>x;x++)Xd.addChild(Dd[3][x]);var y=new Ga(Ob,"label_egg").set({x:48,y:56});Ud.addChild(y);var A=new Ga(Ob,"label_butter").set({x:38,y:56});Vd.addChild(A);var B=new Ga(Ob,"label_sugar").set({x:38,y:48});Wd.addChild(B);var C=new Ga(Ob,"label_salt").set({x:50,y:58});Xd.addChild(C),yc=new Ga(Ob,"egg_shdw").set({x:78,cursor:"pointer",idx:0,name:"egg"});var D=yc.getBounds();yc.hitArea=new La((new Ma).f("#000").dr(-5,-5,D.width+10,D.height+10)),yc.regX=D.width/2,yc.regY=D.height/2,yc.addEventListener("mousedown",d),Ud.addChild(yc),Bc=new Ga(Ob,"butter_shdw").set({x:71,cursor:"pointer",idx:1,name:"butter"}),D=Bc.getBounds(),Bc.hitArea=new La((new Ma).f("#000").dr(-5,-5,D.width+10,D.height+10)),Bc.regX=D.width/2,Bc.regY=D.height/2,Bc.addEventListener("mousedown",d),Vd.addChild(Bc),Ac=new Ga(Ob,"sugar_shdw").set({x:53,cursor:"pointer",idx:2,name:"sugar"}),D=Ac.getBounds(),Ac.hitArea=new La((new Ma).f("#000").dr(-5,-5,D.width+10,D.height+10)),Ac.regX=D.width/2,Ac.regY=D.height/2,Ac.addEventListener("mousedown",d),Wd.addChild(Ac),zc=new Ga(Ob,"salt_shdw").set({x:74,cursor:"pointer",idx:3,name:"salt"}),D=zc.getBounds(),zc.hitArea=new La((new Ma).f("#000").dr(-5,-5,D.width+10,D.height+10)),zc.regX=D.width/2,zc.regY=D.height/2,zc.addEventListener("mousedown",d),Xd.addChild(zc),Cb.addChild(Ud,Vd,Wd,Xd),Xa=new Ga(Pb).set({paused:!0,visible:!1,framerate:15}),Xa.addEventListener("animationend",f),Cb.addChild(Xa),Ua=new Ga(Ob),Ua.visible=!1,Ab.addChild(Ua);var F=new Ga(Ob,"recipe_card").set({x:-6,y:135});Ya=new Ga(Ob,"card_egg").set({x:80,y:228}),Za=new Ga(Ob,"card_butter").set({x:71,y:298}),$a=new Ga(Ob,"card_sugar").set({x:66,y:370}),_a=new Ga(Ob,"card_salt").set({x:76,y:437}),ab=new Ga(Ob,"card_egg_lab").set({x:130,y:235}),bb=new Ga(Ob,"card_butter_lab").set({x:130,y:305}),cb=new Ga(Ob,"card_sugar_lab").set({x:130,y:379}),db=new Ga(Ob,"card_salt_lab").set({x:130,y:459}),eb=new Ga(Ob,"card_num_0").set({x:26,y:230}),fb=eb.clone().set({y:300}),gb=eb.clone().set({y:374}),hb=eb.clone().set({y:454}),Ed=[eb,fb,gb,hb],$d.addChild(F,Ya,Za,$a,_a,db,cb,bb,ab,eb,fb,gb,hb,Jd),Cc=new Ka(app.getCache("trash_btn")).set({x:24,y:640,name:"trash_making"}),Cc.addEventListener(a,k),fa(Cc,!1),$d.addChild(Cc),Lb.addChild($d),Fc=new Ka(app.getCache("check_btn")).set({x:104,origY:642,visible:!1,name:"btn_done"}),Fc.addEventListener(a,s),Nb.addChild(Fc),Gc=new Ka(app.getCache("save_btn")).set({x:104,origY:642,visible:!1,name:"btn_save"}),Gc.addEventListener(a,t),Nb.addChild(Gc),ub=new Ga(Qb,"mix_bowl_base").set({x:225,y:216.5}),vb=new Ga(Qb),Db.addChild(ub,vb),Zd.addChild(new Ga(Qb,"orange_dough")),Zd.set({regX:295,regY:286,x:507,y:560,mask:new La((new Ma).f("#000").de(257,230,522,298))}),kb=Zd.clone(!0).set({scaleX:.65,scaleY:.65,rotation:180}),ob=new Ga(Qb,"white_dough"),nb=new Ga(Qb,"chunks").set({regX:220,regY:208.5,x:287,y:228}),Zd.addChild(ob,nb),mb=ob.clone(),lb=nb.clone(),kb.addChild(mb,lb),Mc=new Ga(Qb,"mixing_spoon").set({regX:39,regY:401,x:530}),Ec=new La,Ec.hitArea=new La((new Ma).f("#000").dr(233,0,570,660)),Ec.cursor="pointer",Ec.name="mixing_bowl",Ec.addEventListener("mousedown",E),Db.addChild(Zd,Mc,kb,Ec),rc=new Ga(Vb,"blossom_arr"),sc=new Ga(Ob,"white_box").set({x:88,y:287,alpha:.85,visible:!1}),tc=new Ga(Vb,"bloss_icn_retry2").set({x:66,y:278,visible:!1}),ae.addChild(rc,sc,tc),ae.set({regX:111,regY:204,cursor:"pointer",name:"blossom_side"}),ae.mouseChildren=!1,ae.addEventListener("mousedown",q),Nb.addChild(ae);var G=new Ga(Ob,"gray_box").set({scaleX:105/32,scaleY:3.25});Ic=new Ka(app.getCache("oven_btn_dn")).set({x:162,y:3,name:"dec_oven_time"}),Ic.addChildAt(G,0),Jc=new Ka(app.getCache("oven_btn_up")).set({x:428,y:3,name:"inc_oven_time"}),Jc.addChildAt(G.clone(),0),Ic.on("mousedown",u,null,!1,{step:-5,max:50,opp:Jc}),Jc.on("mousedown",u,null,!1,{step:5,max:50,opp:Ic});var H=new Ga(Rb,"oven_door").set({x:44,y:210});pb=new Ga(Rb,"oven_tint").set({x:44,y:210}),Td.addChild(new Ga(Rb,"oven"),pb,H,Ic,Jc,pd),Td.set({x:167,y:145}),Eb.addChild(Td);var I=new Ga(Ob,"recipe_card_sm").set({x:-6});ib=new Ga(Ob,"card_num_0").set({x:96}),jb=new Ga(Ob,"card_time_lab").set({x:14}),_d.addChild(I,Kd,jb,ib,Hd),_d.y=303,Lb.addChild(_d),Yd.set({regX:255,regY:470,x:531});var J=new Ga(Xb,"book_base").set({x:2,y:213}),K=new Ga(Ob,"white_box").set({x:114,y:253,scaleX:270/65,scaleY:2.06});sb=new Ga(Xb,"book_cover").set({y:209});var L=new Ga(Xb,"book_rings").set({x:90,y:161});tb=new Ga(Xb,"flip").set({x:1,paused:!0,framerate:7.5,visible:!1});var M=new Ga(Ob,"yellow_box").set({scaleX:105/32,scaleY:105/32});Kc=new Ka(app.getCache("name_arr_left")).set({x:9,y:252,name:"btn_prev_name"}),Kc.addChildAt(M,0),Lc=new Ka(app.getCache("name_arr_right")).set({x:383,y:252,name:"btn_next_name"}),Lc.addChildAt(M.clone(),0),Kc.addEventListener("mousedown",n),Lc.addEventListener("mousedown",n),Yd.addChild(J,K,Id,Kc,Lc,sb,L,tb),Gb.addChild(Yd),Nc=new Ga(Vb),mouthSpr=new Ga(Vb).set({framerate:30}),de.addChild(Nc,mouthSpr),Hb.addChild(de,new Ja(app.getCache("counter_cust")).set({regX:682.5,x:512,y:610})),ee.addChild(J.clone().set({x:0,y:0}),new Ga(Xb,"page_button").set({x:-1}),L.clone().set({x:86,y:-49}),Ld),ee.set({regX:251,regY:281,x:512,cursor:"pointer",name:"cookie_in_recipe_book"}),ee.mouseChildren=!1,ee.addEventListener("mousedown",z),Kb.addChild(ee),btnDragCookie=new Ga(Ub).set({x:516,visible:!1,cursor:"pointer",name:"cookie_to_feed"}),btnDragCookie.addEventListener("mousedown",P),Hb.addChild(btnDragCookie),yb=new Ga(Vb,"cookie_box").set({x:191,y:146.5}),zb=new Ga(Vb,"cookie_box_top").set({regX:327.5,regY:289,x:497.5,y:427}),Oc=new Ga(Vb),delivCont.addChild(Oc);var N={x:68,y:350,visible:!1,name:"btn_next_customer"};uc=new Ka(app.getCache("cust_btn1")).set(N),vc=new Ka(app.getCache("cust_btn2")).set(N),wc=new Ka(app.getCache("cust_btn3")).set(N),uc.addEventListener(a,v),vc.addEventListener(a,v),wc.addEventListener(a,v),Nb.addChild(uc,vc,wc),Va=new Ga(Sb),D=Va.getBounds(),Va.set({visible:!1,regX:D.width/2,regY:D.height/2}),Ab.addChild(Va),Dc=new Ka(app.getCache("trash_btn")).set({x:24,y:650,name:"trash_decorate"}),Dc.addEventListener(a,aa),fa(Dc,!1),Mb.addChild(Dc);var O=app.getuserdata("recipeBook");if(O){Bd=[];var Q=-1;for(var R in O)Q=O[R][5].indexOf("Gibbet"),-1!==Q&&(O[R][5]=O[R][5].substring(0,Q)+"Skibbet"),Bd.push(O[R]);ja(),app.recipeBook=Bd,Xc=Bd.length,Xc>=2&&fa(xc,!0);for(var S in Bd){var T=Bd[S][5],U=T.split(" ");Fd.push(U[0],U[1])}var V=Fd.length;for(x=0;V>x;x++)x%2===0?ue.splice(ue.indexOf(Fd[x]),1):ve.splice(ve.indexOf(Fd[x]),1)}Ab.egg=Ud,Ab.butter=Vd,Ab.sugar=Wd,Ab.salt=Xd,Ab.recipecard=F,Ab.recipecardtime=ib,Ab.arrow=Lc,Ab.feedback=_d,Ab.number1=Ed[0],Ab.number2=Ed[1],Ab.number3=Ed[2],Ab.number4=Ed[3],Ab.servecookies=xc,ra(["make-first"]),na(),Ab.homebutton.visible=!1,app.hasTouch||(ya(ae),ya(ee),ya(Ic),ya(Fc),ya(btnDragCookie),ya(Jc),ya(Ec),ya(uc),ya(vc),ya(wc),ya(Lc),ya(Kc),ya(Cc),ya(Dc),ya(Gc),ya(Bc),ya(yc),ya(b),ya(xc),ya(Ab.homebutton),ya(zc),ya(Ac)),Ab.building_bg.addEventListener("click",Ba),Ab.mixing_bg.addEventListener("click",Ba),Ab.baking_bg.addEventListener("click",Ba),Ab.fishy_bg.addEventListener("click",Ba),Ab.testing_bg.addEventListener("click",Ba),Ab.decorate_bg.addEventListener("click",Ba)},namespace("WGBH").GameState=Qa}(),function(){var a=include("springroll.easeljs.BaseState"),b=include("WGBH.IntroPanel"),c=function(c){a.call(this,new b,c),this.onPlay=this.onPlay.bind(this)},d=extend(c,a);d.enterDone=function(){app.voPlayer.play("cookie-creator"),this.panel.playbutton.addEventListener("click",this.onPlay),this.panel.background.addEventListener("click",this.onPlay),this.panel.background.cursor="pointer",this.moveon=this.moveon.bind(this)},d.moveon=function(){this.nextState()},d.onPlay=function(a){app.sound.play("clickey",{volume:.4}),this.panel.background.cursor=null,this.panel.background.removeEventListener("click",this.onPlay),this.panel.playbutton.removeEventListener("click",this.onPlay),this.panel.splash.visible=!1,this.panel.playbutton.visible=!1,this.panel.ruff.saythings(["cookie-time","were-making"],this.moveon),
app.trackevent("clickPlay",{idorder:["custom"],custom:{coordinates:{x:parseInt(a.stageX),y:parseInt(a.stageY),stage_width:app.display.width,stage_height:app.display.height}}})},d.exit=function(){this.panel.background.cursor=null,this.panel.background.removeEventListener("click",this.onPlay),this.panel.playbutton.removeEventListener("click",this.onPlay)},namespace("WGBH").IntroState=c}(),function(){function a(a,b){window.images[b.id]=a;var c=lib.ssMetadata;for(i=0;i<c.length;i++)ss[c[i].name]=new createjs.SpriteSheet({images:[window.images[c[i].name]],frames:c[i].frames})}var b=include("WGBH.IntroState"),c=include("WGBH.GameState"),d=include("springroll.Application"),e=include("lib.RuffTransition"),f=include("springroll.easeljs.EaselJSDisplay"),g=new d({fps:60,name:"kitchen2",state:"intro",canvasId:"stage",configPath:"assets/config/config.json",manifestsPath:"assets/config/manifests.json",captionsPath:"assets/config/captions.json",display:f,displayOptions:{clearView:!0},autoPause:!0,preload:[{src:"assets/images/RuffTransition_atlas_.png",id:"RuffTransition_atlas_",complete:a}]});g.on("init",function(){this.animator.captions.mute=!0;var a=this.config.assets,d=this.config.scaling;this.manifests;this.transition=new e,this.transition.framerate=30,this.states={intro:new b({next:"game",preload:a.intro,scaling:d.intro}),game:new c({previous:"intro",preload:a.game,scaling:d.game})},g.userData.read("recipeBook",g.bookready)}),g.user={},g.bookready=function(a){g.user.recipeBook=a},g.getuserdata=function(a){return g.user[a]},g.saveuserdata=function(a,b){this.userData.write(a,b)},g.trackevent=function(a,b){if(void 0!==b){var c=[];for(var d in b.idorder)c.push(b[b.idorder[d]]);this.learning[a].apply(this.learning,c)}else this.learning[a].call(this.learning)},g.tracksaying=function(a,b,c,d){switch(b){case"intro":this.trackinstruction(a,c,d);break;case"fail":this.trackincorrectfeedback(a,c,d);break;case"success":this.trackcorrectfeedback(a,c,d)}},g.getfeedbackinfo=function(a){var b=(g.captions.data[a],g.captions.getLength(a)),c=g.captions.getFullCaption(a);return{duration:b,description:c}},g.getfeedbacktrackobject=function(a,b){var c=g.getfeedbackinfo(a);return{idorder:["description","id","media_type","duration"],media_type:b,duration:c.duration,description:c.description,id:a}},g.trackcorrectfeedback=function(a,b,c){var d=g.getfeedbacktrackobject(a,b);c?(d.duration=g.learning.stopTimer("talking"),g.trackevent("endCorrectFeedback",d)):(g.learning.startTimer("talking"),g.trackevent("startCorrectFeedback",d))},g.trackincorrectfeedback=function(a,b,c){var d=g.getfeedbacktrackobject(a,b);c?(d.duration=g.learning.stopTimer("talking"),g.trackevent("endIncorrectFeedback",d)):(g.learning.startTimer("talking"),g.trackevent("startIncorrectFeedback",d))},g.trackinstruction=function(a,b,c){var d=g.getfeedbacktrackobject(a,b);c?(d.duration=g.learning.stopTimer("talking"),g.trackevent("endInstruction",d)):(g.learning.startTimer("talking"),g.trackevent("startInstruction",d))},window.app=g}();