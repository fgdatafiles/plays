function validateListener(a,b){if("function"!=typeof a)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}function Signal(){this._bindings=[],this._prevParams=null;var a=this;this.dispatch=function(){Signal.prototype.dispatch.apply(a,arguments)}}function SignalBinding(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}window.Utils=window.Utils||{},"undefined"==typeof Utils.isTouchDevice&&Object.defineProperty(Utils,"isTouchDevice",{get:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}}),"undefined"==typeof Utils.isDesktop&&Object.defineProperty(Utils,"isDesktop",{get:function(){return!Utils.isTouchDevice}}),function(){var a=Object.freeze({MARS:"mars",MOON:"moon",VENUS:"venus"});namespace("srr").Planet=a}(),function(){var a=include("createjs.Bitmap"),b=include("createjs.Container"),c=function(a,c,d,e){this.eventType=d,this.cont=e,this.powerupCont=new b,this.addImg(this.powerupCont,d),this.cont.addChild(this.powerupCont),this.moveTo(a,c)},d=c.prototype;d.addImg=function(b,c){var d=new a(images[c]);d.regX=d.image.width/2,d.regY=d.image.height/2,d.scaleX=d.scaleY=.5,b.addChild(d)},d.move=function(a,b){this.powerupCont.x+=a,this.powerupCont.y+=b},d.moveTo=function(a,b){this.powerupCont.x=a,this.powerupCont.y=b},Object.defineProperty(d,"x",{get:function(){return this.powerupCont.x},set:function(a){this.powerupCont.x=a}}),Object.defineProperty(d,"y",{get:function(){return this.powerupCont.y},set:function(a){this.powerupCont.y=a}}),d.destroy=function(){this.cont.removeChild(this.powerupCont)},namespace("srr").Powerup=c}(),"undefined"!=typeof createjs&&("undefined"==typeof createjs.DisplayObject.prototype.reg&&(createjs.DisplayObject.prototype.reg=function(a,b){var c;return 1===arguments.length?"number"==typeof a&&(c=this.getBounds(),c&&(this.regX=this.getBounds().width*a,this.regY=this.getBounds().height*a)):2===arguments.length&&"number"==typeof a&&"number"==typeof b&&(c=this.getBounds(),c&&(this.regX=this.getBounds().width*a,this.regY=this.getBounds().height*b)),this}),"undefined"==typeof createjs.DisplayObject.prototype.setPos&&(createjs.DisplayObject.prototype.setPos=function(a,b){return 1===arguments.length?"number"==typeof a?(this.x=a,this.y=a):"number"==typeof a.x&&"number"==typeof a.y&&(this.x=a.x,this.y=a.y):2===arguments.length&&"number"==typeof a&&"number"==typeof b&&(this.x=a,this.y=b),this}),"undefined"==typeof createjs.DisplayObject.prototype.pos&&Object.defineProperty(createjs.DisplayObject.prototype,"pos",{get:function(){return{x:this.x,y:this.y}}}),"undefined"==typeof createjs.DisplayObject.prototype.scale&&(createjs.DisplayObject.prototype.scale=function(a,b){return 1===arguments.length?"number"==typeof a&&(this.scaleX=a,this.scaleY=a):2===arguments.length&&"number"==typeof a&&"number"==typeof b&&(this.scaleX=a,this.scaleY=b),this})),"undefined"==typeof window.innerWidth&&("undefined"!=typeof document.documentElement.clientWidth?window.innerWidth=document.documentElement.clientWidth:"undefined"!=typeof document.body.clientWidth&&(window.innerWidth=document.documentElement.clientWidth)),"undefined"==typeof window.innerHeight&&("undefined"!=typeof document.documentElement.clientHeight?window.innerHeight=document.documentElement.clientHeight:"undefined"!=typeof document.body.clientHeight&&(window.innerHeight=document.documentElement.clientHeight)),"undefined"==typeof Math.circClamp&&(Math.circClamp=function(a){for(;0>a;)a+=2*Math.PI;for(;a>2*Math.PI;)a-=2*Math.PI;return a}),"undefined"==typeof Math.Epsilon&&Object.defineProperty(Math,"Epsilon",{get:function(){return 1e-4}}),"undefined"==typeof Math.rndBool&&Object.defineProperty(Math,"rndBool",{get:function(){return Math.random()>.5}}),"undefined"==typeof Math.lerp&&(Math.lerp=function(a,b,c){return a+c*(b-a)}),"undefined"==typeof Math.lerpAngel&&(Math.lerpAngel=function(a,b,c){var d=b-a;return d>Math.PI?a+=2*Math.PI:d<-Math.PI&&(a-=2*Math.PI),Math.abs(b-a)<.001?b:a+(b-a)*Math.clamp(c)}),"undefined"==typeof Math.sign&&(Math.sign=function(a){return 0>a?-1:1}),"undefined"==typeof Math.stepTowards&&(Math.stepTowards=function(a,b,c){return Math.abs(b-a)<=c?b:b-a>0?a+c:a-c}),"undefined"==typeof Math.moveTowardsValue&&(Math.moveTowardsValue=function(a,b,c){return Math.abs(b-a)<=c?b:a+Math.sign(b-a)*c}),"undefined"==typeof Math.moveTowards&&(Math.moveTowards=function(a,b,c){if("number"==typeof a&&"number"==typeof b)return Math.moveTowardsValue(a,b,c);if("object"==typeof a&&"object"==typeof b&&"number"==typeof a.x&&"number"==typeof b.x&&"number"==typeof a.y&&"number"==typeof b.y){var d={x:b.x-a.x,y:b.y-a.y},e=Math.magnitude(d);if(c>=e||0===e)return{x:b.x,y:b.y};var f={x:a.x+d.x/e*c,y:a.y+d.y/e*c};return f}Console.warn("moveTowards:: invalid input. expecting two numbers or points")}),"undefined"==typeof Math.smoothStep&&(Math.smoothStep=function(a,b,c){return c=Math.Clamp01(c),c=-2*c*c*c+3*c*c,b*c+a*(1-c)}),"undefined"==typeof Math.Clamp01&&(Math.Clamp01=function(a){return 0>a?0:a>1?1:a}),"undefined"==typeof Math.magnitude&&(Math.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)}),"undefined"==typeof Math.repeat&&(Math.repeat=function(a,b){return a-Math.floor(a/b)*b}),"undefined"==typeof Math.angleDiff&&(Math.angleDiff=function(a,b){for(var c=b-a;c<-Math.PI;)c+=2*Math.PI;for(;c>Math.PI;)c-=2*Math.PI;return c}),"undefined"==typeof Math.cordsOnElypse&&(Math.cordsOnElypse=function(a,b){var c=a.center.x-a.width*Math.sin(b)*Math.sin(0*Math.PI)+a.width*Math.cos(b)*Math.cos(0*Math.PI),d=a.center.y+a.height*Math.cos(b)*Math.sin(0*Math.PI)+a.height*Math.sin(b)*Math.cos(0*Math.PI);return{x:c,y:d}}),"undefined"==typeof Math.Elypse&&(Math.Elypse=function(a,b,c,d){return{center:{x:a,y:b},width:c,height:d}}),function(){function a(){this._minigame?app.analyticEvent("leave page in minigame","",this._minigame):this._level?app.analyticEvent("leave page in level: ","",this._level):app.analyticEvent("leave page from menu. last level was a ","",this._lastLvl)}var b=function(){this._currentScreen="splashScreen",this._pageOpened=Date.now(),this.firstPlanet=!1,this._minigame=null,window.onbeforeunload=a},c=b.prototype;c.leaveLoadingScreen=function(){app.analyticEvent("loading time",this._pageOpened-Date.now())},c.planetSelected=function(a){this.firstPlanet||(this.firstPlanet=!0,app.analyticEvent("first planet",a))},c.startedMinigame=function(a){this._minigame=a},c.completedMinigame=function(){this._minigame=null},c.levelStarted=function(a){this._level=a,this._minigame=null},c.failLevel=function(){this._level=null,this._lastLvl="failed"},c.winLevel=function(){this._level=null,this._lastLvl="success"},namespace("srr").Analytics=b}(),function(){var a=include("srr.Planet"),b=function(){this.init()},c=b.prototype;c.init=function(){this._max=8,this._load()},c._save=function(){localStorage.setItem("mars",this[a.MARS]),localStorage.setItem("moon",this[a.MOON]),localStorage.setItem("venus",this[a.VENUS])},c._load=function(){this[a.MARS]=parseInt(localStorage.getItem("mars"))||0,this[a.MOON]=parseInt(localStorage.getItem("moon"))||0,this[a.VENUS]=parseInt(localStorage.getItem("venus"))||0,this[a.MARS]>this._max&&(this[a.MARS]=this._max),this[a.MOON]>this._max&&(this[a.MOON]=this._max),this[a.VENUS]>this._max&&(this[a.VENUS]=this._max),this.completedPlanets=[],this.unCompleted=[],this[a.MARS]>=this._max?this.completedPlanets.push("mars"):this.unCompleted.push("mars"),this[a.MOON]>=this._max?this.completedPlanets.push("moon"):this.unCompleted.push("moon"),this[a.VENUS]>=this._max?this.completedPlanets.push("venus"):this.unCompleted.push("venus")},c.goForward=function(){this.isFinalLevel||(this[app.currentPlanet]=this[app.currentPlanet]+1,this.saveCompletedState()),this._save()},c.saveCompletedState=function(){if(this[app.currentPlanet]>=this._max&&-1===this.completedPlanets.indexOf(app.currentPlanet)){this.completedPlanets.push(app.currentPlanet);var a=this.unCompleted.indexOf(app.currentPlanet);-1!==a&&this.unCompleted.splice(a,1)}},c.completed=function(a){return this[a]>=this._max},Object.defineProperty(c,"isFinalLevel",{get:function(){return this.current>=this._max?!0:!1}}),Object.defineProperty(c,"current",{get:function(){return this[app.currentPlanet]}}),Object.defineProperty(c,"easy",{get:function(){return this[app.currentPlanet]<3}}),Object.defineProperty(c,"medium",{get:function(){return this[app.currentPlanet]>=3&&this[app.currentPlanet]<6}}),Object.defineProperty(c,"hard",{get:function(){return this[app.currentPlanet]>=6}}),Object.defineProperty(c,"difficulty",{get:function(){if(this.easy)return"easy";if(this.medium)return"medium";if(this.hard)return"hard";throw"no valid difficulty"}}),Object.defineProperty(c,"gameComplete",{get:function(){return this.completed("moon")&&this.completed("mars")&&this.completed("venus")}}),namespace("srr.misc").AppProgress=b}(),function(){function a(){return-50*Math.random()}var b=include("createjs.Bitmap"),c=include("createjs.Tween"),d=include("createjs.Ease"),e=include("springroll.DelayedCall"),f=function(a,b,c){this.panelImg=null,this.delayedcall=null,this.init(a,b,c)},g=f.prototype;g.init=function(c,d,e){this.panelImg=new b(images.end_panel);var f=(new createjs.ColorMatrix).adjustHue(a());this.panelImg.filters=[new createjs.ColorMatrixFilter(f)],this.panelImg.cache(0,0,this.panelImg.image.width,this.panelImg.image.height),this.panelImg.reg(.5),c.addChild(this.panelImg),this.panelImg.setPos(d,e)},g.playAnimation=function(){var a=this;c.get(this.panelImg).to({rotation:360,scaleX:1.5,scaleY:1.5},500,d.sineInOut),this.delayedcall=new e(function(){c.get(a.panelImg).to({y:a.panelImg.y-300,alpha:0},300,d.bounceOut)},550)},g.teardown=function(){c.removeTweens(this.panelImg),this.delayedcall&&this.delayedcall.destroy()},namespace("srr.misc").EndSolarPanel=f}(),function(){var a=function(){this._gameSpeed=.3,this._topSpeed=.6,this._maxSpeed=2},b=a.prototype;b.init=function(a,b){this.vehicleMovement=a,this.tileManager=b},b.pickupBoost=function(){this._gameSpeed<this._topSpeed&&(this._gameSpeed=this._topSpeed)},b.update=function(a,b,c,d,e){b.minigame?this._gameSpeed=0:c?this._gameSpeed=Math.min(this._topSpeed/4,.9*this._gameSpeed):d?this.updateEndReached(a,b):e?this.updateBoost(a,b):this.vehicleMovement.blocked?this.updateBlocked(a,b):this.updateNormal(a,b)},b.updateEndReached=function(a,b){var c=this.tileManager.trackLength-this.vehicleMovement.distTraveled,d=Math.max(c-700,0);this._fadeProgress=Math.Clamp01(1-d/500),this.vehicleMovement.moveBehaviour.updateProgress&&this.vehicleMovement.moveBehaviour.updateProgress(this._fadeProgress),0>=d&&app.signals.arrivedAtGoal.dispatch()},b.updateBlocked=function(a,b){this._gameSpeed=Math.lerp(this._gameSpeed,this._topSpeed/4,a/500),b.rumbler.rumble(a),b.vehicleAnim.rumble(a)},b.updateNormal=function(a,b){this._gameSpeed=Math.lerp(this._gameSpeed,this._topSpeed,a/1e3),b.rumbler.driveSmooth(a),b.vehicleAnim.driveSmooth(a)},b.updateBoost=function(a,b){this._gameSpeed=Math.lerp(this._gameSpeed,this._maxSpeed,a/500),b.rumbler.driveSmooth(a),b.vehicleAnim.driveSmooth(a)},Object.defineProperty(b,"gameSpeed",{get:function(){return Math.clamp(this._gameSpeed*this.vehicleMovement.speedMultiplier,0,this._maxSpeed)}}),namespace("srr.misc").GameSpeed=a}(),function(){var a=function(){this._remainingTime=NaN,this._levelTime=NaN,this._5=!1,this._4=!1,this._3=!1,this._2=!1,this._1=!1},b=a.prototype;b.init=function(){app.progress.easy?this._remainingTime=this._levelTime=7e4:app.progress.medium?this._remainingTime=this._levelTime=8e4:this._remainingTime=this._levelTime=99e3,this_warningPlayed=!1},b.pickupExtraTime=function(){this._remainingTime=Math.min(this._remainingTime+5e3,this._levelTime)},b.update=function(a,b,c){this.timeUp||c||(this._remainingTime=Math.max(0,this._remainingTime-a),this._remainingTime<=5e3&&(this.updateFlash(this._remainingTime),this._remainingTime<=0&&app.signals.outOfTime.dispatch(),this_warningPlayed||(this_warningPlayed=!0,app.sound.play("warning-sound"))))},b.updateFlash=function(a){return a=Math.floor(a/1e3),this["_"+a]?void 0:(app.signals.flashTimer.dispatch(),void(this["_"+a]=!0))},Object.defineProperty(b,"timeUp",{get:function(){return this._remainingTime<=0}}),Object.defineProperty(b,"remainingTime",{get:function(){return this._remainingTime}}),Object.defineProperty(b,"levelTime",{get:function(){return this._levelTime}}),namespace("srr.misc").GameTime=a}(),function(){var a=include("springroll.DelayedCall"),b=function(){this._bubble=!1,this._speedBost=!1},c=b.prototype;c.init=function(){this._bubble=!1,this._speedBost=!1,this._delayedSpeedStop&&this._delayedSpeedStop.destroy()},c.endSpeedBoost=function(){this._speedBost=!1,this._delayedSpeedStop&&this._delayedSpeedStop.destroy(),app.signals.speedBoostEnd.dispatch()},Object.defineProperty(c,"bubble",{get:function(){return this._bubble},set:function(a){this._bubble=a}}),Object.defineProperty(c,"speedBoost",{get:function(){return this._speedBost},set:function(b){if(this._speedBost=b,this._delayedSpeedStop&&this._delayedSpeedStop.destroy(),b){var c=this;this._delayedSpeedStop=new a(function(){c.endSpeedBoost()},1e3)}}}),c.teardown=function(){this._delayedSpeedStop&&this._delayedSpeedStop.destroy()},namespace("srr.misc").Powerups=b}(),function(){var a=function(a){this.rumbleMag=0,this.rumbleCount=0,this.cont=a},b=a.prototype;b.driveSmooth=function(a){this.rumbleMag>0&&(this.rumbleMag-=a/50,this.cont.y=0)},b.rumble=function(a){this.rumbleMag+=a/100,this.rumbleMag=Math.min(this.rumbleMag,3),this.rumbleCount=this.rumbleCount+a,this.rumbleCount>30&&(this.rumbleCount=0,this.cont.y=this.cont.y>=0?-this.rumbleMag:this.rumbleMag)},namespace("srr.misc").Rumbler=a}(),function(){var a=include("createjs.Container"),b=include("createjs.Tween"),c=include("createjs.Ease"),d=function(){a.call(this)},e=(a.prototype,extend(d,a));e.onOutOfTime=function(){this.quad=new createjs.Shape,this.quad.graphics.beginFill("#00000").drawRect(0,0,1280,720),this.quad.alpha=0,this.addChild(this.quad),b.get(this.quad).to({alpha:.75},1500,c.cubicOut)},e.teardown=function(){this.quad&&b.removeTweens(this.quad)},namespace("srr.misc").Sunset=d}(),function(){var a=function(a){this.rumbleMag=0,this.rumbleCount=0,this.vehicle=a.player},b=a.prototype;b.driveSmooth=function(a){this.rumbleMag>0&&(this.rumbleMag-=a/50,this.vehicle.rotation=this.rumbleMag,this.rumbleMag<Math.Epsilon&&(this.rumbleMag=0))},b.rumble=function(a){this.rumbleMag+=a/100,this.rumbleMag=Math.min(this.rumbleMag,5),this.rumbleCount=this.rumbleCount+a,this.rumbleCount>45&&(this.rumbleCount=0,this.vehicle.rotation=this.vehicle.rotation>=0?-this.rumbleMag:this.rumbleMag)},namespace("srr.misc").VehicleAnimation=a}(),function(){function a(a,c,d){b(a,"tile_"+d,"tile_"+c+"_"+d)}function b(a,b,c,d){d=d||".png",a.push({id:b,src:"assets/images/"+c+d})}var c={};c.generateManifest=function(c){var d=[];return a(d,c,"bot_start"),a(d,c,"bot"),a(d,c,"bot_end"),a(d,c,"mid_start"),a(d,c,"mid"),a(d,c,"mid_end"),a(d,c,"top_start"),a(d,c,"top"),a(d,c,"top_end"),a(d,c,"straight"),a(d,c,"easy"),a(d,c,"medium"),a(d,c,"hard"),a(d,c,"end"),b(d,"rock","rocks_"+c),"mars"!==c&&b(d,"pothole","potholes_"+c),"moon"!==c&&(b(d,"duststorm01","duststorm-"+c+"01"),b(d,"duststorm02","duststorm-"+c+"02"),b(d,"duststorm03","duststorm-"+c+"03"),b(d,"duststorm04","duststorm-"+c+"04"),b(d,"duststorm05","duststorm-"+c+"05"),b(d,"duststorm06","duststorm-"+c+"06")),b(d,"sky_easy","sky_"+c+"_easy",".jpg"),b(d,"sky_medium","sky_"+c+"_medium",".jpg"),b(d,"sky_hard","sky_"+c+"_hard",".jpg"),b(d,"parallaxBg","parallaxBg_"+c),d},namespace("srr.misc").levelLoader=c}(),function(){function a(a,b,c,d){d=d||".png",a.push({id:b,src:"assets/images/"+c+d})}var b={};b.generateManifest=function(b){planet=b;var c=[];return a(c,b,b,".jpg"),a(c,"infoBar_"+b,"infoBar_"+b),c},namespace("srr.misc").menuLoader=b}(),function(){var a=function(a,b,c,d){this.time=a,this.callback=b,this._progress=c||0,this._enabled=d||!0,this._mousePos={x:NaN,y:NaN},this.update=this.update.bind(this),this.resetProgress=this.resetProgress.bind(this),app.on("update",this.update),window.addEventListener("mousedown",this.resetProgress,!1),window.addEventListener("touchstart",this.resetProgress,!1),window.addEventListener("keydown",this.resetProgress,!1)},b=a.prototype;b.update=function(a){this._mouseMoved?this.resetProgress():(this._progress+=a,this._progress>this.time&&(this.triggerCallback(),this.resetProgress()))},Object.defineProperty(b,"_mouseMoved",{get:function(){return this._mousePos.x!==app.pointer.x||this._mousePos.y!==app.pointer.y?(this._mousePos.x=app.pointer.x,this._mousePos.y=app.pointer.y,!0):(this._mousePos.x=app.pointer.x,this._mousePos.y=app.pointer.y,!1)}}),Object.defineProperty(b,"enabled",{set:function(a){this._enabled=a,a&&this.resetProgress()}}),b.triggerCallback=function(){this.callback&&this.callback()},b.resetProgress=function(){this._progress=0},b.setDelay=function(a){this.progress=-a},b.teardown=function(){this.callback=null,app.off("update",this.update),window.removeEventListener("mousedown",this.resetProgress,!1),window.removeEventListener("touchstart",this.resetProgress,!1),window.removeEventListener("keydown",this.resetProgress,!1)},namespace("srr.TO").TimeoutNotification=a}(),function(){var a=include("srr.TO.TimeoutNotification"),b=function(b,c,d){var e=this.playTimeout.bind(this);this.soundIDs=c,this.timeoutNotification=new a(b,e,d)},c=b.prototype;c.playTimeout=function(){app.voPlayer.play(this.soundIDs[Math.randomInt(this.soundIDs.length-1)])},c.teardown=function(){this.timeoutNotification.teardown()},namespace("srr.TO").Timeout=b}(),function(){var a=include("srr.TO.TimeoutNotification"),b=function(b,c,d){var e=this.playTimeout.bind(this);this.soundIDs=c,this.timeoutNotification=new a(b,e,d)},c=b.prototype;c.playTimeout=function(){app.voPlayer.play(this.soundIDs[Math.randomInt(this.soundIDs.length-1)])},c.teardown=function(){this.timeoutNotification.teardown()},namespace("srr.TO").Timeout=b}(),function(){var a=include("springroll.Enum"),b={};b.Lanes=new a("NONE","TOP","MID","BOT"),b.posToLane=function(a,b){var c=srr.tileSystem.TileManager;return a.y<290-a.x/c.widthHeightRatio?b?this.Lanes.TOP:this.Lanes.NONE:a.y<450-a.x/c.widthHeightRatio?this.Lanes.TOP:a.y<600-a.x/c.widthHeightRatio?this.Lanes.MID:a.y<760-a.x/c.widthHeightRatio?this.Lanes.BOT:b?this.Lanes.BOT:this.Lanes.NONE},b.snapPosToLane=function(a){return this.posInLaneCentre(this.posToLane(a,!0),a.x)},b.laneName=function(a){return(""+a).toLowerCase()},b.laneBlockedAtPos=function(a,b){for(var c=a.length-1;c>=0;c--)if(b>a[c][0]&&b<a[c][1])return!0;return!1},b.posInLaneCentre=function(a,b){var c=srr.tileSystem.TileManager;return a===this.Lanes.TOP?365-b/c.widthHeightRatio:a===this.Lanes.MID?525-b/c.widthHeightRatio:a===this.Lanes.BOT?675-b/c.widthHeightRatio:void 0},namespace("srr.input").movementUtils=b}(),function(){function a(a){this.startingPos.x=app.pointer.x,this.startingPos.y=app.pointer.y,this.startTime=Date.now()}function b(a){Math.distSq(this.startingPos,app.pointer)<100&&Date.now()-this.startTime<150&&(this._planetFacts.lastClickWasSuccess||app.sound.play("uiNeg"))}var c=function(c){this.mouseDown=!1,this.onMouseDown=a.bind(this),this.onMouseUp=b.bind(this),this.startingPos={x:NaN,y:NaN},this.startTime=null,this._planetFacts=c,this.initInput()},d=c.prototype;d.initInput=function(){var a=this,b=app.display.stage;b.addEventListener("mousedown",a.onMouseDown),b.addEventListener("stagemouseup",a.onMouseUp)},d.exitStart=function(){var a=this,b=app.display.stage;b.removeEventListener("mousedown",a.onMouseDown),b.removeEventListener("stagemouseup",a.onMouseUp)},namespace("srr.input").ClickOnNothing=c}(),function(){function a(a){this.mouseDown=!0,this.dragDistance=0,this.lastX=app.pointer.x}function b(a){this.mouseDown=!1}function c(a){this.mouseDown?this.onDrag(a):this.onDragFade(a)}var d=function(){this.mouseDown=!1,this.onMouseDown=a.bind(this),this.onMouseUp=b.bind(this),this.onUpdate=c.bind(this),this.startingPos={x:NaN,y:NaN},this.startTime=null,this.initInput(),this.dragDistance=0},e=d.prototype;e.initInput=function(){var a=this,b=app.display.stage;b.addEventListener("mousedown",a.onMouseDown),b.addEventListener("stagemouseup",a.onMouseUp),this.inputActive=!0,app.on("update",this.onUpdate),this.values=[],this.values.push(0),this.values.push(0),this.values.push(0),this.values.push(0),this.values.push(0)},e.onDrag=function(a){var b=this.lastX-app.pointer.x;this.values.push(b),this.values.shift(),this.lastX=app.pointer.x,app.signals.drag.dispatch(b),this.dragDistance+=Math.abs(b)},e.onDragFade=function(a){for(var b=0,c=this.values.length-1;c>=0;c--)this.values[c]*=.95,b+=this.values[c];b/=this.values.length,(b>.01||-.01>b)&&(app.signals.drag.dispatch(b),this.dragDistance+=Math.abs(b))},e.cancelTouch=function(){this.mousedown=!1,this.startingPos={x:NaN,y:NaN},this.startTime=null},e.setInputActive=function(a){this.inputActive=a},e.exitStart=function(){var a=this,b=app.display.stage;b.removeEventListener("mousedown",a.onMouseDown),b.removeEventListener("stagemouseup",a.onMouseUp),app.off("update",this.onUpdate)},namespace("srr.input").DragInput=d}(),function(){var a=function(a){this._progress=0,this._desiredGoal={x:670,y:450},this.pos=a},b=a.prototype;b.updateBehaviour=function(a,b,c){return this.pos=Math.moveTowards(this.pos,this._desiredGoal,b/5),this.pos},b.updateProgress=function(a){this._progress=Math.Clamp01(a)},b.teardown=function(){},namespace("srr.input").FadeToBackBehaviour=a}(),function(){var a=include("srr.input.movementUtils"),b=function(){this._currentPos=null,this._pointerLane=null,this._lastPointerPos={x:app.pointer.x,y:app.pointer.y},this.keys={Left:!1,Right:!1,ArrowLeft:!1,ArrowRight:!1},this._desiredPos={x:NaN,y:NaN},this.pos={x:NaN,y:NaN},this._desiredPos.x=this.pos.x=300,this._desiredPos.y=this.pos.y=500,this.onKeyDown=this.onKeyDown.bind(this),window.addEventListener("keydown",this.onKeyDown,!1),this.onKeyUp=this.onKeyUp.bind(this),window.addEventListener("keyup",this.onKeyUp)},c=b.prototype;c.onKeyDown=function(b){var c=b.keyIdentifier?b.keyIdentifier:b.key;("Up"===c||"ArrowUp"===c)&&(2==this._currentLane._value?this._desiredPos.y=a.posInLaneCentre(a.Lanes.TOP,this._currentPos.x):3==this._currentLane._value&&(this._desiredPos.y=a.posInLaneCentre(a.Lanes.MID,this._currentPos.x))),("Down"===c||"ArrowDown"===c)&&(1==this._currentLane._value?this._desiredPos.y=a.posInLaneCentre(a.Lanes.MID,this._currentPos.x):2==this._currentLane._value&&(this._desiredPos.y=a.posInLaneCentre(a.Lanes.BOT,this._currentPos.x))),"undefined"!=typeof this.keys[c]&&(this.keys[c]=!0)},c.onKeyUp=function(a){var b=a.keyIdentifier?a.keyIdentifier:a.key;"undefined"!=typeof this.keys[b]&&(this.keys[b]=!1)},c.updateBehaviour=function(b,c,d){return this._currentPos=d,this._currentLane=a.posToLane(d),this.pointerMoved?this.followPointer(b,c):this.keyPressed&&this.updateKeyboard(b,c),this.pos.x=this.horizontalMovement(this._desiredPos,.5*b),this.pos.y=this.verticalMovement(this._desiredPos,.4*c),this.pos},c.followPointer=function(b,c){this._desiredPos.x=app.pointer.x+100,this._desiredPos.y=app.pointer.y-50,this._desiredPos.y=a.snapPosToLane(this._desiredPos)},c.updateKeyboard=function(b,c){(this.keys.Right||this.keys.ArrowRight)&&(this._desiredPos.x+=4),(this.keys.Left||this.keys.ArrowLeft)&&(this._desiredPos.x-=4),this._desiredPos.y=a.snapPosToLane(this._desiredPos)},c.horizontalMovement=function(a,b){return a.x=Math.clamp(a.x,20,800),a.x-this._currentPos.x<0&&(b*=2),Math.stepTowards(this._currentPos.x,a.x,b)},c.verticalMovement=function(b,c){var d=a.posInLaneCentre(a.Lanes.TOP,this._currentPos.x),e=a.posInLaneCentre(a.Lanes.BOT,this._currentPos.x);return b.y=Math.clamp(b.y,d,e),Math.stepTowards(this._currentPos.y,b.y,c)},Object.defineProperty(c,"pointerMoved",{get:function(){return app.pointer.x===this._lastPointerPos.x&&app.pointer.x===this._lastPointerPos.x?(this._lastPointerPos.x=app.pointer.x,this._lastPointerPos.y=app.pointer.y,!1):(this._lastPointerPos.x=app.pointer.x,this._lastPointerPos.y=app.pointer.y,!0)}}),Object.defineProperty(c,"keyPressed",{get:function(){return this.keys.Right||this.keys.Left||this.keys.ArrowRight||this.keys.ArrowLeft}}),c.teardown=function(){window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp)},namespace("srr.input").FollowPointerBehaviour=b}(),function(){var a=include("createjs.Container"),b=function(){a.call(this)},c=a.prototype;extend(b,a);c.teardown=function(){app.voPlayer.stop(),app.voPlayer.captions.stop()},namespace("srr.ui").EndGamePopup=b}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(b){a.call(this),this.startPos=480,this.endPos=850,this.barY=105,this.init(),this.setPos(-40,-20)},d=(a.prototype,extend(c,a));d.init=function(){var c=new a,d=new b(images.progressStart);d.reg(1,1),d.setPos(this.startPos,this.barY),c.addChild(d);var e=new b(images.progressNot);e.reg(0,1),e.setPos(this.startPos,this.barY),e.scaleX=this.endPos-this.startPos,c.addChild(e);var f=new b(images.progressEnd);f.reg(0,1),f.setPos(this.endPos,this.barY),c.addChild(f);var g=c.getBounds();c.cache(g.x,g.y,g.width,g.height),this.addChild(c),this.done=new b(images.progressDone),this.done.reg(0,1),this.done.setPos(this.startPos,this.barY),this.addChild(this.done),this.update(0)},d.update=function(a){this.done.scaleX=Math.Clamp01(a)*(this.endPos-this.startPos)},namespace("srr.ui").LevelProgress=c}(),function(){var a=include("createjs.Container"),b=include("createjs.Tween"),c=include("springroll.DelayedCall"),d=function(b,c){a.call(this),this.fillValue=1,this.pieMask=null,this.timerImg=null,this.init(b,c)},e=(a.prototype,extend(d,a));e.init=function(a,b){this.x=a,this.y=b;var c=new createjs.Bitmap(images.timerBG);c.reg(.5),c.setPos(108,108),this.addChild(c);var d=new createjs.Shape;d.graphics.beginFill("rgba(255,255,255,1)").arc(108,108,108,0,0,!1).lineTo(108,108).closePath(),d.cache(0,0,216,216);var e=new createjs.Bitmap(images.timerSun);e.filters=[new createjs.AlphaMaskFilter(d.cacheCanvas)],e.cache(0,0,216,216),this.addChild(e),this.pieMask=d,this.timerImg=e,this.setFill(.95);var f=new createjs.Bitmap(images.timerCover);f.reg(.5),f.setPos(108,108),this.addChild(f),this.delayedCalls=[],this.timerFlash=new createjs.Bitmap(images.timerFlash),this.timerFlash.scale(2.2),this.timerFlash.reg(.5),this.timerFlash.setPos(108,108),this.timerFlash.alpha=0,this.addChild(this.timerFlash)},e.flashOnce=function(){b.removeTweens(this.timerFlash),this.timerFlash.alpha=1,b.get(this.timerFlash).to({alpha:0},200)},e.flash=function(){this._removeDelayedCalls(),this._delayedflash(0),this._delayedflash(300),this._delayedflash(600),this._delayedflash(900)},e._removeDelayedCalls=function(a){for(var b=0;b<this.delayedCalls.length;b++)this.delayedCalls[b].destroy();this.delayedCalls=[]},e._delayedflash=function(a,d){var e=this;this.delayedCalls.push(new c(function(){b.removeTweens(e.timerFlash),e.timerFlash.alpha=1,b.get(e.timerFlash).to({alpha:0},200)},a))},e.setFill=function(a){a=Math.clamp(a,1e-5,.99999),this.fillValue=Math.lerp(this.fillValue,a,.2);var b=2*Math.PI*(1-this.fillValue)-Math.PI/2,c=-(Math.PI/2);this.pieMask.graphics.clear(),this.pieMask.graphics.beginFill("rgba(255,255,255,1)").arc(108,108,108,b,c,!1).lineTo(108,108).closePath(),this.pieMask.cache(0,0,216,216),this.timerImg.cache(0,0,216,216)},e.teardown=function(){this._removeDelayedCalls(),b.removeTweens(this.timerFlash)},namespace("srr.ui").UITimer=d}(),function(){function a(a){return Math.floor(a/1e3)}function b(){this.closeBtn.removeEventListener("buttonPress",this.gotoMenu),app.signals.onGotoMenu.dispatch()}var c=include("createjs.Container"),d=include("springroll.easeljs.Button"),e=include("srr.ui.UITimer"),f=include("srr.ui.LevelProgress"),g=function(a){c.call(this),this.onResize=this.onResize.bind(this),this.init()},h=(c.prototype,extend(g,c));h.init=function(){var a=new d(images.homeBtn);a.setPos(0,0),this.closeBtn=a,this.addChild(a);var c=new e(160,0);this.timer=c,this.addChild(c);var g=new f;this.levelProgress=g,this.addChild(g);var h=new createjs.Text("96","60px Arial","#ffffff");h.textAlign="center",h.x=270,h.y=76,this.addChild(h),this.timeLabel=h,this.gotoMenu=b.bind(this),this.closeBtn.addEventListener("buttonPress",this.gotoMenu),window.addEventListener("resize",this.onResize,!1),this.onResize()},h.update=function(b,c){this.timer.setFill(b.remainingTime/b.levelTime),this.timeLabel.text=a(b.remainingTime)+"",this.levelProgress.update(c)},h.onResize=function(){var a=this;setTimeout(function(){a.x=0+app._scaleOffset/app._scale},20)},h.onEndGame=function(){this.closeBtn.removeEventListener("buttonPress",this.gotoMenu),this.cache(0,0,1280,720),this.alpha=.5},h.teardown=function(){this.timer.teardown(),window.removeEventListener("resize",this.onResize,!1)},namespace("srr.ui").GameUI=g}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(){a.call(this),this.init()},d=(a.prototype,extend(c,a));d.init=function(){var a=new b(images.end_panel);a.setPos(900,550),this.addChild(a);var c=new createjs.Text("96","60px Arial","#ffffff");c.textAlign="center",c.setPos(850,550),this.addChild(c),this.timeLabel=c,this.updateInfo("moon")},d.updateInfo=function(a){app.progress&&app.progress[a]>0?(this.timeLabel.text=app.progress[a]+"/14",this.visible=!0):this.visible=!1},namespace("srr.ui").PanelAmount=c}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=include("createjs.Tween"),d=function(c,d){this.infoCont=new a,this.planet=c;var e=new b(images["infoBar_"+c]);e.reg(.5,1),e.setPos(640,720),this.infoCont.addChild(e),this.watchout=new b(images.watchout),this.watchout.setPos(320,670),this.infoCont.addChild(this.watchout),d.addChild(this.infoCont),this.enabled=!1,"moon"===c?this.items=g:"mars"===c?this.items=f:this.items=h,this.onMouseDown=this.onMouseDown.bind(this),stage.addEventListener("mousedown",this.onMouseDown)},e=d.prototype,f=[{name:"storm",x1:563,x2:782},{name:"rock",x1:783,x2:951}],g=[{name:"pothole",x1:550,x2:740},{name:"rock",x1:741,x2:960}],h=[{name:"pothole",x1:505,x2:692},{name:"rock",x1:693,x2:834},{name:"storm",x1:835,x2:1020}];e.show=function(){this.infoCont.y=200,this.infoCont.visible=!0,c.removeTweens(this.infoCont),c.get(this.infoCont).to({y:0},500),c.removeTweens(this.watchout),this.watchout.x=270,this.watchout.alpha=1,c.get(this.watchout,{loop:!0}).to({x:300,alpha:0},750)},e.hide=function(){this.infoCont.visible=!1,c.removeTweens(this.infoCont)},e.onMouseDown=function(){if(this._enabled)for(var a=this.items.length-1;a>=0;a--)app.pointer.y>632&&app.pointer.x>this.items[a].x1&&app.pointer.x<this.items[a].x2&&app.voPlayer.play("4_"+this.items[a].name)},Object.defineProperty(e,"enabled",{set:function(a){this._enabled=a,a?this.show():this.hide()}}),e.teardown=function(){stage.removeEventListener("mousedown",this.onMouseDown)},namespace("srr.panels").PlanetInfo=d}(),function(){var a=include("createjs.Bitmap"),b=include("springroll.easeljs.Button"),c=include("srr.ui.EndGamePopup"),d=function(){c.call(this)},e=c.prototype,f=extend(d,c);f.init=function(){app.voPlayer.play("8_wa"),app.sound.play("results-lose"),app.analytics.failLevel();var a=this;this._to=setTimeout(function(){a.delayedShow()},1500)},f.delayedShow=function(){var b=new a(images.fail);b.x=0,b.y=0,this.addChild(b),this.addButtons()},f.addButtons=function(){this.backBtn=new b(images.homeBtn),this.backBtn.setPos(110,10),this.addChild(this.backBtn),this.onBackPress=this.onBackPress.bind(this),this.backBtn.addEventListener("buttonPress",this.onBackPress),this.replayBtn=new b(images.playBtn),this.replayBtn.scale(.75),this.replayBtn.setPos(495,500),this.addChild(this.replayBtn),this.onReplay=this.onReplay.bind(this),this.replayBtn.addEventListener("buttonPress",this.onReplay)},f.onBackPress=function(){this.teardown(),app.signals.onGotoMenu.dispatch(),app.sound.play("uiPos")},f.onReplay=function(){this.teardown(),
app.signals.onReplay.dispatch(),app.sound.play("uiPos")},f.teardown=function(){e.teardown.call(this),this._to&&clearTimeout(this._to)},namespace("srr.ui").PopupFailure=d}(),function(){function a(){return-50*Math.random()}var b=include("createjs.Bitmap"),c=include("springroll.easeljs.Button"),d=include("srr.ui.EndGamePopup"),e=include("createjs.Tween"),f=include("createjs.Ease"),g=include("springroll.DelayedCall"),h=function(){d.call(this)},i=d.prototype,j=extend(h,d),k={0:{x:241,y:335},1:{x:384,y:320},2:{x:526,y:303},3:{x:281,y:420},4:{x:423,y:400},5:{x:565,y:380},6:{x:320,y:501},7:{x:463,y:478},8:{x:605,y:459}};j.init=function(){app.sound.stopAll(),app.sound.unloadAll(),this.playAudio(),app.sound.play("results-win"),app.endPanel&&app.endPanel.playAnimation();var a=this;this._to=setTimeout(function(){a.delayedShow()},1500),app.analytics.winLevel()},j.playAudio=function(){Math.random()<.25?app.voPlayer.play("6_boop_hurray",this.onAfterIntro):app.voPlayer.play("7_payoff_norm"+Math.randomInt(1,3))},j.delayedShow=function(){var a=new b(images.winLevel);a.x=0,a.y=0,this.addChild(a),this.addButtons(),this.delayedCalls=[],this.showProgress()},j.addButtons=function(){this.backBtn=new c(images.homeBtn),this.backBtn.setPos(110,10),this.addChild(this.backBtn),this.onBackPress=this.onBackPress.bind(this),this.backBtn.addEventListener("buttonPress",this.onBackPress),this.nextBtn=new c(images.playBtn),this.nextBtn.scale(.75),this.nextBtn.setPos(495,500),this.addChild(this.nextBtn),this.onNextPress=this.onNextPress.bind(this),this.nextBtn.addEventListener("buttonPress",this.onNextPress)},j.makePanel=function(c){var d=new b(images["sp_"+(c+1)]),e=(new createjs.ColorMatrix).adjustHue(a());return d.filters=[new createjs.ColorMatrixFilter(e)],d.cache(0,0,d.image.width,d.image.height),d.reg(.5),d},j.showProgress=function(){var a,b,c=app.progress.current-1;for(b=0;c>b;b++)a=this.makePanel(b+1),a.setPos(k[b]),this.addChild(a);a=this.makePanel(c+1),a.setPos(660,0),a.scale(2),a.alpha=0,this.addChild(a),this.panel=a,this.delayedCalls.push(new g(function(){e.get(a).to({alpha:1,scaleX:1.5,scaleY:1.5,x:k[c].x,y:k[c].y,rotation:360},500,f.sineInOut)},500)),this.delayedCalls.push(new g(function(){e.get(a).to({scaleX:1,scaleY:1},300,f.sineInOut)},1e3))},j.onBackPress=function(){this.teardown(),app.signals.onGotoMenu.dispatch(),app.sound.play("uiPos")},j.onNextPress=function(){this.teardown(),app.signals.onPlayNextLvl.dispatch(),app.sound.play("uiPos")},j.teardown=function(){i.teardown.call(this),this._to&&clearTimeout(this._to),e.removeTweens(this.panel);for(var a=this.delayedCalls.length-1;a>=0;a--)this.delayedCalls[a].destroy()},namespace("srr.ui").PopupWinLevel=h}(),function(){var a=include("createjs.Bitmap"),b=include("springroll.easeljs.Button"),c=include("srr.ui.EndGamePopup"),d=function(){c.call(this)},e=c.prototype,f=extend(d,c);f.init=function(){app.voPlayer.play("6_boop_found",this.onAfterIntro);var a=this;this._to=setTimeout(function(){a.delayedShow()},1500)},f.onAfterIntro=function(){app.voPlayer.play("7_payoff_level15")},f.delayedShow=function(){var c=new a(images.winPlanet);c.x=0,c.y=0,this.addChild(c);var d=new b(images.playBtn);d.scale(.7),d.x=500,d.y=530,this.addChild(d),this.backBtn=d,this.onBtnPress=this.onBtnPress.bind(this),this.backBtn.addEventListener("buttonPress",this.onBtnPress)},f.onBtnPress=function(){app.signals.onGotoMenu.dispatch(),app.sound.play("uiPos")},f.teardown=function(){e.teardown.call(this),this._to&&clearTimeout(this._to)},namespace("srr.ui").PopupWinPlanet=d}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=include("springroll.easeljs.Button"),d=function(b){this.starPositions={0:{x:198,y:-128},1:{x:174,y:-90},2:{x:186,y:-40},3:{x:127,y:-20},4:{x:72,y:16},5:{x:262,y:116},6:{x:317,y:108},7:{x:345,y:64},8:{x:369,y:5},9:{x:415,y:-16},10:{x:570,y:52},11:{x:612,y:25},12:{x:621,y:-24},13:{x:640,y:-77},14:{x:680,y:-102}},this.landmarkPos={0:{x:235,y:-135},1:{x:135,y:22},2:{x:447,y:-19},3:{x:740,y:-150}},this.maskRect={0:{x:220,y:-150,w:100,h:100},1:{x:160,y:-170,w:100,h:100},3:{x:170,y:-130,w:100,h:100},4:{x:145,y:-130,w:140,h:150},5:{x:80,y:-130,w:180,h:165}},a.call(this),this.init()},e=(a.prototype,extend(d,a));e.init=function(){var b=944;this.map=new a,this.initPath(b),this.addStars(b),this.addLandmarks(b),this.map.cache(0,0,2e3,720),this.addChild(this.map),this.initSean(b)},e.initPath=function(a){this.makeMaskedPath(0),this.makeMaskedPath(a)},e.makeMaskedPath=function(a){var c=79+a,d=-128,e=new b(images[this.planetName+"Path"]);e.setPos(c,d),e.scale(.55),this.map.addChild(e),e=new b(images[this.planetName+"Path2"]),e.setPos(c,d),e.scale(.55),this.map.addChild(e);var f=Math.max(0,app.progress.current),g=this.maskRect[f],h=new createjs.Shape;h.graphics.beginFill("Red"),h.graphics.moveTo(g.x,g.y).lineTo(g.x+g.w,g.y).lineTo(g.x+g.w,g.y+g.h).lineTo(g.x,g.y+g.h),h.x+=a,h._off=!0,e.mask=h},e.addStars=function(a){var c=0;for(c;c<app.progress.current;c++){var d=new b(images.star);d.setPos(this.starPositions[c].x,this.starPositions[c].y),this.map.addChild(d),10>c&&(d=new b(images.star),d.setPos(this.starPositions[c].x+a,this.starPositions[c].y),this.map.addChild(d))}},e.addLandmarks=function(a){for(var c=0;4>c;c++){var d=new b(images[this.planetName+"Landmark"+(c+1)]);d.scale(.55),d.setPos(this.landmarkPos[c].x,this.landmarkPos[c].y),this.map.addChild(d),2>c&&(d=new b(images[this.planetName+"Landmark"+(c+1)]),d.scale(.55),d.setPos(this.landmarkPos[c].x+a,this.landmarkPos[c].y),this.map.addChild(d))}},e.initSean=function(b){this.seanButtons=new a;var d=new c(images.planetSean);this.seanButtons.addChild(d),this.addChild(this.seanButtons),d=new c(images.planetSean),d.x=944,this.seanButtons.addChild(d);var e=Math.max(0,app.progress.current-1);this.seanButtons.x=this.starPositions[e].x-33,this.seanButtons.y=this.starPositions[e].y-33,this.addChild(this.seanButtons),this.onSeanPress=this.onSeanPress.bind(this),this.seanButtons.on("click",this.onSeanPress)},e.onSeanPress=function(){app.signals.onGotoLevel.dispatch(this.planetName),this.seanButtons.off("click",this.onSeanPress)},e.teardown=function(){},namespace("srr").ProgressionMap=d}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(b,c){a.call(this),this.bgWidth=0,this.init(b,c),this.drag(0)},d=(a.prototype,extend(c,a));d.init=function(a,c){var d=new b(images[c]);d.x=d.y=-200,this.addChild(d),this.bgWidth=d.image.width,d=new b(images[c]),d.x=this.bgWidth-200,d.y=-200,this.addChild(d),this.y=-120,this.scale(.55),this.mask=a},d.scroll=function(a){for(this.x+=a;this.x>-100;)this.x-=.55*this.bgWidth;for(;this.x<-1700;)this.x+=.55*this.bgWidth},d.teardown=function(){},namespace("srr").ScrollBG=c}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(b){a.call(this),this.init()},d=(a.prototype,extend(c,a));d.init=function(){this.initBtn(),this.initPanel(),this.alpha=.5},d.initBtn=function(){var a=new b(images.debug);a.setPos(620,20),this.debugBtn=a,this.addChild(a),this.showPanel=this.showPanel.bind(this),this.debugBtn.addEventListener("mousedown",this.showPanel)},d.showPanel=function(){this.p.visible=!0,this.debugBtn.visible=!1},d.hidePanel=function(){this.p.visible=!1,this.debugBtn.visible=!0},d.initPanel=function(){this.p=new a;var b=700,c=200,d=new createjs.Shape;d.graphics.beginFill("#D3D3D3").drawRect(640-b/2,0,b,c),this.p.addChild(d);var e=0;this.addBtn("win",e++),this.addBtn("lose",e++),this.addBtn("extraTime",e++),this.addBtn("bubble",e++),this.addBtn("speed",e++),this.addBtn("close",e++),("moon"===app.currentPlanet||"mars"===app.currentPlanet||"venus"===app.currentPlanet)&&this.addBtn("rock",e++),("moon"===app.currentPlanet||"venus"===app.currentPlanet)&&this.addBtn("pothole",e++),("mars"===app.currentPlanet||"venus"===app.currentPlanet)&&this.addBtn("storm",e++),this.p.visible=!1,this.addChild(this.p)},d.addBtn=function(a,c){var d=300+c%6*120,e=120*Math.floor(c/6);this[a+"Btn"]=new b(images["debug_"+a]),this[a+"Btn"].setPos(d,e),this.p.addChild(this[a+"Btn"]),this["on_"+a]=this["on_"+a].bind(this),this[a+"Btn"].addEventListener("mousedown",this["on_"+a])},d.on_close=function(){this.hidePanel()},d.on_win=function(){app.signals.arrivedAtGoal.dispatch(),this.hidePanel()},d.on_lose=function(){app.signals.outOfTime.dispatch(),this.hidePanel()},d.on_bubble=function(){app.signals.pickupPowerup.dispatch("immunityBubble"),this.hidePanel()},d.on_speed=function(){app.signals.pickupPowerup.dispatch("speedBoost"),this.hidePanel()},d.on_extraTime=function(){app.signals.pickupPowerup.dispatch("extraTime"),this.hidePanel()},d.on_rock=function(){app.signals.hitObstacle.dispatch("rock"),this.hidePanel()},d.on_pothole=function(){app.signals.hitObstacle.dispatch("pothole"),this.hidePanel()},d.on_storm=function(){app.signals.hitObstacle.dispatch("storm"),this.hidePanel()},d.teardown=function(){this.debugBtn.removeEventListener("buttonPress",this.showPanel),this.closeBtn.removeEventListener("buttonPress",this.on_close),this.winBtn.removeEventListener("buttonPress",this.on_win)},namespace("srr.debug").DebugGamePanel=c}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(){},d=c.prototype;d.init=function(b,c,d){this.cont=d,this.objectCont=new a,this.initImg(),this.cont.addChild(this.objectCont),this.moveTo(b,c)},d.hitCheck=function(a){return Math.dist(a,this.pos)<this._radius},d.onCollision=function(){},d.initImg=function(){var a=null;"storm"===this.colliderName?(a=new lib.DustStorm,a.framerate=16):a=new b(images[this.colliderName]),a.reg(.5),this.objectCont.addChild(a)},d.move=function(a,b){this.objectCont.x+=a,this.objectCont.y+=b},d.moveTo=function(a,b){this.objectCont.x=a,this.objectCont.y=b},Object.defineProperty(d,"x",{get:function(){return this.objectCont.x},set:function(a){this.objectCont.x=a}}),Object.defineProperty(d,"y",{get:function(){return this.objectCont.y},set:function(a){this.objectCont.y=a}}),Object.defineProperty(d,"pos",{get:function(){return{x:this.x,y:this.y}}}),d.destroy=function(){this.cont.removeChild(this.objectCont)},namespace("srr.collidables").Collidable=c}(),function(){var a=include("srr.collidables.Collidable"),b=function(b){a.call(this),this.colliderName=b,this._radius=60},c=(a.prototype,extend(b,a));c.onCollision=function(){app.signals.hitObstacle.dispatch(this.colliderName)},namespace("srr.collidables").Obstacle=b}(),function(){var a=include("srr.collidables.Collidable"),b=function(b){a.call(this),this.colliderName=b,this._radius=75},c=(a.prototype,extend(b,a));c.onCollision=function(){app.signals.pickupPowerup.dispatch(this.colliderName)},namespace("srr.collidables").Powerup=b}(),function(){function a(a){return"immunityBubble"===a||"speedBoost"===a||"extraTime"===a?!0:!1}function b(a){return"storm"===a||"rock"===a||"pothole"===a?!0:!1}var c=include("srr.collidables.Powerup"),d=include("srr.collidables.Obstacle"),e=function(){},f=e.prototype;f.make=function(e){return b(e)?new d(e):a(e)?new c(e):void 0},namespace("srr.collidables").CollidableFactory=e}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=include("srr.misc.EndSolarPanel"),d=function(b,c,d){a.call(this),this.tileID=b,this.x=c,this.y=d,this.init()},e=(a.prototype,extend(d,a)),f=d.WIDTH=700;d.RISE=84.5;e.init=function(){var a=null;a="tile_end"===this.tileID?this.makeEndTile():this.makeTile(),this.addChild(a),this.scaleX=1.005},e.makeTile=function(){var c=new a;return c.addChild(new b(images[this.tileID])),c},e.makeEndTile=function(){var d=new a;if(d.addChild(new b(images[this.tileID])),app.progress.isFinalLevel){var e=new b(images.end_boop);e.setPos(150,350),d.addChild(e)}else{var f=new c(d,140,450);app.endPanel=f}return d},e.move=function(a,b){this.x+=b.x,this.y+=b.y,this.collidable&&this.collidable.move(b.x,b.y),this.x<-(f+app._safeZone)&&app.signals.tileLeavesScreen.dispatch(a)},e.destroy=function(){this.removeChild(this.tileImg),this.tileImg=null},namespace("srr.tileSystem").Tile=d}(),function(){var a=function(a){this.subTracks=[],this.trackArray=[],this.tmpPiece=null,"easy"===a?this.initEasy():"meium"===a?this.initMedium():this.initHard(),this.randomizeTrack(),this.subToTrack()},b=a.prototype;b.initEasy=function(){this.subTracks=[],this.subTracks.push(["top"]),this.subTracks.push(["top","powerup"]),this.subTracks.push(["top","obstacle"]),this.subTracks.push(["mid"]),this.subTracks.push(["mid","powerup"]),this.subTracks.push(["mid","obstacle"]),this.subTracks.push(["bot"]),this.subTracks.push(["bot","powerup"]),this.subTracks.push(["bot","obstacle"]),this.subTracks.push(["top","powerup"]),this.subTracks.push(["bot","powerup"]),this.subTracks.push(["easy"]),this.subTracks.push(["medium"]),this.subTracks.push(["hard"])},b.initMedium=function(){this.subTracks=[],this.subTracks.push(["top"]),this.subTracks.push(["top","powerup"]),this.subTracks.push(["top","obstacle"]),this.subTracks.push(["top","obstacle"]),this.subTracks.push(["mid"]),this.subTracks.push(["mid","powerup"]),this.subTracks.push(["mid","obstacle"]),this.subTracks.push(["bot"]),this.subTracks.push(["bot","powerup"]),this.subTracks.push(["bot","obstacle"]),this.subTracks.push(["bot","obstacle"]),this.subTracks.push(["top","powerup"]),this.subTracks.push(["bot","powerup"]),this.subTracks.push(["easy"]),this.subTracks.push(["medium"]),this.subTracks.push(["hard"])},b.initHard=function(){this.subTracks=[],this.subTracks.push(["top"]),this.subTracks.push(["top","powerup"]),this.subTracks.push(["top","obstacle"]),this.subTracks.push(["top","obstacle"]),this.subTracks.push(["mid"]),this.subTracks.push(["mid","powerup"]),this.subTracks.push(["mid","obstacle"]),this.subTracks.push(["mid","obstacle"]),this.subTracks.push(["bot"]),this.subTracks.push(["bot","powerup"]),this.subTracks.push(["bot","powerup"]),this.subTracks.push(["bot","obstacle"]),this.subTracks.push(["bot","obstacle"]),this.subTracks.push(["top","powerup"]),this.subTracks.push(["bot","powerup"]),this.subTracks.push(["easy"]),this.subTracks.push(["medium"]),this.subTracks.push(["hard"])},b.addPart=function(a,b){this["_"+a]=b;for(var c=b-1;c>=0;c--)this.trackArray.push(a)},b.randomizeTrack=function(){for(var a=0;10>a;a++)this.swapSubTrack(Math.randomInt(this.subTracks.length-1),Math.randomInt(this.subTracks.length-1))},b.subToTrack=function(){for(var a=this.subTracks.length-1;a>=0;a--)for(var b=this.subTracks[a].length-1;b>=0;b--)this.trackArray.push(this.subTracks[a][b])},b.swapSubTrack=function(a,b){a!==b&&(this.tmpPiece=this.subTracks[a],this.subTracks[a]=this.subTracks[b],this.subTracks[b]=this.tmpPiece)},Object.defineProperty(b,"total",{get:function(){return this._total||(this._total=this._straight,this._total+=this._top,this._total+=this._mid,this._total+=this._bot,this._total+=this._powerup,this._total+=this._obstacle),this._total}}),namespace("srr.tileSystem").TrackParts=a}(),function(){function a(a,b){b?a.push("tile_"+b):a.push("tile_straight")}function b(a){"moon"===app.currentPlanet?app.progress.easy||Math.random()<.66?obst="rock":obst="pothole":"mars"===app.currentPlanet?app.progress.easy||Math.rndBool?obst="storm":obst="rock":(this._rnd=Math.random(),app.progress.easy||this._rnd<.4?obst="rock":app.progress.medium||this._rnd<.8?obst="storm":obst="pothole"),a.push({id:"tile_straight",collidable:obst})}function c(a){var b="immunityBubble";Math.random()>.66?b="speedBoost":Math.random()>.33&&(b="extraTime"),a.push({id:"tile_straight",collidable:b})}function d(a){a.push("tile_mid_start"),Math.random()>.5&&a.push("tile_mid"),a.push("tile_mid_end")}function e(a){a.push("tile_top_start"),Math.random()>.5&&a.push("tile_top"),a.push("tile_top_end")}function f(a){a.push("tile_bot_start"),Math.random()>.5&&a.push("tile_bot"),a.push("tile_bot_end")}function g(b){a(b),a(b)}function h(b){a(b),b.push("tile_end")}function i(g,h){for(var i=h.length-1;i>=0;i--)switch(h[i]){case"straight":a(g);break;case"easy":a(g,"easy");break;case"medium":a(g,"medium");break;case"hard":a(g,"hard");break;case"top":e(g);break;case"mid":d(g);break;case"bot":f(g);break;case"powerup":c(g);break;case"obstacle":b(g)}}function j(a){var b=[];return g(b,a),i(b,a),h(b),b}var k=include("srr.tileSystem.TrackParts");TrackGenerator={},TrackGenerator.makeTrack=function(){var a=null;return a=new k(app.progress.easy?"easy":app.progress.medium?"medium":"hard"),j(a.trackArray)},namespace("srr.tileSystem").TrackGenerator=TrackGenerator}(),function(){var a=include("srr.tileSystem.Tile"),b=include("srr.tileSystem.TrackGenerator"),c=include("srr.collidables.CollidableFactory"),d=function(a){this.collidableFactory=new c,this.track=b.makeTrack(),this.collidableCont=a,this.lastTile=null},e=d.prototype,f={x:250,y:300},g={x:250,y:450},h={x:250,y:600};e.firstTile=function(){return this._makeTile(0,50)},Object.defineProperty(e,"nextTileAvailable",{get:function(){return this.track.length>0}}),e.nextTile=function(){var b=this.lastTile.x+a.WIDTH,c=this.lastTile.y-a.RISE;return this._makeTile(b,c)},e._getTileObj=function(){var a=this.track.splice(0,1)[0],b={};return"string"==typeof a?b.id=a:(b.id=a.id,b.collidable=a.collidable,!a.collidable),0===this.track.length&&app.signals.levelEndReached.dispatch(),b},e._makeTile=function(b,c){var d=this._getTileObj(),e=new a(d.id,b,c);return d.collidable&&this._addCollidable(e,d),this.lastTile=e,e},e._addCollidable=function(a,b){a.collidable=this.collidableFactory.make(b.collidable),this._rnd=Math.random(),this._rnd<.33?a.collidable.init(a.x+f.x,a.y+f.y,this.collidableCont):this._rnd<.66?a.collidable.init(a.x+g.x,a.y+g.y,this.collidableCont):a.collidable.init(a.x+h.x,a.y+h.y,this.collidableCont)},e.generateCollision=function(){for(var a,b,c,d=[],e=[],f=[],g=srr.tileSystem.Tile.WIDTH,h=0;h<this.track.length;h++)switch(this.track[h]){case"tile_top_start":a=g*h+250;break;case"tile_top_end":d.push([a,g*h+250]);break;case"tile_mid_start":b=g*h+250;break;case"tile_mid_end":e.push([b,g*h+250]);break;case"tile_bot_start":c=g*h+250;break;case"tile_bot_end":f.push([c,g*h+250])}return{top:d,mid:e,bot:f}},namespace("srr.tileSystem").TileFactory=d}(),function(){var a=include("createjs.Container"),b=function(b){a.call(this)};a.prototype,extend(b,a);namespace("srr.tileSystem").ObstacleCont=b}(),function(){var a=include("createjs.Bitmap"),b=include("createjs.Container"),c=function(a){b.call(this),this.tiles=[]},d=(b.prototype,extend(c,b)),e=60;d.init=function(a,b){this.tiles=[];var c=90;this.addTile(0,c),this.addTile(700,-e+c),this.addTile(1400,2*-e+c)},d.update=function(a){var b={x:-a,y:a/(700/e)};b.x*=.5,b.y*=.5,this.moveTiles(b)},d.moveTiles=function(a){for(var b=this.tiles.length-1;b>=0;b--)this.moveTile(b,a)},d.moveTile=function(a,b){var c=this.tiles[a];c.x+=b.x,c.y+=b.y,c.x<-700&&(c.x+=2100,c.y-=3*e)},d.addTile=function(b,c){var d=new a(images.parallaxBg);d.scaleX=1.01,this.tiles.push(d),d.x=b,d.y=c,this.addChild(d)},namespace("srr.tileSystem").ParallaxBg=c}(),function(){var a=include("createjs.Bitmap"),b=function(a){this.init(a)},c=b.prototype;c.init=function(b){var c=new a(images["sky_"+app.progress.difficulty]);c.scaleX=1280,b.addChild(c)},namespace("srr").PlanetBackground=b}(),function(){var a=include("createjs.Container"),b=include("srr.tileSystem.Tile"),c=include("srr.tileSystem.TileFactory"),d=function(){a.call(this)},e=d.widthHeightRatio=b.WIDTH/b.RISE,f=(a.prototype,extend(d,a));f.init=function(a){this.tileFactory=new c(a),this.trackLength=(this.tileFactory.track.length-1)*b.WIDTH,this.collision=this.tileFactory.generateCollision(),this.tiles=[],this.addTile(this.tileFactory.firstTile()),this.addTile(this.tileFactory.nextTile()),this.addTile(this.tileFactory.nextTile())},f.update=function(a){var b={x:-a,y:a/e};this.moveTiles(b)},f.moveTiles=function(a){for(var b=this.tiles.length-1;b>=0;b--)this.tiles[b].move(b,a)},f.tileLeavesScreen=function(a){this.removeTile(a),this.tileFactory.nextTileAvailable&&this.addTile(this.tileFactory.nextTile())},f.removeTile=function(a){var b=this.tiles[a];b.obstacle&&(b.obstacle.destroy(),b.obstacle=null),this.tiles.splice(a,1),this.removeChild(b),b.destroy(),b=null},f.removePowerup=function(a){this.tileFactory.removePowerup(a)},f.addTile=function(a){a&&(this.tiles.push(a),this.addChild(a))},namespace("srr.tileSystem").TileManager=d}(),function(){var a=function(a,b,c){this._i=0,this.pos={x:a,y:b},this.VO=c},b=a.prototype;b.aboveInfo=function(a){return Math.dist(a,this.pos)<50?!0:!1},b.tryPlay=function(a){return this.aboveInfo(a)?(this.play(),!0):void 0},b.play=function(){var a=this._i++;app.voPlayer.play(this.VO[a]),this._i>this.VO.length-1&&(this._i=0)},namespace("srr.audio").PlanetVOLocation=a}(),function(){var a=function(){this._locations=[]},b=a.prototype;b.tryPlay=function(a){for(var b=this._locations.length-1;b>=0;b--)if(this._locations[b].tryPlay(a))return!0},namespace("srr.audio").PlanetFacts=a}(),function(){var a=include("srr.audio.PlanetVOLocation"),b=include("srr.audio.PlanetFacts"),c=function(){b.call(this),this._locations=[],this._locations.push(new a(105,-100,["3_loc_mn_mare1","3_loc_mn_mare2","3_loc_mn_mare3","3_loc_mn_mare4"])),this._locations.push(new a(1055,-100,["3_loc_mn_mare1","3_loc_mn_mare2","3_loc_mn_mare3","3_loc_mn_mare4"])),this._locations.push(new a(0,80,["3_loc_mn_ocean1","3_loc_mn_ocean2","3_loc_mn_ocean3","3_loc_mn_ocean4"])),this._locations.push(new a(943,80,["3_loc_mn_ocean1","3_loc_mn_ocean2","3_loc_mn_ocean3","3_loc_mn_ocean4"])),this._locations.push(new a(320,40,["3_loc_mn_had1","3_loc_mn_had2","3_loc_mn_had3","3_loc_mn_had4"])),this._locations.push(new a(610,-95,["3_boop_click"]))};b.prototype,extend(c,b);namespace("srr.audio").MoonFacts=c}(),function(){var a=include("srr.audio.PlanetVOLocation"),b=include("srr.audio.PlanetFacts"),c=function(){b.call(this),this._locations=[],this._locations.push(new a(853,70,["3_loc_ven_ish1","3_loc_ven_ish2","3_loc_ven_ish3","3_loc_ven_ish4"])),this._locations.push(new a(-90,70,["3_loc_ven_ish1","3_loc_ven_ish2","3_loc_ven_ish3","3_loc_ven_ish4"])),this._locations.push(new a(165,-20,["3_loc_ven_aphro1","3_loc_ven_aphro2","3_loc_ven_aphro3"])),this._locations.push(new a(388,-100,["3_loc_ven_maat1","3_loc_ven_maat2","3_loc_ven_maat3","3_loc_ven_maat4"])),this._locations.push(new a(633,-20,["3_boop_click"]))};b.prototype,extend(c,b);namespace("srr.audio").VenusFacts=c}(),function(){var a=include("srr.audio.PlanetVOLocation"),b=include("srr.audio.PlanetFacts"),c=function(){b.call(this),this._locations=[],this._locations.push(new a(833,-5,["3_loc_mars_valles1","3_loc_mars_valles2","3_loc_mars_valles3","3_loc_mars_valles4"])),this._locations.push(new a(-111,-5,["3_loc_mars_valles1","3_loc_mars_valles2","3_loc_mars_valles3","3_loc_mars_valles4"])),this._locations.push(new a(273,-110,["3_loc_mars_msharp1","3_loc_mars_msharp2","3_loc_mars_msharp3"])),this._locations.push(new a(275,88,["3_loc_mars_peace1","3_loc_mars_peace2","3_loc_mars_peace3"])),this._locations.push(new a(656,26,["3_boop_click"]))};c.prototype,extend(c,b);namespace("srr.audio").MarsFacts=c}(),function(){var a=function(){this._startPlayed=!1,this._midPlayed=!1,this._endPlayed=!1,this._flav1Played=!1,this._flav2Played=!1},b=a.prototype,c=[{start:"moon1Start",mid:"moon1Mid"},{start:"moon2Start",mid:"3_loc_mn_mare4"},{start:"moon3Start",mid:"3_loc_mn_mare3"},{start:"3_moon",mid:"3_loc_mn_ocean3"},{start:"moon5Start",mid:"3_loc_mn_ocean2"},{start:"3_loc_mn_ocean3",mid:"3_loc_mn_ocean4"},{start:"moon7Start",mid:"3_loc_mn_had1"},{start:"moon8Start",mid:"3_loc_mn_had3"},{start:"3_loc_mn_had2",mid:"3_loc_mn_had4"}],d=[{start:"4_to_mars2",mid:"3_loc_mars_valles1"},{start:"3_loc_mars_valles2",mid:"3_loc_mars_valles4"},{start:"4_to_mars1",mid:"3_loc_mars_valles3"},{start:"3_mars",mid:"3_loc_mars_msharp3"},{start:"4_to_mars1",mid:"3_loc_mars_msharp1"},{start:"3_loc_mars_msharp2",mid:"mars6Mid"},{start:"4_to_mars2",mid:"3_loc_mars_peace3"},{start:"3_loc_mars_peace1",mid:"3_loc_mars_peace2"},{start:"3_loc_mars_peace3",mid:"4_to_mars1"}],e=[{start:"venus1Start",mid:"3_loc_ven_ish2"},{start:"venus2Start",mid:"3_loc_ven_ish4"},{start:"4_to_venus4",mid:"3_loc_ven_ish3"},{start:"venus4Start",mid:"3_loc_ven_aphro2"},{start:"4_to_venus3",mid:"3_loc_ven_aphro1"},{start:"4_to_venus1",mid:"3_loc_ven_aphro3"},{start:"venus7Start",mid:"3_loc_ven_maat3"},{start:"venus8Start",mid:"3_loc_ven_maat4"},{start:"4_to_venus4",mid:"3_loc_ven_maat2"}],f=["flav_astronaut","flav_awesome","flav_cant_believe","flav_crater","flav_interesting_rock","flav_planets_beautiful","flav_space_explorer","flav_stars_bright","flav_super_cool","flav_woohoo"];b.tryPlay=function(a){this._startPlayed?!this._flav1Played&&a>.25?(this._flav1Played=!0,this.tryPlayFlav()):!this._midPlayed&&a>.45?this.playMid():!this._flav2Played&&a>.7?(this._flav2Played=!0,this.tryPlayFlav()):!this._endPlayed&&a>.8&&.9>=a&&this.playEnd():this.playStart()},b.playStart=function(){this._startPlayed=!0,"moon"==app.currentPlanet?app.voPlayer.play(c[app.progress.current].start):"mars"==app.currentPlanet?app.voPlayer.play(d[app.progress.current].start):"venus"==app.currentPlanet&&app.voPlayer.play(e[app.progress.current].start)},b.playMid=function(){this._midPlayed=!0,"moon"==app.currentPlanet?0===app.progress.current?app.voPlayer.play("3_loc_mn_mare1",function(){app.voPlayer.play(c[app.progress.current].mid)}):app.voPlayer.play(c[app.progress.current].mid):"mars"==app.currentPlanet?app.voPlayer.play(d[app.progress.current].mid):"venus"==app.currentPlanet&&app.voPlayer.play(e[app.progress.current].mid)},b.playEnd=function(){this._endPlayed=!0,Math.random()>.75&&app.voPlayer.play("6_boop_uhoh")},b.tryPlayFlav=function(){app.voPlayer.playing||(app.flavID=app.flavID+1||0,app.flavID>f.length-1&&(app.flavID=0),app.voPlayer.play(f[app.flavID]))},namespace("srr.audio").DrivingInfo=a}(),function(){var a=function(a){this._i=0,this._items=a},b=a.prototype;b.play=function(){app.voPlayer.play(this._items[this._i]),this._i++,this._i>=this._items.length&&(this._i=0)},namespace("srr.audio").LoopedVOPlayer=a}(),function(){var a=include("srr.audio.MarsFacts"),b=include("srr.audio.MoonFacts"),c=include("srr.audio.VenusFacts"),d=function(){this._planet=null,this.lastClickWasSuccess=!1,this.mars=new a,this.moon=new b,this.venus=new c},e=d.prototype;e.tryPlay=function(a,b){this.lastClickWasSuccess=this[a].tryPlay(b)},namespace("srr.audio").PlanetFactPlayer=d}(),function(){function a(){g.removeEventListener("canplaythrough",a,!1),g.removeEventListener("load",a,!1),h.onCompleteLoad()}function b(a,b,c){var d=document.createElement("source");d.src=b,d.type=c,a.appendChild(d)}var c=!1,d=!1,e=!1,f=function(a,b){document.getElementById("videoarea").style.visibility="hidden",window.addEventListener("resize",h.onResize),window.addEventListener("orientationchange",h.onResize),app.container.on("soundMuted",i),h.loadCompleteCallback=a,h.endedCallback=b,this.init()},g=null,h=f.prototype;h.loadCompleteCallback=null;var i=function(a){setTimeout(function(){g.muted=!!a.data},20)};h.endVideo=function(){e=!0,this.endedCallback&&this.endedCallback()},h.init=function(){var a=!!document.createElement("video").canPlayType;if(a){g=document.createElement("video"),g.setAttribute("id","video"),g.setAttribute("width",Math.ceil(app.display.width)+"px"),g.setAttribute("height",Math.ceil(app.display.width/1.5)+"px"),document.getElementById("videoarea").appendChild(g);try{g.muted=app.sound._contexts.sfx.muted}catch(c){}this.endVideo=this.endVideo.bind(this),g.addEventListener("ended",this.endVideo,!1),b(g,"assets/video/Intro.mp4","video/mp4"),b(g,"assets/video/Intro.ogv","video/ogv");var d=this;setTimeout(function(){d.onResize()},20)}else endVideo()},h.startLoading=function(){!c&&g&&(c=!0,g.play(),4!==g.readyState?(g.addEventListener("canplaythrough",a,!1),g.addEventListener("load",a,!1)):this.onCompleteLoad(),setTimeout(function(){g.pause()},20))},h.onCompleteLoad=function(){d=!0,h.loadCompleteCallback()},Object.defineProperty(h,"loaded",{get:function(){return d}}),h.onResize=function(){g&&(g.width=app.display.width,g.height=g.width/1.5)},h.pause=function(){g&&g.pause()},h.tryPlay=function(){g&&d&&(e||(document.getElementById("videoarea").style.visibility="visible",g.play(),this.ccTriggered||(this.ccTriggered=!0,app.voPlayer.stop(),app.captions.selfUpdate=!0,app.captions.play("intro"))))},h.removeVideo=function(){if(app.container.off("soundMuted",i),window.removeEventListener("resize",h.onResize),window.removeEventListener("orientationchange",h.onResize),g){g.removeEventListener("canplaythrough",a,!1),g.removeEventListener("load",a,!1),g.removeEventListener("ended",this.endVideo,!1),g.pause();var b=g.parentNode;b.removeChild(g),b.parentNode.removeChild(b)}g=null},namespace("videoPlayer").NativePlayer=f}(),function(){function a(){f=!0,i.endedCallback&&i.endedCallback()}var b=null,c="assets/video/Intro.ogv",d=!1,e=!1,f=!1,g=function(a,b){i.loadCompleteCallback=a,i.endedCallback=b,app.container.on("soundMuted",h)},h=function(a){setTimeout(function(){video.muted=!!a.data},20)},i=g.prototype;i.loadCompleteCallback=null,i.startLoading=function(){e||(e=!0,i.setUpPlayer(),i.mockLoad())},i.mockLoad=function(){d?i.videoReadyCallback():setTimeout(function(){i.mockLoad()},100)},i.videoReadyCallback=function(){d||(d=!0,i.loadCompleteCallback())},Object.defineProperty(i,"loaded",{get:function(){return d}}),i.setUpPlayer=function(){b&&(b.stop(),b.parentNode.removeChild(b));var d={readyCallback:i.videoReadyCallback};b=new OGVPlayer(d);try{b.muted=app.sound._contexts.sfx.muted}catch(e){}b.src=c,document.getElementById("videoarea").appendChild(b),b.addEventListener("ended",a,!1),app.triggerResize(),i.tryPlay(),b.pause()},i.pause=function(){b&&b.pause()},i.tryPlay=function(){b&&(b.play(),this.ccTriggered||(this.ccTriggered=!0,app.voPlayer.stop(),app.captions.selfUpdate=!0,app.captions.play("intro")))},i.removeVideo=function(){if(app.container.off("soundMuted",h),b){b.stop();var a=b.parentNode;a.removeChild(b),a.parentNode.removeChild(a)}b=null},namespace("videoPlayer").OvgPlayer=g}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=include("createjs.Tween"),d=include("createjs.Ease"),e=include("springroll.DelayedCall"),f=function(){a.call(this),this.player=null,this.init()},g=(a.prototype,extend(f,a));g.init=function(){this.gotoLine=new b(images.gotoLine),this.gotoLine.regX=.3*images.gotoLine.width,this.gotoLine.regY=.7*images.gotoLine.height,this.gotoLine.alpha=0,this.addChild(this.gotoLine);var c=new a;this.player=c,this.roverDefault=this.addRoverImg("rover"),this.roverLeft=this.addRoverImg("rover_left"),this.roverRight=this.addRoverImg("rover_right"),this._lastY=this.player.y;var d=this;this._dirUpdate=setInterval(function(){d.updateDir()},200);var e=new lib.Wheels;e.framerate=16,e.setPos(-85,-77),e.scale(this.roverDefault.scaleX),c.addChild(e),this.speedEffect=new lib.SpeedBoost,this.speedEffect.setPos(-230,-20),this.speedEffect.alpha=0,c.addChild(this.speedEffect),this.bubble=new b(images.immunityBubble),this.bubble.regX=.5*images.immunityBubble.width,this.bubble.regY=.5*images.immunityBubble.height,this.bubble.scale(0),this.bubble.alpha=0,c.addChild(this.bubble);var f=new b(images.debugCircle);f.regX=f.regY=images.debugCircle.width/2,f.scaleX=f.scaleY=.7,this.addChild(c)},g.addRoverImg=function(a){var c=new b(images[a]);return c.regX=.5*images.rover.width,c.regY=.5*images.rover.height,c.scaleX=c.scaleY=.8,this.player.addChild(c),c},g.updatePosition=function(a){this.player.x=a.x,this.player.y=a.y},g.updateDir=function(){this._lastY-this.player.y>.5?(this.roverLeft.visible=!0,this.roverDefault.visible=!1,this.roverRight.visible=!1):this._lastY-this.player.y<-.5?(this.roverLeft.visible=!1,this.roverDefault.visible=!1,this.roverRight.visible=!0):(this.roverDefault.visible=!0,this.roverLeft.visible=!1,this.roverRight.visible=!1),this._lastY=this.player.y},g.addBubble=function(){var a=this.bubble;c.removeTweens(a),c.get(a).to({alpha:.5,scaleX:1.6,scaleY:1.6},500,d.bounceOut)},g.removeBubble=function(){var a=this.bubble;new e(function(){c.removeTweens(a),c.get(a).to({
alpha:0,scaleX:0,scaleY:0},300,d.bounceOut)},150)},g.pickupSpeed=function(){c.removeTweens(this.speedEffect),c.get(this.speedEffect).to({alpha:1},200,d.bounceOut)},g.speedBoostEnd=function(){c.removeTweens(this.speedEffect),c.get(this.speedEffect).to({alpha:0},500,d.bounceOut)},g.exitStart=function(){clearTimeout(this._dirUpdate)},namespace("srr.vehicle").VehicleCont=f}(),function(){var a=include("srr.input.movementUtils"),b=include("srr.input.FollowPointerBehaviour"),c=include("srr.input.FadeToBackBehaviour"),d=function(){this.currentPos={x:0,y:0},this.desiredPos={x:0,y:0},this.vehicle=null,this.tileManager=null,this.moveTween=null,this.distTraveled=NaN},e=d.prototype;e.init=function(a,c){this.distTraveled=0,this.vehicle=a,this.tileManager=c,this.moveBehaviour=new b;var d={x:340,y:490};this.currentPos.x=this.desiredPos.x=d.x,this.currentPos.y=this.desiredPos.y=d.y,this.updateVehiclePosition()},e.update=function(a,b){this.distTraveled+=a,this.moveBehaviour&&(this.moveBehaviour.updateBehaviour(a,b,this.currentPos),this.currentPos=this.moveBehaviour.pos,this.collisionCheck()),this.updateVehiclePosition()},e.updateVehiclePosition=function(){this.vehicle.updatePosition(this.currentPos)},e.collisionCheck=function(){for(var a=this.tileManager,b=a.tiles.length-1;b>=0;b--)if(a.tiles[b].collidable){var c=a.tiles[b].collidable;c.hitCheck(this.currentPos)&&(c.onCollision(),a.tiles[b].collidable.destroy(),delete a.tiles[b].collidable)}},Object.defineProperty(e,"currentLane",{get:function(){return a.posToLane(this.currentPos,!0)!==this._lastLane&&(this._lastLane=a.posToLane(this.currentPos,!0)),this._lastLane}}),Object.defineProperty(e,"blocked",{get:function(){var b=a.laneName(this.currentLane),c=this.tileManager.collision[b];return a.laneBlockedAtPos(c,this.currentPos.x+this.distTraveled)}}),Object.defineProperty(e,"speedMultiplier",{get:function(){var a=(this.currentPos.x-200)/1200;return 1+a}}),e.onEndReached=function(){this.moveBehaviour&&this.moveBehaviour.teardown(),this.moveBehaviour=new c(this.currentPos)},e.teardown=function(){stage.removeEventListener("mousedown",this.onMouseDown),this.moveBehaviour&&this.moveBehaviour.teardown()},namespace("srr.vehicle").VehicleMovement=d}(),Signal.prototype={VERSION:"::VERSION_NUMBER::",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,b,c,d){var e,f=this._indexOfListener(a,c);if(-1!==f){if(e=this._bindings[f],e.isOnce()!==b)throw new Error("You cannot add"+(b?"":"Once")+"() then add"+(b?"Once":"")+"() the same listener without removing the relationship first.")}else e=new SignalBinding(this,a,b,c,d),this._addBinding(e);return this.memorize&&this._prevParams&&e.execute(this._prevParams),e},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c,d=this._bindings.length;d--;)if(c=this._bindings[d],c._listener===a&&c.context===b)return d;return-1},has:function(a,b){return-1!==this._indexOfListener(a,b)},add:function(a,b,c){return validateListener(a,"add"),this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){return validateListener(a,"addOnce"),this._registerListener(a,!0,b,c)},remove:function(a,b){validateListener(a,"remove");var c=this._indexOfListener(a,b);return-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1)),a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(this.active){var b,c=Array.prototype.slice.call(arguments),d=this._bindings.length;if(this.memorize&&(this._prevParams=c),d){b=this._bindings.slice(),this._shouldPropagate=!0;do d--;while(b[d]&&this._shouldPropagate&&b[d].execute(c)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var signals=Signal;signals.Signal=Signal,SignalBinding.prototype={active:!0,params:null,execute:function(a){var b,c;return this.active&&this._listener&&(c=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,c),this._isOnce&&this.detach()),b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},function(a){"function"==typeof define&&define.amd?define(function(){return signals}):"undefined"!=typeof module&&module.exports?module.exports=signals:a.signals=signals}(this),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=include("springroll.DelayedCall"),d=include("createjs.Tween"),e=include("createjs.Ease"),f=include("srr.TO.TimeoutNotification"),g=function(){a.call(this);var b=app.config.scaling.app;this.bounds={x:0,y:0,width:b.maxWidth,height:b.height},this.init()},h=(a.prototype,extend(g,a));h.init=function(){this.addBg();var b=new a;this.gameCont=b,this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.updateMinigame=this.updateMinigame.bind(this),this.initInput();var d=this;this.delayedCalls=[],this.delayedCalls.push(new c(function(){b.alpha=0,d.addChild(b),d.fadeIn()},50))},h.addBg=function(){this.darkBg=new createjs.Shape,this.darkBg.graphics.beginFill("rgba(0,0,0,1)").drawRect(0,0,1280,720),this.darkBg.alpha=0,this.addChild(this.darkBg)},h.addSean=function(){this.seanPopup=new b(images.seanPopup),this.seanPopup.reg(0,1),this.seanPopup.setPos(100,920),this.addChild(this.seanPopup)},h.initInput=function(){var a=this,b=app.display.stage;b.addEventListener("mousedown",a.onPointerDown),b.addEventListener("stagemouseup",a.onPointerUp),app.on("update",a.updateMinigame),this.mouseDown=!1},h.initVO=function(a,b,c,d){app["_"+a]?app.voPlayer.play(c[Math.randomInt(0,c.length-1)]):(app["_"+a]=!0,app.voPlayer.play(b[Math.randomInt(0,b.length-1)])),this._toID=d;var e=this.onTimeout.bind(this);this.timeout=new f(9e3,e)},h.onTimeout=function(){this.gameOver||app.voPlayer.playing||app.voPlayer.play(this._toID)},h.onPointerDown=function(){this.mouseDown=!0},h.onPointerUp=function(){this.mouseDown=!1},h.fadeIn=function(){this.addSean();var a=500;this.gameCont.cache(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),this.gameCont.y=-75,this.gameCont.alpha=0,d.get(this.gameCont).to({y:0,alpha:1},a,e.cubicOut),this.darkBg.alpha=0,d.get(this.darkBg).to({alpha:.4},a,e.cubicOut),d.get(this.seanPopup).to({y:720},a,e.cubicOut);var b=this;this.delayedCalls.push(new c(function(){b.afterFadeIn()},a))},h.afterFadeIn=function(){this.gameCont.uncache()},h.fadeOut=function(){this.gameCont.cache(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height);var a=500;d.get(this.gameCont).to({y:-75,alpha:0},a,e.cubicIn),d.get(this.darkBg).to({alpha:0},a,e.cubicIn),d.get(this.seanPopup).to({y:920},a,e.cubicOut)},h.updateMinigame=function(a){},h.completeMinigame=function(){var a=this;this.delayedCalls.push(new c(function(){a.fadeOut()},300)),this.delayedCalls.push(new c(function(){app.signals.minigameComplete.dispatch()},850)),app.voPlayer.play("6_react_whew"),app.sound.play("minigame-complete"),app.analytics.completedMinigame()},h.destroy=function(){var a=this,b=app.display.stage;b.removeEventListener("mousedown",a.onPointerDown),b.removeEventListener("stagemouseup",a.onPointerUp),app.off("update",a.updateMinigame),this.timeout&&this.timeout.teardown(),this.delayedIntro&&this.delayedIntro.destroy();for(var c=this.children.length-1;c>=0;c--)this.removeChild(this.children[0]);for(var d=this.delayedCalls.length-1;d>=0;d--)this.delayedCalls[d].destroy()},namespace("srr").Minigame=g}(),function(){var a=include("createjs.Bitmap"),b=include("createjs.Container"),c=function(a,c,d,e,f,g){b.call(this),this.hue=g,this._selected=!1,this.completed=!0,this.grey={wire:"#aaaaaa",stroke:"#989898"},this.coloured={wire:"#fade6a",stroke:"#c29d27"},this.startPos={x:c,y:d},this.endPos={x:e,y:f},this.init(),a.addChild(this)},d=(b.prototype,extend(c,b));d.init=function(){this.socket=this.createImg("socket",this.hue),this.socket.reg(.5),this.socket.setPos(this.endPos.x,this.endPos.y),this.addChild(this.socket),this.plug=this.createImg("plug",this.hue),this.plug.reg(.5,0),this.plug.x=Math.lerp(this.startPos.x,this.endPos.x,1),this.plug.y=Math.lerp(this.startPos.y,this.endPos.y,1),this.plug.visible=!1,this.addChild(this.plug),this.plug2=this.createImg("plug2",this.hue),this.plug2.reg(.5),this.plug2.x=Math.lerp(this.startPos.x,this.endPos.x,1),this.plug2.y=Math.lerp(this.startPos.y,this.endPos.y,1),this.addChild(this.plug2);var a=this.hue>0?"+"+this.hue:""+this.hue;this.coloured.wire=surfacecurve.color(this.coloured.wire).hue(a).hex6(),this.coloured.stroke=surfacecurve.color(this.coloured.stroke).hue(a).hex6(),this.updateColour(),this.wireCont=new b,this.addChild(this.wireCont),this.updateWireLine()},d.createImg=function(b,c){var d=new a(images[b]),e=(new createjs.ColorMatrix).adjustHue(c);return d.filters=[new createjs.ColorMatrixFilter(e)],d.cache(0,0,d.image.width,d.image.height),d},d.trySelect=function(a){var b={x:this.plug.x,y:this.plug.y+100};return!this.completed&&Math.dist(b,a)<75?(this.selected=!0,!0):!1},d.release=function(){this._selected&&(this.selected=!1)},Object.defineProperty(d,"selected",{get:function(){return this._selected},set:function(a){this._selected=a,a?(this.plug.visible=!1,this.plug2.visible=!0):(this.plug.visible=!0,this.plug2.visible=!1)}}),d.updateWire=function(){this.completed||(this._selected?this.movePlug(app.pointer.x,app.pointer.y):this.movePlug(Math.lerp(this.plug.x,this.startPos.x,.1),Math.lerp(this.plug.y,this.startPos.y,.1)),Math.dist(this.plug,this.endPos)<30&&this.connectWire(),this.updateWireLine())},d.connectWire=function(){this._selected=!1,this.movePlug(this.endPos.x,this.endPos.y),this.completed=!0,this.plug.visible=!1,this.plug2.visible=!0,this.updateColour(),app.sound.play("cable-plug")},d.detachWire=function(){this.completed=!1,this.plug.visible=!0,this.plug2.visible=!1,this.updateColour(),app.sound.play("cable-plug_2")},d.updateColour=function(){this.completed?this.wireColour=this.coloured:this.wireColour=this.grey},d.movePlug=function(a,b){this.plug.setPos(a,b),this.plug2.setPos(a,b)},d.updateWireLine=function(){this.wireCont.removeAllChildren(),this.line=new createjs.Shape,this.line.graphics.setStrokeStyle(14),this.line.graphics.beginStroke(this.wireColour.stroke),this.line.graphics.moveTo(this.startPos.x,this.startPos.y);var a=Math.dist(this.startPos,this.plug),b={x:0,y:0};b.x=Math.lerp(this.startPos.x,this.plug.x,.5),b.y=Math.max(this.startPos.y,this.plug.y)+a/2,this.line.graphics.quadraticCurveTo(b.x,b.y,this.plug.x,this.plug.y),this.wireCont.addChild(this.line),this.line=new createjs.Shape,this.line.graphics.setStrokeStyle(10),this.line.graphics.beginStroke(this.wireColour.wire),this.line.graphics.moveTo(this.startPos.x,this.startPos.y),this.line.graphics.quadraticCurveTo(b.x,b.y,this.plug.x,this.plug.y),this.wireCont.addChild(this.line)},namespace("srr").Wire=c}(),function(){var a=include("createjs.Bitmap"),b=function(a,b,c,d,e){this.startDepth=d,this.endDepth=d+80,this.progress=e||0,this.init(a,b,c,d)},c=b.prototype;c.init=function(b,c,d,e){this._audioCount=0;var f=new a(images.screw);f.scaleY=.9,f.x=d,f.y=e,f.regY=images.screw.height,f.regX=images.screw.width/2,this.screwImg=f,b.addChild(f);var g=new a(images.screwTop);g.reg(.5),g.rotation=360*Math.random(),g.x=f.x,g.y=f.y-100,this.screwTop=g,b.addChild(g),this.updateImg();var h=new a(images.screwTurn);h.x=d,h.y=e,h.regX=images.screwTurn.width/2,h.regY=images.screwTurn.height/2,h.alpha=0,h.alphaCount=0,this.screwTurn=h,c.addChild(h),this.addColliders(d,e)},c.addColliders=function(a,b){var c=75,d={x:a,y:b-c},e={x:a+c,y:b},f={x:a,y:b+c},g={x:a-c,y:b};d.next=e,e.next=f,f.next=g,g.next=d,d.name="top",g.name="left",f.name="bot",e.name="right",this.colliders={},this.colliders.current=null,this.colliders.top=d,this.colliders.right=e,this.colliders.bot=f,this.colliders.left=g},c.mouseOverCollider=function(){var a={x:+app.display.stage.mouseX,y:+app.display.stage.mouseY};a.x+=app._scaleOffset,a.x/=app._scale,a.y/=app._scale;var b=55;return Math.dist(a,this.colliders.top)<b?this.colliders.top:Math.dist(a,this.colliders.right)<b?this.colliders.right:Math.dist(a,this.colliders.bot)<b?this.colliders.bot:Math.dist(a,this.colliders.left)<b?this.colliders.left:void 0},c.updateScrew=function(a,b){if(a){var c=this.mouseOverCollider();c&&c!==this.colliders.current&&(this.colliders.current&&this.colliders.current.next===c&&this.screwIn(),this.colliders.current=c)}this.progress<1?(this.screwTurn.rotation+=.1*b,this.screwTurn.alphaCount+=.005*b,this.screwTurn.alpha=(1+Math.sin(this.screwTurn.alphaCount))/5):this.screwTurn.alpha*=.9},c.screwIn=function(){this.progress<1&&(this.progress+=.07,this.updateImg(),this._audioCount++,++this._audioCount>3&&(this._audioCount=0,app.sound.play("screw",{volume:.5})),this.progress>=1&&app.sound.play("screw-complete",{volume:.5}))},c.updateImg=function(){for(this.screwImg.y=Math.lerp(this.startDepth,this.endDepth,this.progress)+15,this.screwTop.y=this.screwImg.y-130,this.screwTop.rotation+=20;this.screwTop.rotation<0;)this.screwTop.rotation+=360;for(;this.screwTop.rotation>360;)this.screwTop.rotation-=360;this.screwTop.scaleX=this.rotToScale(this.screwTop.rotation),this.screwTop.rotation>315||this.screwTop.rotation<135?this.screwTop.scaleY=-1:this.screwTop.scaleY=1},c.rotToScale=function(a){return a>180&&(a-=180),a=Math.abs(90-a)/90,a=1+.6*a},namespace("srr").Screw=b}(),function(){var a=include("createjs.Bitmap"),b=function(a,b,c,d,e){this._botLayer=a,this._topLayer=b,this._scale=c,this.x=d,this.y=e,this.init()},c=b.prototype;c.init=function(){var b=new a(images.dirt);b.regX=b.regY=images.dirt.width/2,b.scaleX=b.scaleY=this._scale,b.x=this.x,b.y=this.y,this.topImg=b,this._topLayer.addChild(b);var c=new a(images.dirt2);c.regX=c.regY=images.dirt.width/2,c.scaleX=c.scaleY=this._scale,c.x=this.x,c.y=this.y,this.botImg=c,this._botLayer.addChild(c),this.rot=Math.randomFloat(-.5,.5),c.rotation=b.rotation=Math.randomInt(0,360)},c.getScale=function(){return this._scale},c.getAlpha=function(){return this.topImg.alpha},c.onRub=function(){this._scale*=.94,this.topImg.alpha-=.15},c.destroy=function(){this._topLayer.removeChild(this.topImg),this._botLayer.removeChild(this.botImg),this.topImg=null,this.botImg=null,this._scale=null,this.x=null,this.y=null},namespace("srr").Dirt=b}(),function(){var a=include("createjs.Bitmap"),b=function(a){this.dustCont=a,this.dustImg=null,this.velocity={},this.velocity.x=Math.randomFloat(-50,-20),this.velocity.y=Math.randomFloat(-50,-20),this.init()},c=b.prototype;c.init=function(){var b=new a(images.dust);b.regX=b.regY=images.dust.width/2,b.scaleX=b.scaleY=.2,b.rotation=Math.randomInt(0,360),b.x=app.display.stage.mouseX/app._scale+app._scaleOffset,b.y=app.display.stage.mouseY/app._scale,this.dustImg=b,this.dustCont.addChild(b)},c.update=function(a){var b=.001*a;this.dustImg.x+=this.velocity.x*b,this.dustImg.y+=this.velocity.y*b,this.dustImg.alpha-=b,this.dustImg.scaleX=this.dustImg.scaleY+=b},c.destroy=function(){this.dustCont.removeChild(this.dustImg),this.dustImg=null},namespace("srr").Dust=b}(),function(){var a=include("srr.Minigame"),b=include("createjs.Container"),c=include("createjs.Bitmap"),d=include("srr.Screw"),e=function(){a.call(this),app.analytics.startedMinigame("LooseScrews")},f=a.prototype,g=extend(e,a);g.init=function(){f.init.call(this);var a=new c(images.minigameScrewBG1);a.reg(.5,0),a.setPos(650,125),this.gameCont.addChild(a);var d=new b;this.generateDifficulty(),this.screws=[],this.addScrew(421,420,d,this._progress1),this.addScrew(644,420,d,this._progress2),this.addScrew(869,420,d,this._progress3);var e=new c(images.minigameScrewBG2);e.reg(.5,0),e.setPos(650,403),this.gameCont.addChild(e),this.gameCont.addChild(d),this.initVO("minigame-tighten-screws",["6_instrux_screw1"],["6_instrux_screw2"],"6_to_screw")},g.generateDifficulty=function(){this._rand=Math.random(),this._rand<.2?(this._progress1=1,this._progress2=.75*Math.random(),this._progress3=1):this._rand<.6?(this._rand=Math.random(),this._rand<.33?(this._progress1=1,this._progress2=.75*Math.random(),this._progress3=.75*Math.random()):this._rand<.66?(this._progress1=.75*Math.random(),this._progress2=1,this._progress3=.75*Math.random()):(this._progress1=.75*Math.random(),this._progress2=.75*Math.random(),this._progress3=1)):(this._progress1=.75*Math.random(),this._progress2=.75*Math.random(),this._progress3=.75*Math.random())},g.addScrew=function(a,b,c,e){var f=new d(this.gameCont,c,a,b,e);this.screws.push(f)},g.updateMinigame=function(a){for(var b=!0,c=this.screws.length-1;c>=0;c--)this.screws[c].updateScrew(!0,a),this.screws[c].progress<1&&(b=!1);b&&!this.gameComplete&&(this.gameComplete=!0,f.completeMinigame.call(this))},namespace("srr").ScrewMinigame=e}(),function(){function a(a){return 200*a.getScale()}function b(a,b,c){return Math.dist(a,b)<c}var c=include("srr.Minigame"),d=include("createjs.Container"),e=include("createjs.Bitmap"),f=include("srr.Dust"),g=include("srr.Dirt"),h=function(){c.call(this),app.analytics.startedMinigame("WipeSolarPanel"),this._lastDust=Date.now()},i=c.prototype,j=extend(h,c);j.init=function(){i.init.call(this),this.lastPos={x:NaN,y:NaN},this.initBG(),this.botLayer=new d,this.botLayer.alpha=.2,this.topLayer=new d,this.dustLayer=new d,this.gameCont.addChild(this.botLayer),this.gameCont.addChild(this.topLayer),this.gameCont.addChild(this.dustLayer);var a=new e(images.solarpanel);a.x=175,a.y=50,this.gameCont.addChild(a),this.dust=[],this.dirt=[];for(var b={x:340,y:220},c={x:930,y:490},f=20;f>=0;f--)this.addDirt(Math.randomInt(b.x,c.x),Math.randomInt(b.y,c.y),Math.randomFloat(.6,1));this.initVO("minigame-clean-panels",["6_instrux_dust1"],["6_instrux_dust2","6_instrux_dust2_alt"],"6_to_dust")},j.initBG=function(){var a=new d,b=new e(images.minigameBG);b.reg(.5),b.setPos(650,400),a.addChild(b);var c=new e(images.minigameSolar);c.reg(.5),c.setPos(b.x,b.y),a.addChild(c),a.cache(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),this.gameCont.addChild(a)},j.addDirt=function(a,b,c){var d=new g(this.botLayer,this.topLayer,c,a,b);this.dirt.push(d)},j.addDust=function(){var a=new f(this.dustLayer);this.dust.push(a),Date.now()-this._lastDust>700&&(this._lastDust=Date.now(),Math.random()>.5?app.sound.play("clean-screen"):app.sound.play("clean-screen2"))},j.updateMinigame=function(a){if(isNaN(this.lastPos.x))this.lastPos.x=app.display.stage.mouseX,this.lastPos.y=app.display.stage.mouseY;else{var b={x:app.display.stage.mouseX,y:app.display.stage.mouseY};Math.dist(b,this.lastPos)>8&&this.onRub(),this.lastPos=b}this.updateDust(a)},j.updateDust=function(a){for(var b=this.dust.length-1;b>=0;b--)this.dust[b].update(a),this.dust[b].dustImg.alpha<.05&&(this.dust[b].destroy(),this.dust.splice(b,1))},j.onRub=function(){var c={x:app.display.stage.mouseX/app._scale,y:app.display.stage.mouseY/app._scale};c.x+=app._scaleOffset;for(var d=this.dirt.length-1;d>=0;d--){var e=.5*a(this.dirt[d]);b(this.dirt[d],c,e)&&(this.dirt[d].onRub(),this.dirt[d].getAlpha()<.5&&(this.dirt[d].destroy(),this.dirt.splice(d,1),this.dirt.length<1&&this.completeMinigame()),Math.randomFloat(0,1)>.5&&this.addDust())}},namespace("srr").SolarpanelMinigame=h}(),function(){function a(a){for(;-180>a;)a+=360;for(;a>180;)a-=360;return a}var b=include("srr.Minigame"),c=include("createjs.Container"),d=include("createjs.Bitmap"),e=include("springroll.DelayedCall"),f=include("srr.Wire"),g=function(){b.call(this),app.analytics.startedMinigame("ConnectWires")},h=b.prototype,i=extend(g,b);i.init=function(){h.init.call(this),this.gameComplete=!1,this._fadeInComplete=!1,this.initBG(),this.wires=[],this.wireCont=new c,this.gameCont.addChild(this.wireCont),this.initColours();var a=350,b=650,d=950,e=165,f=530,g=Math.random();.33>g?(this.addWire(a,e,d,f,this._colour1),this.addWire(b,e,a,f,this._colour2),this.addWire(d,e,b,f,this._colour3)):.66>g?(this.addWire(a,e,b,f,this._colour1),this.addWire(b,e,d,f,this._colour2),this.addWire(d,e,a,f,this._colour3)):(this.addWire(a,e,d,f,this._colour1),this.addWire(b,e,b,f,this._colour2),this.addWire(d,e,a,f,this._colour3));for(var i=this.wires.length-1;i>=0;i--)this.wires[i].updateWire();this.initVO("minigame-connect-wires",["6_instrux_wire1"],["6_instrux_wire2"],"6_to_wire"),this._dragSound=app.sound.play("cable-drag",{loop:-1,volume:.5})},i.initColours=function(){var b=360*Math.random();this._colour1=a(b),this._colour2=a(b+90),this._colour3=a(b-90)},i.afterFadeIn=function(){h.afterFadeIn.call(this);var a=this;a.wires[Math.randomInt(0,2)].detachWire(),a._fadeInComplete=!0,new e(function(){a.wires[Math.randomInt(0,2)].detachWire()},100),new e(function(){a.wires[Math.randomInt(0,2)].detachWire()},300)},i.initBG=function(){var a=new c,b=new d(images.minigameBG);b.reg(.5),b.setPos(650,400),a.addChild(b);var e=new d(images.minigameWires);e.reg(.5),e.setPos(b.x,b.y),a.addChild(e),a.cache(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),this.gameCont.addChild(a)},i.addWire=function(a,b,c,d,e){var g=new f(this.wireCont,a,b,c,d,e);this.wires.push(g)},i.updateMinigame=function(a){if(this._fadeInComplete){for(var b=!0,c=this.wires.length-1;c>=0;c--)this.wires[c].updateWire(),this.wires[c].completed||(b=!1);b&&!this.gameComplete&&(this.gameComplete=!0,h.completeMinigame.call(this)),this._dragSound.volume=this.wireSelected?1:0}},i.onPointerDown=function(){h.onPointerDown.call(this),this.wireSelected?this.tryReleaseWire():this.trySelectWire()},i.onPointerUp=function(){h.onPointerUp.call(this),Utils.isTouchDevice&&this.tryReleaseWire()},Object.defineProperty(i,"wireSelected",{get:function(){for(var a=this.wires.length-1;a>=0;a--)if(this.wires[a].selected)return!0;return!1}}),i.trySelectWire=function(){for(var a=this.wires.length-1;a>=0;a--)if(this.wires[a].trySelect(app.pointer)){this.wireCont.swapChildren(this.wires[a],this.wireCont.getChildAt(this.wireCont.numChildren-1));break}},i.tryReleaseWire=function(){for(var a=this.wires.length-1;a>=0;a--)this.wires[a].release()},i.completeMinigame=function(){h.completeMinigame.call(this),this._dragSound.stop()},namespace("srr").WireMinigame=g}(),function(){var a=include("createjs.Bitmap"),b=function(a,b){this._img=null,this._cont=a,this._velocity={x:0,y:0},this._screenSize=b,this.init()},c=b.prototype;c.init=function(){this._img=new a(images.particle),this._img.setPos(Math.random()*this._screenSize.width,Math.random()*this._screenSize.height),this._img.scale(Math.random()+.5),this._img.alpha=.2*Math.random()+.1,this._img.mouseEnabled=!1,this._cont.addChild(this._img)},c.setVelocity=function(a,b){this._velocity.x=a,this._velocity.y=b},c.update=function(a){this.move(this._velocity.x*a,this._velocity.y*a)},c.move=function(a,b){this._img.x+=a||0,this._img.y+=b||0,this.capPosition()},c.capPosition=function(){this._img.x<-50?this._img.x+=this._screenSize.width+100:this._img.x>this._screenSize.width+50&&(this._img.x-=this._screenSize.width+100),this._img.y<-50?this._img.y+=this._screenSize.height+100:this._img.y>this._screenSize.height+50&&(this._img.y-=this._screenSize.height+100)},namespace("srr.levelSelection").Particle=b}(),function(){var a=include("createjs.Container"),b=include("srr.levelSelection.Particle"),c=function(){a.call(this),this._particles=[],this.init()},d=(a.prototype,extend(c,a));d.init=function(){this.bgRotation=30,this.addParticles(20),this.update()},d.addParticles=function(a){for(var c={width:app.config.scaling.app.maxWidth,height:app.config.scaling.app.height},d=null,e=0;a>e;e++)this._particles.push(new b(this,c)),d={x:.2*(Math.random()-.5),y:.2*(Math.random()-.5)},this._particles[this._particles.length-1].setVelocity(d.x,d.y)},d.update=function(a){this.bgRotation*=.92;for(var b=this._particles.length-1;b>=0;b--)this._particles[b].update(a),this._particles[b].move(this.bgRotation)},d.goLeft=function(){this.bgRotation=20},d.goRight=function(){this.bgRotation=-20},namespace("srr.levelSelection").CarouselForeground=c}(),function(){var a=include("createjs.Container"),b=include("srr.levelSelection.CarouselForeground"),c=include("srr.panels.PlanetInfo"),d=function(){a.call(this),this.infoBar_moon=new c("moon",this),this.infoBar_mars=new c("mars",this),this.infoBar_venus=new c("venus",this),this.carouselForground=new b,this.addChild(this.carouselForground)},e=(a.prototype,extend(d,a));e.update=function(a){this.carouselForground.update(a)},e.goLeft=function(){this.carouselForground.goLeft()},e.goRight=function(){this.carouselForground.goRight()},e.updateInfoBar=function(){this.infoBar_moon.enabled="moon"===app.frontPlanet,this.infoBar_mars.enabled="mars"===app.frontPlanet,this.infoBar_venus.enabled="venus"===app.frontPlanet},e.teardown=function(){this.infoBar_moon.teardown(),this.infoBar_mars.teardown(),this.infoBar_venus.teardown()},namespace("srr.levelSelection").MenuForeground=d}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(){a.call(this),this.init()},d=(a.prototype,extend(c,a));d.init=function(){var a=new b(images.moon_cover);a.mouseEnabled=!1,a.reg(.5),a.scale(1.1,1.093),this.addChild(a),this.darkCircle=new b(images.darkCircle),this.darkCircle.mouseEnabled=!1,this.darkCircle.alpha=.3,this.darkCircle.reg(.5),this.darkCircle.scale(3.95),this.addChild(this.darkCircle)},Object.defineProperty(d,"coverAlpha",{get:function(){return this.darkCircle.alpha},set:function(a){this.darkCircle.alpha=a}}),d.hide=function(){this.darkCircle.visible=!1},d.show=function(){this.darkCircle.visible=!0},namespace("srr.levelSelection").PlanetCover=c}(),function(){var a=include("createjs.Container"),b=function(b){a.call(this),this.inFront=!1,this.snapToPixel=!0,this.maskRadius=190,this.x=0,this.init(b)},c=(a.prototype,extend(b,a));c.init=function(a){a.x=-this.maskRadius,this.background=a,this.addChild(a),this.mask=this.makeMask(),this.scroll(-a.seanPos.x+190),this.playPlanetFact=this.playPlanetFact.bind(this),this.background.bg.addEventListener("mousedown",this.playPlanetFact)},c.playPlanetFact=function(){this.inFront&&app.signals.clickOnPlanet.dispatch(this.globalToLocal(app.display.stage.mouseX,app.display.stage.mouseY))},c.makeMask=function(){var a=new createjs.Shape;return a.graphics.beginFill("red").drawCircle(0,0,this.maskRadius),a._off=!0,a},c.scroll=function(a){for(this.x+=a;this.x>0;)this.x-=944;for(;this.x<-944;)this.x+=944},c.teardown=function(){this.background.bg.removeEventListener("mousedown",this.playPlanetFact)},Object.defineProperty(c,"offset",{get:function(){return this.x}}),namespace("srr.levelSelection").MaskedScrollCont=b}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=include("springroll.easeljs.Button"),d=include("createjs.Tween"),e=include("createjs.Ease"),f=include("springroll.DelayedCall"),g=function(b){a.call(this),this.starPos=app.config.starPosition[b],this.planetName=b,this.lvl=Math.max(0,app.progress[b]),this.lastLvl=Math.max(0,this.lvl-1),this.init(b)},h=(a.prototype,extend(g,a));h.init=function(){var b=944,c=new a;this.addBG(c,.55),c.reg(0,.5),c.cache(0,0,this.bgWidth,this.bgHeight),this.bg=c,this.addChild(c),this.initSean(b)},h.addBG=function(a,c){var d=new b(images[this.planetName]);d.scale(c),a.addChild(d),d=new b(images[this.planetName]),d.scale(c),d.sourceRect=new createjs.Rectangle(0,0,800,d.image.height),d.x=940,a.addChild(d),this.bgWidth=1744,this.bgHeight=d.image.height+800},h.initSean=function(b){this.seanPos={x:.55*this.starPos[this.lvl].x,y:.55*(this.starPos[this.lvl].y-360)},this.seanStartingPos={x:.55*this.starPos[this.lastLvl].x,y:.55*(this.starPos[this.lastLvl].y-360)},this.seanButtons=new a,this._sean1=new c(images.planetSean),this._sean1.reg(.5),this.seanButtons.addChild(this._sean1),this.addChild(this.seanButtons),this._sean2=new c(images.planetSean),this._sean2.reg(.5),this._sean2.x=944,this.seanButtons.addChild(this._sean2),this.seanButtons.setPos(this.seanStartingPos),this.addChild(this.seanButtons),this.onSeanPress=this.onSeanPress.bind(this),this.seanButtons.on("click",this.onSeanPress)},h.cancelTweens=function(){d.removeTweens(this._sean1),d.removeTweens(this._sean2),d.removeTweens(this.seanButtons)},h.popSeanBtn=function(){try{var a=this;this.cancelTweens(),this._sean1.scale(.5),this._sean2.scale(.5),d.get(this.seanButtons).wait(500).to({x:a.seanPos.x,y:a.seanPos.y},900,e.sineInOut),d.get(this._sean1).wait(1400).to({scaleX:1,scaleY:1},300,e.bounceOut),d.get(this._sean2).wait(1400).to({scaleX:1,scaleY:1},300,e.bounceOut)}catch(b){}},h.jiggleSeanBtn=function(){try{var a=this.seanButtons,b=this.seanButtons.x,c=0;new f(function(){a.x=b+10},c+=65),new f(function(){a.x=b-8},c+=60),new f(function(){a.x=b+6},c+=60),new f(function(){a.x=b-4},c+=55),new f(function(){a.x=b+2},c+=50),new f(function(){a.x=b},c+=50)}catch(d){}},h.onSeanPress=function(){app.signals.onGotoLevel.dispatch(this.planetName),this.seanButtons.off("click",this.onSeanPress)},namespace("srr.levelSelection").PlanetBackground=g}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(){a.call(this),this.init()},d=(a.prototype,extend(c,a));d.init=function(){this._imgWidth=app.config.scaling.app.maxWidth,this.addBGTiles(),this.goLeft(),this.update()},d.update=function(){this._stopped||(this.bgRotation*=.95,this.moveBGImage(this.bgRotation),this.moveBGImage(this.bgRotation),this.bgScale*=.92,this.scaleY=1+this.bgScale,this.bgRotation>.05&&this.bgRotation<-.05&&(this._stopped=!0))},d.addBGTiles=function(){var a=new b(images.menuBackground);this.addChild(a),a=new b(images.menuBackground),a.x=a.image.width,this.addChild(a),this.cache(0,0,2*a.image.width,a.image.height)},d.goLeft=function(){this.bgRotation=-30,this.bgScale=.15,this._stopped=!1},d.goRight=function(){this.bgRotation=30,this.bgScale=.15,this._stopped=!1},d.moveBGImage=function(a){for(this.x+=a;this.x<-this._imgWidth;)this.x+=this._imgWidth;for(;this.x>0;)this.x-=this._imgWidth},namespace("srr.levelSelection").CarouselBackground=c}(),function(){var a=include("createjs.Container"),b=include("srr.levelSelection.PlanetBackground"),c=include("srr.levelSelection.MaskedScrollCont"),d=include("srr.levelSelection.PlanetCover"),e=0,f=1.63,g=new Math.Elypse(525,270,520,20),h=function(b,c){a.call(this),this.planetName=b,this.rotationOffset=c,this.snapToPixel=!0,this.init()},i=(a.prototype,extend(h,a));i.init=function(){var a=this;this.onPointerDown=this.onPointerDown.bind(this),this.onMouseOver=this.onMouseOver.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.on("mousedown",a.onPointerDown),this.on("mouseover",a.onMouseOver),this.on("mouseout",a.onMouseOut),this._inFront=!1,this.initPlanet()},i.initPlanet=function(){this.background=new b(this.planetName),this.scrollCont=new c(this.background),this.addChild(this.scrollCont),this.cover=new d,this.addChild(this.cover)},i.onPointerDown=function(){this.inFront||(app.signals["onPress_"+this.planetName].dispatch(),this.cover.hide())},i.onMouseOver=function(){this.inFront||this.cover.hide()},i.onMouseOut=function(){this.inFront||this.cover.show()},Object.defineProperty(i,"inFront",{get:function(){return this._inFront},set:function(a){this._inFront=a,this.scrollCont.inFront=this._inFront,this._inFront?this._moveToFront():this._moveToBack()}}),i._moveToFront=function(){app.currentPlanet=this.planetName,this.background.popSeanBtn(),this.background.seanButtons.visible=!0,this.playPlanetVO()},i._moveToBack=function(){this.cover.show(),
this.background.seanButtons.visible=!1,this.background.cancelTweens()},i.playPlanetVO=function(){app._introPlayed&&(app[this.planetName+"_introPlayed"]?app.voPlayer.play("3_"+this.planetName):(app[this.planetName+"_introPlayed"]=!0,app.voPlayer.play("3_intro_"+this.planetName)))},i.drag=function(a){var b=.55*-a;this.scrollCont.scroll(b)},i.updatePlanet=function(a){this.cover.coverAlpha=this.inFront?0:.35,this.updatePosition(a)},i.updatePosition=function(a){var b=a+this.rotationOffset,c=Math.cordsOnElypse(g,Math.circClamp(b));this.x=c.x,this.y=c.y;var d=Math.angleDiff(b,Math.PI/2),h=d/Math.PI;h=Math.abs(h),h=1-h;var i=Math.lerp(e,f,h);i=Math.max(i,.2),this.scaleX=this.scaleY=i,this.currentRot=b},i.teardown=function(){var a=this;this.off("mousedown",a.onPointerDown),this.scrollCont.teardown()},namespace("srr.levelSelection").PlanetMenu=h}(),function(){var a=include("createjs.Container"),b=include("srr.levelSelection.PlanetMenu"),c=include("srr.Planet"),d=function(){a.call(this),this.init()},e=(a.prototype,extend(d,a));e.init=function(){this.currentRot=0,this._turnProgress=0,this.desiredRot=Math.PI/2,this.planetPos={front:null,center:null,back:null},this.planetCont=new a,this.planetCont.x=110,this.addChild(this.planetCont),this.initPlanets()},e.initPlanets=function(){this.mars=new b(c.MARS,0),this.planetCont.addChild(this.mars),this.venus=new b(c.VENUS,4*Math.PI/3),this.planetCont.addChild(this.venus),this.moon=new b(c.MOON,2*Math.PI/3),this.planetCont.addChild(this.moon);var a=1.572;this.mars.desiredRot=a,this.venus.desiredRot=a+2*Math.PI/3,this.moon.desiredRot=a+4*Math.PI/3,app.frontPlanet?this.turnTo(app.frontPlanet):this.turnTo("moon")},e.update=function(a){this.currentRot!=this.desiredRot&&(this._turnProgress=Math.min(1,this._turnProgress+a/1e3),this.currentRot=Math.circClamp(Math.lerpAngel(this.currentRot,this.desiredRot,this._turnProgress)),this.positionPlanets())},e.turnTo=function(a){app.frontPlanet=a,this.mars.inFront="mars"===a,this.venus.inFront="venus"===a,this.moon.inFront="moon"===a,this._turnProgress=0,this.desiredRot=this[a].desiredRot,app.sound.play("planet-spin"),setTimeout(function(){app.sound.play("planet-select")},500),app.analytics.planetSelected(a)},e.goLeft=function(){this.mars.inFront?this.turnTo("venus"):this.venus.inFront?this.turnTo("moon"):this.moon.inFront&&this.turnTo("mars")},e.goRight=function(){this.mars.inFront?this.turnTo("moon"):this.moon.inFront?this.turnTo("venus"):this.venus.inFront&&this.turnTo("mars")},e.positionPlanets=function(){this.mars.updatePlanet(this.currentRot),this.venus.updatePlanet(this.currentRot),this.moon.updatePlanet(this.currentRot),this.orderPlanets()},e.orderPlanets=function(){var a=Math.abs(Math.angleDiff(this.mars.currentRot,Math.PI/2)),b=Math.abs(Math.angleDiff(this.venus.currentRot,Math.PI/2)),c=Math.abs(Math.angleDiff(this.moon.currentRot,Math.PI/2));b>a&&c>a?c>b?this.orderPlanetDepth(this.mars,this.venus,this.moon):this.orderPlanetDepth(this.mars,this.moon,this.venus):a>b&&c>b?c>a?this.orderPlanetDepth(this.venus,this.mars,this.moon):this.orderPlanetDepth(this.venus,this.moon,this.mars):b>a?this.orderPlanetDepth(this.moon,this.mars,this.venus):this.orderPlanetDepth(this.moon,this.venus,this.mars)},e.planetId=function(a){for(var b=this.planetCont.children.length-1;b>=0;b--)if(this.planetCont.children[b].planetName===a.planetName)return b},e.orderPlanetDepth=function(a,b,c){var d=this.planetPos;d.front!=a&&(this.movePlanetToPos(a,2),d.front=a),d.center!=b&&(this.movePlanetToPos(b,1),d.center=b),d.back=c},e.movePlanetToPos=function(a,b){var c=this.planetId(a),d=this.planetCont.children[c];this.planetCont.children[c]=this.planetCont.children[b],this.planetCont.children[b]=d},e.teardown=function(){this.currentRot=this.desiredRot,this.mars.teardown(),this.moon.teardown(),this.venus.teardown()},namespace("srr.levelSelection").PlanetCarousel=d}(),function(){var a=include("createjs.Container"),b=include("srr.levelSelection.Particle"),c=function(){a.call(this),this._particles=[],this.init()},d=(a.prototype,extend(c,a));d.init=function(){this.addParticles(20),this.update()},d.addParticles=function(a){for(var c={width:app.config.scaling.app.maxWidth,height:app.config.scaling.app.height},d=0;a>d;d++)this._particles.push(new b(this,c)),vel={x:-(1*Math.random()+2),y:.2*Math.random()+.1},this._particles[this._particles.length-1].setVelocity(vel.x,vel.y)},d.update=function(a){for(var b=this._particles.length-1;b>=0;b--)this._particles[b].update(a)},namespace("srr.levelSelection").PlanetParticles=c}(),function(){var a=include("springroll.easeljs.BasePanel"),b=function(){a.call(this),this.appSize=app.config.scaling.app,e=app._safeZone=110,this.onResize=this.onResize.bind(this)},c=a.prototype,d=extend(b,a);window.app=window.app={};var e;d.setup=function(){var a=this;window.addEventListener("resize",a.onResize,!1),this.onResize()},d.onResize=function(){window.scrollTo(0,1);var a=window.innerWidth,b=window.innerHeight;this.scaleDynamic(a,b),this.scaleX=this.scaleY=app._scale,this.x=-app._scaleOffset},d.scaleDynamic=function(a,b){var c,d,f,g,h=this.appSize;if(a/b<h.width/h.height)c=a/h.width,f=Math.floor(h.width*c),g=Math.floor(h.height*c),d=e*c,app.display.resize(f,g);else{c=b/h.height;var i=a/c-h.width;i>2*e&&(i=2*e),i*=c,f=Math.floor(h.width*c+i),g=Math.floor(h.height*c),d=e*c-i/2,app.display.resize(f,g)}app._scale=c,app._scaleOffset=d,app.transition&&(app.transition.x=-d,app.transition.scaleX=app.transition.scaleY=app._scale)},d.teardown=function(){var a=this;window.removeEventListener("resize",a.onResize,!1),c.teardown.call(this)},namespace("srr").ScalePanel=b}(),function(){var a=include("createjs.Container"),b=include("srr.tileSystem.TileManager"),c=include("srr.vehicle.VehicleCont"),d=include("srr.ui.GameUI"),e=include("srr.ScalePanel"),f=include("srr.SolarpanelMinigame"),g=include("srr.ScrewMinigame"),h=include("srr.WireMinigame"),i=include("srr.tileSystem.ParallaxBg"),j=include("srr.tileSystem.ObstacleCont"),k=include("srr.misc.VehicleAnimation"),l=include("srr.ui.PopupWinPlanet"),m=include("srr.ui.PopupWinLevel"),n=include("srr.ui.PopupFailure"),o=include("srr.misc.Rumbler"),p=include("srr.misc.Sunset"),q=include("srr.levelSelection.PlanetParticles"),r=include("srr.PlanetBackground"),s=function(a){e.call(this),this.rumbler=new o(this),this.minigame=null,this.background=null,this.btn=null},t=e.prototype,u=extend(s,e);u.setup=function(){t.setup.call(this);var e=new a;this.background=new r(e),this.parallaxBg=new i,e.addChild(this.parallaxBg),this.tileManager=new b,e.addChild(this.tileManager),this.vehicleCont=new c,e.addChild(this.vehicleCont),this.vehicleAnim=new k(this.vehicleCont),this.obstacleCont=new j,e.addChild(this.obstacleCont),this.sunset=new p,e.addChild(this.sunset),this.foreground=new q,e.addChild(this.foreground),this.gameCont=e,this.addChild(this.gameCont),this.minigameCont=new a,this.addChild(this.minigameCont),this.gameUI=new d,this.addChild(this.gameUI),this.parallaxBg.init(),this.tileManager.init(this.obstacleCont)},u.update=function(a,b,c,d){this.foreground.update(b),this.parallaxBg.update(b),this.tileManager.update(b),this.gameUI.update(c,d)},u.hitObstacle=function(a){this.minigame&&(this.minigame.destroy(),this.minigame=null),"rock"===a?(this.minigame=new h,app.sound.play("hit-rock")):"pothole"===a?(this.minigame=new g,app.sound.play("hit-pothole")):(this.minigame=new f,app.sound.play("hit-dustdevil")),this.gameCont.cache(0,0,1280,720),this.minigameCont.addChild(this.minigame)},u.destroyMinigame=function(){this.gameCont.uncache(),this.minigame&&(this.minigame.destroy(),this.minigame=null)},u.failLevel=function(){this._addPopup(new n),this.sunset.onOutOfTime()},u.completeLevel=function(){this._addPopup(new m)},u.completePlanet=function(){this._addPopup(new l)},u._addPopup=function(a){this.popup=a,this.popup.init(),this.addChild(this.popup),this._endGame()},u._endGame=function(a){this.gameCont.cache(0,0,1280,720),this.destroyMinigame()},u.exitStart=function(){this.sunset.teardown(),this.gameUI.teardown(),this.destroyMinigame(),this.vehicleCont.exitStart(),this.popup&&this.popup.teardown(),this.debugGamePanel&&this.debugGamePanel.teardown()},namespace("srr.panels").GamePanel=s}(),function(){var a=include("srr.ScalePanel"),b=include("createjs.Bitmap"),c=include("springroll.easeljs.Button"),d=include("createjs.Container"),e=include("createjs.Tween"),f=include("createjs.Ease"),g=function(){a.call(this),this.skipCallback=null},h=a.prototype,i=extend(g,a);i.setup=function(){h.setup.call(this);var a=new d;a.addChild(new b(images.splash));var e=new c(images.playBtn);e.setPos(700,450),a.addChild(e),this.progressBar=new b(images.progressBar),this.progressBar.setPos(1650,431),a.addChild(this.progressBar),this._fading=!1,this._fadeCount=0,this._loadProgress=0,this._loadSpeed=.01,this._loadedCallback=null,this.addChild(a),this.cont=a,this.skipBtn=new c(images.skipBtn),this.skipBtn.setPos(950,550),this.skipBtn.visible=!1,this.addChild(this.skipBtn),this.onSkip=this.onSkip.bind(this),this.skipBtn.addEventListener("click",this.onSkip),this.onResize()},i.update=function(a){this._fading&&(this._fadeCount+=a/1e3,this.cont.x=Math.smoothStep(0,-1280,this._fadeCount),this._fadeCount>=1&&(this._fadeCount=1,this._fading=!1,this.updateLoadingBar()))},i.updateLoadingBar=function(){if(this._loadProgress<1){var a=this;this._loadProgress+=Math.random()*this._loadSpeed,this._loadProgress=Math.min(this._loadProgress,1),this.progressBar.scaleX=25.5*this._loadProgress,this._loadProgress>=1&&setTimeout(function(){a._loadedCallback()},300),setTimeout(function(){a.updateLoadingBar()},300+500*Math.random())}},i.onSkip=function(){this.skipBtn.removeEventListener("click",this.onSkip),this.skipCallback&&this.skipCallback()},i.fadeToLoading=function(a){this._fading=!0,this._fadeCount=0,this._loadedCallback=a},i.hide=function(){this.cont.visible=!1,this.skipBtn.alpha=0,this.skipBtn.visible=!0,e.get(this.skipBtn).wait(1e3).to({alpha:1},1e3,f.cubicOut)},i.onVideoReady=function(){this._loadSpeed=.5},i.onVideoEnded=function(){this.skipBtn.removeEventListener("click",this.onSkip)},Object.defineProperty(i,"fadeComplete",{get:function(){return this._fadeCount>=1}}),Object.defineProperty(i,"readyForIntro",{get:function(){return this.fadeComplete&&this._loadProgress>=1}}),i.teardown=function(){e.removeTweens(this.skipBtn)},namespace("srr.panels").LoadingPanel=g}(),function(){var a=include("srr.levelSelection.CarouselBackground"),b=include("srr.levelSelection.MenuForeground"),c=include("srr.levelSelection.PlanetCarousel"),d=include("srr.ScalePanel"),e=function(a){d.call(this)},f=d.prototype,g=extend(e,d);g.setup=function(){f.setup.call(this),this.background=new a,this.addChild(this.background),this.carousel=new c,this.addChild(this.carousel),this.foreground=new b,this.addChild(this.foreground)},g.update=function(a){this.background.update(a),this.foreground.update(a),this.carousel.update(a)},g.goLeft=function(){this.background.goLeft(),this.foreground.goLeft(),this.carousel.goLeft()},g.goRight=function(){this.background.goRight(),this.foreground.goRight(),this.carousel.goRight()},g.teardown=function(){try{this.carousel.teardown(),this.foreground.teardown()}catch(a){}f.teardown.call(this)},namespace("srr.panels").MenuPanel=e}(),function(){var a=include("springroll.easeljs.BaseState"),b=include("srr.panels.GamePanel"),c=include("srr.vehicle.VehicleMovement"),d=include("srr.misc.GameSpeed"),e=include("srr.misc.GameTime"),f=include("srr.misc.Powerups"),g=include("srr.TO.TimeoutNotification"),h=include("srr.audio.DrivingInfo"),i=function(c){a.call(this,new b,c),this.endReached=!1,this._levelTime=NaN,this._remainingTime=NaN},j=(a.prototype,extend(i,a));j.enterDone=function(){this.vehicleMovement=new c(this.panel.tileManager),this.speed=new d,this.time=new e,this.initSignals(),this.initVariables(),this.initPowerups(),this.update=this.update.bind(this),app.on("update",this.update);var a=this.onTimeout.bind(this);this.timeout=new g(12e3,a),this.drivingTO=Utils.isTouchDevice?"6_steer_drag":"6_steer_mouse",this.drivingInfo=new h,this.initAudio()},j.initVariables=function(){this.vehicleMovement.init(this.panel.vehicleCont,this.panel.tileManager),this.time.init(),this.speed.init(this.vehicleMovement,this.panel.tileManager),this._bumpyTimer=0,this.gameOver=!1,this.endReached=!1},j.initAudio=function(){this.engineVolume=1,this.engineSound=app.sound.play("rover-engine",{loop:-1,volume:0}),this.engineSoundBumpy=app.sound.play("rover-slowdown",{loop:-1,volume:0}),this.gameMusic=app.sound.play("game-music",{loop:-1,volume:.2}),app.sound.preload(["6_instrux_wire1","6_instrux_screw1","6_instrux_dust1"])},j.initPowerups=function(){this.powerups=new f,this.powerups.init()},j.update=function(a){if(!this.gameOver){this.time.update(a,this.panel,this.endReached),this.speed.update(a,this.panel,this.gameOver,this.endReached,this.powerups.speedBoost);var b=a*this.speed.gameSpeed;this.panel.minigame?(a=0,this.panel.update(a,b,this.time,this.gameProgress)):(this.panel.update(a,b,this.time,this.gameProgress),this.vehicleMovement.update(b,a),this.updateVOTips(a)),this.updateEngineSound()}},j.updateEngineSound=function(){this.vehicleMovement.blocked&&!this.powerups.speedBoost?this.engineVolume=Math.Clamp01(this.engineVolume-.02):this.engineVolume=Math.Clamp01(this.engineVolume+.02);var a=this.panel.minigame?.2:.4;this.engineSound.volume=this.engineVolume*a*.5,this.engineSoundBumpy.volume=(1-this.engineVolume)*a},j.updateVOTips=function(a){this.vehicleMovement.blocked&&(app._craterTipPlayed||app.voPlayer.playing||(app._craterTipPlayed=!0,app.voPlayer.play("6_bumpy")),this._bumpyTimer+=a,this._bumpyTimer>2e3&&!app.voPlayer.playing&&app.voPlayer.play("bumpy"+Math.randomInt(1,8))),this.drivingInfo.tryPlay(this.gameProgress)},j.initSignals=function(){this.removeSignals(),this.addInputSignals(),this.addGameSignals()},j.addInputSignals=function(){var a=this;app.signals.onGotoMenu=new Signal,app.signals.onGotoMenu.add(function(){a.previousState()}),app.signals.onPlayNextLvl=new Signal,app.signals.onPlayNextLvl.add(function(){a.nextState()}),app.signals.onReplay=new Signal,app.signals.onReplay.add(function(){a.nextState()})},j.addGameSignals=function(){var a=this,b=this.panel;app.signals.levelEndReached=new Signal,app.signals.minigameComplete=new Signal,app.signals.tileLeavesScreen=new Signal,app.signals.hitObstacle=new Signal,app.signals.pickupPowerup=new Signal,app.signals.speedBoostEnd=new Signal,app.signals.outOfTime=new Signal,app.signals.arrivedAtGoal=new Signal,app.signals.flashTimer=new Signal,app.signals.hitObstacle.add(this.hitObstacle.bind(this)),app.signals.pickupPowerup.add(this.pickupPowerup.bind(this)),app.signals.outOfTime.add(this.onOutOfTime.bind(this)),app.signals.arrivedAtGoal.add(this.onArriveAtGoal.bind(this)),app.signals.levelEndReached.add(function(){a.onEndReached()}),app.signals.minigameComplete.add(function(){a.vehicleMovement.blocked=!1,b.destroyMinigame()}),app.signals.tileLeavesScreen.add(function(a){b.tileManager.tileLeavesScreen(a)}),app.signals.speedBoostEnd.add(function(){b.vehicleCont.speedBoostEnd()}),app.signals.flashTimer.add(function(){b.gameUI.timer.flashOnce()})},j.hitObstacle=function(a){this.powerups.bubble||this.powerups.speedBoost?(this.powerups.bubble=!1,this.panel.vehicleCont.removeBubble(),app.sound.play("bubble-pop",{volume:.5})):this.panel.hitObstacle(a)},j.pickupPowerup=function(a){"immunityBubble"===a?(this.powerups.bubble=!0,this.panel.vehicleCont.addBubble(),app.sound.play("bubble-pickup",{volume:.5}),app._bubbleTipPlayed||app.voPlayer.playing||(app._bubbleTipPlayed=!0,app.voPlayer.play("6_bubble"))):"speedBoost"===a?(this.powerups.speedBoost=!0,this.speed.pickupBoost(),this.panel.vehicleCont.pickupSpeed(),app.sound.play("pickupSpeed"),app._boostTipPlayed||app.voPlayer.playing||(app._boostTipPlayed=!0,app.voPlayer.play("6_speed"))):"extraTime"===a&&(app.sound.play("pickupTime"),this.panel.gameUI.timer.flash(),this.time.pickupExtraTime(),app._timeTipPlayed||app.voPlayer.playing||(app._timeTipPlayed=!0,app.voPlayer.play("6_extratime")))},Object.defineProperty(j,"gameProgress",{get:function(){return this.vehicleMovement.distTraveled/(this.panel.tileManager.trackLength-500)}}),j.onEndReached=function(){this.vehicleMovement.onEndReached(),this.endReached=!0},j.onArriveAtGoal=function(){this.endGame(!0)},j.onOutOfTime=function(){this.endGame(!1)},j.endGame=function(a){this.gameOver||(this.gameOver=!0,this.panel.gameUI.onEndGame(),this.engineSound.stop(),this.engineSoundBumpy.stop(),this.gameMusic.stop(),a?app.progress.isFinalLevel?this.panel.completePlanet():(app.progress.goForward(),this.panel.completeLevel()):this.panel.failLevel())},j.onTimeout=function(){this.gameOver||this.panel.minigame||app.voPlayer.playing||app.voPlayer.play(this.drivingTO)},j.exitStart=function(){app.sound.unloadAll(),app.off("update",this.update),this.removeSignals(),this.timeout.teardown(),this.vehicleMovement.teardown(),this.powerups.teardown(),app.endPanel&&app.endPanel.teardown(),this.panel.exitStart(),this.gameMusic.stop(),this.engineSound.stop(),this.engineSoundBumpy.stop()},j.removeSignals=function(){for(var a in app.signals)app.signals.hasOwnProperty(a)&&delete app.signals[a];app.signals={}},namespace("srr.states").GameState=i}(),function(){var a=include("springroll.easeljs.BaseState"),b=include("srr.panels.LoadingPanel"),c=include("videoPlayer.NativePlayer"),d=include("videoPlayer.OvgPlayer"),e=include("srr.TO.Timeout"),f=function(c){a.call(this,new b,c),this.intro=null,this.onPause=this.onPause.bind(this),this.onResume=this.onResume.bind(this),this.update=this.update.bind(this),this.onPanelPress=this.onPanelPress.bind(this)},g=a.prototype,h=extend(f,a);h.enterDone=function(){this.panel.skipCallback=this.onSkip.bind(this),this.panel.addEventListener("click",this.onPanelPress),app.on("resumed",this.onResume,!1),app.on("paused",this.onPause,!1),app.on("update",this.update,!1),app.captions.selfUpdate=!0,this.to=new e(1e4,["1_splash_click"]),this.addVideoPlayer()},h.addVideoPlayer=function(){this.videoLoadedCallback=this.onVideoLoaded.bind(this),this.videoEndedCallback=this.onVideoEnded.bind(this),/iPhone|iPod/.test(navigator.platform)?this.intro=new d(this.videoLoadedCallback,this.videoEndedCallback):this.intro=new c(this.videoLoadedCallback,this.videoEndedCallback)},h.update=function(a){this.panel.update(a)},h.onPanelPress=function(){app.voPlayer.play("1_splash_title"),this.panel.removeEventListener("click",this.onPanelPress),this.panel.fadeToLoading(this.onLoadedCallback.bind(this)),this.to.teardown(),this.intro.startLoading()},h.onLoadedCallback=function(){this.tryPlayVideo()},h.onVideoLoaded=function(){this.panel.onVideoReady(),this.tryPlayVideo()},h.onResume=function(){this.tryPlayVideo()},h.onPause=function(){this.intro.pause()},h.onVideoEnded=function(){this.leaveState(),this.panel.onVideoEnded()},h.onSkip=function(){this.leaveState()},h.leaveState=function(){this.intro.removeVideo(),this.nextState()},h.tryPlayVideo=function(){this.panel.readyForIntro&&this.intro.loaded&&(this.panel.hide(),this.intro.tryPlay(),app.analytics.leaveLoadingScreen())},h.exitStart=function(){this.to.teardown(),app.off("resumed",this.onResume,!1),app.off("paused",this.onPause,!1),app.captions.selfUpdate=!1,g.exitStart.call(this)},namespace("srr.states").LoadingState=f}(),function(){var a=include("springroll.easeljs.BaseState"),b=include("srr.panels.MenuPanel"),c=include("srr.input.DragInput"),d=include("srr.input.ClickOnNothing"),e=include("srr.misc.levelLoader"),f=include("srr.TO.TimeoutNotification"),g=include("srr.audio.PlanetFactPlayer"),h=include("srr.audio.LoopedVOPlayer"),i=function(c){a.call(this,new b,c),k.panel=this.panel},j=a.prototype,k=extend(i,a);k.enterDone=function(){this.initSignals(),this.dragInput=new c(k.panel);var a=this.onTimeout.bind(this);this._genericTimeOut=!1,this.timeout=new f(1e4,a,-1e4),this.planetFacts=new g,this.clickOnNothing=new d(this.planetFacts),this.panel.foreground.updateInfoBar(),app._introPlayed||(app._introPlayed=!0,app.voPlayer.play("3_intro",function(){app.voPlayer.play("3_intro_moon")})),this.marsTOs=new h(["4_to_mars1","4_to_mars2","4_to_mars3"]),this.venusTOs=new h(["4_to_venus1","4_to_venus2","4_to_venus3","4_to_venus4"]),this.moonTOs=new h(["4_to_moon1","4_to_moon2","4_to_moon3","4_to_moon4"]),this.menuMusic=app.sound.play("select-music",{loop:-1,volume:.5}),this.swoosh=app.sound.play("swoosh",{loop:-1,volume:0}),this.update=k.update.bind(this),app.on("update",this.update)},k.update=function(a){this.panel.update(a)},k.initSignals=function(){this.removeSignals(),this.addNavigation(),this.addLevelSelection()},k.addNavigation=function(){app.signals.onPress_mars=new Signal,app.signals.onPress_venus=new Signal,app.signals.onPress_moon=new Signal,app.signals.drag=new Signal,app.signals.clickOnPlanet=new Signal,app.signals.roverSelect=new Signal;var a=this,b=k.panel;app.signals.onPress_mars.add(function(){b.carousel.moon.inFront?b.goLeft():b.goRight(),b.foreground.updateInfoBar()}),app.signals.onPress_venus.add(function(){b.carousel.mars.inFront?b.goLeft():b.goRight(),b.foreground.updateInfoBar()}),app.signals.onPress_moon.add(function(){b.carousel.venus.inFront?b.goLeft():b.goRight(),b.foreground.updateInfoBar()}),app.signals.drag.add(function(b){a.onDrag(b)}),app.signals.clickOnPlanet.add(function(b){app.frontPlanet&&a.planetFacts.tryPlay(app.frontPlanet,b)})},k.onDrag=function(a){app.frontPlanet&&this.panel.carousel[app.frontPlanet].drag(a),a=Math.abs(a),a*=2.5,a=a>50?50:a,this.swoosh.volume=a/100},k.addLevelSelection=function(){app.signals.onGotoLevel=new Signal;var a=this;app.signals.onGotoLevel.add(function(b,c){a.dragInput.dragDistance<40&&a.goToGame(b)})},k.goToGame=function(a){var b=app.config.assets,c=e.generateManifest(a);app.states.game.preload=b.game.concat(c),app.currentPlanet=a,this.nextState(),app.vo._startCounter=app.vo._startCounter||1,app.voPlayer.play("4_start"+app.vo._startCounter),app.sound.play("uiPos"),app.vo._startCounter++,app.vo._startCounter>3&&(app.vo._startCounter=1),app.analytics.levelStarted(a+app.progress.current)},k.onTimeout=function(){app.voPlayer.playing||(this._genericTimeOut=!this._genericTimeOut,this._genericTimeOut?this.playGenericTO():this.playPlanetTO()),this.getFrontPlanet().background.jiggleSeanBtn()},k.playGenericTO=function(){app.vo._genericMenuTO=app.vo._genericMenuTO||0,0===app.vo._genericMenuTO?app.voPlayer.play("3_planet_select"):app.voPlayer.play("3_to_where"),app.vo._genericMenuTO++,app.vo._genericMenuTO>1&&(app.vo._genericMenuTO=0)},k.playPlanetTO=function(){this.timeout.setDelay(5e3),this.panel.carousel.mars.inFront?this.marsTOs.play():this.panel.carousel.moon.inFront&&this.moonTOs.play(),this.panel.carousel.venus.inFront&&this.venusTOs.play()},k.getFrontPlanet=function(){return this.panel.carousel.mars.inFront?this.panel.carousel.mars:this.panel.carousel.moon.inFront?this.panel.carousel.moon:this.panel.carousel.venus},k.exitStart=function(){app.off("update",this.update),app.sound.stopAll(),app.sound.unloadAll(),this.timeout.teardown(),this.dragInput.exitStart(),this.clickOnNothing.exitStart(),this.removeSignals(),j.exitStart.call(this),this.menuMusic.stop()},k.removeSignals=function(){for(var a in app.signals)app.signals.hasOwnProperty(a)&&delete app.signals[a];app.signals={}},namespace("srr.states").MenuState=i}(),function(){var a=include("springroll.Application"),b=include("srr.states.MenuState"),c=include("srr.states.GameState"),d=include("srr.misc.AppProgress"),e=include("srr.states.LoadingState"),f=include("springroll.EaselJSDisplay"),g=include("srr.misc.menuLoader"),h=include("srr.Planet"),i=include("srr.Analytics"),j=new a({name:"Seans Rover Rescue",preventScrollingKeys:!0,canvasId:"stage",state:"loading",configPath:"assets/config/config.json",captionsPath:"assets/config/captions.json",display:f,transition:new lib.Transition,displayOptions:{clearView:!0}});window.images=window.images||{},j.on("init",function(){var a=this.config,f=a.assets;f.menu=f.menu.concat(g.generateManifest(h.MOON)),f.menu=f.menu.concat(g.generateManifest(h.MARS)),f.menu=f.menu.concat(g.generateManifest(h.VENUS)),this.states={loading:new e({preload:f.loading,next:"menu"}),menu:new b({preload:f.menu,next:"game"}),game:new c({preload:f.game,previous:"menu",next:"game"})},j.progress=new d,j.vo={},j.analytics=new i,j._pointer={x:NaN,y:NaN},Object.defineProperty(j,"pointer",{get:function(){return j.display.stage.mouseInBounds&&(j._pointer.x=j.display.stage.mouseX+(j._scaleOffset||0),j._pointer.y=j.display.stage.mouseY,j._pointer.x/=j._scale||1,j._pointer.y/=j._scale||1),j._pointer}}),j.display.stage.addEventListener("mousedown",function(a){j.display.stage._primaryPointerID=a.pointerID})}),window.app=j}();