(function(Xf){function p(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function w(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=eg++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var F=function(){};F.__name__=["HxOverrides"];F.cca=function(a,
b){var c=a.charCodeAt(b);return c!=c?void 0:c};F.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};F.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};F.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var z=function(){};z.__name__=["Main"];z.main=function(){z.init()};z.validateBrowser=function(){var a=document.createElement("canvas");
if(null==a.getContext||null==a.getContext("2d").fillText)return!1;a=window.audioContextInstance;return n.isMobile()&&null==a?!1:!0};z.validateCookies=function(){return null!=Va.getLocalStorage()&&null!=Va.getSessionStorage()&&null!=navigator.cookieEnabled&&navigator.cookieEnabled};z.init=function(){if(z.validateBrowser())if(z.validateCookies()){z.container=z.getDocument().createElement("div");window.tabindex="0";z.container.style.position="relative";z.container.className="container";window.document.body.appendChild(z.container);
var a=z.getWindow().location.href,a=z.getQueryStringValue(a,"locale");""==a&&(a="en-us");z.dataLocale=a;z.root=new n("scooby_doo_good_2",1024,1024);z.root.addGameState(new zd);z.root.init();window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){a=n.isMobile()?z.TARGET_FPS_MOBILE:z.TARGET_FPS;window.setTimeout(z.update,1E3/a)};z.update()}else window.location.href="cookies.html";else window.location.href="unsupported.html"};z.getQueryStringValue=
function(a,b){var c=a.split("?");if(2>c.length)return"";for(var c=c[1].split("&"),d=0,e=c.length;d<e;){var f=d++;if(Ab.startsWith(c[f],b)&&(f=c[f].split("="),!(2>f.length)))return f[1]}return""};z.update=function(){z.root.processFrame();"1"==R.getProperty("debugDraw")&&z.root.debugRender();window.requestAnimFrame(z.update)};z.getDocument=function(){return window.document};z.getWindow=function(){return window};z.getCanvas=function(){return z.canvas};z.getContainer=function(){return z.container};z.getBasePath=
function(){for(var a=window.location.href.split("/"),b="",c=0,d=a.length-1;c<d;)var e=c++,b=b+(a[e]+"/");return b};Math.__name__=["Math"];var ta=function(){};ta.__name__=["Reflect"];ta.field=function(a,b){try{return a[b]}catch(c){return null}};ta.setProperty=function(a,b,c){var d,e;e=a.__properties__?d=a.__properties__["set_"+b]:!1;if(e)a[d](c);else a[b]=c};ta.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&("hx__closures__"!=d&&c.call(a,d))&&
b.push(d)}return b};ta.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};ta.compareMethods=function(a,b){return a==b?!0:ta.isFunction(a)&&ta.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};var ga=function(){};ga.__name__=["Std"];ga.string=function(a){return C.__string_rec(a,"")};ga.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=F.cca(a,1)&&88!=F.cca(a,1)||(b=parseInt(a));return isNaN(b)?null:b};var Ub=function(){this.b=""};Ub.__name__=
["StringBuf"];Ub.prototype={__class__:Ub};var Ab=function(){};Ab.__name__=["StringTools"];Ab.startsWith=function(a,b){return a.length>=b.length?F.substr(a,0,b.length)==b:!1};Ab.replace=function(a,b,c){return a.split(b).join(c)};var Sa=function(){};Sa.__name__=["Type"];Sa.getClassName=function(a){a=a.__name__;return null==a?null:a.join(".")};Sa.createEnum=function(a,b,c){var d=ta.field(a,b);if(null==d)throw new K("No such constructor "+b);if(ta.isFunction(d)){if(null==c)throw new K("Constructor "+
b+" need parameters");return d.apply(a,c)}if(null!=c&&0!=c.length)throw new K("Constructor "+b+" does not need parameters");return d};Sa.createEnumIndex=function(a,b,c){var d=a.__constructs__[b];if(null==d)throw new K(b+" is not a valid enum constructor index");return Sa.createEnum(a,d,c)};var B=function(a){this.nodeType=a;this.children=[];this.attributeMap=new ya};B.__name__=["Xml"];B.parse=function(a){return Bb.parse(a)};B.createElement=function(a){var b=new B(B.Element);if(b.nodeType!=B.Element)throw new K("Bad node type, expected Element but found "+
b.nodeType);b.nodeName=a;return b};B.createPCData=function(a){var b=new B(B.PCData);if(b.nodeType==B.Document||b.nodeType==B.Element)throw new K("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};B.createCData=function(a){var b=new B(B.CData);if(b.nodeType==B.Document||b.nodeType==B.Element)throw new K("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};B.createComment=function(a){var b=new B(B.Comment);if(b.nodeType==B.Document||b.nodeType==B.Element)throw new K("Bad node type, unexpected "+
b.nodeType);b.nodeValue=a;return b};B.createDocType=function(a){var b=new B(B.DocType);if(b.nodeType==B.Document||b.nodeType==B.Element)throw new K("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};B.createProcessingInstruction=function(a){var b=new B(B.ProcessingInstruction);if(b.nodeType==B.Document||b.nodeType==B.Element)throw new K("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};B.createDocument=function(){return new B(B.Document)};B.prototype={get:function(a){if(this.nodeType!=
B.Element)throw new K("Bad node type, expected Element but found "+this.nodeType);var b=this.attributeMap;return null!=N[a]?b.getReserved(a):b.h[a]},set:function(a,b){if(this.nodeType!=B.Element)throw new K("Bad node type, expected Element but found "+this.nodeType);var c=this.attributeMap;null!=N[a]?c.setReserved(a,b):c.h[a]=b},exists:function(a){if(this.nodeType!=B.Element)throw new K("Bad node type, expected Element but found "+this.nodeType);var b=this.attributeMap;return null!=N[a]?b.existsReserved(a):
b.h.hasOwnProperty(a)},elementsNamed:function(a){if(this.nodeType!=B.Document&&this.nodeType!=B.Element)throw new K("Bad node type, expected Element or Document but found "+this.nodeType);for(var b=[],c=0,d=this.children;c<d.length;){var e=d[c];++c;var f;if(e.nodeType==B.Element){if(e.nodeType!=B.Element)throw new K("Bad node type, expected Element but found "+e.nodeType);f=e.nodeName==a}else f=!1;f&&b.push(e)}return F.iter(b)},addChild:function(a){if(this.nodeType!=B.Document&&this.nodeType!=B.Element)throw new K("Bad node type, expected Element or Document but found "+
this.nodeType);null!=a.parent&&a.parent.removeChild(a);this.children.push(a);a.parent=this},removeChild:function(a){if(this.nodeType!=B.Document&&this.nodeType!=B.Element)throw new K("Bad node type, expected Element or Document but found "+this.nodeType);return F.remove(this.children,a)?(a.parent=null,!0):!1},__class__:B};var Wa=function(){this.lowerBound=new t;this.upperBound=new t};Wa.__name__=["box2D","collision","B2AABB"];Wa.prototype={isValid:function(){var a=this.upperBound.y-this.lowerBound.y;
return a=(a=0<=this.upperBound.x-this.lowerBound.x&&0<=a)&&this.lowerBound.isValid()?this.upperBound.isValid():!1},getCenter:function(){return new t((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},getExtents:function(){return new t((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},contains:function(a){var b;return b=(b=(b=(b=this.lowerBound.x<=a.lowerBound.x)?this.lowerBound.y<=a.lowerBound.y:!1)?a.upperBound.x<=this.upperBound.x:!1)?
a.upperBound.y<=this.upperBound.y:!1},rayCast:function(a,b){var c=-Number.MAX_VALUE,d=Number.MAX_VALUE,e=b.p1.x,f=b.p1.y,g=b.p2.x-b.p1.x,k=b.p2.y-b.p1.y,h=Math.abs(g),l=Math.abs(k),x=a.normal;if(h<Number.MIN_VALUE){if(e<this.lowerBound.x||this.upperBound.x<e)return!1}else if(h=1/g,g=(this.lowerBound.x-e)*h,e=(this.upperBound.x-e)*h,h=-1,g>e&&(h=g,g=e,e=h,h=1),g>c&&(x.x=h,x.y=0,c=g),d=Math.min(d,e),c>d)return!1;if(l<Number.MIN_VALUE){if(f<this.lowerBound.y||this.upperBound.y<f)return!1}else if(h=1/
k,g=(this.lowerBound.y-f)*h,e=(this.upperBound.y-f)*h,h=-1,g>e&&(h=g,g=e,e=h,h=1),g>c&&(x.y=h,x.x=0,c=g),d=Math.min(d,e),c>d)return!1;a.fraction=c;return!0},testOverlap:function(a){var b=a.lowerBound.y-this.upperBound.y,c=this.lowerBound.y-a.upperBound.y;return 0<a.lowerBound.x-this.upperBound.x||0<b||0<this.lowerBound.x-a.upperBound.x||0<c?!1:!0},combine:function(a,b){this.lowerBound.x=Math.min(a.lowerBound.x,b.lowerBound.x);this.lowerBound.y=Math.min(a.lowerBound.y,b.lowerBound.y);this.upperBound.x=
Math.max(a.upperBound.x,b.upperBound.x);this.upperBound.y=Math.max(a.upperBound.y,b.upperBound.y)},__class__:Wa};var t=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};t.__name__=["box2D","common","math","B2Vec2"];t.make=function(a,b){return new t(a,b)};t.prototype={setZero:function(){this.y=this.x=0},set:function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b},setV:function(a){this.x=a.x;this.y=a.y},getNegative:function(){return new t(-this.x,-this.y)},negativeSelf:function(){this.x=
-this.x;this.y=-this.y},copy:function(){return new t(this.x,this.y)},add:function(a){this.x+=a.x;this.y+=a.y},subtract:function(a){this.x-=a.x;this.y-=a.y},multiply:function(a){this.x*=a;this.y*=a},mulM:function(a){var b=this.x;this.x=a.col1.x*b+a.col2.x*this.y;this.y=a.col1.y*b+a.col2.y*this.y},mulTM:function(a){var b=q.dot(this,a.col1);this.y=q.dot(this,a.col2);this.x=b},crossVF:function(a){var b=this.x;this.x=a*this.y;this.y=-a*b},crossFV:function(a){var b=this.x;this.x=-a*this.y;this.y=a*b},minV:function(a){this.x=
this.x<a.x?this.x:a.x;this.y=this.y<a.y?this.y:a.y},maxV:function(a){this.x=this.x>a.x?this.x:a.x;this.y=this.y>a.y?this.y:a.y},abs:function(){0>this.x&&(this.x=-this.x);0>this.y&&(this.y=-this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSquared:function(){return this.x*this.x+this.y*this.y},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var b=1/a;this.x*=b;this.y*=b;return a},isValid:function(){return q.isValid(this.x)?
q.isValid(this.y):!1},__class__:t};var Ad=function(){this.v=new t;this.id=new kc};Ad.__name__=["box2D","collision","ClipVertex"];Ad.prototype={set:function(a){this.v.setV(a.v);this.id.set(a.id)},__class__:Ad};var kc=function(){this.features=new Oe;this.features._m_id=this};kc.__name__=["box2D","collision","B2ContactID"];kc.prototype={set:function(a){this.set_key(a._key)},copy:function(){var a=new kc;a.set_key(this.get_key());return a},get_key:function(){return this._key},set_key:function(a){this._key=
a;this.features._referenceEdge=this._key&255;this.features._incidentEdge=(this._key&65280)>>8&255;this.features._incidentVertex=(this._key&16711680)>>16&255;this.features._flip=(this._key&-16777216)>>24&255;return this._key},__class__:kc,__properties__:{set_key:"set_key",get_key:"get_key"}};var Oe=function(){};Oe.__name__=["box2D","collision","Features"];Oe.prototype={get_referenceEdge:function(){return this._referenceEdge},set_referenceEdge:function(a){this._referenceEdge=a;this._m_id._key=this._m_id._key&
-256|this._referenceEdge&255;return a},get_incidentEdge:function(){return this._incidentEdge},set_incidentEdge:function(a){this._incidentEdge=a;this._m_id._key=this._m_id._key&-65281|this._incidentEdge<<8&65280;return a},get_incidentVertex:function(){return this._incidentVertex},set_incidentVertex:function(a){this._incidentVertex=a;this._m_id._key=this._m_id._key&-16711681|this._incidentVertex<<16&16711680;return a},get_flip:function(){return this._flip},set_flip:function(a){this._flip=a;this._m_id._key=
this._m_id._key&16777215|this._flip<<24&-16777216;return a},__class__:Oe,__properties__:{set_flip:"set_flip",get_flip:"get_flip",set_incidentVertex:"set_incidentVertex",get_incidentVertex:"get_incidentVertex",set_incidentEdge:"set_incidentEdge",get_incidentEdge:"get_incidentEdge",set_referenceEdge:"set_referenceEdge",get_referenceEdge:"get_referenceEdge"}};var J=function(){};J.__name__=["box2D","collision","B2Collision"];J.clipSegmentToLine=function(a,b,c,d){var e,f=0;e=b[0];var g=e.v;e=b[1];var k=
e.v,h=c.x*g.x+c.y*g.y-d;e=c.x*k.x+c.y*k.y-d;0>=h&&a[f++].set(b[0]);0>=e&&a[f++].set(b[1]);0>h*e&&(c=h/(h-e),e=a[f],e=e.v,e.x=g.x+c*(k.x-g.x),e.y=g.y+c*(k.y-g.y),e=a[f],e.id=(0<h?b[0]:b[1]).id,++f);return f};J.edgeSeparation=function(a,b,c,d,e){var f=a.m_vertices;a=a.m_normals;var g=d.m_vertexCount,k=d.m_vertices,h,l;h=b.R;l=a[c];a=h.col1.x*l.x+h.col2.x*l.y;d=h.col1.y*l.x+h.col2.y*l.y;h=e.R;var x=h.col1.x*a+h.col1.y*d;h=h.col2.x*a+h.col2.y*d;for(var u=0,$f=Number.MAX_VALUE,m=0;m<g;){var q=m++;l=k[q];
l=l.x*x+l.y*h;l<$f&&($f=l,u=q)}l=f[c];h=b.R;c=b.position.x+(h.col1.x*l.x+h.col2.x*l.y);b=b.position.y+(h.col1.y*l.x+h.col2.y*l.y);l=k[u];h=e.R;f=e.position.x+(h.col1.x*l.x+h.col2.x*l.y);e=e.position.y+(h.col1.y*l.x+h.col2.y*l.y);return(f-c)*a+(e-b)*d};J.findMaxSeparation=function(a,b,c,d,e){var f=b.m_vertexCount,g=b.m_normals,k,h=e.R;k=d.m_centroid;var l=e.position.x+(h.col1.x*k.x+h.col2.x*k.y),x=e.position.y+(h.col1.y*k.x+h.col2.y*k.y),h=c.R;k=b.m_centroid;for(var l=l-(c.position.x+(h.col1.x*k.x+
h.col2.x*k.y)),x=x-(c.position.y+(h.col1.y*k.x+h.col2.y*k.y)),h=l*c.R.col1.x+x*c.R.col1.y,x=l*c.R.col2.x+x*c.R.col2.y,l=0,u=-Number.MAX_VALUE,m=0;m<f;){var q=m++;k=g[q];k=k.x*h+k.y*x;k>u&&(u=k,l=q)}g=J.edgeSeparation(b,c,l,d,e);u=0<=l-1?l-1:f-1;h=J.edgeSeparation(b,c,u,d,e);m=l+1<f?l+1:0;x=J.edgeSeparation(b,c,m,d,e);if(h>g&&h>x)k=-1;else if(x>g)k=1,u=m,h=x;else return a[0]=l,g;for(;;)if(l=-1==k?0<=u-1?u-1:f-1:u+1<f?u+1:0,g=J.edgeSeparation(b,c,l,d,e),g>h)u=l,h=g;else break;a[0]=u;return h};J.findIncidentEdge=
function(a,b,c,d,e,f){var g=b.m_normals,k=e.m_vertexCount;b=e.m_vertices;e=e.m_normals;var h;h=c.R;c=g[d];var g=h.col1.x*c.x+h.col2.x*c.y,l=h.col1.y*c.x+h.col2.y*c.y;h=f.R;c=h.col1.x*g+h.col1.y*l;l=h.col2.x*g+h.col2.y*l;g=c;h=0;for(var x=Number.MAX_VALUE,u=0;u<k;){var m=u++;c=e[m];c=g*c.x+l*c.y;c<x&&(x=c,h=m)}e=h;g=e+1<k?e+1:0;k=a[0];c=b[e];h=f.R;k.v.x=f.position.x+(h.col1.x*c.x+h.col2.x*c.y);k.v.y=f.position.y+(h.col1.y*c.x+h.col2.y*c.y);k.id.features.set_referenceEdge(d);k.id.features.set_incidentEdge(e);
k.id.features.set_incidentVertex(0);k=a[1];c=b[g];h=f.R;k.v.x=f.position.x+(h.col1.x*c.x+h.col2.x*c.y);k.v.y=f.position.y+(h.col1.y*c.x+h.col2.y*c.y);k.id.features.set_referenceEdge(d);k.id.features.set_incidentEdge(g);k.id.features.set_incidentVertex(1)};J.makeClipPointVector=function(){var a=[];a[0]=new Ad;a[1]=new Ad;return a};J.collidePolygons=function(a,b,c,d,e){var f;a.m_pointCount=0;var g=b.m_radius+d.m_radius,k;J.s_edgeAO[0]=0;var h=J.findMaxSeparation(J.s_edgeAO,b,c,d,e);k=J.s_edgeAO[0];
if(!(h>g)){var l;J.s_edgeBO[0]=0;var x=J.findMaxSeparation(J.s_edgeBO,d,e,b,c);l=J.s_edgeBO[0];if(!(x>g)){x>0.98*h+0.001?(h=d,d=b,b=e,a.m_type=ua.FACE_B,k=1):(h=b,b=c,c=e,l=k,a.m_type=ua.FACE_A,k=0);e=J.s_incidentEdge;J.findIncidentEdge(e,h,b,l,d,c);x=h.m_vertices;d=x[l];var u;u=l+1<h.m_vertexCount?x[l+1|0]:x[0];h=J.s_localTangent;h.set(u.x-d.x,u.y-d.y);h.normalize();x=J.s_localNormal;x.x=h.y;x.y=-h.x;var m=J.s_planePoint;m.set(0.5*(d.x+u.x),0.5*(d.y+u.y));f=J.s_tangent;l=b.R;f.x=l.col1.x*h.x+l.col2.x*
h.y;f.y=l.col1.y*h.x+l.col2.y*h.y;var q=J.s_tangent2;q.x=-f.x;q.y=-f.y;h=J.s_normal;h.x=f.y;h.y=-f.x;var n=J.s_v11,r=J.s_v12;n.x=b.position.x+(l.col1.x*d.x+l.col2.x*d.y);n.y=b.position.y+(l.col1.y*d.x+l.col2.y*d.y);r.x=b.position.x+(l.col1.x*u.x+l.col2.x*u.y);r.y=b.position.y+(l.col1.y*u.x+l.col2.y*u.y);b=h.x*n.x+h.y*n.y;l=f.x*r.x+f.y*r.y+g;u=J.s_clipPoints1;d=J.s_clipPoints2;e=J.clipSegmentToLine(u,e,q,-f.x*n.x-f.y*n.y+g);if(!(2>e||(e=J.clipSegmentToLine(d,u,f,l),2>e))){a.m_localPlaneNormal.setV(x);
a.m_localPoint.setV(m);x=e=0;for(m=v.b2_maxManifoldPoints;x<m;)l=x++,f=d[l],h.x*f.v.x+h.y*f.v.y-b<=g&&(q=a.m_points[e],l=c.R,n=f.v.x-c.position.x,u=f.v.y-c.position.y,q.m_localPoint.x=n*l.col1.x+u*l.col1.y,q.m_localPoint.y=n*l.col2.x+u*l.col2.y,q.m_id.set(f.id),q.m_id.features.set_flip(k),++e);a.m_pointCount=e}}}};J.collideCircles=function(a,b,c,d,e){a.m_pointCount=0;var f,g;f=c.R;g=b.m_p;var k=c.position.x+(f.col1.x*g.x+f.col2.x*g.y);c=c.position.y+(f.col1.y*g.x+f.col2.y*g.y);f=e.R;g=d.m_p;k=e.position.x+
(f.col1.x*g.x+f.col2.x*g.y)-k;e=e.position.y+(f.col1.y*g.x+f.col2.y*g.y)-c;f=b.m_radius+d.m_radius;k*k+e*e>f*f||(a.m_type=ua.CIRCLES,a.m_localPoint.setV(b.m_p),a.m_localPlaneNormal.setZero(),a.m_pointCount=1,a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0))};J.collidePolygonAndCircle=function(a,b,c,d,e){a.m_pointCount=0;var f,g,k,h=e.R;k=d.m_p;var l=e.position.y+(h.col1.y*k.x+h.col2.y*k.y);f=e.position.x+(h.col1.x*k.x+h.col2.x*k.y)-c.position.x;g=l-c.position.y;h=c.R;c=f*h.col1.x+
g*h.col1.y;var h=f*h.col2.x+g*h.col2.y,x=0;e=-Number.MAX_VALUE;var l=b.m_radius+d.m_radius,u=b.m_vertexCount,m=b.m_vertices;b=b.m_normals;for(var q=0;q<u;){var n=q++;k=m[n];f=c-k.x;g=h-k.y;k=b[n];k=k.x*f+k.y*g;if(k>l)return;k>e&&(e=k,x=n)}k=x;f=m[k];u=m[k+1<u?k+1:0];e<Number.MIN_VALUE?(a.m_pointCount=1,a.m_type=ua.FACE_A,a.m_localPlaneNormal.setV(b[x]),a.m_localPoint.x=0.5*(f.x+u.x),a.m_localPoint.y=0.5*(f.y+u.y),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):(e=(c-u.x)*(f.x-
u.x)+(h-u.y)*(f.y-u.y),0>=(c-f.x)*(u.x-f.x)+(h-f.y)*(u.y-f.y)?(c-f.x)*(c-f.x)+(h-f.y)*(h-f.y)>l*l||(a.m_pointCount=1,a.m_type=ua.FACE_A,a.m_localPlaneNormal.x=c-f.x,a.m_localPlaneNormal.y=h-f.y,a.m_localPlaneNormal.normalize(),a.m_localPoint.setV(f),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):0>=e?(c-u.x)*(c-u.x)+(h-u.y)*(h-u.y)>l*l||(a.m_pointCount=1,a.m_type=ua.FACE_A,a.m_localPlaneNormal.x=c-u.x,a.m_localPlaneNormal.y=h-u.y,a.m_localPlaneNormal.normalize(),a.m_localPoint.setV(u),
a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):(x=0.5*(f.x+u.x),f=0.5*(f.y+u.y),e=(c-x)*b[k].x+(h-f)*b[k].y,e>l||(a.m_pointCount=1,a.m_type=ua.FACE_A,a.m_localPlaneNormal.x=b[k].x,a.m_localPlaneNormal.y=b[k].y,a.m_localPlaneNormal.normalize(),a.m_localPoint.set(x,f),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0))))};J.testOverlap=function(a,b){var c=b.lowerBound,d=a.upperBound,e=c.x-d.x,f=c.y-d.y,c=a.lowerBound,d=b.upperBound,g=c.y-d.y;return 0<e||0<f||
0<c.x-d.x||0<g?!1:!0};var Pe=function(){this.position=new t;this.velocity=new t;this.normal=new t;this.id=new kc};Pe.__name__=["box2D","collision","B2ContactPoint"];Pe.prototype={__class__:Pe};var Qe=function(){this.m_v1=new Ic;this.m_v2=new Ic;this.m_v3=new Ic;this.m_vertices=[];this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};Qe.__name__=["box2D","collision","B2Simplex"];Qe.prototype={readCache:function(a,b,c,d,e){v.b2Assert(0<=a.count&&3>=a.count);var f,g;
this.m_count=a.count;for(var k=this.m_vertices,h,l=0,x=this.m_count;l<x;)f=l++,h=k[f],h.indexA=a.indexA[f],h.indexB=a.indexB[f],f=b.getVertex(h.indexA),g=d.getVertex(h.indexB),h.wA=q.mulX(c,f),h.wB=q.mulX(e,g),h.w=q.subtractVV(h.wB,h.wA),h.a=0;1<this.m_count&&(a=a.metric,h=this.getMetric(),h<0.5*a||2*a<h||h<Number.MIN_VALUE)&&(this.m_count=0);0==this.m_count&&(h=k[0],h.indexA=0,h.indexB=0,f=b.getVertex(0),g=d.getVertex(0),h.wA=q.mulX(c,f),h.wB=q.mulX(e,g),h.w=q.subtractVV(h.wB,h.wA),this.m_count=
1)},writeCache:function(a){a.metric=this.getMetric();a.count=this.m_count|0;for(var b=this.m_vertices,c=0,d=this.m_count;c<d;){var e=c++;a.indexA[e]=b[e].indexA|0;a.indexB[e]=b[e].indexB|0}},getSearchDirection:function(){switch(this.m_count){case 1:return this.m_v1.w.getNegative();case 2:var a=q.subtractVV(this.m_v2.w,this.m_v1.w);return 0<q.crossVV(a,this.m_v1.w.getNegative())?q.crossFV(1,a):q.crossVF(a,1);default:return v.b2Assert(!1),new t}},getClosestPoint:function(){switch(this.m_count){case 0:return v.b2Assert(!1),
new t;case 1:return this.m_v1.w;case 2:return new t(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return v.b2Assert(!1),new t}},getWitnessPoints:function(a,b){switch(this.m_count){case 0:v.b2Assert(!1);break;case 1:a.setV(this.m_v1.wA);b.setV(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;b.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;
b.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:b.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;b.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:v.b2Assert(!1)}},getMetric:function(){switch(this.m_count){case 0:return v.b2Assert(!1),0;case 1:return 0;case 2:return q.subtractVV(this.m_v1.w,this.m_v2.w).length();case 3:return q.crossVV(q.subtractVV(this.m_v2.w,this.m_v1.w),q.subtractVV(this.m_v3.w,
this.m_v1.w));default:return v.b2Assert(!1),0}},solve2:function(){var a=this.m_v1.w,b=this.m_v2.w,c=q.subtractVV(b,a),a=-(a.x*c.x+a.y*c.y);0>=a?this.m_count=this.m_v1.a=1:(b=b.x*c.x+b.y*c.y,0>=b?(this.m_count=this.m_v2.a=1,this.m_v1.set(this.m_v2)):(c=1/(b+a),this.m_v1.a=b*c,this.m_v2.a=a*c,this.m_count=2))},solve3:function(){var a=this.m_v1.w,b=this.m_v2.w,c=this.m_v3.w,d=q.subtractVV(b,a),e=q.dot(a,d),f=q.dot(b,d),e=-e,g=q.subtractVV(c,a),k=q.dot(a,g),h=q.dot(c,g),k=-k,l=q.subtractVV(c,b),x=q.dot(b,
l),l=q.dot(c,l),x=-x,g=q.crossVV(d,g),d=g*q.crossVV(b,c),c=g*q.crossVV(c,a),a=g*q.crossVV(a,b);0>=e&&0>=k?this.m_count=this.m_v1.a=1:0<f&&0<e&&0>=a?(h=1/(f+e),this.m_v1.a=f*h,this.m_v2.a=e*h,this.m_count=2):0<h&&0<k&&0>=c?(f=1/(h+k),this.m_v1.a=h*f,this.m_v3.a=k*f,this.m_count=2,this.m_v2.set(this.m_v3)):0>=f&&0>=x?(this.m_count=this.m_v2.a=1,this.m_v1.set(this.m_v2)):0>=h&&0>=l?(this.m_count=this.m_v3.a=1,this.m_v1.set(this.m_v3)):0<l&&0<x&&0>=d?(f=1/(l+x),this.m_v2.a=l*f,this.m_v3.a=x*f,this.m_count=
2,this.m_v1.set(this.m_v3)):(f=1/(d+c+a),this.m_v1.a=d*f,this.m_v2.a=c*f,this.m_v3.a=a*f,this.m_count=3)},__class__:Qe};var Ic=function(){};Ic.__name__=["box2D","collision","B2SimplexVertex"];Ic.prototype={set:function(a){this.wA.setV(a.wA);this.wB.setV(a.wB);this.w.setV(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB},__class__:Ic};var Xa=function(){};Xa.__name__=["box2D","collision","B2Distance"];Xa.distance=function(a,b,c){++Xa.b2_gjkCalls;var d=c.proxyA,e=c.proxyB,f=c.transformA,g=c.transformB,
k=Xa.s_simplex;k.readCache(b,d,f,e,g);var h=k.m_vertices,l=Xa.s_saveA,x=Xa.s_saveB,u=0;k.getClosestPoint().lengthSquared();for(var m,n=0;20>n;){u=k.m_count;m=0;for(var r=u;m<r;){var p=m++;l[p]=h[p].indexA;x[p]=h[p].indexB}switch(k.m_count){case 1:break;case 2:k.solve2();break;case 3:k.solve3();break;default:v.b2Assert(!1)}if(3==k.m_count)break;m=k.getClosestPoint();m.lengthSquared();r=k.getSearchDirection();if(r.lengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;m=h[k.m_count];m.indexA=d.getSupport(q.mulTMV(f.R,
r.getNegative()))|0;m.wA=q.mulX(f,d.getVertex(m.indexA));m.indexB=e.getSupport(q.mulTMV(g.R,r))|0;m.wB=q.mulX(g,e.getVertex(m.indexB));m.w=q.subtractVV(m.wB,m.wA);++n;++Xa.b2_gjkIters;r=!1;for(p=0;p<u;){var s=p++;if(m.indexA==l[s]&&m.indexB==x[s]){r=!0;break}}if(r)break;++k.m_count}Xa.b2_gjkMaxIters=q.max(Xa.b2_gjkMaxIters,n)|0;k.getWitnessPoints(a.pointA,a.pointB);a.distance=q.subtractVV(a.pointA,a.pointB).length();a.iterations=n;k.writeCache(b);c.useRadii&&(b=d.m_radius,e=e.m_radius,a.distance>
b+e&&a.distance>Number.MIN_VALUE?(a.distance-=b+e,c=q.subtractVV(a.pointB,a.pointA),c.normalize(),a.pointA.x+=b*c.x,a.pointA.y+=b*c.y,a.pointB.x-=e*c.x,a.pointB.y-=e*c.y):(m=new t,m.x=0.5*(a.pointA.x+a.pointB.x),m.y=0.5*(a.pointA.y+a.pointB.y),a.pointA.x=a.pointB.x=m.x,a.pointA.y=a.pointB.y=m.y,a.distance=0))};var Re=function(){};Re.__name__=["box2D","collision","B2DistanceInput"];Re.prototype={__class__:Re};var Se=function(){this.pointA=new t;this.pointB=new t};Se.__name__=["box2D","collision","B2DistanceOutput"];
Se.prototype={__class__:Se};var Bd=function(){this.m_vertices=[]};Bd.__name__=["box2D","collision","B2DistanceProxy"];Bd.prototype={set:function(a){switch(a.getType()[1]){case 1:a=C.__cast(a,Ya);this.m_vertices=[];this.m_vertices[0]=a.m_p;this.m_count=1;this.m_radius=a.m_radius;break;case 2:a=C.__cast(a,oa);this.m_vertices=a.m_vertices;this.m_count=a.m_vertexCount;this.m_radius=a.m_radius;break;default:v.b2Assert(!1)}},getSupport:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*
a.y,d=1,e=this.m_count;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return b},getSupportVertex:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_count;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return this.m_vertices[b]},getVertexCount:function(){return this.m_count},getVertex:function(a){v.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a]},__class__:Bd};var Te=function(){this.m_freeList=
this.m_root=null;this.m_insertionCount=this.m_path=0};Te.__name__=["box2D","collision","B2DynamicTree"];Te.prototype={createProxy:function(a,b){var c=this.allocateNode(),d=v.b2_aabbExtension,e=v.b2_aabbExtension;c.aabb.lowerBound.x=a.lowerBound.x-d;c.aabb.lowerBound.y=a.lowerBound.y-e;c.aabb.upperBound.x=a.upperBound.x+d;c.aabb.upperBound.y=a.upperBound.y+e;c.userData=b;this.insertLeaf(c);return c},destroyProxy:function(a){this.removeLeaf(a);this.freeNode(a)},moveProxy:function(a,b,c){v.b2Assert(a.isLeaf());
if(a.aabb.contains(b))return!1;this.removeLeaf(a);var d=v.b2_aabbExtension+v.b2_aabbMultiplier*(0<c.x?c.x:-c.x);c=v.b2_aabbExtension+v.b2_aabbMultiplier*(0<c.y?c.y:-c.y);a.aabb.lowerBound.x=b.lowerBound.x-d;a.aabb.lowerBound.y=b.lowerBound.y-c;a.aabb.upperBound.x=b.upperBound.x+d;a.aabb.upperBound.y=b.upperBound.y+c;this.insertLeaf(a);return!0},rebalance:function(a){if(null!=this.m_root)for(var b=0;b<a;){b++;for(var c=this.m_root,d=0;!1==c.isLeaf();)c=0!=(this.m_path>>d&1)?c.child2:c.child1,d=d+1&
31;++this.m_path;this.removeLeaf(c);this.insertLeaf(c)}},getFatAABB:function(a){return a.aabb},getUserData:function(a){return a.userData},query:function(a,b){if(null!=this.m_root){var c=[],d=0;for(c[d++]=this.m_root;0<d;){var e=c[--d];if(e.aabb.testOverlap(b))if(e.isLeaf()){if(!a(e))break}else c[d++]=e.child1,c[d++]=e.child2}}},rayCast:function(a,b){if(null!=this.m_root){var c=b.p1,d=b.p2,e=q.subtractVV(c,d);e.normalize();var e=q.crossFV(1,e),f=q.absV(e),g=b.maxFraction,k=new Wa,h;h=c.x+g*(d.x-c.x);
g=c.y+g*(d.y-c.y);k.lowerBound.x=Math.min(c.x,h);k.lowerBound.y=Math.min(c.y,g);k.upperBound.x=Math.max(c.x,h);k.upperBound.y=Math.max(c.y,g);var l=[],x=0;for(l[x++]=this.m_root;0<x;)if(h=l[--x],!1!=h.aabb.testOverlap(k)){var g=h.aabb.getCenter(),u=h.aabb.getExtents();if(!(0<Math.abs(e.x*(c.x-g.x)+e.y*(c.y-g.y))-f.x*u.x-f.y*u.y))if(h.isLeaf()){g=new Cd;g.p1=b.p1;g.p2=b.p2;g.maxFraction=b.maxFraction;g=a(g,h);if(0==g)break;h=c.x+g*(d.x-c.x);g=c.y+g*(d.y-c.y);k.lowerBound.x=Math.min(c.x,h);k.lowerBound.y=
Math.min(c.y,g);k.upperBound.x=Math.max(c.x,h);k.upperBound.y=Math.max(c.y,g)}else l[x++]=h.child1,l[x++]=h.child2}}},allocateNode:function(){if(null!=this.m_freeList){var a=this.m_freeList;this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;return a}return new Jc},freeNode:function(a){a.parent=this.m_freeList;this.m_freeList=a},insertLeaf:function(a){++this.m_insertionCount;if(null==this.m_root)this.m_root=a,this.m_root.parent=null;else{var b=a.aabb.getCenter(),c=this.m_root;if(!1==
c.isLeaf())for(;;){var d=c.child1,c=c.child2,e=Math.abs((d.aabb.lowerBound.x+d.aabb.upperBound.x)/2-b.x)+Math.abs((d.aabb.lowerBound.y+d.aabb.upperBound.y)/2-b.y),f=Math.abs((c.aabb.lowerBound.x+c.aabb.upperBound.x)/2-b.x)+Math.abs((c.aabb.lowerBound.y+c.aabb.upperBound.y)/2-b.y),c=e<f?d:c;if(!1!=c.isLeaf())break}b=c.parent;d=this.allocateNode();d.parent=b;d.userData=null;d.aabb.combine(a.aabb,c.aabb);if(null!=b)for(c.parent.child1==c?b.child1=d:b.child2=d,d.child1=c,d.child2=a,c.parent=d,a.parent=
d;!b.aabb.contains(d.aabb)&&(b.aabb.combine(b.child1.aabb,b.child2.aabb),d=b,b=b.parent,null!=b););else d.child1=c,d.child2=a,c.parent=d,this.m_root=a.parent=d}},removeLeaf:function(a){if(a==this.m_root)this.m_root=null;else{var b=a.parent,c=b.parent;a=b.child1==a?b.child2:b.child1;if(null!=c)for(c.child1==b?c.child1=a:c.child2=a,a.parent=c,this.freeNode(b);null!=c;){b=c.aabb;c.aabb=new Wa;c.aabb.combine(c.child1.aabb,c.child2.aabb);if(b.contains(c.aabb))break;c=c.parent}else this.m_root=a,a.parent=
null,this.freeNode(b)}},__class__:Te};var Ue=function(){};Ue.__name__=["box2D","collision","IBroadPhase"];Ue.prototype={__class__:Ue};var Dd=function(){this.m_tree=new Te;this.m_moveBuffer=[];this.m_pairBuffer=[];this.m_pairCount=0};Dd.__name__=["box2D","collision","B2DynamicTreeBroadPhase"];Dd.__interfaces__=[Ue];Dd.prototype={createProxy:function(a,b){var c=this.m_tree.createProxy(a,b);++this.m_proxyCount;this.bufferMove(c);return c},destroyProxy:function(a){this.unBufferMove(a);--this.m_proxyCount;
this.m_tree.destroyProxy(a)},moveProxy:function(a,b,c){this.m_tree.moveProxy(a,b,c)&&this.bufferMove(a)},testOverlap:function(a,b){var c=this.m_tree.getFatAABB(a),d=this.m_tree.getFatAABB(b);return c.testOverlap(d)},getUserData:function(a){return this.m_tree.getUserData(a)},getFatAABB:function(a){return this.m_tree.getFatAABB(a)},getProxyCount:function(){return this.m_proxyCount},updatePairs:function(a){for(var b=this,c=this.m_pairCount=0,d=this.m_moveBuffer;c<d.length;){var e=[d[c]];++c;var f=function(a){return function(c){if(c==
a[0])return!0;b.m_pairCount==b.m_pairBuffer.length&&(b.m_pairBuffer[b.m_pairCount]=new Ve);var d=b.m_pairBuffer[b.m_pairCount];c.id<a[0].id?(d.proxyA=c,d.proxyB=a[0]):(d.proxyA=a[0],d.proxyB=c);++b.m_pairCount;return!0}}(e),e=this.m_tree.getFatAABB(e[0]);this.m_tree.query(f,e)}this.m_moveBuffer=[];c=!0;for(d=0;c;)if(d>=this.m_pairCount)c=!1;else{var f=this.m_pairBuffer[d],e=this.m_tree.getUserData(f.proxyA),g=this.m_tree.getUserData(f.proxyB);a(e,g);for(++d;d<this.m_pairCount;){e=this.m_pairBuffer[d];
if(e.proxyA!=f.proxyA||e.proxyB!=f.proxyB)break;++d}}},query:function(a,b){this.m_tree.query(a,b)},rayCast:function(a,b){this.m_tree.rayCast(a,b)},validate:function(){},rebalance:function(a){this.m_tree.rebalance(a)},bufferMove:function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a},unBufferMove:function(a){F.remove(this.m_moveBuffer,a)},comparePairs:function(a,b){return 0},__class__:Dd};var Jc=function(){this.aabb=new Wa;this.id=Jc.currentID++};Jc.__name__=["box2D","collision","B2DynamicTreeNode"];
Jc.prototype={isLeaf:function(){return null==this.child1},__class__:Jc};var Ve=function(){};Ve.__name__=["box2D","collision","B2DynamicTreePair"];Ve.prototype={__class__:Ve};var Kc=function(){this.m_pointCount=0;this.m_points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new We}this.m_localPlaneNormal=new t;this.m_localPoint=new t};Kc.__name__=["box2D","collision","B2Manifold"];Kc.prototype={reset:function(){for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c].reset()}this.m_localPlaneNormal.setZero();
this.m_localPoint.setZero();this.m_type=ua.CIRCLES;this.m_pointCount=0},set:function(a){this.m_pointCount=a.m_pointCount;for(var b=0,c=v.b2_maxManifoldPoints;b<c;){var d=b++;this.m_points[d].set(a.m_points[d])}this.m_localPlaneNormal.setV(a.m_localPlaneNormal);this.m_localPoint.setV(a.m_localPoint);this.m_type=a.m_type},copy:function(){var a=new Kc;a.set(this);return a},__class__:Kc};var We=function(){this.m_localPoint=new t;this.m_id=new kc;this.reset()};We.__name__=["box2D","collision","B2ManifoldPoint"];
We.prototype={reset:function(){this.m_localPoint.setZero();this.m_tangentImpulse=this.m_normalImpulse=0;this.m_id.set_key(0)},set:function(a){this.m_localPoint.setV(a.m_localPoint);this.m_normalImpulse=a.m_normalImpulse;this.m_tangentImpulse=a.m_tangentImpulse;this.m_id.set(a.m_id)},__class__:We};var ua={__ename__:!0,__constructs__:["CIRCLES","FACE_A","FACE_B"],CIRCLES:["CIRCLES",0]};ua.CIRCLES.__enum__=ua;ua.FACE_A=["FACE_A",1];ua.FACE_A.__enum__=ua;ua.FACE_B=["FACE_B",2];ua.FACE_B.__enum__=ua;ua.__empty_constructs__=
[ua.CIRCLES,ua.FACE_A,ua.FACE_B];var Cd=function(a,b,c){null==c&&(c=1);this.p1=new t;this.p2=new t;null!=a&&this.p1.setV(a);null!=b&&this.p2.setV(b);this.maxFraction=c};Cd.__name__=["box2D","collision","B2RayCastInput"];Cd.prototype={__class__:Cd};var Xe=function(){this.normal=new t};Xe.__name__=["box2D","collision","B2RayCastOutput"];Xe.prototype={__class__:Xe};var Ye=function(){this.m_localPoint=new t;this.m_axis=new t};Ye.__name__=["box2D","collision","B2SeparationFunction"];Ye.prototype={initialize:function(a,
b,c,d,e){this.m_proxyA=b;this.m_proxyB=d;b=a.count;v.b2Assert(0<b&&3>b);var f=new t,g=new t,k,h;if(1==b)this.m_type=Ga.POINTS,f=this.m_proxyA.getVertex(a.indexA[0]),g=this.m_proxyB.getVertex(a.indexB[0]),h=f,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=g,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*h.y),e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),this.m_axis.x=g-f,this.m_axis.y=e-c,this.m_axis.normalize();else{if(a.indexB[0]==a.indexB[1])this.m_type=
Ga.FACE_A,b=this.m_proxyA.getVertex(a.indexA[0]),d=this.m_proxyA.getVertex(a.indexA[1]),g=this.m_proxyB.getVertex(a.indexB[0]),this.m_localPoint.x=0.5*(b.x+d.x),this.m_localPoint.y=0.5*(b.y+d.y),this.m_axis=q.crossVF(q.subtractVV(d,b),1),this.m_axis.normalize(),h=this.m_axis,k=c.R,b=k.col1.x*h.x+k.col2.x*h.y,d=k.col1.y*h.x+k.col2.y*h.y,h=this.m_localPoint,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=g,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*h.y),
e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),a=(g-f)*b+(e-c)*d;else if(a.indexA[0]==a.indexA[0])this.m_type=Ga.FACE_B,k=this.m_proxyB.getVertex(a.indexB[0]),h=this.m_proxyB.getVertex(a.indexB[1]),f=this.m_proxyA.getVertex(a.indexA[0]),this.m_localPoint.x=0.5*(k.x+h.x),this.m_localPoint.y=0.5*(k.y+h.y),this.m_axis=q.crossVF(q.subtractVV(h,k),1),this.m_axis.normalize(),h=this.m_axis,k=e.R,b=k.col1.x*h.x+k.col2.x*h.y,d=k.col1.y*h.x+k.col2.y*h.y,h=this.m_localPoint,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*
h.y),e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=f,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),a=(f-g)*b+(c-e)*d;else{b=this.m_proxyA.getVertex(a.indexA[0]);d=this.m_proxyA.getVertex(a.indexA[1]);k=this.m_proxyB.getVertex(a.indexB[0]);h=this.m_proxyB.getVertex(a.indexB[1]);q.mulX(c,f);f=q.mulMV(c.R,q.subtractVV(d,b));q.mulX(e,g);a=q.mulMV(e.R,q.subtractVV(h,k));e=f.x*f.x+f.y*f.y;c=a.x*a.x+a.y*a.y;var l=q.subtractVV(a,f),g=f.x*l.x+f.y*l.y,l=a.x*l.x+
a.y*l.y,f=f.x*a.x+f.y*a.y,x=e*c-f*f;a=0;0!=x&&(a=q.clamp((f*l-g*c)/x,0,1));0>(f*a+l)/c&&(a=q.clamp((f-g)/e,0,1));f=new t;f.x=b.x+a*(d.x-b.x);f.y=b.y+a*(d.y-b.y);g=new t;g.x=k.x+a*(h.x-k.x);g.y=k.y+a*(h.y-k.y);0==a||1==a?(this.m_type=Ga.FACE_B,this.m_axis=q.crossVF(q.subtractVV(h,k),1),this.m_axis.normalize(),this.m_localPoint=g):(this.m_type=Ga.FACE_A,this.m_axis=q.crossVF(q.subtractVV(d,b),1),this.m_localPoint=f)}0>a&&this.m_axis.negativeSelf()}},evaluate:function(a,b){var c,d,e;switch(this.m_type[1]){case 0:return c=
q.mulTMV(a.R,this.m_axis),d=q.mulTMV(b.R,this.m_axis.getNegative()),c=this.m_proxyA.getSupportVertex(c),d=this.m_proxyB.getSupportVertex(d),c=q.mulX(a,c),d=q.mulX(b,d),e=(d.x-c.x)*this.m_axis.x+(d.y-c.y)*this.m_axis.y;case 1:return e=q.mulMV(a.R,this.m_axis),c=q.mulX(a,this.m_localPoint),d=q.mulTMV(b.R,e.getNegative()),d=this.m_proxyB.getSupportVertex(d),d=q.mulX(b,d),e=(d.x-c.x)*e.x+(d.y-c.y)*e.y;case 2:return e=q.mulMV(b.R,this.m_axis),d=q.mulX(b,this.m_localPoint),c=q.mulTMV(a.R,e.getNegative()),
c=this.m_proxyA.getSupportVertex(c),c=q.mulX(a,c),e=(c.x-d.x)*e.x+(c.y-d.y)*e.y}},__class__:Ye};var Ga={__ename__:!0,__constructs__:["POINTS","FACE_A","FACE_B"],POINTS:["POINTS",0]};Ga.POINTS.__enum__=Ga;Ga.FACE_A=["FACE_A",1];Ga.FACE_A.__enum__=Ga;Ga.FACE_B=["FACE_B",2];Ga.FACE_B.__enum__=Ga;Ga.__empty_constructs__=[Ga.POINTS,Ga.FACE_A,Ga.FACE_B];var Ze=function(){this.indexA=[];this.indexB=[]};Ze.__name__=["box2D","collision","B2SimplexCache"];Ze.prototype={__class__:Ze};var $e=function(){this.proxyA=
new Bd;this.proxyB=new Bd;this.sweepA=new Cb;this.sweepB=new Cb};$e.__name__=["box2D","collision","B2TOIInput"];$e.prototype={__class__:$e};var kb=function(a,b){this.position=new t;this.R=new ha;null!=a&&(this.position.setV(a),this.R.setM(b))};kb.__name__=["box2D","common","math","B2Transform"];kb.prototype={initialize:function(a,b){this.position.setV(a);this.R.setM(b)},setIdentity:function(){this.position.setZero();this.R.setIdentity()},set:function(a){this.position.setV(a.position);this.R.setM(a.R)},
getAngle:function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},__class__:kb};var ha=function(){this.col1=new t(0,1);this.col2=new t(0,1)};ha.__name__=["box2D","common","math","B2Mat22"];ha.fromAngle=function(a){var b=new ha;b.set(a);return b};ha.fromVV=function(a,b){var c=new ha;c.setVV(a,b);return c};ha.prototype={set:function(a){var b=Math.cos(a);a=Math.sin(a);this.col1.x=b;this.col2.x=-a;this.col1.y=a;this.col2.y=b},setVV:function(a,b){this.col1.setV(a);this.col2.setV(b)},copy:function(){var a=
new ha;a.setM(this);return a},setM:function(a){this.col1.setV(a.col1);this.col2.setV(a.col2)},addM:function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y},setIdentity:function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1},setZero:function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0},getAngle:function(){return Math.atan2(this.col1.y,this.col1.x)},getInverse:function(a){var b=this.col1.x,c=this.col2.x,d=this.col1.y,e=this.col2.y,
f=b*e-c*d;0!=f&&(f=1/f);a.col1.x=f*e;a.col2.x=-f*c;a.col1.y=-f*d;a.col2.y=f*b;return a},solve:function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,k=d*g-e*f;0!=k&&(k=1/k);a.x=k*(g*b-e*c);a.y=k*(d*c-f*b);return a},abs:function(){this.col1.abs();this.col2.abs()},__class__:ha};var D=function(){};D.__name__=["box2D","collision","B2TimeOfImpact"];D.timeOfImpact=function(a){++D.b2_toiCalls;var b=a.proxyA,c=a.proxyB,d=a.sweepA,e=a.sweepB;v.b2Assert(d.t0==e.t0);v.b2Assert(1-d.t0>Number.MIN_VALUE);
var f=b.m_radius+c.m_radius;a=a.tolerance;var g=0,k=0,h=0;D.s_cache.count=0;for(D.s_distanceInput.useRadii=!1;;){d.getTransform(D.s_xfA,g);e.getTransform(D.s_xfB,g);D.s_distanceInput.proxyA=b;D.s_distanceInput.proxyB=c;D.s_distanceInput.transformA=D.s_xfA;D.s_distanceInput.transformB=D.s_xfB;Xa.distance(D.s_distanceOutput,D.s_cache,D.s_distanceInput);if(0>=D.s_distanceOutput.distance){g=1;break}D.s_fcn.initialize(D.s_cache,b,D.s_xfA,c,D.s_xfB);var l=D.s_fcn.evaluate(D.s_xfA,D.s_xfB);if(0>=l){g=1;
break}0==k&&(h=l>f?q.max(f-a,0.75*f):q.max(l-a,0.02*f));if(l-h<0.5*a){if(0==k){g=1;break}break}var x=g,u=g,m=1;d.getTransform(D.s_xfA,m);e.getTransform(D.s_xfB,m);var n=D.s_fcn.evaluate(D.s_xfA,D.s_xfB);if(n>=h){g=1;break}for(var r=0;;){var t;t=0!=(r&1)?u+(h-l)*(m-u)/(n-l):0.5*(u+m);d.getTransform(D.s_xfA,t);e.getTransform(D.s_xfB,t);var p=D.s_fcn.evaluate(D.s_xfA,D.s_xfB);if(q.abs(p-h)<0.025*a){x=t;break}p>h?(u=t,l=p):(m=t,n=p);++r;++D.b2_toiRootIters;if(50==r)break}D.b2_toiMaxRootIters=q.max(D.b2_toiMaxRootIters,
r)|0;if(x<(1+100*Number.MIN_VALUE)*g)break;g=x;++k;++D.b2_toiIters;if(1E3==k)break}D.b2_toiMaxIters=q.max(D.b2_toiMaxIters,k)|0;return g};var af=function(){this.m_normal=new t;this.m_points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new t}};af.__name__=["box2D","collision","B2WorldManifold"];af.prototype={initialize:function(a,b,c,d,e){if(0!=a.m_pointCount){var f,g,k,h,l,x,u;switch(a.m_type[1]){case 0:g=b.R;f=a.m_localPoint;k=b.position.x+g.col1.x*f.x+g.col2.x*f.y;h=
b.position.y+g.col1.y*f.x+g.col2.y*f.y;g=d.R;f=a.m_points[0].m_localPoint;a=d.position.x+g.col1.x*f.x+g.col2.x*f.y;f=d.position.y+g.col1.y*f.x+g.col2.y*f.y;g=a-k;d=f-h;l=g*g+d*d;l>Number.MIN_VALUE*Number.MIN_VALUE?(l=Math.sqrt(l),this.m_normal.x=g/l,this.m_normal.y=d/l):(this.m_normal.x=1,this.m_normal.y=0);g=h+c*this.m_normal.y;f-=e*this.m_normal.y;this.m_points[0].x=0.5*(k+c*this.m_normal.x+(a-e*this.m_normal.x));this.m_points[0].y=0.5*(g+f);break;case 1:g=b.R;f=a.m_localPlaneNormal;k=g.col1.x*
f.x+g.col2.x*f.y;h=g.col1.y*f.x+g.col2.y*f.y;g=b.R;f=a.m_localPoint;l=b.position.x+g.col1.x*f.x+g.col2.x*f.y;x=b.position.y+g.col1.y*f.x+g.col2.y*f.y;this.m_normal.x=k;this.m_normal.y=h;b=0;for(var m=a.m_pointCount;b<m;){var q=b++;g=d.R;f=a.m_points[q].m_localPoint;u=d.position.x+g.col1.x*f.x+g.col2.x*f.y;f=d.position.y+g.col1.y*f.x+g.col2.y*f.y;this.m_points[q].x=u+0.5*(c-(u-l)*k-(f-x)*h-e)*k;this.m_points[q].y=f+0.5*(c-(u-l)*k-(f-x)*h-e)*h}break;case 2:for(g=d.R,f=a.m_localPlaneNormal,k=g.col1.x*
f.x+g.col2.x*f.y,h=g.col1.y*f.x+g.col2.y*f.y,g=d.R,f=a.m_localPoint,l=d.position.x+g.col1.x*f.x+g.col2.x*f.y,x=d.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_normal.x=-k,this.m_normal.y=-h,d=0,m=a.m_pointCount;d<m;)q=d++,g=b.R,f=a.m_points[q].m_localPoint,u=b.position.x+g.col1.x*f.x+g.col2.x*f.y,f=b.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_points[q].x=u+0.5*(e-(u-l)*k-(f-x)*h-c)*k,this.m_points[q].y=f+0.5*(e-(u-l)*k-(f-x)*h-c)*h}}},__class__:af};var va=function(){this.m_type=Y.UNKNOWN_SHAPE;this.m_radius=
v.b2_linearSlop};va.__name__=["box2D","collision","shapes","B2Shape"];va.testOverlap=function(a,b,c,d){return!0};va.prototype={copy:function(){return null},set:function(a){this.m_radius=a.m_radius},getType:function(){return this.m_type},testPoint:function(a,b){return!1},rayCast:function(a,b,c){return!1},computeAABB:function(a,b){},computeMass:function(a,b){},computeSubmergedArea:function(a,b,c,d){return 0},__class__:va};var Ya=function(a){null==a&&(a=0);va.call(this);this.m_p=new t;this.m_type=Y.CIRCLE_SHAPE;
this.m_radius=a};Ya.__name__=["box2D","collision","shapes","B2CircleShape"];Ya.__super__=va;Ya.prototype=p(va.prototype,{copy:function(){var a=new Ya;a.set(this);return a},set:function(a){va.prototype.set.call(this,a);C.__instanceof(a,Ya)&&(a=C.__cast(a,Ya),this.m_p.setV(a.m_p))},testPoint:function(a,b){var c=a.R,d=a.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),c=a.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y),d=b.x-d,c=b.y-c;return d*d+c*c<=this.m_radius*this.m_radius},rayCast:function(a,
b,c){var d=c.R,e=b.p1.x-(c.position.x+(d.col1.x*this.m_p.x+d.col2.x*this.m_p.y));c=b.p1.y-(c.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y));var d=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y,g=e*d+c*f,k=d*d+f*f,h=g*g-k*(e*e+c*c-this.m_radius*this.m_radius);if(0>h||k<Number.MIN_VALUE)return!1;g=-(g+Math.sqrt(h));return 0<=g&&g<=b.maxFraction*k?(g/=k,a.fraction=g,a.normal.x=e+g*d,a.normal.y=c+g*f,a.normal.normalize(),!0):!1},computeAABB:function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),
c=b.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);a.lowerBound.set(d-this.m_radius,c-this.m_radius);a.upperBound.set(d+this.m_radius,c+this.m_radius)},computeMass:function(a,b){a.mass=b*v.b2_pi*this.m_radius*this.m_radius;a.center.setV(this.m_p);a.I=a.mass*(0.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},computeSubmergedArea:function(a,b,c,d){c=q.mulX(c,this.m_p);var e=-(q.dot(a,c)-b);if(e<-this.m_radius+Number.MIN_VALUE)return 0;if(e>this.m_radius)return d.setV(c),
Math.PI*this.m_radius*this.m_radius;b=this.m_radius*this.m_radius;var f=e*e,e=b*(Math.asin(e/this.m_radius)+Math.PI/2)+e*Math.sqrt(b-f);b=-0.6666666666666666*Math.pow(b-f,1.5)/e;d.x=c.x+a.x*b;d.y=c.y+a.y*b;return e},getLocalPosition:function(){return this.m_p},setLocalPosition:function(a){this.m_p.setV(a)},getRadius:function(){return this.m_radius},setRadius:function(a){this.m_radius=a},__class__:Ya});var lc=function(a,b){va.call(this);this.s_supportVec=new t;this.m_v1=new t;this.m_v2=new t;this.m_coreV1=
new t;this.m_coreV2=new t;this.m_normal=new t;this.m_direction=new t;this.m_cornerDir1=new t;this.m_cornerDir2=new t;this.m_type=Y.EDGE_SHAPE;this.m_nextEdge=this.m_prevEdge=null;this.m_v1=a;this.m_v2=b;this.m_direction.set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.normalize();this.m_normal.set(this.m_direction.y,-this.m_direction.x);this.m_coreV1.set(-v.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-v.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+
this.m_v1.y);this.m_coreV2.set(-v.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-v.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.set(-this.m_normal.x,-this.m_normal.y)};lc.__name__=["box2D","collision","shapes","B2EdgeShape"];lc.__super__=va;lc.prototype=p(va.prototype,{testPoint:function(a,b){return!1},rayCast:function(a,b,c){var d,e=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y;d=c.R;var g=c.position.x+(d.col1.x*this.m_v1.x+d.col2.x*
this.m_v1.y),k=c.position.y+(d.col1.y*this.m_v1.x+d.col2.y*this.m_v1.y),h=c.position.y+(d.col1.y*this.m_v2.x+d.col2.y*this.m_v2.y)-k;c=-(c.position.x+(d.col1.x*this.m_v2.x+d.col2.x*this.m_v2.y)-g);d=100*Number.MIN_VALUE;var l=-(e*h+f*c);if(l>d){var g=b.p1.x-g,x=b.p1.y-k,k=g*h+x*c;if(0<=k&&k<=b.maxFraction*l&&(b=-e*x+f*g,-d*l<=b&&b<=l*(1+d)))return a.fraction=k/l,b=Math.sqrt(h*h+c*c),a.normal.x=h/b,a.normal.y=c/b,!0}return!1},computeAABB:function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_v1.x+
c.col2.x*this.m_v1.y),e=b.position.y+(c.col1.y*this.m_v1.x+c.col2.y*this.m_v1.y),f=b.position.x+(c.col1.x*this.m_v2.x+c.col2.x*this.m_v2.y),c=b.position.y+(c.col1.y*this.m_v2.x+c.col2.y*this.m_v2.y);d<f?(a.lowerBound.x=d,a.upperBound.x=f):(a.lowerBound.x=f,a.upperBound.x=d);e<c?(a.lowerBound.y=e,a.upperBound.y=c):(a.lowerBound.y=c,a.upperBound.y=e)},computeMass:function(a,b){a.mass=0;a.center.setV(this.m_v1);a.I=0},computeSubmergedArea:function(a,b,c,d){var e=new t(a.x*b,a.y*b),f=q.mulX(c,this.m_v1);
c=q.mulX(c,this.m_v2);var g=q.dot(a,f)-b;a=q.dot(a,c)-b;if(0<g){if(0<a)return 0;f.x=-a/(g-a)*f.x+g/(g-a)*c.x;f.y=-a/(g-a)*f.y+g/(g-a)*c.y}else 0<a&&(c.x=-a/(g-a)*f.x+g/(g-a)*c.x,c.y=-a/(g-a)*f.y+g/(g-a)*c.y);d.x=(e.x+f.x+c.x)/3;d.y=(e.y+f.y+c.y)/3;return 0.5*((f.x-e.x)*(c.y-e.y)-(f.y-e.y)*(c.x-e.x))},getLength:function(){return this.m_length},getVertex1:function(){return this.m_v1},getVertex2:function(){return this.m_v2},getCoreVertex1:function(){return this.m_coreV1},getCoreVertex2:function(){return this.m_coreV2},
getNormalVector:function(){return this.m_normal},getDirectionVector:function(){return this.m_direction},getCorner1Vector:function(){return this.m_cornerDir1},getCorner2Vector:function(){return this.m_cornerDir2},corner1IsConvex:function(){return this.m_cornerConvex1},corner2IsConvex:function(){return this.m_cornerConvex2},getFirstVertex:function(a){var b=a.R;return new t(a.position.x+(b.col1.x*this.m_coreV1.x+b.col2.x*this.m_coreV1.y),a.position.y+(b.col1.y*this.m_coreV1.x+b.col2.y*this.m_coreV1.y))},
getNextEdge:function(){return this.m_nextEdge},getPrevEdge:function(){return this.m_prevEdge},support:function(a,b,c){var d=a.R,e=a.position.x+(d.col1.x*this.m_coreV1.x+d.col2.x*this.m_coreV1.y),f=a.position.y+(d.col1.y*this.m_coreV1.x+d.col2.y*this.m_coreV1.y),g=a.position.x+(d.col1.x*this.m_coreV2.x+d.col2.x*this.m_coreV2.y);a=a.position.y+(d.col1.y*this.m_coreV2.x+d.col2.y*this.m_coreV2.y);e*b+f*c>g*b+a*c?(this.s_supportVec.x=e,this.s_supportVec.y=f):(this.s_supportVec.x=g,this.s_supportVec.y=
a);return this.s_supportVec},setPrevEdge:function(a,b,c,d){this.m_prevEdge=a;this.m_coreV1=b;this.m_cornerDir1=c;this.m_cornerConvex1=d},setNextEdge:function(a,b,c,d){this.m_nextEdge=a;this.m_coreV2=b;this.m_cornerDir2=c;this.m_cornerConvex2=d},__class__:lc});var Ed=function(){this.mass=0;this.center=new t(0,0);this.I=0};Ed.__name__=["box2D","collision","shapes","B2MassData"];Ed.prototype={__class__:Ed};var oa=function(){va.call(this);this.m_type=Y.POLYGON_SHAPE;this.m_centroid=new t;this.m_vertices=
[];this.m_normals=[]};oa.__name__=["box2D","collision","shapes","B2PolygonShape"];oa.asArray=function(a,b){var c=new oa;c.setAsArray(a,b);return c};oa.asVector=function(a,b){var c=new oa;c.setAsVector(a,b);return c};oa.asBox=function(a,b){var c=new oa;c.setAsBox(a,b);return c};oa.asOrientedBox=function(a,b,c,d){null==d&&(d=0);var e=new oa;e.setAsOrientedBox(a,b,c,d);return e};oa.asEdge=function(a,b){var c=new oa;c.setAsEdge(a,b);return c};oa.computeCentroid=function(a,b){for(var c=new t,d=0,e=0;e<
b;){var f=e++,g=a[f],f=f+1<b?a[f+1|0]:a[0],k=0.5*((g.x-0)*(f.y-0)-(g.y-0)*(f.x-0)),d=d+k;c.x+=0.3333333333333333*k*(0+g.x+f.x);c.y+=0.3333333333333333*k*(0+g.y+f.y)}c.x*=1/d;c.y*=1/d;return c};oa.computeOBB=function(a,b,c){for(var d=[],e=0;e<c;){var f=e++;d[f]=b[f]}d[c]=d[0];b=Number.MAX_VALUE;e=1;for(f=c+1;e<f;){for(var g=e++,k=d[g-1|0],h=d[g].x-k.x,l=d[g].y-k.y,g=Math.sqrt(h*h+l*l),h=h/g,l=l/g,x=-l,u=h,m=g=Number.MAX_VALUE,q=-Number.MAX_VALUE,n=-Number.MAX_VALUE,r=0,t=c;r<t;){var p=r++,s=d[p].x-
k.x,v=d[p].y-k.y,p=h*s+l*v,s=x*s+u*v;p<g&&(g=p);s<m&&(m=s);p>q&&(q=p);s>n&&(n=s)}r=(q-g)*(n-m);r<0.95*b&&(b=r,a.R.col1.x=h,a.R.col1.y=l,a.R.col2.x=x,a.R.col2.y=u,h=0.5*(g+q),l=0.5*(m+n),x=a.R,a.center.x=k.x+(x.col1.x*h+x.col2.x*l),a.center.y=k.y+(x.col1.y*h+x.col2.y*l),a.extents.x=0.5*(q-g),a.extents.y=0.5*(n-m))}};oa.__super__=va;oa.prototype=p(va.prototype,{copy:function(){var a=new oa;a.set(this);return a},set:function(a){va.prototype.set.call(this,a);if(C.__instanceof(a,oa)){a=C.__cast(a,oa);
this.m_centroid.setV(a.m_centroid);this.m_vertexCount=a.m_vertexCount;this.reserve(this.m_vertexCount);for(var b=0,c=this.m_vertexCount;b<c;){var d=b++;this.m_vertices[d].setV(a.m_vertices[d]);this.m_normals[d].setV(a.m_normals[d])}}},setAsArray:function(a,b){null==b&&(b=0);for(var c=[],d=0;d<a.length;){var e=a[d];++d;c.push(e)}this.setAsVector(c,b)},setAsVector:function(a,b){null==b&&(b=0);0==b&&(b=a.length);v.b2Assert(2<=b);this.m_vertexCount=b|0;this.reserve(b|0);for(var c=0,d=this.m_vertexCount;c<
d;){var e=c++;this.m_vertices[e].setV(a[e])}c=0;for(d=this.m_vertexCount;c<d;){var e=c++,f=q.subtractVV(this.m_vertices[e+1<this.m_vertexCount?e+1:0],this.m_vertices[e]);v.b2Assert(f.lengthSquared()>Number.MIN_VALUE);this.m_normals[e].setV(q.crossVF(f,1));this.m_normals[e].normalize()}this.m_centroid=oa.computeCentroid(this.m_vertices,this.m_vertexCount)},setAsBox:function(a,b){this.m_vertexCount=4;this.reserve(4);this.m_vertices[0].set(-a,-b);this.m_vertices[1].set(a,-b);this.m_vertices[2].set(a,
b);this.m_vertices[3].set(-a,b);this.m_normals[0].set(0,-1);this.m_normals[1].set(1,0);this.m_normals[2].set(0,1);this.m_normals[3].set(-1,0);this.m_centroid.setZero()},setAsOrientedBox:function(a,b,c,d){null==d&&(d=0);this.m_vertexCount=4;this.reserve(4);this.m_vertices[0].set(-a,-b);this.m_vertices[1].set(a,-b);this.m_vertices[2].set(a,b);this.m_vertices[3].set(-a,b);this.m_normals[0].set(0,-1);this.m_normals[1].set(1,0);this.m_normals[2].set(0,1);this.m_normals[3].set(-1,0);this.m_centroid=c;a=
new kb;a.position=c;a.R.set(d);c=0;for(d=this.m_vertexCount;c<d;)b=c++,this.m_vertices[b]=q.mulX(a,this.m_vertices[b]),this.m_normals[b]=q.mulMV(a.R,this.m_normals[b])},setAsEdge:function(a,b){this.m_vertexCount=2;this.reserve(2);this.m_vertices[0].setV(a);this.m_vertices[1].setV(b);this.m_centroid.x=0.5*(a.x+b.x);this.m_centroid.y=0.5*(a.y+b.y);this.m_normals[0]=q.crossVF(q.subtractVV(b,a),1);this.m_normals[0].normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y},
testPoint:function(a,b){var c;c=a.R;for(var d=b.x-a.position.x,e=b.y-a.position.y,f=d*c.col1.x+e*c.col1.y,g=d*c.col2.x+e*c.col2.y,k=0,h=this.m_vertexCount;k<h;){var l=k++;c=this.m_vertices[l];d=f-c.x;e=g-c.y;c=this.m_normals[l];if(0<c.x*d+c.y*e)return!1}return!0},rayCast:function(a,b,c){var d=0,e=b.maxFraction,f,g,k,h;f=b.p1.x-c.position.x;g=b.p1.y-c.position.y;k=c.R;var l=f*k.col1.x+g*k.col1.y,x=f*k.col2.x+g*k.col2.y;f=b.p2.x-c.position.x;g=b.p2.y-c.position.y;k=c.R;b=f*k.col1.x+g*k.col1.y-l;k=f*
k.col2.x+g*k.col2.y-x;for(var u=-1,m=0,q=this.m_vertexCount;m<q;){var n=m++;h=this.m_vertices[n];f=h.x-l;g=h.y-x;h=this.m_normals[n];f=h.x*f+h.y*g;g=h.x*b+h.y*k;if(0==g){if(0>f)return!1}else 0>g&&f<d*g?(d=f/g,u=n):0<g&&f<e*g&&(e=f/g);if(e<d-Number.MIN_VALUE)return!1}return 0<=u?(a.fraction=d,k=c.R,h=this.m_normals[u],a.normal.x=k.col1.x*h.x+k.col2.x*h.y,a.normal.y=k.col1.y*h.x+k.col2.y*h.y,!0):!1},computeAABB:function(a,b){for(var c=b.R,d=this.m_vertices[0],e=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),
f=b.position.y+(c.col1.y*d.x+c.col2.y*d.y),g=e,k=f,h=1,l=this.m_vertexCount;h<l;){var x=h++,d=this.m_vertices[x],x=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),d=b.position.y+(c.col1.y*d.x+c.col2.y*d.y);e<x||(e=x);f<d||(f=d);g>x||(g=x);k>d||(k=d)}a.lowerBound.x=e-this.m_radius;a.lowerBound.y=f-this.m_radius;a.upperBound.x=g+this.m_radius;a.upperBound.y=k+this.m_radius},computeMass:function(a,b){if(2==this.m_vertexCount)a.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=0.5*(this.m_vertices[0].y+
this.m_vertices[1].y),a.mass=0,a.I=0;else{for(var c=0,d=0,e=0,f=0,g=0,k=this.m_vertexCount;g<k;)var h=g++,l=this.m_vertices[h],x=h+1<this.m_vertexCount?this.m_vertices[h+1|0]:this.m_vertices[0],u=l.x-0,m=l.y-0,q=x.x-0,n=x.y-0,h=u*n-m*q,r=0.5*h,e=e+r,c=c+0.3333333333333333*r*(0+l.x+x.x),d=d+0.3333333333333333*r*(0+l.y+x.y),l=u,f=f+h*(0.3333333333333333*(0.25*(l*l+q*l+q*q)+(0*l+0*q))+0+(0.3333333333333333*(0.25*(m*m+n*m+n*n)+(0*m+0*n))+0));a.mass=b*e;a.center.set(c*(1/e),d*(1/e));a.I=b*f}},computeSubmergedArea:function(a,
b,c,d){var e=q.mulTMV(c.R,a),f=b-q.dot(a,c.position),g=[],k=0;a=b=-1;for(var h=!1,l=0,x=this.m_vertexCount;l<x;){var u=l++;g[u]=q.dot(e,this.m_vertices[u])-f;var m=g[u]<-Number.MIN_VALUE;0<u&&(m?h||(b=u-1,++k):h&&(a=u-1,++k));h=m}switch(k){case 0:return h?(a=new Ed,this.computeMass(a,1),d.setV(q.mulX(c,a.center)),a.mass):0;case 1:-1==b?b=this.m_vertexCount-1:a=this.m_vertexCount-1}f=(b+1)%this.m_vertexCount;e=(a+1)%this.m_vertexCount;k=(0-g[b])/(g[f]-g[b]);g=(0-g[a])/(g[e]-g[a]);b=new t(this.m_vertices[b].x*
(1-k)+this.m_vertices[f].x*k,this.m_vertices[b].y*(1-k)+this.m_vertices[f].y*k);a=new t(this.m_vertices[a].x*(1-g)+this.m_vertices[e].x*g,this.m_vertices[a].y*(1-g)+this.m_vertices[e].y*g);g=0;k=new t;for(h=this.m_vertices[f];f!=e;)f=(f+1)%this.m_vertexCount,l=f==e?a:this.m_vertices[f],x=0.5*((h.x-b.x)*(l.y-b.y)-(h.y-b.y)*(l.x-b.x)),g+=x,k.x+=x*(b.x+h.x+l.x)/3,k.y+=x*(b.y+h.y+l.y)/3,h=l;k.multiply(1/g);d.setV(q.mulX(c,k));return g},getVertexCount:function(){return this.m_vertexCount},getVertices:function(){return this.m_vertices},
getNormals:function(){return this.m_normals},getSupport:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_vertexCount;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return b},getSupportVertex:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_vertexCount;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return this.m_vertices[b]},validate:function(){return!1},
reserve:function(a){for(var b=this.m_vertices.length;b<a;){var c=b++;this.m_vertices[c]=new t;this.m_normals[c]=new t}},__class__:oa});var Y={__ename__:!0,__constructs__:["UNKNOWN_SHAPE","CIRCLE_SHAPE","POLYGON_SHAPE","EDGE_SHAPE"],UNKNOWN_SHAPE:["UNKNOWN_SHAPE",0]};Y.UNKNOWN_SHAPE.__enum__=Y;Y.CIRCLE_SHAPE=["CIRCLE_SHAPE",1];Y.CIRCLE_SHAPE.__enum__=Y;Y.POLYGON_SHAPE=["POLYGON_SHAPE",2];Y.POLYGON_SHAPE.__enum__=Y;Y.EDGE_SHAPE=["EDGE_SHAPE",3];Y.EDGE_SHAPE.__enum__=Y;Y.__empty_constructs__=[Y.UNKNOWN_SHAPE,
Y.CIRCLE_SHAPE,Y.POLYGON_SHAPE,Y.EDGE_SHAPE];var Fd=function(a,b,c){this._r=255*q.clamp(a,0,1)|0;this._g=255*q.clamp(b,0,1)|0;this._b=255*q.clamp(c,0,1)|0};Fd.__name__=["box2D","common","B2Color"];Fd.prototype={set:function(a,b,c){this._r=255*q.clamp(a,0,1)|0;this._g=255*q.clamp(b,0,1)|0;this._b=255*q.clamp(c,0,1)|0},toHex:function(){return"#"+this.componentToHex(this._r)+this.componentToHex(this._g)+this.componentToHex(this._b)},componentToHex:function(a){a=a.toString(16);return"1"==a.length?"0"+
a:a},set_r:function(a){return this._r=255*q.clamp(a,0,1)|0},set_g:function(a){return this._g=255*q.clamp(a,0,1)|0},set_b:function(a){return this._b=255*q.clamp(a,0,1)|0},get_r:function(){return this._r},get_g:function(){return this._g},get_b:function(){return this._b},get_color:function(){return this._r<<16|this._g<<8|this._b},__class__:Fd,__properties__:{get_color:"get_color",set_b:"set_b",set_g:"set_g",set_r:"set_r"}};var v=function(){};v.__name__=["box2D","common","B2Settings"];v.b2MixFriction=
function(a,b){return Math.sqrt(a*b)};v.b2MixRestitution=function(a,b){return a>b?a:b};v.b2Assert=function(a){if(!a)throw new K("Assertion Failed");};var Vb=function(a,b,c){this.col1=new Ka;this.col2=new Ka;this.col3=new Ka;null==a&&null==b&&null==c?(this.col1.setZero(),this.col2.setZero(),this.col3.setZero()):(this.col1.setV(a),this.col2.setV(b),this.col3.setV(c))};Vb.__name__=["box2D","common","math","B2Mat33"];Vb.prototype={setVVV:function(a,b,c){this.col1.setV(a);this.col2.setV(b);this.col3.setV(c)},
copy:function(){return new Vb(this.col1,this.col2,this.col3)},setM:function(a){this.col1.setV(a.col1);this.col2.setV(a.col2);this.col3.setV(a.col3)},addM:function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col1.z+=a.col1.z;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y;this.col2.z+=a.col2.z;this.col3.x+=a.col3.x;this.col3.y+=a.col3.y;this.col3.z+=a.col3.z},setIdentity:function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=
1},setZero:function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0},solve22:function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,k=d*g-e*f;0!=k&&(k=1/k);a.x=k*(g*b-e*c);a.y=k*(d*c-f*b);return a},solve33:function(a,b,c,d){var e=this.col1.x,f=this.col1.y,g=this.col1.z,k=this.col2.x,h=this.col2.y,l=this.col2.z,x=this.col3.x,u=this.col3.y,m=this.col3.z,q=e*(h*m-l*u)+f*(l*x-k*m)+g*(k*u-h*x);0!=q&&(q=
1/q);a.x=q*(b*(h*m-l*u)+c*(l*x-k*m)+d*(k*u-h*x));a.y=q*(e*(c*m-d*u)+f*(d*x-b*m)+g*(b*u-c*x));a.z=q*(e*(h*d-l*c)+f*(l*b-k*d)+g*(k*c-h*b));return a},__class__:Vb};var q=function(){};q.__name__=["box2D","common","math","B2Math"];q.__properties__={get_MAX_VALUE:"get_MAX_VALUE",get_MIN_VALUE:"get_MIN_VALUE"};q.isValid=function(a){return isNaN(a)||-Infinity==a||Infinity==a?!1:!0};q.dot=function(a,b){return a.x*b.x+a.y*b.y};q.crossVV=function(a,b){return a.x*b.y-a.y*b.x};q.crossVF=function(a,b){return new t(b*
a.y,-b*a.x)};q.crossFV=function(a,b){return new t(-a*b.y,a*b.x)};q.mulMV=function(a,b){return new t(a.col1.x*b.x+a.col2.x*b.y,a.col1.y*b.x+a.col2.y*b.y)};q.mulTMV=function(a,b){return new t(q.dot(b,a.col1),q.dot(b,a.col2))};q.mulX=function(a,b){var c=q.mulMV(a.R,b);c.x+=a.position.x;c.y+=a.position.y;return c};q.mulXT=function(a,b){var c=q.subtractVV(b,a.position),d=c.x*a.R.col1.x+c.y*a.R.col1.y;c.y=c.x*a.R.col2.x+c.y*a.R.col2.y;c.x=d;return c};q.addVV=function(a,b){return new t(a.x+b.x,a.y+b.y)};
q.subtractVV=function(a,b){return new t(a.x-b.x,a.y-b.y)};q.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)};q.distanceSquared=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};q.mulFV=function(a,b){return new t(a*b.x,a*b.y)};q.addMM=function(a,b){return ha.fromVV(q.addVV(a.col1,b.col1),q.addVV(a.col2,b.col2))};q.mulMM=function(a,b){return ha.fromVV(q.mulMV(a,b.col1),q.mulMV(a,b.col2))};q.mulTMM=function(a,b){var c=new t(q.dot(a.col1,b.col1),q.dot(a.col2,b.col1)),d=new t(q.dot(a.col1,
b.col2),q.dot(a.col2,b.col2));return ha.fromVV(c,d)};q.abs=function(a){return 0<a?a:-a};q.absV=function(a){return new t(q.abs(a.x),q.abs(a.y))};q.absM=function(a){return ha.fromVV(q.absV(a.col1),q.absV(a.col2))};q.min=function(a,b){return a<b?a:b};q.minV=function(a,b){return new t(q.min(a.x,b.x),q.min(a.y,b.y))};q.max=function(a,b){return a>b?a:b};q.maxV=function(a,b){return new t(q.max(a.x,b.x),q.max(a.y,b.y))};q.clamp=function(a,b,c){return a<b?b:a>c?c:a};q.clampV=function(a,b,c){return q.maxV(b,
q.minV(a,c))};q.swap=function(a,b){var c=a[0];a[0]=b[0];b[0]=c};q.random=function(){return 2*Math.random()-1};q.randomRange=function(a,b){var c=Math.random();return(b-a)*c+a};q.nextPowerOfTwo=function(a){a|=a>>1&2147483647;a|=a>>2&1073741823;a|=a>>4&268435455;a|=a>>8&16777215;return(a|a>>16&65535)+1};q.isPowerOfTwo=function(a){return 0<a&&0==(a&a-1)};q.get_MIN_VALUE=function(){return Number.MIN_VALUE};q.get_MAX_VALUE=function(){return Number.MAX_VALUE};var Cb=function(){this.localCenter=new t;this.c0=
new t;this.c=new t};Cb.__name__=["box2D","common","math","B2Sweep"];Cb.prototype={set:function(a){this.localCenter.setV(a.localCenter);this.c0.setV(a.c0);this.c.setV(a.c);this.a0=a.a0;this.a=a.a;this.t0=a.t0},copy:function(){var a=new Cb;a.localCenter.setV(this.localCenter);a.c0.setV(this.c0);a.c.setV(this.c);a.a0=this.a0;a.a=this.a;a.t0=this.t0;return a},getTransform:function(a,b){a.position.x=(1-b)*this.c0.x+b*this.c.x;a.position.y=(1-b)*this.c0.y+b*this.c.y;a.R.set((1-b)*this.a0+b*this.a);var c=
a.R;a.position.x-=c.col1.x*this.localCenter.x+c.col2.x*this.localCenter.y;a.position.y-=c.col1.y*this.localCenter.x+c.col2.y*this.localCenter.y},advance:function(a){if(this.t0<a&&1-this.t0>Number.MIN_VALUE){var b=(a-this.t0)/(1-this.t0);this.c0.x=(1-b)*this.c0.x+b*this.c.x;this.c0.y=(1-b)*this.c0.y+b*this.c.y;this.a0=(1-b)*this.a0+b*this.a;this.t0=a}},__class__:Cb};var Ka=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c};Ka.__name__=["box2D","common","math",
"B2Vec3"];Ka.prototype={setZero:function(){this.x=this.y=this.z=0},set:function(a,b,c){this.x=a;this.y=b;this.z=c},setV:function(a){this.x=a.x;this.y=a.y;this.z=a.z},getNegative:function(){return new Ka(-this.x,-this.y,-this.z)},negativeSelf:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z},copy:function(){return new Ka(this.x,this.y,this.z)},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z},subtract:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z},multiply:function(a){this.x*=a;this.y*=
a;this.z*=a},__class__:Ka};var A=function(a,b){this.m_xf=new kb;this.m_sweep=new Cb;this.m_linearVelocity=new t;this.m_force=new t;this.m_flags=0;a.bullet&&(this.m_flags|=A.e_bulletFlag);a.fixedRotation&&(this.m_flags|=A.e_fixedRotationFlag);a.allowSleep&&(this.m_flags|=A.e_allowSleepFlag);a.awake&&(this.m_flags|=A.e_awakeFlag);a.active&&(this.m_flags|=A.e_activeFlag);this.m_world=b;this.m_xf.position.setV(a.position);this.m_xf.R.set(a.angle);this.m_sweep.localCenter.setZero();this.m_sweep.t0=1;this.m_sweep.a0=
this.m_sweep.a=a.angle;var c=this.m_xf.R,d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.setV(this.m_sweep.c);this.m_contactList=this.m_controllerList=this.m_jointList=null;this.m_controllerCount=0;this.m_next=this.m_prev=null;this.m_linearVelocity.setV(a.linearVelocity);this.m_angularVelocity=a.angularVelocity;this.m_linearDamping=a.linearDamping;
this.m_angularDamping=a.angularDamping;this.m_force.set(0,0);this.m_sleepTime=this.m_torque=0;this.m_type=a.type;this.m_invMass=this.m_type==A.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_inertiaScale=a.inertiaScale;this.m_userData=a.userData;this.m_fixtureList=null;this.m_fixtureCount=0};A.__name__=["box2D","dynamics","B2Body"];A.prototype={connectEdges:function(a,b,c){var d=Math.atan2(b.getDirectionVector().y,b.getDirectionVector().x);c=Math.tan(0.5*(d-c));c=q.mulFV(c,
b.getDirectionVector());c=q.subtractVV(c,b.getNormalVector());c=q.mulFV(v.b2_toiSlop,c);c=q.addVV(c,b.getVertex1());var e=q.addVV(a.getDirectionVector(),b.getDirectionVector());e.normalize();var f=0<q.dot(a.getDirectionVector(),b.getNormalVector());a.setNextEdge(b,c,e,f);b.setPrevEdge(a,c,e,f);return d},createFixture:function(a){if(!0==this.m_world.isLocked())return null;var b=new ub;b.create(this,this.m_xf,a);0!=(this.m_flags&A.e_activeFlag)&&b.createProxy(this.m_world.m_contactManager.m_broadPhase,
this.m_xf);b.m_next=this.m_fixtureList;this.m_fixtureList=b;++this.m_fixtureCount;b.m_body=this;0<b.m_density&&this.resetMassData();this.m_world.m_flags|=ca.e_newFixture;return b},createFixture2:function(a,b){null==b&&(b=0);var c=new bf;c.shape=a;c.density=b;return this.createFixture(c)},DestroyFixture:function(a){if(!0!=this.m_world.isLocked()){for(var b=this.m_fixtureList,c=null;null!=b;){if(b==a){null!=c?c.m_next=a.m_next:this.m_fixtureList=a.m_next;break}c=b;b=b.m_next}for(b=this.m_contactList;null!=
b;){var c=b.contact,b=b.next,d=c.getFixtureA(),e=c.getFixtureB();a!=d&&a!=e||this.m_world.m_contactManager.destroy(c)}0!=(this.m_flags&A.e_activeFlag)&&a.destroyProxy(this.m_world.m_contactManager.m_broadPhase);a.destroy();a.m_body=null;a.m_next=null;--this.m_fixtureCount;this.resetMassData()}},setPositionAndAngle:function(a,b){var c;if(!0!=this.m_world.isLocked()){this.m_xf.R.set(b);this.m_xf.position.setV(a);c=this.m_xf.R;var d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;
this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.setV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=b;d=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;null!=c;)c.synchronize(d,this.m_xf,this.m_xf),c=c.m_next;this.m_world.m_contactManager.findNewContacts()}},setTransform:function(a){this.setPositionAndAngle(a.position,a.getAngle())},getTransform:function(){return this.m_xf},getPosition:function(){return this.m_xf.position},
setPosition:function(a){this.setPositionAndAngle(a,this.getAngle())},getAngle:function(){return this.m_sweep.a},setAngle:function(a){this.setPositionAndAngle(this.getPosition(),a)},getWorldCenter:function(){return this.m_sweep.c},getLocalCenter:function(){return this.m_sweep.localCenter},setLinearVelocity:function(a){this.m_type!=A.b2_staticBody&&this.m_linearVelocity.setV(a)},getLinearVelocity:function(){return this.m_linearVelocity},setAngularVelocity:function(a){this.m_type!=A.b2_staticBody&&(this.m_angularVelocity=
a)},getAngularVelocity:function(){return this.m_angularVelocity},getDefinition:function(){var a=new Gd;a.type=this.getType();a.allowSleep=(this.m_flags&A.e_allowSleepFlag)==A.e_allowSleepFlag;a.angle=this.getAngle();a.angularDamping=this.m_angularDamping;a.angularVelocity=this.m_angularVelocity;a.fixedRotation=(this.m_flags&A.e_fixedRotationFlag)==A.e_fixedRotationFlag;a.bullet=(this.m_flags&A.e_bulletFlag)==A.e_bulletFlag;a.awake=(this.m_flags&A.e_awakeFlag)==A.e_awakeFlag;a.linearDamping=this.m_linearDamping;
a.linearVelocity.setV(this.getLinearVelocity());a.position=this.getPosition();a.userData=this.getUserData();return a},applyForce:function(a,b){this.m_type==A.b2_dynamicBody&&(!1==this.isAwake()&&this.setAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)},applyTorque:function(a){this.m_type==A.b2_dynamicBody&&(!1==this.isAwake()&&this.setAwake(!0),this.m_torque+=a)},applyImpulse:function(a,b){this.m_type==A.b2_dynamicBody&&(!1==this.isAwake()&&
this.setAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x))},split:function(a){for(var b=this.getLinearVelocity().copy(),c=this.getAngularVelocity(),d=this.getWorldCenter(),e=this.m_world.createBody(this.getDefinition()),f=null,g=this.m_fixtureList;null!=g;)if(a(g)){var k=g.m_next;null!=f?f.m_next=k:this.m_fixtureList=k;this.m_fixtureCount--;g.m_next=e.m_fixtureList;
e.m_fixtureList=g;e.m_fixtureCount++;g.m_body=e;g=k}else f=g,g=g.m_next;this.resetMassData();e.resetMassData();f=this.getWorldCenter();a=e.getWorldCenter();f=q.addVV(b,q.crossFV(c,q.subtractVV(f,d)));b=q.addVV(b,q.crossFV(c,q.subtractVV(a,d)));this.setLinearVelocity(f);e.setLinearVelocity(b);this.setAngularVelocity(c);e.setAngularVelocity(c);this.synchronizeFixtures();e.synchronizeFixtures();return e},merge:function(a){for(var b=a.m_fixtureList;null!=b;){var c=b.m_next;a.m_fixtureCount--;b.m_next=
this.m_fixtureList;this.m_fixtureList=b;this.m_fixtureCount++;b.m_body=a;b=c}this.m_fixtureCount=0;this.getWorldCenter();a.getWorldCenter();this.getLinearVelocity().copy();a.getLinearVelocity().copy();this.getAngularVelocity();a.getAngularVelocity();this.resetMassData();this.synchronizeFixtures()},getMass:function(){return this.m_mass},getInertia:function(){return this.m_I},getMassData:function(a){a.mass=this.m_mass;a.I=this.m_I;a.center.setV(this.m_sweep.localCenter)},setMassData:function(a){v.b2Assert(!1==
this.m_world.isLocked());if(!0!=this.m_world.isLocked()&&this.m_type==A.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=a.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<a.I&&0==(this.m_flags&A.e_fixedRotationFlag)&&(this.m_I=a.I-this.m_mass*(a.center.x*a.center.x+a.center.y*a.center.y),this.m_invI=1/this.m_I);var b=this.m_sweep.c.copy();this.m_sweep.localCenter.setV(a.center);this.m_sweep.c0.setV(q.mulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.setV(this.m_sweep.c0);
this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-b.y);this.m_linearVelocity.y+=this.m_angularVelocity*(this.m_sweep.c.x-b.x)}},resetMassData:function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.setZero();if(this.m_type!=A.b2_staticBody&&this.m_type!=A.b2_kinematicBody){for(var a=t.make(0,0),b=this.m_fixtureList;null!=b;)if(0!=b.m_density){var c=b.getMassData();this.m_mass+=c.mass;a.x+=c.center.x*c.mass;a.y+=c.center.y*c.mass;this.m_I+=c.I;b=b.m_next}0<
this.m_mass?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&0==(this.m_flags&A.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(a.x*a.x+a.y*a.y),this.m_I*=this.m_inertiaScale,v.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;b=this.m_sweep.c.copy();this.m_sweep.localCenter.setV(a);this.m_sweep.c0.setV(q.mulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.setV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*
-(this.m_sweep.c.y-b.y);this.m_linearVelocity.y+=this.m_angularVelocity*(this.m_sweep.c.x-b.x)}},getWorldPoint:function(a){var b=this.m_xf.R;a=new t(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return a},getWorldVector:function(a){return q.mulMV(this.m_xf.R,a)},getLocalPoint:function(a){return q.mulXT(this.m_xf,a)},getLocalVector:function(a){return q.mulTMV(this.m_xf.R,a)},getLinearVelocityFromWorldPoint:function(a){return new t(this.m_linearVelocity.x-
this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},getLinearVelocityFromLocalPoint:function(a){var b=this.m_xf.R;a=new t(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return new t(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},getLinearDamping:function(){return this.m_linearDamping},
setLinearDamping:function(a){this.m_linearDamping=a},getAngularDamping:function(){return this.m_angularDamping},setAngularDamping:function(a){this.m_angularDamping=a},setType:function(a){if(this.m_type!=a)for(this.m_type=a,this.resetMassData(),this.m_type==A.b2_staticBody&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0,a=this.m_contactList;null!=a;)a.contact.flagForFiltering(),a=a.next},getType:function(){return this.m_type},setBullet:function(a){this.m_flags=
a?this.m_flags|A.e_bulletFlag:this.m_flags&~A.e_bulletFlag},isBullet:function(){return(this.m_flags&A.e_bulletFlag)==A.e_bulletFlag},setSleepingAllowed:function(a){a?this.m_flags|=A.e_allowSleepFlag:(this.m_flags&=~A.e_allowSleepFlag,this.setAwake(!0))},setAwake:function(a){a?(this.m_flags|=A.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~A.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},isAwake:function(){return(this.m_flags&
A.e_awakeFlag)==A.e_awakeFlag},setFixedRotation:function(a){this.m_flags=a?this.m_flags|A.e_fixedRotationFlag:this.m_flags&~A.e_fixedRotationFlag;this.resetMassData()},isFixedRotation:function(){return(this.m_flags&A.e_fixedRotationFlag)==A.e_fixedRotationFlag},setActive:function(a){if(a!=this.isActive()){var b;if(a)for(this.m_flags|=A.e_activeFlag,a=this.m_world.m_contactManager.m_broadPhase,b=this.m_fixtureList;null!=b;)b.createProxy(a,this.m_xf),b=b.m_next;else{this.m_flags&=~A.e_activeFlag;a=
this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;null!=b;)b.destroyProxy(a),b=b.m_next;for(a=this.m_contactList;null!=a;)b=a,a=a.next,this.m_world.m_contactManager.destroy(b.contact);this.m_contactList=null}}},isActive:function(){return(this.m_flags&A.e_activeFlag)==A.e_activeFlag},isSleepingAllowed:function(){return(this.m_flags&A.e_allowSleepFlag)==A.e_allowSleepFlag},getFixtureList:function(){return this.m_fixtureList},getJointList:function(){return this.m_jointList},getControllerList:function(){return this.m_controllerList},
getContactList:function(){return this.m_contactList},getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},setUserData:function(a){this.m_userData=a},getWorld:function(){return this.m_world},synchronizeFixtures:function(){var a=A.s_xf1;a.R.set(this.m_sweep.a0);var b=a.R,c=this.m_sweep.localCenter;a.position.x=this.m_sweep.c0.x-(b.col1.x*c.x+b.col2.x*c.y);a.position.y=this.m_sweep.c0.y-(b.col1.y*c.x+b.col2.y*c.y);c=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;null!=
b;)b.synchronize(c,a,this.m_xf),b=b.m_next},synchronizeTransform:function(){this.m_xf.R.set(this.m_sweep.a);var a=this.m_xf.R,b=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*b.x+a.col2.x*b.y);this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*b.x+a.col2.y*b.y)},shouldCollide:function(a){if(this.m_type!=A.b2_dynamicBody&&a.m_type!=A.b2_dynamicBody)return!1;for(var b=this.m_jointList;null!=b;){if(b.other==a&&!1==b.joint.m_collideConnected)return!1;b=b.next}return!0},advance:function(a){this.m_sweep.advance(a);
this.m_sweep.c.setV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.synchronizeTransform()},__class__:A};var Gd=function(){this.position=new t;this.linearVelocity=new t;this.userData=null;this.angularDamping=this.linearDamping=this.angularVelocity=this.angle=0;this.awake=this.allowSleep=!0;this.bullet=this.fixedRotation=!1;this.type=A.b2_staticBody;this.active=!0;this.inertiaScale=1};Gd.__name__=["box2D","dynamics","B2BodyDef"];Gd.prototype={__class__:Gd};var Lc=function(){};Lc.__name__=["box2D",
"dynamics","B2ContactFilter"];Lc.prototype={shouldCollide:function(a,b){var c=a.getFilterData(),d=b.getFilterData();return c.groupIndex==d.groupIndex&&0!=c.groupIndex?0<c.groupIndex:0!=(c.maskBits&d.categoryBits)&&0!=(c.categoryBits&d.maskBits)},rayCollide:function(a,b){return null==a?!0:this.shouldCollide(C.__cast(a,ub),b)},__class__:Lc};var cf=function(){this.normalImpulses=[];this.tangentImpulses=[]};cf.__name__=["box2D","dynamics","B2ContactImpulse"];cf.prototype={__class__:cf};var eb=function(){};
eb.__name__=["box2D","dynamics","B2ContactListener"];eb.prototype={beginContact:function(a){},endContact:function(a){},preSolve:function(a,b){},postSolve:function(a,b){},__class__:eb};var Hd=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=Lc.b2_defaultFilter;this.m_contactListener=eb.b2_defaultListener;this.m_contactFactory=new df(this.m_allocator);this.m_broadPhase=new Dd};Hd.__name__=["box2D","dynamics","B2ContactManager"];Hd.prototype={addPair:function(a,b){var c=C.__cast(a,
ub),d=C.__cast(b,ub),e=c.getBody(),f=d.getBody();if(e!=f){for(var g=f.getContactList();null!=g;){if(g.other==e){var k=g.contact.getFixtureA(),h=g.contact.getFixtureB();if(k==c&&h==d||k==d&&h==c)return}g=g.next}!1!=f.shouldCollide(e)&&!1!=this.m_contactFilter.shouldCollide(c,d)&&(g=this.m_contactFactory.create(c,d),c=g.getFixtureA(),d=g.getFixtureB(),e=c.m_body,f=d.m_body,g.m_prev=null,g.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=g),this.m_world.m_contactList=
g,g.m_nodeA.contact=g,g.m_nodeA.other=f,g.m_nodeA.prev=null,g.m_nodeA.next=e.m_contactList,null!=e.m_contactList&&(e.m_contactList.prev=g.m_nodeA),e.m_contactList=g.m_nodeA,g.m_nodeB.contact=g,g.m_nodeB.other=e,g.m_nodeB.prev=null,g.m_nodeB.next=f.m_contactList,null!=f.m_contactList&&(f.m_contactList.prev=g.m_nodeB),f.m_contactList=g.m_nodeB,++this.m_world.m_contactCount)}},findNewContacts:function(){this.m_broadPhase.updatePairs(w(this,this.addPair))},destroy:function(a){var b=a.getFixtureA(),c=
a.getFixtureB(),b=b.getBody(),c=c.getBody();a.isTouching()&&this.m_contactListener.endContact(a);null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_world.m_contactList&&(this.m_world.m_contactList=a.m_next);null!=a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next);null!=a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev);a.m_nodeA==b.m_contactList&&(b.m_contactList=a.m_nodeA.next);null!=a.m_nodeB.prev&&(a.m_nodeB.prev.next=a.m_nodeB.next);null!=a.m_nodeB.next&&
(a.m_nodeB.next.prev=a.m_nodeB.prev);a.m_nodeB==c.m_contactList&&(c.m_contactList=a.m_nodeB.next);this.m_contactFactory.destroy(a);--this.m_contactCount},collide:function(){for(var a=this.m_world.m_contactList;null!=a;){var b=a.getFixtureA(),c=a.getFixtureB(),d=b.getBody(),e=c.getBody();if(!1==d.isAwake()&&!1==e.isAwake())a=a.getNext();else{if(0!=(a.m_flags&E.e_filterFlag)){if(!1==e.shouldCollide(d)){b=a;a=b.getNext();this.destroy(b);continue}if(!1==this.m_contactFilter.shouldCollide(b,c)){b=a;a=
b.getNext();this.destroy(b);continue}a.m_flags&=~E.e_filterFlag}!1==this.m_broadPhase.testOverlap(b.m_proxy,c.m_proxy)?(b=a,a=b.getNext(),this.destroy(b)):(a.update(this.m_contactListener),a=a.getNext())}}},__class__:Hd};var za=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;this.m_drawFlags=0};za.__name__=["box2D","dynamics","B2DebugDraw"];za.prototype={setFlags:function(a){this.m_drawFlags=a},getFlags:function(){return this.m_drawFlags},appendFlags:function(a){this.m_drawFlags|=
a},clearFlags:function(a){this.m_drawFlags&=~a},setSprite:function(a){this.m_sprite=a},getSprite:function(){return this.m_sprite},setDrawScale:function(a){this.m_drawScale=a},getDrawScale:function(){return this.m_drawScale},setLineThickness:function(a){this.m_lineThickness=a},getLineThickness:function(){return this.m_lineThickness},setAlpha:function(a){this.m_alpha=a},getAlpha:function(){return this.m_alpha},setFillAlpha:function(a){this.m_fillAlpha=a},getFillAlpha:function(){return this.m_fillAlpha},
setXFormScale:function(a){this.m_xformScale=a},getXFormScale:function(){return this.m_xformScale},drawPolygon:function(a,b,c){console.log("drawPolygon()");this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);for(c=1;c<b;){var d=c++;this.m_sprite.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale)}this.m_sprite.lineTo(a[0].x*this.m_drawScale,
a[0].y*this.m_drawScale);this.m_sprite.stroke()},drawSolidPolygon:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);c="rgba("+c.get_r()+","+c.get_g()+","+c.get_b()+","+this.m_fillAlpha;this.m_sprite.fillStyle=c+")";for(c=1;c<b;){var d=c++;this.m_sprite.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale)}this.m_sprite.lineTo(a[0].x*
this.m_drawScale,a[0].y*this.m_drawScale);this.m_sprite.stroke();this.m_sprite.fill()},drawCircle:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.arc(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale,0,2*Math.PI,!1);this.m_sprite.stroke()},drawSolidCircle:function(a,b,c,d){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=d.toHex();this.m_sprite.globalAlpha=
this.m_alpha;this.m_sprite.beginPath();c="rgba("+d.get_r()+","+d.get_g()+","+d.get_b()+","+this.m_fillAlpha;this.m_sprite.fillStyle=c+")";this.m_sprite.arc(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale,0,2*Math.PI,!1);this.m_sprite.stroke();this.m_sprite.fill()},drawSegment:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a.x*this.m_drawScale,a.y*this.m_drawScale);
this.m_sprite.lineTo(b.x*this.m_drawScale,b.y*this.m_drawScale);this.m_sprite.stroke()},drawTransform:function(a){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle="#FF0000";this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a.position.x*this.m_drawScale,a.position.y*this.m_drawScale);this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col1.x)*this.m_drawScale,(a.position.y+this.m_xformScale*a.R.col1.y)*this.m_drawScale);this.m_sprite.lineWidth=
this.m_lineThickness;this.m_sprite.strokeStyle="#00FF00";this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.moveTo(a.position.x*this.m_drawScale,a.position.y*this.m_drawScale);this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col2.x)*this.m_drawScale,(a.position.y+this.m_xformScale*a.R.col2.y)*this.m_drawScale);this.m_sprite.stroke()},__class__:za};var Mc=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};Mc.__name__=["box2D","dynamics","B2FilterData"];Mc.prototype={copy:function(){var a=
new Mc;a.categoryBits=this.categoryBits;a.maskBits=this.maskBits;a.groupIndex=this.groupIndex;return a},__class__:Mc};var ub=function(){this.m_filter=new Mc;this.m_aabb=new Wa;this.m_shape=this.m_next=this.m_body=this.m_userData=null;this.m_restitution=this.m_friction=this.m_density=0};ub.__name__=["box2D","dynamics","B2Fixture"];ub.prototype={getType:function(){return this.m_shape.getType()},getShape:function(){return this.m_shape},setSensor:function(a){if(this.m_isSensor!=a&&(this.m_isSensor=a,
null!=this.m_body))for(a=this.m_body.getContactList();null!=a;){var b=a.contact,c=b.getFixtureA(),d=b.getFixtureB();c!=this&&d!=this||b.setSensor(c.isSensor()||d.isSensor());a=a.next}},isSensor:function(){return this.m_isSensor},setFilterData:function(a){this.m_filter=a.copy();if(null==this.m_body)for(a=this.m_body.getContactList();null!=a;){var b=a.contact,c=b.getFixtureA(),d=b.getFixtureB();c!=this&&d!=this||b.flagForFiltering();a=a.next}},getFilterData:function(){return this.m_filter.copy()},getBody:function(){return this.m_body},
getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},SetUserData:function(a){this.m_userData=a},testPoint:function(a){return this.m_shape.testPoint(this.m_body.getTransform(),a)},rayCast:function(a,b){return this.m_shape.rayCast(a,b,this.m_body.getTransform())},getMassData:function(a){null==a&&(a=new Ed);this.m_shape.computeMass(a,this.m_density);return a},setDensity:function(a){this.m_density=a},getDensity:function(){return this.m_density},getFriction:function(){return this.m_friction},
setFriction:function(a){this.m_friction=a},getRestitution:function(){return this.m_restitution},setRestitution:function(a){this.m_restitution=a},getAABB:function(){return this.m_aabb},create:function(a,b,c){this.m_userData=c.userData;this.m_friction=c.friction;this.m_restitution=c.restitution;this.m_body=a;this.m_next=null;this.m_filter=c.filter.copy();this.m_isSensor=c.isSensor;this.m_shape=c.shape.copy();this.m_density=c.density},destroy:function(){this.m_shape=null},createProxy:function(a,b){this.m_shape.computeAABB(this.m_aabb,
b);this.m_proxy=a.createProxy(this.m_aabb,this)},destroyProxy:function(a){null!=this.m_proxy&&(a.destroyProxy(this.m_proxy),this.m_proxy=null)},synchronize:function(a,b,c){if(null!=this.m_proxy){var d=new Wa,e=new Wa;this.m_shape.computeAABB(d,b);this.m_shape.computeAABB(e,c);this.m_aabb.combine(d,e);b=q.subtractVV(c.position,b.position);a.moveProxy(this.m_proxy,this.m_aabb,b)}},__class__:ub};var bf=function(){this.filter=new Mc;this.userData=this.shape=null;this.friction=0.2;this.density=this.restitution=
0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;this.isSensor=!1};bf.__name__=["box2D","dynamics","B2FixtureDef"];bf.prototype={__class__:bf};var Wb=function(){this.m_bodies=[];this.m_contacts=[];this.m_joints=[]};Wb.__name__=["box2D","dynamics","B2Island"];Wb.prototype={initialize:function(a,b,c,d,e,f){this.m_bodyCapacity=a;this.m_contactCapacity=b;this.m_jointCapacity=c;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=d;this.m_listener=e;
this.m_contactSolver=f;for(d=this.m_bodies.length;d<a;)e=d++,this.m_bodies[e]=null;for(a=this.m_contacts.length;a<b;)d=a++,this.m_contacts[d]=null;for(b=this.m_joints.length;b<c;)a=b++,this.m_joints[a]=null},clear:function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0},solve:function(a,b,c){for(var d,e=0,f=this.m_bodyCount;e<f;)d=e++,d=this.m_bodies[d],d.getType()==A.b2_dynamicBody&&(d.m_linearVelocity.x+=a.dt*(b.x+d.m_invMass*d.m_force.x),d.m_linearVelocity.y+=a.dt*(b.y+d.m_invMass*
d.m_force.y),d.m_angularVelocity+=a.dt*d.m_invI*d.m_torque,d.m_linearVelocity.multiply(q.clamp(1-a.dt*d.m_linearDamping,0,1)),d.m_angularVelocity*=q.clamp(1-a.dt*d.m_angularDamping,0,1));this.m_contactSolver.initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);b=this.m_contactSolver;b.initVelocityConstraints(a);e=0;for(f=this.m_jointCount;e<f;)d=e++,d=this.m_joints[d],d.initVelocityConstraints(a);e=0;for(f=a.velocityIterations;e<f;){e++;for(var g=0,k=this.m_jointCount;g<k;)d=g++,d=this.m_joints[d],
d.solveVelocityConstraints(a);b.solveVelocityConstraints()}e=0;for(f=this.m_jointCount;e<f;)d=e++,d=this.m_joints[d],d.finalizeVelocityConstraints();b.finalizeVelocityConstraints();e=0;for(f=this.m_bodyCount;e<f;)d=e++,d=this.m_bodies[d],d.getType()!=A.b2_staticBody&&(g=a.dt*d.m_linearVelocity.x,k=a.dt*d.m_linearVelocity.y,g*g+k*k>v.b2_maxTranslationSquared&&(d.m_linearVelocity.normalize(),d.m_linearVelocity.x*=v.b2_maxTranslation*a.inv_dt,d.m_linearVelocity.y*=v.b2_maxTranslation*a.inv_dt),g=a.dt*
d.m_angularVelocity,g*g>v.b2_maxRotationSquared&&(d.m_angularVelocity=0>d.m_angularVelocity?-v.b2_maxRotation*a.inv_dt:v.b2_maxRotation*a.inv_dt),d.m_sweep.c0.setV(d.m_sweep.c),d.m_sweep.a0=d.m_sweep.a,d.m_sweep.c.x+=a.dt*d.m_linearVelocity.x,d.m_sweep.c.y+=a.dt*d.m_linearVelocity.y,d.m_sweep.a+=a.dt*d.m_angularVelocity,d.synchronizeTransform());e=0;for(f=a.positionIterations;e<f;){e++;for(var g=b.solvePositionConstraints(v.b2_contactBaumgarte),k=!0,h=0,l=this.m_jointCount;h<l;)d=h++,d=this.m_joints[d],
d=d.solvePositionConstraints(v.b2_contactBaumgarte),k=k?d:!1;if(g&&k)break}this.report(b.m_constraints);if(c){c=Number.MAX_VALUE;b=v.b2_linearSleepTolerance*v.b2_linearSleepTolerance;e=v.b2_angularSleepTolerance*v.b2_angularSleepTolerance;f=0;for(g=this.m_bodyCount;f<g;)d=f++,d=this.m_bodies[d],d.getType()!=A.b2_staticBody&&(0==(d.m_flags&A.e_allowSleepFlag)&&(c=d.m_sleepTime=0),0==(d.m_flags&A.e_allowSleepFlag)||d.m_angularVelocity*d.m_angularVelocity>e||q.dot(d.m_linearVelocity,d.m_linearVelocity)>
b?c=d.m_sleepTime=0:(d.m_sleepTime+=a.dt,c=q.min(c,d.m_sleepTime)));if(c>=v.b2_timeToSleep)for(a=0,c=this.m_bodyCount;a<c;)b=a++,d=this.m_bodies[b],d.setAwake(!1)}},solveTOI:function(a){this.m_contactSolver.initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);for(var b=this.m_contactSolver,c=0,d=this.m_jointCount;c<d;){var e=c++;this.m_joints[e].initVelocityConstraints(a)}c=0;for(d=a.velocityIterations;c<d;){c++;b.solveVelocityConstraints();for(var e=0,f=this.m_jointCount;e<f;){var g=
e++;this.m_joints[g].solveVelocityConstraints(a)}}c=0;for(d=this.m_bodyCount;c<d;)e=c++,e=this.m_bodies[e],e.getType()!=A.b2_staticBody&&(f=a.dt*e.m_linearVelocity.x,g=a.dt*e.m_linearVelocity.y,f*f+g*g>v.b2_maxTranslationSquared&&(e.m_linearVelocity.normalize(),e.m_linearVelocity.x*=v.b2_maxTranslation*a.inv_dt,e.m_linearVelocity.y*=v.b2_maxTranslation*a.inv_dt),f=a.dt*e.m_angularVelocity,f*f>v.b2_maxRotationSquared&&(e.m_angularVelocity=0>e.m_angularVelocity?-v.b2_maxRotation*a.inv_dt:v.b2_maxRotation*
a.inv_dt),e.m_sweep.c0.setV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=a.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=a.dt*e.m_linearVelocity.y,e.m_sweep.a+=a.dt*e.m_angularVelocity,e.synchronizeTransform());c=0;for(a=a.positionIterations;c<a;){c++;d=b.solvePositionConstraints(0.75);e=!0;f=0;for(g=this.m_jointCount;f<g;)var k=f++,k=this.m_joints[k].solvePositionConstraints(v.b2_contactBaumgarte),e=e?k:!1;if(d&&e)break}this.report(b.m_constraints)},report:function(a){if(null!=this.m_listener)for(var b=
0,c=this.m_contactCount;b<c;){for(var d=b++,e=this.m_contacts[d],d=a[d],f=0,g=d.pointCount;f<g;){var k=f++;Wb.s_impulse.normalImpulses[k]=d.points[k].normalImpulse;Wb.s_impulse.tangentImpulses[k]=d.points[k].tangentImpulse}this.m_listener.postSolve(e,Wb.s_impulse)}},addBody:function(a){a.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=a},addContact:function(a){this.m_contacts[this.m_contactCount++]=a},addJoint:function(a){this.m_joints[this.m_jointCount++]=a},__class__:Wb};var Nc=
function(){};Nc.__name__=["box2D","dynamics","B2TimeStep"];Nc.prototype={set:function(a){this.dt=a.dt;this.inv_dt=a.inv_dt;this.positionIterations=a.positionIterations;this.velocityIterations=a.velocityIterations;this.warmStarting=a.warmStarting},__class__:Nc};var ca=function(a,b){this.s_stack=[];this.m_contactManager=new Hd;this.m_contactSolver=new Da;this.m_island=new Wb;this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null;this.m_controllerCount=
this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;ca.m_warmStarting=!0;ca.m_continuousPhysics=!0;this.m_allowSleep=b;this.m_gravity=a;this.m_inv_dt0=0;this.m_contactManager.m_world=this;var c=new Gd;this.m_groundBody=this.createBody(c)};ca.__name__=["box2D","dynamics","B2World"];ca.prototype={setDestructionListener:function(a){this.m_destructionListener=a},setContactFilter:function(a){this.m_contactManager.m_contactFilter=a},setContactListener:function(a){this.m_contactManager.m_contactListener=
a},setDebugDraw:function(a){this.m_debugDraw=a},setBroadPhase:function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;null!=c;){for(var d=c.m_fixtureList;null!=d;)d.m_proxy=a.createProxy(b.getFatAABB(d.m_proxy),d),d=d.m_next;c=c.m_next}},validate:function(){this.m_contactManager.m_broadPhase.validate()},getProxyCount:function(){return this.m_contactManager.m_broadPhase.getProxyCount()},createBody:function(a){if(!0==this.isLocked())return null;
a=new A(a,this);a.m_prev=null;a.m_next=this.m_bodyList;null!=this.m_bodyList&&(this.m_bodyList.m_prev=a);this.m_bodyList=a;++this.m_bodyCount;return a},destroyBody:function(a){if(!0!=this.isLocked()){for(var b=a.m_jointList;null!=b;){var c=b,b=b.next;null!=this.m_destructionListener&&this.m_destructionListener.sayGoodbyeJoint(c.joint);this.destroyJoint(c.joint)}for(b=a.m_controllerList;null!=b;)c=b,b=b.nextController,c.controller.removeBody(a);for(b=a.m_contactList;null!=b;)c=b,b=b.next,this.m_contactManager.destroy(c.contact);
a.m_contactList=null;for(b=a.m_fixtureList;null!=b;)c=b,b=b.m_next,null!=this.m_destructionListener&&this.m_destructionListener.sayGoodbyeFixture(c),c.destroyProxy(this.m_contactManager.m_broadPhase),c.destroy();a.m_fixtureList=null;a.m_fixtureCount=0;null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_bodyList&&(this.m_bodyList=a.m_next);--this.m_bodyCount}},createJoint:function(a){var b=da.create(a,null);b.m_prev=null;b.m_next=this.m_jointList;null!=this.m_jointList&&
(this.m_jointList.m_prev=b);this.m_jointList=b;++this.m_jointCount;b.m_edgeA.joint=b;b.m_edgeA.other=b.m_bodyB;b.m_edgeA.prev=null;b.m_edgeA.next=b.m_bodyA.m_jointList;null!=b.m_bodyA.m_jointList&&(b.m_bodyA.m_jointList.prev=b.m_edgeA);b.m_bodyA.m_jointList=b.m_edgeA;b.m_edgeB.joint=b;b.m_edgeB.other=b.m_bodyA;b.m_edgeB.prev=null;b.m_edgeB.next=b.m_bodyB.m_jointList;null!=b.m_bodyB.m_jointList&&(b.m_bodyB.m_jointList.prev=b.m_edgeB);b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,d=a.bodyB;if(!1==a.collideConnected)for(a=
d.getContactList();null!=a;)a.other==c&&a.contact.flagForFiltering(),a=a.next;return b},destroyJoint:function(a){var b=a.m_collideConnected;null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_jointList&&(this.m_jointList=a.m_next);var c=a.m_bodyA,d=a.m_bodyB;c.setAwake(!0);d.setAwake(!0);null!=a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next);null!=a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev);a.m_edgeA==c.m_jointList&&(c.m_jointList=a.m_edgeA.next);
a.m_edgeA.prev=null;a.m_edgeA.next=null;null!=a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next);null!=a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev);a.m_edgeB==d.m_jointList&&(d.m_jointList=a.m_edgeB.next);a.m_edgeB.prev=null;a.m_edgeB.next=null;da.destroy(a,null);--this.m_jointCount;if(!1==b)for(a=d.getContactList();null!=a;)a.other==c&&a.contact.flagForFiltering(),a=a.next},addController:function(a){a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList=a;a.m_world=this;this.m_controllerCount++;
return a},removeController:function(a){null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);this.m_controllerList==a&&(this.m_controllerList=a.m_next);this.m_controllerCount--},createController:function(a){if(a.m_world!=this)throw new K("Controller can only be a member of one world");a.m_next=this.m_controllerList;a.m_prev=null;null!=this.m_controllerList&&(this.m_controllerList.m_prev=a);this.m_controllerList=a;++this.m_controllerCount;a.m_world=this;return a},destroyController:function(a){a.clear();
null!=a.m_next&&(a.m_next.m_prev=a.m_prev);null!=a.m_prev&&(a.m_prev.m_next=a.m_next);a==this.m_controllerList&&(this.m_controllerList=a.m_next);--this.m_controllerCount},setWarmStarting:function(a){ca.m_warmStarting=a},setContinuousPhysics:function(a){ca.m_continuousPhysics=a},getBodyCount:function(){return this.m_bodyCount},getJointCount:function(){return this.m_jointCount},getContactCount:function(){return this.m_contactCount},setGravity:function(a){this.m_gravity=a},getGravity:function(){return this.m_gravity},
getGroundBody:function(){return this.m_groundBody},step:function(a,b,c){0!=(this.m_flags&ca.e_newFixture)&&(this.m_contactManager.findNewContacts(),this.m_flags&=~ca.e_newFixture);this.m_flags|=ca.e_locked;var d=ca.s_timestep2;d.dt=a;d.velocityIterations=b;d.positionIterations=c;d.inv_dt=0<a?1/a:0;d.dtRatio=this.m_inv_dt0*a;d.warmStarting=ca.m_warmStarting;this.m_contactManager.collide();0<d.dt&&this.solve(d);ca.m_continuousPhysics&&0<d.dt&&this.solveTOI(d);0<d.dt&&(this.m_inv_dt0=d.inv_dt);this.m_flags&=
~ca.e_locked},clearForces:function(){for(var a=this.m_bodyList;null!=a;)a.m_force.setZero(),a.m_torque=0,a=a.m_next},drawDebugData:function(){if(null!=this.m_debugDraw){var a=this.m_debugDraw.getFlags(),b,c,d;new t;new t;new t;var e;new Wa;new Wa;e=[new t,new t,new t,new t];var f=new Fd(0,0,0);if(0!=(a&za.e_shapeBit))for(b=this.m_bodyList;null!=b;){e=b.m_xf;for(c=b.getFixtureList();null!=c;)d=c.getShape(),!1==b.isActive()?f.set(0.5,0.5,0.3):b.getType()==A.b2_staticBody?f.set(0.5,0.9,0.5):b.getType()==
A.b2_kinematicBody?f.set(0.5,0.5,0.9):!1==b.isAwake()?f.set(0.6,0.6,0.6):f.set(0.9,0.7,0.7),this.drawShape(d,e,f),c=c.m_next;b=b.m_next}if(0!=(a&za.e_jointBit))for(b=this.m_jointList;null!=b;)this.drawJoint(b),b=b.m_next;if(0!=(a&za.e_controllerBit))for(b=this.m_controllerList;null!=b;)b.draw(this.m_debugDraw),b=b.m_next;if(0!=(a&za.e_pairBit))for(f.set(0.3,0.9,0.9),b=this.m_contactManager.m_contactList;null!=b;)d=b.getFixtureA(),c=b.getFixtureB(),d=d.getAABB().getCenter(),c=c.getAABB().getCenter(),
this.m_debugDraw.drawSegment(d,c,f),b=b.getNext();if(0!=(a&za.e_aabbBit))for(d=this.m_contactManager.m_broadPhase,e=[new t,new t,new t,new t],b=this.m_bodyList;null!=b;){if(!1!=b.isActive())for(c=b.getFixtureList();null!=c;){var g=d.getFatAABB(c.m_proxy);e[0].set(g.lowerBound.x,g.lowerBound.y);e[1].set(g.upperBound.x,g.lowerBound.y);e[2].set(g.upperBound.x,g.upperBound.y);e[3].set(g.lowerBound.x,g.upperBound.y);this.m_debugDraw.drawPolygon(e,4,f);c=c.getNext()}b=b.getNext()}if(0!=(a&za.e_centerOfMassBit))for(b=
this.m_bodyList;null!=b;)e=ca.s_xf,e.R=b.m_xf.R,e.position=b.getWorldCenter(),this.m_debugDraw.drawTransform(e),b=b.m_next}},queryAABB:function(a,b){var c=this.m_contactManager.m_broadPhase;c.query(function(b){b=c.getUserData(b);return a(b)},b)},queryShape:function(a,b,c){null==c&&(c=new kb,c.setIdentity());var d=this.m_contactManager.m_broadPhase,e=new Wa;b.computeAABB(e,c);d.query(function(e){e=C.__cast(d.getUserData(e),ub);var g=e.getShape(),k=e.getBody().getTransform();return va.testOverlap(b,
c,g,k)?a(e):!0},e)},queryPoint:function(a,b){var c=this.m_contactManager.m_broadPhase,d=new Wa;d.lowerBound.set(b.x-v.b2_linearSlop,b.y-v.b2_linearSlop);d.upperBound.set(b.x+v.b2_linearSlop,b.y+v.b2_linearSlop);c.query(function(d){d=C.__cast(c.getUserData(d),ub);return d.testPoint(b)?a(d):!0},d)},rayCast:function(a,b,c){var d=this.m_contactManager.m_broadPhase,e=new Xe,f=new Cd(b,c);d.rayCast(function(f,k){var h=d.getUserData(k),h=C.__cast(h,ub);if(h.rayCast(e,f)){var l=e.fraction,x=new t((1-l)*b.x+
l*c.x,(1-l)*b.y+l*c.y);return a(h,x,e.normal,l)}return f.maxFraction},f)},rayCastOne:function(a,b){var c;this.rayCast(function(a,b,f,g){c=a;return g},a,b);return c},rayCastAll:function(a,b){var c=[];this.rayCast(function(a,b,f,g){c[c.length]=a;return 1},a,b);return c},getBodyList:function(){return this.m_bodyList},getJointList:function(){return this.m_jointList},getContactList:function(){return this.m_contactList},isLocked:function(){return 0<(this.m_flags&ca.e_locked)},solve:function(a){for(var b,
c=this.m_controllerList;null!=c;)c.step(a),c=c.m_next;var d=this.m_island;d.initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(b=this.m_bodyList;null!=b;)b.m_flags&=~A.e_islandFlag,b=b.m_next;for(c=this.m_contactList;null!=c;)c.m_flags&=~E.e_islandFlag,c=c.m_next;for(c=this.m_jointList;null!=c;)c.m_islandFlag=!1,c=c.m_next;for(var c=this.s_stack,e=this.m_bodyList;null!=e;){if(0==(e.m_flags&A.e_islandFlag)&&!1!=e.isAwake()&&
!1!=e.isActive()&&e.getType()!=A.b2_staticBody){d.clear();var f=0;c[f++]=e;for(e.m_flags|=A.e_islandFlag;0<f;)if(b=c[--f],d.addBody(b),!1==b.isAwake()&&b.setAwake(!0),b.getType()!=A.b2_staticBody){for(var g,k=b.m_contactList;null!=k;)0==(k.contact.m_flags&E.e_islandFlag)&&(!0!=k.contact.isSensor()&&!1!=k.contact.isEnabled()&&!1!=k.contact.isTouching())&&(d.addContact(k.contact),k.contact.m_flags|=E.e_islandFlag,g=k.other,0==(g.m_flags&A.e_islandFlag)&&(c[f++]=g,g.m_flags|=A.e_islandFlag)),k=k.next;
for(b=b.m_jointList;null!=b;)!0!=b.joint.m_islandFlag&&(g=b.other,!1!=g.isActive()&&(d.addJoint(b.joint),b.joint.m_islandFlag=!0,0==(g.m_flags&A.e_islandFlag)&&(c[f++]=g,g.m_flags|=A.e_islandFlag))),b=b.next}d.solve(a,this.m_gravity,this.m_allowSleep);f=0;for(g=d.m_bodyCount;f<g;)b=f++,b=d.m_bodies[b],b.getType()==A.b2_staticBody&&(b.m_flags&=~A.e_islandFlag)}e=e.m_next}a=0;for(d=c.length;a<d;){e=a++;if(null==c[e])break;c[e]=null}for(b=this.m_bodyList;null!=b;)!1!=b.isAwake()&&!1!=b.isActive()&&b.getType()!=
A.b2_staticBody&&b.synchronizeFixtures(),b=b.m_next;this.m_contactManager.findNewContacts()},solveTOI:function(a){var b,c,d,e,f=this.m_island;f.initialize(this.m_bodyCount,v.b2_maxTOIContactsPerIsland,v.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var g=ca.s_queue;for(b=this.m_bodyList;null!=b;)b.m_flags&=~A.e_islandFlag,b.m_sweep.t0=0,b=b.m_next;for(b=this.m_contactList;null!=b;)b.m_flags&=~(E.e_toiFlag|E.e_islandFlag),b=b.m_next;for(e=this.m_jointList;null!=
e;)e.m_islandFlag=!1,e=e.m_next;for(;;){e=null;var k=1;for(b=this.m_contactList;null!=b;){if(!0!=b.isSensor()&&!1!=b.isEnabled()&&!1!=b.isContinuous()){c=1;if(0!=(b.m_flags&E.e_toiFlag))c=b.m_toi;else{c=b.m_fixtureA;d=b.m_fixtureB;c=c.m_body;d=d.m_body;if(!(c.getType()==A.b2_dynamicBody&&!1!=c.isAwake()||d.getType()==A.b2_dynamicBody&&!1!=d.isAwake())){b=b.m_next;continue}var h=c.m_sweep.t0;c.m_sweep.t0<d.m_sweep.t0?(h=d.m_sweep.t0,c.m_sweep.advance(h)):d.m_sweep.t0<c.m_sweep.t0&&(h=c.m_sweep.t0,
d.m_sweep.advance(h));c=b.computeTOI(c.m_sweep,d.m_sweep);v.b2Assert(0<=c&&1>=c);0<c&&1>c&&(c=(1-c)*h+c,1<c&&(c=1));b.m_toi=c;b.m_flags|=E.e_toiFlag}Number.MIN_VALUE<c&&c<k&&(e=b,k=c)}b=b.m_next}if(null==e||1-100*Number.MIN_VALUE<k)break;c=e.m_fixtureA;d=e.m_fixtureB;c=c.m_body;d=d.m_body;ca.s_backupA.set(c.m_sweep);ca.s_backupB.set(d.m_sweep);c.advance(k);d.advance(k);e.update(this.m_contactManager.m_contactListener);e.m_flags&=~E.e_toiFlag;if(!0==e.isSensor()||!1==e.isEnabled())c.m_sweep.set(ca.s_backupA),
d.m_sweep.set(ca.s_backupB),c.synchronizeTransform(),d.synchronizeTransform();else if(!1!=e.isTouching()){b=c;b.getType()!=A.b2_dynamicBody&&(b=d);f.clear();d=c=0;g[c+d++]=b;for(b.m_flags|=A.e_islandFlag;0<d;)if(b=g[c++],--d,f.addBody(b),!1==b.isAwake()&&b.setAwake(!0),b.getType()==A.b2_dynamicBody){for(e=b.m_contactList;null!=e&&f.m_contactCount!=f.m_contactCapacity;)0==(e.contact.m_flags&E.e_islandFlag)&&(!0!=e.contact.isSensor()&&!1!=e.contact.isEnabled()&&!1!=e.contact.isTouching())&&(f.addContact(e.contact),
e.contact.m_flags|=E.e_islandFlag,h=e.other,0==(h.m_flags&A.e_islandFlag)&&(h.getType()!=A.b2_staticBody&&(h.advance(k),h.setAwake(!0)),g[c+d]=h,++d,h.m_flags|=A.e_islandFlag)),e=e.next;for(b=b.m_jointList;null!=b;)f.m_jointCount!=f.m_jointCapacity&&!0!=b.joint.m_islandFlag&&(h=b.other,!1!=h.isActive()&&(f.addJoint(b.joint),b.joint.m_islandFlag=!0,0==(h.m_flags&A.e_islandFlag)&&(h.getType()!=A.b2_staticBody&&(h.advance(k),h.setAwake(!0)),g[c+d]=h,++d,h.m_flags|=A.e_islandFlag))),b=b.next}b=ca.s_timestep;
b.warmStarting=!1;b.dt=(1-k)*a.dt;b.inv_dt=1/b.dt;b.dtRatio=0;b.velocityIterations=a.velocityIterations;b.positionIterations=a.positionIterations;f.solveTOI(b);k=0;for(c=f.m_bodyCount;k<c;)if(b=k++,b=f.m_bodies[b],b.m_flags&=~A.e_islandFlag,!1!=b.isAwake()&&b.getType()==A.b2_dynamicBody)for(b.synchronizeFixtures(),e=b.m_contactList;null!=e;)e.contact.m_flags&=~E.e_toiFlag,e=e.next;k=0;for(e=f.m_contactCount;k<e;)b=k++,b=f.m_contacts[b],b.m_flags&=~(E.e_toiFlag|E.e_islandFlag);k=0;for(b=f.m_jointCount;k<
b;)e=k++,e=f.m_joints[e],e.m_islandFlag=!1;this.m_contactManager.findNewContacts()}}},drawJoint:function(a){var b=a.getBodyA(),c=a.getBodyB(),d=b.m_xf.position,e=c.m_xf.position,f=a.getAnchorA(),g=a.getAnchorB(),k=ca.s_jointColor;switch(a.m_type[1]){case 3:this.m_debugDraw.drawSegment(f,g,k);break;case 4:b=C.__cast(a,lb);a=b.getGroundAnchorA();b=b.getGroundAnchorB();this.m_debugDraw.drawSegment(a,f,k);this.m_debugDraw.drawSegment(b,g,k);this.m_debugDraw.drawSegment(a,b,k);break;case 5:this.m_debugDraw.drawSegment(f,
g,k);break;default:b!=this.m_groundBody&&this.m_debugDraw.drawSegment(d,f,k),this.m_debugDraw.drawSegment(f,g,k),c!=this.m_groundBody&&this.m_debugDraw.drawSegment(e,g,k)}},drawShape:function(a,b,c){switch(a.m_type[1]){case 1:a=C.__cast(a,Ya);var d=q.mulX(b,a.m_p);this.m_debugDraw.drawSolidCircle(d,a.m_radius,b.R.col1,c);break;case 2:d=C.__cast(a,oa);a=d.getVertexCount();for(var d=d.getVertices(),e=[],f=0;f<a;){var g=f++;e[g]=q.mulX(b,d[g])}this.m_debugDraw.drawSolidPolygon(e,a,c);break;case 3:a=
C.__cast(a,lc),this.m_debugDraw.drawSegment(q.mulX(b,a.getVertex1()),q.mulX(b,a.getVertex2()),c)}},__class__:ca};var E=function(){this.m_nodeA=new Id;this.m_nodeB=new Id;this.m_manifold=new Kc;this.m_oldManifold=new Kc};E.__name__=["box2D","dynamics","contacts","B2Contact"];E.prototype={getManifold:function(){return this.m_manifold},getWorldManifold:function(a){var b=this.m_fixtureA.getBody(),c=this.m_fixtureB.getBody(),d=this.m_fixtureA.getShape(),e=this.m_fixtureB.getShape();a.initialize(this.m_manifold,
b.getTransform(),d.m_radius,c.getTransform(),e.m_radius)},isTouching:function(){return(this.m_flags&E.e_touchingFlag)==E.e_touchingFlag},isContinuous:function(){return(this.m_flags&E.e_continuousFlag)==E.e_continuousFlag},setSensor:function(a){this.m_flags=a?this.m_flags|E.e_sensorFlag:this.m_flags&~E.e_sensorFlag},isSensor:function(){return(this.m_flags&E.e_sensorFlag)==E.e_sensorFlag},setEnabled:function(a){this.m_flags=a?this.m_flags|E.e_enabledFlag:this.m_flags&~E.e_enabledFlag},isEnabled:function(){return(this.m_flags&
E.e_enabledFlag)==E.e_enabledFlag},getNext:function(){return this.m_next},getFixtureA:function(){return this.m_fixtureA},getFixtureB:function(){return this.m_fixtureB},flagForFiltering:function(){this.m_flags|=E.e_filterFlag},reset:function(a,b){this.m_flags=E.e_enabledFlag;if(null==a||null==b)this.m_fixtureB=this.m_fixtureA=null;else{if(a.isSensor()||b.isSensor())this.m_flags|=E.e_sensorFlag;var c=a.getBody(),d=b.getBody();if(c.getType()!=A.b2_dynamicBody||c.isBullet()||d.getType()!=A.b2_dynamicBody||
d.isBullet())this.m_flags|=E.e_continuousFlag;this.m_fixtureA=a;this.m_fixtureB=b;this.m_manifold.m_pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null}},update:function(a){var b=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=b;this.m_flags|=E.e_enabledFlag;var c=!1,b=(this.m_flags&E.e_touchingFlag)==
E.e_touchingFlag,d=this.m_fixtureA.m_body,e=this.m_fixtureB.m_body,f=this.m_fixtureA.m_aabb.testOverlap(this.m_fixtureB.m_aabb);if(0!=(this.m_flags&E.e_sensorFlag))f&&(c=this.m_fixtureA.getShape(),f=this.m_fixtureB.getShape(),d=d.getTransform(),e=e.getTransform(),c=va.testOverlap(c,d,f,e)),this.m_manifold.m_pointCount=0;else{d.getType()!=A.b2_dynamicBody||d.isBullet()||e.getType()!=A.b2_dynamicBody||e.isBullet()?this.m_flags|=E.e_continuousFlag:this.m_flags&=~E.e_continuousFlag;if(f){this.evaluate();
for(var c=0<this.m_manifold.m_pointCount,f=0,g=this.m_manifold.m_pointCount;f<g;){var k=f++,k=this.m_manifold.m_points[k];k.m_normalImpulse=0;k.m_tangentImpulse=0;for(var h=k.m_id,l=0,x=this.m_oldManifold.m_pointCount;l<x;){var u=l++,u=this.m_oldManifold.m_points[u];if(u.m_id.get_key()==h.get_key()){k.m_normalImpulse=u.m_normalImpulse;k.m_tangentImpulse=u.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;c!=b&&(d.setAwake(!0),e.setAwake(!0))}this.m_flags=c?this.m_flags|E.e_touchingFlag:
this.m_flags&~E.e_touchingFlag;!1==b&&!0==c&&a.beginContact(this);!0==b&&!1==c&&a.endContact(this);0==(this.m_flags&E.e_sensorFlag)&&a.preSolve(this,this.m_oldManifold)},evaluate:function(){},computeTOI:function(a,b){E.s_input.proxyA.set(this.m_fixtureA.getShape());E.s_input.proxyB.set(this.m_fixtureB.getShape());E.s_input.sweepA=a;E.s_input.sweepB=b;E.s_input.tolerance=v.b2_linearSlop;return D.timeOfImpact(E.s_input)},__class__:E};var Db=function(){E.call(this)};Db.__name__=["box2D","dynamics","contacts",
"B2CircleContact"];Db.create=function(a){return new Db};Db.destroy=function(a,b){};Db.__super__=E;Db.prototype=p(E.prototype,{reset:function(a,b){E.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();J.collideCircles(this.m_manifold,C.__cast(this.m_fixtureA.getShape(),Ya),a.m_xf,C.__cast(this.m_fixtureB.getShape(),Ya),b.m_xf)},__class__:Db});var ff=function(){this.localPlaneNormal=new t;this.localPoint=new t;this.normal=new t;this.normalMass=
new ha;this.K=new ha;this.points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.points[c]=new ef}};ff.__name__=["box2D","dynamics","contacts","B2ContactConstraint"];ff.prototype={__class__:ff};var ef=function(){this.localPoint=new t;this.rA=new t;this.rB=new t};ef.__name__=["box2D","dynamics","contacts","B2ContactConstraintPoint"];ef.prototype={__class__:ef};var Id=function(){};Id.__name__=["box2D","dynamics","contacts","B2ContactEdge"];Id.prototype={__class__:Id};var df=function(a){this.m_allocator=
a;this.initializeRegisters()};df.__name__=["box2D","dynamics","contacts","B2ContactFactory"];df.prototype={addType:function(a,b,c,d){var e=c[1],f=d[1];this.m_registers[e][f].createFcn=a;this.m_registers[e][f].destroyFcn=b;this.m_registers[e][f].primary=!0;c!=d&&(this.m_registers[f][e].createFcn=a,this.m_registers[f][e].destroyFcn=b,this.m_registers[f][e].primary=!1)},initializeRegisters:function(){this.m_registers=[];for(var a=0,b=Y.__empty_constructs__.length;a<b;){var c=a++;this.m_registers[c]=
[];for(var d=0,e=Y.__empty_constructs__.length;d<e;){var f=d++;this.m_registers[c][f]=new gf}}this.addType(Db.create,Db.destroy,Y.CIRCLE_SHAPE,Y.CIRCLE_SHAPE);this.addType(Eb.create,Eb.destroy,Y.POLYGON_SHAPE,Y.CIRCLE_SHAPE);this.addType(Fb.create,Fb.destroy,Y.POLYGON_SHAPE,Y.POLYGON_SHAPE);this.addType(Gb.create,Gb.destroy,Y.EDGE_SHAPE,Y.CIRCLE_SHAPE);this.addType(Hb.create,Hb.destroy,Y.POLYGON_SHAPE,Y.EDGE_SHAPE)},create:function(a,b){var c=a.getType(),d=b.getType(),c=this.m_registers[c[1]][d[1]];
if(null!=c.pool)return d=c.pool,c.pool=d.m_next,c.poolCount--,d.reset(a,b),d;d=c.createFcn;return null!=d?(c.primary?(d=d(this.m_allocator),d.reset(a,b)):(d=d(this.m_allocator),d.reset(b,a)),d):null},destroy:function(a){0<a.m_manifold.m_pointCount&&(a.m_fixtureA.m_body.setAwake(!0),a.m_fixtureB.m_body.setAwake(!0));var b=a.m_fixtureA.getType(),c=a.m_fixtureB.getType(),b=this.m_registers[b[1]][c[1]];b.poolCount++;a.m_next=b.pool;b.pool=a;b=b.destroyFcn;b(a,this.m_allocator)},__class__:df};var gf=function(){};
gf.__name__=["box2D","dynamics","contacts","B2ContactRegister"];gf.prototype={__class__:gf};var Oc=function(){this.m_normal=new t;this.m_separations=[];this.m_points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new t}};Oc.__name__=["box2D","dynamics","contacts","B2PositionSolverManifold"];Oc.prototype={initialize:function(a){v.b2Assert(0<a.pointCount);var b,c,d,e,f;switch(a.type[1]){case 0:d=a.bodyA.m_xf.R;c=a.localPoint;b=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*
c.y);e=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyB.m_xf.R;c=a.points[0].localPoint;f=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);d=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);c=f-b;var g=d-e,k=c*c+g*g;k>Number.MIN_VALUE*Number.MIN_VALUE?(k=Math.sqrt(k),this.m_normal.x=c/k,this.m_normal.y=g/k):(this.m_normal.x=1,this.m_normal.y=0);this.m_points[0].x=0.5*(b+f);this.m_points[0].y=0.5*(e+d);this.m_separations[0]=c*this.m_normal.x+g*this.m_normal.y-a.radius;break;case 1:d=
a.bodyA.m_xf.R;c=a.localPlaneNormal;this.m_normal.x=d.col1.x*c.x+d.col2.x*c.y;this.m_normal.y=d.col1.y*c.x+d.col2.y*c.y;d=a.bodyA.m_xf.R;c=a.localPoint;e=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);f=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyB.m_xf.R;g=0;for(k=a.pointCount;g<k;){var h=g++;c=a.points[h].localPoint;b=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);c=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);this.m_separations[h]=(b-e)*this.m_normal.x+(c-f)*this.m_normal.y-
a.radius;this.m_points[h].x=b;this.m_points[h].y=c}break;case 2:d=a.bodyB.m_xf.R;c=a.localPlaneNormal;this.m_normal.x=d.col1.x*c.x+d.col2.x*c.y;this.m_normal.y=d.col1.y*c.x+d.col2.y*c.y;d=a.bodyB.m_xf.R;c=a.localPoint;e=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);f=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyA.m_xf.R;g=0;for(k=a.pointCount;g<k;)h=g++,c=a.points[h].localPoint,b=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y),c=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*
c.y),this.m_separations[h]=(b-e)*this.m_normal.x+(c-f)*this.m_normal.y-a.radius,this.m_points[h].set(b,c);this.m_normal.x*=-1;this.m_normal.y*=-1}},__class__:Oc};var Da=function(){this.m_step=new Nc;this.m_constraints=[]};Da.__name__=["box2D","dynamics","contacts","B2ContactSolver"];Da.prototype={initialize:function(a,b,c,d){var e;this.m_step.set(a);this.m_allocator=d;for(this.m_constraintCount=c;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new ff;
for(a=0;a<c;){d=a++;e=b[d];var f=e.m_fixtureA,g=e.m_fixtureB,k=f.m_shape.m_radius,h=g.m_shape.m_radius,l=f.m_body,x=g.m_body;e=e.getManifold();var u=v.b2MixFriction(f.getFriction(),g.getFriction()),m=v.b2MixRestitution(f.getRestitution(),g.getRestitution()),q=l.m_linearVelocity.x,n=l.m_linearVelocity.y,r=x.m_linearVelocity.x,t=x.m_linearVelocity.y,p=l.m_angularVelocity,s=x.m_angularVelocity;v.b2Assert(0<e.m_pointCount);Da.s_worldManifold.initialize(e,l.m_xf,k,x.m_xf,h);f=Da.s_worldManifold.m_normal.x;
g=Da.s_worldManifold.m_normal.y;d=this.m_constraints[d];d.bodyA=l;d.bodyB=x;d.manifold=e;d.normal.x=f;d.normal.y=g;d.pointCount=e.m_pointCount;d.friction=u;d.restitution=m;d.localPlaneNormal.x=e.m_localPlaneNormal.x;d.localPlaneNormal.y=e.m_localPlaneNormal.y;d.localPoint.x=e.m_localPoint.x;d.localPoint.y=e.m_localPoint.y;d.radius=k+h;d.type=e.m_type;k=0;for(h=d.pointCount;k<h;){var w=k++,m=e.m_points[w],u=d.points[w];u.normalImpulse=m.m_normalImpulse;u.tangentImpulse=m.m_tangentImpulse;u.localPoint.setV(m.m_localPoint);
var m=u.rA.x=Da.s_worldManifold.m_points[w].x-l.m_sweep.c.x,z=u.rA.y=Da.s_worldManifold.m_points[w].y-l.m_sweep.c.y,A=u.rB.x=Da.s_worldManifold.m_points[w].x-x.m_sweep.c.x,w=u.rB.y=Da.s_worldManifold.m_points[w].y-x.m_sweep.c.y,C=m*g-z*f,y=A*g-w*f,C=C*C,y=y*y;u.normalMass=1/(l.m_invMass+x.m_invMass+l.m_invI*C+x.m_invI*y);var B=l.m_mass*l.m_invMass+x.m_mass*x.m_invMass,B=B+(l.m_mass*l.m_invI*C+x.m_mass*x.m_invI*y);u.equalizedMass=1/B;y=g;B=-f;C=m*B-z*y;y=A*B-w*y;C*=C;y*=y;u.tangentMass=1/(l.m_invMass+
x.m_invMass+l.m_invI*C+x.m_invI*y);u.velocityBias=0;m=d.normal.x*(r+-s*w-q- -p*z)+d.normal.y*(t+s*A-n-p*m);m<-v.b2_velocityThreshold&&(u.velocityBias+=-d.restitution*m)}2==d.pointCount&&(t=d.points[0],r=d.points[1],e=l.m_invMass,l=l.m_invI,q=x.m_invMass,x=x.m_invI,n=t.rA.x*g-t.rA.y*f,t=t.rB.x*g-t.rB.y*f,p=r.rA.x*g-r.rA.y*f,r=r.rB.x*g-r.rB.y*f,f=e+q+l*n*n+x*t*t,g=e+q+l*p*p+x*r*r,x=e+q+l*n*p+x*t*r,f*f<100*(f*g-x*x)?(d.K.col1.set(f,x),d.K.col2.set(x,g),d.K.getInverse(d.normalMass)):d.pointCount=1)}},
initVelocityConstraints:function(a){for(var b=0,c=this.m_constraintCount;b<c;){var d=b++,d=this.m_constraints[d],e=d.bodyA,f=d.bodyB,g=e.m_invMass,k=e.m_invI,h=f.m_invMass,l=f.m_invI,m=d.normal.x,u=d.normal.y,q=u,n=-m,r;if(a.warmStarting){r=d.pointCount;for(var t=0;t<r;){var p=t++,p=d.points[p];p.normalImpulse*=a.dtRatio;p.tangentImpulse*=a.dtRatio;var s=p.normalImpulse*m+p.tangentImpulse*q,v=p.normalImpulse*u+p.tangentImpulse*n;e.m_angularVelocity-=k*(p.rA.x*v-p.rA.y*s);e.m_linearVelocity.x-=g*s;
e.m_linearVelocity.y-=g*v;f.m_angularVelocity+=l*(p.rB.x*v-p.rB.y*s);f.m_linearVelocity.x+=h*s;f.m_linearVelocity.y+=h*v}}else for(r=d.pointCount,e=0,f=r;e<f;)g=e++,g=d.points[g],g.normalImpulse=0,g.tangentImpulse=0}},solveVelocityConstraints:function(){for(var a,b,c,d,e,f,g,k,h,l,m=0,u=this.m_constraintCount;m<u;){var n=m++;d=this.m_constraints[n];var n=d.bodyA,r=d.bodyB,p=n.m_angularVelocity,t=r.m_angularVelocity,s=n.m_linearVelocity,v=r.m_linearVelocity,w=n.m_invMass,z=n.m_invI,A=r.m_invMass,C=
r.m_invI;k=d.normal.x;var y=h=d.normal.y,B=-k;l=d.friction;g=0;for(f=d.pointCount;g<f;)a=g++,a=d.points[a],b=v.x-t*a.rB.y-s.x+p*a.rA.y,c=v.y+t*a.rB.x-s.y-p*a.rA.x,b=b*y+c*B,b=a.tangentMass*-b,c=l*a.normalImpulse,c=q.clamp(a.tangentImpulse+b,-c,c),b=c-a.tangentImpulse,e=b*y,b*=B,s.x-=w*e,s.y-=w*b,p-=z*(a.rA.x*b-a.rA.y*e),v.x+=A*e,v.y+=A*b,t+=C*(a.rB.x*b-a.rB.y*e),a.tangentImpulse=c;if(1==d.pointCount)a=d.points[0],b=v.x+-t*a.rB.y-s.x- -p*a.rA.y,c=v.y+t*a.rB.x-s.y-p*a.rA.x,d=b*k+c*h,b=-a.normalMass*
(d-a.velocityBias),c=a.normalImpulse+b,0<c||(c=0),b=c-a.normalImpulse,e=b*k,b*=h,s.x-=w*e,s.y-=w*b,p-=z*(a.rA.x*b-a.rA.y*e),v.x+=A*e,v.y+=A*b,t+=C*(a.rB.x*b-a.rB.y*e),a.normalImpulse=c;else{a=d.points[0];y=d.points[1];f=a.normalImpulse;g=y.normalImpulse;e=(v.x-t*a.rB.y-s.x+p*a.rA.y)*k+(v.y+t*a.rB.x-s.y-p*a.rA.x)*h;var E=(v.x-t*y.rB.y-s.x+p*y.rA.y)*k+(v.y+t*y.rB.x-s.y-p*y.rA.x)*h;b=e-a.velocityBias;c=E-y.velocityBias;l=d.K;b-=l.col1.x*f+l.col2.x*g;for(c-=l.col1.y*f+l.col2.y*g;;){l=d.normalMass;B=-(l.col1.x*
b+l.col2.x*c);l=-(l.col1.y*b+l.col2.y*c);if(0<=B&&0<=l){f=B-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;s.x-=w*(d+k);s.y-=w*(f+h);p-=z*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=A*(d+k);v.y+=A*(f+h);t+=C*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=B;y.normalImpulse=l;break}B=-a.normalMass*b;l=0;E=d.K.col1.y*B+c;if(0<=B&&0<=E){f=B-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;s.x-=w*(d+k);s.y-=w*(f+h);p-=z*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=A*(d+k);v.y+=A*(f+h);t+=C*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=
B;y.normalImpulse=l;break}B=0;l=-y.normalMass*c;e=d.K.col2.x*l+b;if(0<=l&&0<=e){f=B-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;s.x-=w*(d+k);s.y-=w*(f+h);p-=z*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=A*(d+k);v.y+=A*(f+h);t+=C*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=B;y.normalImpulse=l;break}l=B=0;e=b;E=c;if(0<=e&&0<=E){f=B-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;s.x-=w*(d+k);s.y-=w*(f+h);p-=z*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=A*(d+k);v.y+=A*(f+h);t+=C*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=
B;y.normalImpulse=l;break}break}}n.m_angularVelocity=p;r.m_angularVelocity=t}},finalizeVelocityConstraints:function(){for(var a=0,b=this.m_constraintCount;a<b;)for(var c=a++,c=this.m_constraints[c],d=c.manifold,e=0,f=c.pointCount;e<f;){var g=e++,k=d.m_points[g],g=c.points[g];k.m_normalImpulse=g.normalImpulse;k.m_tangentImpulse=g.tangentImpulse}},solvePositionConstraints:function(a){for(var b=0,c=0,d=this.m_constraintCount;c<d;){var e=c++,e=this.m_constraints[e],f=e.bodyA,g=e.bodyB,k=f.m_mass*f.m_invMass,
h=f.m_mass*f.m_invI,l=g.m_mass*g.m_invMass,m=g.m_mass*g.m_invI;Da.s_psm.initialize(e);for(var u=Da.s_psm.m_normal,n=0,r=e.pointCount;n<r;){var p=n++,t=e.points[p],s=Da.s_psm.m_points[p],w=Da.s_psm.m_separations[p],p=s.x-f.m_sweep.c.x,y=s.y-f.m_sweep.c.y,z=s.x-g.m_sweep.c.x,s=s.y-g.m_sweep.c.y;b<w||(b=w);w=q.clamp(a*(w+v.b2_linearSlop),-v.b2_maxLinearCorrection,0);w*=-t.equalizedMass;t=w*u.x;w*=u.y;f.m_sweep.c.x-=k*t;f.m_sweep.c.y-=k*w;f.m_sweep.a-=h*(p*w-y*t);f.synchronizeTransform();g.m_sweep.c.x+=
l*t;g.m_sweep.c.y+=l*w;g.m_sweep.a+=m*(z*w-s*t);g.synchronizeTransform()}}return b>-1.5*v.b2_linearSlop},__class__:Da};var Gb=function(){E.call(this)};Gb.__name__=["box2D","dynamics","contacts","B2EdgeAndCircleContact"];Gb.create=function(a){return new Gb};Gb.destroy=function(a,b){};Gb.__super__=E;Gb.prototype=p(E.prototype,{reset:function(a,b){E.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();this.b2CollideEdgeAndCircle(this.m_manifold,
C.__cast(this.m_fixtureA.getShape(),lc),a.m_xf,C.__cast(this.m_fixtureB.getShape(),Ya),b.m_xf)},b2CollideEdgeAndCircle:function(a,b,c,d,e){},__class__:Gb});var Eb=function(){E.call(this)};Eb.__name__=["box2D","dynamics","contacts","B2PolyAndCircleContact"];Eb.create=function(a){return new Eb};Eb.destroy=function(a,b){};Eb.__super__=E;Eb.prototype=p(E.prototype,{reset:function(a,b){E.prototype.reset.call(this,a,b);v.b2Assert(a.getType()==Y.POLYGON_SHAPE);v.b2Assert(b.getType()==Y.CIRCLE_SHAPE)},evaluate:function(){var a=
this.m_fixtureA.m_body,b=this.m_fixtureB.m_body;J.collidePolygonAndCircle(this.m_manifold,C.__cast(this.m_fixtureA.getShape(),oa),a.m_xf,C.__cast(this.m_fixtureB.getShape(),Ya),b.m_xf)},__class__:Eb});var Hb=function(){E.call(this)};Hb.__name__=["box2D","dynamics","contacts","B2PolyAndEdgeContact"];Hb.create=function(a){return new Hb};Hb.destroy=function(a,b){};Hb.__super__=E;Hb.prototype=p(E.prototype,{reset:function(a,b){E.prototype.reset.call(this,a,b);v.b2Assert(a.getType()==Y.POLYGON_SHAPE);
v.b2Assert(b.getType()==Y.EDGE_SHAPE)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();this.b2CollidePolyAndEdge(this.m_manifold,C.__cast(this.m_fixtureA.getShape(),oa),a.m_xf,C.__cast(this.m_fixtureB.getShape(),lc),b.m_xf)},b2CollidePolyAndEdge:function(a,b,c,d,e){},__class__:Hb});var Fb=function(){E.call(this)};Fb.__name__=["box2D","dynamics","contacts","B2PolygonContact"];Fb.create=function(a){return new Fb};Fb.destroy=function(a,b){};Fb.__super__=E;Fb.prototype=
p(E.prototype,{reset:function(a,b){E.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();J.collidePolygons(this.m_manifold,C.__cast(this.m_fixtureA.getShape(),oa),a.m_xf,C.__cast(this.m_fixtureB.getShape(),oa),b.m_xf)},__class__:Fb});var da=function(a){this.m_edgeA=new Jd;this.m_edgeB=new Jd;this.m_localCenterA=new t;this.m_localCenterB=new t;v.b2Assert(a.bodyA!=a.bodyB);this.m_type=a.type;this.m_next=this.m_prev=null;this.m_bodyA=a.bodyA;
this.m_bodyB=a.bodyB;this.m_collideConnected=a.collideConnected;this.m_islandFlag=!1;this.m_userData=a.userData};da.__name__=["box2D","dynamics","joints","B2Joint"];da.create=function(a,b){var c=null;switch(a.type[1]){case 1:c=new mb(C.__cast(a,Kd));break;case 2:c=new mc(C.__cast(a,Ld));break;case 3:c=new Md(C.__cast(a,Nd));break;case 4:c=new lb(C.__cast(a,Od));break;case 5:c=new Pd(C.__cast(a,Qd));break;case 6:c=new Rd(C.__cast(a,Sd));break;case 7:c=new Td(C.__cast(a,Ud));break;case 8:c=new Vd(C.__cast(a,
Wd));break;case 9:c=new Xd(C.__cast(a,Yd))}return c};da.destroy=function(a,b){};da.prototype={getType:function(){return this.m_type},getAnchorA:function(){return null},getAnchorB:function(){return null},getReactionForce:function(a){return null},getReactionTorque:function(a){return 0},getBodyA:function(){return this.m_bodyA},getBodyB:function(){return this.m_bodyB},getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},setUserData:function(a){this.m_userData=a},isActive:function(){return this.m_bodyA.isActive()?
this.m_bodyB.isActive():!1},initVelocityConstraints:function(a){},solveVelocityConstraints:function(a){},finalizeVelocityConstraints:function(){},solvePositionConstraints:function(a){return!1},__class__:da};var Md=function(a){da.call(this,a);this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_u=new t;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_length=a.length;this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_bias=this.m_gamma=
this.m_impulse=0};Md.__name__=["box2D","dynamics","joints","B2DistanceJoint"];Md.__super__=da;Md.prototype=p(da.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)},getReactionTorque:function(a){return 0},getLength:function(){return this.m_length},setLength:function(a){this.m_length=a},
getFrequency:function(){return this.m_frequencyHz},setFrequency:function(a){this.m_frequencyHz=a},getDampingRatio:function(){return this.m_dampingRatio},setDampingRatio:function(a){this.m_dampingRatio=a},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchor1.x-d.m_sweep.localCenter.x,g=this.m_localAnchor1.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchor2.x-e.m_sweep.localCenter.x,
h=this.m_localAnchor2.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;this.m_u.x=e.m_sweep.c.x+k-d.m_sweep.c.x-f;this.m_u.y=e.m_sweep.c.y+h-d.m_sweep.c.y-g;c=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);c>v.b2_linearSlop?this.m_u.multiply(1/c):this.m_u.setZero();b=f*this.m_u.y-g*this.m_u.x;var l=k*this.m_u.y-h*this.m_u.x;b=d.m_invMass+d.m_invI*b*b+e.m_invMass+e.m_invI*l*l;this.m_mass=0!=b?1/b:0;if(0<this.m_frequencyHz){c-=this.m_length;var l=2*Math.PI*this.m_frequencyHz,
m=this.m_mass*l*l;this.m_gamma=a.dt*(2*this.m_mass*this.m_dampingRatio*l+a.dt*m);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_bias=c*a.dt*m*this.m_gamma;this.m_mass=b+this.m_gamma;this.m_mass=0!=this.m_mass?1/this.m_mass:0}a.warmStarting?(this.m_impulse*=a.dtRatio,a=this.m_impulse*this.m_u.x,b=this.m_impulse*this.m_u.y,d.m_linearVelocity.x-=d.m_invMass*a,d.m_linearVelocity.y-=d.m_invMass*b,d.m_angularVelocity-=d.m_invI*(f*b-g*a),e.m_linearVelocity.x+=e.m_invMass*a,e.m_linearVelocity.y+=e.m_invMass*
b,e.m_angularVelocity+=e.m_invI*(k*b-h*a)):this.m_impulse=0},solveVelocityConstraints:function(a){var b;a=this.m_bodyA;var c=this.m_bodyB;b=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=b.col1.x*d+b.col2.x*e,e=b.col1.y*d+b.col2.y*e,d=f;b=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*k,k=b.col1.y*g+b.col2.y*k,g=f,f=-this.m_mass*(this.m_u.x*(c.m_linearVelocity.x+
-c.m_angularVelocity*k-(a.m_linearVelocity.x+-a.m_angularVelocity*e))+this.m_u.y*(c.m_linearVelocity.y+c.m_angularVelocity*g-(a.m_linearVelocity.y+a.m_angularVelocity*d))+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;b=f*this.m_u.x;f*=this.m_u.y;a.m_linearVelocity.x-=a.m_invMass*b;a.m_linearVelocity.y-=a.m_invMass*f;a.m_angularVelocity-=a.m_invI*(d*f-e*b);c.m_linearVelocity.x+=c.m_invMass*b;c.m_linearVelocity.y+=c.m_invMass*f;c.m_angularVelocity+=c.m_invI*(g*f-k*b)},solvePositionConstraints:function(a){var b;
if(0<this.m_frequencyHz)return!0;a=this.m_bodyA;var c=this.m_bodyB;b=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=b.col1.x*d+b.col2.x*e,e=b.col1.y*d+b.col2.y*e,d=f;b=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*k,k=b.col1.y*g+b.col2.y*k,g=f,f=c.m_sweep.c.x+g-a.m_sweep.c.x-d,h=c.m_sweep.c.y+k-a.m_sweep.c.y-e;b=Math.sqrt(f*f+h*h);f/=b;h/=b;b-=this.m_length;
b=q.clamp(b,-v.b2_maxLinearCorrection,v.b2_maxLinearCorrection);var l=-this.m_mass*b;this.m_u.set(f,h);f=l*this.m_u.x;h=l*this.m_u.y;a.m_sweep.c.x-=a.m_invMass*f;a.m_sweep.c.y-=a.m_invMass*h;a.m_sweep.a-=a.m_invI*(d*h-e*f);c.m_sweep.c.x+=c.m_invMass*f;c.m_sweep.c.y+=c.m_invMass*h;c.m_sweep.a+=c.m_invI*(g*h-k*f);a.synchronizeTransform();c.synchronizeTransform();return q.abs(b)<v.b2_linearSlop},__class__:Md});var ja=function(){this.type=Q.UNKNOWN_JOINT;this.bodyB=this.bodyA=this.userData=null;this.collideConnected=
!1};ja.__name__=["box2D","dynamics","joints","B2JointDef"];ja.prototype={__class__:ja};var Nd=function(){ja.call(this);this.localAnchorA=new t;this.localAnchorB=new t;this.type=Q.DISTANCE_JOINT;this.length=1;this.dampingRatio=this.frequencyHz=0};Nd.__name__=["box2D","dynamics","joints","B2DistanceJointDef"];Nd.__super__=ja;Nd.prototype=p(ja.prototype,{initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(d));
a=d.x-c.x;c=d.y-c.y;this.length=Math.sqrt(a*a+c*c);this.dampingRatio=this.frequencyHz=0},__class__:Nd});var Xd=function(a){da.call(this,a);this.m_localAnchorA=new t;this.m_localAnchorB=new t;this.m_linearMass=new ha;this.m_linearImpulse=new t;this.m_localAnchorA.setV(a.localAnchorA);this.m_localAnchorB.setV(a.localAnchorB);this.m_linearMass.setZero();this.m_angularMass=0;this.m_linearImpulse.setZero();this.m_angularImpulse=0;this.m_maxForce=a.maxForce;this.m_maxTorque=a.maxTorque};Xd.__name__=["box2D",
"dynamics","joints","B2FrictionJoint"];Xd.__super__=da;Xd.prototype=p(da.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},getReactionForce:function(a){return new t(a*this.m_linearImpulse.x,a*this.m_linearImpulse.y)},getReactionTorque:function(a){return a*this.m_angularImpulse},setMaxForce:function(a){this.m_maxForce=a},getMaxForce:function(){return this.m_maxForce},setMaxTorque:function(a){this.m_maxTorque=
a},getMaxTorque:function(){return this.m_maxTorque},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchorB.x-e.m_sweep.localCenter.x,h=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;b=d.m_invMass;c=e.m_invMass;var l=d.m_invI,m=e.m_invI,
u=new ha;u.col1.x=b+c;u.col2.x=0;u.col1.y=0;u.col2.y=b+c;u.col1.x+=l*g*g;u.col2.x+=-l*f*g;u.col1.y+=-l*f*g;u.col2.y+=l*f*f;u.col1.x+=m*h*h;u.col2.x+=-m*k*h;u.col1.y+=-m*k*h;u.col2.y+=m*k*k;u.getInverse(this.m_linearMass);this.m_angularMass=l+m;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);a.warmStarting?(this.m_linearImpulse.x*=a.dtRatio,this.m_linearImpulse.y*=a.dtRatio,this.m_angularImpulse*=a.dtRatio,a=this.m_linearImpulse,d.m_linearVelocity.x-=b*a.x,d.m_linearVelocity.y-=b*a.y,
d.m_angularVelocity-=l*(f*a.y-g*a.x+this.m_angularImpulse),e.m_linearVelocity.x+=c*a.x,e.m_linearVelocity.y+=c*a.y,e.m_angularVelocity+=m*(k*a.y-h*a.x+this.m_angularImpulse)):(this.m_linearImpulse.setZero(),this.m_angularImpulse=0)},solveVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB,f=d.m_linearVelocity,g=d.m_angularVelocity,k=e.m_linearVelocity,h=e.m_angularVelocity,l=d.m_invMass,m=e.m_invMass,u=d.m_invI,n=e.m_invI;b=d.m_xf.R;var r=this.m_localAnchorA.x-d.m_sweep.localCenter.x,
p=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*r+b.col2.x*p;p=b.col1.y*r+b.col2.y*p;r=c;b=e.m_xf.R;var s=this.m_localAnchorB.x-e.m_sweep.localCenter.x,v=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*s+b.col2.x*v;v=b.col1.y*s+b.col2.y*v;s=c;c=-this.m_angularMass*(h-g);var w=this.m_angularImpulse;b=a.dt*this.m_maxTorque;this.m_angularImpulse=q.clamp(this.m_angularImpulse+c,-b,b);c=this.m_angularImpulse-w;g-=u*c;h+=n*c;b=q.mulMV(this.m_linearMass,new t(-(k.x-h*v-f.x+g*p),-(k.y+
h*s-f.y-g*r)));c=this.m_linearImpulse.copy();this.m_linearImpulse.add(b);b=a.dt*this.m_maxForce;this.m_linearImpulse.lengthSquared()>b*b&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.multiply(b));b=q.subtractVV(this.m_linearImpulse,c);f.x-=l*b.x;f.y-=l*b.y;g-=u*(r*b.y-p*b.x);k.x+=m*b.x;k.y+=m*b.y;h+=n*(s*b.y-v*b.x);d.m_angularVelocity=g;e.m_angularVelocity=h},solvePositionConstraints:function(a){return!0},__class__:Xd});var Yd=function(){ja.call(this);this.localAnchorA=new t;this.localAnchorB=
new t;this.type=Q.FRICTION_JOINT;this.maxTorque=this.maxForce=0};Yd.__name__=["box2D","dynamics","joints","B2FrictionJointDef"];Yd.__super__=ja;Yd.prototype=p(ja.prototype,{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(c))},__class__:Yd});var Rd=function(a){da.call(this,a);this.m_groundAnchor1=new t;this.m_groundAnchor2=new t;this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_J=new hf;
var b=a.joint1.m_type,c=a.joint2.m_type;this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;this.m_ground1=a.joint1.getBodyA();this.m_bodyA=a.joint1.getBodyB();b==Q.REVOLUTE_JOINT?(this.m_revolute1=C.__cast(a.joint1,mb),this.m_groundAnchor1.setV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.setV(this.m_revolute1.m_localAnchor2),b=this.m_revolute1.getJointAngle()):(this.m_prismatic1=C.__cast(a.joint1,mc),this.m_groundAnchor1.setV(this.m_prismatic1.m_localAnchor1),this.m_localAnchor1.setV(this.m_prismatic1.m_localAnchor2),
b=this.m_prismatic1.getJointTranslation());this.m_ground2=a.joint2.getBodyA();this.m_bodyB=a.joint2.getBodyB();c==Q.REVOLUTE_JOINT?(this.m_revolute2=C.__cast(a.joint2,mb),this.m_groundAnchor2.setV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.setV(this.m_revolute2.m_localAnchor2),c=this.m_revolute2.getJointAngle()):(this.m_prismatic2=C.__cast(a.joint2,mc),this.m_groundAnchor2.setV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.setV(this.m_prismatic2.m_localAnchor2),c=this.m_prismatic2.getJointTranslation());
this.m_ratio=a.ratio;this.m_constant=b+this.m_ratio*c;this.m_impulse=0};Rd.__name__=["box2D","dynamics","joints","B2GearJoint"];Rd.__super__=da;Rd.prototype=p(da.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*this.m_impulse*this.m_J.linearB.x,a*this.m_impulse*this.m_J.linearB.y)},getReactionTorque:function(a){var b=this.m_bodyB.m_xf.R,
c=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,d=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,e=b.col1.x*c+b.col2.x*d,d=b.col1.y*c+b.col2.y*d;return a*(this.m_impulse*this.m_J.angularB-e*this.m_impulse*this.m_J.linearB.y+d*this.m_impulse*this.m_J.linearB.x)},getRatio:function(){return this.m_ratio},setRatio:function(a){this.m_ratio=a},initVelocityConstraints:function(a){var b=this.m_ground1,c=this.m_ground2,d=this.m_bodyA,e=this.m_bodyB,f,g,k,h,l,m=0;this.m_J.setZero();null!=
this.m_revolute1?(this.m_J.angularA=-1,m+=d.m_invI):(h=b.m_xf.R,f=this.m_prismatic1.m_localXAxis1,b=h.col1.x*f.x+h.col2.x*f.y,f=h.col1.y*f.x+h.col2.y*f.y,h=d.m_xf.R,g=this.m_localAnchor1.x-d.m_sweep.localCenter.x,k=this.m_localAnchor1.y-d.m_sweep.localCenter.y,l=h.col1.x*g+h.col2.x*k,k=h.col1.y*g+h.col2.y*k,h=l*f-k*b,this.m_J.linearA.set(-b,-f),this.m_J.angularA=-h,m+=d.m_invMass+d.m_invI*h*h);null!=this.m_revolute2?(this.m_J.angularB=-this.m_ratio,m+=this.m_ratio*this.m_ratio*e.m_invI):(h=c.m_xf.R,
f=this.m_prismatic2.m_localXAxis1,b=h.col1.x*f.x+h.col2.x*f.y,f=h.col1.y*f.x+h.col2.y*f.y,h=e.m_xf.R,g=this.m_localAnchor2.x-e.m_sweep.localCenter.x,k=this.m_localAnchor2.y-e.m_sweep.localCenter.y,l=h.col1.x*g+h.col2.x*k,k=h.col1.y*g+h.col2.y*k,h=l*f-k*b,this.m_J.linearB.set(-this.m_ratio*b,-this.m_ratio*f),this.m_J.angularB=-this.m_ratio*h,m+=this.m_ratio*this.m_ratio*(e.m_invMass+e.m_invI*h*h));this.m_mass=0<m?1/m:0;a.warmStarting?(d.m_linearVelocity.x+=d.m_invMass*this.m_impulse*this.m_J.linearA.x,
d.m_linearVelocity.y+=d.m_invMass*this.m_impulse*this.m_J.linearA.y,d.m_angularVelocity+=d.m_invI*this.m_impulse*this.m_J.angularA,e.m_linearVelocity.x+=e.m_invMass*this.m_impulse*this.m_J.linearB.x,e.m_linearVelocity.y+=e.m_invMass*this.m_impulse*this.m_J.linearB.y,e.m_angularVelocity+=e.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},solveVelocityConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=this.m_J.compute(a.m_linearVelocity,a.m_angularVelocity,b.m_linearVelocity,b.m_angularVelocity),
c=-this.m_mass*c;this.m_impulse+=c;a.m_linearVelocity.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_linearVelocity.y+=a.m_invMass*c*this.m_J.linearA.y;a.m_angularVelocity+=a.m_invI*c*this.m_J.angularA;b.m_linearVelocity.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_linearVelocity.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_angularVelocity+=b.m_invI*c*this.m_J.angularB},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c,d;c=null!=this.m_revolute1?this.m_revolute1.getJointAngle():this.m_prismatic1.getJointTranslation();
d=null!=this.m_revolute2?this.m_revolute2.getJointAngle():this.m_prismatic2.getJointTranslation();c=-this.m_mass*(this.m_constant-(c+this.m_ratio*d));a.m_sweep.c.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_sweep.c.y+=a.m_invMass*c*this.m_J.linearA.y;a.m_sweep.a+=a.m_invI*c*this.m_J.angularA;b.m_sweep.c.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_sweep.c.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_sweep.a+=b.m_invI*c*this.m_J.angularB;a.synchronizeTransform();b.synchronizeTransform();return 0<v.b2_linearSlop},
__class__:Rd});var Sd=function(){ja.call(this);this.type=Q.GEAR_JOINT;this.joint2=this.joint1=null;this.ratio=1};Sd.__name__=["box2D","dynamics","joints","B2GearJointDef"];Sd.__super__=ja;Sd.prototype=p(ja.prototype,{__class__:Sd});var hf=function(){this.linearA=new t;this.linearB=new t};hf.__name__=["box2D","dynamics","joints","B2Jacobian"];hf.prototype={setZero:function(){this.linearA.setZero();this.angularA=0;this.linearB.setZero();this.angularB=0},set:function(a,b,c,d){this.linearA.setV(a);this.angularA=
b;this.linearB.setV(c);this.angularB=d},compute:function(a,b,c,d){return this.linearA.x*a.x+this.linearA.y*a.y+this.angularA*b+(this.linearB.x*c.x+this.linearB.y*c.y)+this.angularB*d},__class__:hf};var Jd=function(){};Jd.__name__=["box2D","dynamics","joints","B2JointEdge"];Jd.prototype={__class__:Jd};var Q={__ename__:!0,__constructs__:"UNKNOWN_JOINT REVOLUTE_JOINT PRISMATIC_JOINT DISTANCE_JOINT PULLEY_JOINT MOUSE_JOINT GEAR_JOINT LINE_JOINT WELD_JOINT FRICTION_JOINT".split(" "),UNKNOWN_JOINT:["UNKNOWN_JOINT",
0]};Q.UNKNOWN_JOINT.__enum__=Q;Q.REVOLUTE_JOINT=["REVOLUTE_JOINT",1];Q.REVOLUTE_JOINT.__enum__=Q;Q.PRISMATIC_JOINT=["PRISMATIC_JOINT",2];Q.PRISMATIC_JOINT.__enum__=Q;Q.DISTANCE_JOINT=["DISTANCE_JOINT",3];Q.DISTANCE_JOINT.__enum__=Q;Q.PULLEY_JOINT=["PULLEY_JOINT",4];Q.PULLEY_JOINT.__enum__=Q;Q.MOUSE_JOINT=["MOUSE_JOINT",5];Q.MOUSE_JOINT.__enum__=Q;Q.GEAR_JOINT=["GEAR_JOINT",6];Q.GEAR_JOINT.__enum__=Q;Q.LINE_JOINT=["LINE_JOINT",7];Q.LINE_JOINT.__enum__=Q;Q.WELD_JOINT=["WELD_JOINT",8];Q.WELD_JOINT.__enum__=
Q;Q.FRICTION_JOINT=["FRICTION_JOINT",9];Q.FRICTION_JOINT.__enum__=Q;Q.__empty_constructs__=[Q.UNKNOWN_JOINT,Q.REVOLUTE_JOINT,Q.PRISMATIC_JOINT,Q.DISTANCE_JOINT,Q.PULLEY_JOINT,Q.MOUSE_JOINT,Q.GEAR_JOINT,Q.LINE_JOINT,Q.WELD_JOINT,Q.FRICTION_JOINT];var H={__ename__:!0,__constructs__:["INACTIVE_LIMIT","AT_LOWER_LIMIT","AT_UPPER_LIMIT","EQUAL_LIMITS"],INACTIVE_LIMIT:["INACTIVE_LIMIT",0]};H.INACTIVE_LIMIT.__enum__=H;H.AT_LOWER_LIMIT=["AT_LOWER_LIMIT",1];H.AT_LOWER_LIMIT.__enum__=H;H.AT_UPPER_LIMIT=["AT_UPPER_LIMIT",
2];H.AT_UPPER_LIMIT.__enum__=H;H.EQUAL_LIMITS=["EQUAL_LIMITS",3];H.EQUAL_LIMITS.__enum__=H;H.__empty_constructs__=[H.INACTIVE_LIMIT,H.AT_LOWER_LIMIT,H.AT_UPPER_LIMIT,H.EQUAL_LIMITS];var Td=function(a){da.call(this,a);this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_localXAxis1=new t;this.m_localYAxis1=new t;this.m_axis=new t;this.m_perp=new t;this.m_K=new ha;this.m_impulse=new t;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_localXAxis1.setV(a.localAxisA);
this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.setZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=H.INACTIVE_LIMIT;this.m_axis.setZero();this.m_perp.setZero()};Td.__name__=["box2D","dynamics","joints","B2LineJoint"];
Td.__super__=da;Td.prototype=p(da.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},getReactionTorque:function(a){return a*this.m_impulse.y},getJointTranslation:function(){var a=
this.m_bodyA,b=this.m_bodyB,c=a.getWorldPoint(this.m_localAnchor1),d=b.getWorldPoint(this.m_localAnchor2),b=d.x-c.x,c=d.y-c.y,a=a.getWorldVector(this.m_localXAxis1);return a.x*b+a.y*c},getJointSpeed:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,
f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,c=b.m_sweep.c.x+g-(a.m_sweep.c.x+d),f=b.m_sweep.c.y+k-(a.m_sweep.c.y+e),h=a.getWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*h.y+f*a*h.x+(h.x*(m.x+-b*k-l.x- -a*e)+h.y*(m.y+b*g-l.y-a*d))},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableLimit=a},getLowerLimit:function(){return this.m_lowerTranslation},
getUpperLimit:function(){return this.m_upperTranslation},setLimits:function(a,b){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b},isMotorEnabled:function(){return this.m_enableMotor},enableMotor:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorForce:function(a){this.m_bodyA.setAwake(!0);
this.m_bodyB.setAwake(!0);this.m_maxMotorForce=a},getMaxMotorForce:function(){return this.m_maxMotorForce},getMotorForce:function(){return this.m_motorImpulse},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;this.m_localCenterA.setV(b.getLocalCenter());this.m_localCenterB.setV(c.getLocalCenter());var f=b.getTransform();c.getTransform();d=b.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-this.m_localCenterA.y;e=d.col1.x*g+d.col2.x*k;k=d.col1.y*
g+d.col2.y*k;g=e;d=c.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,l=this.m_localAnchor2.y-this.m_localCenterB.y;e=d.col1.x*h+d.col2.x*l;l=d.col1.y*h+d.col2.y*l;h=e;d=c.m_sweep.c.x+h-b.m_sweep.c.x-g;e=c.m_sweep.c.y+l-b.m_sweep.c.y-k;this.m_invMassA=b.m_invMass;this.m_invMassB=c.m_invMass;this.m_invIA=b.m_invI;this.m_invIB=c.m_invI;this.m_axis.setV(q.mulMV(f.R,this.m_localXAxis1));this.m_a1=(d+g)*this.m_axis.y-(e+k)*this.m_axis.x;this.m_a2=h*this.m_axis.y-l*this.m_axis.x;this.m_motorMass=
this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.setV(q.mulMV(f.R,this.m_localYAxis1));this.m_s1=(d+g)*this.m_perp.y-(e+k)*this.m_perp.x;this.m_s2=h*this.m_perp.y-l*this.m_perp.x;f=this.m_invMassA;g=this.m_invMassB;k=this.m_invIA;h=this.m_invIB;this.m_K.col1.x=f+g+k*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2;this.m_K.col1.y=k*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2;
this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=f+g+k*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*e,q.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?this.m_limitState=H.EQUAL_LIMITS:d<=this.m_lowerTranslation?this.m_limitState!=H.AT_LOWER_LIMIT&&(this.m_limitState=H.AT_LOWER_LIMIT,this.m_impulse.y=0):d>=this.m_upperTranslation?this.m_limitState!=H.AT_UPPER_LIMIT&&(this.m_limitState=H.AT_UPPER_LIMIT,this.m_impulse.y=0):(this.m_limitState=
H.INACTIVE_LIMIT,this.m_impulse.y=0)):this.m_limitState=H.INACTIVE_LIMIT;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,e=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,f=this.m_impulse.x*this.m_s2+
(this.m_motorImpulse+this.m_impulse.y)*this.m_a2,b.m_linearVelocity.x-=this.m_invMassA*a,b.m_linearVelocity.y-=this.m_invMassA*d,b.m_angularVelocity-=this.m_invIA*e,c.m_linearVelocity.x+=this.m_invMassB*a,c.m_linearVelocity.y+=this.m_invMassB*d,c.m_angularVelocity+=this.m_invIB*f):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,f=c.m_linearVelocity,g=c.m_angularVelocity,k,h,l;this.m_enableMotor&&
this.m_limitState!=H.EQUAL_LIMITS&&(l=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e)),k=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=q.clamp(this.m_motorImpulse+l,-a,a),l=this.m_motorImpulse-k,k=l*this.m_axis.x,a=l*this.m_axis.y,h=l*this.m_a1,l*=this.m_a2,d.x-=this.m_invMassA*k,d.y-=this.m_invMassA*a,e-=this.m_invIA*h,f.x+=this.m_invMassB*k,f.y+=this.m_invMassB*a,g+=this.m_invIB*l);a=this.m_perp.x*(f.x-d.x)+this.m_perp.y*
(f.y-d.y)+this.m_s2*g-this.m_s1*e;this.m_enableLimit&&this.m_limitState!=H.INACTIVE_LIMIT?(h=this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e,k=this.m_impulse.copy(),l=this.m_K.solve(new t,-a,-h),this.m_impulse.add(l),this.m_limitState==H.AT_LOWER_LIMIT?this.m_impulse.y=q.max(this.m_impulse.y,0):this.m_limitState==H.AT_UPPER_LIMIT&&(this.m_impulse.y=q.min(this.m_impulse.y,0)),a=-a-(this.m_impulse.y-k.y)*this.m_K.col2.x,this.m_impulse.x=0!=this.m_K.col1.x?a/this.m_K.col1.x+k.x:
k.x,l.x=this.m_impulse.x-k.x,l.y=this.m_impulse.y-k.y,k=l.x*this.m_perp.x+l.y*this.m_axis.x,a=l.x*this.m_perp.y+l.y*this.m_axis.y,h=l.x*this.m_s1+l.y*this.m_a1,l=l.x*this.m_s2+l.y*this.m_a2):(l=0!=this.m_K.col1.x?-a/this.m_K.col1.x:0,this.m_impulse.x+=l,k=l*this.m_perp.x,a=l*this.m_perp.y,h=l*this.m_s1,l*=this.m_s2);d.x-=this.m_invMassA*k;d.y-=this.m_invMassA*a;e-=this.m_invIA*h;f.x+=this.m_invMassB*k;f.y+=this.m_invMassB*a;g+=this.m_invIB*l;b.m_linearVelocity.setV(d);b.m_angularVelocity=e;c.m_linearVelocity.setV(f);
c.m_angularVelocity=g},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=a.m_sweep.c,d=a.m_sweep.a,e=b.m_sweep.c,f=b.m_sweep.a,g,k,h,l,m,u=0,n=0;h=!1;var r=0,p=ha.fromAngle(d);l=ha.fromAngle(f);g=p;var n=this.m_localAnchor1.x-this.m_localCenterA.x,s=this.m_localAnchor1.y-this.m_localCenterA.y;k=g.col1.x*n+g.col2.x*s;s=g.col1.y*n+g.col2.y*s;n=k;g=l;l=this.m_localAnchor2.x-this.m_localCenterB.x;m=this.m_localAnchor2.y-this.m_localCenterB.y;k=g.col1.x*l+g.col2.x*m;m=g.col1.y*l+
g.col2.y*m;l=k;g=e.x+l-c.x-n;k=e.y+m-c.y-s;if(this.m_enableLimit){this.m_axis=q.mulMV(p,this.m_localXAxis1);this.m_a1=(g+n)*this.m_axis.y-(k+s)*this.m_axis.x;this.m_a2=l*this.m_axis.y-m*this.m_axis.x;var w=this.m_axis.x*g+this.m_axis.y*k;q.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?(r=q.clamp(w,-v.b2_maxLinearCorrection,v.b2_maxLinearCorrection),u=q.abs(w),h=!0):w<=this.m_lowerTranslation?(r=q.clamp(w-this.m_lowerTranslation+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),
u=this.m_lowerTranslation-w,h=!0):w>=this.m_upperTranslation&&(r=q.clamp(w-this.m_upperTranslation+v.b2_linearSlop,0,v.b2_maxLinearCorrection),u=w-this.m_upperTranslation,h=!0)}this.m_perp=q.mulMV(p,this.m_localYAxis1);this.m_s1=(g+n)*this.m_perp.y-(k+s)*this.m_perp.x;this.m_s2=l*this.m_perp.y-m*this.m_perp.x;p=new t;s=this.m_perp.x*g+this.m_perp.y*k;u=q.max(u,q.abs(s));n=0;h?(h=this.m_invMassA,l=this.m_invMassB,m=this.m_invIA,g=this.m_invIB,this.m_K.col1.x=h+l+m*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,
this.m_K.col1.y=m*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=h+l+m*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_K.solve(p,-s,-r)):(h=this.m_invMassA,l=this.m_invMassB,m=this.m_invIA,g=this.m_invIB,r=h+l+m*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,p.x=0!=r?-s/r:0,p.y=0);r=p.x*this.m_perp.x+p.y*this.m_axis.x;h=p.x*this.m_perp.y+p.y*this.m_axis.y;s=p.x*this.m_s1+p.y*this.m_a1;p=p.x*this.m_s2+p.y*this.m_a2;c.x-=this.m_invMassA*r;c.y-=this.m_invMassA*
h;d-=this.m_invIA*s;e.x+=this.m_invMassB*r;e.y+=this.m_invMassB*h;f+=this.m_invIB*p;a.m_sweep.a=d;b.m_sweep.a=f;a.synchronizeTransform();b.synchronizeTransform();return u<=v.b2_linearSlop?n<=v.b2_angularSlop:!1},__class__:Td});var Ud=function(){ja.call(this)};Ud.__name__=["box2D","dynamics","joints","B2LineJointDef"];Ud.__super__=ja;Ud.prototype=p(ja.prototype,{b2LineJointDef:function(){this.localAnchorA=new t;this.localAnchorB=new t;this.localAxisA=new t;this.type=Q.LINE_JOINT;this.localAxisA.set(1,
0);this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0},initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.localAxisA=this.bodyA.getLocalVector(d)},__class__:Ud});var Pd=function(a){da.call(this,a);this.K=new ha;this.K1=new ha;this.K2=new ha;this.m_localAnchor=new t;this.m_target=new t;this.m_impulse=new t;this.m_mass=new ha;this.m_C=
new t;this.m_target.setV(a.target);var b=this.m_target.x-this.m_bodyB.m_xf.position.x,c=this.m_target.y-this.m_bodyB.m_xf.position.y,d=this.m_bodyB.m_xf.R;this.m_localAnchor.x=b*d.col1.x+c*d.col1.y;this.m_localAnchor.y=b*d.col2.x+c*d.col2.y;this.m_maxForce=a.maxForce;this.m_impulse.setZero();this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_gamma=this.m_beta=0};Pd.__name__=["box2D","dynamics","joints","B2MouseJoint"];Pd.__super__=da;Pd.prototype=p(da.prototype,{getAnchorA:function(){return this.m_target},
getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor)},getReactionForce:function(a){return new t(a*this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return 0},getTarget:function(){return this.m_target},setTarget:function(a){!1==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0);this.m_target=a},getMaxForce:function(){return this.m_maxForce},setMaxForce:function(a){this.m_maxForce=a},getFrequency:function(){return this.m_frequencyHz},setFrequency:function(a){this.m_frequencyHz=
a},getDampingRatio:function(){return this.m_dampingRatio},setDampingRatio:function(a){this.m_dampingRatio=a},initVelocityConstraints:function(a){var b=this.m_bodyB,c=b.getMass(),d=2*Math.PI*this.m_frequencyHz,e=c*d*d;this.m_gamma=a.dt*(2*c*this.m_dampingRatio*d+a.dt*e);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_beta=a.dt*e*this.m_gamma;var e=b.m_xf.R,c=this.m_localAnchor.x-b.m_sweep.localCenter.x,d=this.m_localAnchor.y-b.m_sweep.localCenter.y,f=e.col1.x*c+e.col2.x*d,d=e.col1.y*c+e.col2.y*
d,c=f,e=b.m_invMass,f=b.m_invI;this.K1.col1.x=e;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=e;this.K2.col1.x=f*d*d;this.K2.col2.x=-f*c*d;this.K2.col1.y=-f*c*d;this.K2.col2.y=f*c*c;this.K.setM(this.K1);this.K.addM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.getInverse(this.m_mass);this.m_C.x=b.m_sweep.c.x+c-this.m_target.x;this.m_C.y=b.m_sweep.c.y+d-this.m_target.y;b.m_angularVelocity*=0.98;this.m_impulse.x*=a.dtRatio;this.m_impulse.y*=a.dtRatio;b.m_linearVelocity.x+=
e*this.m_impulse.x;b.m_linearVelocity.y+=e*this.m_impulse.y;b.m_angularVelocity+=f*(c*this.m_impulse.y-d*this.m_impulse.x)},solveVelocityConstraints:function(a){var b=this.m_bodyB,c,d,e;c=b.m_xf.R;var f=this.m_localAnchor.x-b.m_sweep.localCenter.x,g=this.m_localAnchor.y-b.m_sweep.localCenter.y;d=c.col1.x*f+c.col2.x*g;g=c.col1.y*f+c.col2.y*g;f=d;d=b.m_linearVelocity.x+-b.m_angularVelocity*g;var k=b.m_linearVelocity.y+b.m_angularVelocity*f;c=this.m_mass;d=d+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;
e=k+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;k=-(c.col1.x*d+c.col2.x*e);e=-(c.col1.y*d+c.col2.y*e);c=this.m_impulse.x;d=this.m_impulse.y;this.m_impulse.x+=k;this.m_impulse.y+=e;a=a.dt*this.m_maxForce;this.m_impulse.lengthSquared()>a*a&&this.m_impulse.multiply(a/this.m_impulse.length());k=this.m_impulse.x-c;e=this.m_impulse.y-d;b.m_linearVelocity.x+=b.m_invMass*k;b.m_linearVelocity.y+=b.m_invMass*e;b.m_angularVelocity+=b.m_invI*(f*e-g*k)},solvePositionConstraints:function(a){return!0},
__class__:Pd});var Qd=function(){ja.call(this);this.target=new t;this.type=Q.MOUSE_JOINT;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=0.7};Qd.__name__=["box2D","dynamics","joints","B2MouseJointDef"];Qd.__super__=ja;Qd.prototype=p(ja.prototype,{__class__:Qd});var mc=function(a){da.call(this,a);this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_localXAxis1=new t;this.m_localYAxis1=new t;this.m_axis=new t;this.m_perp=new t;this.m_K=new Vb;this.m_impulse=new Ka;this.m_localAnchor1.setV(a.localAnchorA);
this.m_localAnchor2.setV(a.localAnchorB);this.m_localXAxis1.setV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=a.referenceAngle;this.m_impulse.setZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=H.INACTIVE_LIMIT;
this.m_axis.setZero();this.m_perp.setZero()};mc.__name__=["box2D","dynamics","joints","B2PrismaticJoint"];mc.__super__=da;mc.prototype=p(da.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*
this.m_axis.y))},getReactionTorque:function(a){return a*this.m_impulse.y},getJointTranslation:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.getWorldPoint(this.m_localAnchor1),d=b.getWorldPoint(this.m_localAnchor2),b=d.x-c.x,c=d.y-c.y,a=a.getWorldVector(this.m_localXAxis1);return a.x*b+a.y*c},getJointSpeed:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*
e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,c=b.m_sweep.c.x+g-(a.m_sweep.c.x+d),f=b.m_sweep.c.y+k-(a.m_sweep.c.y+e),h=a.getWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*h.y+f*a*h.x+(h.x*(m.x+-b*k-l.x- -a*e)+h.y*(m.y+b*g-l.y-a*d))},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_bodyA.setAwake(!0);
this.m_bodyB.setAwake(!0);this.m_enableLimit=a},getLowerLimit:function(){return this.m_lowerTranslation},getUpperLimit:function(){return this.m_upperTranslation},setLimits:function(a,b){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b},isMotorEnabled:function(){return this.m_enableMotor},enableMotor:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);
this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorForce:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_maxMotorForce=a},getMotorForce:function(){return this.m_motorImpulse},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;this.m_localCenterA.setV(b.getLocalCenter());this.m_localCenterB.setV(c.getLocalCenter());var f=b.getTransform();c.getTransform();d=b.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-
this.m_localCenterA.y;e=d.col1.x*g+d.col2.x*k;k=d.col1.y*g+d.col2.y*k;g=e;d=c.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,l=this.m_localAnchor2.y-this.m_localCenterB.y;e=d.col1.x*h+d.col2.x*l;l=d.col1.y*h+d.col2.y*l;h=e;d=c.m_sweep.c.x+h-b.m_sweep.c.x-g;e=c.m_sweep.c.y+l-b.m_sweep.c.y-k;this.m_invMassA=b.m_invMass;this.m_invMassB=c.m_invMass;this.m_invIA=b.m_invI;this.m_invIB=c.m_invI;this.m_axis.setV(q.mulMV(f.R,this.m_localXAxis1));this.m_a1=(d+g)*this.m_axis.y-(e+k)*this.m_axis.x;
this.m_a2=h*this.m_axis.y-l*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass);this.m_perp.setV(q.mulMV(f.R,this.m_localYAxis1));this.m_s1=(d+g)*this.m_perp.y-(e+k)*this.m_perp.x;this.m_s2=h*this.m_perp.y-l*this.m_perp.x;f=this.m_invMassA;g=this.m_invMassB;k=this.m_invIA;h=this.m_invIB;this.m_K.col1.x=f+g+k*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2;
this.m_K.col1.y=k*this.m_s1+h*this.m_s2;this.m_K.col1.z=k*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=k+h;this.m_K.col2.z=k*this.m_a1+h*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=f+g+k*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*e,q.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?this.m_limitState=H.EQUAL_LIMITS:d<=this.m_lowerTranslation?
this.m_limitState!=H.AT_LOWER_LIMIT&&(this.m_limitState=H.AT_LOWER_LIMIT,this.m_impulse.z=0):d>=this.m_upperTranslation?this.m_limitState!=H.AT_UPPER_LIMIT&&(this.m_limitState=H.AT_UPPER_LIMIT,this.m_impulse.z=0):(this.m_limitState=H.INACTIVE_LIMIT,this.m_impulse.z=0)):this.m_limitState=H.INACTIVE_LIMIT;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+
this.m_impulse.z)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,e=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,f=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,b.m_linearVelocity.x-=this.m_invMassA*a,b.m_linearVelocity.y-=this.m_invMassA*d,b.m_angularVelocity-=this.m_invIA*e,c.m_linearVelocity.x+=this.m_invMassB*a,c.m_linearVelocity.y+=this.m_invMassB*
d,c.m_angularVelocity+=this.m_invIB*f):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,f=c.m_linearVelocity,g=c.m_angularVelocity,k,h,l;this.m_enableMotor&&this.m_limitState!=H.EQUAL_LIMITS&&(l=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e)),k=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=q.clamp(this.m_motorImpulse+
l,-a,a),l=this.m_motorImpulse-k,k=l*this.m_axis.x,a=l*this.m_axis.y,h=l*this.m_a1,l*=this.m_a2,d.x-=this.m_invMassA*k,d.y-=this.m_invMassA*a,e-=this.m_invIA*h,f.x+=this.m_invMassB*k,f.y+=this.m_invMassB*a,g+=this.m_invIB*l);h=this.m_perp.x*(f.x-d.x)+this.m_perp.y*(f.y-d.y)+this.m_s2*g-this.m_s1*e;a=g-e;this.m_enableLimit&&this.m_limitState!=H.INACTIVE_LIMIT?(l=this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e,k=this.m_impulse.copy(),l=this.m_K.solve33(new Ka,-h,-a,-l),this.m_impulse.add(l),
this.m_limitState==H.AT_LOWER_LIMIT?this.m_impulse.z=q.max(this.m_impulse.z,0):this.m_limitState==H.AT_UPPER_LIMIT&&(this.m_impulse.z=q.min(this.m_impulse.z,0)),h=-h-(this.m_impulse.z-k.z)*this.m_K.col3.x,a=-a-(this.m_impulse.z-k.z)*this.m_K.col3.y,a=this.m_K.solve22(new t,h,a),a.x+=k.x,a.y+=k.y,this.m_impulse.x=a.x,this.m_impulse.y=a.y,l.x=this.m_impulse.x-k.x,l.y=this.m_impulse.y-k.y,l.z=this.m_impulse.z-k.z,k=l.x*this.m_perp.x+l.z*this.m_axis.x,a=l.x*this.m_perp.y+l.z*this.m_axis.y,h=l.x*this.m_s1+
l.y+l.z*this.m_a1,l=l.x*this.m_s2+l.y+l.z*this.m_a2):(l=this.m_K.solve22(new t,-h,-a),this.m_impulse.x+=l.x,this.m_impulse.y+=l.y,k=l.x*this.m_perp.x,a=l.x*this.m_perp.y,h=l.x*this.m_s1+l.y,l=l.x*this.m_s2+l.y);d.x-=this.m_invMassA*k;d.y-=this.m_invMassA*a;e-=this.m_invIA*h;f.x+=this.m_invMassB*k;f.y+=this.m_invMassB*a;g+=this.m_invIB*l;b.m_linearVelocity.setV(d);b.m_angularVelocity=e;c.m_linearVelocity.setV(f);c.m_angularVelocity=g},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,
c=a.m_sweep.c,d=a.m_sweep.a,e=b.m_sweep.c,f=b.m_sweep.a,g,k,h,l,m=0,u=0;h=!1;var n=0,p=ha.fromAngle(d),r=ha.fromAngle(f);g=p;var u=this.m_localAnchor1.x-this.m_localCenterA.x,s=this.m_localAnchor1.y-this.m_localCenterA.y;k=g.col1.x*u+g.col2.x*s;s=g.col1.y*u+g.col2.y*s;u=k;g=r;r=this.m_localAnchor2.x-this.m_localCenterB.x;l=this.m_localAnchor2.y-this.m_localCenterB.y;k=g.col1.x*r+g.col2.x*l;l=g.col1.y*r+g.col2.y*l;r=k;g=e.x+r-c.x-u;k=e.y+l-c.y-s;if(this.m_enableLimit){this.m_axis=q.mulMV(p,this.m_localXAxis1);
this.m_a1=(g+u)*this.m_axis.y-(k+s)*this.m_axis.x;this.m_a2=r*this.m_axis.y-l*this.m_axis.x;var w=this.m_axis.x*g+this.m_axis.y*k;q.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?(n=q.clamp(w,-v.b2_maxLinearCorrection,v.b2_maxLinearCorrection),m=q.abs(w),h=!0):w<=this.m_lowerTranslation?(n=q.clamp(w-this.m_lowerTranslation+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),m=this.m_lowerTranslation-w,h=!0):w>=this.m_upperTranslation&&(n=q.clamp(w-this.m_upperTranslation+v.b2_linearSlop,
0,v.b2_maxLinearCorrection),m=w-this.m_upperTranslation,h=!0)}this.m_perp=q.mulMV(p,this.m_localYAxis1);this.m_s1=(g+u)*this.m_perp.y-(k+s)*this.m_perp.x;this.m_s2=r*this.m_perp.y-l*this.m_perp.x;p=new Ka;s=this.m_perp.x*g+this.m_perp.y*k;r=f-d-this.m_refAngle;m=q.max(m,q.abs(s));u=q.abs(r);h?(h=this.m_invMassA,l=this.m_invMassB,g=this.m_invIA,k=this.m_invIB,this.m_K.col1.x=h+l+g*this.m_s1*this.m_s1+k*this.m_s2*this.m_s2,this.m_K.col1.y=g*this.m_s1+k*this.m_s2,this.m_K.col1.z=g*this.m_s1*this.m_a1+
k*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=g+k,this.m_K.col2.z=g*this.m_a1+k*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=h+l+g*this.m_a1*this.m_a1+k*this.m_a2*this.m_a2,this.m_K.solve33(p,-s,-r,-n)):(h=this.m_invMassA,l=this.m_invMassB,g=this.m_invIA,k=this.m_invIB,n=g*this.m_s1+k*this.m_s2,w=g+k,this.m_K.col1.set(h+l+g*this.m_s1*this.m_s1+k*this.m_s2*this.m_s2,n,0),this.m_K.col2.set(n,w,0),n=this.m_K.solve22(new t,-s,-r),p.x=
n.x,p.y=n.y,p.z=0);n=p.x*this.m_perp.x+p.z*this.m_axis.x;h=p.x*this.m_perp.y+p.z*this.m_axis.y;s=p.x*this.m_s1+p.y+p.z*this.m_a1;p=p.x*this.m_s2+p.y+p.z*this.m_a2;c.x-=this.m_invMassA*n;c.y-=this.m_invMassA*h;d-=this.m_invIA*s;e.x+=this.m_invMassB*n;e.y+=this.m_invMassB*h;f+=this.m_invIB*p;a.m_sweep.a=d;b.m_sweep.a=f;a.synchronizeTransform();b.synchronizeTransform();return m<=v.b2_linearSlop?u<=v.b2_angularSlop:!1},__class__:mc});var Ld=function(){ja.call(this);this.localAnchorA=new t;this.localAnchorB=
new t;this.localAxisA=new t;this.type=Q.PRISMATIC_JOINT;this.localAxisA.set(1,0);this.referenceAngle=0;this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};Ld.__name__=["box2D","dynamics","joints","B2PrismaticJointDef"];Ld.__super__=ja;Ld.prototype=p(ja.prototype,{initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.localAxisA=this.bodyA.getLocalVector(d);
this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:Ld});var lb=function(a){da.call(this,a);this.m_groundAnchor1=new t;this.m_groundAnchor2=new t;this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_u1=new t;this.m_u2=new t;this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=a.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=a.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=a.groundAnchorB.x-this.m_ground.m_xf.position.x;
this.m_groundAnchor2.y=a.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_ratio=a.ratio;this.m_constant=a.lengthA+this.m_ratio*a.lengthB;this.m_maxLength1=q.min(a.maxLengthA,this.m_constant-this.m_ratio*lb.b2_minPulleyLength);this.m_maxLength2=q.min(a.maxLengthB,(this.m_constant-lb.b2_minPulleyLength)/this.m_ratio);this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};lb.__name__=["box2D","dynamics","joints",
"B2PulleyJoint"];lb.__super__=da;lb.prototype=p(da.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*this.m_impulse*this.m_u2.x,a*this.m_impulse*this.m_u2.y)},getReactionTorque:function(a){return 0},getGroundAnchorA:function(){var a=this.m_ground.m_xf.position.copy();a.add(this.m_groundAnchor1);return a},getGroundAnchorB:function(){var a=
this.m_ground.m_xf.position.copy();a.add(this.m_groundAnchor2);return a},getLength1:function(){var a=this.m_bodyA.getWorldPoint(this.m_localAnchor1),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y);return Math.sqrt(b*b+a*a)},getLength2:function(){var a=this.m_bodyB.getWorldPoint(this.m_localAnchor2),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor2.y);return Math.sqrt(b*
b+a*a)},getRatio:function(){return this.m_ratio},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_xf.R,e=this.m_localAnchor1.x-b.m_sweep.localCenter.x,f=this.m_localAnchor1.y-b.m_sweep.localCenter.y,g=d.col1.x*e+d.col2.x*f,f=d.col1.y*e+d.col2.y*f,e=g,d=c.m_xf.R,k=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y,g=d.col1.x*k+d.col2.x*h,h=d.col1.y*k+d.col2.y*h,k=g,d=c.m_sweep.c.x+k,g=c.m_sweep.c.y+h,l=this.m_ground.m_xf.position.x+
this.m_groundAnchor2.x,m=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.set(b.m_sweep.c.x+e-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),b.m_sweep.c.y+f-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y));this.m_u2.set(d-l,g-m);d=this.m_u1.length();g=this.m_u2.length();d>v.b2_linearSlop?this.m_u1.multiply(1/d):this.m_u1.setZero();g>v.b2_linearSlop?this.m_u2.multiply(1/g):this.m_u2.setZero();0<this.m_constant-d-this.m_ratio*g?(this.m_state=H.INACTIVE_LIMIT,this.m_impulse=
0):this.m_state=H.AT_UPPER_LIMIT;d<this.m_maxLength1?(this.m_limitState1=H.INACTIVE_LIMIT,this.m_limitImpulse1=0):this.m_limitState1=H.AT_UPPER_LIMIT;g<this.m_maxLength2?(this.m_limitState2=H.INACTIVE_LIMIT,this.m_limitImpulse2=0):this.m_limitState2=H.AT_UPPER_LIMIT;d=e*this.m_u1.y-f*this.m_u1.x;g=k*this.m_u2.y-h*this.m_u2.x;this.m_limitMass1=b.m_invMass+b.m_invI*d*d;this.m_limitMass2=c.m_invMass+c.m_invI*g*g;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=
1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;a.warmStarting?(this.m_impulse*=a.dtRatio,this.m_limitImpulse1*=a.dtRatio,this.m_limitImpulse2*=a.dtRatio,a=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,d=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,g=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,l=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*a,b.m_linearVelocity.y+=b.m_invMass*
d,b.m_angularVelocity+=b.m_invI*(e*d-f*a),c.m_linearVelocity.x+=c.m_invMass*g,c.m_linearVelocity.y+=c.m_invMass*l,c.m_angularVelocity+=c.m_invI*(k*l-h*g)):this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0},solveVelocityConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,
k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,h,l;this.m_state==H.AT_UPPER_LIMIT&&(c=a.m_linearVelocity.x+-a.m_angularVelocity*e,f=a.m_linearVelocity.y+a.m_angularVelocity*d,h=b.m_linearVelocity.x+-b.m_angularVelocity*k,l=b.m_linearVelocity.y+b.m_angularVelocity*g,c=-(this.m_u1.x*c+this.m_u1.y*f)-this.m_ratio*(this.m_u2.x*h+this.m_u2.y*l),l=this.m_pulleyMass*-c,c=this.m_impulse,this.m_impulse=q.max(0,this.m_impulse+l),l=this.m_impulse-c,c=-l*this.m_u1.x,
f=-l*this.m_u1.y,h=-this.m_ratio*l*this.m_u2.x,l=-this.m_ratio*l*this.m_u2.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*f,a.m_angularVelocity+=a.m_invI*(d*f-e*c),b.m_linearVelocity.x+=b.m_invMass*h,b.m_linearVelocity.y+=b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(g*l-k*h));this.m_limitState1==H.AT_UPPER_LIMIT&&(c=a.m_linearVelocity.x+-a.m_angularVelocity*e,f=a.m_linearVelocity.y+a.m_angularVelocity*d,c=-(this.m_u1.x*c+this.m_u1.y*f),l=-this.m_limitMass1*c,c=this.m_limitImpulse1,
this.m_limitImpulse1=q.max(0,this.m_limitImpulse1+l),l=this.m_limitImpulse1-c,c=-l*this.m_u1.x,f=-l*this.m_u1.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*f,a.m_angularVelocity+=a.m_invI*(d*f-e*c));this.m_limitState2==H.AT_UPPER_LIMIT&&(h=b.m_linearVelocity.x+-b.m_angularVelocity*k,l=b.m_linearVelocity.y+b.m_angularVelocity*g,c=-(this.m_u2.x*h+this.m_u2.y*l),l=-this.m_limitMass2*c,c=this.m_limitImpulse2,this.m_limitImpulse2=q.max(0,this.m_limitImpulse2+l),l=this.m_limitImpulse2-
c,h=-l*this.m_u2.x,l=-l*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*h,b.m_linearVelocity.y+=b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(g*l-k*h))},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c,d=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,e=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,f=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,g=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,k,h,l,m,u,n,p,r=0;this.m_state==H.AT_UPPER_LIMIT&&(c=a.m_xf.R,
k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,h=this.m_localAnchor1.y-a.m_sweep.localCenter.y,u=c.col1.x*k+c.col2.x*h,h=c.col1.y*k+c.col2.y*h,k=u,c=b.m_xf.R,l=this.m_localAnchor2.x-b.m_sweep.localCenter.x,m=this.m_localAnchor2.y-b.m_sweep.localCenter.y,u=c.col1.x*l+c.col2.x*m,m=c.col1.y*l+c.col2.y*m,l=u,c=a.m_sweep.c.x+k,u=a.m_sweep.c.y+h,n=b.m_sweep.c.x+l,p=b.m_sweep.c.y+m,this.m_u1.set(c-d,u-e),this.m_u2.set(n-f,p-g),c=this.m_u1.length(),u=this.m_u2.length(),c>v.b2_linearSlop?this.m_u1.multiply(1/
c):this.m_u1.setZero(),u>v.b2_linearSlop?this.m_u2.multiply(1/u):this.m_u2.setZero(),c=this.m_constant-c-this.m_ratio*u,r=q.max(r,-c),c=q.clamp(c+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),p=-this.m_pulleyMass*c,c=-p*this.m_u1.x,u=-p*this.m_u1.y,n=-this.m_ratio*p*this.m_u2.x,p=-this.m_ratio*p*this.m_u2.y,a.m_sweep.c.x+=a.m_invMass*c,a.m_sweep.c.y+=a.m_invMass*u,a.m_sweep.a+=a.m_invI*(k*u-h*c),b.m_sweep.c.x+=b.m_invMass*n,b.m_sweep.c.y+=b.m_invMass*p,b.m_sweep.a+=b.m_invI*(l*p-m*n),a.synchronizeTransform(),
b.synchronizeTransform());this.m_limitState1==H.AT_UPPER_LIMIT&&(c=a.m_xf.R,k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,h=this.m_localAnchor1.y-a.m_sweep.localCenter.y,u=c.col1.x*k+c.col2.x*h,h=c.col1.y*k+c.col2.y*h,k=u,c=a.m_sweep.c.x+k,u=a.m_sweep.c.y+h,this.m_u1.set(c-d,u-e),c=this.m_u1.length(),c>v.b2_linearSlop?(this.m_u1.x*=1/c,this.m_u1.y*=1/c):this.m_u1.setZero(),c=this.m_maxLength1-c,r=q.max(r,-c),c=q.clamp(c+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),p=-this.m_limitMass1*c,c=-p*this.m_u1.x,
u=-p*this.m_u1.y,a.m_sweep.c.x+=a.m_invMass*c,a.m_sweep.c.y+=a.m_invMass*u,a.m_sweep.a+=a.m_invI*(k*u-h*c),a.synchronizeTransform());this.m_limitState2==H.AT_UPPER_LIMIT&&(c=b.m_xf.R,l=this.m_localAnchor2.x-b.m_sweep.localCenter.x,m=this.m_localAnchor2.y-b.m_sweep.localCenter.y,u=c.col1.x*l+c.col2.x*m,m=c.col1.y*l+c.col2.y*m,l=u,n=b.m_sweep.c.x+l,p=b.m_sweep.c.y+m,this.m_u2.set(n-f,p-g),u=this.m_u2.length(),u>v.b2_linearSlop?(this.m_u2.x*=1/u,this.m_u2.y*=1/u):this.m_u2.setZero(),c=this.m_maxLength2-
u,r=q.max(r,-c),c=q.clamp(c+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),p=-this.m_limitMass2*c,n=-p*this.m_u2.x,p=-p*this.m_u2.y,b.m_sweep.c.x+=b.m_invMass*n,b.m_sweep.c.y+=b.m_invMass*p,b.m_sweep.a+=b.m_invI*(l*p-m*n),b.synchronizeTransform());return r<v.b2_linearSlop},__class__:lb});var Od=function(){ja.call(this);this.groundAnchorA=new t;this.groundAnchorB=new t;this.localAnchorA=new t;this.localAnchorB=new t;this.type=Q.PULLEY_JOINT;this.groundAnchorA.set(-1,1);this.groundAnchorB.set(1,1);this.localAnchorA.set(-1,
0);this.localAnchorB.set(1,0);this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0;this.ratio=1;this.collideConnected=!0};Od.__name__=["box2D","dynamics","joints","B2PulleyJointDef"];Od.__super__=ja;Od.prototype=p(ja.prototype,{initialize:function(a,b,c,d,e,f,g){this.bodyA=a;this.bodyB=b;this.groundAnchorA.setV(c);this.groundAnchorB.setV(d);this.localAnchorA=this.bodyA.getLocalPoint(e);this.localAnchorB=this.bodyB.getLocalPoint(f);a=e.x-c.x;c=e.y-c.y;this.lengthA=Math.sqrt(a*a+c*c);c=f.x-d.x;
d=f.y-d.y;this.lengthB=Math.sqrt(c*c+d*d);this.ratio=g;g=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=g-this.ratio*lb.b2_minPulleyLength;this.maxLengthB=(g-lb.b2_minPulleyLength)/this.ratio},__class__:Od});var mb=function(a){da.call(this,a);this.K=new ha;this.K1=new ha;this.K2=new ha;this.K3=new ha;this.impulse3=new Ka;this.impulse2=new t;this.reduced=new t;this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_impulse=new Ka;this.m_mass=new Vb;this.m_localAnchor1.setV(a.localAnchorA);
this.m_localAnchor2.setV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.setZero();this.m_motorImpulse=0;this.m_lowerAngle=a.lowerAngle;this.m_upperAngle=a.upperAngle;this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=H.INACTIVE_LIMIT};mb.__name__=["box2D","dynamics","joints","B2RevoluteJoint"];mb.__super__=da;mb.prototype=p(da.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},
getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return a*this.m_impulse.z},getJointAngle:function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},getJointSpeed:function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_enableLimit=
a},getLowerLimit:function(){return this.m_lowerAngle},getUpperLimit:function(){return this.m_upperAngle},setLimits:function(a,b){this.m_lowerAngle=a;this.m_upperAngle=b},isMotorEnabled:function(){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);return this.m_enableMotor},enableMotor:function(a){this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorTorque:function(a){this.m_maxMotorTorque=
a},getMotorTorque:function(){return this.m_maxMotorTorque},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;d=b.m_xf.R;var f=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y;e=d.col1.x*f+d.col2.x*g;g=d.col1.y*f+d.col2.y*g;f=e;d=c.m_xf.R;var k=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y;e=d.col1.x*k+d.col2.x*h;h=d.col1.y*k+d.col2.y*h;k=e;d=b.m_invMass;e=c.m_invMass;var l=b.m_invI,
m=c.m_invI;this.m_mass.col1.x=d+e+g*g*l+h*h*m;this.m_mass.col2.x=-g*f*l-h*k*m;this.m_mass.col3.x=-g*l-h*m;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=d+e+f*f*l+k*k*m;this.m_mass.col3.y=f*l+k*m;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=l+m;this.m_motorMass=1/(l+m);!1==this.m_enableMotor&&(this.m_motorImpulse=0);if(this.m_enableLimit){var u=c.m_sweep.a-b.m_sweep.a-this.m_referenceAngle;q.abs(this.m_upperAngle-this.m_lowerAngle)<2*v.b2_angularSlop?
this.m_limitState=H.EQUAL_LIMITS:u<=this.m_lowerAngle?(this.m_limitState!=H.AT_LOWER_LIMIT&&(this.m_impulse.z=0),this.m_limitState=H.AT_LOWER_LIMIT):u>=this.m_upperAngle?(this.m_limitState!=H.AT_UPPER_LIMIT&&(this.m_impulse.z=0),this.m_limitState=H.AT_UPPER_LIMIT):(this.m_limitState=H.INACTIVE_LIMIT,this.m_impulse.z=0)}else this.m_limitState=H.INACTIVE_LIMIT;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x,u=this.m_impulse.y,
b.m_linearVelocity.x-=d*a,b.m_linearVelocity.y-=d*u,b.m_angularVelocity-=l*(f*u-g*a+this.m_motorImpulse+this.m_impulse.z),c.m_linearVelocity.x+=e*a,c.m_linearVelocity.y+=e*u,c.m_angularVelocity+=m*(k*u-h*a+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e,f,g,k,h=b.m_linearVelocity,l=b.m_angularVelocity,m=c.m_linearVelocity,u=c.m_angularVelocity,p=b.m_invMass,n=c.m_invMass,r=b.m_invI,
s=c.m_invI;this.m_enableMotor&&this.m_limitState!=H.EQUAL_LIMITS&&(f=this.m_motorMass*-(u-l-this.m_motorSpeed),g=this.m_motorImpulse,a=a.dt*this.m_maxMotorTorque,this.m_motorImpulse=q.clamp(this.m_motorImpulse+f,-a,a),f=this.m_motorImpulse-g,l-=r*f,u+=s*f);if(this.m_enableLimit&&this.m_limitState!=H.INACTIVE_LIMIT){d=b.m_xf.R;f=this.m_localAnchor1.x-b.m_sweep.localCenter.x;g=this.m_localAnchor1.y-b.m_sweep.localCenter.y;e=d.col1.x*f+d.col2.x*g;g=d.col1.y*f+d.col2.y*g;f=e;d=c.m_xf.R;a=this.m_localAnchor2.x-
c.m_sweep.localCenter.x;k=this.m_localAnchor2.y-c.m_sweep.localCenter.y;e=d.col1.x*a+d.col2.x*k;k=d.col1.y*a+d.col2.y*k;a=e;e=m.x+-u*k-h.x- -l*g;var t=m.y+u*a-h.y-l*f;this.m_mass.solve33(this.impulse3,-e,-t,-(u-l));this.m_limitState==H.EQUAL_LIMITS?this.m_impulse.add(this.impulse3):this.m_limitState==H.AT_LOWER_LIMIT?(d=this.m_impulse.z+this.impulse3.z,0>d&&(this.m_mass.solve22(this.reduced,-e,-t),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=
this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==H.AT_UPPER_LIMIT&&(d=this.m_impulse.z+this.impulse3.z,0<d&&(this.m_mass.solve22(this.reduced,-e,-t),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0));h.x-=p*this.impulse3.x;h.y-=p*this.impulse3.y;l-=r*(f*this.impulse3.y-g*this.impulse3.x+this.impulse3.z);m.x+=n*this.impulse3.x;m.y+=
n*this.impulse3.y;u+=s*(a*this.impulse3.y-k*this.impulse3.x+this.impulse3.z)}else d=b.m_xf.R,f=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y,e=d.col1.x*f+d.col2.x*g,g=d.col1.y*f+d.col2.y*g,f=e,d=c.m_xf.R,a=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,e=d.col1.x*a+d.col2.x*k,k=d.col1.y*a+d.col2.y*k,a=e,this.m_mass.solve22(this.impulse2,-(m.x+-u*k-h.x- -l*g),-(m.y+u*a-h.y-l*f)),this.m_impulse.x+=this.impulse2.x,
this.m_impulse.y+=this.impulse2.y,h.x-=p*this.impulse2.x,h.y-=p*this.impulse2.y,l-=r*(f*this.impulse2.y-g*this.impulse2.x),m.x+=n*this.impulse2.x,m.y+=n*this.impulse2.y,u+=s*(a*this.impulse2.y-k*this.impulse2.x);b.m_linearVelocity.setV(h);b.m_angularVelocity=l;c.m_linearVelocity.setV(m);c.m_angularVelocity=u},solvePositionConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB,e=0;c=0;var f,g,k;if(this.m_enableLimit&&this.m_limitState!=H.INACTIVE_LIMIT){b=d.m_sweep.a-a.m_sweep.a-this.m_referenceAngle;
var h=0;this.m_limitState==H.EQUAL_LIMITS?(b=q.clamp(b-this.m_lowerAngle,-v.b2_maxAngularCorrection,v.b2_maxAngularCorrection),h=-this.m_motorMass*b,e=q.abs(b)):this.m_limitState==H.AT_LOWER_LIMIT?(b-=this.m_lowerAngle,e=-b,b=q.clamp(b+v.b2_angularSlop,-v.b2_maxAngularCorrection,0),h=-this.m_motorMass*b):this.m_limitState==H.AT_UPPER_LIMIT&&(e=b-=this.m_upperAngle,b=q.clamp(b-v.b2_angularSlop,0,v.b2_maxAngularCorrection),h=-this.m_motorMass*b);a.m_sweep.a-=a.m_invI*h;d.m_sweep.a+=d.m_invI*h;a.synchronizeTransform();
d.synchronizeTransform()}c=a.m_xf.R;h=this.m_localAnchor1.x-a.m_sweep.localCenter.x;b=this.m_localAnchor1.y-a.m_sweep.localCenter.y;f=c.col1.x*h+c.col2.x*b;b=c.col1.y*h+c.col2.y*b;h=f;c=d.m_xf.R;var l=this.m_localAnchor2.x-d.m_sweep.localCenter.x,m=this.m_localAnchor2.y-d.m_sweep.localCenter.y;f=c.col1.x*l+c.col2.x*m;m=c.col1.y*l+c.col2.y*m;l=f;g=d.m_sweep.c.x+l-a.m_sweep.c.x-h;k=d.m_sweep.c.y+m-a.m_sweep.c.y-b;var u=g*g+k*k;c=Math.sqrt(u);f=a.m_invMass;var p=d.m_invMass,n=a.m_invI,r=d.m_invI,s=10*
v.b2_linearSlop;u>s*s&&(u=1/(f+p),g=u*-g,k=u*-k,a.m_sweep.c.x-=0.5*f*g,a.m_sweep.c.y-=0.5*f*k,d.m_sweep.c.x+=0.5*p*g,d.m_sweep.c.y+=0.5*p*k,g=d.m_sweep.c.x+l-a.m_sweep.c.x-h,k=d.m_sweep.c.y+m-a.m_sweep.c.y-b);this.K1.col1.x=f+p;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=f+p;this.K2.col1.x=n*b*b;this.K2.col2.x=-n*h*b;this.K2.col1.y=-n*h*b;this.K2.col2.y=n*h*h;this.K3.col1.x=r*m*m;this.K3.col2.x=-r*l*m;this.K3.col1.y=-r*l*m;this.K3.col2.y=r*l*l;this.K.setM(this.K1);this.K.addM(this.K2);this.K.addM(this.K3);
this.K.solve(mb.tImpulse,-g,-k);g=mb.tImpulse.x;k=mb.tImpulse.y;a.m_sweep.c.x-=a.m_invMass*g;a.m_sweep.c.y-=a.m_invMass*k;a.m_sweep.a-=a.m_invI*(h*k-b*g);d.m_sweep.c.x+=d.m_invMass*g;d.m_sweep.c.y+=d.m_invMass*k;d.m_sweep.a+=d.m_invI*(l*k-m*g);a.synchronizeTransform();d.synchronizeTransform();return c<=v.b2_linearSlop?e<=v.b2_angularSlop:!1},__class__:mb});var Kd=function(){ja.call(this);this.localAnchorA=new t;this.localAnchorB=new t;this.type=Q.REVOLUTE_JOINT;this.localAnchorA.set(0,0);this.localAnchorB.set(0,
0);this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0;this.enableMotor=this.enableLimit=!1};Kd.__name__=["box2D","dynamics","joints","B2RevoluteJointDef"];Kd.__super__=ja;Kd.prototype=p(ja.prototype,{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:Kd});var Vd=function(a){da.call(this,a);this.m_localAnchorA=
new t;this.m_localAnchorB=new t;this.m_impulse=new Ka;this.m_mass=new Vb;this.m_localAnchorA.setV(a.localAnchorA);this.m_localAnchorB.setV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.setZero();this.m_mass=new Vb};Vd.__name__=["box2D","dynamics","joints","B2WeldJoint"];Vd.__super__=da;Vd.prototype=p(da.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},getReactionForce:function(a){return new t(a*
this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return a*this.m_impulse.z},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchorB.x-e.m_sweep.localCenter.x,h=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;b=d.m_invMass;
c=e.m_invMass;var l=d.m_invI,m=e.m_invI;this.m_mass.col1.x=b+c+g*g*l+h*h*m;this.m_mass.col2.x=-g*f*l-h*k*m;this.m_mass.col3.x=-g*l-h*m;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+f*f*l+k*k*m;this.m_mass.col3.y=f*l+k*m;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=l+m;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_impulse.z*=a.dtRatio,d.m_linearVelocity.x-=b*this.m_impulse.x,d.m_linearVelocity.y-=b*this.m_impulse.y,
d.m_angularVelocity-=l*(f*this.m_impulse.y-g*this.m_impulse.x+this.m_impulse.z),e.m_linearVelocity.x+=c*this.m_impulse.x,e.m_linearVelocity.y+=c*this.m_impulse.y,e.m_angularVelocity+=m*(k*this.m_impulse.y-h*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.setZero()},solveVelocityConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB,e=a.m_linearVelocity,f=a.m_angularVelocity,g=d.m_linearVelocity,k=d.m_angularVelocity,h=a.m_invMass,l=d.m_invMass,m=a.m_invI,u=d.m_invI;b=a.m_xf.R;var p=
this.m_localAnchorA.x-a.m_sweep.localCenter.x,n=this.m_localAnchorA.y-a.m_sweep.localCenter.y;c=b.col1.x*p+b.col2.x*n;n=b.col1.y*p+b.col2.y*n;p=c;b=d.m_xf.R;var q=this.m_localAnchorB.x-d.m_sweep.localCenter.x,r=this.m_localAnchorB.y-d.m_sweep.localCenter.y;c=b.col1.x*q+b.col2.x*r;r=b.col1.y*q+b.col2.y*r;q=c;b=g.x-k*r-e.x+f*n;c=g.y+k*q-e.y-f*p;var s=k-f,t=new Ka;this.m_mass.solve33(t,-b,-c,-s);this.m_impulse.add(t);e.x-=h*t.x;e.y-=h*t.y;f-=m*(p*t.y-n*t.x+t.z);g.x+=l*t.x;g.y+=l*t.y;k+=u*(q*t.y-r*t.x+
t.z);a.m_angularVelocity=f;d.m_angularVelocity=k},solvePositionConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB;b=a.m_xf.R;var e=this.m_localAnchorA.x-a.m_sweep.localCenter.x,f=this.m_localAnchorA.y-a.m_sweep.localCenter.y;c=b.col1.x*e+b.col2.x*f;f=b.col1.y*e+b.col2.y*f;e=c;b=d.m_xf.R;var g=this.m_localAnchorB.x-d.m_sweep.localCenter.x,k=this.m_localAnchorB.y-d.m_sweep.localCenter.y;c=b.col1.x*g+b.col2.x*k;k=b.col1.y*g+b.col2.y*k;g=c;b=a.m_invMass;c=d.m_invMass;var h=a.m_invI,l=d.m_invI,
m=d.m_sweep.c.x+g-a.m_sweep.c.x-e,u=d.m_sweep.c.y+k-a.m_sweep.c.y-f,p=d.m_sweep.a-a.m_sweep.a-this.m_referenceAngle,n=10*v.b2_linearSlop,r=Math.sqrt(m*m+u*u),s=q.abs(p);r>n&&(h*=1,l*=1);this.m_mass.col1.x=b+c+f*f*h+k*k*l;this.m_mass.col2.x=-f*e*h-k*g*l;this.m_mass.col3.x=-f*h-k*l;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+e*e*h+g*g*l;this.m_mass.col3.y=e*h+g*l;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=h+l;n=new Ka;this.m_mass.solve33(n,
-m,-u,-p);a.m_sweep.c.x-=b*n.x;a.m_sweep.c.y-=b*n.y;a.m_sweep.a-=h*(e*n.y-f*n.x+n.z);d.m_sweep.c.x+=c*n.x;d.m_sweep.c.y+=c*n.y;d.m_sweep.a+=l*(g*n.y-k*n.x+n.z);a.synchronizeTransform();d.synchronizeTransform();return r<=v.b2_linearSlop?s<=v.b2_angularSlop:!1},__class__:Vd});var Wd=function(){ja.call(this);this.localAnchorA=new t;this.localAnchorB=new t;this.type=Q.WELD_JOINT;this.referenceAngle=0};Wd.__name__=["box2D","dynamics","joints","B2WeldJointDef"];Wd.__super__=ja;Wd.prototype=p(ja.prototype,
{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(c));this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:Wd});var S={__ename__:!0,__constructs__:"Image Audio Other Javascript Css Font".split(" "),Image:["Image",0]};S.Image.__enum__=S;S.Audio=["Audio",1];S.Audio.__enum__=S;S.Other=["Other",2];S.Other.__enum__=S;S.Javascript=["Javascript",3];S.Javascript.__enum__=S;S.Css=["Css",
4];S.Css.__enum__=S;S.Font=["Font",5];S.Font.__enum__=S;S.__empty_constructs__=[S.Image,S.Audio,S.Other,S.Javascript,S.Css,S.Font];var jf=function(a,b,c,d,e){null==d&&(d=!1);this.isAbsolute=!1;this.asset=null;this.name=a;this.type=c;this.source=b;this.isAbsolute=d;this.options=e};jf.__name__=["engine","AssetLoadingInfo"];jf.prototype={__class__:jf};var Aa=function(){this._eventListeners=[]};Aa.__name__=["engine","events","EventDispatcher"];Aa.prototype={addEventListener:function(a,b){this.hasEventListener(a,
b)||this._eventListeners.push(new kf(a,b))},hasEventListener:function(a,b){for(var c=this._eventListeners.length-1;0<=c;){if(this._eventListeners[c].eventName==a&&ta.compareMethods(this._eventListeners[c].action,b))return!0;--c}return!1},dispatchEvent:function(a){a.target=this;for(var b=this._eventListeners.length-1;0<=b;){var c=this._eventListeners[b];c.eventName==a.getType()&&c.action(a);--b}},removeAllEventListeners:function(){this._eventListeners=[]},removeEventListener:function(a,b){if(this.hasEventListener(a,
b))for(var c=this._eventListeners.length-1;0<=c;){var d=this._eventListeners[c];if(d.eventName==a&&ta.compareMethods(d.action,b)){this._eventListeners.splice(c,1);break}--c}},__class__:Aa};var L=function(){this._instanceId=0;this._isActive=this._isUpdating=!0;this._isInitialized=this._isMarkedForDeletion=!1;this._eventListeners=[];this._instanceId=L._currentInstanceId++;this._name="GameObject"+this._instanceId;this._properties=new ya};L.__name__=["engine","GameObject"];L.__super__=Aa;L.prototype=
p(Aa.prototype,{init:function(){this._isInitialized=!0;this.dispatchEvent(new fb("initialize"))},update:function(){!this._isInitialized&&this._isActive&&(this.init(),this.setActive(!0))},fixedUpdate:function(){},postUpdate:function(){},render:function(){},onActivate:function(){this._isActive=!0;this.dispatchEvent(new fb("activate"))},onDeactivate:function(){this._isActive=!1;this.dispatchEvent(new fb("deactivate"))},debugRender:function(){},handleMessage:function(a,b){},setProperty:function(a,b){var c=
this._properties;null!=N[a]?c.setReserved(a,b):c.h[a]=b},getProperty:function(a){var b=this._properties;return null!=N[a]?b.getReserved(a):b.h[a]},hasProperty:function(a){var b=this._properties;return null!=N[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},isMarkedForDeletion:function(){return this._isMarkedForDeletion},getName:function(){return this._name},setName:function(a){this._name=a},getInstanceId:function(){return this._instanceId},isActive:function(){return this._isActive},setActive:function(a){if(!this._isActive&&
a)this._isInitialized||this.init(),this.onActivate();else if(this._isActive&&!a)this.onDeactivate()},setUpdating:function(a){this._isUpdating=a},isUpdating:function(){return this._isUpdating},destroy:function(){this._isMarkedForDeletion=!0;this.setActive(!1)},onDestroy:function(){this.dispatchEvent(new fb("destroy"))},log:function(a){Ea.log(a)},__class__:L});var m=function(a){L.call(this);a.addComponent(this);this.setName(Sa.getClassName(C.getClass(this)))};m.__name__=["engine","Component"];m.__super__=
L;m.prototype=p(L.prototype,{getEntity:function(){return this._entity},setEntity:function(a){this._entity=a},getTags:function(){return this.getEntity().getTags()},addTag:function(a){this.getEntity().addTag(a)},hasTag:function(a){return this.getEntity().hasTag(a)},removeTag:function(a){this.getEntity().removeTag(a)},getComponent:function(a){return this.getEntity().getComponent(a)},getGameState:function(){return this.getEntity().getGameState()},destroy:function(){L.prototype.destroy.call(this)},addEntity:function(a){null==
a&&(a=!0);return this.getEntity().addEntity(a)},onPause:function(){},onResume:function(){},onDestroy:function(){L.prototype.onDestroy.call(this)},__class__:m});var Xb=function(){this._prevScale=new O;this._prevRotation=new O;this._prevPosition=new O;this._cachedWorldScale=new O;this._cachedWorldRotation=new O;this._cachedWorldPosition=new O;this._isVisible=this._worldPositionDirty=this._worldRotationDirty=this._worldScaleDirty=!0;this._parent=null;L.call(this);this._components=[];this._children=[];
this._tags=[];this._transform=new nc(this);this._transform.addEventListener("update",w(this,this.onTransformUpdate))};Xb.__name__=["engine","Entity"];Xb.instantiate=function(a){return a.addEntity()};Xb.__super__=L;Xb.prototype=p(L.prototype,{getTransform:function(){return this._transform},init:function(){L.prototype.init.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.init()}},getGameState:function(){return this._gameState},setGameState:function(a){this._gameState=
a},addTag:function(a){this._tags.push(a)},removeTag:function(a){for(var b=0,c=this._tags.length;b<c;){var d=b++;this._tags[d]==a&&this._tags.splice(d,1)}},hasTag:function(a){for(var b=0,c=this._tags.length;b<c;){var d=b++;if(this._tags[d]==a)return!0}return!1},getTags:function(){return this._tags},hasChild:function(a){for(var b=0,c=this._children.length;b<c;){var d=b++;if(this._children[d]==a)return!0}return!1},removeChild:function(a,b){null==b&&(b=!1);for(var c=0,d=this._children.length;c<d;){var e=
c++,f=this._children[e];if(f==a){f.setParent(null,b);this._children.splice(e,1);break}}},addChild:function(a,b){null==b&&(b=!1);a==this&&this.log("Cannot parent an Entity to itself.");null!=a.getParent()&&a.getParent().removeChild(a,b);this._children.push(a);a.setParent(this,b)},insertChild:function(a,b){a==this&&this.log("Cannot parent an Entity to itself.");null!=a.getParent()&&a.getParent().removeChild(a);this._children.splice(b,0,a);a.setParent(this)},destroyAllChildren:function(){for(var a=0,
b=this._children.length;a<b;){var c=a++;this._children[c].destroy()}this._children=[]},getParent:function(){return this._parent},getRootEntity:function(){return null!=this.getParent()?this.getParent():this},setParent:function(a,b){null==b&&(b=!1);if(this._parent!=a){var c=this.getPosition(),d=this.getRotation(),e=this.getScale();this._parent=a;null!=this.getParent()?this.dispatchEvent(new U("addedToParent",{parent:this.getParent()})):this.dispatchEvent(new U("removedFromParent"));b&&(this.setPosition(c.x,
c.y,c.z),this.setRotation(d.x,d.y,d.z),this.setScale(e.x,e.y,e.z));this.dispatchEvent(new U("displayUpdate"));this.dispatchEvent(new U("parentUpdate"));c=0;for(d=this._children;c<d.length;)e=d[c],++c,e.dispatchEvent(new U("parentUpdate"));this._worldScaleDirty=this._worldRotationDirty=this._worldPositionDirty=!0}},setActive:function(a){L.prototype.setActive.call(this,a)},isActive:function(){return this._isActive},isActiveInHierarchy:function(){return null!=this.getParent()?this.isActive()?this.getParent().isActive():
!1:this._isActive},getChildren:function(a){null==a&&(a=!1);if(!a)return this._children;a=this._children;for(var b=[].concat(a),c=0,d=b.length;c<d;){var e=c++;a=a.concat(b[e].getChildren(!0))}return a},findChildByName:function(a){for(var b=0,c=this._children.length;b<c;){var d=b++,d=this._children[d];if(d.getName()==a)return d;d=d.findChildByName(a);if(null!=d)return d}return null},isVisible:function(){return null!=this._parent?this._parent.isVisible()?this._isVisible:!1:this._isVisible},setVisible:function(a){(this._isVisible=
a)?this.dispatchEvent(new U("visibilityOn")):this.dispatchEvent(new U("visibilityOff"));this.dispatchEvent(new U("displayUpdate"))},onActivate:function(){L.prototype.onActivate.call(this);for(var a=0,b=this._children.length;a<b;){var c=a++;this._children[c].setActive(!0)}this.dispatchEvent(new U("displayUpdate"))},onDeactivate:function(){L.prototype.onDeactivate.call(this);for(var a=0,b=this._children.length;a<b;){var c=a++;this._children[c].setActive(!1)}this.dispatchEvent(new U("displayUpdate"))},
getPositionRef:function(){return this._transform.getPositionRef()},getPosition:function(){if(this._worldPositionDirty){this._cachedWorldPosition=this._transform.getPosition(T.World);this._worldPositionDirty=!1;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldPosition.getClone()},getLocalPosition:function(){return this._transform.getPosition(T.Local)},setLocalPosition:function(a,b,c){null==c&&(c=
0);null==b&&(b=0);null==a&&(a=0);this._transform.setPosition(new O(a,b,c),T.Local);this.dispatchEvent(new U("displayUpdate"))},setPosition:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setPosition(new O(a,b,c),T.World);this.dispatchEvent(new U("displayUpdate"))},translate:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.translate(a,b,c);this.dispatchEvent(new U("displayUpdate"))},getRotationRef:function(){return this._transform.getRotationRef()},
getRotation:function(){if(this._worldRotationDirty){this._cachedWorldRotation=this._transform.getRotation(T.World);this._worldRotationDirty=!0;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldRotation.getClone()},getLocalRotation:function(){return this._transform.getRotation(T.Local)},setLocalRotation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setRotation(a,b,
c,T.Local);this.dispatchEvent(new U("displayUpdate"))},setRotation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setRotation(a,b,c,T.World);this.dispatchEvent(new U("displayUpdate"))},setLocalRotation2d:function(a){null==a&&(a=0);var b=this._transform.getRotation(T.Local);this._transform.setRotation(b.x,b.y,a,T.Local);this.dispatchEvent(new U("displayUpdate"))},setRotation2d:function(a){null==a&&(a=0);var b=this._transform.getRotation(T.World);this._transform.setRotation(b.x,
b.y,a,T.World);this.dispatchEvent(new U("displayUpdate"))},rotate:function(a,b,c){this._transform.rotate(a,b,c)},rotate2d:function(a){this._transform.rotate(0,0,a)},getScaleRef:function(){return this._transform.getScaleRef()},getScale:function(){if(this._worldScaleDirty){this._cachedWorldScale=this._transform.getScale(T.World);this._worldScaleDirty=!1;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldScale.getClone()},
getLocalScale:function(){return this._transform.getScale(T.Local)},setScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._transform.setScale(a,b,c,T.World);this.dispatchEvent(new U("displayUpdate"))},setLocalScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._transform.setScale(a,b,c,T.Local);this.dispatchEvent(new U("displayUpdate"))},onPause:function(){for(var a=0,b=this._components.length;a<b;){var c=a++;this._components[c].onPause()}},onResume:function(){for(var a=
0,b=this._components.length;a<b;){var c=a++;this._components[c].onResume()}},update:function(){L.prototype.update.call(this);for(var a=this._components.length,b=a;0<b--;)a=this._components[b],a.isMarkedForDeletion()&&(a.onDestroy(),this._components.splice(b,1));a=this._components.length;for(b=0;b<a;){var c=b++,c=this._components[c];c.isActive()&&c.isUpdating()&&c.update()}},fixedUpdate:function(){L.prototype.fixedUpdate.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];
c.isActive()&&c.fixedUpdate()}},render:function(){L.prototype.render.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.render()}},postUpdate:function(){L.prototype.postUpdate.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.isUpdating()&&c.postUpdate()}},debugRender:function(){L.prototype.debugRender.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&
c.debugRender()}a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ea.getDebugCamera()){var d=ea.getDebugCamera().getEntity(),b=ea.getDebugCamera().getZoomScale(),c=ea.getDebugCamera().getComponent(Ib),d=d.getPosition();a.translate(-d.x*b+c.getContainerOffset().x,-d.y*b+c.getContainerOffset().y);a.scale(b,b)}a.beginPath();a.globalAlpha=0.65;a.lineWidth=1;a.strokeStyle="#44FF44";b=this.getPosition();a.moveTo(b.x,b.y-10);a.lineTo(b.x,b.y+10);a.moveTo(b.x-10,b.y);
a.lineTo(b.x+10,b.y);a.moveTo(b.x-10,b.y-10);a.lineTo(b.x+10,b.y+10);a.moveTo(b.x+10,b.y-10);a.lineTo(b.x-10,b.y+10);a.stroke();a.restore();n.getInstance().getLayerByName("debug").setWholeCanvasDirty(!0)},addComponent:function(a){for(var b=0,c=this._components.length;b<c;){var d=b++;if(this._components[d]==a)return null}this._components.push(a);a.setEntity(this);return a},getComponent:function(a){for(var b=0,c=this._components.length;b<c;){var d=b++;if(C.__instanceof(this._components[d],a))return this._components[d]}return null},
getComponentsInChildren:function(a){var b=[],c=this.getComponents(a);null!=c&&(b=b.concat(c));for(var c=0,d=this._children.length;c<d;){var e=c++,e=this._children[e].getComponentsInChildren(a);null!=e&&(b=b.concat(e))}return b},getComponents:function(a){if(null==a)return this._components;for(var b=[],c=0,d=this._components.length;c<d;){var e=c++;C.__instanceof(this._components[e],a)&&b.push(this._components[e])}return 0<b.length?b:null},getComponentInParent:function(a){var b=this.getParent();return null==
b?null:null==b.getComponent(a)?b.getComponentInParent(a):null},handleMessage:function(a,b){for(var c=this._components.length-1;0<=c;){var d=this._components[c];d.isActive()&&d.handleMessage(a,b);--c}},isUpdating:function(){return null!=this._parent?this._isUpdating?this._parent.isUpdating():!1:this._isUpdating},destroy:function(){L.prototype.destroy.call(this);null!=this._gameState&&this._gameState.scheduleEntityForDeletion(this);for(var a=this._components.length;0<a--;){var b=this._components[a];
b.destroy();b.onDestroy()}for(a=this._children.length;0<a--;)b=this._children[a],b.destroy(),b.onDestroy();null!=this.getParent()&&this.getParent().removeChild(this)},addEntity:function(a){null==a&&(a=!0);var b=this.getGameState().addEntity();a&&this.addChild(b);return b},onTransformUpdate:function(){this.setTransformsDirty()},setTransformsDirty:function(){this._worldScaleDirty=this._worldRotationDirty=this._worldPositionDirty=!0;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c.setTransformsDirty()}},
onDestroy:function(){L.prototype.onDestroy.call(this)},__class__:Xb});var R=function(){};R.__name__=["engine","GameConfig"];R.getProperty=function(a,b){var c=R._properties;if(null!=N[a]?!c.existsReserved(a):!c.h.hasOwnProperty(a))return b;c=R._properties;return null!=N[a]?c.getReserved(a):c.h[a]};R.getBoolProperty=function(a){a=R.getProperty(a);return"TRUE"!=a.toUpperCase()?"1"==a:!0};R.setProperty=function(a,b){var c=R._properties,d=ga.string(b);null!=N[a]?c.setReserved(a,d):c.h[a]=d};R.parseGameConfig=
function(a){for(var b=0,c=ta.fields(a);b<c.length;){var d=c[b];++b;var e=R._properties,f=ta.field(a,d);null!=N[d]?e.setReserved(d,f):e.h[d]=f}};R.prototype={__class__:R};var X=function(){this._activeEntities=this._entitiesToDelete=null;this._isPaused=!1;this._elapsedTime=0;this._hasInitialized=!1;L.call(this);this._entities=[];this._activeEntities=[];this._entitiesToDelete=[];this._sceneRoot=this.addEntity()};X.__name__=["engine","GameState"];X.__super__=L;X.prototype=p(L.prototype,{getPaused:function(){return this._isPaused},
init:function(){L.prototype.init.call(this)},getSceneRoot:function(){return this._sceneRoot},update:function(){L.prototype.update.call(this);for(var a=this._entitiesToDelete.length,b=0,c=a;b<c;){var d=b++,d=this._entitiesToDelete[d];d.onDestroy();F.remove(this._entities,d)}nb.clear(this._entitiesToDelete);b=0;if(!this._isPaused){nb.clear(this._activeEntities);c=[].concat(this._entities);a=c.length;for(d=0;d<a;){var e=d++,e=c[e];null!=e&&e.isActiveInHierarchy()&&(this._activeEntities.push(e),++b,e.isUpdating()&&
e.update())}this._elapsedTime+=n.getDeltaTime()}"1"==R.getProperty("debugCheats")&&qa.getInstance().isKeyPressed(105)&&(this.log(this._entities),this.log(this._activeEntities),I.outputAssets(),this.log("Active entities: "+b))},fixedUpdate:function(){L.prototype.fixedUpdate.call(this);if(!this._isPaused)for(var a=0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isActiveInHierarchy()&&c.fixedUpdate()}},postUpdate:function(){L.prototype.postUpdate.call(this);if(!this._isPaused)for(var a=
0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isUpdating()&&c.isActiveInHierarchy()&&c.postUpdate()}},render:function(){L.prototype.render.call(this);for(var a=0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isVisible()&&c.isActiveInHierarchy()&&c.render()}},debugRender:function(){L.prototype.debugRender.call(this);for(var a=0,b=this._entities.length;a<b;){var c=a++,c=this._entities[c];c.isActive()&&c.isVisible()&&c.debugRender()}},addEntity:function(a){null==
a&&(a=new Xb);a.setGameState(this);this._entities.push(a);null!=this._sceneRoot&&this._sceneRoot.addChild(a);return a},removeEntity:function(a){F.remove(this._entities,a)},getHasEntity:function(a){return-1!=nb.indexOf(this._entities,a)},getEntities:function(){return this._entities},findEntityByName:function(a){for(var b=0,c=this._entities.length;b<c;){var d=b++,d=this._entities[d];if(d.getName()==a)return d}return null},getEntitiesByTag:function(a,b){null==b&&(b=!0);for(var c=[],d=0,e=this._entities.length;d<
e;){var f=d++,f=this._entities[f];(!b||f.isActiveInHierarchy())&&f.hasTag(a)&&c.push(f)}return c},getClosestEntityToPointByTag:function(a,b,c){null==c&&(c=!0);b=this.getEntitiesByTag(b);for(var d=-1,e=null,f=0,g=b.length;f<g;){var k=f++,k=b[k];if(!c||k.isActiveInHierarchy()){var h=k.getPosition(),h=(new O(h.x-a.x,h.y-a.y,h.z-a.z)).getLength();if(-1==d||h<d)d=h,e=k}}return e},sortEntitiesByZ:function(){this._entities.sort(function(a,b){var c=a.getPosition(),d=b.getPosition();return c.z==d.z?a.getInstanceId()>
b.getInstanceId()?1:-1:c.z<d.z?1:-1})},handleMessage:function(a,b){L.prototype.handleMessage.call(this,a,b);if(!this._isPaused)for(var c=this._activeEntities.length-1;0<=c;)this._activeEntities[c].isActive()&&this._activeEntities[c].handleMessage(a,b),--c},pause:function(){this._isPaused=!0;for(var a=0,b=this._entities.length;a<b;){var c=a++;this._entities[c].onPause()}},resume:function(){this._isPaused=!1;for(var a=0,b=this._entities.length;a<b;){var c=a++;this._entities[c].onResume()}},bringEntityToFront:function(a,
b){null==b&&(b=!1);F.remove(this._entities,a)&&this._entities.push(a);if(b)for(var c=a.getChildren(),d=0,e=c.length;d<e;){var f=d++;this.bringEntityToFront(c[f],!0)}},sendEntityToBack:function(a,b){null==b&&(b=!1);F.remove(this._entities,a)&&this._entities.splice(0,0,a);if(b)for(var c=a.getChildren(),d=0,e=c.length;d<e;){var f=d++;this.sendEntityToBack(c[f],!0)}},insertEntityAfter:function(a,b){if(F.remove(this._entities,a)){var c=this._entities,d=nb.indexOf(this._entities,b)+1;c.splice(d,0,a)}},
scheduleEntityForDeletion:function(a){this._entitiesToDelete.push(a)},destroy:function(){L.prototype.destroy.call(this);for(var a=this._entities.length-1;0<=a;)this._entities[a].destroy(),this._entities[a].onDestroy(),--a;this._isMarkedForDeletion=!0},__class__:X});var lf=function(){};lf.__name__=["engine","TimeService"];lf.prototype={__class__:lf,__properties__:{get_fixedIterationsThisFrame:"get_fixedIterationsThisFrame",get_realDeltaTime:"get_realDeltaTime",set_isFixedTimeStep:"set_isFixedTimeStep",
get_isFixedTimeStep:"get_isFixedTimeStep",set_maxTimeStep:"set_maxTimeStep",get_maxTimeStep:"get_maxTimeStep",set_fixedTimeStep:"set_fixedTimeStep",get_fixedTimeStep:"get_fixedTimeStep",set_timeScale:"set_timeScale",get_timeScale:"get_timeScale",get_deltaTime:"get_deltaTime"}};var Zd=function(){this._timeScale=1;this._maxTimeStep=0.5;this._isFixedTimeStep=!1;this._remainderTimeStep=0;this._fixedTimeStep=0.016666666666666666;this._prevTimeStamp=this._currentTimeStamp=0;this.updateTimeStamp();this._prevTimeStamp=
this._currentTimeStamp};Zd.__name__=["engine","HaxeTimerTimeService"];Zd.__interfaces__=[lf];Zd.prototype={get_deltaTime:function(){return this.get_isFixedTimeStep()?this.get_fixedTimeStep()*this.get_timeScale():Math.min(this.get_maxTimeStep(),this.get_realDeltaTime())*this.get_timeScale()},get_timeScale:function(){return this._timeScale},set_timeScale:function(a){return this._timeScale=a},get_fixedTimeStep:function(){return this._fixedTimeStep},set_fixedTimeStep:function(a){return this._fixedTimeStep=
a},get_maxTimeStep:function(){return this._maxTimeStep},set_maxTimeStep:function(a){return this._maxTimeStep=a},get_isFixedTimeStep:function(){return this._isFixedTimeStep},set_isFixedTimeStep:function(a){return this._isFixedTimeStep=a},get_realDeltaTime:function(){return this._currentTimeStamp-this._prevTimeStamp},get_fixedIterationsThisFrame:function(){var a=Math.min(this.get_maxTimeStep(),this.get_realDeltaTime()+this._remainderTimeStep),b=Math.floor(a/this.get_fixedTimeStep()),b=Math.max(1,b)|
0;this._remainderTimeStep=a-b*this._fixedTimeStep;return b},update:function(){this.updateTimeStamp()},updateTimeStamp:function(){this._prevTimeStamp=this._currentTimeStamp;this._currentTimeStamp=(new Date).getTime()/1E3},__class__:Zd,__properties__:{get_fixedIterationsThisFrame:"get_fixedIterationsThisFrame",get_realDeltaTime:"get_realDeltaTime",set_isFixedTimeStep:"set_isFixedTimeStep",get_isFixedTimeStep:"get_isFixedTimeStep",set_maxTimeStep:"set_maxTimeStep",get_maxTimeStep:"get_maxTimeStep",set_fixedTimeStep:"set_fixedTimeStep",
get_fixedTimeStep:"get_fixedTimeStep",set_timeScale:"set_timeScale",get_timeScale:"get_timeScale",get_deltaTime:"get_deltaTime"}};var vb=function(a,b,c,d,e){null==e&&(e=!1);this._context2d=null;this._wholeCanvasDirty=this._renderedThisFrame=!1;this._canvasWidth=this._canvasHeight=0;this._autoClear=!0;this._backgroundColor="#000000";L.call(this);this.setName(a);this._container=z.getContainer();this._canvas=z.getDocument().createElement("canvas");this._canvas.width=b;this._canvas.height=c;this._canvasWidth=
b;this._canvasHeight=c;this._canvas.setAttribute("webkitTransform","translate3d(0px, 0px, 0px);");this._canvas.style.position="absolute";this._context2d=this._canvas.getContext("2d");e?(vb._masterLayer=this,this._container.appendChild(this._canvas)):this._canvas.style.visibility="hidden"};vb.__name__=["engine","Layer"];vb.getMasterLayer=function(){return vb._masterLayer};vb.__super__=L;vb.prototype=p(L.prototype,{getClearBounds:function(){return this._clearBounds},setClearBounds:function(a){this._clearBounds=
a},getContext:function(){return this._context2d},getWholeCanvasDirty:function(){return this._wholeCanvasDirty},setWholeCanvasDirty:function(a){this._wholeCanvasDirty=a;this._renderedThisFrame=!0},clear:function(a){null==a&&(a=!1);if(vb._masterLayer!=this||a)a=this._canvas.getContext("2d"),null==this._clearBounds?a.clearRect(0,0,this._canvas.width,this._canvas.height):a.clearRect(this._clearBounds.ul.x,this._clearBounds.ul.y,this._clearBounds.wh.x,this._clearBounds.wh.y),this._wholeCanvasDirty=!1},
render:function(){L.prototype.render.call(this);fa.getInstance().getWebGlEnabled()||(fa.getInstance().getRenderer().view.getContext("2d",null).setTransform(1,0,0,1,0,0),fa.getInstance().getRenderer().view.getContext("2d",null).drawImage(this._canvas,0,0,this._canvasWidth,this._canvasHeight))},getSize:function(){return new s(this._canvasWidth,this._canvasHeight)},setSize:function(a,b){this._canvasWidth=a;this._canvasHeight=b;this._canvas.width=a;this._canvas.height=b},update:function(){L.prototype.update.call(this);
this._renderedThisFrame=!1},getMaskFunction:function(){return this._maskFunction},setMaskFunction:function(a){this._maskFunction=a},getContainer:function(){return this._container},getCanvas:function(){return this._canvas},getAutoClear:function(){return this._autoClear},setAutoClear:function(a){this._autoClear=a},destroy:function(){L.prototype.destroy.call(this);null!=this.getCanvas().parentNode&&this.getCanvas().parentNode.removeChild(this.getCanvas())},__class__:vb});var Jb=function(a){null==a&&
(a=!1);this._currentRequestsActive=0;this._minLoadTimeElapsed=!1;this._currentAssetToLoad=0;this._loadCompleted=!1;this._assetsToLoad=0;this._onCompleteCallback=null;this._assetLoadingInfo=[];a&&(this._minLoadTimeElapsed=!0)};Jb.__name__=["engine","LoadBatch"];Jb.prototype={getLoadComplete:function(){return this._loadCompleted},addAsset:function(a,b,c,d){this._assetLoadingInfo.push(new jf(a,b,c,!1,d))},getAssetLoadingInfoByAssetName:function(a){for(var b=0,c=this._assetLoadingInfo.length;b<c;){var d=
b++,d=this._assetLoadingInfo[d];if(d.name==a)return d}return null},numAssets:function(){return this._assetsToLoad},onAssetLoaded:function(a){this._assetsToLoad--;this.checkAssetsLoaded();a=this._assetLoadingInfo.length-this._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:a,total:this._assetLoadingInfo.length});this.loadNext()},onXmlHttpRequestLoaded:function(a){},checkAssetsLoaded:function(){if(!(0<this._currentRequestsActive)){var a=this._assetLoadingInfo.length-this._assetsToLoad;
n.getInstance().sendGlobalMessage("onFileLoaded",{progress:a,total:this._assetLoadingInfo.length});this._loadCompleted||0<this._assetsToLoad||this.fireAllAssetsLoaded()}},fireAllAssetsLoaded:function(){this._minLoadTimeElapsed&&(this._loadCompleted=!0,null!=this._onCompleteCallback&&this._onCompleteCallback())},load:function(a){this._onCompleteCallback=a;this._assetsToLoad=this._assetLoadingInfo.length;this._loadCompleted=!1;this._currentAssetToLoad=0;0==this._assetLoadingInfo.length?(a(),this._loadCompleted=
!0):(this.loadNext(),n.getInstance().setDeferredActionsPaused(!1),n.getInstance().invokeAsyncDeferredAction(0.5,w(this,this.onMinLoadElapsed)))},unload:function(){for(var a=0,b=this._assetLoadingInfo.length;a<b;){var c=a++;I.unloadAsset(this._assetLoadingInfo[c].name)}},loadNext:function(){var a=this;if(!(10<=this._currentRequestsActive||0>=this._assetsToLoad&&this._minLoadTimeElapsed)){for(var b=null;null==b&&0<this._assetsToLoad;)if(b=this._assetLoadingInfo[this._currentAssetToLoad++],null==b)this._assetsToLoad--,
this.checkAssetsLoaded();else break;if(!(0>=this._assetsToLoad)){b.source=Ab.replace(b.source,"${locale}",z.dataLocale);switch(b.type[1]){case 0:var c=z.getDocument().createElement("img");I.registerAsset(b.name,c);this._currentRequestsActive++;var d=this;c.addEventListener("load",function(d){PIXI.Texture.addTextureToCache(PIXI.Texture.fromImage(c.src,!1,null!=b.options?b.options.scaleMode:PIXI.SCALE_MODES.DEFAULT),b.name);a._currentRequestsActive--;a.onAssetLoaded(d)});c.addEventListener("onerror",
function(){d._assetsToLoad--;alert("file not found: "+b.source);a._currentRequestsActive--;d.checkAssetsLoaded();var c=d._assetLoadingInfo.length-d._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:d._assetLoadingInfo.length});d.loadNext()});c.id=b.name;c.src=b.source;break;case 1:if(!n.isMobile()||r.isWebkitEnabled()||n.isCocoon()){var e=null,f=this;if(I.assetExists(b.name)){f._assetsToLoad--;f.checkAssetsLoaded();e=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",
{progress:e,total:f._assetLoadingInfo.length});f.loadNext();return}var e=F.substr(b.source,b.source.length-3,3),g=-1<navigator.userAgent.toLowerCase().indexOf("firefox");"mp3"==e&&g&&(b.source=Ab.replace(b.source,"mp3","ogg"));if(!r.isWebkitEnabled()||g)e=document.createElement("audio"),e.src=b.source,e.preload=!0,e.autoplay=!1,e.id=b.name,this._currentRequestsActive++,e.addEventListener("canplay",function(){f._assetsToLoad--;a._currentRequestsActive--;f.checkAssetsLoaded();var b=f._assetLoadingInfo.length-
f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:b,total:f._assetLoadingInfo.length});f.loadNext()},!1),e.addEventListener("onerror",function(){f._assetsToLoad--;console.log("File not found: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),e.addEventListener("stalled",function(){f._assetsToLoad--;console.log("File not found: "+
b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),e.addEventListener("suspend",function(){f._assetsToLoad--;console.log("Loading suspended: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});
f.loadNext()}),I.registerAsset(b.name,e),e.load();else{var k=new XMLHttpRequest;k.open("GET",b.source,!0);k.responseType="arraybuffer";I.registerAsset(b.name+"_src",b.source);this._currentRequestsActive++;k.onload=function(){r.getAudioContextInstance().decodeAudioData(k.response,function(c){I.registerAsset(b.name,c);f._assetsToLoad--;a._currentRequestsActive--;f.checkAssetsLoaded();c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});
f.loadNext()})};k.send()}}else I.registerAsset(b.name,b.source),this._assetsToLoad--,this.checkAssetsLoaded(),this.loadNext();break;case 2:var h=new XMLHttpRequest,l=this;this._currentRequestsActive++;h.onload=function(){I.registerAsset(b.name,h.responseText);l._assetsToLoad--;a._currentRequestsActive--;l.checkAssetsLoaded();var c=l._assetLoadingInfo.length-l._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:l._assetLoadingInfo.length});l.loadNext()};h.onerror=function(){l._assetsToLoad--;
alert("File not found: "+b.source);a._currentRequestsActive--;l.checkAssetsLoaded();l.loadNext()};h.open("GET",b.source,!0);h.send();break;case 3:e=z.getDocument().createElement("script");e.type="text/javascript";e.async=!0;e.src=b.source;e.id=b.name;z.getDocument().body.appendChild(e);this._currentRequestsActive++;e.onload=function(){a._currentRequestsActive--;a.checkAssetsLoaded();a.loadNext()};break;case 4:e=z.getDocument().createElement("link");e.rel="stylesheet";e.type="text/css";e.href=b.source;
e.id=b.name;z.getDocument().head.appendChild(e);this.checkAssetsLoaded();this.loadNext();break;case 5:e='<style type="text/css"> @font-face { font-family: \''+b.name+"'; src: url('"+b.source+"'); } </style>",z.getDocument().head.innerHTML+=e,this.checkAssetsLoaded(),this.loadNext()}this.loadNext()}}},onMinLoadElapsed:function(){this._minLoadTimeElapsed=!0;this.checkAssetsLoaded()},concatLoadBatch:function(a){for(var b=0,c=a._assetLoadingInfo.length;b<c;){var d=b++,d=a._assetLoadingInfo[d];this.hasAsset(d.name)||
this._assetLoadingInfo.push(d)}},hasAsset:function(a){for(var b=0,c=this._assetLoadingInfo.length;b<c;){var d=b++;if(this._assetLoadingInfo[d].name==a)return!0}return!1},__class__:Jb};var la=function(){};la.__name__=["engine","Localizer"];la.initStrings=function(){if(!la._isInitialized){var a=I.getAsset("strings"),a=B.parse(a);la.stringsXml=a.elementsNamed("strings").next();la._isInitialized=!0}};la.getString=function(a){try{var b=la.stringsXml.elementsNamed(a).next();if(b.nodeType!=B.Document&&b.nodeType!=
B.Element)throw new K("Bad node type, expected Element or Document but found "+b.nodeType);var c=b.children[0];if(c.nodeType==B.Document||c.nodeType==B.Element)throw new K("Bad node type, unexpected "+c.nodeType);return c.nodeValue}catch(d){throw new K("Could not find string: "+a);}};var ba=function(){L.call(this)};ba.__name__=["engine","Manager"];ba.__super__=L;ba.prototype=p(L.prototype,{__class__:ba});var wb=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.ul=
new s(a,b);this.wh=new s(c,d)};wb.__name__=["engine","Rect2D"];wb.prototype={getClone:function(){return new wb(this.ul.x,this.ul.y,this.wh.x,this.wh.y)},getIntersect:function(a){return!(this.ul.x>a.ul.x+a.wh.x||this.ul.x+this.wh.x<a.ul.x||this.ul.y>a.ul.y+a.wh.y||this.ul.y+this.wh.y<a.ul.y)},containsPoint:function(a){return a.x>this.ul.x&&a.y>this.ul.y&&a.x<this.ul.x+this.wh.x?a.y<this.ul.y+this.wh.y:!1},__class__:wb};var n=function(a,b,c){this._iosAudioEnabled=!1;this._prevWidth=this._prevHeight=
0;this._isUpdating=!0;this._hasFocus=!1;this._screenScale=null;this._isOrientationScreenShowing=!1;this._currentOrientation=0;this._isDeferredActionsPaused=!1;this._gameStates=this._managers=this._layers=this._deferredActions=null;this._gameHeight=768;this._gameWidth=1024;this._gameId=a;this._gameWidth=b;this._gameHeight=c;this._screenScale=new s(1,1);this._gameStates=[];n._instance=this;this._layers=[];this._managers=[];this._deferredActions=[]};n.__name__=["engine","Root"];n.getTimeScale=function(){return n._timeService.get_timeScale()};
n.setTimeScale=function(a){n._timeService.set_timeScale(a)};n.getDeltaTime=function(){return n._timeService.get_deltaTime()};n.getRealDeltaTime=function(){return n._timeService.get_realDeltaTime()};n.getInstance=function(){return n._instance};n.isAppMode=function(){return window.isStandalone};n.isPhone=function(){return-1!=navigator.userAgent.toLowerCase().indexOf("iphone")||-1!=navigator.userAgent.toLowerCase().indexOf("ipod")||-1!=navigator.userAgent.toLowerCase().indexOf("android")||-1!=navigator.userAgent.toLowerCase().indexOf("Linux")?
!0:!1};n.isIOS=function(){z.getWindow();var a=z.getWindow().navigator.platform;return-1!=a.indexOf("iPhone")||-1!=a.indexOf("iPod")||-1!=a.indexOf("iPad")?!0:!1};n.isCocoon=function(){return!1};n.isMobile=function(){z.getWindow();var a=z.getWindow().navigator.platform;return-1!=a.indexOf("iPhone")||-1!=a.indexOf("iPod")||-1!=a.indexOf("iPad")||-1!=a.indexOf("android")||-1!=a.indexOf("Linux")?!0:!1};n.isInternetExplorer=function(){return-1!=navigator.userAgent.toLowerCase().indexOf("msie")};n.isFirefox=
function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")};n.isSafari=function(){return-1<navigator.userAgent.toLowerCase().indexOf("safari/")};n.getDevicePixelRatio=function(){return 1};n.prototype={getGameStates:function(){return this._gameStates},getLayers:function(){return this._layers},getGameWidth:function(){return this._gameWidth},setGameWidth:function(a){this._gameWidth=a},getGameHeight:function(){return this._gameHeight},setGameHeight:function(a){this._gameHeight=a},getGameId:function(){return this._gameId},
init:function(){r.init();z.getContainer().focus();for(var a=0,b=this._gameStates;a<b.length;){var c=b[a];++a;c.init()}this._prevWidth=z.getWindow().innerWidth;this._prevHeight=z.getWindow().innerHeight;a=window;a.addEventListener("orientationchange",w(this,this.onOrientationChange),!1);a.addEventListener("pageshow",w(this,this.onOrientationChange),!1);a.addEventListener("resize",w(this,this.onResizeWindow),!1);a.onfocus=w(this,this.onFocusGained);a.onblur=w(this,this.onFocusLost);window.document.addEventListener("webkitvisibilitychange",
w(this,this.onWebkitVisibilityChange),!1);a.addEventListener("pagehide",w(this,this.onFocusLost),!1);n.isMobile()&&n.isIOS()&&a.addEventListener("touchend",w(this,this.onIosTouchEnd),!1);if(n.isMobile())this.onOrientationChange();else this.setScreenScale(1,1)},update:function(){if(!this._hasFocus)this.onFocusGained();if(this._isUpdating){for(var a=0,b=this._managers.length,a=b;0<a--;)b=this._managers[a],b.isMarkedForDeletion()&&(b.onDestroy(),this._managers.splice(a,1));b=this._managers.length;for(a=
0;a<b;){var c=a++,c=this._managers[c];c.isActive()&&c.update()}r.update();for(a=b=this._gameStates.length;0<a--;)b=this._gameStates[a],b.isMarkedForDeletion()&&(b.onDestroy(),this._gameStates.splice(a,1));b=this._gameStates.length;for(a=0;a<b;)c=a++,this._gameStates[c].isActive()&&this._gameStates[c].update();for(a=this._layers.length;0<a--;)b=this._layers[a],b.isMarkedForDeletion()&&(b.onDestroy(),F.remove(this._layers,b));a=0;for(b=this._layers.length;a<b;)c=a++,this._layers[c].update()}if(!this._isDeferredActionsPaused)for(a=
this._deferredActions.length;0<a--;)b=this._deferredActions[a],null!=b&&(b.timeUntilExecute-=n.getDeltaTime(),0>=b.timeUntilExecute&&(b.params?b.actionToExecute(b.params):b.actionToExecute(),this._deferredActions.splice(a,1)))},fixedUpdate:function(){var a=n._timeService.get_fixedIterationsThisFrame();n._timeService.set_isFixedTimeStep(!0);for(var b=0;b<a;){b++;for(var c=0,d=this._managers.length;c<d;){var e=c++,e=this._managers[e];e.isActive()&&e.fixedUpdate()}c=0;for(d=this._gameStates.length;c<
d;)e=c++,this._gameStates[e].isActive()&&this._gameStates[e].fixedUpdate()}n._timeService.set_isFixedTimeStep(!1)},postUpdate:function(){for(var a=0,b=this._managers.length;a<b;){var c=a++,c=this._managers[c];c.isActive()&&c.postUpdate()}a=0;for(b=this._gameStates.length;a<b;)c=a++,this._gameStates[c].isActive()&&this._gameStates[c].postUpdate()},processFrame:function(){n._timeService.update();this.fixedUpdate();this.update();this.render();this.postUpdate()},updateDivClass:function(){var a="container";
1==this._currentOrientation&&(a+=" portrait");z.getContainer().className=a},render:function(){for(var a=this._layers.length,b=0;b<a;){var c=b++,c=this._layers[c];c.getAutoClear()&&c.getWholeCanvasDirty()&&c.clear()}b=0;for(a=this._gameStates.length;b<a;)c=b++,this._gameStates[c].isActive()&&this._gameStates[c].render();b=0;for(a=this._managers.length;b<a;)c=b++,this._managers[c].isActive()&&this._managers[c].render();a=this._layers.length;for(b=0;b<a;)c=b++,c=this._layers[c],"debug"!=c.getName()&&
c.render()},debugRender:function(){for(var a=0,b=this._gameStates.length;a<b;){var c=a++;this._gameStates[c].debugRender()}a=0;for(b=this._managers.length;a<b;)c=a++,this._managers[c].debugRender();a=0;for(b=this._layers.length;a<b;)c=a++,c=this._layers[c],"debug"==c.getName()&&c.render(),c.debugRender()},addGameState:function(a){0<=this._gameStates.indexOf(a)&&(F.remove(this._gameStates,a),this._gameStates.push(a));for(var b=0,c=this._gameStates.length;b<c;){var d=b++;if(a==this._gameStates[d])return a}this._gameStates.push(a);
return a},removeGameState:function(a){a.destroy()},addManager:function(a){this._managers.push(a);a.init()},removeManager:function(a){for(var b=0,c=this._managers.length;b<c;){var d=b++;if(this._managers[d]==a){this._managers.splice(d,1);a.destroy();break}}},getManager:function(a){for(var b=0,c=this._managers.length;b<c;){var d=b++;if(C.__instanceof(this._managers[d],a))return this._managers[d]}return null},setDeferredActionsPaused:function(a){this._isDeferredActionsPaused=a},destroyAllDeferredActions:function(){this._deferredActions=
[]},switchToGameState:function(a,b){null!=a&&this.removeGameState(a);null!=b&&this.addGameState(b)},addLayer:function(a,b){null==b&&(b=!1);b?this._layers.splice(0,0,a):this._layers.push(a)},insertLayerAfter:function(a,b){var c=this._layers,d=this._layers.indexOf(b)+1;c.splice(d,0,a)},removeLayer:function(a){a.destroy();F.remove(this._layers,a)},getLayerByName:function(a){for(var b=0,c=this._layers.length;b<c;){var d=b++,d=this._layers[d];if(d.getName()==a)return d}return null},sendGlobalMessage:function(a,
b){for(var c=this._managers.length-1;0<=c;)this._managers[c].handleMessage(a,b),--c;for(c=this._gameStates.length-1;0<=c;)this._gameStates[c].handleMessage(a,b),--c},invokeAsyncDeferredAction:function(a,b,c){a=new $d(a,b,c);this._deferredActions.push(a);return a},destroyDeferredAction:function(a){F.remove(this._deferredActions,a)},onOrientationChange:function(){var a=this;this.invokeAsyncDeferredAction(0.35,function(){var b=!1,b=n.isMobile()?z.getWindow().innerWidth>z.getWindow().innerHeight:!0;"HORIZONTAL"==
R.getProperty("forceOrientation")?(a._currentOrientation=0,b=!0):"VERTICAL"==R.getProperty("forceOrientation")?(a._currentOrientation=1,b=!1):a._currentOrientation=b?0:1;a.onResizeWindow();a.sendGlobalMessage("onOrientationChanged",{isHorizontal:b})})},setScreenScale:function(a,b){this.updateDivClass();this._screenScale.x=a;this._screenScale.y=b;this.onScreenScaleUpdated()},getScreenScale:function(){return null!=fa.getInstance()&&null!=fa.getInstance().getStage()?new s(fa.getInstance().getStage().scale.x,
fa.getInstance().getStage().scale.y):new s(1,1)},getGameSize:function(){return new s(this._gameWidth,this._gameHeight)},getScreenOffset:function(){var a=z.getWindow().innerWidth,b=z.getWindow().innerHeight;return new s(Math.max(0,a/2-this._gameWidth*this.getScreenScale().x/2),Math.max(0,b/2-this._gameHeight*this.getScreenScale().y/2))},getCurrentOrientation:function(){return this._currentOrientation},onWebkitVisibilityChange:function(){if(z.getDocument().webkitHidden)this.onFocusLost();else this.onFocusGained()},
onFocusGained:function(){this._hasFocus||(qa.getInstance().disablePageKeyPresses(),r.resumeAllSounds(),this._isUpdating=this._hasFocus=!0,this.sendGlobalMessage("onFocusGained"))},onFocusLost:function(){r.pauseAllSounds();this._hasFocus&&(qa.getInstance().enablePageKeyPresses(),this._isUpdating=this._hasFocus=!1,this.sendGlobalMessage("onFocusLost"))},onResizeWindow:function(){var a=1,b=a,b="1"==R.getProperty("scaleToScreenOnDesktop");n.isMobile()||b?(b=z.getWindow(),b=a=Math.min(b.innerHeight/this._gameHeight,
b.innerWidth/this._gameWidth)):a=b=1;this.sendGlobalMessage("onResizedWindow");this.setScreenScale(b,a)},onScreenScaleUpdated:function(){z.getWindow();z.getWindow();z.getContainer();n.getDevicePixelRatio();n.isMobile()&&this.hideAddressBar();this.sendGlobalMessage("onScreenScaleUpdated")},stopUpdates:function(){this._isUpdating=!1},resumeUpdates:function(){this._isUpdating=!0},hideAddressBar:function(){if(n.isPhone()&&!window.location.hash){var a=window.outerHeight;document.height<a&&(document.body.style.height=
a+50+"px");setTimeout(function(){window.scrollTo(0,1)},50)}},requestFullscreen:function(){if(!n.isIOS()){var a=window.document,b=a.documentElement,c=b.requestFullscreen||b.mozRequestFullScreen||b.webkitRequestFullScreen||b.msRequestFullscreen;a.fullscreenElement||(a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement)||c.call(b)}},onIosTouchEnd:function(){if(!1==this._iosAudioEnabled)try{var a=r.getAudioContextInstance(),b=a.createBuffer(1,1,22050),c=a.createBufferSource();c.buffer=
b;c.connect(a.destination);c.start(0);this._iosAudioEnabled=!0;Ea.log("Audio enabled for iOS")}catch(d){Ea.log("error")}},__class__:n};var mf=function(){this._data={};this.load()};mf.__name__=["engine","SaveData"];mf.prototype={setItem:function(a,b){this._data[a]=b;this.save()},getItem:function(a,b){if(Object.prototype.hasOwnProperty.call(this._data,a))return ta.field(this._data,a);this.setItem(a,b);return b},save:function(){var a=n.getInstance().getGameId()+"Data";if(null!=Va.getSessionStorage())try{Va.getSessionStorage().setItem(a,
JSON.stringify(this._data))}catch(b){Ea.log("Error saving to session storage")}if(null!=Va.getLocalStorage())try{Va.getLocalStorage().setItem(a,JSON.stringify(this._data))}catch(c){Ea.log("Error saving to local storage")}},load:function(){var a=n.getInstance().getGameId()+"Data";if(null!=Va.getSessionStorage()||null!=Va.getLocalStorage()){var b=null;try{b=Va.getSessionStorage().getItem(a)}catch(c){Ea.log("Failed to get item from session storage")}if(null==b)try{b=Va.getLocalStorage().getItem(a)}catch(d){Ea.log("Failed to get item from session storage")}null!=
b&&(this._data=JSON.parse(b))}},deleteAllSaveData:function(){this._data={};this.save()},__class__:mf};var s=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=this.y=0;this.x=a;this.y=b};s.__name__=["engine","Vector2"];s.prototype={getClone:function(){return new s(this.x,this.y)},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},scaleBy:function(a,b){this.x*=a;this.y*=b},dotProduct:function(a){return this.x*a.x+this.y*a.y},getNormalized:function(){var a=this.getLength();return new s(this.x/
a,this.y/a)},__class__:s};var O=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=this.y=this.z=0;this.x=a;this.y=b;this.z=c};O.__name__=["engine","Vector3"];O.lerp=function(a,b,c){return new O(a.x+(b.x-a.x)*c,a.y+(b.y-a.y)*c,a.z+(b.z-a.z)*c)};O.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};O.prototype={add:function(a){return new O(this.x+a.x,this.y+a.y,this.z+a.z)},subtract:function(a){return new O(this.x-a.x,this.y-a.y,this.z-a.z)},scaleBy:function(a){this.x*=a;this.y*=a;this.z*=
a},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},getClone:function(){return new O(this.x,this.y,this.z)},getNormalized:function(){var a=this.getLength();return new O(this.x/a,this.y/a,this.z/a)},__class__:O};var Z=function(a,b,c){this._isMuted=!1;this._currentTime=0;this._isInitialized=!1;this._soundName=a;this._volume=b;this._loop=c;this.init()};Z.__name__=["engine","audio","SoundData"];Z.prototype={init:function(){this._isInitialized=!0},play:function(a){},resume:function(){},
update:function(){this._currentTime+=n.getDeltaTime()},pause:function(){},stop:function(){r.removeSoundFromPlayingSounds(this)},getVolume:function(){return this._volume},setVolume:function(a){this._volume=a},getMuted:function(){return this._isMuted},setMuted:function(a){this._isMuted=a},getLoop:function(){return this._loop},setLoop:function(a){this._loop=a},getSoundLength:function(){return 1},getCurrentTime:function(){return this._currentTime},setCurrentTime:function(a){this._currentTime=a},getSoundName:function(){return this._soundName},
__class__:Z};var Pc=function(a,b,c){Z.call(this,a,b,c)};Pc.__name__=["engine","audio","FlashSoundData"];Pc.__super__=Z;Pc.prototype=p(Z.prototype,{init:function(){Z.prototype.init.call(this);this._audio=soundManager.createSound({id:this._soundName});this._audio.setVolume(100*this._volume)},play:function(a){null==a&&(a=0);Z.prototype.play.call(this,a);var b=this;this._audio.play({onfinish:function(){b._loop&&b.play(0);r.removeSoundFromPlayingSounds(b)},onstop:function(){r.removeSoundFromPlayingSounds(b)}})},
pause:function(){Z.prototype.pause.call(this);this._audio.pause()},stop:function(){Z.prototype.stop.call(this);this._audio.stop()},resume:function(){Z.prototype.resume.call(this);this._audio.resume()},setVolume:function(a){Z.prototype.setVolume.call(this,a);this._audio.setVolume(100*a)},__class__:Pc});var Qc=function(a,b,c){Z.call(this,a,b,c)};Qc.__name__=["engine","audio","Html5SoundData"];Qc.__super__=Z;Qc.prototype=p(Z.prototype,{init:function(){Z.prototype.init.call(this)},play:function(a){null==
a&&(a=0);var b=this;Z.prototype.play.call(this,a);this._audio=I.getAsset(this._soundName);0!=a&&this._audio.addEventListener("canplay",function(c){b._audio.currentTime=a});this._audio.play();this._audio.addEventListener("ended",w(this,this.onSoundComplete),!1);this._audio.loop=this._loop;this._audio.volume=this._volume},resume:function(){Z.prototype.resume.call(this);this._audio.play()},pause:function(){Z.prototype.pause.call(this);this._audio.pause()},stop:function(){Z.prototype.stop.call(this);
this._audio.pause()},onSoundComplete:function(a){r.removeSoundFromPlayingSounds(this)},setVolume:function(a){Z.prototype.setVolume.call(this,a);this._audio.volume=a},setMuted:function(a){Z.prototype.setMuted.call(this,a);this._audio.muted=a},setLoop:function(a){Z.prototype.setLoop.call(this,a);null!=this._audio&&(this._audio.loop=a)},getCurrentTime:function(){return this._audio.currentTime},setCurrentTime:function(a){this._audio.currentTime=a},__class__:Qc});var r=function(){};r.__name__=["engine",
"audio","SoundManager"];r.getMusicTrack=function(){return r._musicTrack};r.init=function(){try{r._audioContext=new AudioContext,r._isWebkitEnabled=!n.isFirefox()&&null!=r._audioContext}catch(a){if(n.isInternetExplorer())try{soundManager.setup({url:"soundmanager2_flash9.swf",flashVersion:9,onready:r.onSoundManagerReady,ontimeout:r.onSoundManagerTimeout,useHighPerformance:!0})}catch(b){r._useFlashSound=!1}}window.document.body.addEventListener("pointerdown",r.onPointerDown);r._musicTrack=new Rc(null)};
r.onPointerDown=function(){null!=r._audioContext&&r._audioContext.resume();window.document.body.removeEventListener("pointerdown",r.onPointerDown)};r.onSoundManagerReady=function(){r._useFlashSound=!0==soundManager.html5.usingFlash};r.onSoundManagerTimeout=function(){r._useFlashSound=!1==soundManager.html5.usingFlash};r.getAudioContextInstance=function(){return r._audioContext};r.isWebkitEnabled=function(){return r._isWebkitEnabled?!r._useFlashSound:!1};r.setWebkitEnabled=function(a){r._isWebkitEnabled=
a};r.isMusicMuted=function(){return r._musicMuted};r.setMusicMuted=function(a){r._musicMuted=a;null!=r._musicTrack.get()&&r._musicTrack.get().setMuted(a);r.isWebkitEnabled()||(n.isMobile()&&a?r._musicTrack.get().pause():n.isMobile()&&!a&&r._musicTrack.get().play())};r.isSoundMuted=function(){return r._soundMuted};r.setSoundMuted=function(a){r._soundMuted=a;for(var b=0,c=r._soundsPlaying.length;b<c;){var d=b++;r._soundsPlaying[d].setMuted(a)}};r.getMasterVolume=function(){return r._masterVolume};r.setMasterVolume=
function(a){r._masterVolume=a;r.setMusicVolume(r._musicVolume);r.setSoundVolume(r._soundVolume)};r.getMusicVolume=function(){return r._musicVolume};r.setMusicVolume=function(a){r._musicVolume=a;null!=r._musicTrack&&null!=r._musicTrack.get()&&r._musicTrack.get().setVolume(r.getMusicVolume()*r.getMasterVolume())};r.getSoundVolume=function(){return r._soundVolume};r.setSoundVolume=function(a){r._soundVolume=a;a=0;for(var b=r._soundsPlaying.length;a<b;){var c=a++;r._soundsPlaying[c].setVolume(r.getSoundVolume()*
r.getMasterVolume())}};r.playRandomSoundByName=function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);return r.playSoundByName(a[ka.randomInt(0,a.length)],b,c)};r.playSoundByName=function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);if(!r.isWebkitEnabled()&&n.isMobile()&&!b||!I.assetExists(a))return null;a=r.isWebkitEnabled()?new Sc(a,r.getSoundVolume()*r.getMasterVolume(),c):r.getUseFlashSound()?new Pc(a,r.getMasterVolume()*r.getSoundVolume(),c):new Qc(a,r.getSoundVolume()*r.getMasterVolume(),c);a.play();a.setMuted(r._soundMuted);
r._soundsPlaying.push(a);return a};r.update=function(){for(var a=0,b=r._soundsPlaying.length;a<b;){var c=a++,c=r._soundsPlaying[c];null==c?r.removeSoundFromPlayingSounds(c):c.update()}null!=r._musicTrack.get()&&r._musicTrack.get().update()};r.onSoundComplete=function(a){r.removeSoundFromPlayingSounds(a.currentTarget)};r.removeSoundFromPlayingSounds=function(a){F.remove(r._soundsPlaying,a)};r.addSoundToPlayingSounds=function(a){r._soundsPlaying.push(a)};r.isSoundPlaying=function(a){return-1!=r._soundsPlaying.indexOf(a)};
r.pauseAllSounds=function(){null!=r._musicTrack.get()&&r._musicTrack.get().pause();for(var a=0,b=r._soundsPlaying.length;a<b;){var c=a++,c=r._soundsPlaying[c];null!=c&&c.pause()}};r.resumeAllSounds=function(){for(var a=r._soundsPlaying.length,b=[].concat(r._soundsPlaying),c=0;c<a;){var d=c++;b[d].resume()}null!=r._musicTrack.get()&&(r._musicTrack.get().pause(),r._musicTrack.get().resume())};r.playMusicByNameOnMobileOnly=function(a){return n.isMobile()?r.playMusicByName(a,!0):null};r.playMusicByName=
function(a,b){null==b&&(b=!0);if(n.isMobile()&&!b)return null;if(!I.assetExists(a))return Ea.log(a+" doesn't exist!"),null;if(null!=r._musicTrack.get()){if(r._musicTrack.get().getSoundName()==a)return r._musicTrack.get();r._musicTrack.get().stop()}var c;c=r.isWebkitEnabled()?new Sc(a,r.getMasterVolume()*r.getMusicVolume(),!0):r._useFlashSound?new Pc(a,r.getMusicVolume()*r.getMasterVolume(),!0):new Qc(a,r.getMasterVolume()*r.getMusicVolume(),!0);c.play(0);r._musicTrack.set(c);r.setMusicVolume(r._musicVolume);
r._musicTrack.get().setMuted(r._musicMuted);return r._musicTrack.get()};r.stopMusic=function(){null!=r._musicTrack.get()&&(r._musicTrack.get().stop(),r._musicTrack=new Rc(null))};r.stopAllSounds=function(){for(var a=r._soundsPlaying.length-1;0<=a;){var b=r._soundsPlaying[a];null!=b&&b.stop();r.removeSoundFromPlayingSounds(b);--a}r._soundsPlaying=[]};r.getUseFlashSound=function(){return r._useFlashSound};r.prototype={__class__:r};var Sc=function(a,b,c){null==c&&(c=!1);null==b&&(b=1);this._audio=null;
Z.call(this,a,b,c)};Sc.__name__=["engine","audio","WebkitSoundData"];Sc.__super__=Z;Sc.prototype=p(Z.prototype,{init:function(){Z.prototype.init.call(this);this._audioContext=r.getAudioContextInstance();this._audio=this._audioContext.createBufferSource();this._audio.buffer=I.getAsset(this._soundName);this._gainNode=null!=(gb=this._audioContext,w(gb,gb.createGain))?this._audioContext.createGain():this._audioContext.createGainNode();this._audio.connect(this._gainNode,0,0);this._gainNode.connect(this._audioContext.destination,
0,0);this._audio.loop=this._loop;this._audio.id=this._soundName;this.setVolume(this._volume)},play:function(a){null==a&&(a=0);Z.prototype.play.call(this,a);this._currentTime=a;try{null!=(gb=this._audio,w(gb,gb.start))?this._audio.start(this._audioContext.currentTime,a):0==a?this._audio.noteOn():this._audio.noteGrainOn(this._audioContext.currentTime,a)}catch(b){this._audio.noteOn(this._audioContext.currentTime,a,this._audio.buffer.duration-a)}},pause:function(){Z.prototype.pause.call(this);if(!(null==
this._audio||null!=this._audio&&null!=this._audio.buffer&&this.getCurrentTime()>this.getSoundLength()&&!this.getLoop())){if(null!=(gb=this._audio,w(gb,gb.stop)))try{this._audio.stop(this._audioContext.currentTime)}catch(a){}else try{this._audio.noteOff(this._audioContext.currentTime)}catch(b){}r.removeSoundFromPlayingSounds(this)}},resume:function(){Z.prototype.resume.call(this);null!=this._audio&&null!=this._audio.buffer&&this.getCurrentTime()>this.getSoundLength()&&!this.getLoop()||(this.stop(),
this.init(),this.play(this._currentTime),r.addSoundToPlayingSounds(this))},stop:function(){Z.prototype.stop.call(this);if(null!=this._audio){if(null!=(gb=this._audio,w(gb,gb.stop)))try{this._audio.stop(this._audioContext.currentTime)}catch(a){}else try{this._audio.noteOff(this._audioContext.currentTime)}catch(b){}this._audio=null;r.removeSoundFromPlayingSounds(this)}},getSoundLength:function(){return this._audio.buffer.duration},update:function(){Z.prototype.update.call(this);this.getCurrentTime()>
this.getSoundLength()&&!this.getLoop()?r.removeSoundFromPlayingSounds(this):this.getCurrentTime()>this.getSoundLength()&&(this._currentTime-=this.getSoundLength())},onSoundComplete:function(){},setCurrentTime:function(a){Z.prototype.setCurrentTime.call(this,a);this.stop();this.init();this.play(a)},setVolume:function(a){Z.prototype.setVolume.call(this,a);if(null!=this._audio||null!=this._gainNode)this._gainNode.gain.value=this._isMuted?0:a},setMuted:function(a){Z.prototype.setMuted.call(this,a);this._gainNode.gain.value=
this._isMuted?0:this._volume},setLoop:function(a){Z.prototype.setLoop.call(this,a);null!=this._audio&&(this._audio.loop=a)},__class__:Sc});var ae=function(){};ae.__name__=["engine","box2d","Box2dContactListener"];ae.__super__=eb;ae.prototype=p(eb.prototype,{beginContact:function(a){eb.prototype.beginContact.call(this,a);var b=a.getFixtureA().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new xb("beginContact",{contact:a})));b=a.getFixtureB().getBody().getUserData();null!=b&&
(b=b.entity,null!=b&&b.dispatchEvent(new xb("beginContact",{contact:a})))},endContact:function(a){eb.prototype.endContact.call(this,a);var b=a.getFixtureA().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new xb("endContact",{contact:a})));b=a.getFixtureB().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new xb("endContact",{contact:a})))},preSolve:function(a,b){eb.prototype.preSolve.call(this,a,b)},postSolve:function(a,b){eb.prototype.postSolve.call(this,
a,b)},__class__:ae});var P=function(a){this._type=a};P.__name__=["engine","events","Event"];P.prototype={getType:function(){return this._type},__class__:P};var xb=function(a,b){this._data=null;this._type=a;this._data=b};xb.__name__=["engine","box2d","Box2dEvent"];xb.__super__=P;xb.prototype=p(P.prototype,{getData:function(){return this._data},setData:function(a){this._data=a},__class__:xb});var Tc=function(a,b){null==b&&(b="debug");this._debugLayerName="";this._physicsScale=0.03333333333333333;this._positionIterations=
2;this._velocityIterations=6;this._b2World=this._gravity=null;L.call(this);null==a&&(a=new s(0,0));this._gravity=new t(a.x,a.y);this._debugLayerName=b;this._b2World=new ca(this._gravity,!1)};Tc.__name__=["engine","box2d","Box2dManager"];Tc.__super__=ba;Tc.prototype=p(ba.prototype,{get_velocityIterations:function(){return this._velocityIterations},set_velocityIterations:function(a){return this._velocityIterations=a},get_positionIterations:function(){return this._positionIterations},set_positionIterations:function(a){return this._positionIterations=
a},init:function(){ba.prototype.init.call(this);this._debugDrawLayer=n.getInstance().getLayerByName(this._debugLayerName);this._debugDraw=new za;this._debugDraw.setSprite(this._debugDrawLayer.getCanvas().getContext("2d"));this._debugDraw.setDrawScale(30);this._debugDraw.setLineThickness(1);this._debugDraw.setAlpha(0.5);this._debugDraw.setFillAlpha(0.1);this._debugDraw.setFlags(za.e_shapeBit|za.e_jointBit|za.e_centerOfMassBit);this._b2World.setDebugDraw(this._debugDraw);this._b2World.setContactListener(new ae)},
getB2World:function(){return this._b2World},getGravity:function(){return this._gravity},setGravity:function(a){this._gravity=a;this._b2World.setGravity(a);return a},getPhysicsScale:function(){return this._physicsScale},getInversePhysicsScale:function(){return 1/this._physicsScale},setPhysicsScale:function(a){this._physicsScale=a},update:function(){ba.prototype.update.call(this);this.dispatchEvent(new Yb("preUpdate"));for(var a=0,b=Math.max(1,Math.floor(n.getDeltaTime()/0.016666666666666666));a<b;)a++,
this._b2World.step(0.016666666666666666,this._velocityIterations,this._positionIterations),this._b2World.clearForces();this.dispatchEvent(new Yb("update"))},getPixelToWorld:function(a,b){return new t(a*this._physicsScale,b*this._physicsScale)},getWorldToPixel:function(a,b){return new s(a/this._physicsScale,b/this._physicsScale)},debugRender:function(){ba.prototype.debugRender.call(this);this._b2World.drawDebugData();this._debugDrawLayer.setWholeCanvasDirty(!0)},__class__:Tc,__properties__:{set_positionIterations:"set_positionIterations",
get_positionIterations:"get_positionIterations",set_velocityIterations:"set_velocityIterations",get_velocityIterations:"get_velocityIterations"}});var Yb=function(a){this._type=a};Yb.__name__=["engine","box2d","Box2dManagerEvent"];Yb.__super__=P;Yb.prototype=p(P.prototype,{__class__:Yb});var wa=function(a,b,c){this._loop=!0;this._length=0;this._name=a;this._animationKeyframes=[];null!=b&&(this._length=b);this._offset=new s};wa.__name__=["engine","components","Animation"];wa.parseFromXmlString=function(a,
b){for(var c=B.parse(b),d=c.elementsNamed("animation").next().get("name"),d=new wa(d,c.elementsNamed("animation").next().get("length")),c=c.elementsNamed("animation").next().elementsNamed("keyframe");c.hasNext();){var e=c.next(),e=new be(e.get("index"),e.get("spriteIndex"),a);d.addKeyframe(e)}La.getInstance().registerAnimation(d);return d};wa.makeLinearAnimationFromSheetBySpriteName=function(a,b,c,d,e,f,g){null==g&&(g=0);null==f&&(f=-1);null==e&&(e=!1);var k=Pa.getInstance().getSpriteSheetByName(b),
h=k.getNumSprites();-1==f&&(f=h);for(var l=0,m=0,u=f;m<u;){var n=m++;Ab.startsWith(k.getSpriteInfoByIndex(n).getName(),c)&&++l}a=new wa(a,l*d);for(m=l=0;m<h&&!(u=m++,Ab.startsWith(k.getSpriteInfoByIndex(u).getName(),c)&&(u=new be(g,u,b),a.addKeyframe(u),g+=d,++l,l>=f)););a.setLoop(e);La.getInstance().registerAnimation(a);return a};wa.createAnimation=function(a,b,c,d,e){null==e&&(e=!0);null==d&&(d=1);null==La.getInstance().getAnimationByName(a)&&(Zb.parseFromXmlString(a,a,I.getAsset(b)),wa.makeLinearAnimationFromSheetBySpriteName(a,
a,"",d,e).setOffset(c.x,c.y))};wa.appendAnimation=function(a,b,c,d,e){null==e&&(e=1);if(null==La.getInstance().getAnimationByName(b))for(a=La.getInstance().getAnimationByName(a),Zb.parseFromXmlString(b,b,I.getAsset(c)),b=wa.makeLinearAnimationFromSheetBySpriteName("tempAnim",b,"",e,!1,-1,a.getKeyframeLength()),b.setOffset(d.x,d.y),d=b.getAnimationKeyframes(),b=0,c=d.length;b<c;)e=b++,a.addKeyframe(d[e])};wa.prototype={getAnimationKeyframes:function(){return this._animationKeyframes},getKeyframeLength:function(){return this._length},
getLength:function(){return this._length/30},getName:function(){return this._name},getLoop:function(){return this._loop},setLoop:function(a){this._loop=a},getOffset:function(){return this._offset},setOffset:function(a,b){this._offset.x=a;this._offset.y=b},addKeyframe:function(a){this._animationKeyframes.push(a);var b=a.getPosition();this._length=Math.max(this._length,a.getPosition());b>this._length&&(this._length=b)},getSpriteIndexAtPosition:function(a){for(var b=this._animationKeyframes.length,c=
this._animationKeyframes[0].getSpriteIndex(),d=0;d<b;){var e=d++;if(a>=this._animationKeyframes[e].getPosition()/30)c=this._animationKeyframes[e].getSpriteIndex();else break}return c},getSpriteSheetNameAtPosition:function(a){for(var b=this._animationKeyframes.length,c=this._animationKeyframes[0].getSpriteSheetName(),d=0;d<b;){var e=d++;if(a>=this._animationKeyframes[e].getPosition()/30)c=this._animationKeyframes[e].getSpriteSheetName();else break}return c},__class__:wa};var Fa=function(a,b,c,d,e){this._inactiveOneFrame=
!1;this._killMessageOnMouseDown=!0;this._isMouseOver=!1;this._handPointer=!0;this._onClicked=this._onMouseDown=this._onMouseUp=this._onMouseMoved=this._onMouseOver=this._onMouseOut=null;m.call(this,a);this._boxCollision=new oc;this._collisionSize=b;this._collisionOffset=c;this._camera=e;this.setOnMouseDown(d)};Fa.__name__=["engine","components","Button"];Fa.createFromHTMLElement=function(a){return new Fa(a.getEntity(),a.getSize(),new s(0,0))};Fa.createFromHTMLElementID=function(a,b,c){null==c&&(c=
0);b=z.getDocument().getElementById(b);var d=b.clientWidth+c,e=b.clientHeight+c;return new Fa(a,new s(d,e),new s(b.offsetLeft-a.getPosition().x-c/2+d/2,b.offsetTop-a.getPosition().y-c/2+e/2))};Fa.createFromEdgeHTMLElementID=function(a,b,c,d){null==d&&(d=0);var e=z.getDocument().getElementById(b);b=ga.parseInt(e.style.width)+d;var f=ga.parseInt(e.style.height)+d,g=Za.getStylePositionOfDomElement(e).y-d/2;d=Za.getStylePositionOfDomElement(e).x-d/2;return new Fa(a,new s(b,f),new s(d-a.getPosition().x+
b/2,g-a.getPosition().y+f/2),c)};Fa.createFromPixiSprite=function(a){return new Fa(a.getEntity(),new s(a.getSprite().texture.width,a.getSprite().texture.height),null)};Fa.__super__=m;Fa.prototype=p(m.prototype,{setOnClicked:function(a){this._onClicked=a},setOnMouseDown:function(a){this._onMouseDown=a},setOnMouseMoved:function(a){this._onMouseMoved=a},setOnMouseUp:function(a){this._onMouseUp=a},setOnMouseOut:function(a){this._onMouseOut=a},getKillMessageOnMouseDown:function(){return this._killMessageOnMouseDown},
setKillMessageOnMouseDown:function(a){this._killMessageOnMouseDown=a},getData:function(){return this._data},getCollisionSize:function(){return this._collisionSize},setData:function(a){this._data=a},init:function(){m.prototype.init.call(this);this._prevPosition=new s(this.getEntity().getPosition().x,this.getEntity().getPosition().y);this.updateCollision()},update:function(){m.prototype.update.call(this);this._inactiveOneFrame=!1;!1==this.getEntity().isVisible()&&(this._inactiveOneFrame=!0);if(this._isMouseOver&&
this.isButtonDisabledByButtonGroup(this.getEntity()))this.onMouseOut(qa.getInstance().getMousePosition());this.updateCollision()},setOffset:function(a,b){this._collisionOffset=new s(a,b)},getOffset:function(){return this._collisionOffset},updateCollision:function(){var a=this.getEntity().getPosition();this._boxCollision.ul.x=a.x-this._collisionSize.x/2;this._boxCollision.ul.y=a.y-this._collisionSize.y/2;this._boxCollision.wh.x=this._collisionSize.x;this._boxCollision.wh.y=this._collisionSize.y;null!=
this._collisionOffset&&(this._boxCollision.ul.x+=this._collisionOffset.x,this._boxCollision.ul.y+=this._collisionOffset.y)},onMouseClick:function(a){a=a.getClone();a.x>n.getInstance().getGameSize().x||(0>a.x||a.y>n.getInstance().getGameSize().y||0>a.y)||(null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale())),this._boxCollision.checkPointIntersect(a)&&
(this.getEntity().dispatchEvent(new U("mouseClick",{button:this,entity:this.getEntity()})),null!=this._onClicked&&this._onClicked(this)))},onMouseDown:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));return this._boxCollision.checkPointIntersect(a)?(this.getEntity().dispatchEvent(new U("mouseDown",
{button:this,entity:this.getEntity()})),null!=this._onMouseDown&&this._onMouseDown(this),n.isMobile()&&(this._isMouseOver=!0),!0):!1},onMouseMoved:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));if(this._boxCollision.checkPointIntersect(a)){this.getEntity().dispatchEvent(new U("mouseOver",
{button:this,entity:this.getEntity()}));if(!this._isMouseOver)this.onMouseOver(a);this._isMouseOver=!0;this.getEntity().dispatchEvent(new U("mouseMove",{button:this,entity:this.getEntity()}));null!=this._onMouseMoved&&this._onMouseMoved(this)}else this._isMouseOver&&!n.isMobile()&&(this.onMouseOut(a),this._isMouseOver=!1)},onMouseUp:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*
this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));this._boxCollision.checkPointIntersect(a)&&(this.getEntity().dispatchEvent(new U("mouseUp",{button:this,entity:this.getEntity()})),null!=this._onMouseUp&&this._onMouseUp(this))},onMouseOver:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),
1/this._camera.getZoomScale()));this._handPointer&&(z.getDocument().body.style.cursor="pointer");this.getEntity().dispatchEvent(new U("mouseOver",{button:this,entity:this.getEntity()}));null!=this._onMouseOver&&this._onMouseOver(this);this._isMouseOver=!0},onMouseOut:function(a){null!=a&&(a=a.getClone(),null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),
1/this._camera.getZoomScale())),this._handPointer&&(z.getDocument().body.style.cursor="default"),this.getEntity().dispatchEvent(new U("mouseOut",{button:this,entity:this.getEntity()})),null!=this._onMouseOut&&this._onMouseOut(this),this._isMouseOver=!1)},verifyTouches:function(a){var b=!1;if(null!=a&&null!=a.touches){for(var c=0,d=a.touches.length;c<d;){var e=c++,f=a.touches[e],g=n.getInstance().getScreenOffset(),e=(f.pageX-g.x)/n.getInstance().getScreenScale().x,f=(f.pageY-g.y)/n.getInstance().getScreenScale().y;
this._boxCollision.checkPointIntersect(new s(e,f))&&(b=!0)}if(!b&&this._isMouseOver)this.onMouseOut(null);else if(b&&!this._isMouseOver)this.onMouseOver(null)}},setCollisionProperties:function(a,b){this._collisionSize=a;this._collisionOffset=b},isButtonDisabledByButtonGroup:function(a){var b=a.getComponent($b);if(null!=b&&!b.isInputEnabled())return!0;a=a.getParent();return null!=a?this.isButtonDisabledByButtonGroup(a):!1},handleMessage:function(a,b){m.prototype.handleMessage.call(this,a,b);if(!(b&&
b.isDisabled||!this.getEntity().isVisible()||!this.isActive()||this.isButtonDisabledByButtonGroup(this.getEntity())||this._inactiveOneFrame))switch(a){case "mouseClick":this.onMouseClick(b);break;case "mouseDown":this.onMouseDown(b)&&this._killMessageOnMouseDown&&(b.isDisabled=!0);break;case "mouseMove":this.onMouseMoved(b);break;case "mouseUp":this.onMouseUp(b);break;case "verifyTouches":this.verifyTouches(b)}},onActivate:function(){m.prototype.onActivate.call(this);this._inactiveOneFrame=!0},onDeactivate:function(){m.prototype.onDeactivate.call(this);
this._isMouseOver&&this._handPointer&&(z.getDocument().body.style.cursor="default")},debugRender:function(){m.prototype.debugRender.call(this);var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ea.getDebugCamera()){var b=ea.getDebugCamera().getEntity();a.translate(-b.getPosition().x,-b.getPosition().y)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(this._boxCollision.ul.x,this._boxCollision.ul.y);a.lineTo(this._boxCollision.ul.x+this._boxCollision.wh.x,
this._boxCollision.ul.y);a.lineTo(this._boxCollision.ul.x+this._boxCollision.wh.x,this._boxCollision.ul.y+this._boxCollision.wh.y);a.lineTo(this._boxCollision.ul.x,this._boxCollision.ul.y+this._boxCollision.wh.y);a.lineTo(this._boxCollision.ul.x,this._boxCollision.ul.y);a.stroke();a.restore()},destroy:function(){m.prototype.destroy.call(this);if(this._isMouseOver)this.onMouseOut(null)},__class__:Fa});var ea=function(a){this._offset=null;this._zoomScale=1;this._target=this._cameraBounds=this._slackMovement=
null;m.call(this,a);this._offset=new s;this._lensWidth=n.getInstance().getGameSize().x;this._lensHeight=n.getInstance().getGameSize().y;null==ea._debugCamera&&(ea._debugCamera=this)};ea.__name__=["engine","components","Camera"];ea.getDebugCamera=function(){return ea._debugCamera};ea.__super__=m;ea.prototype=p(m.prototype,{getTarget:function(){return this._target},setTarget:function(a){null!=this._target&&this._target.removeEventListener("destroy",w(this,this.onTargetDestroy));this._target=a;null!=
this._target&&this._target.addEventListener("destroy",w(this,this.onTargetDestroy))},setOffset:function(a){this._offset=a},getOffset:function(){return this._offset},getZoomScale:function(){return this._zoomScale},setZoomScale:function(a){this._zoomScale=a},getLensSize:function(){return new s(this._lensWidth,this._lensHeight)},setLensSize:function(a,b){this._lensWidth=a;this._lensHeight=b},init:function(){m.prototype.init.call(this);this._slackMovement=this.getComponent(pc)},getSlackMovement:function(){return this._slackMovement},
jumpToTarget:function(){null!=this._target&&this.getEntity().setLocalPosition(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z)},getCenter:function(){var a=this.getEntity().getPosition();return new O(a.x-this._lensWidth/this._zoomScale/2,a.y-this._lensHeight/this._zoomScale/2,a.z)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);
null!=this._target&&(null==this._slackMovement?this.getEntity().setLocalPosition(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z):this._slackMovement.setTarget(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/
this._zoomScale,this.getEntity().getPosition().z));this.updateCameraBounds()},updateCameraBounds:function(){if(null!=this._cameraBounds){var a=this.getEntity().getPosition().getClone(),b=this._lensWidth/2/this._zoomScale,c=this._lensHeight/2/this._zoomScale,d=new s(a.x+b,a.y+c),e=!1;d.x-b<this._cameraBounds.ul.x&&(d.x=this._cameraBounds.ul.x+b,e=!0);d.y-c<this._cameraBounds.ul.y&&(d.y=this._cameraBounds.ul.y+c,e=!0);d.x+b>this._cameraBounds.ul.x+this._cameraBounds.wh.x&&(d.x=this._cameraBounds.ul.x+
this._cameraBounds.wh.x-b,e=!0);d.y+c>this._cameraBounds.ul.y+this._cameraBounds.wh.y&&(d.y=this._cameraBounds.ul.y+this._cameraBounds.wh.y-c,e=!0);a.x=d.x-b;a.y=d.y-c;e&&this.getEntity().setLocalPosition(a.x,a.y,a.z)}},getPointConstrainedToCameraBounds:function(a,b){if(null!=this._cameraBounds){var c=new O(a,b),d=this._lensWidth/2/this._zoomScale,e=this._lensHeight/2/this._zoomScale,f=new s(a,b);f.x-d<this._cameraBounds.ul.x&&(f.x=this._cameraBounds.ul.x+d);f.y-e<this._cameraBounds.ul.y&&(f.y=this._cameraBounds.ul.y+
e);f.x+d>this._cameraBounds.ul.x+this._cameraBounds.wh.x&&(f.x=this._cameraBounds.ul.x+this._cameraBounds.wh.x-d);c.y+e>this._cameraBounds.ul.y+this._cameraBounds.wh.y&&(f.y=this._cameraBounds.ul.y+this._cameraBounds.wh.y-e);a=f.x;b=f.y}return new s(a,b)},getBounds:function(){return this._cameraBounds},setBounds:function(a,b,c,d){this._cameraBounds=new wb(a,b,c-a,d-b)},getViewBounds:function(){var a=this.getEntity().getPosition();return new wb(a.x,a.y,2*(this._lensWidth/2/this._zoomScale),2*(this._lensHeight/
2/this._zoomScale))},destroyBounds:function(){this._cameraBounds=null},destroy:function(){m.prototype.destroy.call(this);ea._debugCamera==this&&(ea._debugCamera=null)},onTargetDestroy:function(){this.setTarget(null)},__class__:ea});var Ta=function(a,b){this._offset=this._onEnter=this._onInside=this._onExit=null;m.call(this,a);this._offset=b};Ta.__name__=["engine","components","Collider"];Ta.__super__=m;Ta.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);$a.getInstance().registerCollider(this)},
getCollision:function(){return null},checkPointIntersect:function(a){return!1},update:function(){m.prototype.update.call(this)},getRaycastPoint:function(a,b,c,d,e){$a.getInstance().dispatchEvent(new Uc("raycastCheck",a,b));return-1},debugRender:function(){m.prototype.debugRender.call(this)},setOnEnter:function(a){this._onEnter=a},setOnExit:function(a){this._onExit=a},setOnInside:function(a){this._onInside=a},onEnter:function(a){this._isActive&&null!=this._onEnter&&this._onEnter(a,this)},onInside:function(a){this._isActive&&
null!=this._onInside&&this._onInside(a,this)},onExit:function(a){this._isActive&&null!=this._onExit&&this._onExit(a,this)},onDestroy:function(){m.prototype.onDestroy.call(this);$a.getInstance().removeCollider(this)},__class__:Ta});var $d=function(a,b,c,d){null==d&&(d=!1);this.isPaused=this.repeating=!1;this.timeUntilExecute=a;this.actionToExecute=b;this.params=c;this.repeating=d;this.duration=a};$d.__name__=["engine","components","DeferredAction"];$d.prototype={update:function(){this.isPaused||(this.timeUntilExecute-=
n.getDeltaTime())},__class__:$d};var hb=function(a){m.call(this,a);this._deferredActions=[]};hb.__name__=["engine","components","DeferredActionController"];hb.addDeferredActionToTarget=function(a,b,c,d){var e=a.getComponent(hb);null==e&&(e=new hb(a));e.addDeferredAction(b,c,d);return e};hb.__super__=m;hb.prototype=p(m.prototype,{update:function(){m.prototype.update.call(this);for(var a=this._deferredActions.length-1;0<=a;){var b=this._deferredActions[a];null==b?F.remove(this._deferredActions,b):(b.update(),
0>=b.timeUntilExecute&&(b.actionToExecute(b.params),b.repeating?b.timeUntilExecute=b.duration:F.remove(this._deferredActions,b)),--a,a>this._deferredActions.length-1&&(a=this._deferredActions.length-1))}},addDeferredAction:function(a,b,c){a=new $d(a,b,c);this._deferredActions.push(a);return a},removeDeferredAction:function(a){F.remove(this._deferredActions,a)},destroyAllDeferredActions:function(){this._deferredActions=[]},__class__:hb});var ce=function(a,b,c,d){this._context=this._image=this._cachedSize=
this._clipRect=null;this._forceRenderRequired=!1;this._skew=this._rotation=this._spriteInfo=this._coords=null;this._alpha=1;this._maskFunction=null;this._imageName="";this.IsLargeImage=!1;m.call(this,a);this._imageName=b;this._layer=c;this._cameraPositionScale=new s(1,1);this._pivotPoint=new s;this._camera=d;this._offset=new s;this._scale=new O(1,1,1);this._skew=new s;this._rotation=new O(0,0,0);this._clipRect=null};ce.__name__=["engine","components","GameImage"];ce.__super__=m;ce.prototype=p(m.prototype,
{getClipRect:function(){return this._clipRect},setClipRect:function(a){1>a.wh.x&&(a.wh.x=1);1>a.wh.y&&(a.wh.y=1);this._clipRect=a},getCamera:function(){return this._camera},setCamera:function(a){this._camera=a},getCoords:function(){return this._coords},setCoords:function(a){this._coords=a},getRotation:function(){return this._rotation},setRotation:function(a){this._rotation=a},setSpriteInfo:function(a){this._spriteInfo=a},setImage:function(a){I.assetExists(a)&&""!=a&&(this._imageName=a,this._image=
this.getImageAsset(),this._cachedSize=null)},getImageAsset:function(){return I.getAsset(this._imageName)},getSkew:function(){return this._skew},setSkew:function(a,b){this._skew=new s(a,b)},setSource:function(a){this._imageName=a},getOffset:function(){return this._offset},setOffset:function(a,b){this._offset=new s(a,b)},centerOffsetOnEntity:function(){if(""!=this._imageName){var a=this.getSize(),a=null!=this._spriteInfo?new s(this._spriteInfo.getCoords().wh.x,this._spriteInfo.getCoords().wh.y):new s(this._image.width,
this._image.height);this.setOffset(-a.x/2,-a.y/2)}},setOffsetBasedOnPivotPoint:function(a,b){var c=this.getSize(),c=null!=this._spriteInfo?new s(this._spriteInfo.getCoords().wh.x,this._spriteInfo.getCoords().wh.y):new s(this._image.width,this._image.height);this.setOffset(-(c.x*a),-(c.y*(1-b)))},getAlpha:function(){return this._alpha},setAlpha:function(a){this._alpha=a},getPivotPoint:function(){return this._pivotPoint},setPivotPoint:function(a,b){this._pivotPoint=new s(a,b)},getLayer:function(){return this._layer},
setLayer:function(a){this._layer=a;this._context=null},getImageName:function(){return this._imageName},getSize:function(){if(null!=this._cachedSize)return this._cachedSize;null==this._image&&(this._image=this.getImageAsset());var a=this.getEntity().getScale();return null!=this._spriteInfo?this._cachedSize=new s(this._spriteInfo.getCoords().wh.x*Math.abs(a.x*this._scale.x),this._spriteInfo.getCoords().wh.y*Math.abs(a.y*this._scale.y)):""==this._imageName?new s(0,0):this._cachedSize=new s(this._image.width*
Math.abs(a.x*this._scale.x),this._image.height*Math.abs(a.y*this._scale.y))},getMaskFunction:function(){return this._maskFunction},setMaskFunction:function(a){this._maskFunction=a},setScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._scale=new O(a,b,c)},getScale:function(){return this._scale},getCameraPositionScale:function(){return this._cameraPositionScale},setCameraPositionScale:function(a){this._cameraPositionScale=a},render:function(){m.prototype.render.call(this);if(0!=
this._alpha&&(""!=this._imageName||null!=this._spriteInfo)){var a=this.getEntity(),b=a.getPosition(),c=1,d=new s(0,0),e=new s(1,1);null!=this._camera&&(d=this._camera.getEntity(),c=this._camera.getZoomScale(),d=d.getPosition(),d=new s(-(d.x/this._cameraPositionScale.x)*e.x,-(d.y/this._cameraPositionScale.y)*e.y),d.scaleBy(c,c));null==this._context&&(this._context=this._layer.getCanvas().getContext("2d"));this._context.save();null!=this._maskFunction&&(this._context.translate(d.x/e.x*c,d.y/e.y*c),
this._maskFunction(this._context,this),this._context.clip(),this._context.translate(-d.x*e.x*c,-d.y*e.y*c));var f=a.getScale().getClone();f.x*=this._scale.x;f.y*=this._scale.y;this._context.setTransform(1,this._skew.x/f.x,this._skew.y/f.y,1,Math.floor(b.x*e.x*c+d.x)*n.getDevicePixelRatio(),Math.floor(b.y*e.y*c+d.y)*n.getDevicePixelRatio());0!=a.getRotation().z+this._rotation.z&&this._context.rotate(ka.degToRad(a.getRotation().z+this._rotation.z));this._context.scale(f.x*c,f.y*c);a=this._offset.getClone();
null!=this._spriteInfo&&(a.x+=this._spriteInfo.getOffset().x,a.y+=this._spriteInfo.getOffset().y);this._context.translate(Math.floor(a.x*e.x)*n.getDevicePixelRatio(),Math.floor(a.y*e.y)*n.getDevicePixelRatio());this._context.globalAlpha=this._alpha;this._context.scale(e.x*n.getDevicePixelRatio(),e.y*n.getDevicePixelRatio());null==this._spriteInfo&&null==this._coords?(null==this._image&&(this._image=this.getImageAsset()),null==this._clipRect?this._context.drawImage(this._image,0,0):(this._clipRect.ul.x=
Math.max(0,this._clipRect.ul.x),this._clipRect.ul.y=Math.max(0,this._clipRect.ul.y),this._context.drawImage(this._image,this._clipRect.ul.x,this._clipRect.ul.y,this._clipRect.wh.x,this._clipRect.wh.y,0,0,this._clipRect.wh.x*e.x*n.getDevicePixelRatio(),this._clipRect.wh.y*e.y*n.getDevicePixelRatio()))):null==this._spriteInfo&&null!=this._coords?(null==this._image&&(this._image=I.getAsset(this._imageName)),this._context.drawImage(this._image,this._coords.ul.x,this._coords.ul.y,this._coords.wh.x,this._coords.wh.y,
0,0,this._coords.wh.x,this._coords.wh.y)):(e=this._spriteInfo.getCoords(),a=Pa.getInstance().getSpriteSheetByName(this._spriteInfo.getSpriteSheetName()),null==this._image&&(this._image=I.getAsset(a.getImageName())),this._context.drawImage(a.getImage(),e.ul.x,e.ul.y,e.wh.x,e.wh.y,0,0,e.wh.x,e.wh.y));this._layer.setWholeCanvasDirty(!0);this._context.restore()}},quickRender:function(){m.prototype.render.call(this);new s(1,1);this._context=this._layer.getCanvas().getContext("2d");null!=this._maskFunction&&
(this._maskFunction(this._context,this),this._context.clip());this._context.scale(this._scale.x,this._scale.y);this._context.rotate(this._rotation.z);if(null==this._spriteInfo&&null==this._coords)null==this._image&&(this._image=I.getAsset(this._imageName));else if(null==this._spriteInfo&&null!=this._coords)null==this._image&&(this._image=I.getAsset(this._imageName)),this._context.drawImage(this._image,Math.floor(this._coords.ul.x),Math.floor(this._coords.ul.y),Math.floor(this._coords.wh.x),Math.floor(this._coords.wh.y),
this._offset.x,this._offset.y,Math.floor(this._coords.wh.x)+2,Math.floor(this._coords.wh.y)+2);else{var a=this._spriteInfo.getCoords(),b=Pa.getInstance().getSpriteSheetByName(this._spriteInfo.getSpriteSheetName());null==this._image&&(this._image=I.getAsset(b.getImageName()));this._context.drawImage(this._image,a.ul.x,a.ul.y,a.wh.x,a.wh.y,this._offset.x,this._offset.y,a.wh.x,a.wh.y)}this._context.rotate(-this._rotation.z);this._context.scale(1/this._scale.x,this._scale.y);this._layer.setWholeCanvasDirty(!0)},
destroy:function(){m.prototype.destroy.call(this)},onDestroy:function(){m.prototype.onDestroy.call(this);this._camera=null},__class__:ce});var nf=function(a,b,c,d,e){null==d&&(d=!0);this._entities=this._buffer=this._camera=this._cameraPositionScale=this._context=this._layer=this._gameImages=null;this._removeGameImageComponents=!0;m.call(this,a);this._removeGameImageComponents=d;this._entities=b;this._camera=e;this._cameraPositionScale=new s(1,1);this._context=null;this._layer=c;this._gameImages=[]};
nf.__name__=["engine","components","GameImageBatch"];nf.__super__=m;nf.prototype=p(m.prototype,{getCameraPositionScale:function(){return this._cameraPositionScale},setCameraPositionScale:function(a){this._cameraPositionScale=a},getLayer:function(){return this._layer},setLayer:function(a){this._layer=a},init:function(){m.prototype.init.call(this);for(var a=[],b=0,c=this._entities.length;b<c;){var d=b++,d=this._entities[d],e=d.getComponent(ce),f=d.getPosition().getClone(),g=d.getScale().getClone(),
k=d.getRotation().getClone();e.setOffset(e.getOffset().x+f.x*g.x,e.getOffset().y+f.y*g.y);e.setScale(g.x,g.y,1);e.setRotation(k);e.setEntity(this.getEntity());e.setLayer(this._layer);d.destroy();a.push(e)}this._gameImages=a},render:function(){m.prototype.render.call(this);var a=this._gameImages.length;if(0!=a)if(null==this._camera){var b=new s(1,1),c=this._layer.getCanvas().getContext("2d");c.save();c.setTransform(b.x*n.getDevicePixelRatio(),0,0,b.y*n.getDevicePixelRatio(),0,0);for(b=0;b<a;){var d=
b++;this._gameImages[d].quickRender()}c.restore()}else{var d=1,e=new s(0,0),f=new s(1,1),c=new O(0,0);null!=this._camera&&(c=this._camera.getEntity(),d=this._camera.getZoomScale(),c=c.getPosition(),e=new s(-(c.x/this._cameraPositionScale.x)*f.x*n.getDevicePixelRatio(),-(c.y/this._cameraPositionScale.y)*f.y*n.getDevicePixelRatio()),e.scaleBy(d,d));b=this._layer.getCanvas().getContext("2d");b.save();b.setTransform(d*f.x*n.getDevicePixelRatio(),0,0,d*f.y*n.getDevicePixelRatio(),Math.floor(e.x),Math.floor(e.y));
this._camera.getViewBounds();this.getCameraPositionScale();this._gameImages[0].getSize();for(d=0;d<a;){var f=d++,f=this._gameImages[f],e=f.getOffset().getClone(),g=f.getScale(),k=f.getSize().x,h=f.getSize().y;e.scaleBy(g.x,g.y);e.x-k>c.x+800||(e.x+k<c.x-800||e.y-h>c.y+600||e.y+h<c.y-600)||f.quickRender()}b.restore()}},__class__:nf});var Za=function(a,b,c,d){null==d&&(d="");null==c&&(c="");this._alwaysUpdatePosition=!1;this._className="";this._div=null;this._isDirty=!0;m.call(this,a);this._html=c;
this._className=d;this._layer=b;this.updateHtml()};Za.__name__=["engine","components","HtmlElements"];Za.showElementById=function(a,b){null==b&&(b=!0);var c=Za.getChildDivById(z.getContainer(),a);null!=c?c.style.display=b?"block":"none":Ea.log("Could not find element with id of "+a+" to "+(b?"show":"hide"))};Za.getStylePositionOfDomElement=function(a){for(var b=ga.parseInt(a.style.top),c=ga.parseInt(a.style.left);;)if(null!=a.parentNode&&Object.prototype.hasOwnProperty.call(a.parentNode,"style")&&
"layer"!=a.parentElement.className)b+=ga.parseInt(a.parentElement.style.top),c+=ga.parseInt(a.parentElement.style.left),a=a.parentElement;else break;return new s(c,b)};Za.setElementTextById=function(a,b){var c=z.getDocument().getElementById(a);null==c?Ea.log("Could not find '"+a+"' on the page!"):c.innerHTML=b};Za.getChildDivById=function(a,b){for(var c=0,d=a.children.length;c<d;){var e=c++,e=a.children[e];if(e.id==b||e.hasChildNodes()&&(e=Za.getChildDivById(e,b),null!=e))return e}return null};Za.__super__=
m;Za.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this.getEntity().addEventListener("displayUpdate",w(this,this.onDisplayUpdated))},getChildElementById:function(a){return z.getDocument().getElementById(a)},setChildElementTextById:function(a,b){var c=Za.getChildDivById(this.getDiv(),a);null!=c&&(c.innerHTML=b);this._html=this.getDiv().innerHTML},getDiv:function(){null==this._div&&this._isDirty&&this.updateHtml();return this._div},update:function(){m.prototype.update.call(this);
null!=this._div&&this._isDirty&&this.updateHtml();null!=this._div&&this._alwaysUpdatePosition&&this.updatePosition();var a=this.getEntity().isVisible()?"block":"none";this._div.style.display=a},updateHtml:function(){Ea.log("updateHtml");null!=this._div&&null!=this._div.parentNode&&this._div.parentNode.removeChild(this._div);this._isDirty=!1;this._div=z.getDocument().createElement("div");this._div.className=this._className;this._div.innerHTML=this._html;this._div.style.position="absolute";var a="translate(0, 0px) scale("+
this.getEntity().getScale().x*n.getInstance().getScreenScale().x+","+this.getEntity().getScale().y*n.getInstance().getScreenScale().y;this._div.style.webkitTransform=a+")";a="translate(0, 0px) scale("+this.getEntity().getScale().x*n.getInstance().getScreenScale().x+","+this.getEntity().getScale().y*n.getInstance().getScreenScale().y;this._div.style.transform=a+")";this._layer.getContainer().appendChild(this._div);this.updatePosition()},updatePosition:function(){var a=this.getEntity().getPosition().x*
n.getInstance().getScreenScale().x;this._div.style.left=a-(this._center?this._div.clientWidth/2:0)+"px";a=this.getEntity().getPosition().y*n.getInstance().getScreenScale().y;this._div.style.top=a-(this._center?this._div.clientHeight/2:0)+"px"},setId:function(a){null==this._div&&this._isDirty&&this.updateHtml();this._id=a;this._div.id=a},getId:function(){return this._id},getHtml:function(){return this._html},setHtml:function(a){this._html=a},setClassName:function(a){this._className=a},getClassName:function(){return this._className},
addClassName:function(a){this._className=0<this._className.length?this._className+(" "+a):a},removeClassName:function(a){this._className=Ab.replace(this._className,a,"")},forceUpdateNextFrame:function(){this._html=this._div.innerHTML},centerOnEntity:function(a){null==a&&(a=!0);this._center=a;this.updatePosition()},getSize:function(){return new s(this._div.clientWidth*n.getInstance().getScreenScale().y,this._div.clientHeight*n.getInstance().getScreenScale().y)},destroy:function(){m.prototype.destroy.call(this);
null!=this._div.parentNode&&this._layer.getContainer().removeChild(this._div)},handleMessage:function(a,b){m.prototype.handleMessage.call(this,a,b)},onDisplayUpdated:function(){},alwaysUpdatePosition:function(a){null==a&&(a=!0);this._alwaysUpdatePosition=a},__class__:Za});var Qa=function(a,b,c,d,e,f,g,k,h){null==h&&(h=0);null==k&&(k=0);null==g&&(g=!1);this._magnitudeDecayRate=0;this._half=!1;this._propertyName="";this._target=null;this._theta=this._rate=this._base=this._magnitude=0;m.call(this,a);
this._base=d;this._magnitude=e;this._rate=f;this._propertyName=c;this._target=b;this._half=g;this._theta=k;this._magnitudeDecayRate=h};Qa.__name__=["engine","components","PropertyOscillator"];Qa.__super__=m;Qa.prototype=p(m.prototype,{getTheta:function(){return this._theta},setTheta:function(a){this._theta=a},getMagnitude:function(){return this._magnitude},setMagnitude:function(a){this._magnitude=a},getRate:function(){return this._rate},setRate:function(a){this._rate=a},getMagnitudeDecayRate:function(){return this._magnitudeDecayRate},
setMagnitudeDecayRate:function(a){this._magnitudeDecayRate=a},getBase:function(){return this._base},setBase:function(a){this._base=a},update:function(){m.prototype.update.call(this);if(0<this._magnitude){this._magnitude-=this._magnitudeDecayRate*n.getDeltaTime();0>this._magnitude&&(this._magnitude=0);this._theta+=this._rate*n.getDeltaTime();this._theta>=(this._half?Math.PI:2*Math.PI)&&(this._theta-=this._half?Math.PI:2*Math.PI);var a=this._base+Math.sin(this._theta)*this._magnitude;ta.setProperty(this._target,
this._propertyName,a)}},__class__:Qa});var pc=function(a,b){null==b&&(b=0.5);this._slack=1;this._targetPosition=null;m.call(this,a);this._slack=b};pc.__name__=["engine","components","SlackMovement"];pc.__super__=m;pc.prototype=p(m.prototype,{getSlack:function(){return this._slack},setSlack:function(a){this._slack=a},update:function(){m.prototype.update.call(this);if(null!=this._targetPosition){var a=this._targetPosition.subtract(this.getEntity().getPosition()),b=a.getLength();0!=b&&(a=a.getNormalized(),
a.scaleBy(b*this._slack),5E-5>a.x&&-5E-5<a.x&&(a.x=0),5E-5>a.y&&-5E-5<a.y&&(a.y=0),5E-5>a.z&&-5E-5<a.z&&(a.z=0),b=this.getEntity().getPosition(),this.getEntity().setLocalPosition(b.x+a.x,b.y+a.y,b.z+a.z))}},getTarget:function(){return this._targetPosition},setTarget:function(a,b,c){this._targetPosition=new O(a,b,c)},__class__:pc});var T={__ename__:!0,__constructs__:["Local","World"],Local:["Local",0]};T.Local.__enum__=T;T.World=["World",1];T.World.__enum__=T;T.__empty_constructs__=[T.Local,T.World];
var nc=function(a){m.call(this,a);this._localPosition=new O;this._localRotation=new O;this._localScale=new O(1,1,1)};nc.__name__=["engine","components","Transform"];nc.getIdentity=function(){return window.glMatrix.mat4.identity(window.glMatrix.mat4.create())};nc.__super__=m;nc.prototype=p(m.prototype,{getParent:function(){return null!=this.getEntity().getParent()?this.getEntity().getParent().getTransform():null},getPositionRef:function(){return this._localPosition},getRotationRef:function(){return this._localRotation},
getScaleRef:function(){return this._localScale},getPosition:function(a){if(a==T.Local)return this._localPosition.getClone();a=window.glMatrix.mat4.identity(window.glMatrix.mat4.create());for(var b=this;null!=b;){var c=window.glMatrix.mat4.create(),d=b.getRotation(T.Local),e=b.getPosition(T.Local),f=b.getScale(T.Local),c=window.glMatrix.mat4.fromRotationTranslationScale(c,window.glMatrix.quat.fromEuler(window.glMatrix.quat.create(),d.x,d.y,d.z),window.glMatrix.vec3.fromValues(e.x,e.y,e.z),window.glMatrix.vec3.fromValues(f.x,
f.y,f.z));window.glMatrix.mat4.multiply(a,c,a);b=b.getParent()}b=window.glMatrix.vec3.create();window.glMatrix.vec3.transformMat4(b,b,a);return new O(b[0],b[1],b[1])},setPosition:function(a,b){switch(b[1]){case 0:this._localPosition.x=a.x;this._localPosition.y=a.y;this._localPosition.z=a.z;break;case 1:if(this._localPosition.x=a.x,this._localPosition.y=a.y,this._localPosition.z=a.z,null!=this.getParent()){for(var c=nc.getIdentity(),d=this.getParent();null!=d;){var e=d.getRotation(T.Local),f=d.getPosition(T.Local),
g=d.getScale(T.Local),e=window.glMatrix.quat.fromEuler(window.glMatrix.quat.create(),e.x,e.y,e.z),f=window.glMatrix.vec3.fromValues(f.x,f.y,f.z),g=window.glMatrix.vec3.fromValues(g.x,g.y,g.z),k=window.glMatrix.mat4.create(),k=window.glMatrix.mat4.fromRotationTranslationScale(k,e,f,g);window.glMatrix.mat4.multiply(c,k,c);d=d.getParent()}c=window.glMatrix.mat4.invert(window.glMatrix.mat4.create(),c);d=window.glMatrix.vec3.fromValues(this._localPosition.x,this._localPosition.y,this._localPosition.z);
d=window.glMatrix.vec3.transformMat4(d,d,c);this._localPosition.x=d[0];this._localPosition.y=d[1];this._localPosition.z=d[2]}else this.setPosition(this._localPosition,T.Local)}this.dispatchEvent(new yb("update"))},translate:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._localPosition.x+=a;this._localPosition.y+=b;this._localPosition.z+=c},getScale:function(a){if(a==T.Local)return this._localScale.getClone();a=new O(1,1,1);for(var b=this;null!=b;)a.x*=b.getScale(T.Local).x,a.y*=
b.getScale(T.Local).y,a.z*=b.getScale(T.Local).z,b=b.getParent();return a},setScale:function(a,b,c,d){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);switch(d[1]){case 0:this._localScale.x=a;this._localScale.y=b;this._localScale.z=c;break;case 1:for(this._localScale.x=a,this._localScale.y=b,this._localScale.z=c,a=this.getEntity().getParent();null!=a;)this._localScale.x/=a.getTransform().getScale(T.Local).x,this._localScale.y/=a.getTransform().getScale(T.Local).y,this._localScale.z/=a.getTransform().getScale(T.Local).z,
a=a.getParent()}this.dispatchEvent(new yb("update"))},scale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._localScale.x*=a;this._localScale.y*=b;this._localScale.z*=c;this.dispatchEvent(new yb("update"))},getRotation:function(a){if(a==T.Local)return this._localRotation.getClone();a=new O;for(var b=this;null!=b;)a.x+=b.getRotation(T.Local).x,a.y+=b.getRotation(T.Local).y,a.z+=b.getRotation(T.Local).z,b=b.getParent();return a},setRotation:function(a,b,c,d){switch(d[1]){case 0:this._localRotation.x=
a;this._localRotation.y=b;this._localRotation.z=c;break;case 1:null!=this.getParent()&&(this._localRotation.x=a,this._localRotation.y=b,this._localRotation.z=c,this._localRotation.x-=this.getParent().getRotation(d).x,this._localRotation.y-=this.getParent().getRotation(d).y,this._localRotation.z-=this.getParent().getRotation(d).z)}this.dispatchEvent(new yb("update"))},rotate:function(a,b,c){this._localRotation.x+=a;this._localRotation.y+=b;this._localRotation.z+=c;this.dispatchEvent(new yb("update"))},
__class__:nc});var yb=function(a){this._type=a};yb.__name__=["engine","components","TransformEvent"];yb.__super__=P;yb.prototype=p(P.prototype,{__class__:yb});var sa=function(a){this._tweens=null;m.call(this,a);this._tweens=[]};sa.__name__=["engine","components","Tweener"];sa.addTweenToTarget=function(a,b,c,d,e,f,g,k,h,l){null==k&&(k=0);var m=a.getComponent(sa);null==m&&(m=new sa(a));m.addTween(b,c,d,e,f,g,k,h,l);return m};sa.__super__=m;sa.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this)},
addTween:function(a,b,c,d,e,f,g,k,h){null==g&&(g=0);a=new of(a,b,c,d,e,f,g,k,h);this._tweens.push(a);return a},skipAll:function(){for(var a=0,b=this._tweens.length;a<b;){var c=a++;this._tweens[c].skip()}},destroyTween:function(a){F.remove(this._tweens,a)},destroyAllTweens:function(){this._tweens=[]},update:function(){m.prototype.update.call(this);for(var a=this._tweens.length-1;0<=a;){var b=this._tweens[a];b.update(n.getDeltaTime());this.getEntity().setTransformsDirty();b._isCompleted&&this._tweens.splice(a,
1);--a}},__class__:sa});var de=function(a,b){this._velocity=this._angularVelocity=this._gravity=null;m.call(this,a);this._velocity=new O;this._angularVelocity=new O;null!=b&&(this._gravity=b.getClone())};de.__name__=["engine","components","VelocityController"];de.__super__=m;de.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);null!=this._gravity&&(this._velocity.x+=this._gravity.x*n.getDeltaTime(),this._velocity.y+=this._gravity.y*
n.getDeltaTime(),this._velocity.z+=this._gravity.z*n.getDeltaTime());var a=this._velocity.getClone();a.scaleBy(n.getDeltaTime());var b=this._angularVelocity.getClone();b.scaleBy(n.getDeltaTime());var c=this.getEntity().getLocalPosition();this.getEntity().getLocalRotation();this.getEntity().setLocalPosition(c.x+a.x,c.y+a.y,c.z+a.z);this.getEntity().rotate(b.x,b.y,b.z)},getXyAngleFromVector:function(a){return ka.getAngleInDegreesBetween2dVectors(a,new s(this._velocity.x,this._velocity.y))},getGravity:function(){return this._gravity.getClone()},
setGravity:function(a){this._gravity=new O(a.x,a.y,a.z)},getVelocity:function(){return this._velocity},addVelocity:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._velocity=this._velocity.add(new O(a,b,c))},setVelocity:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._velocity=new O(a,b,c)},setVelocityX:function(a){this._velocity.x=a},setVelocityY:function(a){this._velocity.y=a},setVelocityZ:function(a){this._velocity.z=a},getVelocityX:function(){return this._velocity.x},
getVelocityY:function(){return this._velocity.y},getVelocityZ:function(){return this._velocity.z},getAngularVelocity:function(){return this._angularVelocity},setAngularVelocity:function(a){this._angularVelocity=a},__class__:de});var Ma=function(a){m.call(this,a);null!=Ma._instance&&(window.console.warn("An AudioListener instance already exists. There should only be one!"),Ma._instance.destroy());Ma._instance=this;this._audioSources=[]};Ma.__name__=["engine","components","audio","AudioListener"];Ma.getInstance=
function(){return Ma._instance};Ma.__super__=m;Ma.prototype=p(m.prototype,{registerAudioSource:function(a){-1==this._audioSources.indexOf(a)&&(this._audioSources.push(a),a.addEventListener("destroy",w(this,this.onAudioSourceDestroyed)))},removeAudioSource:function(a){F.remove(this._audioSources,a)},onAudioSourceDestroyed:function(a){a.target.removeEventListener("destroy",w(this,this.onAudioSourceDestroyed));this.removeAudioSource(a.target)},update:function(){m.prototype.update.call(this);if(!this.getGameState().getPaused())for(var a=
this.getEntity().getPosition(),b=0,c=this._audioSources.length;b<c;){var d=b++,d=this._audioSources[d],e=Math.abs(a.subtract(d.getEntity().getPosition()).getLength()),f=d.getRolloff();0<f?e<=f?(e=G.linear(1-e/f,0,1,1),d.setVolumePercent(e)):d.setVolumePercent(0):d.setVolumePercent(1)}},onPause:function(){m.prototype.onPause.call(this);for(var a=0,b=this._audioSources.length;a<b;){var c=a++;this._audioSources[c].setVolumePercent(0)}},destroy:function(){m.prototype.destroy.call(this);Ma._instance=null},
__class__:Ma});var Vc=function(a,b,c){null==c&&(c=1);null==b&&(b=0);m.call(this,a);this._maxVolume=c;this._rolloff=b;this._volume=0};Vc.__name__=["engine","components","audio","AudioSource"];Vc.__super__=m;Vc.prototype=p(m.prototype,{get_maxVolume:function(){return this._maxVolume},set_maxVolume:function(a){return this._maxVolume=a},setRolloff:function(a){this._rolloff=a},getRolloff:function(){return this._rolloff},setVolumePercent:function(a){this.setVolume(this._maxVolume*a)},setVolume:function(a){a!=
this._volume&&(this._volume=a,null!=this._soundData&&this._soundData.setVolume(this._volume))},play:function(a,b){null==b&&(b=!1);null!=Ma.getInstance()&&(Ma.getInstance().registerAudioSource(this),r.isSoundMuted()||(this._soundData=r.playSoundByName(a,!1,b),null!=this._soundData&&this._soundData.setVolume(this._volume)))},pause:function(){null!=this._soundData&&this._soundData.pause()},resume:function(){null!=this._soundData&&this._soundData.resume()},stop:function(){null!=this._soundData&&(this._soundData.stop(),
this._soundData=null)},setLoop:function(a){null!=this._soundData&&this._soundData.setLoop(a)},setActive:function(a){m.prototype.setActive.call(this,a);null!=Ma.getInstance()&&(a?Ma.getInstance().registerAudioSource(this):(Ma.getInstance().removeAudioSource(this),this.setVolumePercent(0)))},destroy:function(){m.prototype.destroy.call(this);this.stop()},__class__:Vc,__properties__:{set_maxVolume:"set_maxVolume",get_maxVolume:"get_maxVolume"}});var Ha=function(a,b,c,d){this._lockDelayButtonNextFrame=
!1;this._inputEnabled=!0;this._action=this._instantAction=this._deferredAction=null;this._delayTime=0;m.call(this,a);this._delayTime=c;this._action=b;this._instantAction=d};Ha.__name__=["engine","components","buttons","ButtonActionDelay"];Ha.getDelayButtonLock=function(){return Ha._delayButtonLock};Ha.__super__=m;Ha.prototype=p(m.prototype,{setOnAction:function(a){this._action=a},init:function(){m.prototype.init.call(this);this._deferredAction=new hb(this.getEntity());this.getEntity().addEventListener("mouseDown",
w(this,this.onMouseDown))},onMouseDown:function(){this._inputEnabled&&!Ha._delayButtonLock&&(this._inputEnabled=!1,this._lockDelayButtonNextFrame=!0,null!=this._instantAction&&this._instantAction(),this._deferredAction.addDeferredAction(this._delayTime,w(this,this.onMouseDownDelayElapse)))},postUpdate:function(){m.prototype.update.call(this);this._lockDelayButtonNextFrame&&(Ha._delayButtonLock=!0);this._lockDelayButtonNextFrame=!1},onMouseDownDelayElapse:function(){this._lockDelayButtonNextFrame=
Ha._delayButtonLock=!1;null!=this._action&&this._action();this._inputEnabled=!0},destroy:function(){m.prototype.destroy.call(this);0<=this._delayTime&&(Ha._delayButtonLock=!1)},__class__:Ha});var $b=function(a){this._inputEnabled=!0;m.call(this,a)};$b.__name__=["engine","components","buttons","ButtonGroup"];$b.__super__=m;$b.prototype=p(m.prototype,{isInputEnabled:function(){return this._inputEnabled},setInputEnabled:function(a){this._inputEnabled=a},__class__:$b});var qc=function(a,b,c,d,e){null==
e&&(e=!0);this._allowOnce=!0;this._buttonMouseOverScale=this._tweener=null;this._isPulseActive=!1;m.call(this,a);this._pulseFromScale=b;this._pulseToScale=c;this._pulseDuration=d;this._allowOnce=e;this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown))};qc.__name__=["engine","components","buttons","ButtonMouseDownPulse"];qc.__super__=m;qc.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._buttonMouseOverScale=this.getComponent(ac);this._tweener=new sa(this.getEntity())},
disableButton:function(){this.getEntity().removeEventListener("mouseDown",w(this,this.onMouseDown))},enableButton:function(){this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown))},onMouseDown:function(){if(!this._isPulseActive&&!Ha.getDelayButtonLock()){var a=this.getEntity().getComponent(V);this._isPulseActive=!0;null!=this._buttonMouseOverScale&&this._buttonMouseOverScale.setActive(!1);null!=a?(this._tweener.addTween(a.getScaleRef(),"x",this._pulseFromScale,this._pulseToScale,
this._pulseDuration,G.easeOutBack,0,w(this,this.onPulseComplete)),this._tweener.addTween(a.getScaleRef(),"y",this._pulseFromScale,this._pulseToScale,this._pulseDuration,G.easeOutBack,0)):(this._tweener.addTween(this.getEntity().getScaleRef(),"x",this._pulseFromScale,this._pulseToScale,this._pulseDuration,G.easeOutBack,0,w(this,this.onPulseComplete)),this._tweener.addTween(this.getEntity().getScaleRef(),"y",this._pulseFromScale,this._pulseToScale,this._pulseDuration,G.easeOutBack,0))}},onPulseComplete:function(){this._allowOnce||
(this._isPulseActive=!1,null!=this._buttonMouseOverScale&&this._buttonMouseOverScale.setActive(!0))},__class__:qc});var bc=function(a,b,c){this._pixiSprite=null;m.call(this,a);this._defaultImageName=b;this._mouseOverImageName=c;this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",w(this,this.onMouseOut))};bc.__name__=["engine","components","buttons","ButtonMouseOverImage"];bc.__super__=m;bc.prototype=p(m.prototype,{setDefaultImage:function(a){this._defaultImageName=
a;this.updateImage(this._defaultImageName)},setMouseOverImage:function(a){this._mouseOverImageName=a;this.updateImage(this._mouseOverImageName)},init:function(){m.prototype.init.call(this);this._pixiSprite=this.getComponent(y);null!=this._pixiSprite&&(this._pixiSprite.setImage(this._defaultImageName),this._pixiSprite.getSprite().anchor.x=0.5,this._pixiSprite.getSprite().anchor.y=0.5)},disableButton:function(){this.getEntity().removeEventListener("mouseOver",w(this,this.onMouseOver));this.getEntity().removeEventListener("mouseOut",
w(this,this.onMouseOut))},enableButton:function(){this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",w(this,this.onMouseOut))},onMouseOver:function(a){this.updateImage(this._mouseOverImageName)},onMouseOut:function(a){this.updateImage(this._defaultImageName)},updateImage:function(a){null==this._pixiSprite&&(this._pixiSprite=this.getComponent(y));null!=this._pixiSprite&&this._pixiSprite.setImage(a)},__class__:bc});var ac=function(a,
b,c,d,e){null==c&&(c=0.35);null==b&&(b=1.25);this._baseScaleX=this._baseScaleY=1;this._button=this._tweener=null;m.call(this,a);this._scaleSize=b;this._scaleDuration=c;this._mouseOverEasingFunction=d;this._mouseOutEasingFunction=e;null==this._mouseOverEasingFunction&&(this._mouseOverEasingFunction=G.linear);null==this._mouseOutEasingFunction&&(this._mouseOutEasingFunction=G.linear);this._baseScaleX=this.getEntity().getScaleRef().x;this._baseScaleY=this.getEntity().getScaleRef().y;this.getEntity().addEventListener("mouseOver",
w(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",w(this,this.onMouseOut))};ac.__name__=["engine","components","buttons","ButtonMouseOverScale"];ac.__super__=m;ac.prototype=p(m.prototype,{onDeactivate:function(){m.prototype.onDeactivate.call(this);this._tweener.setActive(!1)},onActivate:function(){m.prototype.onActivate.call(this);this._tweener.setActive(!0)},init:function(){m.prototype.init.call(this);this._tweener=new sa(this.getEntity());var a=this.getEntity().getComponent(V);
null!=a&&(this._baseScaleX=a.getScaleRef().x,this._baseScaleY=a.getScaleRef().y)},disableButton:function(){this.onMouseOut(null);this.getEntity().removeEventListener("mouseOver",w(this,this.onMouseOver))},enableButton:function(){this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver))},onMouseOver:function(a){a=this.getEntity().getComponent(V);if(!Ha.getDelayButtonLock())if(this._tweener.destroyAllTweens(),null!=a){var b=a.getScaleRef().x,c=a.getScaleRef().y;this._tweener.addTween(a.getScaleRef(),
"x",b,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction);this._tweener.addTween(a.getScaleRef(),"y",c,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction)}else a=this.getEntity().getScaleRef().x,b=this.getEntity().getScaleRef().y,this._tweener.addTween(this.getEntity().getScaleRef(),"x",a,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction),this._tweener.addTween(this.getEntity().getScaleRef(),"y",b,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction)},
onMouseOut:function(a){if(null!=this._tweener)if(a=this.getEntity().getComponent(V),this._tweener.destroyAllTweens(),null!=a){var b=a.getScaleRef().x,c=a.getScaleRef().y;this._tweener.addTween(a.getScaleRef(),"x",b,this._baseScaleX,this._scaleDuration,this._mouseOutEasingFunction);this._tweener.addTween(a.getScaleRef(),"y",c,this._baseScaleY,this._scaleDuration,this._mouseOutEasingFunction)}else a=this.getEntity().getScaleRef().x,b=this.getEntity().getScaleRef().y,this._tweener.addTween(this.getEntity().getScaleRef(),
"x",a,this._baseScaleX,this._scaleDuration,this._mouseOutEasingFunction),this._tweener.addTween(this.getEntity().getScaleRef(),"y",b,this._baseScaleY,this._scaleDuration,this._mouseOutEasingFunction)},__class__:ac});var rc=function(a,b,c){m.call(this,a);this._soundName=b;this._overSoundName=c};rc.__name__=["engine","components","buttons","ButtonSoundPlay"];rc.__super__=m;rc.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown));
this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver))},onMouseDown:function(){""!=this._soundName&&r.playSoundByName(this._soundName)},onMouseOver:function(){""!=this._soundName&&r.playSoundByName(this._overSoundName)},destroy:function(){m.prototype.destroy.call(this);this.getEntity().removeEventListener("mouseDown",w(this,this.onMouseDown))},__class__:rc});var Wc=function(a,b,c){Ta.call(this,a,c);this._collision=b};Wc.__name__=["engine","components","colliders","BoxCollider"];Wc.__super__=
Ta;Wc.prototype=p(Ta.prototype,{update:function(){Ta.prototype.update.call(this);var a=this.getEntity().getPosition().getClone(),b=null!=this._offset?this._offset:new O,c=a.x-this._collision.wh.x/2,d=b.x*this.getEntity().getScale().x;this._collision.ul.x=c+d;a=a.y-this._collision.wh.y/2;b=b.y*this.getEntity().getScale().y;this._collision.ul.y=a+b},checkPointIntersect:function(a){return this._collision.checkPointIntersect(a)},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);return this._collision.getRaycastPoint(a,
b,c,d,e)},debugRender:function(){Ta.prototype.debugRender.call(this);var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ea.getDebugCamera()){var b=ea.getDebugCamera().getEntity(),c=ea.getDebugCamera().getZoomScale(),d=ea.getDebugCamera().getComponent(Ib);a.translate(-b.getPosition().x*c+d.getContainerOffset().x,-b.getPosition().y*c+d.getContainerOffset().y);a.scale(c,c)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(this._collision.ul.x,this._collision.ul.y);
a.lineTo(this._collision.ul.x+this._collision.wh.x,this._collision.ul.y);a.lineTo(this._collision.ul.x+this._collision.wh.x,this._collision.ul.y+this._collision.wh.y);a.lineTo(this._collision.ul.x,this._collision.ul.y+this._collision.wh.y);a.lineTo(this._collision.ul.x,this._collision.ul.y);a.stroke();a.restore()},getCollision:function(){return this._collision},__class__:Wc});var Xc=function(a,b,c){Ta.call(this,a,c);this._collision=b};Xc.__name__=["engine","components","colliders","PolygonCollider"];
Xc.__super__=Ta;Xc.prototype=p(Ta.prototype,{update:function(){Ta.prototype.update.call(this);var a=this.getEntity().getPosition().getClone(),b=null!=this._offset?this._offset:new O,c=a.x-this._collision.wh.x/2,d=b.x*this.getEntity().getScale().x;this._collision.ul.x=c+d;a=a.y-this._collision.wh.y/2;b=b.y*this.getEntity().getScale().y;this._collision.ul.y=a+b},checkPointIntersect:function(a){return this._collision.checkPointIntersect(a)},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);return this._collision.getRaycastPoint(a,
b,c,d,e)},debugRender:function(){Ta.prototype.debugRender.call(this);var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ea.getDebugCamera()){var b=ea.getDebugCamera().getEntity(),c=ea.getDebugCamera().getZoomScale(),d=ea.getDebugCamera().getComponent(Ib);a.translate(-b.getPosition().x*c+d.getContainerOffset().x,-b.getPosition().y*c+d.getContainerOffset().y);a.scale(c,c)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";b=0;for(c=this._collision.getPoints().length;b<
c;)d=b++,0==d?a.moveTo(this._collision.ul.x+this._collision.getPoints()[d].x,this._collision.ul.y+this._collision.getPoints()[d].y):a.lineTo(this._collision.ul.x+this._collision.getPoints()[d].x,this._collision.ul.y+this._collision.getPoints()[d].y);a.lineTo(this._collision.ul.x+this._collision.getPoints()[0].x,this._collision.ul.y+this._collision.getPoints()[0].y);a.stroke();a.restore()},getCollision:function(){return this._collision},__class__:Xc});var be=function(a,b,c){this._position=this._spriteIndex=
0;this._position=a;this._spriteIndex=b;this._spriteSheetName=c};be.__name__=["engine","components","flashAnimation","AnimationKeyframe"];be.prototype={getSpriteSheetName:function(){return this._spriteSheetName},getPosition:function(){return this._position},getSpriteIndex:function(){return this._spriteIndex},__class__:be};var G=function(){};G.__name__=["engine","components","tween","EasingFunctions"];G.linear=function(a,b,c,d){return b+c*(a/d)};G.easeOutExpo=function(a,b,c,d){return c*(-Math.pow(2,
-10*a/d)+1)+b};G.easeInCubic=function(a,b,c,d){a/=d;return c*a*a*a+b};G.easeOutCubic=function(a,b,c,d){a/=d;--a;return c*(a*a*a+1)+b};G.easeInQuad=function(a,b,c,d){a/=d;return c*a*a+b};G.easeOutQuad=function(a,b,c,d){a/=d;return-c*a*(a-2)+b};G.easeInOutQuad=function(a,b,c,d){a/=d/2;if(1>a)return c/2*a*a+b;--a;return-c/2*(a*(a-2)-1)+b};G.easeInOutSine=function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b};G.easeInQuint=function(a,b,c,d){a/=d;return c*a*a*a*a*a+b};G.easeOutQuint=function(a,b,c,
d){a/=d;--a;return c*(a*a*a*a*a+1)+b};G.easeOutBounce=function(a,b,c,d){a/=d;return 0.36363636363636365>a?c*7.5625*a*a+b:0.7272727272727273>a?c*(7.5625*(a-=0.5454545454545454)*a+0.75)+b:0.9090909090909091>a?c*(7.5625*(a-=0.8181818181818182)*a+0.9375)+b:c*(7.5625*(a-=0.9545454545454546)*a+0.984375)+b};G.easeInBack=function(a,b,c,d){return c*(a/=d)*a*(2.70158*a-1.70158)+b};G.easeOutBack=function(a,b,c,d){a=a/d-1;return c*(a*a*(3.70158*a+2.70158)+1)+b};G.easeInOutExpo=function(a,b,c,d){a/=d/2;if(1>a)return c/
2*Math.pow(2,10*(a-1))+b;--a;return c/2*(-Math.pow(2,-10*a)+2)+b};var of=function(a,b,c,d,e,f,g,k,h){this._elapsedTime=0;this._isCompleted=!1;this._action=this._params=null;this._change=this._delay=0;this._target=this._easingFunction=null;this._propertyName="";this._begin=this._end=this._duration=0;this._target=a;this._propertyName=b;this._begin=c;this._end=d;this._duration=e;this._easingFunction=f;this._delay=g;this._action=k;this._params=h};of.__name__=["engine","components","tween","Tween"];of.prototype=
{getOnUpdate:function(){return this._onUpdate},setOnUpdate:function(a){this._onUpdate=a},update:function(a){this._change=this._end-this._begin;this._elapsedTime+=a;this._elapsedTime<this._delay||(this._elapsedTime>this._duration+this._delay&&(this._elapsedTime=this._duration+this._delay),a=0,a=this._easingFunction(this.getTransitionTimeElapsed(),this._begin,this._change,this._duration),ta.setProperty(this._target,this._propertyName,a),null!=this._onUpdate&&this._onUpdate(),!this._isCompleted&&this.getTransitionTimeElapsed()>=
this._duration&&(this._isCompleted=!0,null!=this._action&&(a=this._action,this._action=null,a(this._params))))},skip:function(){ta.setProperty(this._target,this._propertyName,this._end);this._isCompleted=!0;this._elapsedTime=this._duration},getTransitionTimeElapsed:function(){return Math.max(0,this._elapsedTime-this._delay)},__class__:of};var U=function(a,b){this.data=null;this._type=a;this.data=b};U.__name__=["engine","events","EntityEvent"];U.__super__=P;U.prototype=p(P.prototype,{__class__:U});
var kf=function(a,b){this.eventName=a;this.action=b};kf.__name__=["engine","events","EventListener"];kf.prototype={__class__:kf};var fb=function(a){this._type=a};fb.__name__=["engine","events","GameObjectEvent"];fb.__super__=P;fb.prototype=p(P.prototype,{__class__:fb});var Uc=function(a,b,c){this.start=this.end=null;this._type=a;this.start=b;this.end=c};Uc.__name__=["engine","events","RaycastCheckEvent"];Uc.__super__=P;Uc.prototype=p(P.prototype,{__class__:Uc});var La=function(){this._animations=
new ya};La.__name__=["engine","managers","AnimationManager"];La.getInstance=function(){null==La._instance&&(La._instance=new La);return La._instance};La.prototype={getAnimationByName:function(a){var b=this._animations;return null!=N[a]?b.getReserved(a):b.h[a]},registerAnimation:function(a){var b=this._animations,c=a.getName();null!=N[c]?b.setReserved(c,a):b.h[c]=a},removeAnimationByName:function(a){this._animations.remove(a)},removeAllAnimations:function(){this._animations=new ya},__class__:La};var I=
function(){};I.__name__=["engine","managers","AssetManager"];I.outputAssets=function(){Ea.log(I.assetList)};I.getAsset=function(a){var b=I.assetList;if(null!=N[a]?!b.existsReserved(a):!b.h.hasOwnProperty(a))throw new K(a+" does not exist in asset list!");b=I.assetList;return null!=N[a]?b.getReserved(a):b.h[a]};I.assetExists=function(a){var b=I.assetList;return null!=N[a]?b.existsReserved(a):b.h.hasOwnProperty(a)};I.unloadAsset=function(a){var b=I.assetList;null!=N[a]?b.setReserved(a,null):b.h[a]=
null;I.assetList.remove(a);a=PIXI.Texture.removeTextureFromCache(a);null!=a&&a.destroy(!0)};I.unloadLoadBatch=function(a){I.getAsset(a).unload()};I.registerAsset=function(a,b,c){null==c&&(c=!0);var d=I.assetList;(null!=N[a]?d.existsReserved(a):d.h.hasOwnProperty(a))&&!c||(c=I.assetList,null!=N[a]?c.setReserved(a,b):c.h[a]=b)};I.prototype={__class__:I};var ob=function(){L.call(this);ob._instance=this};ob.__name__=["engine","managers","DebugManager"];ob.getInstance=function(){return ob._instance};ob.__super__=
ba;ob.prototype=p(ba.prototype,{update:function(){ba.prototype.update.call(this);"1"==R.getProperty("debugCheats")&&(qa.getInstance().isKeyPressed(104)&&R.setProperty("debugDraw","1"==R.getProperty("debugDraw")?"0":"1"),qa.getInstance().isKeyPressed(101)&&this.dispatchEvent(new pb("beatLevel")),qa.getInstance().isKeyPressed(102)&&this.dispatchEvent(new pb("failLevel")),qa.getInstance().isKeyPressed(100)&&(R.setProperty("forceOrientation","HORIZONTAL"==R.getProperty("forceOrientation")?"VERTICAL":
"HORIZONTAL"),n.getInstance().onOrientationChange()),qa.getInstance().isKeyPressed(99)&&this.outputHierarchyToWindow())},destroy:function(){ba.prototype.destroy.call(this);ob._instance=null},outputHierarchyToWindow:function(){Ea.log("Outputting Hierarchy to window...");for(var a=window.document.createElement("div"),b=window.open("","_blank"),c=0,d=n.getInstance().getGameStates().length;c<d;){var e=c++,e=n.getInstance().getGameStates()[e],f=window.document.createElement("details");a.appendChild(f);
f.style.color="#FF0000";var g=window.document.createElement("summary");f.appendChild(g);g.innerText=Sa.getClassName(null==e?null:C.getClass(e));for(var g=0,k=e.getEntities().length;g<k;){var h=g++,h=e.getEntities()[h];null==h.getParent()&&(h=this.createDetailsElementForEntity(h),h.style.marginLeft="10px",f.appendChild(h))}}b.document.body.appendChild(a)},createDetailsElementForEntity:function(a){var b=a.getName();if(""==b||null==b)b="Entity";var c=window.document.createElement("details");c.style.marginLeft=
"10px";c.style.color="#00b700";var d=window.document.createElement("summary");c.appendChild(d);for(var e=null!=a.getComponents(m)?a.getComponents(m).length:0,f=a.getChildren().length,g=a.getChildren(!0).length,k="",h=0;h<e;){var l=h++,l=a.getComponents(m)[l],n=window.document.createElement("details");n.style.marginLeft="10px";n.style.color="#439eff";var u=window.document.createElement("summary");n.appendChild(u);var p=Sa.getClassName(null==l?null:C.getClass(l));l.isActive()||(p="(INACTIVE) "+p);u.innerText=
p;""!=k&&(k+=", ");u=Sa.getClassName(null==l?null:C.getClass(l)).split(".");k+=u[u.length-1];c.appendChild(n);for(var u=ta.fields(l),p=0,r=u.length;p<r;){var q=p++,s=u[q],q=window.document.createElement("details");q.style.marginLeft="10px";q.style.color="#AAAAAA";var t=window.document.createElement("summary");q.appendChild(t);var v=ta.field(l,s),w=v;null==w||C.getClass(w);t.innerText=s;s=window.document.createElement("span");s.style.marginLeft="10px";s.style.color="#888888";s.innerText=v;n.appendChild(q);
q.appendChild(s)}}a.isActive()||(b="(INACTIVE) "+b);d.innerHTML=0<e?b+" - Children("+f+"/"+g+") <font color='#439eff'> Components("+e+": "+k+")</font>":b+" - Children("+f+"/"+g+")";for(b=0;b<f;)d=b++,d=a.getChildren()[d],d=this.createDetailsElementForEntity(d),c.appendChild(d);return c},__class__:ob});var pb=function(a){this._type=a};pb.__name__=["engine","managers","DebugManagerEvent"];pb.__super__=P;pb.prototype=p(P.prototype,{__class__:pb});var qa=function(){this._keysDown=this._keysPressedThisFrame=
null;this._isInputDisabled=this._isLeftMouseDown=!1;this._mousePosition=null;L.call(this);qa._instance=this;this._mousePosition=new s(0,0);this._keysDown=[];this._keysPressedThisFrame=[];for(var a=0;255>a;)a++,this._keysDown.push(!1),this._keysPressedThisFrame.push(!1)};qa.__name__=["engine","managers","InputManager"];qa.getInstance=function(){return qa._instance};qa.__super__=ba;qa.prototype=p(ba.prototype,{init:function(){ba.prototype.init.call(this);z.getWindow().addEventListener("mousemove",w(this,
this.onMouseMoved));z.getWindow().addEventListener("mousedown",w(this,this.onMouseDown));z.getWindow().addEventListener("mouseup",w(this,this.onMouseUp));z.getWindow().addEventListener("mouseleave",w(this,this.onMouseLeave));z.getWindow().addEventListener("mouseout",w(this,this.onMouseOut));z.getDocument().addEventListener("keydown",w(this,this.onKeyDown));z.getDocument().addEventListener("keyup",w(this,this.onKeyUp));z.getDocument().addEventListener("keypress",w(this,this.onKeyPressed));z.getWindow().addEventListener("click",
w(this,this.onMouseClick));document.addEventListener("touchstart",w(this,this.onMouseDown));document.addEventListener("touchend",w(this,this.onMouseUp));document.addEventListener("touchmove",w(this,this.onMouseMoved))},update:function(){ba.prototype.update.call(this)},postUpdate:function(){ba.prototype.postUpdate.call(this);for(var a=0,b=this._keysPressedThisFrame.length;a<b;){var c=a++;this._keysPressedThisFrame[c]=!1}},getMousePosition:function(){var a=n.getInstance().getScreenOffset();return new s((this._mousePosition.x-
a.x)/n.getInstance().getScreenScale().x,(this._mousePosition.y-a.y)/n.getInstance().getScreenScale().y)},onMouseMoved:function(a){if(!this._isInputDisabled)if(n.isMobile()){for(var b=a.changedTouches,c=0,d=b.length;c<d;){var e=c++,f=b[e],e=f.pageX-z.getContainer().offsetParent.offsetLeft,f=f.pageY-z.getContainer().offsetParent.offsetTop;this._mousePosition.x=e;this._mousePosition.y=f;n.getInstance().sendGlobalMessage("mouseMove",this.getMousePosition())}n.getInstance().sendGlobalMessage("verifyTouches",
a)}else b=a.pageX-z.getContainer().offsetParent.offsetLeft,a=a.pageY-z.getContainer().offsetParent.offsetTop,this._mousePosition.x=b,this._mousePosition.y=a,n.getInstance().sendGlobalMessage("mouseMove",this.getMousePosition())},onMouseDown:function(a){n.getInstance().hideAddressBar();n.isMobile()&&!n.isIOS()&&n.getInstance().requestFullscreen();if(!this._isInputDisabled)if(n.isMobile()){this._isLeftMouseDown=!0;var b=a.changedTouches;a=0;for(var c=b.length;a<c;){var d=a++,e=b[d],d=e.pageX-z.getContainer().offsetParent.offsetLeft,
e=e.pageY-z.getContainer().offsetParent.offsetTop;this._mousePosition.x=d;this._mousePosition.y=e;n.getInstance().sendGlobalMessage("mouseDown",this.getMousePosition())}}else this._isLeftMouseDown=!0,b=a.pageX-z.getContainer().offsetParent.offsetLeft,a=a.pageY-z.getContainer().offsetParent.offsetTop,this._mousePosition.x=b,this._mousePosition.y=a,n.getInstance().sendGlobalMessage("mouseDown",this.getMousePosition())},onMouseUp:function(a){if(!this._isInputDisabled){if(n.isMobile())this._isLeftMouseDown=
!1;else{this._isLeftMouseDown=!1;var b;b=a.pageX-z.getContainer().offsetParent.offsetLeft;a=a.pageY-z.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a}n.getInstance().sendGlobalMessage("mouseUp",this.getMousePosition())}},onMouseClick:function(a){if(!this._isInputDisabled){var b=a.pageX-z.getContainer().offsetParent.offsetLeft;a=a.pageY-z.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;n.getInstance().sendGlobalMessage("mouseClick",
this.getMousePosition())}},onMouseLeave:function(a){if(!this._isInputDisabled){var b=a.pageX-z.getContainer().offsetParent.offsetLeft;a=a.pageY-z.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;n.getInstance().sendGlobalMessage("mouseLeave",this.getMousePosition())}},onMouseOut:function(a){if(!this._isInputDisabled){var b=a.pageX-z.getContainer().offsetParent.offsetLeft;a=a.pageY-z.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=
a;n.getInstance().sendGlobalMessage("mouseOut",this.getMousePosition())}},onKeyDown:function(a){a.stopPropagation();this._isInputDisabled||this._keysDown[a.keyCode]||(this._keysDown[a.keyCode]=!0,this._keysPressedThisFrame[a.keyCode]=!0,n.getInstance().sendGlobalMessage("keyDown",a.keyCode))},onKeyUp:function(a){this._isInputDisabled||(this._keysDown[a.keyCode]=!1,n.getInstance().sendGlobalMessage("keyUp",a.keyCode))},onKeyPressed:function(a){a.stopPropagation();this._isInputDisabled||n.getInstance().sendGlobalMessage("keyPressed",
a.keyCode)},disablePageKeyPresses:function(){document.onkeydown=function(a){a.preventDefault();return!1}},enablePageKeyPresses:function(){document.onkeydown=null},getInputDisabled:function(){return this._isInputDisabled},setInputDisabled:function(a){this._isInputDisabled=a},isKeyDown:function(a){return this._keysDown[a]},isKeyPressed:function(a){return this._keysPressedThisFrame[a]},isLeftMouseDown:function(){return this._isLeftMouseDown},__class__:qa});var $a=function(){this._colliders=this._raycastsThisFrame=
null;L.call(this);$a._instance=this;this._raycastsThisFrame=[];this._colliders=[];this._debugDrawEnabled="1"==R.getProperty("debugDraw");this.addEventListener("raycastCheck",w(this,this.onRaycastCheck))};$a.__name__=["engine","managers","PhysicsManager"];$a.getInstance=function(){return $a._instance};$a.createBoxColliderEntity=function(a,b,c,d,e,f,g,k){null==k&&(k=!0);d=f.addEntity();d.setLocalPosition(a,b,c);a=new oc;k=new Wc(d,a,k?new O:new O(0.5*a.wh.x,0.5*a.wh.y));if(null!=g)for(a=0,b=g.length;a<
b;)c=a++,k.addTag(g[c]);return d};$a.createBoxCollider=function(a,b,c,d,e,f,g){null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);b=new oc;a=new Wc(a,b,new O(d,e,f));if(null!=g)for(d=0,e=g.length;d<e;)f=d++,a.addTag(g[f]);return a};$a.__super__=ba;$a.prototype=p(ba.prototype,{update:function(){ba.prototype.update.call(this)},registerCollider:function(a){for(var b=0,c=this._colliders.length;b<c;){var d=b++;if(this._colliders[d]==a)return}this._colliders.push(a)},removeCollider:function(a){for(var b=0,c=
this._colliders.length;b<c;){var d=b++;if(this._colliders[d]==a){this._colliders.splice(d,1);break}}},getColliders:function(){return this._colliders},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!0);for(var f=-1,g=null,k=null,h=0,l=0,m=0,u=this._colliders.length;m<u;){var n=m++;++l;n=this._colliders[n];if(!1!=n.isActive()){if(null!=e){for(var p=!1,q=0,r=e.length;q<r;){var t=q++;if(n.hasTag(e[t])){p=!0;break}}if(!p)continue}++h;p=new s;if(d){if(q=new s,r=n.getRaycastPoint(a,b,p,d,q),-1==f&&0<r||
0<r&&r<f)c.distance=r,c.collider=n,c.collisionPoint=p,k=c.normal=q,g=p,f=r,F.remove(this._colliders,n),this._colliders.unshift(n)}else if(q=new s,r=n.getRaycastPoint(a,b,p,d,q),0<r){c.distance=r;c.collider=n;c.collisionPoint=p;k=c.normal=q;g=p;f=r;F.remove(this._colliders,n);this._colliders.unshift(n);break}}}this._raycastsThisFrame.push({start:a,end:b,hitPoint:g,normal:k});return f},render:function(){ba.prototype.render.call(this);"0"==R.getProperty("debugDraw")&&(this._raycastsThisFrame=[])},debugRender:function(){ba.prototype.debugRender.call(this);
for(var a=0,b=this._raycastsThisFrame.length;a<b;){var c=a++,d=this._raycastsThisFrame[c],e=d.start,f=d.end,c=d.hitPoint,g=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");g.save();if(null!=ea.getDebugCamera()){var k=ea.getDebugCamera().getEntity(),h=ea.getDebugCamera().getZoomScale(),l=ea.getDebugCamera().getComponent(Ib);g.translate(-k.getPosition().x*h+l.getContainerOffset().x,-k.getPosition().y*h+l.getContainerOffset().y);g.scale(h,h)}null==c?(g.beginPath(),g.globalAlpha=1,
g.lineWidth=1,g.strokeStyle="#AAAAFF",g.moveTo(e.x,e.y),g.lineTo(f.x,f.y),g.stroke()):(g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#AAAAFF",g.moveTo(e.x,e.y),g.lineTo(c.x,c.y),g.stroke(),g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#FFFF00",g.moveTo(c.x,c.y),g.lineTo(f.x,f.y),g.stroke(),null!=d.normal&&(e=(new s(f.x-c.x,f.y-c.y)).getLength(),d=new s(c.x+d.normal.x*e,c.y+d.normal.y*e),g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#FF00FF",g.moveTo(c.x,c.y),
g.lineTo(d.x,d.y),g.stroke()));g.restore()}this._raycastsThisFrame=[]},destroyAllColliders:function(){for(var a=this._colliders.length-1;0<=a;)this.removeCollider(this._colliders[a]),--a;this._colliders=[]},onRaycastCheck:function(a){this._raycastsThisFrame.push({start:a.start,end:a.end})},__class__:$a});var cc=function(){this._isCurrentVoLocked=!1;this._voTrack=null;L.call(this);cc._instance=this};cc.__name__=["engine","managers","VoManager"];cc.getInstance=function(){return cc._instance};cc.__super__=
ba;cc.prototype=p(ba.prototype,{playVo:function(a,b,c,d){null==d&&(d=!1);null==c&&(c=!1);null==b&&(b=!1);if(!this._isCurrentVoLocked||b)this.stopVo(),this._voTrack=r.playSoundByName(a,c,d),b&&(n.getInstance().invokeAsyncDeferredAction(this._voTrack.getSoundLength(),w(this,this.onHighPrioritySoundElapse)),this._isCurrentVoLocked=!0)},onHighPrioritySoundElapse:function(){this._isCurrentVoLocked=!1},stopVo:function(){null!=this._voTrack&&(this._voTrack.stop(),this._voTrack=null)},__class__:cc});var ee=
function(){};ee.__name__=["engine","ui","ILayoutElement"];ee.prototype={__class__:ee,__properties__:{set_localPosition:"set_localPosition",get_localPosition:"get_localPosition",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width"}};var ra=function(a){this._updateContainerEveryFrame=!0;m.call(this,a);this._positionOffset=new s(0,0);this._scaleModifier=new s(1,1);this._scaleOffset=new s(0,0);this._rotationOffset=0;this.initContainer()};ra.__name__=["engine","pixi",
"PixiContainer"];ra.__interfaces__=[ee];ra.__super__=m;ra.prototype=p(m.prototype,{get_width:function(){return this._container.width},set_width:function(a){return this._container.width=a},get_height:function(){return this._container.height},set_height:function(a){return this._container.height=a},get_localPosition:function(){return this.getEntity().getLocalPosition()},set_localPosition:function(a){this.getEntity().setLocalPosition(a.x,a.y,a.z);return a},getUpdateContainerEveryFrame:function(){return this._updateContainerEveryFrame},
setUpdateContainerEveryFrame:function(a){this._updateContainerEveryFrame=a},getPositionOffset:function(){return this._positionOffset},setPositionOffset:function(a){this._positionOffset=a},getScaleModifier:function(){return this._scaleModifier},setScaleModifier:function(a){this._scaleModifier=a},getScaleOffset:function(){return this._scaleOffset},setScaleOffset:function(a){this._scaleOffset=a},getRotationOffset:function(){return this._rotationOffset},setRotationOffset:function(a){this._rotationOffset=
a},getContainer:function(){return this._container},initContainer:function(){this._container=new PIXI.Container},onActivate:function(){m.prototype.onActivate.call(this);null!=this._container&&(this._container.renderable=!0)},onDeactivate:function(){m.prototype.onDeactivate.call(this);null!=this._container&&(this._container.renderable=!1)},init:function(){m.prototype.init.call(this);this.updateTransforms();this.updateParenting()},updateParenting:function(){if(!this.isMarkedForDeletion()){var a=this.getEntity().getParent();
if(null!=a){var b=a.getComponent(ra);null==b&&(b=new ra(a));0<b.getContainer().children.length?b.getContainer().addChildAt(this._container,b.getContainer().children.length):b.getContainer().addChild(this._container);this._parentContainer=b}else 0<fa.getInstance().getStage().children.length?fa.getInstance().getStage().addChildAt(this._container,fa.getInstance().getStage().children.length):fa.getInstance().getStage().addChild(this._container)}},update:function(){m.prototype.update.call(this);this._container.visible=
this.getEntity().isVisible()},render:function(){m.prototype.render.call(this);this._updateContainerEveryFrame&&(this.updateTransforms(),this.updateParenting())},bringToFront:function(){var a=this._container.parent;null!=a&&(a.removeChild(this._container),a.addChild(this._container))},updateTransforms:function(){var a=this.getEntity().getLocalPosition(),b=this.getEntity().getLocalScale();this._container.position=new PIXI.Point(a.x+this._positionOffset.x,a.y+this._positionOffset.y);a=this.getEntity().getLocalRotation().z+
this._rotationOffset;this._container.rotation=ka.degToRad(a);this._container.scale=new PIXI.Point(b.x*this._scaleModifier.x+this._scaleOffset.x,b.y*this._scaleModifier.y+this._scaleOffset.y)},destroy:function(){m.prototype.destroy.call(this);null!=this._container.parent&&this._container.parent.removeChild(this._container)},__class__:ra,__properties__:{set_localPosition:"set_localPosition",get_localPosition:"get_localPosition",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width"}});
var y=function(a,b,c){ra.call(this,a);this.setImage(b,c)};y.__name__=["engine","pixi","PixiSprite"];y.__interfaces__=[ee];y.__super__=ra;y.prototype=p(ra.prototype,{getSprite:function(){return this._container},getFrame:function(){return this.getSprite().texture.frame},getAnchor:function(){return new s(this.getSprite().anchor.x,this.getSprite().anchor.y)},setAnchor:function(a,b){this.getSprite().anchor.x=a;this.getSprite().anchor.y=b},getSize:function(){return new s(this.getSprite().width,this.getSprite().height)},
setSize:function(a,b){this.getEntity().setScale(a/this.getSprite().texture.width,b/this.getSprite().texture.height)},setImageElement:function(a,b){this._currentImageElement=a;var c;null==b?c=PIXI.Texture.fromImage(this._currentImageElement.src):(c=PIXI.BaseTexture.fromImage(this._currentImageElement.src),c=new PIXI.Texture(c,b));this.getSprite().texture=c;this.updateTransforms()},setImage:function(a,b){if(I.assetExists(a)){var c=I.getAsset(a);this.setImageElement(c,b)}},initContainer:function(){ra.prototype.initContainer.call(this);
this._container=new PIXI.Sprite(null)},__class__:y});var Na=function(a,b){this._onAnimationComplete=null;this._position=0;this._updateScale=1;this._isPlaying=!0;y.call(this,a,"");this._currentAnimationName=b};Na.__name__=["engine","pixi","PixiAnimation"];Na.__super__=y;Na.prototype=p(y.prototype,{getAnimation:function(){return La.getInstance().getAnimationByName(this._currentAnimationName)},getAnimationLength:function(){return this.getAnimation().getLength()},getUpdateScale:function(){return this._updateScale},
setUpdateScale:function(a){this._updateScale=a},fixedUpdate:function(){y.prototype.update.call(this);var a=this.getAnimation();if(null!=a){if(this._isPlaying){this._position+=n.getDeltaTime()*this.getUpdateScale();if(0<this._updateScale&&this._position>=a.getLength()&&(a.getLoop()?this._position-=a.getLength():(this._position=a.getLength(),this.stop()),null!=this._onAnimationComplete)){var b=this._onAnimationComplete;this._onAnimationComplete=null;b(this.getEntity());a=La.getInstance().getAnimationByName(this._currentAnimationName)}0>
this._updateScale&&0>=this._position&&(a.getLoop()?this._position+=a.getLength():(this._position=0,this.stop()),null!=this._onAnimationComplete&&(b=this._onAnimationComplete,this._onAnimationComplete=null,b(this.getEntity()),a=La.getInstance().getAnimationByName(this._currentAnimationName)))}if(null!=a){var b=a.getSpriteIndexAtPosition(this._position),c=a.getSpriteSheetNameAtPosition(this._position),b=Pa.getInstance().getSpriteSheetByName(c).getSpriteInfoByIndex(b),d=b.getCoords();this.setImage(c,
new PIXI.Rectangle(d.ul.x,d.ul.y,d.wh.x,d.wh.y));c=a.getOffset().x/b.getCoords().wh.x;a=a.getOffset().y/b.getCoords().wh.y;d=b.getOffset().x/b.getCoords().wh.x;b=b.getOffset().y/b.getCoords().wh.y;this.getSprite().anchor.x=-c-d;this.getSprite().anchor.y=-a-b}}},setPosition:function(a){this._position=a},getPosition:function(){return this._position},setAnimation:function(a,b,c){null==c&&(c=!1);if(this._currentAnimationName!=a||c)this._position=0;this._currentAnimationName=a;this._onAnimationComplete=
b;this._isPlaying=!0},getAnimationName:function(){return this._currentAnimationName},play:function(){this._isPlaying=!0},stop:function(){this._isPlaying=!1},playing:function(){return this._isPlaying},setOnAnimationComplete:function(a){this._onAnimationComplete=a},getOnAnimationComplete:function(){return this._onAnimationComplete},__class__:Na});var Ib=function(a){this._containerOffset=new s(0,0);this._muteRotation=!1;this._layers=[];ea.call(this,a)};Ib.__name__=["engine","pixi","PixiCamera"];Ib.__super__=
ea;Ib.prototype=p(ea.prototype,{getContainerOffset:function(){return this._containerOffset},setContainerOffset:function(a){this._containerOffset.x=a.x;this._containerOffset.y=a.y},getMuteRotation:function(){return this._muteRotation},setMuteRotation:function(a){this._muteRotation=a},addLayer:function(a,b,c,d,e,f){null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=1);null==b&&(b=1);a=new pf(a,b,c,d,e,f);this._layers.push(a);return a},removeLayer:function(a){F.remove(this._layers,a)},getLayerByContainer:function(a){for(var b=
0,c=this._layers.length;b<c;){var d=b++,d=this._layers[d];if(d.pixiContainer==a)return d}return null},getLayers:function(){return this._layers},postUpdate:function(){ea.prototype.postUpdate.call(this);for(var a=this.getEntity().getPosition(),b=0,c=this._layers.length;b<c;){var d=b++,e=this._zoomScale,d=this._layers[d],e=0==d.zoomModifier?1:e*d.zoomModifier;0==d.parallaxX&&0==d.parallaxY&&(e=1);d.muteXMovement?d.pixiContainer.setPositionOffset(new s(d.pixiContainer.getPositionOffset().x,n.getInstance().getGameSize().y/
2+this._containerOffset.y*d.parallaxY)):d.muteYMovement?d.pixiContainer.setPositionOffset(new s(n.getInstance().getGameSize().x/2+this._containerOffset.x*d.parallaxX,d.pixiContainer.getPositionOffset().y)):d.muteXMovement||d.muteYMovement||d.pixiContainer.setPositionOffset(new s(n.getInstance().getGameSize().x/2+this._containerOffset.x*d.parallaxX,n.getInstance().getGameSize().y/2+this._containerOffset.y*d.parallaxY));this._muteRotation||d.pixiContainer.setRotationOffset(this.getEntity().getRotation().z);
var f=Math.floor(a.x*d.parallaxX)-d.originX+n.getInstance().getGameSize().x/e/2,g=Math.floor(a.y*d.parallaxY)-d.originY+n.getInstance().getGameSize().y/e/2;d.pixiContainer.getContainer().pivot=new PIXI.Point(f,g);d.pixiContainer.setScaleModifier(new s(e,e))}},__class__:Ib});var pf=function(a,b,c,d,e,f){null==f&&(f=1);this.muteXMovement=this.muteYMovement=!1;this.zoomModifier=1;this.originX=this.originY=0;this.parallaxX=this.parallaxY=1;this.pixiContainer=a;this.parallaxX=b;this.parallaxY=c;this.originX=
d;this.originY=e;this.zoomModifier=f};pf.__name__=["engine","pixi","PixiCameraLayer"];pf.prototype={__class__:pf};var fa=function(a){this._isSetup=!1;this.scaleHeightToWidth=0;L.call(this)};fa.__name__=["engine","pixi","PixiManager"];fa.getInstance=function(){null==fa._instance&&(fa._instance=new fa,n.getInstance().addManager(fa._instance));return fa._instance};fa.__super__=ba;fa.prototype=p(ba.prototype,{getWebGlEnabled:function(){return this._renderer.type==PIXI.RENDERER_TYPE.WEBGL},getStage:function(){return this._stage},
getRenderer:function(){return this._renderer},setup:function(a){this._baseWidth=R.getProperty("gameWidth",1024);this._baseHeight=R.getProperty("gameHeight",768);this._stage=new PIXI.Container;this._renderer=PIXI.autoDetectRenderer(n.getInstance().getGameSize().x,n.getInstance().getGameSize().y,a,!1);this._masterLayer=n.getInstance().getLayerByName("master");z.getContainer().appendChild(this._renderer.view);this._isSetup=!0;this.updateSize()},render:function(){ba.prototype.render.call(this);null!=
this._renderer&&this._renderer.render(this._stage)},handleMessage:function(a,b){ba.prototype.handleMessage.call(this,a,b);if(null!=this._renderer)switch(a){case "onOrientationChanged":this.updateSize();break;case "onResizedWindow":this.updateSize()}},updateSize:function(){if(null!=this._stage)if(n.isMobile()){var a=window.innerWidth,b=window.innerHeight,c=ka.lerp(b/this._baseHeight,a/this._baseWidth,this.scaleHeightToWidth);this._stage.scale.x=c;this._stage.scale.y=c;this._stage.x=0.5*a-0.5*this._baseWidth*
c;this._stage.y=0.5*b-0.5*this._baseHeight*c;this._renderer.view.style.left="0px";this._renderer.view.style.top="0px";this._renderer.resize(a,b)}else a=window.innerHeight,this._renderer.view.style.left=0.5*window.innerWidth-0.5*this._baseWidth+"px",this._renderer.view.style.top=0.5*a-0.5*this._baseHeight+"px"},__class__:fa});var ma=function(a,b,c){ra.call(this,a);this.getText().anchor.x=0.5;this.getText().anchor.y=0.5;a=this._container;a.text=b;a.style=c};ma.__name__=["engine","pixi","PixiText"];
ma.__super__=ra;ma.prototype=p(ra.prototype,{getText:function(){return this._container},getTextString:function(){return this.getText().text},setTextString:function(a){this.getText().text=a},initContainer:function(){ra.prototype.initContainer.call(this);this._container=new PIXI.Text("")},init:function(){ra.prototype.init.call(this)},destroy:function(){ra.prototype.destroy.call(this);this.getText().texture.baseTexture.destroy()},__class__:ma});var Ia=function(a,b,c){null==c&&(c=!0);X.call(this);this._from=
a;this._to=b;this._destroyFrom=c;r.playSoundByName("transition_1")};Ia.__name__=["engine","screenTransition","TransitionScreen"];Ia.__super__=X;Ia.prototype=p(X.prototype,{onTransitionMidpoint:function(){this._destroyFrom&&this._from.destroy();n.getInstance().addGameState(this._to);this.dispatchEvent(new dc("midpoint"))},onTransitionComplete:function(){this.destroy();this.dispatchEvent(new dc("complete"))},__class__:Ia});var dc=function(a){this._type=a};dc.__name__=["engine","screenTransition","TransitionScreenEvent"];
dc.__super__=P;dc.prototype=p(P.prototype,{__class__:dc});var qb=function(){this.layers=[];this.ul=new s;this.wh=new s};qb.__name__=["engine","shapes","Shape"];qb.prototype={hasLayer:function(a){for(var b=0,c=this.layers.length;b<c;){var d=b++;if(this.layers[d]==a)return!0}return!1},getClone:function(){var a=new qb;a.ul=this.ul.getClone();a.wh=this.wh.getClone();for(var b=0,c=this.layers.length;b<c;){var d=b++;a.layers.push(this.layers[d])}return a},checkPointIntersect:function(a){return!1},getRaycastPoint:function(a,
b,c,d,e){return-1},__class__:qb};var oc=function(){qb.call(this)};oc.__name__=["engine","shapes","BoxShape"];oc.__super__=qb;oc.prototype=p(qb.prototype,{checkPointIntersect:function(a){qb.prototype.checkPointIntersect.call(this,a);return a.x>=this.ul.x&&a.y>=this.ul.y&&a.x<=this.ul.x+this.wh.x?a.y<=this.ul.y+this.wh.y:!1},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);e=new s;for(var f=[new s(this.ul.x,this.ul.y),new s(this.ul.x+this.wh.x,this.ul.y),new s(this.ul.x+this.wh.x,this.ul.y+this.wh.y),
new s(this.ul.x,this.ul.y+this.wh.y)],g=-1,k=0,h=f.length-1;k<h;){var l=k++,l=ka.lineIntersect2D(a,b,f[l],f[l+1],e);if(0<l)if(d){if(-1==g||l<g)c.x=e.x,c.y=e.y,g=l}else return c.x=e.x,c.y=e.y,l}a=ka.lineIntersect2D(a,b,f[0],f[f.length-1],e);if(0<a)if(d){if(-1==g||a<g)c.x=e.x,c.y=e.y,g=a}else return c.x=e.x,c.y=e.y,a;return g},getClone:function(){return null},__class__:oc});var Yc=function(){this._lowestPoint=this._highestPoint=null;qb.call(this);this._lowestPoint=new s(999999,999999);this._highestPoint=
new s(-999999,-999999);this._points=[]};Yc.__name__=["engine","shapes","PolygonShape"];Yc.__super__=qb;Yc.prototype=p(qb.prototype,{addPoint:function(a,b){this._points.push(new s(a,b));a<this._lowestPoint.x&&(this._lowestPoint.x=a);b<this._lowestPoint.y&&(this._lowestPoint.y=b);a>this._highestPoint.x&&(this._highestPoint.x=a);b>this._highestPoint.y&&(this._highestPoint.y=b)},getPoints:function(){return this._points},checkPointIntersect:function(a){for(var b=this._points.length,c=0,d=!1,e=null,f=null;c<
b;){e=this._points[c].getClone();f=this._points[(c+1)%b].getClone();e.x+=this.ul.x;e.y+=this.ul.y;f.x+=this.ul.x;f.y+=this.ul.y;if(0==c)d=0<(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y);else if(d&&0>(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y)||!d&&0<(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y))return!1;++c}return!0},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);var f=new wb;f.ul=this._lowestPoint.getClone();f.wh=new s(this._highestPoint.x-this._lowestPoint.x,this._highestPoint.y-this._lowestPoint.y);f.ul.x+=
this.ul.x;f.ul.y+=this.ul.y;var g=Math.abs(b.x-a.x),k=Math.abs(b.y-a.y),g=new wb(a.x<b.x?a.x:b.x,a.y<b.y?a.y:b.y,g,k);if(!f.getIntersect(g))return-1;for(var f=new s,k=this._points,g=-1,h=0,l=k.length-1;h<l;){var m=h++,u=k[m].getClone();u.x+=this.ul.x;u.y+=this.ul.y;var n=k[m+1].getClone();n.x+=this.ul.x;n.y+=this.ul.y;m=ka.lineIntersect2D(a,b,u,n,f);if(0<m)if(d){if(-1==g||m<g)c.x=f.x,c.y=f.y,null!=e&&(g=(new s(n.y-u.y,u.x-n.x)).getNormalized(),e.x=g.x,e.y=g.y,0<(new s(b.x-a.x,b.y-a.y)).dotProduct(e)&&
(e.x*=-1,e.y*=-1)),g=m}else return c.x=f.x,c.y=f.y,null!=e&&(c=(new s(n.y-u.y,u.x-n.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new s(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),m}h=k[0].getClone();h.x+=this.ul.x;h.y+=this.ul.y;l=k[k.length-1].getClone();l.x+=this.ul.x;l.y+=this.ul.y;k=ka.lineIntersect2D(a,b,h,l,f);if(0<k)if(d){if(-1==g||k<g)c.x=f.x,c.y=f.y,null!=e&&(c=(new s(l.y-h.y,h.x-l.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new s(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),g=k}else return c.x=
f.x,c.y=f.y,null!=e&&(c=(new s(l.y-h.y,h.x-l.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new s(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),k;return g},getClone:function(){return null},__class__:Yc});var qf=function(a){this.soundName=a;this.subtitles=[]};qf.__name__=["engine","speechManager","Dialogue"];qf.prototype={__class__:qf};var Kb=function(a,b){null==b&&(b=!0);null==a&&(a=!0);this._voTrack=this._speechMap=this._currentDeferredActions=null;L.call(this);this._speechMap=new rf;this._voiceOversEnabled=
a;this._subtitlesEnabled=b;this._currentDeferredActions=[];Kb._instance=this};Kb.__name__=["engine","speechManager","SpeechManager"];Kb.getInstance=function(){return Kb._instance};Kb.__super__=ba;Kb.prototype=p(ba.prototype,{getVoiceOversEnabled:function(){return this._voiceOversEnabled},setVoiceOversEnabled:function(a){this._voiceOversEnabled=a},getSubtitlesEnabled:function(){return this._subtitlesEnabled},setSubtitlesEnabled:function(a){this._subtitlesEnabled=a},init:function(){ba.prototype.init.call(this)},
setup:function(){this.parseSpeechMap()},parseSpeechMap:function(){for(var a=B.parse(I.getAsset("speechMap")).elementsNamed("speech_map").next().elementsNamed("dialogue");a.hasNext();){for(var b=a.next(),c=new qf(b.get("soundName")),b=b.elementsNamed("subtitle");b.hasNext();){var d=b.next(),d=new sf(d.get("stringId"),parseFloat(d.get("time")),parseFloat(d.get("duration")));c.subtitles.push(d)}this._speechMap.dialogue.push(c)}},stopVo:function(){null!=this._voTrack&&(this._voTrack.stop(),this._voTrack=
null)},playVo:function(a){var b=this;null!=this._voTrack&&this.stopVo();if("0"==R.getProperty("speechMode")||"2"==R.getProperty("speechMode"))this._voTrack=r.playSoundByName(a);if("1"==R.getProperty("speechMode")||"2"==R.getProperty("speechMode")){var c=this._speechMap.getDialogueBySoundName(a);if(null!=c){for(;0<this._currentDeferredActions.length;)a=this._currentDeferredActions.pop(),n.getInstance().destroyDeferredAction(a);a=0;for(var d=c.subtitles.length;a<d;){var e=a++,e=[c.subtitles[e]];this._currentDeferredActions.push(n.getInstance().invokeAsyncDeferredAction(e[0].time,
function(a){return function(){b.dispatchSubtitle(a[0])}}(e)))}}else Ea.log("WARNING: '"+a+"' has no subtitles.")}return this._voTrack},dispatchSubtitle:function(a){this.dispatchEvent(new Zc("showSubtitle",a.duration,la.getString(a.stringId)))},__class__:Kb});var rf=function(){this.dialogue=[]};rf.__name__=["engine","speechManager","SpeechMap"];rf.prototype={getDialogueBySoundName:function(a){for(var b=0,c=this.dialogue.length;b<c;){var d=b++;if(this.dialogue[d].soundName==a)return this.dialogue[d]}return null},
__class__:rf};var sf=function(a,b,c){this.stringId=a;this.time=b;this.duration=c};sf.__name__=["engine","speechManager","Subtitle"];sf.prototype={__class__:sf};var Zc=function(a,b,c){this._duration=0;this._type=a;this._duration=b;this._subtitleText=c};Zc.__name__=["engine","speechManager","SubtitleEvent"];Zc.__super__=P;Zc.prototype=p(P.prototype,{getDuration:function(){return this._duration},getSubtitleText:function(){return this._subtitleText},__class__:Zc});var fe=function(a,b,c,d){this._name=
a;this._coords=b.getClone();this._spriteSheetName=c;null==d||isNaN(d.x)&&isNaN(d.y)?this._offset=new s:this._offset=new s(d.x,d.y)};fe.__name__=["engine","spriteSheets","SpriteInfo"];fe.prototype={getCoords:function(){return this._coords},setOffset:function(a,b){this._offset.x=a;this._offset.y=b},getOffset:function(){return this._offset},getSpriteSheetName:function(){return this._spriteSheetName},getName:function(){return this._name},__class__:fe};var Zb=function(a,b){this._image=null;this._spriteInfo=
[];this._spriteInfoHashTable=new ya;this._name=a;null==b?this._imageName=a:(this._imageName=b,this._image=I.getAsset(this._imageName))};Zb.__name__=["engine","spriteSheets","SpriteSheet"];Zb.parseFromXmlString=function(a,b,c){c=B.parse(c);b=new Zb(a,b);for(c=c.elementsNamed("TextureAtlas").next().elementsNamed("sprite");c.hasNext();){var d=c.next(),d=new fe(d.get("n"),new wb(parseFloat(d.get("x")),parseFloat(d.get("y")),parseFloat(d.get("w")),parseFloat(d.get("h"))),a,new s(parseFloat(d.get("oX")),
parseFloat(d.get("oY"))));b.addSpriteInfo(d)}Pa.getInstance().registerSpriteSheet(b);return b};Zb.prototype={getNumSprites:function(){return this._spriteInfo.length},getName:function(){return this._name},getImage:function(){return this._image},getImageName:function(){return this._imageName},addSpriteInfo:function(a){this._spriteInfo.push(a);var b=this._spriteInfoHashTable,c=a.getName();null!=N[c]?b.setReserved(c,a):b.h[c]=a},getSpriteInfoByIndex:function(a){return this._spriteInfo[a]},getSpriteInfoByName:function(a){var b=
this._spriteInfoHashTable;return null!=N[a]?b.getReserved(a):b.h[a]},addToAllOffsets:function(a,b){for(var c=0,d=this._spriteInfo.length;c<d;){var e=c++,e=this._spriteInfo[e];e.setOffset(e.getOffset().x+a,e.getOffset().y+b)}},__class__:Zb};var Pa=function(){this._spriteSheets=new ya};Pa.__name__=["engine","spriteSheets","SpriteSheetManager"];Pa.getInstance=function(){null==Pa._instance&&(Pa._instance=new Pa);return Pa._instance};Pa.createSpriteSheetFromGrid=function(a,b,c,d,e){var f=I.getAsset(a),
g=Math.floor(f.width/c),f=Math.floor(f.height/d);b=new Zb(a,b);for(var k=0;k<f;)for(var h=k++,l=0,m=g;l<m;){var u=l++,u=new fe(a+u+"-"+h,new wb(u*c,h*d,c,d),a,e);b.addSpriteInfo(u)}Pa.getInstance().registerSpriteSheet(b)};Pa.prototype={addToAllSpriteSheetOffsets:function(a,b,c){this.getSpriteSheetByName(a).addToAllOffsets(b,c)},getSpriteSheetByName:function(a){var b=this._spriteSheets;return null!=N[a]?b.getReserved(a):b.h[a]},registerSpriteSheet:function(a){var b=this._spriteSheets,c=a.getName();
null!=N[c]?b.setReserved(c,a):b.h[c]=a},removeSpriteSheetByName:function(a){this._spriteSheets.remove(a)},removeAllSpriteSheets:function(){this._spriteSheets=new ya},__class__:Pa};var $c=function(){this.image=null;this.width=this.height=0;this.trans="#000000";this.source=""};$c.__name__=["engine","tmx","TmxImage"];$c.prototype={__class__:$c};var tf=function(){this.image=null;this.width=this.height=0;this.properties=new ya};tf.__name__=["engine","tmx","TmxImageLayer"];tf.prototype={__class__:tf};var uf=
function(){this.data="";this.width=this.height=0;this.name="";this.properties=new ya;this.tileValues=[]};uf.__name__=["engine","tmx","TmxLayer"];uf.prototype={decompressData:function(){for(var a=this.data.split(","),b=0,c=a.length;b<c;){var d=b++,d=ga.parseInt(a[d]);this.tileValues.push(d)}},isSpace:function(a,b){var c=F.cca(a,b);return 9<=c&&13>=c?!0:32==c},__class__:uf};var vf=function(a,b,c,d,e,f,g){this._tiles=this._colliderEntities=this._layerContainers=null;this._isLoaded=!1;this._layer=this._fgLayer=
this._camera=this._onLevelLoaded=null;this._basePath="";this._tmxMap=null;m.call(this,a);this._tmxMap=b;this._layer=d;this._fgLayer=e;this._camera=f;this._basePath=c;this._onLevelLoaded=g;this._tiles=[];this._colliderEntities=[];this._layers=[];this._layerContainers=[]};vf.__name__=["engine","tmx","TmxLevel"];vf.__super__=m;vf.prototype=p(m.prototype,{getLayerContainerByName:function(a){for(var b=0,c=this._layerContainers.length;b<c;){var d=b++,d=this._layerContainers[d];if(d.getName()==a)return d}return null},
getTiles:function(){return this._tiles},getTmxMap:function(){return this._tmxMap},init:function(){m.prototype.init.call(this);new ra(this.getEntity());for(var a=new Jb(!0),b=0,c=this._tmxMap.tilesets.length;b<c;){var d=b++,d=this._tmxMap.tilesets[d];if(0<d.images.length)d=this._basePath+d.images[0].source,a.addAsset("tmxImage"+d,d,S.Image);else if("undefined"!=d.source&&null!=d.source){var e=this._basePath+d.source;console.log(d.source);a.addAsset("tmxTileset"+e,e,S.Other)}}b=0;for(c=this._tmxMap.imageLayers.length;b<
c;)d=b++,d=this._tmxMap.imageLayers[d],console.log("ADDING tmxImage"+this._basePath+d.image.source),a.addAsset("tmxImage"+this._basePath+d.image.source,this._basePath+d.image.source,S.Image);a.load(w(this,this.onTilesetsLoaded))},onTilesetsLoaded:function(){for(var a=new Jb(!0),b=0,c=this._tmxMap.tilesets.length;b<c;){var d=b++,d=this._tmxMap.tilesets[d];if(0==d.images.length){var e="tmxTileset"+this._basePath+d.source;if(I.assetExists(e)){e=B.parse(I.getAsset(e)).elementsNamed("tileset").next();
d.name=e.get("name");d.tileWidth=parseInt(e.get("tilewidth"));d.tileHeight=parseInt(e.get("tileheight"));var e=e.elementsNamed("image").next(),f=e.get("source"),g=new $c;g.source=f;g.width=parseInt(e.get("width"));g.height=parseInt(e.get("height"));g.trans=e.get("trans");d.images[0]=g;a.addAsset("tmxImage"+this._basePath+f,this._basePath+f,S.Image)}}else d.images[0].image=I.getAsset("tmxImage"+this._basePath+d.images[0].source)}a.load(w(this,this.onTilesetImagesLoaded))},onTilesetImagesLoaded:function(){for(var a=
0,b=this._tmxMap.tilesets.length;a<b;){var c=a++,c=this._tmxMap.tilesets[c];null!=c.images[0]&&null==c.images[0].image&&(c.images[0].image=I.getAsset("tmxImage"+this._basePath+c.images[0].source))}this.onLevelLoaded()},onLevelLoaded:function(){this._isLoaded||(this._isLoaded=!0,null!=this._onLevelLoaded&&(this._onLevelLoaded(),this._onLevelLoaded=null))},createLevel:function(){this._isLoaded||Ea.log("Level not loaded; Cannot execute 'createLevel()'!");this.instantiateEntities();this.processCollision()},
instantiateEntities:function(){for(var a=0,b=this._tmxMap.imageLayers.length;a<b;){var c=a++,d=this._tmxMap.imageLayers[c],c=this.getEntity().getGameState().addEntity();this.getEntity().addChild(c);new y(c,"tmxImage"+this._basePath+d.image.source);var e=1,f=1,g=d.properties;if(null!=N.ParallaxX?g.existsReserved("ParallaxX"):g.h.hasOwnProperty("ParallaxX"))if(g=d.properties,parseFloat(null!=N.ParallaxX?g.getReserved("ParallaxX"):g.h.ParallaxX),g=d.properties,null!=N.ParallaxX?g.existsReserved("ParallaxX"):
g.h.hasOwnProperty("ParallaxX"))e=d.properties,e=parseFloat(null!=N.ParallaxX?e.getReserved("ParallaxX"):e.h.ParallaxX);g=d.properties;if(null!=N.ParallaxY?g.existsReserved("ParallaxY"):g.h.hasOwnProperty("ParallaxY"))if(g=d.properties,parseFloat(null!=N.ParallaxY?g.getReserved("ParallaxY"):g.h.ParallaxY),g=d.properties,null!=N.ParallaxY?g.existsReserved("ParallaxY"):g.h.hasOwnProperty("ParallaxY"))f=d.properties,f=parseFloat(null!=N.ParallaxY?f.getReserved("ParallaxY"):f.h.ParallaxY);var g=this._camera,
k=this.getGameState().addEntity();this.getEntity().addChild(k);var h=new ra(k);k.addChild(c);g.addLayer(h,e,f);e=d.properties;if(null!=N.OriginX?e.existsReserved("OriginX"):e.h.hasOwnProperty("OriginX"))e=d.properties,e=parseFloat(null!=N.OriginX?e.getReserved("OriginX"):e.h.OriginX),c.setLocalPosition(c.getLocalPosition().x+e*this._tmxMap.tileWidth,c.getLocalPosition().y,c.getLocalPosition().z);e=d.properties;if(null!=N.OriginY?e.existsReserved("OriginY"):e.h.hasOwnProperty("OriginY"))d=d.properties,
d=parseFloat(null!=N.OriginY?d.getReserved("OriginY"):d.h.OriginY),c.setLocalPosition(c.getLocalPosition().x,c.getLocalPosition().y+d*this._tmxMap.tileHeight,c.getLocalPosition().z)}a=0;for(b=this._tmxMap.layers.length;a<b;){c=a++;d=this._tmxMap.layers[c];c=this.getGameState().addEntity();c.setName(d.name);this._layerContainers.push(c);new ra(c);this.getEntity().addChild(c);for(var e=d.height,f=d.width,g=this._tmxMap.tileWidth,k=this._tmxMap.tileHeight,h=this._tmxMap.tilesets.length,l=[],m=0,u=h;m<
u;){var n=m++,n=this._tmxMap.tilesets[n];if(null!=n.images[0])for(var p="tmxImage"+this._basePath+n.images[0].source,q=I.getAsset("tmxImage"+this._basePath+n.images[0].source),r=n.tileWidth,t=n.tileHeight,v=q.width,w=q.height,z=v/r,A=(r-1)/v,B=(t-1)/w,E=0,F=e;E<F;)for(var G=E++,H=0,K=f;H<K;){var J=H++,L=J*g,P=G*k,D=d.tileValues[G*f+J];if(0!=D){for(var J=D&-2147483648,Q=D&1073741824,O=D&536870912,D=D&536870911,M=1,R=0,T=h;R<T;){var S=R++;D>=this._tmxMap.tilesets[S].firstgid&&(M=this._tmxMap.tilesets[S].firstgid)}M==
n.firstgid&&(D-=M,0>D||(M=D%z*r/v,R=Math.floor(D/z)*t/w,D=this.getEntity().getGameState().addEntity(),c.addChild(D),D.setLocalPosition(L,P+k,this.getEntity().getPosition().z),l.push(D),L=new y(D,p,new PIXI.Rectangle(Math.round(M*q.width),Math.round(R*q.height),Math.round(A*q.width)+1,Math.round(B*q.height)+1)),L.setUpdateContainerEveryFrame(!1),L.setPositionOffset(new s(0,-n.tileHeight)),O&&(D.setLocalRotation(0,0,90),D.setLocalScale(1,-1),D.setLocalPosition(D.getLocalPosition().x,D.getLocalPosition().y,
D.getLocalPosition().z)),J&&(O?(D.setLocalPosition(D.getLocalPosition().x+r,D.getLocalPosition().y,D.getLocalPosition().z),D.setLocalScale(D.getScale().x,-D.getScale().y,1)):(D.setLocalPosition(D.getLocalPosition().x+r,D.getLocalPosition().y,D.getLocalPosition().z),D.setLocalScale(-D.getScale().x,D.getScale().y,1))),Q&&(O?(D.setLocalPosition(D.getLocalPosition().x,D.getLocalPosition().y+r,D.getLocalPosition().z),D.setLocalScale(-D.getScale().x,D.getScale().y,1)):(D.setLocalPosition(D.getLocalPosition().x,
D.getLocalPosition().y+t,D.getLocalPosition().z),D.setLocalScale(D.getScale().x,-D.getScale().y,1)))))}}}e=this._camera;(null==e?null:C.getClass(e))==Ib&&(e=this._camera,f=d.properties,(null!=N.ParallaxX?f.existsReserved("ParallaxX"):f.h.hasOwnProperty("ParallaxX"))?(f=d.properties,f=parseFloat(null!=N.ParallaxX?f.getReserved("ParallaxX"):f.h.ParallaxX)):f=1,g=d.properties,(null!=N.ParallaxY?g.existsReserved("ParallaxY"):g.h.hasOwnProperty("ParallaxY"))?(d=d.properties,d=parseFloat(null!=N.ParallaxY?
d.getReserved("ParallaxY"):d.h.ParallaxY)):d=1,e.addLayer(c.getComponent(ra),f,d))}},processCollision:function(){for(var a=0,b=this._tmxMap.objectGroups.length;a<b;)for(var c=a++,c=this._tmxMap.objectGroups[c],d=0,e=c.objects.length;d<e;){var f=d++,f=c.objects[f],g=f.polygon;if(("Collision"==f.type||"SoftCollision"==f.type)&&null!=g){var k=this.getEntity().getGameState().addEntity();this.getEntity().addChild(k);for(var h=new Yc,l=0,m=g.points.length;l<m;){var n=l++,n=g.points[n];h.addPoint(Math.floor(n.x),
Math.floor(n.y))}(new Xc(k,h)).addTag("Collision"==f.type?"ground":"softGround");k.setLocalPosition(Math.floor(f.x),Math.floor(f.y));this._colliderEntities.push(k)}else if("Collision"==f.type||"SoftCollision"==f.type)g=this.getEntity().getGameState().addEntity(),this.getEntity().addChild(g),k=new Yc,k.addPoint(0,0),k.addPoint(f.width,0),k.addPoint(f.width,f.height),k.addPoint(0,f.height),k.addPoint(0,0),(new Xc(g,k)).addTag("Collision"==f.type?"ground":"softGround"),g.setLocalPosition(Math.floor(f.x),
Math.floor(f.y)),this._colliderEntities.push(g)}},getAllObjectsByType:function(a){for(var b=this.getAllObjects(),c=[],c=c.concat(b),b=c.length-1;0<=b;)c[b].type!=a&&c.splice(b,1),--b;return c},getAllObjects:function(){for(var a=[],b=0,c=this._tmxMap.objectGroups.length;b<c;)for(var d=b++,d=this._tmxMap.objectGroups[d],e=0,f=d.objects.length;e<f;){var g=e++;a.push(d.objects[g])}return a},getClosestObjectToPointByArray:function(a,b){for(var c=-1,d=null,e=0,f=b.length;e<f;){var g=e++,g=b[g],k=new s(g.x+
g.width/2,g.y+g.height/2),k=new s(k.x-a.x,k.y-a.y);if(-1==c||k.getLength()<c)c=k.getLength(),d=g}return d},findObjectByName:function(a){for(var b=this.getAllObjects(),c=0,d=b.length;c<d;){var e=c++,e=b[e];if(e.name==a)return e}return null},findObjectByType:function(a){for(var b=this.getAllObjects(),c=0,d=b.length;c<d;){var e=c++,e=b[e];if(e.type==a)return e}return null},getColliderEntities:function(){return this._colliderEntities},onDestroy:function(){m.prototype.onDestroy.call(this);this._tmxMap=
null},__class__:vf});var wf=function(){this.tilesets=this.layers=this.objectGroups=this.imageLayers=this.properties=null;this.width=this.height=this.tileWidth=this.tileHeight=0;this.orientation="orthogonal";this.tilesets=[];this.layers=[];this.objectGroups=[];this.imageLayers=[];this.properties=new ya};wf.__name__=["engine","tmx","TmxMap"];wf.prototype={createPixiSpriteByTileId:function(a,b,c){for(var d=this.tilesets.length,e=0;e<d;){var f=e++,f=this.tilesets[f];if(0!=f.tiles.length){var g=b;if(0!=
g){for(var g=g&536870911,k=1,h=0,l=d;h<l;){var m=h++;g>=this.tilesets[m].firstgid&&(k=this.tilesets[m].firstgid)}if(k==f.firstgid&&(g-=k,!(0>g)))return b="tmxImage"+c+f.tiles[g].image.source,I.getAsset(b),new y(a,b)}}}return null},__class__:wf};var xf=function(){this.polygon=this.polyline=null;this.x=this.y=this.rotation=this.width=this.height=0;this.name=this.type="";this.properties=new ya};xf.__name__=["engine","tmx","TmxObject"];xf.prototype={isFlippedHorizontally:function(){return this.gid&-2147483648},
isFlippedVertically:function(){return this.gid&1073741824},isFlippedDiagonally:function(){return this.gid&536870912},parsePolygon:function(a){this.polygon=new yf;a=a.split(" ");for(var b=0,c=a.length;b<c;){var d=b++,d=a[d].split(","),d=new s(parseFloat(d[0]),parseFloat(d[1]));this.polygon.points.push(d)}},parsePolyline:function(a){this.polyline=new zf;a=a.split(" ");for(var b=0,c=a.length;b<c;){var d=b++,d=a[d].split(","),d=new s(parseFloat(d[0]),parseFloat(d[1]));this.polyline.points.push(d)}},getBoolProperty:function(a,
b){null==b&&(b=!1);var c=this.properties;return(null!=N[a]?c.existsReserved(a):c.h.hasOwnProperty(a))?(c=this.properties,"true"==(null!=N[a]?c.getReserved(a):c.h[a])):b},__class__:xf};var Af=function(){this.visible=!0;this.width=this.height=0;this.name="";this.objects=[]};Af.__name__=["engine","tmx","TmxObjectGroup"];Af.prototype={__class__:Af};var yf=function(){this.points=[]};yf.__name__=["engine","tmx","TmxPolygon"];yf.prototype={__class__:yf};var zf=function(){this.points=[]};zf.__name__=["engine",
"tmx","TmxPolyline"];zf.prototype={__class__:zf};var ge=function(){};ge.__name__=["engine","tmx","TmxReader"];ge.getMapFromXmlString=function(a){var b=new wf;a=B.parse(a).elementsNamed("map").next();b.tileWidth=parseFloat(a.get("tilewidth"));b.tileHeight=parseFloat(a.get("tileheight"));b.width=parseFloat(a.get("width"));b.height=parseFloat(a.get("height"));b.orientation=a.get("orientation");for(var c=a.elementsNamed("properties");c.hasNext();)for(var d=c.next().elementsNamed("property");d.hasNext();){var e=
d.next(),f=b.properties,g=e.get("name"),e=e.get("value");null!=N[g]?f.setReserved(g,e):f.h[g]=e}for(c=a.elementsNamed("tileset");c.hasNext();)g=c.next(),d=new Bf,d.firstgid=ga.parseInt(g.get("firstgid")),d.source=g.get("source"),d.name=g.get("name"),d.tileWidth=ga.parseInt(g.get("tilewidth")),d.tileHeight=ga.parseInt(g.get("tileheight")),b.tilesets.push(d),g.elementsNamed("image").hasNext()&&(g=g.elementsNamed("image").next(),e=new $c,e.width=ga.parseInt(g.get("width")),e.height=ga.parseInt(g.get("height")),
e.source=g.get("source"),e.trans=g.get("trans"),d.images.push(e));for(c=a.elementsNamed("layer");c.hasNext();){g=c.next();d=new uf;d.name=g.get("name");d.width=parseFloat(g.get("width"));d.height=parseFloat(g.get("height"));if(g.elementsNamed("data").hasNext()){e=g.elementsNamed("data").next();if(e.nodeType!=B.Document&&e.nodeType!=B.Element)throw new K("Bad node type, expected Element or Document but found "+e.nodeType);e=e.children[0];if(e.nodeType==B.Document||e.nodeType==B.Element)throw new K("Bad node type, unexpected "+
e.nodeType);e=e.nodeValue}else e=null;d.data=e;d.decompressData();b.layers.push(d);if(g.elementsNamed("properties").hasNext())for(g=g.elementsNamed("properties").next().elementsNamed("property");g.hasNext();){var f=g.next(),k=d.properties,e=f.get("name"),f=f.get("value");null!=N[e]?k.setReserved(e,f):k.h[e]=f}}for(c=a.elementsNamed("objectgroup");c.hasNext();){g=c.next();d=new Af;d.width=parseFloat(g.get("width"));d.height=parseFloat(g.get("height"));d.visible=1==ga.parseInt(g.get("visible"));d.name=
g.get("name");for(g=g.elementsNamed("object");g.hasNext();)if(f=g.next(),e=new xf,e.name=f.get("name"),e.width=parseFloat(f.get("width")),e.height=parseFloat(f.get("height")),e.x=parseFloat(f.get("x")),e.y=parseFloat(f.get("y")),e.type=f.get("type"),e.gid=ga.parseInt(f.get("gid")),f.exists("rotation")&&(e.rotation=parseFloat(f.get("rotation"))),d.objects.push(e),f.elementsNamed("polygon").hasNext()&&e.parsePolygon(f.elementsNamed("polygon").next().get("points")),f.elementsNamed("polyline").hasNext()&&
e.parsePolyline(f.elementsNamed("polyline").next().get("points")),f.elementsNamed("properties").hasNext())for(f=f.elementsNamed("properties").next().elementsNamed("property");f.hasNext();){var h=f.next(),l=e.properties,k=h.get("name"),h=h.get("value");null!=N[k]?l.setReserved(k,h):l.h[k]=h}b.objectGroups.push(d)}for(a=a.elementsNamed("imagelayer");a.hasNext();)if(d=a.next(),!d.exists("visible")||"0"!=d.get("visible")){c=new tf;c.name=d.get("name");c.width=ga.parseInt("width");c.height=ga.parseInt("height");
g=new $c;c.image=g;g.source=d.elementsNamed("image").next().get("source");if(d.elementsNamed("properties").hasNext())for(d=d.elementsNamed("properties").next().elementsNamed("property");d.hasNext();)e=d.next(),f=c.properties,g=e.get("name"),e=e.get("value"),null!=N[g]?f.setReserved(g,e):f.h[g]=e;b.imageLayers.push(c)}return b};ge.prototype={__class__:ge};var Bf=function(){this.name="";this.tileWidth=this.tileHeight=0;this.source="";this.firstgid=0;this.images=[];this.tiles=[]};Bf.__name__=["engine",
"tmx","TmxTileset"];Bf.prototype={__class__:Bf};var he=function(a){m.call(this,a)};he.__name__=["engine","ui","KeepUiPanelCentered"];he.__super__=m;he.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._uiPanel=this.getEntity().getComponent(sc)},update:function(){m.prototype.update.call(this);if(n.isMobile()){fa.getInstance().getRenderer();fa.getInstance().getRenderer();var a=n.getInstance().getGameSize();this.getEntity().setPosition(0.5*a.x,0.5*a.y)}else a=n.getInstance().getGameSize(),
this.getEntity().setPosition(a.x/2,a.y/2)},__class__:he});var ec=function(a,b){m.call(this,a);this._size=b};ec.__name__=["engine","ui","ScaleBackgroundToWindow"];ec.__super__=m;ec.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);if(null==this._size){var a=this.getComponent(y);this._size=null!=a?new s(a.getSprite().texture.baseTexture.width,a.getSprite().texture.baseTexture.height):new s}this._uiElement=this.getComponent(V)},update:function(){m.prototype.update.call(this);var a=
new s(fa.getInstance().getStage().scale.x,fa.getInstance().getStage().scale.y),b=fa.getInstance().getRenderer().view.width/this._size.x,c=fa.getInstance().getRenderer().view.height/this._size.y,b=Math.max(b,c),b=b/a.x;null!=this._uiElement?this._uiElement.setScale(b,b):this.getEntity().setScale(b,b)},__class__:ec});var ib={__ename__:!0,__constructs__:["Left","Center","Right"],Left:["Left",0]};ib.Left.__enum__=ib;ib.Center=["Center",1];ib.Center.__enum__=ib;ib.Right=["Right",2];ib.Right.__enum__=ib;
ib.__empty_constructs__=[ib.Left,ib.Center,ib.Right];var jb={__ename__:!0,__constructs__:["Top","Center","Bottom"],Top:["Top",0]};jb.Top.__enum__=jb;jb.Center=["Center",1];jb.Center.__enum__=jb;jb.Bottom=["Bottom",2];jb.Bottom.__enum__=jb;jb.__empty_constructs__=[jb.Top,jb.Center,jb.Bottom];var V=function(a,b){this._updateEveryFrame=!0;this._positionDirty=this._pixelPerfect=!1;this._uiPanel=this._coords=this._size=this._scale=null;m.call(this,a);this.setUiPanel(b);this._coords=new s(0,0);this._scale=
new s(1,1)};V.__name__=["engine","ui","UiElement"];V.__super__=m;V.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);if(null==this._size){var a=this.getComponent(y);null!=a?this.setSize(new s(a.getSprite().width,a.getSprite().height)):this.setSize(new s(0,0))}this.updateDisplay()},getScaleRef:function(){return this._scale},getSize:function(){return this._size},getPixelPerfect:function(){return this._pixelPerfect},setPixelPerfect:function(a){this._pixelPerfect=a},setSize:function(a){null==
this._size&&(this._size=new s);this._size.x=a.x;this._size.y=a.y},getUiPanel:function(){return this._uiPanel},setScale:function(a,b){null==b&&(b=1);null==a&&(a=1);this._scale=new s(a,b);this.updateDisplay()},setUiPanel:function(a){null!=this._uiPanel&&this._uiPanel.removeEventListener("updateDisplay",w(this,this.onUiPanelUpdateDisplay));this._uiPanel=a;this._uiPanel.addEventListener("updateDisplay",w(this,this.onUiPanelUpdateDisplay));this._uiPanel.getEntity().addChild(this.getEntity())},getCoords:function(){return this._coords},
getCoordsRef:function(){return this._coords},setCoords:function(a){this._coords=a},update:function(){m.prototype.update.call(this)},postUpdate:function(){m.prototype.postUpdate.call(this);(this._positionDirty||this._updateEveryFrame)&&this.updateDisplay()},onUiPanelUpdateDisplay:function(){this._positionDirty=!0},updateDisplay:function(){z.getWindow();this._uiPanel.getSize();n.getInstance().getGameSize();this._uiPanel.getSize();n.getInstance().getGameSize();var a=this._uiPanel.getSize().x/2*this._coords.x,
b=this._uiPanel.getSize().y/2*this._coords.y;this._pixelPerfect?this.getEntity().setLocalScale(this._scale.x,this._scale.y):this.getEntity().setLocalScale(this._scale.x/this._uiPanel.getEntity().getScale().x,this._scale.y/this._uiPanel.getEntity().getScale().y);this.getEntity().setLocalPosition(a/fa.getInstance().getStage().scale.x,b/fa.getInstance().getStage().scale.y,0);this._positionDirty=!1},debugRender:function(){m.prototype.debugRender.call(this);if(null!=this._size){var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");
a.save();var b=this.getEntity().getPosition();a.beginPath();a.lineWidth=1;a.strokeStyle="#0000FF";a.moveTo(b.x-this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y-this._size.y/2);a.stroke();a.restore()}},__class__:V});var sc=function(a,b){m.call(this,a);this._size=b;this._window=z.getWindow()};sc.__name__=["engine","ui","UiPanel"];sc.__super__=
m;sc.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this.setSize(this._size)},getSize:function(){return this._size},setSize:function(a){this._size=a;this.updateDisplay()},updateDisplay:function(){this.dispatchEvent(new ad("updateDisplay"))},debugRender:function(){m.prototype.debugRender.call(this);var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();var b=this.getEntity().getPosition();a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(b.x-
this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y-this._size.y/2);a.stroke();a.restore()},__class__:sc});var ad=function(a){this._type=a};ad.__name__=["engine","ui","UiPanelEvent"];ad.__super__=P;ad.prototype=p(P.prototype,{__class__:ad});var ie=function(a,b){this._prevWidth=this._prevHeight=0;this._uiPanel=this._window=null;m.call(this,a);
this._uiPanel=b;this._window=z.getWindow()};ie.__name__=["engine","ui","UiPanelSizeToWindow"];ie.__super__=m;ie.prototype=p(m.prototype,{update:function(){m.prototype.update.call(this);var a=fa.getInstance().getRenderer().width,b=fa.getInstance().getRenderer().height;this._uiPanel.setSize(new s(a,b));this.getEntity().setLocalPosition(0.5*a,0.5*b,0);this._prevWidth=a;this._prevHeight=b},__class__:ie});var nb=function(){};nb.__name__=["engine","utilities","ArrayUtils"];nb.indexOf=function(a,b){for(var c=
0,d=a.length;c<d;){var e=c++;if(a[e]==b)return e}return-1};nb.clear=function(a){a.length=0};nb.prototype={__class__:nb};var Ea=function(){};Ea.__name__=["engine","utilities","Debug"];Ea.log=function(a){};Ea.alert=function(a){};var ka=function(){};ka.__name__=["engine","utilities","Math2"];ka.lerp=function(a,b,c){return a+(b-a)*c};ka.degToRad=function(a){return 0.0174532925*a};ka.radToDeg=function(a){return 57.2957795*a};ka.randomFloat=function(a,b){return a+Math.random()*(b-a)};ka.randomInt=function(a,
b){return Math.floor(ka.randomFloat(a,b))};ka.getClosestPointOnSegment=function(a,b,c){b=new s(b.x-a.x,b.y-a.y);c=(new s(c.x-a.x,c.y-a.y)).dotProduct(b)/b.dotProduct(b);0>c&&(c=0);1<c&&(c=1);c=new s(b.x*c,b.y*c);return new s(a.x+c.x,a.y+c.y)};ka.lineIntersect2D=function(a,b,c,d,e){var f=(b.x-a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x),g=(b.x-a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x);if(0==f||0==g)return-2;d=((a.y-c.y)*(d.x-c.x)-(a.x-c.x)*(d.y-c.y))/f;c=((a.y-c.y)*(b.x-a.x)-(a.x-c.x)*(b.y-a.y))/g;return 0<d&&1>d&&
0<c&&1>c?(c=(new s(a.x-b.x,a.y-b.y)).getLength()*d,b=new s(b.x-a.x,b.y-a.y),b.scaleBy(d,d),b=new s(a.x+b.x,a.y+b.y),e.x=b.x,e.y=b.y,c):-1};ka.clamp=function(a,b,c){return a<b?b:a>c?c:a};ka.getRotated2dVector=function(a,b){var c=ka.degToRad(b),d=Math.cos(c),c=Math.sin(c),e=new s(a.x,a.y),f=e.x*c+e.y*d;e.x=e.x*d-e.y*c;e.y=f;return e};ka.getAngleInDegreesBetween2dVectors=function(a,b){return ka.radToDeg(Math.atan2(a.x*b.y-a.y*b.x,a.dotProduct(b)))};var Rc=function(a){this._value=null;this._eventListeners=
[];this._value=a};Rc.__name__=["engine","utilities","WatchableValue"];Rc.__super__=Aa;Rc.prototype=p(Aa.prototype,{set:function(a){var b=this._value;this._value=a;this._value!=b&&this.dispatchEvent(new bd("change",this._value,b))},get:function(){return this._value},__class__:Rc});var bd=function(a,b,c){this._type=a;this.value=b;this.oldValue=c};bd.__name__=["engine","utilities","WatchableValueEvent"];bd.__super__=P;bd.prototype=p(P.prototype,{__class__:bd});var cd=function(){};cd.__name__=["game",
"EntityFactory"];cd.createCamera=function(a,b,c,d){d=d.addEntity();d.setLocalPosition(a,b,c);a=new ea(d);new pc(d,0.1);a.setZoomScale(1);a.setOffset(new s(0,-125));new sa(d);return d};cd.createHud=function(a,b){var c=a.addEntity();new dd(c,b);return c};cd.prototype={__class__:cd};var ab=function(a,b){Ia.call(this,a,b)};ab.__name__=["game","FadeTransition"];ab.doTransition=function(a,b){var c=new ab(a,b);n.getInstance().addGameState(c)};ab.doMidpointTransition=function(a,b,c){a=new ab(a,b);a.addEventListener("midpoint",
c);n.getInstance().addGameState(a)};ab.__super__=Ia;ab.prototype=p(Ia.prototype,{init:function(){var a=this;Ia.prototype.init.call(this);qa.getInstance().setInputDisabled(!0);var b=this.addEntity();b.setLocalPosition(512,384,0);this._pixiSprite=new y(b,"blackSquare");this._pixiSprite.getSprite().anchor.x=0.5;this._pixiSprite.getSprite().anchor.y=0.5;b.setLocalScale(200,200,1);this._tweener=new sa(b);this._tweener.addTween(this._pixiSprite.getSprite(),"alpha",0,1,0.2,G.linear,0,function(){a.onTransitionMidpoint()});
this._tweener.addTween(this._pixiSprite.getSprite(),"alpha",1,0,0.2,G.linear,0.25,function(){a.onTransitionComplete()})},render:function(){Ia.prototype.render.call(this);null!=this._pixiSprite&&this._pixiSprite.bringToFront()},update:function(){Ia.prototype.update.call(this);F.remove(n.getInstance().getGameStates(),this);n.getInstance().getGameStates().push(this)},onTransitionMidpoint:function(){Ia.prototype.onTransitionMidpoint.call(this);qa.getInstance().setInputDisabled(!1)},__class__:ab});var Cf=
function(){this.alwaysPlayTutorials=this.skipIntro=this.skipDrivingTutorial=this.instantDrivingGameOver=!1};Cf.__name__=["game","FlowConfig"];Cf.prototype={__class__:Cf};var Ef=function(){this.isFirstPlayThisSession=!0;this.flowConfig=new Cf;this._scoreController=new Df};Ef.__name__=["game","GameController"];Ef.prototype={get_isTutorialComplete:function(){return W.getInstance().isTutorialComplete()},set_isTutorialComplete:function(a){W.getInstance().setTutorialComplete(a);return a},get_isSortingTutorialComplete:function(){return W.getInstance().isSortingTutorialComplete()},
set_isSortingTutorialComplete:function(a){W.getInstance().setSortingTutorialComplete(a);return a},get_scoreController:function(){return this._scoreController},__class__:Ef,__properties__:{get_scoreController:"get_scoreController",set_isSortingTutorialComplete:"set_isSortingTutorialComplete",get_isSortingTutorialComplete:"get_isSortingTutorialComplete",set_isTutorialComplete:"set_isTutorialComplete",get_isTutorialComplete:"get_isTutorialComplete"}};var W=function(){this._isTutorialComplete=!1;this._currentLevelNumber=
1;this._eventListeners=[];W._instance=this;this._saveData=new mf};W.__name__=["game","GameTracker"];W.getInstance=function(){null==W._instance&&(W._instance=new W);return W._instance};W.getScoreSaveKeyForLevel=function(a){return"levelScore"+(null==a?"null":""+a)};W.__super__=Aa;W.prototype=p(Aa.prototype,{getSaveData:function(){return this._saveData},getNumLevels:function(){return ga.parseInt(R.getProperty("numLevels"))},getNumLevelsUnlocked:function(){return this.getSaveData().getItem("numLevelsUnlocked",
1)},setNumLevelsUnlocked:function(a){this.getSaveData().setItem("numLevelsUnlocked",Math.min(this.getNumLevels(),Math.max(a,this.getNumLevelsUnlocked())))},setScoreForLevel:function(a,b){a>this.getScoreForLevel(b)&&this.getSaveData().setItem(W.getScoreSaveKeyForLevel(b),a)},getScoreForLevel:function(a){return this.getSaveData().getItem(W.getScoreSaveKeyForLevel(a),0)},setScoreForCurrentLevel:function(a){this.setScoreForLevel(a,this._currentLevelNumber)},setCurrentLevelNumber:function(a){this._currentLevelNumber=
a},getCurrentLevelNumber:function(){return this._currentLevelNumber},getHasBeatenGame:function(){return this.getSaveData().getItem("hasBeatenGame",!1)},setHasBeatenGame:function(a){this.getSaveData().setItem("hasBeatenGame",a)},getHasStartedGame:function(){return this.getSaveData().getItem("hasStartedGame",!1)},setHasStartedGame:function(a){this.getSaveData().setItem("hasStartedGame",a)},getHighScore:function(){return this.getSaveData().getItem("highScore",0)},setHighScore:function(a){a<=this.getHighScore()||
this.getSaveData().setItem("highScore",a)},isTutorialComplete:function(){return this._isTutorialComplete},setTutorialComplete:function(a){this._isTutorialComplete=a},isSortingTutorialComplete:function(){return this.getSaveData().getItem("isSortingTutorialComplete",!1)},setSortingTutorialComplete:function(a){this.getSaveData().setItem("isSortingTutorialComplete",a)},__class__:W});var Ja=function(a,b,c){null==c&&(c=!0);Ia.call(this,a,b,c);this._uiPanel=Ba.createFullscreenUiPanel(this);this._pixiContainer=
this._uiPanel.getComponent(ra)};Ja.__name__=["game","WhooshTransition"];Ja.doTransition=function(a,b){var c=new Ja(a,b);n.getInstance().addGameState(c)};Ja.doMidpointTransition=function(a,b,c){a=new Ja(a,b);a.addEventListener("midpoint",c);n.getInstance().addGameState(a)};Ja.__super__=Ia;Ja.prototype=p(Ia.prototype,{init:function(){var a=this;Ia.prototype.init.call(this);this._background=this.addEntity();new ec(this._background,new s(1024,576));this._tweener=new sa(this._uiPanel.getEntity());var b=
new V(this._background,this._uiPanel);this._tweener.addTween(b.getCoordsRef(),"x",-2.75,0,0.25,G.linear,0,function(){a.onTransitionMidpoint()});this._tweener.addTween(b.getCoordsRef(),"x",0,2.75,0.25,G.linear,0.25,function(){a.onTransitionComplete()});b=this.addEntity();(new y(b,"transition")).setAnchor(0.5,0.5);b.setPosition(0,0);b.setScale(-1,1);this._background.addChild(b);r.playSoundByName("sfxTransition1")},render:function(){Ia.prototype.render.call(this);null!=this._pixiContainer&&(this.bringEntityToFront(this._pixiContainer.getEntity()),
this._pixiContainer.bringToFront())},onTransitionMidpoint:function(){Ia.prototype.onTransitionMidpoint.call(this);F.remove(n.getInstance().getGameStates(),this);n.getInstance().getGameStates().push(this)},__class__:Ja});var Ff=function(){};Ff.__name__=["game","aStar","AStarNode"];Ff.prototype={__class__:Ff};var Oa=function(){this._nodes=[]};Oa.__name__=["game","aStar","Pathfinder"];Oa.findPath=function(a,b,c,d){var e=[],f=[],g=b,k,h,l,m;g.g=0;g.h=Oa.heuristic(g,c,1);g.f=g.g+g.h;for(var n=a.length,
p;g!=c;){k=d(g);n=k.length;for(p=0;p<n;)a=k[p],a!=g&&a.traversable&&(h=g.g+1,l=Oa.heuristic(a,c,1),m=h+l,-1!=nb.indexOf(e,a)||-1!=nb.indexOf(f,a)?a.f>m&&(a.f=m,a.g=h,a.h=l,a.parentNode=g):(a.f=m,a.g=h,a.h=l,a.parentNode=g,e.push(a))),++p;f.push(g);if(0==e.length)return null;e.sort(Oa.sortOnF);g=e.shift()}return Oa.buildPath(c,b)};Oa.buildPath=function(a,b){var c=[],d=a;for(c.push(d);d!=b;)d=d.parentNode,c.unshift(d);return c};Oa.diagonalHeuristic=function(a,b,c,d){null==d&&(d=2);null==c&&(c=1);var e=
Math.abs(a.x-b.x);a=Math.abs(a.y-b.y);b=Math.min(e,a);return d*b+c*(e+a-2*b)};Oa.manhattanHeuristic=function(a,b,c){null==c&&(c=1);var d=Math.abs(a.x-b.x);a=Math.abs(a.y-b.y);return d+a*c};Oa.sortOnF=function(a,b){return a.f>b.f?1:a.f<b.f?-1:0};Oa.prototype={__class__:Oa};var zd=function(){X.call(this)};zd.__name__=["game","boot","BootState"];zd.__super__=X;zd.prototype=p(X.prototype,{init:function(){X.prototype.init.call(this);this._root=n.getInstance();var a=new $a;this._root.addManager(a);a=new qa;
this._root.addManager(a);var b=new ob;this._root.addManager(b);b=new cc;this._root.addManager(b);b=new Kb;this._root.addManager(b);a.disablePageKeyPresses();this.initLayers();this.getAssetsList()},getAssetsList:function(){var a=new Jb;a.addAsset("assetList","asset_list.js",S.Other);a.addAsset("strings","./locale/${locale}/strings.xml",S.Other);a.addAsset("globalGameConfig","game_config.js",S.Other);a.addAsset("gameConfig","./locale/${locale}/game_config.js",S.Other);a.addAsset("styleCss","./locale/${locale}/css/style.css",
S.Css);a.addAsset("speechMap","./media/xml/speech_map.xml",S.Other);a.addAsset("ipadOrientationImage","./media/images/system/orientation_ipad.png",S.Image);a.addAsset("iphoneOrientationImage","./media/images/system/orientation_iphone.png",S.Image);a.load(w(this,this.onAssetListLoaded))},onAssetListLoaded:function(){R.parseGameConfig(JSON.parse(I.getAsset("globalGameConfig")));R.parseGameConfig(JSON.parse(I.getAsset("gameConfig")));n.getInstance().setGameWidth(R.getProperty("gameWidth",1024));n.getInstance().setGameHeight(R.getProperty("gameHeight",
768));la.initStrings();Kb.getInstance().setup();if(n.isMobile()||"NONE"!=R.getProperty("forceOrientation")){var a=new je;this._root.addGameState(a);n.getInstance().onOrientationChange()}for(var a=JSON.parse(I.getAsset("assetList")),b=0,c=a.loadBatches.length;b<c;){for(var d=b++,e=new Jb,d=a.loadBatches[d],f=0,g=d.assets.length;f<g;){var k=f++,k=d.assets[k],h=k.source.split("."),l=S.Other;switch(h[h.length-1]){case "css":l=S.Css;break;case "eot":case "ttf":case "woff":l=S.Font;break;case "jpeg":case "jpg":case "png":l=
S.Image;break;case "js":l=S.Other;break;case "mp3":case "wav":l=S.Audio}e.addAsset(k.name,k.source,l)}I.registerAsset(d.name,e)}I.getAsset("loadScreenBatchPreload").load(w(this,this.onLoadScreenPreloadComplete))},onLoadScreenPreloadComplete:function(){fa.getInstance().setup({backgroundColor:0});fa.getInstance().scaleHeightToWidth=R.getProperty("scaleHeightToWidth");this._loadingScreen=new ed;this._root.addGameState(this._loadingScreen);this._root.onResizeWindow();I.getAsset("loadBatchPreload").load(w(this,
this.onPreloadComplete))},onPreloadComplete:function(){this.destroy();var a=new Ef;Ja.doTransition(this._loadingScreen,new Lb(a))},initLayers:function(){this._root.addLayer(new vb("debug",n.getInstance().getGameWidth()|0,n.getInstance().getGameHeight()|0))},__class__:zd});var Mb=function(){this._eventListeners=[]};Mb.__name__=["game","commands","Command"];Mb.__super__=Aa;Mb.prototype=p(Aa.prototype,{execute:function(){},onComplete:function(){this.dispatchEvent(new fd("complete"))},__class__:Mb});
var fd=function(a){this._type="complete"};fd.__name__=["game","commands","CommandEvent"];fd.__super__=P;fd.prototype=p(P.prototype,{__class__:fd});var tc=function(){this._shouldTrace=!1;this._eventListeners=[];this._sequence=[];this._commandsLeft=[]};tc.__name__=["game","commands","CommandSequence"];tc.__super__=Aa;tc.prototype=p(Aa.prototype,{clear:function(){for(var a=0,b=this._commandsLeft.length;a<b;){var c=a++;this._commandsLeft[c].removeEventListener("complete",w(this,this.onCommandComplete))}this._commandsLeft=
[];this._sequence=[]},addParallel:function(a){this._sequence.push(a)},addSequential:function(a){for(var b=0,c=a.length;b<c;){var d=b++;this.addCommand(a[d])}},addCommand:function(a){this._sequence.push([a])},execute:function(){this._shouldTrace&&console.log(this._sequence);0<this._commandsLeft.length&&(this._shouldTrace&&(console.log("Warning: Previous sequence never finished!"),console.log(this._commandsLeft)),this._commandsLeft=[]);this.executeNextSequence()},executeNextSequence:function(){this._shouldTrace&&
console.log("Executing Sequence...");if(0<this._sequence.length){var a=this._sequence[0];this._sequence.splice(0,1);this.executeSequence(a)}else this.dispatchEvent(new gd("complete")),this._shouldTrace&&console.log("Sequence Complete.")},executeSequence:function(a){for(var b=0,c=a.length;b<c;){var d=b++,d=a[d];this._commandsLeft.push(d);d.addEventListener("complete",w(this,this.onCommandComplete))}if(0==this._commandsLeft.length)this.executeNextSequence();else for(a=[].concat(this._commandsLeft),
b=0;b<a.length;)c=a[b],++b,this._shouldTrace&&console.log("Executing: "+Sa.getClassName(null==c?null:C.getClass(c))),c.execute()},onCommandComplete:function(a){a=a.target;this._shouldTrace&&console.log("Command Complete: "+Sa.getClassName(null==a?null:C.getClass(a)));a.removeEventListener("complete",w(this,this.onCommandComplete));F.remove(this._commandsLeft,a);if(0==this._commandsLeft.length)this.onSequenceComplete()},onSequenceComplete:function(){this._shouldTrace&&console.log("onSequenceComplete()");
this.executeNextSequence()},__class__:tc});var gd=function(a){this._type=a};gd.__name__=["game","commands","CommandSequenceEvent"];gd.__super__=P;gd.prototype=p(P.prototype,{__class__:gd});var uc=function(a,b){this._eventListeners=[];this._duration=b;this._deferredActionController=a};uc.__name__=["game","commands","DelayCommand"];uc.__super__=Mb;uc.prototype=p(Mb.prototype,{execute:function(){Mb.prototype.execute.call(this);this._deferredActionController.addDeferredAction(this._duration,w(this,this.onDelayElapse))},
onDelayElapse:function(){this.onComplete()},__class__:uc});var dd=function(a,b){m.call(this,a);this._mazeGameController=b};dd.__name__=["game","gameplay","Hud"];dd.__super__=m;dd.prototype=p(m.prototype,{get_uiPanel:function(){return this._uiPanel},getButtonGroup:function(){return this._buttonGroup},init:function(){m.prototype.init.call(this);this.construct()},construct:function(){this._uiPanel=Ba.createFullscreenUiPanel(this.getGameState());this._buttonGroup=new $b(this._uiPanel.getEntity());var a=
this._uiPanel.addEntity();(new V(a,this._uiPanel)).setCoords(new s(0,-1));(new y(a,"hudOverlay")).setAnchor(0.5,0);a=this._uiPanel.addEntity();(new V(a,this._uiPanel)).setCoords(new s(-0.810546875,-0.8645833333333334));(new y(a,"hudLivesBg")).setAnchor(0.5,0.5);var b=a.addEntity();b.setLocalPosition(-28,0);b.setName("livesTarget");b=a.addEntity();b.setLocalPosition(9,0);b=new ma(b,"",{fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",fontSize:26});b.getText().anchor.x=0;new ke(a,b,this.livesController);
b=this._uiPanel.addEntity();(new V(b,this._uiPanel)).setCoords(new s(0,-0.8541666666666666));(new y(b,"hudScoreBg")).setAnchor(0.5,0.5);var a={fontFamily:"riffic_free_mediumbold",fill:"#44FF44",fontSize:16},c=b.addEntity();c.setLocalPosition(-7,0);(new ma(c,la.getString("HUD_SCORE"),a)).getText().anchor.x=1;a.fill="#FFFFFF";a.fontSize=22;b=b.addEntity();b.setLocalPosition(-2,0);(new ma(b,"",a)).getText().anchor.x=0;new le(b,this.scoreController);a=new rb;a.deactivateButtonOnClick=!1;a.x=0.91796875;
a.y=-0.8472222222222222;a.defaultImageName="buttonPause";this._pauseButton=Ua.createButton(a,this._uiPanel.getEntity(),w(this,this.onPauseClick));b=this._uiPanel.addEntity();(new V(b,this._uiPanel)).setCoords(new s(0.78125,-0.8472222222222222));a={fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",fontSize:22};c=b.addEntity();(new ma(c,la.getString("HUD_LEVEL"),a)).getText().anchor.x=1;b=b.addEntity();b.setLocalPosition(7,0);(new ma(b,""+W.getInstance().getCurrentLevelNumber(),a)).getText().anchor.x=
0;new me(b,this._mazeGameController);a=this._uiPanel.addEntity();(new V(a,this._uiPanel)).setCoords(new s(-0.45,-0.875));(new y(a,"snackMeterBg")).setAnchor(0.5,0.5);b=a.addEntity();b.setLocalPosition(-16,3);b=new y(b,"snackMeter");b.setAnchor(0,0.5);(new ne(a,this.snackController)).meterSprite=b},onPauseClick:function(){this.dispatchEvent(new Nb(Nb.SHOW_MENU))},destroy:function(){m.prototype.destroy.call(this);null!=this._uiPanel&&this._uiPanel.getEntity().destroy()},__class__:dd,__properties__:{get_uiPanel:"get_uiPanel"}});
var Nb=function(a){this._type=a};Nb.__name__=["game","gameplay","HudEvent"];Nb.__super__=P;Nb.prototype=p(P.prototype,{__class__:Nb});var oe=function(a,b){m.call(this,a);this._levelStats=new Gf;this._gameController=b};oe.__name__=["game","gameplay","Level"];oe.__super__=m;oe.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);ob.getInstance().addEventListener("beatLevel",w(this,this.onBeatLevel));var a=this.addEntity();a.setScale(2,2);var b=new y(a,"grayBg");b.getSprite().anchor.x=
0.5;b.getSprite().anchor.y=0.5;a.setPosition(0.5*n.getInstance().getGameWidth(),0.5*n.getInstance().getGameHeight());a=Ba.createFullscreenUiPanel(this.getGameState());b=this.addEntity();(new V(b,a)).setCoords(new s(0,0));this._mazeGameController=new vc(b,this._gameController,this)},update:function(){m.prototype.update.call(this)},showLevelComplete:function(){var a=this.getGameState().getSceneRoot().addEntity();(new pe(a,this._levelStats,this._gameController)).addEventListener("destroy",w(this,this.onLevelCompleteDestroy));
this.removeDebugListeners()},onLevelCompleteDestroy:function(a){a.target.removeEventListener("destroy",w(this,this.onLevelCompleteDestroy));this.getGameState().destroy()},onLevelFailDestroy:function(a){a.target.removeEventListener("destroy",w(this,this.onLevelFailDestroy));this.getGameState().destroy()},removeDebugListeners:function(){ob.getInstance().removeEventListener("beatLevel",w(this,this.onBeatLevel))},onBeatLevel:function(a){this.showLevelComplete()},__class__:oe});var Gf=function(){this._score=
this._levelTime=0};Gf.__name__=["game","gameplay","LevelStats"];Gf.prototype={getScore:function(){return this._score},setScore:function(a){this._score=a},setLevelTime:function(a){this._levelTime=a},getLevelTime:function(){return this._levelTime},__class__:Gf};var qe=function(a){this._fruitCollected=this.fruitToCollect=0;this._eventListeners=[];this._maze=a;this._maze.addEventListener("collect",w(this,this.onCollectItem))};qe.__name__=["game","mazeGame","FruitController"];qe.__super__=Aa;qe.prototype=
p(Aa.prototype,{get_allFruitCollected:function(){return this.get_fruitCollected()>=this.fruitToCollect},get_fruitCollected:function(){return this._fruitCollected},onCollectItem:function(a){if(C.__instanceof(a.collectible,fc))this.onCollectFruit(a.collectible)},onCollectFruit:function(a){this._fruitCollected++;this.get_allFruitCollected()&&this.dispatchEvent(new wc("allFruitCollected"))},reset:function(){this._fruitCollected=0},__class__:qe,__properties__:{get_fruitCollected:"get_fruitCollected",get_allFruitCollected:"get_allFruitCollected"}});
var wc=function(a){this._type=a};wc.__name__=["game","mazeGame","FruitControllerEvent"];wc.__super__=P;wc.prototype=p(P.prototype,{__class__:wc});var Hf=function(a,b,c){this._levelNum=1;this._loadingScreen=null;this._levelNum=c;this._fromGameState=b;this._gameController=a};Hf.__name__=["game","mazeGame","LevelLoader"];Hf.prototype={loadLevel:function(){var a=I.getAsset("gameplayLoad");W.getInstance().setCurrentLevelNumber(this._levelNum);this._loadingScreen=new ed;ab.doTransition(this._fromGameState,
this._loadingScreen);var b="level"+W.getInstance().getCurrentLevelNumber()+"Load";a.concatLoadBatch(I.getAsset(b));a.load(w(this,this.onLevelLoadComplete))},onLevelLoadComplete:function(){var a=new xc(this._gameController);Ja.doTransition(this._loadingScreen,a)},__class__:Hf};var re=function(){this.numWaitingLives=0;this._numLives=3;this._eventListeners=[]};re.__name__=["game","mazeGame","LivesController"];re.__super__=Aa;re.prototype=p(Aa.prototype,{get_isOutOfLives:function(){return 0>=this.get_numLives()},
get_numLives:function(){return this._numLives},set_numLives:function(a){this._numLives=a;if(0>=this._numLives)this.onDepleteAllLives();return this._numLives},onDepleteAllLives:function(){this.dispatchEvent(new hd("outOfLives"))},__class__:re,__properties__:{set_numLives:"set_numLives",get_numLives:"get_numLives",get_isOutOfLives:"get_isOutOfLives"}});var hd=function(a){this._type=a};hd.__name__=["game","mazeGame","LivesControllerEvent"];hd.__super__=P;hd.prototype=p(P.prototype,{__class__:hd});var vc=
function(a,b,c){this.overridePlayerStart=!1;this._currentRound=1;this._fruitBlockers=[];this._villains=[];this._startPosition=new s(8,3);m.call(this,a);this._gameController=b;this._level=c;this._fruitController=new qe(this);this._livesController=new re;this._snackController=new se(this);this._livesController.addEventListener("outOfLives",w(this,this.onOutOfLives));this._mazeGameUiFactory=new If(this)};vc.__name__=["game","mazeGame","MazeGameController"];vc.__super__=m;vc.prototype=p(m.prototype,{get_hud:function(){return this._hud},
get_currentRound:function(){return this._currentRound},get_player:function(){return this._player},get_mazeGameConfig:function(){return this._mazeGameConfig},get_livesController:function(){return this._livesController},init:function(){m.prototype.init.call(this);this._scoreController=this._gameController.get_scoreController();this._scoreController.reset();this.initMazeFactory();this.initMaze();this.initHud();this._fruitController.addEventListener("allFruitCollected",w(this,this.onCollectAllFruit));
this._deferredAction=new hb(this.getEntity());this.checkStartGameplay()},checkStartGameplay:function(){var a=W.getInstance();1!=a.getCurrentLevelNumber()?this.startGameplay():a.isTutorialComplete()?this.startGameplay():(this.checkTutorial(),a.setTutorialComplete(!0))},checkTutorial:function(){var a=this;yc.show(this.getGameState(),this);this._deferredAction.addDeferredAction(0.1,function(){a.getGameState().pause()})},startGameplay:function(){if(!(0>=this._livesController.get_numLives())){var a=new tc;
a.addCommand(new te(this));a.addCommand(new ue(this));a.addCommand(new uc(this._deferredAction,0.75));a.addCommand(new ve(this));a.addCommand(new we(this));a.addCommand(new xe(this));a.execute()}},addScore:function(a){var b=this._scoreController.get_score(),c=this._scoreController;c.set_score(c.get_score()+a);a=Math.floor(b/this.get_mazeGameConfig().extraLifePoints);a=Math.floor(this._scoreController.get_score()/this.get_mazeGameConfig().extraLifePoints)-a;if(0<a)this.onGainLives(a)},onGainLives:function(a){console.log("Gained life: "+
a);var b=this._livesController;b.set_numLives(b.get_numLives()+a);a=this.get_hud().get_uiPanel().getEntity().findChildByName("livesTarget");this._mazeGameUiFactory.createExtraLifeUi(this._player.getEntity(),a)},initHud:function(){this._hud=cd.createHud(this.getGameState(),this).getComponent(dd);this._hud.fruitController=this._fruitController;this._hud.livesController=this._livesController;this._hud.snackController=this._snackController;this._hud.scoreController=this._scoreController;this._hud.addEventListener(Nb.SHOW_MENU,
w(this,this.showPauseMenu))},showPauseMenu:function(){this.getGameState().pause();zc.show(this.getGameState(),this._gameController)},initMazeFactory:function(){this._mazeGameConfig=new Jf;var a=new bb;a.maxEnemies=1;this._mazeGameConfig.roundConfigs.push(a);a=new bb;a.maxEnemies=2;this._mazeGameConfig.roundConfigs.push(a);a=new bb;a.maxEnemies=3;this._mazeGameConfig.roundConfigs.push(a);a=new bb;a.maxEnemies=3;a.speedModifier=0.05;this._mazeGameConfig.roundConfigs.push(a);a=new bb;a.maxEnemies=3;
a.speedModifier=0.1;this._mazeGameConfig.roundConfigs.push(a);a=new bb;a.maxEnemies=3;a.speedModifier=0.15;this._mazeGameConfig.roundConfigs.push(a);a=new bb;a.maxEnemies=3;a.speedModifier=0.2;this._mazeGameConfig.roundConfigs.push(a);a=new bb;a.maxEnemies=3;a.speedModifier=0.25;this._mazeGameConfig.roundConfigs.push(a);a=new bb;a.maxEnemies=3;a.speedModifier=0.3;this._mazeGameConfig.roundConfigs.push(a);a=new bb;a.maxEnemies=3;a.speedModifier=0.35;this._mazeGameConfig.roundConfigs.push(a);this._mazeFactory=
new Kf(this.getEntity(),this._mazeGameConfig)},initMaze:function(){this._tmxMap=this._mazeFactory.getRandomMazeTmxMap();var a=this._mazeFactory.getMazeReader(this._tmxMap);this._maze=this._mazeFactory.generateMaze(a,this);this._mazeConfig=this._mazeFactory.getMazeConfig();this._mazeCharacterFactory=new id(this._maze,this);this._hazardFactory=new Lf(this._maze);this._collectibleFactory=new Mf(this._maze);this.spawnMovementBlockers();this.spawnFruitBlockers();this.spawnExit();this.spawnPlayer();this.spawnVillainBarns();
this.spawnHazards();this.spawnFruitSetters();this.spawnCollectibles();this.spawnVillains();this.glowPlayer();n.isMobile()&&this.createVirtualController()},glowPlayer:function(){this._player.getEntity().getComponentsInChildren(jd)[0].glow(2)},createVirtualController:function(){null!=this._virtualController&&this._virtualController.destroy();this._virtualController=this.addEntity();new Fa(this._virtualController,new s(1E3,1E3));new kd(this._virtualController,this._player)},onCollectAllFruit:function(a){a=
this._maze.getEntity().getComponentsInChildren(Ac);for(var b=0;b<a.length;){var c=a[b];++b;c.isExit&&c.set_isExitActive(!0)}r.playSoundByName("sfx_exit_available")},spawnExit:function(){for(var a=0,b=this._tmxMap.objectGroups;a<b.length;){var c=b[a];++a;for(var d=0,c=c.objects;d<c.length;){var e=c[d];++d;"Exit"==e.type&&(e=this.getMazeCoordsFromTmxObject(e),e=this._maze.getTileNodeAt(e.x|0,e.y|0),this._mazeFactory.makeTileNodeExit(e))}}},spawnPlayer:function(){for(var a=0,b=this._tmxMap.objectGroups;a<
b.length;){var c=b[a];++a;for(var d=0,c=c.objects;d<c.length;){var e=c[d];++d;"Player"==e.type&&(e=this.getMazeCoordsFromTmxObject(e),this.overridePlayerStart&&(e=this.overridePlayerStartCoords),null==this._player&&(this._player=this._mazeCharacterFactory.createScooby(e.x|0,e.y|0),this._player.addEventListener("respawn",w(this,this.onRespawnPlayer)),this._player.addEventListener("exitLevel",w(this,this.onPlayerExitLevel)),this._player.getEntity().getComponentsInChildren(ld)[0].addEventListener("collect",
w(this,this.onCollectItem))),this._player.respawnCoords=e.getClone())}}},getMazeCoordsFromTmxObject:function(a){return new s(Math.floor((a.x+0.5*a.width)/this._mazeConfig.tileWidth),Math.floor((a.y-0.5*a.height)/this._mazeConfig.tileHeight))},onPlayerExitLevel:function(){var a;a=0<this._player.get_mazeCoords().x?M.East:M.West;this.gotoNextMaze(a,this._player.get_mazeCoords())},onRespawnPlayer:function(a){this._player.getComponent(Bc).removeAllStatusEffects();r.playSoundByName("sfx_lose_life");a.target==
this._player&&this.startGameplay()},spawnHazards:function(){for(var a=0,b=this._tmxMap.objectGroups;a<b.length;){var c=b[a];++a;for(var d=0,c=c.objects;d<c.length;){var e=c[d];++d;var f=this.getMazeCoordsFromTmxObject(e);"Hole"==e.type&&this._hazardFactory.createHole(f.x|0,f.y|0,this)}}},spawnFruitBlockers:function(){for(var a=0,b=this._tmxMap.objectGroups;a<b.length;){var c=b[a];++a;for(var d=0,c=c.objects;d<c.length;){var e=c[d];++d;if("FruitBlocker"==e.type)for(var f=this._maze.getAllTileNodes(),
g=0;g<f.length;){var k=f[g];++g;var h=k.coordsX*this._tmxMap.tileWidth,l=k.coordsY*this._tmxMap.tileHeight;h>=e.x&&(l>=e.y&&h<e.x+e.width&&l<e.y+e.height)&&(k.dontSpawnFruit=!0)}}}},spawnMovementBlockers:function(){for(var a=0,b=this._tmxMap.objectGroups;a<b.length;){var c=b[a];++a;for(var d=0,c=c.objects;d<c.length;){var e=c[d];++d;if("MovementBlocker"==e.type)for(var f=this._maze.getAllTileNodes(),g=0;g<f.length;){var k=f[g];++g;var h=k.coordsX*this._tmxMap.tileWidth,l=k.coordsY*this._tmxMap.tileHeight;
h>=e.x&&(l>=e.y&&h<e.x+e.width&&l<e.y+e.height)&&(k.traversable=!1,k.dontSpawnFruit=!0)}}}},spawnFruitSetters:function(){for(var a=0,b=this._tmxMap.objectGroups;a<b.length;){var c=b[a];++a;for(var d=0,c=c.objects;d<c.length;){var e=c[d];++d;if("FruitSetter"==e.type)for(var f=this._maze.getAllTileNodes(),g=0;g<f.length;){var k=f[g];++g;var h=k.coordsX*this._tmxMap.tileWidth,l=k.coordsY*this._tmxMap.tileHeight;if(h>=e.x&&l>=e.y&&h<e.x+e.width&&l<e.y+e.height){h=na.Cabbage;try{var m=e.properties,h=Sa.createEnum(na,
null!=N.fruitType?m.getReserved("fruitType"):m.h.fruitType,null)}catch(n){l=e.properties,console.log("Could not set fruit type to "+ga.string(null!=N.fruitType?l.getReserved("fruitType"):l.h.fruitType))}k.fruitType=h}}}}},addVillain:function(a){var b=a.movementSpeed*this._mazeFactory.getMazeRoundConfig(this._currentRound).speedModifier;a.movementSpeed+=b;this._villains.push(a)},spawnVillains:function(){for(var a=0,b=this._mazeFactory.getMazeRoundConfig(this._currentRound).maxEnemies;a<b;){var c=a++ +
1,d=this._mazeCharacterFactory.getSpawnDelayForMonsterNumber(c-1);this._villainBarn.spawnVillainInSeconds(c,d)}},spawnVillainBarns:function(){for(var a=0,b=this._tmxMap.objectGroups;a<b.length;){var c=b[a];++a;for(var d=0,c=c.objects;d<c.length;){var e=c[d];++d;if("Barn"==e.type){var f=this.getMazeCoordsFromTmxObject(e);this._villainBarn=this._mazeCharacterFactory.createVillainBarn(f.x|0,f.y|0);f=this.getMazeCoordsFromTmxObject(e);e=new s(f.x+1,f.y);f=this._maze.getTileNodeAt(f.x|0,f.y|0);e=this._maze.getTileNodeAt(e.x|
0,e.y|0);f.traversable=!1;e.traversable=!1;f.dontSpawnFruit=!0;e.dontSpawnFruit=!0}}}},spawnCollectibles:function(){for(var a=0,b=this._tmxMap.objectGroups;a<b.length;){var c=b[a];++a;for(var d=0,c=c.objects;d<c.length;){var e=c[d];++d;"ScoobySnack"==e.type&&(e=this.getMazeCoordsFromTmxObject(e),this._collectibleFactory.createScoobySnack(e.x|0,e.y|0))}}this._collectibleFactory.fillEmptySlotsWithFruit();this._fruitController.fruitToCollect=this._collectibleFactory.fruitSpawned;this.destroyFruitAtOverriddenPlayerStart()},
destroyFruitAtOverriddenPlayerStart:function(){for(var a=this._maze.getEntity().getComponentsInChildren(fc),b=0;b<a.length;){var c=a[b];++b;this.overridePlayerStart&&(c.get_mazeCoords().x==this.overridePlayerStartCoords.x&&c.get_mazeCoords().y==this.overridePlayerStartCoords.y)&&(c.getEntity().destroy(),this._fruitController.fruitToCollect--)}},onOutOfLives:function(a){this._livesController.removeEventListener("outOfLives",w(this,this.onOutOfLives));this.showLevelComplete()},showLevelComplete:function(){this._player.inputEnabled=
!1;this.disableVillainBarn();this._hud.getEntity().destroy();this._level.showLevelComplete();W.getInstance().setHighScore(this._gameController.get_scoreController().get_score())},onVillainHitPlayer:function(){var a=new tc;a.addCommand(new ye(this));a.addCommand(new uc(this._deferredAction,0.7));a.addCommand(new md(this));a.execute();r.playSoundByName("sfx_caught_1")},onPlayerFallIntoHole:function(){var a=new tc;a.addCommand(new uc(this._deferredAction,0.7));a.addCommand(new md(this));a.execute()},
freezeCharacters:function(){this.get_player().freeze(this,!0);for(var a=0,b=this._villains;a<b.length;){var c=b[a];++a;c.freeze(this,!1)}},startPlayerRespawnSequence:function(){var a=this._livesController,b=a.get_numLives();a.set_numLives(b-1);this.get_livesController().get_isOutOfLives()||this._player.respawn()},startVillainsRespawnSequence:function(){console.log("startVillainsRespawnSequence");this._villainBarn.resetSpawns();for(var a=0,b=this._villains;a<b.length;){var c=b[a];++a;c.getEntity().destroy()}this._villains=
[];this.spawnVillains()},respawnVillainFromFall:function(a){this.addScore(this._mazeGameConfig.defeatVillainScore);this.respawnVillain(a)},respawnVillain:function(a){a.respawn();var b=1,c=a.getProperty("monsterNumber")|0;F.remove(this._villains,a);b=this._mazeCharacterFactory.getSpawnDelayForMonsterNumber(c);a.getEntity().destroy();this._villainBarn.spawnVillainInSeconds(c,b)},onCollectItem:function(a){this.dispatchEvent(a);C.__instanceof(a.collectible,fc)?this.addScore(this._mazeGameConfig.collectFruitScore):
C.__instanceof(a.collectible,Cc)&&this.addScore(this._mazeGameConfig.collectScoobySnackScore)},gotoNextMaze:function(a,b){this.advanceRound();this.overridePlayerStart=!0;this.overridePlayerStartCoords=b;this.overridePlayerStartCoords.x=a==M.West?this._mazeConfig.width-1:0;this.disablePlayerDamagersOnVillains();this.panToNewMaze(a);this.refreshHud();r.playSoundByName("sfxTransition1")},disablePlayerDamagersOnVillains:function(){for(var a=0,b=this._villains;a<b.length;){var c=b[a];++a;c.getComponent(Dc).setActive(!1)}},
panToNewMaze:function(a){var b=this,c=this._maze.getEntity();this.initMaze();var d=this._maze.getEntity();this._player.inputEnabled=!1;var e=new sa(this.getEntity());a==M.East?(e.addTween(d.getPositionRef(),"x",1024,0,0.5,G.easeInOutQuad),e.addTween(c.getPositionRef(),"x",0,-1024,0.5,G.easeInOutQuad,0,function(){b.onPanToNewMaze();c.destroy()})):(e.addTween(d.getPositionRef(),"x",-1024,0,0.5,G.easeInOutQuad),e.addTween(c.getPositionRef(),"x",0,1024,0.5,G.easeInOutQuad,0,function(){b.onPanToNewMaze();
c.destroy()}))},onPanToNewMaze:function(){this._player.inputEnabled=!0;this.movePlayerToNewMaze(this.overridePlayerStartCoords)},movePlayerToNewMaze:function(a){this._maze.charactersLayer.addChild(this._player.getEntity(),!0);this._player.set_maze(this._maze);switch(this._player.direction[1]){case 2:this._player.set_mazeCoords(new s(this._maze.gridWidth,this._player.get_mazeCoords().y));this._player.getEntity().translate(this._mazeConfig.tileWidth,0);break;case 3:this._player.set_mazeCoords(new s(-1,
this._player.get_mazeCoords().y)),this._player.getEntity().translate(-this._mazeConfig.tileWidth,0)}console.log(this._player.get_mazeCoords().x+" -> "+a.x);this._player.startMovingToTile(this._maze.getTileNodeAt(a.x|0,a.y|0))},refreshHud:function(){this._hud.getEntity().destroy();this.initHud()},advanceRound:function(){this._fruitController.reset();this._currentRound++},showReadyGo:function(a){this._mazeGameUiFactory.createReadyGoUi(a)},enablePlayerInput:function(){this._player.inputEnabled=!0},disablePlayerInput:function(){this._player.inputEnabled=
!1},enableVillainBarn:function(){this._villainBarn.setActive(!0)},disableVillainBarn:function(){this._villainBarn.setActive(!1)},__class__:vc,__properties__:{get_livesController:"get_livesController",get_mazeGameConfig:"get_mazeGameConfig",get_player:"get_player",get_currentRound:"get_currentRound",get_hud:"get_hud"}});var If=function(a){this._mazeGameController=a};If.__name__=["game","mazeGame","MazeGameUiFactory"];If.prototype={createReadyGoUi:function(a){var b=Ba.createFullscreenUiPanel(this._mazeGameController.getGameState()),
c=b.addEntity(),d=c.addEntity();new V(c,b);d=new ma(d,la.getString("GO"),{fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",stroke:"#00CCCC",strokeThickness:20,fontSize:128});c=new nd(c);c.textField=d;c.addEventListener("destroy",a);return b},createExtraLifeUi:function(a,b){var c=this;this._mazeGameController.get_livesController().numWaitingLives++;var d=this._mazeGameController.getGameState().getSceneRoot().addEntity(),e=new y(d,"extraLife");e.setAnchor(0.5,0.5);var f=a.getPosition().x,g=a.getPosition().y,
k=b.getPosition().x,h=b.getPosition().y;d.setPosition(f,g);var l=new sa(d);l.addTween(d.getScaleRef(),"x",0,1,0.35,G.easeOutBack);l.addTween(d.getScaleRef(),"y",0,1,0.35,G.easeOutBack);l.addTween(d.getPositionRef(),"y",g,g-50,0.35,G.easeOutBack);l.addTween(d.getPositionRef(),"x",f,k,1.5,G.easeInQuint,0.5);l.addTween(d.getPositionRef(),"y",g-50,h,1.5,G.easeInQuint,0.5);l.addTween(d.getScaleRef(),"x",1,1.2,1.5,G.linear,0.5);l.addTween(d.getScaleRef(),"y",1,1.2,1.5,G.linear,0.5);l.addTween(e.getSprite(),
"alpha",1,0,0.1,G.linear,1.9,function(){c._mazeGameController.get_livesController().numWaitingLives--})},__class__:If};var Nf=function(){this.badgeTiers=[0,1,2,3]};Nf.__name__=["game","mazeGame","ScoreConfig"];Nf.prototype={parse:function(a){this.badgeTiers=a.badgeTiers},__class__:Nf};var Df=function(){this._score=this.numLitterCollected=0;this._config=new Nf;this._config.parse(JSON.parse(I.getAsset("scoreConfig")))};Df.__name__=["game","mazeGame","ScoreController"];Df.prototype={get_score:function(){return this._score},
set_score:function(a){return this._score=a},get_badgeTierIndex:function(){return this.getBadgeIndexFromScore(this.get_score())},get_numBadges:function(){return this._config.badgeTiers.length+1},getBadgeIndexFromScore:function(a){for(var b=this._config.badgeTiers.length,c=0;c<b;){var d=c++;if(a<this._config.badgeTiers[d])return d}return b},getScoreRequiredForBadgeIndex:function(a){return this._config.badgeTiers[a]},getHighScore:function(){return W.getInstance().getHighScore()},setHighScore:function(a){W.getInstance().setHighScore(a)},
reset:function(){this.set_score(0)},__class__:Df,__properties__:{get_numBadges:"get_numBadges",get_badgeTierIndex:"get_badgeTierIndex",set_score:"set_score",get_score:"get_score"}};var se=function(a){this._eventListeners=[];this._maze=a;this._maze.addEventListener("collect",w(this,this.onCollectItem))};se.__name__=["game","mazeGame","SnackController"];se.__super__=Aa;se.prototype=p(Aa.prototype,{onCollectItem:function(a){C.__instanceof(a.collectible,Cc)&&(this._scoobySnackStatusEffect=a.collectible.scoobySnackStatusEffect)},
getTimeLeft:function(){return null==this._scoobySnackStatusEffect?0:this._scoobySnackStatusEffect.timeLeft},getTimeLeftPercentage:function(){return null==this._scoobySnackStatusEffect?0:this._scoobySnackStatusEffect.timeLeft/this._scoobySnackStatusEffect.duration},__class__:se});var M={__ename__:!0,__constructs__:["North","South","West","East"],North:["North",0]};M.North.__enum__=M;M.South=["South",1];M.South.__enum__=M;M.West=["West",2];M.West.__enum__=M;M.East=["East",3];M.East.__enum__=M;M.__empty_constructs__=
[M.North,M.South,M.West,M.East];var Of=function(){};Of.__name__=["game","mazeGame","maze","IMazeObject"];Of.prototype={__class__:Of,__properties__:{get_tileRight:"get_tileRight",get_tileLeft:"get_tileLeft",get_tileBelow:"get_tileBelow",get_tileAbove:"get_tileAbove",get_isExitRight:"get_isExitRight",get_isExitLeft:"get_isExitLeft",get_isExitBelow:"get_isExitBelow",get_isExitAbove:"get_isExitAbove",get_isWallRight:"get_isWallRight",get_isWallLeft:"get_isWallLeft",get_isWallBelow:"get_isWallBelow",get_isWallAbove:"get_isWallAbove",
set_tileNode:"set_tileNode",get_tileNode:"get_tileNode",set_mazeCoords:"set_mazeCoords",get_mazeCoords:"get_mazeCoords",set_maze:"set_maze",get_maze:"get_maze"}};var od=function(a,b){this._type=a;this.collectible=b};od.__name__=["game","mazeGame","maze","ItemCollectEvent"];od.__super__=P;od.prototype=p(P.prototype,{__class__:od});var ze=function(a,b){this._cachedTileNodes=null;this._tileNodes=[];m.call(this,a);this.mazeGameController=b};ze.__name__=["game","mazeGame","maze","Maze"];ze.__super__=m;
ze.prototype=p(m.prototype,{getAllTileNodes:function(){if(null==this._cachedTileNodes){for(var a=[],b=0,c=this._tileNodes;b<c.length;){var d=c[b];++b;a=a.concat(d)}this._cachedTileNodes=a}return[].concat(this._cachedTileNodes)},getTileNodeAt:function(a,b){return null==this._tileNodes[b]?null:this._tileNodes[b][a]},setTileNodeAt:function(a,b,c){null==this.getTileNodeAt(a,b)&&(null==this._tileNodes[b]&&(this._tileNodes[b]=[]),this._tileNodes[b][a]=c)},getTileAbove:function(a,b){return this.getTileNodeAt(a,
b-1)},getTileBelow:function(a,b){return this.getTileNodeAt(a,b+1)},getTileLeft:function(a,b){return this.getTileNodeAt(a-1,b)},getTileRight:function(a,b){return this.getTileNodeAt(a+1,b)},isWallAbove:function(a,b){return this.getTileNodeAt(a,b).get_wallAbove()},isWallBelow:function(a,b){return this.getTileNodeAt(a,b).get_wallBelow()},isWallLeft:function(a,b){return this.getTileNodeAt(a,b).get_wallLeft()},isWallRight:function(a,b){return this.getTileNodeAt(a,b).get_wallRight()},isExitAbove:function(a,
b){return this.getTileNodeAt(a,b).get_exitAbove()},isExitBelow:function(a,b){return this.getTileNodeAt(a,b).get_exitBelow()},isExitLeft:function(a,b){return this.getTileNodeAt(a,b).get_exitLeft()},isExitRight:function(a,b){return this.getTileNodeAt(a,b).get_exitRight()},getTilePosition:function(a,b){return this.getTileNodeAt(a,b).getEntity().getPosition()},smashWallLeft:function(a){a.smashLeftWall();a=this.getTileNodeAt(a.coordsX-1,a.coordsY);null!=a&&a.smashWallRight()},smashWallRight:function(a){a.smashWallRight();
a=this.getTileNodeAt(a.coordsX+1,a.coordsY);null!=a&&a.smashLeftWall()},smashWallTop:function(a){a.smashWallTop();a=this.getTileNodeAt(a.coordsX,a.coordsY-1);null!=a&&a.smashWallBottom()},smashWallBottom:function(a){a.smashWallBottom();a=this.getTileNodeAt(a.coordsX,a.coordsY+1);null!=a&&a.smashWallTop()},canSmashLeft:function(a){return 0<a.coordsX},canSmashRight:function(a){return a.coordsX<this.gridWidth-1},canSmashTop:function(a){return 0<a.coordsY},canSmashBottom:function(a){return a.coordsY<
this.gridHeight-1},__class__:ze});var Pf=function(){this.walls=[];this.mazeNumber=1;this.wallPadding=0;this.height=7;this.width=16;this.tileWidth=this.tileHeight=54;this.setSize(16,7)};Pf.__name__=["game","mazeGame","maze","MazeConfig"];Pf.prototype={setSize:function(a,b){this.width=a;this.height=b;for(var c=0,d=b+1;c<d;){var e=c++;this.walls[e]=[];for(var e=this.walls[e],f=0,g=a+1;f<g;)f++,e.push(null)}},getWallAt:function(a,b){return this.walls[b][a]},parseTmx:function(a){this.setSize(a.width|0,
a.height|0);for(var b=0,c=a.objectGroups;b<c.length;){var d=c[b];++b;for(var e=0,d=d.objects;e<d.length;){var f=d[e];++e;if("Wall"==f.type){for(var g=[].concat(f.polyline.points),k=0;k<g.length;){var h=g[k];++k;h.x+=f.x;h.y+=f.y}this.pointsToWalls(g,a.tileWidth)}}}},pointsToWalls:function(a,b){null==b&&(b=1);for(var c=null,d=new s,e=0;e<a.length;){var f=a[e];++e;var g=Math.round(f.x/b),f=Math.round(f.y/b);new s(g,f);if(null!=c)for(var k=new s(g-d.x,f-d.y),h=Math.round(k.getLength()),l=0,m=h+1;l<m;){var n=
l++/h,p=new s(d.x+k.x*n|0,d.y+k.y*n|0),n=p.x|0,p=p.y|0,q=this.walls[p][n];null==q&&(q=new Ae(!1,!1,!1,!1),this.walls[p][n]=q);this.initWallConfigConnections(c,q,k);c=q}else c=this.walls[f|0][g|0],null==c&&(c=new Ae(!1,!1,!1,!1),this.walls[f|0][g|0]=c);d=new s(g,f)}},initWallConfigConnections:function(a,b,c){0<c.x&&(b.connectLeft=!0,a.connectRight=!0);0<c.y&&(b.connectUp=!0,a.connectDown=!0);0>c.x&&(b.connectRight=!0,a.connectLeft=!0);0>c.y&&(b.connectDown=!0,a.connectUp=!0)},__class__:Pf};var Kf=
function(a,b){this._prevMazeNumber=-1;this._mazeNumberPool=[];this.container=a;this._mazeGameConfig=b;this.initMazePool()};Kf.__name__=["game","mazeGame","maze","MazeFactory"];Kf.prototype={initMazePool:function(){for(var a=0,b=this._mazeGameConfig.numMazes;a<b;){var c=a++ +1;this._mazeNumberPool.push(c)}},getRandomMazeTmxMap:function(){0==this._mazeNumberPool.length&&this.initMazePool();for(var a;a=ka.randomInt(0,this._mazeNumberPool.length),a=this._mazeNumberPool[a],a==this._prevMazeNumber;);this._prevMazeNumber=
a;F.remove(this._mazeNumberPool,a);var b=ge.getMapFromXmlString(I.getAsset("maze"+a)),c=b.properties;null!=N.mazeNumber?c.setReserved("mazeNumber",a):c.h.mazeNumber=a;return b},getMazeReader:function(a){var b=a.properties,b=(null!=N.mazeNumber?b.getReserved("mazeNumber"):b.h.mazeNumber)|0;this._mazeConfig=new Pf;this._mazeConfig.parseTmx(a);this._mazeConfig.mazeNumber=b;return new Qf(this._mazeConfig)},getMaxMonstersForRound:function(a){return this.getMazeRoundConfig(a).maxEnemies},getMonsterSpeedModifierForRound:function(a){return this.getMazeRoundConfig(a).speedModifier},
getMazeRoundConfig:function(a){a=Math.min(a,this._mazeGameConfig.roundConfigs.length)-1|0;return this._mazeGameConfig.roundConfigs[a]},getMazeConfig:function(){return this._mazeConfig},generateMaze:function(a,b){var c=this.container.addEntity(),d=new ze(c,b);d.mazeNumber=a.get_mazeNumber();var e=a.get_mazeWidth(),f=a.get_mazeHeight();d.gridWidth=a.get_mazeGridWidth();d.gridHeight=a.get_mazeGridHeight();for(var g=0,k=a.get_mazeGridHeight();g<k;)for(var h=g++,l=0,m=a.get_mazeGridWidth();l<m;){var n=
l++,p=a.getTilePosition(n,h);p.x-=0.5*e;p.y-=0.5*f;var q=a.getTileAt(n,h),q=this.createTileNode(c,q);q.coordsX=n;q.coordsY=h;q.x=n;q.y=h;q.getEntity().setLocalPosition(p.x,p.y);d.setTileNodeAt(n,h,q)}new Be(c,d);return d},createTileNode:function(a,b){var c=a.addEntity();return new Ac(c,b)},makeTileNodeExit:function(a){a.isExit=!0},__class__:Kf};var Jf=function(){this.extraLifePoints=5E3;this.defeatVillainScore=500;this.collectScoobySnackScore=250;this.jumpHoleScore=25;this.smashFenceScore=10;this.collectFruitScore=
5;this.roundConfigs=[];this.numMazes=10};Jf.__name__=["game","mazeGame","maze","MazeGameConfig"];Jf.prototype={__class__:Jf};var pa=function(a){this._mazeCoords=new s;m.call(this,a)};pa.__name__=["game","mazeGame","maze","MazeObject"];pa.__interfaces__=[Of];pa.__super__=m;pa.prototype=p(m.prototype,{get_tileNode:function(){return this._tileNode},set_tileNode:function(a){return this._tileNode=a},get_maze:function(){return this._maze},set_maze:function(a){return this._maze=a},get_mazeCoords:function(){return this._mazeCoords},
set_mazeCoords:function(a){return this._mazeCoords=a},get_isWallAbove:function(){return this._maze.isWallAbove(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isWallBelow:function(){return this._maze.isWallBelow(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isWallLeft:function(){return this._maze.isWallLeft(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isWallRight:function(){return this._maze.isWallRight(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isTileAboveTraversable:function(){var a=this._maze.getTileAbove(this._mazeCoords.x|
0,this._mazeCoords.y|0);return null==a?!1:a.traversable},get_isTileBelowTraversable:function(){var a=this._maze.getTileBelow(this._mazeCoords.x|0,this._mazeCoords.y|0);return null==a?!1:a.traversable},get_isTileLeftTraversable:function(){var a=this._maze.getTileLeft(this._mazeCoords.x|0,this._mazeCoords.y|0);return null==a?!1:a.traversable},get_isTileRightTraversable:function(){var a=this._maze.getTileRight(this._mazeCoords.x|0,this._mazeCoords.y|0);return null==a?!1:a.traversable},attachToMaze:function(a,
b,c){this._maze=a;a=this._maze.getTileNodeAt(b,c);this.attachToTileAndSnapPosition(a)},moveToTileCoords:function(a,b){var c=this._maze.getTileNodeAt(a,b);this.attachToTileAndSnapPosition(c)},attachToTileAndSnapPosition:function(a){this.attachToTile(a);a=a.getEntity().getPosition();this.getEntity().setPosition(a.x,a.y)},removeFromTile:function(){null!=this._tileNode&&(this._tileNode.detachMazeObject(this),this._tileNode=null)},attachToTile:function(a){this._tileNode!=a&&(null!=this._tileNode&&this._tileNode.detachMazeObject(this),
this.set_mazeCoords(new s(a.coordsX,a.coordsY)),this._tileNode=a,this._tileNode.attachMazeObject(this))},get_tileAbove:function(){return this._maze.getTileAbove(this.get_mazeCoords().x|0,this.get_mazeCoords().y|0)},get_tileBelow:function(){return this._maze.getTileBelow(this.get_mazeCoords().x|0,this.get_mazeCoords().y|0)},get_tileLeft:function(){return this._maze.getTileLeft(this.get_mazeCoords().x|0,this.get_mazeCoords().y|0)},get_tileRight:function(){return this._maze.getTileRight(this.get_mazeCoords().x|
0,this.get_mazeCoords().y|0)},onOtherMazeObjectJoinTile:function(a){this.dispatchEvent(new pd("joinTile",a))},get_isExitAbove:function(){return this._maze.isExitAbove(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isExitBelow:function(){return this._maze.isExitBelow(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isExitLeft:function(){return this._maze.isExitLeft(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isExitRight:function(){return this._maze.isExitRight(this._mazeCoords.x|0,this._mazeCoords.y|
0)},__class__:pa,__properties__:{get_isExitRight:"get_isExitRight",get_isExitLeft:"get_isExitLeft",get_isExitBelow:"get_isExitBelow",get_isExitAbove:"get_isExitAbove",get_tileRight:"get_tileRight",get_tileLeft:"get_tileLeft",get_tileBelow:"get_tileBelow",get_tileAbove:"get_tileAbove",get_isTileRightTraversable:"get_isTileRightTraversable",get_isTileLeftTraversable:"get_isTileLeftTraversable",get_isTileBelowTraversable:"get_isTileBelowTraversable",get_isTileAboveTraversable:"get_isTileAboveTraversable",
get_isWallRight:"get_isWallRight",get_isWallLeft:"get_isWallLeft",get_isWallBelow:"get_isWallBelow",get_isWallAbove:"get_isWallAbove",set_mazeCoords:"set_mazeCoords",get_mazeCoords:"get_mazeCoords",set_maze:"set_maze",get_maze:"get_maze",set_tileNode:"set_tileNode",get_tileNode:"get_tileNode"}});var pd=function(a,b){this._type=a;this.mazeObject=b};pd.__name__=["game","mazeGame","maze","MazeObjectJoinTileEvent"];pd.__super__=P;pd.prototype=p(P.prototype,{__class__:pd});var Qf=function(a){this._mazeConfig=
a};Qf.__name__=["game","mazeGame","maze","MazeReader"];Qf.prototype={get_mazeNumber:function(){return this._mazeConfig.mazeNumber},get_wallPadding:function(){return this._mazeConfig.wallPadding},get_mazeGridWidth:function(){return this._mazeConfig.width},get_mazeGridHeight:function(){return this._mazeConfig.height},get_mazeWidth:function(){return this.get_mazeGridWidth()*this.get_tileWidth()+this.get_wallPadding()*this.get_mazeGridWidth()},get_mazeHeight:function(){return this.get_mazeGridHeight()*
this.get_tileHeight()+this.get_wallPadding()*this.get_mazeGridHeight()},get_tileWidth:function(){return this._mazeConfig.tileWidth},get_tileHeight:function(){return this._mazeConfig.tileHeight},getTileAt:function(a,b){var c=0==a,d=a>=this.get_mazeGridWidth()-1,e=0==b,f=b>=this.get_mazeGridHeight()-1,g=this._mazeConfig.getWallAt(a,b),k=this._mazeConfig.getWallAt(a+1,b),h=this._mazeConfig.getWallAt(a,b+1),l=this._mazeConfig.getWallAt(a+1,b+1),m=null!=g&&null!=k&&g.connectRight&&k.connectLeft,g=null!=
g&&null!=h&&g.connectDown&&h.connectUp,k=null!=k&&null!=l&&k.connectDown&&l.connectUp,h=null!=h&&null!=l&&h.connectRight&&l.connectLeft,l=new Rf;l.tileWidth=this.get_tileWidth();l.tileHeight=this.get_tileHeight();l.leftWall=g;l.upWall=m;l.rightWall=k;l.downWall=h;e&&!m&&(l.upExit=!0,l.loopCounterpartCoords=new s(a,this.get_mazeGridHeight()-1));f&&!h&&(l.downExit=!0,l.loopCounterpartCoords=new s(a,0));c&&!g&&(l.leftExit=!0,l.loopCounterpartCoords=new s(this.get_mazeGridWidth()-1,b));d&&!k&&(l.rightExit=
!0,l.loopCounterpartCoords=new s(0,b));return l},getTilePosition:function(a,b){return new O(a*(this.get_tileWidth()+this.get_wallPadding())+0.5*this.get_tileWidth()+this.get_wallPadding(),b*(this.get_tileHeight()+this.get_wallPadding())+this.get_tileHeight()+this.get_wallPadding())},__class__:Qf,__properties__:{get_tileHeight:"get_tileHeight",get_tileWidth:"get_tileWidth",get_mazeHeight:"get_mazeHeight",get_mazeWidth:"get_mazeWidth",get_mazeGridHeight:"get_mazeGridHeight",get_mazeGridWidth:"get_mazeGridWidth",
get_wallPadding:"get_wallPadding",get_mazeNumber:"get_mazeNumber"}};var bb=function(){this.speedModifier=0;this.maxEnemies=1};bb.__name__=["game","mazeGame","maze","MazeRoundConfig"];bb.prototype={__class__:bb};var Be=function(a,b){m.call(this,a);this._maze=b;this.createBackground(this.getEntity());this.createSpacesLayer(this.getEntity());this.createWallsLayer(this.getEntity());this._maze.itemsLayer=this.addEntity();this._maze.charactersLayer=this.addEntity();this._maze.frontItemsLayer=this.addEntity();
this.createMazeEdge(this._maze.frontItemsLayer)};Be.__name__=["game","mazeGame","maze","MazeVisuals"];Be.__super__=m;Be.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this)},createBackground:function(a){a=a.addEntity();(new y(a,"mazeBackground"+this._maze.mazeNumber)).setAnchor(0.5,0.5)},createMazeEdge:function(a){var b=a.addEntity();b.setLocalPosition(-460,0);(new y(b,"mazeBackgroundEdge")).setAnchor(1,0.5);a=a.addEntity();a.setLocalPosition(460,0);a.setLocalScale(-1,1);(new y(a,
"mazeBackgroundEdge")).setAnchor(1,0.5)},createSpacesLayer:function(a){a=a.addEntity();for(var b=0,c=this._maze.gridHeight;b<c;)for(var d=b++,e=0,f=this._maze.gridWidth;e<f;){var g=e++,g=[this._maze.getTileNodeAt(g,d)],k=g[0].getEntity().getPosition(),h=a.addEntity();h.setPosition(k.x,k.y);var l=!1,k=0,m=1;g[0].get_exitAbove()?(l=!0,k=0):g[0].get_exitRight()?(l=!0,k=90,m=-1):g[0].get_exitBelow()?(l=!0,k=180):g[0].get_exitLeft()&&(l=!0,k=270);if(l){l=[h.addEntity()];l[0].setVisible(!1);var n=[l[0].addEntity()],
p=new y(n[0],"exitArrow");h.setScale(1,m);p.setAnchor(0.5,0.5);l[0].setRotation2d(k);h=[null];k=function(a,b,c,d){return function(e){d[0].removeEventListener("exitActivate",a[0]);new Qa(b[0],b[0].getPositionRef(),"y",-55,5,5);c[0].setVisible(!0)}}(h,n,l,g);h[0]=k;g[0].addEventListener("exitActivate",h[0])}}return this._entity},createWallsLayer:function(a){a=a.addEntity();for(var b=0,c=this._maze.gridHeight;b<c;)for(var d=b++,e=0,f=this._maze.gridWidth;e<f;){var g=e++,g=this._maze.getTileNodeAt(g,
d),k=g.getEntity().getPosition();if(g.get_wallAbove()){var h=this.createWall(a,90);h.getEntity().setPosition(k.x,k.y-0.5*g.get_height());h.addTileNodeRelationship(g,M.North)}g.get_wallLeft()&&(h=this.createWall(a,0),h.getEntity().setPosition(k.x-0.5*g.get_width(),k.y),h.addTileNodeRelationship(g,M.West));g.get_wallRight()&&(h=this.createWall(a,0),h.getEntity().setPosition(k.x+0.5*g.get_width(),k.y),h.addTileNodeRelationship(g,M.East));g.get_wallBelow()&&(h=this.createWall(a,90),h.getEntity().setPosition(k.x,
k.y+0.5*g.get_height()),h.addTileNodeRelationship(g,M.South))}return this._entity},createWall:function(a,b){var c=a.addEntity(),d=new qd(c,this._maze.mazeGameController);c.setRotation2d(b);return d},__class__:Be});var qd=function(a,b){this._destroyed=!1;this._tileNodeRelationships=new Ec;m.call(this,a);this._mazeGameController=b};qd.__name__=["game","mazeGame","maze","MazeWall"];qd.__super__=m;qd.prototype=p(m.prototype,{addTileNodeRelationship:function(a,b){var c=new Sf;c.tileNode=a;c.direction=
b;this._tileNodeRelationships.set(a,c);a.addEventListener("wallSmash",w(this,this.onTileNodeWallSmash))},onTileNodeWallSmash:function(a){console.log("onTileNodeWallSmash()");if(!this._destroyed){var b=a.target;null!=b&&(null==this._tileNodeRelationships.h.__keys__[b.__id__]?console.log("TileNode key not in map"):this._tileNodeRelationships.h[b.__id__].direction==a.direction&&this.explode())}},explode:function(){var a=this.addEntity();(new y(a,"breakFenceOverlay")).setAnchor(0.5,0.5);var b=new sa(a);
b.addTween(a.getScaleRef(),"x",0.5,1,0.5,G.easeOutQuint);b.addTween(a.getScaleRef(),"y",0.5,1,0.5,G.easeOutQuint);this._mazeGameController.addScore(this._mazeGameController.get_mazeGameConfig().smashFenceScore);b=ka.randomFloat(-15,15);a.setLocalRotation2d(a.getLocalRotation().z+b);this._destroyed=!0;r.playSoundByName("sfx_fence_break_1")},__class__:qd});var Rf=function(){};Rf.__name__=["game","mazeGame","maze","TileConfig"];Rf.prototype={__class__:Rf};var Ac=function(a,b){this.traversable=!0;this.parentNode=
null;this.isDangerous=this.isExit=!1;this.fruitType=na.Cabbage;this.dontSpawnFruit=!1;this.coordsX=this.coordsY=0;this._isExitActive=!1;this._attachedObjects=[];m.call(this,a);this._tileConfig=b};Ac.__name__=["game","mazeGame","maze","TileNode"];Ac.__interfaces__=[Ff];Ac.__super__=m;Ac.prototype=p(m.prototype,{get_attachedObjects:function(){return this._attachedObjects},get_isEmpty:function(){return 0==this._attachedObjects.length},get_wallAbove:function(){return this._tileConfig.upWall},get_wallBelow:function(){return this._tileConfig.downWall},
get_wallLeft:function(){return this._tileConfig.leftWall},get_wallRight:function(){return this._tileConfig.rightWall},get_exitAbove:function(){return this._tileConfig.upExit},get_exitBelow:function(){return this._tileConfig.downExit},get_exitLeft:function(){return this._tileConfig.leftExit},get_exitRight:function(){return this._tileConfig.rightExit},get_width:function(){return this._tileConfig.tileWidth},get_height:function(){return this._tileConfig.tileHeight},get_loopCounterpartCoords:function(){return this._tileConfig.loopCounterpartCoords},
get_isExitActive:function(){return this._isExitActive},set_isExitActive:function(a){(this._isExitActive=a)&&this.dispatchEvent(new rd("exitActivate"));return this._isExitActive},attachMazeObject:function(a){if(!(0<=this._attachedObjects.indexOf(a))){this._attachedObjects.push(a);a.addEventListener("destroy",w(this,this.onDestroyMazeObject));for(var b=0,c=this._attachedObjects;b<c.length;){var d=c[b];++b;if(d!=a)d.onOtherMazeObjectJoinTile(a)}}},detachMazeObject:function(a){0>this._attachedObjects.indexOf(a)||
(F.remove(this._attachedObjects,a),a.removeEventListener("destroy",w(this,this.onDestroyMazeObject)))},onDestroyMazeObject:function(a){this.detachMazeObject(a.target)},getDirectionRelativeToTile:function(a){var b=this.getEntity().getPosition();a=a.getEntity().getPosition();var c=b.y<a.y,d=b.x<a.x;return b.y>a.y?M.South:c?M.North:d?M.West:M.East},smashLeftWall:function(){this._tileConfig.leftWall=!1;this.dispatchEvent(new Ob("wallSmash",M.West))},smashWallRight:function(){this._tileConfig.rightWall=
!1;this.dispatchEvent(new Ob("wallSmash",M.East))},smashWallTop:function(){this._tileConfig.upWall=!1;this.dispatchEvent(new Ob("wallSmash",M.North))},smashWallBottom:function(){this._tileConfig.downWall=!1;this.dispatchEvent(new Ob("wallSmash",M.South))},__class__:Ac,__properties__:{set_isExitActive:"set_isExitActive",get_isExitActive:"get_isExitActive",get_loopCounterpartCoords:"get_loopCounterpartCoords",get_height:"get_height",get_width:"get_width",get_exitRight:"get_exitRight",get_exitLeft:"get_exitLeft",
get_exitBelow:"get_exitBelow",get_exitAbove:"get_exitAbove",get_wallRight:"get_wallRight",get_wallLeft:"get_wallLeft",get_wallBelow:"get_wallBelow",get_wallAbove:"get_wallAbove",get_isEmpty:"get_isEmpty",get_attachedObjects:"get_attachedObjects"}});var rd=function(a){this._type=a};rd.__name__=["game","mazeGame","maze","TileNodeEvent"];rd.__super__=P;rd.prototype=p(P.prototype,{__class__:rd});var Ae=function(a,b,c,d){this.connectLeft=this.connectRight=this.connectUp=this.connectDown=!1;this.connectLeft=
a;this.connectUp=b;this.connectRight=c;this.connectDown=d};Ae.__name__=["game","mazeGame","maze","WallConfig"];Ae.prototype={__class__:Ae};var Ob=function(a,b){this._type=a;this.direction=b};Ob.__name__=["game","mazeGame","maze","WallSmashEvent"];Ob.__super__=P;Ob.prototype=p(P.prototype,{__class__:Ob});var Sf=function(){};Sf.__name__=["game","mazeGame","maze","WallToTileNodeRelation"];Sf.prototype={__class__:Sf};var Ce=function(){};Ce.__name__=["game","mazeGame","maze","collectibles","ICollectible"];
Ce.prototype={__class__:Ce};var zb=function(a){pa.call(this,a)};zb.__name__=["game","mazeGame","maze","collectibles","Collectible"];zb.__interfaces__=[Ce];zb.__super__=pa;zb.prototype=p(pa.prototype,{collect:function(a){this.getEntity().destroy()},__class__:zb});var Mf=function(a){this.fruitSpawned=0;this._maze=a};Mf.__name__=["game","mazeGame","maze","collectibles","CollectibleFactory"];Mf.prototype={fillEmptySlotsWithFruit:function(){for(var a=na.__constructs__.slice().length,a=ka.randomInt(0,a),
a=Sa.createEnumIndex(na,a,null),b=0,c=this._maze.gridHeight;b<c;)for(var d=b++,e=0,f=this._maze.gridWidth;e<f;){var g=e++,k=this._maze.getTileNodeAt(g,d);k.get_isEmpty()&&(k.dontSpawnFruit||this.createFruitByType(g,d,a))}},createRandomFruit:function(a,b){return this.createCabbage(a,b)},createFruitByType:function(a,b,c){switch(c[1]){case 0:return this.createCorn(a,b);case 1:return this.createCarrot(a,b);case 2:return this.createCabbage(a,b);case 3:return this.createEggplant(a,b);case 4:return this.createTomato(a,
b);case 5:return this.createPumpkin(a,b)}},createCabbage:function(a,b){var c=this.createFruit(a,b);c.tint=10407718;var d=c.addEntity();this.addHoverToSprite(d);(new y(d,"collectibleCabbage")).setAnchor(0.5,0.5);return c},createCarrot:function(a,b){var c=this.createFruit(a,b);c.tint=15824135;var d=c.addEntity();this.addHoverToSprite(d);(new y(d,"collectibleCarrot")).setAnchor(0.5,0.5);return c},createCorn:function(a,b){var c=this.createFruit(a,b);c.tint=16039173;var d=c.addEntity();this.addHoverToSprite(d);
(new y(d,"collectibleCorn")).setAnchor(0.5,0.5);return c},createEggplant:function(a,b){var c=this.createFruit(a,b);c.tint=8403588;var d=c.addEntity();this.addHoverToSprite(d);(new y(d,"collectibleEggplant")).setAnchor(0.5,0.5);return c},createPumpkin:function(a,b){var c=this.createFruit(a,b);c.tint=16746515;var d=c.addEntity();this.addHoverToSprite(d);(new y(d,"collectiblePumpkin")).setAnchor(0.5,0.5);return c},createTomato:function(a,b){var c=this.createFruit(a,b);c.tint=16061717;var d=c.addEntity();
this.addHoverToSprite(d);(new y(d,"collectibleTomato")).setAnchor(0.5,0.5);return c},addHoverToSprite:function(a){var b=a.getPosition().getLength();new Qa(a,a.getPositionRef(),"y",0,3,3,!1,0.01*b)},createFruit:function(a,b){var c=this._maze.itemsLayer.addEntity(),c=new fc(c);c.attachToMaze(this._maze,a,b);this.fruitSpawned++;return c},createScoobySnack:function(a,b){var c=this._maze.itemsLayer.addEntity(),d=new Cc(c);d.attachToMaze(this._maze,a,b);c=c.addEntity();(new y(c,"scoobySnack")).setAnchor(0.5,
0.5);new Qa(c,c.getScaleRef(),"x",1,0.1,6);new Qa(c,c.getScaleRef(),"y",1,0.1,6);new Qa(c,c.getRotationRef(),"z",0,15,6);return d},__class__:Mf};var fc=function(a){this.tint=16777215;pa.call(this,a)};fc.__name__=["game","mazeGame","maze","collectibles","Fruit"];fc.__super__=zb;fc.prototype=p(zb.prototype,{collect:function(a){this.playCollectFx();zb.prototype.collect.call(this,a);this.getEntity().destroy()},playCollectFx:function(){r.playSoundByName("sfxCollect1");var a=this.getEntity().getPosition(),
b=this.getEntity().getParent().addEntity();b.setScale(0.5,0.5);b.setPosition(a.x,a.y);a=new Na(b,"collectionParticle");a.getSprite().tint=this.tint;a.setOnAnimationComplete(function(){b.destroy()})},__class__:fc});var na={__ename__:!0,__constructs__:"Corn Carrot Cabbage Eggplant Tomato Pumpkin".split(" "),Corn:["Corn",0]};na.Corn.__enum__=na;na.Carrot=["Carrot",1];na.Carrot.__enum__=na;na.Cabbage=["Cabbage",2];na.Cabbage.__enum__=na;na.Eggplant=["Eggplant",3];na.Eggplant.__enum__=na;na.Tomato=["Tomato",
4];na.Tomato.__enum__=na;na.Pumpkin=["Pumpkin",5];na.Pumpkin.__enum__=na;na.__empty_constructs__=[na.Corn,na.Carrot,na.Cabbage,na.Eggplant,na.Tomato,na.Pumpkin];var Cc=function(a){pa.call(this,a)};Cc.__name__=["game","mazeGame","maze","collectibles","ScoobySnack"];Cc.__super__=zb;Cc.prototype=p(zb.prototype,{collect:function(a){var b=a.getComponent(Bc);a=a.getComponent(cb);this.scoobySnackStatusEffect=new De(b,a);b.addStatusEffect(this.scoobySnackStatusEffect);r.playSoundByName("sfx_scooby_snack_1");
this.playSnackFx();this.getEntity().destroy()},playSnackFx:function(){var a=this.getEntity().getParent().addEntity(),b=this.getEntity().getPosition().x;a.setPosition(b,this.getEntity().getPosition().y);(new Na(a,"snackEffect")).setOnAnimationComplete(function(){a.destroy()})},__class__:Cc});var Fc=function(a){pa.call(this,a)};Fc.__name__=["game","mazeGame","maze","hazards","Hazard"];Fc.__super__=pa;Fc.prototype=p(pa.prototype,{attachToTileAndSnapPosition:function(a){pa.prototype.attachToTileAndSnapPosition.call(this,
a);a.isDangerous=!0},onOtherMazeObjectJoinTile:function(a){pa.prototype.onOtherMazeObjectJoinTile.call(this,a);if(C.__instanceof(a,cb))this.onCatchCharacter(a)},onCatchCharacter:function(a){},__class__:Fc});var Lf=function(a){this._maze=a};Lf.__name__=["game","mazeGame","maze","hazards","HazardFactory"];Lf.prototype={createHole:function(a,b,c){var d=this._maze.itemsLayer.addEntity(),e=new Ee(d);e.mazeGameController=c;e.attachToMaze(this._maze,a,b);this._maze.getTileNodeAt(a,b);(new y(d,"hole")).setAnchor(0.5,
0.5);return e},__class__:Lf};var Ee=function(a){pa.call(this,a)};Ee.__name__=["game","mazeGame","maze","hazards","Hole"];Ee.__super__=Fc;Ee.prototype=p(Fc.prototype,{onCatchCharacter:function(a){var b=this;Fc.prototype.onCatchCharacter.call(this,a);a.canJumpOverHoles||(a.set_state(new Fe(a,function(){if("Player"==a.getEntity().getName())b.mazeGameController.onPlayerFallIntoHole();else b.mazeGameController.respawnVillainFromFall(a)})),this.playHoleFx())},playHoleFx:function(){var a=this.getEntity().addEntity();
(new Na(a,"holeEffect")).setOnAnimationComplete(function(){a.destroy()})},__class__:Ee});var Ge=function(a,b){this.chaseLifetime=20;this.scatterLifetime=7;m.call(this,a);this._mazeCharacter=b};Ge.__name__=["game","mazeGame","maze","mazeCharacters","AiController"];Ge.__super__=m;Ge.prototype=p(m.prototype,{get_mazeCharacter:function(){return this._mazeCharacter},get_state:function(){return this._state},set_state:function(a){if(null!=this._state)this._state.onExit();this._state=a;this._state.onEnter();
return this._state=a},update:function(){m.prototype.update.call(this);if(null!=this.get_state())this.get_state().onUpdate()},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);if(null!=this.get_state())this.get_state().onFixedUpdate()},moveInDirection:function(a){switch(a[1]){case 0:this._mazeCharacter.handleUpStay();break;case 1:this._mazeCharacter.handleDownStay();break;case 2:this._mazeCharacter.handleLeftStay();break;case 3:this._mazeCharacter.handleRightStay()}},__class__:Ge,__properties__:{set_state:"set_state",
get_state:"get_state",get_mazeCharacter:"get_mazeCharacter"}});var gc=function(a,b){this._type=a;this.tileNode=b};gc.__name__=["game","mazeGame","maze","mazeCharacters","ChangeTileEvent"];gc.__super__=P;gc.prototype=p(P.prototype,{__class__:gc});var Tf=function(){};Tf.__name__=["game","playerInput","IDirectionalInputReceiver"];Tf.prototype={__class__:Tf};var cb=function(a){this.hasMoved=!1;this.inputEnabled=!0;this.direction=M.South;this.respawnCoords=new s;this.canJumpOverHoles=this.canBreakThroughWalls=
!1;this.movementSpeed=500;pa.call(this,a);this._tweener=new sa(this.getEntity());this.audioSource=new Vc(this.getEntity(),100)};cb.__name__=["game","mazeGame","maze","mazeCharacters","MazeCharacter"];cb.__interfaces__=[Tf];cb.__super__=pa;cb.prototype=p(pa.prototype,{get_state:function(){return this._state},set_state:function(a){if(null!=this._state)this._state.onExit();this._state=a;this._state.onEnter();return a},get_velocity:function(){return this.velocityController.getVelocity()},set_velocity:function(a){this.velocityController.setVelocity(a.x,
a.y,a.z);return a},get_nodeBehind:function(){var a=null,b=this.get_mazeCoords().x|0,c=this.get_mazeCoords().y|0;switch(this.direction[1]){case 0:a=c>=this.get_maze().gridHeight-1?this.get_maze().getTileNodeAt(b,0):this.get_maze().getTileBelow(b,c);break;case 1:a=0>=c?this.get_maze().getTileNodeAt(b,this.get_maze().gridHeight-1):this.get_maze().getTileAbove(b,c);break;case 2:a=b>=this.get_maze().gridWidth-1?this.get_maze().getTileNodeAt(0,c):this.get_maze().getTileRight(b,c);break;case 3:a=0>=b?this.get_maze().getTileNodeAt(this.get_maze().gridWidth-
1,c):this.get_maze().getTileLeft(b,c)}return a},update:function(){pa.prototype.update.call(this);if(null!=this.get_state())this.get_state().onUpdate()},fixedUpdate:function(){pa.prototype.fixedUpdate.call(this);if(null!=this.get_state())this.get_state().onFixedUpdate()},handleUpStart:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleUpStart()},handleUpEnd:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleUpEnd()},handleDownStart:function(){this.inputEnabled&&
null!=this.get_state()&&this.get_state().handleDownStart()},handleDownEnd:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleDownEnd()},handleLeftStart:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleLeftStart()},handleLeftEnd:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleLeftEnd()},handleRightStart:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleRightStart()},handleRightEnd:function(){this.inputEnabled&&
null!=this.get_state()&&this.get_state().handleRightEnd()},handleUpStay:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleUpStay()},handleDownStay:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleDownStay()},handleLeftStay:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleLeftStay()},handleRightStay:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleRightStay()},attemptMoveInDirection:function(a){switch(a[1]){case 0:this.attemptMoveUp();
break;case 1:this.attemptMoveDown();break;case 2:this.attemptMoveLeft();break;case 3:this.attemptMoveRight()}},attemptMoveUp:function(){if(this.get_isWallAbove())if(this.canBreakThroughWalls&&this._maze.canSmashTop(this._tileNode))this._maze.smashWallTop(this._tileNode);else{this.gotoIdle();return}if(this.get_isExitAbove())if(this._tileNode.get_isExitActive())this.exitLevel(M.North);else{var a=this._maze.getTileNodeAt(this._tileNode.get_loopCounterpartCoords().x|0,this._tileNode.get_loopCounterpartCoords().y|
0);this.loopToTile(this._tileNode,a)}else this.get_isTileAboveTraversable()&&(a=this.get_tileAbove(),this.startMovingToTile(a))},attemptMoveDown:function(){if(this.get_isWallBelow())if(this.canBreakThroughWalls&&this._maze.canSmashBottom(this._tileNode))this._maze.smashWallBottom(this._tileNode);else{this.gotoIdle();return}if(this.get_isExitBelow())if(this._tileNode.get_isExitActive())this.exitLevel(M.South);else{var a=this._maze.getTileNodeAt(this._tileNode.get_loopCounterpartCoords().x|0,this._tileNode.get_loopCounterpartCoords().y|
0);this.loopToTile(this._tileNode,a)}else this.get_isTileBelowTraversable()&&(a=this.get_tileBelow(),this.startMovingToTile(a))},attemptMoveLeft:function(){if(this.get_isWallLeft())if(this.canBreakThroughWalls&&this._maze.canSmashLeft(this._tileNode))this._maze.smashWallLeft(this._tileNode);else{this.gotoIdle();return}if(this.get_isExitLeft())if(this._tileNode.get_isExitActive())this.exitLevel(M.West);else{var a=this._maze.getTileNodeAt(this._tileNode.get_loopCounterpartCoords().x|0,this._tileNode.get_loopCounterpartCoords().y|
0);this.loopToTile(this._tileNode,a)}else this.get_isTileLeftTraversable()&&(a=this.get_tileLeft(),this.startMovingToTile(a))},attemptMoveRight:function(){if(this.get_isWallRight())if(this.canBreakThroughWalls&&this._maze.canSmashRight(this._tileNode))this._maze.smashWallRight(this._tileNode);else{this.gotoIdle();return}if(this.get_isExitRight())if(this._tileNode.get_isExitActive())this.exitLevel(M.East);else{var a=this._maze.getTileNodeAt(this._tileNode.get_loopCounterpartCoords().x|0,this._tileNode.get_loopCounterpartCoords().y|
0);this.loopToTile(this._tileNode,a)}else this.get_isTileRightTraversable()&&(a=this.get_tileRight(),this.startMovingToTile(a))},rotateToDirection:function(a,b){null==b&&(b=!1);this._tweener.destroyAllTweens();for(var c=ka.getAngleInDegreesBetween2dVectors(new s(0,-1),a)+180,d=this.getEntity().getRotationRef().z,c=c-d;180<c;)c-=360;for(;-180>c;)c+=360;b?this.getEntity().setLocalRotation2d(d+c):this._tweener.addTween(this.getEntity().getRotationRef(),"z",d,d+c,0.25,G.easeOutQuad)},startMovingToTile:function(a){var b=
a.getDirectionRelativeToTile(this.get_tileNode());if(a.isDangerous&&this.canJumpOverHoles){var c=a.coordsX;a=a.coordsY;switch(b[1]){case 0:--a;break;case 1:++a;break;case 2:--c;break;case 3:++c}c=this._maze.getTileNodeAt(c,a);this.set_state(new sd(this,c))}else this.set_state(new td(this,a));this.direction=b;this.hasMoved=!0},gotoIdle:function(){this.set_state(new Pb(this))},freeze:function(a,b){this.set_state(new He(this,a,b))},dispatchTileChangeEvent:function(){this.dispatchEvent(new gc("changeTileStart",
this._tileNode))},dispatchTileChangeFinishEvent:function(){this.dispatchEvent(new gc("changeTileEnd",this._tileNode))},hit:function(){this.dispatchEvent(new sb("hit"))},attachToMaze:function(a,b,c){pa.prototype.attachToMaze.call(this,a,b,c);this.dispatchTileChangeEvent();this.dispatchTileChangeFinishEvent()},respawn:function(){this.moveToTileCoords(this.respawnCoords.x|0,this.respawnCoords.y|0);this.gotoIdle();this.dispatchEvent(new sb("respawn"));this.getEntity().setLocalScale(1,1);this.dispatchTileChangeEvent();
this.dispatchTileChangeFinishEvent()},loopToTile:function(a,b){var c=b.getEntity().getPosition(),d=a.getDirectionRelativeToTile(b);switch(d[1]){case 0:c.y+=b.get_height();break;case 1:c.y-=b.get_height();break;case 2:c.x+=b.get_width();break;case 3:c.x-=b.get_width()}this.getEntity().setPosition(c.x,c.y);c=new td(this,b);c.set_movementDirection(d);this.set_state(c)},setCharacterFlashing:function(a,b){null==b&&(b=10);null!=this.sprite&&(null==this._spriteSinWave&&(this._spriteSinWave=new Qa(this.sprite.getEntity(),
this.sprite.getSprite(),"alpha",1,0,b)),a?(this._spriteSinWave.setRate(b),this._spriteSinWave.setMagnitude(1)):(this._spriteSinWave.setMagnitude(0),this.sprite.getSprite().alpha=1))},exitLevel:function(a){switch(a[1]){case 0:this.rotateToDirection(new s(0,-1),!1);break;case 1:this.rotateToDirection(new s(0,1),!1);break;case 2:this.rotateToDirection(new s(-1,0),!1);break;case 3:this.rotateToDirection(new s(1,0),!1)}this.dispatchEvent(new sb("exitLevel"))},__class__:cb,__properties__:p(pa.prototype.__properties__,
{get_nodeBehind:"get_nodeBehind",set_velocity:"set_velocity",get_velocity:"get_velocity",set_state:"set_state",get_state:"get_state"})});var sb=function(a){this._type=a};sb.__name__=["game","mazeGame","maze","mazeCharacters","MazeCharacterEvent"];sb.__super__=P;sb.prototype=p(P.prototype,{__class__:sb});var id=function(a,b){this._maze=a;this._mazeGameController=b};id.__name__=["game","mazeGame","maze","mazeCharacters","MazeCharacterFactory"];id.prototype={createMazeCharacter:function(a,b){var c=this._maze.charactersLayer.addEntity(),
c=new cb(c);c.velocityController=new de(c.getEntity());c.attachToMaze(this._maze,a,b);return c},createScooby:function(a,b){var c=this.createMazeCharacter(a,b);c.getEntity().setName("Player");c.movementSpeed=250;c.respawnCoords=new s(a,b);new Ie(c.getEntity(),c);new Bc(c.getEntity());var d=c.addEntity();(new y(d,"scoobyShadow")).setAnchor(0.5,0.5);d=c.addEntity();(new y(d,"spawnBlur")).setAnchor(0.5,0.5);new jd(d);new Qa(d,d.getScaleRef(),"x",1,0.1,15,null,5);new Qa(d,d.getScaleRef(),"y",1,0.1,15,
null,5);d=c.addEntity();d=new Na(d,"scoobyWalk");c.sprite=d;new ld(c.getEntity());new Je(c.getEntity(),this._mazeGameController);c.set_state(new Pb(c));new Ma(c.getEntity());return c},createGhost:function(a,b){var c=this.createVillain(a,b),d=c.addEntity(),d=new Na(d,"ghostWalk");c.sprite=d;return c},createMonsterMan:function(a,b){var c=this.createVillain(a,b),d=c.addEntity(),d=new Na(d,"mountainManWalk");c.sprite=d;return c},createScarecrow:function(a,b){var c=this.createVillain(a,b),d=c.addEntity(),
d=new Na(d,"scarecrowWalk");c.sprite=d;return c},createVillain:function(a,b){var c=this.createMazeCharacter(a,b);c.movementSpeed=115;c.respawnCoords=new s(a,b);var d=c.addEntity();(new y(d,"villainShadow")).setAnchor(0.5,0.5);d=new Ge(c.getEntity(),c);d.set_state(new ud(d));new Dc(c.getEntity(),this._mazeGameController.get_player());c.set_state(new Pb(c));return c},createVillainBarn:function(a,b){var c=this._maze.frontItemsLayer.addEntity(),d=new vd(c,this._mazeGameController,this);d.attachToMaze(this._maze,
a,b);c=c.addEntity();(new y(c,"barn")).setAnchor(0.25,0.5);return d},getSpawnDelayForMonsterNumber:function(a){return id.MONSTER_NUMBER_SPAWN_DELAYS[a]},__class__:id};var ld=function(a){m.call(this,a)};ld.__name__=["game","mazeGame","maze","mazeCharacters","MazeCharacterItemCollector"];ld.__super__=m;ld.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._mazeCharacter=this.getComponent(cb);this._mazeCharacter.addEventListener("changeTileStart",w(this,this.onChangeTile))},onChangeTile:function(a){a=
a.tileNode.get_attachedObjects();for(var b=0;b<a.length;){var c=a[b];++b;C.__instanceof(c,Ce)&&(c.collect(this._mazeCharacter.getEntity()),this.dispatchEvent(new od("collect",c)))}},__class__:ld});var Dc=function(a,b){m.call(this,a);this._player=b};Dc.__name__=["game","mazeGame","maze","mazeCharacters","MazeCharacterPlayerDamager"];Dc.__super__=m;Dc.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._mazeCharacter=this.getComponent(cb);this._mazeCharacter.addEventListener("respawn",
w(this,this.onRespawn))},onRespawn:function(a){this.setActive(!0)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);this.checkForPlayer()},checkForPlayer:function(){!this._mazeCharacter.isActive()||35<this._player.getEntity().getPosition().subtract(this.getEntity().getPosition()).getLength()||(this._player.hit(),this.setActive(!1))},__class__:Dc});var Je=function(a,b){this.respawnCoords=new s;m.call(this,a);this._mazeGameController=b};Je.__name__=["game","mazeGame","maze","mazeCharacters",
"RespawnPlayerOnHit"];Je.__super__=m;Je.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._mazeCharacter=this.getComponent(cb);this._mazeCharacter.addEventListener("hit",w(this,this.onHit))},onHit:function(a){this._mazeGameController.onVillainHitPlayer()},__class__:Je});var jd=function(a){this._timeUntilFade=0;m.call(this,a);this._tweener=new sa(this.getEntity())};jd.__name__=["game","mazeGame","maze","mazeCharacters","SpawnGlow"];jd.__super__=m;jd.prototype=p(m.prototype,
{init:function(){m.prototype.init.call(this);null==this._pixiSprite&&(this._pixiSprite=this.getComponent(y),this._pixiSprite.getSprite().alpha=0)},update:function(){m.prototype.update.call(this);0<this._timeUntilFade&&(this._timeUntilFade-=n.getDeltaTime(),0>=this._timeUntilFade&&(this.onFadeTimeElapse(),this._timeUntilFade=0))},glow:function(a){null==this._pixiSprite&&(this._pixiSprite=this.getComponent(y));this._pixiSprite.getSprite().alpha=1;this._timeUntilFade=a},onFadeTimeElapse:function(){this._tweener.addTween(this._pixiSprite.getSprite(),
"alpha",1,0,0.5,G.linear)},__class__:jd});var vd=function(a,b,c){this._numVillainsSpawned=0;this._villainBarnSpawns=[];pa.call(this,a);this._maze=this.get_maze();this._mazeGameController=b;this._mazeCharacterFactory=c;this._alertAudioSource=new Vc(a,9999,0.5)};vd.__name__=["game","mazeGame","maze","mazeCharacters","VillainBarn"];vd.__super__=pa;vd.prototype=p(pa.prototype,{spawnVillainInSeconds:function(a,b){var c=new Uf;c.timeLeft=b;c.monsterNumber=a;this._villainBarnSpawns.push(c)},update:function(){pa.prototype.update.call(this);
for(var a=[].concat(this._villainBarnSpawns),b=0;b<a.length;){var c=a[b];++b;var d=c.timeLeft;c.timeLeft-=n.getDeltaTime();3<d&&3>=c.timeLeft&&this.showAlert();0>=c.timeLeft&&(F.remove(this._villainBarnSpawns,c),this.spawnVillain(c),this.hideAlert())}},spawnVillain:function(a){this._numVillainsSpawned++;a=a.monsterNumber;this.getEntity().getPosition();var b=this.get_mazeCoords().getClone();0.5>ka.randomFloat(0,1)||b.x++;var c=null;switch(a){case 2:c=this._mazeCharacterFactory.createMonsterMan(b.x|
0,b.y|0);break;case 3:c=this._mazeCharacterFactory.createScarecrow(b.x|0,b.y|0);break;default:c=this._mazeCharacterFactory.createGhost(b.x|0,b.y|0)}c.setProperty("monsterNumber",a);this._mazeGameController.addVillain(c)},resetSpawns:function(){this._villainBarnSpawns=[];this._numVillainsSpawned=0;this.hideAlert()},showAlert:function(){null==this._alert&&(this._alert=this.addEntity(),this._alert.setLocalPosition(27.5,-45),(new y(this._alert,"villainAlert")).setAnchor(0.5,0.5),new Qa(this._alert,this._alert.getPositionRef(),
"y",this._alert.getLocalPosition().y,5,5,!1,Math.PI),new Qa(this._alert,this._alert.getScaleRef(),"x",1,0.05,15),new Qa(this._alert,this._alert.getScaleRef(),"y",1,0.05,15,!1,Math.PI),this._alertAudioSource.play("sfx_monster_alert_1",!0))},hideAlert:function(){null!=this._alert&&(this._alert.destroy(),this._alert=null,this._alertAudioSource.setLoop(!1))},__class__:vd});var Uf=function(){this.monsterNumber=1;this.timeLeft=0};Uf.__name__=["game","mazeGame","maze","mazeCharacters","VillainBarnSpawn"];
Uf.prototype={__class__:Uf};var db=function(a){this.context=a};db.__name__="game mazeGame maze mazeCharacters aiStates AiState".split(" ");db.prototype={onEnter:function(){},onUpdate:function(){},onFixedUpdate:function(){},onExit:function(){},__class__:db};var ud=function(a){this._lifetime=0;this.context=a;this._lifetime=a.chaseLifetime};ud.__name__="game mazeGame maze mazeCharacters aiStates ChasePlayerState".split(" ");ud.__super__=db;ud.prototype=p(db.prototype,{onEnter:function(){db.prototype.onEnter.call(this)},
onUpdate:function(){db.prototype.onUpdate.call(this);if(null==this._player||this._player.isMarkedForDeletion())this._player=this.context.getEntity().getGameState().findEntityByName("Player").getComponent(cb);var a=this._player.get_maze().getAllTileNodes(),b=Oa.findPath(a,this.context.get_mazeCharacter().get_tileNode(),this._player.get_tileNode(),w(this,this.getConnectedNodes));null==b&&(b=Oa.findPath(a,this.context.get_mazeCharacter().get_tileNode(),this._player.get_tileNode(),w(this,this.getConnectedNodesLenient)));
null!=b&&1<b.length&&(a=b[1],null==this.context.get_mazeCharacter().get_tileNode().get_loopCounterpartCoords()||this.context.get_mazeCharacter().get_tileNode().get_loopCounterpartCoords().x!=a.x||this.context.get_mazeCharacter().get_tileNode().get_loopCounterpartCoords().y!=a.y?this.context.moveInDirection(a.getDirectionRelativeToTile(this.context.get_mazeCharacter().get_tileNode())):this.context.moveInDirection(this.context.get_mazeCharacter().get_tileNode().getDirectionRelativeToTile(a)));this._lifetime-=
n.getDeltaTime();if(0>=this._lifetime)this.onLifetimeElapse()},onLifetimeElapse:function(){this.context.set_state(new Ke(this.context))},getConnectedNodes:function(a){var b=this.context.get_mazeCharacter().get_maze(),c=[],d=a==this.context.get_mazeCharacter().get_tileNode();this.context.get_mazeCharacter();var e=a.x|0,f=a.y|0,g=this.context.get_mazeCharacter().get_nodeBehind();if(!d||this.context.get_mazeCharacter().hasMoved)b.isWallLeft(e,f)||c.push(b.getTileLeft(e,f)),b.isWallAbove(e,f)||c.push(b.getTileAbove(e,
f)),b.isWallRight(e,f)||c.push(b.getTileRight(e,f));b.isWallBelow(e,f)||c.push(b.getTileBelow(e,f));b.isExitBelow(e,f)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitAbove(e,f)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitLeft(e,f)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitRight(e,f)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|
0,a.get_loopCounterpartCoords().y|0));for(a=c.length-1;0<=a;){e=c[a];if(null==e)c.splice(a,1);else for(b=0,e=e.get_attachedObjects();b<e.length;)f=e[b],++b,C.__instanceof(f,cb)&&f!=this._player&&c.splice(a,1);--a}if(!this._player.canJumpOverHoles)for(a=c.length;0<=--a;)b=c[a],b.isDangerous&&F.remove(c,b);d&&F.remove(c,g);return c},getConnectedNodesLenient:function(a){var b=this.context.get_mazeCharacter().get_maze(),c=[];this.context.get_mazeCharacter().get_tileNode();this.context.get_mazeCharacter();
var d=a.x|0,e=a.y|0;b.isWallLeft(d,e)||c.push(b.getTileLeft(d,e));b.isWallAbove(d,e)||c.push(b.getTileAbove(d,e));b.isWallRight(d,e)||c.push(b.getTileRight(d,e));b.isWallBelow(d,e)||c.push(b.getTileBelow(d,e));b.isExitBelow(d,e)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitAbove(d,e)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitLeft(d,e)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|
0,a.get_loopCounterpartCoords().y|0));b.isExitRight(d,e)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));for(a=c.length-1;0<=a;)null==c[a]&&c.splice(a,1),--a;return c},__class__:ud});var Vf=function(a){this.context=a};Vf.__name__="game mazeGame maze mazeCharacters aiStates IdleAiState".split(" ");Vf.__super__=db;Vf.prototype=p(db.prototype,{__class__:Vf});var Ke=function(a){this._lifetime=0;this._movementDirection=M.North;this._timeUntilDirectionChange=
0;this._minTimeUntilDirectionChange=this._maxTimeUntilDirectionChange=0.05;this.context=a;this._lifetime=a.scatterLifetime};Ke.__name__="game mazeGame maze mazeCharacters aiStates ScatterAiState".split(" ");Ke.__super__=db;Ke.prototype=p(db.prototype,{onEnter:function(){db.prototype.onEnter.call(this);this.rollNextDirection()},onFixedUpdate:function(){db.prototype.onFixedUpdate.call(this);this.processDirectionChange();this.moveInCurrentDirection();this._lifetime-=n.getDeltaTime();if(0>=this._lifetime)this.onLifetimeElapse()},
onLifetimeElapse:function(){this.context.set_state(new ud(this.context))},moveInCurrentDirection:function(){var a=!0,b=this.context.get_mazeCharacter();switch(this._movementDirection[1]){case 0:this.shouldMoveToTile(b.get_tileAbove())||(a=!1);break;case 1:this.shouldMoveToTile(b.get_tileBelow())||(a=!1);break;case 2:this.shouldMoveToTile(b.get_tileLeft())||(a=!1);break;case 3:this.shouldMoveToTile(b.get_tileRight())||(a=!1)}if(a)this.context.moveInDirection(this._movementDirection);else if(a=this._movementDirection,
this.rollNextDirection(),this._movementDirection==a)for(;this.rollNextDirectionLenient(),this._movementDirection==a;);},turnIfStuck:function(){},shouldMoveToTile:function(a){return null==a||a.isDangerous?!1:!0},processDirectionChange:function(){this._timeUntilDirectionChange-=n.getDeltaTime();if(0>=this._timeUntilDirectionChange)this.onDirectionChangeTimeElapse()},onDirectionChangeTimeElapse:function(){this.rollNextDirection()},rollNextDirection:function(a){null==a&&(a=!1);var b=this.context.get_mazeCharacter().get_nodeBehind().getDirectionRelativeToTile(this.context.get_mazeCharacter().get_tileNode()),
c=[].concat(M.__empty_constructs__),d=this.context.get_mazeCharacter();d.get_isWallLeft()&&F.remove(c,M.West);d.get_isWallRight()&&F.remove(c,M.East);d.get_isWallBelow()&&F.remove(c,M.South);d.get_isWallAbove()&&F.remove(c,M.North);a||F.remove(c,b);a=ka.randomInt(0,c.length);this._movementDirection=c[a];this._timeUntilDirectionChange=ka.randomFloat(this._minTimeUntilDirectionChange,this._maxTimeUntilDirectionChange)},rollNextDirectionLenient:function(){this.rollNextDirection(!0)},__class__:Ke});var aa=
function(a){this.context=a};aa.__name__="game mazeGame maze mazeCharacters mazeCharacterStates MazeCharacterState".split(" ");aa.prototype={onEnter:function(){},onUpdate:function(){},onFixedUpdate:function(){},onExit:function(){},handleUpStart:function(){},handleUpStay:function(){},handleUpEnd:function(){},handleDownStart:function(){},handleDownStay:function(){},handleDownEnd:function(){},handleLeftStart:function(){},handleLeftStay:function(){},handleLeftEnd:function(){},handleRightStart:function(){},
handleRightStay:function(){},handleRightEnd:function(){},__class__:aa};var Fe=function(a,b){this._onComplete=null;this.context=a;this._onComplete=b};Fe.__name__="game mazeGame maze mazeCharacters mazeCharacterStates FallDownHole".split(" ");Fe.__super__=aa;Fe.prototype=p(aa.prototype,{onEnter:function(){aa.prototype.onEnter.call(this);this.context.velocityController.setAngularVelocity(new O(0,0,720));this._tweener=new sa(this.context.getEntity());this._tweener.addTween(this.context.getEntity().getScaleRef(),
"x",1,0,0.2,G.easeInQuad);this._tweener.addTween(this.context.getEntity().getScaleRef(),"y",1,0,0.2,G.easeInQuad);this._deferredAction=new hb(this.context.getEntity());this._deferredAction.addDeferredAction(0.35,w(this,this.onFallAnimationComplete));r.playSoundByName("sfx_hole_fall")},onExit:function(){aa.prototype.onExit.call(this);this._deferredAction.destroy();this._tweener.destroy();this._tweener=null;this.context.velocityController.setAngularVelocity(new O(0,0,0));this.context.getEntity().setScale(1,
1,1);this.context.getEntity().setRotation(0,0,0)},onFallAnimationComplete:function(){null!=this._onComplete&&this._onComplete()},__class__:Fe});var He=function(a,b,c){this.context=a;this._flashing=c;this._gameController=b};He.__name__="game mazeGame maze mazeCharacters mazeCharacterStates FreezeState".split(" ");He.__super__=aa;He.prototype=p(aa.prototype,{onEnter:function(){aa.prototype.onEnter.call(this);this.context.set_velocity(new O);var a=this.context.getEntity().getComponentsInChildren(Na)[0];
null!=a&&a.stop();this._flashing&&this.context.setCharacterFlashing(!0,40)},onExit:function(){aa.prototype.onExit.call(this);this._flashing&&this.context.setCharacterFlashing(!1,0)},__class__:He});var Pb=function(a){this.context=a};Pb.__name__="game mazeGame maze mazeCharacters mazeCharacterStates IdleState".split(" ");Pb.__super__=aa;Pb.prototype=p(aa.prototype,{onEnter:function(){aa.prototype.onEnter.call(this);this.context.set_velocity(new O);var a=this.context.getEntity().getComponentsInChildren(Na)[0];
null!=a&&a.stop()},onExit:function(){aa.prototype.onExit.call(this)},handleUpStay:function(){aa.prototype.handleUpStay.call(this);this.context.attemptMoveUp()},handleDownStay:function(){aa.prototype.handleDownStay.call(this);this.context.attemptMoveDown()},handleLeftStay:function(){aa.prototype.handleLeftStay.call(this);this.context.attemptMoveLeft()},handleRightStay:function(){aa.prototype.handleRightStay.call(this);this.context.attemptMoveRight()},__class__:Pb});var sd=function(a,b){this.context=
a;this._targetTile=b;this._movementDirection=this._targetTile.getDirectionRelativeToTile(a.get_tileNode())};sd.__name__="game mazeGame maze mazeCharacters mazeCharacterStates JumpToTileState".split(" ");sd.__super__=aa;sd.prototype=p(aa.prototype,{get_movementDirection:function(){return this._movementDirection},set_movementDirection:function(a){return this._movementDirection=a},onEnter:function(){aa.prototype.onEnter.call(this);this._tweener=this.context.getComponent(sa);this._targetPosition=this._targetTile.getEntity().getPosition();
var a=this._targetPosition.subtract(this.context.getEntity().getPosition());a.z=0;var b=a.getNormalized().getClone();b.scaleBy(this.context.movementSpeed);this.context.set_velocity(b);this._prevPosition=this.context.getEntity().getPosition();var c=this.context.getEntity().getComponentsInChildren(Na)[0];null!=c&&c.stop();this.context.rotateToDirection((new s(b.x,b.y)).getNormalized());this.context.attachToTile(this._targetTile);this.context.dispatchTileChangeEvent();a=a.getLength()/this.context.movementSpeed;
this._tweener.addTween(this.context.getEntity().getScaleRef(),"x",1,1.5,0.5*a,G.easeOutQuad);this._tweener.addTween(this.context.getEntity().getScaleRef(),"y",1,1.5,0.5*a,G.easeOutQuad);this._tweener.addTween(this.context.getEntity().getScaleRef(),"x",1.5,1,0.5*a,G.easeInQuad,0.5*a);this._tweener.addTween(this.context.getEntity().getScaleRef(),"y",1.5,1,0.5*a,G.easeInQuad,0.5*a);r.playSoundByName("sfx_jump_1")},onExit:function(){aa.prototype.onExit.call(this);this._tweener.destroyAllTweens();this.context.getEntity().setLocalScale(1,
1)},onFixedUpdate:function(){aa.prototype.onFixedUpdate.call(this);var a=this._targetPosition.subtract(this._prevPosition).getNormalized(),b=this._targetPosition.subtract(this.context.getEntity().getPosition()).getNormalized();if(0>=O.dot(b,a))this.onPassPoint();this._prevPosition=this.context.getEntity().getPosition()},onPassPoint:function(){if(this.context.get_tileNode().isDangerous){var a=this.context.get_maze().mazeGameController.get_mazeGameConfig().jumpHoleScore;this.context.get_maze().mazeGameController.addScore(a)}this.context.getEntity().setPosition(this._targetPosition.x,
this._targetPosition.y);this.context.set_velocity(new O);this.context.set_state(new Pb(this.context))},handleUpStay:function(){aa.prototype.handleUpStay.call(this);this._movementDirection=M.North},handleLeftStay:function(){aa.prototype.handleLeftStay.call(this);this._movementDirection=M.West},handleRightStay:function(){aa.prototype.handleRightStay.call(this);this._movementDirection=M.East},handleDownStay:function(){aa.prototype.handleDownStay.call(this);this._movementDirection=M.South},__class__:sd,
__properties__:{set_movementDirection:"set_movementDirection",get_movementDirection:"get_movementDirection"}});var td=function(a,b){this._useBufferedDirection=!1;this.context=a;this._targetTile=b;this._bufferedDirection=this._movementDirection=this._targetTile.getDirectionRelativeToTile(a.get_tileNode())};td.__name__="game mazeGame maze mazeCharacters mazeCharacterStates MoveToTileState".split(" ");td.__super__=aa;td.prototype=p(aa.prototype,{get_movementDirection:function(){return this._movementDirection},
set_movementDirection:function(a){return this._movementDirection=a},onEnter:function(){aa.prototype.onEnter.call(this);this._targetPosition=this._targetTile.getEntity().getPosition();var a=this._targetPosition.subtract(this.context.getEntity().getPosition());a.z=0;a=a.getNormalized().getClone();a.scaleBy(this.context.movementSpeed);this.context.set_velocity(a);this._prevPosition=this.context.getEntity().getPosition();var b=this.context.getEntity().getComponentsInChildren(Na)[0];null!=b&&b.play();
this.context.rotateToDirection((new s(a.x,a.y)).getNormalized());this.context.attachToTile(this._targetTile);this.context.dispatchTileChangeEvent()},onFixedUpdate:function(){aa.prototype.onFixedUpdate.call(this);var a=this._targetPosition.subtract(this._prevPosition).getNormalized(),b=this._targetPosition.subtract(this.context.getEntity().getPosition()).getNormalized();if(0>=O.dot(b,a))this.onPassPoint();this._prevPosition=this.context.getEntity().getPosition()},onPassPoint:function(){if(this.context.get_tileNode().isDangerous){var a=
this.context.get_maze().mazeGameController.get_mazeGameConfig().jumpHoleScore;this.context.get_maze().mazeGameController.addScore(a)}this.context.getEntity().setPosition(this._targetPosition.x,this._targetPosition.y);this.context.set_velocity(new O);this.context.set_state(new Pb(this.context));this.context.dispatchTileChangeFinishEvent();this._useBufferedDirection&&this.context.attemptMoveInDirection(this._bufferedDirection)},handleUpStay:function(){aa.prototype.handleUpStay.call(this);this._bufferedDirection=
M.North;this.updateUseBufferedDirection()},handleLeftStay:function(){aa.prototype.handleLeftStay.call(this);this._bufferedDirection=M.West;this.updateUseBufferedDirection()},handleRightStay:function(){aa.prototype.handleRightStay.call(this);this._bufferedDirection=M.East;this.updateUseBufferedDirection()},handleDownStay:function(){aa.prototype.handleDownStay.call(this);this._bufferedDirection=M.South;this.updateUseBufferedDirection()},updateUseBufferedDirection:function(){this._useBufferedDirection=
this._bufferedDirection!=this._movementDirection},__class__:td,__properties__:{set_movementDirection:"set_movementDirection",get_movementDirection:"get_movementDirection"}});var wd=function(a){this._statusEffectController=a};wd.__name__="game mazeGame maze mazeCharacters statusEffects StatusEffect".split(" ");wd.prototype={onActivate:function(){},onDeactivate:function(){},onUpdate:function(){},__class__:wd};var Qb=function(a){this.duration=this.timeLeft=8;this._statusEffectController=a};Qb.__name__=
"game mazeGame maze mazeCharacters statusEffects TimedStatusEffect".split(" ");Qb.__super__=wd;Qb.prototype=p(wd.prototype,{onUpdate:function(){wd.prototype.onUpdate.call(this);this.timeLeft-=n.getDeltaTime();if(0>=this.timeLeft)this.onTimeElapse()},onTimeElapse:function(){this._statusEffectController.removeStatusEffect(this)},reset:function(){this.timeLeft=this.duration},__class__:Qb});var De=function(a,b){Qb.call(this,a);this._target=b};De.__name__="game mazeGame maze mazeCharacters statusEffects ScoobySnackStatusEffect".split(" ");
De.__super__=Qb;De.prototype=p(Qb.prototype,{onActivate:function(){Qb.prototype.onActivate.call(this);this._target.canBreakThroughWalls=!0;this._target.canJumpOverHoles=!0;this._target.audioSource.play("sfx_scooby_snack_loop",!0);this._effect=this._target.addEntity();new Na(this._effect,"snackEffectOverlay")},onDeactivate:function(){Qb.prototype.onDeactivate.call(this);this.timeLeft=0;this._target.canBreakThroughWalls=!1;this._target.canJumpOverHoles=!1;this._target.audioSource.stop();this._effect.destroy()},
__class__:De});var Bc=function(a){this._statusEffects=[];m.call(this,a)};Bc.__name__="game mazeGame maze mazeCharacters statusEffects StatusEffectController".split(" ");Bc.__super__=m;Bc.prototype=p(m.prototype,{addStatusEffect:function(a){if(!(0<=this._statusEffects.indexOf(a))){for(var b=0,c=this._statusEffects;b<c.length;){var d=c[b];++b;C.__instanceof(a,null==d?null:C.getClass(d))&&this.removeStatusEffect(d)}this._statusEffects.push(a);a.onActivate()}},removeStatusEffect:function(a){0>this._statusEffects.indexOf(a)||
(F.remove(this._statusEffects,a),a.onDeactivate(),console.log("Deactivated:"),console.log(a))},removeAllStatusEffects:function(){for(;0<this._statusEffects.length;)this.removeStatusEffect(this._statusEffects[0])},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);for(var a=[].concat(this._statusEffects),b=0;b<a.length;){var c=a[b];++b;c.onUpdate()}},__class__:Bc});var ia=function(a){this._eventListeners=[];this._mazeGameController=a};ia.__name__=["game","mazeGame","mazeGameCommands","MazeGameCommand"];
ia.__super__=Mb;ia.prototype=p(Mb.prototype,{__class__:ia});var te=function(a){ia.call(this,a)};te.__name__=["game","mazeGame","mazeGameCommands","DisablePlayerInputCommand"];te.__super__=ia;te.prototype=p(ia.prototype,{execute:function(){ia.prototype.execute.call(this);this._mazeGameController.disablePlayerInput();this.onComplete()},__class__:te});var ue=function(a){ia.call(this,a)};ue.__name__=["game","mazeGame","mazeGameCommands","DisableVillainBarnCommand"];ue.__super__=ia;ue.prototype=p(ia.prototype,
{execute:function(){ia.prototype.execute.call(this);this._mazeGameController.disableVillainBarn();this.onComplete()},__class__:ue});var xe=function(a){ia.call(this,a)};xe.__name__=["game","mazeGame","mazeGameCommands","EnablePlayerInputCommand"];xe.__super__=ia;xe.prototype=p(ia.prototype,{execute:function(){ia.prototype.execute.call(this);this._mazeGameController.enablePlayerInput();this.onComplete()},__class__:xe});var we=function(a){ia.call(this,a)};we.__name__=["game","mazeGame","mazeGameCommands",
"EnableVillainBarnCommand"];we.__super__=ia;we.prototype=p(ia.prototype,{execute:function(){ia.prototype.execute.call(this);this._mazeGameController.enableVillainBarn();this.onComplete()},__class__:we});var ye=function(a){ia.call(this,a)};ye.__name__=["game","mazeGame","mazeGameCommands","FreezeCharactersCommand"];ye.__super__=ia;ye.prototype=p(ia.prototype,{execute:function(){ia.prototype.execute.call(this);this._mazeGameController.freezeCharacters();this.onComplete()},__class__:ye});var md=function(a){ia.call(this,
a)};md.__name__=["game","mazeGame","mazeGameCommands","RespawnCharactersCommand"];md.__super__=ia;md.prototype=p(ia.prototype,{execute:function(){ia.prototype.execute.call(this);this._mazeGameController.startPlayerRespawnSequence();this._mazeGameController.startVillainsRespawnSequence();this.onComplete()},__class__:md});var ve=function(a){ia.call(this,a)};ve.__name__=["game","mazeGame","mazeGameCommands","ShowReadyGoCommand"];ve.__super__=ia;ve.prototype=p(ia.prototype,{execute:function(){ia.prototype.execute.call(this);
this._mazeGameController.showReadyGo(w(this,this.onComplete))},__class__:ve});var Ie=function(a,b){this._upKeyDownPrev=this._downKeyDownPrev=this._leftKeyDownPrev=this._rightKeyDownPrev=!1;m.call(this,a);this._upKey=R.getProperty("keyUp");this._downKey=R.getProperty("keyDown");this._leftKey=R.getProperty("keyLeft");this._rightKey=R.getProperty("keyRight");this._inputManager=qa.getInstance();this._target=b};Ie.__name__=["game","playerInput","PlayerArrowInputController"];Ie.__super__=m;Ie.prototype=
p(m.prototype,{update:function(){m.prototype.update.call(this);this._inputManager.isKeyDown(this._downKey)&&!this._downKeyDownPrev?(this._target.handleDownStart(),this._downKeyDownPrev=!0):!this._inputManager.isKeyDown(this._downKey)&&this._downKeyDownPrev?(this._target.handleDownEnd(),this._downKeyDownPrev=!1):this._inputManager.isKeyDown(this._downKey)&&this._downKeyDownPrev&&this._target.handleDownStay();this._inputManager.isKeyDown(this._upKey)&&!this._upKeyDownPrev?(this._target.handleUpStart(),
this._upKeyDownPrev=!0):!this._inputManager.isKeyDown(this._upKey)&&this._upKeyDownPrev?(this._target.handleUpEnd(),this._upKeyDownPrev=!1):this._inputManager.isKeyDown(this._upKey)&&this._upKeyDownPrev&&this._target.handleUpStay();this._inputManager.isKeyDown(this._leftKey)&&!this._leftKeyDownPrev?(this._target.handleLeftStart(),this._leftKeyDownPrev=!0):!this._inputManager.isKeyDown(this._leftKey)&&this._leftKeyDownPrev?(this._target.handleLeftEnd(),this._leftKeyDownPrev=!1):this._inputManager.isKeyDown(this._leftKey)&&
this._leftKeyDownPrev&&this._target.handleLeftStay();this._inputManager.isKeyDown(this._rightKey)&&!this._rightKeyDownPrev?(this._target.handleRightStart(),this._rightKeyDownPrev=!0):!this._inputManager.isKeyDown(this._rightKey)&&this._rightKeyDownPrev?(this._target.handleRightEnd(),this._rightKeyDownPrev=!1):this._inputManager.isKeyDown(this._rightKey)&&this._rightKeyDownPrev&&this._target.handleRightStay()},__class__:Ie});var xc=function(a){this._level=null;X.call(this);this._gameController=a};
xc.__name__=["game","screens","GameplayScreen"];xc.__super__=X;xc.prototype=p(X.prototype,{init:function(){X.prototype.init.call(this);wa.createAnimation("scoobyWalk","scoobyWalkXml",new s(-25,-35),2);wa.createAnimation("collectionParticle","collectionParticleXml",new s(-64,-64),2,!1);wa.createAnimation("holeEffect","holeEffectXml",new s(-74,-61),1.5,!1);wa.createAnimation("snackEffect","snackEffectXml",new s(-60,-68),1.5,!1);wa.createAnimation("ghostWalk","ghostWalkXml",new s(-17,-31),2);wa.createAnimation("mountainManWalk",
"mountainManWalkXml",new s(-20,-33),2);wa.createAnimation("scarecrowWalk","scarecrowWalkXml",new s(-21,-31),2);wa.createAnimation("snackEffectOverlay","snackEffectOverlayXml",new s(-31,-68),2);var a=this.addEntity();this._level=new oe(a,this._gameController);r.playMusicByName("music_gameplay")},__class__:xc});var ed=function(){X.call(this)};ed.__name__=["game","screens","LoadingScreen"];ed.__super__=X;ed.prototype=p(X.prototype,{init:function(){X.prototype.init.call(this);var a=Ba.createFullscreenUiPanel(this);
this._background=this.addEntity();(new V(this._background,a)).setCoords(new s(0,0));var b=new y(this._background,"loadingBG");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;new ec(this._background);b=this.addEntity();(new V(b,a)).setCoords(new s(0,0));a=new y(b,"loadingBarBG");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;this._loadingBar=b.addEntity();this._loadingBar.setLocalPosition(0,0,0);a=new y(this._loadingBar,"loadingBar");a.setAnchor(0.5,0.5);this._fillMask=new PIXI.Graphics;
a.getSprite().mask=this._fillMask;a.getSprite().addChild(this._fillMask);a=this.addEntity();a.setPosition(-9E3,-9E3);new ma(a,"x",{fontFamily:"riffic_free_mediumbold"})},onFileLoaded:function(a,b){if(null!=this._loadingBar){var c=a/b;1<c&&(c=1);this.updateLoadingMeter(c)}},updateLoadingMeter:function(a){this._fillMask.clear();this._fillMask.beginFill();this._fillMask.drawRect(-200,200-300*a,400,300);this._fillMask.endFill()},handleMessage:function(a,b){X.prototype.handleMessage.call(this,a,b);if("onFileLoaded"==
a)this.onFileLoaded(b.progress,b.total)},__class__:ed});var zc=function(a,b){X.call(this);this._parentState=a;this._gameController=b;this._pauseMenu=Gc.show(this.getSceneRoot());this._pauseMenu.addEventListener("resume",w(this,this.onPauseMenuResume));this._pauseMenu.addEventListener("quit",w(this,this.onPauseMenuQuit))};zc.__name__=["game","screens","MenusState"];zc.show=function(a,b){var c=new zc(a,b);n.getInstance().addGameState(c)};zc.__super__=X;zc.prototype=p(X.prototype,{onPauseMenuQuit:function(a){this.destroy();
Ja.doTransition(this._parentState,new Lb(this._gameController))},onPauseMenuResume:function(a){var b=this;this._pauseMenu.dismiss();this._pauseMenu.addEventListener("dismissComplete",function(){b._parentState.resume();n.getInstance().removeGameState(b)})},__class__:zc});var je=function(){this._orientationEntity=this._div=this._image=null;X.call(this)};je.__name__=["game","screens","OrientationState"];je.__super__=X;je.prototype=p(X.prototype,{init:function(){X.prototype.init.call(this)},onOrientationChanged:function(a){n.isMobile()&&
!n.isPhone()?a&&0==R.getProperty("isLandscapeAllowedIPad")?this.showOrientationScreen(1):a||0!=R.getProperty("isPortraitAllowedIPad")?this.hideOrientationScreen():this.showOrientationScreen(0):n.isMobile()&&(a&&0==R.getProperty("isLandscapeAllowedIPhone")?this.showOrientationScreen(1):a||0!=R.getProperty("isPortraitAllowedIPhone")?this.hideOrientationScreen():this.showOrientationScreen(0))},showOrientationScreen:function(a){this.hideOrientationScreen(!1);n.getInstance().addGameState(this);n.getInstance().stopUpdates();
qa.getInstance().setInputDisabled(!0);r.pauseAllSounds();this._div=z.getDocument().createElement("div");this._div.style.position="fixed";this._div.style.backgroundColor="#000000";this._div.style.width="100%";this._div.style.height="100%";z.getContainer().appendChild(this._div);switch(a){case 0:this._orientationEntity=this.addEntity();this._image=I.getAsset(n.isPhone()?"iphoneOrientationImage":"ipadOrientationImage");this._div.appendChild(this._image);this._image.style.position="fixed";this._image.style.margin=
"auto auto auto auto";this._image.style.display="block";this._image.style.maxWidth="100%";this._image.style.maxHeight="auto";this._image.style.top="0px";this._image.style.bottom="0px";this._image.style.left="0px";this._image.style.right="0px";break;case 1:this._orientationEntity=this.addEntity(),this._image=I.getAsset(n.isPhone()?"iphoneOrientationImage":"ipadOrientationImage"),this._div.appendChild(this._image),this._image.style.position="fixed",this._image.style.margin="auto auto auto auto",this._image.style.display=
"block",this._image.style.maxWidth="100%",this._image.style.maxHeight="auto",this._image.style.top="0px",this._image.style.bottom="0px",this._image.style.left="0px",this._image.style.right="0px"}},update:function(){X.prototype.update.call(this)},hideOrientationScreen:function(a){null==a&&(a=!0);null!=this._div&&(this._div.parentNode.removeChild(this._div),this._div=null);a&&(n.getInstance().resumeUpdates(),qa.getInstance().setInputDisabled(!1),r.resumeAllSounds(),n.getInstance().hideAddressBar(),
n.getInstance().onScreenScaleUpdated())},handleMessage:function(a,b){X.prototype.handleMessage.call(this,a,b);if("onOrientationChanged"==a)this.onOrientationChanged(b.isHorizontal)},__class__:je});var Lb=function(a){this._shouldShowHighScore=!0;X.call(this);this._gameController=a};Lb.__name__=["game","screens","TitleScreen"];Lb.__super__=X;Lb.prototype=p(X.prototype,{init:function(){X.prototype.init.call(this);this.createMenuScreen();r.playMusicByName("music_menus")},createMenuScreen:function(){var a=
Ba.createFullscreenUiPanel(this);this._buttonGroup=new $b(a.getEntity());var b=new Rb(a);b.createSplashBackground();b.createImage(0.62890625,-0.2951388888888889,"splashLogo");b.createImage(-0.84,-0.75,"environmentLogo");b.createPlayButton(0.736328125,0.6631944444444444,w(this,this.onPlayButtonClicked));if(this._shouldShowHighScore){var c=this.addEntity();(new V(c,a)).setCoords(new s(-0.7,0.8));(new y(c,"scoreContainer")).setAnchor(0.5,0.5);a=W.getInstance().getHighScore();b.createCurrentBadgeLocal(c,
-68,5,a,this._gameController.get_scoreController()).setScale(0.45,0.45);var b=c.addEntity(),d=la.getString("BADGE_"+(this._gameController.get_scoreController().getBadgeIndexFromScore(a)+1));new ma(b,d,{fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",fontSize:14});b.setLocalPosition(-68,-25);b=c.addEntity();new ma(b,la.getString("LEVEL_COMPLETE_HIGH_SCORE_LABEL"),{fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A",fontSize:14});b.setLocalPosition(55,-22);c=c.addEntity();new ma(c,null==a?"null":
""+a,{fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",fontSize:34});c.setLocalPosition(55,7)}},update:function(){X.prototype.update.call(this)},onPlayButtonClicked:function(){if(W.getInstance().isTutorialComplete())this.onStartGame();else W.getInstance().setHasStartedGame(!0),this.onStoryPage()},onStoryPage:function(){var a=this.addEntity();new Le(a,this)},onStartGame:function(){(new Hf(this._gameController,this,1)).loadLevel()},onLevelSelect:function(){Ja.doTransition(this,new Lb(this._gameController))},
onResetGameYes:function(){W.getInstance().getSaveData().deleteAllSaveData();W.getInstance().setHasStartedGame(!1);Ja.doTransition(this,new Lb(this._gameController));this._buttonGroup.setInputEnabled(!0)},onResetGameNo:function(){this._buttonGroup.setInputEnabled(!0)},__class__:Lb});var yc=function(a,b){X.call(this);this._parentState=a;this._gameController=b;this._helpScreen=Sb.show(this.getSceneRoot(),!0);this._helpScreen.addEventListener("resume",w(this,this.onTutorialResume))};yc.__name__=["game",
"screens","TutorialState"];yc.show=function(a,b){var c=new yc(a,b);n.getInstance().addGameState(c)};yc.__super__=X;yc.prototype=p(X.prototype,{onTutorialResume:function(a){var b=this;this._helpScreen.dismiss();this._helpScreen.addEventListener("dismissComplete",function(){b._parentState.resume();b._gameController.startGameplay();n.getInstance().removeGameState(b)})},__class__:yc});var hc=function(a){m.call(this,a)};hc.__name__=["game","ui","TextFieldController"];hc.__super__=m;hc.prototype=p(m.prototype,
{init:function(){m.prototype.init.call(this);this._pixiText=this.getComponent(ma)},update:function(){m.prototype.update.call(this);this._pixiText.setTextString(this.getText())},getText:function(){throw new K("Not implemented.");},__class__:hc});var le=function(a,b){m.call(this,a);this._scoreController=b};le.__name__=["game","ui","FruitText"];le.__super__=hc;le.prototype=p(hc.prototype,{getText:function(){return ga.string(this._scoreController.get_score())},__class__:le});var Me=function(a,b){this._isCountingUp=
!1;this._countdownDelay=0.5;this._maxScoreCountDuration=2.5;this._scoreCountSpeed=2E3;this._currentScore=this._targetScore=0;m.call(this,a);this._deferredAction=new hb(this.getEntity());this._tweener=new sa(this.getEntity());this._scoreController=b;var c=this._scoreController.get_numBadges()-2;this._meterMaxScore=this._scoreController.getScoreRequiredForBadgeIndex(c);this._targetScore=this._scoreController.get_score();this._targetScore/this._scoreCountSpeed>this._maxScoreCountDuration&&(this._scoreCountSpeed=
this._targetScore/this._maxScoreCountDuration);this._meterMask=new PIXI.Graphics};Me.__name__=["game","ui","LevelCompleteBadgeContainer"];Me.__super__=m;Me.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this.badgeIcon.setScale(0,0);this.badgeText.setScale(0,0);this._deferredAction.addDeferredAction(this._countdownDelay,w(this,this.onDelayElapse));this.meterFillSprite.getSprite().addChild(this._meterMask);this.meterFillSprite.getSprite().mask=this._meterMask},onDelayElapse:function(){this._isCountingUp=
!0;this._countingLoop=r.playSoundByName("sfxScoreCountLoop1",!1,!0)},update:function(){m.prototype.update.call(this);var a=Math.min(1,this._currentScore/this._meterMaxScore);if(this._isCountingUp){this._currentScore+=this._scoreCountSpeed*n.getDeltaTime();var b=Math.round(this._currentScore);b>=this._targetScore&&(b=this._currentScore=this._targetScore,this.onReachTargetScore());this.scoreText.setTextString(null==b?"null":""+b)}this._meterMask.clear();this._meterMask.beginFill(16711935);this._meterMask.drawRect(0,
0,this.meterFillSprite.get_width()*a,this.meterFillSprite.get_height());this._meterMask.endFill()},onReachTargetScore:function(){this._isCountingUp=!1;this._tweener.addTween(this.badgeIcon.getScaleRef(),"x",0,1,0.25,G.easeOutBack);this._tweener.addTween(this.badgeIcon.getScaleRef(),"y",0,1,0.25,G.easeOutBack);this._tweener.addTween(this.badgeText.getScaleRef(),"x",0,1,0.25,G.easeOutBack);this._tweener.addTween(this.badgeText.getScaleRef(),"y",0,1,0.25,G.easeOutBack);null!=this._countingLoop&&(this._countingLoop.stop(),
this._countingLoop=null);var a=this._scoreController.getBadgeIndexFromScore(this._targetScore);r.playSoundByName(["sfxScoreCountEnd1","sfxScoreCountEnd2","sfxScoreCountEnd3","sfxScoreCountEnd4","sfxScoreCountEnd5"][a])},destroy:function(){m.prototype.destroy.call(this);null!=this._countingLoop&&this._countingLoop.stop()},__class__:Me});var me=function(a,b){m.call(this,a);this._mazeGameController=b};me.__name__=["game","ui","LevelText"];me.__super__=hc;me.prototype=p(hc.prototype,{getText:function(){return ga.string(this._mazeGameController.get_currentRound())},
__class__:me});var ke=function(a,b,c){m.call(this,a);this._livesController=c;this._text=b};ke.__name__=["game","ui","LivesText"];ke.__super__=m;ke.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this)},update:function(){m.prototype.update.call(this);this.updateSprites()},updateSprites:function(){this._text.setTextString("x"+(this._livesController.get_numLives()-this._livesController.numWaitingLives))},__class__:ke});var Rb=function(a){this._uiPanel=a};Rb.__name__=["game","ui","PopupUiFactory"];
Rb.prototype={createSplashBackground:function(){var a=this._uiPanel.addEntity();new V(a,this._uiPanel);new ec(a);var b=new y(a,"splashBg");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;return a},createImage:function(a,b,c,d,e){null==e&&(e=0.5);null==d&&(d=0.5);var f=this._uiPanel.addEntity();(new V(f,this._uiPanel)).setCoords(new s(a,b));(new y(f,c)).setAnchor(d,e);return f},createImageWithParent:function(a,b,c,d){c=c.addEntity();c.setLocalPosition(a,b);(new y(c,d)).setAnchor(0.5,0.5);return c},
createPlayButton:function(a,b,c){var d=new rb;d.defaultImageName="splashPlayButton";d.x=a;d.y=b;return Ua.createButton(d,this._uiPanel.getEntity(),c)},createCurrentBadge:function(a,b,c,d){var e=this._uiPanel.getEntity().addEntity();(new V(e,this._uiPanel)).setCoords(new s(a,b));a="badge"+d.getBadgeIndexFromScore(c);(new y(e,a)).setAnchor(0.5,0.5);return e},createCurrentBadgeLocal:function(a,b,c,d,e){a=a.addEntity();a.setLocalPosition(b,c);b="badge"+e.getBadgeIndexFromScore(d);(new y(a,b)).setAnchor(0.5,
0.5);return a},createHeadingText:function(a,b,c){var d=this._uiPanel.addEntity();(new V(d,this._uiPanel)).setCoords(new s(a,b));new ma(d,c,{fontSize:"28px",fontFamily:"Arial"});return d},createPromptRoot:function(a,b){var c=this._uiPanel.addEntity(),d=new V(c,this._uiPanel);n.isMobile()&&d.setScale(0.9,0.9);var d=c.addEntity(),e=new y(d,"popupBg");e.getSprite().anchor.x=0.5;e.getSprite().anchor.y=0.5;e=d.addEntity();(new y(e,"headingLogo")).setAnchor(0.5,0.5);e.setLocalPosition(0,-235);d=d.addEntity();
(new y(d,"environmentLogo")).setAnchor(0.5,0.5);d.setLocalPosition(-270,-200);return c},createPromptRootNoBadge:function(a,b){var c=this._uiPanel.addEntity(),d=new V(c,this._uiPanel);n.isMobile()&&d.setScale(0.9,0.9);var d=c.addEntity(),e=new y(d,"popupBg");e.getSprite().anchor.x=0.5;e.getSprite().anchor.y=0.5;d=d.addEntity();(new y(d,"headingLogo")).setAnchor(0.5,0.5);d.setLocalPosition(0,-235);return c},createPromptRootNoBadgeNoLogo:function(a,b){var c=this._uiPanel.addEntity(),d=new V(c,this._uiPanel);
n.isMobile()&&d.setScale(0.9,0.9);d=c.addEntity();d=new y(d,"popupBg");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;return c},createLagrgPromptRoot:function(a,b){var c=this._uiPanel.addEntity(),d=new V(c,this._uiPanel);n.isMobile()&&d.setScale(0.9,0.9);d=c.addEntity();d.setLocalPosition(0,-6);(new y(d,"popupBoxLarge")).setAnchor(0.5,0.5);d=c.addEntity();d.setLocalPosition(0,-233);(new y(d,"popupHeaderLogo")).setAnchor(0.5,0.5);return c},__class__:Rb};var nd=function(a){m.call(this,a);this._tweener=
new sa(this.getEntity());this._deferredAction=new hb(this.getEntity())};nd.__name__=["game","ui","ReadyGoUi"];nd.__super__=m;nd.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this.textField.setTextString(la.getString("READY"));this._tweener.addTween(this.textField.getEntity().getScaleRef(),"x",3,1,0.8,G.easeInQuad,0);this._tweener.addTween(this.textField.getEntity().getScaleRef(),"y",3,1,0.8,G.easeInQuad,0);this._tweener.addTween(this.textField.getText(),"alpha",0,1,0.8,G.linear);
this._tweener.addTween(this.getEntity().getScaleRef(),"x",1.15,1,1.6,G.linear);this._tweener.addTween(this.getEntity().getScaleRef(),"y",1.15,1,1.6,G.linear);this._deferredAction.addDeferredAction(1.6,w(this,this.onReadyDelayElapse))},onReadyDelayElapse:function(){this.textField.setTextString(la.getString("GO"));this._tweener.addTween(this.getEntity().getScaleRef(),"x",1,1.15,1.6,G.linear);this._tweener.addTween(this.getEntity().getScaleRef(),"y",1,1.15,1.6,G.linear);this._tweener.addTween(this.textField.getEntity().getRotationRef(),
"z",0,360,0.13999999999999999,G.easeOutQuad);this._tweener.addTween(this.textField.getEntity().getScaleRef(),"x",0,1,0.27999999999999997,G.easeOutBack,0);this._tweener.addTween(this.textField.getEntity().getScaleRef(),"y",0,1,0.27999999999999997,G.easeOutBack,0);this._deferredAction.addDeferredAction(0.8,w(this,this.onGoDelayElapse));r.playSoundByName("sfx_go")},onGoDelayElapse:function(){var a=this;this._tweener.addTween(this.textField.getEntity().getScaleRef(),"x",1,3,0.27999999999999997,G.easeInQuad,
0);this._tweener.addTween(this.textField.getText(),"alpha",1,0,0.27999999999999997,G.linear);this._tweener.addTween(this.textField.getEntity().getScaleRef(),"y",1,3,0.27999999999999997,G.easeInQuad,0,function(){a.getEntity().destroy()});r.playSoundByName("sfx_go_exit")},__class__:nd});var Wf=function(a,b){this._baseHeight=500;this._baseWidth=750;L.call(this);this._baseWidth=a;this._baseHeight=b};Wf.__name__=["game","ui","ScreenSizeToBrowserSize"];Wf.__super__=ba;Wf.prototype=p(ba.prototype,{postUpdate:function(){ba.prototype.postUpdate.call(this);
n.getDevicePixelRatio();if(1==n.getInstance().getCurrentOrientation()){var a=this._baseWidth/window.innerWidth;n.getInstance().setGameWidth(this._baseWidth);n.getInstance().setGameHeight(Math.ceil(window.innerHeight*a))}else a=this._baseHeight/window.innerHeight,n.getInstance().setGameWidth(Math.ceil(window.innerWidth*a)),n.getInstance().setGameHeight(this._baseHeight);n.getInstance().onResizeWindow()},__class__:Wf});var ne=function(a,b){m.call(this,a);this._snackController=b};ne.__name__=["game",
"ui","SnackText"];ne.__super__=m;ne.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._mask=new PIXI.Graphics;this.meterSprite.getSprite().addChild(this._mask);this.meterSprite.getSprite().mask=this._mask},update:function(){m.prototype.update.call(this);this.updateMask();this.updateVisibility()},updateMask:function(){this._mask.clear();this._mask.beginFill(16711935,1);this._mask.drawRect(0,0.5*-this.meterSprite.get_height(),this.meterSprite.get_width()*this._snackController.getTimeLeftPercentage(),
this.meterSprite.get_height());this._mask.endFill()},updateVisibility:function(){this.getEntity().setVisible(0<this._snackController.getTimeLeftPercentage())},__class__:ne});var Ne=function(a,b,c){m.call(this,a);this._soundOnImage=b;this._soundOffImage=c};Ne.__name__=["game","ui","SoundButton"];Ne.__super__=m;Ne.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._button=this.getEntity().getComponent(Fa);this._buttonActionDelay=this.getEntity().getComponent(Ha);this._buttonMouseOverImage=
this.getEntity().getComponent(bc);this._buttonActionDelay.setOnAction(w(this,this.onClick))},update:function(){m.prototype.update.call(this);this._buttonMouseOverImage.setDefaultImage(r.isMusicMuted()?this._soundOffImage:this._soundOnImage);this._buttonMouseOverImage.setMouseOverImage(r.isMusicMuted()?this._soundOffImage:this._soundOnImage)},onClick:function(){r.setMusicMuted(!r.isMusicMuted());r.setSoundMuted(r.isMusicMuted())},__class__:Ne});var Ba=function(){};Ba.__name__=["game","ui","UiFactory"];
Ba.createFullscreenUiPanel=function(a){var b=n.getInstance().getGameSize();b.getClone();b.x*=n.getInstance().getScreenScale().x;b.y*=n.getInstance().getScreenScale().y;a=a.addEntity();b=new sc(a,b);new ie(a,b);new he(a);return b};Ba.createPulseButton=function(a,b,c,d,e,f,g,k,h,l,m,n,p,q,r,t){var v=Xb.instantiate(a.getGameState());(new V(v,a)).setCoords(new s(b,c));a=new y(v,h);Fa.createFromPixiSprite(a);new qc(v,d,e,f,q);new ac(v,g,k,G.easeOutQuint,G.easeOutQuint);new Ha(v,m,n,p);new bc(v,h,l);new rc(v,
r,t);return v};Ba.createPulseButtonQuick=function(a,b,c,d,e,f,g,k,h,l,m){null==l&&(l=0.35);null==h&&(h=!0);null==k&&(k="");null==g&&(g="");return Ba.createPulseButton(a,b,c,0.35,1,0.15,1.15,0.35,d,e,f,l,m,h,g,k)};Ba.createPulseButtonAbsolute=function(a,b,c,d,e,f,g,k,h,l,m,n,p,q,r,s){a=Xb.instantiate(a);a.setLocalPosition(b,c,0);b=new y(a,h);Fa.createFromPixiSprite(b);new qc(a,d,e,f,q);new ac(a,g,k,G.easeOutQuint,G.easeOutQuint);new Ha(a,m,n,p);new bc(a,h,l);new rc(a,r,s);return a};Ba.createPulseButtonQuickAbsolute=
function(a,b,c,d,e,f,g,k,h,l,m){null==l&&(l=0.35);null==h&&(h=!0);null==k&&(k="");null==g&&(g="");return Ba.createPulseButtonAbsolute(a,b,c,0.35,1,0.15,1.15,0.35,d,e,f,l,m,h,g,k)};Ba.createTextButton=function(a,b,c,d,e,f,g,k,h){null==h&&(h=!0);null==k&&(k="");null==g&&(g="");var l=e.getGameState();a=Ba.createPulseButtonQuick(e,a,b,d,d,f,g,k,h,0.35);l=l.addEntity();l.setLocalPosition(0,-5,0);new ma(l,c,{fontSize:"24px",fontFamily:"Arial",fill:"#000000"});a.addChild(l);return a.getComponent(V)};Ba.prototype=
{__class__:Ba};var kd=function(a,b){this._isMouseDown=!1;m.call(this,a);this._target=b};kd.__name__=["game","ui","VirtualController"];kd.__super__=m;kd.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._button=this.getComponent(Fa);this._button.setOnMouseDown(w(this,this.onMouseDown));this._button.setOnMouseUp(w(this,this.onMouseUp))},onMouseDown:function(){this._isMouseDown=!0;this._mouseDownPosition=qa.getInstance().getMousePosition();null!=this._ui&&this._ui.destroy();this._ui=
this.addEntity();this._ui.setPosition(this._mouseDownPosition.x,this._mouseDownPosition.y);(new y(this._ui,"virtualController")).setAnchor(0.5,0.5)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);if(this._isMouseDown){var a=new s(this._mouseDownPosition.x-qa.getInstance().getMousePosition().x,this._mouseDownPosition.y-qa.getInstance().getMousePosition().y);Math.abs(a.x)>Math.abs(a.y)?25<a.x?this._target.handleLeftStay():-25>a.x&&this._target.handleRightStay():25<a.y?this._target.handleUpStay():
-25>a.y&&this._target.handleDownStay()}},onMouseUp:function(){this._isMouseDown=!1;null!=this._ui&&this._ui.destroy()},__class__:kd});var rb=function(){this.buttonAnchorX=this.buttonAnchorY=0.5;this.textX=this.textY=0;this.text="";this.textStyle=null;this.overSoundId="";this.clickSoundId="sfx_click_1";this.deactivateButtonOnClick=!0;this.onClickDelay=0.35;this.defaultImageName=this.mouseOverImageName="";this.mouseOverScaleDuration=0.35;this.mouseOverScaleTo=1.15;this.mouseDownPulseDuration=0.15;this.mouseDownPulseToScale=
1;this.mouseDownPulseFromScale=0.35;this.positionType=Ra.UiPanel;this.x=this.y=0};rb.__name__=["game","ui","buttonFactory","ButtonConfig"];rb.prototype={__class__:rb};var Ua=function(){};Ua.__name__=["game","ui","buttonFactory","ButtonFactory"];Ua.createButton=function(a,b,c,d){var e=b.addEntity();b=b.getComponent(sc);null!=b&&a.positionType==Ra.UiPanel?(new V(e,b)).setCoords(new s(a.x,a.y)):a.positionType==Ra.World?e.setPosition(a.x,a.y):e.setLocalPosition(a.x,a.y);b=new y(e,a.defaultImageName);
b.setAnchor(a.buttonAnchorX,a.buttonAnchorY);Fa.createFromPixiSprite(b).setData(a.data);new qc(e,a.mouseDownPulseFromScale,a.mouseDownPulseToScale,a.mouseDownPulseDuration,a.deactivateButtonOnClick);new ac(e,a.mouseOverScaleTo,a.mouseOverScaleDuration,G.easeOutQuint,G.easeOutQuint);new Ha(e,c,a.onClickDelay,d);new bc(e,a.defaultImageName,0<a.mouseOverImageName.length?a.mouseOverImageName:a.defaultImageName);new rc(e,a.clickSoundId,a.overSoundId);0<a.text.length&&(c=e.addEntity(),c.setLocalPosition(a.textX,
a.textY),new ma(c,a.text,null==a.textStyle?{}:a.textStyle));return e};var Ra={__ename__:!0,__constructs__:["Local","World","UiPanel"],Local:["Local",0]};Ra.Local.__enum__=Ra;Ra.World=["World",1];Ra.World.__enum__=Ra;Ra.UiPanel=["UiPanel",2];Ra.UiPanel.__enum__=Ra;Ra.__empty_constructs__=[Ra.Local,Ra.World,Ra.UiPanel];var xd=function(a){m.call(this,a)};xd.__name__=["game","ui","popups","Popup"];xd.__super__=m;xd.prototype=p(m.prototype,{init:function(){m.prototype.init.call(this);this._uiPanel=Ba.createFullscreenUiPanel(this.getGameState());
new ra(this._uiPanel.getEntity());this._buttonGroup=new $b(this._uiPanel.getEntity());this.enter()},enter:function(){this.onEnterComplete()},onEnterComplete:function(){this.dispatchEvent(new ic("enterComplete"))},dismiss:function(){this.onDismissComplete()},onDismissComplete:function(){this.dispatchEvent(new ic("dismissComplete"));null!=this._uiPanel&&(this._uiPanel.getEntity().destroy(),this._uiPanel=null);this.getEntity().destroy()},__class__:xd});var Ca=function(a){m.call(this,a)};Ca.__name__=
["game","ui","popups","FadingPopup"];Ca.__super__=xd;Ca.prototype=p(xd.prototype,{enter:function(){var a=this,b=this._uiPanel.getComponent(ra);sa.addTweenToTarget(this.getEntity(),b.getContainer(),"alpha",0,1,0.1,G.linear,0,function(){a.onEnterComplete()})},dismiss:function(){var a=this;this._buttonGroup.setInputEnabled(!1);var b=this._uiPanel.getComponent(ra);sa.addTweenToTarget(this.getEntity(),b.getContainer(),"alpha",1,0,0.1,G.linear,0,function(){a.onDismissComplete()})},__class__:Ca});var Sb=
function(a,b){this._fromTutorial=!1;this._pageIndex=0;m.call(this,a);this._fromTutorial=b};Sb.__name__=["game","ui","popups","HelpScreen"];Sb.show=function(a,b){var c=a.addEntity();return new Sb(c,b)};Sb.__super__=Ca;Sb.prototype=p(Ca.prototype,{init:function(){Ca.prototype.init.call(this);var a=this.addEntity(),b=new y(a,"blackSquare");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.5;a=new V(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);a=new Rb(this._uiPanel);
this._promptBg=a.createLagrgPromptRoot(0,0);this._pageIndex=0;this.updatePage();this.createContent(-158,-84,this._promptBg,"tutorialMovePC",la.getString("HELP_SCREEN_MOVE"));this.createContent(158,-84,this._promptBg,"tutorialCollect",la.getString("HELP_SCREEN_COLLECT"));this.createContent(-158,92,this._promptBg,"tutorialEat",la.getString("HELP_SCREEN_EAT"));this.createContent(158,92,this._promptBg,"tutorialAvoid",la.getString("HELP_SCREEN_AVOID"));a.createImage(-0.74609375,1,"popScooby",0.5,1);a=
new rb;a.x=0.787109375;a.y=0.6631944444444444;a.defaultImageName="splashPlayButton";Ua.createButton(a,this._uiPanel.getEntity(),w(this,this.onClose))},createContent:function(a,b,c,d,e){c=c.addEntity();c.setLocalPosition(a,b);(new y(c,d)).setAnchor(0.5,0.5);a=c.addEntity();a.setLocalPosition(0,63);new ma(a,e,{fontSize:22,fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF"});return c},updatePage:function(){},onPrevButtonClick:function(){},onNextButtonClick:function(){},deleteUiElementAndPositionLocally:function(a,
b,c,d){a.getComponent(V).destroy();b.addChild(a);a.setLocalPosition(c,d)},onClose:function(){this._fromTutorial?this.dispatchEvent(new yd("resume")):this.dismiss()},__class__:Sb});var pe=function(a,b,c){this._displayedScore=this.totalScore=0;this._scoreModifier=5;this._loadingScreen=this._playerData=null;m.call(this,a);this._playerData=b;this._gameController=c};pe.__name__=["game","ui","popups","LevelCompleteScreen"];pe.__super__=Ca;pe.prototype=p(Ca.prototype,{init:function(){Ca.prototype.init.call(this);
var a=this.addEntity();(new V(a,this._uiPanel)).setScale(1E3,1E3);a=new y(a,"blackSquare");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;a.getSprite().alpha=0.5;a=this.addEntity();new V(a,this._uiPanel);new ec(a,new s(1024,576));var a=(new Rb(this._uiPanel)).createPromptRootNoBadge(0,0),b=this.addEntity();b.setLocalPosition(0,-150,0);a.addChild(b);new ma(b,la.getString("LEVEL_COMPLETE_HEADER").toUpperCase(),{fontSize:42,fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A"});b=a.addEntity();
b.setLocalPosition(0,-2);var c=new Me(b,this._gameController.get_scoreController());(new y(b,"badgeContainer")).setAnchor(0.5,0.5);var d=b.addEntity();d.setLocalPosition(-170,-14);(new y(d,"badgeUnknown")).setAnchor(0.5,0.5);var e=b.addEntity(),f=new y(e,"badgeMeterFill");f.setAnchor(0,0);c.meterFillSprite=f;e.setLocalPosition(-275,71);e=b.addEntity();(new y(e,"badgeOverlay")).setAnchor(0.5,0.5);e.setLocalPosition(-173,78);e=a.addEntity();e.setLocalPosition(-170,-82);f=this._gameController.get_scoreController().get_badgeTierIndex()+
1;f=la.getString("BADGE_"+f);new ma(e,f,{fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",fontSize:18});c.badgeText=e;d=d.addEntity();c.badgeIcon=d;e="badge"+this._gameController.get_scoreController().get_badgeTierIndex();(new y(d,e)).setAnchor(0.5,0.5);d=b.addEntity();d.setLocalPosition(115,-60,0);a.addChild(d);new ma(d,la.getString("LEVEL_COMPLETE_SCORE_LABEL").toUpperCase(),{fontSize:24,fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A"});d=b.addEntity();d.setLocalPosition(115,-5,0);a.addChild(d);
d=new ma(d,"0",{fontSize:82,fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF"});c.scoreText=d;c=b.addEntity();c.setLocalPosition(165,48,0);a.addChild(c);c=new ma(c,la.getString("LEVEL_COMPLETE_HIGH_SCORE_LABEL").toUpperCase(),{fontSize:24,align:"right",fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A"});c.getText().anchor.x=1;c.getText().anchor.y=0.5;b=b.addEntity();b.setLocalPosition(170,48,0);a.addChild(b);b=new ma(b,ga.string(W.getInstance().getHighScore()),{fontSize:24,align:"left",fontFamily:"riffic_free_mediumbold",
fill:"#FFFFFF"});b.getText().anchor.x=0;b.getText().anchor.y=0.5;b=new rb;b.x=0;b.y=190;b.defaultImageName="splashPlayButton";Ua.createButton(b,a,w(this,this.onReplayButtonClick));b=new rb;b.x=-145;b.y=210;b.defaultImageName="homeButton";Ua.createButton(b,a,w(this,this.onLevelCompleteNextClicked));a=this.addEntity();(new y(a,"recapScooby")).setAnchor(1,1);(new V(a,this._uiPanel)).setCoords(new s(0.91,1));r.playSoundByName("level_win_1");W.getInstance().setScoreForCurrentLevel(this.totalScore);W.getInstance().setNumLevelsUnlocked(W.getInstance().getCurrentLevelNumber()+
1)},onReplayButtonClick:function(){r.playSoundByName("ui_select_1");Ja.doTransition(this.getGameState(),new xc(this._gameController))},onLevelCompleteNextClicked:function(){r.playSoundByName("ui_select_1");W.getInstance().getCurrentLevelNumber();W.getInstance().getNumLevels();Ja.doTransition(this.getGameState(),new Lb(this._gameController))},onLevelLoadComplete:function(){this.destroy();Ja.doTransition(this._loadingScreen,new xc(this._gameController))},__class__:pe});var Hc=function(a,b,c,d,e,f,g){m.call(this,
a);this._headingText=b;this._bodyText=c;this._yesText=d;this._noText=e;this._onYes=f;this._onNo=g};Hc.__name__=["game","ui","popups","MessageBoxYesNo"];Hc.show=function(a,b,c,d,e,f,g){a=a.addEntity();new Hc(a,b,c,d,e,f,g)};Hc.__super__=Ca;Hc.prototype=p(Ca.prototype,{init:function(){Ca.prototype.init.call(this);var a=this.addEntity(),b=new y(a,"blackSquare");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.5;a=new V(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);
a=(new Rb(this._uiPanel)).createPromptRoot(0,0);b=this.addEntity();b.setLocalPosition(0,-115,0);a.addChild(b);new ma(b,this._headingText.toUpperCase(),{fontSize:62,fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A"});b=this.addEntity();b.setLocalPosition(0,-40,0);a.addChild(b);b=new ma(b,this._bodyText.toUpperCase(),{fontSize:22,fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",align:"center",wordWrapWidth:300,wordWrap:!0});b.getText().anchor.x=0.5;b.getText().anchor.y=0.5;b=new rb;b.defaultImageName=
"grayButton";b.x=-85;b.y=65;b.defaultImageName="yesButton";Ua.createButton(b,a,w(this,this.onYesClick));b.x=85;b.y=65;b.defaultImageName="noButton";Ua.createButton(b,a,w(this,this.onNoClick))},onYesClick:function(){var a=this;this.addEventListener("dismissComplete",function(){null!=a._onYes&&a._onYes()});this.dismiss()},onNoClick:function(){var a=this;this.addEventListener("dismissComplete",function(){null!=a._onNo&&a._onNo()});this.dismiss()},__class__:Hc});var Gc=function(a){m.call(this,a)};Gc.__name__=
["game","ui","popups","PauseMenu"];Gc.show=function(a){a=a.addEntity();return new Gc(a)};Gc.__super__=Ca;Gc.prototype=p(Ca.prototype,{init:function(){Ca.prototype.init.call(this);var a=this.addEntity(),b=new y(a,"blackSquare");b.getSprite().alpha=0.5;b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;(new V(a,this._uiPanel)).setScale(1E3,1E3);a=(new Rb(this._uiPanel)).createPromptRoot(0,0);b=new rb;b.x=0;b.y=75;b.defaultImageName="splashPlayButton";b.deactivateButtonOnClick=!0;Ua.createButton(b,
a,w(this,this.onResumeClicked));b.x=120;b.y=-55;b.defaultImageName="soundOnButton";b.deactivateButtonOnClick=!1;this._soundButton=Ua.createButton(b,a);new Ne(this._soundButton,"soundOnButton","soundOffButton");b.x=0;b.y=-90;b.defaultImageName="helpButton";b.deactivateButtonOnClick=!1;Ua.createButton(b,a,w(this,this.onHelpClicked));b.x=-120;b.y=-55;b.defaultImageName="quitButton";b.deactivateButtonOnClick=!1;Ua.createButton(b,a,w(this,this.onQuitClicked))},onResumeClicked:function(){this.dispatchEvent(new jc("resume"))},
onHelpClicked:function(){var a=this;this.hideMenu();var b=this.getGameState().getSceneRoot().addEntity();(new Sb(b,!1)).addEventListener("dismissComplete",function(){a.showMenu()})},onQuitClicked:function(){this.hideMenu();Hc.show(this.getGameState().getSceneRoot(),la.getString("GAMEPLAY_SCREEN_QUIT_CONFIRM"),la.getString("GAMEPLAY_SCREEN_QUIT_CONFIRM_TEXT"),"","",w(this,this.onConfirmQuitYes),w(this,this.onConfirmQuitNo))},onConfirmQuitYes:function(){this.dispatchEvent(new jc("quit"))},onConfirmQuitNo:function(){this.showMenu()},
hideMenu:function(){this._uiPanel.getEntity().setVisible(!1)},showMenu:function(){this._uiPanel.getEntity().setVisible(!0)},__class__:Gc});var jc=function(a){this._type=a};jc.__name__=["game","ui","popups","PauseMenuEvent"];jc.__super__=P;jc.prototype=p(P.prototype,{__class__:jc});var ic=function(a){this._type=a};ic.__name__=["game","ui","popups","PopupEvent"];ic.__super__=P;ic.prototype=p(P.prototype,{__class__:ic});var Le=function(a,b){m.call(this,a);this._titleScreen=b};Le.__name__=["game","ui",
"popups","StoryScreen"];Le.__super__=Ca;Le.prototype=p(Ca.prototype,{init:function(){Ca.prototype.init.call(this);var a=this.addEntity(),b=new y(a,"blackSquare");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.8;a=new V(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);a=this.addEntity();new V(a,this._uiPanel);b=a.addEntity();b.setLocalPosition(0,-6);(new y(b,"popupBoxLarge")).setAnchor(0.5,0.5);b=a.addEntity();b.setLocalPosition(0,-233);(new y(b,"popupHeaderLogo")).setAnchor(0.5,
0.5);b=a.addEntity();b.setLocalPosition(255,0);(new y(b,"storyScoob")).setAnchor(0.5,0.5);b={fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A",fontSize:40};"es-es"==z.dataLocale&&(b.fontSize=36);var c=a.addEntity();c.setLocalPosition(-210,-147);new ma(c,la.getString("STORY_SCREEN_HEADING"),b);b=a.addEntity();b.setLocalPosition(-210,-110);(new ma(b,la.getString("STORY_SCREEN_BODY"),{fontFamily:"Arial",fill:"#FFFFFF",fontSize:20,wordWrap:!0,wordWrapWidth:380,align:"center",lineHeight:25})).getText().anchor.y=
0;b=a.addEntity();b.setLocalPosition(-431,-212);(new y(b,"popupRoundLogo")).setAnchor(0.5,0.5);b=new rb;b.x=0;b.y=192;b.defaultImageName="splashPlayButton";Ua.createButton(b,a,w(this,this.onClose))},onClose:function(){this._titleScreen.onStartGame()},__class__:Le});var yd=function(a){this._type=a};yd.__name__=["game","ui","popups","TutorialScreenEvent"];yd.__super__=P;yd.prototype=p(P.prototype,{__class__:yd});var Yf=function(){};Yf.__name__=["haxe","IMap"];var Ec=function(){this.h={__keys__:{}}};
Ec.__name__=["haxe","ds","ObjectMap"];Ec.__interfaces__=[Yf];Ec.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++Ec.count);this.h[c]=b;this.h.__keys__[c]=a},__class__:Ec};var ya=function(){this.h={}};ya.__name__=["haxe","ds","StringMap"];ya.__interfaces__=[Yf];ya.prototype={setReserved:function(a,b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},existsReserved:function(a){return null==this.rh?!1:this.rh.hasOwnProperty("$"+a)},
remove:function(a){if(null!=N[a]){a="$"+a;if(null==this.rh||!this.rh.hasOwnProperty(a))return!1;delete this.rh[a]}else{if(!this.h.hasOwnProperty(a))return!1;delete this.h[a]}return!0},__class__:ya};var xa=function(a,b,c){this.xml=b;this.message=a;this.position=c;this.lineNumber=1;for(a=this.positionAtLine=0;a<c;){var d=a++,d=b.charCodeAt(d);10==d?(this.lineNumber++,this.positionAtLine=0):13!=d&&this.positionAtLine++}};xa.__name__=["haxe","xml","XmlParserException"];xa.prototype={toString:function(){return Sa.getClassName(C.getClass(this))+
": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:xa};var Bb=function(){};Bb.__name__=["haxe","xml","Parser"];Bb.parse=function(a,b){null==b&&(b=!1);var c=B.createDocument();Bb.doParse(a,b,0,c);return c};Bb.doParse=function(a,b,c,d){null==c&&(c=0);for(var e=null,f=1,g=1,k=null,h=0,l=0,m=0,n=a.charCodeAt(c),p=new Ub,q=1,r=-1;n==n;){switch(f){case 0:switch(n){case 9:case 10:case 13:case 32:break;default:f=g;continue}break;case 1:if(60==n)f=0,g=2;else{h=c;f=13;continue}break;
case 2:switch(n){case 33:if(91==a.charCodeAt(c+1)){c+=2;if("CDATA["!=F.substr(a,c,6).toUpperCase())throw new K(new xa("Expected <![CDATA[",a,c));c+=5;f=17}else if(68==a.charCodeAt(c+1)||100==a.charCodeAt(c+1)){if("OCTYPE"!=F.substr(a,c+2,6).toUpperCase())throw new K(new xa("Expected <!DOCTYPE",a,c));c+=8;f=16}else{if(45!=a.charCodeAt(c+1)||45!=a.charCodeAt(c+2))throw new K(new xa("Expected \x3c!--",a,c));c+=2;f=15}h=c+1;break;case 47:if(null==d)throw new K(new xa("Expected node name",a,c));h=c+1;
f=0;g=10;break;case 63:f=14;h=c;break;default:f=3;h=c;continue}break;case 3:if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)){if(c==h)throw new K(new xa("Expected node name",a,c));e=B.createElement(F.substr(a,h,c-h));d.addChild(e);++l;f=0;g=4;continue}break;case 4:switch(n){case 47:f=11;break;case 62:f=9;break;default:f=5;h=c;continue}break;case 5:if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)){if(h==c)throw new K(new xa("Expected attribute name",
a,c));k=F.substr(a,h,c-h);if(e.exists(k))throw new K(new xa("Duplicate attribute ["+k+"]",a,c));f=0;g=6;continue}break;case 6:if(61==n)f=0,g=7;else throw new K(new xa("Expected =",a,c));break;case 7:switch(n){case 34:case 39:p=new Ub;f=8;h=c+1;r=n;break;default:throw new K(new xa('Expected "',a,c));}break;case 8:switch(n){case 38:q=c-h;p.b+=null==q?F.substr(a,h,null):F.substr(a,h,q);f=18;q=8;h=c+1;break;case 60:case 62:if(b)throw new K(new xa("Invalid unescaped "+String.fromCharCode(n)+" in attribute value",
a,c));n==r&&(g=c-h,p.b+=null==g?F.substr(a,h,null):F.substr(a,h,g),g=p.b,p=new Ub,e.set(k,g),f=0,g=4);break;default:n==r&&(g=c-h,p.b+=null==g?F.substr(a,h,null):F.substr(a,h,g),g=p.b,p=new Ub,e.set(k,g),f=0,g=4)}break;case 9:h=c=Bb.doParse(a,b,c,e);f=1;break;case 10:if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)){if(h==c)throw new K(new xa("Expected node name",a,c));g=F.substr(a,h,c-h);if(d.nodeType!=B.Element)throw new K("Bad node type, expected Element but found "+d.nodeType);
if(g!=d.nodeName){if(d.nodeType!=B.Element)throw new K("Bad node type, expected Element but found "+d.nodeType);throw new K(new xa("Expected </"+d.nodeName+">",a,c));}f=0;g=12;continue}break;case 11:if(62==n)f=1;else throw new K(new xa("Expected >",a,c));break;case 12:if(62==n)return 0==l&&d.addChild(B.createPCData("")),c;throw new K(new xa("Expected >",a,c));case 13:60==n?(g=c-h,p.b+=null==g?F.substr(a,h,null):F.substr(a,h,g),g=B.createPCData(p.b),p=new Ub,d.addChild(g),++l,f=0,g=2):38==n&&(q=c-
h,p.b+=null==q?F.substr(a,h,null):F.substr(a,h,q),f=18,q=13,h=c+1);break;case 14:63==n&&62==a.charCodeAt(c+1)&&(++c,n=F.substr(a,h+1,c-h-2),d.addChild(B.createProcessingInstruction(n)),++l,f=1);break;case 15:45==n&&(45==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(d.addChild(B.createComment(F.substr(a,h,c-h))),++l,c+=2,f=1);break;case 16:91==n?++m:93==n?--m:62==n&&0==m&&(d.addChild(B.createDocType(F.substr(a,h,c-h))),++l,f=1);break;case 17:93==n&&(93==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(n=
B.createCData(F.substr(a,h,c-h)),d.addChild(n),++l,c+=2,f=1);break;case 18:if(59==n){h=F.substr(a,h,c-h);if(35==h.charCodeAt(0))h=120==h.charCodeAt(1)?ga.parseInt("0"+F.substr(h,1,h.length-1)):ga.parseInt(F.substr(h,1,h.length-1)),p.b+=String.fromCharCode(h);else if(n=Bb.escapes,null!=N[h]?n.existsReserved(h):n.h.hasOwnProperty(h))n=Bb.escapes,h=null!=N[h]?n.getReserved(h):n.h[h],p.b+=ga.string(h);else{if(b)throw new K(new xa("Undefined entity: "+h,a,c));p.b+=ga.string("&"+h+";")}h=c+1;f=q}else if(!(97<=
n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)&&35!=n){if(b)throw new K(new xa("Invalid character in entity: "+String.fromCharCode(n),a,c));p.b+="&";n=c-h;p.b+=null==n?F.substr(a,h,null):F.substr(a,h,n);h=c--;f=q}}n=a.charCodeAt(++c)}1==f&&(h=c,f=13);if(13==f){if(c!=h||0==l)b=c-h,p.b+=null==b?F.substr(a,h,null):F.substr(a,h,b),d.addChild(B.createPCData(p.b));return c}if(!b&&18==f&&13==q)return p.b+="&",b=c-h,p.b+=null==b?F.substr(a,h,null):F.substr(a,h,b),d.addChild(B.createPCData(p.b)),
c;throw new K(new xa("Unexpected end",a,c));};var K=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,K)};K.__name__=["js","_Boot","HaxeError"];K.wrap=function(a){return a instanceof Error?a:new K(a)};K.__super__=Error;K.prototype=p(Error.prototype,{__class__:K});var C=function(){};C.__name__=["js","Boot"];C.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=C.__nativeClassName(a);
return null!=a?C.__resolveNativeClass(a):null};C.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+C.__string_rec(a[f],b)):c+C.__string_rec(a[f],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)f=e++,d+=
(0<f?",":"")+C.__string_rec(a[f],b);return d+"]"}try{d=a.toString}catch(g){return"???"}if(null!=d&&(d!=Object.toString&&"function"==typeof d)&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||("prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c)||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+C.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "string":return a;default:return String(a)}};
C.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||C.__interfLoop(f,b))return!0}return C.__interfLoop(a.__super__,b)};C.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array?null==a.__enum__:!1;case ag:return"boolean"==typeof a;case fg:return!0;case bg:return"number"==typeof a;case gg:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;
default:if(null!=a)if("function"==typeof b){if(a instanceof b||C.__interfLoop(C.getClass(a),b))return!0}else{if("object"==typeof b&&C.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==hg&&null!=a.__name__||b==ig&&null!=a.__ename__?!0:a.__enum__==b}};C.__cast=function(a,b){if(C.__instanceof(a,b))return a;throw new K("Cannot cast "+ga.string(a)+" to "+ga.string(b));};C.__nativeClassName=function(a){a=C.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==
a?null:a};C.__isNativeObj=function(a){return null!=C.__nativeClassName(a)};C.__resolveNativeClass=function(a){return Xf[a]};var Va=function(){};Va.__name__=["js","Browser"];Va.getLocalStorage=function(){try{var a=window.localStorage;a.getItem("");return a}catch(b){return null}};Va.getSessionStorage=function(){try{var a=window.sessionStorage;a.getItem("");return a}catch(b){return null}};var tb=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=
0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};tb.__name__=["js","html","compat","ArrayBuffer"];tb.sliceImpl=function(a,b){var c=new cg(this,a,null==b?null:b-a),d=new Zf(c.byteLength);(new cg(d)).set(c);return d};tb.prototype={slice:function(a,b){return new tb(this.a.slice(a,b))},__class__:tb};var Tb=function(){};Tb.__name__=["js","html","compat","Uint8Array"];Tb._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new tb(c)}else if(C.__instanceof(a,
tb))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new tb(c);else throw new K("TODO "+ga.string(a));c.subarray=Tb._subarray;c.set=Tb._set;return c};Tb._set=function(a,b){if(C.__instanceof(a.buffer,tb)){if(a.byteLength+b>this.byteLength)throw new K("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=
a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new K("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new K("TODO");};Tb._subarray=function(a,b){var c=Tb._new(this.slice(a,b));c.byteOffset=a;return c};var gb,eg=0;String.prototype.__class__=String;String.__name__=["String"];Array.__name__=["Array"];Date.prototype.__class__=Date;Date.__name__=["Date"];var gg={__name__:["Int"]},fg={__name__:["Dynamic"]},bg=Number;bg.__name__=["Float"];
var ag=Boolean;ag.__ename__=["Bool"];var hg={__name__:["Class"]},ig={},N={},dg=dg||{};dg.JQuery=window.jQuery;var Zf=Xf.ArrayBuffer||tb;null==Zf.prototype.slice&&(Zf.prototype.slice=tb.sliceImpl);var cg=Xf.Uint8Array||Tb._new;z.TARGET_FPS=60;z.TARGET_FPS_MOBILE=30;z.GAME_ID="scooby_doo_good_2";z.DEFAULT_SCREEN_WIDTH=1024;z.DEFAULT_SCREEN_HEIGHT=768;z.DEFAULT_LOCALE="en-us";z.BACKGROUND_COLOR="#000000";z.dataLocale="";B.Element=0;B.PCData=1;B.CData=2;B.Comment=3;B.DocType=4;B.ProcessingInstruction=5;B.Document=
6;J.b2_nullFeature=255;J.s_incidentEdge=J.makeClipPointVector();J.s_clipPoints1=J.makeClipPointVector();J.s_clipPoints2=J.makeClipPointVector();J.s_edgeAO=[];J.s_edgeBO=[];J.s_localTangent=new t;J.s_localNormal=new t;J.s_planePoint=new t;J.s_normal=new t;J.s_tangent=new t;J.s_tangent2=new t;J.s_v11=new t;J.s_v12=new t;J.b2CollidePolyTempVec=new t;Xa.s_simplex=new Qe;Xa.s_saveA=[];Xa.s_saveB=[];Jc.currentID=0;D.b2_toiCalls=0;D.b2_toiIters=0;D.b2_toiMaxIters=0;D.b2_toiRootIters=0;D.b2_toiMaxRootIters=
0;D.s_cache=new Ze;D.s_distanceInput=new Re;D.s_xfA=new kb;D.s_xfB=new kb;D.s_fcn=new Ye;D.s_distanceOutput=new Se;va.e_hitCollide=1;va.e_missCollide=0;va.e_startsInsideCollide=-1;oa.s_mat=new ha;v.VERSION="2.1alpha";v.USHRT_MAX=65535;v.b2_pi=Math.PI;v.b2_maxManifoldPoints=2;v.b2_aabbExtension=0.1;v.b2_aabbMultiplier=2;v.b2_polygonRadius=2*v.b2_linearSlop;v.b2_linearSlop=0.005;v.b2_angularSlop=0.011111111111111112*v.b2_pi;v.b2_toiSlop=8*v.b2_linearSlop;v.b2_maxTOIContactsPerIsland=32;v.b2_maxTOIJointsPerIsland=
32;v.b2_velocityThreshold=1;v.b2_maxLinearCorrection=0.2;v.b2_maxAngularCorrection=0.044444444444444446*v.b2_pi;v.b2_maxTranslation=2;v.b2_maxTranslationSquared=v.b2_maxTranslation*v.b2_maxTranslation;v.b2_maxRotation=0.5*v.b2_pi;v.b2_maxRotationSquared=v.b2_maxRotation*v.b2_maxRotation;v.b2_contactBaumgarte=0.2;v.b2_timeToSleep=0.5;v.b2_linearSleepTolerance=0.01;v.b2_angularSleepTolerance=0.011111111111111112*v.b2_pi;q.b2Vec2_zero=new t(0,0);q.b2Mat22_identity=ha.fromVV(new t(1,0),new t(0,1));q.b2Transform_identity=
new kb(q.b2Vec2_zero,q.b2Mat22_identity);A.s_xf1=new kb;A.e_islandFlag=1;A.e_awakeFlag=2;A.e_allowSleepFlag=4;A.e_bulletFlag=8;A.e_fixedRotationFlag=16;A.e_activeFlag=32;A.b2_staticBody=0;A.b2_kinematicBody=1;A.b2_dynamicBody=2;Lc.b2_defaultFilter=new Lc;eb.b2_defaultListener=new eb;Hd.s_evalCP=new Pe;za.e_shapeBit=1;za.e_jointBit=2;za.e_aabbBit=4;za.e_pairBit=8;za.e_centerOfMassBit=16;za.e_controllerBit=32;Wb.s_impulse=new cf;ca.s_timestep2=new Nc;ca.s_xf=new kb;ca.s_backupA=new Cb;ca.s_backupB=
new Cb;ca.s_timestep=new Nc;ca.s_queue=[];ca.s_jointColor=new Fd(0.5,0.8,0.8);ca.e_newFixture=1;ca.e_locked=2;E.e_sensorFlag=1;E.e_continuousFlag=2;E.e_islandFlag=4;E.e_toiFlag=8;E.e_touchingFlag=16;E.e_enabledFlag=32;E.e_filterFlag=64;E.s_input=new $e;Oc.circlePointA=new t;Oc.circlePointB=new t;Da.staticFix=v.b2_maxManifoldPoints;Da.s_worldManifold=new af;Da.s_psm=new Oc;lb.b2_minPulleyLength=2;mb.tImpulse=new t;L._currentInstanceId=0;R._properties=new ya;vb._currentZIndex=0;Jb.MIN_LOAD_TIME=0.5;
Jb.MAX_ACTIVE_REQUESTS=10;la._isInitialized=!1;n.ORIENTATION_HORIZONTAL=0;n.ORIENTATION_VERTICAL=1;n._devicePixelRatio=-1;n._timeService=new Zd;r._masterVolume=1;r._musicVolume=0.25;r._soundVolume=1;r._musicMuted=!1;r._soundMuted=!1;r._soundsPlaying=[];r._isWebkitEnabled=!1;r._useFlashSound=!1;r._soundTimers=new ya;xb.BEGIN_CONTACT="beginContact";xb.END_CONTACT="endContact";Tc.PHYSICS_FPS=60;Tc.TIMESTEP=0.016666666666666666;Yb.PRE_UPDATE="preUpdate";Yb.UPDATE="update";wa.FRAMERATE=30;pc.EPSILON=5E-5;
yb.UPDATE="update";Ha._delayButtonLock=!1;U.VISIBILITY_OFF="visibilityOff";U.VISIBILITY_ON="visibilityOn";U.DISPLAY_UPDATE="displayUpdate";U.ADDED_TO_PARENT="addedToParent";U.REMOVED_FROM_PARENT="removedFromParent";U.PARENT_UPDATE="parentUpdate";U.MOUSE_DOWN="mouseDown";U.MOUSE_UP="mouseUp";U.MOUSE_MOVE="mouseMove";U.MOUSE_OUT="mouseOut";U.MOUSE_OVER="mouseOver";U.MOUSE_CLICK="mouseClick";fb.DESTROY="destroy";fb.ACTIVATE="activate";fb.DEACTIVATE="deactivate";fb.INITIALIZE="initialize";Uc.RAYCAST_CHECK=
"raycastCheck";I.assetList=new ya;pb.BEAT_LEVEL="beatLevel";pb.FAIL_LEVEL="failLevel";pb.TURBO_START="turboStart";pb.TURBO_END="turboEnd";pb.COMIC_SNAPSHOT="comicSnapshot";dc.MIDPOINT="midpoint";dc.COMPLETE="complete";Zc.SHOW_SUBTITLE="showSubtitle";ad.UPDATE_DISPLAY="updateDisplay";bd.CHANGE="change";ab.TIME_SCALE=2;ab.TRANSITION_TIME=0.325;ab.FADE_TIME=7.3;ab.FADE_DURATION=0;W.NUM_LEVELS_UNLOCKED_KEY="numLevelsUnlocked";W.LEVEL_SCORE_SAVE_KEY="levelScore";W.HAS_BEATEN_GAME_KEY="hasBeatenGame";W.HAS_STARTED_GAME_KEY=
"hasStartedGame";Ja.TRANSITION_DURATION=0.5;Oa.heuristic=Oa.manhattanHeuristic;fd.COMPLETE="complete";gd.COMPLETE="complete";Nb.SHOW_MENU="OnMenu";Nb.TOGGLE_MUSIC="onToggleMusic";wc.COLLECT_ALL_FRUIT="allFruitCollected";wc.COLLECT_FRUIT="collectFruit";hd.OUT_OF_LIVES="outOfLives";vc.BASE_SCREEN_WIDTH=1024;vc.MAZE_SCROLL_DURATION=0.5;od.COLLECT="collect";pd.JOIN_TILE="joinTile";qd.ROTATION_VARIANCE=15;rd.EXIT_ACTIVATE="exitActivate";Ob.WALL_SMASH="wallSmash";gc.CHANGE_TILE_START="changeTileStart";
gc.CHANGE_TILE_END="changeTileEnd";sb.HIT="hit";sb.RESPAWN="respawn";sb.EXIT_LEVEL="exitLevel";sb.FINISH_MOVING_TO_TILE="finishMovingToTile";id.MONSTER_NUMBER_SPAWN_DELAYS=[5,15,25];Dc.REQUIRED_DISTANCE=35;vd.WARNING_TIME=3;sd.JUMP_SCALE=1.5;Rb.MOBILE_POPUP_SCALE=0.9;nd.TIME_SCALE=0.8;kd.THRESHHOLD=25;Sb.NUM_PAGES=0;jc.RESUME="resume";jc.QUIT="quit";ic.ENTER_COMPLETE="enterComplete";ic.DISMISS_COMPLETE="dismissComplete";yd.RESUME="resume";Ec.count=0;Bb.escapes=function(a){a=new ya;null!=N.lt?a.setReserved("lt",
"<"):a.h.lt="<";null!=N.gt?a.setReserved("gt",">"):a.h.gt=">";null!=N.amp?a.setReserved("amp","&"):a.h.amp="&";null!=N.quot?a.setReserved("quot",'"'):a.h.quot='"';null!=N.apos?a.setReserved("apos","'"):a.h.apos="'";return a}(this);C.__toStr={}.toString;Tb.BYTES_PER_ELEMENT=1;z.main()})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
