var prevOverall;!function(t){var e=function(){function t(){this._enabled=!0,this.init()}return t.prototype.init=function(){try{this.localStorage=window.localStorage,this.localStorage.setItem("testKey","testData"),this.localStorage.removeItem("testKey")}catch(t){this._enabled=!1}},t.prototype.saveValue=function(t,e){if(this._enabled){var i=JSON.stringify(e);oMetaManager.localSetItem(t,i)}},t.prototype.getValue=function(t){return oMetaManager.localGetItem(t)},t.prototype.remove=function(t){this._enabled&&oMetaManager.localRemoveItem(t)},t.prototype.clear=function(){this._enabled&&this.localStorage.clear()},Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},enumerable:!0,configurable:!0}),t}();t.LocalStorageWrapper=e}(utils||(utils={})),function(t){var e=function(){function t(){}return t.SOURCE_GAME_WIDTH=640,t.SOURCE_GAME_HEIGHT=800,t.GAME_WIDTH=t.SOURCE_GAME_WIDTH,t.GAME_HEIGHT=t.SOURCE_GAME_HEIGHT,t.HALF_GAME_WIDTH=.5*t.GAME_WIDTH,t.HALF_GAME_HEIGHT=.5*t.GAME_HEIGHT,t.WORLD_SCALE=1,t}();t.Config=e}(game||(game={}));var utils,game,__extends=this&&this.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function a(){this.constructor=t}t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)};function onLoad(){new game.Main}!function(t){var e=function(t){function e(e){t.call(this,e,e.stage,"FPS Meter"),this.updateInterval=500,this.timer=0,this.initBackground(),this.initText(),this.setPosition(),this.game.time.advancedTiming=!0}return __extends(e,t),e.prototype.setPosition=function(){this.x=0,this.game.scale.scaleMode===Phaser.ScaleManager.SHOW_ALL?this.position.y=game.Config.GAME_HEIGHT-this.bg.height:this.position.y=game.Config.GAME_HEIGHT*game.Config.WORLD_SCALE-this.bg.height},e.prototype.initBackground=function(){var t=this.game.add.bitmapData(90,25);t.fill(0,0,0),t.rect(0,0,90,25),this.bg=new Phaser.Image(this.game,0,0,t),this.add(this.bg)},e.prototype.initText=function(){this.statsText=this.game.add.text(6,3,"0 fps",{font:"18px Consolas",fill:"#FFFFFF",align:"left"},this)},e.prototype.update=function(){this.timer+=this.game.time.elapsed,this.timer>=this.updateInterval&&(this.timer-=this.updateInterval,this.updateStats())},e.prototype.updateStats=function(){var t="FPS: "+this.game.time.fps;this.statsText.setText(t)},e.prototype.destroy=function(){this.game.time.advancedTiming=!1,t.prototype.destroy.call(this,!0,!1)},e}(Phaser.Group);t.FPSMeter=e}(utils||(utils={})),function(t){var e=function(){function t(){this.intervalID=-1,this.counter=0,this.repeatTimes=0}return t.prototype.repeat=function(t,e,i,a){var s=this;this.intervalID>-1&&clearInterval(this.intervalID),this.func=t,this.context=e,this.repeatTimes=i,this.counter=0,this.intervalID=setInterval(function(){s.execute()},a)},t.prototype.execute=function(){this.func.apply(this.context),++this.counter===this.repeatTimes&&(clearInterval(this.intervalID),this.intervalID=-1)},t.prototype.stop=function(){this.intervalID>-1&&clearInterval(this.intervalID)},t}();t.Timer=e}(utils||(utils={})),function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(){Phaser.Device.isAndroidStockBrowser()&&(this.game.canvas.parentElement.style.overflow="visible");this.add.text(0,0,"Loading...",{font:"10px GrilledCheeseBTNToasted"}).destroy()},i.prototype.preload=function(){this.game.device.ie&&this.game.device.ieVersion<=9&&(this.load.useXDomainRequest=!1)},i.prototype.create=function(){this.setupScale(),this.setupCanvasStyle(),this.setupCustomConsole(),this.addFPSMeter(),this.detectWeakDevice(),this.input.maxPointers=1,this.stage.disableVisibilityChange=!0,this.game.plugins.add(new t.StateTransition(this.game)),this.game.renderer.clearBeforeRender=!1,this.initRadioFunctions();var e=this;gamezop.Initialize({apiKey:"57d370d9-d604-4b6b-8628-95ee800b2386",gameCode:"SklMs63M_gZ",debug:!0,play:function(){radio("play").broadcast({})},pause:function(){radio("pause").broadcast({})},mute:function(){radio("mute").broadcast({})},unmute:function(){radio("unmute").broadcast({})}}).then(function(){return oMetaManager.sync(),e.goToLoadScreen("SDK Init Done")}).catch(function(t){return e.goToLoadScreen(t)})},i.prototype.pauseGame=function(){this.game.paused=!0},i.prototype.unPauseGame=function(){this.game.paused=!1},i.prototype.muteGame=function(){this.game.sound.mute=!0},i.prototype.unMuteGame=function(){this.game.sound.mute=!1},i.prototype.initRadioFunctions=function(){radio("play").subscribe(this.unPauseGame.bind(this)),radio("pause").subscribe(this.pauseGame.bind(this)),radio("mute").subscribe(this.muteGame.bind(this)),radio("unmute").subscribe(this.unMuteGame.bind(this))},i.prototype.goToLoadScreen=function(t){this.game.state.start("Preloader",!0,!1)},i.prototype.setupScale=function(){t.Main.isDesktop?(this.scaleForDesktop(),this.game.scale.forceOrientation(!0,!1)):(this.scaleForMobile(),this.scaleGame(),this.isLandscape()&&this.onEnterLandscape())},i.prototype.scaleForDesktop=function(){var e=this.game.scale;e.scaleMode=Phaser.ScaleManager.SHOW_ALL,e.aspectRatio=t.Config.GAME_WIDTH/t.Config.GAME_HEIGHT,e.onSizeChange.add(this.changesSize,this),e.pageAlignHorizontally=!0,e.pageAlignVertically=!0},i.prototype.changesSize=function(){this.game.scale.isFullScreen},i.prototype.scaleForMobile=function(){var t=this.game.scale;t.scaleMode=Phaser.ScaleManager.EXACT_FIT,t.forceOrientation(!1,!0),t.onSizeChange.add(this.onSizeChange,this)},i.prototype.onSizeChange=function(){this.isPortrait()?(this.scaleGame(),this.game.state.resize(t.Config.GAME_WIDTH,t.Config.GAME_HEIGHT),this.onEnterPortrait()):this.onEnterLandscape()},i.prototype.setupCanvasStyle=function(){this.game.device.desktop?(this.game.canvas.style.boxShadow="0 0 30px black",this.game.canvas.parentElement.style.backgroundColor="#152E4D"):this.game.canvas.style.backgroundColor="black"},i.prototype.setupCustomConsole=function(){if(t.Main.isDesktop){var e=document.getElementById("debug_console");e&&(e.style.display="none")}},i.prototype.addFPSMeter=function(){if(t.Main.development){var e=new utils.FPSMeter(this.game);this.stage.addChild(e)}},i.prototype.detectWeakDevice=function(){t.Main.weakDevice=this.game.renderType===Phaser.CANVAS},i.prototype.scaleGame=function(){var e=window.innerWidth,i=window.innerHeight,a=0,s=0;e*this.game.device.pixelRatio<=t.Config.SOURCE_GAME_WIDTH?(a=2*e,s=2*i):(a=e,s=i);var o=a/t.Config.SOURCE_GAME_WIDTH;this.world.scale.set(o,o),this.scale.setGameSize(a,s),t.Config.WORLD_SCALE=o,t.Config.GAME_WIDTH=this.game.canvas.width/o,t.Config.GAME_HEIGHT=this.game.canvas.height/o,t.Config.HALF_GAME_WIDTH=.5*t.Config.GAME_WIDTH,t.Config.HALF_GAME_HEIGHT=.5*t.Config.GAME_HEIGHT},i.prototype.onEnterLandscape=function(){document.getElementById("rotate").style.display="block",document.getElementById("rotate").style.width=window.innerWidth+"px",document.getElementById("rotate").style.height=window.innerHeight+"px",gamezop.pause(),gamezop.mute()},i.prototype.onEnterPortrait=function(){document.getElementById("rotate").style.display="none",gamezop.play(),0==t.Main.wasMuted&&gamezop.unmute()},i.prototype.isLandscape=function(){return window.innerWidth>window.innerHeight},i.prototype.isPortrait=function(){return window.innerHeight>window.innerWidth},i}(Phaser.State);t.Boot=e}(game||(game={})),function(t){var e=function(){function t(){}return t.createRectTexture=function(t,e,i,a,s){void 0===a&&(a="#000000");var o=Phaser.Color.hexToColor(a),n=!!s,r=t.add.bitmapData(e,i,s,n);return r.fill(o.r,o.g,o.b),r},t.createCircleTexture=function(t,e,i,a){void 0===i&&(i="#000000");var s=Phaser.Color.hexToColor(i),o=!!a,n=t.add.bitmapData(2*e,2*e,a,o);return n.circle(.5*e,.5*e,e),n.fill(s.r,s.g,s.b),n},t}();t.DrawUtil=e}(utils||(utils={})),function(t){var e=function(e){function i(t){e.call(this,t,t.stage),this.overlayDuration=400;var i=utils.DrawUtil.createRectTexture(this.game,1,1,"#000000","black_rect");this.overlay=new Phaser.Image(t,0,0,i),this.overlay.visible=!1,this.game.stage.addChild(this.overlay)}return __extends(i,e),i.prototype.fillStage=function(){var e=t.Config.GAME_WIDTH*t.Config.WORLD_SCALE,i=t.Config.GAME_HEIGHT*t.Config.WORLD_SCALE;this.overlay.scale.set(e,i)},i.prototype.changeState=function(t,e){this.fillStage(),this.showOverlay(t,e)},i.prototype.showOverlay=function(t,e){var i=this;this.overlay.visible=!0,this.overlay.alpha=0,this.overlayTween=this.game.add.tween(this.overlay).to({alpha:1},this.overlayDuration,Phaser.Easing.Cubic.Out,!0),this.overlayTween.onComplete.addOnce(function(){i.doChangeState(t,e)},this)},i.prototype.doChangeState=function(t,e){var i=this;this.game.state.start(t,!0,!1,e),setTimeout(function(){i.hideOverlay()},100),setTimeout(function(){i.overlay.visible=!1},100+this.overlayDuration)},i.prototype.hideOverlay=function(){this.overlayTween=this.game.add.tween(this.overlay).to({alpha:0},this.overlayDuration,Phaser.Easing.Cubic.Out,!0)},i}(Phaser.Plugin);t.StateTransition=e}(game||(game={})),function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(){this.resize()},i.prototype.addBackgound=function(){this.bg=this.game.add.sprite(.5*this.game.width,.5*this.game.height,"loaderBg"),this.bg.anchor.setTo(.5)},i.prototype.addPreloadBar=function(){this.emptyLoader=this.game.add.sprite(.5*this.game.width,.5*this.game.height,"emptyLoader"),this.emptyLoader.anchor.setTo(.5),this.filledLoader=this.game.add.sprite(this.emptyLoader.x-.5*this.emptyLoader.width,this.emptyLoader.y-.5*this.emptyLoader.height,"filledLoader")},i.prototype.addLoadingText=function(){this.loadingText=this.game.add.text(0,0,"Loading...",{font:"50px GrilledCheeseBTNToasted",fill:"#3F51B5",align:"center"}),this.loadingText.anchor.set(.5,.5),this.loadingText.position.set(t.Config.HALF_GAME_WIDTH,t.Config.HALF_GAME_HEIGHT+175),this.loadingText.setShadow(2,2,"#0C1829")},i.prototype.onCompletion=function(t){var e=Math.floor(t);GZLOADER.modify(208,800),GZLOADER.loadProcess(e)},i.prototype.preload=function(){this.loadOtherAssets(),this.loadAudio(),this.loadGraphics(),this.game.load.onFileComplete.add(this.onCompletion,this)},i.prototype.loadOtherAssets=function(){this.load.bitmapFont("digits","assets/fonts/font.png","assets/fonts/font.fnt",null),this.load.json("texts","assets/texts.json")},i.prototype.loadAudio=function(){this.load.audio("main_loop",["assets/audio/MainLoop.m4a","assets/audio/MainLoop.mp3","assets/audio/MainLoop.ogg"],!0),this.game.device.webAudio&&(this.load.audio("tap",["assets/audio/TapSound.wav"],!0),this.load.audio("medal",["assets/audio/MedalEarned.ogg","assets/audio/MedalEarned.m4a"],!0),this.load.audio("jump",["assets/audio/Jump.wav"],!0),this.load.audio("ding",["assets/audio/Ding.wav"],!0),this.load.audio("oh1",["assets/audio/oh1.wav"],!0),this.load.audio("oh2",["assets/audio/oh2.wav"],!0),this.load.audio("whoosh",["assets/audio/whoosh.wav"],!0),this.load.audio("failure",["assets/audio/Failure.wav"],!0))},i.prototype.loadGraphics=function(){this.load.atlasJSONHash("main_menu","assets/graphics/main_menu.png","assets/graphics/main_menu.json"),this.load.image("submit","assets/graphics/submit.png"),this.load.image("tutorial","assets/graphics/tutorial.png"),this.load.image("title","assets/graphics/title.png"),this.load.atlasJSONHash("interface","assets/graphics/interface.png","assets/graphics/interface.json"),this.load.atlasJSONHash("level_graphics","assets/graphics/level_graphics.png","assets/graphics/level_graphics.json"),this.load.atlasJSONHash("boy","assets/graphics/mighty.png","assets/graphics/mighty.json")},i.prototype.loadUpdate=function(){},i.prototype.create=function(){this.initLanguage(),this.game.changeState("MainMenu",!0)},i.prototype.initLanguage=function(){var e=this.game.cache.getJSON("texts"),i=this.getLangFromQuery();t.Main.language=i||e.language||"en",t.Main.texts=e[t.Main.language],t.Main.fontFamily="en"===t.Main.language?"GrilledCheeseBTNToasted":"arialblack",window.document.title=e[t.Main.language].game_title},i.prototype.getLangFromQuery=function(){var t=new Phaser.Net(this.game).getQueryString("lang");return _.isString(t)&&2===t.length?t:null},i.prototype.resize=function(){},i.prototype.resizeBackground=function(){var e=this.bg.width/this.bg.scale.x,i=this.bg.height/this.bg.scale.y;this.bg.scale.set(t.Config.GAME_WIDTH/e,t.Config.GAME_HEIGHT/i),this.bg.x=.5*t.Config.GAME_WIDTH,this.bg.y=.5*t.Config.GAME_HEIGHT},i.prototype.repositionSprites=function(){this.emptyLoader.x=.5*t.Config.GAME_WIDTH,this.emptyLoader.y=.5*t.Config.GAME_HEIGHT,this.filledLoader.x=this.emptyLoader.x-.5*this.emptyLoader.width,this.filledLoader.y=this.emptyLoader.y-.5*this.emptyLoader.height},i}(Phaser.State);t.Preloader=e}(game||(game={})),function(t){var e=function(t){function e(e,i,a,s,o){t.call(this,e,i,a,s,o),this.callbackDelay=0,this.callbackTimer=0,this.clicked=!1,this.disableInput=!1,this._callback=new Phaser.Signal,this.anchor.set(.5,.5),this.inputEnabled=!0,this.events.onInputDown.add(this.onInputDown,this),this.game.device.desktop&&(this.input.useHandCursor=!0)}return __extends(e,t),e.prototype.onInputDown=function(){var t=this;this.disableInput||(this.input.enabled=!1,this.game.device.webAudio&&this.game.sound.play("tap"),this.game.add.tween(this.scale).to({x:1.2,y:.8},200,Phaser.Easing.Cubic.Out,!0).onComplete.addOnce(function(){t.clicked=!0,t.callbackTimer=0,t.game.add.tween(t.scale).to({x:1,y:1},200,Phaser.Easing.Back.Out,!0).onComplete.addOnce(function(){t.input.enabled=!0})},this))},e.prototype.setCallbackDelay=function(t){this.callbackDelay=t},e.prototype.update=function(){this.clicked&&(this.callbackTimer+=this.game.time.elapsed,this.callbackTimer>=this.callbackDelay&&(this._callback.dispatch(),this.clicked=!1,this.callbackTimer=0))},e.prototype.destroy=function(){t.prototype.destroy.call(this),this._callback.dispose(),this._callback=null},Object.defineProperty(e.prototype,"callback",{get:function(){return this._callback},enumerable:!0,configurable:!0}),e}(Phaser.Image);t.SimpleButton=e}(game||(game={})),function(t){var e=function(t){function e(e,i,a,s,o,n){t.call(this,e,i,a,s,o),this.spriteSheet=s,this.textureKey1=o,this.textureKey2=n,this.activeTextureKey=this.textureKey1,this._state=1,this.events.onInputUp.add(this.switchTextures,this,2)}return __extends(e,t),e.prototype.switchTextures=function(){this.activeTextureKey=this.activeTextureKey===this.textureKey1?this.textureKey2:this.textureKey1,this.loadTexture(this.spriteSheet,this.activeTextureKey),this._state=this.activeTextureKey===this.textureKey1?1:2},e.prototype.setState=function(t){1===t?(this.activeTextureKey=this.textureKey1,this.loadTexture(this.spriteSheet,this.activeTextureKey),this._state=1):2===t&&(this.activeTextureKey=this.textureKey2,this.loadTexture(this.spriteSheet,this.activeTextureKey),this._state=2)},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),e}(game.SimpleButton);t.ToggleButton=e}(game||(game={})),function(t){var e=function(e){function i(){e.apply(this,arguments),this.fromPreloader=!1}return __extends(i,e),i.prototype.init=function(t){this.fromPreloader=t},i.prototype.create=function(){GZLOADER.unload(),this.mainSpritebatch=this.add.spriteBatch(this.world),this.addSky(),this.addClouds(),this.addTitle(),this.addBuildings(),this.addBrickWall(),this.addButtons(),this.resize(),gamezop.setState({state:"loaded",metadata:oMetaManager.meta}),!1===t.Main.weakDevice&&this.initAnimation(),this.fromPreloader?(this.handleSoundOnStart(),this.stage.disableVisibilityChange=!1,this.game.onBlur.add(this.onFocusLost,this),this.game.onFocus.add(this.onFocus,this)):t.Main.mainMusicLoop&&t.Main.mainMusicLoop.volume<.33&&(t.Main.mainMusicLoop.volume=.33)},i.prototype.handleSoundOnStart=function(){this.soundButton.input.enabled=!1,this.soundButton.setState(2),this.startMusic()},i.prototype.onFocusLost=function(){t.Main.wasMuted=this.game.sound.mute,this.game.sound.mute=!0},i.prototype.onFocus=function(){!1===t.Main.wasMuted&&(this.game.sound.mute=!1)},i.prototype.addSky=function(){this.background=this.game.add.image(0,-2,"main_menu","Sky0000",this.mainSpritebatch)},i.prototype.addTitle=function(){this.title=this.add.image(0,0,"title"),this.title.anchor.set(.5,0),this.title.scale.setTo(.5,.5),this.title.x=t.Config.HALF_GAME_WIDTH-.5,this.title.y=t.Config.GAME_HEIGHT/4},i.prototype.addSubtitle=function(){var e=t.Main.texts.game_title,i={font:"38px "+t.Main.fontFamily,fill:"#FFFF88",align:"center"};this.subtitle=this.game.add.text(0,0,e,i),this.subtitle.anchor.set(.5,0),this.subtitle.padding.x=3,this.subtitle.x=t.Config.HALF_GAME_WIDTH,this.subtitle.y=this.title.bottom-28,this.subtitle.setShadow(2,2,"rgba(0,0,0,0.66)",1),e===this.game.cache.getJSON("texts").en.game_title?(this.subtitle.visible=!1,this.subtitle.exists=!1):(this.clouds[1].visible=!1,this.clouds[2].visible=!1)},i.prototype.addClouds=function(){this.clouds=[];for(var t=1;t<=5;t++){var e=this.game.add.image(0,0,"main_menu","Cloud_"+t.toString()+"0000",this.mainSpritebatch);e.anchor.set(.5,.5),this.clouds.push(e)}},i.prototype.addBuildings=function(){this.leftBuildings=this.game.add.image(0,0,"main_menu","Buildings_Left0000",this.mainSpritebatch),this.leftBuildings.anchor.set(.5,1),this.leftBuildings.x=143,this.leftBuildings.y=.8*t.Config.GAME_HEIGHT+15,this.rightBuildings=this.game.add.image(0,0,"main_menu","Buildings_Right0000",this.mainSpritebatch),this.rightBuildings.anchor.set(.5,1),this.rightBuildings.x=532,this.rightBuildings.y=.8*t.Config.GAME_HEIGHT+30},i.prototype.addBrickWall=function(){this.brickWall=this.game.add.image(0,0,"main_menu","BrickWall0000",this.mainSpritebatch),this.brickWall.anchor.set(.5,0),this.brickWall.x=t.Config.HALF_GAME_WIDTH,this.brickWall.y=.75*t.Config.GAME_HEIGHT,this.boyPos=this.brickWall.y-25},i.prototype.addBoy=function(){this.boyLower=this.game.add.image(0,0,"main_menu","Boy_Lower0000",this.mainSpritebatch),this.boyLower.anchor.set(.5,1),this.boyLower.x=176,this.boyLower.y=this.brickWall.y,this.boyUpper=this.game.add.image(0,0,"main_menu","Boy_Upper0000",this.mainSpritebatch),this.boyUpper.anchor.set(.5,1),this.boyUpper.x=175,this.boyUpper.y=this.boyLower.y-25,this.boyUpper.angle=-2,this.mainSpritebatch.swap(this.boyUpper,this.boyLower)},i.prototype.addButtons=function(){var e=this,i=Math.min(80,.02*t.Config.GAME_HEIGHT);this.soundButton=new t.ToggleButton(this.game,0,0,"interface","Button_Round_Music_On0000","Button_Round_Music_Off0000"),this.soundButton.position.set(t.Config.GAME_WIDTH/2,i),this.soundButton.callback.add(function(){e.game.sound.mute=!e.game.sound.mute}),this.game.sound.mute&&this.soundButton.switchTextures();this.playButton=new t.SimpleButton(this.game,450,0,"interface","Button_Round_Play0000"),this.playButton.y=this.title.y+400,this.playButton.setCallbackDelay(200),this.playButton.callback.addOnce(function(){gamezop.setState({state:"playing",metadata:oMetaManager.meta}),e.game.changeState("Level")},this),this.keyEnter=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.keyEnter.onDown.add(function(){gamezop.setState({state:"playing",metadata:oMetaManager.meta}),e.game.changeState("Level")},this),this.moreGamesButton=new t.SimpleButton(this.game,0,0,"interface","Button_Round_MoreGames0000"),this.moreGamesButton.x=this.playButton.x-80,this.moreGamesButton.y=this.playButton.y+120,this.moreGamesButton.visible=!1,this.buttons=[this.playButton,this.soundButton],this.buttons.forEach(function(t){e.world.add(t)})},i.prototype.startMusic=function(){t.Main.mainMusicLoop=this.sound.add("main_loop",.33,!0,!0),t.Main.mainMusicLoop.play(),this.soundButton.setState(1),this.soundButton.input.enabled=!0},i.prototype.initAnimation=function(){this.animateTitle(),this.animateButtons()},i.prototype.startBoyAnimation=function(){this.game.add.tween(this.boyUpper.scale).to({y:.95},400,Phaser.Easing.Sinusoidal.Out,!0,0,1e4,!0),this.game.add.tween(this.boyUpper).to({angle:Math.abs(this.boyUpper.angle)},800,Phaser.Easing.Sinusoidal.Out,!0,0,1e4,!0)},i.prototype.animateTitle=function(){this.title.y=.5*-this.title.height,this.title.scale.set(.2,.2),this.game.add.tween(this.title).to({y:.1*t.Config.GAME_HEIGHT},800,Phaser.Easing.Back.Out,!0,200),this.game.add.tween(this.title.scale).to({x:.65,y:.65},600,Phaser.Easing.Back.Out,!0,400),this.subtitle&&(this.subtitle.alpha=0,this.game.add.tween(this.subtitle).to({alpha:1},300,Phaser.Easing.Quadratic.Out,!0,1100))},i.prototype.animateButtons=function(){var t=this,e=1e3;this.buttons.forEach(function(i){i.scale.set(0,0);var a=t.game.add.tween(i.scale).to({x:1,y:1},500,Phaser.Easing.Back.Out,!0,e);i===t.playButton&&a.onComplete.addOnce(t.shakePlayButton,t),e+=150})},i.prototype.shakePlayButton=function(){var t=this;this.time.events.repeat(2200,Number.MAX_VALUE,function(){t.game.add.tween(t.playButton.scale).to({x:1.1,y:.9},150,Phaser.Easing.Cubic.Out,!0,0,3,!0)},this)},i.prototype.resize=function(){this.resizeBackground(),this.alingSprites(),this.alignClouds(),this.alignButtons()},i.prototype.resizeBackground=function(){var e=this.background.width/this.background.scale.x,i=this.background.height/this.background.scale.y;this.background.scale.set(t.Config.GAME_WIDTH/e,.85*t.Config.GAME_HEIGHT/i)},i.prototype.alingSprites=function(){this.title.y=.1*t.Config.GAME_HEIGHT,this.subtitle&&(this.subtitle.y=this.title.bottom-25),this.leftBuildings.y=.83*t.Config.GAME_HEIGHT+15,this.rightBuildings.y=.83*t.Config.GAME_HEIGHT+30,this.brickWall.y=.83*t.Config.GAME_HEIGHT},i.prototype.alignClouds=function(){this.clouds[0].position.set(76,this.title.y),this.clouds[1].position.set(190,this.title.y+120),this.clouds[2].position.set(344,this.title.y+140),this.clouds[3].position.set(545,this.title.y+20),this.clouds[4].position.set(581,this.title.y-50)},i.prototype.alignButtons=function(){this.soundButton.y=4.8*this.title.y+this.title.height;this.playButton.y=3*this.title.y+this.title.height,this.playButton.x=this.title.x,this.moreGamesButton.y=this.playButton.y+120},i.prototype.shutdown=function(){this.buttons=null,this.clouds=null},i}(Phaser.State);t.MainMenu=e}(game||(game={})),function(t){var e=function(){function t(){}return t.distanceSquared=function(t,e,i,a){var s=i-t,o=a-e;return s*s+o*o},t.distance=function(e,i,a,s){var o=t.distanceSquared(e,i,a,s);return Math.sqrt(o)},t.realInRange=function(t,e){return Math.random()*(e-t)+t},t.integerInRange=function(e,i){return Math.round(t.realInRange(e,i))},t.lowPrecisionSin=function(t){return t<-3.14159265?t+=6.28318531:t>3.14159265&&(t-=6.28318531),t<0?1.27323954*t+.405284735*t*t:1.27323954*t-.405284735*t*t},t.DEG_TO_RAD=.017453292519943295,t.RAD_TO_DEG=57.29577951308232,t}();t.MathUtil=e}(utils||(utils={})),function(t){var e=function(){return function(){}}();t.LevelResult=e}(game||(game={})),function(t){var e=function(){function t(){this._ballsToSpawn=20,this._baseSpeed=20}return Object.defineProperty(t.prototype,"levelNumber",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ballsToSpawn",{get:function(){return this._ballsToSpawn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"baseSpeed",{get:function(){return this._baseSpeed},enumerable:!0,configurable:!0}),t}();t.LevelSettings=e}(game||(game={})),function(t){var e=function(e){function i(i,a){e.call(this,i,a);var s=t.Main.texts.new_best.split("\n");this.addText(0,s[0]),this.addText(30,s[1])}return __extends(i,e),i.prototype.addText=function(e,i){var a={font:("ru"===t.Main.language?"26px ":"36px ")+t.Main.fontFamily,fill:"#FFFFFF",align:"center"},s=this.game.add.text(0,0,i,a,this);return s.anchor.set(.5,.5),s.setShadow(2,2,"#B88F00",2),s.position.set(0,e),s.padding.x=2,s},i.prototype.show=function(t){this.game.time.events.add(t,this.doShow,this)},i.prototype.doShow=function(){this.exists=!0,this.visible=!0,this.alpha=0,this.game.add.tween(this).to({alpha:1},200,Phaser.Easing.Sinusoidal.Out,!0,0,1e4,!0)},i.prototype.hide=function(){this.game.tweens.removeFrom(this),this.exists=!1,this.visible=!1},i}(Phaser.Group);t.NewBest=e}(game||(game={})),function(t){var e=function(e){function i(t,a){e.call(this,t,a,"Level Complete Board"),this.buttonsY=0,this.showNewBest=!1,this.medalType=i.NO_CUP,this.exists=!1,this.visible=!1,this.board=this.game.add.group(this),this.addBoard(),this.addTexts(),this.addMedals(),this.addNewBest(),this.addButtons()}return __extends(i,e),i.prototype.addBoard=function(){var t=this.game.add.image(0,0,"interface","LevelComplete_Board0000");t.anchor.set(.5,.5),t.scale.set(1.3,1.3),this.board.add(t)},i.prototype.addTexts=function(){this.addScoreText(),this.addScore(),this.addOverallBest(),this.board.bringToTop(this.scoreText)},i.prototype.addScoreText=function(){var e;e="pt"===t.Main.language||"de"===t.Main.language?40:"it"===t.Main.language?38:48;var i=t.Main.texts.score,a={font:e+"px "+t.Main.fontFamily,fill:"#FBAF05",align:"center"},s=this.game.add.text(0,-100,i,a,this.board);s.padding.x=3,s.anchor.set(.5,.5),s.stroke="#FFFFFF",s.strokeThickness=12,s.setShadow(2,2,"#FB1A05",2)},i.prototype.addScore=function(){var e={font:"100px "+t.Main.fontFamily,fill:"#FBAF05",align:"center"};this.scoreText=this.game.add.text(0,20,"55",e,this.board),this.scoreText.padding.x=3,this.scoreText.anchor.set(.5,.5),this.scoreText.stroke="#FFFFFF",this.scoreText.strokeThickness=12,this.scoreText.setShadow(2,2,"#FB1A05",2)},i.prototype.addTodayBest=function(){t.Main.texts.today_best,this.getFontSize(),t.Main.fontFamily},i.prototype.addOverallBest=function(){var e=t.Main.texts.overall_best+200,i={font:this.getFontSize()+"px "+t.Main.fontFamily,fill:"#FFFFFF",align:"center"};this.bestOverallText=this.game.add.text(0,120,e,i,this.board),this.bestOverallText.padding.x=4,this.bestOverallText.anchor.set(.5,.5),this.bestOverallText.setShadow(2,2,"#FB1A05",2)},i.prototype.getFontSize=function(){return"ru"===t.Main.language?34:"tr"===t.Main.language||"fr"===t.Main.language||"de"===t.Main.language?30:32},i.prototype.addMedals=function(){var t=this;this.medals=[];var e=.5*-this.board.width+50,i=.5*-this.board.height+50;this.medalHighlight=this.game.add.image(e-5,i-12,"interface","Medal_Highlight0000",this.board),this.medalHighlight.anchor.set(.5,.5),this.medalHighlight.visible=!1,["Bronze","Silver","Gold"].forEach(function(a){var s=t.game.add.image(0,0,"interface","Medal_"+a+"0000",t.board);s.exists=!1,s.visible=!1,s.anchor.set(.5,.5),s.position.set(e,i),t.medals.push(s)})},i.prototype.addNewBest=function(){this.newBest=new game.NewBest(this.game,this.board),this.newBest.position.set(this.scoreText.x+.5*this.scoreText.width+62,this.scoreText.y-12),this.newBest.exists=!1,this.newBest.visible=!1,this.game.device.safari&&(this.newBest.y-=7)},i.prototype.addButtons=function(){var t=this;this.buttonsY=this.board.y+.5*this.board.height+45;var e=new game.SimpleButton(this.game,-170,this.buttonsY,"interface","Button_Menu0000");e.callback.addOnce(function(){t.game.changeState("MainMenu")},this);var i=new game.SimpleButton(this.game,0,this.buttonsY,"interface","Button_Play0000");i.callback.add(this.hide,this);var a=new game.ToggleButton(this.game,170,this.buttonsY,"interface","Button_Sound_On0000","Button_Sound_Off0000");a.callback.add(function(){t.game.sound.mute=!t.game.sound.mute}),this.game.sound.mute&&a.switchTextures(),this.buttons=[e,i,a],this.buttons.forEach(function(e){t.add(e)})},i.prototype.show=function(e){this.exists=!0,this.visible=!0,this.hideMedals(),this.hideNewBest(),t.Main.stats.updateStats(e),this.updateData(e),this.SCORE=e,this.startAnimation(),this.keyEnterrestart=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.keyEnterrestart.onDown.add(this.hide,this)},i.prototype.hideMedals=function(){this.medals.forEach(function(t){t.exists=!1,t.visible=!1})},i.prototype.hideNewBest=function(){this.newBest.exists=!1,this.newBest.visible=!1},i.prototype.updateData=function(e){parseInt(t.Main.stats.getValue(t.GameStats.SESSION_BEST));var i=parseInt(t.Main.stats.getValue(t.GameStats.BEST_OVERALL))||0;this.scoreText.setText(e.toString()),this.bestOverallText.setText(t.Main.texts.overall_best+i),this.showNewBest=e>prevOverall,this.medalType=this.getCupType(e)},i.prototype.getCupType=function(t){var e=Phaser.Math.clamp(Math.floor(t/10),0,i.ALL_CUPS.length-1);return i.ALL_CUPS[e]},i.prototype.startAnimation=function(){this.game.device.webAudio&&this.game.sound.play("failure"),this.tweenBoard(),this.tweenButtons(),this.tweenScore(600),this.tweenMedal(1400),this.tweenNewBest(2e3)},i.prototype.tweenBoard=function(){this.board.alpha=1,this.board.y=-200,this.board.scale.set(0,0),this.game.add.tween(this.board).to({y:0},600,Phaser.Easing.Back.Out,!0),this.game.add.tween(this.board.scale).to({x:1,y:1},400,Phaser.Easing.Back.Out,!0),this.playWhoosh()},i.prototype.tweenButtons=function(){var t=this,e=200;this.buttons.forEach(function(i){i.disableInput=!1,i.alpha=1,i.y=t.buttonsY+200,i.scale.set(0,0),t.game.add.tween(i).to({y:i.y-200},600,Phaser.Easing.Back.Out,!0,e),t.game.add.tween(i.scale).to({x:1,y:1},400,Phaser.Easing.Back.Out,!0,e),t.game.time.events.add(e,t.playWhoosh,t),e+=100})},i.prototype.playWhoosh=function(){this.game.device.webAudio&&this.game.sound.play("whoosh")},i.prototype.tweenScore=function(t){this.scoreText.scale.set(5,5),this.scoreText.alpha=0,this.game.add.tween(this.scoreText.scale).to({x:1,y:1},500,Phaser.Easing.Quintic.Out,!0,t),this.game.add.tween(this.scoreText).to({alpha:1},300,Phaser.Easing.Linear.None,!0,t)},i.prototype.tweenNewBest=function(t){this.showNewBest&&(this.newBest.x=this.scoreText.x+this.scoreText.width/this.scoreText.scale.x*.5+.5*this.newBest.width+14,this.newBest.show(t))},i.prototype.tweenMedal=function(t){var e=this;if(this.medalType!==i.NO_CUP){var a=i.ALL_CUPS.indexOf(this.medalType)-1,s=this.medals[a];s.exists=!0,s.visible=!0,s.scale.set(5,5),s.alpha=0,this.game.add.tween(s.scale).to({x:1,y:1},500,Phaser.Easing.Quintic.Out,!0,t),this.game.add.tween(s).to({alpha:1},300,Phaser.Easing.Linear.None,!0,t).onComplete.addOnce(this.showHighlight,this),this.game.time.events.add(t+100,function(){e.game.device.webAudio&&e.game.sound.play("medal")},this)}},i.prototype.showHighlight=function(){this.medalHighlight.visible=!0,this.medalHighlight.scale.set(.8,.8),this.medalHighlight.alpha=1,this.game.add.tween(this.medalHighlight.scale).to({x:1.2,y:1.2},700,Phaser.Easing.Quintic.Out,!0),this.game.add.tween(this.medalHighlight).to({alpha:0},500,Phaser.Easing.Linear.None,!0,200)},i.prototype.submit=function(){submit_on_game_click(this.SCORE)},i.prototype.hide=function(){this.game.time.events.add(1e3,this.onHideComplete,this),this.game.add.tween(this.board).to({y:-100},400,Phaser.Easing.Back.In,!0),this.game.add.tween(this.board).to({alpha:0},200,Phaser.Easing.Linear.None,!0,200),this.newBest.hide(),this.hideButtons(),this.keyEnterrestart.onDown.remove(this.hide,this)},i.prototype.hideButtons=function(){var t=this,e=300;this.buttons.forEach(function(i){i.disableInput=!0,t.game.add.tween(i).to({y:i.y+100},400,Phaser.Easing.Back.In,!0,e),t.game.add.tween(i).to({alpha:0},400,Phaser.Easing.Linear.None,!0,e),e+=100})},i.prototype.onHideComplete=function(){var t=this.game.state.getCurrentState();gamezop.setState({state:"playing",metadata:oMetaManager.meta}),t.restart()},i.prototype.onRestart=function(){this.exists=!1,this.visible=!1},i.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this.buttons=null,this.medals=null},i.GOLD="gold",i.SILVER="silver",i.BRONZE="bronze",i.NO_CUP="no_cup",i.ALL_CUPS=[i.NO_CUP,i.BRONZE,i.SILVER,i.GOLD],i}(Phaser.Group);t.LevelCompleteBoard=e}(game||(game={})),function(t){var e=function(e){function i(t,i){e.call(this,t,i,"Pause Board"),this.buttonsY=0,this.exists=!1,this.visible=!1,this.addBoard(),this.addButtons(),this.addText()}return __extends(i,e),i.prototype.addBoard=function(){this.board=this.game.add.group(this);var t=this.game.add.image(0,0,"interface","LevelComplete_Board0000");t.anchor.set(.5,.5),this.board.add(t)},i.prototype.addText=function(){var e=t.Main.texts.pause,i={font:"56px "+t.Main.fontFamily,fill:"#FBAF05",align:"center"},a=new Phaser.Text(this.game,0,0,e,i);a.padding.x=3,a.anchor.set(.5,.5),a.stroke="#FFFFFF",a.strokeThickness=12,a.setShadow(2,2,"#FB1A05",2),this.board.add(a)},i.prototype.addButtons=function(){var t=this;this.buttonsY=this.board.y+.5*this.board.height+50;var e=new game.SimpleButton(this.game,-152,this.buttonsY,"interface","Button_Menu0000");e.callback.addOnce(function(){t.score>oMetaManager.meta.highscore?(sendScore=t.score,oMetaManager.updateHighScore(sendScore)):sendScore=oMetaManager.meta.highscore,gamezop.setState({score:sendScore,leaderboard:"default",state:"over",metadata:oMetaManager.meta}),t.game.changeState("MainMenu")},this);var i=new game.SimpleButton(this.game,0,this.buttonsY,"interface","Button_Play0000");i.callback.add(this.hide,this),this.keyEnterPause=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.keyEnterPause.onDown.add(this.hide,this);var a=new game.ToggleButton(this.game,152,this.buttonsY,"interface","Button_Sound_On0000","Button_Sound_Off0000");a.callback.add(function(){t.game.sound.mute=!t.game.sound.mute}),this.game.sound.mute&&a.switchTextures(),this.buttons=[e,i,a],this.buttons.forEach(function(e){t.add(e)})},i.prototype.show=function(t){this.exists=!0,this.visible=!0,this.score=t,this.startAnimation()},i.prototype.startAnimation=function(){this.tweenBoard(),this.tweenButtons()},i.prototype.tweenBoard=function(){this.board.alpha=1,this.board.y=-100,this.board.scale.set(0,0),this.game.add.tween(this.board).to({y:0},600,Phaser.Easing.Back.Out,!0),this.game.add.tween(this.board.scale).to({x:1,y:1},400,Phaser.Easing.Back.Out,!0)},i.prototype.tweenButtons=function(){var t=this,e=0;this.buttons.forEach(function(i){i.disableInput=!1,i.alpha=1,i.y=t.buttonsY+100,i.scale.set(0,0),t.game.add.tween(i).to({y:i.y-100},600,Phaser.Easing.Back.Out,!0,e),t.game.add.tween(i.scale).to({x:1,y:1},400,Phaser.Easing.Back.Out,!0,e),e+=100})},i.prototype.hide=function(){this.game.time.events.add(600,this.onHideComplete,this),this.game.add.tween(this.board).to({y:-100},400,Phaser.Easing.Back.In,!0),this.game.add.tween(this.board).to({alpha:0},200,Phaser.Easing.Linear.None,!0,200),this.hideButtons()},i.prototype.hideButtons=function(){var t=this,e=0;this.buttons.forEach(function(i){i.disableInput=!0,t.game.add.tween(i).to({y:i.y+100},400,Phaser.Easing.Back.In,!0,e),t.game.add.tween(i).to({alpha:0},400,Phaser.Easing.Linear.None,!0,e),e+=100})},i.prototype.onHideComplete=function(){this.exists=!1,this.visible=!1,this.game.state.getCurrentState().resume()},i.prototype.onRestart=function(){this.exists=!1,this.visible=!1},i.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this.buttons=null},i}(Phaser.Group);t.PauseBoard=e}(game||(game={})),function(t){var e=function(t){function e(e){t.call(this,e,0,0,"digits","0",70),this.counter=1,this.anchor.set(.5,.5)}return __extends(e,t),e.prototype.updateCount=function(t){var e=this;this.counter!==t&&(this.counter=t,this.setText(t.toString()),this.game.add.tween(this.scale).to({y:.75,x:1.25},100,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){e.game.add.tween(e.scale).to({y:1,x:1},400,Phaser.Easing.Back.Out,!0)}),this.counter>oMetaManager.meta.highscore?(sendScore=this.counter,oMetaManager.updateHighScore(sendScore)):sendScore=oMetaManager.meta.highscore,gamezop.setState({score:sendScore,leaderboard:"default",state:"playing",metadata:oMetaManager.meta}))},e}(Phaser.BitmapText);t.PlatformCounter=e}(game||(game={})),function(t){var e=function(e){function i(t){e.call(this,t),this._hideCompleteSignal=new Phaser.Signal,this.addMainImage(),this.addText()}return __extends(i,e),i.prototype.addMainImage=function(){this.mainImage=this.game.add.image(0,0,"tutorial",null,this),this.mainImage.anchor.set(.5,.5)},i.prototype.addText=function(){var e={font:this.getFontSize()+"px "+t.Main.fontFamily,fill:"#FFFFFF",align:"center"},i=t.Main.texts.high_jump;this.highJumpText=this.game.add.text(0,0,i,e,this),this.highJumpText.anchor.set(.5,0),this.highJumpText.position.set(-145,120);var a=t.Main.texts.short_jump;this.shortJumpText=this.game.add.text(0,0,a,e,this),this.shortJumpText.anchor.set(.5,0),this.shortJumpText.position.set(145,120)},i.prototype.getFontSize=function(){var e={ru:29,tr:29,pt:30,it:26,fr:29,es:29,de:29,default:36};return e.hasOwnProperty(t.Main.language)?e[t.Main.language]:e.default},i.prototype.show=function(t){this.y-=200,this.alpha=0,this.game.add.tween(this).to({alpha:1},200,Phaser.Easing.Linear.None,!0,t+100),this.game.add.tween(this).to({y:this.y+200},600,Phaser.Easing.Back.Out,!0,t).onComplete.addOnce(this.onShowComplete,this)},i.prototype.onShowComplete=function(){this.mainImage.inputEnabled=!0,this.mainImage.events.onInputDown.addOnce(this.hide,this),this.keyEnter=this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.keyEnter.onDown.add(this.hide,this)},i.prototype.hide=function(){this.game.add.tween(this).to({y:this.y+200},600,Phaser.Easing.Back.In,!0),this.game.add.tween(this).to({alpha:0},300,Phaser.Easing.Linear.None,!0,400).onComplete.addOnce(this.onHideComplete,this),this.keyEnter.onDown.remove(this.hide,this)},i.prototype.onHideComplete=function(){this.exists=!1,this.visible=!1,this._hideCompleteSignal.dispatch(),this.destroy()},i.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this._hideCompleteSignal.dispose(),this._hideCompleteSignal=null},Object.defineProperty(i.prototype,"hideCompleteSignal",{get:function(){return this._hideCompleteSignal},enumerable:!0,configurable:!0}),i}(Phaser.Group);t.Tutorial=e}(game||(game={})),function(t){var e=function(){function t(e){this.storage=e,this.saveValue(t.SESSION_BEST,0)}return t.prototype.getValue=function(t){return this.storage.getValue(t)},t.prototype.saveValue=function(t,e){this.storage.saveValue(t,e)},t.prototype.updateStats=function(e){var i=parseInt(this.storage.getValue(t.SESSION_BEST))||0,a=parseInt(this.storage.getValue(t.BEST_OVERALL))||0;prevOverall=a,e>i&&(this.saveValue(t.SESSION_BEST,e),e>oMetaManager.meta.highscore?(sendScore=e,oMetaManager.updateHighScore(e)):sendScore=oMetaManager.meta.highscore,gamezop.setState({score:sendScore,leaderboard:"default",state:"over",metadata:oMetaManager.meta})),e>a&&(this.saveValue(t.BEST_OVERALL,e),oMetaManager.updateHighScore(e)),gamezop.setMetadata(oMetaManager.meta)},t.TUTORIAL="tutorial",t.SESSION_BEST="session_best",t.BEST_OVERALL="best_overall",t}();t.GameStats=e}(game||(game={})),function(t){var e=function(e){function i(t,i){e.call(this,t,t.world,"gui"),this.player=i,this.addPauseButton(),this.initPlatformCounter(),this.initCompleteBoard(),this.initTutorial(),this.initPauseBoard(),this.initRestartOverlay()}return __extends(i,e),i.prototype.addPauseButton=function(){var t=this;this.pauseButton=new game.SimpleButton(this.game,0,0,"interface","Button_Pause0000"),this.pauseButton.position.set(game.Config.GAME_WIDTH-60,game.Config.GAME_HEIGHT*game.Config.WORLD_SCALE*.1),this.pauseButton.y=60,this.pauseButton.events.onInputDown.add(function(){t.game.input.activePointer.isDown=!1},this,0),this.pauseButton.setCallbackDelay(200),this.pauseButton.callback.add(function(){t.game.state.getCurrentState().pause()}),this.add(this.pauseButton)},i.prototype.initPlatformCounter=function(){this._platformCounter=new game.PlatformCounter(this.game),this._platformCounter.position.x=game.Config.HALF_GAME_WIDTH,this._platformCounter.position.y=this.pauseButton.position.y+8,this.add(this._platformCounter),this.game.device.safari&&(this._platformCounter.y-=5)},i.prototype.initCompleteBoard=function(){this.completeBoard=new game.LevelCompleteBoard(this.game,this),this.completeBoard.position.set(game.Config.HALF_GAME_WIDTH,.4*game.Config.GAME_HEIGHT)},i.prototype.initPauseBoard=function(){this.pauseBoard=new game.PauseBoard(this.game,this),this.pauseBoard.position.set(game.Config.HALF_GAME_WIDTH,.4*game.Config.GAME_HEIGHT)},i.prototype.initTutorial=function(){this.player.ignoreClick=!0,this.tutorial=new game.Tutorial(this.game),this.tutorial.hideCompleteSignal.addOnce(this.onTutorialHide,this),this.tutorial.position.set(game.Config.HALF_GAME_WIDTH,game.Config.HALF_GAME_HEIGHT),this.add(this.tutorial),this.tutorial.show(300)},i.prototype.onTutorialHide=function(){t.Main.stats.saveValue(t.GameStats.TUTORIAL,!0),this.player.ignoreClick=!1},i.prototype.initRestartOverlay=function(){var t=utils.DrawUtil.createRectTexture(this.game,1,1,"#FFFFFF","white_rect");this.restartOverlay=this.game.add.image(0,0,t,null,this),this.restartOverlay.scale.set(game.Config.GAME_WIDTH,game.Config.GAME_HEIGHT),this.restartOverlay.exists=!1,this.restartOverlay.visible=!1},i.prototype.onPlayerDied=function(t){this.pauseButton.input.enabled=!1,this.game.add.tween(this.pauseButton).to({alpha:0},100,Phaser.Easing.Linear.None,!0),this.game.add.tween(this.platformCounter).to({alpha:0},100,Phaser.Easing.Linear.None,!0),this.game.time.events.add(1500,this.completeBoard.show,this.completeBoard,t)},i.prototype.reset=function(){this.pauseButton.input.enabled=!0,this.pauseButton.alpha=1,this._platformCounter.alpha=1,this._platformCounter.updateCount(1),this.completeBoard.onRestart(),this.showRestartOverlay()},i.prototype.showRestartOverlay=function(){var t=this;this.restartOverlay.exists=!0,this.restartOverlay.visible=!0,this.restartOverlay.alpha=1,this.game.add.tween(this.restartOverlay).to({alpha:0},300,Phaser.Easing.Linear.None,!0,100).onComplete.addOnce(function(){t.restartOverlay.exists=!1,t.restartOverlay.visible=!1})},i.prototype.resize=function(){},i.prototype.onPause=function(t){this.pauseBoard.show(t),this.pauseButton.visible=!1,this._platformCounter.visible=!1},i.prototype.onResume=function(){this.pauseButton.visible=!0,this._platformCounter.visible=!0},i.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this.buttons=null,this.player=null},Object.defineProperty(i.prototype,"platformCounter",{get:function(){return this._platformCounter},enumerable:!0,configurable:!0}),i}(Phaser.Group);t.LevelGUI=e}(game||(game={})),function(t){!function(t){t[t.DOUBLE_WINDOWS=0]="DOUBLE_WINDOWS",t[t.TRIPLE_WINDOWS=1]="TRIPLE_WINDOWS",t[t.PIPE=2]="PIPE",t[t.DOUBLE_PIPES=3]="DOUBLE_PIPES",t[t.GRAFFITI=4]="GRAFFITI",t[t.NO_DECOR=5]="NO_DECOR"}(t.DecorType||(t.DecorType={}));t.DecorType}(game||(game={})),function(t){var e=function(t){function e(e){t.call(this,e,0,0,"level_graphics","BrickWall0000"),this._platformNumber=0,this.name="Platform",this.decorations=[],this.deactivate()}return __extends(e,t),e.prototype.activate=function(t,e){this._platformNumber=t,this.exists=!0,this.visible=!0,this.y=e},e.prototype.deactivate=function(){this.exists=!1,this.visible=!1,this.hideDecorations()},e.prototype.hideDecorations=function(){this.decorations.forEach(function(t){t.exists=!1,t.visible=!1}),this.decorations.length=0},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.decorations=null},Object.defineProperty(e.prototype,"platformNumber",{get:function(){return this._platformNumber},enumerable:!0,configurable:!0}),e}(Phaser.Image);t.Platform=e}(game||(game={})),function(t){var e=function(){function e(t,e){this.childIndex=0,this.game=t,this.decorLayer=e,this.calculateChildIndex(),this.initDecorSequence(),this.initDecorations(),this.initCallbacks()}return e.prototype.calculateChildIndex=function(){var t=this,e=0;this.decorLayer.children.forEach(function(i){if("Platform"===i.name){var a=t.decorLayer.getChildIndex(i);a>e&&(e=a)}}),this.childIndex=e+1},e.prototype.initDecorSequence=function(){for(this.decorSequence=[t.DecorType.NO_DECOR,t.DecorType.TRIPLE_WINDOWS];this.decorSequence.length<200;)this.addDecorBunchToSequence()},e.prototype.addDecorBunchToSequence=function(){this.decorSequence.push(t.DecorType.NO_DECOR);for(var e=this.game.rnd.integerInRange(5,7),i=this.game.rnd.integerInRange(2,e-1),a=0;a<e;a++)if(a===i-1){var s=Math.random()>.5?t.DecorType.DOUBLE_PIPES:t.DecorType.GRAFFITI;this.decorSequence.push(s)}else{var o=Math.random()>.66?t.DecorType.TRIPLE_WINDOWS:t.DecorType.DOUBLE_WINDOWS;this.decorSequence.push(o)}},e.prototype.initDecorations=function(){var t={Graffity_1:1,Graffity_2:1,Graffity_3:1,Graffity_4:1,Pipe_1:1,Pipe_2:1,Plash_1:1,Plash_2:1,Window_Dark:15};for(var e in this.decorationsPool=[],t)if(t.hasOwnProperty(e))for(var i=parseInt(t[e]),a=0;a<i;a++)this.addNewDecorToPool(e)},e.prototype.addNewDecorToPool=function(t){var e=this.game.add.image(0,0,"level_graphics",t+"0000",this.decorLayer);return e.exists=!1,e.visible=!1,e.anchor.set(.5,.5),e.name=t,this.decorLayer.setChildIndex(e,this.childIndex),this.decorationsPool.push(e),e},e.prototype.initCallbacks=function(){this.callbacks={},this.callbacks[t.DecorType.DOUBLE_WINDOWS]=this.addDoubleWindows,this.callbacks[t.DecorType.TRIPLE_WINDOWS]=this.addTripleWindows,this.callbacks[t.DecorType.GRAFFITI]=this.addGraffity,this.callbacks[t.DecorType.DOUBLE_PIPES]=this.addDoublePipes},e.prototype.decorPlatform=function(t){var e=this.decorSequence[t.platformNumber],i=this.callbacks[e];i&&i.call(this,t)},e.prototype.addDoubleWindows=function(e){var i=.33*t.Config.GAME_WIDTH,a=e.y+.64*e.height,s=this.getActivatedDecorSprite("Window_Dark");s.x=i,s.y=a;var o=this.getActivatedDecorSprite("Window_Dark");o.x=t.Config.GAME_WIDTH-i,o.y=a,e.decorations.push(s,o)},e.prototype.addTripleWindows=function(e){var i=e.y+.64*e.height,a=this.getActivatedDecorSprite("Window_Dark");a.x=90,a.y=i;var s=this.getActivatedDecorSprite("Window_Dark");s.x=.5*t.Config.GAME_WIDTH,s.y=i;var o=this.getActivatedDecorSprite("Window_Dark");o.x=t.Config.GAME_WIDTH-90,o.y=i,e.decorations.push(a,s,o)},e.prototype.addGraffity=function(e){var i="Graffity_"+this.game.rnd.integerInRange(1,4).toString(),a=this.getActivatedDecorSprite(i);a.x=this.game.rnd.realInRange(.3*t.Config.GAME_WIDTH,.7*t.Config.GAME_WIDTH),a.y=e.y+.6*e.height,e.decorations.push(a)},e.prototype.addDoublePipes=function(e){var i=this.getActivatedDecorSprite("Pipe_2");i.x=.25*t.Config.GAME_WIDTH,i.y=e.y+.65*e.height;var a=this.getActivatedDecorSprite("Pipe_1");a.x=.75*t.Config.GAME_WIDTH,a.y=e.y+.65*e.height;var s=this.getActivatedDecorSprite("Plash_1");s.x=.25*t.Config.GAME_WIDTH,s.y=e.y+e.height+8;var o=this.getActivatedDecorSprite("Plash_2");o.x=.75*t.Config.GAME_WIDTH,o.y=e.y+e.height+8,e.decorations.push(i,a,s,o)},e.prototype.getActivatedDecorSprite=function(t){var e=_.find(this.decorationsPool,function(e){return!1===e.exists&&e.name===t});return e||(e=this.addNewDecorToPool(t)),e.exists=!0,e.visible=!0,e},e.prototype.destroy=function(){this.game=null,this.decorLayer=null,this.decorationsPool.length=0,this.decorationsPool=null,this.decorSequence=null,this.callbacks=null},e}();t.PlatformDecor=e}(game||(game={})),function(t){var e=function(e){function i(t){e.call(this,t,0,0,"boy"),this.changeDirectionOffset=33,this.directionChangedTime=0,this.initialVelocityX=-i.VELOCITY_X/16.67,this.gravity=.6/16.67,this.floorY=0,this.onFloor=!1,this.wasOnFloor=!1,this.jumpTimer=0,this.maxJumpDuration=410,this.jumpVelocity=0,this.isJumping=!1,this._radius=26,this.paused=!1,this.ignoreClick=!1,this.addingControls(),this._onGroundSignal=new Phaser.Signal,this.velocity=new Phaser.Point(this.initialVelocityX,0),this.jumpVelocity=.05*(60-this.game.time.desiredFps)-9.6,this.jumpVelocity/=16.67,this.anchor.set(.5,1),this.initDebugShape(),this.initAnimations(),this.addShadow()}return __extends(i,e),i.prototype.initDebugShape=function(){t.Main.development&&(this.debugShape=new Phaser.Circle(this.x,this.y,2*this._radius))},i.prototype.initAnimations=function(){this.animations.add("run",Phaser.Animation.generateFrameNames("mighty",0,15,"",4),30,!0),this.animations.add("jump",Phaser.Animation.generateFrameNames("mighty",22,28,"",4),60,!1),this.animations.add("dead",Phaser.Animation.generateFrameNames("mighty",40,40,"",4),60,!1),this.play("run")},i.prototype.addShadow=function(){!1===t.Main.weakDevice&&(this.shadow=this.game.add.sprite(this.x,this.y,"boy"),this.shadow.anchor.set(.5,1),this.shadow.animations.add("run",Phaser.Animation.generateFrameNames("mighty_shadow",0,15,"",4),30,!0),this.shadow.animations.add("jump",Phaser.Animation.generateFrameNames("mighty_shadow",18,28,"",4),60,!1),this.shadow.animations.add("dead",Phaser.Animation.generateFrameNames("mighty_shadow",40,40,"",4),60,!1),this.shadow.play("run"))},i.prototype.update=function(){this.paused||(this.alive?(this.updateMovement(),this.checkJumpStart(),this.doJumping(),this.checkJumpEnd()):(this.velocity.x*=.99,this.angle+=5),this.updateShadow(),this.velocity.y+=this.gravity*this.game.time.physicsElapsedMS,this.x+=this.velocity.x*this.game.time.physicsElapsedMS,this.y+=this.velocity.y,this.wasOnFloor=this.onFloor,this.onFloor=this.y>=this.floorY,this.alive&&this.onFloor&&(this.y=this.floorY,this.velocity.y=0))},i.prototype.updateMovement=function(){this.changeDirection()&&(this.directionChangedTime=this.game.time.now,this.velocity.x=this.x<t.Config.HALF_GAME_WIDTH?Math.abs(this.velocity.x):-this.velocity.x,this.updateFacing())},i.prototype.changeDirection=function(){var e=this.changeDirectionOffset,i=t.Config.GAME_WIDTH-this.changeDirectionOffset,a=this.game.time.now-this.directionChangedTime;return(this.x<e||this.x>i)&&a>100},i.prototype.updateFacing=function(){this.scale.x=this.velocity.x<0?1:-1},i.prototype.addingControls=function(){this.controls={space:this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),enter:this.game.input.keyboard.addKey(Phaser.Keyboard.ENTER),up:this.game.input.keyboard.addKey(Phaser.Keyboard.UP)}},i.prototype.checkJumpStart=function(){this.onFloor&&this.wasOnFloor&&!this.isJumping&&!this.ignoreClick&&(this.game.input.activePointer.isDown||this.controls.space.isDown||this.controls.enter.isDown||this.controls.up.isDown)&&(this.game.device.webAudio&&this.game.sound.play("jump"),this.removeScaleTweens(),this.isJumping=!0,this.jumpTimer=0,this.play("jump"),this.shadow&&this.shadow.play("jump"))},i.prototype.doJumping=function(){if(this.isJumping){if(this.jumpTimer+=this.game.time.physicsElapsedMS,this.jumpTimer>this.maxJumpDuration||!this.game.input.activePointer.isDown&&!this.controls.space.isDown&&!this.controls.enter.isDown&&!this.controls.up.isDown)return void(this.isJumping=!1);this.velocity.y=this.jumpVelocity*this.game.time.physicsElapsedMS}},i.prototype.checkJumpEnd=function(){!1===this.wasOnFloor&&this.onFloor&&(this.play("run"),this.shadow&&this.shadow.play("run"),this.playJumpEndTween(),this._onGroundSignal.dispatch())},i.prototype.playJumpEndTween=function(){var e=this;t.Main.weakDevice||(this.removeScaleTweens(),this.game.add.tween(this.scale).to({y:.75},100,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){e.game.add.tween(e.scale).to({y:1},800,Phaser.Easing.Elastic.Out,!0)}))},i.prototype.removeScaleTweens=function(){this.game.tweens.removeFrom(this.scale),this.scale.y=1},i.prototype.updateShadow=function(){if(this.shadow){this.shadow.x=this.x+18*Phaser.Math.sign(this.scale.x),this.shadow.y=this.y+0,this.shadow.scale.x=this.scale.x,this.shadow.scale.y=this.scale.y,this.shadow.angle=this.angle}},i.prototype.debugRender=function(){this.debugShape.x=this.x,this.debugShape.y=this.y-.45*this.height,this.game.debug.geom(this.debugShape,"#fff000",!0)},i.prototype.kill=function(){return this.alive=!1,this.anchor.set(.5,.5),this.y-=.5*this.height,this.velocity.y=-11,this.gravity=.5/16.67,this.play("dead"),this.playKillTween(),this.shadow&&(this.shadow.play("dead"),this.shadow.anchor.set(.5,.5)),this},i.prototype.playKillTween=function(){var t=this;this.game.add.tween(this.scale).to({y:.8},100,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){t.game.add.tween(t.scale).to({y:1},800,Phaser.Easing.Back.Out,!0)})},i.prototype.reset=function(){return this.alive=!0,this.velocity.set(this.initialVelocityX,0),this.gravity=.6/16.67,this.anchor.set(.5,1),this.scale.set(1,1),this.angle=0,this.play("run"),this.updateFacing(),this.resetShadow(),this},i.prototype.resetShadow=function(){this.shadow&&(this.shadow.play("run"),this.shadow.anchor.set(.5,1))},i.prototype.onPause=function(t){this.paused=!0,this.animations.currentAnim.paused=!0,this.shadow&&(this.shadow.animations.currentAnim.paused=!0)},i.prototype.onResume=function(){this.paused=!1,this.animations.currentAnim.paused=!1,this.shadow&&(this.shadow.animations.currentAnim.paused=!1)},i.prototype.increaseVelocityX=function(){var t=this.velocity.x+Phaser.Math.sign(this.velocity.x)*(.08/16.67);Math.abs(t)>7/16.67&&(t=7/16.67*Phaser.Math.sign(t)),this.velocity.x=t},i.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this._onGroundSignal.dispose(),this._onGroundSignal=null,this.velocity=null},Object.defineProperty(i.prototype,"onGroundSignal",{get:function(){return this._onGroundSignal},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"radius",{get:function(){return this._radius},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"velocityX",{get:function(){return 16.67*this.velocity.x},enumerable:!0,configurable:!0}),i.VELOCITY_X=4,i}(Phaser.Sprite);t.Player=e}(game||(game={})),function(t){var e=function(){function e(t,e){this.currentAngle=0,this.magnitude=15,this.deltaAngle=.02/16.7,this.initialY=0,this.game=t,this.sprite=e,this.initialY=this.sprite.y}return e.prototype.update=function(){var e=t.MathUtil.lowPrecisionSin(this.currentAngle*Math.PI)*this.magnitude;this.currentAngle+=this.deltaAngle*this.game.time.physicsElapsedMS,this.currentAngle>=2&&(this.currentAngle-=2),this.sprite.y=this.initialY+e},e.prototype.destroy=function(){this.game=null,this.sprite=null},e}();t.FloatFX=e}(utils||(utils={})),function(t){var e=function(e){function i(a,s,o){e.call(this,a,0,0,"level_graphics","Ghost0000"),this.changeDirectionOffset=30,this.changeDirectionTimer=0,this._velocityX=0,this._radius=i.RADIUS,this.enemyNumber=0,this.paused=!1,this.enemyType=t.EnemyType.NORMAL,this.anchor.set(.5,1),this.initDebugShape(),this.initFloatFX(),this.deactivate(),this.events.onAddedToGroup.addOnce(this.initShadow,this)}return __extends(i,e),i.prototype.initDebugShape=function(){t.Main.development&&(this._debugShape=new Phaser.Circle(this.x,this.y,2*this._radius))},i.prototype.initFloatFX=function(){this.floatFX=new utils.FloatFX(this.game,this),this.floatFX.magnitude=3},i.prototype.initShadow=function(){!1===t.Main.weakDevice&&(this.shadow=this.game.add.image(this.x,this.y,"level_graphics","Ghost_Shadow0000",this.parent),this.shadow.anchor.set(.5,1),this.shadow.parent.swapChildren(this,this.shadow))},i.prototype.update=function(){this.paused||this.exists&&(this.updateMovement(),this.updateShadow(),this.floatFX.update())},i.prototype.updateMovement=function(){this.x+=this._velocityX*this.game.time.physicsElapsedMS,this.shouldSwitchDirection()&&(this.changeDirectionTimer=this.game.time.now,this._velocityX=this.x<t.Config.HALF_GAME_WIDTH?Math.abs(this._velocityX):-this._velocityX,this.updateFacing(),this.playFacingChangeTween())},i.prototype.updateFacing=function(){this._velocityX<0?(this.loadTexture("level_graphics","Ghost_Flipped0000"),this.shadow&&this.shadow.loadTexture("level_graphics","Ghost_Shadow_Flipped0000")):(this.loadTexture("level_graphics","Ghost0000"),this.shadow&&this.shadow.loadTexture("level_graphics","Ghost_Shadow0000"))},i.prototype.playFacingChangeTween=function(){var e=this;t.Main.weakDevice||this.game.add.tween(this.scale).to({y:.8},100,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){e.game.add.tween(e.scale).to({y:1},800,Phaser.Easing.Elastic.Out,!0)})},i.prototype.shouldSwitchDirection=function(){var e=this.changeDirectionOffset,i=t.Config.GAME_WIDTH-this.changeDirectionOffset,a=this.game.time.now-this.changeDirectionTimer;return(this.x<e||this.x>i)&&a>100},i.prototype.updateShadow=function(){if(this.shadow){this.shadow.x=this.x+-20*Phaser.Math.sign(this._velocityX),this.shadow.y=this.y+0,this.shadow.scale.x=this.scale.x,this.shadow.scale.y=this.scale.y}},i.prototype.activate=function(e,i,a){this.exists=!0,this.visible=!0,this.x=this.game.rnd.realInRange(this.changeDirectionOffset,t.Config.GAME_WIDTH-this.changeDirectionOffset),this.y=e,this._velocityX=i/16.67,this.floatFX.initialY=e,this.floatFX.magnitude=1.9*Math.abs(i),this.activateShadow(),this.updateFacing(),this.enemyNumber=a},i.prototype.activateShadow=function(){this.shadow&&(this.shadow.exists=!0,this.shadow.visible=!0)},i.prototype.deactivate=function(){this.exists=!1,this.visible=!1,this.shadow&&(this.shadow.exists=!1,this.shadow.visible=!1)},i.prototype.debugRender=function(){this._debugShape&&(this._debugShape.x=this.x+12*Phaser.Math.sign(this._velocityX),this._debugShape.y=this.y-.5*this.height,this.game.debug.geom(this._debugShape,"#ff0000"))},i.prototype.onPause=function(){this.paused=!0},i.prototype.onResume=function(){this.paused=!1},i.prototype.destroy=function(){e.prototype.destroy.call(this,!0),this._debugShape=null,this.floatFX.destroy(),this.floatFX=null},Object.defineProperty(i.prototype,"velocityX",{get:function(){return this._velocityX},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"radius",{get:function(){return this._radius},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"debugShape",{get:function(){return this._debugShape},enumerable:!0,configurable:!0}),i.RADIUS=28,i}(Phaser.Sprite);t.Enemy=e}(game||(game={})),function(t){!function(t){t[t.NO_ENEMY=0]="NO_ENEMY",t[t.NORMAL=1]="NORMAL",t[t.SNEAKY=2]="SNEAKY"}(t.EnemyType||(t.EnemyType={}));t.EnemyType}(game||(game={})),function(t){var e=function(){function e(e){this._game=e,this._futureEnemies=[t.EnemyType.NO_ENEMY]}return e.prototype.generate=function(t){for(;this._futureEnemies.length<t;)this.addEnemiesBunch()},e.prototype.addEnemiesBunch=function(){this._futureEnemies.push(t.EnemyType.NO_ENEMY);for(var e=this._game.rnd.integerInRange(3,5),i=this.getSneakyEnemyNum(e),a=1;a<e;a++)a===i?this._futureEnemies.push(t.EnemyType.SNEAKY):this._futureEnemies.push(t.EnemyType.NORMAL)},e.prototype.getSneakyEnemyNum=function(t){return Math.random()>.66?this._game.rnd.integerInRange(1,t):-1},e.prototype.destroy=function(){this._game=null,this._futureEnemies=null},Object.defineProperty(e.prototype,"futureEnemies",{get:function(){return this._futureEnemies},enumerable:!0,configurable:!0}),e}();t.EnemiesGenerator=e}(game||(game={})),function(t){var e=function(e){function i(i){e.call(this,i,"level_graphics","Ghost20000"),this.teleportOffset=40,this.teleportTimer=0,this.enemyType=t.EnemyType.SNEAKY}return __extends(i,e),i.prototype.initShadow=function(){!1===t.Main.weakDevice&&(this.shadow=this.game.add.image(this.x,this.y,"level_graphics","Ghost2_Shadow0000",this.parent),this.shadow.anchor.set(.5,1),this.shadow.parent.swapChildren(this,this.shadow))},i.prototype.updateMovement=function(){this.x+=this._velocityX*this.game.time.physicsElapsedMS,this.shouldTeleport()&&(this.teleportTimer=this.game.time.now,this.teleport(),this.updateFacing())},i.prototype.shouldTeleport=function(){var e=-this.teleportOffset,i=t.Config.GAME_WIDTH+this.teleportOffset,a=this.game.time.now-this.teleportTimer;return(this.x<e||this.x>i)&&a>100},i.prototype.teleport=function(){this.x=this.x<t.Config.HALF_GAME_WIDTH?t.Config.GAME_WIDTH+this.teleportOffset:-this.teleportOffset},i.prototype.updateFacing=function(){this._velocityX<0?(this.loadTexture("level_graphics","Ghost2_Flipped0000"),this.shadow&&this.shadow.loadTexture("level_graphics","Ghost2_Shadow_Flipped0000")):(this.loadTexture("level_graphics","Ghost20000"),this.shadow&&this.shadow.loadTexture("level_graphics","Ghost2_Shadow0000"))},i}(t.Enemy);t.SneakyEnemy=e}(game||(game={})),function(t){var e=function(e){function i(){e.apply(this,arguments),this.moveFloorMark=0,this.worldHeight=1e5,this.platformCounter=1,this.newPlatformMark=0,this.platformDistance=238,this.lastAddedPlatformY=0,this.score=1}return __extends(i,e),i.prototype.init=function(){this.score=1,this.platformCounter=1,this.newPlatformMark=0,this.lastAddedPlatformY=Math.round(this.worldHeight/t.Config.WORLD_SCALE),this.lastAddedPlatform=null,this.debugRenderFlag=!1,this.moveFloorMark=0},i.prototype.create=function(){this.mainSpritebatch=this.game.add.spriteBatch(this.world,"main_spritebatch"),this.createPlatforms(),this.addPlatformHightlight(),this.platformsDecorator=new t.PlatformDecor(this.game,this.mainSpritebatch),this.createEnemies(),this.generateFutureEnemies(),this.initialGeneration(),this.addFloor(),this.addPlayer(),this.addGUI(),this.initPauseables(),this.setupCamera(),this.initKeyCallbacks(),this.resize()},i.prototype.createPlatforms=function(){this.platforms=[];for(var e=Math.ceil(t.Config.GAME_HEIGHT/this.platformDistance)+2,i=0;i<e;i++)this.createNewPlatform()},i.prototype.createNewPlatform=function(){var e=new t.Platform(this.game);return e.x=-3,this.platforms.push(e),this.mainSpritebatch.add(e),e},i.prototype.addPlatformHightlight=function(){this.platformHightlight=this.game.add.image(0,0,"level_graphics","Platfrom_Highlight0000",this.mainSpritebatch)},i.prototype.createEnemies=function(){this.enemies=[];for(var e=this.platforms.length-1,i=0;i<e;i++)this.createNewEnemy(t.EnemyType.NORMAL);for(i=0;i<2;i++)this.createNewEnemy(t.EnemyType.SNEAKY)},i.prototype.createNewEnemy=function(e){var i;return e===t.EnemyType.NORMAL?i=new t.Enemy(this.game):e===t.EnemyType.SNEAKY&&(i=new t.SneakyEnemy(this.game)),this.enemies.push(i),this.mainSpritebatch.add(i),i},i.prototype.addFloor=function(){var e=utils.DrawUtil.createRectTexture(this.game,t.Config.GAME_WIDTH,10,"#FF0000");this.floor=this.game.add.sprite(0,0,e),this.floor.y=this.getBottomExistingPlatform().y+16,this.floor.visible=!1,this.moveFloorMark=this.getBottomExistingPlatform().y+16-this.platformDistance},i.prototype.generateFutureEnemies=function(){this.enemiesGenerator=new t.EnemiesGenerator(this.game),this.enemiesGenerator.generate(200)},i.prototype.initialGeneration=function(){for(var e=Math.ceil(t.Config.GAME_HEIGHT/this.platformDistance),i=0;i<e;i++)this.enlargeLevel()},i.prototype.enlargeLevel=function(){this.addNewPlatform(),this.addNewEnemy()},i.prototype.addPlayer=function(){this.player=new t.Player(this.game),this.player.onGroundSignal.add(this.onPlayerReachGround,this),this.player.floorY=this.floor.y,this.player.position.set(.5*t.Config.GAME_WIDTH,this.player.floorY),this.game.add.existing(this.player)},i.prototype.onPlayerReachGround=function(){var t=this.getNearestPlatform(this.player.position);t.platformNumber>this.score&&(this.platformHightlight.y=t.y+4,this.platformHightlight.alpha=0,this.game.add.tween(this.platformHightlight).to({alpha:.5},150,Phaser.Easing.Quintic.Out,!0,0,0,!0),this.game.device.webAudio&&this.game.sound.play("ding",.2),this.player.increaseVelocityX()),this.score=t.platformNumber,this.gui.platformCounter.updateCount(this.score)},i.prototype.getNearestPlatform=function(t){var e=Number.MAX_VALUE,i=this.platforms[0];return this.platforms.forEach(function(a){if(a.exists){var s=Math.abs(t.y-a.y);s<e&&(i=a,e=s)}}),i},i.prototype.getBottomExistingPlatform=function(){var t=0,e=null;return this.platforms.forEach(function(i){i.exists&&i.y>t&&(e=i,t=i.y)}),e},i.prototype.setupCamera=function(){this.world.setBounds(0,0,t.Config.GAME_WIDTH,this.worldHeight),this.camera.width=t.Config.GAME_WIDTH*t.Config.WORLD_SCALE,this.camera.height=t.Config.GAME_HEIGHT*t.Config.WORLD_SCALE,this.camera.view.y=(this.player.y-t.Config.GAME_HEIGHT+this.platformDistance)*t.Config.WORLD_SCALE,this.camera.roundPx=!1},i.prototype.addGUI=function(){this.gui=new t.LevelGUI(this.game,this.player)},i.prototype.initPauseables=function(){this.pauseables=[this.gui,this.player],this.pauseables=this.pauseables.concat(this.enemies)},i.prototype.initKeyCallbacks=function(){t.Main.development&&(this.game.input.keyboard.addKey(Phaser.Keyboard.D).onDown.add(this.toggleDebugRender,this),this.game.input.keyboard.addKey(Phaser.Keyboard.P).onDown.add(this.togglePause,this))},i.prototype.togglePause=function(){this.game.paused=!this.game.paused},i.prototype.restart=function(){t.Main.mainMusicLoop&&this.sound.usingWebAudio&&t.Main.mainMusicLoop.fadeTo(300,.33),this.gui.reset(),this.player.reset(),this.platforms.forEach(function(t){t.deactivate()}),this.enemies.forEach(function(t){t.deactivate()}),this.score=1,this.platformCounter=1,this.newPlatformMark=0,this.lastAddedPlatformY=Math.round(this.worldHeight/t.Config.WORLD_SCALE),this.lastAddedPlatform=null,this.initialGeneration(),this.floor.y=this.getBottomExistingPlatform().y+16,this.moveFloorMark=this.floor.y-this.platformDistance,this.player.floorY=this.floor.y,this.player.position.set(.75*t.Config.GAME_WIDTH,this.player.floorY),this.camera.view.y=this.getCameraY()},i.prototype.toggleDebugRender=function(){this.debugRenderFlag=!this.debugRenderFlag},i.prototype.gotoMainMenu=function(){this.game.changeState("MainMenu")},i.prototype.update=function(){this.removeObjectsOutOfBounds(),this.generateLevel(),this.checkPlayerEnemiesOverlap(),this.player.alive&&(this.updateFloor(),this.updateCamera(),this.gui.y=this.camera.view.y/t.Config.WORLD_SCALE)},i.prototype.updateFloor=function(){this.player.y<this.moveFloorMark&&(this.moveFloorMark-=this.platformDistance,this.floor.y-=this.platformDistance,this.player.floorY=this.floor.y)},i.prototype.updateCamera=function(){var t=this.getCameraY()-this.camera.view.y;this.camera.view.y+=.05*t},i.prototype.getCameraY=function(){return(this.player.y-t.Config.GAME_HEIGHT+this.platformDistance)*t.Config.WORLD_SCALE},i.prototype.removeObjectsOutOfBounds=function(){this.removePlatforms(),this.removeEnemies()},i.prototype.removePlatforms=function(){var t=this,e=2*this.platformDistance;this.platforms.forEach(function(i){i.exists&&i.y-t.player.y>e&&i.deactivate()})},i.prototype.removeEnemies=function(){var t=this,e=2*this.platformDistance;this.enemies.forEach(function(i){i.exists&&i.y-t.player.y>e&&i.deactivate()})},i.prototype.checkPlayerEnemiesOverlap=function(){if(!1!==this.player.alive)for(var e=this.player.x,i=this.player.y-.5*this.player.height,a=this.player.radius+t.Enemy.RADIUS,s=a*a,o=0;o<this.enemies.length;o++){var n=this.enemies[o];if(n.exists){var r=n.x+12*Phaser.Math.sign(n.velocityX),h=n.y-.5*n.height;if(utils.MathUtil.distanceSquared(e,i,r,h)<=s)return this.player.kill(),void this.onPlayerDied()}}},i.prototype.onPlayerDied=function(){t.Main.mainMusicLoop&&this.sound.usingWebAudio&&t.Main.mainMusicLoop.fadeTo(300,.07),this.playRandomOhSound(),this.gui.onPlayerDied(this.score),gamezop.setState({state:"over",metadata:oMetaManager.meta})},i.prototype.playRandomOhSound=function(){if(this.game.device.webAudio){var t=this.rnd.integerInRange(1,2);this.game.sound.play("oh"+t)}},i.prototype.generateLevel=function(){this.player.y<this.newPlatformMark&&this.enlargeLevel()},i.prototype.addNewPlatform=function(){var e=this.lastAddedPlatformY-this.platformDistance,i=this.platformCounter++,a=this.getPlatform();a.activate(i,e),this.lastAddedPlatformY=a.y,this.lastAddedPlatform=a,this.newPlatformMark=this.lastAddedPlatformY+t.Config.GAME_HEIGHT-this.platformDistance,this.platformsDecorator.decorPlatform(a)},i.prototype.getPlatform=function(){var t=_.find(this.platforms,function(t){return!1===t.exists});return t||(t=this.createNewPlatform()),t},i.prototype.addNewEnemy=function(){var e=this.enemiesGenerator.futureEnemies[this.platformCounter-1];if(e!==t.EnemyType.NO_ENEMY){var i=this.lastAddedPlatform.y,a=this.getEnemySpeed();this.getEnemy(e).activate(i,a,this.platformCounter-1)}},i.prototype.getEnemy=function(t){var e=_.find(this.enemies,function(e){return e.enemyType===t&&!1===e.exists});return e||(e=this.createNewEnemy(t)),e},i.prototype.getEnemySpeed=function(){var e=this.player?this.player.velocityX:t.Player.VELOCITY_X,i=Math.abs(e),a=i-.5*i,s=i+.5*i,o=this.game.rnd.realInRange(a,s);return Math.abs(e-o)<.8&&(o-=.8*Phaser.Math.sign(e-o)),o*Phaser.ArrayUtils.getRandomItem([1,-1])},i.prototype.render=function(){this.debugRenderFlag&&(this.renderEnemies(),this.player.debugRender(),this.game.debug.cameraInfo(this.camera,30,30))},i.prototype.renderEnemies=function(){this.enemies.forEach(function(t){t.exists&&t.debugRender()})},i.prototype.resize=function(){this.gui.resize()},i.prototype.pause=function(){var t=this;this.pauseables.forEach(function(e){e.onPause(t.score)})},i.prototype.resume=function(){this.pauseables.forEach(function(t){t.onResume()})},i.prototype.shutdown=function(){this.platformsDecorator.destroy(),this.platformsDecorator=null,this.enemiesGenerator.destroy(),this.enemiesGenerator=null,this.platforms=null,this.enemies=null,this.lastAddedPlatform=null,this.pauseables=null,this.player=null},i}(Phaser.State);t.Level=e}(game||(game={})),function(t){var e=function(){function e(){}return e.createConfig=function(){t.Main.isDesktop=this.checkDesktop();var e=t.Main.isDesktop;return{width:t.Config.SOURCE_GAME_WIDTH,height:t.Config.SOURCE_GAME_HEIGHT,renderer:Phaser.AUTO,transparent:e,antialias:!1,enableDebug:t.Main.development}},e.checkDesktop=function(){var t=!1,e=detect.parse(window.navigator.userAgent);return"Desktop"===e.device.type&&(t=!0,e.device.family.indexOf("Nexus")>-1&&(t=!1)),t},e}();t.GameConfigCreator=e}(game||(game={})),window.addEventListener("load",onLoad,!1),function(t){var e=function(e){function i(){var a=t.GameConfigCreator.createConfig();e.call(this,a),i.storage=new utils.LocalStorageWrapper,i.stats=new t.GameStats(i.storage),this.state.add("Boot",t.Boot,!0),this.state.add("Preloader",t.Preloader,!1),this.state.add("MainMenu",t.MainMenu,!1),this.state.add("Level",t.Level,!1)}return __extends(i,e),i.prototype.isDomainAllowed=function(){var t=new Phaser.Net(this).getHostName();return null===t||["192.168.1.5","liquidrainbow.net"].some(function(e){return e.indexOf(t)>-1})},i.prototype.changeState=function(t,e){this.plugins.plugins[0].changeState(t,e)},i.isDesktop=!0,i.weakDevice=!1,i.wasPaused=!1,i.wasMuted=!1,i.development=!1,i.language="en",i.fontFamily="arialblack",i}(Phaser.Game);t.Main=e}(game||(game={}));