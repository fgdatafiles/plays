function validateListener(a,b){if("function"!=typeof a)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}function Signal(){this._bindings=[],this._prevParams=null;var a=this;this.dispatch=function(){Signal.prototype.dispatch.apply(a,arguments)}}function SignalBinding(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}window.Utils=window.Utils||{},"undefined"==typeof Utils.isTouchDevice&&Object.defineProperty(Utils,"isTouchDevice",{get:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}}),"undefined"==typeof Utils.isDesktop&&Object.defineProperty(Utils,"isDesktop",{get:function(){return!Utils.isTouchDevice}}),"undefined"!=typeof createjs&&("undefined"==typeof createjs.DisplayObject.prototype.reg&&(createjs.DisplayObject.prototype.reg=function(a,b){var c;return 1===arguments.length?"number"==typeof a?(c=this.getBounds(),c&&(this.regX=this.getBounds().width*a,this.regY=this.getBounds().height*a)):"number"==typeof a.x&&"number"==typeof a.y&&(c=this.getBounds(),c&&(this.regX=this.getBounds().width*a.x,this.regY=this.getBounds().height*a.y)):2===arguments.length&&"number"==typeof a&&"number"==typeof b&&(c=this.getBounds(),c&&(this.regX=this.getBounds().width*a,this.regY=this.getBounds().height*b)),this}),"undefined"==typeof createjs.DisplayObject.prototype.setPos&&(createjs.DisplayObject.prototype.setPos=function(a,b){return 1===arguments.length?"number"==typeof a?(this.x=a,this.y=a):"number"==typeof a.x&&"number"==typeof a.y&&(this.x=a.x,this.y=a.y):2===arguments.length&&"number"==typeof a&&"number"==typeof b&&(this.x=a,this.y=b),this}),"undefined"==typeof createjs.DisplayObject.prototype.moveBy&&(createjs.DisplayObject.prototype.moveBy=function(a,b){return 1===arguments.length?"number"==typeof a?(this.x+=a,this.y+=a):"number"==typeof a.x&&"number"==typeof a.y&&(this.x+=a.x,this.y+=a.y):2===arguments.length&&"number"==typeof a&&"number"==typeof b&&(this.x+=a,this.y+=b),this}),"undefined"==typeof createjs.DisplayObject.prototype.pos&&Object.defineProperty(createjs.DisplayObject.prototype,"pos",{get:function(){return{x:this.x,y:this.y}}}),"undefined"==typeof createjs.DisplayObject.prototype.move&&(createjs.DisplayObject.prototype.move=function(a,b){return 1===arguments.length?"number"==typeof a?(this.x+=a,this.y+=a):"number"==typeof a.x&&"number"==typeof a.y&&(this.x+=a.x,this.y+=a.y):2===arguments.length&&"number"==typeof a&&"number"==typeof b&&(this.x+=a,this.y+=b),this}),"undefined"==typeof createjs.DisplayObject.prototype.scale&&(createjs.DisplayObject.prototype.scale=function(a,b){return 1===arguments.length?"number"==typeof a&&(this.scaleX=a,this.scaleY=a):2===arguments.length&&"number"==typeof a&&"number"==typeof b&&(this.scaleX=a,this.scaleY=b),this})),"undefined"==typeof Math.circClamp&&(Math.circClamp=function(a){for(;0>a;)a+=2*Math.PI;for(;a>2*Math.PI;)a-=2*Math.PI;return a}),"undefined"==typeof Math.randomRange&&(Math.randomRange=function(a,b){return a+Math.random()*(b-a)}),"undefined"==typeof Math.radToDeg&&Object.defineProperty(Math,"radToDeg",{get:function(){return 57.2958}}),"undefined"==typeof Math.degToRad&&Object.defineProperty(Math,"degToRad",{get:function(){return.01745}}),"undefined"==typeof Math.Epsilon&&Object.defineProperty(Math,"Epsilon",{get:function(){return 1e-4}}),"undefined"==typeof Math.rndBool&&Object.defineProperty(Math,"rndBool",{get:function(){return Math.random()>.5}}),"undefined"==typeof Math.lerp&&(Math.lerp=function(a,b,c){return c>1?b:a+c*(b-a)}),"undefined"==typeof Math.lerpPoint&&(Math.lerpPoint=function(a,b,c){return{x:Math.lerp(a.x,b.x,c),y:Math.lerp(a.x,b.x,c)}}),"undefined"==typeof Math.lerpAngel&&(Math.lerpAngel=function(a,b,c){var d,e=b-a;for(e>180?e-=360:-180>e&&(e+=360),d=a+e*c;d>180;)d-=360;for(;-180>d;)d+=360;return d}),"undefined"==typeof Math.sign&&(Math.sign=function(a){return 0>a?-1:1}),"undefined"==typeof Math.moveTowardsValue&&(Math.moveTowardsValue=function(a,b,c){return Math.abs(b-a)<=c?b:a+Math.sign(b-a)*c}),"undefined"==typeof Math.moveTowards&&(Math.moveTowards=function(a,b,c){if("number"==typeof a&&"number"==typeof b)return Math.moveTowardsValue(a,b,c);if("object"==typeof a&&"object"==typeof b&&"number"==typeof a.x&&"number"==typeof b.x&&"number"==typeof a.y&&"number"==typeof b.y){var d={x:b.x-a.x,y:b.y-a.y},e=Math.magnitude(d);if(c>=e||0===e)return{x:b.x,y:b.y};var f={x:a.x+d.x/e*c,y:a.y+d.y/e*c};return f}Console.warn("moveTowards:: invalid input. expecting two numbers or points")}),"undefined"==typeof Math.smoothStep&&(Math.smoothStep=function(a,b,c){return c=Math.Clamp01(c),c=-2*c*c*c+3*c*c,b*c+a*(1-c)}),"undefined"==typeof Math.Clamp01&&(Math.Clamp01=function(a){return 0>a?0:a>1?1:a}),"undefined"==typeof Math.magnitude&&(Math.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)}),"undefined"==typeof Math.normalize&&(Math.normalize=function(a,b){b=b||1;var c=Math.magnitude(a);return"number"==typeof b?{x:a.x/c*b,y:a.y/c*b}:{x:a.x/c,y:a.y/c}}),"undefined"==typeof Math.repeat&&(Math.repeat=function(a,b){return a-Math.floor(a/b)*b}),"undefined"==typeof Math.angleDiff&&(Math.angleDiff=function(a,b){for(var c=b-a;c<-Math.PI;)c+=2*Math.PI;for(;c>Math.PI;)c-=2*Math.PI;return c}),"undefined"==typeof Math.cordsOnElypse&&(Math.cordsOnElypse=function(a,b){var c=a.center.x-a.width*Math.sin(b)*Math.sin(0*Math.PI)+a.width*Math.cos(b)*Math.cos(0*Math.PI),d=a.center.y+a.height*Math.cos(b)*Math.sin(0*Math.PI)+a.height*Math.sin(b)*Math.cos(0*Math.PI);return{x:c,y:d}}),"undefined"==typeof Math.Elypse&&(Math.Elypse=function(a,b,c,d){return{center:{x:a,y:b},width:c,height:d}}),"undefined"==typeof window.innerWidth&&("undefined"!=typeof document.documentElement.clientWidth?window.innerWidth=document.documentElement.clientWidth:"undefined"!=typeof document.body.clientWidth&&(window.innerWidth=document.documentElement.clientWidth)),"undefined"==typeof window.innerHeight&&("undefined"!=typeof document.documentElement.clientHeight?window.innerHeight=document.documentElement.clientHeight:"undefined"!=typeof document.body.clientHeight&&(window.innerHeight=document.documentElement.clientHeight)),Signal.prototype={VERSION:"::VERSION_NUMBER::",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,b,c,d){var e,f=this._indexOfListener(a,c);if(-1!==f){if(e=this._bindings[f],e.isOnce()!==b)throw new Error("You cannot add"+(b?"":"Once")+"() then add"+(b?"Once":"")+"() the same listener without removing the relationship first.")}else e=new SignalBinding(this,a,b,c,d),this._addBinding(e);return this.memorize&&this._prevParams&&e.execute(this._prevParams),e},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var c,d=this._bindings.length;d--;)if(c=this._bindings[d],c._listener===a&&c.context===b)return d;return-1},has:function(a,b){return-1!==this._indexOfListener(a,b)},add:function(a,b,c){return validateListener(a,"add"),this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){return validateListener(a,"addOnce"),this._registerListener(a,!0,b,c)},remove:function(a,b){validateListener(a,"remove");var c=this._indexOfListener(a,b);return-1!==c&&(this._bindings[c]._destroy(),this._bindings.splice(c,1)),a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(this.active){var b,c=Array.prototype.slice.call(arguments),d=this._bindings.length;if(this.memorize&&(this._prevParams=c),d){b=this._bindings.slice(),this._shouldPropagate=!0;do d--;while(b[d]&&this._shouldPropagate&&b[d].execute(c)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var signals=Signal;signals.Signal=Signal,SignalBinding.prototype={active:!0,params:null,execute:function(a){var b,c;return this.active&&this._listener&&(c=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,c),this._isOnce&&this.detach()),b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},function(a){"function"==typeof define&&define.amd?define(function(){return signals}):"undefined"!=typeof module&&module.exports?module.exports=signals:a.signals=signals}(this),function(){var a=function(a){app.vo=app.vo||{}};a.prototype;namespace("wam.audio").GameAudio=a}(),function(){var a=function(a){app.vo=app.vo||{},this._missionReqs=a};a.prototype;namespace("wam.audio").MenuAudio=a}(),function(){var a=function(a,b){this._menuPanel=a,this._shipModel=b,this._shipView=a.shipView,this._decoOptions=a.decoOptions,this._selectedModel=null,this.initSignals(),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerDown=this.onPointerDown.bind(this),app.display.stage.addEventListener("stagemousedown",this.onPointerDown),app.display.stage.addEventListener("stagemouseup",this.onPointerUp)},b=a.prototype;b.initSignals=function(){var a=this;app.signals.startDrag=new Signal,app.signals.startDrag.add(function(b){a.onDragStart(b)}),app.signals.tapMenuPiece=new Signal,app.signals.tapMenuPiece.add(function(b){a.onMenuPieceTap(b)}),app.signals.bgTap=new Signal,app.signals.bgTap.add(function(){a._decoOptions.close()}),app.signals.addDeco.add(function(b){a._shipView.addDeco(b),setTimeout(function(){a._decoOptions.onTapDeco(b)},20)}),app.signals.removeDeco.add(function(b){a._shipModel.removeDeco(b),a._shipView.removeDeco(b),a._decoOptions.close()}),app.signals.startDragDeco=new Signal,app.signals.startDragDeco.add(function(b){a.onDecoDragStart(b)}),app.signals.tapDeco=new Signal,app.signals.tapDeco.add(function(b){var c=a._shipModel.getDecoById(b);a._decoOptions.onTapDeco(c),a._menuPanel.shipView.showDeco()}),app.signals.tapDecoMove=new Signal,app.signals.tapDecoMove.add(function(b){a._decoOptions.close(),a.onDecoDragStart(b)}),app.signals.tapDecoFlip=new Signal,app.signals.tapDecoFlip.add(function(b){a._shipModel.flipDeco(b),a._shipView.updateDeco(a._shipModel.getDecoById(b))}),app.signals.rotateDeco=new Signal,app.signals.rotateDeco.add(function(b,c){a._shipModel.rotateDeco(b,c),a._shipView.updateDeco(a._shipModel.getDecoById(b))})},b.onPointerDown=function(){},b.onPointerUp=function(){this._selectedModel&&(this._menuPanel.dragView.stopDrag(),this.tryPlacePart(this.pointer))},b.onMenuPieceTap=function(a){var b=this;setTimeout(function(){"deco"!==a.partType?b.updateShipPart(a):(b._selectedModel=a,b._menuPanel.bgPlane.setVisible(!0),b._menuPanel.dragView.startDrag(a))},50)},b.onDragStart=function(a){this._selectedModel=a,this._menuPanel.dragView.startDrag(a)},b.onDecoDragStart=function(a){var b=this._shipModel.getDecoById(a);this.onDragStart(b),app.signals.removeDeco.dispatch(a)},b.tryPlacePart=function(a){if(this._selectedModel){var b=this._selectedModel.partType;this.isLegitPosition(b,a)&&this.updateShipPart(this._selectedModel,a),this.resetBuildSystem()}},b.isLegitPosition=function(a,b){return b.x>420&&b.x<850&&b.y>-25&&b.y<620},b.updateShipPart=function(a,b){"deco"!==a.partType?this._shipModel.changeCorePart(a):this._shipModel.changeDeco(a,b)},Object.defineProperty(b,"pointer",{get:function(){return Utils.isTouchDevice?{x:app.pointer.x,y:app.pointer.y-100}:{x:app.pointer.x,y:app.pointer.y}}}),b.resetBuildSystem=function(){this._selectedModel=null,this._menuPanel.dragView.stopDrag(),this._menuPanel.bgPlane.setVisible(!1),this._decoOptions.close()},b.teardown=function(){app.display.stage.removeEventListener("stagemousedown",this.onPointerDown),app.display.stage.removeEventListener("stagemouseup",this.onPointerUp)},namespace("wam.input").BuildSystem=a}(),function(){var a,b=function(a){this.init(a)},c=b.prototype,d=150,e=350,f=300,g=260,h=500,i=400;Object.defineProperty(c,"isZooming",{get:function(){return this.timeSinceDown>d}}),Object.defineProperty(c,"ZoomProgress",{get:function(){return this.zoomProgress}}),Object.defineProperty(c,"CamRect",{get:function(){return this.calculateRect()}}),c.init=function(b){this.inputEnabled=!0,this.zoomEnabled=!0,this.timeSinceDown=0,this.pointerIsDown=!1,this.zoomProgress=0,this.pointer={x:0,y:0},a=b.panel.parent,a.addEventListener("stagemousedown",this.onPointerPress.bind(this)),a.addEventListener("stagemouseup",this.onPointerRelease.bind(this))},c.update=function(a){this.updateZoom(a),app.signals.updateCamZoom.dispatch(this.zoomProgress,this.CamRect)},c.updateZoom=function(a){this.pointer.x=Math.lerp(this.pointer.x,app.pointer.x,a/75),this.pointer.y=Math.lerp(this.pointer.y,app.pointer.y,a/75),this.pointerIsDown&&this.inputEnabled&&(this.timeSinceDown+=a),this.calculateZoom()},c.calculateZoom=function(){var a=0;if(this.zoomEnabled)if(this.timeSinceDown<d)a=Math.lerp(this.zoomProgress,0,.1);else if(this.timeSinceDown>e){if(a=1,!this.zoomSoundPlayed){this.zoomSoundPlayed=!0;var b=Math.floor(Math.randomRange(1,2));app.sound.play("zoom-"+b)}}else a=(this.timeSinceDown-d)/(e-d);this.zoomProgress=a},c.onPointerPress=function(a){this.timeSinceDown=0,this.zoomSoundPlayed=!1,this.pointer.x=app.pointer.x,this.pointer.y=app.pointer.y,this.inputEnabled&&(this.pointerIsDown=!0)},c.onPointerRelease=function(a){this.pointerIsDown=!1,this.timeSinceDown=0,this.inputEnabled&&app.signals.onPointerRelease.dispatch()},c.calculateRect=function(){var a={x1:this.pointer.x-Math.lerp(f,h,this.zoomProgress)/2,y1:this.pointer.y-Math.lerp(g,i,this.zoomProgress)/2,x2:this.pointer.x+Math.lerp(f,h,this.zoomProgress)/2,y2:this.pointer.y+Math.lerp(g,i,this.zoomProgress)/2};return this.clampRectOnScreen(a)},c.clampRectOnScreen=function(a){var b=app._scaleOffset/app._scale;b+=10,a.x1<b?(a.x2-=a.x1-b,a.x1=b):a.x2>1280-b&&(a.x1-=a.x2-(1280-b),a.x2=1280-b);var c=105;return a.y1<c?(a.y2-=a.y1-c,a.y1=c):a.y2>720&&(a.y1-=a.y2-720,a.y2=720),a},c.teardown=function(){a.removeAllEventListeners()},namespace("wam.input").CameraInput=b}(),function(){var a=include("springroll.DelayedCall"),b=function(a,b,c){this._tapCallback=b,this._dragCallback=c,this.init(a)},c=b.prototype;c.init=function(a){this._displayObj=a,this._triggerTap=!1,this._touchPos={x:NaN,y:NaN},this._onPointerDown=this._onPointerDown.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onHoldPressed=this._onHoldPressed.bind(this),this._displayObj.addEventListener("mousedown",this._onPointerDown),app.display.stage.addEventListener("stagemouseup",this._onPointerUp)},c._onPointerDown=function(){this._triggerTap=!0,this._touchPos.x=app.pointer.x,this._touchPos.y=app.pointer.y,this._delayedCall=new a(this._onHoldPressed,200)},c._onHoldPressed=function(){this._triggerTap=!1,this._dragCallback&&this._dragCallback()},c._onPointerUp=function(){this._triggerTap&&this._hasNotMoved&&this._tapCallback&&this._tapCallback(),this._triggerTap=!1,this._delayedCall&&this._delayedCall.destroy()},c.teardown=function(){this._delayedCall&&this._delayedCall.destroy(),this._displayObj.removeAllEventListeners(),app.display.stage.removeEventListener("stagemouseup",this._onPointerUp)},Object.defineProperty(c,"_hasNotMoved",{get:function(){return Math.distSq(this._touchPos,app.pointer)<5625}}),namespace("wam.input").DragTrigger=b}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=include("createjs.Tween"),d=include("createjs.Ease"),e=function(b){a.call(this),this._removeImg(),this._bgPlane=b},f=(a.prototype,extend(e,a));f.startDrag=function(a){this._removeImg(),this._img=new b(images[a.partName]),this._img.mouseEnabled=!1;var e="deco"===a.partType?1:.5;this._img.scale(e),this._img.reg(.5),this._img.scaleX=a.flipped?-e:e,this._img.rotation=a.rotation,this._img.setPos(app.pointer),this.addChild(this._img),this._offset=0,c.removeTweens(this),Utils.isTouchDevice&&c.get(this).to({_offset:-100},200,d.quadOut),this._img.alpha=0},f.stopDrag=function(){c.removeTweens(this),this._img&&c.removeTweens(this._img),this._removeImg()},f._removeImg=function(){this._img&&(this.removeChild(this._img),this._img=null)},f.update=function(){this.dragging&&this.updatePos()},f.updatePos=function(){this._img.setPos(app.pointer.x,app.pointer.y+this._offset),app.pointer.x>410&&(this._bgPlane.setVisible(!0),0===this._img.alpha&&c.get(this._img).to({alpha:.5},200,d.quadOut))},Object.defineProperty(f,"dragging",{get:function(){return this._img}}),namespace("wam.input").DragView=e}(),function(){var a=new springroll.ApplicationPlugin;a.setup=function(){this.onMouseDown=a.onMouseDown.bind(this)},a.preload=function(a){var b={x:640,y:320};Object.defineProperty(app,"pointer",{get:function(){return app.display.stage.mouseInBounds&&(b.x=app.display.stage.mouseX+(app._scaleOffset||0),b.y=app.display.stage.mouseY,b.x/=app._scale||1,b.y/=app._scale||1),b}}),app.display.stage.addEventListener("stagemousedown",this.onMouseDown),a()},a.onMouseDown=function(a){app.display.stage._primaryPointerID=a.pointerID},a.teardown=function(){app.display&&app.display.stage.removeEventListener("stagemousedown",this.onMouseDown)}}(),function(){var a=function(){app=app||{},app.signals={},this.active=!1},b=a.prototype;b.addSignal=function(a,b){app.signals[a]=new Signal,app.signals[a].add(b)},Object.defineProperty(b,"active",{set:function(a){for(var b in app.signals)app.signals.hasOwnProperty(b)&&(app.signals[b].active=a)}}),namespace("wam.signals").BaseSignals=a}(),function(){var a=include("wam.signals.BaseSignals"),b=function(b,c){a.call(this),this.init(b,c)},c=(a.prototype,extend(b,a));c.init=function(a,b){this.addSignal("returnToMenu",function(){this.active=!1,a.previousState()}),this.addSignal("replay",function(){this.active=!1,a.manager.state="game"}),this.addSignal("addScore",function(b){a.addScore(b)}),this.addSignal("setScore",function(b){a.setScore(b)}),this.addSignal("onPointerRelease",function(){a.onPointerRelease()}),this.addSignal("updateCamZoom",function(b,c){a.updateCamZoom(b,c)}),this.addSignal("addStar",function(a,c,d){b.starCont.addStar(a,c,d)})},namespace("wam.signals").GameSignals=b}(),function(){var a=include("wam.signals.BaseSignals"),b=function(b,c){a.call(this),this.init(b,c)},c=(a.prototype,extend(b,a));c.init=function(a,b){this.addSignal("onPressPlay",function(){a.onPressPlay()}),this.addSignal("onLevelSelect",function(b){a.onLevelSelect(b)})},namespace("wam.signals").MenuSignals=b}(),function(){var a=include("wam.signals.BaseSignals"),b=function(b,c){a.call(this),this.init(b,c)},c=(a.prototype,extend(b,a));c.init=function(a,b){this.addSignal("returnToMenu",function(){a.previousState(),this.active=!1}),this.addSignal("addScore",function(b){a.addScore(b)}),this.addSignal("setScore",function(b){a.setScore(b)}),this.addSignal("onPointerRelease",function(){a.onPointerRelease()}),this.addSignal("updateCamZoom",function(b,c){a.updateCamZoom(b,c)}),this.addSignal("addStar",function(a,c,d){b.starCont.addStar(a,c,d)})},namespace("wam.signals").TutorialSignals=b}(),function(){function a(a,b,c){var d,e,f,g,h,i,j,k;if(a=Math.max(0,Math.min(360,a)),b=Math.max(0,Math.min(100,b)),c=Math.max(0,Math.min(100,c)),b/=100,c/=100,0===b)return d=e=f=c,[Math.round(255*d),Math.round(255*e),Math.round(255*f)];switch(a/=60,g=Math.floor(a),h=a-g,i=c*(1-b),j=c*(1-b*h),k=c*(1-b*(1-h)),g){case 0:d=c,e=k,f=i;break;case 1:d=j,e=c,f=i;break;case 2:d=i,e=c,f=k;break;case 3:d=i,e=j,f=c;break;case 4:d=k,e=i,f=c;break;default:d=c,e=i,f=j}return[Math.round(255*d),Math.round(255*e),Math.round(255*f)]}var b=include("createjs.Container"),c=include("createjs.Bitmap"),d=include("createjs.Text"),e=function(a){b.call(this),this.init()},f=(b.prototype,extend(e,b));f.init=function(){var a=new c(images.hud_battery_base);a.setPos(960,57),this.addChild(a),this.fill=new c(images.batteryFill),this.fill.setPos(1e3,64),this.fill.scale(1,1.1),this.addChild(this.fill),this.label=new d("--","50px DKButterflyBall","#437d84"),this.label.textAlign="right",this.label.x=955,this.label.y=60,this.addChild(this.label)},f.updateBattery=function(b){this.label.text=""+b;var c=b/app.config.gameVars.clicks,d=Math.lerp(160,0,1-c),e=Math.lerp(100,84,1-c),f=Math.lerp(83,60,1-c),g=a(d,e,f);this.fill.scaleX=c,this.fill.filters=[new createjs.ColorFilter(0,0,0,1,g[0],g[1],g[2],1)],this.fill.cache(0,0,150,50)},namespace("wam.ui").BatteryView=e}(),function(){var a=include("createjs.Container"),b=include("springroll.DelayedCall"),c=include("createjs.Tween"),d=include("createjs.Ease"),e=include("createjs.Bitmap"),f=function(b){a.call(this),this.init()},g=(a.prototype,extend(f,a)),h=.55;g.init=function(){this.animPlaying=!1,this.lvlNr=0,this.lvlStart=NaN,this.lvlEnd=NaN,this.getLvlBracket(),this.desiredScale=0,this.scoreBar=new e(images.fillbar),this.scoreBar.x=268,this.scoreBar.y=68,this.scoreBar.scale(0,1),this.addChild(this.scoreBar),this.badge=new e(images.badge1),this.badge.reg(.5),this.badge.x=810,this.badge.y=90,this.addChild(this.badge),this.replaceBadge=this.replaceBadge.bind(this),this.onAfterAnim=this.onAfterAnim.bind(this)},g.getLvlBracket=function(a){var b=app.config.gameVars.badgePoints;this.lvlStart=b[this.lvlNr],this.lvlEnd=b[this.lvlNr+1]},g.updateScore=function(a,c){var e=Math.lerp(500,1300,c);if(this.tmpValue=a,!this.animPlaying)if(a<this.lvlEnd){var f=(a-this.lvlStart)/(this.lvlEnd-this.lvlStart);this.tweenBar(e,f)}else if(this.scoreBar.scaleX<h&&(this.tweenBar(e,1,500),this.animPlaying=!0,this.popBadge(e+300)),this.lvlNr<2){this.lvlNr++;var g=this;new b(function(){g.tweenBar(0,0,500,d.circInOut)},2e3)}},g.tweenBar=function(a,b,e,f){b*=h,this.scoreBar.scaleX!=b&&(e=e||500,f=f||d.bounceOut,c.get(this.scoreBar,{override:!0}).wait(a).to({scaleX:b},e,f))},g.popBadge=function(a){var e=this;new b(function(){e.badge.setPos(640,360),e.badge.scale(1),c.get(e.badge,{override:!0}).to({scaleX:2,scaleY:2},300,d.bounceOut).call(function(){app.sound.play("badge")}).wait(400).to({scaleX:1,scaleY:1,x:810,y:90},500,d.bounceOut).call(e.onAfterAnim)},a)},g.onAfterAnim=function(){this.getLvlBracket(),this.animPlaying=!1,this.tmpValue!=this.lvlStart&&this.updateScore(this.tmpValue,0),this.replaceBadge()},g.replaceBadge=function(){this.badge.image=images["badge"+(this.lvlNr+1)]},g.teardown=function(){c.removeAllTweens()},namespace("wam.ui").ScoreView=f}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(b){a.call(this),this.init(b)},d=(a.prototype,extend(c,a));d.init=function(a){this.setPos(640,360),this.scale(1.5),this._scale=0,this.lines=[];for(var b=10,c=0;b>c;c++)this.addLine(c/b)},d.addLine=function(a){var c=new b(images.starBurst);c.reg(0,.5),c.rotation=360*a,this.addChild(c),this.lines.push(c)},d.update=function(a){this.rotation+=.02*a,this._scale+=.005*a;for(var b=(1+Math.sin(this._scale))/2,c=0;c<this.lines.length;c++)this.lines[c].scaleY=Math.lerp(1,1.5,b)},namespace("wam.ui").Starburst=c}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(b){a.call(this),this.init()},d=(a.prototype,extend(c,a));d.init=function(){this.x2=new b(images.multiplier_x1),this.x2.reg(.5,1),this.addChild(this.x2),this.zoomer=new b(images.zoomer),this.zoomer.reg(.5),this.zoomer.scale(.5),this.addChild(this.zoomer),this.zoomMax=new b(images.zoom_min),this.zoomMax.reg(1,0)},d.updateRect=function(a,b){this.x2.x=b.x1+(b.x2-b.x1)/2,this.x2.y=b.y2,this.x2.scale(Math.lerp(.5,1,a)),this.x2.image=a>.95?images.multiplier_x2:images.multiplier_x1,this.zoomer.x=b.x1+(b.x2-b.x1)/2,this.zoomer.y=b.y1+(b.y2-b.y1)/2,this.zoomer.scale(Math.lerp(.5,.8,a)),this.zoomer.rotation=Math.lerp(0,45,a),this.zoomMax.x=b.x2-25,this.zoomMax.y=b.y1+25,this.zoomMax.image=a>.95?images.zoom_max:images.zoom_min},namespace("wam.views").Zoomer=c}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(b){a.call(this),this.init(),this.setBounds(null)},d=(a.prototype,extend(c,a));d.init=function(){this.img=new b(images.white),this.img.scaleX=64,this.img.scaleY=36,this.addChild(this.img)},d.flash=function(){this.img.alpha=.8},d.update=function(a){this.img.alpha>0&&(this.img.alpha-=.004*a)},namespace("wam.views").Flash=c}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(b){a.call(this),this.init()},d=(a.prototype,extend(c,a)),e=20;d.init=function(){this.top=new b(images.black),this.top.reg(0,1),this.addChild(this.top),this.bot=new b(images.black),this.bot.reg(0,0),this.addChild(this.bot),this.left=new b(images.black),this.left.reg(0,0),this.left.x=-200,this.left.scaleY=720,this.addChild(this.left),this.right=new b(images.black),this.right.x=1280,this.right.scaleY=720,this.addChild(this.right),this.cache(0,0,1280,720)},d.updateRect=function(a,b){this.alpha=1,this.top.x=b.x1-10,this.top.y=b.y1,this.top.scaleX=(b.x2-b.x1)/e*1.1,this.top.scaleY=b.y1/e,this.bot.x=b.x1-10,this.bot.y=b.y2,this.bot.scaleX=(b.x2-b.x1)/e*1.1,this.bot.scaleY=(720-b.y2)/e,this.left.scaleX=(b.x1+200)/e,this.right.x=b.x2,this.right.scaleX=800,this.updateCache(),this.alpha=Math.min(1,2*a)},namespace("wam.views").BlackFrame=c}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(b){a.call(this),this.init()},d=(a.prototype,extend(c,a));d.init=function(){this.stars=[],this.addStar(3)},d.addStar=function(a){for(var c;a>0;)a--,c=new b(images.starOutline),c.reg(.5),c.scale(.5),this.addChild(c),this.stars.push(c)},d.updateAnimalCount=function(a,b){this.updateStar(0,a>=1,b),this.updateStar(1,a>=2,b),this.updateStar(2,a>=3,b)},d.updateStar=function(a,b,c){b?this.stars[a].image=c>.95?images.starRetGold:images.starRetSilv:this.stars[a].image=images.starRetNone},d.updateRect=function(a,b){var c=90*a;this.stars[0].setPos(b.x1+90+c,b.y1+20),this.stars[1].setPos(b.x1+140+c,b.y1+20),this.stars[2].setPos(b.x1+190+c,b.y1+20)},namespace("wam.views").ReticleStars=c}(),function(){var a=include("createjs.Bitmap"),b=function(b,c,d){d=d||1,this.img=new a(images[c]),this.img.reg(.5),this.img.scaleX=this.img.scaleY=d,this.cont=b,this.hideMe=!1,this.cont.addChild(this.img)},c=b.prototype;Object.defineProperty(c,"lookingDir",{set:function(a){this.img.scaleX*=a}}),c.updateView=function(a,b,c){this.img.x=b,this.img.y=c,this.hideMe&&(this.img.alpha-=a*app.timeScale*.01)},c.hide=function(){this.hideMe=!0},c.teardown=function(){this.cont.removeChild(this.img)},namespace("wam.views").AnimalView=b}(),function(){var a=include("createjs.Bitmap"),b=function(b){this.frameCount=0,this.col=d[Math.floor(Math.random()*d.length)],this.img=new a(images["ani_bird_"+this.col+"_"+this.lastFrame]),this.img.reg(.5),this.img.scale(Math.randomRange(.7,1)),b.addChild(this.img),this.isAnimating=!0},c=b.prototype,d=["blue","red","yellow"];Object.defineProperty(c,"lookingDir",{set:function(a){this.img.scaleX*=a}}),c.updateBirdView=function(a,b,c){this.img.x=b,this.img.y=c,this.updateFrame(a)},c.updateFrame=function(a){if(this.isAnimating){this.frameCount+=a*app.timeScale*.01;var b=Math.floor(this.frameCount)%5;this.lastFrame!=b&&(this.lastFrame=b,this.img.image=images["ani_bird_"+this.col+"_"+this.lastFrame])}},c.stopAnim=function(){this.isAnimating=!1,this.img.image=images["ani_bird_"+this.col+"_4"]},c.hide=function(){this.img.visible=!1},c.teardown=function(a){a.removeChild(this.img)},namespace("wam.views").BirdView=b}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(c,d){this.parent=c,this.cont=new a,this.cont.scale(.5),this.body=new b(images["ani_"+d+"_0"]),this.cont.addChild(this.body),this.eyes=new b(images["ani_"+d+"_1"]),this.eyes.visible=!1,this.cont.addChild(this.eyes),"dot"===d?this.eyes.setPos(152,37):"dev"===d?this.eyes.setPos(85,82):"nev"===d?this.eyes.setPos(102,165):"ruby"===d&&this.eyes.setPos(76,80),this.hideMe=!1,c.addChild(this.cont)},d=c.prototype;Object.defineProperty(d,"lookingDir",{set:function(a){this.cont.scaleX*=a}}),d.updateView=function(a,b,c){this.cont.x=b,this.cont.y=c,this.hideMe&&(this.cont.alpha-=a*app.timeScale*.01)},d.hide=function(){this.hideMe=!0},d.teardown=function(){this.parent.removeChild(this.cont)},namespace("wam.views").ChildView=c}(),function(){var a,b,c,d,e=include("createjs.Container"),f=include("createjs.Bitmap"),g=function(a){e.call(this),this.init()},h=(e.prototype,extend(g,e));h.init=function(){a=new f(images.reticule_tl),a.reg(.1,.1),this.addChild(a),b=new f(images.reticule_bl),b.reg(.1,.9),this.addChild(b),c=new f(images.reticule_tr),c.reg(.9,.1),this.addChild(c),d=new f(images.reticule_br),d.reg(.9,.9),this.addChild(d)},h.updateRect=function(e,f){a.setPos(f.x1,f.y1),b.setPos(f.x1,f.y2),c.setPos(f.x2,f.y1),d.setPos(f.x2,f.y2);var g=Math.lerp(.7,1,e);a.scale(g),b.scale(g),c.scale(g),d.scale(g)},namespace("wam.views").Corners=g}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=function(c,d){d=d||1,this.moose=new a,this.moose.scale(d),c.addChild(this.moose),this.frameCount=0,this.img=new b(images.ani_moose_0),this.img.reg(.5),this.yawnCount=0,this.mouth=new b(images.ani_moose_1),this.mouth.visible=!1,this.mouth.x=62,this.mouth.y=-68,this.moose.addChild(this.img),this.moose.addChild(this.mouth)},d=c.prototype;Object.defineProperty(d,"lookingDir",{set:function(a){this.moose.scaleX*=a}}),d.updateMooseView=function(a,b,c){this.moose.x=b,this.moose.y=c,this.updateYawn(a)},d.updateYawn=function(a){this.yawnCount>0&&(this.yawnCount-=a*app.timeScale*.001,this.yawnCount>.7?(this.mouth.visible=!0,this.mouth.image=images.ani_moose_1):this.yawnCount>.4?this.mouth.image=images.ani_moose_2:this.yawnCount>.1?this.mouth.image=images.ani_moose_1:this.mouth.visible=!1)},d.yawn=function(){this.yawnCount=1},d.hide=function(){this.moose.visible=!1},d.teardown=function(a){a.removeChild(this.moose),this.mouth=new b(images.ani_moose_1)},namespace("wam.views").MooseView=c}(),function(){var a=include("createjs.Container"),b=include("wam.views.BlackFrame"),c=include("wam.views.Corners"),d=include("wam.views.ReticleStars"),e=include("springroll.DelayedCall"),f=include("wam.views.Zoomer"),g=function(b){a.call(this),this.init(),this.setBounds(null)},h=(a.prototype,extend(g,a));h.init=function(){this.blackFrame=new b,this.addChild(this.blackFrame),this.corners=new c,this.addChild(this.corners),this.zoomer=new f,this.addChild(this.zoomer),this.reticleStars=new d,this.addChild(this.reticleStars)},h.setVisible=function(a,b){if(b){var c=this;new e(function(){c.visible=a},b)}else this.visible=a},h.onGameEnd=function(){this.visible=!1},h.updateRect=function(a,b){this.blackFrame.updateRect(a,b),this.corners.updateRect(a,b),this.reticleStars.updateRect(a,b),this.zoomer.updateRect(a,b)},namespace("wam.views").Reticle=g}(),function(){var a=include("createjs.Bitmap"),b=function(b){this.frameCount=0,this.img=new a(images.ani_scratch_0),this.img.reg(.5),this.img.scale(.8),b.addChild(this.img)},c=b.prototype;Object.defineProperty(c,"lookingDir",{set:function(a){this.img.scaleX*=a}}),c.updateView=function(a,b,c){this.img.x=b,this.img.y=c,this.updateFrame(a)},c.updateFrame=function(a){this.frameCount+=a*app.timeScale*.01;var b=Math.floor(this.frameCount)%11;this.lastFrame!=b&&(this.lastFrame=b,this.img.image=images["ani_scratch_"+this.lastFrame])},c.hide=function(){this.img.visible=!1},c.teardown=function(a){a.removeChild(this.img)},namespace("wam.views").ScratchView=b}(),function(){var a,b,c,d,e=include("createjs.Container"),f=include("createjs.Bitmap"),g=include("wam.views.BlackFrame"),h=function(a){e.call(this),this.init()},i=(e.prototype,extend(h,e));i.init=function(){blackFrame=new g,this.addChild(blackFrame),
a=new f(images.pxl),a.reg(0,.5),this.addChild(a),b=new f(images.pxl),b.reg(0,.5),this.addChild(b),c=new f(images.pxl),c.reg(.5,0),this.addChild(c),d=new f(images.pxl),d.reg(.5,0),this.addChild(d)},i.updateRect=function(e,f){blackFrame.updateRect(e,f),this.alpha=1,a.x=f.x1,a.y=f.y1,a.scaleX=(f.x2-f.x1)/5,b.x=f.x1,b.y=f.y2,b.scaleX=(f.x2-f.x1)/5,c.x=f.x1,c.y=f.y1,c.scaleY=(f.y2-f.y1)/5,d.x=f.x2,d.y=f.y1,d.scaleY=(f.y2-f.y1)/5},i.hide=function(){this.alpha=.1},namespace("wam.views").ShotSizeDebug=h}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=include("createjs.Tween"),d=function(b){a.call(this),this.init()},e=(a.prototype,extend(d,a));e.init=function(){this.stars=[],this.removeAfterAnim=this.removeAfterAnim.bind(this)},e.update=function(a){},e.addStar=function(a,b,c){if(.95>c)this._addStar(a,a,b,c);else{var d={x:a.x+50-100*Math.random(),y:a.y+50-100*Math.random()},e=b+50-100*Math.random();this._addStar(a,d,e,c),d={x:a.x+50-100*Math.random(),y:a.y+50-100*Math.random()},e=b+50-100*Math.random(),this._addStar(a,d,b,c)}},e._addStar=function(a,d,e,f){var g=new b(f>.95?images.starRetGold:images.starRetSilv);g.reg(.5),g.scale(.5),g.setPos(a),this.addChild(g);c.get(g).wait(100*Math.random()).to({scaleX:1,scaleY:1,alpha:1,x:d.x,y:d.y},150).call(function(){app.sound.play("star")}).wait(e).to({x:300,y:50,scaleX:.5,scaleY:.5,alpha:0},300).call(this.removeAfterAnim)},e.removeAfterAnim=function(a){this.removeChild(a.target)},namespace("wam.views").StarCont=d}(),function(){var a=function(a){this._cont=a,this._removeMe=!1,this.view=null,this.x=NaN,this.y=NaN},b=a.prototype;Object.defineProperty(b,"pos",{get:function(){return{x:this.x,y:this.y}}}),Object.defineProperty(b,"isActive",{get:function(){return!this._removeMe}}),b.update=function(a){},b.takePhoto=function(){this.removeAnimal()},b.removeAnimal=function(){this._removeMe=!0,this.view.hide()},b.teardown=function(){this.view.teardown(this._cont)},namespace("wam.models").Animal=a}(),function(){var a=include("wam.views.BirdView"),b=function(b,c,d){this._cont=b,this.view=new a(this._cont),this.init(c,d)},c=b.prototype;Object.defineProperty(c,"pos",{get:function(){return{x:this.x,y:this.y}}}),Object.defineProperty(c,"isActive",{get:function(){return!this._removeMe}});var d=1280;c.init=function(a,b){Math.random()>.5?(this.x=-50,this.dir=1):(this.x=d+50,this.dir=-1),this.baseHeight=a||200+250*Math.random(),this.y=this.baseHeight,this.oscillationFrequency=50+100*Math.random(),this.oscillationMagnitude=b||50+100*Math.random(),this.speed=Math.randomRange(.1,.15),this.view.lookingDir=this.dir},c.takePhoto=function(){this.removeBird()},c.update=function(a){this.x+=this.dir*this.speed*(a*app.timeScale),this.y=this.baseHeight+Math.sin(this.x/this.oscillationFrequency)*this.oscillationMagnitude,(this.x<-60||this.x>d+60)&&this.removeBird(),this.view.updateBirdView(a,this.x,this.y)},c.removeBird=function(){this._removeMe=!0,this.view.hide()},c.teardown=function(){this.view.teardown(this._cont)},namespace("wam.models").Bird=b}(),function(){var a=include("wam.models.Animal"),b=include("wam.views.MooseView"),c=include("createjs.Tween"),d=function(c,d){a.call(this,c),this.yawnCount=0,this.view=new b(c,.7),this.onAfterAnim=this.onAfterAnim.bind(this),this.init(d)},e=(a.prototype,extend(d,a));e.init=function(a){this.view.lookingDir=Math.random()>.5?1:-1,this.x=a?650:Math.randomRange(400,800),this.y=700,this.update(0),a?c.get(this).to({y:520},300).affectedByGame=!0:c.get(this).to({y:520},300).wait(1500).to({y:700},300).call(this.onAfterAnim).affectedByGame=!0},e.update=function(a){this.yawnCount-=a*app.timeScale,this.yawnCount<=0&&(this.yawnCount=Math.randomRange(4e3,7e3),this.view.yawn()),this.view.updateMooseView(a,this.x,this.y)},e.onAfterAnim=function(){this.removeAnimal()},namespace("wam.models").Moose=d}(),function(){var a=include("wam.views.BirdView"),b=include("wam.models.Animal"),c=include("createjs.Tween"),d=function(c){b.call(this,c),this.view=new a(c),this.init()},e=(b.prototype,extend(d,b));e.init=function(){this.x=-100,this.y=-100,this.update(0)},e.update=function(a){this.view.updateBirdView(a,this.x,this.y)},e.flyIn=function(a,b,d){this.x=a.x,this.y=a.y;var e=this;c.get(this).to({x:b.x,y:b.y},d).call(function(){e.view.stopAnim()})},namespace("wam.models").TutorialBird=d}(),function(){var a=include("wam.models.Animal"),b=include("wam.views.ChildView"),c=include("createjs.Tween"),d=include("createjs.Ease"),e=include("springroll.DelayedCall"),f=function(c){a.call(this,c),this.viewOffset={x:0,y:0},this.onAfterAnim=this.onAfterAnim.bind(this),this.blink=this.blink.bind(this);var d;do d=Math.floor(4*Math.random());while(d===g.lastChild);g.lastChild=d,this.view=new b(c,h[g.lastChild]),this.init()},g=(a.prototype,extend(f,a)),h=["dot","dev","nev","ruby"];g.lastLocation=0,g.lastChild="dot",g.init=function(){var a;do a=Math.floor(4*Math.random());while(a===g.lastLocation);g.lastLocation=a,0===a?this.fromCenterRight():1===a?this.fromRightWindow():2===a?this.fromDoor():this.fromCenterLeft()},g.fromCenterLeft=function(){this.x=520,this.y=450,this.view.lookingDir=-1,this.viewOffset.x=100,this.viewOffset.y=50,this.view.cont.reg(.5,1),c.get(this).to({x:500},500,d.bounceOut).wait(750).call(this.blink).wait(750).to({x:520},300,d.bounceOut).call(this.onAfterAnim).affectedByGame=!0,c.get(this.view.cont).to({rotation:-45},500,d.bounceOut).wait(1500).to({rotation:0},300,d.bounceOut).affectedByGame=!0},g.fromDoor=function(){this.x=220,this.y=450,this.view.lookingDir=1,this.viewOffset.x=-100,this.viewOffset.y=50,this.view.cont.reg(.5,1),c.get(this).to({x:280},500,d.bounceOut).wait(750).call(this.blink).wait(750).to({x:220},300,d.bounceOut).call(this.onAfterAnim).affectedByGame=!0,c.get(this.view.cont).to({rotation:45},500,d.bounceOut).wait(1500).to({rotation:0},300,d.bounceOut).affectedByGame=!0},g.fromCenterRight=function(){this.x=760,this.y=400,this.viewOffset.x=-100,this.viewOffset.y=50,this.view.cont.reg(.5,1),c.get(this.view.cont).to({rotation:45},500,d.bounceOut).wait(750).call(this.blink).wait(750).to({rotation:0},300,d.bounceOut).call(this.onAfterAnim).affectedByGame=!0},g.fromRightWindow=function(){this.x=1120,this.y=550,this.view.lookingDir=-1,this.view.cont.reg(.5),c.get(this).to({y:370},500,d.bounceOut).wait(750).call(this.blink).wait(750).to({y:550},300,d.bounceOut).call(this.onAfterAnim).affectedByGame=!0},g.blink=function(){var a=this.view.eyes;a.visible=!0,new e(function(){a.visible=!1},100)},g.onAfterAnim=function(){this.removeAnimal()},g.update=function(a){this.view.updateView(a,this.x+this.viewOffset.x,this.y+this.viewOffset.y)},namespace("wam.models").Child=f}(),function(){var a=include("wam.models.Animal"),b=include("wam.views.ScratchView"),c=include("createjs.Tween"),d=function(c){a.call(this,c),this.viewOffset={x:0,y:0},this.onAfterAnim=this.onAfterAnim.bind(this),this.view=new b(c,"ani_scratch_0",.5),this.init(location)},e=(a.prototype,extend(d,a));e.init=function(){"dogpark"===app.vars.location?this.runPast([-100,590],[1380,550],[NaN,450]):"lake"===app.vars.location&&this.runPast([-100,590],[1380,400],[NaN,300])},e.runPast=function(a,b,d){if(d[0]=a[0]+(b[0]-a[0])/2,Math.random()>.5){var e=[a[0],a[1]];a=[b[0],b[1]],b=[e[0],e[1]],this.view.lookingDir=-1}this.x=a[0],this.y=a[1],c.get(this).to({guide:{path:[a[0],a[1],d[0],d[1],b[0],b[1]]}},4e3).call(this.onAfterAnim).affectedByGame=!0},e.onAfterAnim=function(){this.removeAnimal()},e.update=function(a){this.view.updateView(a,this.x+this.viewOffset.x,this.y+this.viewOffset.y)},namespace("wam.models").ScratchRunning=d}(),function(){var a=include("wam.models.Animal"),b=include("wam.views.AnimalView"),c=include("createjs.Tween"),d=include("createjs.Ease"),e=function(c){a.call(this,c),this.viewOffset={x:0,y:0},this.onAfterAnim=this.onAfterAnim.bind(this);var d=g[Math.floor(Math.random()*g.length)];this.view=new b(c,"ani_fish_"+d+"_0"),this.init()},f=(a.prototype,extend(e,a)),g=["orange","red","blue","yellow"];f.init=function(){this.jumpCenter()},f.jumpCenter=function(){var a=Math.randomRange(200,500),b=Math.randomRange(700,1100),e=Math.randomRange(0,100),f=a+(b-a)/2,g=-45,h=45;if(Math.random()>.5){var i=a;a=b,b=i,this.view.lookingDir=-1,i=g,g=h,h=i}Math.random()>.7&&(h*=9),this.x=a,this.y=800,c.get(this).to({guide:{path:[a,800,f,e,b,800]}},2e3).call(this.onAfterAnim).affectedByGame=!0,this.rot=g,c.get(this).to({rot:h},2e3,d.quartInOut).affectedByGame=!0},f.onAfterAnim=function(){this.removeAnimal()},f.update=function(a){this.view.img.rotation=this.rot,this.view.updateView(a,this.x+this.viewOffset.x,this.y+this.viewOffset.y)},namespace("wam.models").Fish=e}(),function(){var a=include("wam.models.Animal"),b=include("wam.views.AnimalView"),c=include("createjs.Tween"),d=function(c){a.call(this,c),this.viewOffset={x:0,y:0},this.onAfterAnim=this.onAfterAnim.bind(this),this.view=new b(c,"ani_cricket_0"),this.init()},e=(a.prototype,extend(d,a));e.init=function(){this.jump()},e.jump=function(){c.get(this).to({guide:{path:[200,800,600,300,1100,800]}},4e3).call(this.onAfterAnim).affectedByGame=!0},e.onAfterAnim=function(){this.removeAnimal()},e.update=function(a){this.view.updateView(a,this.x+this.viewOffset.x,this.y+this.viewOffset.y)},namespace("wam.models").Cricket=d}(),function(){var a=include("wam.models.Animal"),b=include("wam.views.AnimalView"),c=include("springroll.DelayedCall"),d=include("createjs.Tween"),e=include("createjs.Ease"),f=function(c){a.call(this,c),this.viewOffset={x:0,y:0},this.firstFrame=!0,this.legCount=0,this.view=new b(c,"ani_spider_0"),this.init()},g=(a.prototype,extend(f,a));g.init=function(){var a=Math.randomRange(300,900),b=a+300*Math.random()-150;this.x=a,this.y=0;var c=this.blink.bind(this),f=this.onAfterAnim.bind(this);d.get(this).to({y:650},1e3,e.bounceOut).call(c).wait(1500).to({x:b,y:800},400,e.easeIn).call(f).affectedByGame=!0},g.update=function(a){this.view.updateView(a,this.x+this.viewOffset.x,this.y+this.viewOffset.y)},g.blink=function(){var a=this.view.img;a.image=images.ani_spider_1,new c(function(){a.image=images.ani_spider_0},200)},g.onAfterAnim=function(){this.removeAnimal()},namespace("wam.models").Spider=f}(),function(){var a=function(a,b){this.min=a,this.max=b,this.timer=Math.randomRange(this.min,this.max)},b=a.prototype;b.update=function(a){this.timer-=a*app.timeScale,this.timer<0&&(this.spawnAnimal(),this.timer=Math.randomRange(this.min,this.max))},b.spawnAnimal=function(){},namespace("wam.models").Spawner=a}(),function(){var a=include("wam.models.Spawner"),b=include("wam.models.Child"),c=include("wam.models.Spider"),d=include("wam.models.Bird"),e=function(b){a.call(this,1500,2300),this.manager=b,this.spawnCount=0},f=(a.prototype,extend(e,a));f.spawnAnimal=function(){var a=Math.random();a>.25?this.manager.spawnAnimal(new b(this.manager.background)):(a=Math.random(),a>.4?this.manager.spawnAnimal(new d(this.manager.background,295,30)):this.manager.spawnAnimal(new c(this.manager.foreground)))},namespace("wam.models").TreehouseSpawner=e}(),function(){var a=include("wam.models.Spawner"),b=include("wam.models.Bird"),c=include("wam.models.Fish"),d=include("wam.models.ScratchRunning"),e=function(b){a.call(this,1500,2e3),this.manager=b,this.spawnCount=0},f=(a.prototype,extend(e,a));f.spawnAnimal=function(){switch(this.spawnCount++,this.spawnCount%3){case 0:this.manager.spawnAnimal(new c(this.manager.foreground));break;case 1:this.manager.spawnAnimal(new b(this.manager.foreground));break;case 2:this.manager.spawnAnimal(new d(this.manager.background))}},namespace("wam.models").LakeSpawner=e}(),function(){var a=include("wam.models.Spawner"),b=include("wam.models.Bird"),c=include("wam.models.Moose"),d=function(b){a.call(this,1500,2e3),this.manager=b,this.spawnCount=0},e=(a.prototype,extend(d,a));e.spawnAnimal=function(){switch(this.spawnCount++,this.spawnCount%3){case 0:this.manager.spawnAnimal(new c(this.manager.background));break;default:this.manager.spawnAnimal(new b(this.manager.foreground))}},namespace("wam.models").ForestSpawner=d}(),function(){var a=include("wam.models.ScratchRunning"),b=include("wam.models.Cricket"),c=include("wam.models.Spawner"),d=include("wam.models.Bird"),e=function(a){c.call(this,1500,2e3),this.manager=a,this.spawnCount=0},f=(c.prototype,extend(e,c));f.spawnAnimal=function(){var c;switch(this.spawnCount++,this.spawnCount%3){case 0:c=new a(this.manager.background);break;case 1:c=new d(this.manager.foreground);break;case 2:c=new b(this.manager.foreground)}c&&this.manager.spawnAnimal(c)},namespace("wam.models").DogparkSpawner=e}(),function(){var a=include("springroll.DelayedCall"),b=include("wam.models.ForestSpawner"),c=include("wam.models.LakeSpawner"),d=include("wam.models.DogparkSpawner"),e=include("wam.models.TreehouseSpawner"),f=function(a,b,c){this.foreground=b,this.background=a,this.animals=[],this.animalsInRect=0,this.timer=0,this.removeTimer=0,this.spawner=this.getAnimalSpawner(app.vars.location)},g=f.prototype;g.update=function(a){this.spawner.update(a);for(var b=this.animals.length-1;b>=0;b--)this.animals[b].update(a);this.removeTimer+=a,this.removeTimer>1e3&&(this.removeTimer=0,this.removeDisabledAnimals())},g.getAnimalSpawner=function(a){return"forest"===a?new b(this):"lake"===a?new c(this):"dogpark"===a?new d(this):"treehouse"===a?new e(this):{update:function(){}}},g.takePicture=function(b,c){for(var d=this,e=0,f=Math.lerp(100,900,c),g=this.animals.length-1;g>=0;g--)h(this.animals[g],b)&&(this.animals[g].takePhoto(),app.signals.addStar.dispatch(this.animals[g].pos,f,c),e++,f+=100);return new a(function(){d.removeDisabledAnimals()},400),e},g.spawnAnimal=function(a){this.animals.push(a)},g.removeDisabledAnimals=function(){for(var a=this.animals.length-1;a>=0;a--)this.animals[a]._removeMe&&(this.animals[a].teardown(),this.animals.splice(a,1))},g.updateRect=function(a){var b;this.animalsInRect=0;for(var c=this.animals.length-1;c>=0;c--)this.animals[c].isActive&&(b=h(this.animals[c],a),this.animalsInRect+=b?1:0)};var h=function(a,b){return a.x>b.x1&&a.x<b.x2&&a.y>b.y1&&a.y<b.y2};g.teardown=function(){for(var a=0;a<this.animals.length;a++)this.animals[a].teardown();this.dc&&this.dc.destroy()},namespace("wam.models").AnimalManager=f}(),function(){var a=include("wam.models.AnimalManager"),b=include("wam.models.Moose"),c=include("wam.models.TutorialBird"),d=function(b,c){a.call(this,b,c)},e=(a.prototype,extend(d,a));e.spawnTutorialAnimals=function(a){var d;if(0===a){var e=new b(this.background,"tutorial");this.spawnAnimal(e)}else 1===a?(d=new c(this.foreground),d.flyIn({x:0,y:0},{x:550,y:590},1300),this.spawnAnimal(d),d=new c(this.foreground),d.flyIn({x:900,y:0},{x:600,y:600},1200),d.view.lookingDir=-1,this.spawnAnimal(d),d=new c(this.foreground),d.flyIn({x:200,y:0},{x:650,y:590},1e3),this.spawnAnimal(d)):2===a&&(d=new c(this.foreground),d.flyIn({x:0,y:0},{x:550,y:590},1300),this.spawnAnimal(d),d=new c(this.foreground),d.view.lookingDir=-1,d.flyIn({x:490,y:0},{x:600,y:600},1200),this.spawnAnimal(d),d=new c(this.foreground),d.flyIn({x:200,y:0},{x:650,y:590},1e3),this.spawnAnimal(d))},namespace("wam.models").TutorialAnimalManager=d}(),function(){var a=function(a){this.location="",this.clicks=a.clicks};a.prototype;namespace("wam.models").AppVars=a}(),function(){var a=include("createjs.Tween"),b=function(){this.tweens=[],this.scaledTime=1},c=b.prototype;c.tick=function(b,c){this.tweens=a._tweens.slice(),this.scaledTime=b*app.timeScale;for(var d=this.tweens.length-1;d>=0;d--){var e=this.tweens[d];app.paused&&!e.ignoreGlobalPause||e._paused||(e.affectedByGame?c||e.tick(this.scaledTime):e.tick(e._useTicks?1:b))}},namespace("wam.models").Ticker=b}(),function(){var a=include("wam.models.Animal"),b=include("wam.views.MooseView"),c=include("createjs.Tween"),d=function(c){a.call(this,c),this.yawnCount=0,this.view=new b(c,.7),this.init()},e=(a.prototype,extend(d,a));e.init=function(){this.view.lookingDir=Math.random()>.5?1:-1,this.x=650,this.y=550,this.update(0),c.get(this).to({y:550},750)},e.update=function(a){this.yawnCount-=a*app.timeScale,this.yawnCount<=0&&(this.yawnCount=Math.randomRange(4e3,7e3),this.view.yawn()),this.view.updateMooseView(a,this.x,this.y)},namespace("wam.models").TutorialMoose=d}(),function(){var a=include("createjs.Container"),b=include("springroll.easeljs.Button"),c=include("createjs.Bitmap"),d=include("wam.ui.BatteryView"),e=include("wam.ui.ScoreView"),f=function(b){a.call(this),this.init()},g=(a.prototype,extend(f,a));g.init=function(){var a=new c(images.hud);this.addChild(a),this.scoreView=new e,this.addChild(this.scoreView),this.batteryView=new d,this.addChild(this.batteryView);var f=new b(images.backBtn);f.setPos(84,17),this.addChild(f),this.backButton=f,f.addEventListener("click",function(a){app.signals.returnToMenu.dispatch(),app.sound.play("click")})},g.onGameEnd=function(){this.visible=!1},g.updateBattery=function(a){this.batteryView.updateBattery(a)},g.updateScore=function(a,b){this.scoreView.updateScore(a,b)},g.teardown=function(){this.backButton.removeAllEventListeners(),this.scoreView.teardown()},namespace("wam.ui").GameUI=f}(),function(){var a=include("createjs.Container"),b=include("springroll.easeljs.Button"),c=include("createjs.Bitmap"),d=function(b){a.call(this),this.init()},e=(a.prototype,extend(d,a));e.init=function(){var a=new c(images.bgLevelSelection);this.addChild(a),this.eye1=new c(images.eye),this.eye1.reg(.5),this.eye1.setPos(136,332),this.addChild(this.eye1),this.eye2=new c(images.eye),this.eye2.reg(.5),this.eye2.setPos(198,326),this.addChild(this.eye2),this.btns=[],this.addButton(230,69,"forest"),this.addButton(650,69,"lake"),this.addButton(230,320,"dogpark"),this.addButton(650,320,"treehouse");var b=new c(images.scratch_nose);b.setPos(233,527),this.addChild(b)},e.update=function(a){var b,c;b=app.pointer.x-this.eye1.x,c=app.pointer.y-this.eye1.y,this.eye1.rotation=30+Math.radToDeg*Math.atan2(c,b),b=app.pointer.x-this.eye2.x,c=app.pointer.y-this.eye2.y,this.eye2.rotation=30+Math.radToDeg*Math.atan2(c,b)},e.addButton=function(a,d,e){var f=new c(images["scene_"+e]);f.setPos(a,d+3),this.addChild(f);var g=new b(images.lvlBtn);g.setPos(a,d),g.addEventListener("click",function(a){app.signals.onLevelSelect.dispatch(e)}),this.addChild(g),this.btns.push(g)},e.teardown=function(){for(var a=this.btns.length-1;a>=0;a--)this.btns[a].removeAllEventListeners()},namespace("wam.ui").LevelSelection=d}(),function(){var a=include("springroll.DelayedCall"),b=include("springroll.easeljs.Button"),c=include("createjs.Container"),d=include("wam.ui.Starburst"),e=include("createjs.Bitmap"),f=include("createjs.Tween"),g=include("createjs.Ease"),h=function(a){c.call(this),this.init(a)},i=(c.prototype,extend(h,c));i.init=function(a){var b=app.config.gameVars.badgePoints;this.initGfx(a,b),this.initScale(a,b)},i.update=function(a){this.starburst&&this.starburst.update(a)},i.initScale=function(b,c){var d=0,e=0;b>=c[3]?(e=1,this.popBadge(this.badge1,1600),this.popBadge(this.badge2,1800),this.popBadge(this.badge3,2e3),d=3):b>=c[2]?(e=.97*b/c[3],this.popBadge(this.badge1,1600),this.popBadge(this.badge2,1800),d=2):b>=c[1]?(e=.49*b/c[2],this.popBadge(this.badge1,1600),d=1):e=.15*b/c[1];var f=this,g=1e3;new a(function(){f.showPopup(b,e),d>0&&app.voPlayer.play("badge-"+d)},g)},i.popBadge=function(a,b){f.get(a).wait(b).to({alpha:1},1).to({scaleX:1.2,scaleY:1.2},400,g.bounceOut)},i.initGfx=function(a,c){this.alpha=0;var f=new e(images.black);f.alpha=.5,f.scaleX=64,f.scaleY=36,this.addChild(f),this.starburst=new d,this.addChild(this.starburst);var g=new e(images.resultPopup);g.reg(.5),g.setPos(640,360),this.addChild(g),this.dad=new e(images.result_dad),this.dad.alpha=0,this.dad.reg(.5),this.dad.setPos(180,483),this.addChild(this.dad),this.mom=new e(images.result_mom),this.mom.alpha=0,this.mom.reg(.5),this.mom.setPos(180,483),this.addChild(this.mom),this.dot=new e(images.result_dot),this.dot.alpha=0,this.dot.reg(.5),this.dot.setPos(180,273),this.addChild(this.dot),this.hal=new e(images.result_hal),this.hal.alpha=0,this.hal.reg(.5),this.hal.setPos(180,273),this.addChild(this.hal),this.scoreBar=new e(images.fillbar),this.scoreBar.x=182,this.scoreBar.y=362,this.scoreBar.scaleX=0,this.addChild(this.scoreBar),a>=c[3]&&(this.badge3=new e(images.badge3),this.badge3.reg(.5),this.badge3.setPos(1070,358),this.badge3.scale(.4),this.badge3.alpha=0,this.addChild(this.badge3)),a>=c[2]&&(this.badge2=new e(images.badge2),this.badge2.reg(.5),this.badge2.setPos(650,360),this.badge2.scale(.4),this.badge2.alpha=0,this.addChild(this.badge2)),a>=c[1]&&(this.badge1=new e(images.badge1),this.badge1.reg(.5),this.badge1.setPos(360,360),this.badge1.scale(.4),this.badge1.alpha=0,this.addChild(this.badge1)),this.menuBtn=new b(images.btnHome),this.menuBtn.scale(.8),this.menuBtn.setPos(630,570),this.addChild(this.menuBtn),this.menuBtn.addEventListener("click",function(a){app.signals.returnToMenu.dispatch(),app.sound.play("click")}),this.replayBtn=new b(images.btnReplay),this.replayBtn.scale(.8),this.replayBtn.setPos(220,570),this.addChild(this.replayBtn),this.replayBtn.addEventListener("click",function(a){app.signals.replay.dispatch(),app.sound.play("click")})},i.showPopup=function(a,b){app.sound.play("fanfare"),this.alpha=1,f.get(this.scoreBar).wait(500).to({scaleX:b},500),f.get(this.hal).wait(500).to({alpha:1,x:180+900*b},500);var c;c=b>.5?150+300*Math.random():450+300*Math.random(),f.get(this.dot).wait(500).to({alpha:1,x:c},500),c=180+250*Math.random(),f.get(this.dad).wait(500).to({alpha:1,x:c},500),c=550+300*Math.random(),f.get(this.mom).wait(500).to({alpha:1,x:c},500)},i.teardown=function(){this.menuBtn.removeAllEventListeners()},namespace("wam.ui").ResultPopup=h}(),function(){var a=include("springroll.DelayedCall"),b=include("springroll.easeljs.Button"),c=include("createjs.Container"),d=include("createjs.Bitmap"),e=function(){c.call(this),this.delayedShow(1e3)},f=(c.prototype,extend(e,c));f.delayedShow=function(c){var e=this;new a(function(){var a=new d(images.black);a.alpha=.5,a.scaleX=64,a.scaleY=36,e.addChild(a);var c=new d(images.tutorialPopup);c.reg(.5),c.setPos(640,360),e.addChild(c);var f=new b(images.playBtn);f.setPos(398,503),e.addChild(f),e.menuBtn=f,f.addEventListener("click",function(a){app.signals.returnToMenu.dispatch(),app.sound.play("click")})},c)},f.update=function(a){},f.teardown=function(){this.menuBtn&&this.menuBtn.removeAllEventListeners()},namespace("wam.ui").TutorialCompletePopup=e}(),function(){var a=include("createjs.Container"),b=include("springroll.easeljs.Button"),c=include("createjs.Bitmap"),d=include("wam.ui.ScoreView"),e=function(b){a.call(this),this.init()},f=(a.prototype,extend(e,a));f.init=function(){var a=new c(images.hud);this.addChild(a),this.scoreView=new d,this.addChild(this.scoreView);var e=new b(images.backBtn);e.setPos(84,17),this.addChild(e),this.backButton=e,e.addEventListener("click",function(a){app.signals.returnToMenu.dispatch()})},f.update=function(a){},f.onGameEnd=function(){this.visible=!1},f.teardown=function(){this.backButton.removeAllEventListeners()},namespace("wam.ui").TutorialUI=e}(),function(){var a=include("springroll.easeljs.BasePanel"),b=function(){a.call(this),this.appSize=app.config.scaling,e=app._safeZone=110,this.onResize=this.onResize.bind(this)},c=a.prototype,d=extend(b,a);window.app=window.app={};var e;d.setup=function(){var a=this;window.addEventListener("resize",a.onResize,!1),this.onResize()},d.onResize=function(){window.scrollTo(0,1);var a=window.innerWidth,b=window.innerHeight;this.scaleDynamic(a,b),this.scaleX=this.scaleY=app._scale,this.x=-app._scaleOffset},d.scaleDynamic=function(a,b){var c,d,f,g,h=this.appSize;if(a/b<h.width/h.height)c=a/h.width,f=Math.floor(h.width*c),g=Math.floor(h.height*c),d=e*c,app.display.resize(f,g);else{c=b/h.height;var i=a/c-h.width;i>2*e&&(i=2*e),i*=c,f=Math.floor(h.width*c+i),g=Math.floor(h.height*c),d=e*c-i/2,app.display.resize(f,g)}app._scale=c,app._scaleOffset=d,app.transition&&(app.transition.x=-d,app.transition.scaleX=app.transition.scaleY=app._scale),this.resizeCaptions(app._scale)},d.resizeCaptions=function(a){/Mobile/i.test(navigator.userAgent)&&!/ipad/i.test(navigator.userAgent)?this.setCaptionSize("md"):"undefined"!=typeof window.orientation?this.setCaptionSize("xl"):.3>a?this.setCaptionSize("sm"):.4>a?this.setCaptionSize("md"):.5>a?this.setCaptionSize("lg"):this.setCaptionSize("xl")},d.setCaptionSize=function(a){if(this.captionSize!==a){this.captionSize=a;var b=document.getElementById("captions");b.className="size-"+a+" bg-none color-white edge-uniform font-arial align-bottom"}},d.teardown=function(){var a=this;window.removeEventListener("resize",a.onResize,!1),c.teardown.call(this)},namespace("wam.panels").ScalePanel=b}(),function(){var a=include("createjs.Container"),b=include("createjs.Bitmap"),c=include("wam.panels.ScalePanel"),d=include("wam.ui.GameUI"),e=include("wam.ui.TutorialUI"),f=include("wam.ui.ResultPopup"),g=include("wam.ui.TutorialCompletePopup"),h=include("wam.views.Reticle"),i=include("wam.views.Flash"),j=include("wam.views.StarCont"),k=function(a){this.isTutorial=a,c.call(this)},l=c.prototype,m=extend(k,c);Object.defineProperty(m,"ui",{get:function(){return this._ui}}),m.setup=function(){l.setup.call(this),this.gameCont=new a,this.addChild(this.gameCont);var c=app.vars.location||"forest",f=new b(images["envBack_"+c]);if(this.gameCont.addChild(f),this.bgCont=new a,this.gameCont.addChild(this.bgCont),this.clouds=[],forground=new b(images["envFront_"+c]),forground.reg(0,1),forground.setPos(0,720),this.gameCont.addChild(forground),"dogpark"===app.vars.location){var g=new b(images.clouds1);g.setPos(300,170),this.gameCont.addChild(g),this.clouds.push(g),g=new b(images.clouds2),g.setPos(700,270),this.gameCont.addChild(g),this.clouds.push(g)}this.forgroundCont=new a,this.gameCont.addChild(this.forgroundCont),this.starCont=new j,this.gameCont.addChild(this.starCont),this.flash=new i,this.gameCont.addChild(this.flash),this.reticle=new h,this.gameCont.addChild(this.reticle),this.isTutorial?this._ui=new e:this._ui=new d,this.gameCont.addChild(this._ui),this.gameCont.reg(.5),this.gameCont.setPos(640,360)},m.update=function(a){this.flash.update(a),this.resultPopup&&this.resultPopup.update(a);for(var b=this.clouds.length-1;b>=0;b--)this.clouds[b].x+=a*app.timeScale*.02,this.clouds[b].x>1300&&(this.clouds[b].x-=1600)},m.takePicture=function(){this.flash.flash()},m.onGameEnd=function(a){this._ui.onGameEnd(),this.reticle.onGameEnd(),this.isTutorial?this.resultPopup=new g:this.resultPopup=new f(a),this.addChild(this.resultPopup)},m.updateCamZoom=function(a,b){var c,d,e;c=1+.75*a,e=b.x1+(b.x2-b.x1)/2,e=Math.floor((640-e)*Math.lerp(a,1-Math.cos(a*Math.PI/2),.4)*1.5),d=b.y1+(b.y2-b.y1)/2,d=Math.floor((360-d)*Math.lerp(a,1-Math.cos(a*Math.PI/2),.5)*1.7),this.gameCont.x=640+e,this.gameCont.y=360+d,this.gameCont.scaleX=c,this.gameCont.scaleY=c,this.reticle.updateRect(a,b),this.ui.y=Math.lerp(0,-100,a)},m.teardown=function(){this._ui.teardown(),this.resultPopup&&this.resultPopup.teardown(),l.teardown.call(this)},namespace("wam.panels").GamePanel=k}(),function(){var a=include("wam.panels.ScalePanel"),b=include("springroll.easeljs.Button"),c=include("createjs.Bitmap"),d=function(b){a.call(this)},e=a.prototype,f=extend(d,a);f.setup=function(){e.setup.call(this);var a=new c(images.bgSplash);this.addChild(a),this.loaderBG=new c(images.loaderBG),this.loaderBG.reg(.5),this.loaderBG.setPos(770,560),this.loaderBG.visible=!1,this.addChild(this.loaderBG),this.loader1=new c(images.loader_01),this.loader1.reg(.5),this.loader1.setPos(770,560),this.loader1.visible=!1,this.addChild(this.loader1),this.eye1=new c(images.tut_eye),this.eye1.reg(.5),this.eye1.scale(1.1),this.eye1.setPos(147,314),this.addChild(this.eye1),this.eye2=new c(images.tut_eye),this.eye2.reg(.5),this.eye2.scale(1.1),this.eye2.setPos(217,307),this.addChild(this.eye2),this.playBtn=new b(images.playBtnSplash),this.playBtn.reg(.5),this.playBtn.setPos(790,560),this.playBtn.scale(1.5),this.addChild(this.playBtn),this.rotCount=0,this.rotAdd=0},f.update=function(a){this.rotCount+=.002*a,this.rotAdd=3*Math.sin(this.rotCount),this.loader1.rotation+=Math.max(this.rotAdd,0);var b,c;b=app.pointer.x-this.eye1.x,c=app.pointer.y-this.eye1.y,this.eye1.rotation=30+Math.radToDeg*Math.atan2(c,b),b=app.pointer.x-this.eye2.x,c=app.pointer.y-this.eye2.y,this.eye2.rotation=10+Math.radToDeg*Math.atan2(c,b)},f.startLoad=function(){this.playBtn.visible=!1,this.loaderBG.visible=!0,this.loader1.visible=!0},namespace("wam.panels").LoadPanel=d}(),function(){var a=include("wam.panels.ScalePanel"),b=include("wam.ui.LevelSelection"),c=include("springroll.easeljs.Button"),d=include("createjs.Bitmap"),e=function(b){a.call(this)},f=a.prototype,g=extend(e,a);g.setup=function(){if(f.setup.call(this),app.returning)this.levelSelection=new b,this.addChild(this.levelSelection);else{var a=new d(images.bgMenu);this.addChild(a),this.playBtn=new c(images.playBtn),this.playBtn.setPos(627,435),this.addChild(this.playBtn),this.playBtn.addEventListener("click",function(a){app.signals.onPressPlay.dispatch()})}},g.update=function(a){this.levelSelection&&this.levelSelection.update(a)},g.teardown=function(){f.teardown.call(this),this.playBtn&&this.playBtn.removeAllEventListeners(),this.levelSelection&&this.levelSelection.teardown()},namespace("wam.panels").MenuPanel=e}(),function(){var a=include("wam.models.TutorialAnimalManager"),b=include("wam.signals.TutorialSignals"),c=include("springroll.easeljs.BaseState"),d=include("wam.panels.GamePanel"),e=include("wam.input.CameraInput"),f=include("springroll.DelayedCall"),g=500,h=function(a){var b=!0;c.call(this,new d(b),a),this._update=this.update.bind(this)},i=c.prototype,j=extend(h,c);j.enter=function(){i.enter.call(this),this.signals=new b(this,this.panel)},j.enterDone=function(){i.enterDone.call(this),this.animalManager=new a(this.panel.bgCont,this.panel.forgroundCont),this.cameraInput=new e(this),this.score=0,this.setScore(0),app.timeScale=1,app.timeFreeze=0,this.desiredTimeScale=1,app.on("update",this._update),this.signals.active=!0,this.updateTutorial(0)},j.update=function(a){this.panel.update(a),app.timeFreeze>0?app.timeFreeze-=a:(this.cameraInput.update(a),this.animalManager.update(a),app.timeScale=Math.lerp(app.timeScale,this.desiredTimeScale,a/750)),this.updateReticle(),app.ticker.tick(a,app.timeFreeze>0)},j.updateReticle=function(a){var b=this.panel.reticle.reticleStars;b.updateAnimalCount(this.animalManager.animalsInRect,this.cameraInput.ZoomProgress)},j.onPointerRelease=function(){app.timeFreeze<=0&&this.takePicture()},j.takePicture=function(){var a=this.cameraInput.CamRect,b=this.cameraInput.ZoomProgress,c=b>.95?!0:!1,d=this.animalManager.animalsInRect;if(d>=this.currentCondition.animals&&b>=this.currentCondition.zoom){this.panel.takePicture(),this.animalManager.takePicture(a,b),app.timeFreeze=g,d=Math.min(3,d);this.tutStep++,this.updateTutorial(this.tutStep);var e=Math.floor(Math.randomRange(1,4));app.sound.play("shutter-"+e)}else this.onTutStepFail(c)},j.onTutStepFail=function(a){app.voPlayer.playing||(1===this.tutStep?app.voPlayer.play("instrux-02-fail"):2===this.tutStep&&(a?app.voPlayer.play("instrux-02-fail"):app.voPlayer.play("instrux-03-fail")))},j.updateTutorial=function(a){app.voPlayer.stop();var b=this;b.tutStep=a,b.setInputEnabled(!1),b.panel.reticle.setVisible(!1),0===b.tutStep?(this.cameraInput.zoomEnabled=!1,app.voPlayer.play("instrux-01"),new f(function(){b.currentCondition={animals:1,zoom:0},b.animalManager.spawnTutorialAnimals(b.tutStep),b.panel.reticle.setVisible(!0,2e3),b.setInputEnabled(!0,2e3)},1e3)):1===b.tutStep?(this.setScore(2),app.voPlayer.play("instrux-02"),new f(function(){b.currentCondition={animals:3,zoom:0},b.animalManager.spawnTutorialAnimals(b.tutStep),b.panel.reticle.setVisible(!0,8e3),b.setInputEnabled(!0,8e3)},7e3)):2===b.tutStep?(this.setScore(8),app.voPlayer.play("instrux-03"),new f(function(){b.currentCondition={animals:3,zoom:.95},b.animalManager.spawnTutorialAnimals(b.tutStep),b.panel.reticle.setVisible(!0,9e3),b.setInputEnabled(!0,9e3),b.cameraInput.zoomEnabled=!0;
},4e3)):(this.setScore(20),app.voPlayer.play("instrux-04"),new f(function(){b.endTutorial()},3500))},j.setInputEnabled=function(a,b){if(b){var c=this;new f(function(){c.cameraInput.inputEnabled=a},b)}else this.cameraInput.inputEnabled=a},j.endTutorial=function(){this.setInputEnabled(!1),this.panel.onGameEnd(this.score)},j.updateCamZoom=function(a,b){this.panel.updateCamZoom(a,b),this.animalManager.updateRect(b),this.desiredTimeScale=Math.max(.15,1-a)},j.setScore=function(a){this.score=a,this.panel.ui.scoreView.updateScore(this.score,this.cameraInput.ZoomProgress)},j.exitStart=function(){app.voPlayer.stop(),app.off("update",this._update),this.signals.active=!1,this.cameraInput.teardown(),this.animalManager.teardown(),i.exitStart.call(this)},namespace("wam.states").TutorialState=h}(),function(){var a=include("wam.signals.MenuSignals"),b=include("springroll.easeljs.BaseState"),c=include("wam.panels.MenuPanel"),d=include("createjs.Tween"),e=function(a){b.call(this,new c,a),this._update=this.update.bind(this),this.toTimer=0};d.tick=function(a,b){},d.handleEvent=function(a){};var f=b.prototype,g=extend(e,b);g.enter=function(){f.enter.call(this),this.signals=new a(this,this.panel)},g.enterDone=function(){f.enterDone.call(this),this.signals.active=!0,app.on("update",this._update)},g.update=function(a){this.panel.update(a),app.returning||(this.toTimer-=a,this.toTimer<0&&(this.toTimer=3e4,app.voPlayer.play("intro-hal")))},g.onPressPlay=function(){app.returning=!0,this.manager.state="tutorial",app.voPlayer.stop(),app.sound.play("click")},g.onLevelSelect=function(a){if(app.vars.location=a,this.manager.state="game",!app.voPlayer.playing){var b=Math.floor(Math.randomRange(1,5));app.voPlayer.play("menu-gen-"+b)}app.sound.play("click")},g.exitStart=function(){app.off("update",this._update),this.signals.active=!1,f.exitStart.call(this)},namespace("wam.states").MenuState=e}(),function(){var a=include("springroll.easeljs.BaseState"),b=include("wam.panels.LoadPanel"),c=function(c){a.call(this,new b,c),this._update=this.update.bind(this)},d=a.prototype,e=extend(c,a);e.enter=function(){var a=this.startLoad.bind(this);this.panel.addEventListener("click",a)},e.enterDone=function(){d.enterDone.call(this),app.on("update",this._update)},e.update=function(a){this.panel.update(a)},e.startLoad=function(){this.panel.startLoad(),this.panel.removeAllEventListeners(),app.sound.play("click");var a=this,b=this.config.assets;window.images=window.images||{},app.load(b.game,function(c){for(var d in c)window.images[""+d]=c[d];app.load(b.menu,function(b){for(var c in b)window.images[""+c]=b[c];a.loadComplete()})})},e.loadComplete=function(){this.nextState()},e.exitStart=function(){app.off("update",this._update)},namespace("wam.states").LoadState=c}(),function(){var a=include("springroll.easeljs.BaseState"),b=include("wam.signals.GameSignals"),c=include("wam.panels.GamePanel"),d=include("wam.input.CameraInput"),e=include("wam.models.AnimalManager"),f=include("springroll.DelayedCall"),g=400,h=function(b){a.call(this,new c,b),this._update=this.update.bind(this)},i=a.prototype,j=extend(h,a);j.enter=function(){i.enter.call(this),this.signals=new b(this,this.panel)},j.enterDone=function(){i.enterDone.call(this),this.animalManager=new e(this.panel.bgCont,this.panel.forgroundCont),this.cameraInput=new d(this),this.clicksRemaining=app.config.gameVars.clicks,this.panel.ui.updateBattery(this.clicksRemaining),this.score=0,this.setScore(0),app.timeScale=1,app.timeFreeze=0,this.desiredTimeScale=1,app.on("update",this._update),this.signals.active=!0},j.update=function(a){app.timeFreeze>0?app.timeFreeze-=a:(this.cameraInput.update(a),this.animalManager.update(a),app.timeScale=Math.lerp(app.timeScale,this.desiredTimeScale,a/750)),this.updatePanel(a),app.ticker.tick(a,app.timeFreeze>0)},j.updatePanel=function(a){this.panel.update(a);var b=this.panel.reticle.reticleStars;b.updateAnimalCount(this.animalManager.animalsInRect,this.cameraInput.ZoomProgress)},j.onPointerRelease=function(){app.timeFreeze<=0&&this.clicksRemaining>0&&this.takePicture()},j.takePicture=function(){this.panel.takePicture();var a=this.cameraInput.CamRect,b=this.cameraInput.ZoomProgress;app.timeFreeze=g;var c=Math.min(3,this.animalManager.takePicture(a,b)),d=b>.95?!0:!1;c*=d?2:1,this.addScore(c),this.clicksRemaining--,this.panel.ui.updateBattery(this.clicksRemaining),0===this.clicksRemaining&&this.endGame();var e=Math.floor(Math.randomRange(1,4));app.sound.play("shutter-"+e),!app.voPlayer.playing&&c>1&&Math.random()>.8&&(e=Math.floor(Math.randomRange(1,5)),app.voPlayer.play("Gen-shot-0"+e))},j.endGame=function(){this.cameraInput.inputEnabled=!1,this.panel.onGameEnd(this.score)},j.updateCamZoom=function(a,b){this.panel.updateCamZoom(a,b),this.animalManager.updateRect(b),this.desiredTimeScale=Math.max(.15,1-a)},j.addScore=function(a){this.setScore(this.score+a)},j.setScore=function(a){if(this.score=a,this.panel.ui.updateScore(this.score,this.cameraInput.ZoomProgress),this.score>=60&&this.clicksRemaining>0){this.cameraInput.inputEnabled=!1;var b=this;new f(function(){b.endGame()},1e3)}},j.exitStart=function(){app.off("update",this._update),this.signals.active=!1,this.cameraInput.teardown(),this.animalManager.teardown(),i.exitStart.call(this)},namespace("wam.states").GameState=h}(),function(){var a=include("wam.states.TutorialState"),b=include("wam.states.LoadState"),c=include("wam.states.MenuState"),d=include("wam.states.GameState"),e=function(e){return{load:new b({preload:e.load,next:"menu"}),menu:new c({next:"game"}),game:new d({previous:"menu"}),tutorial:new a({previous:"menu"})}};namespace("wam.states").States=e}(),function(){var a=include("springroll.Application"),b=include("springroll.EaselJSDisplay"),c=include("wam.models.AppVars"),d=include("wam.states.States"),e=include("wam.models.Ticker"),f=lib.Transition,g=new a({name:"agentHalAnimalDetective",canvasId:"stage",state:"load",configPath:"assets/config/config.json",display:b,transition:new f,displayOptions:{clearView:!0}});g.on("init",function(){this.states=new d(this.config.assets),g.vars=new c(this.config.gameVars),createjs.MotionGuidePlugin.install(),g.sound.play("musicbed",{loop:-1})}),g.ticker=new e,window.app=g}();