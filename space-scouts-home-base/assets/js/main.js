platypus.Badger=function(){"use strict";var t=[],e=function(e,i,s,n){var a=null,r=0,o="",h=0,l="",p={},c=null,u={},d=null;for(o in this.badgesAwarded=[],this.keys=p,this.userData=s,this.badges=u,this.loading=!0,this.gameId=i,e)if(e.hasOwnProperty(o))for(a=e[o].badges,u[o]=[],h=a.length;h--;){for(l in d=a[h],u[o][d.id]=c={},d)d.hasOwnProperty(l)&&(c[l]=d[l]);if(c.subgoals)for(r=c.subgoals.length;r--;)p[c.subgoals[r].key]||(p[c.subgoals[r].key]=[]),p[c.subgoals[r].key].push(c)}s.readGameData("SpaceScouts","BadgeProgress",function(e){var i="",s=e||{},a=t.length;for(i in this.progress=s,s.badges||(s.badges={}),s)s.hasOwnProperty(i)&&"badges"!==i&&this.setProgress(i,s[i]);for(this.loading=!1;a--;)t[a]();t=null,n&&n(this.badges,this.getBadgeStatusForLAP())}.bind(this))},i=e.prototype;return i.increment=function(e){this.loading?t.push(this.increment.bind(this,e)):this.setProgress(e,(this.progress[e]||0)+1)},i.setProgress=function(t,e){var i=this.keys[t],s=!1,n=0,a=0,r=!this.loading,o=0,h=this.progress,l=null;if(i){for(n=i.length,r&&platypus.debug.orange&&platypus.debug.orange('Badger: "'+t+'" badge subgoal incremented for '+n+" badge"+(n>1?"s":"")+".");n--;){for(a=(l=i[n].subgoals).length,s=!0;a--;)l[a].key===t&&(o=l[a].progress||0,l[a].progress=Math.min(e,+l[a].count),l[a].progress===+l[a].count&&(l[a].completed=!0),r&&o!==l[a].progress&&(platypus.game.currentScene?platypus.game.currentScene.triggerOnChildren("badge-incremented",{badge:i[n],subgoal:t,originalProgress:o,progress:l[a].progress,count:+l[a].count}):platypus.debug.warn("Badger: just tried to show a badge notification, but there is no current scene."))),l[a].completed||(s=!1);!s||i[n].completed||this.gameId&&this.gameId!==i[n]["game-id"]||(i[n].completed=!0,h.badges[i[n].name]||this.badgesAwarded.push(i[n]))}this.loading||(h[t]=e,this.userData.writeGameData("SpaceScouts","BadgeProgress",h))}else platypus.debug.warn('Badger: There are no badges that have a "'+t+'" subgoal. Progress for this key will not be saved.')},i.award=function(){var t=this.badgesAwarded,e=t.length,i=this.progress,s=null;if(e){for(s=t.greenSlice(),t.length=0;e--;)this.increment("earned-badge"),i.badges[s[e].name]=!0;return this.userData.writeGameData("SpaceScouts","BadgeProgress",i),s}return null},i.getBadges=function(t){return t?this.badges[t]:this.badges},i.getBadgeStatusForLAP=function(t){var e=[],i=this.badges,s=null,n=null,a="",r=0,o=null,h=null,l=0,p=0,c=0;for(a in i)if(i.hasOwnProperty(a))for(p=(s=i[a]).length;p--;)if(c=(h=(n=s[p]).subgoals).length,l=0,r=0,o={},t){if(t===n.name){for(;c--;)o[h[c].key]=h[c].completed||!1,l+=+h[c].count,r+=h[c].progress||0;return{name:n.name,unlocked:n.completed||!1,steps:o,progress:r/l}}}else{for(;c--;)o[h[c].key]=h[c].completed||!1,l+=+h[c].count,r+=h[c].progress||0;e.push({name:n.name,unlocked:n.completed||!1,progress:r/l,steps:o})}return e},e}(),platypus.Games=function(){"use strict";var t=(parseInt(window.location.search.substring(1),10)||5)/100,e=function(t){t.router.getDownloadStatus().then(function(t,e){this.status=e,this.tryAgain(t)}.bind(this,t)).catch(function(t,e){platypus.debug.warn("Something went wrong, probably a timeout:",e),"Client is not connected"===e.message?this.runTestSequence(t):this.tryAgain(t)}.bind(this,t))},i=function(t){this.status=[],this.wifi=!0,this.wifiChecker=function(t){this.wifi="wifi"===t.data.type}.bind(this),t.container.on("connection-status",this.wifiChecker),e.bind(this,t)()},s=i.prototype;return s.tryAgain=function(t){for(var i=this.status,s=i.length,n=!s;s--;)i[s].data<1&&(n=!0,this.wifi||(i[s].type="offline")),t.trigger(i[s].slug+"-status-update",i[s]);n?(t.container.send("internet-access"),window.setTimeout(e.bind(this,t),1e3)):(t.container.off("connection-status",this.wifiChecker),this.neverComplete||localStorage.setItem("space-scouts-downloads","complete"))},s.getGame=function(t){for(var e=this.status,i=e.length;i--;)if(e[i].slug===t)return e[i];return null},s.runTestSequence=function(e){var i=function(){var s=this.status,n=0;for(n=0;n<s.length;n++)if(s[n].data<1){s[n].data+=t,e.trigger(s[n].slug+"-status-update",s[n]),setTimeout(i,1e3);break}}.bind(this);this.status=[{slug:"space-scouts-home-base",type:"progress",data:1},{slug:"base-builder",type:"progress",data:0},{slug:"cooking-school",type:"progress",data:0},{slug:"mission-control",type:"progress",data:0},{slug:"food-farmer",type:"progress",data:0},{slug:"rover-maker",type:"progress",data:0},{slug:"space-scouts-lab",type:"progress",data:0}],localStorage.removeItem("space-scouts-downloads"),this.neverComplete=!0,setTimeout(i,1e3)},i}(),platypus.LabRetriever=function(){"use strict";var t=[],e=function(e,i){this.labItemsUnlocked=[],this.userData=e,this.loading=!0,this.onLoaded=!1,e.readGameData("space-scouts-lab","LabUnlocks",function(e){var s=e||{},n=t.length;for(this.progress=s,this.loading=!1;n--;)t[n]();t=null,i&&i(this),this.onLoaded&&this.onLoaded()}.bind(this))},i=e.prototype;return i.has=function(t){return!!this.progress[t]},i.isNew=function(t){return!(this.progress[t]&&this.progress[t].used)},i.unlock=function(e){this.loading?t.push(this.unlock.bind(this,e)):this.progress[e]||(this.labItemsUnlocked.push(e),this.progress[e]={},this.userData.writeGameData("space-scouts-lab","LabUnlocks",this.progress))},i.use=function(t){"space-scouts-lab"===platypus.game.app.name?this.loading||!this.progress[t]||this.progress[t].used||(this.progress[t].used=!0,this.userData.writeGameData("space-scouts-lab","LabUnlocks",this.progress)):platypus.debug.warn('LabRetriever: Only the Lab is allowed to mark "'+t+'" as a used item.')},i.award=function(){var t=this.labItemsUnlocked;return t.length?t:null},e}(),function(){"use strict";var t,e,i,s,n,a,r,o,h=window.navigator.userAgent.toLowerCase(),l=include("platypus.Data"),p=[["os 9_","","ios935"],["os 10_","","ios935"],["kfgiwi","","small"],["kfdowi","","small"],["os 11_","","small"],["iphone","dpi2","small"],["iphone","dpi3","small"],["ipad; cpu os 12_","scr4:3","small"],["ipad; cpu os 13_","scr4:3","small"],["android 4.","","small"],["android 5.","","small"],["android 6.","","small"]],c=0,u=null,d="",g=platypus.PIXIAnimation.formatSpriteSheet.bind(platypus.PIXIAnimation);for(c=0;c<p.length;c++)if(u=p[c],h.indexOf(u[0])>=0&&(!u[1]||"scr4:3"===u[1]&&window.screen.height/window.screen.width==1024/768||"dpi2"===u[1]&&2===window.devicePixelRatio||"dpi3"===u[1]&&3===window.devicePixelRatio)){d=u[2];break}d?(platypus.modifyAllAssets={ios935:4,small:2}[d],springroll.Task.prototype.filter=(o="/"+d+"/",function(t){var e=t.lastIndexOf("/"),i=t.substring(t.lastIndexOf(".")+1),s=t.substring(e+1);return"png"===i||"jpg"===i?t.substring(0,e)+o+s:t}),platypus.PIXIAnimation.formatSpriteSheet=(t=/([\w-]+)\.(\w+)$/,e=function(t,e,i){var s=platypus.modifyAllAssets,n=null,a=0;for(a=0;a<t.length;a++)n=t[a],e.push(Array.setUp(n[0]/s>>0,n[1]/s>>0,n[2]/s>>0,n[3]/s>>0,n[4]+i,n[5]/s>>0,n[6]/s>>0))},i=function(t){for(var e=t.length,i="",s="";e--;)i+=s+(t[e].src||t[e]).substring(0,128),s=",";return i},s=function(t,s){var r=s.animations,o=s.images,h=s.framerate||60,l=s.frames,p=0,c=Array.setUp(),u=o.length,d=l.length,m=t.animations,y=t.images,f=t.framerate||60,w=t.frames,v=null;for(s.id?s.id+=";"+(t.id||i(t.images)):s.id=t.id||i(t.images),p=0;p<y.length;p++)c.push(a(y[p])),o.push(c[p]);return Array.isArray(w)?e(w,l,u):(v=g(t),e(v.frames,l,u),v.recycleSpriteSheet()),function(t,e,i,s,a){var r="";for(r in t)t.hasOwnProperty(r)&&(e[r]&&(e[r].frames.recycle(),e[r].recycle(),platypus.debug.olive('PIXIAnimation "'+a+'": Overwriting duplicate animation for "'+r+'".')),e[r]=n(r,t[r],i,s))}(m,r,f/h,d,s.id),c.recycle(),s},n=function(t,e,i,s){var n=0,a=0,r=Array.setUp(),o=0;if("number"==typeof e)return r.push(e+s),l.setUp("frames",r,"next",t,"speed",i);if(Array.isArray(e)){for(a=e[0]||0,o=(e[1]||a)+1+s,n=a+=s;n<o;n++)r.push(n);return l.setUp("frames",r,"next",e[2]||t,"speed",(e[3]||1)*i)}for(n=0;n<e.frames.length;n++)r.push(e.frames[n]+s);return l.setUp("frames",r,"next",e.next||t,"speed",(e.speed||1)*i)},a=function(e){var i=!1;return"string"==typeof e&&(i=e.match(t))?i[1]:e},r=function(){var t=this.animations,e="";for(e in t)t.hasOwnProperty(e)&&t[e].frames.recycle(),t[e].recycle();this.frames.recycle(2),this.images.recycle(),this.recycle()},function(t){var e=platypus.PIXIAnimation.EmptySpriteSheet,i=t;if("string"==typeof i&&(i=platypus.game.settings.spriteSheets[t]),i){if(e=l.setUp("animations",l.setUp(),"framerate",60,"frames",Array.setUp(),"id","","images",Array.setUp(),"recycleSpriteSheet",r),Array.isArray(i))return function(t,e){for(var i=t.length,n=null;i--;)"string"==typeof(n=t[i])&&(n=platypus.game.settings.spriteSheets[n]),n&&s(n,e);return e}(i,e);if(i)return s(i,e)}return e})):platypus.modifyAllAssets=1}(),function(){"use strict";var t=include("springroll.SavedData"),e=include("springroll.UserData").prototype;e.readGameData=function(e,i,s){this.container.supported?this.container.fetch("userDataRead",function(t){s(t.data)},e+i,!0):s(t.read(e+i))},e.writeGameData=function(e,i,s,n){if(!this.container.supported)return t.write(e+i,s),void(n&&n());this.container.fetch("userDataWrite",function(){n&&n()},{name:e+i,value:s},!0)},e.removeGameData=function(e,i,s){if(!this.container.supported)return t.remove(e+i),void(s&&s());this.container.fetch("userDataRemove",function(){s&&s()},e+i,!0)},e.fixFetch=function(){var t,e,i,s=this.container;s.___fetch||(s.___fetch=s.fetch,s.fetch=(t=!1,e=function(s,n){var a=null;s(n),i.length?(a=i.shift(),this.___fetch(a.event,e.bind(this,a.callback),a.options,a.once)):t=!1},i=[],function(s,n,a,r){t?i.push({event:s,callback:n,options:a,once:r}):(t=!0,this.___fetch(s,e.bind(this,n),a,r))}))}}(),function(){"use strict";var t,e="file:"===window.location.protocol||"ionic:"===window.location.protocol||"localhost:8080"===window.location.host,i=window.navigator.userAgent.toLowerCase(),s=i.indexOf("os 9_")>=0||i.indexOf("os 10_")>=0,n=include("springroll.Application"),a=include("platypus.Badger"),r=include("springroll.pixi.PixiDisplay"),o=include("springroll.Debug",!1),h=include("platypus.Games"),l=include("platypus.LabRetriever"),p="complete"===localStorage.getItem("space-scouts-downloads"),c=document.getElementById("interaction"),u=function(t,e){return e[t]?e[t]:e.touches&&e.touches[0]&&e.touches[0][t]?e.touches[0][t]:0},d=u.bind(null,"clientX"),g=u.bind(null,"clientY"),m=function(t){c.style.display="none",y=!1,f.paused=!1;try{document.body.removeChild(c)}catch(t){}f.analyticsEmitter.clickPlay({x:d(t),y:g(t),stage_width:window.innerWidth,stage_height:window.innerHeight})},y=!e||i.indexOf("os 9_")>=0,f=new n({name:"space-scouts-home-base",canvasId:"stage",captions:"captions",configPath:"assets/config/config.json",display:r,displayOptions:{clearView:!0,preserveDrawingBuffer:!0},enableHiDPI:!0,preload:(t=[{id:"buttons",src:"assets/images/buttons.png"},{id:"Smoke_t01",src:"assets/images/Smoke_t01.png"},{id:"sparkle",src:"assets/images/sparkle.png"},{id:"game_icons",src:"assets/images/game_icons.png"}],s||t.push({id:"ScreenBadge_Standard",src:"assets/images/ScreenBadge_Standard.png"}),t),resizeElement:"content",responsive:!0,uniformResize:!1,state:p?"menu":"menu-downloading",version:"1.0.5"}),w=function(){var t=document.getElementById("frame"),e=window.innerHeight,i=window.innerWidth,s=.75*i>>0,n=2*e>>0;e>s?(t.style.height=s+"px",t.style.top=((e-s)/2>>0)+"px",t.style.width="",t.style.left=""):i>n?(t.style.width=n+"px",t.style.left=((i-n)/2>>0)+"px",t.style.height="",t.style.top=""):(t.style.height="",t.style.top="",t.style.width="",t.style.left="")};if(f.userData.fixFetch(),f.on("init",function(){var t=new a(f.config["badge-list"],"space-scouts-home-base"!==f.name?f.name:"",f.userData,function(t,e){o&&f.analyticsEmitter.enableLogging(),f.analyticsEmitter.startGame(f.options.version,e),f.googleAnalytics.event(f.name,"StartGame")});f.container.on("download-complete",function(){f.sound.play("download-complete")}),platypus.games=new h(f),f.paused=y,platypus.labRetriever=new l(f.userData),platypus.badger=t,t.increment("tried-"+f.name),f.captions.data=f.config.captions}),f.once("endGame",function(t){f.analyticsEmitter.endGame(t,platypus.badger.getBadgeStatusForLAP()),f.googleAnalytics.event(f.name,"EndGame")}),f.on("resize",function(t,e){f.transition?(f.transition.x=t/2,f.transition.y=e/2,f.transition.scale.x=f.transition.scale.y=e/880):(platypus.savedWidth=t,platypus.savedHeight=e)}),platypus.savedGame=sessionStorage.getItem("load-saved-game")||null,platypus.savedGame){sessionStorage.removeItem("load-saved-game");try{platypus.savedGame=JSON.parse(platypus.savedGame)}catch(t){platypus.savedGame=null}}window.app=f,window.addEventListener("resize",w,!1),window.addEventListener("orientationchange",w,!1),window.addEventListener("focus",w,!1),window.addEventListener("load",w,!1);try{!y||window.AudioContext&&"running"!==(new window.AudioContext).state||window.webkitAudioContext&&"running"!==(new window.webkitAudioContext).state||(y=!1)}catch(t){platypus.debug.warn("Unlocking audio error: "+t.message)}y&&(c.addEventListener("pointerup",m),c.addEventListener("mouseup",m),c.addEventListener("touchend",m),c.style.display="block")}(),function(){"use strict";var t=include("platypus.Data"),e=function(t,e){return t.time-e.time},i=function(i,s){var n=0;for(n=0;n<i.length;n++)s.push(t.setUp("event",i[n].event,"time",i[n].time||0,"message",i[n].message));return n&&s.sort(e),s},s=function(i,s,n){var a=0,r=n.getElapsed();for(a=0;a<i.length;a++)s.push(t.setUp("event",i[a].event,"time",(i[a].time||0)+r,"message",i[a].message||null));a&&s.sort(e)},n=function(t,e,i){var n=0,a=Array.setUp();for(n=0;n<t.length;n++)t[n].sound?(t[n].events&&a.push(s.bind(this,t[n].events,e,i)),a.push(t[n].sound)):a.push(t[n]);return a},a=function(t,e){this.playingAudio=!1,this.player.unloadSound(),this.owner.destroyed||(this.checkTimeEvents(!0),this.owner.triggerEvent("sequence-complete")),e.recycle()},r=function(t,e){var s=null,r=Array.setUp(),o=this.player;"string"==typeof t?s=Array.setUp(t):Array.isArray(t)?s=n(t,r,o):(t.events&&i(t.events,r),s=Array.isArray(t.sound)?n(t.sound,r,o):Array.setUp(t.sound)),e&&e.events&&i(e.events,r),o.play(s,a.bind(this,!0,s),a.bind(this,!1,s)),this.eventList.recycle(),this.eventList=r,this.playingAudio=!0};platypus.createComponentClass({id:"AudioVO",properties:{audioMap:null},initialize:function(){var t="";if(this.eventList=Array.setUp(),this.playingAudio=!1,this.player=platypus.game.app.voPlayer,this.player.trackSound=platypus.supports.iOS,this.audioMap)for(t in this.audioMap)this.audioMap.hasOwnProperty(t)&&this.addEventListener(t,r.bind(this,this.audioMap[t]));this.paused=!1},events:{"handle-render":function(){this.paused||this.checkTimeEvents(!1)},"stop-audio":function(){this.player.stop(),this.player.voList=[]}},methods:{checkTimeEvents:function(t){var e=null,i=this.eventList,s=0,n=this.owner;if(i&&i.length)for(s=this.player.getElapsed();i.length&&(t||i[0].time<=s);)e=i.greenSplice(0),n.trigger(e.event,e.message),e.recycle()},destroy:function(){this.playingAudio&&(this.player.stop(),this.player.voList=[]),this.eventList.recycle()}}})}(),function(){"use strict";platypus.createComponentClass({id:"BadgeAward",properties:{},publicProperties:{},initialize:function(){this.badgeList=null,this.lastState=""},events:{"scene-loaded":function(t){var e=platypus.game.app;this.badgeList=t,this.owner.triggerEvent("show-next-badge"),e.music="planetarium-ambiance",e.musicInstance.volume=.5},"show-next-badge":function(){var t=platypus.game.app,e=null,i=this.owner.state;if(this.badgeList.length)switch(e=this.badgeList.greenSplice(0),this.badgeList.length||this.owner.triggerEvent("last-badge-showing"),t.analyticsEmitter.unlockedBadge(e.name),t.googleAnalytics.event(t.name,"BadgeUnlocked",e.name,1),this.lastState&&i.set(this.lastState,!1),this.lastState=e["game-id"]+"-"+e.id,i.set(this.lastState,!0),this.owner.triggerEvent("set-title",e.name),this.owner.triggerEvent(this.lastState),e.highlight){case"rank-0":case"rank-1":case"rank-2":case"rank-3":case"rank-4":this.owner.triggerEvent("fanfare"),this.owner.scaleX=this.owner.scaleY=1.3333;break;default:this.owner.triggerEvent("tada"),this.owner.scaleX=this.owner.scaleY=1.76}else platypus.game.loadScene("badge-menu")}},methods:{},publicMethods:{}})}(),function(){"use strict";var t=include("createjs.Tween"),e=include("createjs.Ease"),i=include("platypus.Entity");platypus.createComponentClass({id:"BadgeBannerBuilder",properties:{bannerPositions:null,toBuild:"all",zoomOutWidth:1816,zoomOutHeight:1360,zoomInWidth:908,zoomInHeight:680},publicProperties:{},initialize:function(){var t=platypus.game.app,e=t.name,i=platypus.badger.getBadges(),s=0,n=null;if(this.showEverything="space-scouts-home-base"===e,this.zoomBanners=[],this.banners=[],this.badges={},this.badgeHighlight=null,this.collectedBadges=0,this.zooming=!1,this.cameraX=0,this.cameraY=0,this.tweenWidth=1816,this.tweenHeight=1360,this.targetBanner=null,this.zoomed="out",this.showEverything)for(n in i)i.hasOwnProperty(n)&&(this.buildBanner(n,i[n],s),s++);else this.buildBanner(e,i[e],s);this.badgeHighlight=this.owner.addEntity({type:"badge-highlight",properties:{x:0,y:0,z:100.5,opacity:.001}}),t.music="jam",t.musicInstance.volume=.5,t.getNext=function(){return"out"===this.zoomed?"home-base":"treehouse"}.bind(this),t.getPrev=function(){return"out"===this.zoomed?"treehouse":this.targetBanner.game+"-banner"}.bind(this),this.badgeTime=Date.now(),t.googleAnalytics.event(t.name,"EnterBadgeScreen","BadgesCollected",this.collectedBadges)},events:{"scene-live":function(t){var e=0;if(this.showEverything){if(t&&t.banner)for(e=this.banners.length;e--;)if(this.banners[e].game===t.banner){this.owner.triggerEvent("zoom-in",this.banners[e]);break}}else this.owner.triggerEvent("zoom-in",this.banners[0])},tick:function(){this.zooming&&this.resizeCamera()},"camera-update":function(t){this.tweenWidth=t.viewport.width,this.tweenHeight=t.viewport.height,this.cameraX=t.viewport.x,this.cameraY=t.viewport.y},"zoom-out":function(){this.zooming||("out"!==this.zoomed&&this.showEverything?(this.zooming=!0,this.owner.triggerEvent("rl-hide-info-panel"),this.targetBanner.zoomBanner.triggerEvent("show-sprite"),this.targetBanner=null,this.badgeHighlight.opacity=.001,t.get(this).to({cameraX:0,cameraY:0,tweenWidth:this.zoomOutWidth,tweenHeight:this.zoomOutHeight},1e3,e.sineInOut).call(function(){this.zoomed="out",this.zooming=!1,this.resizeCamera()}.bind(this))):this.owner.triggerEvent("new-scene"))},"zoom-in":function(i){this.zooming||"out"!==this.zoomed||(this.zooming=!0,this.targetBanner=i,this.showEverything?i.state.get("app")?t.get(this).to({cameraX:this.targetBanner.x+225,cameraY:this.targetBanner.y,tweenWidth:this.zoomInWidth,tweenHeight:this.zoomInHeight},1e3,e.sineInOut).call(this.zoomInComplete.bind(this,i,!1)):t.get(this).to({cameraX:this.targetBanner.x+180,cameraY:this.targetBanner.y,tweenWidth:.8*this.zoomInWidth,tweenHeight:.8*this.zoomInHeight},1e3,e.sineInOut).call(this.zoomInComplete.bind(this,i,!1)):(this.cameraX=this.targetBanner.x+225,this.cameraY=this.targetBanner.y,this.tweenWidth=this.zoomInWidth,this.tweenHeight=this.zoomInHeight,this.zoomInComplete(i,!0)))}},methods:{zoomInComplete:function(t,e){this.zoomed="in",this.zooming=!1,this.resizeCamera(),this.targetBanner.zoomBanner.triggerEvent("hide-sprite"),this.badges[t.game][0].triggerEvent("send-highlight-info"),this.owner.triggerEvent("rl-show-info-panel",e)},resizeCamera:function(){this.owner.triggerEvent("resize-camera",{width:this.tweenWidth,height:this.tweenHeight}),this.owner.triggerEvent("relocate",{x:this.cameraX,y:this.cameraY})},buildBanner:function(t,e,i){var s=null,n=this.bannerPositions&&this.bannerPositions[t],a=null,r=450*(i%3),o=650*Math.floor(i/3);this.showEverything?n?(r=n.x,o=n.y):(r+=-450,o+=-325):r-=225,(s=this.owner.addEntity({type:"badge-banner",properties:{x:r,y:o,z:100,game:t}})).state.set(t,!0),a=this.owner.addEntity({type:"zoom-banner",properties:{game:t,x:r,y:o,z:102}}),s.zoomBanner=a,a.banner=s,this.banners.push(s),this.zoomBanners.push(a),this.buildBadges(t,e,r,o,n)},buildBadges:function(t,e,i,s,n){var a=0,r=0,o=null,h=null,l=0,p=0,c=0,u="",d="",g=n&&n.badgeOffsetX?n.badgeOffsetX:-91,m=n&&n.badgeOffsetY?n.badgeOffsetY:-70;for(a=0;a<e.length;a++)h=e[a],n.specials&&n.specials[a]?(r-=1,p=i+n.specials[a].x,c=s+n.specials[a].y):(l=Math.floor((a+r)/3),p=i+g+91*((a+r)%3),c=s+m+91*l),u=h.name,d=h.description,o=this.owner.addEntity({type:"badge",properties:{x:p,y:c,z:101,animation:t+"-"+h.id,highlight:h.highlight||"circle",name:u||t+"-"+h.id,description:d||"Undescribed",level:h.level,collected:h.completed,game:t,directive:h.directive,progress:this.getProgress(h)}}),this.addGroupInfo(h,o,"group1"),this.addGroupInfo(h,o,"group2"),this.addGroupInfo(h,o,"group3"),this.addGroupInfo(h,o,"group4"),o.collected?(o.state.set(o.animation,!0),this.collectedBadges+=1):o.opacity=.2,h.highlight?(o.state.set(h.highlight,!0),o.collected?o.scaleX=o.scaleY=.203452:o.scaleX=o.scaleY=.203452/.6):o.scaleX=o.scaleY=.6344*.38,this.badges[t]||(this.badges[t]=[]),this.badges[t].push(o)},addGroupInfo:function(t,e,i){var s=0,n=0,a=null,r=0,o=0;if(t[i]){if(e[i]=t[i],e[i+"-directive"]=t[i+"-directive"],!t.subgoals)return e[i+"-complete"]=!1,void(e[i+"-progress"]=0);for(s=(a=t[i+"-subgoals"].split(",")).length;s--;)for(n=t.subgoals.length;n--;)if(t.subgoals[n].key===a[s]){o+=Math.min(t.subgoals[n].progress||0,+(t.subgoals[n].count||0)),r+=+(t.subgoals[n].count||0);break}o!==r?(e[i+"-complete"]=!1,e[i+"-progress"]=o/r):e[i+"-complete"]=!0}},getProgress:function(t){var e=0,i=0,s=0;if(!t.subgoals)return 0;for(e=t.subgoals.length;e--;)s+=Math.min(t.subgoals[e].progress||0,+(t.subgoals[e].count||0)),i+=+(t.subgoals[e].count||0);return s/i},destroy:function(){var t=platypus.game.app;t.googleAnalytics.event(t.name,"ExitBadgeScreen","BadgeScreenTime",Date.now()-this.badgeTime>>0)}},publicMethods:{},getAssetList:function(){for(var t=null,e=["badge-banner","badge","badge-highlight","zoom-banner"],s=e.length,n=Array.setUp();s--;)t=i.getAssetList({type:e[s]}),n.union(t),t.recycle();return n}})}(),function(){"use strict";platypus.createComponentClass({id:"BadgeHighlightLogic",properties:{},publicProperties:{},initialize:function(){this.prevAnimation=null},events:{"highlight-badge":function(t){this.owner.opacity=1,this.owner.x=t.x,this.owner.y=t.y,this.owner.triggerEvent("set-animation",t.highlight)},"set-animation":function(t){""!==this.prevAnimation&&this.owner.state.set(this.prevAnimation,!1),this.owner.state.set(t,!0),this.prevAnimation=t}},methods:{},publicMethods:{}})}(),function(){"use strict";var t=include("createjs.Tween"),e=include("platypus.Data"),i=include("platypus.Entity"),s=function(t,e){var i=null;return t&&(e=(t=t.split(":"))&&t[0]||e),"app"===e||(i=platypus.games.getGame(e))&&1===i.data};platypus.createComponentClass({id:"BadgeInfoPanelLogic",properties:{},publicProperties:{},initialize:function(){this.highlightedBadge=null,this.prevAnimation="",this.badgeInfo=null,this.rows=Array.setUp()},events:{"scene-loaded":function(){var t=platypus.game.app,e=t.name,i=null,s=t.config["badge-list"],n=null,a=null;if(this.highlightedBadge=this.owner.parent.addEntity({type:"highlighted-badge",properties:{x:this.owner.x,y:this.owner.y+-270,z:101}}),this.rows.push(this.createGoRow(0),this.createGoRow(1),this.createGoRow(2),this.createGoRow(3)),"space-scouts-home-base"===e){for(i in s)if(s.hasOwnProperty(i)){a={name:(n=s[i].badges[0]).name,description:n.description,level:n.level,animation:i+"-"+n.id,game:i};break}}else a={name:(n=s[e].badges[0]).name,description:n.description,level:n.level,animation:e+"-"+n.id,game:e};this.owner.triggerEvent("highlight-badge",a,!0),this.owner.triggerEvent("hide-sprite"),this.highlightedBadge.triggerEvent("hide-sprite"),this.rows[0].checkmark.triggerEvent("hide-sprite"),this.rows[1].checkmark.triggerEvent("hide-sprite"),this.rows[2].checkmark.triggerEvent("hide-sprite"),this.rows[3].checkmark.triggerEvent("hide-sprite")},"highlight-badge":function(t,e){var i=this.highlightedBadge;this.badgeInfo=t,i.scaleX=i.scaleY=1,t.collected?(this.owner.triggerEvent("set-badge-animation",t.animation),"circle"!==t.highlight&&(i.scaleX=i.scaleY=2/3),this.owner.state.set("earned",!0),e||(this.owner.triggerEvent(t.animation+"-earned"),platypus.game.app.voPlayer.play(t.animation))):(this.owner.triggerEvent("set-badge-animation",t.highlight||"empty"),this.owner.state.set("earned",!1),e||(this.owner.triggerEvent(t.animation),platypus.game.app.voPlayer.play([t.animation,t.game+"-to-earn-badge",t.animation+"-requirements"]))),this.owner.triggerEvent("set-title-text",t.name),this.loadRows(t)},"set-badge-animation":function(t){""!==this.prevAnimation&&this.highlightedBadge.state.set(this.prevAnimation,!1),this.highlightedBadge.state.set(t,!0),this.prevAnimation=t},"hide-info-panel":function(){this.tweenHide(this.owner),this.tweenHide(this.highlightedBadge),this.tweenHide(this.rows[0].checkmark),this.tweenHide(this.rows[1].checkmark),this.tweenHide(this.rows[2].checkmark),this.tweenHide(this.rows[3].checkmark)},"show-info-panel":function(e){var i=e?0:300;this.owner.triggerEvent("show-sprite"),this.highlightedBadge.triggerEvent("show-sprite"),this.rows[0].checkmark.triggerEvent("show-sprite"),this.rows[1].checkmark.triggerEvent("show-sprite"),this.rows[2].checkmark.triggerEvent("show-sprite"),this.rows[3].checkmark.triggerEvent("show-sprite"),this.owner.opacity=.001,this.highlightedBadge.opacity=.001,this.rows[0].checkmark.opacity=.001,this.rows[1].checkmark.opacity=.001,this.rows[2].checkmark.opacity=.001,this.rows[3].checkmark.opacity=.001,t.get(this.owner).to({opacity:1},i),t.get(this.highlightedBadge).to({opacity:1},i),t.get(this.rows[0].checkmark).to({opacity:1},i),t.get(this.rows[1].checkmark).to({opacity:1},i),t.get(this.rows[2].checkmark).to({opacity:1},i),t.get(this.rows[3].checkmark).to({opacity:1},i)},"get-badge":function(t){var e=platypus.game.app,i=null,s=this.badgeInfo.game,n=null;t.directive?(s=(i=t.directive.split(":"))&&i[0]||this.badgeInfo.game,platypus.debug.olive("This one has a directive! "+t.directive)):platypus.debug.olive("Wants to achieve badge. Opening Level Select for all cases at this point."),"space-scouts-home-base"===e.name?"app"===s?this.owner.triggerEvent("look-at-all-badges"):(sessionStorage.setItem("get-badge",i),(n=e.router.navigate(s))?n.subscribe(function(t){platypus.debug.log("Navigation Event",t)}):platypus.debug.warn("BadgeInfoPanelLogic: Unable to navigate to game.")):platypus.game.loadScene("level-select")}},methods:{createGoRow:function(t){var i=this.owner,s=e.setUp("checkmark",i.parent.addEntity({type:"go-to-badge-button",properties:{x:i.x+-300,y:i.y+100+100*t,z:101}}),"directive","","visible",!1);return s.checkmark.on("released",i.triggerEvent.bind(i,"get-badge",s)),s},loadRows:function(t){for(var e=["group1","group2","group3","group4"],i=e.length,n=0,a=null,r=null,o=null;i--;){for(o=(r=(a=this.rows[i]).checkmark).state,n=1;n<=16;n++)o.set("filled-"+n,!1);t[e[i]]?(r.x=this.owner.x+-300,r.triggerEvent("set-text",t[e[i]]),a.visible=!0,a.directive=t[e[i]+"-directive"],s(a.directive,t.game)?(r.state.set("unavailable",!1),t[e[i]+"-complete"]?r.triggerEvent("disable"):(o.set("filled-"+(Math.ceil(16*t[e[i]+"-progress"])||1),!0),r.triggerEvent("enable"))):(r.state.set("unavailable",!0),r.triggerEvent("disable"))):(r.x=-6e3,a.visible=!1)}t.group1?(r.components[3].sprite.y=0,r.components[3].sprite.anchor.y=.5):((r=(a=this.rows[0]).checkmark).x=this.owner.x+-300,r.triggerEvent("set-text",t.description),a.visible=!0,a.directive=t.directive,s(a.directive,t.game)?(r.state.set("unavailable",!1),t.collected?r.triggerEvent("disable"):(o.set("filled-"+(Math.ceil(16*t.progress)||1),!0),r.triggerEvent("enable"))):(r.state.set("unavailable",!0),r.triggerEvent("disable")),r.components[3].sprite.y=-24,r.components[3].sprite.anchor.y=0)},tweenHide:function(e){t.get(e).to({opacity:0},300).call(function(){e.triggerEvent("hide-sprite")})}},publicMethods:{},getAssetList:function(){for(var t=null,e=["highlighted-badge","go-to-badge-button"],s=e.length,n=Array.setUp();s--;)t=i.getAssetList({type:e[s]}),n.union(t),t.recycle();return n}})}(),function(){"use strict";platypus.createComponentClass({id:"BadgeLogic",properties:{},publicProperties:{animation:"",highlight:"circle",name:"default name",description:"default description",level:"",collected:!1,game:""},initialize:function(){},events:{"send-highlight-info":function(){this.owner.triggerEvent("rl-highlight-badge",this.owner)}},methods:{},publicMethods:{}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.Data"),i=include("createjs.Ease"),s=include("createjs.Tween"),n=include("platypus.Vector");platypus.createComponentClass({id:"Encourager",properties:{appToo:!1,game:"",destinationA:0,destinationB:0,direction:1,instead:"",speed:.25,margin:90},initialize:function(){var e=this.instead&&2*Math.random()>>0?this.instead:this.game,i=platypus.badger.getBadges(e),s=0,n=Array.setUp();for(s=0;s<i.length;s++)i[s].completed||n.push("try-"+e+"-"+i[s].id);if(n.length>2&&(n.length=2),this.appToo){for(i=platypus.badger.getBadges("app"),s=0,s=0;s<i.length;s++)i[s].completed||n.push("try-app-"+i[s].id);n.length>4&&(n.length=4),n.push("note-badges","note-journal","note-navigation")}n.push("try-game-"+e+"-1","try-game-"+e+"-2"),this.encouragements=n,Object.defineProperty(this,"stickyClick",{set:function(t){this.stickyClick=t}.bind(this.owner.parent),get:function(){return this.stickyClick}.bind(this.owner.parent)}),this.camera=t.setUp(),this.vector=null,this.state=this.owner.state,this.sensorState=!1,this.groupMovement=null,this.ignoreInput=!1,this.destinationA=this.destinationA||this.owner.x,this.originalY=this.owner.y,this.originalZ=this.owner.z,this.originalScaleX=this.owner.scaleX,this.owner.scaleX=this.owner.scaleX*this.direction,this.originalScaleY=this.owner.scaleY,this.top=this.owner.top,this.left=this.owner.left,this.goHome=0,this.destination=0,this.instead===e&&(this.destinationA-=1200,this.destinationB-=1200)},events:{"camera-update":function(t){this.camera.set(t.viewport)},"handle-render":function(t){var e=this.owner,i=e.parent,s=e.state,n=this.vector;s.get("focus")&&s.set("focus",!1),n&&s.get("dragging")?e.x>this.camera.right-this.margin?i.triggerEvent("scrolling-right"):e.x<this.camera.left+this.margin&&i.triggerEvent("scrolling-left"):this.goHome>0?(this.goHome-=t.delta,this.goHome<=0&&(this.goHome=0,this.destinationB&&Math.abs(this.destinationB-e.x)<Math.abs(this.destinationA-e.x)?this.destination=this.destinationB:this.destination=this.destinationA,Math.abs(this.destination-e.x)>15&&(s.set("walking",!0),this.direction=this.destination-e.x>0?1:-1,this.owner.scaleX=this.originalScaleX*this.direction))):s.get("walking")&&(e.x+=this.direction*this.speed*t.delta,Math.abs(this.destination-e.x)<=15&&(s.set("walking",!1),this.destinationB&&(this.destinationB===this.destination?this.direction=this.destinationA-this.destination>0?1:-1:this.direction=this.destinationB-this.destination>0?1:-1,this.owner.scaleX=this.originalScaleX*this.direction)))},pointerdown:function(t){var i=null;this.owner.parent.zooming?this.ignoreInput=!0:(this.dragged=!1,"mouse"===t.pixiEvent.data.pointerType?this.stickyClick?(this.ignoreInput=!0,this.stickyClick(t),this.stickyClick=null):(i=function(t){var i=this.camera,s=this.owner.container.parent.transform.worldTransform,n=e.setUp("event",t.data.originalEvent,"pixiEvent",t,"x",t.data.global.x/s.a+i.left,"y",t.data.global.y/s.d+i.top,"entity",this.owner);this.vector?this.continueInputMovement(n):this.stickyClick?(this.stickyClick(),this.stickyClick=null):platypus.debug.warn("Encourager: Somehow there is a pointermove event hooked up that has no way to be torn down."),n.recycle()}.bind(this),this.startInputMovement(t),this.ignoreInput||(this.owner.container.addListener("pointermove",i),this.stickyClick=function(t,e){this.owner.container.removeListener("pointermove",t),e&&this.vector&&this.endInputMovement(e)}.bind(this,i))):this.startInputMovement(t))},pointermove:function(t){!this.vector||this.ignoreInput||this.vector.x===t.x&&this.vector.y===t.y||(this.dragged=!0,this.stickyClick&&(this.stickyClick(),this.stickyClick=null),this.continueInputMovement(t))},pointerup:function(t){!this.vector||this.ignoreInput||this.stickyClick?this.ignoreInput=!1:this.endInputMovement(t)},pointerupoutside:function(t){!this.vector||this.ignoreInput||this.stickyClick?this.ignoreInput=!1:this.endInputMovement(t)},pointercancel:function(t){this.vector&&(this.ignoreInput||this.stickyClick?this.ignoreInput=!1:this.endInputMovement(t))},"instruct-a":function(t){var e=platypus.game.app,i=e.config.captions[t]&&e.config.captions[t].lines,s=0,n="";if(this.time=Date.now(),this.duration=function(t){var e=createjs.Sound._getSrcById(t);return e&&e.src&&(e=createjs.Sound.activePlugin._audioSources[e.src])?1e3*(e.duration||0)>>0:0}(t),i)for(s=0;s<i.length;s++)n+=i[s].content+" ";try{e.analyticsEmitter.startInstruction("audio",this.duration,n,t)}catch(t){platypus.debug.warn("Analytics Emitter Error",t)}},"instruct-b":function(t){var e=platypus.game.app,i=e.config.captions[t]&&e.config.captions[t].lines,s=0,n="",a=Date.now()-this.time;if(i)for(s=0;s<i.length;s++)n+=i[s].content+" ";try{e.analyticsEmitter.endInstruction("audio",a>>0,n,t)}catch(t){platypus.debug.warn("Analytics Emitter Error",t)}}},methods:{startInputMovement:function(t){var e=this.owner;this.owner.parent.triggerEvent("follow",{mode:"static"}),this.owner.parent.triggerEvent("input-off"),e.state.set("walking",!1),this.vector&&this.vector.recycle(),this.vector=n.setUp(t.x,t.y),this.offsetX=t.x-this.owner.x,this.offsetY=t.y-this.owner.y,this.owner.z+=1e3,this.tween=s.get(this.owner).to({scaleX:1.2*this.originalScaleX*this.direction,scaleY:1.2*this.originalScaleY},300,i.sineInOut),e.parent.triggerEvent("pause-zooming"),this.dragging=!0},continueInputMovement:function(t,e){var i=this.owner,s=i.state,n=this.camera;this.dragging&&!s.get("dragging")&&(s.set("dragging",!0),i.triggerEvent("magnifying"),this.owner.top=null,this.owner.left=null),this.vector.x=t.x,this.vector.y=t.y,i.x=t.x-this.offsetX,i.y=t.y-this.offsetY,i.triggerEvent("dragged",t),!e&&(n.top>i.y||n.bottom<i.y||n.left>i.x||n.right<i.x)&&this.endInputMovement(t,!0)},endInputMovement:function(t,e){var n=this.owner;e||this.continueInputMovement(t,!0),this.vector.recycle(),this.vector=null,n.parent.triggerEvent("unpause-zooming"),n.state.set("dragging",!1),this.goHome=5e3,this.owner.triggerEvent(this.encouragements[Math.random()*this.encouragements.length>>0]),n.parent.triggerEvent("follow",{mode:"pan"}),n.parent.triggerEvent("input-on"),this.tween=s.get(n).to({y:this.originalY,z:this.originalZ,scaleX:this.originalScaleX*this.direction,scaleY:this.originalScaleY},300,i.sineInOut)},destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=window.navigator.userAgent.toLowerCase(),e=t.indexOf("os 9_")>=0||t.indexOf("os 10_")>=0,i=["pink","purple","aqua","yellow","green","orange"],s=include("platypus.Entity");platypus.createComponentClass({id:"FlagBuilder",properties:{flagLines:null,flagLocations:null},publicProperties:{},initialize:function(){var t=this.flagBadges=Array.setUp(),s=0,n=platypus.badger.getBadges(),a=null,r=0,o=0,h=0,l=null,p=null;if(!e){for(l in this.banners=[],this.badges=[],this.badgeHighlight=null,this.targetBanner=null,n)if(n.hasOwnProperty(l))for(h=n[l].length;h--;)n[l][h].completed&&("app"!==l||n[l][h].id>4)&&t.push(n[l][h]);for((o=Math.ceil(t.length/this.flagLocations.length))%2&&(o+=1),h=o,o=Array.setUp();h--;)o.push(this.owner.addEntity({type:"flag-line",properties:{state:{"long-clip":"long-clip"===this.flagLines[h].state,"short-clip":"short-clip"===this.flagLines[h].state},x:this.flagLines[h].x,y:this.flagLines[h].y,z:this.flagLines[h].z}}));for(h=t.length;h--;)r=2*(h/(2*this.flagLocations.length)>>0)+h%2,a=this.flagLines[r],s=(h/2>>0)%this.flagLocations.length,r%2&&(s=this.flagLocations.length-s-1),p={},t[h]&&(p[t[h]["game-id"]+"-"+t[h].id]=!0),p[i[((h/2>>0)+r)%i.length]]=!0,this.owner.addEntity({type:"flag-badge",properties:{rotation:this.flagLocations[s].rotation,state:p,x:a.x+this.flagLocations[s].x,y:a.y+this.flagLocations[s].y}})}},getAssetList:function(){for(var t=null,i=e?[]:["flag-line","flag-badge"],n=i.length,a=Array.setUp();n--;)t=s.getAssetList({type:i[n]}),a.union(t),t.recycle();return a}})}(),function(){"use strict";platypus.createComponentClass({id:"Flipper",properties:{leftHair:"",rightHair:"",hairSlot:"",leftBadge:"",rightBadge:"",badgeSlot:""},initialize:function(){this.direction=0,this.spine=null},events:{load:function(){for(var t=this.owner.components,e=t.length;e--;)if(t[e].spine){this.spine=t[e].spine;break}},"handle-render":function(){this.spine&&this.direction!==this.owner.scaleX&&(this.direction=this.owner.scaleX,this.direction>0?(this.hairSlot&&this.spine.skeleton.setAttachment(this.hairSlot,this.rightHair),this.badgeSlot&&this.spine.skeleton.setAttachment(this.badgeSlot,this.rightBadge)):(this.hairSlot&&this.spine.skeleton.setAttachment(this.hairSlot,this.leftHair),this.badgeSlot&&this.spine.skeleton.setAttachment(this.badgeSlot,this.leftBadge)))}}})}(),function(){"use strict";var t=include("createjs.Ease"),e=include("createjs.Tween");platypus.createComponentClass({id:"Flourish",properties:{range:null,golden:!0,count:1,offsetX:0,offsetY:0,offsetZ:10,spawns:"",rate:100},publicProperties:{},initialize:function(){this.time=0,this.index=0,this.fxModifier=1},events:{pulse:function(){this.flourishing=!0},"handle-render":function(t){var e=t.delta;this.fxModifier=e>15?15/e:1},"handle-logic":function(t){var e=0,i=this.owner.x,s=this.owner.y;this.flourishing&&(this.time+=t.delta,this.time>this.rate/this.fxModifier&&(this.time-=this.rate/this.fxModifier,e=2*Math.PI/this.count,i=this.owner.x+this.range*Math.cos(e*this.index),s=this.owner.y+this.range*Math.sin(e*this.index),this.addHere(i,s),this.index+=1,this.index>=this.count&&(this.index=0)))},flourish:function(t){var e=0,i=0,s=this.range,n=0,a=t||this.count,r=this.owner.x,o=this.owner.y;if("number"==typeof s)for(e=2*Math.PI/a;a--;)r=this.owner.x+this.range*Math.cos(e*a),o=this.owner.y+this.range*Math.sin(e*a),this.addHere(r,o);else if(s.width&&s.height)for(n=(2*s.width+2*s.height)/a,r-=s.width/2,o-=s.height/2,i=0;a--;)(i=n*a)<=s.width?this.addHere(r+i,o):i<=s.width+s.height?this.addHere(r+s.width,o+i-s.width):i<=2*s.width+s.height?this.addHere(r+s.width-(i-s.width-s.height),o+s.height):this.addHere(r,o+s.height-(i-2*s.width-s.height));else for(;a--;)this.addHere(r,o)}},methods:{addHere:function(i,s){var n=.6*Math.random()+.3,a=this.owner.parent.addEntity({type:this.spawns,properties:{opacity:1,rotation:0,scaleX:2*n,scaleY:2*n,tint:this.golden?16776960+255*Math.random()>>0:null,x:this.offsetX+i,y:this.offsetY+s,z:this.owner.z+this.offsetZ}}),r=i-this.owner.x,o=s-this.owner.y,h=r*r+o*o;this.golden&&e.get(a).to({opacity:0,rotation:(Math.random()<.5?1:-1)*(720+1440*Math.random()),scaleX:n,scaleY:n,x:this.offsetX+i+(r>0?1:-1)*n*150*r*r/h,y:this.offsetY+s+(o>0?1:-1)*n*150*o*o/h},1e3+2e3*Math.random(),t.sineOut).call(function(t){!t.destroyed&&this.owner.parent&&this.owner.parent.removeEntity(t)}.bind(this,a))}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("PIXI.Graphics"),i=include("platypus.StateMap"),s={unknown:new i("!no-internet,!in-progress,!indeterminate,progress-0,!progress-1,!progress-2,!progress-3,!complete"),offline:new i("no-internet,!in-progress,!indeterminate,!progress-0,!progress-1,!progress-2,!progress-3,complete"),offlineWithSunspot:new i("no-internet,in-progress,!indeterminate,progress-0,!progress-1,!progress-2,!progress-3,!complete"),complete:new i("!no-internet,!in-progress,!indeterminate,!progress-0,!progress-1,!progress-2,!progress-3,complete"),progress0:new i("!no-internet,in-progress,!indeterminate,progress-0,!progress-1,!progress-2,!progress-3,!complete"),progress1:new i("!no-internet,in-progress,!indeterminate,!progress-0,progress-1,!progress-2,!progress-3,!complete"),progress2:new i("!no-internet,in-progress,!indeterminate,!progress-0,!progress-1,progress-2,!progress-3,!complete"),progress3:new i("!no-internet,in-progress,!indeterminate,!progress-0,!progress-1,!progress-2,progress-3,!complete"),indeterminate:new i("!no-internet,in-progress,indeterminate,progress-0,!progress-1,!progress-2,!progress-3,!complete"),error:new i("!no-internet,!in-progress,!indeterminate,progress-0,!progress-1,!progress-2,!progress-3,!complete")},n=function(t){var e=this.owner,i=e.state,n=this.sunspot;this.lastStatus=null,t?"offline"===t.type?(n?(i.update(s.offlineWithSunspot),n.where===this&&(e.triggerEvent("smokey"),n.where===this&&(n.where=null,n.x=-6e3,n.triggerEvent("pai")))):i.update(s.offline),e.triggerEvent("enable")):"progress"===t.type?"number"==typeof t.data?this.handleProgress(t):(i.update(s.indeterminate),e.triggerEvent("disable")):(i.update(s.error),e.triggerEvent("disable")):(i.update(s.unknown),e.triggerEvent("disable"))},a=0;platypus.createComponentClass({id:"GameChanger",properties:{game:"",loadSavedGame:null,maskWidth:0,waitForSunspot:!1},initialize:function(){this.progressMask=null,this.indeterminate=!1,this.sunspot=null,this.lastStatus=null,this.handleProgress=this.progressWithoutSunspot},events:{"peer-entity-added":function(t){"sunspot-working"===t.type&&(this.sunspot=t,this.waitForSunspot&&(this.handleUpdate=n.bind(this),this.handleUpdate(platypus.games.getGame(this.game)),platypus.game.app.on(this.game+"-status-update",this.handleUpdate)),this.handleProgress=this.progressWithSunspot)},"handle-logic":function(t){this.indeterminate!==this.owner.state.get("indeterminate")&&(this.indeterminate=this.owner.state.get("indeterminate"),this.progressMask&&(this.indeterminate?this.progressMask.scale.x=.1*platypus.modifyAllAssets:this.progressMask.scale.x=1*platypus.modifyAllAssets)),this.indeterminate&&this.progressMask&&(this.progressMask.x=this.target.offsetX-.4*this.maskWidth+Date.now()%1e3/1e3*this.maskWidth),this.sunspot&&this.sunspot.where===this&&a&&(a-=t.delta)<0&&(a=0),this.lastStatus&&this.handleProgress(this.lastStatus)},load:function(){var i,s,a,r,o=this.owner.components,h=o[o.length-1];this.maskWidth&&(this.target=h,this.progressMask=(i=h.sprite,s=this.owner.container,a=t.setUp(-this.maskWidth,0,this.maskWidth,140),r=new e,i.mask=r,r.isMask=!0,r.z=1,s.addChild(r),r.clear(),r.beginFill(0,1),r.r(a.left,a.top,a.width,a.height),r.endFill(),r),this.progressMask.y=h.offsetY),this.waitForSunspot||(this.handleUpdate=n.bind(this),this.handleUpdate(platypus.games.getGame(this.game)),platypus.game.app.on(this.game+"-status-update",this.handleUpdate))},"load-game":function(){var t=platypus.game.app,e=null;this.owner.state.get("no-internet")?this.owner.triggerEvent("ask-about-internet"):(this.loadSavedGame&&sessionStorage.setItem("load-saved-game",JSON.stringify(this.loadSavedGame)),(e=t.router.navigate(this.game))?e.subscribe(function(t){platypus.debug.log("Navigation Event",t)}):platypus.debug.warn("GameChanger: Unable to navigate to game."))}},methods:{updateFilter:function(t,e,i){var s=t.matrix;s[0]=e,s[4]=i,s[6]=e,s[9]=i,s[12]=e,s[14]=i},destroy:function(){this.interval&&(window.clearInterval(this.interval),this.interval=null),platypus.game.app.off(this.game+"-status-update",this.handleUpdate),this.sunspot&&(this.sunspot.where=null,a=0)},progressWithSunspot:function(t){var e=this.owner,i=e.state,n=this.sunspot,r=n.locations[this.game];t.data>=1?n.where===this&&a?a&&(this.lastStatus=t):(i.get("complete")||(e.triggerEvent("sparkley"),n.where===this&&(n.where=null,n.x=-6e3,n.triggerEvent("pai"))),i.update(s.complete),e.triggerEvent("enable")):0===t.data?(i.update(s.progress0),e.triggerEvent("disable")):t.data>0?(a?this.lastStatus=t:t.data>.5?(i.get("progress-3")||(e.triggerEvent("smokey"),n.triggerEvent("pai",e.x+r[6],e.y+r[7],r[8],e.game),a=3e3,n.where=this),i.update(s.progress3)):t.data>.25?(i.get("progress-2")||(e.triggerEvent("smokey"),n.triggerEvent("ham",e.x+r[3],e.y+r[4],r[5]),a=3e3,n.where=this),i.update(s.progress2)):(i.get("progress-1")||(e.triggerEvent("smokey"),n.triggerEvent("sawsaw",e.x+r[0],e.y+r[1],r[2]),a=3e3,n.where=this),i.update(s.progress1)),e.triggerEvent("disable")):(i.update(s.indeterminate),e.triggerEvent("disable"))},progressWithoutSunspot:function(t){var e=this.owner,i=e.state;t.data>=1?(i.update(s.complete),e.triggerEvent("enable")):t.data>=0?(t.data>.5?i.update(s.progress3):t.data>.25?i.update(s.progress2):t.data>0?i.update(s.progress1):i.update(s.progress0),e.triggerEvent("disable"),this.progressMask&&(this.progressMask.x=this.target.offsetX+t.data*this.maskWidth)):(i.update(s.indeterminate),e.triggerEvent("disable"))}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPActionButton",properties:{lapEvent:""},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y;e.analyticsEmitter[this.lapEvent]({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},e.getLayout(),e.isReallyReady())},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPBadgeBack",properties:{lapEvent:""},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},pressed:function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y;e.analyticsEmitter.leaveBadges({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},e.getNext(),e.getPrev())},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPBadgeBanner",properties:{lapEvent:""},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y;e.analyticsEmitter.selectBanner({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},platypus.badger.getBadgeStatusForLAP(),this.owner.game)},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPBadgeButton",properties:{lapEvent:""},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y,n=platypus.badger.getBadgeStatusForLAP();e.analyticsEmitter[this.lapEvent]({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},n)},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPBadgeHighlight",properties:{lapEvent:""},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y,n=platypus.badger.getBadgeStatusForLAP(this.owner.name).progress;e.analyticsEmitter.selectBadge({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},platypus.badger.getBadgeStatusForLAP(),this.owner.game,this.owner.name,n)},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPDwellTimer",publicProperties:{hover:!0},initialize:function(){this.camera=t.setUp(),this.time=-1,this.x=0,this.y=0,this.xs=0,this.ys=0},events:{"camera-update":function(t){this.camera.set(t.viewport)},"handle-render":function(t){var e=t.delta;this.time>=0&&(this.time+=e,this.xs+=this.x*e,this.ys+=this.y*e)},pointerover:function(t){this.time=0,this.x=t.x,this.y=t.y,this.ys=0,this.xs=0},pointermove:function(t){this.x=t.x,this.y=t.y},pointerout:function(t){var e=platypus.game.app;t&&t.event&&"mouse"===t.event.pointerType&&this.time>=1e3&&e.analyticsEmitter.dwellTime(this.time>>0,this.owner.type),this.time=-1}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPHelpButton",properties:{lapEvent:""},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y,n=e.getLayout();e.analyticsEmitter[this.lapEvent]({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},n,e.getHint())},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=function(t){var e=0,i=platypus.game.app.config.journal.maxSavesPerGame;for(e=0;e<i;e++)t&&t[e]&&(this.savesTotal+=1)};platypus.createComponentClass({id:"LAPJournalButton",properties:{gameIds:["space-scouts-lab","base-builder","cooking-school","food-farmer","mission-control","rover-maker"]},initialize:function(){var i=platypus.game.app,s=i.config.journal.storageKey,n=this.gameIds,a=n.length;for(this.savesTotal=0,this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y;a--;)i.userData.readGameData(n[a],s,e.bind(this))},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y;e.analyticsEmitter.viewSavedGames({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},this.savesTotal)},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPPointerEvent",properties:{lapEvent:"",includePrev:!1},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y;this.includePrev?e.analyticsEmitter[this.lapEvent]({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},this.includePrev):e.analyticsEmitter[this.lapEvent]({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0})},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPRecycleButton",properties:{lapEvent:""},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y,n=e.getLayout();delete n.player_placed_objects,e.analyticsEmitter[this.lapEvent]({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},n,e.getResources())},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPSavedGame",properties:{lapEvent:"",game:""},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y;e.analyticsEmitter[this.lapEvent]({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0},this.game)},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPScrollButton",initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=t&&"number"==typeof t.x?t.x:this.x,i=t&&"number"==typeof t.y?t.y:this.y,s=platypus.game.app,n=platypus.game.currentScene.layers[0],a=n.components[5].worldCamera||n.components[6].worldCamera;s.analyticsEmitter.scrollin({stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:e-this.camera.left>>0,y:i-this.camera.top>>0},function(t,e){var i=e.left+t.halfWidth,s=e.right-t.halfWidth;return(t.x-i)/(s-i)}(a.viewport,n))},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"LAPSelectLevel",properties:{lapEvent:"",lapLevel:""},initialize:function(){this.camera=t.setUp(),this.x=this.owner.x,this.y=this.owner.y},events:{"camera-update":function(t){this.camera.set(t.viewport)},"pointer-event":function(t){var e=platypus.game.app,i=t&&"number"==typeof t.x?t.x:this.x,s=t&&"number"==typeof t.y?t.y:this.y;e.analyticsEmitter[this.lapEvent](this.lapLevel,{stage_width:this.camera.width>>0,stage_height:this.camera.height>>0,x:i-this.camera.left>>0,y:s-this.camera.top>>0})},pointerdown:function(t){this.x=t.x,this.y=t.y},pointermove:function(t){this.x=t.x,this.y=t.y},pointerup:function(t){this.x=t.x,this.y=t.y}},methods:{destroy:function(){this.camera.recycle()}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("platypus.Data");platypus.createComponentClass({id:"LogicButton",properties:{onPress:"",onRelease:"",onCancel:"",onHover:"",useOnce:!1,disabled:!1,toggle:!1,pressed:!1,passthroughOnMovement:!1},publicProperties:{bottom:null,left:null,right:null,top:null},initialize:function(){var e=this.owner.state;this.aabb=t.setUp(),this.lastBottom=null,this.lastLeft=null,this.lastRight=null,this.lastTop=null,this.state=e,e.set("disabled",this.disabled),e.set("released",!this.pressed),e.set("pressed",this.pressed),e.set("highlighted",!1),this.owner.buttonMode=!this.disabled,this.cancelled=!1,this.readyToToggle=!1,this.savedForPassthrough=null,this.dragging=[]},events:{"handle-logic":function(){var t=this.bottom,e=this.left,i=this.right,s=this.top;this.lastBottom===t&&this.lastLeft===e&&this.lastRight===i&&this.lastTop===s||(this.updatePosition(this.aabb),this.lastBottom=t,this.lastLeft=e,this.lastRight=i,this.lastTop=s)},"camera-update":function(t){this.aabb.set(t.viewport),this.updatePosition(this.aabb)},pointerdown:function(t){this.state.get("disabled")||(this.toggle?this.readyToToggle=!0:(this.onPress&&this.owner.trigger(this.onPress),this.updateStateAndTrigger("pressed"),t&&t.pixiEvent&&t.pixiEvent.stopPropagation&&t.pixiEvent.stopPropagation(),this.useOnce&&this.removeEventListener&&this.removeEventListener("pointerdown")),this.passthroughOnMovement&&(this.savedForPassthrough=e.setUp("entity",t.entity,"event",t.event,"pixiEvent",t.pixiEvent,"x",t.x,"y",t.y),this.motion=e.setUp("x",t.x,"y",t.y)))},pointermove:function(t){this.passthroughOnMovement&&(this.motion&&Math.abs(this.motion.x-t.x)>8&&(this.cancelled=!0,this.state.set("pressed",!1),this.owner.parent.triggerEvent("pointerdown",this.savedForPassthrough),this.savedForPassthrough.recycle(),this.savedForPassthrough=null,this.motion.recycle(),this.motion=null),this.cancelled&&this.owner.parent.triggerEvent("pressmove",t))},pressup:function(t){var e=this.state;e.get("disabled")||(this.cancelled?(this.passthroughOnMovement&&this.owner.parent.triggerEvent("pressup",t),this.onCancel&&this.owner.trigger(this.onCancel),this.updateStateAndTrigger("cancelled")):this.toggle?this.readyToToggle&&(e.get("pressed")?this.updateStateAndTrigger("released"):this.updateStateAndTrigger("pressed")):(this.onRelease&&this.owner.trigger(this.onRelease),this.updateStateAndTrigger("released")),t&&t.pixiEvent&&t.pixiEvent.stopPropagation&&t.pixiEvent.stopPropagation(),this.useOnce&&this.removeEventListener&&(this.removeEventListener("pressup"),this.state.set("disabled",!0),this.owner.buttonMode=!1)),this.cancelled=!1,this.readyToToggle=!1},pointerover:function(){this.onHover&&this.owner.trigger(this.onHover),this.state.get("pressed")&&(this.cancelled=!1)},pointerout:function(){this.state.get("pressed")&&(this.cancelled=!0)},disable:function(){this.state.set("disabled",!0),this.owner.buttonMode=!1},enable:function(){this.state.set("disabled",!1),this.owner.buttonMode=!0},"toggle-disabled":function(){var t=this.state.get("disabled");this.owner.buttonMode=t,this.state.set("disabled",!t)},highlight:function(){this.state.set("highlighted",!0)},unhighlight:function(){this.state.set("highlighted",!1)},"toggle-highlight":function(){var t=this.state;t.set("highlighted",!t.get("highlighted"))},"dragging-taking-place":function(){this.owner.triggerEvent("disable")},"no-dragging-taking-place":function(){this.owner.triggerEvent("enable")}},methods:{updatePosition:function(t){var e=this.bottom,i=this.left,s=this.owner,n=this.right,a=this.top;"number"==typeof i?s.x=t.left+i:"number"==typeof n&&(s.x=t.right-n),"number"==typeof a?s.y=t.top+a:"number"==typeof e&&(s.y=t.bottom-e)},updateStateAndTrigger:function(t){var i=null,s=this.owner,n=this.state,a=n.get("pressed"),r=n.get("released"),o=!1;r&&"pressed"===t?(n.set("pressed",!0),n.set("released",!1),o=!0):a&&"released"===t?(n.set("pressed",!1),n.set("released",!0),o=!0):"cancelled"===t&&(n.set("pressed",!1),n.set("released",!0),o=!0),o&&(i=e.setUp("released",a,"pressed",r,"triggered",r,"entity",s),s.triggerEvent(t,i),i.recycle())},destroy:function(){this.aabb.recycle(),this.aabb=null,this.owner.buttonMode=!1,this.state=null}}})}(),function(){"use strict";var t="complete"===localStorage.getItem("space-scouts-downloads");platypus.createComponentClass({id:"MenuChooser",events:{load:function(){this.owner.triggerEvent("set-scene",t?"menu":"menu-downloading")}}})}(),function(){"use strict";var t;platypus.createComponentClass({id:"Mouth",properties:{animationMap:null,slotName:"Mouth"},initialize:(t=function(t){this.spine&&this.spine.skeleton.setAttachment(this.slotName,t)},function(){var e="",i=this.animationMap;for(e in this.spine=null,i)i.hasOwnProperty(e)&&this.addEventListener(e,t.bind(this,i[e]))}),events:{load:function(){for(var t=this.owner.components,e=t.length;e--;)if(t[e].spine){this.spine=t[e].spine;break}}}})}(),function(){"use strict";platypus.createComponentClass({id:"Parallax",initialize:function(){this.originX=this.owner.x,this.originY=this.owner.y},properties:{},publicProperties:{rate:0},events:{"camera-update":function(t){var e=this.owner,i=this.rate;e.x=this.originX+t.viewport.x*i,e.y=this.originY+t.viewport.y*i}}})}(),function(){"use strict";var t=include("createjs.Tween"),e=include("createjs.Ease");platypus.createComponentClass({id:"PointerBehaviors",properties:{bounceDistance:30,scaleBy:1.25},publicProperties:{},initialize:function(){this.degToRad=Math.PI/180,this.originalX=this.owner.x,this.originalY=this.owner.y,this.originalScaleX=this.owner.scaleX,this.originalScaleY=this.owner.scaleY},events:{"handle-logic":function(t){},move:function(t){this.owner.x=t.x,this.owner.y=t.y,this.owner.rotation=t.rotation||this.owner.rotation,this.originalX=this.owner.x,this.originalY=this.owner.y},"smooth-move":function(i){this.originalX=this.owner.x,this.originalY=this.owner.y,t.get(this.owner).to({x:i.x,y:i.y,rotation:i.rotation||this.owner.rotation},i.time||250,e.sineInOut).call(function(){this.originalX=this.owner.x,this.originalY=this.owner.y}.bind(this))},show:function(){t.get(this.owner).to({opacity:1},100)},hide:function(){t.get(this.owner).to({opacity:0},100)},"start-pulse":function(i){i=i||-1,this.originalScaleX=this.owner.scaleX,this.originalScaleY=this.owner.scaleY,t.get(this.owner,{loop:i}).to({scaleX:this.originalScaleX*this.scaleBy,scaleY:this.originalScaleY*this.scaleBy},250,e.sineInOut).to({scaleX:this.originalScaleX,scaleY:this.originalScaleY},250,e.sineInOut)},"start-bounce":function(i){i=i||-1,this.originalX=this.owner.x,this.originalY=this.owner.y,t.get(this.owner,{loop:i}).to({x:this.originalX+Math.cos(this.owner.rotation*this.degToRad)*this.bounceDistance,y:this.originalY+Math.sin(this.owner.rotation*this.degToRad)*this.bounceDistance},250,e.sineInOut).to({x:this.originalX,y:this.originalY},250,e.sineInOut)},stop:function(){t.removeTweens(this.owner),this.owner.x=this.originalX,this.owner.y=this.originalY,this.owner.scaleX=this.originalScaleX,this.owner.scaleY=this.originalScaleY},"set-state":function(t){this.owner.state.set(t.state,t.value)}},methods:{},publicMethods:{}})}(),function(){"use strict";var t=["rank-0","rank-1","rank-2","rank-3","rank-4"];platypus.createComponentClass({id:"RankState",initialize:function(){for(var e=platypus.badger.getBadges().app,i=e&&e.length;i--;)t[e[i].id]&&this.owner.state.set(t[e[i].id],e[i].completed);platypus.badger.increment("first-time-space-scout"),platypus.badger.badgesAwarded.length>0&&this.owner.triggerEvent("pulse")},events:{released:function(){platypus.badger.increment("tried-badges"),this.checkForNewBadges()}},methods:{checkForNewBadges:function(){var t=platypus.badger.award();t&&t.length?platypus.game.loadScene("badge-award-scene",t):platypus.game.loadScene("badge-menu",t)}}})}(),function(){"use strict";var t,e=include("PIXI.Graphics"),i=include("platypus.components.RenderContainer"),s=(t=function(t,e){var i=0,s=e.indexOf("("),n=e.substring(0,s),a=e.substring(s+1,e.indexOf(")"));if(a.length){for(i=(a=a.greenSplit(",")).length;i--;)a[i]=+a[i];t[n].apply(t,a),a.recycle()}else t[n]()},function(e,i){var s=0,n=i.greenSplit(".");for(s=0;s<n.length;s++)t(e,n[s]);n.recycle()});platypus.createComponentClass({id:"RenderGraphics",properties:{offsetX:0,offsetY:0,offsetZ:0,shape:""},publicProperties:{color:16776960,width:100,height:100},initialize:function(t){var e,n,a,r,o;"string"==typeof this.color&&(this.color=parseInt(this.color.replace("#","0x"),16)),e=this,n=this.shape,a=this.color,r=this.width,o=this.height,e.beginFill(a,1),n&&"string"==typeof n?s(e,n):n&&n.radius?e.dc(n.x||0,n.y||0,n.radius):n&&n.width&&n.height?e.r(n.x||0,n.y||0,n.width,n.height):e.r(-r/2,-o/2,r,o),e.endFill(),this.x=this.offsetX,this.y=this.offsetY,this.z=this.offsetZ,this.owner.container?this.addToContainer():this.owner.addComponent(new i(this.owner,t,this.addToContainer.bind(this)))},methods:{addToContainer:function(){var t=this.owner.container;t.addChild(this),t.reorder=!0},destroy:function(){this.owner.container.removeChild(this)}}},e)}(),function(){"use strict";var t=include("platypus.Data"),e=include("platypus.components.RenderContainer"),i=include("PIXI.Graphics"),s=include("platypus.Vector");platypus.createComponentClass({id:"RenderShape",properties:{mask:null,interactive:!1,offsetX:0,offsetY:0,offsetZ:0,rotate:!1,mirror:!1,flip:!1,visible:!0,cache:!1,ignoreOpacity:!1,scale:1,scaleX:1,scaleY:1,skew:0,skewX:0,skewY:0,rotation:0,shape:null},initialize:function(){var n=null,a=this.owner,r=a.shape,o=r&&r.points||null,h=this.gfx=new i,l=r&&r.translation?s.setUp(r.translation.x,r.translation.y):s.setUp(0,0);h.beginFill(16777215,1),o?h.drawPolygon(function(t,e){var i=Array.setUp(),s=0;for(s=0;s<t.length;s++)i.push(t[s].x+e.x,t[s].y+e.y);return i}(o,{x:l.x,y:l.y})):r&&"circle"===r.type?h.drawCircle(this.offsetX,this.offsetY,r.radius||a.radius||a.width/2):h.drawRect(this.offsetX-a.width/2,this.offsetY-a.height/2,a.width,a.height),h.endFill(),l.recycle(),this.owner.container?this.addToContainer():(n=t.setUp("interactive",this.interactive,"mask",this.mask,"rotate",this.rotate,"mirror",this.mirror,"flip",this.flip,"visible",this.visible,"cache",this.cache,"ignoreOpacity",this.ignoreOpacity,"scaleX",this.scaleX,"scaleY",this.scaleY,"skewX",this.skewX,"skewY",this.skewY,"rotation",this.rotation),this.owner.addComponent(new e(this.owner,n,this.addToContainer.bind(this))),n.recycle())},events:{},methods:{addToContainer:function(){var t=this.owner.container;t.addChild(this.gfx),t.reorder=!0}}})}(),function(){"use strict";var t,e,i=include("PIXI.spine.core.TextureAtlas",!1),s=include("PIXI.spine.core.AtlasAttachmentLoader",!1),n=include("PIXI.BaseTexture"),a=include("platypus.Data"),r=include("platypus.components.EventRender"),o=include("platypus.components.RenderContainer"),h=include("PIXI.spine.core.SkeletonJson",!1),l=include("PIXI.spine.Spine",!1),p=include("platypus.components.StateRender");l&&platypus.createComponentClass({id:"RenderSpine",properties:{animationMap:null,mask:null,interactive:!1,mixTimes:0,offsetX:0,offsetY:0,offsetZ:0,atlas:"",skeleton:null,rotate:!1,mirror:!1,flip:!1,visible:!0,eventBased:!1,stateBased:!0},publicProperties:{dragMode:!1,scaleX:1,scaleY:1,skewX:0,skewY:0,rotation:0,x:0,y:0,z:0},initialize:(e=function(t,e,i){var s,a,r=(s=e,(a=platypus.game.app.assetManager.cache.read(s.substring(s.lastIndexOf("/")+1,s.lastIndexOf("."))))||platypus.debug.warn('RenderSpine: "'+s+'" is not a loaded asset.'),new n(a));i(r),r.isLoading?r.on("loaded",t):t()},function(t,n){var c,u="",d=null,g=platypus.game.settings,m=g.atlases[this.atlas+"-"+(1===platypus.modifyAllAssets?1:2)],y=g.skeletons[this.skeleton],f=new i(m,e.bind(null,n)),w=new h(new s(f)).readSkeletonData(y),v=this.spine=new l(w);return v.state.addListener({event:function(t,e){var i=e.data.name;this.playAnimation(i)&&this.spine.update(1e-6),this.owner.trigger(i,e.data)}.bind(this),complete:function(){this.owner.triggerEvent("animation-ended",this.currentAnimation)}.bind(this)}),v.autoUpdate=!1,c=function(t,e){var i=null,s="";if(t)return t;for(s in i={},e)e.hasOwnProperty(s)&&(i[s]=s);return i}(this.animationMap,y.animations),this.stateBased=c&&this.stateBased,this.eventBased=c&&this.eventBased,c&&(u=c.default||"",this.eventBased&&(d=a.setUp("animationMap",c,"component",this),this.owner.addComponent(new r(this.owner,d)),d.recycle()),this.stateBased&&(d=a.setUp("animationMap",c,"forcePlayThrough",this.forcePlayThrough,"component",this),this.owner.addComponent(new p(this.owner,d)),d.recycle())),this.mixTimes&&this.setMixTimes(this.mixTimes),u&&(this.currentAnimation=u,v.state.setAnimation(0,u,!0)),v.x=this.offsetX,v.y=this.offsetY,v.z=this.offsetZ,this.owner.container?this.addToContainer():(d=a.setUp("interactive",this.interactive,"mask",this.mask,"rotate",this.rotate,"mirror",this.mirror,"flip",this.flip,"visible",this.visible,"cache",this.cache,"ignoreOpacity",this.ignoreOpacity,"scaleX",this.scaleX,"scaleY",this.scaleY,"skewX",this.skewX,"skewY",this.skewY,"rotation",this.rotation),this.owner.addComponent(new o(this.owner,d,this.addToContainer.bind(this))),d.recycle()),!0}),events:{"handle-render":function(t){this.spine&&(this.owner.triggerEvent("update-animation",!0),this.spine.update(t.delta/1e3))},"set-mix-times":function(t){this.setMixTimes(t)},hide:function(){this.visible=!1},show:function(){this.visible=!0},"stop-animation":function(t){this.stopAnimation(t)},"play-animation":function(t){this.playAnimation(t)}},methods:{addToContainer:function(){var t=this.owner.container;t.addChild(this.spine),t.reorder=!0},playAnimation:function(t){var e=this.spine;return!(!t||!e.state.hasAnimation(t))&&(this.currentAnimation=t,e.state.setAnimation(0,t,!0),this.paused=!1,!0)},stopAnimation:function(t){var e=this.spine;t&&e.state.hasAnimation(t)&&(this.currentAnimation=t,e.state.setAnimation(0,t,!1)),this.paused=!0},setMixTimes:function(t){var e=this.spine,i=e.spineData.animations,s=0,n=0,a=0,r="",o=e.stateData;if("number"==typeof t)for(n=i.length;n--;)for(a=i.length;a--;)n!==a&&o.setMix(i[n].name,i[a].name,t);else for(r in t)t.hasOwnProperty(r)&&(s=r.indexOf(":"))>=0&&o.setMix(r.substring(0,s),r.substring(s+1),t[r]);this.mixTimes=o.animationToMixTime},destroy:function(){this.owner.container.removeChild(this.spine),this.spine.destroy(),this.spine=null,this.mixTimes=null}},getAssetList:(t=function(t,e){var i=Array.setUp(),s=null,n=0;if(t){if(1===(s=t.split("\n")).length){if(!(t=e[t+"-"+(1===platypus.modifyAllAssets?1:2)]))return i;s=t.split("\n")}for(n=s.length;n--;)".png"===s[n].substr(s[n].length-4)&&i.push(s[n])}return i},function(e,i,s){var n=null,a=0,r=null,o=platypus.game.settings.atlases,h=e.atlas||i.atlas||s.atlas;if(Array.isArray(h)){for(a=h.length,r=Array.setUp();a--;)n=t(h[a],o),r.union(n),n.recycle();return r}return t(h,o)})})}(),function(){"use strict";var t,e=include("platypus.Data"),i=include("platypus.components.EventRender"),s=include("platypus.components.RenderContainer"),n=include("platypus.PIXIAnimation"),a=include("platypus.components.StateRender");platypus.createComponentClass({id:"RenderSprite",properties:{localScaleX:1,localScaleY:1,spriteSheet:null,animationMap:null,mask:null,interactive:!1,offsetX:0,offsetY:0,offsetZ:0,restart:!0,rotate:!1,mirror:!1,flip:!1,visible:!0,eventBased:!1,stateBased:!0,cache:!1,forcePlayThrough:!1,ignoreOpacity:!1,scale:1,scaleX:1,scaleY:1,skew:0,skewX:0,skewY:0,rotation:0},initialize:function(){var t,r="",o=null,h=n.formatSpriteSheet(this.spriteSheet);h===n.EmptySpriteSheet&&platypus.debug.warn('Entity "'+this.owner.type+'": RenderSprite sprite sheet not defined.'),t=function(t,e){var i=null,s="",n=null,a=0;if(t)return t;if(Array.isArray(e.frames)&&1===e.frames.length)return null;for(s in i={},n=Array.setUp(),e.animations)e.animations.hasOwnProperty(s)&&(n.push(s),i[s]=s);if("default"===n[0])for(a=n.length,i={};a--;)i[n[a]]=n[a];return n.recycle(),i}(this.animationMap,h),this.stateBased=t&&this.stateBased,this.eventBased=t&&this.eventBased,t&&(r=t.default||"",this.eventBased&&(o=e.setUp("animationMap",t,"restart",this.restart,"component",this),this.owner.addComponent(new i(this.owner,o)),o.recycle()),this.stateBased&&(o=e.setUp("animationMap",t,"forcePlayThrough",this.forcePlayThrough,"component",this),this.owner.addComponent(new a(this.owner,o)),o.recycle())),this.sprite=new n(h,r),this.sprite.on("complete",function(t){this.owner.triggerEvent("animation-ended",t)}.bind(this)),this.sprite.x=this.offsetX,this.sprite.y=this.offsetY,this.sprite.z=this.offsetZ,this.sprite.scale.x=this.localScaleX*platypus.modifyAllAssets,this.sprite.scale.y=this.localScaleY*platypus.modifyAllAssets,this.owner.container?this.addToContainer():(o=e.setUp("interactive",this.interactive,"mask",this.mask,"rotate",this.rotate,"mirror",this.mirror,"flip",this.flip,"visible",this.visible,"cache",this.cache,"ignoreOpacity",this.ignoreOpacity,"scaleX",this.scaleX,"scaleY",this.scaleY,"skewX",this.skewX,"skewY",this.skewY,"rotation",this.rotation),this.owner.addComponent(new s(this.owner,o,this.addToContainer.bind(this))),o.recycle()),h.recycleSpriteSheet()},events:{"handle-render":function(t){this.sprite&&(this.owner.triggerEvent("update-animation",!0),this.sprite.update(t.delta))},"stop-animation":function(t){this.stopAnimation(t)},"play-animation":function(t,e){this.playAnimation(t,e)}},methods:{addToContainer:function(){var t=this.owner.container;t.addChild(this.sprite),t.reorder=!0},playAnimation:function(t,e){var i=this.sprite;t&&i.has(t)?i.gotoAndPlay(t,e):i.play()},stopAnimation:function(t){var e=this.sprite;t&&e.has(t)?e.gotoAndStop(t):e.stop()},destroy:function(){this.owner.container.removeChild(this.sprite),this.sprite.destroy(),this.sprite=null}},getAssetList:(t=function(e,i){if(e){if("string"==typeof e)return t(i[e],i);if(e.images)return e.images.greenSlice()}return Array.setUp()},function(e,i,s){var n=null,a=0,r=null,o=platypus.game.settings.spriteSheets,h=e.spriteSheet||i.spriteSheet||s.spriteSheet;if(Array.isArray(h)){for(a=h.length,r=Array.setUp();a--;)n=t(h[a],o),r.union(n),n.recycle();return r}return t(h,o)})})}(),function(){"use strict";var t,e=include("platypus.AABB"),i=include("platypus.PIXIAnimation"),s=include("springroll.Application"),n=include("PIXI.CanvasRenderer"),a=include("PIXI.Container"),r=include("PIXI.Graphics"),o=a,h=include("PIXI.Rectangle"),l=include("platypus.components.RenderContainer"),p=include("PIXI.RenderTexture"),c=include("PIXI.Sprite"),u=function(t,e,i){var s=e.baseTexture._glRenderTargets[t.CONTEXT_UID];s&&s.clear(i)},d=function(){return null},g=e.setUp(),m=function(t,e){return t.z-e.z},y=function(t){for(var e=1;e<t;)e*=2;return e},f=function(t,e){this.id=e,this.instances=Array.setUp(t),this.index=0,t.template=this},w={getNext:d,destroy:d},v=f.prototype;v.getNext=function(){var t=this.instances[this.index],e=null;return t||(e=this.instances[0],(t=this.instances[this.index]=new c(e.texture)).scale=e.scale,t.rotation=e.rotation,t.anchor=e.anchor),this.index+=1,t},v.clear=function(){this.index=0},v.destroy=function(){var t=0;for(t=0;t<this.instances.length;t++)this.instances[t].destroy();this.instances.recycle(),this.recycle()},recycle.add(f,!!springroll.Debug,"Template"),platypus.createComponentClass({id:"RenderTiles",properties:{buffer:0,cacheAll:!1,entityCache:!1,imageMap:[],maximumBuffer:2048,scaleX:1,scaleY:1,spriteSheet:null,tileCache:!0,tileHeight:10,tileWidth:10,top:0,left:0},initialize:function(t){var r=platypus.modifyAllAssets,h=this.imageMap;this.doMap=null,this.cachedDisplayObjects=null,this.populate=this.populateTiles,this.tiles={},this.renderer=s.instance.display.renderer,this.tilesSprite=null,this.cacheTexture=null,this.mapContainer=null,this.laxCam=e.setUp(),this.tileWidth/=r,this.tileHeight/=r,this.scaleX*=r,this.scaleY*=r,this.worldWidth=this.tileWidth,this.worldHeight=this.tileHeight,this.cache=e.setUp(),this.cachePixels=e.setUp(),this.spriteSheet=i.formatSpriteSheet(this.spriteSheet),this.tileContainer=this.spriteSheet.images.length>1||this.renderer instanceof n?new a:new o(15e3,{position:!0,rotation:!0,scale:!0}),this.mapContainer=new a,this.mapContainer.addChild(this.tileContainer),this.reorderedStage=!1,this.updateCache=!1,this.imageMap=Array.setUp(this.createMap(h)),this.tilesWidth=this.imageMap[0].length,this.tilesHeight=this.imageMap[0][0].length,this.layerWidth=this.tilesWidth*this.tileWidth,this.layerHeight=this.tilesHeight*this.tileHeight,this.cacheWidth=Math.min(y(this.layerWidth+2),this.maximumBuffer),this.cacheHeight=Math.min(y(this.layerHeight+2),this.maximumBuffer),this.tileCache||(this.buffer=0,this.cacheAll=!1),this.ready=!1,this.owner.container?this.addToContainer():this.owner.addComponent(new l(this.owner,t,this.addToContainer.bind(this)))},events:{"cache-sprite":function(t){this.cacheSprite(t)},"peer-entity-added":function(t){this.cacheSprite(t)},"add-tiles":function(t){var e=t.imageMap;e&&(this.imageMap.push(this.createMap(e)),this.updateCache=!0)},"change-tile":function(t,e,i,s){var n=this.imageMap;n&&(this.updateTile(t,n[s||0],e,i),this.updateCache=!0)},"camera-loaded":function(t){this.worldWidth=t.world.width,this.worldHeight=t.world.height,this.buffer&&!this.cacheAll&&this.updateBufferRegion(t.viewport)},"camera-update":function(t){this.ready&&this.updateCamera(t)},"handle-render":function(){this.updateCache&&(this.updateCache=!1,this.cacheGrid?this.updateGrid():this.update(this.cacheTexture,this.cache))}},methods:{addToContainer:function(){var t=this.container=this.owner.container,e=this.mapContainer,i=null,s=this.owner.z;t.reorder=!0,this.ready=!0,this.updateRegion(0),this.tileCache?(this.mapContainerWrapper=new a,this.mapContainerWrapper.addChild(e),this.layerWidth<=this.cacheWidth&&this.layerHeight<=this.cacheHeight?(this.cacheAll=!0,this.render=this.renderCache,this.cacheTexture=p.create(this.cacheWidth,this.cacheHeight),this.tilesSprite=i=new c(this.cacheTexture),i.scale.x=this.scaleX,i.scale.y=this.scaleY,i.z=s,this.cache.setBounds(0,0,this.tilesWidth-1,this.tilesHeight-1),this.update(this.cacheTexture,this.cache),t.addChild(i)):(this.render=this.renderCache,this.cacheAll=!1,this.cacheTexture=p.create(this.cacheWidth,this.cacheHeight),this.tilesSprite=new c(this.cacheTexture),this.tilesSprite.scale.x=this.scaleX,this.tilesSprite.scale.y=this.scaleY,this.tilesSprite.z=s,this.cacheTexture.alternate=p.create(this.cacheWidth,this.cacheHeight),this.tilesSpriteCache=new c(this.cacheTexture.alternate),this.cacheTexture.alternate.alternate=this.cacheTexture,t.addChild(this.tilesSprite))):(this.render=d,e.scale.x=this.scaleX,e.scale.y=this.scaleY,e.x=this.left,e.y=this.top,e.z=s,t.addChild(e))},cacheSprite:function(t){var e=0,i=0,s=t.cacheRender,n=null,a=0,r=0,o=0,h=0;if(this.entityCache&&s){for(this.doMap||(this.doMap=Array.setUp(),this.cachedDisplayObjects=Array.setUp(),this.populate=this.populateTilesAndEntities),this.cachedDisplayObjects.push(s),(n=s.getBounds(s.transformMatrix)).x-=this.left,n.y-=this.top,a=Math.max(0,Math.floor(n.y/this.tileHeight)),r=Math.min(this.tilesHeight,Math.ceil((n.y+n.height)/this.tileHeight)),h=Math.max(0,Math.floor(n.x/this.tileWidth)),o=Math.min(this.tilesWidth,Math.ceil((n.x+n.width)/this.tileWidth)),e=h;e<o;e++)for(this.doMap[e]||(this.doMap[e]=Array.setUp()),i=a;i<r;i++)this.doMap[e][i]||(this.doMap[e][i]=Array.setUp()),this.doMap[e][i].push(s);t.removeComponent("RenderSprite"),this.updateCache=!0}},convertCamera:function(t){var e=this.layerWidth*this.scaleX,i=this.layerHeight*this.scaleY,s=this.worldWidth,n=s-t.width,a=this.worldHeight,r=a-t.height,o=this.laxCam;return s!==e&&n?o.moveX((t.left-this.left)*(e-t.width)/n+t.halfWidth+this.left):o.moveX(t.x),a!==i&&r?o.moveY((t.top-this.top)*(i-t.height)/r+t.halfHeight+this.top):o.moveY(t.y),t.width===o.width&&t.height===o.height||o.resize(t.width,t.height),o},createTile:function(t){var e,s=null;return"tile-1"===t?w:(e="tile"+function(t,e){var i=+t.substring(4),s=0;return 2147483648&i&&(e.scale.x=-1),1073741824&i&&(e.scale.y=-1),536870912&i&&(s=e.scale.x,e.scale.x=e.scale.y,e.scale.y=-s,e.rotation=Math.PI/2),268435455&i}(t,s=new i(this.spriteSheet)),s.gotoAndStop(e),f.setUp(s,t))},createMap:function(t){var e=0,i=0,s="",n=null;if("string"!=typeof t[0][0])return t;for(n=Array.setUp(),e=0;e<t.length;e++)for(n[e]=Array.setUp(),i=0;i<t[e].length;i++)s=t[e][i],this.updateTile(s,n,e,i);return n},updateCamera:function(t){var e=0,i=0,s=!1,n=null,a=0,r=0,o=0,h=0,l=this.cache,p=this.cachePixels,c=t.viewport,u=this.buffer&&(c.width!==this.laxCam.width||c.height!==this.laxCam.height),d=g,m=this.convertCamera(c);if(!this.cacheAll&&(p.empty||!p.contains(m))&&this.imageMap.length>0&&(u&&this.updateBufferRegion(m),o=(a=this.cacheTilesWidth-1)/2,h=(r=this.cacheTilesHeight-1)/2,d.setAll(Math.round((m.x-this.left)/(this.tileWidth*this.scaleX)-o)+o,Math.round((m.y-this.top)/(this.tileHeight*this.scaleY)-h)+h,a,r),d.left<0?d.moveX(d.halfWidth):d.right>this.tilesWidth-1&&d.moveX(this.tilesWidth-1-d.halfWidth),d.top<0?d.moveY(d.halfHeight):d.bottom>this.tilesHeight-1&&d.moveY(this.tilesHeight-1-d.halfHeight),this.tileCache?!l.empty&&d.contains(l)||(this.tilesSpriteCache.texture=this.cacheTexture,this.cacheTexture=this.cacheTexture.alternate,this.tilesSprite.texture=this.cacheTexture,this.update(this.cacheTexture,d,this.tilesSpriteCache,l)):this.update(null,d),p.setAll((l.x+.5)*this.tileWidth+this.left,(l.y+.5)*this.tileHeight+this.top,(l.width+1)*this.tileWidth,(l.height+1)*this.tileHeight)),this.cacheGrid)for(e=0;e<this.cacheGrid.length;e++)for(i=0;i<this.cacheGrid[e].length;i++)n=this.cacheGrid[e][i],p.setAll((e+.5)*this.cacheClipWidth+this.left,(i+.5)*this.cacheClipHeight+this.top,this.cacheClipWidth,this.cacheClipHeight),s=p.intersects(m),n.visible&&!s?n.visible=!1:!n.visible&&s&&(n.visible=!0),n.visible&&s&&(n.x=c.left-m.left+e*this.cacheClipWidth+this.left,n.y=c.top-m.top+i*this.cacheClipHeight+this.top);else this.tileCache&&(this.tilesSprite.x=c.left-m.left+l.left*this.tileWidth*this.scaleX+this.left,this.tilesSprite.y=c.top-m.top+l.top*this.tileHeight*this.scaleY+this.top)},updateTile:function(t,e,i,s){var n=null,a=this.tiles;t.id&&(t=t.id),(n=a[t])||null===n||(n=a[t]=this.createTile(t)),e[i][s]=n},createGrid:function(t){var e=this.cacheHeight,i=this.cacheWidth,s=this.cacheTilesHeight,n=this.cacheTilesWidth,a=0,r=0,o=null,l=this.scaleX,u=this.scaleY,d=this.tileHeight,g=this.tileWidth,m=this.tilesHeight,f=this.tilesWidth,w=0,v=0,b=this.owner.z,x=null,S=null,C=Array.setUp();for(w=0;w<f;w+=n)for(x=Array.setUp(),C.push(x),v=0;v<m;v+=s)r=Math.min(y((f-w)*g+2),i),a=Math.min(y((m-v)*d+2),e),(o=p.create(r,a)).frame=new h(1,1,((r-2)/g>>0)*g+1,((a-2)/d>>0)*d+1),(S=new c(o)).z=b,S.scale.x=l,S.scale.y=u,x.push(S),t.addChild(S),b-=1e-6;return C},updateRegion:function(t){var e=this.tileWidth,i=this.tileHeight,s=Math.min(this.tilesWidth,(this.cacheWidth-2)/e>>0),n=Math.min(this.tilesHeight,(this.cacheHeight-2)/i>>0);s||platypus.debug.warn('"'+this.owner.type+'" RenderTiles: The tiles are '+e+"px wide which is larger than "+(this.cacheWidth-2)+"px (maximum cache size of "+this.cacheWidth+"px minus a 2px edge bleed). Increase the maximum cache size or reduce tile size."),n||platypus.debug.warn('"'+this.owner.type+'" RenderTiles: The tiles are '+i+"px high which is larger than "+(this.cacheHeight-2)+"px (maximum cache size of "+this.cacheHeight+"px minus a 2px edge bleed). Increase the maximum cache size or reduce tile size."),this.cacheTilesWidth=s,this.cacheTilesHeight=n,this.cacheClipWidth=s*e,this.cacheClipHeight=n*i,this.tileCache&&(this.mapContainer.mask=(new r).beginFill(0).drawRect(0,0,this.cacheClipWidth+t,this.cacheClipHeight+t).endFill())},updateBufferRegion:function(t){var e=this.tileWidth,i=this.tileHeight;this.cacheTilesWidth=Math.min(this.tilesWidth,Math.ceil((t.width+2*this.buffer)/e),this.cacheWidth/e>>0),this.cacheTilesHeight=Math.min(this.tilesHeight,Math.ceil((t.height+2*this.buffer)/i),this.cacheHeight/i>>0),this.cacheClipWidth=this.cacheTilesWidth*e,this.cacheClipHeight=this.cacheTilesHeight*i,this.mapContainer.mask=(new r).beginFill(0).drawRect(0,0,this.cacheClipWidth,this.cacheClipHeight).endFill()},update:function(t,e,i,s){this.populate(e,s),this.render(e,t,this.mapContainer,this.mapContainerWrapper,i,s),s&&s.set(e)},populateTiles:function(t,e){var i=0,s=0,n=0,a=0,r=null,o=Array.setUp();for(this.tileContainer.removeChildren(),i=t.left;i<=t.right;i++)for(s=t.top;s<=t.bottom;s++)if(!e||e.empty||s>e.bottom||s<e.top||i>e.right||i<e.left)for(a=0;a<this.imageMap.length;a++)(r=this.imageMap[a][i][s].getNext())&&(r.template&&o.push(r.template),r.x=(i+.5)*this.tileWidth,r.y=(s+.5)*this.tileHeight,this.tileContainer.addChild(r));for(n=0;n<o.length;n++)o[n].clear();o.recycle()},populateTilesAndEntities:function(t,e){var i=0,s=0,n=0,a=0,r=null,o=null,h=Array.setUp(),l=Array.setUp(),p=null;for(this.tileContainer.removeChildren(),i=t.left;i<=t.right;i++)for(s=t.top;s<=t.bottom;s++)if(!e||e.empty||s>e.bottom||s<e.top||i>e.right||i<e.left){for(a=0;a<this.imageMap.length;a++)(r=this.imageMap[a][i][s].getNext())&&(r.template&&l.push(r.template),r.x=(i+.5)*this.tileWidth,r.y=(s+.5)*this.tileHeight,this.tileContainer.addChild(r));if(this.doMap[i]&&this.doMap[i][s])for(p=this.doMap[i][s],n=0;n<p.length;n++)p[n].drawn||(p[n].drawn=!0,h.push(p[n]))}if(this.mapContainer.removeChildren(),this.mapContainer.addChild(this.tileContainer),h.length)for(h.sort(m),n=0;n<h.length;n++)delete(o=h[n]).drawn,this.mapContainer.addChild(o),o.mask&&this.mapContainer.addChild(o.mask);for(n=0;n<l.length;n++)l[n].clear();l.recycle(),h.recycle()},renderCache:function(t,e,i,s,n,a){var r=this.renderer;n&&!a.empty&&(n.x=a.left*this.tileWidth,n.y=a.top*this.tileHeight,i.addChild(n)),u(r,e),i.x=-t.left*this.tileWidth,i.y=-t.top*this.tileHeight,r.render(s,e),e.requiresUpdate=!0},renderCacheWithExtrusion:function(t,e,i,s){var n=new r,a=this.renderer;n.lineStyle(1,0),n.drawRect(.5,.5,this.cacheClipWidth+1,this.cacheClipHeight+1),u(a,e),s.mask=n,i.x=-t.left*this.tileWidth,i.y=-t.top*this.tileHeight+1,a.render(s,e),i.x=-t.left*this.tileWidth+1,i.y=-t.top*this.tileHeight,a.render(s,e),i.x=-t.left*this.tileWidth+2,i.y=-t.top*this.tileHeight+1,a.render(s,e),i.x=-t.left*this.tileWidth+1,i.y=-t.top*this.tileHeight+2,a.render(s,e),s.mask=null,i.x=-t.left*this.tileWidth+1,i.y=-t.top*this.tileHeight+1,a.render(s,e),e.requiresUpdate=!0},updateGrid:function(){var t=this.cache,e=this.cacheTilesHeight,i=this.cacheTilesWidth,s=this.tilesHeight-1,n=this.tilesWidth-1,a=0,r=0,o=this.cacheGrid;for(a=0;a<o.length;a++)for(r=0;r<o[a].length;r++)t.setBounds(a*i,r*e,Math.min((a+1)*i,n),Math.min((r+1)*e,s)),this.update(o[a][r].texture,t)},toJSON:function(){for(var t=this.imageMap[0],e=[],i=t.length,s=0;i--;)for(s=t[i].length,e[i]=[];s--;)e[i][s]=t[i][s].id;return{type:"RenderTiles",buffer:this.buffer,cacheAll:this.cacheAll,entityCache:this.entityCache,imageMap:e,maximumBuffer:this.maximumBuffer,scaleX:this.scaleX,scaleY:this.scaleY,spriteSheet:this.spriteSheet,tileCache:this.tileCache,tileHeight:this.tileHeight,tileWidth:this.tileWidth,top:this.top,left:this.left}},destroy:function(){var t=0,e=0,i="",s=this.cacheGrid,n=this.doMap,a=this.imageMap;if(s){for(t=0;t<s.length;t++)for(e=0;e<s[t].length;e++)s[t][e].texture.destroy(!0),this.container.removeChild(s[t][e]);s.recycle(2),delete this.cacheGrid}else this.tilesSprite?(this.tilesSprite.texture.alternate&&this.tilesSprite.texture.alternate.destroy(!0),this.tilesSprite.texture.destroy(!0),this.container.removeChild(this.tilesSprite)):this.container.removeChild(this.mapContainer);for(i in a.recycle(2),this.tiles)this.tiles.hasOwnProperty(i)&&this.tiles[i].destroy();if(this.tiles=null,this.container=null,this.tilesSprite=null,this.spriteSheet.recycleSpriteSheet(),n){for(t=0;t<this.cachedDisplayObjects.length;t++)this.cachedDisplayObjects[t].destroy();for(this.cachedDisplayObjects.recycle(),t=0;t<n.length;t++)if(n[t]){for(e=0;e<n.length;e++)n[t][e]&&n[t][e].recycle();n[t].recycle()}n.recycle()}this.laxCam.recycle(),this.cache.recycle(),this.cachePixels.recycle()}},getAssetList:(t=function(e,i){if(e){if("string"==typeof e)return t(i[e],i);if(e.images)return e.images.greenSlice()}return Array.setUp()},function(e,i,s){var n=null,a=0,r=null,o=platypus.game.settings.spriteSheets,h=e.spriteSheet||i.spriteSheet||s.spriteSheet;if(h){if("string"==typeof h&&"import"!==h)return t(h,o);if(Array.isArray(h)){for(a=h.length,r=Array.setUp();a--;)n=t(h[a],o),r.union(n),n.recycle();return r}if(h.images)return h.images.greenSlice()}return Array.setUp()})})}(),function(){"use strict";var t=include("platypus.AABB");platypus.createComponentClass({id:"ResizeSnapper",properties:{cameraSizes:null},publicProperties:{bottom:null,left:null,right:null,top:null,x:0,y:0},initialize:function(){this.aabb=t.setUp(),this.lastBottom=null,this.lastLeft=null,this.lastRight=null,this.lastTop=null,this.cameraSizesIndex=-1},events:{"handle-logic":function(){var t=this.bottom,e=this.left,i=this.right,s=this.top;this.lastBottom===t&&this.lastLeft===e&&this.lastRight===i&&this.lastTop===s||(this.updatePosition(this.aabb),this.lastBottom=t,this.lastLeft=e,this.lastRight=i,this.lastTop=s)},"camera-update":function(t){this.aabb.set(t.viewport),this.cameraSizes&&this.checkCamera(this.aabb),this.updatePosition(this.aabb)}},methods:{checkCamera:function(t){var e=this.cameraSizes,i=0,s=t.width/t.height;for(i=0;i<e.length;i++)if(s>e[i].minRatio){i!==this.cameraSizesIndex&&(this.updateProperties(e[i]),this.cameraSizesIndex=i);break}},updateProperties:function(t){this.right="number"==typeof t.right?t.right:null,this.left="number"==typeof t.left?t.left:null,this.top="number"==typeof t.top?t.top:null,this.bottom="number"==typeof t.bottom?t.bottom:null,"number"==typeof t.x&&(this.x=t.x),"number"==typeof t.y&&(this.y=t.y)},updatePosition:function(t){var e=this.bottom,i=this.left,s=this.owner,n=this.right,a=this.top;"number"==typeof i?s.x=t.left+i:"number"==typeof n&&(s.x=t.right-n),"number"==typeof a?s.y=t.top+a:"number"==typeof e&&(s.y=t.bottom-e)},destroy:function(){this.aabb.recycle(),this.aabb=null}}})}(),function(){"use strict";var t=window.navigator.userAgent.toLowerCase(),e=t.indexOf("os 9_")>=0||t.indexOf("os 10_")>=0,i=include("PIXI.spine.core.TextureAtlas",!1),s=include("PIXI.spine.core.AtlasAttachmentLoader",!1),n=include("PIXI.BaseTexture"),a=include("PIXI.spine.core.SkeletonJson",!1),r=include("PIXI.spine.Spine",!1),o=function(){var t=platypus.game.app,e=t.config.platypus;t.transition=new r(new a(new s(new i(e.atlases["ScreenBadge_Standard-"+platypus.modifyAllAssets],function(t,e){var i,s;e((i=t,(s=platypus.game.app.assetManager.cache.read(i.substring(i.lastIndexOf("/")+1,i.lastIndexOf("."))))||platypus.debug.warn('SavedGameChecker: "'+i+'" is not a loaded asset.'),new n(s)))}))).readSkeletonData(e.skeletons.ScreenBadge_Standard)),t.transition.children[0].mask=t.transition.children[2].children[0],platypus.savedWidth&&platypus.savedHeight&&(t.transition.x=platypus.savedWidth/2,t.transition.y=platypus.savedHeight/2,t.transition.scale.x=t.transition.scale.y=platypus.savedHeight/880),t.transition.visible=!1};platypus.createComponentClass({id:"SavedGameChecker",events:{"scene-live":function(){platypus.savedGame&&sessionStorage.removeItem("load-saved-game"),this.owner.triggerEvent("relocate",{x:0,y:0})},tick:function(){platypus.game.app.transition||e||(this.tickCount=(this.tickCount||0)+1,30===this.tickCount&&o())}}})}(),function(){"use strict";var t={"space-scouts-lab":670,"base-builder":134,"cooking-school":0,"food-farmer":536,"mission-control":268,"rover-maker":402},e=include("platypus.Async"),i=include("platypus.Data"),s=0,n=function(t,e,i,s,n){t.readGameData(e,i,function(t,e,i,s){var n=0,a=platypus.game.app.config.journal.maxSavesPerGame;for(n=0;n<a;n++)s&&s[n]?e.push(this.addSave(t,s,s[n],0,0,n)):("food-farmer"!==t||n<3)&&e.push(this.addEmpty(0,0,t));this.tableColumns=this.tableColumns||3,this.updateLocations(),i()}.bind(this,e,s,n))},a=function(t,e){var i=platypus.game.app;this.currentlyShowing&&(i.googleAnalytics.event(i.name,"ExitSaveMenuTab-"+this.currentlyShowing,"SaveMenuTime",Date.now()-this.startTime),this.startTime=Date.now()),this.owner.triggerEvent("highlight-"+e),this.owner.triggerEvent("dehighlight-non-"+e),this.owner.triggerEvent("relocate",{x:t,y:0}),this.currentlyShowing=e,i.googleAnalytics.event(i.name,"EnterSaveMenuTab-"+this.currentlyShowing,"NumberOfSaves",this.savesByGame[e]||0)};platypus.createComponentClass({id:"SavedGameLister",properties:{spacing:3e3,gameIds:["space-scouts-lab","base-builder","cooking-school","food-farmer","mission-control","rover-maker"]},publicProperties:{},initialize:function(t,i){var s=platypus.game.app,r=s.userData,o=this.spacing,h=s.config.journal.storageKey,l=Array.setUp(),p="",c=this.gameIds,u=c.length;for(this.savesByGame=[],this.currentlyShowing=null,this.startTime=Date.now(),this.savesTotal=0,this.buttons=[],this.anySaves=!1;u--;)p=c[u],this.buttons[u]=[],l.push(n.bind(this,r,p,h,this.buttons[u])),this.addEventListener(p,a.bind(this,u*o,p));return e.setUp(l,function(){this.anySaves?this.owner.triggerEvent("journal-intro"):this.owner.triggerEvent("journal-none"),i()}.bind(this)),s.music="jam",s.musicInstance.volume=.5,platypus.badger.increment("tried-journal"),!0},events:{"camera-update":function(t){var e=t.viewport,i=e.width/e.height>1.766?3:2;this.tableColumns!==i&&(this.tableColumns=i,this.updateLocations())},"scene-live":function(t){t&&t.banner?this.owner.triggerEvent(t.banner):this.owner.triggerEvent("space-scouts-lab")},"exit-save-menu":function(){var t=platypus.game.app;t.googleAnalytics.event(t.name,"ExitSaveMenuTab-"+this.currentlyShowing,"SaveMenuTime",Date.now()-this.startTime)},"delete-me":function(t){platypus.game.app.userData;var e=t.entity,i=e.deletes,s=platypus.game.app.config.journal.storageKey;i.gameData[i.saveIndex]=null,this.addEmpty(i.x,i.y,i.game),this.owner.parent.app.userData.writeGameData(i.game,s,i.gameData),e.on("prepare-logic",function(t){this.removeEntity(t.deletes),this.removeEntity(t)}.bind(this.owner,e))}},methods:{addEmpty:function(t,e,i){var s=platypus.game.app.config.journal.thumbnail;return this.owner.addEntity({type:"saved-game-empty",properties:{width:s.width,height:s.height,x:t,y:e,z:8,game:i}})},addSave:function(e,n,a,r,o,h,l,p){var c=null,u=null,d=new Image,g=platypus.game.app.config.journal,m=platypus.modifyAllAssets,y=g.thumbnail.width/2,f=g.thumbnail.height/2,w=y/2,v=f/2,b=0;return this.anySaves=!0,this.savesTotal+=1,this.savesByGame[e]||(this.savesByGame[e]=0),this.savesByGame[e]+=1,l&&(c=function(t,e){t.count-=1,t.count||(t.recycle(),e())}.bind(null,i.setUp("count",2),l)),a.thumbnail?d.src=a.thumbnail:(d="thumbnail-backup",b=t[e]),u=this.owner.addEntity({type:"saved-game-button",properties:{x:r,y:o,z:15,cameraSizes:p,spriteSheet:{id:b?e+"-thumbnail":"saved-ss-"+s,images:[d],frames:[[0,b,y*m,f*m,0,w*m,v*m]]},persistentData:{level:a.level},events:null,saveIndex:h,game:e,loadSavedGame:n[h],gameData:n}},c),s+=1,u.components[u.components.length-3].sprite.scale.x=2,u.components[u.components.length-3].sprite.scale.y=2,this.owner.addEntity({type:"delete-saved-game-button",properties:{deletes:u,x:r+w,y:o-v,z:16,game:e}},c)},updateLocations:function(){var t=this.buttons,e=null,i=t.length,s=0,n=platypus.game.app.config.journal,a=n.thumbnail.width,r=a/2,o=n.thumbnail.height,h=o/2,l=n.maxSavesPerGame,p=this.tableColumns,c=(l/p-1)/2,u=(3/p-1)/2,d=this.spacing,g=0,m=0,y=n.spacing+a,f=n.spacing+o;for(1===c&&(c=.8);i--;)for(s=t[i].length;s--;)g=(s%p-(p-1)/2)*y+d*i,m="food-farmer"!==(e=t[i][s]).game?((s/p>>0)-c)*f:((s/p>>0)-u)*f,e.deletes&&(e.x=g+r,e.y=m-h,e=e.deletes),e.x=g,e.y=m,e.totalSaves=this.savesTotal}},getAssetList:function(){return Array.setUp("assets/images/delete-button.png","assets/images/journal-frame.png","assets/images/thumbnail-backup.png")}})}(),function(){"use strict";var t=include("platypus.Data");platypus.createComponentClass({id:"SceneChanger",properties:{scene:"",persistentData:null},initialize:function(){this.persistentData=t.setUp(this.persistentData),this.loadingScene=!1},events:{"new-scene":function(t){var e=t||this,i=e.scene||this.scene,s=e.persistentData||this.persistentData;this.loadingScene||(this.loadingScene=!0,platypus.game.loadScene(i,s))},"set-scene":function(t){this.scene=t},"set-persistent-scene-data":function(t){var e=this.persistentData,i="";for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}},methods:{destroy:function(){}}})}(),function(){"use strict";platypus.createComponentClass({id:"Scroller",properties:{direction:""},publicProperties:{},initialize:function(){},events:{adopted:function(){this.owner.state.set(this.direction,!0)},"handle-logic":function(){this.owner.state.get("pressed")&&this.owner.triggerEvent("scroll-"+this.direction)},pointerdown:function(){this.owner.state.set("pressed",!0)},pointerup:function(){this.release()},pointerupoutside:function(){this.release()},pointercancel:function(){this.release()},pointerover:function(){this.owner.state.set("hover",!0)},pointerout:function(){this.owner.state.set("hover",!1)},"hide-sprite":function(){this.release()}},methods:{release:function(){this.owner.state.set("pressed",!1)}}})}(),function(){"use strict";var t={mindy:["idle-1","idle-2","hello","hi-there","hi"],sean:["idle-1","idle-2","hello","hi-there","hi"],sydney:["idle-1","idle-2","hello","hi-there","hi"],jet:["idle-1","idle-2","hello","hi-there","hi","greetings","hello-earthies"]},e={top:["hide-up","show-up"],bottom:["hide-down","show-down"],left:["hide-left","show-left"],right:["hide-right","show-right"]},i=include("platypus.AABB"),s=include("platypus.Data"),n=include("createjs.Ease"),a=include("platypus.Entity"),r=include("createjs.Tween"),o=function(){this.transition.recycle(),this.transition=null};platypus.createComponentClass({id:"ScrollHandler",properties:{},publicProperties:{scrollable:!0,top:-680,bottom:680,left:-5080,right:3800,zoomedIn:!1},initialize:function(){var t=platypus.game.app;this.arrowVisibility={top:1,bottom:0,left:1,right:1},this.showArrows=1,this.followSunspot=null,this.initialHost=["mindy","sean","jet","sydney"][4*Math.random()>>0],this.initialHostEntity=null,this.characters=Array.setUp(),this.idleTimer=3e4,!platypus.badger.badges.app[0].completed||platypus.badger.badgesAwarded.length>0&&"rank-0"===platypus.badger.badgesAwarded[0].highlight?(this.initialHost="sean",this.firstTime=!0,this.owner.triggerEvent("relocate",{x:0,y:0})):platypus.badger.badgesAwarded.length>0&&(this.initialHost="sean",this.newBadge=!0),this.alreadyGaveIntroForThisSession=!!sessionStorage.getItem("alreadyGaveIntro"),this.alreadyGaveIntroForThisSession||sessionStorage.setItem("alreadyGaveIntro","yes"),t.music="home-base",t.musicInstance.volume=.5},events:{"child-entity-added":function(e){this.firstTime||"sunspot"!==e.type?e.type===this.initialHost&&(this.initialHostEntity=e,this.firstTime&&this.initialHostEntity.triggerEvent("first-time")):this.followSunspot=e,t[e.type]&&this.characters.push(e)},load:function(){var t=s.setUp("world",i.setUp().setBounds(this.left,this.top,this.right,this.bottom));this.owner.triggerEvent("world-loaded",t),t.world.recycle(),t.recycle()},"camera-update":function(t){this.camera=t.viewport,this.clampX(this.camera.x),this.clampY(this.camera.y)},"scrolling-up":function(){this.stopTheSunspot(),this.scrollTo(this.camera.x,this.camera.y-20)},"scrolling-down":function(){this.stopTheSunspot(),this.scrollTo(this.camera.x,this.camera.y+20)},"scrolling-left":function(){this.stopTheSunspot(),this.scrollTo(this.camera.x-20,this.camera.y)},"scrolling-right":function(){this.stopTheSunspot(),this.scrollTo(this.camera.x+20,this.camera.y)},"scroll-to":function(t,e,i){this.stopTheSunspot(),this.scrollTo(t,e,i)},swipe:function(t){this.swipe||(this.swipe=function(t,e,i){var s=e-t+i.y;this.scrollable&&(s>=this.upperLimit?(s=this.upperLimit,this.scrollUp.triggerEvent("hide-sprite")):s<=this.lowerLimit?(s=this.lowerLimit,this.scrollDown.triggerEvent("hide-sprite")):(this.scrollDown.triggerEvent("show-sprite"),this.scrollUp.triggerEvent("show-sprite")),this.scrollListGroup.y=s)}.bind(this,t.y,this.scrollListGroup.y)),this.swipe(t)},"end-swipe":function(t){this.swipe&&(this.swipe(t),this.swipe=null)},tick:function(t){if(this.transition)"relocate"!==this.transition.type&&this.owner.triggerEvent("resize-camera",this.transition),this.owner.triggerEvent("relocate",this.transition);else if(this.followSunspot){if(this.initialHostEntity&&Math.abs(this.initialHostEntity.x-this.followSunspot.x)<50)return this.scrollTo(this.initialHostEntity.x,0,200),void this.stopTheSunspot(!0);this.scrollTo(this.followSunspot.x,0)}else platypus.game.app.voPlayer.playing||(this.idleTimer-=t.delta,this.idleTimer<0&&(this.idleTimer=3e4,this.playClosestCharacterIdle()))},"zoomed-in":function(t){this.zoomedIn||(this.zoomedIn=!0,this.showArrows=0,this.transition=s.setUp("type","zoom-in","x",this.camera.x,"y",this.camera.y,"width",1600,"height",1200),r.get(this.transition).to({x:t.x,y:t.y,width:800,height:600},600,n.sineInOut).call(o.bind(this)))},"zoomed-out":function(t){var e=t?t.x:this.camera.x,i=t?t.y:this.camera.y;this.zoomedIn=!1,this.showArrows=1,this.transition=s.setUp("type","zoom-out","x",this.camera.x,"y",this.camera.y,"width",800,"height",600),r.get(this.transition).to({x:e,y:i,width:1600,height:1200},600,n.sineInOut).call(o.bind(this))},pointerdown:function(){this.stopTheSunspot()}},methods:{clampX:function(t){var i=this.arrowVisibility,s=t>>0;return s<=this.left+this.camera.halfWidth>>0?(i.left=0,i.right=1):s>=this.right-this.camera.halfWidth>>0?(i.left=1,i.right=0):(i.left=1,i.right=1),this.owner.triggerEvent(e.left[this.showArrows&i.left]),this.owner.triggerEvent(e.right[this.showArrows&i.right]),t},clampY:function(t){var i=this.arrowVisibility;t<=this.top+this.camera.halfHeight?i.top=0:t>=this.bottom-this.camera.halfHeight?i.bottom=0:(i.top=1,i.bottom=1),this.owner.triggerEvent(e.top[this.showArrows&i.top]),this.owner.triggerEvent(e.bottom[this.showArrows&i.bottom])},playClosestCharacterIdle:function(e){for(var i=this.characters,s=i.length,n=null,a=1/0,r=0;s--;)a>(r=Math.abs(i[s].x-this.camera.x))&&(n=i[s],a=r);e?n.triggerEvent("intro"):(s=Math.random()*t[n.type].length>>0,n.triggerEvent(t[n.type][s]))},scrollTo:function(t,e,i){var a=this.owner;i?(this.transition=s.setUp("type","relocate","x",this.camera.x,"y",this.camera.y),r.get(this.transition).to({x:t,y:e},i,n.sineInOut).call(o.bind(this))):a.triggerEvent("relocate",{x:t,y:e})},stopTheSunspot:function(t){this.followSunspot&&(this.followSunspot=null,this.newBadge?this.initialHostEntity.triggerEvent("new-badge"):this.alreadyGaveIntroForThisSession&&!t||this.playClosestCharacterIdle(!this.alreadyGaveIntroForThisSession),this.initialHostEntity=null)}},publicMethods:{addMenuItem:function(t){return t.properties||(t.properties={}),t.properties.y=this.count*this.verticalSpacing,t.properties.renderGroup=this.scrollGroup,this.lastEntityAdded=this.owner.addEntity(t),this.count+=1,this.scrollListGroup.y=this.upperLimit,this.lowerLimit=Math.min(this.upperLimit,this.upperLimit-this.count*this.verticalSpacing+this.scrollHeight),this.upperLimit===this.lowerLimit?this.scrollable=!1:(this.scrollable=!0,this.scrollDown.triggerEvent("show-sprite")),this.lastEntityAdded},getEntitiesAtPoint:function(t,e){for(var s=i.setUp(),n=Array.setUp(),a=this.owner.entities,r=null,o=a.length;o--;)r=a[o],s.setAll(r.x||0,r.y||0,r.width||0,r.height||0),s.containsPoint(t,e-this.scrollListGroup.y)&&n.push(r);return s.recycle(),n}},getAssetList:function(t,e,i){var s=t&&t.itemEntity||e&&e.itemEntity||i&&i.itemEntity;return s?a.getAssetList({type:s}):Array.setUp()}})}(),function(){"use strict";var t=include("createjs.Ease"),e=include("createjs.Tween");platypus.createComponentClass({id:"Smoke",properties:{},initialize:function(){this.owner.x+=60*Math.random()-30,this.owner.y+=60*Math.random()-30},events:{adopted:function(){var i=this.owner;this.owner.scaleX=7,this.owner.scaleY=7,e.get(i).to({x:i.x+30*Math.random()-15,y:i.y-95+20*Math.random(),opacity:1e-4,scaleX:8,scaleY:8},1500+(1500*Math.random()>>0),t.sineOut).call(function(){var t=this.owner;t.destroyed||t.parent.removeEntity(t)}.bind(this))}}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("createjs.Tween"),i=include("createjs.Ease");platypus.createComponentClass({id:"Sunspot",properties:{direction:0,entrance:"",left:0,right:0,time:0},publicProperties:{scaleX:1,scaleY:1,x:0,y:0},initialize:function(){this.owner.state.set("balloons",!0),this.owner.state.set("inflated",!0),this.scaleOrigin=this.scaleX,this.originalY=this.y,this.balloonY=this.y,this.puffY=this.y-200,this.destinationY=this.y,this.arcX=0,this.arcRange=0,this.slowRoll=1/16,this.freq=2e3,this.freqMagnitude=25,this.owner.state.set("wave",!1),this.owner.state.set("photo",!1),this.owner.state.set("spin",!1),this.owner.state.set("land",!1),this.owner.state.set("jump",!1),this.owner.state.set("idle",!0),this.takingPhoto=!1,this.initialDistance=0,this.timer=0,this.direction||(this.direction=[-1,1][Math.round(Math.random())]),this.camera=t.setUp()},events:{pointerdown:function(){var t=this.owner.state;t.get("wave")?(e.get(this).to({destinationY:this.destinationY-600},1e3,i.sineInOut),this.owner.triggerEvent("sunspot-bye")):t.get("balloons")?(t.set("wave",!0),this.wavingByTouch=!0,this.owner.triggerEvent("sunspot-waving")):this.slowRoll<1?(e.get(this).to({slowRoll:2*this.slowRoll,scaleX:this.direction*this.scaleOrigin*1.5,scaleY:1.5*this.scaleOrigin},250,i.sineInOut).to({scaleX:this.direction*this.scaleOrigin,scaleY:this.scaleOrigin},250,i.sineInOut),this.owner.triggerEvent("sunspot-weee")):(e.get(this).to({destinationY:this.destinationY-600},1e3,i.sineInOut),this.owner.triggerEvent("sunspot-bye"))},"camera-update":function(t){this.camera.set(t.viewport)},"handle-logic":function(t){var e,i;this.timer-=t.delta,this.timer<0&&(this.direction>0?this.direction=-1:this.direction=1,this.timer=this.time,this.scaleX=this.direction*this.scaleOrigin,this.wavingByTouch=!1,this.slowRoll=1/16,this.freq=2e3,this.freqMagnitude=25,this.owner.state.set("balloons",[!0,!0,!1][3*Math.random()>>0]),this.owner.state.get("balloons")?this.destinationY=this.balloonY:this.destinationY=this.puffY),i=1-(e=this.timer/this.time),Math.abs(this.camera.x-this.x)<this.camera.width/6?this.owner.state.get("balloons")&&!this.owner.state.get("wave")&&this.owner.state.set("wave",!0):!this.wavingByTouch&&this.owner.state.get("wave")&&this.owner.state.set("wave",!1),this.direction>0?this.owner.x=this.left*e+this.right*i:this.owner.x=this.right*e+this.left*i,this.owner.y=this.destinationY+Math.sin(this.timer/this.freq*Math.PI*2)*this.freqMagnitude,this.owner.state.get("balloons")?this.owner.rotation=0:this.owner.rotation+=t.delta*this.direction*this.slowRoll}},methods:{destroy:function(){this.camera.recycle(),this.camera=null}}})}(),function(){"use strict";var t=include("platypus.AABB"),e={"base-builder":["s-Lhand crayon BB","s-Rhand paint BB"],"cooking-school":["s-Lhand crayon CS","s-Rhand paint"],"food-farmer":["s-Lhand crayon FF","s-Rhand paint FF"],"mission-control":["s-Lhand crayon MC","s-Rhand paint MC"],"rover-maker":["s-Lhand crayon RM","s-Rhand paint"],"space-scouts-lab":["s-Lhand crayon SSL","s-Rhand paint SSL"]};platypus.createComponentClass({id:"SunspotWorking",properties:{leftHair:"",rightHair:"",hairSlot:"",leftBadge:"",rightBadge:"",badgeSlot:""},initialize:function(){this.direction=0,this.spine=null,this.camera=t.setUp()},events:{load:function(){for(var t=this.owner.components,e=t.length;e--;)if(t[e].spine){this.spine=t[e].spine;break}},"camera-update":function(t){this.camera.set(t.viewport)},"animation-ended":function(t){"painting"===t?Math.random()>.8&&this.owner.triggerEvent("pai-rest"):"painting rest"===t&&this.owner.triggerEvent("pai")},hit:function(){var t=this.owner,e=this.camera,i=(t.x-e.x)/e.halfWidth,s=Math.max(-1,Math.min(1,i)),n=.3*(2-2*Math.abs(s))+.05;t.triggerEvent("hitPanned",{pan:s,volume:n})},saw:function(){var t=this.owner,e=this.camera,i=(t.x-e.x)/e.halfWidth,s=Math.max(-1,Math.min(1,i)),n=.15*(2-2*Math.abs(s))+.025;t.triggerEvent("sawPanned",{pan:s,volume:n})},"handle-logic":function(){this.updateLocation&&(this.updateLocation(),this.updateLocation=null)},sawsaw:function(t,e,i){this.updateLocation=this.reposition.bind(this,t,e,i)},ham:function(t,e,i){this.updateLocation=this.reposition.bind(this,t,e,i)},pai:function(t,i,s,n){var a=e[n];this.updateLocation=this.reposition.bind(this,t,i,s),a&&(this.spine.update(1e-6),this.spine.skeleton.setAttachment("s-Lhand crayon",a[0]),this.spine.skeleton.setAttachment("s-Rhand paint",a[1]))}},methods:{destroy:function(){this.camera.recycle(),this.camera=null},reposition:function(t,e,i){var s=this.owner;(t||e||i)&&(s.x=t,s.y=e,s.scaleX=.333*i)}}})}(),function(){"use strict";var t,e,i=/^(?:(\w+:)\/{2}(\w+(?:\.\w+)*\/?))?([\/.]*?(?:[^?]+)?\/)?(?:(([^\/?]+)\.(\w+))|([^\/?]+))(?:\?((?:(?:[^&]*?[\/=])?(?:((?:(?:[^\/?&=]+)\.(\w+)))\S*?)|\S+))?)?$/,s=include("platypus.AABB"),n=include("platypus.Data"),a=include("platypus.Entity"),r=(t=function(t,e){return t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24)>>>0},e=function(t,e){return t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24)>>>0},function(i,s){var n=4,a=[],r=atob(i.replace(/\\/g,""));if("zlib"===s)for(r=pako.inflate(r);n<=r.length;)a.push(e(r,n-4)),n+=4;else for(;n<=r.length;)a.push(t(r,n-4)),n+=4;return a}),o=function(t){var e=t.match(i);return e[5]||e[7]},h=function(t){for(var e=1;e<t;)e*=10;return e},l={x:1,y:1,id:-1},p=function(t,e){var i=0;if(t){if(Array.isArray(t)){for(i=t.length;i--;)if(t[i].name===e)return t[i].value;return null}return t[e]}return null},c=function(t,e,i){var s=0;if(t)if(Array.isArray(t)){for(s=t.length;s--;)if(t[s].name===e)return t[s].type=typeof i,void(t[s].value=i);t.push({name:e,type:typeof i,value:i})}else t[e]=i},u=function(t,e){var i,s,n,a,r=0,o=t.gid||-1,h={},p={gid:-1,transform:null,properties:h,type:""},c=null,u=null,g=0;for(-1!==o&&(p.transform=(n=!!(1073741824&(i=o)),a=!!(2147483648&i),(s=l).id=268435455&i,s.x=1,s.y=1,n&&(s.y=-1),a&&(s.x=-1),s),o=p.gid=l.id),r=0;r<e.length&&!(e[r].firstgid>o);r++)u=e[r];return u&&(g=o-u.firstgid,u.tileproperties&&u.tileproperties[g]&&(c=u.tileproperties[g]),u.tiles&&u.tiles[g]&&(p.type=u.tiles[g].type||"")),p.type=t.type||p.type,""===p.type&&(t.name?(p.type=t.name,platypus.debug.warn('Component TiledLoader (loading "'+p.type+'"): Defining the entity type using the "name" property has been deprecated. Define the type using the object\'s "type" property in Tiled instead.')):c&&(c.entity?(p.type=c.entity,platypus.debug.warn('Component TiledLoader (loading "'+p.type+'"): Defining the entity type using the "entity" property in the object properties has been deprecated. Define the type using the object\'s "type" property in Tiled instead.')):c.type&&(p.type=c.type,platypus.debug.warn('Component TiledLoader (loading "'+p.type+'"): Defining the entity type in the object properties has been deprecated. Define the type using the object\'s "type" property in Tiled instead.')))),p.type?(p.transform?(h.scaleX=p.transform.x,h.scaleY=p.transform.y):(h.scaleX=1,h.scaleY=1),d(c,p.properties),d(t.properties,p.properties),p):null},d=function(t,e){var i=0,s="";if(t&&e)if(Array.isArray(t))for(i=0;i<t.length;i++)c(e,t[i].name,g(t[i].value));else for(s in t)t.hasOwnProperty(s)&&c(e,s,g(t[s]));return e},g=function(t){var e=0;if("string"==typeof t){if(0===(e=parseFloat(t))||e)return e;if("true"===t)return!0;if("false"===t)return!1;if(t.length>1&&("{"===t[0]&&"}"===t[t.length-1]||"["===t[0]&&"]"===t[t.length-1]))try{return JSON.parse(t)}catch(t){}}return t},m=function(t,e){var i=0,s=0,r=Array.setUp(),o=null,h=Array.setUp(),l=null,c=null,d=null;if("string"==typeof t&&(t=platypus.game.settings.levels[t]),t)if(t.tilesets&&(t.tilesets=w(t.tilesets)),t.assets)h.union(t.assets);else if(t.layers){for(i=0;i<t.layers.length;i++)if("objectgroup"===t.layers[i].type)for(s=0;s<t.layers[i].objects.length;s++)(c=u(t.layers[i].objects[s],t.tilesets))&&(d=a.getAssetList(c),h.union(d),d.recycle());else"imagelayer"===t.layers[i].type?h.union([t.layers[i].image]):(c=p(t.layers[i].properties,"entity"))&&(l=n.setUp("type",c),o=a.getAssetList(l),h.union(o),o.recycle(),l.recycle());if(!e){for(i=0;i<t.tilesets.length;i++)r.push(t.tilesets[i].image);h.union(r),r.recycle()}t.assets=h.greenSlice()}return h},y={"render-layer":{id:"render-layer",components:[{type:"RenderTiles",spriteSheet:"import",imageMap:"import",entityCache:!0}]},"collision-layer":{id:"collision-layer",components:[{type:"CollisionTiles",collisionMap:"import"}]},"image-layer":{id:"image-layer",components:[{type:"RenderTiles",spriteSheet:"import",imageMap:"import"}]}},f=function(t){var e="",i=platypus.game.settings.levels[t.source.replace(".json","")];for(e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return delete t.source,t},w=function(t){var e=0;for(e=0;e<t.length;e++)t[e].source&&(t[e]=f(t[e]));return t};platypus.createComponentClass({id:"TiledLoader",properties:{offsetMap:!1,showCollisionTiles:!1,images:null,layerIncrement:1e3,separateTiles:!1,spriteSheet:null},publicProperties:{level:null,unitsPerPixel:1,imagesScale:1,entityPositionX:"center",entityPositionY:"bottom",manuallyLoad:!1},initialize:function(){this.assetCache=platypus.game.app.assetManager.cache,this.layerZ=0,this.followEntity=!1},events:{"scene-loaded":function(t,e){this.manuallyLoad||(e.count+=1,this.loadLevel({level:this.level||t.level,persistentData:t},e.release))},"load-level":function(t,e){this.loadLevel(t,e)}},methods:{createLayer:function(t,e,i,s,n,r,o,h,l,c){var u=null,g=null,m=e.width,f=e.height,w=e.tileheight||r,v=e.tilewidth||n,b=0,x=0,S=0,C=0,A=0,E=JSON.parse(JSON.stringify(platypus.game.settings.entities[t]||y[t])),k={},P=[],M=[],B=[],T={images:e.image?[e.image]:h,frames:M,animations:k},I=!1,L=null,z=null,X=0,U=0,H=0,Y="",O=null,W=function(t,e,i,s){var n=i.margin||0,a=i.spacing||0,r=i.tilewidth,o=i.tileheight,h=r/2,l=o/2,p=r+a,c=o+a,u=2*n-a,d=i.columns||i.imagewidth/p+u>>0,g=i.imageheight/c+u>>0,m=0,y=0;for(r*=s,o*=s,h*=s,l*=s,p*=s,c*=s,y=0;y<g;y++)for(m=0;m<d;m++)t.push([n+m*p,n+y*c,r,o,e,h,l])};if(this.decodeLayer(e),O=e.data,i+=e.offsetx||0,s+=e.offsety||0,E.properties=E.properties||{},e.properties){if((C=p(e.properties,"width"))&&(b=parseInt(C,10)),(S=p(e.properties,"height"))&&(x=parseInt(S,10)),b||x){for(b=b||m,x=x||f,O=[],U=0;U<b;U++)for(H=0;H<x;H++)O[U+H*b]=U<m&&H<f?e.data[U+H*m]:0;m=b,f=x}d(e.properties,E.properties)}if("collision-layer"===t)for(z=[],U=0;U<o.length;U++)if((L=o[U]).tileproperties)for(Y in L.tileproperties)L.tileproperties.hasOwnProperty(Y)&&L.tileproperties[Y].jumpThrough&&z.push(L.firstgid+parseInt(Y,10));if(E.properties.width=v*m*this.unitsPerPixel,E.properties.height=w*f*this.unitsPerPixel,E.properties.columns=m,E.properties.rows=f,E.properties.tileWidth=v*this.unitsPerPixel,E.properties.tileHeight=w*this.unitsPerPixel,E.properties.scaleX=this.imagesScale,E.properties.scaleY=this.imagesScale,E.properties.layerZ=this.layerZ,E.properties.left=E.properties.x||i,E.properties.top=E.properties.y||s,E.properties.z=E.properties.z||this.layerZ,o.length){for(U=0;U<o.length;U++)W(M,U,o[U],this.unitsPerPixel/this.imagesScale);for(A=(u=o[o.length-1]).firstgid+u.tilecount,U=-1;U<A;U++)k["tile"+U]=U}for(U=0;U<m;U++)for(P[U]=[],B[U]=[],H=0;H<f;H++)X=+O[U+H*m]-1,B[U][H]="tile"+X,X+=1,z&&z.length&&z[0]===(268435455&X)&&(X|=268435456),P[U][H]=X;for(U=0;U<E.components.length;U++)"RenderTiles"===E.components[U].type&&(I=E.components[U]),"import"===E.components[U].spriteSheet?E.components[U].spriteSheet=T:E.components[U].spriteSheet&&("string"==typeof E.components[U].spriteSheet&&platypus.game.settings.spriteSheets[E.components[U].spriteSheet]&&(E.components[U].spriteSheet=platypus.game.settings.spriteSheets[E.components[U].spriteSheet]),E.components[U].spriteSheet.animations||(E.components[U].spriteSheet.animations=k)),"import"===E.components[U].collisionMap&&(E.components[U].collisionMap=P),"import"===E.components[U].imageMap&&(E.components[U].imageMap=B);return this.layerZ+=this.layerIncrement,"render-layer"===t&&!this.separateTiles&&l&&l.tileHeight===w&&l.tileWidth===v&&l.columns===m&&l.rows===f?(l.triggerEvent("add-tiles",I),this.updateLoadingProgress(c),l):(g={},"render-layer"===t&&this.spriteSheet&&("string"==typeof this.spriteSheet?g.spriteSheet=platypus.game.settings.spriteSheets[this.spriteSheet]:g.spriteSheet=this.spriteSheet,g.spriteSheet.animations||(g.spriteSheet.animations=k)),this.owner.addEntity(new a(E,{properties:g},this.updateLoadingProgress.bind(this,c),this.owner)))},convertImageLayer:function(t){var e,i=null,s=0,n="",a=t.properties||{},r=p(a,"repeat"),h=p(a,"repeat-x"),l=p(a,"repeat-y"),c={data:[],image:"",height:1,name:t.name,type:"tilelayer",width:1,tileheight:1,tilewidth:1,x:t.x,y:t.y,properties:a};for(r&&(c.width=+r,c.height=+r),h&&(c.width=+h),l&&(c.height=+l),e=c.width*c.height,s=0;s<e;s++)c.data.push(1);return(i=this.assetCache.read(t.name))?(c.image=t.name,c.tileheight=i.height,c.tilewidth=i.width):(n=o(t.image),(i=this.assetCache.read(n))?(platypus.debug.warn('Component TiledLoader: Did not find a spritesheet for "'+t.name+'", so using "'+t.image+'" instead.'),c.image=n,c.tileheight=i.height,c.tilewidth=i.width):(platypus.debug.warn('Component TiledLoader: Cannot find the "'+t.name+'" sprite sheet. Add it to the list of assets in config.json and give it the id "'+t.name+'".'),c.image=t.image)),c.tileset={columns:1,image:c.image,imageheight:c.tileheight,imagewidth:c.tilewidth,margin:0,name:t.name,spacing:0,tilecount:1,tileheight:c.tileheight,tilewidth:c.tilewidth,type:"tileset"},c},loadLevel:function(t,e){var i,a,r,l,c,u,g=!0,m=null,y=0,f="",v=null,b=null,x=null,S=null,C=n.setUp("count",0,"progress",0,"total",0),A=0,E=0;if(i=(m="string"==typeof t.level?platypus.game.settings.levels[t.level]:t.level).layers,r=w(m.tilesets),l=m.tilewidth,c=m.tileheight,m.properties&&d(m.properties,this.owner),0===(v=this.images?this.images.greenSlice():Array.setUp()).length)for(y=0;y<r.length;y++)S=r[y],this.assetCache.read(S.name)?v.push(S.name):(f=o(S.image),this.assetCache.read(f)?(platypus.debug.warn('Component TiledLoader: Did not find a spritesheet for "'+S.name+'", so using "'+S.image+'" instead.'),v.push(f)):(platypus.debug.warn('Component TiledLoader: Cannot find the "'+S.name+'" sprite sheet. Add it to the list of assets in config.json and give it the id "'+S.name+'".'),v.push(S.image)));for(u=m.width*l*this.unitsPerPixel,a=m.height*c*this.unitsPerPixel,this.offsetMap&&(A=h(u),E=h(a)),C.total=y=i.length;y--;)"objectgroup"===i[y].type?C.total+=i[y].objects.length:!g||"collision"!==i[y].name&&"collision-layer"!==p(i[y].properties,"entity")||(g=!1);for(this.finishedLoading=function(t,e,i,a,r,o,h,l){var p=n.setUp("level",null,"world",s.setUp(),"tile",s.setUp(),"camera",null);p.level=t,p.camera=this.followEntity,p.width=a,p.height=r,p.world.setBounds(e,i,e+a,i+r),p.tile.setBounds(0,0,o,h),this.owner.triggerEvent("world-loaded",p),p.world.recycle(),p.tile.recycle(),p.recycle(),this.owner.removeComponent(this),l&&l()}.bind(this,m,A,E,u,a,l,c,e),y=0;y<i.length;y++)switch((x=i[y]).type){case"imagelayer":b=this.convertImageLayer(x),b=this.createLayer("image-layer",b,A,E,b.tilewidth,b.tileheight,[b.tileset],v,b,C);break;case"objectgroup":this.setUpEntities(x,A,E,l,c,r,C),b=null,this.updateLoadingProgress(C);break;case"tilelayer":b=this.setupLayer(x,g,b,A,E,l,c,r,v,C);break;default:platypus.debug.warn('Component TiledLoader: Platypus does not support Tiled layers of type "'+x.type+'". This layer will not be loaded.'),this.updateLoadingProgress(C)}},setUpEntities:function(t,e,i,s,n,r,o){var h=0,l=0,c=0,d=0,g=0,m=0,y=0,f=null,w=0,v=null,b=null,x=null,S=p(t.properties,"entityPositionX")||this.entityPositionX,C=p(t.properties,"entityPositionY")||this.entityPositionY,A="",E=-1,k=1/0,P=-1/0,M=1/0,B=-1/0,T=null,I=null,L=null,z=0,X=0;for(e+=t.offsetx||0,i+=t.offsety||0,w=0;w<t.objects.length;w++)if(v=t.objects[w],T=u(v,r)){if(E=T.gid,A=T.type,x=(b=platypus.game.settings.entities[A])&&b.properties||null,I=T.properties,v.polygon||v.polyline){for(k=1/0,P=-1/0,M=1/0,B=-1/0,L=null,v.polygon?L=v.polygon:v.polyline&&(L=v.polyline),c=0;c<L.length;c++)L[c].x>P&&(P=L[c].x),L[c].x<k&&(k=L[c].x),L[c].y>B&&(B=L[c].y),L[c].y<M&&(M=L[c].y);if(I.width=P-k,I.height=B-M,I.x=v.x+k,I.y=v.y+M,h=0,l=0,I.width=I.width*this.unitsPerPixel,I.height=I.height*this.unitsPerPixel,I.x=I.x*this.unitsPerPixel+e,I.y=I.y*this.unitsPerPixel+i,v.polygon)for(I.shape={},I.shape.type="polygon",I.shape.points=[],d=0;d<L.length;d++)I.shape.points.push({x:(L[d].x-k)*this.unitsPerPixel+e,y:(L[d].y-M)*this.unitsPerPixel+i});else if(v.polyline)for(I.shape={},I.shape.type="polyline",I.shape.points=[],d=0;d<L.length;d++)I.shape.points.push({x:(L[d].x-k)*this.unitsPerPixel+e,y:(L[d].y-M)*this.unitsPerPixel+i})}else z=s*this.unitsPerPixel,X=n*this.unitsPerPixel,h=0,l=0,I.width=(v.width||0)*this.unitsPerPixel,I.height=(v.height||0)*this.unitsPerPixel,x&&("number"==typeof x.width&&(I.width=x.width,h=z),"number"==typeof x.height&&(I.height=x.height,l=X)),v.point||(I.width||(I.width=z),I.height||(I.height=X),h=h||I.width,l=l||I.height),I.x=v.x*this.unitsPerPixel,I.y=v.y*this.unitsPerPixel,v.rotation&&(g=(v.width||z)/2,m=(v.height||X)/2,y=v.rotation/180%2*Math.PI,f=platypus.Vector.setUp(g,-m).rotate(y),I.rotation=v.rotation,I.x=Math.round(1e3*(I.x+f.x-g))/1e3,I.y=Math.round(1e3*(I.y+f.y+m))/1e3,f.recycle()),"left"===S?I.regX=0:"center"===S?(I.regX=I.width/2,I.x+=h/2):"right"===S&&(I.regX=I.width,I.x+=h),I.x+=e,-1===E&&(I.y+=I.height),"bottom"===C?I.regY=I.height:"center"===C?(I.regY=I.height/2,I.y-=l/2):"top"===C&&(I.regY=0,I.y-=l),I.y+=i,v.ellipse?(I.shape={},I.shape.type="circle",I.shape.width=I.width*this.unitsPerPixel,I.shape.height=I.height*this.unitsPerPixel,I.shape.radius=(I.width+I.height)*this.unitsPerPixel/4):v.width&&v.height&&(I.shape={},I.shape.type="rectangle",I.shape.width=I.width*this.unitsPerPixel,I.shape.height=I.height*this.unitsPerPixel);x?(I.scaleX*=this.imagesScale*(x.scaleX||1),I.scaleY*=this.imagesScale*(x.scaleY||1)):(I.scaleX*=this.imagesScale,I.scaleY*=this.imagesScale),I.layerZ=this.layerZ,I.z?I.z+=this.layerZ:x&&"number"==typeof x.z?I.z=this.layerZ+x.z:I.z=this.layerZ,(v=this.owner.addEntity(new a(b,{properties:I},this.updateLoadingProgress.bind(this,o),this.owner)))&&(v.camera&&(this.followEntity={entity:v,mode:v.camera}),this.owner.triggerEvent("entity-created",v))}else this.updateLoadingProgress(o);this.layerZ+=this.layerIncrement},setupLayer:function(t,e,i,s,n,a,r,o,h,l){var c=!1,u=p(t.properties,"entity"),d=u||"render-layer",g=null,m=0;if(u||("collision"===t.name?d="collision-layer":"action"===t.name&&(d=e?"tile-layer":"render-layer")),"tile-layer"===d||this.showCollisionTiles&&platypus.game.settings.debug)return l.count+=1,this.createLayer("collision-layer",t,s,n,a,r,o,h,i,l),this.createLayer("render-layer",t,s,n,a,r,o,h,i,l);if("collision-layer"===d)return this.createLayer("collision-layer",t,s,n,a,r,o,h,i,l),null;if(g=platypus.game.settings.entities[d])for(m=g.components.length;m--;)if("RenderTiles"===g.components[m].type){c=!0;break}return c?this.createLayer(d,t,s,n,a,r,o,h,i,l):(this.createLayer(d,t,s,n,a,r,o,h,i,l),null)},updateLoadingProgress:function(t){t.count+=1,t.progress=t.count/t.total,this.owner.triggerEvent("level-loading-progress",t),t.count===t.total&&(t.recycle(),this.finishedLoading())},destroy:function(){}},publicMethods:{decodeLayer:function(t){return"base64"===t.encoding&&(t.data=r(t.data,t.compression),t.encoding="csv"),t}},getAssetList:function(t,e,i){var s=e||{},n=i||{},a=t.spriteSheet||s.spriteSheet||n.spriteSheet,r=t.images||s.images||n.images,o=m(t.level||s.level||n.level,a);return a&&("string"==typeof a?o.union(platypus.game.settings.spriteSheets[a].images):o.union(a.images)),r&&o.union(r),o},getLateAssetList:function(t,e,i,s){var n=e||{},a=i||{},r=t.spriteSheet||n.spriteSheet||a.spriteSheet;return s&&s.level?m(s.level,r):Array.setUp()}})}(),function(){"use strict";var t=include("platypus.AABB"),e=include("createjs.Tween");platypus.createComponentClass({id:"TutorialSystem",properties:{},publicProperties:{},initialize:function(){this.camera=t.setUp()},events:{"camera-update":function(t){this.camera.set(t.viewport)},"point-out-badge":function(){var t=this.owner.trigger;e.get(this.owner).to({rotation:135,x:this.camera.left+600,y:this.camera.bottom-600},600).call(t,["show-sprite"]).to({opacity:1},300).call(t,["pointy"]).wait(2e3).to({opacity:0},300).call(t,["hide-sprite"])},"point-out-journal":function(){var t=this.owner.trigger;e.get(this.owner).to({rotation:45,x:this.camera.right-600,y:this.camera.bottom-600},600).call(t,["show-sprite"]).to({opacity:1},300).call(t,["pointy"]).wait(2e3).to({opacity:0},300).call(t,["hide-sprite"])}}})}(),function(){"use strict";platypus.createComponentClass({id:"UnlockSequence",properties:{},publicProperties:{},initialize:function(){},events:{"complete-level":function(){this.owner.state.set("completing",!0)},"unlock-level":function(){this.owner.state.set("unlocking",!0)},"animation-ended":function(t){"completing"===t&&(this.owner.state.set("completing",!1),this.owner.state.set("complete",!0),this.owner.parent.triggerEvent("level-unlock-sequence")),"unlocking"===t&&(this.owner.state.set("unlocking",!1),this.owner.state.set("disabled",!1))}},methods:{},publicMethods:{}})}(),function(){"use strict";var t=include("platypus.components.AudioVO"),e=include("platypus.components.RenderAnimation"),i=include("platypus.components.RenderSprite"),s=function(t,e){return" "===e?t+"default":t+e},n=function(t,e,i){this.owner.addComponent(new t(this.owner,e,i))},a=function(t,e,i,n){var a=0,r="",o={},h=0,l="",p="",c=t.voice,u=t.mouthCues;if("string"==typeof t)o.sound=t,o.events=Array.setUp();else if("string"==typeof t.sound)o.sound=t.sound,o.events=Array.setUp();else{for(r in t.sound)t.sound.hasOwnProperty(r)&&(o[r]=t.sound[r]);o.events?o.events=o.events.greenSlice():o.events=Array.setUp()}if(c||u||!platypus.game.app.config.mouthCues||(u=platypus.game.app.config.mouthCues[o.sound]),c)for(c+=" ",a=0;a<c.length;a++)(p=c[a])!==l&&(l=p,o.events.push({time:h,event:s(i,p)})),h+=n;else if(u)for(a=0;a<u.length;a++)p=u[a],o.events.push({time:1e3*p.start,event:s(i,p.value)}),h+=n;return o},r=function(t,e,i,s){var n=0,r=Array.setUp();if(e[" "]||(e[" "]=e.default),Array.isArray(t)){for(n=0;n<t.length;n++)"number"==typeof t[n]?r.push(t[n]):r.push(a(t[n],0,i,s));return r}return a(t,0,i,s)};platypus.createComponentClass({id:"VoiceOver",properties:{animationMap:{default:"default"},renderComponent:"",frameLength:100,messagePrefix:"",voiceOverMap:{}},initialize:function(a,o){var h="",l=Array.setUp(),p={audioMap:{},aliases:a.aliases},c={acceptInput:a.acceptInput,aliases:a.aliases,animation:a.animation,animationMap:{},eventBased:!0,flip:a.flip,hidden:a.hidden,interactive:a.interactive,mask:a.mask,mirror:a.mirror,offsetZ:a.offsetZ,regX:a.regX,regY:a.regY,restart:a.restart,rotate:a.rotate,scaleX:a.scaleX,scaleY:a.scaleY,spriteSheet:a.spriteSheet,stateBased:a.stateBased||!1};for(h in this.messagePrefix?this.message=this.messagePrefix+"-":this.message="",this.animationMap)this.animationMap.hasOwnProperty(h)&&(c.animationMap[s(this.message,h)]=this.animationMap[h]);for(h in c.animationMap.default=this.animationMap.default,this.renderComponent?l.push(n.bind(this,platypus.components[this.renderComponent],c)):l.push(n.bind(this,a.animation?e:i,c)),this.voiceOverMap)this.voiceOverMap.hasOwnProperty(h)&&(p.audioMap[h]=r(this.voiceOverMap[h],this.animationMap,this.message,this.frameLength));return l.push(n.bind(this,t,p)),platypus.Async.setUp(l,o),l.recycle(),!0},events:{load:function(){this.owner.removeComponent(this)}},getAssetList:function(t,e,i){var s=t.spriteSheet||e.spriteSheet||i&&i.spriteSheet;return"string"==typeof s?platypus.game.settings.spriteSheets[s].images.greenSlice():s?s.images.greenSlice():Array.setUp()}})}(),function(){"use strict";platypus.createComponentClass({id:"ZoomBannerLogic",properties:{},publicProperties:{banner:null},initialize:function(){},events:{zoom:function(){this.owner.parent.triggerEvent("zoom-in",this.owner.banner)}},methods:{},publicMethods:{}})}();