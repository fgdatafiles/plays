/*! SpringRoll PBSKIDS 0.2.3 */
!function(e){var t=include("springroll.Application"),i=function(e,i){if(this.target=e,void 0===e.name)throw"DwellTimer object target needs a name";this.timer=e.id+"_dwell",this.learning=i||t.instance.learning,e.__dwellTimer=this,this.mouseOver=this.mouseOver.bind(this),this.mouseOut=this.mouseOut.bind(this),e.addEventListener("mouseover",this.mouseOver)},s=extend(i);s.mouseOver=function(e){var t=this.target;(void 0===t.enabled||t.enabled)&&(t.hasEventListener("mousedown")||t.hasEventListener("click")||t.hasEventListener("mouseup")||t.hasEventListener("pressup"))&&(this.learning&&this.learning.startTimer(this.timer),t.addEventListener("mousedown",this.mouseOut),t.addEventListener("mouseout",this.mouseOut))},s.mouseOut=function(e){var t,i=this.target;i.removeEventListener("mousedown",this.mouseOut),i.removeEventListener("mouseout",this.mouseOut),this.learning&&(t=this.learning.stopTimer(this.timer))>=1e3&&this.learning.dwellTime(this.learning.kidaptive_uri,t,i.name)},s.destroy=function(){var e=this.target;e.removeEventListener("mouseover",this.mouseOver),e.removeEventListener("mousedown",this.mouseOut),e.removeEventListener("mouseout",this.mouseOut),this.learning&&(this.learning.removeTimer(this.timer),this.learning=null),this.target=this.timer=null,this.mouseOver=this.mouseOut=null},i.create=function(e){i.destroy(e),new i(e)},i.destroy=function(e){e.__dwellTimer&&(e.__dwellTimer.destroy(),delete e.__dwellTimer)},namespace("springroll.pbskids.easeljs").DwellTimer=i,namespace("springroll.easeljs").DwellTimer=i}(),function(){var e,t=include("springroll.ApplicationPlugin"),i=include("createjs.Point"),s=new t,a=new i,n=new i;s.setup=function(){e||(e=include("springroll.Debug",!1)),this.offClickParams=[],this._lastPointerID=null,this.normalizePosition=function(e,t,i){if(e.hasOwnProperty("x")&&(i=t||e.parent,t=e.y,e=e.x),i&&i.localToGlobal){var s=i.localToGlobal(e,t,n);e=s.x,t=s.y}var a=this.display;return{x:0|e,y:0|t,stage_width:a.width,stage_height:a.height}},this.currentPosition=function(){return this.normalizePosition(a)}},s.preload=function(e){if(!this.learning)throw"Missing learning module. Is a requirement of easeljs-learning";var t=this.display;if(t){var i=t.stage;i&&(r=r.bind(this),o=o.bind(this),i.addEventListener("stagemousedown",r),i.addEventListener("stagemousemove",o))}e()};var o=function(e){e.pointerID===this._lastPointerID&&(a.x=e.stageX,a.y=e.stageY)},r=function(e){this._lastPointerID=e.pointerID;var t=e.target,i=t._getObjectsUnderPoint(e.stageX,e.stageY,null,!0),s=!1;if(i)for(;i&&i!=t;){if(i.hasEventListener("mousedown")||i.hasEventListener("click")){s=!0;break}i=i.parent}if(!s){var a=this.offClickParams.slice(0);a.unshift(this.normalizePosition(e.stageX,e.stageY)),a.unshift(this.learning.kidaptive_uri),this.learning.offClick&&this.learning.offClick.apply(this,a)}};s.teardown=function(){var e=this.display;if(e&&e.stage){var t=e.stage;t&&(t.removeEventListener("stagemousedown",r),t.removeEventListener("stagemousemove",o))}this.offClickParams=null}}(),function(){function e(){this.Container_constructor(),this.resize(app.display.width,app.display.height)}var t=createjs.extend(e,cjs.Container);function i(e,t){var i=app.display.width,s=app.display.height;void 0!==e.ox&&(e.x=e.ox*i+(e.rx||0)),void 0!==e.oy&&(e.y=e.oy*s+(e.ry||0))}t.reset=function(){},t.start=function(){this.setActive(!0)},t.setActive=function(e){},t.animateIn=function(){return cm.ViewControl.transitOut()},t.animateOut=function(){return this.setActive(!1),cm.ViewControl.transitIn()},t.resize=function(e,t){this.children.forEach(i)},t.update=function(){this.children.forEach(i)},t.destroy=function(){this.setActive(!1)},cm.View=cjs.promote(e,"Container")}(),function(){var e=[[{x:105,y:-132},{x:217,y:-116},{x:368,y:-10},{x:645,y:-11}],[{x:109,y:-195},{x:244,y:-163},{x:409,y:-24},{x:642,y:-11}],[{x:107,y:-269},{x:256,y:-221},{x:432,y:-32},{x:644,y:-11}],[{x:108,y:-334},{x:265,y:-287},{x:468,y:-50},{x:644,y:-15}]],t=[-156,-222,-290,-354],s=[.35,.3,.25,.2,.15],a=[{bg:{x:-2,y:-15},fore:{x:347,y:19}},{bg:{x:-5,y:-14},fore:{x:341,y:21}},{bg:{x:-6,y:-14},fore:{x:342,y:20}},{bg:{x:-2,y:-15},fore:{x:347,y:17}},{bg:{x:-5,y:-14},fore:{x:343,y:19}},{bg:{x:-5,y:-14},fore:{x:343,y:19}},{bg:{x:-6,y:-14},fore:{x:342,y:20}},{bg:{x:-6,y:-14},fore:{x:342,y:20}}],n={nick:{regX:40,regY:115},sally:{regX:40,regY:120},thing1:{regX:32,regY:90},thing2:{regX:29,regY:90}};function o(e){this.View_constructor(),this.levelCfg=e.levelCfg||null,this.isReplay=e.isReplay||!1,this.prevFailureCount=e.prevFailureCount||0,this.cleverSuccess=!1;var t=app.display.width,i=app.display.height;this.config=app.config.gameplay,this.minSlideHeight=1,this.maxSlideHeight=4,this.time=0,this.playerRaceDuration=0,this.thingRaceDuration=0,this.towerBlockHeight=62,this.towerBlockSpacing=4,this.slideYOffset=310,this.slideBaseDistance=554,this.towerElevation=0,this.slideBlockQuantity=2,this.thingPathPosition=0,this.playerPathPosition=0,this.thingHeightTimeComponent=1e3,this.playerHeightTimeComponent=1e3,this.playerSurfaceFrictionTimeComponent=0,this.playerSurfaceTextureName="none",this.useTool=this._useTool.bind(this),this.tutorialArrowOnMMB=this._tutorialArrowOnMMB.bind(this),this.interactionHandler=this._interactionHandler.bind(this),this.handleMMBUseEvents=this._handleMMBUseEvents.bind(this),this.slideStyleID=0,this.selectedRaceCharacterName="nick",this.selectedRaceThingName=["thing1","thing2"].random(),this.idlePromptManager=new cm.IdlePromptManager(app.display.stage),this.build(),this.resize(t,i)}var r=createjs.extend(o,cm.View);r.reset=function(){this.slidingChild.set({x:0,y:0,rotation:0}),this.slidingThing.set({x:0,y:0,rotation:0}),this.thingsSlideContainer.addChild(this.slidingThing),this.ui.nextBtn.set({scale:0,visible:!1}),this.ui.replayBtn.set({scale:0,visible:!1}),this.ui.progressBar.progress=cm.game.currentLevel/cm.game.maxLevels;var e=this.levelCfg;this.minSlideHeight=e.minSlideHeight,this.maxSlideHeight=e.maxSlideHeight,this.raceGoalCondition=e.goal,this.setThingSlideTowerElevation(e.thingSlideElevation),this.setPlayerSlideTowerElevation(e.playerSlideElevation),this.slideBlockQuantity=e.playerSlideElevation,this.checkHeightButtonState()},r.build=function(){var t,s,a=app.maxWidth,n=app.maxHeight,o=cm.Assets.lib.MainSS,r=new cjs.Shape;r.graphics.beginLinearGradientFill(["#53b5f3","#fff"],[0,1],0,0,0,470).dr(0,0,app.maxWidth,550);var h=["bg1","bg2","bg3"].random();this.bg=new cjs.Bitmap(cm.Assets.lib[h]),this.bg.regs(.5,1).set({y:app.display.height/2}),this.worldContainer=new cjs.Container,this.worldContainer.set({ox:.5,oy:.5,name:"world-container"}),this.thingsSlideContainer=new cjs.Container,this.thingsSlideContainer.set({x:-241,y:127,name:"thing_slide_container"}),this.slideContainer=new cjs.Container,this.slideContainer.set({x:-285,y:169,name:"slide_container"}),this.toolDragContainer=new cjs.Container;var c=new cjs.Sprite(o,"finish_line");c.regs("center").set({x:390,y:170}),this.clouds=new cm.SceneryClouds({spritesheet:cm.Assets.lib.MainSS,spriteNames:["cloud1","cloud2","cloud3","cloud4"]}),this.clouds.set({ox:.5,oy:.5}),this.worldContainer.addChild(this.bg,c,this.thingsSlideContainer,this.slideContainer),this.slide=(new cjs.Container).set({name:"Player Slide"});var d=new cjs.Sprite(o,"slide_1");this.slideBG=d,this.slideBG.hittestShape=new cjs.Shape,this.slideBG.hittestShape.alpha=.2,this.slide.addChild(d),this.playerTravelPath=new cm.CubicBezierCurve({x:16,y:62},{x:187,y:-42},{x:435,y:114},{x:713,y:64}),this.slide.set({regX:166,regY:326,name:"the_slide"}),s=new cjs.Shape,t=this.slide.getTransformedBounds(),s.graphics.f("#000").dr(t.x+166,t.y-200,t.width,700),this.slide.mask=s,this.slideTexture=new cjs.Sprite(o,"slidetexture_butter"),this.slideTexture.set({visible:!1}),this.slide.addChild(this.slideTexture),s=new cjs.Shape,t=this.slideTexture.getTransformedBounds(),s.graphics.clear().f("#000").dr(0,0,0,t.height),this.slideTexture.mask=s,this.slidingChild=new cjs.Sprite(cm.Assets.lib.CharacterAnimSS,cm.SlidingCharacter.getCharacterAnimPrefix("nick","sit_slide")),this.slidingChild.regs("center").set({visible:!1}),this.slide.addChild(this.slidingChild),this.slideTextureMaskSprite=new cjs.Sprite(cm.Assets.lib.SlideTexAnimsSS,"slide_texture_anims/butter_mask"),this.slideTextureMaskSprite.set({visible:!1,regX:42,regY:53,scaleX:1.1,scaleY:1.05,framerate:24}),this.slideTextureMaskSprite.on("animationend",(function(e){this.visible&&this.gotoAndPlay(this.currentAnimation)})),this.slide.addChild(this.slideTextureMaskSprite);var u=new cjs.Sprite(o,"slide_foreground_layer_1");u.center().set({x:348,y:63}),this.slide.addChild(u),this.slideFore=u,this.thingsSlideTower=new cm.ThingsSlide(this.levelCfg.thingSlideElevation,"slide_thing_tower_base",-25,"slide_thing_tower_top_base","slide_thing_tower_top_cap"),this.thingsSlideTower.name="thingsSlideTower",this.thingsSlideContainer.addChild(this.thingsSlideTower),this.thingsTowerTopContainer=(new cjs.Container).set({name:"Things Top Tower Container"});var p=this.thing1=(new cm.Thing1).set({name:"slide_top_thing1",x:-22,y:-9,startPos:{x:-22,y:-9}}),g=this.thing2=(new cm.Thing2).set({name:"slide_top_thing2",x:20,y:-11,startPos:{x:20,y:-11}});p.idleWave(),g.idleWave(),this.thingsTowerTopContainer.addChild(g,p),this.thingsSlideContainer.addChild(this.thingsTowerTopContainer),this.thingsSlideFore=this.thingsSlideTower.slideContainer.slideFront;var m=this.thingsSlideTower.slideContainer.localToLocal(this.thingsSlideFore.x,this.thingsSlideFore.y,this.thingsSlideContainer);this.thingsSlideFore.set(m),this.thingsSlideFore.rotation=this.thingsSlideTower.slideContainer.rotation,this.thingsSlideContainer.addChild(this.thingsSlideFore),this.thingTravelPath=new cm.CubicBezierCurve(e[0]),this.slidingThing=new cjs.Sprite(cm.Assets.lib.CharacterAnimSS,cm.SlidingCharacter.getCharacterAnimPrefix(this.selectedRaceThingName,"sit_slide")),this.slidingThing.regs("center").set({visible:!1}),this.towerTopContainer=(new cjs.Container).set({name:"Top Tower Container"}),this.towerTopContainer.set({y:this.slideYOffset});var f=new cjs.Sprite(o,"slide_tower_top_cap");f.regs("center").set({x:-8,y:-300});var v=new cjs.Sprite(o,"slide_tower_top_base");v.regs("center").set({x:-1,y:-279});var y=(new cm.Nic).set({name:"slide_top_nick",x:11,y:-341,startPos:{x:11,y:-341}}),w=(new cm.Sally).set({name:"slide_top_sally",x:-25,y:-330,scale:.98,startPos:{x:-25,y:-330}});y.idleWave(),w.idleWave(),this.slideTopNick=y,this.slideTopSally=w,this.towerTopGears=new cm.Assets.lib.MainAnims.Gears,this.towerTopGears.set({x:-71,y:-329,framerate:24}),this.towerTopGears.stop(),this.towerTopContainer.addChild(v,this.slide,f,this.towerTopGears,y,w);var T=new cjs.Sprite(o,"slide_tower_base");T.regs("center"),this.slideContainer.addChild(T),this.towerBlocks=[];var b=this.getRandomBlocks(),C=-this.towerBlockSpacing;for(i=0,l=4;i<l;i++)(s=new cm.Assets.lib.MainAnims[i%2==0?b[0]:b[1]]).gotoAndStop("default"),s.set({regX:56,regY:86,y:C,framerate:24}),this.slideContainer.addChild(s),this.towerBlocks[i]=s,(s=new cjs.Sprite(o,"suess_"+(i+1))).set({x:-17,y:C-this.towerBlockHeight/2,visible:!1}).center(),this.slideContainer.addChild(s),this.towerBlocks[i].blockNumber=s,C-=this.towerBlockHeight+this.towerBlockSpacing;this.slideContainer.addChild(this.towerTopContainer),this.pointerHandContainer=new cjs.Container,cm.VisualCues.setContainer(this.pointerHandContainer),this.levelChangeOverlay=new cjs.Shape,this.levelChangeOverlay.set({visible:!1,alpha:0,ox:.5,oy:.5}),this.levelChangeOverlay.graphics.f("#fff").dr(-a/2,-n/2,a,n),this.ui=new cm.GameUIController(this.config),this.blackOverlay=this.ui.blackOverlay,this.homeBtn=this.ui.homeBtn,this.heightControls=this.ui.heightControls,this.raceGuide=this.ui.raceGuide,this.startRaceBtn=this.ui.startRaceBtn,this.toolPalette=this.ui.toolPalette,this.nextBtn=this.ui.nextBtn,this.replayBtn=this.ui.replayBtn,this.progressBar=this.ui.progressBar,this.microMaboodle=this.ui.microMaboodle,this.raceReplay=this.ui.raceReplay,this.screenshotBtn=this.ui.screenshotBtn;var S=this;this.microMaboodle.addItemToMagnify(this.slideBG,new cm.MagnifiedTexture("butter"),{onMagnify:function(e){var t;switch(this.slideTexture.currentAnimation){case"slidetexture_butter":t="fof-mmb-inspect-butter",e.updateBackground("butter"),e.updateBallAnimation(this.config.textureTimeComponents.butter),this.unlockTexture("butter");break;case"slidetexture_sand":t="fof-mmb-inspect-sand",e.updateBackground("sand"),e.updateBallAnimation(this.config.textureTimeComponents.sand),this.unlockTexture("sand");break;case"slidetexture_ice":t="fof-mmb-inspect-ice",e.updateBackground("ice"),e.updateBallAnimation(this.config.textureTimeComponents.ice),this.unlockTexture("ice");break;case"slidetexture_honey":t="fof-mmb-inspect-honey",e.updateBackground("honey"),e.updateBallAnimation(this.config.textureTimeComponents.honey),this.unlockTexture("honey");break;case"slidetexture_oil":t="fof-mmb-inspect-oil",e.updateBackground("oil"),e.updateBallAnimation(this.config.textureTimeComponents.oil),this.unlockTexture("oil");break;case"slidetexture_glue":t="fof-mmb-inspect-glue",e.updateBackground("glue"),e.updateBallAnimation(this.config.textureTimeComponents.glue),this.unlockTexture("glue");break;case"slidetexture_rollers":t="fof-mmb-inspect-rollers",e.updateBackground("rollers"),e.updateBallAnimation(this.config.textureTimeComponents.rollers),this.unlockTexture("rollers");break;case"slidetexture_rocks":t="fof-mmb-inspect-rocks",e.updateBackground("rocks"),e.updateBallAnimation(this.config.textureTimeComponents.rocks),this.unlockTexture("rocks")}e.startBallAnimation(),!t||app.voPlayer.playing&&0!==app.voPlayer.currentVO.indexOf("fof-mmb-inspect-")||app.voPlayer.play(t,(function(){cm.game.checkMMBCuriositySeed(),cm.game.checkAllTexturesUnlocked()}));var i=this.slideTexture.currentAnimation.split("_")[1];cm.LearningBridge.mmbInspectObject(i,app.config.gameplay.textureTimeComponents[i],S.levelCfg.uri)}.bind(this),canHit:function(){return!0===this.slideTexture.visible}.bind(this)}),this.idlePromptManager.addIdlePrompt("start_btn_prompt",1e4,function(){this.startRaceBtn.idleHint()}.bind(this)),this.idlePromptManager.enabled=!0,this.idlePromptManager.pause("start_btn_prompt"),this.addChild(r,this.clouds,this.worldContainer,this.ui.blackOverlay,this.ui.homeBtn,this.ui.screenshotBtn,this.ui.heightControls,this.ui.raceGuide,this.ui.startRaceBtn,this.ui.toolPalette,this.ui.microMaboodle,this.ui.nextBtn,this.ui.replayBtn,this.ui.raceReplay,this.pointerHandContainer,this.ui.progressBar,this.ui.starParticles,this.toolDragContainer,this.levelChangeOverlay),void 0!==this.levelCfg.textures&&0!==this.levelCfg.textures.length||this.removeChild(this.ui.toolPalette,this.ui.microMaboodle),app.bridge.isInWrapper||this.removeChild(this.ui.screenshotBtn,this.ui.homeBtn),this.setSlideStyle(Math.range(1,8))},r.unlockTexture=function(e){if(!springroll.SavedData.read("hasSeenTexture_"+e)){springroll.SavedData.write("hasSeenTexture_"+e,!0),this.toolPalette.resetToolTray(e);var t=e+"ToolCursor";this.ui[t].gotoAndStop(e+"_tool")}},r.getRandomBlocks=function(){var e=["PurpleBlockPop","BlueBlockPop","LimeBlockPop","GreenBlockPop"];return e.shuffle(),e},r.setSlideStyle=function(e){this.slideStyleID=e,this.slideBG.gotoAndStop("slide_"+e),this.slideBG.set(a[e-1].bg),b=this.slideBG.getBounds(),b&&(padding=20,this.slideBG.hittestShape.graphics.clear().f("#fff").r(b.x-padding,b.y-padding,b.width+2*padding,b.height+2*padding)),this.slideBG.hittestShape.set(a[e-1].bg),this.slideFore.gotoAndStop("slide_foreground_layer_"+e),this.slideFore.set(a[e-1].fore),this.raceReplay.setSlideStyle(e),this.raceReplay.setThingSlideStype(this.thingsSlideTower.slideContainer.slideStyleID)},r.setPlayerSlideTowerElevation=function(e){for(var t,i=-this.towerBlockSpacing,s=0,a=this.towerBlocks.length;s<a;s++)(t=this.towerBlocks[s]).visible=!0,t.scale=1,t.blockNumber.visible=!0,s+1>e?(t.blockNumber.visible=!1,t.visible=!1):i-=this.towerBlockHeight+this.towerBlockSpacing;this.resetSlidingChildPosition(e);var n=Math.abs(i-this.towerBlockHeight+12);this.towerElevation=n,this.towerTopContainer.y=this.slideYOffset-n,this.slide.rotation=Math.toDeg(Math.atan(this.towerElevation/this.slideBaseDistance)),this.playerHeightTimeComponent=this.config.heightRaceDurations[e]},r.changePlayerSlideTowerElevation=function(e){var t,i,s=-this.towerBlockSpacing;this.mouseEnabled=!1;for(var a=0,n=this.towerBlocks.length;a<n;a++)a+1>e?!0===(i=this.towerBlocks[a]).visible&&(i.blockNumber.visible=!1,cjs.Tween.get(i).to({scale:.1},200,cjs.Ease.quadInOut).set({visible:!1})):(s-=this.towerBlockHeight+this.towerBlockSpacing,(t=this.towerBlocks[a]).visible=!0);this.resetSlidingChildPosition(e);var o=Math.abs(s-this.towerBlockHeight+10);o>this.towerElevation?(app.sound.play("slide-raise",{volume:.4}),t.scaleX=1,t.scaleY=.6,t.gotoAndPlay(0),cjs.Tween.get(t).to({scaleY:1},200,cjs.Ease.quadInOut).set({visible:!0},t.blockNumber).wait(100).call(t.gotoAndStop,[6],t)):o<this.towerElevation&&app.sound.play("slide-lower",{volume:.4}),this.towerElevation=o,this.towerTopGears.gotoAndPlay(0),cjs.Tween.get(this.towerTopContainer).to({y:this.slideYOffset-o},200,cjs.Ease.backOut),cjs.Tween.get(this.slide).to({rotation:Math.toDeg(Math.atan(this.towerElevation/this.slideBaseDistance))},200,cjs.Ease.backOut),cjs.Tween.get({}).wait(210).set({mouseEnabled:!0},this),this.playerHeightTimeComponent=this.config.heightRaceDurations[e]},r.setThingSlideTowerElevation=function(i){if(i<=4&&i>=1){var s=t[i-1];this.thingsTowerTopContainer.set({x:60,y:s}),this.thingTravelPath.set(e[i-1]),this.resetSlidingThingPosition(i),this.thingHeightTimeComponent=this.config.heightRaceDurations[i]}},r.resetSlidingThingPosition=function(e){this.thingPathPosition=0,this.thingTravelPath.putObject(0,this.slidingThing);var t=this.thingsTowerTopContainer.getChildByName("slide_top_"+this.selectedRaceThingName);t.set(t.startPos),t.idleWave(),t.visible=!0,this.slidingThing.visible=!1},r.resetSlidingChildPosition=function(e){var t=s[e];this.playerPathPosition=t,this.playerTravelPath.putObject(t,this.slidingChild);var i=this.towerTopContainer.getChildByName("slide_top_"+this.selectedRaceCharacterName);i.set(i.startPos),i.idleWave(),i.visible=!0,this.slidingChild.visible=!1,this.slide.addChild(this.slidingChild),this.slide.addChild(this.slideFore),this.thingsSlideContainer.addChild(this.thingsSlideFore)},r._useTool=function(e){var t;switch(e.tooltype){case"ice_tool":this.activeFrictionTool=this.ui.iceToolCursor,t=app.sound.play("slide-ice-loop",{volume:0,loop:!0});break;case"honey_tool":this.activeFrictionTool=this.ui.honeyToolCursor,t=app.sound.play("slide-honey-loop",{volume:0,loop:!0});break;case"butter_tool":this.activeFrictionTool=this.ui.butterToolCursor,t=app.sound.play("slide-butter-loop",{volume:0,loop:!0});break;case"sand_tool":this.activeFrictionTool=this.ui.sandToolCursor,t=app.sound.play("slide-sand-loop",{volume:0,loop:!0});break;case"sponge_tool":this.activeFrictionTool=this.ui.spongeToolCursor,t=app.sound.play("slide-sponge-loop",{volume:0,loop:!0});break;case"oil_tool":this.activeFrictionTool=this.ui.oilToolCursor,t=app.sound.play("slide-oil-loop",{volume:0,loop:!0});break;case"glue_tool":this.activeFrictionTool=this.ui.glueToolCursor,t=app.sound.play("slide-glue-loop",{volume:0,loop:!0});break;case"rollers_tool":this.activeFrictionTool=this.ui.rollersToolCursor,t=app.sound.play("slide-rollers-loop",{volume:0,loop:!0});break;case"rocks_tool":this.activeFrictionTool=this.ui.rocksToolCursor,t=app.sound.play("slide-rocks-loop",{volume:0,loop:!0})}app.sound.play("global-grab-item",{volume:.5}),this.frictionToolSoundLoop=t,cjs.Tween.get(this.frictionToolSoundLoop).to({volume:.4},300),this.activeFrictionTool.set({x:e.stageX,y:e.stageY,_startX:e.stageX,_startY:e.stageY}),this.toolDragContainer.addChild(this.activeFrictionTool),this.toolmove=cm.game.stage.on("stagemousemove",this._toolmove,this),this.thingsSlideContainer&&cjs.Tween.get(this.thingsSlideContainer).to({alpha:.5},300,cjs.Ease.quadInOut);var i,s=e.tooltype;cm.Device.mobile?(i="drag",this.finishTool=cm.game.stage.on("stagemouseup",this._finishUsingTool,this)):(i="click",this.finishTool=this.activeFrictionTool.on("click",this._finishUsingTool,this)),cm.LearningBridge.startDrag(e,i,s,this.levelCfg.uri)},r._tutorialArrowOnMMB=function(e){this.tutorialArrow||(this.tutorialArrow=new cjs.Sprite(cm.Assets.lib.MainSS,"tutorial_arrow"),this.tutorialArrow.set({visible:!1,alpha:0}).regs(.5,1),this.tutorialArrow.baseRegY=this.tutorialArrow.regY,this.addChild(this.tutorialArrow));var t=this.microMaboodle.localToLocal(this.microMaboodle.lensArmContainer.x,this.microMaboodle.lensArmContainer.y,this);return this.tutorialArrow.set({x:t.x-40,y:t.y-110}),cjs.Tween.get(this.tutorialArrow).set({visible:!0}).to({alpha:1},300,cjs.Ease.backOut).wait(6e3).to({alpha:0},300,cjs.Ease.backOut).set({visible:!1})},r._toolmove=function(e){this.activeFrictionTool.set({x:e.stageX,y:e.stageY});var t=this.slideBG.globalToLocal(e.stageX,e.stageY),i=this.activeFrictionTool.name;this.slide.addChild(this.slideBG.hittestShape),this.slideBG.hittestShape.hitTest(t.x,t.y)&&!this.isPaintingSlide&&(!1===this.slideTexture.visible&&0===this.playerSurfaceFrictionTimeComponent&&"sponge_tool"!==i?(this.isPaintingSlide=!0,this._slidePaintTargetX=0,this.slideTexture.visible=!0,this.slideTextureMaskSprite.set({visible:!0,alpha:1,scale:1}),"butter_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/butter_mask"),this.slideTexture.gotoAndStop("slidetexture_butter"),this.slideTexture.set({x:-56,y:5,alpha:1,rotation:.5})):"honey_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/honey_mask"),this.slideTexture.gotoAndStop("slidetexture_honey"),this.slideTexture.set({x:-56,y:5,alpha:1,rotation:.5})):"sand_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/sand_mask"),this.slideTexture.gotoAndStop("slidetexture_sand"),this.slideTexture.set({x:-1,y:18,alpha:1,rotation:-.3})):"ice_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/ice_mask"),this.slideTexture.gotoAndStop("slidetexture_ice"),this.slideTexture.set({x:7,y:14,alpha:1,rotation:0})):"oil_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/oil_mask"),this.slideTexture.gotoAndStop("slidetexture_oil"),this.slideTexture.set({x:-56,y:5,alpha:1,rotation:.5})):"glue_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/glue_mask"),this.slideTexture.gotoAndStop("slidetexture_glue"),this.slideTexture.set({x:-56,y:1,alpha:1,rotation:.5})):"rollers_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/rollers_mask"),this.slideTexture.gotoAndStop("slidetexture_rollers"),this.slideTexture.set({x:6,y:-13,alpha:1,rotation:.7})):"rocks_tool"===i&&(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/rocks_mask"),this.slideTexture.gotoAndStop("slidetexture_rocks"),this.slideTexture.set({x:29,y:0,alpha:1,rotation:.8}))):"sponge_tool"===i&&0!==this.playerSurfaceFrictionTimeComponent&&(this.isPaintingSlide=!0,this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/sponge_mask"),this.slideTextureMaskSprite.set({visible:!0,alpha:1,scale:1}))),this.slide.removeChild(this.slideBG.hittestShape),this._slidePaintPoint=t},r._finishUsingTool=function(e){this.thingsSlideContainer&&cjs.Tween.get(this.thingsSlideContainer,{override:!0}).to({alpha:1},300,cjs.Ease.quadInOut),cm.game.stage.off("stagemousemove",this.toolmove),cm.Device.mobile?cm.game.stage.off("stagemouseup",this.finishTool):this.activeFrictionTool.off("click",this.finishTool);var t=this.activeFrictionTool.name;if(this.isPaintingSlide)"sponge_tool"===t?(this._slidePaintTargetX>0?cjs.Tween.get(this,{onChange:function(e){this.updateSlideTextureMask()}.bind(this)}).to({_slidePaintTargetX:0},400,cjs.Ease.quadInOut).set({visible:!1},this.slideTexture).set({visible:!1},this.slideTextureMaskSprite):(this.slideTexture.visible=!1,this.slideTextureMaskSprite.visible=!1),cm.LearningBridge.finishedClearingSlideTexture(this,this.playerSurfaceTextureName,this.playerSurfaceFrictionTimeComponent),this.playerSurfaceFrictionTimeComponent=0,this.playerSurfaceTextureName="none"):0===this.playerSurfaceFrictionTimeComponent&&(this._slidePaintTargetX<this.slideTexture.getBounds().width?(cjs.Tween.get(this,{onChange:function(e){this.updateSlideTextureMask()}.bind(this)}).to({_slidePaintTargetX:this.slideTexture.getTransformedBounds().width},400,cjs.Ease.quadInOut),cjs.Tween.get(this.slideTextureMaskSprite).wait(400).to({alpha:0,scale:1.1},200,cjs.Ease.quadInOut).set({visible:!1})):cjs.Tween.get(this.slideTextureMaskSprite).to({alpha:0,scale:1.1},200,cjs.Ease.quadInOut).set({visible:!1}),"butter_tool"===t?(this.playerSurfaceFrictionTimeComponent=this.config.textureTimeComponents.butter,this.playerSurfaceTextureName="butter"):"sand_tool"===t?(this.playerSurfaceFrictionTimeComponent=this.config.textureTimeComponents.sand,this.playerSurfaceTextureName="sand"):"ice_tool"===t?(this.playerSurfaceFrictionTimeComponent=this.config.textureTimeComponents.ice,this.playerSurfaceTextureName="ice"):"honey_tool"===t?(this.playerSurfaceFrictionTimeComponent=this.config.textureTimeComponents.honey,this.playerSurfaceTextureName="honey"):"oil_tool"===t?(this.playerSurfaceFrictionTimeComponent=this.config.textureTimeComponents.oil,this.playerSurfaceTextureName="oil"):"glue_tool"===t?(this.playerSurfaceFrictionTimeComponent=this.config.textureTimeComponents.glue,this.playerSurfaceTextureName="glue"):"rollers_tool"===t?(this.playerSurfaceFrictionTimeComponent=this.config.textureTimeComponents.rollers,this.playerSurfaceTextureName="rollers"):"rocks_tool"===t&&(this.playerSurfaceFrictionTimeComponent=this.config.textureTimeComponents.rocks,this.playerSurfaceTextureName="rocks"),cm.LearningBridge.finishedApplyingSlideTexture(this));else{var i=cm.Device.mobile?"drag":"click";cm.LearningBridge.endDragOutside(i,t,this.levelCfg.uri)}app.sound.play("global-misplace-item"),this.isPaintingSlide=!1,cjs.Tween.get(this.frictionToolSoundLoop).to({volume:0},400).call(this.frictionToolSoundLoop.stop,null,this.frictionToolSoundLoop),this.toolPalette.mouseEnabled=!1,cjs.Tween.get(this.activeFrictionTool).to({x:this.activeFrictionTool._startX,y:this.activeFrictionTool._startY},400,cjs.Ease.cubicInOut).set({mouseEnabled:!0},this.toolPalette).call((function(){this.toolPalette.resetToolTray(this.activeFrictionTool.name.split("_")[0]),this.activeFrictionTool.parent.removeChild(this.activeFrictionTool),this.activeFrictionTool=null}),null,this)},r.makeLevelUID=function(e){for(var t,i,s,a,n=[],o=[],r={difficulty:"diff",thingSlideElevation:"tse",playerSlideElevation:"pse",minSlideHeight:"minsh",maxSlideHeight:"maxsh",goal:"goal",textures:"tex",isTutorial:"tut"},l=["isTutorial","difficulty","thingSlideElevation","playerSlideElevation","minSlideHeight","maxSlideHeight","goal","textures"],h=0,c=l.length;h<c;h++)if(void 0!==(s=e[a=l[h]])){if(t="",t+=r[a]+":","textures"===a)if(o.length=0,(i=s).length>0){for(var d=0,u=i.length;d<u;d++)o[d]=app.config.gameplay.slideTextureIDs[i[d]];t+=o.join(",")}else t+=-1;else"isTutorial"===a?t+=1:"boolean"==typeof s?t+=Number(s):void 0!==s&&(t+=s);n.push(t)}return n.join("_")},r.start=function(){this.setActive(!0),this.resize(app.display.width,app.display.height),cm.LearningBridge.startRound(this.levelCfg,this.isReplay),app.pleAnalyticsHelper.trackLevelStart(this.makeLevelUID(this.levelCfg)),app.pleAnalyticsHelper.trackRoundStart(this.makeLevelUID(this.levelCfg)),cm.game.checkForPersistentAward()?cjs.Tween.get(this).wait(1e3).call(this.waitForSeedVO,null,this):this.startGameplay()},r.waitForSeedVO=function(){cjs.Tween.get(this).wait(app.voPlayer.currentDuration||4e3).call(this.startGameplay,null,this)},r.startGameplay=function(){var e;this._playRaceHint(),this.showHeightControls(this.levelCfg.hasHeightControls),this.showToolPalette(this.levelCfg.textures.length>0),e="nick"===springroll.SavedData.read("fof_lastSlideChar")?"sally":"nick",springroll.SavedData.write("fof_lastSlideChar",e),this.selectedRaceCharacterName=e,this.ui.setRaceGuide(this.raceGoalCondition,e),this.showRaceGuide(!0).wait(1500).call(this.ui.raceGuideToSide,null,this.ui),this.showStartRaceButton(!0)},r._playRaceHint=function(){if(!app.voPlayer.playing)switch(this.raceGoalCondition){case this.config.RACE_GOALS.PLAYER_WIN:app.voPlayer.play("fof-goal-generic-faster");break;case this.config.RACE_GOALS.TIE:app.voPlayer.play("fof-goal-generic-tie");break;case this.config.RACE_GOALS.PLAYER_LOSE:app.voPlayer.play("fof-goal-generic-slower")}},r.showStartRaceButton=function(e){return!0===e?this.idlePromptManager.resume("start_btn_prompt"):!1===e&&this.idlePromptManager.pause("start_btn_prompt"),this.ui.showStartRaceButton(e)},r._setupToolPalette=function(){this.toolPalette.setToolButtons(this.levelCfg.textures);for(var e,t=this.unlockTexture.bind(this),i=this,s=0,a=this.levelCfg.textures.length;s<a;s++)e=this.levelCfg.textures[s],this.microMaboodle.addItemToMagnify(this.toolPalette.getToolButtonInstance(e+"_tool"),new cm.MagnifiedTexture(e),{onMagnify:function(){var s="fof-mmb-inspect-"+e,a=e;return function(e){t(e.type),e.startBallAnimation(),app.voPlayer.playing&&0!==app.voPlayer.currentVO.indexOf("fof-mmb-inspect-")||app.voPlayer.play(s,(function(){cm.game.checkMMBCuriositySeed(),cm.game.checkAllTexturesUnlocked()})),cm.LearningBridge.mmbInspectObject(a,app.config.gameplay.textureTimeComponents[a],i.levelCfg.uri)}}()})},r.shouldPlayMMBVO=function(){for(var e=!1,t=0,i=this.mmbVOIDs;t<i;t++)if(app.voPlayer.currentVO===this.mmbVOIDs[t]){e=!0;break}return!app.voPlayer.playing||e},r.showToolPalette=function(e){return!0===e?(app.sound.play("global-tray-slide-up",{volume:.3}),this._setupToolPalette(),this.microMaboodle.visible=!0,this.microMaboodle.show(),this.toolPalette.addEventListener("toolDrag",this.useTool),this.toolPalette.addEventListener("mysteryClicked",this.tutorialArrowOnMMB),cjs.Tween.get(this.ui.toolPalette).set({visible:!0}).to({ry:0},300,cjs.Ease.quadIn).set({mouseEnabled:!0})):!1===e&&!0===this.ui.toolPalette.visible?(this.microMaboodle.hide().set({visible:!1},this.microMaboodle),this.toolPalette.removeEventListener("toolDrag",this.useTool),this.toolPalette.removeEventListener("mysteryClicked",this.tutorialArrowOnMMB),cjs.Tween.get(this.ui.toolPalette).set({mouseEnabled:!1}).to({ry:this.ui.toolPalette.getBounds().height},300,cjs.Ease.quadIn).set({visible:!1})):void 0},r.showHeightControls=function(e){return this.ui.showHeightControls(e)},r.showRaceGuide=function(e){return this.ui.showRaceGuide(e)},r.destroy=function(){this.View_destroy(),this.idlePromptManager.destroy(),this.ui.destroy()},r.setActive=function(e){!0===e?(this.screenshotBtn.addListeners(),this.startRaceBtn.clickHandler=this._onStartRaceButtonClicked.bind(this),this.attachInteractionHandler(this.heightControls),this.attachInteractionHandler(this.nextBtn),this.attachInteractionHandler(this.replayBtn),this.attachInteractionHandler(this.raceGuide),this.attachInteractionHandler(this.homeBtn),this.microMaboodle.addEventListener("mmb_use_start",this.handleMMBUseEvents),this.microMaboodle.addEventListener("mmb_use_end",this.handleMMBUseEvents),this.ui.createDwellTimers()):!1===e&&(this.screenshotBtn.removeListeners(),cjs.Tween.removeTweens(this),this.startRaceBtn.removeListeners(),this.removeInteractionHandler(this.heightControls),this.removeInteractionHandler(this.nextBtn),this.removeInteractionHandler(this.replayBtn),this.removeInteractionHandler(this.raceGuide),this.removeInteractionHandler(this.homeBtn),this.ui.destroyDwellTimers(),this.microMaboodle.removeEventListener("mmb_use_start",this.handleMMBUseEvents),this.microMaboodle.removeEventListener("mmb_use_end",this.handleMMBUseEvents))},r.checkHeightButtonState=function(){this.slideBlockQuantity===this.maxSlideHeight&&(this.ui.heightUpBtn.mouseEnabled=!1,this.ui.heightUpBtn.alpha=.5),this.slideBlockQuantity===this.minSlideHeight&&(this.ui.heightDownBtn.mouseEnabled=!1,this.ui.heightDownBtn.alpha=.5),this.slideBlockQuantity<this.maxSlideHeight&&(this.ui.heightUpBtn.alpha=1,this.ui.heightUpBtn.mouseEnabled=!0),this.slideBlockQuantity>this.minSlideHeight&&(this.ui.heightDownBtn.alpha=1,this.ui.heightDownBtn.mouseEnabled=!0)},r.canMoveHeightDown=function(){return this.slideBlockQuantity>this.minSlideHeight&&!cjs.Tween.hasActiveTweens(this.slide)},r.canMoveHeightUp=function(){return this.slideBlockQuantity<this.maxSlideHeight&&!cjs.Tween.hasActiveTweens(this.slide)},r.handleHeightDownClick=function(e){this.canMoveHeightDown()&&this.lowerSlide(e),this.checkHeightButtonState()},r.handleHeightUpClick=function(e){this.canMoveHeightUp()&&this.raiseSlide(e),this.checkHeightButtonState()},r.lowerSlide=function(e){this.slideBlockQuantity--,cm.LearningBridge.loweredSlideHeight(this),this.changePlayerSlideTowerElevation(this.slideBlockQuantity)},r.raiseSlide=function(e){this.slideBlockQuantity++,cm.LearningBridge.raisedSlideHeight(this),this.changePlayerSlideTowerElevation(this.slideBlockQuantity)},r.attachInteractionHandler=function(e){e.addEventListener("click",this.interactionHandler),e.addEventListener("mousedown",this.interactionHandler),e.addEventListener("pressup",this.interactionHandler)},r.removeInteractionHandler=function(e){e.removeEventListener("click",this.interactionHandler),e.removeEventListener("mousedown",this.interactionHandler),e.removeEventListener("pressup",this.interactionHandler)},r._handleMMBUseEvents=function(e){if(!this.simulatingMicromaboodle)switch(e.type){case"mmb_use_start":cm.LearningBridge.startDrag(e,"drag","micro-ma-boodle",this.levelCfg.uri);break;case"mmb_use_end":cm.LearningBridge.endDragOutside("drag","micro-ma-boodle",this.levelCfg.uri)}},r._interactionHandler=function(e){switch(e.type){case"click":switch(e.target.name){case"home_btn":this.takeSlideSnapshot&&this.takeSlideSnapshot(),app.bridge.goHome();break;case"height_down_btn":this.handleHeightDownClick(e);break;case"height_up_btn":this.handleHeightUpClick(e);break;case"replay_btn":app.voPlayer.stop(),this.mouseEnabled=!1,cm.LearningBridge.replayRound(this.levelCfg.uri),cm.ViewControl.gotoView("Game",{levelCfg:this.levelCfg,isReplay:!0});break;case"next_btn":this.mouseEnabled=!1,app.voPlayer.stop(),cm.LearningBridge.gotoNextRound(this.levelCfg.uri),app.bridge.isInWrapper?this.ui.collectXP(this.cleverSuccess,(function(){cjs.Tween.get({}).wait(500).call((function(){cm.game.gotoNextView()}))})):cm.game.gotoNextView();break;case"race_guide":app.sound.play("global-click-2"),this._playRaceHint()}break;case"mousedown":switch(e.target.name){case"height_down_btn":e.target.gotoAndStop("height_down_btn_pressed");break;case"height_up_btn":e.target.gotoAndStop("height_up_btn_pressed");break;case"race_guide":cjs.Tween.get(e.target).to({scale:.6},150,cjs.Ease.quadInOut)}break;case"pressup":switch(e.target.name){case"height_down_btn":e.target.gotoAndStop("height_down_btn");break;case"height_up_btn":e.target.gotoAndStop("height_up_btn");break;case"race_guide":cjs.Tween.get(e.target).to({scale:.7},150,cjs.Ease.backOut)}}},r._onStartRaceButtonClicked=function(e){this.startRace(this.selectedRaceCharacterName,this.selectedRaceThingName),this.showStartRaceButton(!1)},r.startRace=function(e,t){this.showToolPalette(!1),this.showHeightControls(!1),cm.LearningBridge.submitAnswer(this,!!this.isTutorialView);var i=this.towerTopContainer.getChildByName("slide_top_"+e);i.jumpToSlide();var s=this.thingsTowerTopContainer.getChildByName("slide_top_"+t);s.jumpToSlide();var a=this.slidingChild.parent.localToLocal(this.slidingChild.x,this.slidingChild.y,i.parent),n=(a.y+i.y)/2-40;app.sound.play("slide-jump"),cjs.Tween.get(i).to({x:a.x},600),cjs.Tween.get(i).to({y:n},300,cjs.Ease.quadOut).to({y:a.y},300,cjs.Ease.quadIn),n=((a=this.slidingThing.parent.localToLocal(this.slidingThing.x,this.slidingThing.y,s.parent)).y+s.y)/2-40,cjs.Tween.get(s).to({x:a.x},600),cjs.Tween.get(s).to({y:n},300,cjs.Ease.quadOut).to({y:a.y},300,cjs.Ease.quadIn).call(this._startRace,null,this)},r._startRace=function(){var e=this._thingRaceUpdate.bind(this),t=this._playerRaceUpdate.bind(this),i=this.getThingTime();this.slidingChild.visible=!0,this.slidingThing.visible=!0,this.slidingChild.gotoAndStop(cm.SlidingCharacter.getCharacterAnimPrefix(this.selectedRaceCharacterName,"sit_slide")),this.slidingChild.set(n[this.selectedRaceCharacterName]),this.slidingThing.gotoAndStop(cm.SlidingCharacter.getCharacterAnimPrefix(this.selectedRaceThingName,"sit_slide")),this.slidingThing.set(n[this.selectedRaceThingName]),this.towerTopContainer.getChildByName("slide_top_"+this.selectedRaceCharacterName).visible=!1,this.thingsTowerTopContainer.getChildByName("slide_top_"+this.selectedRaceThingName).visible=!1,"nick"===this.selectedRaceCharacterName?app.voPlayer.play(["fof-sliding-nick-alt1","fof-sliding-nick-alt2","fof-sliding-nick-alt3","fof-sliding-nick-alt4","fof-sliding-nick-alt5"].random()):"sally"===this.selectedRaceCharacterName&&app.voPlayer.play(["fof-sliding-sally-alt1","fof-sliding-sally-alt2","fof-sliding-sally-alt3","fof-sliding-sally-alt4"].random());cjs.Tween.get(this,{onChange:e,onComplete:this._thingRaceComplete.bind(this)}).to({thingPathPosition:1},i,cjs.Ease.quadIn);var s=this.getPlayerTime();cjs.Tween.get(this,{onChange:t,onComplete:this._playerRaceComplete.bind(this)}).to({playerPathPosition:1},s,cjs.Ease.quadIn)},r._playerRaceComplete=function(e){var t=this.slidingChild,i=this.slide.localToLocal(this.slidingChild.x,this.slidingChild.y,this.slideContainer);t.set({x:i.x,y:i.y,rotation:this.slide.rotation}),this.slideContainer.addChild(t),cjs.Tween.get(t).to({x:t.x+70,rotation:0},.2*this.getPlayerTime(),cjs.Ease.quadOut),1===this.thingPathPosition&&1===this.playerPathPosition&&this.raceComplete()},r._thingRaceComplete=function(e){cjs.Tween.get(this.slidingThing).to({x:this.slidingThing.x+70,rotation:0},.2*this.getThingTime(),cjs.Ease.quadOut),1===this.thingPathPosition&&1===this.playerPathPosition&&this.raceComplete()},r._thingRaceUpdate=function(e){this.thingTravelPath.putObject(this.thingPathPosition,this.slidingThing)},r._playerRaceUpdate=function(e){this.playerTravelPath.putObject(this.playerPathPosition,this.slidingChild)},r.raceComplete=function(e){var t,i,s=this.getThingTime(),a=this.getPlayerTime(),n=this.selectedRaceCharacterName,o=["fof-success-generic-sally-alt2","fof-success-generic-nick"];if(this.playerSurfaceFrictionTimeComponent!==app.config.gameplay.textureTimeComponents.butter&&this.playerSurfaceFrictionTimeComponent!==app.config.gameplay.textureTimeComponents.honey&&this.playerSurfaceFrictionTimeComponent!==app.config.gameplay.textureTimeComponents.oil&&this.playerSurfaceFrictionTimeComponent!==app.config.gameplay.textureTimeComponents.glue||o.push("fof-success-generic-sally-alt1"),o=o.random(),this.raceGoalCondition===this.config.RACE_GOALS.PLAYER_LOSE)s<a?this.checkCleverSpeedUpTexture()?(this.cleverSuccess=!0,t=["factorfriction-19.5","factorfriction-19.6"],this.playCorrectFeedbackVO([o,t.random()],this.succeedLevel.bind(this,"lose"))):this.playCorrectFeedbackVO([o,"fof-success-slower-generic-"+n],this.succeedLevel.bind(this,"lose")):(s===a?i="tie":s>a&&(i="win"),this.playFailure(i,["fof-failure-slower-generic","fof-failure-fq-generic-slower"]));else if(this.raceGoalCondition===this.config.RACE_GOALS.TIE)if(s===a)this.playCorrectFeedbackVO([o,"fof-success-tie-generic-"+n],this.succeedLevel.bind(this,"tie"));else{var r=["fof-failure-tie-generic"];s<a?(i="lose",r.push("fof-failure-fq-generic-faster")):s>a&&(i="win",r.push("fof-failure-fq-generic-slower")),this.playFailure(i,r)}else this.raceGoalCondition===this.config.RACE_GOALS.PLAYER_WIN&&(s>a?this.checkCleverSlowDownTexture()?(this.cleverSuccess=!0,t=["factorfriction-19.5","factorfriction-19.6"],this.playCorrectFeedbackVO([o,t.random()],this.succeedLevel.bind(this,"win"))):this.playCorrectFeedbackVO([o,"fof-success-faster-generic-"+n],this.succeedLevel.bind(this,"win")):(s===a?i="tie":s<a&&(i="lose"),this.playFailure(i,["fof-failure-faster-generic","fof-failure-fq-generic-faster"])))},r.checkCleverSpeedUpTexture=function(){return this.slideTexture.visible&&("slidetexture_butter"===this.slideTexture.currentAnimation||"slidetexture_ice"===this.slideTexture.currentAnimation||"slidetexture_oil"===this.slideTexture.currentAnimation||"slidetexture_rollers"===this.slideTexture.currentAnimation)},r.checkCleverSlowDownTexture=function(){return this.slideTexture.visible&&("slidetexture_sand"===this.slideTexture.currentAnimation||"slidetexture_honey"===this.slideTexture.currentAnimation||"slidetexture_glue"===this.slideTexture.currentAnimation||"slidetexture_rocks"===this.slideTexture.currentAnimation)},r.playFailure=function(e,t){var i=null;!0===this.slideTexture.visible&&(i=this.slideTexture.currentAnimation.replace("slidetexture_","")),this.raceReplay.replayResult(e,i,this.selectedRaceCharacterName,this.selectedRaceThingName),this.raceReplay.show(),this.playIncorrectFeedbackVO(t,function(){this.mouseEnabled=!1,cm.ViewControl.gotoView("Game",{levelCfg:this.levelCfg,prevFailureCount:++this.prevFailureCount}),cm.game.totalMisses++}.bind(this))},r.succeedLevel=function(e){var t=null;!0===this.slideTexture.visible&&(t=this.slideTexture.currentAnimation.replace("slidetexture_","")),this.prevFailureCount>=2&&app.seeds.earnSeedPacket(app.seeds.seedTypes.PERSISTENCE,"You fail a race twice, and then get it right on the third time.",{voOptions:["garden-18","garden-22"]}),cm.LearningBridge.endRound(this.levelCfg.uri,this.prevFailureCount,this.time),app.pleAnalyticsHelper.trackRoundEnd(this.makeLevelUID(this.levelCfg)),app.pleAnalyticsHelper.trackLevelComplete(this.makeLevelUID(this.levelCfg)),app.sound.play("slide-results-appear"),this.ui.succeedLevel(),this.raceReplay.replayResult(e,t,this.selectedRaceCharacterName,this.selectedRaceThingName),this.raceReplay.show()},r.getThingTime=function(){return this.thingHeightTimeComponent},r.getPlayerTime=function(){return this.playerHeightTimeComponent+this.playerSurfaceFrictionTimeComponent},r.resize=function(e,t){this.View_resize(e,t),this.ui&&this.ui.resize(e,t)},r.onScreenCaptureEvent=function(e){var t=app.bridge.events;switch(e.type){case t.SCREEN_CAPTURE_START:this.ui.hideAllForScreenshot(),this.pointerHandContainer.visible=!1;break;case t.SCREEN_CAPTURE_END:this.ui.showAllAfterScreenshot(),this.pointerHandContainer.visible=!0}},r.update=function(e){if(this.time+=e,this.View_update(),this.ui.update(e),this.isPaintingSlide&&("sponge_tool"===this.activeFrictionTool.name&&this._slidePaintPoint.x<this._slidePaintTargetX||"sponge_tool"!==this.activeFrictionTool.name&&this._slidePaintPoint.x>this._slidePaintTargetX)){this._slidePaintTargetX=Math.lerp(this._slidePaintTargetX,this._slidePaintPoint.x,.1),this.updateSlideTextureMask();var t=this.slideTexture.getTransformedBounds();!cm.Device.mobile&&("sponge_tool"===this.activeFrictionTool.name&&this._slidePaintTargetX<0||"sponge_tool"!==this.activeFrictionTool.name&&this._slidePaintTargetX>t.width)&&this._finishUsingTool({stageX:app.display.stage.mouseX,stageY:app.display.stage.mouseY})}this.tutorialArrow&&this.tutorialArrow.visible&&(this.tutorialArrow.regY=this.tutorialArrow.baseRegY+10*Math.sin(.004*this.time)),this.idlePromptManager.update(e)},r.updateSlideTextureMask=function(){var e=this.slideTexture.getTransformedBounds();this.slideTexture.mask.graphics.clear().f("#000").dr(this.slideTexture.x,this.slideTexture.y,this._slidePaintTargetX,e.height);var t=this._slidePaintTargetX/e.width;this.playerTravelPath.putObject(t,this.slideTextureMaskSprite),this.slideTextureMaskSprite.x=this.slideTexture.x+this._slidePaintTargetX},r.playInstructionVO=function(e,t){app.voPlayer.play(e,(function(){cm.LearningBridge.endInstruction(),t&&t()}),(function(){cm.LearningBridge.endInstruction()})),cm.LearningBridge.startInstruction(e,this.levelCfg.uri)},r.playCorrectFeedbackVO=function(e,t){app.voPlayer.play(e,(function(){cm.LearningBridge.endCorrectFeedback(),t&&t()}),(function(){cm.LearningBridge.endCorrectFeedback()})),cm.LearningBridge.startCorrectFeedback(e,this.levelCfg.uri)},r.playIncorrectFeedbackVO=function(e,t){app.voPlayer.play(e,(function(){cm.LearningBridge.endIncorrectFeedback(),t&&t()}),(function(){cm.LearningBridge.endIncorrectFeedback()})),cm.LearningBridge.startIncorrectFeedback(e,this.levelCfg.uri)},r.wouldPlayerSucceed=function(){var e=this.getThingTime(),t=this.getPlayerTime();return this.raceGoalCondition===this.config.RACE_GOALS.PLAYER_LOSE?e<t:this.raceGoalCondition===this.config.RACE_GOALS.TIE?e===t:this.raceGoalCondition!==this.config.RACE_GOALS.PLAYER_WIN||e>t},cm.View.GameView=cjs.promote(o,"View")}(),function(){function e(e){var t=cm.Assets.lib.MainSS,i=app.maxWidth,s=app.maxHeight;this.config=e,this.blackOverlay=new cjs.Shape,this.blackOverlay.set({visible:!1,alpha:0,ox:.5,oy:.5}),this.blackOverlay.graphics.f("#000").dr(-i/2,-s/2,i,s);var a=new cm.UIButton(cm.Assets.lib.SharedUISS,"home-btn");a.regs("center").set({x:64,y:64,name:"home_btn"}).pointerOn(),a.addListeners(),this.homeBtn=a;var n=new cm.ScreenCaptureButton(cm.Assets.lib.SharedUISS,"camera-btn");n.set({ox:1,oy:0,rx:-64,ry:64,name:"screenshot_btn"}).center(),this.screenshotBtn=n;var o=new cjs.Container;o.set({ox:0,oy:.5,ry:-70,visible:!1,mouseEnabled:!1}),this.heightControls=o;var r=new cjs.Sprite(t,"height_adjust_buttons_panel");r.regs(0,.5),r.regX=35;var l=new cjs.Sprite(t,"height_up_btn");l.set({x:75,y:-105,name:"height_up_btn"}).hitbox().pointerOn();var h=new cjs.Sprite(t,"height_down_btn");h.set({x:68,y:9,name:"height_down_btn"}).hitbox().pointerOn(),l.on("click",(function(){})),h.on("click",(function(){})),o.addChild(r,l,h),o.set({rx:-o.getBounds().width}),this.heightDownBtn=h,this.heightUpBtn=l;var c=new cm.UIButton(cm.Assets.lib.SharedUISS,"next-btn");c.set({name:"next_btn",ox:.5,oy:1}).regs("center").pointerOn(),c.addListeners(),this.nextBtn=c;var d=new cm.UIButton(cm.Assets.lib.SharedUISS,"replay-btn");d.set({name:"replay_btn",ox:.5,oy:1}).regs("center").pointerOn(),d.addListeners(),this.replayBtn=d,this.startRaceBtn=new cm.RunTestButton(cm.Assets.lib.SharedUISS,null),this.startRaceBtn.set({ox:.5,oy:0,name:"start_race_btn"}),this.startRaceBtn.btn.name="start_race_btn",this.raceGuide=(new cjs.Container).set({ox:.5,oy:.5,rx:0,ry:0,visible:!1,scale:0,name:"race_guide",mouseChildren:!1,mouseEnabled:!1});var u=new cjs.Sprite(t,"race_guide_bg");function p(e){return springroll.SavedData.read("hasSeenTexture_"+e)?e+"_tool":"mystery_tool"}u.center(),this.raceGuideArrow=new cjs.Sprite(t,"tutorial_arrow").regs(.5,0),this.raceGuideArrow.set({y:-230}),this.raceGuideFinishLine=new cjs.Sprite(t,"race_guide_finishline").center(),this.raceGuideThingSprite=new cjs.Sprite(t,"race_guide_thing_head").center().set({name:"race_guide_thing_sprite"}),this.raceGuideCharSprite=new cjs.Sprite(t,"race_guide_nick_head").center().set({name:"race_guide_char_sprite"}),this.raceGuide.addChild(u,this.raceGuideFinishLine,this.raceGuideThingSprite,this.raceGuideCharSprite,this.raceGuideArrow),this.toolPalette=new cm.ToolPalette,this.toolPalette.set({ox:.5,oy:1,mouseEnabled:!1,visible:!1,ry:this.toolPalette.getBounds().height}),this.raceReplay=new cm.RaceReplay,this.raceReplay.set({ox:.5,oy:.5,scale:0,visible:!1}),this.microMaboodle=new cm.MicroMaboodle(app.bridge.gameNames.FACT_OR_FRICTION),this.microMaboodle.lensArmContainer.name="mmb_lens_arm",this.microMaboodle.addEventListener("mmb_use_start",this.toolPalette.toolButtonHint.bind(this.toolPalette,2500)),this.progressBar=new cm.ProgressBar,this.progressBar.set({regX:316,regY:8,ox:.5,oy:0,ry:0}),this.starParticles=new cm.StarParticles,this.starParticles.set({ox:.5,oy:.5}),this.starParticles.gravity.y=5e-4,this.starParticles.maxParticleLifetime=500,this.butterToolCursor=new cjs.Sprite(t,"butter_tool").regs("center").hitbox().set({name:"butter_tool",toolTipOffset:{x:-60,y:0}}),this.sandToolCursor=new cjs.Sprite(t,"sand_tool").regs("center").hitbox().set({name:"sand_tool",toolTipOffset:{x:-24,y:60}}),this.spongeToolCursor=new cjs.Sprite(t,p("sponge")).regs("center").hitbox().set({name:"sponge_tool",toolTipOffset:{x:-35,y:47}}),this.honeyToolCursor=new cjs.Sprite(t,p("honey")).regs("center").hitbox().set({name:"honey_tool",toolTipOffset:{x:-24,y:60}}),this.iceToolCursor=new cjs.Sprite(t,p("ice")).regs("center").hitbox().set({name:"ice_tool",toolTipOffset:{x:-35,y:47}}),this.oilToolCursor=new cjs.Sprite(t,p("oil")).regs("center").hitbox().set({name:"oil_tool",toolTipOffset:{x:-60,y:0}}),this.glueToolCursor=new cjs.Sprite(t,p("glue")).regs("center").hitbox().set({name:"glue_tool",toolTipOffset:{x:-24,y:60}}),this.rollersToolCursor=new cjs.Sprite(t,p("rollers")).regs("center").hitbox().set({name:"rollers_tool",toolTipOffset:{x:-35,y:47}}),this.rocksToolCursor=new cjs.Sprite(t,p("rocks")).regs("center").hitbox().set({name:"rocks_tool",toolTipOffset:{x:-24,y:60}}),this._componentsList=[this.blackOverlay,this.homeBtn,this.screenshotBtn,this.heightControls,this.nextBtn,this.replayBtn,this.startRaceBtn,this.raceGuide,this.toolPalette,this.microMaboodle,this.progressBar,this.starParticles,this.butterToolCursor,this.sandToolCursor,this.spongeToolCursor,this.honeyToolCursor,this.iceToolCursor,this.oilToolCursor,this.glueToolCursor,this.rollersToolCursor,this.rocksToolCursor],springroll.pbskids.easeljs.DwellTimer.create(this.homeBtn)}var t=e.prototype,i=0;t.createDwellTimers=function(){cm.LearningBridge.createDwellTimer(this.homeBtn,this.screenshotBtn,this.heightUpBtn,this.heightDownBtn,this.nextBtn,this.replayBtn,this.startRaceBtn.btn,this.raceGuide,this.microMaboodle.lensArmContainer)},t.destroyDwellTimers=function(){cm.LearningBridge.destroyDwellTimer(this.homeBtn,this.screenshotBtn,this.heightUpBtn,this.heightDownBtn,this.nextBtn,this.replayBtn,this.startRaceBtn.btn,this.raceGuide,this.microMaboodle.lensArmContainer)},t.setRaceGuide=function(e,t){switch(this.raceGuideCharSprite.gotoAndStop("race_guide_"+t+"_head"),e){case this.config.RACE_GOALS.PLAYER_WIN:this.raceGuideFinishLine.set({x:0,y:0}),this.raceGuideCharSprite.set({x:93,y:-6,scale:1}),this.raceGuideThingSprite.set({x:-90,y:-10,scale:1});break;case this.config.RACE_GOALS.TIE:this.raceGuideFinishLine.set({x:-40,y:-5}),this.raceGuideThingSprite.set({x:38,y:37,scale:.8}),this.raceGuideCharSprite.set({x:30,y:-44,scale:.8});break;case this.config.RACE_GOALS.PLAYER_LOSE:this.raceGuideFinishLine.set({x:0,y:0}),this.raceGuideThingSprite.set({x:91,y:-3,scale:1}),this.raceGuideCharSprite.set({x:-98,y:1,scale:1})}},t.showStartRaceButton=function(e){return!0===e?this.startRaceBtn.show():!1===e&&!0===this.startRaceBtn.visible?this.startRaceBtn.hide():void 0},t.showHeightControls=function(e,t){return!0===e?cjs.Tween.get(this.heightControls).wait(t||0).set({visible:!0}).to({rx:-30},300,cjs.Ease.quadIn).set({mouseEnabled:!0}):!1===e&&!0===this.heightControls.visible?cjs.Tween.get(this.heightControls).wait(t||0).set({mouseEnabled:!1}).to({rx:-this.heightControls.getBounds().width},300,cjs.Ease.quadIn).set({visible:!1}):void 0},t.showRaceGuide=function(e){return!0===e?(cjs.Tween.get(this.raceGuideArrow).set({visible:!0}).to({alpha:1},300,cjs.Ease.quadInOut),cjs.Tween.get(this.raceGuide).set({visible:!0}).to({scale:1},300,cjs.Ease.backOut)):!1===e&&!0===this.raceGuide.visible?(cjs.Tween.get(this.raceGuideArrow).to({alpha:0},300,cjs.Ease.quadInOut).set({visible:!1}),cjs.Tween.get(this.raceGuide).to({scale:0},300,cjs.Ease.backIn).set({visible:!1})):void 0},t.raceGuideToSide=function(){return cjs.Tween.get(this.raceGuideArrow).to({alpha:0},300,cjs.Ease.quadInOut).set({visible:!1}),cjs.Tween.get(this.raceGuide).set({scale:1}).to({ox:1,oy:0,rx:-195,ry:220,scale:.7},500,cjs.Ease.cubicInOut).set({mouseEnabled:!0}).call((function(){this.raceGuide.pointerOn()}),null,this)},t.succeedLevel=function(){this.showRaceGuide(!1),Math.random()<.5?app.voPlayer.play(["payoff-125","payoff-126","payoff-127"].random(),this.promptNextButton.bind(this)):this.promptNextButton();var e=this.progressBar.showProgress(cm.game.currentLevel,cm.game.currentLevel+1,cm.game.maxLevels);this.showBlackOverlay(!0),cjs.Tween.get(this.replayBtn).wait(e.duration).call(app.sound.play,["global-button-appear"],app.sound).set({visible:!0,rx:-100,ry:-100}).to({scale:1},300,cjs.Ease.backOut).set({mouseEnabled:!0}),cjs.Tween.get(this.nextBtn).wait(e.duration).set({visible:!0,rx:100,ry:-100}).to({scale:1},300,cjs.Ease.backOut).set({mouseEnabled:!0})},t.promptNextButton=function(){app.voPlayer.play(["fof-next-prompt"],function(){}.bind(this)),cjs.Tween.get(this.nextBtn).wait(750).call(cm.VisualCues.wiggle,[this.nextBtn],cm.VisualCues).wait(3500).call(cm.VisualCues.removeWiggle,[this.nextBtn],cm.VisualCues).wait(250).call(cm.VisualCues.wiggle,[this.replayBtn],cm.VisualCues).wait(3500).call(cm.VisualCues.removeWiggle,[this.replayBtn],cm.VisualCues)},t.cancelNextButtonPrompt=function(){app.sound.stop("fof-next-prompt"),cjs.Tween.removeTweens(this.nextBtn),cm.VisualCues.removeWiggle(this.replayBtn),cm.VisualCues.removeWiggle(this.nextBtn)},t.collectXP=function(e,t){cjs.Tween.get(this.replayBtn).to({scale:0},300,cjs.Ease.backIn).set({visible:!1}),cjs.Tween.get(this.nextBtn).to({scale:0},300,cjs.Ease.backIn).set({visible:!1});cjs.Tween.get(this.progressBar).to({ry:-72},200,cjs.Ease.backIn).set({visible:!1}).call((function(){this.starFanfare();var i="slide_complete";e&&(i=["slide_complete","slide_clever"]),app.xp.earnXP(i,t)}),null,this)},t.starFanfare=function(){var e=[[-308,-183],[-9,-233],[288,-168],[299,128],[-9,199],[-316,112]],t=0;app.sound.play("global-starburst",{volume:.5});for(var i=0,s=e.length;i<s;i++)cjs.Tween.get(this).wait(t).call(this.starParticles.makeBurst,[e[i][0],e[i][1],10,.4],this.starParticles),t+=200},t.succeedTutorialLevel=function(){return this.showBlackOverlay(!0),this.progressBar.showProgress(cm.game.currentLevel,cm.game.currentLevel+1,cm.game.maxLevels)},t.showBlackOverlay=function(e){return e?cjs.Tween.get(this.blackOverlay).set({visible:!0}).to({alpha:.5},400,cjs.Ease.quadInOut):cjs.Tween.get(this.blackOverlay,{override:!0}).to({alpha:0},400,cjs.Ease.quadInOut).set({visible:!1})},t.showTutorialRaceReplay=function(e,t,i,s){return app.sound.play("global-button-appear"),this.showBlackOverlay(!0),this.raceReplay.replayResult(e,t,i,s),this.raceReplay.show()},t.hideTutorialRaceReplay=function(){this.showBlackOverlay(!1),this.raceReplay.hide()},t.failLevel=function(){this.replayBtn.set({rx:0,ry:-100}),cjs.Tween.get(this.replayBtn).set({visible:!0}).to({scale:1},300,cjs.Ease.backOut).set({mouseEnabled:!0})},t.update=function(e){i+=e,!0===this.raceGuideArrow.visible&&(this.raceGuideArrow.regY=-10-10*Math.sin(.01*i))},t.destroy=function(){this.toolPalette.destroy(),this.microMaboodle.destroy(),this.cancelNextButtonPrompt()},t.resize=function(e,t){var i=cm.Device.notchSize*(1/cm.game.scale);this.heightControls.regX=-i},t.hideAllForScreenshot=function(){for(var e,t=0,i=this._componentsList.length;t<i;t++)(e=this._componentsList[t])._wasVisibleBeforeScreenshot=!0===e.visible,e.visible=!1},t.showAllAfterScreenshot=function(){for(var e,t=0,i=this._componentsList.length;t<i;t++)(e=this._componentsList[t]).visible=e._wasVisibleBeforeScreenshot},cm.GameUIController=e}(),function(){function e(e){this.Container_constructor(),this.moveSpeed=0,this.rotationSpeed=0,this.type=e,this.isPlaying=!1;var t=cm.Assets.lib.MainSS;this.background=new cjs.Sprite(t,"mm_screen_"+e),this.bgBounds=this.background.getBounds(),this.rollingBall=new cjs.Sprite(t,"mm_ball"),this.rollingBall.center(),this.rollingBall.x=this.bgBounds.width/2,this.rollingBall.y=this.bgBounds.height/2;var i=new cjs.Shape;i.graphics.drawRect(-this.bgBounds.width/2-5,-this.bgBounds.height/2-5,this.bgBounds.width-17,this.bgBounds.height-15),this.mask=i,this.mask.skewX=8,this.addChild(this.background,this.rollingBall,i);var s=this.setSpeeds(e);this.updateBallAnimation(s)}var t=cjs.extend(e,cjs.Container);t.setSpeeds=function(e){return app.config.gameplay.textureTimeComponents[e]},t.startBallAnimation=function(){this.rollingBall.x=-35,this.rollingBall.y=-35;var e=this.bgBounds.width+35,t=this.bgBounds.height+35;return cjs.Tween.get(this.rollingBall,{loop:-1,override:!0}).to({x:e,y:t},this.moveSpeed)},t.stopBallAnimation=function(){this.isPlaying=!1,cjs.Tween.removeAllTweens(this.rollingBall)},t.updateBallAnimation=function(e){switch(e){case 700:this.moveSpeed=5e3,this.rotationSpeed=50;break;case 350:this.moveSpeed=4e3,this.rotationSpeed=100;break;case-350:this.moveSpeed=2e3,this.rotationSpeed=200;break;case-700:this.moveSpeed=1e3,this.rotationSpeed=250;break;default:this.moveSpeed=3e3,this.rotationSpeed=150}},t.updateBackground=function(e){this.background.gotoAndStop("mm_screen_"+e)},t._tick=function(e){var t=.001*e.delta;this.rollingBall.rotation+=this.rotationSpeed*t,this.Container__tick(e)},cm.MagnifiedTexture=cjs.promote(e,"Container")}(),function(){function e(){this.Container_constructor(),this.barContainer=new cjs.Container;var e=cm.Assets.lib.MainSS,t=new cjs.Sprite(e,"progress_bar");this.barContainer.addChild(t);var i=new cjs.Sprite(e,"progress_bar_fill");i.set({x:-i.getBounds().width,y:-1}),this.barContainer.addChild(i),this.fill=i;var s=new cjs.Sprite(e,"progress_bar_border");this.barContainer.addChild(s);var a=i.getBounds();i.mask=new cjs.Shape,i.mask.graphics.f("#000").rr(1,0,a.width-1,a.height,a.height/2);var n,o=new cjs.Sprite(e,"progress_bar_slide");o.regs("center").set({x:i.getBounds().width}),this.barContainer.addChild(o);for(var r=5,l=0;l<8;l++)(n=new cjs.Sprite(e,"progress_bar_hash")).regs(.5,1).set({x:r,y:2,pulsed:!1}),r+=77,this.barContainer.addChild(n);var h=0;Object.defineProperty(this,"progress",{set:function(e){var t=this.fill.getBounds().width,i=e*t-t;this.fill.set({x:i}),h=e},get:function(){return h}}),this.barContainer.set({y:-72}),this.visible=!1,this.addChild(this.barContainer)}var t=cjs.extend(e,cjs.Container);t.hide=function(){return cjs.Tween.get(this.barContainer).to({y:-72},400,cjs.Ease.backIn)},t.showProgress=function(e,t,i){app.sound.play("global-prize-bar-lower");var s=cjs.Tween.get(this.barContainer).set({visible:!0},this).to({y:72},400,cjs.Ease.backOut);return this.progress=e/i,cjs.Tween.get(this).wait(s.duration).to({progress:t/i},600,cjs.Ease.quadInOut)},t._onActionsComplete=function(e){this.timeline=null},cm.ProgressBar=cjs.promote(e,"Container")}(),function(){function e(){this.Container_constructor();var e=cm.Assets.lib.MainSS,t=new cjs.Sprite(e,"racereplay_overlay_bg");t.center();var i=new cjs.Container,s=new cjs.Shape;s.graphics.f("#f00").dr(-285,-155,570,310),i.mask=s;var a=new cjs.Sprite(e,"racereplay_frame").center().set({x:-1,y:-2});this.slideyBoi=new cjs.Sprite(e,"racereplay_boy").center().set({x:-500,y:50}),this.slideyThing=new cjs.Sprite(e,"racereplay_thing1").center().set({x:-500,y:-70}),this.slideTexture=new cjs.Sprite(e,"racereplay_butter").set({x:-365,y:50,visible:!1}).regs(0,.5),i.addChild(this.slideTexture,this.slideyBoi,this.slideyThing),this.thingSlide=new cjs.Sprite(e,"racereplay_slide_4").set({x:-296,y:-120}),this.playerSlide=new cjs.Sprite(e,"racereplay_slide_1").set({x:-294,y:0}),this.addChild(t,this.thingSlide,this.playerSlide,i,a)}var t=cjs.extend(e,cjs.Container);t.show=function(){return cjs.Tween.get(this).set({visible:!0}).to({scale:1},400,cjs.Ease.backOut)},t.hide=function(){return cjs.Tween.removeTweens(this.slideyBoi),cjs.Tween.removeTweens(this.slideyThing),cjs.Tween.get(this).to({scale:0},400,cjs.Ease.backIn).set({visible:!1})},t.setThingSlideStype=function(e){this.thingSlide.gotoAndStop("racereplay_slide_"+e)},t.setSlideStyle=function(e){this.playerSlide.gotoAndStop("racereplay_slide_"+e)},t.replayResult=function(e,t,i,s){var a=0,n=0;switch(e){case"win":a=300;break;case"lose":n=300}this.slideyBoi.gotoAndStop("racereplay_"+("nick"===i?"boy":"girl")),this.slideyBoi.center(),this.slideyThing.gotoAndStop("racereplay_"+s),t?(this.slideTexture.visible=!0,this.slideTexture.gotoAndStop("racereplay_"+t),this.slideTexture.regs(0,.5)):this.slideTexture.visible=!1,this.slideyThing.set({x:-500}),this.slideyBoi.set({x:-500}),cjs.Tween.get(this.slideyThing,{loop:!0,override:!0}).wait(a).to({x:500},3e3,cjs.Ease.quadInOut).wait(n),cjs.Tween.get(this.slideyBoi,{loop:!0,override:!0}).wait(n).to({x:500},3e3,cjs.Ease.quadInOut).wait(a)},t.destroy=function(){cjs.Tween.removeTweens(this.slideyThing),cjs.Tween.removeTweens(this.slideyBoi),this.removeAllEventListeners()},t.toString=function(){return"["+this.constructor.name+"(name="+this.name+")]"},cm.RaceReplay=cjs.promote(e,"Container")}(),function(){function e(e){this.Container_constructor();var t=cm.Assets.lib.MainSS;this.slideStyleID=e||Math.range(1,8),this.setType(),this.slideBack=new cjs.Sprite(t,"slide_"+this.slideStyleID).set({name:"slideBack"}),this.slideFront=new cjs.Sprite(t,"slide_foreground_layer_"+this.slideStyleID).set({name:"slideFront"}),this.addChild(this.slideBack,this.slideFront),this.regs(0,1)}var t=cjs.extend(e,cjs.Container);t.setType=function(){switch(this.type="",this.slideStyleID){case 1:case 4:this.type="typeA";break;case 2:case 5:case 6:this.type="typeB";break;case 3:case 7:case 8:this.type="typeC";break;default:this.type="typeA"}},t.getSlideFront=function(){return this.slideFront},cm.RandomSlide=cjs.promote(e,"Container")}(),function(){var e={typeA:{1:{x:-65,y:80,rotation:8.5},2:{x:-59,y:61,rotation:15.5},3:{x:-35,y:49,rotation:22.5},4:{x:-5,y:45,rotation:28}},typeB:{1:{x:-65,y:91,rotation:8.5},2:{x:-59,y:71,rotation:15.5},3:{x:-35,y:59,rotation:22.5},4:{x:-5,y:55,rotation:28}},typeC:{1:{x:-68,y:89,rotation:8.5},2:{x:-59,y:70,rotation:15.5},3:{x:-35,y:58,rotation:22.5},4:{x:-5,y:54,rotation:28}}};function t(e,t,i,s,a){this.Container_constructor(),this.towerBlockHeight=62,this.towerBlockSpacing=4,this.blockHeight=e;var n=cm.Assets.lib.MainSS;this.base=new cjs.Sprite(n,t).set({name:"base"}),this.base.regs(.5,1),this.addChild(this.base);for(var o=this.getRandomBlocks(),r=i,l=0,h=e;l<h;l++){var c=new cm.Assets.lib.MainAnims[l%2==0?o[0]:o[1]];c.gotoAndStop("default"),c.set({regX:56,regY:86}),c.framerate=24,c.y=r;var d=new cjs.Sprite(n,"suess_"+(l+1));d.set({x:-17,y:r-this.towerBlockHeight/2}).center(),r-=this.towerBlockHeight+this.towerBlockSpacing,this.addChild(c,d)}this.slideTop=(new cjs.Container).set({name:"slideTop"}),this.addChild(this.slideTop),this.topBack=new cjs.Sprite(n,s),this.slideTop.addChild(this.topBack),this.topFront=new cjs.Sprite(n,a),this.slideTop.addChild(this.topFront),this.slideTop.regs(.5,1),this.slideTop.y=r,this.stackBounds=this.getBounds(),this.x+=this.stackBounds.width/2,this.slideContainer=(new cm.RandomSlide).set({name:"thingsSlide"}),this.setSlidePositionAndRotation();var u=new cjs.Shape;u.graphics.beginFill("#ff0000").drawRect(94,-500,2e3,2e3),this.slideContainer.mask=u,this.slideContainer.slideFront.mask=u,this.slideTop.addChildAt(this.slideContainer,1)}var i=cjs.extend(t,cjs.Container);i.setSlidePositionAndRotation=function(){var t=this.slideContainer.type;this.slideContainer.set(e[t][this.blockHeight])},i.getRandomBlocks=function(){var e=["PurpleBlockPop","BlueBlockPop","LimeBlockPop","GreenBlockPop"];return e.shuffle(),e},cm.ThingsSlide=cjs.promote(t,"Container")}(),function(){function e(){this.Container_constructor(),this.toolButtons=[];var e=cm.Assets.lib.MainSS,t=new cjs.Sprite(e,"tools_palette_bg");t.regs(1,1).set({ox:.5}),this.bg=t,this.tray=new cjs.Shape,i(this.tray),this.tray.set({ox:-.5,rx:5,oy:0,ry:-30}),this.toolButtonsContainer=new cjs.Container,this.toolButtonsContainer.set({ox:-.5,rx:5,oy:0,ry:-30}),this.addChild(t,this.tray,this.toolButtonsContainer),this.on("mousedown",this.interactionHandler,this),app.on("resize",this.resize.bind(this)),this.resize()}var t=cjs.extend(e,cjs.Container);t.setToolButtons=function(e){var t,i,s,a=cm.Assets.lib.MainSS;if(this.toolButtons.length>0){for(t=0,i=this.toolButtons.length;t<i;t++)this.toolButtonsContainer.removeChild(this.toolButtons[t]);this.toolButtons.length=0}for(t=0,i=e.length;t<i;t++){var n;n=springroll.SavedData.read("hasSeenTexture_"+e[t])?e[t]:"mystery",(s=new cjs.Sprite(a,n+"_tool_tray")).regs(.5,1).set({name:e[t]+"_tool",y:-20}).pointerOn(),this.toolButtonsContainer.addChild(s),this.toolButtons.push(s),cm.LearningBridge.createDwellTimer(s),s.on("click",(function(){}))}var o=new cjs.Sprite(a,"sponge_tool");o.center().set({name:"sponge_tool",scale:.9,rotation:10,y:-59}).pointerOn().hitbox(5),this.spongeToolButton=o,this.toolButtonsContainer.addChild(o),cm.LearningBridge.createDwellTimer(o),o.on("click",(function(){})),this._adjustToolButtonPositions()},t.getToolButtonInstance=function(e){return this.toolButtonsContainer.getChildByName(e)},t._adjustToolButtonPositions=function(){if(0!==this.toolButtons.length&&this.spongeToolButton){for(var e,t,a=this.toolButtons.length,n=.75*s(),o=n/a,r=o,l=0;l<a;l++)t=(e=this.toolButtons[l]).getBounds().width,e.x=r-o/2,r+=o,e.scale=t>o-20?(o-20)/t:1;this.spongeToolButton.set({x:n+(s()-n)/2}),i(this.tray,n)}},t.interactionHandler=function(e){switch(e.type){case"mousedown":if(e.target.name&&-1!==e.target.name.indexOf("_tool")){var t=e.target.name.split("_")[0];springroll.SavedData.read("hasSeenTexture_"+t)?(event=new cjs.Event("toolDrag"),event.tooltype=e.target.name,event.stageX=e.stageX,event.stageY=e.stageY,this.dispatchEvent(event),e.target.gotoAndStop(t+"_tool_tray_void")):(this.dispatchEvent("mysteryClicked"),app.voPlayer.play("fof-mmb-prompt-mystery"))}}},t.resetToolTray=function(e){var t=this.toolButtonsContainer.getChildByName(e+"_tool");springroll.SavedData.read("hasSeenTexture_"+e)?(t.gotoAndStop(e+"_tool_tray"),"sponge"!==e&&t.regs(.5,1)):t.gotoAndStop("mystery_tool_tray")},t.destroy=function(){for(var e=this.toolButtons.length;e<e;e++)cm.LearningBridge.destroyDwellTimer(this.toolButtons[e]);this.spongeToolButton&&cm.LearningBridge.destroyDwellTimer(this.spongeToolButton),this.removeAllEventListeners()},t.toString=function(){return"["+this.constructor.name+"(name="+this.name+")]"},t.resize=function(e,t){a(this.bg),a(this.tray),a(this.toolButtonsContainer),i(this.tray,.75*s()),this._adjustToolButtonPositions()},t.toolButtonHint=function(e){for(var t=0,i=this.toolButtons.length;t<i;t++)cm.VisualCues.wiggle(this.toolButtons[t]);e&&cjs.Tween.get(this).wait(e).call(this.endToolButtonHint,null,this)},t.endToolButtonHint=function(){for(var e=0,t=this.toolButtons.length;e<t;e++)cm.VisualCues.removeWiggle(this.toolButtons[e])};var i=function(e,t){var i=112;e.graphics.c().f("#ccc").rr(0,-i,t,i,8).f("#fff").rr(0,-i,t-4,108,8).ef().s("#000").ss(2).rr(0,-i,t,i,8),e.width=t,e.height=i,e.mouseEnabled=!1},s=function(){return app.display.width-155},a=function(e){var t=app.display.width,i=app.display.height;void 0!==e.ox&&(e.x=e.ox*t+(e.rx||0)),void 0!==e.oy&&(e.y=e.oy*i+(e.ry||0))};cm.ToolPalette=cjs.promote(e,"Container")}(),function(){var e={WALKING:"walking",CLIMBING:"climbing",IDLE:"idle",IDLE_WAVE:"idle_wave"};function t(e){this.Container_constructor(),this.isCharacter=!0,this.vel=new cm.Vector2,this.animPrefix="",this.follow=null,this.targetPt=null,this.onTargetComplete=null,this.currentMode=null,this.idleTimer=0,this.isUpHigh=!1,this.walkSpeed=i.baseSpeed,this._buildArt(e||cm.Assets.lib.CharacterAnimSS),this.gotoAnim("default")}var i=t;i.baseSpeed=100,i.MODES=e,i.showDebug=!1;var s=cjs.extend(t,cjs.Container);s._buildArt=function(e){},s._updateSpriteAnimation=function(e){},s._tick=function(t){if(this.x+=this.vel.x*t.delta,this.y+=this.vel.y*t.delta,0===this.vel.x&&0===this.vel.y||(this.currentMode=e.WALKING,this.scaleX=this.vel.x>0?1:-1),this.follow){var s=Math.distance(this,this.follow);this.walkSpeed=s<80?0:s<100?s/100*i.baseSpeed:i.baseSpeed}else this.walkSpeed=i.baseSpeed;if(this.targetPt){var a=Math.distance(this,this.targetPt),n=cm.Vector2.angleFromPoints(this,this.targetPt);a<10?(this.onTargetComplete&&this.onTargetComplete(),this.onTargetComplete=null,this.targetPt=null):(this.vel.x=Math.cos(n)*this.walkSpeed,this.vel.y=Math.sin(n)*this.walkSpeed)}else this.currentMode===e.WALKING&&(this.vel.x*=.8,this.vel.y*=.8,this.vel.length()<1&&(this.vel.x=this.vel.y=0,this.currentMode=e.IDLE));this.currentMode===e.IDLE?this.gotoAnim("idle"):this.currentMode===e.WALKING&&this.gotoAnim("walk"),this.Container__tick(t)},s.setMode=function(e){this.currentMode=e},s.setNewPath=function(e){this.targetPt=e[0],e.splice(0,1),e.length>0&&(this.path=e)},s.walkToPoint=function(e,t,i){this.onTargetComplete=i,this.targetPt=new cjs.Point(e,t)},s.gotoAnim=function(e){this.currentAnim!==e&&(this.currentAnim=e,this._updateSpriteAnimation(e))},s.toString=function(){return"["+this.constructor.name+"(name="+this.name+")]"},cm.Character=cjs.promote(t,"Container")}(),function(){var e={WALKING:"walking",CLIMBING:"climbing",IDLE:"idle",SLIDING:"sliding",IDLE_WAVE:"idle_wave"};function t(t,s){this.Container_constructor(),this.vel=new cm.Vector2,this.animPrefix=s,this.follow=null,this.targetPt=null,this.onTargetComplete=null,this.currentMode=e.IDLE,this.idleTimer=0,this.walkSpeed=i.baseSpeed,this._buildArt(t||cm.Assets.lib.CharacterAnimSS),this.gotoAnim("default")}var i=t;i.baseSpeed=100,i.MODES=e,i.showDebug=!1,i.getCharacterAnimPrefix=function(e,t){return"anim-"+e+"/"+t};var s=cjs.extend(t,cjs.Container);s._buildArt=function(e){},s._tick=function(t){if(this.x+=this.vel.x*t.delta,this.y+=this.vel.y*t.delta,0===this.vel.x&&0===this.vel.y||(this.currentMode=e.WALKING,this.scaleX=this.vel.x>0?1:-1),this.follow){var s=Math.distance(this,this.follow);this.walkSpeed=s<80?0:s<100?s/100*i.baseSpeed:i.baseSpeed}else this.walkSpeed=i.baseSpeed;if(this.targetPt){var a=Math.distance(this,this.targetPt),n=cm.Vector2.angleFromPoints(this,this.targetPt);a<10?(this.onTargetComplete&&this.onTargetComplete(),this.onTargetComplete=null,this.targetPt=null):(this.vel.x=Math.cos(n)*this.walkSpeed,this.vel.y=Math.sin(n)*this.walkSpeed)}else this.currentMode===e.WALKING&&(this.vel.x*=.8,this.vel.y*=.8,this.vel.length()<1&&(this.vel.x=this.vel.y=0,this.currentMode=e.IDLE));this.currentMode===e.IDLE?this.gotoAnim("idle"):this.currentMode===e.IDLE_WAVE?(this.idleTimer-=t.delta,this.idleTimer<=0&&(this.gotoAnim("wave"),this.idleTimer=Math.range(1e4,2e4))):this.currentMode===e.WALKING&&this.gotoAnim("walk"),this.Container__tick(t)},s.setMode=function(e){this.currentMode=e},s.idleWave=function(){this.currentMode=e.IDLE_WAVE,this.idleTimer=Math.range(1e4,2e4),this.gotoAnim("idle")},s.jumpToSlide=function(){this.currentMode=e.SLIDING,this.sprite.on("animationend",(function(e){this.sprite.stop(),this.sprite.framerate=24,e.remove()}),this),this.sprite.framerate=50,this.gotoAnim("jump_slide")},s.setNewPath=function(e){this.targetPt=e[0],e.splice(0,1),e.length>0&&(this.path=e)},s.walkToPoint=function(e,t,i){this.onTargetComplete=i,this.targetPt=new cjs.Point(e,t)},s.gotoAnim=function(e){this.currentAnim!==e&&(this.currentAnim=e,"wave"===e&&this.sprite.on("animationend",(function(e){this.gotoAnim("idle"),e.remove()}),this),this.sprite.gotoAndPlay(this.animPrefix+"/"+e))},s.toString=function(){return"["+this.constructor.name+"(name="+this.name+")]"},cm.SlidingCharacter=cjs.promote(t,"Container")}(),function(){function e(e){this.Character_constructor(e),this.walkSpeed=150}var t=cjs.extend(e,cm.Character);t._buildArt=function(e){this.head=new cjs.Sprite(e,"anim-catinthehat/default_Head"),this.body=new cjs.Sprite(e,"anim-catinthehat/default"),this.head.framerate=this.body.framerate=24,this.head.scaleX=this.body.scaleX=-1,this.addChild(this.body,this.head)},t._updateSpriteAnimation=function(e){"wave"===e&&this.body.on("animationend",(function(e){this.gotoAnim("idle"),e.remove()}),this),this.head.gotoAndPlay("anim-catinthehat/"+e+"_Head"),this.body.gotoAndPlay("anim-catinthehat/"+e)},cm.CatInTheHat=cjs.promote(e,"Character")}(),function(){function e(e){this.Sprite_constructor(e,"anim-fishbro/default"),this.framerate=24}var t=cjs.extend(e,cjs.Sprite);t.gotoAnim=function(e){"idle_jump"===e&&this.on("animationend",(function(e){this.gotoAnim("idle"),e.remove()}),this),this.gotoAndPlay("anim-fishbro/"+e)},t.setMode=function(){},cm.Fish=cjs.promote(e,"Sprite")}(),function(){function e(e){this.SlidingCharacter_constructor(e,"anim-nick")}cjs.extend(e,cm.SlidingCharacter)._buildArt=function(e){if(this.sprite=new cjs.Sprite(e,"anim-nick/default"),this.sprite.set({regX:40,regY:115}),this.sprite.framerate=24,this.addChild(this.sprite),cm.SlidingCharacter.showDebug){var t=new cjs.Shape;t.graphics.f("#f00").dc(0,0,3),this.addChild(t)}},cm.Nic=cjs.promote(e,"SlidingCharacter")}(),function(){function e(e){this.SlidingCharacter_constructor(e,"anim-sally")}cjs.extend(e,cm.SlidingCharacter)._buildArt=function(e){if(this.sprite=new cjs.Sprite(e,"anim-sally/default"),this.sprite.set({regX:40,regY:120}),this.sprite.framerate=24,this.addChild(this.sprite),cm.SlidingCharacter.showDebug){var t=new cjs.Shape;t.graphics.f("#f00").dc(0,0,3),this.addChild(t)}},cm.Sally=cjs.promote(e,"SlidingCharacter")}(),function(){function e(e){this.SlidingCharacter_constructor(e,"anim-thing1")}cjs.extend(e,cm.SlidingCharacter)._buildArt=function(e){if(this.sprite=new cjs.Sprite(e,"anim-thing1/default"),this.sprite.set({regX:32,regY:90}),this.sprite.framerate=24,this.addChild(this.sprite),cm.SlidingCharacter.showDebug){var t=new cjs.Shape;t.graphics.f("#f00").dc(0,0,3),this.addChild(t)}},cm.Thing1=cjs.promote(e,"SlidingCharacter")}(),function(){function e(e){this.SlidingCharacter_constructor(e,"anim-thing2")}cjs.extend(e,cm.SlidingCharacter)._buildArt=function(e){if(this.sprite=new cjs.Sprite(e,"anim-thing2/default"),this.sprite.set({regX:29,regY:90}),this.sprite.framerate=24,this.addChild(this.sprite),cm.SlidingCharacter.showDebug){var t=new cjs.Shape;t.graphics.f("#f00").dc(0,0,3),this.addChild(t)}},cm.Thing2=cjs.promote(e,"SlidingCharacter")}(),function(){function e(){this.View_constructor();var e=new cjs.Shape;e.graphics.beginLinearGradientFill(["#53b5f3","#fff"],[0,1],0,0,0,470).dr(0,0,app.maxWidth,470);var t=new cjs.Bitmap(cm.Assets.lib.end_bg);t.regs(.5,1);var i=new cm.UIButton(cm.Assets.lib.SharedUISS,"home-big-btn");i.center().set({ox:.5,oy:1,rx:-90,ry:-90,scale:0,name:"home_btn"}).pointerOn(),this.homeBtn=i;var s=new cm.UIButton(cm.Assets.lib.SharedUISS,"continue-btn");s.center().set({ox:.5,oy:1,rx:90,ry:-90,scale:0,name:"continue_btn"}).pointerOn(),this.continueBtn=s,this.cameraBtn=new cm.ScreenCaptureButton(cm.Assets.lib.SharedUISS,"camera-btn"),this.cameraBtn.set({ox:1,oy:0,rx:-64,ry:64,name:"screenshot_btn"}).center();var a=cm.Assets.lib.CharacterAnimSS;this.clouds=new cm.SceneryClouds({spritesheet:cm.Assets.lib.MainSS,spriteNames:["cloud1","cloud2","cloud3","cloud4"]}),this.cat=new cm.CatInTheHat(cm.Assets.lib.EndCharacterAnimSS).set({name:"cat"}),this.sally=new cm.Sally(a).set({name:"sally"}),this.nick=new cm.Nic(a).set({name:"nick"}),this.fish=new cm.Fish(cm.Assets.lib.EndCharacterAnimSS).set({name:"fish"}),this.starParticles=new cm.StarParticles,this.starParticles.gravity.y=5e-4,this.starParticles.maxParticleLifetime=500,this.charactersContainer=new cjs.Container,this.charactersContainer.addChild(this.cat.set({scale:.9,x:-79,y:-55}),this.sally.set({scaleX:-.98,scaleY:.98,x:16,y:183}),this.nick.set({scaleX:-1.1,scaleY:1.1,x:62,y:196}),this.fish.set({scale:.7,x:-352,y:14})),this.characters=[this.cat,this.sally,this.nick,this.fish],this.addChild(e,this.clouds.set({ox:.5,oy:.5}),t.set({ox:.5,oy:1}),this.charactersContainer.set({ox:.5,oy:.5}),this.starParticles.set({ox:.5,oy:.5}),s),app.bridge.isInWrapper?this.addChild(i,this.cameraBtn):this.continueBtn.rx=0,this.resize(app.display.width,app.display.height),this.on("click",(function(e){var t=this.starParticles.globalToLocal(e.stageX,e.stageY);this.starParticles.makeBurst(t.x,t.y,10,.5)}))}var t=createjs.extend(e,cm.View);t.start=function(){app.bridge.recordPlaythroughComplete(),Math.random()>.5?app.voPlayer.play(["fof-end-p1-nick","fof-end-p2-nick"],this.showEndScreenHint.bind(this)):app.voPlayer.play(["fof-end-p1-sally","fof-end-p2-sally"],this.showEndScreenHint.bind(this)),this.characterWaveLoop();for(var e=[[-391,-116],[-92,-202],[199,-234],[478,-160],[478,-160],[199,-234],[-92,-202],[-391,-116]],t=0,i=0,s=e.length;i<s;i++)cjs.Tween.get(this).wait(t).call(this.starParticles.makeBurst,[e[i][0],e[i][1],10,.4],this.starParticles),t+=200;cjs.Tween.get(this.homeBtn).to({scale:1},400,cjs.Ease.backOut),cjs.Tween.get(this.continueBtn).wait(100).to({scale:1},400,cjs.Ease.backOut).call(this.setActive,[!0],this)},t.resize=function(e,t){this.View_resize(e,t),this.cameraBtn&&(this.cameraBtn.x=e/2-64,this.cameraBtn.y=t/-2+64)},t.setActive=function(e){!0===e?(this.homeBtn.addListeners(),this.homeBtn.on("click",(function(e){e.remove(),app.voPlayer.stop(),app.bridge.goHome()})),this.continueBtn.addListeners(),this.continueBtn.on("click",(function(e){e.remove(),app.voPlayer.stop(),cm.LearningBridge.replayLevel(),cm.game.newGame()})),this.cameraBtn.addListeners(),cm.LearningBridge.createDwellTimer(this.homeBtn),cm.LearningBridge.createDwellTimer(this.continueBtn),cm.LearningBridge.createDwellTimer(this.cameraBtn)):!1===e&&(cm.LearningBridge.destroyDwellTimer(this.homeBtn),cm.LearningBridge.destroyDwellTimer(this.continueBtn),cm.LearningBridge.destroyDwellTimer(this.cameraBtn),this.continueBtn.removeAllEventListeners(),this.homeBtn.removeAllEventListeners(),this.cameraBtn.removeListeners())},t.showEndScreenHint=function(){var e=new cjs.Sprite(cm.Assets.lib.SharedUISS,"hint-arrow").set({regX:43,regY:126});cm.VisualCues.setContainer(this),cm.VisualCues.setArrow(e),cm.VisualCues.getArrow().pointAt(this.continueBtn),app.voPlayer.play(["endround-01","endround-02"].random())},t.characterWaveLoop=function(){for(var e,t=function(e){"fish"===e.name?e.gotoAnim("idle_jump"):e.gotoAnim("wave")},i=0,s=this.characters.length;i<s;i++)(e=this.characters[i]).setMode(null),cjs.Tween.get(e,{loop:!0}).wait(Math.range(200,600)).call(t,[e],this).wait(Math.range(5e3,7e3))},t.destroy=function(){this.View_destroy(),cjs.Tween.removeTweens(this);for(var e,t=0,i=this.characters.length;t<i;t++)e=this.characters[t],cjs.Tween.removeTweens(e)},cm.View.EndView=cjs.promote(e,"View")}(),function(){var e=[.3,.25,.17,.12],t={RACE_GOALS:{PLAYER_WIN:0,TIE:1,PLAYER_LOSE:2},heightRaceDurations:[2650,2300,1950,1600],textureTimeComponents:{butter:-350,sand:350,ice:-700,honey:700,oil:-350,glue:350,rollers:-700,rocks:700}};function i(){this.View_constructor();var e=app.display.width,i=app.display.height;this.levelCfg={textures:["butter"]},app.bridge.getFreeplayOptionsFor(app.options.pleID,this.onGetFreeplayOptions.bind(this)),this.platformElevationMax=-383,this.platformElevationMin=-250,this.slideMaxRotation=38,this.slideMinRotation=31,this.elevationIndex=2,this.elevationIncrement=Math.abs(this.platformElevationMax-this.platformElevationMin),this.rotationIncrement=this.slideMaxRotation-this.slideMinRotation,this.config=t,this.time=0,this.playerRaceDuration=0,this.slideYOffset=310,this.slideBaseDistance=554,this.playerPathPosition=0,this.playerHeightTimeComponent=1e3,this.playerSurfaceFrictionTimeComponent=0,this.useTool=this._useTool.bind(this),this.interactionHandler=this._interactionHandler.bind(this),this.slidingCharacterIsNick=!0,this.idlePromptManager=new cm.IdlePromptManager(app.display.stage),this.tutorialArrowOnMMB=this._tutorialArrowOnMMB.bind(this),this.handleMMBUseEvents=this._handleMMBUseEvents.bind(this),this.build(),this.resize(e,i)}var s=createjs.extend(i,cm.View.GameView);s.onGetFreeplayOptions=function(e){this.levelCfg.textures=this.levelCfg.textures.concat(e.data)},s.reset=function(){var e=this.towerTopContainer.getChildByName("slide_top_boy");e.set({x:106,y:204,rotation:0,scale:.9,visible:!0}),e.gotoAnim("idle");var t=this.towerTopContainer.getChildByName("slide_top_girl");t.set({x:50,y:209,rotation:0,scale:.9,visible:!0}),t.gotoAnim("idle"),this.slidingChild.set({x:0,y:0,rotation:0,visible:!1}),this.slide.addChild(this.slidingChild),this.ui.nextBtn.set({scale:0,visible:!1}),this.ui.replayBtn.set({scale:0,visible:!1}),this.setPlayerSlideTowerElevation(this.elevationIndex)},s.build=function(){var e,t,i=app.maxWidth,s=app.maxHeight,a=cm.Assets.lib.FreeplaySS,n=new cjs.Bitmap(cm.Assets.lib.FreeplayBG);n.regs("center").set({ox:.5,oy:.5}),this.worldContainer=new cjs.Container,this.worldContainer.set({ox:.5,oy:.5,name:"world-container"}),this.toolDragContainer=new cjs.Container;var o=new cjs.Sprite(a,"freeplay_slide");this.slideBG=o,this.slide=new cjs.Container,this.slide.addChild(o),this.playerTravelPath=new cm.CubicBezierCurve({x:30,y:60},{x:150,y:216},{x:355,y:215},{x:550,y:60}),this.slide.set({name:"slide",regX:518,regY:76,x:171,y:157,rotation:this.slideMaxRotation}),t=new cjs.Shape,this.slide.getTransformedBounds(),t.graphics.clear().f("#000").dr(0,this.platformElevationMax,app.maxWidth,app.display.height),this.slide.mask=t,this.slideTexture=new cjs.Sprite(a,"freeplay_sltexture_sand"),this.slideTexture.set({name:"slideTexture",visible:!1,x:14,y:46}),t=new cjs.Shape,e=this.slideTexture.getTransformedBounds(),t.graphics.clear().f("#f00").dr(this.slideTexture.x,this.slideTexture.y,e.width,e.height),this.slideTexture.mask=t,this.slide.addChild(this.slideTexture),this.slidingChild=new cjs.Sprite(cm.Assets.lib.FreeplayCharAnimsSS,cm.SlidingCharacter.getCharacterAnimPrefix("nick","sit_slide")),this.slidingChild.regs(.5,1).set({visible:!1,scale:.9}),this.slideTextureMaskSprite=new cjs.Sprite(cm.Assets.lib.SlideTexAnimsSS,"slide_texture_anims/butter_mask"),this.slideTextureMaskSprite.set({visible:!1,regX:42,regY:53,scale:1.2,framerate:24}),this.slideTextureMaskSprite.on("animationend",(function(e){this.visible&&this.gotoAndPlay(this.currentAnimation)})),this.slide.addChild(this.slideTextureMaskSprite);var r=new cjs.Sprite(a,"freeplay_slide_edge").set({x:2,y:52});this.slideFore=r,this.slide.addChild(r),this.towerTopContainer=new cjs.Container,this.towerTopContainer.set({x:-288,y:this.platformElevationMax});var l=new cm.Nic(cm.Assets.lib.FreeplayCharAnimsSS).set({name:"slide_top_boy",x:106,y:204,scale:.9}),h=new cm.Sally(cm.Assets.lib.FreeplayCharAnimsSS).set({name:"slide_top_girl",x:50,y:209,scale:.9});switch(cm.game.season){case"Spring":l.sprite.set({regX:30,regY:145}),h.sprite.set({regX:30,regY:150});break;case"Fall":l.sprite.set({regX:40,regY:155}),h.sprite.set({regX:40,regY:150});break;case"Winter":l.sprite.set({regX:30,regY:155}),h.sprite.set({regX:25,regY:155})}this.towerTopContainer.addChild(l,h);var c=new cjs.Sprite(a,"freeplay_slide_platform");c.set({x:-288,y:this.platformElevationMax}),this.slidePlatform=c,(t=new cjs.Shape).graphics.f("#000").dr(-app.display.width/2,-250,app.maxWidth,app.display.height-250),c.mask=t;var d=new cjs.Sprite(a,"freeplay_platform_ropeknot");d.set({x:-289,y:-255});var u=new cjs.Sprite(a,"freeplay_platform_ropeknot");u.set({scaleX:-1,x:-131,y:-254}),this.worldContainer.addChild(this.slide,this.slidePlatform,d,u,this.towerTopContainer),this.levelChangeOverlay=new cjs.Shape,this.levelChangeOverlay.set({visible:!1,alpha:0,ox:.5,oy:.5}),this.levelChangeOverlay.graphics.f("#fff").dr(-i/2,-s/2,i,s),this.ui=new cm.GameUIController(this.config),this.blackOverlay=this.ui.blackOverlay,this.homeBtn=this.ui.homeBtn,this.heightControls=this.ui.heightControls,this.raceGuide=this.ui.raceGuide,this.startRaceBtn=this.ui.startRaceBtn,this.toolPalette=this.ui.toolPalette,this.screenshotBtn=this.ui.screenshotBtn,this.nextBtn=this.ui.nextBtn,this.replayBtn=this.ui.replayBtn,this.progressBar=this.ui.progressBar,this.microMaboodle=this.ui.microMaboodle,this.homeBtn.mouseEnabled=!1;this.microMaboodle.addItemToMagnify(this.slideBG,new cm.MagnifiedTexture("butter"),{onMagnify:function(e){var t;switch(this.slideTexture.currentAnimation){case"freeplay_sltexture_butter":t="fof-mmb-inspect-butter",e.updateBackground("butter"),e.updateBallAnimation(this.config.textureTimeComponents.butter),this.unlockTexture("butter");break;case"freeplay_sltexture_sand":t="fof-mmb-inspect-sand",e.updateBackground("sand"),e.updateBallAnimation(this.config.textureTimeComponents.sand),this.unlockTexture("sand");break;case"freeplay_sltexture_ice":t="fof-mmb-inspect-ice",e.updateBackground("ice"),e.updateBallAnimation(this.config.textureTimeComponents.ice),this.unlockTexture("ice");break;case"freeplay_sltexture_honey":t="fof-mmb-inspect-honey",e.updateBackground("honey"),e.updateBallAnimation(this.config.textureTimeComponents.honey),this.unlockTexture("honey");break;case"freeplay_sltexture_oil":t="fof-mmb-inspect-oil",e.updateBackground("oil"),e.updateBallAnimation(this.config.textureTimeComponents.oil),this.unlockTexture("oil");break;case"freeplay_sltexture_glue":t="fof-mmb-inspect-glue",e.updateBackground("glue"),e.updateBallAnimation(this.config.textureTimeComponents.glue),this.unlockTexture("glue");break;case"freeplay_sltexture_rollers":t="fof-mmb-inspect-rollers",e.updateBackground("rollers"),e.updateBallAnimation(this.config.textureTimeComponents.rollers),this.unlockTexture("rollers");break;case"freeplay_sltexture_rocks":t="fof-mmb-inspect-rocks",e.updateBackground("rocks"),e.updateBallAnimation(this.config.textureTimeComponents.rocks),this.unlockTexture("rocks")}e.startBallAnimation(),!t||app.voPlayer.playing&&0!==app.voPlayer.currentVO.indexOf("fof-mmb-inspect-")||app.voPlayer.play(t);var i=this.slideTexture.currentAnimation.split("_")[2];cm.LearningBridge.mmbInspectObject(i,app.config.gameplay.textureTimeComponents[i],"")}.bind(this),canHit:function(){return!0===this.slideTexture.visible}.bind(this)}),this.pointerHandContainer=new cjs.Container,cm.VisualCues.setContainer(this.pointerHandContainer),this.idlePromptManager.addIdlePrompt("start_btn_prompt",1e4,function(){this.startRaceBtn.idleHint()}.bind(this)),this.idlePromptManager.enabled=!0,this.idlePromptManager.pause("start_btn_prompt"),this.tutorialArrow=new cjs.Sprite(cm.Assets.lib.MainSS,"tutorial_arrow"),this.tutorialArrow.set({visible:!1,alpha:0}).regs(.5,1),this.tutorialArrow.baseRegY=this.tutorialArrow.regY,this.addChild(n,this.worldContainer,this.ui.blackOverlay,this.ui.homeBtn,this.ui.screenshotBtn,this.ui.heightControls,this.ui.startRaceBtn,this.ui.toolPalette,this.ui.microMaboodle,this.ui.nextBtn,this.ui.replayBtn,this.pointerHandContainer,this.tutorialArrow,this.toolDragContainer,this.levelChangeOverlay),app.bridge.isInWrapper||this.removeChild(this.ui.screenshotBtn,this.ui.homeBtn)},s.handleHeightDownClick=function(){var e=this.elevationIndex;e>0&&(e--,this.startRaceBtn.mouseEnabled=!1,this.heightControls.mouseEnabled=!1,cjs.Tween.get(this,{onChange:function(e){this.setPlayerSlideTowerElevation(this.elevationIndex)}.bind(this)}).to({elevationIndex:e},300,cjs.Ease.cubicInOut).set({mouseEnabled:!0},this.heightControls).set({mouseEnabled:!0},this.startRaceBtn)),e<3&&(this.ui.heightUpBtn.alpha=1,this.ui.heightUpBtn.mouseEnabled=!0),0===e&&(this.ui.heightDownBtn.mouseEnabled=!1,this.ui.heightDownBtn.alpha=.5)},s.handleHeightUpClick=function(){var e=this.elevationIndex;e<3&&(e++,this.startRaceBtn.mouseEnabled=!1,this.heightControls.mouseEnabled=!1,cjs.Tween.get(this,{onChange:function(e){this.setPlayerSlideTowerElevation(this.elevationIndex)}.bind(this)}).to({elevationIndex:e},300,cjs.Ease.cubicInOut).set({mouseEnabled:!0},this.heightControls).set({mouseEnabled:!0},this.startRaceBtn)),e>0&&(this.ui.heightDownBtn.alpha=1,this.ui.heightDownBtn.mouseEnabled=!0),3===e&&(this.ui.heightUpBtn.mouseEnabled=!1,this.ui.heightUpBtn.alpha=.5)},s.setPlayerSlideTowerElevation=function(e){this.resetSlidingChildPosition(e);var t=Math.map(e,0,3,this.platformElevationMin,this.platformElevationMax),i=Math.map(e,0,3,this.slideMinRotation,this.slideMaxRotation);this.towerTopContainer.y=t,this.slidePlatform.y=t,this.slide.rotation=i,this.slide.mask.graphics.clear().f("#000").dr(-app.display.width/2,t+220,app.display.width,app.display.height),this.playerHeightTimeComponent=this.config.heightRaceDurations[e]},s.resetSlidingChildPosition=function(t){var i=e[t];this.playerPathPosition=i,this.slide.addChild(this.slidingChild),this.slide.addChild(this.slideFore),this.playerTravelPath.putObject(i,this.slidingChild),this.towerTopContainer.getChildByName("slide_top_boy").visible=!0,this.towerTopContainer.getChildByName("slide_top_girl").visible=!0},s._toolmove=function(e){this.activeFrictionTool.set({x:e.stageX,y:e.stageY});var t=this.slideBG.globalToLocal(e.stageX,e.stageY),i=this.activeFrictionTool.name;this.slideBG.hitTest(t.x,t.y)&&!this.isPaintingSlide&&(!1===this.slideTexture.visible&&0===this.playerSurfaceFrictionTimeComponent&&"sponge_tool"!==i?(this.isPaintingSlide=!0,this._slidePaintTargetX=0,this.slideTexture.visible=!0,this.slideTextureMaskSprite.set({visible:!0,alpha:1,scale:1.5}),"butter_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/butter_mask"),this.slideTexture.gotoAndStop("freeplay_sltexture_butter"),this.slideTexture.set({x:14,y:40,rotation:2.5,alpha:1})):"honey_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/honey_mask"),this.slideTexture.gotoAndStop("freeplay_sltexture_honey"),this.slideTexture.set({x:14,y:40,rotation:2.5,alpha:1})):"sand_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/sand_mask"),this.slideTexture.gotoAndStop("freeplay_sltexture_sand"),this.slideTexture.set({x:14,y:46,rotation:1.5,alpha:1})):"ice_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/ice_mask"),this.slideTexture.gotoAndStop("freeplay_sltexture_ice"),this.slideTexture.set({x:14,y:40,rotation:2.5,alpha:1})):"oil_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/oil_mask"),this.slideTexture.gotoAndStop("freeplay_sltexture_oil"),this.slideTexture.set({x:14,y:40,rotation:2.5,alpha:1})):"glue_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/glue_mask"),this.slideTexture.gotoAndStop("freeplay_sltexture_glue"),this.slideTexture.set({x:14,y:40,rotation:2.5,alpha:1})):"rollers_tool"===i?(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/rollers_mask"),this.slideTexture.gotoAndStop("freeplay_sltexture_rollers"),this.slideTexture.set({x:18,y:19,rotation:1,alpha:1})):"rocks_tool"===i&&(this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/rocks_mask"),this.slideTexture.gotoAndStop("freeplay_sltexture_rocks"),this.slideTexture.set({x:14,y:27,rotation:2,alpha:1}))):"sponge_tool"===i&&0!==this.playerSurfaceFrictionTimeComponent&&(this.isPaintingSlide=!0,this.slideTextureMaskSprite.gotoAndPlay("slide_texture_anims/sponge_mask"),this.slideTextureMaskSprite.set({visible:!0,alpha:1,scale:1.5}))),this._slidePaintPoint=t},s.start=function(){this.setActive(!0),springroll.SavedData.read("fof_hasSeenFreeplayIntro")?this.startGameplay():(this.startIntro(),springroll.SavedData.write("fof_hasSeenFreeplayIntro",!0))},s.startIntro=function(){app.voPlayer.play("factorfriction-050",this.introPart1.bind(this))},s.introPart1=function(){app.voPlayer.play("factorfriction-051",this.introPart2.bind(this)),this.showHeightControls(!0).call((function(){this.showTutorialArrow(!0,this.heightControls,30)}),null,this)},s.introPart2=function(){app.voPlayer.play("factorfriction-052",this._startGameplay.bind(this)),this.showToolPalette(!0).call((function(){cjs.Tween.get(this).call((function(){this.showTutorialArrow(!0,this.toolPalette.getToolButtonInstance("butter_tool"),-40,-40)}),null,this)}),null,this)},s.startGameplay=function(){this.showToolPalette(!0),this.showHeightControls(!0),this._startGameplay()},s._startGameplay=function(){this.idlePromptManager.addIdlePrompt("vo_prompt",25e3,(function(){app.voPlayer.play(["factorfriction-052.1","factorfriction-052.2"].random())})),this.homeBtn.mouseEnabled=!0,cjs.Tween.get(this).wait(1e3).call(this.showTutorialArrow,[!1],this),this.showStartRaceButton(!0),this.checkFirstTimeFreeplay()},s.checkFirstTimeFreeplay=function(){springroll.SavedData.read("firstTimeFOFFreeplay")||(springroll.SavedData.write("firstTimeFOFFreeplay",!0,!1),app.seeds.earnSeedPacket(app.seeds.seedTypes.CURIOUSITY,"Enter Slida-ma-zoo freeplay for the first time.",{voOptions:["garden-23","garden-25"]}))},s.showTutorialArrow=function(e,t,i,s){return!0===e?(t.parent.localToGlobal(t.x,t.y,this.tutorialArrow),this.tutorialArrow.x+=t.getTransformedBounds().width/2-t.regX/2+(i||0),this.tutorialArrow.y+=-t.getTransformedBounds().height/2-10+(s||0),cjs.Tween.get(this.tutorialArrow).set({visible:!0}).to({alpha:1},300,cjs.Ease.backOut)):!1===e&&!0===this.tutorialArrow.visible?cjs.Tween.get(this.tutorialArrow).to({alpha:0},300,cjs.Ease.backIn).set({visible:!1}):void 0},s.startRace=function(){var e;this.showHeightControls(!1),this.showToolPalette(!1),this.slidingCharacterIsNick?(this.slidingChild.gotoAndStop(cm.SlidingCharacter.getCharacterAnimPrefix("sally","sit_slide")),this.slidingCharacterIsNick=!1,e="girl"):(this.slidingChild.gotoAndStop(cm.SlidingCharacter.getCharacterAnimPrefix("nick","sit_slide")),this.slidingCharacterIsNick=!0,e="boy"),this.slidingChild.regs(.5,1),this.slidingChild.regY=170;var t=this.towerTopContainer.getChildByName("slide_top_"+e);t.jumpToSlide();var i=this.slidingChild.parent.localToLocal(this.slidingChild.x,this.slidingChild.y,t.parent),s=(i.y+t.y)/2-40;app.sound.play("slide-jump"),cjs.Tween.get(t).to({x:i.x},600),cjs.Tween.get(t).to({y:s},300,cjs.Ease.quadOut).to({y:i.y},300,cjs.Ease.quadIn).call(this._startRace,null,this),cjs.Tween.get(t).to({rotation:this.slidingChild.rotation+this.slidingChild.parent.rotation},600,cjs.Ease.quadInOut)},s._startRace=function(){var e=this._playerRaceUpdate.bind(this);this.slidingChild.visible=!0,this.towerTopContainer.getChildByName("slide_top_"+(this.slidingCharacterIsNick?"boy":"girl")).visible=!1;var t=this.getPlayerTime();cjs.Tween.get(this,{onChange:e,onComplete:this._playerRaceComplete.bind(this)}).to({playerPathPosition:1},t,cjs.Ease.quadOut)},s._playerRaceComplete=function(e){var t=[];if(this.slideTexture.visible)switch(this.slideTexture.currentAnimation){case"freeplay_sltexture_butter":t.push("factorfriction-054");break;case"freeplay_sltexture_sand":t.push("factorfriction-053");break;case"freeplay_sltexture_ice":t.push("factorfriction-054.1");break;case"freeplay_sltexture_honey":t.push("factorfriction-054.2");break;case"freeplay_sltexture_oil":t.push("factorfriction-054.6");break;case"freeplay_sltexture_glue":t.push("factorfriction-054.5");break;case"freeplay_sltexture_rollers":t.push("factorfriction-054.4");break;case"freeplay_sltexture_rocks":t.push("factorfriction-054.3")}t?(this.hasHeardReturnToBYVO||(this.hasHeardReturnToBYVO=!0,t.push("factorfriction-055"),cjs.Tween.get(this).wait(3e3).call((function(){app.bridge.isInWrapper&&cm.VisualCues.getPointer().showTap({target:this.ui.homeBtn})}))),app.voPlayer.play(t,this.raceComplete.bind(this))):this.raceComplete()},s.raceComplete=function(){cjs.Tween.get(this.levelChangeOverlay).set({visible:!0}).to({alpha:1},300,cjs.Ease.quadInOut).call(this.reset,null,this).to({alpha:0},300,cjs.Ease.quadInOut).set({visible:!1}).call((function(){this.showStartRaceButton(!0),this.showToolPalette(!0),this.showHeightControls(!0).set({mouseEnabled:!0},this.toolPalette)}),null,this)},s._playerRaceUpdate=function(e){this.playerTravelPath.putObject(this.playerPathPosition,this.slidingChild)},s.update=function(e){this.GameView_update(e),this.tutorialArrow.visible&&(this.tutorialArrow.regY=this.tutorialArrow.baseRegY+10*Math.sin(.004*this.time))},s.takeSlideSnapshot=function(){this.slidingChild.visible=!1,this.worldContainer.removeChild(this.towerTopContainer);var e=this.playerTravelPath,t={x:0,y:0},i={x:0,y:0},s={x:0,y:0},a={x:0,y:0};this.slide.localToLocal(e.startPoint.x,e.startPoint.y,this.worldContainer,t),this.slide.localToLocal(e.controlPoint1.x,e.controlPoint1.y,this.worldContainer,i),this.slide.localToLocal(e.controlPoint2.x,e.controlPoint2.y,this.worldContainer,s),this.slide.localToLocal(e.endPoint.x,e.endPoint.y,this.worldContainer,a);for(var n,o=new cm.CubicBezierCurve(t,i,s,a),r=[],l=0;l<=1;l+=.1)n=o.getPoint(l),r.push(n[0],n[1]);app.userData.write("_freeplay_slide_motionpath",r),app.userData.write("_freeplay_slide_time",this.getPlayerTime()),app.userData.write("_freeplay_slide_defaultTime",this.config.heightRaceDurations[0]);var h=this.worldContainer.getBounds(),c=-255-h.y;this.worldContainer.cache(h.x,h.y+c,h.width,h.height-c),app.userData.write("_freeplay_image",this.worldContainer.cacheCanvas.toDataURL());var d=(h=this.slidePlatform.getBounds()).height-80,u=this.slidePlatform.y-this.platformElevationMin+d;app.userData.write("_freeplay_height",u),this.worldContainer.addChild(this.towerTopContainer),this.worldContainer.uncache(),this.reset(),this.setPlayerSlideTowerElevation(this.elevationIndex)},s.destroy=function(){this.takeSlideSnapshot(),this.View_destroy()},cm.View.FreeplayView=cjs.promote(i,"GameView")}(),function(){function e(){this.View_constructor(),this.playBtnClick=this._playBtnClick.bind(this);var e=new cjs.Bitmap(cm.Assets.lib.title_bg).center().set({ox:.5,oy:.5});this.playBtn=new cm.UIButton(cm.Assets.lib.SharedUISS,"title-play-btn").center().set({ox:1,oy:1,rx:-138,ry:-125,name:"title_play_btn"}),this.addChild(e,this.playBtn),this.resize(app.display.width,app.display.height)}var t=createjs.extend(e,cm.View);t.setActive=function(e){!0===e?(this.playBtn.addListeners(),this.playBtn.addEventListener("click",this.playBtnClick),this.playBtn.addEventListener("pressup",(function(e){var t=cjs.Sound.activePlugin;t instanceof cjs.WebAudioPlugin&&"suspended"===t.context.state&&t.context.resume(),cjs.WebAudioPlugin.isSupported()&&cjs.WebAudioPlugin.playEmptySound()})),cm.LearningBridge.createDwellTimer(this.playBtn)):!1===e&&(cm.LearningBridge.destroyDwellTimer(this.playBtn),this.playBtn.removeAllEventListeners())},t._playBtnClick=function(e){e.remove(),cm.LearningBridge.clickPlay(),cm.game.startMainAssetsLoad()},t.destroy=function(){this.View_destroy()},cm.View.TitleView=cjs.promote(e,"View")}(),function(){function e(e){this.GameView_constructor(e),this.isTutorialView=!0}var t=createjs.extend(e,cm.View.GameView);t.setActive=function(e){this.GameView_setActive(e),this.heightControls.removeEventListener("click",this.interactionHandler)},t.reset=function(){this.slidingChild.set({x:0,y:0,rotation:0}),this.slidingThing.set({x:0,y:0,rotation:0}),this.thingsSlideContainer.addChild(this.slidingThing),this.nextBtn.set({scale:0,visible:!1}),this.replayBtn.set({scale:0,visible:!1}),this.progressBar.progress=cm.game.currentLevel/cm.game.maxLevels,this.raceGoalCondition=this.levelCfg.goal,this.slideBlockQuantity=this.levelCfg.playerSlideElevation,this.minSlideHeight=this.levelCfg.minSlideHeight,this.maxSlideHeight=this.levelCfg.maxSlideHeight,this.setThingSlideTowerElevation(this.levelCfg.thingSlideElevation),this.setPlayerSlideTowerElevation(this.levelCfg.playerSlideElevation)},t.build=function(){this.GameView_build(),this.config=app.config.tutorials,this.tutorialArrow=new cjs.Sprite(cm.Assets.lib.MainSS,"tutorial_arrow"),this.tutorialArrow.set({visible:!1,alpha:0}).regs(.5,1),this.tutorialArrow.baseRegY=this.tutorialArrow.regY,this.addChild(this.tutorialArrow)},t.start=function(){this.GameView_start(),app.pleAnalyticsHelper.trackTutorialBegin(this.makeLevelUID(this.levelCfg))},t.showTutorialArrow=function(e,t,i,s,a){return!0===e?(t.parent.localToGlobal(t.x,t.y,this.tutorialArrow),void 0!==a&&!0!==a||(this.tutorialArrow.x+=.5*t.getTransformedBounds().width-t.regX/2,this.tutorialArrow.y+=.5*-t.getTransformedBounds().height-10),this.tutorialArrow.x+=i||0,this.tutorialArrow.y+=s||0,cjs.Tween.get(this.tutorialArrow).set({visible:!0}).to({alpha:1},300,cjs.Ease.backOut)):!1===e&&!0===this.tutorialArrow.visible?cjs.Tween.get(this.tutorialArrow).to({alpha:0},300,cjs.Ease.backIn).set({visible:!1}):void 0},t.showToolPalette=function(e){return!0===e?(app.sound.play("global-tray-slide-up",{volume:.3}),this._setupToolPalette(),this.microMaboodle.show().set({mouseEnabled:!1},this.microMaboodle),cjs.Tween.get(this.toolPalette).set({visible:!0}).to({ry:0},300,cjs.Ease.quadIn).set({mouseEnabled:!0})):!1===e&&!0===this.toolPalette.visible?(this.microMaboodle.hide(),cjs.Tween.get(this.toolPalette).set({mouseEnabled:!1}).to({ry:this.toolPalette.getBounds().height},300,cjs.Ease.quadIn).set({visible:!1})):void 0},t._finishUsingTool=function(){this.GameView__finishUsingTool(),-500===this.playerSurfaceFrictionTimeComponent&&(this.toolPalette.removeEventListener("toolDrag",this.useTool),this.showStartRaceButton(!0).call((function(){cjs.Tween.get(this.startRaceBtn,{loop:!0}).to({scale:1.1},400,cjs.Ease.quadInOut).to({scale:1},400,cjs.Ease.quadInOut)}),null,this),this.startRaceBtn.on("click",(function(e){e.remove(),cjs.Tween.removeTweens(this.startRaceBtn),this.showStartRaceButton(!1),this.raceComplete=this.tutorialStep9.bind(this),this.startRace("nick","thing1")}),this))},t.update=function(e){this.GameView_update(e),this.tutorialArrow.visible&&(this.tutorialArrow.regY=this.tutorialArrow.baseRegY+10*Math.sin(.004*this.time))},t.onTutorialPhaseCompleted=function(){cm.LearningBridge.endRound(this.levelCfg.uri,this.prevFailureCount,this.time),app.pleAnalyticsHelper.trackTutorialComplete(this.makeLevelUID(this.levelCfg)),app.pleAnalyticsHelper.trackRoundEnd(this.makeLevelUID(this.levelCfg)),app.pleAnalyticsHelper.trackLevelComplete(this.makeLevelUID(this.levelCfg)),this.ui.succeedTutorialLevel().wait(800).call(this.collectTutorialXP,null,this)},t.collectTutorialXP=function(){app.bridge.isInWrapper?this.ui.collectXP(this.cleverSuccess,(function(){cjs.Tween.get({}).wait(500).call((function(){cm.game.advanceTutorial()}))})):cm.game.advanceTutorial()},cm.View.TutorialGameView=cjs.promote(e,"GameView")}(),function(){function e(e){this.GameView_constructor(e)}var t=createjs.extend(e,cm.View.GameView);t._interactionHandler=function(e){switch(e.type){case"click":switch(e.target.name){case"height_down_btn":this.handleHeightDownClick(e);break;case"height_up_btn":this.handleHeightUpClick(e);break;case"start_race":this.startRace("nick","thing1"),this.showStartRaceButton(!1);break;case"replay_btn":this.mouseEnabled=!1,cm.LearningBridge.replayRound(),cm.ViewControl.gotoView("TutorialLevel",{levelCfg:this.levelCfg});break;case"next_btn":cm.LearningBridge.gotoNextRound(),this.mouseEnabled=!1,cm.game.advanceTutorial();break;case"home_btn":app.bridge.goHome();break;case"race_guide":this._playRaceHint()}break;case"mousedown":switch(e.target.name){case"height_down_btn":e.target.gotoAndStop("height_down_btn_pressed");break;case"height_up_btn":e.target.gotoAndStop("height_up_btn_pressed");break;case"race_guide":cjs.Tween.get(e.target).to({scale:.6},150,cjs.Ease.quadInOut)}break;case"pressup":switch(e.target.name){case"height_down_btn":e.target.gotoAndStop("height_down_btn");break;case"height_up_btn":e.target.gotoAndStop("height_up_btn");break;case"race_guide":cjs.Tween.get(e.target).to({scale:.7},150,cjs.Ease.backOut)}}},t.succeedLevel=function(e){cm.LearningBridge.endRound(this.levelCfg.uri,this.prevFailureCount,this.time),app.pleAnalyticsHelper.trackTutorialComplete(this.makeLevelUID(this.levelCfg)),app.pleAnalyticsHelper.trackRoundEnd(this.makeLevelUID(this.levelCfg)),app.pleAnalyticsHelper.trackLevelComplete(this.makeLevelUID(this.levelCfg)),app.bridge.isInWrapper?this.ui.succeedTutorialLevel().wait(800).call((function(){this.ui.collectXP(this.cleverSuccess,(function(){cjs.Tween.get({}).wait(500).call((function(){cm.game.advanceTutorial()}))}))}),null,this):this.ui.succeedTutorialLevel().wait(800).call(cm.game.advanceTutorial,null,cm.game)},t.raceComplete=function(e){var t=this.getThingTime(),i=this.getPlayerTime(),s=this.selectedRaceCharacterName,a=null;if(!0===this.slideTexture.visible&&(a=this.slideTexture.currentAnimation.replace("slidetexture_","")),this.raceGoalCondition===this.config.RACE_GOALS.PLAYER_LOSE)t<i?(this.ui.starFanfare(),this.ui.showTutorialRaceReplay("lose",a,this.selectedRaceCharacterName,this.selectedRaceThingName),app.voPlayer.play("fof-success-slower-generic-"+s,this.succeedLevel.bind(this,"lose"))):app.voPlayer.play(["fof-failure-slower-generic","fof-failure-fq-generic-slower"],function(){this.mouseEnabled=!1,cm.ViewControl.gotoView("TutorialLevel",{levelCfg:this.levelCfg})}.bind(this));else if(this.raceGoalCondition===this.config.RACE_GOALS.TIE)if(t===i)this.ui.starFanfare(),this.ui.showTutorialRaceReplay("tie",a,this.selectedRaceCharacterName,this.selectedRaceThingName),app.voPlayer.play("fof-success-tie-generic-"+s,this.succeedLevel.bind(this,"tie"));else{var n=["fof-failure-tie-generic"];t<i?n.push("fof-failure-fq-generic-faster"):t>i&&n.push("fof-failure-fq-generic-slower"),app.voPlayer.play(n,function(){this.mouseEnabled=!1,cm.ViewControl.gotoView("TutorialLevel",{levelCfg:this.levelCfg})}.bind(this))}else this.raceGoalCondition===this.config.RACE_GOALS.PLAYER_WIN&&(t>i?(this.ui.starFanfare(),this.ui.showTutorialRaceReplay("win",a,this.selectedRaceCharacterName,this.selectedRaceThingName),app.voPlayer.play("fof-success-faster-generic-"+s,this.succeedLevel.bind(this,"win"))):app.voPlayer.play(["fof-failure-faster-generic","fof-failure-fq-generic-faster"],function(){this.mouseEnabled=!1,cm.ViewControl.gotoView("TutorialLevel",{levelCfg:this.levelCfg})}.bind(this)))},cm.View.TutorialLevelGameView=cjs.promote(e,"GameView")}(),function(){function e(e){this.TutorialGameView_constructor(e)}var t=createjs.extend(e,cm.View.TutorialGameView);t.build=function(){this.TutorialGameView_build(),this.thingsSlideContainer.visible=!1},t._playerRaceComplete=function(e){var t=this.slidingChild,i=this.slide.localToLocal(this.slidingChild.x,this.slidingChild.y,this.slideContainer);t.set({x:i.x,y:i.y,rotation:this.slide.rotation}),this.slideContainer.addChild(t),cjs.Tween.get(t).to({x:t.x+110,rotation:0},.2*this.getPlayerTime(),cjs.Ease.quadOut),this.raceComplete()},t._thingRaceComplete=function(e){},t.startGameplay=function(){this.levelCfg;this.ui.setRaceGuide(this.raceGoalCondition,"nick"),this.playInstructionVO(["fof-tutorial-intro"],this.tutorialStep1.bind(this))},t.tutorialStep1=function(){this.playInstructionVO("factorfriction-002"),this.showStartRaceButton(!0).call((function(){this.startRaceBtn.idleHint()}),null,this),this.raceComplete=this.tutorialStep2.bind(this)},t.tutorialStep2=function(){this.playInstructionVO("fof-tutorial-height-pt1",function(){cjs.Tween.get(this.levelChangeOverlay).wait(800).set({visible:!0}).to({alpha:1},300,cjs.Ease.quadInOut).call(this.setPlayerSlideTowerElevation,[this.slideBlockQuantity],this).to({alpha:0},300,cjs.Ease.quadInOut).set({visible:!1}).call(this._tutorialStep2,null,this)}.bind(this))},t._tutorialStep2=function(){var e=function(e){switch(cjs.Tween.get(this.heightControls,{override:!0}).to({rotation:0},150,cjs.Ease.quadIn),e.target.name){case"height_down_btn":this.slideBlockQuantity>this.minSlideHeight&&this.lowerSlide(e),this.showStartRaceButton(!0),this.showHeightControls(!1),this.raceComplete=this.tutorialStep3.bind(this,"slower"),e.remove();break;case"height_up_btn":this.slideBlockQuantity<this.maxSlideHeight&&this.raiseSlide(e),this.showStartRaceButton(!0),this.showHeightControls(!1),this.raceComplete=this.tutorialStep3.bind(this,"faster"),e.remove()}this.checkHeightButtonState()}.bind(this);this.playInstructionVO(["fof-tutorial-height-pt2"],function(){this.heightControls.addEventListener("click",e)}.bind(this)),this.ui.showHeightControls(!0,4500).call((function(){cjs.Tween.get(this.heightControls,{loop:!0}).to({rotation:3},300,cjs.Ease.quadInOut).to({rotation:-3},300,cjs.Ease.quadInOut).to({rotation:3},300,cjs.Ease.quadInOut).to({rotation:-3},300,cjs.Ease.quadInOut).to({rotation:0},150,cjs.Ease.quadInOut).call((function(){cm.VisualCues.getPointer().showTap({target:this.heightControls,offset:{x:130,y:-40}})}),null,this).wait(3e3)}),null,this)},t.tutorialStep3=function(e){var t;"slower"===e?t="fof-tutorial-height-pt5":"faster"===e&&(t="fof-tutorial-height-pt4");var i=function(t){switch(cjs.Tween.get(this.heightControls,{override:!0}).to({rotation:0},150,cjs.Ease.quadIn),t.target.name){case"height_down_btn":if("slower"===e)return;this.canMoveHeightDown()&&this.lowerSlide(t),this.showStartRaceButton(!0),this.showHeightControls(!1),this.raceComplete=this.tutorialStep4.bind(this,"slower"),t.remove();break;case"height_up_btn":if("faster"===e)return;this.canMoveHeightUp()&&this.raiseSlide(t),this.showStartRaceButton(!0),this.showHeightControls(!1),this.raceComplete=this.tutorialStep4.bind(this,"faster"),t.remove()}this.checkHeightButtonState()}.bind(this);this.playInstructionVO([t,"fof-tutorial-height-pt6"],function(){cjs.Tween.get(this.levelChangeOverlay).set({visible:!0}).to({alpha:1},300,cjs.Ease.quadInOut).call(function(){var e=this.levelCfg;this.raceGoalCondition=e.goal,this.slideBlockQuantity=e.playerSlideElevation,this.setThingSlideTowerElevation(e.thingSlideElevation),this.setPlayerSlideTowerElevation(e.playerSlideElevation)}.bind(this)).to({alpha:0},300,cjs.Ease.quadInOut).set({visible:!1}).call((function(){this.checkHeightButtonState(),"slower"===e?this.ui.heightDownBtn.alpha=.5:"faster"===e&&(this.ui.heightUpBtn.alpha=.5),this.showHeightControls(!0).call((function(){this.heightControls.addEventListener("click",i)}),null,this)}),null,this)}.bind(this))},t.tutorialStep4=function(e){var t;"slower"===e?t="fof-tutorial-height-pt5":"faster"===e&&(t="fof-tutorial-height-pt4"),this.playInstructionVO([t,"fof-tutorial-height-pt7"],this.onTutorialPhaseCompleted.bind(this))},cm.View.TutorialPart1GameView=cjs.promote(e,"TutorialGameView")}(),function(){function e(e){this.TutorialGameView_constructor(e),this.selectedRaceThingName="thing1"}var t=createjs.extend(e,cm.View.TutorialGameView);t.setActive=function(e){this.TutorialGameView_setActive(e),this.startRaceBtn.clickHandler=function(e){}},t.startGameplay=function(){this.levelCfg;this.ui.setRaceGuide(this.raceGoalCondition,"nick"),this.thing1.gotoAnim("wave"),this.playInstructionVO(["fof-tutorial-win-p1"],this.tutorialStep1.bind(this)),cjs.Tween.get(this).wait(9500).call((function(){this.showRaceGuide(!0).wait(1500).call(this.ui.raceGuideToSide,null,this.ui)}),null,this)},t.tutorialStep1=function(){var e=cm.VisualCues.getPointer();this.showTutorialArrow(!1),this.showStartRaceButton(!0).call(e.showTap,[{target:this.startRaceBtn.children[1]}],e),this.startRaceBtn.on("click",(function(e){e.remove(),cjs.Tween.removeTweens(this.startRaceBtn),this.showStartRaceButton(!1),this.raceComplete=this.tutorialStep2.bind(this),this.startRace("nick","thing1")}),this)},t.tutorialStep2=function(){this.ui.showTutorialRaceReplay("lose",null,this.selectedRaceCharacterName,this.selectedRaceThingName),this.playIncorrectFeedbackVO(["fof-tutorial-win-p2","fof-tutorial-win-p3"],this.tutorialStep3.bind(this))},t.tutorialStep3=function(){this.ui.hideTutorialRaceReplay(),cjs.Tween.get(this.levelChangeOverlay).wait(700).set({visible:!0}).to({alpha:1},300,cjs.Ease.quadInOut).call((function(){var e=this.levelCfg;this.setThingSlideTowerElevation(e.thingSlideElevation),this.setPlayerSlideTowerElevation(e.playerSlideElevation)}),null,this).to({alpha:0},300,cjs.Ease.quadInOut).set({visible:!1}).call(this._tutorialStep3,null,this)},t._tutorialStep3=function(){var e=this.levelCfg,t=function(t){switch(t.target.name){case"height_down_btn":this.canMoveHeightDown()&&this.lowerSlide(t);break;case"height_up_btn":this.canMoveHeightUp()&&this.raiseSlide(t),this.slideBlockQuantity>e.thingSlideElevation&&(this.showHeightControls(!1),this.heightControls.removeAllEventListeners(),this.playInstructionVO("fof-tutorial-win-p4",this.tutorialStep4.bind(this)))}this.checkHeightButtonState()}.bind(this);this.showHeightControls(!0).call((function(){this.heightControls.addEventListener("click",t)}),null,this)},t.tutorialStep4=function(){this.showStartRaceButton(!0),this.startRaceBtn.on("click",(function(e){e.remove(),cjs.Tween.removeTweens(this.startRaceBtn),this.showStartRaceButton(!1),this.raceComplete=this.tutorialStep5.bind(this),this.startRace("nick","thing1")}),this)},t.tutorialStep5=function(){this.ui.starFanfare(),this.ui.showTutorialRaceReplay("win",null,this.selectedRaceCharacterName,this.selectedRaceThingName),this.playCorrectFeedbackVO("fof-tutorial-win-p5",this.onTutorialPhaseCompleted.bind(this))},cm.View.TutorialPart2GameView=cjs.promote(e,"TutorialGameView")}(),function(){function e(e){this.TutorialGameView_constructor(e),this.selectedRaceThingName="thing2",this.heightControlsCallback=function(e){switch(e.target.name){case"height_down_btn":this.canMoveHeightDown()&&this.lowerSlide(e),this.showStartRaceButton(!0),this.raceComplete=this.tutorialStep2.bind(this);break;case"height_up_btn":this.canMoveHeightUp()&&this.raiseSlide(e),this.showStartRaceButton(!0),this.raceComplete=this.tutorialStep2.bind(this)}this.checkHeightButtonState()}.bind(this)}var t=createjs.extend(e,cm.View.TutorialGameView);t.startGameplay=function(){this.levelCfg;this.ui.setRaceGuide(this.raceGoalCondition,"nick"),this.thing2.gotoAnim("wave"),this.playInstructionVO(["fof-tutorial-lose-p1"],this.tutorialStep1.bind(this)),cjs.Tween.get(this).wait(6e3).call((function(){this.showRaceGuide(!0).wait(1500).call(this.ui.raceGuideToSide,null,this.ui)}),null,this)},t.tutorialStep1=function(){this.showHeightControls(!0).call((function(){this.heightControls.addEventListener("click",this.heightControlsCallback)}),null,this)},t.tutorialStep2=function(){var e=this.getThingTime(),t=this.getPlayerTime();if(this.heightControls.removeEventListener("click",this.heightControlsCallback),e<t)this.ui.starFanfare(),this.ui.showTutorialRaceReplay("lose",null,this.selectedRaceCharacterName,this.selectedRaceThingName),this.playCorrectFeedbackVO("fof-tutorial-lose-p3",this.onTutorialPhaseCompleted.bind(this));else if(e>t||e===t){var i;i=e>t?"win":"tie",this.ui.showTutorialRaceReplay(i,null,this.selectedRaceCharacterName,this.selectedRaceThingName),this.playInstructionVO("fof-tutorial-lose-p4",function(){this.ui.hideTutorialRaceReplay(),cjs.Tween.get(this.levelChangeOverlay).set({visible:!0}).to({alpha:1},300,cjs.Ease.quadInOut).call((function(){this.raceGoalCondition=this.levelCfg.goal,this.slideBlockQuantity=this.levelCfg.playerSlideElevation,this.setThingSlideTowerElevation(this.levelCfg.thingSlideElevation),this.setPlayerSlideTowerElevation(this.levelCfg.playerSlideElevation)}),null,this).to({alpha:0},300,cjs.Ease.quadInOut).call(this.tutorialStep1,null,this)}.bind(this))}},cm.View.TutorialPart3GameView=cjs.promote(e,"TutorialGameView")}(),function(){function e(e){this.TutorialGameView_constructor(e),this.heightControlsCallback=function(e){switch(e.target.name){case"height_down_btn":this.canMoveHeightDown()&&this.lowerSlide(e),this.showStartRaceButton(!0),this.raceComplete=this.tutorialStep2.bind(this);break;case"height_up_btn":this.canMoveHeightUp()&&this.raiseSlide(e),this.showStartRaceButton(!0),this.raceComplete=this.tutorialStep2.bind(this)}this.checkHeightButtonState()}.bind(this)}var t=createjs.extend(e,cm.View.TutorialGameView);t.startGameplay=function(){this.levelCfg;this.ui.setRaceGuide(this.raceGoalCondition,"nick"),this.playInstructionVO(["fof-tutorial-tie-p1"],this.tutorialStep1.bind(this)),cjs.Tween.get(this).wait(6e3).call((function(){this.showRaceGuide(!0).wait(1500).call(this.ui.raceGuideToSide,null,this.ui)}),null,this)},t.tutorialStep1=function(){this.showHeightControls(!0).call((function(){this.heightControls.addEventListener("click",this.heightControlsCallback)}),null,this)},t.tutorialStep2=function(){var e,t=this.getThingTime(),i=this.getPlayerTime();(this.heightControls.removeEventListener("click",this.heightControlsCallback),t===i)?(this.ui.starFanfare(),this.ui.showTutorialRaceReplay("tie",null,this.selectedRaceCharacterName,this.selectedRaceThingName),this.playCorrectFeedbackVO("fof-success-tie-generic-nick",this.onTutorialPhaseCompleted.bind(this))):(t>i?e="win":t<i&&(e="lose"),this.ui.showTutorialRaceReplay(e,null,this.selectedRaceCharacterName,this.selectedRaceThingName),this.playIncorrectFeedbackVO("fof-failure-tie-generic",function(){this.ui.hideTutorialRaceReplay(),cjs.Tween.get(this.levelChangeOverlay).set({visible:!0}).to({alpha:1},300,cjs.Ease.quadInOut).call((function(){this.raceGoalCondition=this.levelCfg.goal,this.slideBlockQuantity=this.levelCfg.playerSlideElevation,this.setThingSlideTowerElevation(this.levelCfg.thingSlideElevation),this.setPlayerSlideTowerElevation(this.levelCfg.playerSlideElevation)}),null,this).to({alpha:0},300,cjs.Ease.quadInOut).call(this.tutorialStep1,null,this)}.bind(this)))},cm.View.TutorialPart4GameView=cjs.promote(e,"TutorialGameView")}(),function(){var e="pick_another_prompt";function t(e){this.TutorialGameView_constructor(e),this.hasPlacedSand=!1,this.hasPlacedButter=!1,this.cancelPrompt=this._cancelPrompt.bind(this)}var i=createjs.extend(t,cm.View.TutorialGameView);i.startGameplay=function(){this.levelCfg;this.selectedRaceCharacterName="sally",this.ui.setRaceGuide(this.raceGoalCondition,"sally"),this.toolPalette.setToolButtons(this.levelCfg.textures),this.playInstructionVO(["fof-tutorial-texture-p1"],this.introduceMicromaboodle_pt1.bind(this)),this.toolPalette.addEventListener("toolDrag",this.useTool),this.toolPalette.addEventListener("toolDrag",this.cancelPrompt),this.showToolPalette(!0),cjs.Tween.get(this).wait(1e3).call((function(){this.showTutorialArrow(!0,this.toolPalette.getToolButtonInstance("butter_tool"),-40,-50)}),null,this).wait(1500).call((function(){this.showTutorialArrow(!0,this.toolPalette.getToolButtonInstance("sand_tool"),-40,-50)}),null,this)},i.tutorialStep1=function(){this.playInstructionVO("fof-tutorial-texture-p2"),this.microMaboodle.mouseEnabled=!0,this.toolPalette.mouseEnabled=!0,this.simulatingMicromaboodle=!1,this.isPart2&&this.idlePromptManager.addIdlePrompt(e,15e3,function(){(this.hasPlacedSand&&this.playerSurfaceFrictionTimeComponent>0||this.hasPlacedButter&&this.playerSurfaceFrictionTimeComponent<0)&&(this.playInstructionVO("factorfriction-009"),cjs.Tween.get(this).wait(300).call((function(){this.showTutorialArrow(!0,this.toolPalette.getToolButtonInstance("sponge_tool"),-40)}),null,this).wait(2500).call(this.showTutorialArrow,[!1],this))}.bind(this))},i._cancelPrompt=function(t){this.idlePromptManager.cancel(e)},i.tutorialStep2=function(){var e=this.getThingTime(),t=this.getPlayerTime(),i=null;!0===this.slideTexture.visible&&(i=this.slideTexture.currentAnimation.replace("slidetexture_","")),t<e?(this.playCorrectFeedbackVO(["fof-tutorial-texture-p3-butter"],this.tutorialStep3.bind(this,"win")),this.ui.showTutorialRaceReplay("win",i,this.selectedRaceCharacterName,this.selectedRaceThingName),this.hasPlacedButter=!0):t>e&&(this.playCorrectFeedbackVO(["fof-tutorial-texture-p3-sand"],this.tutorialStep3.bind(this,"lose")),this.ui.showTutorialRaceReplay("lose",i,this.selectedRaceCharacterName,this.selectedRaceThingName),this.hasPlacedSand=!0),this.isPart2=!0},i.tutorialStep3=function(e){!0===this.hasPlacedButter&&!0===this.hasPlacedSand?this.onTutorialPhaseCompleted():(this.ui.hideTutorialRaceReplay(),cjs.Tween.get(this.levelChangeOverlay).wait(400).set({visible:!0}).to({alpha:1},200,cjs.Ease.quadInOut).call(this._tutorialStep3,null,this))},i._tutorialStep3=function(){var e=this.levelCfg;this.raceGoalCondition=e.goal,this.slideBlockQuantity=e.playerSlideElevation,this.setThingSlideTowerElevation(e.thingSlideElevation),this.setPlayerSlideTowerElevation(e.playerSlideElevation),cjs.Tween.get(this.levelChangeOverlay).to({alpha:0},150,cjs.Ease.quadInOut).call((function(){this.playInstructionVO(["fof-tutorial-texture-p4-wash"],this.tutorialStep1.bind(this)),this.showToolPalette(!0),cjs.Tween.get(this).wait(1e3).call((function(){this.showTutorialArrow(!0,this.toolPalette.getToolButtonInstance("sponge_tool"),-40)}),null,this).wait(2e3).call(this.showTutorialArrow,[!1],this)}),null,this).set({visible:!1})},i._finishUsingTool=function(t){this.GameView__finishUsingTool(t),!this.isPart2&&(this.playerSurfaceFrictionTimeComponent>0||this.playerSurfaceFrictionTimeComponent<0)||this.isPart2&&(this.hasPlacedSand&&this.playerSurfaceFrictionTimeComponent<0||this.hasPlacedButter&&this.playerSurfaceFrictionTimeComponent>0)?(this.startRaceBtn.clickHandler=function(t){cjs.Tween.removeAllTweens(),this.showTutorialArrow(!1),this.pointerHandContainer.visible=!1,this.simulatingMicromaboodle&&(this.microMaboodle.stopFollowingTarget(),setTimeout(function(){this.microMaboodle.hide()}.bind(this),500)),this.idlePromptManager.removeIdlePrompt(e),this.raceComplete=this.tutorialStep2.bind(this),this.startRace(this.selectedRaceCharacterName,this.selectedRaceThingName),this.showStartRaceButton(!1)}.bind(this),this.showStartRaceButton(!0)):this.showStartRaceButton(!1)},i.introduceMicromaboodle_pt1=function(){cjs.Tween.get(this,{override:!0}).wait(500).call(this.showTutorialArrow,[!0,this.microMaboodle.lensArmContainer,-20,-80,!1],this).wait(4e3).call(this.showTutorialArrow,[!1],this),this.playInstructionVO("fof-mmb-prompt-p1",this.introduceMicromaboodle_pt2.bind(this))},i.introduceMicromaboodle_pt2=function(){this.simulatingMicromaboodle=!0;var e=cm.VisualCues.getPointer();e.speed=1e3,e.from(this.microMaboodle.lensArmContainer,{x:0,y:-40}).press().callback(function(){this.microMaboodle.followTarget(e),this.microMaboodle.showScreen(500)}.bind(this)).to(this.toolPalette.getToolButtonInstance("sand_tool"),{x:40,y:-40}).wait(4e3).to(this.toolPalette.getToolButtonInstance("butter_tool"),{x:40,y:0}).wait(4e3).callback(function(){this.microMaboodle.stopFollowingTarget()}.bind(this)).release().end().callback(this.tutorialStep1.bind(this))},cm.View.TutorialPart5GameView=cjs.promote(t,"TutorialGameView")}(),function(){cm.LAYERS={},cm.Animations={};var e=[{viewID:"HeightTutorial",levelSettings:null,isTutorial:!0},{viewID:"HeightWinTutorial",levelSettings:null,isTutorial:!0},{viewID:"TutorialLevel",levelSettings:{difficulty:2,goal:0,numberOfTextures:0}},{viewID:"HeightLoseTutorial",levelSettings:null,isTutorial:!0},{viewID:"TutorialLevel",levelSettings:{difficulty:2,goal:2,numberOfTextures:0}},{viewID:"HeightTieTutorial",levelSettings:null,isTutorial:!0},{viewID:"TutorialLevel",levelSettings:{difficulty:2,goal:1,numberOfTextures:0}},{viewID:"TextureTutorial",levelSettings:null,isTutorial:!0},{viewID:"Game",levelSettings:{numberOfTextures:2}},{viewID:"Game",levelSettings:{numberOfTextures:2}},{viewID:"Game",levelSettings:{numberOfTextures:3}},{viewID:"Game",levelSettings:{numberOfTextures:3}},{viewID:"Game",levelSettings:{numberOfTextures:3}},{viewID:"End"}];function t(){this.persistance={hasPlayed4Levels:!1,levelsPlayed:0},this.curiosity={hasUsedMMB:!1}}function i(){this.currentLevel=0,this.maxLevels=8,this.currentViewIndex=0,this.levelIsTutorial=null,this.scale=1,this.totalTime=0,this.totalMisses=0,this.hasInitedSound=!1,cjs.MotionGuidePlugin.install(),cjs.LoadItem.LOAD_TIMEOUT_DEFAULT=6e4,this.season=app.bridge.getSeason(),this.initializeStages(),this.initLayers(),this.boot(),this.setupMysteryTextureKeys(),cm.game=this}var s=i.prototype;s.getRandomLevel=function(e){var t;e=e||{};var i=cm.where(app.config.gameplay.levels,e),s=cm.where(i,{hasBeenPlayed:!1});if(void 0===s){for(var a=0,n=i.length;a<n;a++)i[a].hasBeenPlayed=!1;t=i.random()}else t=s.random();return t.hasBeenPlayed=!0,t},s.initializeStages=function(){var e=this.stage=app.display.stage;e.snapToPixelEnabled=!0,cm.Device.mobile&&cjs.Touch.isSupported()?e.enableDOMEvents(!1):
//!!! This is a performance hit, especially on mobile
e.enableMouseOver(20)},s.debugRect=function(e){e.debugShape||(e.debugShape=new cjs.Shape,cm.Layer.s.Debug.addChild(e.debugShape)),e.debugShape.graphics.clear().s("#f00").dr(e.x,e.y,e.width,e.height)},s.validateLevel=function(e,t){for(var i,s,a,n,o=[],r=e.heightRaceDurations[t.thingSlideElevation],l=t.minSlideHeight;l<=t.maxSlideHeight;){for(a=e.heightRaceDurations[l],o.push(a),i=0,s=t.textures.length;i<s;i++)n=e.textureTimeComponents[t.textures[i]],o.push(a+n);l++}var h=!1;for(l=0,s=o.length;l<s;l++)if(t.goal===e.RACE_GOALS.PLAYER_WIN&&o[l]<r||t.goal===e.RACE_GOALS.TIE&&o[l]===r||t.goal===e.RACE_GOALS.PLAYER_LOSE&&o[l]>r){h=!0;break}var c=!1;if((t.playerSlideElevation<t.minSlideHeight||t.playerSlideElevation>t.maxSlideHeight)&&(c=!0),!h||c)throw"LEVEL NOT VALID!"},s.initLayers=function(){this.stage.addChild(new cm.Layer("Views",0,0),new cm.Layer("Transition",0,0),new cm.Layer("Loader",.5,.5),new cm.Layer("Debug",.5,.5));var e=this.stage;cm.Layer.alignLayers(e.width,e.height),cm.ViewControl.setViewLayer(cm.Layer.s.Views)},s.boot=function(){for(var e=app.config.gameplay.levels.easy.concat(app.config.gameplay.levels.medium),t=0,i=(e=app.config.gameplay.levels=e.concat(app.config.gameplay.levels.hard)).length;t<i;t++)e[t].numberOfTextures=e[t].textures.length,e[t].hasBeenPlayed=!1,window.edit&&this.validateLevel(app.config.gameplay,e[t]);cm.Assets.load([app.config.assets.preload],this.onBootLoad.bind(this)),this.stage.on(app.bridge.events.SCREEN_CAPTURE_START,this.onBridgeEvents,this),this.stage.on(app.bridge.events.SCREEN_CAPTURE_END,this.onBridgeEvents,this)},s.setupMysteryTextureKeys=function(){for(var e in springroll.SavedData.write("hasSeenTexture_sponge",!0),app.config.gameplay.slideTextureIDs)null===springroll.SavedData.read("hasSeenTexture_"+e)&&("butter"===e||"sand"===e?springroll.SavedData.write("hasSeenTexture_"+e,!0):springroll.SavedData.write("hasSeenTexture_"+e,!1))},s.onBootLoad=function(e){this.ready=!0,cm.Assets.lib.cmlogo=e.target.getResult("cmlogo"),cm.ViewControl.registerView("Game",cm.View.GameView,!1),cm.ViewControl.registerView("Title",cm.View.TitleView,!1),cm.ViewControl.registerView("Freeplay",cm.View.FreeplayView,!1),cm.ViewControl.registerView("Tutorial",cm.View.TutorialGameView,!1),cm.ViewControl.registerView("HeightTutorial",cm.View.TutorialPart1GameView,!1),cm.ViewControl.registerView("HeightWinTutorial",cm.View.TutorialPart2GameView,!1),cm.ViewControl.registerView("HeightLoseTutorial",cm.View.TutorialPart3GameView,!1),cm.ViewControl.registerView("HeightTieTutorial",cm.View.TutorialPart4GameView,!1),cm.ViewControl.registerView("TextureTutorial",cm.View.TutorialPart5GameView,!1),cm.ViewControl.registerView("TutorialLevel",cm.View.TutorialLevelGameView,!1),cm.ViewControl.registerView("End",cm.View.EndView,!1),cm.ViewControl.setTransitionLayer(cm.Layer.s.Transition,cm.ViewTransition),this.loadingScreen=new cm.LoaderView,cm.Layer.s.Loader.addChild(this.loadingScreen),app.bridge.isInWrapper||app.playOptions.freeplay?this.startMainAssetsLoad():(app.pleAnalyticsHelper.trackStartGame(),cm.ViewControl.gotoView("Title"))},s.startMainAssetsLoad=function(e){var t=[app.config.assets.main];app.playOptions.freeplay&&(t.push(app.config.assets.freeplay),t.push(app.config.assets["freeplay"+this.season])),t.push(app.config.assets.endscreen),this.loadingScreen.animateIn().call((function(){cm.ViewControl.gotoLoaderThen(t,this.onMainAssetsLoad.bind(this))}),null,this)},s.onMainAssetsLoad=function(e){var t=new cjs.Bitmap(cm.Assets.lib.hand_pointer).set({regX:16,regY:52});cm.VisualCues.setPointer(t),app.sound.play("music-friction-loop",{volume:.5,loop:!0}),app.playOptions.freeplay?(app.pleAnalyticsHelper.trackStartFreeplay(),this.loadingScreen.animateOut().call(cm.ViewControl.gotoView,["Freeplay"],cm.ViewControl)):null!==cm.getUrlVar("test")?this.loadingScreen.animateOut().call(this.testLevel,null,this):(app.pleAnalyticsHelper.trackStartGame(),this.loadingScreen.animateOut().call(this.newGame,null,this))},s.checkForPersistentAward=function(){return!!app.bridge.isInWrapper&&(4===this.seedUnlockTracker.persistance.levelsPlayed&&!this.seedUnlockTracker.persistance.hasPlayed4Levels&&(this.seedUnlockTracker.persistance.hasPlayed4Levels=!0,app.seeds.earnSeedPacket(app.seeds.seedTypes.PERSISTENCE,"User completed half a playthrough",{voOptions:["garden-18","garden-19","garden-20","garden-22"]}),!0))},s.checkMMBCuriositySeed=function(){app.bridge.isInWrapper&&(this.seedUnlockTracker.curiosity.hasUsedMMB||this.levelIsTutorial||(cm.ViewControl.current.microMaboodle&&cm.ViewControl.current.microMaboodle.stopFollowingTarget(),this.seedUnlockTracker.curiosity.hasUsedMMB=!0,app.seeds.earnSeedPacket(app.seeds.seedTypes.CURIOUSITY,"Use the Micro-ma-boodle in a game session.",{voOptions:["garden-23","garden-25"],stagePoint:cm.ViewControl.current.microMaboodle.localToGlobal(0,0)})))},s.checkAllTexturesUnlocked=function(){if(app.bridge.isInWrapper&&!springroll.SavedData.read("hasUnlockedAllTextures")){["ice","honey","oil","glue","rollers","rocks"].every((function(e){return springroll.SavedData.read("hasSeenTexture_"+e)}))&&(springroll.SavedData.write("hasUnlockedAllTextures",!0),app.seeds.earnSeedPacket(app.seeds.seedTypes.CURIOUSITY,"Uncover all the secret textures.",{voOptions:["garden-23","garden-25"]}))}},s.gotoNextView=function(){var e={};if(this.currentLevel++,this.seedUnlockTracker.persistance.levelsPlayed=this.currentLevel,this.currentViewMeta=e,this.currentLevel===this.maxLevels)cm.LearningBridge.endLevel(this.totalTime,this.totalMisses),this.gotoEndScreen();else{var t,i={};t=app.alpPlugin?app.alpPlugin.getRecommendation():"type:slide_ctrl:1_tse:1_pse:1_minsh:1_maxsh:4_goal:0_tex:2,3,8",app.learning.kidaptive_uri=t,this.determineTutorialLevel(t)?(this.levelIsTutorial=!0,e.viewID=this.determineTutorialFromURI(t),i.levelCfg=app.config.tutorials.levels[e.viewID]):(this.levelIsTutorial=!1,e.viewID="Game",i.levelCfg=this.decodeLevelURI(t)),i.levelCfg||(i.levelCfg=this.getRandomLevel(e.levelSettings)),i.levelCfg.uri=t,cm.ViewControl.gotoView(e.viewID,i)}},s.determineTutorialLevel=function(e){return-1!==e.split(":")[1].indexOf("slidetutor_mech")},s.determineTutorialFromURI=function(t){var i;switch(t.split(":")[2]){case"height":i=e[0].viewID;break;case"heightwin":i=e[1].viewID;break;case"heightlose":i=e[3].viewID;break;case"heighttie":i=e[5].viewID;break;case"texture":i=e[7].viewID;break;default:i=e[1].viewID}return i},s.decodeLevelURI=function(e){var t={goal:null,hasBeenPlayed:!0,hasHeightControls:null,hasTools:null,maxSlideHeight:null,minSlideHeight:null,numberOfTextures:null,playerSlideElevation:null,textures:null,thingSlideElevation:null},i=e.split("_");i.shift();var s=parseInt(i[0].split("ctrl:")[1]);t.hasHeightControls=0!==s,t.thingSlideElevation=parseInt(i[1].split("tse:")[1]),t.playerSlideElevation=parseInt(i[2].split("pse:")[1]),t.minSlideHeight=parseInt(i[3].split("minsh:")[1]),t.maxSlideHeight=parseInt(i[4].split("maxsh:")[1]),t.goal=parseInt(i[5].split("goal:")[1]);for(var a=i[6].split("tex:")[1],n=[],o=0,r=(a=a.split(",")).length;o<r;o++)for(var l in app.config.gameplay.slideTextureIDs)parseInt(a[o])===app.config.gameplay.slideTextureIDs[l]&&n.push(l);return t.textures=n,t.numberOfTextures=n.length,t.hasTools=n.length>0,!!this.checkLevelWithinParameters(t)&&t},s.checkLevelWithinParameters=function(e){return e.goal>=0&&e.goal<=2&&e.maxSlideHeight>=1&&e.maxSlideHeight<=4&&e.minSlideHeight>=1&&e.minSlideHeight<=4&&e.thingSlideElevation>=1&&e.thingSlideElevation<=4&&e.playerSlideElevation>=1&&e.playerSlideElevation<=4},s.advanceTutorial=s.gotoNextView,s.getNextViewMeta=function(){var e=this.viewProcession[this.currentViewIndex];return this.currentViewIndex++,e||null},s.testLevel=function(){"1"===cm.getUrlVar("test")||("2"===cm.getUrlVar("test")?cm.where(app.config.gameplay.levels,{difficulty:5,goal:0,thingSlideElevation:2})[0]:"3"===cm.getUrlVar("test")||("height-tut"===cm.getUrlVar("test")?cm.ViewControl.gotoView("HeightLoseTutorial",{levelCfg:app.config.tutorials.levels.HeightLoseTutorial}):"texture-tut"===cm.getUrlVar("test")&&cm.ViewControl.gotoView("TextureTutorial",{levelCfg:app.config.tutorials.levels.TextureTutorial})))},s.getDebugVar=function(e){return!0===window.ISTESTMODE?cm.getUrlVar(e):null},s.gotoEndScreen=function(){this.loadingScreen.animateIn().call((function(){cm.ViewControl.gotoLoaderThen([app.config.assets.endscreen],this._gotoEndScreen.bind(this))}),null,this)},s._gotoEndScreen=function(){this.loadingScreen.animateOut().call(cm.ViewControl.gotoView,["End"],cm.ViewControl)},s.newGame=function(){this.currentViewIndex=0,this.seedUnlockTracker=new t,this.gotoNextView(),this.maxLevels=8,this.currentLevel=0,cm.LearningBridge.startLevel(),this.totalTime=0,this.totalMisses=0},s.resize=function(e,t){this.scale=app.realHeight/t,cm.Layer.alignLayers(e,t),cm.ViewControl.resize(e,t)},s.onBridgeEvents=function(e){var t=cm.ViewControl.current;t&&t.onScreenCaptureEvent&&t.onScreenCaptureEvent(e)},s.update=function(e){this.ready&&(this.totalTime+=e,this.loadingScreen&&this.loadingScreen.update(),cm.ViewControl.update(e),cm.VisualCues.update(e),cm.Layer.alignLayers(app.display.width,app.display.height))},cm.Game=i}();var level,playerSlideElevation,minSlideHeight,maxSlideHeight,_levels=[];function makeWinLevelCfg(e,t,i){1===i?i:3===i&&i+1}for(var availableHeights=2,h=4;i<=h;availableHeights++){for(var i=1,l=3;i<l;i++)1===i?(minSlideHeight=i,playerSlideElevation=maxSlideHeight=i+availableHeights-1):playerSlideElevation=i+Math.range(-1,1),level={thingSlideElevation:i,playerSlideElevation:playerSlideElevation,minSlideHeight:minSlideHeight,maxSlideHeight:maxSlideHeight,goal:0,hasTools:!1,hasHeightControls:!0,difficulty:availableHeights},_levels.push(level);for(i=2,l=4;i<l;i++)playerSlideElevation=4===i?i-Math.range(0,availableHeights-1):i+Math.range(-1,1),level={thingSlideElevation:i,playerSlideElevation:playerSlideElevation,goal:2,hasTools:!1,hasHeightControls:!0,difficulty:availableHeights},_levels.push(level);for(i=1,l=4;i<l;i++)playerSlideElevation=4===i?i-Math.range(0,availableHeights-1):1===i?i+Math.range(1,availableHeights-1):i+Math.range(-1,1),level={thingSlideElevation:i,playerSlideElevation:playerSlideElevation,goal:1,hasTools:!1,hasHeightControls:!0,difficulty:availableHeights},_levels.push(level)}for(var numtextures=2,nt=3;numtextures<=nt;numtextures++)for(availableHeights=2,h=4;i<=h;availableHeights++){for(i=1,l=3;i<l;i++)playerSlideElevation=1===i?i+Math.range(0,availableHeights-1):i+Math.range(-1,1),level={thingSlideElevation:i,playerSlideElevation:playerSlideElevation,goal:0,hasTools:!1,hasHeightControls:!0,difficulty:availableHeights*numtextures},_levels.push(level);for(i=2,l=4;i<l;i++)playerSlideElevation=4===i?i-Math.range(0,availableHeights-1):i+Math.range(-1,1),level={thingSlideElevation:i,playerSlideElevation:playerSlideElevation,goal:2,hasTools:!1,hasHeightControls:!0,difficulty:availableHeights*numtextures},_levels.push(level);for(i=1,l=4;i<l;i++)playerSlideElevation=4===i?i-Math.range(0,availableHeights-1):1===i?i+Math.range(1,availableHeights-1):i+Math.range(-1,1),level={thingSlideElevation:i,playerSlideElevation:playerSlideElevation,goal:1,hasTools:!1,hasHeightControls:!0,difficulty:availableHeights*numtextures},_levels.push(level)}!function(){function e(e){this._gameStage=e,this._time=0,this._promptActions=[],this._promptActionsMap={},this.enabled=!1,this.stageListener=this._gameStage.on("stagemousedown",this._resetPrompts,this)}var t=e.prototype;t.constructor=e,t.addIdlePrompt=function(e,t,i,s){var a={prompt:i,onCancel:s||null,waitTime:t,lastPromptTime:this._time,enabled:!0};this._promptActionsMap[e]=a,this._promptActions.push(a)},t.pause=function(e){e&&this._promptActionsMap[e]?this._promptActionsMap[e].enabled=!1:this.enabled=!1},t.resume=function(e){e&&this._promptActionsMap[e]?(this._promptActionsMap[e].enabled=!0,this._promptActionsMap[e].lastPromptTime=this._time):this.enabled=!0},t.cancel=function(e){if(e&&this._promptActionsMap[e])this._promptActionsMap[e].lastPromptTime=this._time,this._promptActionsMap[e].onCancel&&this._promptActionsMap[e].onCancel();else for(var t=0,i=this._promptActions.length;t<i;t++)pr=this._promptActions[t],!0===pr.enabled&&(pr.lastPromptTime=this._time,pr.onCancel&&pr.onCancel())},t.cancelAll=function(){this.cancel()},t.removeIdlePrompt=function(e){if(e){this.cancel(e);var t=this._promptActionsMap[e];this._promptActions.erase(t),delete this._promptActionsMap[e]}},t.update=function(e){if(this.enabled){var t;this._time+=e;for(var i=0,s=this._promptActions.length;i<s;i++)!0===(t=this._promptActions[i]).enabled&&this._time-t.lastPromptTime>t.waitTime&&(t.lastPromptTime=this._time,t.prompt())}},t._resetPrompts=function(e){for(var t=0,i=this._promptActions.length;t<i;t++)this._promptActions[t].lastPromptTime=this._time},t.destroy=function(){this._gameStage.off("stagemousedown",this.stageListener),this._promptActions.length=0,this._promptActionsMap={}},cm.IdlePromptManager=e}(),function(){var e=include("springroll.pbskids.easeljs.DwellTimer"),t=include("springroll.Debug",!1),i=["game_time","level","round","event_count"];var s=function(){throw"LearningBridge cannot be instantiated."};s.enabled=!0,s.trackEvent=function(e,a){if(s.enabled){if(t){var n=app.learning[e].signature;if(n.eventCode,a){for(var o=0,r=0;o<n.args.length;o++){var l=n.args[o];-1===i.indexOf(l.name)&&(l.name,JSON.stringify(a[r]),r++)}for(;r<a.length;r++)JSON.stringify(a[r])}}app.learning[e].apply(app.learning,a)}},s.clickPlay=function(){this.trackEvent("clickPlay",[{kidaptive_uri:"",coordinates:s._getCoordinateObject()}])},s.endGame=function(e){var t=0;e=e||"home",cm.ViewControl.current instanceof cm.View.GameView&&(t=Math.floor(cm.ViewControl.current.time),app.game.currentLevel),app.learning.endGame({duration:t||0,exit_type:e})},s.startRound=function(e,t){var i="";switch(e.goal){case app.config.gameplay.RACE_GOALS.PLAYER_WIN:i="faster";break;case app.config.gameplay.RACE_GOALS.TIE:i="tie";break;case app.config.gameplay.RACE_GOALS.PLAYER_LOSE:i="slower"}for(var s=[],a=e.minSlideHeight,n=e.maxSlideHeight;a<=n;a++)s.push(a);var o={nicksally:{height:e.playerSlideElevation,available_heights:[],adjustable:e.hasHeightControls},thing:{height:e.thingSlideElevation,available_heights:[e.thingSlideElevation],adjustable:!1}};for(a=e.minSlideHeight,n=e.maxSlideHeight;a<=n;a++)a>=e.minSlideHeight&&a<=e.maxSlideHeight&&o.nicksally.available_heights.push(a);var r=[];if(e.textures)for(a=0,n=e.textures.length;a<n;a++){var l,h={};switch(e.textures[a]){case"butter":case"oil":l=-350;break;case"rollers":case"ice":l=-700;break;case"sand":case"glue":l=350;break;case"rocks":case"honey":l=700}h[e.textures[a]]=l,r.push(h)}this.trackEvent("startRound",[e.uri||"",i,o,r,!0===this.determineTutorialLevel(e.uri||"")?"tutorial":"challenge"])},s.determineTutorialLevel=function(e){return-1!==e.split(":")[1].indexOf("slidetutor_mech")},s.endRound=function(e,t,i){this.trackEvent("endRound",[e||"",Math.round(i),t])},s.startLevel=function(){this.trackEvent("startLevel",[""])},s.endLevel=function(e,t){this.trackEvent("endLevel",["",Math.round(e),t])},s.startInstruction=function(e,t){this.trackEvent("startInstruction",[app.captions.getFullCaption(e),e.join?e.join(","):e,"audio",app.captions.getLength(e),{muted:app.sound._contexts.vo.muted,closed_caption:void 0!==app.captionsMuted&&app.captionsMuted,kidaptive_uri:t||""}])},s.endInstruction=function(){this.trackEvent("endInstruction")},s.replayRound=function(e){this.trackEvent("replayRound",[e||"",s._getCoordinateObject()])},s.gotoNextRound=function(e){this.trackEvent("gotoNextRound",[e||"",s._getCoordinateObject()])},s.replayLevel=function(){this.trackEvent("replayLevel",["",s._getCoordinateObject()])},s.raisedSlideHeight=function(e){0!==e.playerSurfaceFrictionTimeComponent&&({}[e.playerSurfaceTextureName]=e.playerSurfaceFrictionTimeComponent);var t=!!cm.ViewControl.current.isTutorialView,i={nicksally:{height:e.slideBlockQuantity,material:{}},thing:{height:e.levelCfg.thingSlideElevation,material:{none:0}}};i.nicksally.material[e.playerSurfaceTextureName]=e.playerSurfaceFrictionTimeComponent,this.trackEvent("raisedSlideHeight",[e.levelCfg.uri||"",this._getCoordinateObject(),e.slideBlockQuantity,t||e.wouldPlayerSucceed(),i])},s.loweredSlideHeight=function(e){0!==e.playerSurfaceFrictionTimeComponent&&({}[e.playerSurfaceTextureName]=e.playerSurfaceFrictionTimeComponent);var t=!!cm.ViewControl.current.isTutorialView,i={nicksally:{height:e.slideBlockQuantity,material:{}},thing:{height:e.levelCfg.thingSlideElevation,material:{none:0}}};i.nicksally.material[e.playerSurfaceTextureName]=e.playerSurfaceFrictionTimeComponent,this.trackEvent("loweredSlideHeight",[e.levelCfg.uri||"",this._getCoordinateObject(),e.slideBlockQuantity,t||e.wouldPlayerSucceed(),i])},s.startDrag=function(e,t,i,s){app.learning.startTimer("_objectDrag"),this.trackEvent("startDrag",[s||"",this._getCoordinateObject(),t,i])},s.endDragOutside=function(e,t,i){this.trackEvent("endDragOutside",[i||"",this._getCoordinateObject(),t||"",e,app.learning.stopTimer("_objectDrag")])},s.finishedApplyingSlideTexture=function(e){var t={};0!==e.playerSurfaceFrictionTimeComponent&&(t[e.playerSurfaceTextureName]=e.playerSurfaceFrictionTimeComponent),this.trackEvent("finishedApplyingSlideTexture",[e.levelCfg.uri||"",this._getCoordinateObject(),app.learning.stopTimer("_objectDrag"),t,e.slideBlockQuantity||1,e.wouldPlayerSucceed()])},s.finishedClearingSlideTexture=function(e,t,i){var s={};s[t]=i,this.trackEvent("finishedClearingSlideTexture",[e.levelCfg.uri||"",this._getCoordinateObject(),app.learning.stopTimer("_objectDrag"),s,e.slideBlockQuantity,e.wouldPlayerSucceed()])},s.mmbInspectObject=function(e,t,i){var s={};s[e]=t,this.trackEvent("mmbInspectObject",[i||"",this._getCoordinateObject(),s])},s.submitAnswer=function(e){0!==e.playerSurfaceFrictionTimeComponent&&({}[e.playerSurfaceTextureName]=e.playerSurfaceFrictionTimeComponent);var t=!!cm.ViewControl.current.isTutorialView,i={nicksally:{height:e.levelCfg.playerSlideElevation,material:e.playerSurfaceTextureName},thing:{height:e.levelCfg.thingSlideElevation,material:""}};this.trackEvent("submitAnswer",[e.levelCfg.uri||"",this._getCoordinateObject(),t||e.wouldPlayerSucceed(),i])},s.startIncorrectFeedback=function(e,t){this.trackEvent("startIncorrectFeedback",[app.captions.getFullCaption(e),e.join?e.join(","):e,"audio",app.captions.getLength(e),{muted:app.sound._contexts.vo.muted,closed_caption:void 0!==app.captionsMuted&&app.captionsMuted,kidaptive_uri:t||""}])},s.startCorrectFeedback=function(e,t){this.trackEvent("startCorrectFeedback",[app.captions.getFullCaption(e),e.join?e.join(","):e,"audio",app.captions.getLength(e),{muted:app.sound._contexts.vo.muted,closed_caption:void 0!==app.captionsMuted&&app.captionsMuted,kidaptive_uri:t||""}])},s.endIncorrectFeedback=function(){this.trackEvent("endIncorrectFeedback")},s.endCorrectFeedback=function(){this.trackEvent("endCorrectFeedback")},s._getCoordinateObject=function(){var e=app.display,t=e.stage;return{x:Math.round(t.mouseX),y:Math.round(t.mouseY),stage_width:e.width,stage_height:e.height}},s.createDwellTimer=function(t){for(var i=0,s=arguments.length;i<s;i++){var a=arguments[i];if(!a.name)throw"Dwell timers need a target with a name! On target: "+a.toString();e.create(a)}},s.destroyDwellTimer=function(t){for(var i=0;i<arguments.length;i++)e.destroy(arguments[i])},cm.LearningBridge=s}(),function(){var e=include("springroll.Application"),t=include("springroll.easeljs.EaselJSDisplay"),i=include("cm"),s={apikey:"gtb6AXRbON@p.enjm4sQ)uv*.GMQu",gameuri:"/game/pbskids/cithkalat/slida_ma_zoo",dev:!0,nooidc:!1};JSON3.noConflict();var a=new e({name:"factorfriction",pleID:"fact-or-friction",pleName:"Slidea-ma-zoo",canvasId:"stage",display:t,configPath:"assets/config/config.json",captionsPath:"assets/config/%LANG%/captions.json",languagesPath:"assets/config/languages.json",captions:"captions",maxWidth:1664,maxHeight:768,displayOptions:{clearView:!0},alp:{apiKey:s.apikey,gameUri:s.gameuri,options:{dev:s.dev,noOidc:s.nooidc},version:{version:"1.0.0",build:"0"},promptPrefix:"/prompt/pbskids/cithkalat/slida_ma_zoo/ver_1/",eventOverride:SpringrollAlpPluginFactOrFrictionHelper.eventOverride,recCallback:SpringrollAlpPluginFactOrFrictionHelper.recCallback,recParams:SpringrollAlpPluginFactOrFrictionHelper.recParams,recType:SpringrollAlpPluginFactOrFrictionHelper.recType}});function n(){a.languages.setLanguage(a.playOptions.language||"en")}a.minWidth=1024,a.maxWidth=1664,a.maxHeight=768,a.on("init",(function(){this._hasRecievedPlayOptions=!1,this.game=new i.Game;var e=this.display.stage.canvas;this.game.resize(e.width,e.height),window.edit&&edit.init(this.display.stage),this.learning.kidaptive_uri="",this.sound.addContext(this.config.sounds.globalsfx),this.bridge.isInWrapper||window.addEventListener("beforeunload",(function(e){return i.LearningBridge.endGame("navigation"),null})),SpringrollAlpPluginFactOrFrictionHelper.init.call(this)})),a.on("resize",(function(e,t){i.Device.checkForNotchSize(),this.game&&this.game.resize(e,t)})),a.on("update",(function(e){!1===this._hasRecievedPlayOptions&&a.playOptions.language&&(n.call(this),this._hasRecievedPlayOptions=!0),i.Device.mobile&&createjs.Touch.isSupported()&&function(){var e=a.display.stage;if(!e)return;var t=e.__touch;if(t&&!0===t.multitouch){try{cjs.Touch.disable(e)}catch(e){}cjs.Touch.enable(e,!0),e.enableDOMEvents(!1),e._primaryPointerID=null}}(),this.game&&this.game.update(e)})),window.app=i.app=a}();