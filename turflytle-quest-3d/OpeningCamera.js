pc.script.attribute("rotatingSpeed","number",1),pc.script.attribute("movingSpeedPhase1","number",-3),pc.script.attribute("movingSpeedPhase2","number",-3),pc.script.create("OpeningCamera",function(a){var b=function(a){this.entity=a};return b.prototype={initialize:function(){this.playerEntity=a.root.findByName("Player"),this.playerScript=this.playerEntity.script.PlayerController,this.targetCameraEntity=a.root.findByName("Camera"),this.targetPosition=this.targetCameraEntity.getPosition(),this.cameraComponent=this.entity.camera,this.startQuat=new pc.Quat;var b=this.targetCameraEntity.getRotation();this.targetQuat=new pc.Quat(b.x,b.y,b.z,b.w),this.quatTimer=0,this.tween=null,this.start=!1,this.state="none",this.animationIsReady=!1},update:function(b){if(!PAUSE){switch(this.state){case"closing":this.closing(b);break;case"rotating":this.rotating(b);break;case"adjusting":var c;this.quatTimer+=b,this.quatTimer>1&&(this.quatTimer=1),c=(new pc.Quat).slerp(this.startQuat,this.targetQuat,this.quatTimer/1),this.entity.setRotation(c)}"adjusting"!==this.state&&(this.playerEntity||(this.playerEntity=a.root.findByName("Player")),this.entity.lookAt(this.playerEntity.getPosition()))}},onEnable:function(){this.playerScript.on("idle",this._onIdle,this)},onDisable:function(){this.playerScript.off("idle",this._onIdle,this)},_onIdle:function(){"waiting"===this.state?this.state="rotating":this.animationIsReady=!0},closing:function(a){this.entity.getLocalPosition().z>5?this.entity.translate(0,0,this.movingSpeedPhase1*a):this.animationIsReady?this.state="rotating":this.state="waiting"},rotating:function(a){if(this.entity.translateLocal(this.rotatingSpeed*a,0,0),this.entity.getPosition().x<this.playerEntity.getPosition().x){this.state="adjusting";var b=this.entity.getRotation();this.startQuat.set(b.x,b.y,b.z,b.w),this.moveToStartingPoint()}},moveToStartingPoint:function(){var a=this,b=this.targetCameraEntity.getLocalPosition(),c=(this.targetCameraEntity.getLocalEulerAngles(),this.entity.getLocalPosition());new TWEEN.Tween({x:c.x,y:c.y,z:c.z}).to({x:b.x,y:b.y,z:b.z},1e3).onUpdate(function(){a.entity.setLocalPosition(this.x,this.y,this.z)}).onComplete(function(){a.entity.enabled=!1,a.targetCameraEntity.enabled=!0,a.fire("openingFinished")}).start()},startOpening:function(){this.state="closing"}},b});