pc.script.attribute("playOpening","boolean",!1),pc.script.attribute("delay","number",0),pc.script.create("Camera",function(a){var b=new pc.Vec3(0,.809,-2.976),c=new pc.Vec3(175,0,-180),d=function(a){this.entity=a};return d.prototype={initialize:function(){this.player=a.root.findByName("Player"),this.camera=this.entity.camera,this.locked=!1,b.copy(this.entity.getLocalPosition()),c.copy(this.entity.getLocalEulerAngles()),this.offset=b.clone(),this.rotation=c.clone(),this.playOpening?setTimeout(this.showOpening.bind(this),this.delay):(this.entity.setLocalEulerAngles(c.x,c.y,c.z),this.entity.setLocalPosition(b.x,b.y,b.z)),this.isLerping=!1,this.goalPosition=new pc.Vec3,this.goalRotation=new pc.Vec3,this.newPosition=new pc.Vec3,this.newRotation=new pc.Vec3},update:function(a){this.isRotateAround&&this.rotateAroundPlayer()},moveLerp:function(a,b){this.goalPosition=a},move:function(a,b,c){this.locked||this.entity.setLocalPosition(this.offset.x+a,this.offset.y+b,this.offset.z+c)},rotate:function(a,b,c){this.locked||this.entity.setLocalEulerAngles(this.rotation.x+a,this.rotation.y+b,this.rotation.z+c)},moveTo:function(a,b){this.locked=!0;var c=this.entity.getLocalPosition(),d=new pc.Vec3;d.copy(c),a.add(this.offset);var e=this;new TWEEN.Tween({x:d.x,y:d.y,z:d.z}).to({x:a.x,y:a.y,z:a.z},b).onUpdate(function(){e.entity.setLocalPosition(this.x,this.y,this.z),console.log("moving")}).onComplete(function(){e.locked=!1}).start()},rotateTo:function(a,b){this.locked=!0;var c=this.entity.getLocalEulerAngles(),d=new pc.Vec3;d.copy(c),a.add(this.rotation),this._convertAngleX(d),this._convertAngleX(a);var e=this;new TWEEN.Tween({x:d.x,y:d.y,z:d.z}).to({x:a.x,y:a.y,z:a.z},b).easing(TWEEN.Easing.Quadratic.Out).onUpdate(function(){e.entity.setLocalEulerAngles(this.x,this.y,this.z)}).onComplete(function(){e.locked=!1}).start()},_convertAngleX:function(a){a.x<0&&(a.x+=360)},showOpening:function(){var a=this,c=(this.entity.getLocalPosition().x,this.entity.getLocalPosition().y),d=this.entity.getLocalPosition().z;new TWEEN.Tween({fov:90,y:c,z:d}).to({fov:45,y:28.085,z:120},5e3).onUpdate(function(){a.camera.fov=this.fov,a.entity.setLocalPosition(b.x,this.y,this.z),a.entity.lookAt(a.player.getPosition())}).onComplete(function(){a.isRotateAround=!0}).start()},rotateAroundPlayer:function(){this.entity.lookAt(this.player.getPosition()),this.entity.translateLocal(new pc.Vec3(5,0,0)),this.entity.getLocalEulerAngles().y<0&&(this.isRotateAround=!1,this.moveToStartingPoint())},moveToStartingPoint:function(){var a=this,d=this.entity.getLocalPosition().x,e=this.entity.getLocalPosition().y,f=this.entity.getLocalPosition().z,g=this.entity.getLocalEulerAngles().x,h=this.entity.getLocalEulerAngles().y;this.entity.getLocalEulerAngles().z,new TWEEN.Tween({x:d,y:e,z:f,rx:g,ry:h}).to({x:b.x,y:b.y,z:b.z,rx:c.x,ry:c.y},1e3).onUpdate(function(){a.entity.setLocalPosition(this.x,this.y,this.z),a.entity.setLocalEulerAngles(this.rx,this.ry,a.entity.getLocalEulerAngles().z)}).onComplete(function(){}).start()}},d});