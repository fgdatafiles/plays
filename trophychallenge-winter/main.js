!function(n){var r={};function __webpack_require__(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,__webpack_require__),t.l=!0,t.exports}__webpack_require__.m=n,__webpack_require__.c=r,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(t,e){if(1&e&&(t=__webpack_require__(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)__webpack_require__.d(n,r,function(e){return t[e]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=3)}([function(n,r,e){(function(e){var t;function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*!
 *  howler.js v2.1.3
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
/*!
 *  howler.js v2.1.3
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
!function(){"use strict";function za(){this.init()}za.prototype={init:function init(){var e=this||m;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function volume(e){var t=this||m;if(e=parseFloat(e),t.ctx||p(),void 0!==e&&0<=e&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,m.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),o=0;o<r.length;o++){var i=t._howls[n]._soundById(r[o]);i&&i._node&&(i._node.volume=i._volume*e)}return t}return t._volume},mute:function mute(e){var t=this||m;t.ctx||p(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,m.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var r=t._howls[n]._getSoundIds(),o=0;o<r.length;o++){var i=t._howls[n]._soundById(r[o]);i&&i._node&&(i._node.muted=!!e||i._muted)}return t},unload:function unload(){for(var e=this||m,t=e._howls.length-1;0<=t;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,p()),e},codecs:function codecs(e){return(this||m)._codecs[e.replace(/^x-/,"")]},_setup:function _setup(){var t=this||m;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(e){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function _setupCodecs(){var t=this||m,e=null;try{e="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!e||"function"!=typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),r=t._navigator&&t._navigator.userAgent.match(/OPR\/([0-6].)/g),o=r&&parseInt(r[0].split("/")[1],10)<33;return t._codecs={mp3:!(o||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function _unlockAudio(){var s=this||m;if(!s._audioUnlocked&&s.ctx){s._audioUnlocked=!1,s.autoUnlock=!1,s._mobileUnloaded||44100===s.ctx.sampleRate||(s._mobileUnloaded=!0,s.unload()),s._scratchBuffer=s.ctx.createBuffer(1,1,22050);var e=function unlock(e){for(var t=0;t<s.html5PoolSize;t++)try{var n=new Audio;n._unlocked=!0,s._releaseHtml5Audio(n)}catch(e){s.noAudio=!0}for(t=0;t<s._howls.length;t++)if(!s._howls[t]._webAudio)for(var r=s._howls[t]._getSoundIds(),o=0;o<r.length;o++){var i=s._howls[t]._soundById(r[o]);i&&i._node&&!i._node._unlocked&&(i._node._unlocked=!0,i._node.load())}s._autoResume();var a=s.ctx.createBufferSource();a.buffer=s._scratchBuffer,a.connect(s.ctx.destination),void 0===a.start?a.noteOn(0):a.start(0),"function"==typeof s.ctx.resume&&s.ctx.resume(),a.onended=function(){a.disconnect(0),s._audioUnlocked=!0,document.removeEventListener("touchstart",unlock,!0),document.removeEventListener("touchend",unlock,!0),document.removeEventListener("click",unlock,!0);for(var e=0;e<s._howls.length;e++)s._howls[e]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),s}},_obtainHtml5Audio:function _obtainHtml5Audio(){var e=this||m;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function _releaseHtml5Audio(e){var t=this||m;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function _autoSuspend(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&m.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume:function _autoResume(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&m.usingWebAudio)return"running"===t.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state?(t.ctx.resume().then(function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")}),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};function Ba(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")}var m=new za;Ba.prototype={init:function init(e){var t=this;return m.ctx||p(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=m.usingWebAudio&&!t._html5,void 0!==m.ctx&&m.ctx&&m.autoUnlock&&m._unlockAudio(),m._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function action(){t.play()}}),t._preload&&t.load(),t},load:function load(){var e=this,t=null;if(m.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var r,o;if(e._format&&e._format[n])r=e._format[n];else{if("string"!=typeof(o=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(r=/^data:audio\/([^;,]+);/i.exec(o))||(r=/\.([^.]+)$/.exec(o.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&m.codecs(r)){t=e._src[n];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new i(e),e._webAudio&&s(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function play(t,n){var r=this,e=null;if("number"==typeof t)e=t,t=null;else{if("string"==typeof t&&"loaded"===r._state&&!r._sprite[t])return null;if(void 0===t&&(t="__default",!r._playLock)){for(var o=0,i=0;i<r._sounds.length;i++)r._sounds[i]._paused&&!r._sounds[i]._ended&&(o++,e=r._sounds[i]._id);1===o?t=null:e=null}}var a=e?r._soundById(e):r._inactiveSound();if(!a)return null;if(e&&!t&&(t=a._sprite||"__default"),"loaded"!==r._state){a._sprite=t,a._ended=!1;var s=a._id;return r._queue.push({event:"play",action:function action(){r.play(s)}}),s}if(e&&!a._paused)return n||r._loadQueue("play"),a._id;r._webAudio&&m._autoResume();var l=Math.max(0,0<a._seek?a._seek:r._sprite[t][0]/1e3),c=Math.max(0,(r._sprite[t][0]+r._sprite[t][1])/1e3-l),u=1e3*c/Math.abs(a._rate),p=r._sprite[t][0]/1e3,h=(r._sprite[t][0]+r._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;function $b(){a._paused=!1,a._seek=l,a._start=p,a._stop=h,a._loop=!(!a._loop&&!r._sprite[t][2])}if(!(h<=l)){var y=a._node;if(r._webAudio){var f=function playWebAudio(){r._playLock=!1,$b(),r._refreshBuffer(a);var e=a._muted||r._muted?0:a._volume;y.gain.setValueAtTime(e,m.ctx.currentTime),a._playStart=m.ctx.currentTime,void 0===y.bufferSource.start?a._loop?y.bufferSource.noteGrainOn(0,l,86400):y.bufferSource.noteGrainOn(0,l,c):a._loop?y.bufferSource.start(0,l,86400):y.bufferSource.start(0,l,c),u!=1/0&&(r._endTimers[a._id]=setTimeout(r._ended.bind(r,a),u)),n||setTimeout(function(){r._emit("play",a._id),r._loadQueue()},0)};"running"===m.state?f():(r._playLock=!0,r.once("resume",f),r._clearTimer(a._id))}else{var d=function playHtml5(){y.currentTime=l,y.muted=a._muted||r._muted||m._muted||y.muted,y.volume=a._volume*m.volume(),y.playbackRate=a._rate;try{var e=y.play();if(e&&"undefined"!=typeof Promise&&(e instanceof Promise||"function"==typeof e.then)?(r._playLock=!0,$b(),e.then(function(){r._playLock=!1,y._unlocked=!0,n||(r._emit("play",a._id),r._loadQueue())}).catch(function(){r._playLock=!1,r._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0})):n||(r._playLock=!1,$b(),r._emit("play",a._id),r._loadQueue()),y.playbackRate=a._rate,y.paused)return void r._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?r._endTimers[a._id]=setTimeout(r._ended.bind(r,a),u):(r._endTimers[a._id]=function(){r._ended(a),y.removeEventListener("ended",r._endTimers[a._id],!1)},y.addEventListener("ended",r._endTimers[a._id],!1))}catch(e){r._emit("playerror",a._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===y.src&&(y.src=r._src,y.load());var g=window&&window.ejecta||!y.readyState&&m._navigator.isCocoonJS;if(3<=y.readyState||g)d();else{r._playLock=!0;y.addEventListener(m._canPlayEvent,function listener(){d(),y.removeEventListener(m._canPlayEvent,listener,!1)},!1),r._clearTimer(a._id)}}return a._id}r._ended(a)},pause:function pause(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"pause",action:function action(){n.pause(e)}}),n;for(var r=n._getSoundIds(e),o=0;o<r.length;o++){n._clearTimer(r[o]);var i=n._soundById(r[o]);if(i&&!i._paused&&(i._seek=n.seek(r[o]),i._rateSeek=0,i._paused=!0,n._stopFade(r[o]),i._node))if(n._webAudio){if(!i._node.bufferSource)continue;void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),n._cleanBuffer(i._node)}else isNaN(i._node.duration)&&i._node.duration!==1/0||i._node.pause();t||n._emit("pause",i?i._id:null)}return n},stop:function stop(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function action(){n.stop(e)}}),n;for(var r=n._getSoundIds(e),o=0;o<r.length;o++){n._clearTimer(r[o]);var i=n._soundById(r[o]);i&&(i._seek=i._start||0,i._rateSeek=0,i._paused=!0,i._ended=!0,n._stopFade(r[o]),i._node&&(n._webAudio?i._node.bufferSource&&(void 0===i._node.bufferSource.stop?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),n._cleanBuffer(i._node)):isNaN(i._node.duration)&&i._node.duration!==1/0||(i._node.currentTime=i._start||0,i._node.pause(),i._node.duration===1/0&&n._clearSound(i._node))),t||n._emit("stop",i._id))}return n},mute:function mute(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function action(){n.mute(e,t)}}),n;if(void 0===t){if("boolean"!=typeof e)return n._muted;n._muted=e}for(var r=n._getSoundIds(t),o=0;o<r.length;o++){var i=n._soundById(r[o]);i&&(i._muted=e,i._interval&&n._stopFade(i._id),n._webAudio&&i._node?i._node.gain.setValueAtTime(e?0:i._volume,m.ctx.currentTime):i._node&&(i._node.muted=!!m._muted||e),n._emit("mute",i._id))}return n},volume:function volume(){var e,t,n,r=this,o=arguments;if(0===o.length)return r._volume;if(1===o.length||2===o.length&&void 0===o[1]?0<=r._getSoundIds().indexOf(o[0])?t=parseInt(o[0],10):e=parseFloat(o[0]):2<=o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10)),!(void 0!==e&&0<=e&&e<=1))return(n=t?r._soundById(t):r._sounds[0])?n._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function action(){r.volume.apply(r,o)}}),r;void 0===t&&(r._volume=e),t=r._getSoundIds(t);for(var i=0;i<t.length;i++)(n=r._soundById(t[i]))&&(n._volume=e,o[2]||r._stopFade(t[i]),r._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(e,m.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=e*m.volume()),r._emit("volume",n._id));return r},fade:function fade(e,t,n,r){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function action(){o.fade(e,t,n,r)}}),o;e=parseFloat(e),t=parseFloat(t),n=parseFloat(n),o.volume(e,r);for(var i=o._getSoundIds(r),a=0;a<i.length;a++){var s=o._soundById(i[a]);if(s){if(r||o._stopFade(i[a]),o._webAudio&&!s._muted){var l=m.ctx.currentTime,c=l+n/1e3;s._volume=e,s._node.gain.setValueAtTime(e,l),s._node.gain.linearRampToValueAtTime(t,c)}o._startFadeInterval(s,e,t,n,i[a],void 0===r)}}return o},_startFadeInterval:function _startFadeInterval(t,n,r,o,e,i){var a=this,s=n,l=r-n,c=Math.abs(l/.01),u=Math.max(4,0<c?o/c:o),p=Date.now();t._fadeTo=r,t._interval=setInterval(function(){var e=(Date.now()-p)/o;p=Date.now(),s+=l*e,s=Math.max(0,s),s=Math.min(1,s),s=Math.round(100*s)/100,a._webAudio?t._volume=s:a.volume(s,t._id,!0),i&&(a._volume=s),(r<n&&s<=r||n<r&&r<=s)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,a.volume(r,t._id),a._emit("fade",t._id))},u)},_stopFade:function _stopFade(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(m.ctx.currentTime),clearInterval(n._interval),n._interval=null,t.volume(n._fadeTo,e),n._fadeTo=null,t._emit("fade",e)),t},loop:function loop(){var loop,e,t,n=this,r=arguments;if(0===r.length)return n._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(t=n._soundById(parseInt(r[0],10)))&&t._loop;loop=r[0],n._loop=loop}else 2===r.length&&(loop=r[0],e=parseInt(r[1],10));for(var o=n._getSoundIds(e),i=0;i<o.length;i++)(t=n._soundById(o[i]))&&(t._loop=loop,n._webAudio&&t._node&&t._node.bufferSource&&(t._node.bufferSource.loop=loop)&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop));return n},rate:function rate(){var rate,e,t,n=this,r=arguments;if(0===r.length)e=n._sounds[0]._id;else if(1===r.length){0<=n._getSoundIds().indexOf(r[0])?e=parseInt(r[0],10):rate=parseFloat(r[0])}else 2===r.length&&(rate=parseFloat(r[0]),e=parseInt(r[1],10));if("number"!=typeof rate)return(t=n._soundById(e))?t._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function action(){n.rate.apply(n,r)}}),n;void 0===e&&(n._rate=rate),e=n._getSoundIds(e);for(var o=0;o<e.length;o++)if(t=n._soundById(e[o])){n.playing(e[o])&&(t._rateSeek=n.seek(e[o]),t._playStart=n._webAudio?m.ctx.currentTime:t._playStart),t._rate=rate,n._webAudio&&t._node&&t._node.bufferSource?t._node.bufferSource.playbackRate.setValueAtTime(rate,m.ctx.currentTime):t._node&&(t._node.playbackRate=rate);var i=n.seek(e[o]),a=1e3*((n._sprite[t._sprite][0]+n._sprite[t._sprite][1])/1e3-i)/Math.abs(t._rate);!n._endTimers[e[o]]&&t._paused||(n._clearTimer(e[o]),n._endTimers[e[o]]=setTimeout(n._ended.bind(n,t),a)),n._emit("rate",t._id)}return n},seek:function seek(){var seek,e,t=this,n=arguments;if(0===n.length)e=t._sounds[0]._id;else if(1===n.length){0<=t._getSoundIds().indexOf(n[0])?e=parseInt(n[0],10):t._sounds.length&&(e=t._sounds[0]._id,seek=parseFloat(n[0]))}else 2===n.length&&(seek=parseFloat(n[0]),e=parseInt(n[1],10));if(void 0===e)return t;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"seek",action:function action(){t.seek.apply(t,n)}}),t;var r=t._soundById(e);if(r){if(!("number"==typeof seek&&0<=seek)){if(t._webAudio){var o=t.playing(e)?m.ctx.currentTime-r._playStart:0,i=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(i+o*Math.abs(r._rate))}return r._node.currentTime}var a=t.playing(e);a&&t.pause(e,!0),r._seek=seek,r._ended=!1,t._clearTimer(e),t._webAudio||!r._node||isNaN(r._node.duration)||(r._node.currentTime=seek);var s=function seekAndEmit(){t._emit("seek",e),a&&t.play(e,!0)};if(a&&!t._webAudio){setTimeout(function emitSeek(){t._playLock?setTimeout(emitSeek,0):s()},0)}else s()}return t},playing:function playing(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var n=0;n<this._sounds.length;n++)if(!this._sounds[n]._paused)return!0;return!1},duration:function duration(e){var duration=this._duration,t=this._soundById(e);return t&&(duration=this._sprite[t._sprite][1]/1e3),duration},state:function state(){return this._state},unload:function unload(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(m._canPlayEvent,t[n]._loadFn,!1),m._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var r=m._howls.indexOf(e);0<=r&&m._howls.splice(r,1);var o=!0;for(n=0;n<m._howls.length;n++)if(m._howls[n]._src===e._src||0<=e._src.indexOf(m._howls[n]._src)){o=!1;break}return a&&o&&delete a[e._src],m.noAudio=!1,e._state="unloaded",e._sounds=[],e=null},on:function on(e,t,n,r){var o=this["_on"+e];return"function"==typeof t&&o.push(r?{id:n,fn:t,once:r}:{id:n,fn:t}),this},off:function off(e,t,n){var r=this,o=r["_on"+e],i=0;if("number"==typeof t&&(n=t,t=null),t||n)for(i=0;i<o.length;i++){var a=n===o[i].id;if(t===o[i].fn&&a||!t&&a){o.splice(i,1);break}}else if(e)r["_on"+e]=[];else{var s=Object.keys(r);for(i=0;i<s.length;i++)0===s[i].indexOf("_on")&&Array.isArray(r[s[i]])&&(r[s[i]]=[])}return r},once:function once(e,t,n){return this.on(e,t,n,1),this},_emit:function _emit(e,t,n){for(var r=this,o=r["_on"+e],i=o.length-1;0<=i;i--)o[i].id&&o[i].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(r,o[i].fn),0),o[i].once&&r.off(e,o[i].fn,o[i].id));return r._loadQueue(e),r},_loadQueue:function _loadQueue(e){var t=this;if(0<t._queue.length){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function _ended(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!(!e._loop&&!t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=m.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),o)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),m._autoSuspend()),t._webAudio||r||t.stop(e._id,!0),t},_clearTimer:function _clearTimer(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function _soundById(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function _inactiveSound(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new i(e)},_drain:function _drain(){var e=this,t=e._pool,n=0,r=0;if(!(e._sounds.length<t)){for(r=0;r<e._sounds.length;r++)e._sounds[r]._ended&&n++;for(r=e._sounds.length-1;0<=r;r--){if(n<=t)return;e._sounds[r]._ended&&(e._webAudio&&e._sounds[r]._node&&e._sounds[r]._node.disconnect(0),e._sounds.splice(r,1),n--)}}},_getSoundIds:function _getSoundIds(e){if(void 0!==e)return[e];for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t},_refreshBuffer:function _refreshBuffer(e){return e._node.bufferSource=m.ctx.createBufferSource(),e._node.bufferSource.buffer=a[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,m.ctx.currentTime),this},_cleanBuffer:function _cleanBuffer(e){var t=m._navigator&&0<=m._navigator.vendor.indexOf("Apple");if(m._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=m._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function _clearSound(e){/MSIE |Trident\//.test(m._navigator&&m._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function Sound(e){this._parent=e,this.init()};i.prototype={init:function init(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++m._counter,t._sounds.push(e),e.create(),e},create:function create(){var e=this,t=e._parent,n=m._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),e._node.gain.setValueAtTime(n,m.ctx.currentTime),e._node.paused=!0,e._node.connect(m.masterGain)):m.noAudio||(e._node=m._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(m._canPlayEvent,e._loadFn,!1),e._node.src=t._src,e._node.preload="auto",e._node.volume=n*m.volume(),e._node.load()),e},reset:function reset(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++m._counter,e},_errorListener:function _errorListener(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function _loadListener(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(m._canPlayEvent,this._loadFn,!1)}};var a={},s=function loadBuffer(t){var e=t._src;if(a[e])return t._duration=a[e].duration,void u(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);c(r.buffer,t)}else{var i=new XMLHttpRequest;i.open("GET",e,!0),i.withCredentials=t._xhrWithCredentials,i.responseType="arraybuffer",i.onload=function(){var e=(i.status+"")[0];"0"===e||"2"===e||"3"===e?c(i.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+i.status+".")},i.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete a[e],t.load())},l(i)}},l=function safeXhrSend(t){try{t.send()}catch(e){t.onerror()}},c=function decodeAudioData(e,t){function pf(){t._emit("loaderror",null,"Decoding audio data failed.")}function qf(e){e&&0<t._sounds.length?(a[t._src]=e,u(t,e)):pf()}"undefined"!=typeof Promise&&1===m.ctx.decodeAudioData.length?m.ctx.decodeAudioData(e).then(qf).catch(pf):m.ctx.decodeAudioData(e,qf,pf)},u=function loadSound(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},p=function setupAudioContext(){if(m.usingWebAudio){try{"undefined"!=typeof AudioContext?m.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?m.ctx=new webkitAudioContext:m.usingWebAudio=!1}catch(e){m.usingWebAudio=!1}m.ctx||(m.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(m._navigator&&m._navigator.platform),t=m._navigator&&m._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var r=/safari/.test(m._navigator&&m._navigator.userAgent.toLowerCase());(m._navigator&&m._navigator.standalone&&!r||m._navigator&&!m._navigator.standalone&&!r)&&(m.usingWebAudio=!1)}m.usingWebAudio&&(m.masterGain=void 0===m.ctx.createGain?m.ctx.createGainNode():m.ctx.createGain(),m.masterGain.gain.setValueAtTime(m._muted?0:m._volume,m.ctx.currentTime),m.masterGain.connect(m.ctx.destination)),m._setup()}};void 0===(t=function(){return{Howler:m,Howl:Ba}}.apply(r,[]))||(n.exports=t),r.Howler=m,r.Howl=Ba,"undefined"!=typeof window?(window.HowlerGlobal=za,window.Howler=m,window.Howl=Ba,window.Sound=i):void 0!==e&&(e.HowlerGlobal=za,e.Howler=m,e.Howl=Ba,e.Sound=i)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.1.3
 *  howlerjs.com
 *
 *  (c) 2013-2019, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){"use strict";var n,r,o;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;0<=n;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var r=this;return r.ctx&&r.ctx.listener?(t="number"!=typeof t?r._pos[1]:t,n="number"!=typeof n?r._pos[2]:n,"number"!=typeof e?r._pos:(r._pos=[e,t,n],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(e,t,n,r,o,i){var a=this;if(!a.ctx||!a.ctx.listener)return a;var s=a._orientation;return t="number"!=typeof t?s[1]:t,n="number"!=typeof n?s[2]:n,r="number"!=typeof r?s[3]:r,o="number"!=typeof o?s[4]:o,i="number"!=typeof i?s[5]:i,"number"!=typeof e?s:(a._orientation=[e,t,n,r,o,i],void 0!==a.ctx.listener.forwardX?(a.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),a.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),a.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),a.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),a.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),a.ctx.listener.upZ.setTargetAtTime(i,Howler.ctx.currentTime,.1)):a.ctx.listener.setOrientation(e,t,n,r,o,i),a)},Howl.prototype.init=(n=Howl.prototype.init,function(e){var t=this;return t._orientation=e.orientation||[1,0,0],t._stereo=e.stereo||null,t._pos=e.pos||null,t._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},t._onstereo=e.onstereo?[{fn:e.onstereo}]:[],t._onpos=e.onpos?[{fn:e.onpos}]:[],t._onorientation=e.onorientation?[{fn:e.onorientation}]:[],n.call(this,e)}),Howl.prototype.stereo=function(e,t){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function action(){n.stereo(e,t)}}),n;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===t){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var o=n._getSoundIds(t),i=0;i<o.length;i++){var a=n._soundById(o[i]);if(a){if("number"!=typeof e)return a._stereo;a._stereo=e,a._pos=[e,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||c(a,r),"spatial"==r?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(e,0,0):a._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",a._id)}}return n},Howl.prototype.pos=function(e,t,n,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function action(){o.pos(e,t,n,r)}}),o;if(t="number"!=typeof t?0:t,n="number"!=typeof n?-.5:n,void 0===r){if("number"!=typeof e)return o._pos;o._pos=[e,t,n]}for(var i=o._getSoundIds(r),a=0;a<i.length;a++){var s=o._soundById(i[a]);if(s){if("number"!=typeof e)return s._pos;s._pos=[e,t,n],s._node&&(s._panner&&!s._panner.pan||c(s,"spatial"),void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):s._panner.setPosition(e,t,n)),o._emit("pos",s._id)}}return o},Howl.prototype.orientation=function(e,t,n,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function action(){o.orientation(e,t,n,r)}}),o;if(t="number"!=typeof t?o._orientation[1]:t,n="number"!=typeof n?o._orientation[2]:n,void 0===r){if("number"!=typeof e)return o._orientation;o._orientation=[e,t,n]}for(var i=o._getSoundIds(r),a=0;a<i.length;a++){var s=o._soundById(i[a]);if(s){if("number"!=typeof e)return s._orientation;s._orientation=[e,t,n],s._node&&(s._panner||(s._pos||(s._pos=o._pos||[0,0,-.5]),c(s,"spatial")),void 0!==s._panner.orientationX?(s._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),s._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),s._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):s._panner.setOrientation(e,t,n)),o._emit("orientation",s._id)}}return o},Howl.prototype.pannerAttr=function(){var e,t,n,r=this,o=arguments;if(!r._webAudio)return r;if(0===o.length)return r._pannerAttr;if(1===o.length){if("object"!==_typeof(o[0]))return(n=r._soundById(parseInt(o[0],10)))?n._pannerAttr:r._pannerAttr;e=o[0],void 0===t&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:r._panningModel})}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var i=r._getSoundIds(t),a=0;a<i.length;a++)if(n=r._soundById(i[a])){var s=n._pannerAttr;s={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:s.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:s.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:s.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:s.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:s.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:s.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:s.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:s.panningModel};var l=n._panner;l?(l.coneInnerAngle=s.coneInnerAngle,l.coneOuterAngle=s.coneOuterAngle,l.coneOuterGain=s.coneOuterGain,l.distanceModel=s.distanceModel,l.maxDistance=s.maxDistance,l.refDistance=s.refDistance,l.rolloffFactor=s.rolloffFactor,l.panningModel=s.panningModel):(n._pos||(n._pos=r._pos||[0,0,-.5]),c(n,"spatial"))}return r},Sound.prototype.init=(r=Sound.prototype.init,function(){var e=this,t=e._parent;e._orientation=t._orientation,e._stereo=t._stereo,e._pos=t._pos,e._pannerAttr=t._pannerAttr,r.call(this),e._stereo?t.stereo(e._stereo):e._pos&&t.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}),Sound.prototype.reset=(o=Sound.prototype.reset,function(){var e=this,t=e._parent;return e._orientation=t._orientation,e._stereo=t._stereo,e._pos=t._pos,e._pannerAttr=t._pannerAttr,e._stereo?t.stereo(e._stereo):e._pos?t.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,t._refreshBuffer(e)),o.call(this)});var c=function setupPanner(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}).call(this,e(2))},function(i,c,h){var x;!function(){function aa(e,t,n){return e.call.apply(e.bind,arguments)}function ba(t,n,e){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,r),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function p(e,t,n){return(p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aa:ba).apply(null,arguments)}var a=Date.now||function(){return+new Date};function ca(e,t){this.a=e,this.o=t||e,this.c=this.o.document}var s=!!window.FontFace;function t(e,t,n,r){if(t=e.c.createElement(t),n)for(var o in n)n.hasOwnProperty(o)&&("style"==o?t.style.cssText=n[o]:t.setAttribute(o,n[o]));return r&&t.appendChild(e.c.createTextNode(r)),t}function u(e,t,n){(e=e.c.getElementsByTagName(t)[0])||(e=document.documentElement),e.insertBefore(n,e.lastChild)}function v(e){e.parentNode&&e.parentNode.removeChild(e)}function w(e,t,n){t=t||[],n=n||[];for(var r=e.className.split(/\s+/),o=0;o<t.length;o+=1){for(var i=!1,a=0;a<r.length;a+=1)if(t[o]===r[a]){i=!0;break}i||r.push(t[o])}for(t=[],o=0;o<r.length;o+=1){for(i=!1,a=0;a<n.length;a+=1)if(r[o]===n[a]){i=!0;break}i||t.push(r[o])}e.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function y(e,t){for(var n=e.className.split(/\s+/),r=0,o=n.length;r<o;r++)if(n[r]==t)return!0;return!1}function z(e,n,r){function d(){a&&o&&(a(i),a=null)}n=t(e,"link",{rel:"stylesheet",href:n,media:"all"});var o=!1,i=null,a=r||null;s?(n.onload=function(){o=!0,d()},n.onerror=function(){o=!0,i=Error("Stylesheet failed to load"),d()}):setTimeout(function(){o=!0,d()},0),u(e,"head",n)}function A(e,n,r,o){var i=e.c.getElementsByTagName("head")[0];if(i){var a=t(e,"script",{src:n}),s=!1;return a.onload=a.onreadystatechange=function(){s||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(s=!0,r&&r(null),a.onload=a.onreadystatechange=null,"HEAD"==a.parentNode.tagName&&i.removeChild(a))},i.appendChild(a),setTimeout(function(){s||(s=!0,r&&r(Error("Script load timeout")))},o||5e3),a}return null}function B(){this.a=0,this.c=null}function C(e){return e.a++,function(){e.a--,D(e)}}function E(e,t){e.c=t,D(e)}function D(e){0==e.a&&e.c&&(e.c(),e.c=null)}function F(e){this.a=e||"-"}function G(e,t){this.c=e,this.f=4,this.a="n";var n=(t||"n4").match(/^([nio])([1-9])$/i);n&&(this.a=n[1],this.f=parseInt(n[2],10))}function I(e){var t=[];e=e.split(/,\s*/);for(var n=0;n<e.length;n++){var r=e[n].replace(/['"]/g,"");-1!=r.indexOf(" ")||/^\d/.test(r)?t.push("'"+r+"'"):t.push(r)}return t.join(",")}function J(e){return e.a+e.f}function H(e){var t="normal";return"o"===e.a?t="oblique":"i"===e.a&&(t="italic"),t}function ha(e,t){this.c=e,this.f=e.o.document.documentElement,this.h=t,this.a=new F("-"),this.j=!1!==t.events,this.g=!1!==t.classes}function L(e){if(e.g){var t=y(e.f,e.a.c("wf","active")),n=[],r=[e.a.c("wf","loading")];t||n.push(e.a.c("wf","inactive")),w(e.f,n,r)}K(e,"inactive")}function K(e,t,n){e.j&&e.h[t]&&(n?e.h[t](n.c,J(n)):e.h[t]())}function ja(){this.c={}}function M(e,n){this.c=e,this.f=n,this.a=t(this.c,"span",{"aria-hidden":"true"},this.f)}function N(e){u(e.c,"body",e.a)}function O(e){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+I(e.c)+";font-style:"+H(e)+";font-weight:"+e.f+"00;"}function P(e,t,n,r,o,i){this.g=e,this.j=t,this.a=r,this.c=n,this.f=o||3e3,this.h=i||void 0}function Q(e,t,n,r,o,i,a){this.v=e,this.B=t,this.c=n,this.a=r,this.s=a||"BESbswy",this.f={},this.w=o||3e3,this.u=i||null,this.m=this.j=this.h=this.g=null,this.g=new M(this.c,this.s),this.h=new M(this.c,this.s),this.j=new M(this.c,this.s),this.m=new M(this.c,this.s),e=O(e=new G(this.a.c+",serif",J(this.a))),this.g.a.style.cssText=e,e=O(e=new G(this.a.c+",sans-serif",J(this.a))),this.h.a.style.cssText=e,e=O(e=new G("serif",J(this.a))),this.j.a.style.cssText=e,e=O(e=new G("sans-serif",J(this.a))),this.m.a.style.cssText=e,N(this.g),N(this.h),N(this.j),N(this.m)}F.prototype.c=function(e){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.a)},P.prototype.start=function(){var n=this.c.o.document,r=this,o=a(),e=new Promise(function(t,e){!function f(){a()-o>=r.f?e():n.fonts.load(function fa(e){return H(e)+" "+e.f+"00 300px "+I(e.c)}(r.a),r.h).then(function(e){1<=e.length?t():setTimeout(f,25)},function(){e()})}()}),i=null,t=new Promise(function(e,t){i=setTimeout(t,r.f)});Promise.race([t,e]).then(function(){i&&(clearTimeout(i),i=null),r.g(r.a)},function(){r.j(r.a)})};var o={D:"serif",C:"sans-serif"},n=null;function T(){if(null===n){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);n=!!e&&(parseInt(e[1],10)<536||536===parseInt(e[1],10)&&parseInt(e[2],10)<=11)}return n}function la(e,t,n){for(var r in o)if(o.hasOwnProperty(r)&&t===e.f[o[r]]&&n===e.f[o[r]])return!0;return!1}function U(e){var t,n=e.g.a.offsetWidth,r=e.h.a.offsetWidth;(t=n===e.f.serif&&r===e.f["sans-serif"])||(t=T()&&la(e,n,r)),t?a()-e.A>=e.w?T()&&la(e,n,r)&&(null===e.u||e.u.hasOwnProperty(e.a.c))?V(e,e.v):V(e,e.B):function ma(e){setTimeout(p(function(){U(this)},e),50)}(e):V(e,e.v)}function V(e,t){setTimeout(p(function(){v(this.g.a),v(this.h.a),v(this.j.a),v(this.m.a),t(this.a)},e),0)}function W(e,t,n){this.c=e,this.a=t,this.f=0,this.m=this.j=!1,this.s=n}Q.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=a(),U(this)};var g=null;function na(e){0==--e.f&&e.j&&(e.m?((e=e.a).g&&w(e.f,[e.a.c("wf","active")],[e.a.c("wf","loading"),e.a.c("wf","inactive")]),K(e,"active")):L(e.a))}function oa(e){this.j=e,this.a=new ja,this.h=0,this.f=this.g=!0}function ra(e,t){this.c=e,this.a=t}function sa(e,t){this.c=e,this.a=t}function ta(e,t){this.c=e||"https://fonts.googleapis.com/css",this.a=[],this.f=[],this.g=t||""}W.prototype.g=function(e){var t=this.a;t.g&&w(t.f,[t.a.c("wf",e.c,J(e).toString(),"active")],[t.a.c("wf",e.c,J(e).toString(),"loading"),t.a.c("wf",e.c,J(e).toString(),"inactive")]),K(t,"fontactive",e),this.m=!0,na(this)},W.prototype.h=function(e){var t=this.a;if(t.g){var n=y(t.f,t.a.c("wf",e.c,J(e).toString(),"active")),r=[],o=[t.a.c("wf",e.c,J(e).toString(),"loading")];n||r.push(t.a.c("wf",e.c,J(e).toString(),"inactive")),w(t.f,r,o)}K(t,"fontinactive",e),na(this)},oa.prototype.load=function(e){this.c=new ca(this.j,e.context||this.j),this.g=!1!==e.events,this.f=!1!==e.classes,function pa(o,e,t){var n=[],r=t.timeout;!function ia(e){e.g&&w(e.f,[e.a.c("wf","loading")]),K(e,"loading")}(e);n=function ka(e,t,n){var r,o=[];for(r in t)if(t.hasOwnProperty(r)){var i=e.c[r];i&&o.push(i(t[r],n))}return o}(o.a,t,o.c);var i=new W(o.c,e,r);for(o.h=n.length,e=0,t=n.length;e<t;e++)n[e].load(function(e,t,n){var r,c,u,h,y,f;c=i,u=e,h=t,y=n,f=0==--(r=o).h,(r.f||r.g)&&setTimeout(function(){var e=y||null,t=h||{};if(0===u.length&&f)L(c.a);else{c.f+=u.length,f&&(c.j=f);var n,r=[];for(n=0;n<u.length;n++){var o=u[n],i=t[o.c],a=c.a,s=o;if(a.g&&w(a.f,[a.a.c("wf",s.c,J(s).toString(),"loading")]),K(a,"fontloading",s),(a=null)===g)if(window.FontFace){var s=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),l=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);g=s?42<parseInt(s[1],10):!l}else g=!1;a=g?new P(p(c.g,c),p(c.h,c),c.c,o,c.s,i):new Q(p(c.g,c),p(c.h,c),c.c,o,c.s,e,i),r.push(a)}for(n=0;n<r.length;n++)r[n].start()}},0)})}(this,new ha(this.c,e),e)},ra.prototype.load=function(i){var t=this,a=t.a.projectId,e=t.a.version;if(a){var s=t.c.o;A(this.c,(t.a.api||"https://fast.fonts.net/jsapi")+"/"+a+".js"+(e?"?v="+e:""),function(e){e?i([]):(s["__MonotypeConfiguration__"+a]=function(){return t.a},function b(){if(s["__mti_fntLst"+a]){var e,t=s["__mti_fntLst"+a](),n=[];if(t)for(var r=0;r<t.length;r++){var o=t[r].fontfamily;null!=t[r].fontStyle&&null!=t[r].fontWeight?(e=t[r].fontStyle+t[r].fontWeight,n.push(new G(o,e))):n.push(new G(o))}i(n)}else setTimeout(function(){b()},50)}())}).id="__MonotypeAPIScript__"+a}else i([])},sa.prototype.load=function(e){var t,n,r=this.a.urls||[],o=this.a.families||[],i=this.a.testStrings||{},a=new B;for(t=0,n=r.length;t<n;t++)z(this.c,r[t],C(a));var s=[];for(t=0,n=o.length;t<n;t++)if((r=o[t].split(":"))[1])for(var l=r[1].split(","),c=0;c<l.length;c+=1)s.push(new G(r[0],l[c]));else s.push(new G(r[0]));E(a,function(){e(s,i)})};function ya(e){this.f=e,this.a=[],this.c={}}var m={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},_={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},S={i:"i",italic:"i",n:"n",normal:"n"},k=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function Ea(e,t){this.c=e,this.a=t}var l={Arimo:!0,Cousine:!0,Tinos:!0};function Ga(e,t){this.c=e,this.a=t}function Ha(e,t){this.c=e,this.f=t,this.a=[]}Ea.prototype.load=function(e){var t=new B,n=this.c,r=new ta(this.a.api,this.a.text),o=this.a.families;!function va(e,t){for(var n=t.length,r=0;r<n;r++){var o=t[r].split(":");3==o.length&&e.f.push(o.pop());var i="";2==o.length&&""!=o[1]&&(i=":"),e.a.push(o.join(i))}}(r,o);var i=new ya(o);!function Da(e){for(var t=e.f.length,n=0;n<t;n++){var r=e.f[n].split(":"),o=r[0].replace(/\+/g," "),i=["n4"];if(2<=r.length){var a;if(a=[],s=r[1])for(var s,l=(s=s.split(",")).length,c=0;c<l;c++){var u;if((u=s[c]).match(/^[\w-]+$/))if(null==(h=k.exec(u.toLowerCase())))u="";else{if(u=null==(u=h[2])||""==u?"n":S[u],null==(h=h[1])||""==h)h="4";else var p=_[h],h=p||(isNaN(h)?"4":h.substr(0,1));u=[u,h].join("")}else u="";u&&a.push(u)}0<a.length&&(i=a),3==r.length&&(a=[],0<(r=(r=r[2])?r.split(","):a).length&&(r=m[r[0]])&&(e.c[o]=r))}for(e.c[o]||(r=m[o])&&(e.c[o]=r),r=0;r<i.length;r+=1)e.a.push(new G(o,i[r]))}}(i),z(n,function wa(e){if(0==e.a.length)throw Error("No fonts to load!");if(-1!=e.c.indexOf("kit="))return e.c;for(var t=e.a.length,n=[],r=0;r<t;r++)n.push(e.a[r].replace(/ /g,"+"));return t=e.c+"?family="+n.join("%7C"),0<e.f.length&&(t+="&subset="+e.f.join(",")),0<e.g.length&&(t+="&text="+encodeURIComponent(e.g)),t}(r),C(t)),E(t,function(){e(i.a,i.c,l)})},Ga.prototype.load=function(a){var e=this.a.id,s=this.c.o;e?A(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",function(e){if(e)a([]);else if(s.Typekit&&s.Typekit.config&&s.Typekit.config.fn){e=s.Typekit.config.fn;for(var t=[],n=0;n<e.length;n+=2)for(var r=e[n],o=e[n+1],i=0;i<o.length;i++)t.push(new G(r,o[i]));try{s.Typekit.load({events:!1,classes:!1,async:!0})}catch(e){}a(t)}},2e3):a([])},Ha.prototype.load=function(c){var e=this.f.id,t=this.c.o,u=this;e?(t.__webfontfontdeckmodule__||(t.__webfontfontdeckmodule__={}),t.__webfontfontdeckmodule__[e]=function(e,t){for(var n=0,r=t.fonts.length;n<r;++n){var o=t.fonts[n];u.a.push(new G(o.name,(i="font-weight:"+o.weight+";font-style:"+o.style,l=s=a=void 0,a=4,s="n",l=null,i&&((l=i.match(/(normal|oblique|italic)/i))&&l[1]&&(s=l[1].substr(0,1).toLowerCase()),(l=i.match(/([1-9]00|normal|bold)/i))&&l[1]&&(/bold/i.test(l[1])?a=7:/[1-9]00/.test(l[1])&&(a=parseInt(l[1].substr(0,1),10)))),s+a)))}var i,a,s,l;c(u.a)},A(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function ea(e){return e.o.location.hostname||e.a.location.hostname}(this.c)+"/"+e+".js",function(e){e&&c([])})):c([])};var e=new oa(window);e.a.c.custom=function(e,t){return new sa(t,e)},e.a.c.fontdeck=function(e,t){return new Ha(t,e)},e.a.c.monotype=function(e,t){return new ra(t,e)},e.a.c.typekit=function(e,t){return new Ga(t,e)},e.a.c.google=function(e,t){return new Ea(t,e)};var r={load:p(e.load,e)};void 0===(x=function(){return r}.call(c,h,c,i))||(i.exports=x)}()},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?function _assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}n.r(t);var r=function(){function MPGame(e){var t;return function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MPGame),(t=_possibleConstructorReturn(this,_getPrototypeOf(MPGame).call(this,e))).gameScale=e.gameScale,t.gameScaleExtension="_"+t.gameScale.toString().replace(".","_"),t.buttonSize="tablet",window.matchMedia("(min-width: 815px)").matches||(t.buttonSize="mobile"),t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(MPGame,Phaser.Game),MPGame}();function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function MPUtils(){!function MPUtils_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MPUtils)}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(MPUtils,null,[{key:"GetRootElement",value:function GetRootElement(){return document.getElementById("local-game-holder")}},{key:"GetAssetURL",value:function GetAssetURL(){return MPUtils.GetGameDir()+"bin/"}},{key:"GetGameDir",value:function GetGameDir(){return""}},{key:"ClassNameToString",value:function ClassNameToString(e){var t=e.name;if(!e.name){var n=e.toString();t=n.substring(n.indexOf(" ")+1,n.indexOf("("))}return t}},{key:"CloneArray",value:function CloneArray(e){return JSON.parse(JSON.stringify(e))}},{key:"SliceArrayMultipleRandom",value:function SliceArrayMultipleRandom(e,t,n){for(var r=[],o=0;o<t;o++){var i=Phaser.Math.Between(0,e.length-1);n||r.push(e[i]),e.slice(i)}return n?e:r}},{key:"QuickSliceArray",value:function QuickSliceArray(e,t,n){var r=t||e[n],o=t?e.indexOf(t):n;return e.splice(o,1),{array:e,object:r}}},{key:"Vibrate",value:function Vibrate(e){e||(e=100),window.navigator&&window.navigator.vibrate&&window.navigator.vibrate(e)}},{key:"ShuffleArray",value:function ShuffleArray(e){for(var t,n,r=e.length;0!==r;)n=Math.floor(Math.random()*r),t=e[r-=1],e[r]=e[n],e[n]=t}},{key:"AddChild",value:function AddChild(e,t){t&&(t.add.existing?t.add.existing(e):t.add(e))}},{key:"GetAngleDifference",value:function GetAngleDifference(e,t){var n=MPUtils.Repeat(e-t,360);return 180<n&&(n-=360),n}},{key:"RotateVector2",value:function RotateVector2(e,t){var n={x:e.x,y:e.y},r=Phaser.Math.DegToRad(t),o=Math.sin(r),i=Math.cos(r),a=n.x,s=n.y;return n.x=i*a-o*s,n.y=o*a+i*s,n}},{key:"NearestMultiple",value:function NearestMultiple(e,t){return Math.ceil(e/t)*t}},{key:"Repeat",value:function Repeat(e,t){return e-Math.floor(e/t)*t}},{key:"ClampTextToDimensions",value:function ClampTextToDimensions(e,t,n){if(e.width>t||e.height>n){var r=Math.max(e.width/t,e.height/n),o=parseInt(e.style.fontSize)/r;e.setFontSize(o-1)}}},{key:"ConvertTiledProperties",value:function ConvertTiledProperties(e){if(e.properties.length){for(var t={},n=0;n<e.properties.length;n++)t[e.properties[n].name]=e.properties[n].value;e.properties=t}}},{key:"ApplyWinterSkin",value:function ApplyWinterSkin(e){if(1<e.skeletonData.skins.length)for(var t=e.skeletonData.skins,n=0;n<t.length;n++){var r=t[n];if("winter"===r.name){e.setSkin(r);break}}}}]),MPUtils}();Phaser.Physics.Matter.World.prototype.setBounds=function(e,t,n,r,o,i,a,s,l){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=this.scene.sys.scale.width),void 0===r&&(r=this.scene.sys.scale.height),void 0===o&&(o=128),void 0===i&&(i=!0),void 0===a&&(a=!0),s||(s=!0),void 0===l&&(l=!0),this.updateWall(i,"left",e-o,t-o,o,r+2*o),this.updateWall(a,"right",e+n,t-o,o,r+2*o),this.updateWall(s,"top",e,t-o,n,o),this.updateWall(l,"bottom",e,t+r,n,o),this};function Sl(e,t,n,r,o){var i=t.node,a=i.style;if(!i||!a||Phaser.GameObjects.GameObject.RENDER_MASK!==t.renderFlags||0!==t.cameraFilter&&t.cameraFilter&r.id||t.parentContainer&&!t.parentContainer.willRender())i&&(a.display="none");else{var s=t.parentContainer,l=r.alpha*t.alpha;s&&(l*=s.alpha);var c=e._tempMatrix1,u=e._tempMatrix2,p=e._tempMatrix3,h=0,y=0,f="0%",d="0%";o?(h=t.width*t.scaleX*t.originX,y=t.height*t.scaleY*t.originY,u.applyITRS(t.x-h,t.y-y,t.rotation,t.scaleX,t.scaleY),c.copyFrom(r.matrix),c.multiplyWithOffset(o,-r.scrollX*t.scrollFactorX,-r.scrollY*t.scrollFactorY),u.e=t.x-h,u.f=t.y-y):(h=t.width*t.originX,y=t.height*t.originY,u.applyITRS(t.x-h,t.y-y,t.rotation,t.scaleX,t.scaleY),c.copyFrom(r.matrix),f=100*t.originX+"%",d=100*t.originY+"%",u.e-=r.scrollX*t.scrollFactorX,u.f-=r.scrollY*t.scrollFactorY),c.multiply(u,p),t.transformOnly||(a.display="block",a.opacity=l,a.zIndex=t._depth,a.pointerEvents="none",a.mixBlendMode=Phaser.BlendModes[t._blendMode]),a.transform=p.getCSSMatrix()+" skew("+t.skewX+"rad, "+t.skewY+"rad) rotate3d("+t.rotate3d.x+","+t.rotate3d.y+","+t.rotate3d.z+","+t.rotate3d.w+t.rotate3dAngle+")",a.transformOrigin=f+" "+d;var g=i.getBoundingClientRect();t.displayWidth=g.width,t.displayHeight=g.height}}Phaser.GameObjects.DOMElement.prototype.renderCanvas=Sl,Phaser.GameObjects.DOMElement.prototype.renderWebGL=Sl,Phaser.Game.prototype.step=function(e,t){if(this.pendingDestroy)return this.runDestroy();this.speed&&1!=this.speed&&(t*=this.speed);var n=this.events;n.emit(Phaser.Core.Events.PRE_STEP,e,t),n.emit(Phaser.Core.Events.STEP,e,t),this.scene.update(e,t),n.emit(Phaser.Core.Events.POST_STEP,e,t);var r=this.renderer;r.preRender(),n.emit(Phaser.Core.Events.PRE_RENDER,r,e,t),this.scene.render(r),r.postRender(),n.emit(Phaser.Core.Events.POST_RENDER,r,e,t)};var o=Phaser.Input.Pointer.prototype.touchstart;Phaser.Input.Pointer.prototype.touchstart=function(e,t){o.call(this,e,t),this.downTime=t.timeStamp};var i=Phaser.Input.Pointer.prototype.touchend;function SceneManager_typeof(e){return(SceneManager_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SceneManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SceneManager_getPrototypeOf(e){return(SceneManager_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SceneManager_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SceneManager_setPrototypeOf(e,t){return(SceneManager_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}Phaser.Input.Pointer.prototype.touchend=function(e,t){i.call(this,e,t),this.upTime=t.timeStamp},Math.sign||(Math.sign=function(e){return 0<=e?1:-1}),String.prototype.padStart||(String.prototype.padStart=function padStart(e,t){return e>>=0,t=String(void 0!==t?t:" "),this.length>=e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))});var a=function(){function SceneManager(e){var t;return function SceneManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SceneManager),t=function SceneManager_possibleConstructorReturn(e,t){return!t||"object"!==SceneManager_typeof(t)&&"function"!=typeof t?SceneManager_assertThisInitialized(e):t}(this,SceneManager_getPrototypeOf(SceneManager).call(this,e)),SceneManager.Instance=SceneManager_assertThisInitialized(t),t.activeScenes=[],t.events=new Phaser.Events.EventEmitter,t}return function SceneManager_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SceneManager_setPrototypeOf(e,t)}(SceneManager,Phaser.Plugins.BasePlugin),function SceneManager_createClass(e,t,n){return t&&SceneManager_defineProperties(e.prototype,t),n&&SceneManager_defineProperties(e,n),e}(SceneManager,[{key:"StartScene",value:function StartScene(e,t){null==t&&(t={}),t.additive=void 0!==t.additive&&t.additive;var n=I.ClassNameToString(e);this.activeScenes.push(n),this.game.scene.add(n,e,!0,t)}},{key:"StopScene",value:function StopScene(e){var t=this.activeScenes.indexOf(e);0<=t&&this.activeScenes.splice(t,1),setTimeout(function(){this.game.scene.getScene(e).Destroy(),this.game.scene.remove(e)}.bind(this),1)}},{key:"StartLoadingScene",value:function StartLoadingScene(e,t,n){null==n&&(n={}),n.sceneToLoad=t,this.StartScene(e,n)}},{key:"StartTransitionScene",value:function StartTransitionScene(e,t,n){this.StartScene(e,{additive:!0,callback:t,context:n})}},{key:"OnSceneInit",value:function OnSceneInit(e){if(!e.data.additive)for(var t=this.activeScenes.length-1;0<=t;t--){if(this.activeScenes[t]!==e.key)this.game.scene.getScene(this.activeScenes[t]).dontDestroyOnLoad||this.StopScene(this.activeScenes[t])}this.events.emit("sceneInit",e.key)}},{key:"PauseAllScenes",value:function PauseAllScenes(){for(var e=0;e<this.activeScenes.length;e++)this.game.scene.pause(this.activeScenes[e])}},{key:"ResumeAllScenes",value:function ResumeAllScenes(){for(var e=0;e<this.activeScenes.length;e++)this.game.scene.resume(this.activeScenes[e])}},{key:"SleepAllScenes",value:function SleepAllScenes(){for(var e=0;e<this.activeScenes.length;e++)this.game.scene.sleep(this.activeScenes[e])}},{key:"WakeAllScenes",value:function WakeAllScenes(){for(var e=0;e<this.activeScenes.length;e++)this.game.scene.wake(this.activeScenes[e])}}]),SceneManager}();function AccessibilityManager_typeof(e){return(AccessibilityManager_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AccessibilityManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AccessibilityManager_getPrototypeOf(e){return(AccessibilityManager_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AccessibilityManager_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AccessibilityManager_setPrototypeOf(e,t){return(AccessibilityManager_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var s=function(){function AccessibilityManager(e){var t;return function AccessibilityManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AccessibilityManager),t=function AccessibilityManager_possibleConstructorReturn(e,t){return!t||"object"!==AccessibilityManager_typeof(t)&&"function"!=typeof t?AccessibilityManager_assertThisInitialized(e):t}(this,AccessibilityManager_getPrototypeOf(AccessibilityManager).call(this,e)),AccessibilityManager.Instance=AccessibilityManager_assertThisInitialized(t),t.div=document.createElement("div"),t.div.id="subtitles",t.div.style.zIndex=20,I.GetRootElement().appendChild(t.div),t.div.className+="subtitles",t.language="en",t.entries=[],t.visibleTime=0,t.visibleTimer=0,t.textVisible=!1,t.subtitlesEnabled=!1,t.subtitlesData={},t}return function AccessibilityManager_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AccessibilityManager_setPrototypeOf(e,t)}(AccessibilityManager,Phaser.Plugins.BasePlugin),function AccessibilityManager_createClass(e,t,n){return t&&AccessibilityManager_defineProperties(e.prototype,t),n&&AccessibilityManager_defineProperties(e,n),e}(AccessibilityManager,[{key:"start",value:function start(){this.game.events.on("step",this.update,this)}},{key:"update",value:function update(e,t){for(var n=!1,r=this.entries.length-1;0<=r;r--)this.entries[r].timer+=.001*t,this.entries[r].timer>this.entries[r].time&&(this.entries.splice(r,1),n=!0);n&&this.SetText()}},{key:"SetSubtitlesData",value:function SetSubtitlesData(e,t){this.language=t||Pr.Instance.config.language,this.subtitlesData=e}},{key:"ToggleSubtitlesEnabled",value:function ToggleSubtitlesEnabled(){this.SetSubtitlesEnabled(!this.subtitlesEnabled)}},{key:"SetSubtitlesEnabled",value:function SetSubtitlesEnabled(e){this.subtitlesEnabled=e,this.game.events.emit("subtitlesEnabled",e)}},{key:"GetSubtitleText",value:function GetSubtitleText(e){return this.subtitlesData?this.subtitlesData[this.language][e]:null}},{key:"RemoveEntry",value:function RemoveEntry(e){if(void 0!==e&&this.subtitlesEnabled){var t=this.GetSubtitleText(e)||e;if(null!=t){for(var n=!1,r=t.split("\n"),o=0;o<r.length;o++)for(var i=this.entries.length-1;0<=i;i--)this.entries[i].text===r[o]&&(this.entries.splice(i,1),n=!0);n&&this.SetText()}}}},{key:"ClearSubtitles",value:function ClearSubtitles(){this.entries.length=0,this.SetText()}},{key:"ShowSubtitle",value:function ShowSubtitle(e,t){if(void 0!==e&&this.subtitlesEnabled){var n=this.GetSubtitleText(e)||e;if(null!=n){if(0===t)t=.4*n.split(" ").length;var r=n.split("\n");if(r.length<=1)t+=1,this.visibleTimer=0,this.visibleTime+=t,this.entries.push({text:n,time:t,timer:0});else{for(var o=0,i=0;i<r.length;i++){var a=t*(r[i].length/n.length);this.entries.push({text:r[i],time:a,timer:o}),o-=a}this.visibleTimer=0,this.visibleTime+=t+1}if(3<this.entries.length)for(var s=this.entries.length;3<s;s--)this.entries.shift();this.SetText()}}}},{key:"SetText",value:function SetText(){for(var e="",t=[],n=0;n<this.entries.length;n++)if(!(this.entries[n].timer<0)){for(var r=!1,o=0;o<t.length;o++)t[o]===this.entries[n].text&&(r=!0);r||(0!==n&&(e+="<br/>"),e+=this.entries[n].text,t.push(this.entries[n].text))}this.div.innerHTML=e}}]),AccessibilityManager}(),l=n(0);function AudioSound_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function AudioSound(e,t,n){!function AudioSound_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AudioSound),this.game=e,this.key=t,this.sound=new l.Howl({src:h.Instance.howlCache[t].src}),this.sound.loop(void 0!==n.loop&&n.loop),this.subtitles=void 0!==n.subtitles&&n.subtitles,this.fadeVolumeTween=null}return function AudioSound_createClass(e,t,n){return t&&AudioSound_defineProperties(e.prototype,t),n&&AudioSound_defineProperties(e,n),e}(AudioSound,[{key:"Play",value:function Play(e){var t=e&&void 0!==e.volume?e.volume:1,n=!e||void 0===e.restart||e.restart,r=e&&void 0!==e.loop?e.loop:this.sound.loop,o=e&&void 0!==e.subtitles?e.subtitles:this.subtitles,i=(e&&void 0!==e.detune&&e.detune,this.IsPlaying());!n&&i||(this.SetVolume(t),this.sound.loop(r),this.sound.play(),o&&s.Instance.ShowSubtitle(this.key,this.sound.totalDuration))}},{key:"SetMute",value:function SetMute(e){this.sound.mute(e)}},{key:"SetVolume",value:function SetVolume(e){this.sound.volume(e)}},{key:"FadeVolume",value:function FadeVolume(e,t){this.fadeVolumeTween&&this.fadeVolumeTween.stop(),this.volumeTweenValue=this.sound._volume,e.tweens.add({targets:this,volumeTweenValue:t,duration:1e4,onUpdate:this.OnVolumeTweenUpdate,onUpdateScope:this})}},{key:"OnVolumeTweenUpdate",value:function OnVolumeTweenUpdate(){this.SetVolume(this.volumeTweenValue)}},{key:"Pause",value:function Pause(){this.sound.pause()}},{key:"Resume",value:function Resume(){this.IsPlaying()&&this.sound.play()}},{key:"IsPlaying",value:function IsPlaying(){for(var e=0;e<this.sound._sounds.length;e++)if(!this.sound._sounds[e]._ended)return!0;return!1}},{key:"Stop",value:function Stop(){this.IsPlaying()&&(this.sound.stop(),this.subtitles&&s.Instance.RemoveEntry(this.key))}},{key:"Destroy",value:function Destroy(){this.Stop()}}]),AudioSound}();function AudioLayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function AudioLayer(e,t,n){!function AudioLayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AudioLayer),this.game=e,this.key=t,this.config=n,this.sounds=[],this.allowMultiple=void 0===n.allowMultiple||n.allowMultiple,this.loop=void 0!==n.loop&&n.loop,this.subtitles=void 0!==n.subtitles&&n.subtitles,this.restart=void 0===n.restart||n.restart}return function AudioLayer_createClass(e,t,n){return t&&AudioLayer_defineProperties(e.prototype,t),n&&AudioLayer_defineProperties(e,n),e}(AudioLayer,[{key:"AddSound",value:function AddSound(e){var t=this.GetSound(e);t||(t=new c(this.game,e,this.config),this.sounds.push(t))}},{key:"GetSound",value:function GetSound(e){for(var t=0;t<this.sounds.length;t++)if(this.sounds[t].key==e)return this.sounds[t]}},{key:"PlaySound",value:function PlaySound(e,t){var n=this.GetSound(e);if(!this.allowMultiple){var r=t&&void 0!==t.restart?t.restart:this.restart,o=n.IsPlaying();if(r)this.StopAllSounds();else if(this.StopAllSounds(n.key),o)return}n.Play(t)}},{key:"StopSound",value:function StopSound(e){this.GetSound(e).Stop()}},{key:"StopAllSounds",value:function StopAllSounds(e){for(var t=0;t<this.sounds.length;t++)this.sounds[t].key!=e&&this.sounds[t].Stop()}},{key:"FadeOutAllSounds",value:function FadeOutAllSounds(e){for(var t=0;t<this.sounds.length;t++)this.sounds[t].FadeOut(e)}},{key:"Pause",value:function Pause(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].Pause()}},{key:"Resume",value:function Resume(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].Resume()}},{key:"SetMute",value:function SetMute(e){for(var t=0;t<this.sounds.length;t++)this.sounds[t].SetMute(e)}},{key:"SetVolume",value:function SetVolume(e){for(var t=0;t<this.sounds.length;t++)this.sounds[t].SetVolume(e)}},{key:"FadeVolume",value:function FadeVolume(e,t,n,r){for(var o=0;o<this.sounds.length;o++)this.sounds[o].FadeVolume(e,t,n,r)}},{key:"Destroy",value:function Destroy(){for(var e=0;e<this.sounds.length;e++)this.sounds[e].Destroy();this.sounds=[]}}]),AudioLayer}();function SaveDataManager_typeof(e){return(SaveDataManager_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SaveDataManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SaveDataManager_getPrototypeOf(e){return(SaveDataManager_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SaveDataManager_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SaveDataManager_setPrototypeOf(e,t){return(SaveDataManager_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var p=function(){function SaveDataManager(e){var t;return function SaveDataManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SaveDataManager),t=function SaveDataManager_possibleConstructorReturn(e,t){return!t||"object"!==SaveDataManager_typeof(t)&&"function"!=typeof t?SaveDataManager_assertThisInitialized(e):t}(this,SaveDataManager_getPrototypeOf(SaveDataManager).call(this,e)),SaveDataManager.Instance=SaveDataManager_assertThisInitialized(t),t.id="cn_gumball_party_save_data",t.data=[],t.LoadFromStorage(),t}return function SaveDataManager_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SaveDataManager_setPrototypeOf(e,t)}(SaveDataManager,Phaser.Plugins.BasePlugin),function SaveDataManager_createClass(e,t,n){return t&&SaveDataManager_defineProperties(e.prototype,t),n&&SaveDataManager_defineProperties(e,n),e}(SaveDataManager,[{key:"GetData",value:function GetData(e){for(var t=0;t<this.data.length;t++)if(this.data[t].id==e)return this.data[t].value;return null}},{key:"SaveData",value:function SaveData(e,t){for(var n=null,r=0;r<this.data.length;r++)this.data[r].id==e&&(n=this.data[r]);n?n.value=t:this.data.push({id:e,value:t})}},{key:"LoadFromStorage",value:function LoadFromStorage(){var e=this.FetchDataFromStorage();e&&(this.data=I.CloneArray(e))}},{key:"FetchDataFromStorage",value:function FetchDataFromStorage(){var e=this.id;if(Pr.Instance.gmi){e=e.toString();var t=Pr.Instance.gmi.getAllSettings().gameData;return t&&null!==t[e]&&void 0!==t[e]?t[e]:null}var n=window.localStorage.getItem(e);try{for(var r in localStorage)localStorage[r].length&&2*localStorage[r].length;return JSON.parse(n)}catch(e){console.log(e)}return null}},{key:"SaveToStorage",value:function SaveToStorage(){if(Pr.Instance.gmi)Pr.Instance.gmi.setGameData(this.id,CloneArray(this.data));else try{window.localStorage.setItem(this.id,JSON.stringify(this.data))}catch(e){console.error("Failed to save data, check console"),console.log(CloneObject(this.data,!0)),console.log(e)}}},{key:"ClearKey",value:function ClearKey(e){for(var t=0;t<this.data.length;t++)if(this.data[t].id==e)return void this.data.splice(t,1)}},{key:"ClearData",value:function ClearData(e){this.data=[],e?window.localStorage.clear():this.LoadFromStorage()}}]),SaveDataManager}();function AudioManager_typeof(e){return(AudioManager_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AudioManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AudioManager_getPrototypeOf(e){return(AudioManager_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AudioManager_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AudioManager_setPrototypeOf(e,t){return(AudioManager_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(){function AudioManager(e){var t;return function AudioManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AudioManager),_defineProperty(AudioManager_assertThisInitialized(t=function AudioManager_possibleConstructorReturn(e,t){return!t||"object"!==AudioManager_typeof(t)&&"function"!=typeof t?AudioManager_assertThisInitialized(e):t}(this,AudioManager_getPrototypeOf(AudioManager).call(this,e))),"OnWindowBlur",function(){l.Howler.mute(!0)}),_defineProperty(AudioManager_assertThisInitialized(t),"OnWindowFocus",function(){l.Howler.mute(!this.audioEnabled)}),_defineProperty(AudioManager_assertThisInitialized(t),"OnVisibilityChange",function(){"hidden"==document.visibilityState?this.OnWindowBlur():this.OnWindowFocus()}),AudioManager.Instance=AudioManager_assertThisInitialized(t),t.audioEnabled=!0,t.layers=[],t.howlCache={},t.LoadData(),t.onWindowBlur=t.OnWindowBlur.bind(AudioManager_assertThisInitialized(t)),t.onWindowFocus=t.OnWindowFocus.bind(AudioManager_assertThisInitialized(t)),t.onVisibilityChange=t.OnVisibilityChange.bind(AudioManager_assertThisInitialized(t)),window.addEventListener("blur",t.onWindowBlur),window.addEventListener("focus",t.onWindowFocus),document.addEventListener("visibilitychange",t.onVisibilityChange),t}return function AudioManager_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AudioManager_setPrototypeOf(e,t)}(AudioManager,Phaser.Plugins.BasePlugin),function AudioManager_createClass(e,t,n){return t&&AudioManager_defineProperties(e.prototype,t),n&&AudioManager_defineProperties(e,n),e}(AudioManager,[{key:"AddLayer",value:function AddLayer(e,t){var n=this.GetLayer(e);if(n||(n=new u(this.game,e,t),this.layers.push(n)),t.audioKeys)for(var r=0;r<t.audioKeys.length;r++)n.AddSound(t.audioKeys[r])}},{key:"GetLayerIndex",value:function GetLayerIndex(e){for(var t=0;t<this.layers.length;t++)if(this.layers[t].key==e)return t}},{key:"GetLayer",value:function GetLayer(e){var t=this.GetLayerIndex(e);return this.layers[t]}},{key:"SetLayerVolume",value:function SetLayerVolume(e,t){var n=this.GetLayer(e);n&&n.SetVolume(t)}},{key:"FadeLayerVolume",value:function FadeLayerVolume(e,t,n,r,o){var i=this.GetLayer(e);i&&i.FadeVolume(t,n,r,o)}},{key:"Play",value:function Play(e,t,n){this.GetLayer(e).PlaySound(t,n)}},{key:"Stop",value:function Stop(e,t){this.GetLayer(e).StopSound(t)}},{key:"FadeVolume",value:function FadeVolume(e,t,n,r,o,i){var a=this.GetLayer(e);if(a){var s=a.GetSound(t);s&&s.FadeVolume(n,r,o,i)}}},{key:"StopLayer",value:function StopLayer(e){var t=this.GetLayer(e);t&&t.StopAllSounds()}},{key:"PauseLayer",value:function PauseLayer(e){var t=this.GetLayer(e);t&&t.Pause()}},{key:"ResumeLayer",value:function ResumeLayer(e){var t=this.GetLayer(e);t&&t.Resume()}},{key:"ToggleAudioEnabled",value:function ToggleAudioEnabled(){this.SetAudioEnabled(!this.audioEnabled)}},{key:"SetAudioEnabled",value:function SetAudioEnabled(e){this.audioEnabled=e,this.game.sound.mute=!e,l.Howler.mute(!this.audioEnabled),this.game.events.emit("audioEnabled",e),this.SaveData()}},{key:"DestroyLayer",value:function DestroyLayer(e){var t=this.GetLayerIndex(e);this.GetLayer(e).Destroy(),this.layers.splice(t,1)}},{key:"SaveData",value:function SaveData(){p.Instance.SaveData("AudioManager",{audioEnabled:this.audioEnabled}),p.Instance.SaveToStorage()}},{key:"LoadData",value:function LoadData(){var e=p.Instance.GetData("AudioManager");e&&(this.audioEnabled=e.audioEnabled),this.game.sound.mute=!this.audioEnabled,l.Howler.mute(!this.audioEnabled)}},{key:"LoadHowlSound",value:function LoadHowlSound(e){if(!this.howlCache[e.key])return this.howlCache[e.key]={src:e.url},new l.Howl({src:e.url})}}]),AudioManager}();function MPScene_typeof(e){return(MPScene_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MPScene_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MPScene_possibleConstructorReturn(e,t){return!t||"object"!==MPScene_typeof(t)&&"function"!=typeof t?function MPScene_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MPScene_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MPScene_getPrototypeOf(e){return(MPScene_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MPScene_setPrototypeOf(e,t){return(MPScene_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var y=function(){function MPScene(e){var t;return function MPScene_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MPScene),(t=MPScene_possibleConstructorReturn(this,MPScene_getPrototypeOf(MPScene).call(this))).key=e,t}return function MPScene_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MPScene_setPrototypeOf(e,t)}(MPScene,Phaser.Scene),function MPScene_createClass(e,t,n){return t&&MPScene_defineProperties(e.prototype,t),n&&MPScene_defineProperties(e,n),e}(MPScene,[{key:"init",value:function init(){this.deviceManager=Pr.Instance.deviceManager,this.dontDestroyOnLoad=!1,this.gameScale=this.game.gameScale,this.viewport=new Phaser.Structs.Size(this.scale.width,this.scale.height,this.game.scale.scaleMode),this.viewport.setAspectRatio(this.scale.parentSize.aspectRatio),this.scale.on("resize",this.Resize,this),this.world=this.add.container(0,0),this.ui=this.add.container(0,0),this.dom=this.add.container(0,0),this.sys.events.on("wake",this.OnWake,this),this.sys.events.on("sleep",this.OnSleep,this),a.Instance.OnSceneInit(this.sys.settings)}},{key:"preload",value:function preload(){}},{key:"create",value:function create(){this.debug=Pr.Instance.config&&Pr.Instance.config.debug,this.debugFps=Pr.Instance.config&&Pr.Instance.config.debugFps,this.matter.world.drawDebug=this.debug&&Pr.Instance.config&&Pr.Instance.config.debugDrawPhysics,this.debugFps&&this.ShowFPS(),this.debugSpeedKey=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SHIFT)}},{key:"update",value:function update(e,t){_get(MPScene_getPrototypeOf(MPScene.prototype),"update",this).call(this,e,t),this.debugFps&&(this.fpsCounter.text=Math.floor(this.game.loop.actualFps),this.children.last!==this.fpsCounter&&this.children.bringToTop(this.fpsCounter)),this.debug&&(this.debugSpeedKey.isDown?this.game.speed=5:this.game.speed=1)}},{key:"Resize",value:function Resize(){this.viewport.setAspectRatio(this.scale.parentSize.aspectRatio)}},{key:"ShowFPS",value:function ShowFPS(){this.fpsCounter=this.add.text(.5*this.scale.width,.05*this.scale.height,"00",{fontSize:24*this.gameScale+"px",fill:"#00ff00"}),this.fpsCounter.setOrigin(.5)}},{key:"OnAudioButtonPressed",value:function OnAudioButtonPressed(e){h.Instance.SetAudioEnabled(e)}},{key:"OnWake",value:function OnWake(){}},{key:"OnSleep",value:function OnSleep(){}},{key:"Destroy",value:function Destroy(){}}]),MPScene}();function MPDOMClasses_typeof(e){return(MPDOMClasses_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MPDOMClasses_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b=function(){function MPDOMClasses(){!function MPDOMClasses_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MPDOMClasses)}return function MPDOMClasses_createClass(e,t,n){return t&&MPDOMClasses_defineProperties(e.prototype,t),n&&MPDOMClasses_defineProperties(e,n),e}(MPDOMClasses,null,[{key:"LoadData",value:function LoadData(e,t){MPDOMClasses.data=e.cache.json.get(t)}},{key:"GetClassConfig",value:function GetClassConfig(e){for(var t=e.split(" "),n=t.length,r=[t.slice(0)],o=1;o<n;o++){r[o]=[];for(var i=0;i<n;i++)for(var a=i;a<=n;a++)if(!(n<=a+o)){for(var s=t[i],l=1;l<=o;l++)s+=" "+t[a+l];r[o].push(s)}}var c=[];n=r.length;for(o=0;o<n;o++){var u=r[o].length;for(i=0;i<u;i++)for(var p in MPDOMClasses.data)p==r[o][i]&&c.push(MPDOMClasses.data[p])}var h={};n=c.length;for(o=0;o<n;o++)MPDOMClasses.ObjectExtend(h,c[o]);return h}},{key:"ObjectExtend",value:function ObjectExtend(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])arguments[t].hasOwnProperty(n)&&("object"===MPDOMClasses_typeof(e[n])&&"object"===MPDOMClasses_typeof(arguments[t][n])?MPDOMClasses.ObjectExtend(e[n],arguments[t][n]):e[n]=arguments[t][n]);return e}}]),MPDOMClasses}();function ElementPosition_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(){function ElementPosition(e,t,n){!function ElementPosition_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ElementPosition),n||(n={}),this.scene=e,this.target=t,this.viewX=void 0!==n.x?n.x:0,this.viewY=void 0!==n.y?n.y:0,this.offsetX=void 0!==n.offsetX?n.offsetX:0,this.offsetY=void 0!==n.offsetY?n.offsetY:0,this.local=void 0===n.local||n.local,this.scene.scale.on("resize",this.UpdatePosition,this),this.UpdatePosition(),setTimeout(this.UpdatePosition.bind(this),50)}return function ElementPosition_createClass(e,t,n){return t&&ElementPosition_defineProperties(e.prototype,t),n&&ElementPosition_defineProperties(e,n),e}(ElementPosition,[{key:"UpdatePosition",value:function UpdatePosition(){if(this.scene&&this.target){var e=.5*(this.scene.scale.width-this.scene.viewport.width),t=.5*(this.scene.scale.height-this.scene.viewport.height);if(this.local||this.target.fixedToCamera||!this.target.parentContainer){this.target.fixedToCamera?this.target.cameraOffset:this.target,this.target.x=e+this.scene.viewport.width*this.viewX+this.offsetX,this.target.y=t+this.scene.viewport.height*this.viewY+this.offsetY,this.target.fixedToCamera&&this.target.cameraOffset.setTo(this.target.x,this.target.y)}else{var n=0,r=0;this.target.x=e+(this.scene.viewport.width*this.viewX+this.offsetX)-n,this.target.y=t+(this.scene.viewport.height*this.viewY+this.offsetY)-r}}}},{key:"destroy",value:function destroy(){this.scene&&(this.scene.scale.off("resize",this.UpdatePosition,this),this.scene=null,this.target=null)}}]),ElementPosition}();function MPDOMPanel_typeof(e){return(MPDOMPanel_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MPDOMPanel_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MPDOMPanel_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MPDOMPanel_get(e,t,n){return(MPDOMPanel_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function MPDOMPanel_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MPDOMPanel_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MPDOMPanel_getPrototypeOf(e){return(MPDOMPanel_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MPDOMPanel_setPrototypeOf(e,t){return(MPDOMPanel_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var d=function(){function MPDOMPanel(e,t,n){var r;!function MPDOMPanel_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MPDOMPanel),n||(n={});var o=(b.GetClassConfig(n.domClass||"dom_panel")||{})[e.game.buttonSize]||{tablet:{},mobile:{}},i=n.x||o.x||.5,a=n.y||o.y||.5,s=n.offsetX||o.offsetX||0,l=n.offsetY||o.offsetY||0;return r=function MPDOMPanel_possibleConstructorReturn(e,t){return!t||"object"!==MPDOMPanel_typeof(t)&&"function"!=typeof t?MPDOMPanel_assertThisInitialized(e):t}(this,MPDOMPanel_getPrototypeOf(MPDOMPanel).call(this,e)),I.AddChild(MPDOMPanel_assertThisInitialized(r),t),r.offsetX=s,r.offsetY=l,r.elementPosition=new f(r.scene,MPDOMPanel_assertThisInitialized(r),{x:i,y:a,offsetX:r.offsetX*r.scene.gameScale,offsetY:r.offsetY*r.scene.gameScale,local:!1}),r.scene.scale.on("resize",r.UpdateScale,MPDOMPanel_assertThisInitialized(r)),r.UpdateScale(),r}return function MPDOMPanel_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MPDOMPanel_setPrototypeOf(e,t)}(MPDOMPanel,Phaser.GameObjects.Container),function MPDOMPanel_createClass(e,t,n){return t&&MPDOMPanel_defineProperties(e.prototype,t),n&&MPDOMPanel_defineProperties(e,n),e}(MPDOMPanel,[{key:"UpdateScale",value:function UpdateScale(){var e=this.scene.viewport.height/window.innerHeight;this.setScale(e),this.elementPosition.offsetX=this.offsetX*e,this.elementPosition.offsetY=this.offsetY*e,this.elementPosition.UpdatePosition()}},{key:"destroy",value:function destroy(){this.scene&&(this.scene.scale.off("resize",this.UpdateScale,this),this.elementPosition&&(this.elementPosition.destroy(),this.elementPosition=null),MPDOMPanel_get(MPDOMPanel_getPrototypeOf(MPDOMPanel.prototype),"destroy",this).call(this))}}]),MPDOMPanel}();function MPDOMButton_typeof(e){return(MPDOMButton_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MPDOMButton_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MPDOMButton_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MPDOMButton_get(e,t,n){return(MPDOMButton_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function MPDOMButton_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MPDOMButton_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MPDOMButton_getPrototypeOf(e){return(MPDOMButton_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MPDOMButton_setPrototypeOf(e,t){return(MPDOMButton_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var g=function(){function MPDOMButton(e,t,n){var r;!function MPDOMButton_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MPDOMButton),n||(n={});var o=n.x||0,i=n.y||0,a=n.frames||[],s=n.atlas||"ui_atlas",l=n.prefix||"",c=n.id||"domui_button",u=n.title||"Button",p=n.noDom||!1,h=(null!==n.domClass&&b.GetClassConfig(n.domClass||"dom_button std")||{})[e.game.buttonSize]||{tablet:{},mobile:{}},y=l+a[0],f=l+(1<a.length?a[1]:a[0]);r=function MPDOMButton_possibleConstructorReturn(e,t){return!t||"object"!==MPDOMButton_typeof(t)&&"function"!=typeof t?MPDOMButton_assertThisInitialized(e):t}(this,MPDOMButton_getPrototypeOf(MPDOMButton).call(this,e,o,i)),I.AddChild(MPDOMButton_assertThisInitialized(r),t),r.buttonOrigin=n.buttonOrigin||new Phaser.Math.Vector2(.5,.5),r.desktop=Pr.Instance.deviceManager.desktop,r.unselectedFrame=y,r.selectedFrame=f,r.prefix=l,r.buttonId=c,r.buttonTitle=u,r.noDom=p,r.tabIndex=n.tabIndex||-1,r.button=r.scene.add.sprite(0,0,s,y),r.button.setOrigin(r.buttonOrigin.x,r.buttonOrigin.y),r.add(r.button);var d=n.spriteWidth||h.spriteWidth||r.button.frame.realWidth,g=n.spriteHeight||h.spriteHeight||r.button.frame.realHeight,m=n.buttonWidth||h.buttonWidth||r.button.frame.realWidth,_=n.buttonHeight||h.buttonHeight||r.button.frame.realHeight,P=new Phaser.Geom.Point(m,_);return r.buttonSize=P,r.baseImageScale=new Phaser.Geom.Point(d/r.button.frame.realWidth,g/r.button.frame.realHeight),r.button.setScale(r.baseImageScale.x,r.baseImageScale.y),r.button.setInteractive({useHandCursor:!0}),r._onMouseMove=r.OnMouseMove.bind(MPDOMButton_assertThisInitialized(r)),r._onKeyDown=r.OnKeyDown.bind(MPDOMButton_assertThisInitialized(r)),r.buttonClickAudio=null,r.buttonHoverAudioArray=[],r.hoverTweenConfig=null,r.voAudio=null,r.voAudioDelay=.15,r.attemptFullscreen=!0,r.inputEnabled=!0,r.isOver=!1,r.isDown=!1,r.buttonSelected=!1,r.enableOnResume=!1,n.callback&&r.SetCallbackFunction(n.callback,n.context),n.onDown&&(r.onDown=n.onDown,r.onDownContext=n.onDownContext),n.onOver&&(r.onOver=n.onOver,r.onOverContext=n.onOverContext),n.onOut&&(r.onOut=n.onOut,r.onOutContext=n.onOutContext),n.rolloverSound&&r.AddRolloverSound(n.rolloverSound),n.clickSound&&r.SetClickSound(n.clickSound),n.vo&&r.SetVOSound(n.vo),r}return function MPDOMButton_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MPDOMButton_setPrototypeOf(e,t)}(MPDOMButton,Phaser.GameObjects.Container),function MPDOMButton_createClass(e,t,n){return t&&MPDOMButton_defineProperties(e.prototype,t),n&&MPDOMButton_defineProperties(e,n),e}(MPDOMButton,[{key:"Enable",value:function Enable(e){this.inputEnabled=!0,this.buttonElement||this.CreateDOMButton(),this.buttonElement&&(e&&this.buttonElement.parent.insertBefore(this.buttonElement.node,e?e.nextSibling:null),this.buttonElement.visible=!0),this.button.on("pointerout",this.OnInputOut,this),this.button.on("pointerup",this.OnInputUp,this),this.button.on("pointerdown",this.OnInputDown,this),this.desktop&&this.button.on("pointerover",this.OnInputOver,this),this.scene.events.on("pause",this.OnPause,this),this.enableOnResume=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.document.addEventListener("keydown",this._onKeyDown,!1)}},{key:"Disable",value:function Disable(){this.scene.events.off("pause",this.OnPause,this),this.scene.events.on("resume",this.OnResume,this),this.enableOnResume=!1,this.inputEnabled=!1,this.buttonElement&&(this.buttonElement.visible=!1),this.button.off("pointerout",this.OnInputOut,this),this.button.off("pointerup",this.OnInputUp,this),this.button.off("pointerdown",this.OnInputDown,this),this.button.off("pointerover",this.OnInputOver,this),window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.document.removeEventListener("keydown",this._onKeyDown,!1)}},{key:"Show",value:function Show(){this.visible=!0,this.SetButtonSelected(!1)}},{key:"Hide",value:function Hide(){this.visible=!1}},{key:"SetCallbackFunction",value:function SetCallbackFunction(o,i){this._callback=function(e,t,n){if((!t.event||"mouseup"!=t.event.type||0==t.event.button)&&this.inputEnabled&&this.visible){this.buttonClickAudio&&h.Instance.Play(this.buttonClickAudio.layer,this.buttonClickAudio.key);var r=Pr.Instance.deviceManager;!this.attemptFullscreen||r.desktop||r.ipad||this.scene.scale.isFullscreen||r.disableFullscreen||this.scene.scale.startFullscreen(),this.OnInputOver(),o.call(i,e,t)}}}},{key:"CreateDOMButton",value:function CreateDOMButton(){var e={cursor:"pointer",width:this.buttonSize.x+"px",height:this.buttonSize.y+"px","background-color":this.debug?"rgba(255,0,0,0.5)":"transparent","border-style":"none"};this.buttonElement=this.scene.add.dom(0,0,"button",e),this.buttonElement.setOrigin(this.buttonOrigin.x,this.buttonOrigin.y),this.add(this.buttonElement),this.buttonElement.tabIndex=this.tabIndex,this.buttonElement.node.id=this.buttonId,this.buttonElement.node.setAttribute("aria-label",this.buttonTitle),(this.buttonElement.node.button=this).buttonElement.node.addEventListener("focus",function(e){this.button.isDown=!0,this.button.OnInputOver(this.button,this.button.scene.input.activePointer,e)}),this.buttonElement.node.addEventListener("focusout",function(e){this.button.isDown=!1,this.button.OnInputOut(this.button,this.button.scene.input.activePointer,e)}),this.desktop&&this.ForwardEvents()}},{key:"ForwardEvents",value:function ForwardEvents(e){if(this.buttonElement){e||(e=["click","mousedown","mousemove","mouseup","touchstart","touchmove","touchend"]);var t=function forwarder(e){var t=new e.constructor(e.type,e);this.scene.game.canvas.dispatchEvent(t),e.preventDefault()}.bind(this);e.forEach(function(e){this.buttonElement.node.addEventListener(e,t,!0)}.bind(this)),~e.indexOf("click")&&this.buttonElement.node.addEventListener("click",function(e){0===e.clientX&&0===e.clientY&&this.button.OnInputUp(this.button.button,this.button.scene.input.activePointer,e)})}}},{key:"OnInputOver",value:function OnInputOver(){if(this.scene&&!this.isOver&&!this.ShouldIgnore()){if(!this.isOver){for(var e=0;e<this.buttonHoverAudioArray.length;e++){var t=this.buttonHoverAudioArray[e];h.Instance.Play(t.layer,t.key)}this.voAudio&&h.Instance.Play(this.voAudio.layer,this.voAudio.key),this.hoverTweenConfig&&(this.hoverTween&&this.hoverTween.stop(),this.hoverTween=this.scene.tweens.add(this.hoverTweenConfig))}this.onOver&&this.onOver.call(this.onOverContext),this.isOver=!0,this.SetButtonSelected(!0)}}},{key:"OnInputOut",value:function OnInputOut(){if(this.scene){this.isOver&&this.hoverTween&&(this.hoverTween.restart(),this.hoverTween.stop()),this.onOut&&this.onOut.call(this.onOutContext),this.isOver=!1,this.isDown=!1,this.SetButtonSelected(!1);for(var e=0;e<this.buttonHoverAudioArray.length;e++){var t=this.buttonHoverAudioArray[e];h.Instance.Stop(t.layer,t.key)}}}},{key:"OnInputDown",value:function OnInputDown(){this.ShouldIgnore()||(this.isDown=!0,this.onDown&&this.onDown.call(this.onDownContext))}},{key:"OnInputUp",value:function OnInputUp(e,t,n,r){this.ShouldIgnore()||(this.isDown&&this.OnClick(e,t,n,r),this.isOver?this.ShouldIgnore()?this.OnInputOut():this.OnInputOver():this.OnInputOut())}},{key:"ShouldIgnore",value:function ShouldIgnore(){return this.scene&&this.scene.scene.manager.scenes[this.scene.scene.manager.scenes.length-1].key!=this.scene.key}},{key:"OnClick",value:function OnClick(e,t,n,r){this._callback&&this._callback.call(this,this.button,e,r)}},{key:"OnMouseMove",value:function OnMouseMove(){if(this.buttonElement&&this.isOver&&"none"!=this.buttonElement.node.style.outline){this.buttonElement.node.style.outline="none";for(var e=this.scene.input.activePointer,t=!0,n=0,r=this.scene.cameras.cameras.length;n<r;n++){var o=this.scene.cameras.cameras[n];if(this.scene.input.manager.hitTest(e,[this.button],o).length<=0){t=!1;break}}t||this.OnInputOut(this,e)}}},{key:"OnKeyDown",value:function OnKeyDown(e){this.buttonElement&&9===e.keyCode&&(this.buttonElement.node.style.outline="")}},{key:"SetFrames",value:function SetFrames(e){this.unselectedFrame=this.prefix+e[0],this.selectedFrame=this.prefix+(1<e.length?e[1]:e[0]),this.SetButtonSelected(this.buttonSelected)}},{key:"SetButtonSelected",value:function SetButtonSelected(e){this.buttonSelected=e,this.button.setFrame(e?this.selectedFrame:this.unselectedFrame)}},{key:"AddRolloverSound",value:function AddRolloverSound(e){this.buttonHoverAudioArray.push(e)}},{key:"SetHoverEffect",value:function SetHoverEffect(e){this.hoverTweenConfig=e,this.hoverTweenConfig.targets=this}},{key:"SetClickSound",value:function SetClickSound(e){this.buttonClickAudio=e}},{key:"SetVOSound",value:function SetVOSound(e){this.voAudio=e}},{key:"SetTitle",value:function SetTitle(e){this.buttonTitle=e,this.buttonElement&&this.buttonElement.node.setAttribute("aria-label",this.buttonTitle)}},{key:"OnPause",value:function OnPause(){this.enableOnResume&&(this.Hide(),this.Disable(),this.enableOnResume=!0)}},{key:"OnResume",value:function OnResume(){this.enableOnResume&&(this.scene.events.off("resume",this.OnResume,this),this.Show(),this.Enable())}},{key:"destroy",value:function destroy(){this.buttonHoverAudioArray=null,this.buttonClickAudio=null,this._callback=null,this.button&&(this.button.destroy(),this.button=null),this.buttonElement&&(this.buttonElement.destroy(),this.buttonElement=null),window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.document.removeEventListener("keydown",this._onKeyDown,!1),MPDOMButton_get(MPDOMButton_getPrototypeOf(MPDOMButton.prototype),"destroy",this).call(this)}}]),MPDOMButton}();function MPDOMToggleButton_typeof(e){return(MPDOMToggleButton_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MPDOMToggleButton_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MPDOMToggleButton_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MPDOMToggleButton_get(e,t,n){return(MPDOMToggleButton_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function MPDOMToggleButton_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MPDOMToggleButton_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MPDOMToggleButton_getPrototypeOf(e){return(MPDOMToggleButton_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MPDOMToggleButton_setPrototypeOf(e,t){return(MPDOMToggleButton_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var m=function(){function MPDOMToggleButton(e,t,n){var r;return function MPDOMToggleButton_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MPDOMToggleButton),r=function MPDOMToggleButton_possibleConstructorReturn(e,t){return!t||"object"!==MPDOMToggleButton_typeof(t)&&"function"!=typeof t?MPDOMToggleButton_assertThisInitialized(e):t}(this,MPDOMToggleButton_getPrototypeOf(MPDOMToggleButton).call(this,e,t,n)),n||(n={}),r.toggleActive=void 0===n.toggleActive||n.toggleActive,r.toggleOnFrames=n.frames,r.toggleOffFrames=n.toggleOffFrames,r.toggleEvent=n.toggleEvent,r.UpdateToggleFrames(),r.onToggle=n.onToggle,r.toggleEvent&&r.scene.game.events.on(r.toggleEvent,r.SetToggle,MPDOMToggleButton_assertThisInitialized(r)),r}return function MPDOMToggleButton_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MPDOMToggleButton_setPrototypeOf(e,t)}(MPDOMToggleButton,g),function MPDOMToggleButton_createClass(e,t,n){return t&&MPDOMToggleButton_defineProperties(e.prototype,t),n&&MPDOMToggleButton_defineProperties(e,n),e}(MPDOMToggleButton,[{key:"OnClick",value:function OnClick(e,t,n,r){MPDOMToggleButton_get(MPDOMToggleButton_getPrototypeOf(MPDOMToggleButton.prototype),"OnClick",this).call(this,e,t,n,r),this.SetToggle(!this.toggleActive),this.onToggle&&this.onToggle.call(this,this.toggleActive)}},{key:"SetToggle",value:function SetToggle(e){this.toggleActive=e,this.UpdateToggleFrames()}},{key:"UpdateToggleFrames",value:function UpdateToggleFrames(){this.toggleActive?this.SetFrames(this.toggleOnFrames):this.SetFrames(this.toggleOffFrames)}},{key:"destroy",value:function destroy(){this.scene&&(this.toggleEvent&&this.scene.game.events.off(this.toggleEvent,this.SetToggle,this),MPDOMToggleButton_get(MPDOMToggleButton_getPrototypeOf(MPDOMToggleButton.prototype),"destroy",this).call(this))}}]),MPDOMToggleButton}();function MainMenuScreen_typeof(e){return(MainMenuScreen_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MainMenuScreen_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MainMenuScreen_possibleConstructorReturn(e,t){return!t||"object"!==MainMenuScreen_typeof(t)&&"function"!=typeof t?function MainMenuScreen_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function MainMenuScreen_getPrototypeOf(e){return(MainMenuScreen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MainMenuScreen_setPrototypeOf(e,t){return(MainMenuScreen_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var _=function(){function MainMenuScreen(e){return function MainMenuScreen_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MainMenuScreen),MainMenuScreen_possibleConstructorReturn(this,MainMenuScreen_getPrototypeOf(MainMenuScreen).call(this,e))}return function MainMenuScreen_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MainMenuScreen_setPrototypeOf(e,t)}(MainMenuScreen,Phaser.GameObjects.Container),function MainMenuScreen_createClass(e,t,n){return t&&MainMenuScreen_defineProperties(e.prototype,t),n&&MainMenuScreen_defineProperties(e,n),e}(MainMenuScreen,[{key:"update",value:function update(){}},{key:"Resize",value:function Resize(){}},{key:"Enable",value:function Enable(){this.visible=!0}},{key:"Disable",value:function Disable(){this.visible=!1}}]),MainMenuScreen}();function AssetManager_typeof(e){return(AssetManager_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AssetManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AssetManager_getPrototypeOf(e){return(AssetManager_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AssetManager_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AssetManager_setPrototypeOf(e,t){return(AssetManager_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var P=function(){function AssetManager(e){var t;return function AssetManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AssetManager),t=function AssetManager_possibleConstructorReturn(e,t){return!t||"object"!==AssetManager_typeof(t)&&"function"!=typeof t?AssetManager_assertThisInitialized(e):t}(this,AssetManager_getPrototypeOf(AssetManager).call(this,e)),AssetManager.Instance=AssetManager_assertThisInitialized(t),t.pack=void 0,t.audioLoadProgress=1,t.audioFileCount=0,t.loadedAudioFileCount=0,t}return function AssetManager_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AssetManager_setPrototypeOf(e,t)}(AssetManager,Phaser.Plugins.BasePlugin),function AssetManager_createClass(e,t,n){return t&&AssetManager_defineProperties(e.prototype,t),n&&AssetManager_defineProperties(e,n),e}(AssetManager,[{key:"LoadAssetPacks",value:function LoadAssetPacks(e,t){for(var n=this.audioFileCount=0;n<t.length;n++)this.LoadAssetPack(e,t[n]);this.loadedAudioFileCount=0,this.audioLoadProgress=0<this.audioFileCount?0:1}},{key:"LoadAssetPack",value:function LoadAssetPack(e,t){var n=e.cache.json.get("assets");n[t]&&(this.LoadPack(e,t+".shared",n[t].shared),this.LoadPack(e,t+".gamescale",n[t]["gamescale"+this.game.gameScaleExtension]),s.Instance&&n[t].localised&&(n[t].localised["shared_"+s.Instance.language]&&this.LoadPack(e,t+".shared_"+s.Instance.language,n[t].localised["shared_"+s.Instance.language]),n[t].localised["gamescale"+this.game.gameScaleExtension+"_"+s.Instance.language]&&this.LoadPack(e,t+".gamescale_"+s.Instance.language,n[t].localised["gamescale"+this.game.gameScaleExtension+"_"+s.Instance.language])))}},{key:"LoadPack",value:function LoadPack(e,t,n){e.load.pack(t,n),this.LoadHowlerAudio(n)}},{key:"LoadHowlerAudio",value:function LoadHowlerAudio(e){if(e&&e.assets)for(var t=e.assets.files,n=0;n<t.length;n++)if("audio"==t[n].type){var r=h.Instance.LoadHowlSound(t[n]);r&&(this.audioFileCount++,r.once("load",this.OnLoadedHowlerAudio.bind(this)))}}},{key:"OnLoadedHowlerAudio",value:function OnLoadedHowlerAudio(){this.loadedAudioFileCount++,this.audioLoadProgress=this.loadedAudioFileCount/this.audioFileCount}}]),AssetManager}();function LoadingBar_typeof(e){return(LoadingBar_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LoadingBar_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LoadingBar_possibleConstructorReturn(e,t){return!t||"object"!==LoadingBar_typeof(t)&&"function"!=typeof t?function LoadingBar_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function LoadingBar_getPrototypeOf(e){return(LoadingBar_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function LoadingBar_setPrototypeOf(e,t){return(LoadingBar_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var S=function(){function LoadingBar(e,t){var n;return function LoadingBar_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LoadingBar),(n=LoadingBar_possibleConstructorReturn(this,LoadingBar_getPrototypeOf(LoadingBar).call(this,e))).background=n.scene.add.image(0,0,t.backKey,t.backFrame),n.add(n.background),n.fill=n.scene.add.image(0,0,t.fillKey,t.fillFrame),n.add(n.fill),n.progress=0,n.fill.setCrop(0,0,1,n.fill.height),n}return function LoadingBar_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LoadingBar_setPrototypeOf(e,t)}(LoadingBar,Phaser.GameObjects.Container),function LoadingBar_createClass(e,t,n){return t&&LoadingBar_defineProperties(e.prototype,t),n&&LoadingBar_defineProperties(e,n),e}(LoadingBar,[{key:"SetProgress",value:function SetProgress(e){this.progress=e,this.fill.setCrop(0,0,Math.max(1,this.fill.width*e),this.fill.height)}}]),LoadingBar}();function LoadingScreen_typeof(e){return(LoadingScreen_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LoadingScreen_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LoadingScreen_possibleConstructorReturn(e,t){return!t||"object"!==LoadingScreen_typeof(t)&&"function"!=typeof t?function LoadingScreen_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function LoadingScreen_get(e,t,n){return(LoadingScreen_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function LoadingScreen_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=LoadingScreen_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function LoadingScreen_getPrototypeOf(e){return(LoadingScreen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function LoadingScreen_setPrototypeOf(e,t){return(LoadingScreen_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var O=function(){function LoadingScreen(){var e;return function LoadingScreen_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LoadingScreen),(e=LoadingScreen_possibleConstructorReturn(this,LoadingScreen_getPrototypeOf(LoadingScreen).call(this,"LoadingScreen"))).progress=0,e.assetLoadProgress=0,e.progressSpeed=.01,e.finished=!1,e}return function LoadingScreen_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LoadingScreen_setPrototypeOf(e,t)}(LoadingScreen,y),function LoadingScreen_createClass(e,t,n){return t&&LoadingScreen_defineProperties(e.prototype,t),n&&LoadingScreen_defineProperties(e,n),e}(LoadingScreen,[{key:"preload",value:function preload(){LoadingScreen_get(LoadingScreen_getPrototypeOf(LoadingScreen.prototype),"preload",this).call(this),this.background=this.add.sprite(.5*this.scale.width,.5*this.scale.height,"loading_background"),this.world.add(this.background),this.loadingBar=new S(this,{backKey:"loading_bar_back",fillKey:"loading_bar_fill"}),this.loadingBar.x=.5*this.scale.width,this.loadingBar.y=.575*this.scale.height,this.loadingBar.setScale(this.gameScale),this.world.add(this.loadingBar);var e=[I.ClassNameToString(this.sys.settings.data.sceneToLoad)];if(this.sys.settings.data.additionalAssetBundles){for(var t=0;t<this.sys.settings.data.additionalAssetBundles.length;t++)e.push(this.sys.settings.data.additionalAssetBundles[t]);this.sys.settings.data.additionalAssetBundles=[]}P.Instance.LoadAssetPacks(this,e),this.load.on("progress",this.UpdateProgress,this)}},{key:"create",value:function create(){LoadingScreen_get(LoadingScreen_getPrototypeOf(LoadingScreen.prototype),"create",this).call(this)}},{key:"update",value:function update(e,t){LoadingScreen_get(LoadingScreen_getPrototypeOf(LoadingScreen.prototype),"update",this).call(this,e,t),0==this.load.totalToLoad&&(this.assetLoadProgress=1),this.UpdateLoadingBar(),!this.finished&&1<=this.progress&&(this.finished=!0,a.Instance.StartScene(this.sys.settings.data.sceneToLoad,this.sys.settings.data))}},{key:"UpdateProgress",value:function UpdateProgress(e){this.assetLoadProgress=e,this.UpdateLoadingBar()}},{key:"UpdateLoadingBar",value:function UpdateLoadingBar(){var e=.75*this.assetLoadProgress+.25*P.Instance.audioLoadProgress;this.progress<e&&(this.progress+=this.progressSpeed,this.loadingBar.SetProgress(this.progress))}}]),LoadingScreen}();function LocalisationManager_typeof(e){return(LocalisationManager_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LocalisationManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function LocalisationManager_getPrototypeOf(e){return(LocalisationManager_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function LocalisationManager_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LocalisationManager_setPrototypeOf(e,t){return(LocalisationManager_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var v=function(){function LocalisationManager(e){var t;return function LocalisationManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LocalisationManager),t=function LocalisationManager_possibleConstructorReturn(e,t){return!t||"object"!==LocalisationManager_typeof(t)&&"function"!=typeof t?LocalisationManager_assertThisInitialized(e):t}(this,LocalisationManager_getPrototypeOf(LocalisationManager).call(this,e)),LocalisationManager.Instance=LocalisationManager_assertThisInitialized(t),t.language="en",t.localisationData={},t}return function LocalisationManager_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LocalisationManager_setPrototypeOf(e,t)}(LocalisationManager,Phaser.Plugins.BasePlugin),function LocalisationManager_createClass(e,t,n){return t&&LocalisationManager_defineProperties(e.prototype,t),n&&LocalisationManager_defineProperties(e,n),e}(LocalisationManager,[{key:"SetLocalisationData",value:function SetLocalisationData(e){this.SetLanguage(Pr.Instance.config.language),this.localisationData=e}},{key:"SetLanguage",value:function SetLanguage(e){"auto"==e&&(e=this.LanguageBCPToCode(navigator.language));var t=["en","fr","es","de","pt","hu","ro","pl","bg","ru","nl","cs","no","sv","da","ar","tr","it","es-419","pt-br"];this.language=~t.indexOf(e)?e:t[0]}},{key:"LanguageBCPToCode",value:function LanguageBCPToCode(e){return e=e.substr(0,e.indexOf("-"))}},{key:"GetString",value:function GetString(e){if(!this.localisationData)return e;var t=this.localisationData[e];if(!t)return e;var n=t[this.language];return n||t.en}}]),LocalisationManager}();function PauseExitConfirmationPopup_typeof(e){return(PauseExitConfirmationPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PauseExitConfirmationPopup_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PauseExitConfirmationPopup_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PauseExitConfirmationPopup_get(e,t,n){return(PauseExitConfirmationPopup_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function PauseExitConfirmationPopup_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PauseExitConfirmationPopup_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PauseExitConfirmationPopup_getPrototypeOf(e){return(PauseExitConfirmationPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PauseExitConfirmationPopup_setPrototypeOf(e,t){return(PauseExitConfirmationPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var w=function(){function PauseExitConfirmationPopup(e,t,n){var r;!function PauseExitConfirmationPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PauseExitConfirmationPopup),(r=function PauseExitConfirmationPopup_possibleConstructorReturn(e,t){return!t||"object"!==PauseExitConfirmationPopup_typeof(t)&&"function"!=typeof t?PauseExitConfirmationPopup_assertThisInitialized(e):t}(this,PauseExitConfirmationPopup_getPrototypeOf(PauseExitConfirmationPopup).call(this,e,t,n))).background=r.scene.add.sprite(0,0,"pause_atlas","exit_confirmation_panel.png"),r.add(r.background),r.exitText=r.scene.make.text({x:10*r.scene.gameScale,y:0*r.scene.gameScale,text:v.Instance.GetString("exit_confirmation"),style:{fontFamily:'"FredBurger Black"',fontSize:45*r.scene.gameScale+"px",color:"#000000",wordWrap:{width:360*r.scene.gameScale},align:"center"}},!0),r.exitText.setOrigin(.5),r.exitText.setStroke("#FFFFFF",8*r.scene.gameScale),I.ClampTextToDimensions(r.exitText,360*r.scene.gameScale,150*r.scene.gameScale),r.add(r.exitText),r.yesButton=new g(r.scene,r.scene.dom,{x:.5*r.scene.scale.width-125*r.scene.gameScale,y:525*r.scene.gameScale,domClass:null,frames:["exit_confirmation_button.png"],atlas:"pause_atlas",id:"domui_yes",title:v.Instance.GetString("Yes"),callback:r.OnYesButtonPressed,context:PauseExitConfirmationPopup_assertThisInitialized(r),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}});var o=r.scene.add.text(0*r.scene.gameScale,0*r.scene.gameScale,v.Instance.GetString("Yes"),{fontFamily:'"FredBurger Black"',fontSize:40*r.scene.gameScale+"px",color:"#000000"}).setOrigin(.5).setStroke("#FFFFFF",8*r.scene.gameScale);I.ClampTextToDimensions(o,150*r.scene.gameScale,60*r.scene.gameScale),r.yesButton.add(o),r.yesButton.Hide(),r.noButton=new g(r.scene,r.scene.dom,{x:.5*r.scene.scale.width+125*r.scene.gameScale,y:525*r.scene.gameScale,domClass:null,frames:["exit_confirmation_button.png"],atlas:"pause_atlas",id:"domui_no",title:v.Instance.GetString("No"),callback:r.OnNoButtonPressed,context:PauseExitConfirmationPopup_assertThisInitialized(r),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}});var i=r.scene.add.text(0*r.scene.gameScale,0*r.scene.gameScale,v.Instance.GetString("No"),{fontFamily:'"FredBurger Black"',fontSize:40*r.scene.gameScale+"px",color:"#000000"}).setOrigin(.5).setStroke("#FFFFFF",8*r.scene.gameScale);return I.ClampTextToDimensions(i,150*r.scene.gameScale,60*r.scene.gameScale),r.noButton.add(i),r.noButton.Hide(),r}return function PauseExitConfirmationPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PauseExitConfirmationPopup_setPrototypeOf(e,t)}(PauseExitConfirmationPopup,Phaser.GameObjects.Container),function PauseExitConfirmationPopup_createClass(e,t,n){return t&&PauseExitConfirmationPopup_defineProperties(e.prototype,t),n&&PauseExitConfirmationPopup_defineProperties(e,n),e}(PauseExitConfirmationPopup,[{key:"update",value:function update(){PauseExitConfirmationPopup_get(PauseExitConfirmationPopup_getPrototypeOf(PauseExitConfirmationPopup.prototype),"update",this).call(this)}},{key:"Show",value:function Show(){this.visible=!0,this.yesButton.Show(),this.yesButton.Enable(),this.noButton.Show(),this.noButton.Enable()}},{key:"Hide",value:function Hide(){this.yesButton.Hide(),this.yesButton.Disable(),this.noButton.Hide(),this.noButton.Disable()}},{key:"OnYesButtonPressed",value:function OnYesButtonPressed(){this.emit("confirm")}},{key:"OnNoButtonPressed",value:function OnNoButtonPressed(){this.visible=!1,this.emit("deny")}}]),PauseExitConfirmationPopup}();function PauseScene_typeof(e){return(PauseScene_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PauseScene_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PauseScene_possibleConstructorReturn(e,t){return!t||"object"!==PauseScene_typeof(t)&&"function"!=typeof t?function PauseScene_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function PauseScene_get(e,t,n){return(PauseScene_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function PauseScene_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PauseScene_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PauseScene_getPrototypeOf(e){return(PauseScene_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PauseScene_setPrototypeOf(e,t){return(PauseScene_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var T=function(){function PauseScene(){return function PauseScene_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PauseScene),PauseScene_possibleConstructorReturn(this,PauseScene_getPrototypeOf(PauseScene).call(this,"PauseScene"))}return function PauseScene_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PauseScene_setPrototypeOf(e,t)}(PauseScene,y),function PauseScene_createClass(e,t,n){return t&&PauseScene_defineProperties(e.prototype,t),n&&PauseScene_defineProperties(e,n),e}(PauseScene,[{key:"create",value:function create(){PauseScene_get(PauseScene_getPrototypeOf(PauseScene.prototype),"create",this).call(this),this.background=this.add.sprite(.5*this.scale.width,.5*this.scale.height,"pause_screen_background"),this.world.add(this.background),this.clouds=this.add.tileSprite(.5*this.scale.width,this.scale.height,1970*this.gameScale,706*this.gameScale,"pause_screen_clouds"),this.clouds.setOrigin(.5,1),this.world.add(this.clouds),this.panel=this.add.sprite(.5*this.scale.width,100*this.gameScale,"pause_atlas","pause_screen_panel.png"),this.world.add(this.panel),this.titleText=this.add.text(.5*this.scale.width,100*this.gameScale,v.Instance.GetString("Paused"),{fontFamily:'"FredBurger Black"',fontSize:80*this.gameScale+"px",color:"#000000"}).setOrigin(.5).setStroke("#FFFFFF",8*this.gameScale),this.ui.add(this.titleText),I.ClampTextToDimensions(this.titleText,375*this.gameScale,100*this.gameScale),this.confirmationPopup=new w(this,.5*this.scale.width,.5*this.scale.height),this.confirmationPopup.visible=!1,this.confirmationPopup.on("confirm",this.OnExitConfirm,this),this.confirmationPopup.on("deny",this.OnExitDeny,this),this.ui.add(this.confirmationPopup),this.topLeftPanel=new d(this,this,{domClass:"dom_panel top left"}),this.topRightPanel=new d(this,this,{domClass:"dom_panel top right"}),this.backButton=new g(this,this.topLeftPanel,{frames:["button_home_unselected.png","button_home_selected.png"],atlas:"ui_atlas",id:"domui_MENU_home",title:"Home",callback:this.OnBackButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.backButton.Enable(),this.audioButton=new m(this,this.topRightPanel,{frames:["button_audio_on_unselected.png","button_audio_on_selected.png"],toggleOffFrames:["button_audio_off_unselected.png","button_audio_off_selected.png"],atlas:"ui_atlas",id:"domui_MENU_audio",title:"Audio",onToggle:this.OnAudioButtonPressed.bind(this),toggleActive:h.Instance.audioEnabled,toggleEvent:"audioEnabled",clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.audioButton.Enable(),this.playPanel=new d(this,this,{domClass:"dom_panel play"}),this.playButton=new g(this,this.playPanel,{frames:["button_play_unselected.png","button_play_selected.png"],atlas:"ui_atlas",id:"domui_MENU_play",domClass:"dom_button play",title:"Play",callback:this.OnPlayButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.playButton.Enable(),this.appLink=new g(this,this.dom,{frames:["gumball_party_icon.png","gumball_party_icon.png"],x:.5*this.scale.width+.5*this.viewport.width-100*this.gameScale,y:this.scale.height-80*this.gameScale,domClass:null,atlas:"ui_atlas",id:"domui_app_link",title:"Gumball App",callback:this.OnAppLinkPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.appLink.Enable(),this.appText=this.add.text(0,-100*this.gameScale,v.Instance.GetString("check_out_new_app"),{fontFamily:'"FredBurger Black"',fontSize:30*this.gameScale+"px",color:"#FFF",wordWrap:{width:150*this.gameScale},align:"center"}).setOrigin(.5),this.appLink.add(this.appText),I.ClampTextToDimensions(this.appText,this.appText.style.wordWrapWidth,80*this.gameScale)}},{key:"update",value:function update(e,t){PauseScene_get(PauseScene_getPrototypeOf(PauseScene.prototype),"update",this).call(this,e,t);var n=this.clouds.tilePositionX+.05*t;this.clouds.setTilePosition(n,0)}},{key:"OnPlayButtonPressed",value:function OnPlayButtonPressed(){a.Instance.WakeAllScenes(),a.Instance.StopScene(this.key)}},{key:"OnAppLinkPressed",value:function OnAppLinkPressed(){Pr.Instance.LoadAppLink()}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){this.playButton.Hide(),this.backButton.Hide(),this.audioButton.Hide(),this.appLink.Hide(),this.playButton.Disable(),this.backButton.Disable(),this.audioButton.Disable(),this.appLink.Disable(),this.ShowConfirmationPopup()}},{key:"Resize",value:function Resize(){PauseScene_get(PauseScene_getPrototypeOf(PauseScene.prototype),"Resize",this).call(this),this.appLink.x=.5*this.scale.width+.5*this.viewport.width-100*this.gameScale}},{key:"ShowConfirmationPopup",value:function ShowConfirmationPopup(){this.confirmationPopup.Show()}},{key:"OnExitConfirm",value:function OnExitConfirm(){a.Instance.StartLoadingScene(O,er)}},{key:"OnExitDeny",value:function OnExitDeny(){this.confirmationPopup.Hide(),this.playButton.Show(),this.backButton.Show(),this.audioButton.Show(),this.backButton.Enable(),this.audioButton.Enable(),this.playButton.Enable()}}]),PauseScene}();function GameScene_typeof(e){return(GameScene_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GameScene_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GameScene_possibleConstructorReturn(e,t){return!t||"object"!==GameScene_typeof(t)&&"function"!=typeof t?function GameScene_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function GameScene_get(e,t,n){return(GameScene_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function GameScene_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=GameScene_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function GameScene_getPrototypeOf(e){return(GameScene_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function GameScene_setPrototypeOf(e,t){return(GameScene_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var C=function(){function GameScene(e){return function GameScene_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GameScene),GameScene_possibleConstructorReturn(this,GameScene_getPrototypeOf(GameScene).call(this,e))}return function GameScene_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GameScene_setPrototypeOf(e,t)}(GameScene,y),function GameScene_createClass(e,t,n){return t&&GameScene_defineProperties(e.prototype,t),n&&GameScene_defineProperties(e,n),e}(GameScene,[{key:"create",value:function create(){GameScene_get(GameScene_getPrototypeOf(GameScene.prototype),"create",this).call(this),this.playerCount=this.sys.settings.data.gameData.playerCount,this._onWindowBlur=this.OnWindowBlur.bind(this),this._onVisibilityChange=this.OnVisibilityChange.bind(this),window.addEventListener("blur",this._onWindowBlur),document.addEventListener("visibilitychange",this._onVisibilityChange)}},{key:"CreateDOM",value:function CreateDOM(){this.topRightPanel=new d(this,this.dom,{domClass:"dom_panel top right"}),this.pauseButton=new g(this,this.topRightPanel,{frames:["button_pause_unselected.png","button_pause_selected.png"],atlas:"ui_atlas",id:"domui_MENU_pause",title:"Pause",callback:this.OnPauseButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.pauseButton.Enable()}},{key:"update",value:function update(e,t){GameScene_get(GameScene_getPrototypeOf(GameScene.prototype),"update",this).call(this,e,t)}},{key:"OnPauseButtonPressed",value:function OnPauseButtonPressed(){a.Instance.SleepAllScenes(),a.Instance.StartScene(T,{additive:!0})}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){a.Instance.StartLoadingScene(O,er)}},{key:"OnVisibilityChange",value:function OnVisibilityChange(){(document.hidden||document.msHidden||document.webkitHidden)&&this.OnWindowBlur()}},{key:"OnWindowBlur",value:function OnWindowBlur(){this.scene.isVisible(this.key)&&this.OnPauseButtonPressed()}},{key:"Destroy",value:function Destroy(){window.removeEventListener("blur",this._onWindowBlur),document.removeEventListener("visibilitychange",this._onVisibilityChange)}}]),GameScene}();function MinigameUI_typeof(e){return(MinigameUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigameUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigameUI_possibleConstructorReturn(e,t){return!t||"object"!==MinigameUI_typeof(t)&&"function"!=typeof t?function MinigameUI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function MinigameUI_getPrototypeOf(e){return(MinigameUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigameUI_setPrototypeOf(e,t){return(MinigameUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var k=function(){function MinigameUI(e){var t;!function MinigameUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigameUI),(t=MinigameUI_possibleConstructorReturn(this,MinigameUI_getPrototypeOf(MinigameUI).call(this,e))).scene=e,t.x=.5*t.scene.scale.width,t.y=.5*t.scene.scale.height;var n=t.scene.cameras.main;return t.scene.cameras.cameras.splice(0,1),t.scene.cameras.cameras.push(n),t.timerText=t.scene.add.text(0,0,"3",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:300*t.scene.gameScale+"px",color:"#FF0000"}),t.timerText.setOrigin(.5),t.timerText.setShadow(5*t.scene.gameScale,5*t.scene.gameScale),t.timerText.visible=!1,t.add(t.timerText),t.startText=t.scene.add.text(0,0,v.Instance.GetString("start"),{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:100*t.scene.gameScale+"px",color:"#FF0000"}),t.startText.setOrigin(.5),t.startText.setShadow(5*t.scene.gameScale,5*t.scene.gameScale),t.startText.visible=!1,t.add(t.startText),t.countdown=3,t.countdownDelay=0,t.lowerNumber=!0,t}return function MinigameUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigameUI_setPrototypeOf(e,t)}(MinigameUI,Phaser.GameObjects.Container),function MinigameUI_createClass(e,t,n){return t&&MinigameUI_defineProperties(e.prototype,t),n&&MinigameUI_defineProperties(e,n),e}(MinigameUI,[{key:"update",value:function update(){}},{key:"Hide",value:function Hide(){this.visible=!1}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){this.scene.tweens.add({targets:this.timerText,scaleX:.1,scaleY:.1,duration:1e3,ease:"Linear",repeat:2,onRepeat:this.OnTimerTweenRepeat,onRepeatScope:this,onComplete:this.OnTimerTweenComplete,onCompleteScope:this,delay:this.countdownDelay,onStart:this.OnTimerTweenStart,onStartScope:this}),this.scene.tweens.add({targets:this.timerText,alpha:0,duration:1e3,ease:"Linear",repeat:2,delay:this.countdownDelay})}},{key:"OnTimerTweenStart",value:function OnTimerTweenStart(){this.timerText.visible=!0,h.Instance.Play("sfx_minigame","minigame_321_beep")}},{key:"OnTimerTweenRepeat",value:function OnTimerTweenRepeat(){this.lowerNumber&&(this.countdown--,h.Instance.Play("sfx_minigame","minigame_321_beep"),this.timerText.setText(this.countdown)),this.lowerNumber=!this.lowerNumber}},{key:"OnTimerTweenComplete",value:function OnTimerTweenComplete(){this.timerText.visible=!1,this.startText.visible=!0,this.scene.tweens.add({targets:this.startText,scaleX:.75,scaleY:.75,repeat:1,yoyo:!0,duration:150,ease:"Linear"}),this.scene.tweens.add({targets:this.startText,scaleX:0,scaleY:0,duration:200,delay:600,ease:"Linear"}),this.scene.SetState(F.State.Game)}}]),MinigameUI}();function MinigamePlayerInput_typeof(e){return(MinigamePlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigamePlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigamePlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==MinigamePlayerInput_typeof(t)&&"function"!=typeof t?function MinigamePlayerInput_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function MinigamePlayerInput_getPrototypeOf(e){return(MinigamePlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigamePlayerInput_setPrototypeOf(e,t){return(MinigamePlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var x=function(){function MinigamePlayerInput(e,t){var n;return function MinigamePlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigamePlayerInput),(n=MinigamePlayerInput_possibleConstructorReturn(this,MinigamePlayerInput_getPrototypeOf(MinigamePlayerInput).call(this))).scene=e,n.player=t,n.data=t.playerNumber==M.PlayerNumber.ONE?MinigamePlayerInput.InputData.ONE:MinigamePlayerInput.InputData.TWO,n.keyboardData="fr"==s.Instance.language&&n.data.keyboard.azerty?n.data.keyboard.azerty:n.data.keyboard.qwerty,n.leftKey=n.scene.input.keyboard.addKey(n.keyboardData.leftKey),n.rightKey=n.scene.input.keyboard.addKey(n.keyboardData.rightKey),n.upKey=n.scene.input.keyboard.addKey(n.keyboardData.upKey),n.downKey=n.scene.input.keyboard.addKey(n.keyboardData.downKey),n.actionKey=n.scene.input.keyboard.addKey(n.keyboardData.actionKey),n.gamepadIndex=n.data.gamepad.index,n.moveVector=new Phaser.Math.Vector2(0,0),n}return function MinigamePlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigamePlayerInput_setPrototypeOf(e,t)}(MinigamePlayerInput,Phaser.Events.EventEmitter),function MinigamePlayerInput_createClass(e,t,n){return t&&MinigamePlayerInput_defineProperties(e.prototype,t),n&&MinigamePlayerInput_defineProperties(e,n),e}(MinigamePlayerInput,[{key:"update",value:function update(){if(this.moveVector.set(0,0),this.scene.input.gamepad.gamepads.length>this.gamepadIndex){var e=this.scene.input.gamepad.getPad(this.gamepadIndex);if(e){var t=e.axes[0].getValue(),n=e.axes[1].getValue();this.moveVector.x+=t,this.moveVector.y+=n}}this.upKey.isDown&&(this.moveVector.y-=1),this.downKey.isDown&&(this.moveVector.y+=1),this.leftKey.isDown&&(this.moveVector.x-=1),this.rightKey.isDown&&(this.moveVector.x+=1),this.moveVector.normalize()}},{key:"OnMinigameComplete",value:function OnMinigameComplete(){}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){}}]),MinigamePlayerInput}();function MinigamePlayerAI_typeof(e){return(MinigamePlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigamePlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigamePlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==MinigamePlayerAI_typeof(t)&&"function"!=typeof t?function MinigamePlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function MinigamePlayerAI_getPrototypeOf(e){return(MinigamePlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigamePlayerAI_setPrototypeOf(e,t){return(MinigamePlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}x.InputData=Object.freeze({ONE:{keyboard:{qwerty:{leftKey:Phaser.Input.Keyboard.KeyCodes.LEFT,rightKey:Phaser.Input.Keyboard.KeyCodes.RIGHT,upKey:Phaser.Input.Keyboard.KeyCodes.UP,downKey:Phaser.Input.Keyboard.KeyCodes.DOWN,actionKey:Phaser.Input.Keyboard.KeyCodes.SPACE}},gamepad:{index:0}},TWO:{keyboard:{qwerty:{leftKey:Phaser.Input.Keyboard.KeyCodes.A,rightKey:Phaser.Input.Keyboard.KeyCodes.D,upKey:Phaser.Input.Keyboard.KeyCodes.W,downKey:Phaser.Input.Keyboard.KeyCodes.S,actionKey:Phaser.Input.Keyboard.KeyCodes.ENTER},azerty:{leftKey:Phaser.Input.Keyboard.KeyCodes.Q,rightKey:Phaser.Input.Keyboard.KeyCodes.D,upKey:Phaser.Input.Keyboard.KeyCodes.Z,downKey:Phaser.Input.Keyboard.KeyCodes.S,actionKey:Phaser.Input.Keyboard.KeyCodes.ENTER}},gamepad:{index:1}}});var A=function(){function MinigamePlayerAI(e,t){var n;return function MinigamePlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigamePlayerAI),(n=MinigamePlayerAI_possibleConstructorReturn(this,MinigamePlayerAI_getPrototypeOf(MinigamePlayerAI).call(this))).scene=e,n.player=t,n.difficulty=MinigamePlayerAI.Difficulty[n.scene.sys.settings.data.gameData.aiDifficulty],n}return function MinigamePlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigamePlayerAI_setPrototypeOf(e,t)}(MinigamePlayerAI,Phaser.Events.EventEmitter),function MinigamePlayerAI_createClass(e,t,n){return t&&MinigamePlayerAI_defineProperties(e.prototype,t),n&&MinigamePlayerAI_defineProperties(e,n),e}(MinigamePlayerAI,[{key:"update",value:function update(){}}]),MinigamePlayerAI}();function PlayerAnimation_typeof(e){return(PlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==PlayerAnimation_typeof(t)&&"function"!=typeof t?function PlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function PlayerAnimation_get(e,t,n){return(PlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function PlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PlayerAnimation_getPrototypeOf(e){return(PlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PlayerAnimation_setPrototypeOf(e,t){return(PlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}A.Difficulty=Object.freeze({EASY:0,MEDIUM:1,HARD:3});var B=function(){function PlayerAnimation(e,t){var n;return function PlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PlayerAnimation),(n=PlayerAnimation_possibleConstructorReturn(this,PlayerAnimation_getPrototypeOf(PlayerAnimation).call(this,e))).player=t,n.spine=n.CreateSpine(),n.spine.setScale(n.scene.gameScale),n.add(n.spine),n.state=null,n.timeInState=0,n.flipX=!1,n}return function PlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PlayerAnimation_setPrototypeOf(e,t)}(PlayerAnimation,Phaser.GameObjects.Container),function PlayerAnimation_createClass(e,t,n){return t&&PlayerAnimation_defineProperties(e.prototype,t),n&&PlayerAnimation_defineProperties(e,n),e}(PlayerAnimation,[{key:"update",value:function update(e,t){this.timeInState+=.001*t}},{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id,"idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){if(this.state!=e||this.state.allowRestart){var t=void(this.timeInState=0)!==(this.state=e).trackIndex?e.trackIndex:0;this.PlayAnimation(t,this.state.animationName,this.state.loop)}}},{key:"PlayAnimation",value:function PlayAnimation(e,t,n){this.spine.setAnimation(e,t,n)}},{key:"SetFlipX",value:function SetFlipX(e){switch(this.flipX=e,this.scene.game.renderer.type){case Phaser.CANVAS:this.spine.skeleton.flipX=e;break;case Phaser.WEBGL:this.setScale(1,e?-1:1)}}},{key:"destroy",value:function destroy(){PlayerAnimation_get(PlayerAnimation_getPrototypeOf(PlayerAnimation.prototype),"destroy",this).call(this)}}]),PlayerAnimation}();function Player_typeof(e){return(Player_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Player_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Player_possibleConstructorReturn(e,t){return!t||"object"!==Player_typeof(t)&&"function"!=typeof t?function Player_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function Player_getPrototypeOf(e){return(Player_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Player_setPrototypeOf(e,t){return(Player_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var M=function(){function Player(e,t){var n;return function Player_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Player),(n=Player_possibleConstructorReturn(this,Player_getPrototypeOf(Player).call(this,e))).playerNumber=t.playerNumber,n.controller=t.playerController,n.characterData=t.data.characterData,n.points=t.data.points,n.trophies=t.data.trophies,n.minigamesWon=void 0!==t.data.minigamesWon?t.data.minigamesWon:0,n.chances=void 0!==t.data.chances?t.data.chances:0,n.steps=void 0!==t.data.steps?t.data.steps:0,n.animation=n.CreateAnimation(),n.add(n.animation),n}return function Player_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Player_setPrototypeOf(e,t)}(Player,Phaser.GameObjects.Container),function Player_createClass(e,t,n){return t&&Player_defineProperties(e.prototype,t),n&&Player_defineProperties(e,n),e}(Player,[{key:"CreateAnimation",value:function CreateAnimation(){return new B(this.scene,this)}},{key:"update",value:function update(e,t){switch(this.controller){case Player.Controller.HUMAN:this.UpdateHumanControl(e,t);break;case Player.Controller.AI:this.UpdateAIControl(e,t)}}},{key:"UpdateHumanControl",value:function UpdateHumanControl(){}},{key:"UpdateAIControl",value:function UpdateAIControl(){}}]),Player}();function MinigameCompletePopup_typeof(e){return(MinigameCompletePopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigameCompletePopup_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigameCompletePopup_possibleConstructorReturn(e,t){return!t||"object"!==MinigameCompletePopup_typeof(t)&&"function"!=typeof t?function MinigameCompletePopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function MinigameCompletePopup_getPrototypeOf(e){return(MinigameCompletePopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigameCompletePopup_setPrototypeOf(e,t){return(MinigameCompletePopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}M.PlayerNumber=Object.freeze({ONE:0,TWO:1}),M.Controller=Object.freeze({HUMAN:0,AI:1});var D=function(){function MinigameCompletePopup(e){var t;!function MinigameCompletePopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigameCompletePopup),(t=MinigameCompletePopup_possibleConstructorReturn(this,MinigameCompletePopup_getPrototypeOf(MinigameCompletePopup).call(this,e))).x=.5*t.scene.scale.width,t.y=.5*t.scene.scale.height,t.tintOverlay=t.scene.add.rectangle(0,0,t.scene.scale.width,t.scene.scale.height,0,.5),t.tintOverlay.setOrigin(0),t.tintOverlay.visible=!1,t.scene.ui.add(t.tintOverlay),t.background=t.scene.add.sprite(0,0,"shared_minigame_atlas","winner_popup.png"),t.add(t.background),t.titleText=t.scene.add.text(-140*t.scene.gameScale,-180*t.scene.gameScale,v.Instance.GetString("the_winner_is"),{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*t.scene.gameScale+"px",color:"#000000"}),t.titleText.setOrigin(.5),t.titleText.setStroke("#FFFFFF",8*t.scene.gameScale),I.ClampTextToDimensions(t.titleText,450*t.scene.gameScale,80*t.scene.gameScale),t.add(t.titleText),t.pointsCountText=t.scene.add.text(-15*t.scene.gameScale,185*t.scene.gameScale,90,{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*t.scene.gameScale+"px",color:"#FFFFFF"}),t.pointsCountText.setOrigin(.5),t.add(t.pointsCountText),t.winnerSprite=t.scene.add.sprite(180*t.scene.gameScale,15*t.scene.gameScale,"shared_minigame_atlas","winner_darwin.png"),t.add(t.winnerSprite);var n=new Phaser.Math.Vector2(500*t.scene.gameScale,20*t.scene.gameScale),r=new Phaser.Geom.Rectangle(.5*-n.x,.5*-n.y,n.x,n.y);return t.confettiParticles=t.scene.add.particles("shared_minigame_atlas"),t.add(t.confettiParticles),t.confettiParticleEmitter=t.confettiParticles.createEmitter({on:!1,x:100*t.scene.gameScale,y:230*t.scene.gameScale,frame:["confetto_0.png","confetto_1.png","confetto_2.png","confetto_3.png","confetto_4.png","confetto_5.png","confetto_6.png"],alpha:{start:1,end:0,ease:"Sine.easeIn"},scale:{start:1,end:0,ease:"Sine.easeIn"},rotate:{min:0,max:360,start:0,end:-720},speed:{min:-600*t.scene.gameScale,max:600*t.scene.gameScale},radial:!0,angle:{min:-140,max:-40},emitZone:{source:r},gravityY:300,lifespan:2e3}),t.confettiParticleEmitter.reserve(50),t.pointsCount=0,t.pointsCountTarget=0,t.winnerId=null,t.visible=!1,t}return function MinigameCompletePopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigameCompletePopup_setPrototypeOf(e,t)}(MinigameCompletePopup,Phaser.GameObjects.Container),function MinigameCompletePopup_createClass(e,t,n){return t&&MinigameCompletePopup_defineProperties(e.prototype,t),n&&MinigameCompletePopup_defineProperties(e,n),e}(MinigameCompletePopup,[{key:"Show",value:function Show(e){switch(this.setScale(0),this.tintOverlay.alpha=0,this.tintOverlay.visible=!0,this.pointsCount=e.points,this.pointsCountText.setText(this.pointsCount),this.pointsCountTarget=this.pointsCount+10,e.points=this.pointsCountTarget,this.scene.tweens.add({targets:this.tintOverlay,alpha:{value:.5,duration:1e3,ease:"Back.easeOut"},onComplete:this.OnShowComplete,onCompleteScope:this}),this.scene.tweens.add({targets:this,scaleX:{value:1,duration:800,ease:"Back.easeOut"},scaleY:{value:1,duration:800,ease:"Back.easeOut",delay:400}}),this.winnerSprite.y=600*this.scene.gameScale,this.winnerSprite.setFrame("winner_"+e.characterData.id+".png"),this.winnerSprite.visible=!1,e.characterData.id){case"gumball":this.winnerSprite.x=100*this.scene.gameScale}this.winnerId=e.characterData.id,this.visible=!0}},{key:"OnShowComplete",value:function OnShowComplete(){this.winnerSprite.visible=!0,this.scene.tweens.add({targets:this.winnerSprite,y:{value:15*this.scene.gameScale,duration:800,ease:"Back.easeOut"}}),h.Instance.Play("sfx_minigame","minigame_winner_points_count_up",{loop:!0}),this.scene.tweens.add({targets:this,pointsCount:{value:this.pointsCountTarget,duration:800,delay:250,ease:"Linear"},onUpdate:this.OnPointsCountTweenUpdate,onUpdateScope:this,onComplete:this.OnPointsCountTweenComplete,onCompleteScope:this}),this.confettiParticleEmitter.explode(50),h.Instance.Play("sfx_minigame","winner_confetti_shot"),h.Instance.Play("sfx_minigame","vo_"+this.winnerId+"_win",{delay:1})}},{key:"OnPointsCountTweenUpdate",value:function OnPointsCountTweenUpdate(){this.pointsCountText.setText(Math.floor(this.pointsCount))}},{key:"OnPointsCountTweenComplete",value:function OnPointsCountTweenComplete(){h.Instance.Play("sfx_minigame","minigame_winner_points_count_up_end"),h.Instance.Stop("sfx_minigame","minigame_winner_points_count_up"),this.scene.tweens.add({targets:this.pointsCountText,scaleX:{value:1.25,duration:250,yoyo:!0,repeat:3,ease:"Linear"},scaleY:{value:1.25,duration:250,yoyo:!0,repeat:3,ease:"Linear"}})}}]),MinigameCompletePopup}();function MinigameCamera_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function MinigameCamera(e){!function MinigameCamera_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigameCamera),this.scene=e,this.camera=this.scene.cameras.add(0,0,this.scene.scale.width,this.scene.scale.height),this.cameraLookAt=new Phaser.Math.Vector2(.5*this.scene.scale.width,.5*this.scene.scale.height),this.camera.centerOn(this.cameraLookAt.x,this.cameraLookAt.y),this.camera.ignore(this.scene.ui),this.camera.ignore(this.scene.dom),this.lerpCameraTween=null}return function MinigameCamera_createClass(e,t,n){return t&&MinigameCamera_defineProperties(e.prototype,t),n&&MinigameCamera_defineProperties(e,n),e}(MinigameCamera,[{key:"update",value:function update(){}},{key:"SetLookAt",value:function SetLookAt(e,t){this.cameraLookAt.set(e,t),this.camera.centerOn(this.cameraLookAt.x,this.cameraLookAt.y)}},{key:"LerpLookAt",value:function LerpLookAt(e,t,n,r){this.lerpCameraTween&&this.lerpCameraTween.stop(),this.lerpCameraTween=this.scene.tweens.add({targets:this.cameraLookAt,x:e,y:t,duration:n,ease:r,onUpdate:this.OnLerpTweenUpdate,onUpdateScope:this})}},{key:"OnLerpTweenUpdate",value:function OnLerpTweenUpdate(){this.camera.centerOn(this.cameraLookAt.x,this.cameraLookAt.y)}}]),MinigameCamera}();function MinigameTutorialPopup_typeof(e){return(MinigameTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigameTutorialPopup_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigameTutorialPopup_getPrototypeOf(e){return(MinigameTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigameTutorialPopup_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MinigameTutorialPopup_setPrototypeOf(e,t){return(MinigameTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var R=function(){function MinigameTutorialPopup(e){var t;!function MinigameTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigameTutorialPopup),(t=function MinigameTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==MinigameTutorialPopup_typeof(t)&&"function"!=typeof t?MinigameTutorialPopup_assertThisInitialized(e):t}(this,MinigameTutorialPopup_getPrototypeOf(MinigameTutorialPopup).call(this,e))).x=.5*t.scene.scale.width,t.y=.5*t.scene.scale.height,t.tintOverlay=t.scene.add.rectangle(0,0,t.scene.scale.width,t.scene.scale.height,0,1),t.tintOverlay.alpha=0,t.tintOverlay.setOrigin(.5),t.add(t.tintOverlay),t.contentContainer=t.scene.add.container(0,720*t.scene.gameScale),t.add(t.contentContainer),t.panel=t.scene.add.sprite(0,0),t.contentContainer.add(t.panel),t.controlSpines=[];for(var n=0;n<t.scene.sys.settings.data.gameData.playerCount;n++)t.CreateControlSpine(n);return t.tutorialText=t.scene.add.text(0,-280*t.scene.gameScale,v.Instance.GetString(t.scene.key+"_TutorialText"),{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:30*t.scene.gameScale+"px",color:"#FFFFFF"}),t.tutorialText.setOrigin(.5),I.ClampTextToDimensions(t.tutorialText,740*t.scene.gameScale,60*t.scene.gameScale),t.tutorialText.alpha=0,t.contentContainer.add(t.tutorialText),t.playButton=new g(t.scene,t.contentContainer,{x:0,y:250*t.scene.gameScale,buttonWidth:128*t.scene.gameScale,buttonHeight:128*t.scene.gameScale,spriteWidth:128*t.scene.gameScale,spriteHeight:128*t.scene.gameScale,frames:["button_play_unselected.png","button_play_selected.png"],atlas:"ui_atlas",id:"domui_MENU_play",domClass:"dom_button play",title:"Play",callback:t.OnPlayButtonPressed,context:MinigameTutorialPopup_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.scene.tweens.add({targets:t.tintOverlay,alpha:{value:.4,delay:250,duration:750,ease:"Linear"}}),t.scene.tweens.add({targets:t.contentContainer,y:{value:0,delay:400,duration:750,ease:"Back.easeOut"},onComplete:t.OnShowComplete,onCompleteScope:MinigameTutorialPopup_assertThisInitialized(t)}),h.Instance.Play("sfx_minigame","screen_in_controls_panel"),t}return function MinigameTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigameTutorialPopup_setPrototypeOf(e,t)}(MinigameTutorialPopup,Phaser.GameObjects.Container),function MinigameTutorialPopup_createClass(e,t,n){return t&&MinigameTutorialPopup_defineProperties(e.prototype,t),n&&MinigameTutorialPopup_defineProperties(e,n),e}(MinigameTutorialPopup,[{key:"update",value:function update(){}},{key:"CreateControlSpine",value:function CreateControlSpine(e){var t,n=1<this.scene.playerCount,r=n?e:this.scene.playerCount-e;if(this.scene.deviceManager.desktop){t=this.scene.add.spine(-450*(r-.5)*this.scene.gameScale,250*this.scene.gameScale,"how_to_desktop","all",!0);var o="fr"!=s.Instance.language?"wasd":"zqsd";t.skeleton.setSkinByName(0==e?"arrows":o),this.contentContainer.add(t),this.controlSpines.push(t)}else{var i=n?-750:-250;(t=this.scene.add.spine((r-.5)*i*this.scene.gameScale,250*this.scene.gameScale,"how_to_mobile","swipe",!0)).skeleton.setSkinByName(0==e?"p1":"p2"),t.setScale(0==e?1:-1,1),this.contentContainer.add(t),this.controlSpines.push(t)}var a=this.scene.add.sprite(t.x,t.y+35*this.scene.gameScale,"shared_minigame_atlas","icon_"+this.scene.sys.settings.data.gameData.players[e].characterData.id+".png");this.contentContainer.add(a)}},{key:"OnPlayButtonPressed",value:function OnPlayButtonPressed(){this.playButton.Disable(),this.emit("onHideStart"),this.scene.tweens.add({targets:this.contentContainer,y:{value:720*this.scene.gameScale,duration:750,ease:"Back.easeIn"}}),this.textTween&&this.textTween.stop(),this.textTween=this.scene.tweens.add({targets:this.tutorialText,alpha:{value:0,duration:500,ease:"Linear"}}),this.scene.tweens.add({targets:this,alpha:{value:0,delay:750,duration:500,hold:500,ease:"Linear"},onComplete:this.OnHideComplete,onCompleteScope:this}),this.scene.input.keyboard.off("keydown",this.OnPlayButtonPressed,this),h.Instance.Play("sfx_minigame","screen_out_controls_panel")}},{key:"OnShowComplete",value:function OnShowComplete(){this.playButton.Enable(),this.textTween=this.scene.tweens.add({targets:this.tutorialText,alpha:{value:1,duration:500,ease:"Linear"}}),this.scene.input.keyboard.on("keydown",this.OnPlayButtonPressed,this),this.emit("onShowComplete")}},{key:"OnHideComplete",value:function OnHideComplete(){this.visible=!1,this.scene.SetState(F.State.PreGame)}}]),MinigameTutorialPopup}();function TransitionScene_typeof(e){return(TransitionScene_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TransitionScene_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TransitionScene_possibleConstructorReturn(e,t){return!t||"object"!==TransitionScene_typeof(t)&&"function"!=typeof t?function TransitionScene_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TransitionScene_get(e,t,n){return(TransitionScene_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TransitionScene_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TransitionScene_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TransitionScene_getPrototypeOf(e){return(TransitionScene_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TransitionScene_setPrototypeOf(e,t){return(TransitionScene_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var E=function(){function TransitionScene(){return function TransitionScene_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TransitionScene),TransitionScene_possibleConstructorReturn(this,TransitionScene_getPrototypeOf(TransitionScene).call(this,"TransitionScene"))}return function TransitionScene_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TransitionScene_setPrototypeOf(e,t)}(TransitionScene,y),function TransitionScene_createClass(e,t,n){return t&&TransitionScene_defineProperties(e.prototype,t),n&&TransitionScene_defineProperties(e,n),e}(TransitionScene,[{key:"init",value:function init(){TransitionScene_get(TransitionScene_getPrototypeOf(TransitionScene.prototype),"init",this).call(this),this.dontDestroyOnLoad=!0}},{key:"create",value:function create(){TransitionScene_get(TransitionScene_getPrototypeOf(TransitionScene.prototype),"create",this).call(this),this.events.once("screenHidden",this.sys.settings.data.callback,this.sys.settings.data.context),a.Instance.events.on("sceneInit",this.OnSceneInit,this),this.minWidth=150*this.gameScale,this.rainbowSprites=[];for(var e=1e3,t=0;t<6;t++){var n=this.add.nineslice(.5*this.scale.width+.5*this.viewport.width+200*this.gameScale,119*t*this.gameScale,Math.ceil(this.minWidth),Math.ceil(131*this.gameScale),{key:"transition_atlas",frame:t+1+".png"},59*this.gameScale);n.setOrigin(0,1),n.angle=180,n.nineSliceWidth=Math.ceil(this.minWidth),this.world.add(n),this.tweens.add({targets:n,nineSliceWidth:{value:this.viewport.width+250*this.gameScale,duration:660,delay:t*e*.034,ease:"Sine.easeIn"},onComplete:5==t?this.OnScreenHidden:void 0,onCompleteScope:this}),this.tweens.add({targets:n,x:{value:.5*this.scale.width-.5*this.viewport.width-200*this.gameScale,duration:660,delay:800+t*e*.034,ease:"Sine.easeOut"},onComplete:5==t?this.OnTransitionComplete:void 0,onCompleteScope:this}),this.rainbowSprites.push(n)}this.cloud1Sprite=this.add.sprite(.5*this.scale.width+.5*this.viewport.width+300*this.gameScale,.5*this.scale.height,"transition_atlas","cloud.png"),this.tweens.add({targets:this.cloud1Sprite,x:{value:.5*this.scale.width+.5*this.viewport.width,duration:340,yoyo:!0,hold:660,ease:"Sine.easeInOut"}}),this.cloud2Sprite=this.add.sprite(.5*this.scale.width-.5*this.viewport.width-300*this.gameScale,.5*this.scale.height,"transition_atlas","cloud.png"),this.tweens.add({targets:this.cloud2Sprite,x:{value:.5*this.scale.width-.5*this.viewport.width,duration:340,delay:200,yoyo:!0,hold:460,ease:"Sine.easeInOut"}}),h.Instance.Play("sfx_ui_shared","screen_wipe")}},{key:"update",value:function update(e,t){TransitionScene_get(TransitionScene_getPrototypeOf(TransitionScene.prototype),"update",this).call(this,e,t);for(var n=0;n<this.rainbowSprites.length;n++)this.rainbowSprites[n].width!=this.rainbowSprites[n].nineSliceWidth&&this.rainbowSprites[n].resize(Math.ceil(this.rainbowSprites[n].nineSliceWidth),this.rainbowSprites[n].height)}},{key:"OnSceneInit",value:function OnSceneInit(){this.game.scene.bringToTop("TransitionScene")}},{key:"OnScreenHidden",value:function OnScreenHidden(){this.events.emit("screenHidden")}},{key:"OnTransitionComplete",value:function OnTransitionComplete(){a.Instance.StopScene("TransitionScene")}},{key:"Destroy",value:function Destroy(){TransitionScene_get(TransitionScene_getPrototypeOf(TransitionScene.prototype),"Destroy",this).call(this),a.Instance.events.off("sceneInit",this.OnSceneInit,this)}}]),TransitionScene}();function Minigame_typeof(e){return(Minigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Minigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Minigame_possibleConstructorReturn(e,t){return!t||"object"!==Minigame_typeof(t)&&"function"!=typeof t?function Minigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function Minigame_get(e,t,n){return(Minigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function Minigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Minigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Minigame_getPrototypeOf(e){return(Minigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Minigame_setPrototypeOf(e,t){return(Minigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var F=function(){function Minigame(e){return function Minigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Minigame),Minigame_possibleConstructorReturn(this,Minigame_getPrototypeOf(Minigame).call(this,e))}return function Minigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Minigame_setPrototypeOf(e,t)}(Minigame,C),function Minigame_createClass(e,t,n){return t&&Minigame_defineProperties(e.prototype,t),n&&Minigame_defineProperties(e,n),e}(Minigame,[{key:"create",value:function create(){Minigame_get(Minigame_getPrototypeOf(Minigame.prototype),"create",this).call(this),this.state=Minigame.State.Tutorial,this.CreateDOM(),this.players=[],this.minigameCamera=this.CreateMinigameCamera(),this.minigameCamera&&this.cameras.main.ignore(this.world),this.CreateWorld(),h.Instance.AddLayer("sfx_minigame",{audioKeys:["minigame_321_beep","player_one_score_point","player_two_score_point","player_one_score_short","player_two_score_short","minigame_winner_points_count_up","minigame_winner_points_count_up_end","winner_confetti_shot","screen_in_controls_panel","screen_out_controls_panel","minigame_end","vo_anais_win","vo_tobias_win","vo_penny_win","vo_gumball_win","vo_darwin_win","vo_carrie_win","vo_anais_lose","vo_tobias_lose","vo_penny_lose","vo_gumball_lose","vo_darwin_lose","vo_carrie_lose"]}),h.Instance.AddLayer("music_minigame",{audioKeys:[],loop:!0}),this.minigameUI=this.CreateMinigameUI(),this.ui.add(this.minigameUI),this.minigameTutorialPopup=this.CreateMinigameTutorial(),this.ui.add(this.minigameTutorialPopup),this.minigameCompletePopup=new D(this),this.ui.add(this.minigameCompletePopup),this.displayFPS&&this.ui.add(this.fpsCounter),this.gameTimer=0,this.winingPlayer=this.players[0],this.postGameCooldownTimer=0,this.postGameCooldownTime=2,this.resultsCooldownTimer=0}},{key:"CreateMinigameCamera",value:function CreateMinigameCamera(){return new j(this)}},{key:"CreateMinigameUI",value:function CreateMinigameUI(){return new k(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new R(this)}},{key:"CreateWorld",value:function CreateWorld(){}},{key:"update",value:function update(e,t){Minigame_get(Minigame_getPrototypeOf(Minigame.prototype),"update",this).call(this,e,t),this.minigameUI.update(e,t),this.minigameCamera&&this.minigameCamera.update(e,t);for(var n=0;n<this.players.length;n++)this.players[n].update(e,t);switch(this.state){case Minigame.State.PreGame:this.UpdatePreGameState(e,t);break;case Minigame.State.Game:this.UpdateGameState(e,t);break;case Minigame.State.PostGame:this.UpdatePostGameState(e,t);break;case Minigame.State.Results:this.UpdateResultsGameState(e,t)}}},{key:"UpdatePreGameState",value:function UpdatePreGameState(){}},{key:"UpdateGameState",value:function UpdateGameState(e,t){0<this.gameTimer&&(this.gameTimer-=.001*t,this.gameTimer<=0&&this.EndGame())}},{key:"UpdatePostGameState",value:function UpdatePostGameState(e,t){0<this.postGameCooldownTimer&&(this.postGameCooldownTimer-=.001*t,this.postGameCooldownTimer<=0&&this.SetState(Minigame.State.Results))}},{key:"UpdateResultsGameState",value:function UpdateResultsGameState(e,t){0<this.resultsCooldownTimer&&(this.resultsCooldownTimer-=.001*t,this.resultsCooldownTimer<=0&&this.ReturnToBoardGame())}},{key:"SetState",value:function SetState(e){switch(this.state=e,this.state){case Minigame.State.PreGame:this.OnEnterPreGameState();break;case Minigame.State.Game:this.OnEnterGameState();break;case Minigame.State.PostGame:this.OnEnterPostGameState();break;case Minigame.State.Results:this.OnEnterResultsState()}}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){for(var e=0;e<this.players.length;e++)this.players[e].OnEnterPreGameState();this.minigameUI.OnEnterPreGameState()}},{key:"OnEnterGameState",value:function OnEnterGameState(){}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){var e=this.GetWinningPlayer();e.minigamesWon++;for(var t=0;t<this.players.length;t++)this.players[t].OnGameEnterPostGameState(this.players[t]==e);this.postGameCooldownTimer=this.postGameCooldownTime}},{key:"OnEnterResultsState",value:function OnEnterResultsState(){for(var e=0;e<this.players.length;e++)this.players[e].OnMinigameComplete();this.minigameUI.Hide(),h.Instance.FadeLayerVolume("music_minigame",this,.1,1e3);var t=this.GetWinningPlayer();this.minigameCompletePopup.Show(t),this.resultsCooldownTimer=5}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){return this.players[0]}},{key:"EndGame",value:function EndGame(){this.SetState(Minigame.State.PostGame)}},{key:"ReturnToBoardGame",value:function ReturnToBoardGame(){for(var e=0;e<this.players.length;e++)this.sys.settings.data.gameData.players[e].points=this.players[e].points,this.sys.settings.data.gameData.players[e].trophies=this.players[e].trophies,this.sys.settings.data.gameData.players[e].minigamesWon=this.players[e].minigamesWon,this.sys.settings.data.gameData.players[e].chances=this.players[e].chances,this.sys.settings.data.gameData.players[e].steps=this.players[e].steps;a.Instance.StartTransitionScene(E,this.LoadBoardScene,this)}},{key:"LoadBoardScene",value:function LoadBoardScene(){a.Instance.StartLoadingScene(O,this.sys.settings.data.gameData.parentScene,this.sys.settings.data)}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){this.ReturnToBoardGame()}},{key:"OnSleep",value:function OnSleep(){h.Instance.PauseLayer("sfx_minigame"),h.Instance.PauseLayer("music_minigame")}},{key:"OnWake",value:function OnWake(){h.Instance.ResumeLayer("sfx_minigame"),h.Instance.ResumeLayer("music_minigame")}},{key:"Destroy",value:function Destroy(){Minigame_get(Minigame_getPrototypeOf(Minigame.prototype),"Destroy",this).call(this),h.Instance.DestroyLayer("sfx_minigame"),h.Instance.DestroyLayer("music_minigame")}}]),Minigame}();function MinigamePlayerAnimation_typeof(e){return(MinigamePlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigamePlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigamePlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==MinigamePlayerAnimation_typeof(t)&&"function"!=typeof t?function MinigamePlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function MinigamePlayerAnimation_getPrototypeOf(e){return(MinigamePlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigamePlayerAnimation_setPrototypeOf(e,t){return(MinigamePlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function Minigame_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(F,"State",Object.freeze({Tutorial:0,PreGame:1,Game:2,PostGame:3,Results:4}));var H=function(){function MinigamePlayerAnimation(e,t){return function MinigamePlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigamePlayerAnimation),MinigamePlayerAnimation_possibleConstructorReturn(this,MinigamePlayerAnimation_getPrototypeOf(MinigamePlayerAnimation).call(this,e,t))}return function MinigamePlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigamePlayerAnimation_setPrototypeOf(e,t)}(MinigamePlayerAnimation,B),function MinigamePlayerAnimation_createClass(e,t,n){return t&&MinigamePlayerAnimation_defineProperties(e.prototype,t),n&&MinigamePlayerAnimation_defineProperties(e,n),e}(MinigamePlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id,"idle",!0);return I.ApplyWinterSkin(e),e}}]),MinigamePlayerAnimation}();function MinigamePlayer_typeof(e){return(MinigamePlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigamePlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigamePlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MinigamePlayer_get(e,t,n){return(MinigamePlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function MinigamePlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MinigamePlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MinigamePlayer_getPrototypeOf(e){return(MinigamePlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigamePlayer_setPrototypeOf(e,t){return(MinigamePlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var L=function(){function MinigamePlayer(e,t){var n;switch(function MinigamePlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigamePlayer),(n=function MinigamePlayer_possibleConstructorReturn(e,t){return!t||"object"!==MinigamePlayer_typeof(t)&&"function"!=typeof t?MinigamePlayer_assertThisInitialized(e):t}(this,MinigamePlayer_getPrototypeOf(MinigamePlayer).call(this,e,t))).controller){case M.Controller.HUMAN:n.playerInput=n.CreateInput(),n.playerInput.actionKey.on("down",n.OnActionKeyPressed,MinigamePlayer_assertThisInitialized(n)),n.playerInput.on("pointerdown",n.OnPointerDown,MinigamePlayer_assertThisInitialized(n));break;case M.Controller.AI:n.playerAI=n.CreateAI()}return n.minigameScore=0,n}return function MinigamePlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigamePlayer_setPrototypeOf(e,t)}(MinigamePlayer,M),function MinigamePlayer_createClass(e,t,n){return t&&MinigamePlayer_defineProperties(e.prototype,t),n&&MinigamePlayer_defineProperties(e,n),e}(MinigamePlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new H(this.scene,this)}},{key:"CreateInput",value:function CreateInput(){return new x(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new A(this.scene,this)}},{key:"update",value:function update(e,t){MinigamePlayer_get(MinigamePlayer_getPrototypeOf(MinigamePlayer.prototype),"update",this).call(this,e,t),this.animation.update(e,t)}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){MinigamePlayer_get(MinigamePlayer_getPrototypeOf(MinigamePlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.playerInput.update(e,t)}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){MinigamePlayer_get(MinigamePlayer_getPrototypeOf(MinigamePlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.playerAI.update(e,t)}},{key:"SetMinigameScore",value:function SetMinigameScore(e){this.minigameScore=e}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){this.playerInput&&this.playerInput.OnEnterPreGameState()}},{key:"OnGameEnterPostGameState",value:function OnGameEnterPostGameState(e){e?this.OnMinigameWon():this.OnMinigameLost()}},{key:"OnMinigameComplete",value:function OnMinigameComplete(){this.playerInput&&this.playerInput.OnMinigameComplete()}},{key:"OnMinigameWon",value:function OnMinigameWon(){}},{key:"OnMinigameLost",value:function OnMinigameLost(){h.Instance.Play("sfx_minigame","vo_"+this.characterData.id+"_lose")}},{key:"OnActionKeyPressed",value:function OnActionKeyPressed(){}},{key:"OnPointerDown",value:function OnPointerDown(){}},{key:"destroy",value:function destroy(){MinigamePlayer_get(MinigamePlayer_getPrototypeOf(MinigamePlayer.prototype),"destroy",this).call(this)}}]),MinigamePlayer}();function VolleyballPlayerAI_typeof(e){return(VolleyballPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VolleyballPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballPlayerAI_typeof(t)&&"function"!=typeof t?function VolleyballPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function VolleyballPlayerAI_get(e,t,n){return(VolleyballPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function VolleyballPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VolleyballPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function VolleyballPlayerAI_getPrototypeOf(e){return(VolleyballPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballPlayerAI_setPrototypeOf(e,t){return(VolleyballPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var G=function(){function VolleyballPlayerAI(e,t){var n;switch(function VolleyballPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballPlayerAI),(n=VolleyballPlayerAI_possibleConstructorReturn(this,VolleyballPlayerAI_getPrototypeOf(VolleyballPlayerAI).call(this,e,t))).moveVector=new Phaser.Math.Vector2(0,0),n.moveTargetOffset=new Phaser.Math.Vector2(0,0),n.centreTarget=new Phaser.Math.Vector2(0,.5*n.scene.scale.height),n.moveSpeed=300*n.scene.gameScale,n.ballHitX=0,n.willBallLandOnThisSide=!1,n.hasPredictedLand=!1,n.rightSide=1<n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.TWO,n.rightSide){case!0:n.moveTargetOffset.x=-25*n.scene.gameScale,n.centreTarget.x=.5*n.scene.scale.width+.25*n.scene.viewport.width;break;case!1:n.moveTargetOffset.x=25*n.scene.gameScale,n.centreTarget.x=.5*n.scene.scale.width-.25*n.scene.viewport.width}switch(n.difficulty){case A.Difficulty.EASY:n.moveSpeed=200*n.scene.gameScale;break;case A.Difficulty.MEDIUM:n.moveSpeed=240*n.scene.gameScale;break;case A.Difficulty.HARD:n.moveSpeed=300*n.scene.gameScale}return n}return function VolleyballPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballPlayerAI_setPrototypeOf(e,t)}(VolleyballPlayerAI,A),function VolleyballPlayerAI_createClass(e,t,n){return t&&VolleyballPlayerAI_defineProperties(e.prototype,t),n&&VolleyballPlayerAI_defineProperties(e,n),e}(VolleyballPlayerAI,[{key:"update",value:function update(e,t){if(VolleyballPlayerAI_get(VolleyballPlayerAI_getPrototypeOf(VolleyballPlayerAI.prototype),"update",this).call(this,e,t),this.moveVector.set(0,0),this.scene.ball.travelTimer<=.75*this.scene.ball.travelTime&&!this.hasPredictedLand){var n=this.ballHitX+3.3*(this.scene.ball.x-this.ballHitX);switch(this.rightSide){case!0:this.willBallLandOnThisSide=n>.5*this.scene.scale.width;break;case!1:this.willBallLandOnThisSide=n<.5*this.scene.scale.width}this.hasPredictedLand=!0}if(this.scene.ball.travelTimer<=.75*this.scene.ball.travelTime&&this.willBallLandOnThisSide?(this.targetingBall,this.moveVector.set(this.scene.ball.x-(this.player.x+this.moveTargetOffset.x),this.scene.ball.y-(this.player.y+this.moveTargetOffset.y))):0<this.scene.ball.travelTimer&&this.moveVector.set(this.centreTarget.x-this.player.x,this.centreTarget.y-this.player.y),0!=this.moveVector.x||0!=this.moveVector.y){var r=this.moveVector.length();this.moveVector.normalize(),this.moveVector.x*=this.moveSpeed*t*.001,this.moveVector.y*=this.moveSpeed*t*.001;var o=this.moveVector.length()/r;1<o&&(this.moveVector.x/=o,this.moveVector.y/=o)}}},{key:"OnBallHit",value:function OnBallHit(){switch(this.ballHitX=this.scene.ball.x,this.moveTargetOffset.y=Phaser.Math.RND.realInRange(-25*this.scene.gameScale,25*this.scene.gameScale),this.willBallLandOnThisSide=!1,this.hasPredictedLand=!1,this.rightSide){case!0:this.moveTargetOffset.x=Phaser.Math.RND.realInRange(-50*this.scene.gameScale,0*this.scene.gameScale);break;case!1:this.moveTargetOffset.x=Phaser.Math.RND.realInRange(0*this.scene.gameScale,50*this.scene.gameScale)}}}]),VolleyballPlayerAI}();function MinigamePlayerDragScreenInput_typeof(e){return(MinigamePlayerDragScreenInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigamePlayerDragScreenInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigamePlayerDragScreenInput_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MinigamePlayerDragScreenInput_get(e,t,n){return(MinigamePlayerDragScreenInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function MinigamePlayerDragScreenInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MinigamePlayerDragScreenInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MinigamePlayerDragScreenInput_getPrototypeOf(e){return(MinigamePlayerDragScreenInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigamePlayerDragScreenInput_setPrototypeOf(e,t){return(MinigamePlayerDragScreenInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var N=function(){function MinigamePlayerDragScreenInput(e,t){var n;if(function MinigamePlayerDragScreenInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigamePlayerDragScreenInput),!(n=function MinigamePlayerDragScreenInput_possibleConstructorReturn(e,t){return!t||"object"!==MinigamePlayerDragScreenInput_typeof(t)&&"function"!=typeof t?MinigamePlayerDragScreenInput_assertThisInitialized(e):t}(this,MinigamePlayerDragScreenInput_getPrototypeOf(MinigamePlayerDragScreenInput).call(this,e,t))).scene.deviceManager.desktop){new Phaser.Geom.Rectangle(0,0,.5*n.scene.scale.width,n.scene.scale.height);var r=1<n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.TWO?.75:.25;n.inputRect=n.scene.add.rectangle(n.scene.scale.width*r,.5*n.scene.scale.height,.5*n.scene.scale.width,n.scene.scale.height,16776960,0),n.inputRect.setOrigin(.5),n.inputRect.setInteractive(),n.inputRect.on("pointerdown",n.OnPointerDown,MinigamePlayerDragScreenInput_assertThisInitialized(n)),n.scene.ui.add(n.inputRect)}return n.pointerPosition=new Phaser.Math.Vector2(0,0),n.activePointer=null,n}return function MinigamePlayerDragScreenInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigamePlayerDragScreenInput_setPrototypeOf(e,t)}(MinigamePlayerDragScreenInput,x),function MinigamePlayerDragScreenInput_createClass(e,t,n){return t&&MinigamePlayerDragScreenInput_defineProperties(e.prototype,t),n&&MinigamePlayerDragScreenInput_defineProperties(e,n),e}(MinigamePlayerDragScreenInput,[{key:"update",value:function update(e,t){MinigamePlayerDragScreenInput_get(MinigamePlayerDragScreenInput_getPrototypeOf(MinigamePlayerDragScreenInput.prototype),"update",this).call(this,e,t),this.activePointer&&(this.activePointer.isDown?this.pointerPosition.set(this.activePointer.worldX,this.activePointer.worldY):this.activePointer=null)}},{key:"OnPointerDown",value:function OnPointerDown(e){this.activePointer=e,this.pointerPosition.set(this.activePointer.worldX,this.activePointer.worldY),this.emit("pointerdown",this.pointerPosition.x,this.pointerPosition.y)}}]),MinigamePlayerDragScreenInput}();function VolleyballPlayerAnimation_typeof(e){return(VolleyballPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VolleyballPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballPlayerAnimation_typeof(t)&&"function"!=typeof t?function VolleyballPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function VolleyballPlayerAnimation_get(e,t,n){return(VolleyballPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function VolleyballPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VolleyballPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function VolleyballPlayerAnimation_getPrototypeOf(e){return(VolleyballPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballPlayerAnimation_setPrototypeOf(e,t){return(VolleyballPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var U=function(){function VolleyballPlayerAnimation(e,t){return function VolleyballPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballPlayerAnimation),VolleyballPlayerAnimation_possibleConstructorReturn(this,VolleyballPlayerAnimation_getPrototypeOf(VolleyballPlayerAnimation).call(this,e,t))}return function VolleyballPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballPlayerAnimation_setPrototypeOf(e,t)}(VolleyballPlayerAnimation,H),function VolleyballPlayerAnimation_createClass(e,t,n){return t&&VolleyballPlayerAnimation_defineProperties(e.prototype,t),n&&VolleyballPlayerAnimation_defineProperties(e,n),e}(VolleyballPlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id+"_topdown","volley_idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){VolleyballPlayerAnimation_get(VolleyballPlayerAnimation_getPrototypeOf(VolleyballPlayerAnimation.prototype),"SetState",this).call(this,e),e==VolleyballPlayerAnimation.State.Hit?this.spine.on("spine.complete",this.OnHitAnimationComplete,this):this.spine.off("spine.complete",this.OnHitAnimationComplete,this),e==VolleyballPlayerAnimation.State.Win||e==VolleyballPlayerAnimation.State.Lose?this.spine.on("spine.complete",this.OnReactAnimationComplete,this):this.spine.off("spine.complete",this.OnReactAnimationComplete,this)}},{key:"update",value:function update(e,t){VolleyballPlayerAnimation_get(VolleyballPlayerAnimation_getPrototypeOf(VolleyballPlayerAnimation.prototype),"update",this).call(this,e,t)}},{key:"OnHitAnimationComplete",value:function OnHitAnimationComplete(){this.SetState(VolleyballPlayerAnimation.State.Idle)}},{key:"OnReactAnimationComplete",value:function OnReactAnimationComplete(){this.SetState(VolleyballPlayerAnimation.State.Idle)}},{key:"destroy",value:function destroy(){VolleyballPlayerAnimation_get(VolleyballPlayerAnimation_getPrototypeOf(VolleyballPlayerAnimation.prototype),"destroy",this).call(this)}}]),VolleyballPlayerAnimation}();function VolleyballPlayer_typeof(e){return(VolleyballPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VolleyballPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VolleyballPlayer_get(e,t,n){return(VolleyballPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function VolleyballPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VolleyballPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function VolleyballPlayer_getPrototypeOf(e){return(VolleyballPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballPlayer_setPrototypeOf(e,t){return(VolleyballPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function VolleyballPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(U,"State",Object.freeze({Idle:{animationName:"volley_idle",loop:!0},Hit:{animationName:"volley_hit",loop:!1},Win:{animationName:"volley_success",loop:!1},Lose:{animationName:"volley_fail",loop:!1}}));var z=function(){function VolleyballPlayer(e,t){var n;!function VolleyballPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballPlayer);var r=1<(n=function VolleyballPlayer_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballPlayer_typeof(t)&&"function"!=typeof t?VolleyballPlayer_assertThisInitialized(e):t}(this,VolleyballPlayer_getPrototypeOf(VolleyballPlayer).call(this,e,t))).scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO;switch(r){case!0:n.setPosition(.5*n.scene.scale.width+200*n.scene.gameScale,.5*n.scene.scale.height);break;case!1:n.setPosition(.5*n.scene.scale.width-200*n.scene.gameScale,.5*n.scene.scale.height)}n.clampOffset=75*n.scene.gameScale,n.clampBounds={left:r?.5*n.scene.scale.width+n.clampOffset:.5*n.scene.scale.width-.5*n.scene.viewport.width+n.clampOffset,right:r?.5*n.scene.scale.width+.5*n.scene.viewport.width-n.clampOffset:.5*n.scene.scale.width-n.clampOffset,top:n.clampOffset,bottom:n.scene.scale.height-n.clampOffset};var o=new Phaser.Math.Vector2(125*n.scene.gameScale,80*n.scene.gameScale);return n.controller==M.Controller.HUMAN&&n.scene.deviceManager.desktop&&(o.x*=1.5,o.y*=1.5),n.sensor=n.scene.matter.add.rectangle(n.x,n.y,o.x,o.y,{ignoreGravity:!0,isSensor:!0}),n.sensor.gameObject=VolleyballPlayer_assertThisInitialized(n),n.moveSpeed=600*n.scene.gameScale,n.dragOffset=new Phaser.Math.Vector2(0,0),n.enemyPlayer=null,n.hitStrength=.125*n.scene.gameScale,n.score=0,n.animation.SetState(U.State.Idle),n}return function VolleyballPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballPlayer_setPrototypeOf(e,t)}(VolleyballPlayer,L),function VolleyballPlayer_createClass(e,t,n){return t&&VolleyballPlayer_defineProperties(e.prototype,t),n&&VolleyballPlayer_defineProperties(e,n),e}(VolleyballPlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new U(this.scene,this)}},{key:"CreateInput",value:function CreateInput(){return new N(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new G(this.scene,this)}},{key:"update",value:function update(e,t){VolleyballPlayer_get(VolleyballPlayer_getPrototypeOf(VolleyballPlayer.prototype),"update",this).call(this,e,t),this.x=Phaser.Math.Clamp(this.x,this.clampBounds.left,this.clampBounds.right),this.y=Phaser.Math.Clamp(this.y,this.clampBounds.top,this.clampBounds.bottom),this.sensor.position.x=this.x,this.sensor.position.y=this.y}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){VolleyballPlayer_get(VolleyballPlayer_getPrototypeOf(VolleyballPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&(0!=this.playerInput.moveVector.x&&(this.x+=this.playerInput.moveVector.x*this.moveSpeed*t*.001),0!=this.playerInput.moveVector.y&&(this.y+=this.playerInput.moveVector.y*this.moveSpeed*t*.001),this.playerInput.activePointer&&(this.x=this.playerInput.pointerPosition.x-this.dragOffset.x,this.y=this.playerInput.pointerPosition.y-this.dragOffset.y))}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){VolleyballPlayer_get(VolleyballPlayer_getPrototypeOf(VolleyballPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state==F.State.Game&&(0!=this.playerAI.moveVector.x&&(this.x+=this.playerAI.moveVector.x),0!=this.playerAI.moveVector.y&&(this.y+=this.playerAI.moveVector.y))}},{key:"OnPointerDown",value:function OnPointerDown(e,t){VolleyballPlayer_get(VolleyballPlayer_getPrototypeOf(VolleyballPlayer.prototype),"OnPointerDown",this).call(this),this.dragOffset.set(e-this.x,t-this.y)}},{key:"HitBall",value:function HitBall(e){var t=e.x-this.x,n=e.y-this.y;this.scene.deviceManager.desktop&&(t=Phaser.Math.Clamp(t,-35*this.scene.gameScale,35*this.scene.gameScale),n=Phaser.Math.Clamp(n,-35*this.scene.gameScale,35*this.scene.gameScale));var r=t*this.hitStrength,o=n*this.hitStrength;e.Hit(r,o),this.animation.SetState(U.State.Hit)}},{key:"OnBallHit",value:function OnBallHit(){switch(this.playerAI&&this.playerAI.OnBallHit(),this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","volleyball_player_one_hit");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","volleyball_player_two_hit")}}},{key:"OnRoundWon",value:function OnRoundWon(){this.animation.SetState(U.State.Win)}},{key:"OnRoundLost",value:function OnRoundLost(){this.animation.SetState(U.State.Lose)}},{key:"AddScore",value:function AddScore(){switch(this.score++,this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","player_one_score_point");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","player_two_score_point")}}},{key:"destroy",value:function destroy(){VolleyballPlayer_get(VolleyballPlayer_getPrototypeOf(VolleyballPlayer.prototype),"destroy",this).call(this)}}]),VolleyballPlayer}();function VolleyballBall_typeof(e){return(VolleyballBall_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballBall_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VolleyballBall_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VolleyballBall_get(e,t,n){return(VolleyballBall_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function VolleyballBall_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VolleyballBall_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function VolleyballBall_getPrototypeOf(e){return(VolleyballBall_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballBall_setPrototypeOf(e,t){return(VolleyballBall_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var V=function(){function VolleyballBall(e){var t;return function VolleyballBall_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballBall),(t=function VolleyballBall_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballBall_typeof(t)&&"function"!=typeof t?VolleyballBall_assertThisInitialized(e):t}(this,VolleyballBall_getPrototypeOf(VolleyballBall).call(this,e))).setPosition(.5*t.scene.scale.width,.5*t.scene.scale.height),t.ballShadowSprite=t.scene.add.circle(t.x,t.y,25*t.scene.gameScale,0,.5),t.ballShadowSprite.setOrigin(.5),t.scene.world.add(t.ballShadowSprite),t.trailParticles=t.scene.add.particles("volleyball_minigame_atlas","ball_trail.png"),t.scene.world.add(t.trailParticles),t.trailParticleEmitter=t.trailParticles.createEmitter({on:!1,frequency:20,x:0,y:0,alpha:{start:.5,end:0,ease:"Sine.easeOut"},scale:{start:1,end:.3,ease:"Sine.easeOut"},rotate:{start:0,end:0,ease:"Linear"},lifespan:1e3,follow:VolleyballBall_assertThisInitialized(t)}),t.trailParticleEmitter.reserve(Math.ceil(t.trailParticleEmitter.lifespan/t.trailParticleEmitter.frequency)),t.spine=t.scene.add.spine(0,0,"volley_ball","idle",!0),t.spine.setScale(t.scene.gameScale),t.add(t.spine),t.ballBody=t.scene.matter.add.image(t.x,t.y,"volleyball_minigame_atlas","volley_ball.png"),t.ballBody.alpha=0,t.ballBody.setBounce(1),t.ballBody.setFixedRotation(),t.ballBody.setIgnoreGravity(!0),t.ballBody.setFriction(0),t.ballBody.gameObject=VolleyballBall_assertThisInitialized(t),t.ballBody.setCollisionCategory(t.scene.ballCollisionCategory),t.ballBody.setCollidesWith([1]),t.add(t.ballBody),t.collidingNet=null,t.collidingPlayers=[],t.maxDistancefromGround=10,t.distanceFromGround=0,t.travelTime=t.scene.deviceManager.desktop?2.4:2,t.travelTimer=0,t.respawnTimer=0,t.minScale=.4,t.maxScale=1,t.visible=!1,t.ballShadowSprite.visible=!1,t.velocityMagnitude=0,t.spinDirection=1,t.shadowPredictionTime=1,t.netHitStrength=4*t.scene.gameScale,t}return function VolleyballBall_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballBall_setPrototypeOf(e,t)}(VolleyballBall,Phaser.GameObjects.Container),function VolleyballBall_createClass(e,t,n){return t&&VolleyballBall_defineProperties(e.prototype,t),n&&VolleyballBall_defineProperties(e,n),e}(VolleyballBall,[{key:"update",value:function update(e,t){VolleyballBall_get(VolleyballBall_getPrototypeOf(VolleyballBall.prototype),"update",this).call(this,e,t),this.x=this.ballBody.body.position.x,this.y=this.ballBody.body.position.y,this.ballShadowSprite.x=this.x,this.ballShadowSprite.y=this.y;var n=Math.atan2(this.ballBody.body.velocity.y,this.ballBody.body.velocity.x);n<0&&(n+=2*Math.PI),n=Phaser.Math.RadToDeg(n),this.trailParticleEmitter.rotate.start=n,this.trailParticleEmitter.rotate.end=n,this.velocityMagnitude=Phaser.Math.Distance.Between(0,0,this.ballBody.body.velocity.x,this.ballBody.body.velocity.y);var r=200/Math.max(this.velocityMagnitude,.1);if(this.trailParticleEmitter.frequency=Phaser.Math.Clamp(r,10,500),r<this.trailParticleEmitter._counter&&(this.trailParticleEmitter._counter=r),this.spine.angle+=this.velocityMagnitude*this.spinDirection,0<this.travelTimer){this.travelTimer-=.001*t;var o=(this.travelTime-this.travelTimer)/this.travelTime,i=Math.sin(o*Math.PI);this.SetDistanceFromGround(i*this.maxDistancefromGround),this.travelTimer<=0&&this.CheckHit()}0<this.respawnTimer&&(this.respawnTimer-=.001*t,this.respawnTimer<=0&&this.Spawn())}},{key:"CheckHit",value:function CheckHit(){this.collidingNet?this.HitNet():0<this.collidingPlayers.length?this.collidingPlayers[this.collidingPlayers.length-1].gameObject.HitBall(this):this.OnBallLand()}},{key:"HitNet",value:function HitNet(){if(this.trailParticleEmitter.on=!0,h.Instance.Play("sfx_minigame","volleyball_net_bounce"),Math.abs(this.velocityMagnitude)<.1){var e=Phaser.Math.RND.pick([-1,1]);this.Hit(e*this.netHitStrength,1*Phaser.Math.RND.pick([-1,1])*this.scene.gameScale),this.scene.net.Bulge(-e,this.y)}else{var t=this.x>.5*this.scene.scale.width==0<this.ballBody.body.velocity.x?1:-1;this.Hit(this.ballBody.body.velocity.x*t,this.ballBody.body.velocity.y),this.scene.net.Bulge(-t,this.y)}}},{key:"Hit",value:function Hit(e,t){this.scene.minigameCamera.camera.shake(50,.001),this.ballBody.setVelocity(e,t),this.travelTimer=this.travelTime,this.scene.OnBallHit(),this.spinDirection*=-1,this.spine.setAnimation(1,"bounce",!1)}},{key:"Spawn",value:function Spawn(){this.ballBody.setVelocity(0,0),this.ballBody.setPosition(.5*this.scene.scale.width,.5*this.scene.scale.height),this.scene.OnBallSpawn(),this.travelTimer=.5*this.travelTime,this.visible=!0,this.ballShadowSprite.visible=!0,this.ballBody.setFriction(0,0)}},{key:"OnBallLand",value:function OnBallLand(){this.scene.OnBallLand(),h.Instance.Play("sfx_minigame","volleyball_bounce_ground"),this.ballBody.setFriction(0,.05),this.trailParticleEmitter.on=!1;for(var e=250,t=[],n=this.minScale+.06;n>this.minScale;n-=.02)t.push({duration:.5*e,scaleX:n,scaleY:n,ease:"Circ.easeOut"}),t.push({duration:.5*e,scaleX:this.minScale,scaleY:this.minScale,ease:"Circ.easeOut"}),e-=75;this.scene.tweens.timeline({targets:this.spine,duration:50,tweens:t})}},{key:"OnNetCollisionStart",value:function OnNetCollisionStart(e){this.collidingNet=e.bodyB}},{key:"OnNetCollisionEnd",value:function OnNetCollisionEnd(){this.collidingNet=null}},{key:"OnPlayerCollisionStart",value:function OnPlayerCollisionStart(e){this.collidingPlayers.push(e.bodyB)}},{key:"OnPlayerCollisionEnd",value:function OnPlayerCollisionEnd(e){for(var t=this.collidingPlayers.length;0<=t;t--)if(this.collidingPlayers[t]==e.bodyB){this.collidingPlayers.splice(t,1);break}}},{key:"SetDistanceFromGround",value:function SetDistanceFromGround(e){this.distanceFromGround=e;var t=Phaser.Math.Linear(this.minScale,this.maxScale,e/this.maxDistancefromGround);this.spine.setScale(t*this.scene.gameScale),this.ballBody.setScale(t),this.trailParticleEmitter.scaleX.start=t,this.trailParticleEmitter.scaleX.end=.3*t;var n=this.x,r=this.y+250*(t-this.minScale)*this.scene.gameScale;this.ballShadowSprite.x=n,this.ballShadowSprite.y=r;var o=Phaser.Math.Linear(this.maxScale,this.minScale,e/this.maxDistancefromGround);this.ballShadowSprite.setScale(o),this.ballBody.setFixedRotation()}},{key:"destroy",value:function destroy(){VolleyballBall_get(VolleyballBall_getPrototypeOf(VolleyballBall.prototype),"destroy",this).call(this)}}]),VolleyballBall}();function VolleyballNet_typeof(e){return(VolleyballNet_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballNet_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VolleyballNet_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VolleyballNet_get(e,t,n){return(VolleyballNet_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function VolleyballNet_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VolleyballNet_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function VolleyballNet_getPrototypeOf(e){return(VolleyballNet_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballNet_setPrototypeOf(e,t){return(VolleyballNet_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var W=function(){function VolleyballNet(e){var t;return function VolleyballNet_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballNet),(t=function VolleyballNet_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballNet_typeof(t)&&"function"!=typeof t?VolleyballNet_assertThisInitialized(e):t}(this,VolleyballNet_getPrototypeOf(VolleyballNet).call(this,e))).setPosition(.5*t.scene.scale.width,.5*t.scene.scale.height),t.bulgeSprite=t.scene.add.sprite(0,0,"volleyball_minigame_atlas","volley_net_bulge.png"),t.bulgeSprite.setOrigin(0,.5),t.add(t.bulgeSprite),t.sprite=t.scene.add.sprite(0,0,"volleyball_minigame_atlas","volley_net.png"),t.add(t.sprite),t.sensor=t.scene.matter.add.rectangle(t.x,t.y,t.sprite.width,t.sprite.height,{ignoreGravity:!0,isSensor:!0}),t.sensor.gameObject=VolleyballNet_assertThisInitialized(t),t.bulgeSprite.visible=!1,t.bulgeTween=null,t}return function VolleyballNet_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballNet_setPrototypeOf(e,t)}(VolleyballNet,Phaser.GameObjects.Container),function VolleyballNet_createClass(e,t,n){return t&&VolleyballNet_defineProperties(e.prototype,t),n&&VolleyballNet_defineProperties(e,n),e}(VolleyballNet,[{key:"update",value:function update(e,t){VolleyballNet_get(VolleyballNet_getPrototypeOf(VolleyballNet.prototype),"update",this).call(this,e,t),this.sensor.position.x=this.x,this.sensor.position.y=this.y}},{key:"Bulge",value:function Bulge(e,t){this.bulgeSprite.visible=!0,this.bulgeSprite.setFlipX(1==e),this.bulgeSprite.setOrigin(1==e?0:1,.5);var n=175*this.scene.gameScale;this.bulgeSprite.setPosition(0,Phaser.Math.Clamp(t-this.y,-n,n)),this.bulgeSprite.setScale(0,1),this.bulgeTween&&this.bulgeTween.isPlaying()&&this.bulgeTween.stop(),this.bulgeTween=this.scene.tweens.add({targets:this.bulgeSprite,scaleX:1,duration:200,ease:"Linear",yoyo:!0,onComplete:this.OnBulgeTweenComplete,onCompleteScope:this})}},{key:"OnBulgeTweenComplete",value:function OnBulgeTweenComplete(){this.bulgeSprite.visible=!1}},{key:"destroy",value:function destroy(){VolleyballNet_get(VolleyballNet_getPrototypeOf(VolleyballNet.prototype),"destroy",this).call(this)}}]),VolleyballNet}();function VolleyballUI_typeof(e){return(VolleyballUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VolleyballUI_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballUI_typeof(t)&&"function"!=typeof t?function VolleyballUI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function VolleyballUI_getPrototypeOf(e){return(VolleyballUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballUI_setPrototypeOf(e,t){return(VolleyballUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var q=function(){function VolleyballUI(e){var t;!function VolleyballUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballUI);var n=1<(t=VolleyballUI_possibleConstructorReturn(this,VolleyballUI_getPrototypeOf(VolleyballUI).call(this,e))).scene.playerCount;return t.playerOneScore=t.scene.add.container(),t.playerOneScore.setPosition(n?200*t.scene.gameScale:-200*t.scene.gameScale,.65*-t.scene.scale.height),t.add(t.playerOneScore),t.playerTwoScore=t.scene.add.container(),t.playerTwoScore.setPosition(n?-200*t.scene.gameScale:200*t.scene.gameScale,.65*-t.scene.scale.height),t.add(t.playerTwoScore),t.playerOneScoreSprite=t.scene.add.sprite(0,0,"volleyball_minigame_atlas","volley_points.png"),t.playerOneScore.add(t.playerOneScoreSprite),t.playerTwoScoreSprite=t.scene.add.sprite(0,0,"volleyball_minigame_atlas","volley_points.png"),t.playerTwoScore.add(t.playerTwoScoreSprite),t.playerOneScoreText=t.scene.add.text(0,30*t.scene.gameScale,"0",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*t.scene.gameScale+"px",color:"#FFFFFF"}),t.playerOneScoreText.setOrigin(.5),t.playerOneScore.add(t.playerOneScoreText),t.playerTwoScoreText=t.scene.add.text(0,30*t.scene.gameScale,"0",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*t.scene.gameScale+"px",color:"#FFFFFF"}),t.playerTwoScoreText.setOrigin(.5),t.playerTwoScore.add(t.playerTwoScoreText),t}return function VolleyballUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballUI_setPrototypeOf(e,t)}(VolleyballUI,k),function VolleyballUI_createClass(e,t,n){return t&&VolleyballUI_defineProperties(e.prototype,t),n&&VolleyballUI_defineProperties(e,n),e}(VolleyballUI,[{key:"SetScore",value:function SetScore(e,t){this.playerOneScore.setPosition(this.playerOneScore.x,.65*-this.scene.scale.height),this.playerTwoScore.setPosition(this.playerTwoScore.x,.65*-this.scene.scale.height);var n=e==M.PlayerNumber.ONE?this.playerOneScore:this.playerTwoScore,r=e==M.PlayerNumber.ONE?this.playerTwoScore:this.playerOneScore;switch(this.notIncreasingAppearTween=this.scene.tweens.add({targets:r,y:.475*-this.scene.scale.height,duration:500,ease:"Sine.easeOut",yoyo:t<this.scene.scoreLimit,hold:1e3}),this.increasingAppearTween=this.scene.tweens.add({targets:n,y:.45*-this.scene.scale.height,duration:500,ease:"Sine.easeOut",yoyo:t<this.scene.scoreLimit,hold:1e3}),e){case M.PlayerNumber.ONE:this.playerOneScoreText.setText(t);break;case M.PlayerNumber.TWO:this.playerTwoScoreText.setText(t)}}},{key:"Hide",value:function Hide(){}}]),VolleyballUI}();function VolleyballBackground_typeof(e){return(VolleyballBackground_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballBackground_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballBackground_typeof(t)&&"function"!=typeof t?function VolleyballBackground_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function VolleyballBackground_getPrototypeOf(e){return(VolleyballBackground_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballBackground_setPrototypeOf(e,t){return(VolleyballBackground_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var K=function(){function VolleyballBackground(e){var t;return function VolleyballBackground_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballBackground),(t=VolleyballBackground_possibleConstructorReturn(this,VolleyballBackground_getPrototypeOf(VolleyballBackground).call(this,e))).backgroundSprite=t.scene.add.sprite(.5*t.scene.scale.width,.5*t.scene.scale.height,"volley_background"),t.add(t.backgroundSprite),t.courtSprite=t.scene.add.nineslice(.5*t.scene.scale.width,.5*t.scene.scale.height,Math.ceil(t.scene.viewport.width-50*t.scene.gameScale),Math.ceil(688*t.scene.gameScale),{key:"volleyball_minigame_atlas",frame:"volley_court.png"},100*t.scene.gameScale,100*t.scene.gameScale),t.courtSprite.setOrigin(.5),t.add(t.courtSprite),t.linesSprite=t.scene.add.sprite(.5*t.scene.scale.width,.5*t.scene.scale.height,"volley_lines"),t.add(t.linesSprite),t}return function VolleyballBackground_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballBackground_setPrototypeOf(e,t)}(VolleyballBackground,Phaser.GameObjects.Container),VolleyballBackground}();function VolleyballCamera_typeof(e){return(VolleyballCamera_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballCamera_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VolleyballCamera_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballCamera_typeof(t)&&"function"!=typeof t?function VolleyballCamera_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function VolleyballCamera_getPrototypeOf(e){return(VolleyballCamera_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballCamera_setPrototypeOf(e,t){return(VolleyballCamera_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Y=function(){function VolleyballCamera(e){var t;return function VolleyballCamera_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballCamera),(t=VolleyballCamera_possibleConstructorReturn(this,VolleyballCamera_getPrototypeOf(VolleyballCamera).call(this,e))).SetLookAt(.5*t.scene.scale.width,.5*t.scene.scale.height),t}return function VolleyballCamera_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballCamera_setPrototypeOf(e,t)}(VolleyballCamera,j),function VolleyballCamera_createClass(e,t,n){return t&&VolleyballCamera_defineProperties(e.prototype,t),n&&VolleyballCamera_defineProperties(e,n),e}(VolleyballCamera,[{key:"update",value:function update(){}}]),VolleyballCamera}();function VolleyballTutorialPopup_typeof(e){return(VolleyballTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballTutorialPopup_typeof(t)&&"function"!=typeof t?function VolleyballTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function VolleyballTutorialPopup_getPrototypeOf(e){return(VolleyballTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballTutorialPopup_setPrototypeOf(e,t){return(VolleyballTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var X=function(){function VolleyballTutorialPopup(e){var t;return function VolleyballTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballTutorialPopup),(t=VolleyballTutorialPopup_possibleConstructorReturn(this,VolleyballTutorialPopup_getPrototypeOf(VolleyballTutorialPopup).call(this,e))).panel.setTexture("volleyball_minigame_atlas","how_to_volley.png"),t}return function VolleyballTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballTutorialPopup_setPrototypeOf(e,t)}(VolleyballTutorialPopup,R),VolleyballTutorialPopup}();function VolleyballMinigame_typeof(e){return(VolleyballMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VolleyballMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VolleyballMinigame_possibleConstructorReturn(e,t){return!t||"object"!==VolleyballMinigame_typeof(t)&&"function"!=typeof t?function VolleyballMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function VolleyballMinigame_get(e,t,n){return(VolleyballMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function VolleyballMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VolleyballMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function VolleyballMinigame_getPrototypeOf(e){return(VolleyballMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VolleyballMinigame_setPrototypeOf(e,t){return(VolleyballMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var J=function(){function VolleyballMinigame(){return function VolleyballMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolleyballMinigame),VolleyballMinigame_possibleConstructorReturn(this,VolleyballMinigame_getPrototypeOf(VolleyballMinigame).call(this,"VolleyballMinigame"))}return function VolleyballMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VolleyballMinigame_setPrototypeOf(e,t)}(VolleyballMinigame,F),function VolleyballMinigame_createClass(e,t,n){return t&&VolleyballMinigame_defineProperties(e.prototype,t),n&&VolleyballMinigame_defineProperties(e,n),e}(VolleyballMinigame,[{key:"create",value:function create(){VolleyballMinigame_get(VolleyballMinigame_getPrototypeOf(VolleyballMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["volleyball_start","volleyball_net_bounce","volleyball_player_one_hit","volleyball_player_two_hit","volleyball_bounce_ground"]}),h.Instance.AddLayer("music_minigame",{audioKeys:["music_volleyball"]}),this.scoreLimit=3,h.Instance.Play("music_minigame","music_volleyball")}},{key:"CreateMinigameUI",value:function CreateMinigameUI(){return new q(this)}},{key:"CreateMinigameCamera",value:function CreateMinigameCamera(){return new Y(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new X(this)}},{key:"CreateWorld",value:function CreateWorld(){VolleyballMinigame_get(VolleyballMinigame_getPrototypeOf(VolleyballMinigame.prototype),"CreateWorld",this).call(this),this.matter.world.setBounds(.5*this.scale.width-.5*this.viewport.width,.5*this.scale.height-.5*this.viewport.height,this.viewport.width,this.viewport.height,32,!0,!0,!1,!0),this.background=new K(this),this.world.add(this.background),this.ballCollisionCategory=this.matter.world.nextCategory(),this.net=new W(this),this.world.add(this.net);for(var e=0;e<2;e++){var t=new z(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(t),this.world.add(t)}this.players[0].enemyPlayer=this.players[1],this.players[1].enemyPlayer=this.players[0],this.ball=new V(this),this.world.add(this.ball),this.flashSpine=this.add.spine(.5*this.scale.width,.5*this.scale.height,"flash","flash",!1),this.flashSpine.setScale(this.gameScale),this.flashSpine.visible=!1,this.world.add(this.flashSpine),this.matterCollision.addOnCollideStart({objectA:this.ball.ballBody,objectB:this.net.sensor,callback:this.ball.OnNetCollisionStart,context:this.ball}),this.matterCollision.addOnCollideEnd({objectA:this.ball.ballBody,objectB:this.net.sensor,callback:this.ball.OnNetCollisionEnd,context:this.ball});var n=[];for(e=0;e<this.players.length;e++)n.push(this.players[e].sensor);this.matterCollision.addOnCollideStart({objectA:this.ball.ballBody,objectB:n,callback:this.ball.OnPlayerCollisionStart,context:this.ball}),this.matterCollision.addOnCollideEnd({objectA:this.ball.ballBody,objectB:n,callback:this.ball.OnPlayerCollisionEnd,context:this.ball});var r=[this.matter.world.walls.bottom,this.matter.world.walls.top,this.matter.world.walls.left,this.matter.world.walls.right];this.matterCollision.addOnCollideStart({objectA:this.ball.ballBody,objectB:r,callback:this.OnWallCollision,context:this})}},{key:"update",value:function update(e,t){VolleyballMinigame_get(VolleyballMinigame_getPrototypeOf(VolleyballMinigame.prototype),"update",this).call(this,e,t),this.ball.update(e,t)}},{key:"AddScore",value:function AddScore(e){for(var t=0;t<this.players.length;t++)if(this.players[t].playerNumber==e){this.players[t].AddScore(),this.minigameUI.SetScore(e,this.players[t].score),this.players[t].score<this.scoreLimit?this.ball.respawnTimer=1:this.EndGame();break}}},{key:"OnEnterGameState",value:function OnEnterGameState(){VolleyballMinigame_get(VolleyballMinigame_getPrototypeOf(VolleyballMinigame.prototype),"OnEnterGameState",this).call(this),this.ball.Spawn(),h.Instance.Play("sfx_minigame","volleyball_start")}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){VolleyballMinigame_get(VolleyballMinigame_getPrototypeOf(VolleyballMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"OnBallSpawn",value:function OnBallSpawn(){this.world.bringToTop(this.ball.ballShadowSprite),this.world.bringToTop(this.ball)}},{key:"OnBallHit",value:function OnBallHit(){for(var e=0;e<this.players.length;e++)this.players[e].OnBallHit();this.flashSpine.visible=!0,this.flashSpine.setPosition(this.ball.x,this.ball.y),this.flashSpine.setScale(.5*this.gameScale),this.flashSpine.setAnimation(0,"flash",!1)}},{key:"OnBallLand",value:function OnBallLand(){var e=this.ball.x<.5*this.scale.width?1<this.playerCount?this.players[0]:this.players[1]:1<this.playerCount?this.players[1]:this.players[0];e.OnRoundWon(),e.enemyPlayer.OnRoundLost(),this.AddScore(e.playerNumber),this.world.moveTo(this.ball.ballShadowSprite,this.world.getIndex(this.net)),this.world.moveTo(this.ball,this.world.getIndex(this.net))}},{key:"OnWallCollision",value:function OnWallCollision(e){this.flashSpine.visible=!0,this.flashSpine.setPosition(this.ball.x+.5*this.ball.ballBody.width*e.pair.collision.tangent.y,this.ball.y-.5*this.ball.ballBody.height*e.pair.collision.tangent.x),this.flashSpine.setScale(.5*this.gameScale),this.flashSpine.setAnimation(0,"flash",!1)}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=0,t=null,n=0;n<this.players.length;n++)this.players[n].score>e&&(e=this.players[n].score,t=this.players[n]);return t}}]),VolleyballMinigame}();function HurdlesUI_typeof(e){return(HurdlesUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HurdlesUI_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesUI_typeof(t)&&"function"!=typeof t?function HurdlesUI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HurdlesUI_get(e,t,n){return(HurdlesUI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HurdlesUI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HurdlesUI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HurdlesUI_getPrototypeOf(e){return(HurdlesUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesUI_setPrototypeOf(e,t){return(HurdlesUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Z=function(){function HurdlesUI(e){return function HurdlesUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesUI),HurdlesUI_possibleConstructorReturn(this,HurdlesUI_getPrototypeOf(HurdlesUI).call(this,e))}return function HurdlesUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesUI_setPrototypeOf(e,t)}(HurdlesUI,k),function HurdlesUI_createClass(e,t,n){return t&&HurdlesUI_defineProperties(e.prototype,t),n&&HurdlesUI_defineProperties(e,n),e}(HurdlesUI,[{key:"update",value:function update(e,t){HurdlesUI_get(HurdlesUI_getPrototypeOf(HurdlesUI.prototype),"update",this).call(this,e,t)}}]),HurdlesUI}();function HurdlesPlayerAI_typeof(e){return(HurdlesPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HurdlesPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesPlayerAI_typeof(t)&&"function"!=typeof t?function HurdlesPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HurdlesPlayerAI_get(e,t,n){return(HurdlesPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HurdlesPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HurdlesPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HurdlesPlayerAI_getPrototypeOf(e){return(HurdlesPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesPlayerAI_setPrototypeOf(e,t){return(HurdlesPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var $=function(){function HurdlesPlayerAI(e,t){var n;switch(function HurdlesPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesPlayerAI),(n=HurdlesPlayerAI_possibleConstructorReturn(this,HurdlesPlayerAI_getPrototypeOf(HurdlesPlayerAI).call(this,e,t))).tapRateMin=.15,n.tapRateMax=.18,n.jumpRangeMin=100*n.scene.gameScale,n.jumpRangeMax=140*n.scene.gameScale,n.difficulty){case A.Difficulty.EASY:n.jumpRangeMin=80*n.scene.gameScale,n.jumpRangeMax=160*n.scene.gameScale,n.tapRateMin=.2,n.tapRateMax=.27;break;case A.Difficulty.MEDIUM:n.jumpRangeMin=90*n.scene.gameScale,n.jumpRangeMax=150*n.scene.gameScale,n.tapRateMin=.17,n.tapRateMax=.24;break;case A.Difficulty.HARD:n.jumpRangeMin=100*n.scene.gameScale,n.jumpRangeMax=140*n.scene.gameScale,n.tapRateMin=.14,n.tapRateMax=.21}return n.jumpRange=Phaser.Math.RND.realInRange(n.jumpRangeMin,n.jumpRangeMax),n.tapRate=Phaser.Math.RND.realInRange(n.tapRateMin,n.tapRateMax),n.tapTimer=n.tapRate,n.nextObstacleIndex=0,n.run=!1,n.jump=!1,n}return function HurdlesPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesPlayerAI_setPrototypeOf(e,t)}(HurdlesPlayerAI,A),function HurdlesPlayerAI_createClass(e,t,n){return t&&HurdlesPlayerAI_defineProperties(e.prototype,t),n&&HurdlesPlayerAI_defineProperties(e,n),e}(HurdlesPlayerAI,[{key:"update",value:function update(e,t){HurdlesPlayerAI_get(HurdlesPlayerAI_getPrototypeOf(HurdlesPlayerAI.prototype),"update",this).call(this,e,t),this.run=!1,this.jump=!1,0<this.tapTimer&&(this.tapTimer-=.001*t,this.tapTimer<=0&&(this.run=!0,this.tapTimer=this.tapRate)),this.nextObstacleIndex<this.scene.obstacles.length&&(this.scene.obstacles[this.nextObstacleIndex].obstacleBody?Math.abs(this.scene.obstacles[this.nextObstacleIndex].obstacleBody.x-this.player.x)<this.jumpRange&&(this.jump=!0,this.nextObstacleIndex++,this.jumpRange=Phaser.Math.RND.realInRange(this.jumpRangeMin,this.jumpRangeMax),this.tapRate=Phaser.Math.RND.realInRange(this.tapRateMin,this.tapRateMax)):this.nextObstacleIndex++)}}]),HurdlesPlayerAI}();function HurdlesPlayerInput_typeof(e){return(HurdlesPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HurdlesPlayerInput_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HurdlesPlayerInput_get(e,t,n){return(HurdlesPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HurdlesPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HurdlesPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HurdlesPlayerInput_getPrototypeOf(e){return(HurdlesPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesPlayerInput_setPrototypeOf(e,t){return(HurdlesPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Q=function(){function HurdlesPlayerInput(e,t){var n;if(function HurdlesPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesPlayerInput),!(n=function HurdlesPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesPlayerInput_typeof(t)&&"function"!=typeof t?HurdlesPlayerInput_assertThisInitialized(e):t}(this,HurdlesPlayerInput_getPrototypeOf(HurdlesPlayerInput).call(this,e,t))).scene.deviceManager.desktop){switch(n.buttonContainer=n.scene.add.container(0,n.scene.scale.height-150*n.scene.gameScale),1<n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.TWO){case!0:n.buttonContainer.x=.5*n.scene.scale.width+.5*n.scene.viewport.width-225*n.scene.gameScale;break;case!1:n.buttonContainer.x=.5*n.scene.scale.width-.5*n.scene.viewport.width+225*n.scene.gameScale}n.scene.ui.add(n.buttonContainer),n.jumpButton=new g(n.scene,n.buttonContainer,{x:-75*n.scene.gameScale,frames:["button_jump.png","button_jump.png"],spriteWidth:128*n.scene.gameScale,spriteHeight:128*n.scene.gameScale,buttonWidth:128*n.scene.gameScale,buttonHeight:128*n.scene.gameScale,atlas:"ui_atlas",id:"domui_MENU_play",domClass:"dom_button play",title:"Jump",callback:n.OnJumpKeyDown,context:HurdlesPlayerInput_assertThisInitialized(n)}),n.runButton=new g(n.scene,n.buttonContainer,{x:75*n.scene.gameScale,frames:["button_run.png","button_run.png"],spriteWidth:128*n.scene.gameScale,spriteHeight:128*n.scene.gameScale,buttonWidth:128*n.scene.gameScale,buttonHeight:128*n.scene.gameScale,atlas:"ui_atlas",id:"domui_MENU_play",domClass:"dom_button play",title:"Run",callback:n.OnRunKeyDown,context:HurdlesPlayerInput_assertThisInitialized(n)})}return n.wasRun=!1,n.run=!1,n.wasJump=!1,n.jump=!1,n.rightKey.on("down",n.OnRunKeyDown,HurdlesPlayerInput_assertThisInitialized(n)),n.upKey.on("down",n.OnJumpKeyDown,HurdlesPlayerInput_assertThisInitialized(n)),n}return function HurdlesPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesPlayerInput_setPrototypeOf(e,t)}(HurdlesPlayerInput,x),function HurdlesPlayerInput_createClass(e,t,n){return t&&HurdlesPlayerInput_defineProperties(e.prototype,t),n&&HurdlesPlayerInput_defineProperties(e,n),e}(HurdlesPlayerInput,[{key:"update",value:function update(e,t){HurdlesPlayerInput_get(HurdlesPlayerInput_getPrototypeOf(HurdlesPlayerInput.prototype),"update",this).call(this,e,t),this.run=this.wasRun,this.wasRun=!1,this.jump=this.wasJump,this.wasJump=!1}},{key:"OnRunKeyDown",value:function OnRunKeyDown(){this.wasRun=!0,this.run=!0}},{key:"OnJumpKeyDown",value:function OnJumpKeyDown(){this.wasJump=!0,this.jump=!0}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){HurdlesPlayerInput_get(HurdlesPlayerInput_getPrototypeOf(HurdlesPlayerInput.prototype),"OnEnterPreGameState",this).call(this),this.buttonContainer&&(this.jumpButton.Enable(),this.runButton.Enable())}},{key:"OnMinigameComplete",value:function OnMinigameComplete(){HurdlesPlayerInput_get(HurdlesPlayerInput_getPrototypeOf(HurdlesPlayerInput.prototype),"OnMinigameComplete",this).call(this),this.buttonContainer&&(this.buttonContainer.visible=!1,this.runButton.Disable(),this.jumpButton.Disable())}}]),HurdlesPlayerInput}();function HurdlesPlayerAnimation_typeof(e){return(HurdlesPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HurdlesPlayerAnimation_getPrototypeOf(e){return(HurdlesPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesPlayerAnimation_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HurdlesPlayerAnimation_setPrototypeOf(e,t){return(HurdlesPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ee=function(){function HurdlesPlayerAnimation(e,t){var n;return function HurdlesPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesPlayerAnimation),(n=function HurdlesPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesPlayerAnimation_typeof(t)&&"function"!=typeof t?HurdlesPlayerAnimation_assertThisInitialized(e):t}(this,HurdlesPlayerAnimation_getPrototypeOf(HurdlesPlayerAnimation).call(this,e,t))).spine.on("spine.event",n.OnSpineEvent,HurdlesPlayerAnimation_assertThisInitialized(n)),n}return function HurdlesPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesPlayerAnimation_setPrototypeOf(e,t)}(HurdlesPlayerAnimation,H),function HurdlesPlayerAnimation_createClass(e,t,n){return t&&HurdlesPlayerAnimation_defineProperties(e.prototype,t),n&&HurdlesPlayerAnimation_defineProperties(e,n),e}(HurdlesPlayerAnimation,[{key:"OnSpineEvent",value:function OnSpineEvent(e,t){switch(t.data.name){case"OnFootstep":switch(this.player.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","hurdles_player_one_footstep_0"+Phaser.Math.RND.integerInRange(1,5));break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","hurdles_player_two_footstep_0"+Phaser.Math.RND.integerInRange(1,5))}}}}]),HurdlesPlayerAnimation}();function HurdlesPlayer_typeof(e){return(HurdlesPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HurdlesPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HurdlesPlayer_get(e,t,n){return(HurdlesPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HurdlesPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HurdlesPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HurdlesPlayer_getPrototypeOf(e){return(HurdlesPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesPlayer_setPrototypeOf(e,t){return(HurdlesPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function HurdlesPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(ee,"State",Object.freeze({Idle:{animationName:"hurdles_idle",loop:!0},Ready:{animationName:"hurdles_ready",loop:!0},Run:{animationName:"hurdles_run",loop:!0},Stun:{animationName:"hurdles_stun",loop:!1},Jump:{animationName:"hurdles_jump",loop:!1},Win:{animationName:"hurdles_success",loop:!1},Lose:{animationName:"hurdles_fail",loop:!1}}));var te=function(){function HurdlesPlayer(e,t){var n;switch(function HurdlesPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesPlayer),(n=function HurdlesPlayer_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesPlayer_typeof(t)&&"function"!=typeof t?HurdlesPlayer_assertThisInitialized(e):t}(this,HurdlesPlayer_getPrototypeOf(HurdlesPlayer).call(this,e,t))).playerNumber){case M.PlayerNumber.ONE:n.setPosition(.5*n.scene.scale.width,500*n.scene.gameScale);break;case M.PlayerNumber.TWO:n.setPosition(.5*n.scene.scale.width,390*n.scene.gameScale)}n.playerCollisionCategory=n.scene.matter.world.nextCategory(),n.bodyDimensions=new Phaser.Math.Vector2(65*n.scene.gameScale,100*n.scene.gameScale),n.bodyOffset=new Phaser.Math.Vector2(0,.5*-n.bodyDimensions.y),n.body=n.scene.matter.add.image(n.x+n.bodyOffset.x,n.y+n.bodyOffset.y),n.body.setBody({type:"rectangle",width:n.bodyDimensions.x,height:n.bodyDimensions.y}),n.body.setIgnoreGravity(!1),n.body.setFixedRotation(),n.body.setMass(50),n.body.setFriction(1,0,100),n.body.setCollisionCategory(n.playerCollisionCategory),n.body.setCollidesWith([1,n.playerCollisionCategory]),n.body.gameObject=HurdlesPlayer_assertThisInitialized(n),n.add(n.body),n.floorBody=n.scene.matter.add.image(.5*n.scene.scale.width,n.y+25*n.scene.gameScale),n.floorBody.setBody({type:"rectangle",width:2200*n.scene.gameScale,height:50*n.scene.gameScale}),n.floorBody.setIgnoreGravity(!1),n.floorBody.setFixedRotation(),n.floorBody.setStatic(!0),n.floorBody.setFriction(.2,0),n.floorBody.setCollisionCategory(n.playerCollisionCategory),n.floorBody.setCollidesWith(n.playerCollisionCategory);var r=n.playerNumber==M.PlayerNumber.ONE?n.scene.frontContainer:n.scene.backContainer;n.flashSpine=n.scene.add.spine(.5*n.scale.width,.5*n.scale.height,"flash","flash",!1),n.flashSpine.setScale(n.gameScale),n.flashSpine.visible=!1,r.add(n.flashSpine),n.trailParticles=n.scene.add.particles("hurdles_minigame_atlas","trail.png"),r.add(n.trailParticles),n.trailParticleEmitter=n.trailParticles.createEmitter({on:!1,frequency:20,x:10*n.scene.gameScale,y:-70*n.scene.gameScale,alpha:{start:.5,end:0,ease:"Sine.easeOut"},scale:{start:1,end:.3,ease:"Sine.easeOut"},rotate:{start:0,end:0,ease:"Linear"},lifespan:1e3,follow:HurdlesPlayer_assertThisInitialized(n)}),n.trailParticleEmitter.reserve(Math.ceil(n.trailParticleEmitter.lifespan/n.trailParticleEmitter.frequency));var o=new Phaser.Math.Vector2(50*n.scene.gameScale,20*n.scene.gameScale),i=new Phaser.Geom.Rectangle(.5*-o.x,.5*-o.y,o.x,o.y);return n.dustParticles=n.scene.add.particles("hurdles_minigame_atlas","dust.png"),r.add(n.dustParticles),n.dustParticleEmitter=n.dustParticles.createEmitter({on:!1,x:10*n.scene.gameScale,y:-5*n.scene.gameScale,alpha:{start:1,end:0,ease:"Sine.easeOut"},scale:{start:.5,end:.3,ease:"Sine.easeOut"},angle:{min:0,max:360},lifespan:1e3,speedX:{min:-100*n.scene.gameScale,max:100*n.scene.gameScale},speedY:{start:-100*n.scene.gameScale,end:-100*n.scene.gameScale},accelerationY:{start:250*n.scene.gameScale,end:250*n.scene.gameScale},emitZone:{source:i},follow:HurdlesPlayer_assertThisInitialized(n)}),n.dustParticleEmitter.reserve(5),n.jumpTweenTimeline=null,n.standY=null,n.inRace=!0,n.hasWon=!1,n.runSpeed=7.15,n.previousPosition=new Phaser.Math.Vector2,n.movedDirection=new Phaser.Math.Vector2,n.hasRanSinceJump=!1,n.knockbackForce=new Phaser.Math.Vector2(-.5*n.scene.gameScale,-.5*n.scene.gameScale),n.stunnedCooldownTimer=0,n.stunnedCooldownTime=1,n.stunnedKnockbackTimer=0,n.stunnedKnockbackTime=.001,n.canLandCooldownTimer=0,n.canLandCooldownTime=.5,n.runCooldownTimer=0,n.runCooldownTime=.3,n.canLoseOffScreen=n.controller==M.Controller.HUMAN,n.animation.SetState(ee.State.Ready),n.state=HurdlesPlayer.State.Idle,n}return function HurdlesPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesPlayer_setPrototypeOf(e,t)}(HurdlesPlayer,L),function HurdlesPlayer_createClass(e,t,n){return t&&HurdlesPlayer_defineProperties(e.prototype,t),n&&HurdlesPlayer_defineProperties(e,n),e}(HurdlesPlayer,[{key:"CreateInput",value:function CreateInput(){return new Q(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new $(this.scene,this)}},{key:"CreateAnimation",value:function CreateAnimation(){return new ee(this.scene,this)}},{key:"update",value:function update(e,t){HurdlesPlayer_get(HurdlesPlayer_getPrototypeOf(HurdlesPlayer.prototype),"update",this).call(this,e,t),this.x=this.body.body.position.x-this.bodyOffset.x,this.y=this.body.body.position.y-this.bodyOffset.y,this.standY||(this.standY=this.y),this.floorBody.x=this.scene.minigameCamera.cameraLookAt.x,this.movedDirection.setTo(this.x-this.previousPosition.x,this.y-this.previousPosition.y);var n=Math.atan2(this.movedDirection.y,this.movedDirection.x);if(n<0&&(n+=2*Math.PI),n=Phaser.Math.RadToDeg(n),this.trailParticleEmitter.rotate.start=n,this.trailParticleEmitter.rotate.end=n,this.scene.state==F.State.Game){switch(this.state){case HurdlesPlayer.State.Idle:this.UpdateIdleState(e,t);break;case HurdlesPlayer.State.Run:this.UpdateRunState(e,t);break;case HurdlesPlayer.State.Jump:this.UpdateJumpState(e,t);break;case HurdlesPlayer.State.Stunned:this.UpdateStunnedState(e,t)}this.canLoseOffScreen&&this.inRace&&this.x<this.scene.minigameCamera.cameraLookAt.x-.5*this.scene.viewport.width&&this.Lose(),this.previousPosition.setTo(this.x,this.y)}}},{key:"UpdateIdleState",value:function UpdateIdleState(){}},{key:"UpdateJumpState",value:function UpdateJumpState(e,t){0<this.canLandCooldownTimer&&(this.canLandCooldownTimer-=.001*t),0<this.runCooldownTimer&&(this.runCooldownTimer-=.001*t),this.canLandCooldownTimer<=0&&this.OnGround()&&this.OnLand()}},{key:"UpdateRunState",value:function UpdateRunState(e,t){0<this.runCooldownTimer&&(this.runCooldownTimer-=.001*t,this.runCooldownTimer<=0&&this.SetState(HurdlesPlayer.State.Idle))}},{key:"UpdateStunnedState",value:function UpdateStunnedState(e,t){0<this.stunnedCooldownTimer&&(this.stunnedCooldownTimer-=.001*t,this.stunnedCooldownTimer<=0&&this.SetState(HurdlesPlayer.State.Idle))}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){HurdlesPlayer_get(HurdlesPlayer_getPrototypeOf(HurdlesPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&(this.playerInput.jump?this.AttemptJump():this.playerInput.run&&this.AttemptRun())}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){HurdlesPlayer_get(HurdlesPlayer_getPrototypeOf(HurdlesPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state==F.State.Game&&(this.playerAI.jump?this.AttemptJump():this.playerAI.run&&this.AttemptRun())}},{key:"SetState",value:function SetState(e){if(this.state!=e)switch(this.state=e){case HurdlesPlayer.State.Idle:this.OnEnterIdleState();break;case HurdlesPlayer.State.Run:this.OnEnterRunState();break;case HurdlesPlayer.State.Jump:this.OnEnterJumpState();break;case HurdlesPlayer.State.Stunned:this.OnEnterStunnedState();break;case HurdlesPlayer.State.EndGame:this.OnEnterEndGameState()}}},{key:"OnEnterIdleState",value:function OnEnterIdleState(){this.trailParticleEmitter.on=!1,this.animation.SetState(ee.State.Idle)}},{key:"OnEnterRunState",value:function OnEnterRunState(){this.trailParticleEmitter.on=!1,this.hasRanSinceJump=!0,this.animation.SetState(ee.State.Run)}},{key:"OnEnterJumpState",value:function OnEnterJumpState(){switch(this.trailParticleEmitter.on=!0,this.dustParticleEmitter.explode(5),this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","hurdles_player_one_jump");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","hurdles_player_two_jump")}this.canLandCooldownTimer=this.canLandCooldownTime,this.animation.SetState(ee.State.Jump),this.body.setVelocity(0,0),this.jumpTweenTimeline=this.scene.tweens.createTimeline();var e=250*this.scene.gameScale,t=250*this.scene.gameScale,n=this.body.y;this.hasRanSinceJump||(t=0),this.jumpTweenTimeline.add({targets:this.body,x:{value:this.body.x+.5*t,duration:750,ease:"Linear"},y:{value:this.body.y-e,duration:750,ease:"Sine.easeOut"}}),this.jumpTweenTimeline.add({targets:this.body,x:{value:this.body.x+t,duration:750,ease:"Linear"},y:{value:n,duration:750,ease:"Sine.easeIn"}}),this.jumpTweenTimeline.play(),this.hasRanSinceJump=!1}},{key:"OnEnterStunnedState",value:function OnEnterStunnedState(){this.jumpTweenTimeline&&this.jumpTweenTimeline.stop(),this.trailParticleEmitter.on=!1,this.stunnedCooldownTimer=this.stunnedCooldownTime,this.stunnedKnockbackTimer=this.stunnedKnockbackTime,this.animation.SetState(ee.State.Stun)}},{key:"OnEnterEndGameState",value:function OnEnterEndGameState(){this.trailParticleEmitter.on=!1}},{key:"AttemptRun",value:function AttemptRun(){this.runCooldownTimer=this.runCooldownTime,this.state!=HurdlesPlayer.State.Idle&&this.state!=HurdlesPlayer.State.Run||(this.SetState(HurdlesPlayer.State.Run),this.body.setVelocity(this.runSpeed,0))}},{key:"AttemptJump",value:function AttemptJump(){this.state!=HurdlesPlayer.State.Idle&&this.state!=HurdlesPlayer.State.Run||this.SetState(HurdlesPlayer.State.Jump)}},{key:"Lose",value:function Lose(){this.inRace=!1,this.scene.EndGame()}},{key:"OnLand",value:function OnLand(){switch(0<this.runCooldownTimer?this.SetState(HurdlesPlayer.State.Run):this.SetState(HurdlesPlayer.State.Idle),this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","hurdles_player_one_land");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","hurdles_player_two_land")}this.dustParticleEmitter.explode(5)}},{key:"OnHitObstacle",value:function OnHitObstacle(e){this.state!=HurdlesPlayer.State.Run&&this.state!=HurdlesPlayer.State.Jump||(this.flashSpine.parentContainer.bringToTop(this.flashSpine),this.flashSpine.visible=!0,this.flashSpine.setPosition(e.pair.collision.supports[0].x,e.pair.collision.supports[0].y),this.flashSpine.setScale(.5),this.flashSpine.setAnimation(0,"flash",!1),this.body.setVelocity(0,0),this.scene.minigameCamera.camera.shake(250,.003),this.SetState(HurdlesPlayer.State.Stunned))}},{key:"OnGround",value:function OnGround(){return Math.abs(this.body.body.velocity.y)<.01&&Math.abs(this.y-this.standY)<.5}},{key:"OnMinigameWon",value:function OnMinigameWon(){HurdlesPlayer_get(HurdlesPlayer_getPrototypeOf(HurdlesPlayer.prototype),"OnMinigameWon",this).call(this),this.SetState(HurdlesPlayer.State.EndGame),this.animation.SetState(ee.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){HurdlesPlayer_get(HurdlesPlayer_getPrototypeOf(HurdlesPlayer.prototype),"OnMinigameLost",this).call(this),this.SetState(HurdlesPlayer.State.EndGame),this.animation.SetState(ee.State.Lose)}},{key:"destroy",value:function destroy(){HurdlesPlayer_get(HurdlesPlayer_getPrototypeOf(HurdlesPlayer.prototype),"destroy",this).call(this)}}]),HurdlesPlayer}();function HurdlesCamera_typeof(e){return(HurdlesCamera_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesCamera_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HurdlesCamera_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesCamera_typeof(t)&&"function"!=typeof t?function HurdlesCamera_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HurdlesCamera_get(e,t,n){return(HurdlesCamera_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HurdlesCamera_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HurdlesCamera_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HurdlesCamera_getPrototypeOf(e){return(HurdlesCamera_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesCamera_setPrototypeOf(e,t){return(HurdlesCamera_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function HurdlesPlayer_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(te,"State",Object.freeze({Idle:0,Run:1,Jump:2,Stunned:3,GameOver:4}));var ne=function(){function HurdlesCamera(e){var t;return function HurdlesCamera_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesCamera),(t=HurdlesCamera_possibleConstructorReturn(this,HurdlesCamera_getPrototypeOf(HurdlesCamera).call(this,e))).SetLookAt(.6*t.scene.scale.width,.5*t.scene.scale.height),t.padding=200*t.scene.gameScale,t.snapCamera=!0,t.minX=.6*t.scene.scale.width,t}return function HurdlesCamera_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesCamera_setPrototypeOf(e,t)}(HurdlesCamera,j),function HurdlesCamera_createClass(e,t,n){return t&&HurdlesCamera_defineProperties(e.prototype,t),n&&HurdlesCamera_defineProperties(e,n),e}(HurdlesCamera,[{key:"update",value:function update(e,t){HurdlesCamera_get(HurdlesCamera_getPrototypeOf(HurdlesCamera.prototype),"update",this).call(this,e,t),this.CalculateAverageLookAt()}},{key:"CalculateAverageLookAt",value:function CalculateAverageLookAt(){for(var e=0,t=-1e4,n=0;n<this.scene.players.length;n++)e+=this.scene.players[n].x,this.scene.players[n].x>t&&(t=this.scene.players[n].x);var r=t-(e/=this.scene.players.length);r>.5*this.scene.viewport.width-this.padding&&(e+=r-(.5*this.scene.viewport.width-this.padding));var o=this.snapCamera?e:Phaser.Math.Linear(this.cameraLookAt.x,e,.1);this.snapCamera=!1,o=Math.max(o,this.minX),this.SetLookAt(o,this.cameraLookAt.y)}}]),HurdlesCamera}();function HurdlesObstacle_typeof(e){return(HurdlesObstacle_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesObstacle_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HurdlesObstacle_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HurdlesObstacle_get(e,t,n){return(HurdlesObstacle_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HurdlesObstacle_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HurdlesObstacle_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HurdlesObstacle_getPrototypeOf(e){return(HurdlesObstacle_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesObstacle_setPrototypeOf(e,t){return(HurdlesObstacle_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var re=function(){function HurdlesObstacle(e,t,n,r){var o;return function HurdlesObstacle_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesObstacle),(o=function HurdlesObstacle_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesObstacle_typeof(t)&&"function"!=typeof t?HurdlesObstacle_assertThisInitialized(e):t}(this,HurdlesObstacle_getPrototypeOf(HurdlesObstacle).call(this,e,t,n))).player=r,o.obstacleSpine=o.scene.add.spine(15*o.scene.gameScale,80*o.scene.gameScale,"hurdle","idle",!1),o.obstacleSpine.setScale(o.scene.gameScale),o.add(o.obstacleSpine),o.obstacleBody=o.scene.matter.add.image(t+10*o.scene.gameScale,n,void 0,void 0,{shape:{type:"rectangle",width:10*o.scene.gameScale,height:158*o.scene.gameScale}}),o.obstacleBody.setFixedRotation(),o.obstacleBody.setIgnoreGravity(!0),o.obstacleBody.setFriction(0),o.obstacleBody.setSensor(!0),o.obstacleBody.setCollisionCategory(r.playerCollisionCategory),o.obstacleBody.setCollidesWith(r.playerCollisionCategory),o.obstacleBody.gameObject=HurdlesObstacle_assertThisInitialized(o),o.scene.world.addAt(o.obstacleBody,o.scene.world.getIndex(r)),o.scene.matterCollision.addOnCollideStart({objectA:o.obstacleBody,objectB:r.body,callback:o.OnPlayerCollisionStart,context:HurdlesObstacle_assertThisInitialized(o)}),o.padding=100*o.scene.gameScale,o}return function HurdlesObstacle_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesObstacle_setPrototypeOf(e,t)}(HurdlesObstacle,Phaser.GameObjects.Container),function HurdlesObstacle_createClass(e,t,n){return t&&HurdlesObstacle_defineProperties(e.prototype,t),n&&HurdlesObstacle_defineProperties(e,n),e}(HurdlesObstacle,[{key:"update",value:function update(){var e=this.scene.minigameCamera.camera.midPoint.x-.5*this.scene.scale.width,t=this.scene.minigameCamera.camera.midPoint.x+.5*this.scene.scale.width,n=this.x<=t+this.padding&&this.x>=e-this.padding;this.visible=n}},{key:"OnPlayerCollisionStart",value:function OnPlayerCollisionStart(e){this.player.OnHitObstacle(e),this.obstacleSpine.setAnimation(0,"drop",!1),h.Instance.Play("sfx_minigame","hurdles_impact"),this.obstacleBody.destroy(),this.obstacleBody=null}},{key:"destroy",value:function destroy(){HurdlesObstacle_get(HurdlesObstacle_getPrototypeOf(HurdlesObstacle.prototype),"destroy",this).call(this),this.obstacleBody&&this.obstacleBody.destroy()}}]),HurdlesObstacle}();function HurdlesBackground_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oe=function(){function HurdlesBackground(e){!function HurdlesBackground_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesBackground),this.scene=e,this.backgroundPieces=[],this.backgroundWidth=1820*this.scene.gameScale;for(var t=0;t<2;t++){var n=this.scene.add.sprite(.5*this.scene.scale.width+this.backgroundWidth*t,.5*this.scene.scale.height,"hurdles_background");this.scene.world.add(n),this.backgroundPieces.push(n)}}return function HurdlesBackground_createClass(e,t,n){return t&&HurdlesBackground_defineProperties(e.prototype,t),n&&HurdlesBackground_defineProperties(e,n),e}(HurdlesBackground,[{key:"update",value:function update(){for(var e=this.scene.minigameCamera.cameraLookAt.x-.5*this.scene.scale.width,t=0;t<this.backgroundPieces.length;t++){this.backgroundPieces[t].x+.5*this.backgroundPieces[t].width<e&&(this.backgroundPieces[t].x+=this.backgroundPieces[t].width*this.backgroundPieces.length)}}}]),HurdlesBackground}();function HurdlesTrack_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ie=function(){function HurdlesTrack(e,t){!function HurdlesTrack_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesTrack),this.scene=e,this.startX=.5*this.scene.scale.width+30*this.scene.gameScale,this.finishX=this.startX+t;for(var n=0;n<2;n++){var r=(390+110*n)*this.scene.gameScale,o=this.scene.add.sprite(this.startX,r,"hurdles_minigame_atlas","hurdles_track.png");o.setOrigin(0,.5),o.setScale(t/o.width,1),this.scene.world.add(o);var i=this.scene.add.sprite(this.startX,r,"hurdles_minigame_atlas","hurdles_track_start.png");i.setOrigin(.5,.5),this.scene.world.add(i);var a=this.scene.add.sprite(this.finishX,r,"hurdles_minigame_atlas","hurdles_finishline.png");a.setOrigin(0,.5),this.scene.world.add(a)}this.ribbonStand=this.scene.add.sprite(this.finishX+5*this.scene.gameScale,280*this.scene.gameScale,"hurdles_minigame_atlas","ribbon_stand.png"),this.scene.world.add(this.ribbonStand),this.ribbonSpine=this.scene.add.spine(this.finishX,410*this.scene.gameScale,"ribbon","idle",!1),this.ribbonSpine.setScale(this.gameScale),this.scene.world.add(this.ribbonSpine),this.hasAnyPlayerFinished=!1}return function HurdlesTrack_createClass(e,t,n){return t&&HurdlesTrack_defineProperties(e.prototype,t),n&&HurdlesTrack_defineProperties(e,n),e}(HurdlesTrack,[{key:"update",value:function update(){if(!this.hasAnyPlayerFinished)for(var e=0;e<this.scene.players.length;e++)if(this.scene.players[e].x+25*this.scene.gameScale>this.finishX){this.scene.players[e].hasWon=!0,this.hasAnyPlayerFinished=!0,this.ribbonSpine.setAnimation(0,"break",!1),this.scene.EndGame();break}}}]),HurdlesTrack}();function HurdlesTutorialPopup_typeof(e){return(HurdlesTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesTutorialPopup_typeof(t)&&"function"!=typeof t?function HurdlesTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HurdlesTutorialPopup_getPrototypeOf(e){return(HurdlesTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesTutorialPopup_setPrototypeOf(e,t){return(HurdlesTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ae=function(){function HurdlesTutorialPopup(e){var t;!function HurdlesTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesTutorialPopup),(t=HurdlesTutorialPopup_possibleConstructorReturn(this,HurdlesTutorialPopup_getPrototypeOf(HurdlesTutorialPopup).call(this,e))).panel.setTexture("hurdles_minigame_atlas","how_to_hurdles.png");for(var n=0;n<t.controlSpines.length;n++)t.scene.deviceManager.desktop?t.controlSpines[n].setAnimation(0,"up_right",!0):t.controlSpines[n].setAnimation(0,"tap",!0);return t}return function HurdlesTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesTutorialPopup_setPrototypeOf(e,t)}(HurdlesTutorialPopup,R),HurdlesTutorialPopup}();function HurdlesBackgroundCharacter_typeof(e){return(HurdlesBackgroundCharacter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesBackgroundCharacter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HurdlesBackgroundCharacter_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesBackgroundCharacter_typeof(t)&&"function"!=typeof t?function HurdlesBackgroundCharacter_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HurdlesBackgroundCharacter_get(e,t,n){return(HurdlesBackgroundCharacter_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HurdlesBackgroundCharacter_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HurdlesBackgroundCharacter_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HurdlesBackgroundCharacter_getPrototypeOf(e){return(HurdlesBackgroundCharacter_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesBackgroundCharacter_setPrototypeOf(e,t){return(HurdlesBackgroundCharacter_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var se=function(){function HurdlesBackgroundCharacter(e,t,n,r,o){var i;return function HurdlesBackgroundCharacter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesBackgroundCharacter),(i=HurdlesBackgroundCharacter_possibleConstructorReturn(this,HurdlesBackgroundCharacter_getPrototypeOf(HurdlesBackgroundCharacter).call(this,e,t,n))).spine=i.scene.add.spine(0,0,r,o,!0),i.spine.setScale(i.scene.gameScale),i.add(i.spine),i.padding=100*i.scene.gameScale,i}return function HurdlesBackgroundCharacter_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesBackgroundCharacter_setPrototypeOf(e,t)}(HurdlesBackgroundCharacter,Phaser.GameObjects.Container),function HurdlesBackgroundCharacter_createClass(e,t,n){return t&&HurdlesBackgroundCharacter_defineProperties(e.prototype,t),n&&HurdlesBackgroundCharacter_defineProperties(e,n),e}(HurdlesBackgroundCharacter,[{key:"update",value:function update(){var e=this.scene.minigameCamera.camera.midPoint.x-.5*this.scene.scale.width,t=this.scene.minigameCamera.camera.midPoint.x+.5*this.scene.scale.width,n=this.x<=t+this.padding&&this.x>=e-this.padding;this.visible=n}},{key:"destroy",value:function destroy(){HurdlesBackgroundCharacter_get(HurdlesBackgroundCharacter_getPrototypeOf(HurdlesBackgroundCharacter.prototype),"destroy",this).call(this)}}]),HurdlesBackgroundCharacter}();function HurdlesMinigame_typeof(e){return(HurdlesMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HurdlesMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HurdlesMinigame_possibleConstructorReturn(e,t){return!t||"object"!==HurdlesMinigame_typeof(t)&&"function"!=typeof t?function HurdlesMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HurdlesMinigame_get(e,t,n){return(HurdlesMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HurdlesMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HurdlesMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HurdlesMinigame_getPrototypeOf(e){return(HurdlesMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HurdlesMinigame_setPrototypeOf(e,t){return(HurdlesMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var le=function(){function HurdlesMinigame(){return function HurdlesMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HurdlesMinigame),HurdlesMinigame_possibleConstructorReturn(this,HurdlesMinigame_getPrototypeOf(HurdlesMinigame).call(this,"HurdlesMinigame"))}return function HurdlesMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HurdlesMinigame_setPrototypeOf(e,t)}(HurdlesMinigame,F),function HurdlesMinigame_createClass(e,t,n){return t&&HurdlesMinigame_defineProperties(e.prototype,t),n&&HurdlesMinigame_defineProperties(e,n),e}(HurdlesMinigame,[{key:"create",value:function create(){HurdlesMinigame_get(HurdlesMinigame_getPrototypeOf(HurdlesMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["hurdles_start","hurdles_player_one_jump","hurdles_player_one_land","hurdles_player_two_jump","hurdles_player_two_land","hurdles_impact","hurdles_player_one_footstep_01","hurdles_player_one_footstep_02","hurdles_player_one_footstep_03","hurdles_player_one_footstep_04","hurdles_player_one_footstep_05","hurdles_player_two_footstep_01","hurdles_player_two_footstep_02","hurdles_player_two_footstep_03","hurdles_player_two_footstep_04","hurdles_player_two_footstep_05","hurdles_finish_race","music_hurdles"]}),h.Instance.AddLayer("music_minigame",{audioKeys:["music_hurdles"]}),h.Instance.Play("music_minigame","music_hurdles")}},{key:"CreateMinigameCamera",value:function CreateMinigameCamera(){return new ne(this)}},{key:"CreateMinigameUI",value:function CreateMinigameUI(){return new Z(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new ae(this)}},{key:"CreateWorld",value:function CreateWorld(){HurdlesMinigame_get(HurdlesMinigame_getPrototypeOf(HurdlesMinigame.prototype),"CreateWorld",this).call(this),this.raceLength=4e3*this.gameScale,this.safeZone=500*this.gameScale,this.matter.world.engine.world.gravity.y=this.gameScale,this.background=new oe(this),this.backContainer=this.add.container(),this.frontContainer=this.add.container();for(var e=0;e<2;e++){var t=new te(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(t)}this.track=new ie(this,this.raceLength),this.CreateBackgroundCharacters(),this.world.add(this.backContainer),this.world.add(this.frontContainer),this.obstacles=[];for(e=this.safeZone;e<this.raceLength-this.safeZone;e+=Phaser.Math.RND.realInRange(300,600))for(var n=this.players.length-1;0<=n;n--){var r=new re(this,.5*this.scale.width+e,this.players[n].y-45*this.gameScale,this.players[n]);this.obstacles.push(r),(0==n?this.frontContainer:this.backContainer).add(r)}for(e=this.players.length-1;0<=e;e--){(0==e?this.frontContainer:this.backContainer).add(this.players[e])}this.world.add(this.matter.world.debugGraphic),this.world.bringToTop(this.track.ribbonSpine),this.confettiParticles=this.add.particles("shared_minigame_atlas"),this.ui.add(this.confettiParticles),this.confettiParticleLeftEmitter=this.confettiParticles.createEmitter({on:!1,x:.5*this.scale.width-.5*this.viewport.width,y:this.scale.height,frame:["confetto_0.png","confetto_1.png","confetto_2.png","confetto_3.png","confetto_4.png","confetto_5.png","confetto_6.png"],alpha:{start:1,end:0,ease:"Sine.easeIn"},scale:{start:1,end:0,ease:"Sine.easeIn"},rotate:{min:0,max:360,start:0,end:-720},speed:{min:200*this.gameScale,max:1e3*this.gameScale},radial:!0,angle:{min:-80,max:-45},gravityY:600,lifespan:2e3}),this.confettiParticleLeftEmitter.reserve(50),this.confettiParticleRightEmitter=this.confettiParticles.createEmitter({on:!1,x:.5*this.scale.width+.5*this.viewport.width,y:this.scale.height,frame:["confetto_0.png","confetto_1.png","confetto_2.png","confetto_3.png","confetto_4.png","confetto_5.png","confetto_6.png"],alpha:{start:1,end:0,ease:"Sine.easeIn"},scale:{start:1,end:0,ease:"Sine.easeIn"},rotate:{min:0,max:360,start:0,end:720},speed:{min:200*this.gameScale,max:1e3*this.gameScale},radial:!0,angle:{min:-135,max:-85},gravityY:600,lifespan:2e3}),this.confettiParticleRightEmitter.reserve(50),this.explodeTimer=0}},{key:"update",value:function update(e,t){HurdlesMinigame_get(HurdlesMinigame_getPrototypeOf(HurdlesMinigame.prototype),"update",this).call(this,e,t),this.explodeTimer-=.001*t,this.explodeTimer<0&&(this.explodeTimer=1);for(var n=0;n<this.obstacles.length;n++)this.obstacles[n].update(e,t);for(n=0;n<this.backgroundCharacters.length;n++)this.backgroundCharacters[n].update(e,t);this.background.update(e,t),this.track.update(e,t)}},{key:"CreateBackgroundCharacters",value:function CreateBackgroundCharacters(){this.richard=new se(this,1100*this.gameScale,350*this.gameScale,"minigame_richard","idle_1"),this.world.add(this.richard),this.teri=new se(this,2200*this.gameScale,350*this.gameScale,"minigame_teri","idle"),this.world.add(this.teri),this.carmen=new se(this,2700*this.gameScale,350*this.gameScale,"minigame_carmen","idle"),this.world.add(this.carmen),this.alan=new se(this,3700*this.gameScale,350*this.gameScale,"minigame_alan","idle"),this.world.add(this.alan),this.bananajoe=new se(this,4700*this.gameScale,350*this.gameScale,"minigame_bananajoe","idle"),this.world.add(this.bananajoe),this.brown=new se(this,4900*this.gameScale,335*this.gameScale,"minigame_brown","idle"),this.world.add(this.brown),this.teri2=new se(this,5e3*this.gameScale,350*this.gameScale,"minigame_teri","idle"),this.world.add(this.teri2),this.leslie=new se(this,5100*this.gameScale,350*this.gameScale,"minigame_leslie","idle"),this.world.add(this.leslie),this.backgroundCharacters=[this.richard,this.teri,this.carmen,this.alan,this.bananajoe,this.brown,this.teri2,this.leslie]}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=0;e<this.players.length;e++)if(this.players[e].hasWon)return this.players[e];for(e=0;e<this.players.length;e++)if(this.players[e].inRace)return this.players[e]}},{key:"OnEnterGameState",value:function OnEnterGameState(){HurdlesMinigame_get(HurdlesMinigame_getPrototypeOf(HurdlesMinigame.prototype),"OnEnterGameState",this).call(this),h.Instance.Play("sfx_minigame","hurdles_start"),this.richard&&(this.richard.spine.once("spine.complete",this.OnRichardFlagWaveComplete,this),this.richard.spine.setAnimation(0,"flag_wave",!1))}},{key:"OnRichardFlagWaveComplete",value:function OnRichardFlagWaveComplete(){this.richard.spine.setAnimation(0,"idle_2",!0)}},{key:"EndGame",value:function EndGame(){HurdlesMinigame_get(HurdlesMinigame_getPrototypeOf(HurdlesMinigame.prototype),"EndGame",this).call(this),h.Instance.Play("sfx_minigame","hurdles_finish_race")}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){HurdlesMinigame_get(HurdlesMinigame_getPrototypeOf(HurdlesMinigame.prototype),"OnEnterPostGameState",this).call(this),this.confettiParticleLeftEmitter.explode(50),this.confettiParticleRightEmitter.explode(50),h.Instance.Play("sfx_minigame","winner_confetti_shot")}}]),HurdlesMinigame}();function MinigamePlayerDragInput_typeof(e){return(MinigamePlayerDragInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigamePlayerDragInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigamePlayerDragInput_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MinigamePlayerDragInput_get(e,t,n){return(MinigamePlayerDragInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function MinigamePlayerDragInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MinigamePlayerDragInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MinigamePlayerDragInput_getPrototypeOf(e){return(MinigamePlayerDragInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigamePlayerDragInput_setPrototypeOf(e,t){return(MinigamePlayerDragInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ce=function(){function MinigamePlayerDragInput(e,t){var n;return function MinigamePlayerDragInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigamePlayerDragInput),(n=function MinigamePlayerDragInput_possibleConstructorReturn(e,t){return!t||"object"!==MinigamePlayerDragInput_typeof(t)&&"function"!=typeof t?MinigamePlayerDragInput_assertThisInitialized(e):t}(this,MinigamePlayerDragInput_getPrototypeOf(MinigamePlayerDragInput).call(this,e,t))).scene.deviceManager.desktop||(n.inputRect=n.scene.add.rectangle(0,0,100*n.scene.gameScale,100*n.scene.gameScale,16776960,0),n.inputRect.setOrigin(.5),n.inputRect.setInteractive(),n.inputRect.on("pointerdown",n.OnPointerDown,MinigamePlayerDragInput_assertThisInitialized(n)),n.scene.ui.add(n.inputRect)),n.dragMoveVector=new Phaser.Math.Vector2(0,0),n.touchDirection=new Phaser.Math.Vector2(0,0),n.touchDistance=0,n.pointerPosition=new Phaser.Math.Vector2(0,0),n.activePointer=null,n}return function MinigamePlayerDragInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigamePlayerDragInput_setPrototypeOf(e,t)}(MinigamePlayerDragInput,x),function MinigamePlayerDragInput_createClass(e,t,n){return t&&MinigamePlayerDragInput_defineProperties(e.prototype,t),n&&MinigamePlayerDragInput_defineProperties(e,n),e}(MinigamePlayerDragInput,[{key:"update",value:function update(e,t){MinigamePlayerDragInput_get(MinigamePlayerDragInput_getPrototypeOf(MinigamePlayerDragInput.prototype),"update",this).call(this,e,t),this.inputRect&&(this.inputRect.x=this.player.x,this.inputRect.y=this.player.y),this.dragMoveVector.set(0,0),this.touchDirection.set(0,0),this.touchDistance=0,this.activePointer&&(this.activePointer.isDown?(this.dragMoveVector.x=2*(this.activePointer.worldX-this.pointerPosition.x),this.dragMoveVector.y=2*(this.activePointer.worldY-this.pointerPosition.y),this.touchDirection.set(this.activePointer.worldX-this.player.x,this.activePointer.worldY-this.player.y),this.touchDistance=this.touchDirection.length(),this.touchDirection.normalize(),this.pointerPosition.set(this.activePointer.worldX,this.activePointer.worldY)):this.activePointer=null)}},{key:"OnPointerDown",value:function OnPointerDown(e){this.activePointer=e,this.pointerPosition.set(this.activePointer.worldX,this.activePointer.worldY)}}]),MinigamePlayerDragInput}();function PaintingPlayerAI_typeof(e){return(PaintingPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PaintingPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PaintingPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==PaintingPlayerAI_typeof(t)&&"function"!=typeof t?function PaintingPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function PaintingPlayerAI_get(e,t,n){return(PaintingPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function PaintingPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PaintingPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PaintingPlayerAI_getPrototypeOf(e){return(PaintingPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PaintingPlayerAI_setPrototypeOf(e,t){return(PaintingPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ue=function(){function PaintingPlayerAI(e,t){var n;switch(function PaintingPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaintingPlayerAI),(n=PaintingPlayerAI_possibleConstructorReturn(this,PaintingPlayerAI_getPrototypeOf(PaintingPlayerAI).call(this,e,t))).moveVector=new Phaser.Math.Vector2(0,0),n.moveSpeed=15*n.scene.gameScale,n.difficulty){case A.Difficulty.EASY:n.moveSpeed=8*n.scene.gameScale;break;case A.Difficulty.MEDIUM:n.moveSpeed=11*n.scene.gameScale;break;case A.Difficulty.HARD:n.moveSpeed=14*n.scene.gameScale}return n}return function PaintingPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PaintingPlayerAI_setPrototypeOf(e,t)}(PaintingPlayerAI,A),function PaintingPlayerAI_createClass(e,t,n){return t&&PaintingPlayerAI_defineProperties(e.prototype,t),n&&PaintingPlayerAI_defineProperties(e,n),e}(PaintingPlayerAI,[{key:"update",value:function update(e,t){PaintingPlayerAI_get(PaintingPlayerAI_getPrototypeOf(PaintingPlayerAI.prototype),"update",this).call(this,e,t),this.moveVector.set(0,0);for(var n=null,r=Number.POSITIVE_INFINITY,o=0;o<this.scene.paintAITargets.length;o++)if(this.scene.paintAITargets[o].lastTaggedPlayer!=this.player){var i=Phaser.Math.Distance.Between(this.player.body.x,this.player.body.y,this.scene.paintAITargets[o].x,this.scene.paintAITargets[o].y);i<r&&(r=i,n=this.scene.paintAITargets[o])}n&&(this.moveVector.set(n.x-this.player.body.x,n.y-this.player.body.y),this.moveVector.normalize(),this.moveVector.x*=this.moveSpeed,this.moveVector.y*=this.moveSpeed)}}]),PaintingPlayerAI}();function PaintingPlayerAnimation_typeof(e){return(PaintingPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PaintingPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PaintingPlayerAnimation_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PaintingPlayerAnimation_get(e,t,n){return(PaintingPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function PaintingPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PaintingPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PaintingPlayerAnimation_getPrototypeOf(e){return(PaintingPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PaintingPlayerAnimation_setPrototypeOf(e,t){return(PaintingPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var pe=function(){function PaintingPlayerAnimation(e,t){var n;return function PaintingPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaintingPlayerAnimation),(n=function PaintingPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==PaintingPlayerAnimation_typeof(t)&&"function"!=typeof t?PaintingPlayerAnimation_assertThisInitialized(e):t}(this,PaintingPlayerAnimation_getPrototypeOf(PaintingPlayerAnimation).call(this,e,t))).spine.on("spine.event",n.OnSpineEvent,PaintingPlayerAnimation_assertThisInitialized(n)),n}return function PaintingPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PaintingPlayerAnimation_setPrototypeOf(e,t)}(PaintingPlayerAnimation,H),function PaintingPlayerAnimation_createClass(e,t,n){return t&&PaintingPlayerAnimation_defineProperties(e.prototype,t),n&&PaintingPlayerAnimation_defineProperties(e,n),e}(PaintingPlayerAnimation,[{key:"OnSpineEvent",value:function OnSpineEvent(e,t){switch(t.data.name){case"OnFootstep":switch(this.player.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","painting_player_one_footstep_0"+Phaser.Math.RND.integerInRange(1,6));break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","painting_player_two_footstep_0"+Phaser.Math.RND.integerInRange(1,6))}}}},{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id+"_topdown","painting_idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){PaintingPlayerAnimation_get(PaintingPlayerAnimation_getPrototypeOf(PaintingPlayerAnimation.prototype),"SetState",this).call(this,e)}},{key:"update",value:function update(e,t){PaintingPlayerAnimation_get(PaintingPlayerAnimation_getPrototypeOf(PaintingPlayerAnimation.prototype),"update",this).call(this,e,t)}},{key:"destroy",value:function destroy(){PaintingPlayerAnimation_get(PaintingPlayerAnimation_getPrototypeOf(PaintingPlayerAnimation.prototype),"destroy",this).call(this)}}]),PaintingPlayerAnimation}();function PaintingPlayer_typeof(e){return(PaintingPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PaintingPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PaintingPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PaintingPlayer_get(e,t,n){return(PaintingPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function PaintingPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PaintingPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PaintingPlayer_getPrototypeOf(e){return(PaintingPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PaintingPlayer_setPrototypeOf(e,t){return(PaintingPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function PaintingPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(pe,"State",Object.freeze({Idle:{animationName:"painting_idle",loop:!0},Walk:{animationName:"painting_walk",loop:!0},Win:{animationName:"painting_success",loop:!1},Lose:{animationName:"painting_fail",loop:!1}}));var he=function(){function PaintingPlayer(e,t){var n;switch(function PaintingPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaintingPlayer),(n=function PaintingPlayer_possibleConstructorReturn(e,t){return!t||"object"!==PaintingPlayer_typeof(t)&&"function"!=typeof t?PaintingPlayer_assertThisInitialized(e):t}(this,PaintingPlayer_getPrototypeOf(PaintingPlayer).call(this,e,t))).paintImage=null,n.frame=0,1<n.scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO){case!0:n.paintImage=n.scene.textures.get("painting_paintbrush_1_"+n.scene.paintColourType).getSourceImage(),n.setPosition(.5*n.scene.scale.width+200*n.scene.gameScale,.5*n.scene.scale.height),n.frame=0;break;case!1:n.paintImage=n.scene.textures.get("painting_paintbrush_2_"+n.scene.paintColourType).getSourceImage(),n.setPosition(.5*n.scene.scale.width-200*n.scene.gameScale,.5*n.scene.scale.height),n.frame=1}return n.playerForceAmount=.12,n.force=new Phaser.Math.Vector2,n.dragSpeed=15*n.scene.gameScale,n.paintOffset=new Phaser.Math.Vector2(0,-50*n.scene.gameScale),n.bodyGraphics=n.scene.make.graphics(),n.bodyGraphics.generateTexture("paintingPlayerBodyGraphics",75*n.scene.gameScale,75*n.scene.gameScale),n.body=n.scene.matter.add.image(n.x,n.y+n.paintOffset.y,"paintingPlayerBodyGraphics"),n.body.setIgnoreGravity(!0),n.body.setFixedRotation(),n.body.setMass(1/n.scene.gameScale*10),n.body.setCollisionCategory(n.scene.playerCollisionCategory),n.body.setCollidesWith(0),n.body.setFriction(0,.5),n.body.gameObject=PaintingPlayer_assertThisInitialized(n),n.add(n.body),n.movedThisFrame=!1,n.animation.SetState(pe.State.Idle),n}return function PaintingPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PaintingPlayer_setPrototypeOf(e,t)}(PaintingPlayer,L),function PaintingPlayer_createClass(e,t,n){return t&&PaintingPlayer_defineProperties(e.prototype,t),n&&PaintingPlayer_defineProperties(e,n),e}(PaintingPlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new pe(this.scene,this)}},{key:"CreateInput",value:function CreateInput(){return new ce(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new ue(this.scene,this)}},{key:"update",value:function update(e,t){var n=this.movedThisFrame;this.movedThisFrame=!1,PaintingPlayer_get(PaintingPlayer_getPrototypeOf(PaintingPlayer.prototype),"update",this).call(this,e,t),this.x=this.body.body.position.x,this.y=this.body.body.position.y-this.paintOffset.y,0==this.frame&&(.1<Math.abs(this.body.body.velocity.x)||.1<Math.abs(this.body.body.velocity.y))&&this.Paint(),this.frame++,1<this.frame&&(this.frame=0),this.movedThisFrame!=n&&(this.movedThisFrame?this.animation.SetState(pe.State.Walk):this.animation.SetState(pe.State.Idle))}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){PaintingPlayer_get(PaintingPlayer_getPrototypeOf(PaintingPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&(0==this.playerInput.moveVector.x&&0==this.playerInput.moveVector.y||(this.force.set(this.playerInput.moveVector.x,this.playerInput.moveVector.y),this.force.scale(this.dragSpeed),this.body.setVelocity(this.force.x*t*.001*60,this.force.y*t*.001*60),this.movedThisFrame=!0),0==this.playerInput.touchDirection.x&&0==this.playerInput.touchDirection.y||this.playerInput.touchDistance>this.dragSpeed&&(this.force.set(this.playerInput.touchDirection.x,this.playerInput.touchDirection.y),this.force.normalize(),this.force.scale(this.dragSpeed),this.movedThisFrame=!0,this.body.setVelocity(this.force.x*t*.001*60,this.force.y*t*.001*60)))}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){PaintingPlayer_get(PaintingPlayer_getPrototypeOf(PaintingPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state==F.State.Game&&(0==this.playerAI.moveVector.x&&0==this.playerAI.moveVector.y||(this.force.set(this.playerAI.moveVector.x,this.playerAI.moveVector.y),this.body.setVelocity(this.force.x*t*.001*60,this.force.y*t*.001*60),this.movedThisFrame=!0))}},{key:"OnEnterGameState",value:function OnEnterGameState(){this.body.setCollidesWith(1),this.Paint()}},{key:"Paint",value:function Paint(){this.scene.Paint(this.x,this.y+this.paintOffset.y,this.paintImage)}},{key:"OnMinigameWon",value:function OnMinigameWon(){PaintingPlayer_get(PaintingPlayer_getPrototypeOf(PaintingPlayer.prototype),"OnMinigameWon",this).call(this),this.animation.SetState(pe.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){PaintingPlayer_get(PaintingPlayer_getPrototypeOf(PaintingPlayer.prototype),"OnMinigameLost",this).call(this),this.animation.SetState(pe.State.Lose)}},{key:"destroy",value:function destroy(){PaintingPlayer_get(PaintingPlayer_getPrototypeOf(PaintingPlayer.prototype),"destroy",this).call(this)}}]),PaintingPlayer}();function PaintingUI_typeof(e){return(PaintingUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PaintingUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PaintingUI_possibleConstructorReturn(e,t){return!t||"object"!==PaintingUI_typeof(t)&&"function"!=typeof t?function PaintingUI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function PaintingUI_getPrototypeOf(e){return(PaintingUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PaintingUI_setPrototypeOf(e,t){return(PaintingUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ye=function(){function PaintingUI(e){var t;return function PaintingUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaintingUI),(t=PaintingUI_possibleConstructorReturn(this,PaintingUI_getPrototypeOf(PaintingUI).call(this,e))).isSinglePlayer=1==t.scene.playerCount,t.gameTimerText=t.scene.add.text(0,.46*-t.scene.scale.height,"00:00",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*t.scene.gameScale+"px",color:"#FFFFFF"}),t.gameTimerText.setOrigin(.5),t.add(t.gameTimerText),t.progressPlayerLeft=t.scene.add.sprite(0,.435*t.scene.scale.height,"painting_minigame_atlas","progress_fill_1_"+t.scene.paintColourType+".png"),t.progressPlayerLeft.setCrop(0,0,1,t.progressPlayerLeft.height),t.add(t.progressPlayerLeft),t.progressPlayerRight=t.scene.add.sprite(0,.435*t.scene.scale.height,"painting_minigame_atlas","progress_fill_2_"+t.scene.paintColourType+".png"),t.progressPlayerRight.setCrop(0,0,1,t.progressPlayerRight.height),t.add(t.progressPlayerRight),t.barOverlay=t.scene.add.sprite(0,.435*t.scene.scale.height,"painting_minigame_atlas","progress_overlay.png"),t.add(t.barOverlay),t.barPlayerLeftHead=t.scene.add.sprite(.5*t.barOverlay.width,t.barOverlay.y,"painting_minigame_atlas","icon_"+(t.isSinglePlayer?t.scene.players[1].characterData.id:t.scene.players[0].characterData.id)+".png"),t.add(t.barPlayerLeftHead),t.barPlayerRightHead=t.scene.add.sprite(.5*-t.barOverlay.width,t.barOverlay.y,"painting_minigame_atlas","icon_"+(t.isSinglePlayer?t.scene.players[0].characterData.id:t.scene.players[1].characterData.id)+".png"),t.add(t.barPlayerRightHead),t.currentSeconds=0,t.currentWinningPlayerIndex=-1,t}return function PaintingUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PaintingUI_setPrototypeOf(e,t)}(PaintingUI,k),function PaintingUI_createClass(e,t,n){return t&&PaintingUI_defineProperties(e.prototype,t),n&&PaintingUI_defineProperties(e,n),e}(PaintingUI,[{key:"SetFilledBarValues",value:function SetFilledBarValues(e,t,n){var r=n<t?0:1;this.currentWinningPlayerIndex!=r&&(this.currentWinningPlayerIndex=r,this.winningProgressFlashTween&&this.winningProgressFlashTween.stop(),this.progressPlayerLeft.alpha=1,this.progressPlayerRight.alpha=1,this.winningProgressFlashTween=this.scene.tweens.add({targets:0==this.currentWinningPlayerIndex?this.progressPlayerLeft:this.progressPlayerRight,alpha:.5,duration:200,ease:"Linear",yoyo:!0,loop:-1}));this.barPlayerLeftHead.x=.5*this.barOverlay.width-this.barOverlay.width*t*.9,this.barPlayerRightHead.x=-.5*this.barOverlay.width+this.barOverlay.width*n*.9,this.progressPlayerLeft.setCrop(this.progressPlayerLeft.width-.9*t*this.progressPlayerLeft.width,0,this.progressPlayerLeft.width,this.progressPlayerLeft.height),this.progressPlayerRight.setCrop(0,0,.9*n*this.progressPlayerRight.width,this.progressPlayerRight.height)}},{key:"SetGameTimerText",value:function SetGameTimerText(e){e=Math.max(0,e);var t=Math.round(Math.floor(e/60)),n=Math.round(e-60*t);if(this.currentSeconds!=n){this.currentSeconds=n;var r=("0"+t).slice(-2)+":"+("0"+n).slice(-2);this.gameTimerText.setText(r)}}}]),PaintingUI}();function PaintingSensor_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fe=function(){function PaintingSensor(e,t,n){!function PaintingSensor_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaintingSensor),this.scene=e,this.x=t,this.y=n,this.lastTaggedPlayer=null}return function PaintingSensor_createClass(e,t,n){return t&&PaintingSensor_defineProperties(e.prototype,t),n&&PaintingSensor_defineProperties(e,n),e}(PaintingSensor,[{key:"update",value:function update(){for(var e=2500*this.scene.gameScale,t=null,n=0;n<this.scene.players.length;n++){var r=Phaser.Math.Distance.Squared(this.scene.players[n].x,this.scene.players[n].y,this.x,this.y);r<e&&(e=r,t=this.scene.players[n])}t&&this.lastTaggedPlayer!=t&&(this.lastTaggedPlayer=t,this.scene.OnSensorTagged())}}]),PaintingSensor}();function PaintingBackground_typeof(e){return(PaintingBackground_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PaintingBackground_possibleConstructorReturn(e,t){return!t||"object"!==PaintingBackground_typeof(t)&&"function"!=typeof t?function PaintingBackground_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function PaintingBackground_getPrototypeOf(e){return(PaintingBackground_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PaintingBackground_setPrototypeOf(e,t){return(PaintingBackground_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var de=function(){function PaintingBackground(e){var t;return function PaintingBackground_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaintingBackground),(t=PaintingBackground_possibleConstructorReturn(this,PaintingBackground_getPrototypeOf(PaintingBackground).call(this,e))).backgroundSprite=t.scene.add.sprite(.5*t.scene.scale.width,.5*t.scene.scale.height,"painting_background"),t.add(t.backgroundSprite),t}return function PaintingBackground_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PaintingBackground_setPrototypeOf(e,t)}(PaintingBackground,Phaser.GameObjects.Container),PaintingBackground}();function PaintingTutorialPopup_typeof(e){return(PaintingTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PaintingTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==PaintingTutorialPopup_typeof(t)&&"function"!=typeof t?function PaintingTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function PaintingTutorialPopup_getPrototypeOf(e){return(PaintingTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PaintingTutorialPopup_setPrototypeOf(e,t){return(PaintingTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ge=function(){function PaintingTutorialPopup(e){var t;return function PaintingTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaintingTutorialPopup),(t=PaintingTutorialPopup_possibleConstructorReturn(this,PaintingTutorialPopup_getPrototypeOf(PaintingTutorialPopup).call(this,e))).panel.setTexture("painting_minigame_atlas","how_to_painting.png"),t}return function PaintingTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PaintingTutorialPopup_setPrototypeOf(e,t)}(PaintingTutorialPopup,R),PaintingTutorialPopup}();function PaintingAITarget_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var me=function(){function PaintingAITarget(e,t,n){!function PaintingAITarget_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaintingAITarget),this.scene=e,this.x=t,this.y=n,this.lastTaggedPlayer=null,this.currentlyTouchingPlayer=!1,this.touchingPlayerCount=0}return function PaintingAITarget_createClass(e,t,n){return t&&PaintingAITarget_defineProperties(e.prototype,t),n&&PaintingAITarget_defineProperties(e,n),e}(PaintingAITarget,[{key:"update",value:function update(){for(var e=3500*this.scene.gameScale,t=null,n=0;n<this.scene.players.length;n++){var r=Phaser.Math.Distance.Squared(this.scene.players[n].x,this.scene.players[n].y,this.x,this.y);r<e&&(e=r,t=this.scene.players[n])}t&&this.lastTaggedPlayer!=t&&(this.lastTaggedPlayer=t,this.scene.OnSensorTagged())}}]),PaintingAITarget}();function PaintingMinigame_typeof(e){return(PaintingMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PaintingMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PaintingMinigame_possibleConstructorReturn(e,t){return!t||"object"!==PaintingMinigame_typeof(t)&&"function"!=typeof t?function PaintingMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function PaintingMinigame_get(e,t,n){return(PaintingMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function PaintingMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PaintingMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PaintingMinigame_getPrototypeOf(e){return(PaintingMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PaintingMinigame_setPrototypeOf(e,t){return(PaintingMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var _e=function(){function PaintingMinigame(){return function PaintingMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PaintingMinigame),PaintingMinigame_possibleConstructorReturn(this,PaintingMinigame_getPrototypeOf(PaintingMinigame).call(this,"PaintingMinigame"))}return function PaintingMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PaintingMinigame_setPrototypeOf(e,t)}(PaintingMinigame,F),function PaintingMinigame_createClass(e,t,n){return t&&PaintingMinigame_defineProperties(e.prototype,t),n&&PaintingMinigame_defineProperties(e,n),e}(PaintingMinigame,[{key:"create",value:function create(){PaintingMinigame_get(PaintingMinigame_getPrototypeOf(PaintingMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["painting_start","painting_player_one_footstep_01","painting_player_one_footstep_02","painting_player_one_footstep_03","painting_player_one_footstep_04","painting_player_one_footstep_05","painting_player_one_footstep_06","painting_player_two_footstep_01","painting_player_two_footstep_02","painting_player_two_footstep_03","painting_player_two_footstep_04","painting_player_two_footstep_05","painting_player_two_footstep_06","music_painting"]}),this.gameTimer=45,this.collisionCooldownTimer=0,this.collisionCooldownTime=.5,h.Instance.AddLayer("music_minigame",{audioKeys:["music_painting"]}),h.Instance.Play("music_minigame","music_painting")}},{key:"CreateMinigameUI",value:function CreateMinigameUI(){return new ye(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new ge(this)}},{key:"CreateWorld",value:function CreateWorld(){PaintingMinigame_get(PaintingMinigame_getPrototypeOf(PaintingMinigame.prototype),"CreateWorld",this).call(this),this.matter.world.setBounds(.5*this.scale.width-.5*this.viewport.width,.5*this.scale.height-.4*this.viewport.height,this.viewport.width,.75*this.viewport.height,32,!0,!0,!1,!0),this.playerCollisionCategory=this.matter.world.nextCategory(),this.background=new de(this),this.world.add(this.background),this.paintCanvasScale=.5,this.paintCanvas=this.textures.createCanvas("paint_canvas",this.scale.width*this.paintCanvasScale,this.scale.height*this.paintCanvasScale),this.paintImage=this.add.image(.5*this.scale.width,.5*this.scale.height,"paint_canvas"),this.paintImage.setScale(1/this.paintCanvasScale),this.world.add(this.paintImage),this.depthWorld=this.add.container(),this.world.add(this.depthWorld),this.paintColourType=Phaser.Math.RND.integerInRange(1,3);for(var e=0;e<2;e++){var t=new he(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(t),this.depthWorld.add(t)}this.paintSensors=[],this.paintSensorDistance=new Phaser.Math.Vector2(50*this.gameScale,50*this.gameScale);for(var n=.5*this.paintSensorDistance.x;n<this.scale.width;n+=this.paintSensorDistance.x)for(var r=.1*this.scale.height+.5*this.paintSensorDistance.y;r<.85*this.scale.height;r+=this.paintSensorDistance.y)if(!(n<=.5*this.scale.width-.5*this.viewport.width||n>=.5*this.scale.width+.5*this.viewport.width)){var o=new fe(this,n,r);this.paintSensors.push(o)}this.paintAITargets=[],this.paintTargetDistance=new Phaser.Math.Vector2(75*this.gameScale,75*this.gameScale);for(n=.5*this.paintTargetDistance.x;n<this.scale.width;n+=this.paintTargetDistance.x)for(r=.1*this.scale.height+.5*this.paintTargetDistance.y;r<.85*this.scale.height;r+=this.paintTargetDistance.y)if(!(n<=.5*this.scale.width-.5*this.viewport.width||n>=.5*this.scale.width+.5*this.viewport.width)){var i=new me(this,n,r);this.paintAITargets.push(i)}this.flashSpine=this.add.spine(.5*this.scale.width,.5*this.scale.height,"flash","flash",!1),this.flashSpine.setScale(this.gameScale),this.flashSpine.visible=!1,this.world.add(this.flashSpine),this.matterCollision.addOnCollideStart({objectA:this.players[0].body,objectB:this.players[1].body,callback:this.OnPlayerCollision,context:this})}},{key:"update",value:function update(e,t){PaintingMinigame_get(PaintingMinigame_getPrototypeOf(PaintingMinigame.prototype),"update",this).call(this,e,t);for(var n=0;n<this.paintAITargets.length;n++)this.paintAITargets[n].update(e,t);for(n=0;n<this.paintSensors.length;n++)this.paintSensors[n].update(e,t);this.minigameUI.SetGameTimerText(this.gameTimer),0<this.collisionCooldownTimer&&(this.collisionCooldownTimer-=.001*t),this.depthWorld.sort("y")}},{key:"Paint",value:function Paint(e,t,n){e=e*this.paintCanvasScale-.5*n.width,t=t*this.paintCanvasScale-.5*n.height,this.paintCanvas.context.globalCompositeOperation="source-over",this.paintCanvas.draw(e,t,n)}},{key:"OnSensorTagged",value:function OnSensorTagged(){for(var e,t,n,r=0,o=0,i=0,a=0;a<this.paintSensors.length;a++)this.paintSensors[a].lastTaggedPlayer==this.players[0]?r++:this.paintSensors[a].lastTaggedPlayer==this.players[1]?o++:i++;e=i/this.paintSensors.length,t=r/this.paintSensors.length,n=o/this.paintSensors.length;var s=1==this.playerCount;this.minigameUI.SetFilledBarValues(e,s?n:t,s?t:n)}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=0,t=this.players[0],n=0;n<this.players.length;n++){for(var r=0,o=0;o<this.paintSensors.length;o++)this.paintSensors[o].lastTaggedPlayer==this.players[n]&&r++;e<r&&(e=r,t=this.players[n])}return t}},{key:"OnPlayerCollision",value:function OnPlayerCollision(e){this.collisionCooldownTimer<=0&&Phaser.Math.Distance.Between(0,0,e.bodyA.velocity.x-e.bodyB.velocity.x,e.bodyA.velocity.y-e.bodyB.velocity.y)>4*this.gameScale&&(this.flashSpine.visible=!0,this.flashSpine.setPosition(e.pair.collision.supports[0].x,e.pair.collision.supports[0].y),this.flashSpine.setScale(.5),this.flashSpine.setAnimation(0,"flash",!1),this.collisionCooldownTimer=this.collisionCooldownTime)}},{key:"OnEnterGameState",value:function OnEnterGameState(){h.Instance.Play("sfx_minigame","painting_start");for(var e=0;e<this.players.length;e++)this.players[e].OnEnterGameState()}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){PaintingMinigame_get(PaintingMinigame_getPrototypeOf(PaintingMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"EndGame",value:function EndGame(){PaintingMinigame_get(PaintingMinigame_getPrototypeOf(PaintingMinigame.prototype),"EndGame",this).call(this)}},{key:"Destroy",value:function Destroy(){PaintingMinigame_get(PaintingMinigame_getPrototypeOf(PaintingMinigame.prototype),"Destroy",this).call(this),this.textures.removeKey("paint_canvas")}}]),PaintingMinigame}();function SumoPlayerAI_typeof(e){return(SumoPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SumoPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SumoPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==SumoPlayerAI_typeof(t)&&"function"!=typeof t?function SumoPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SumoPlayerAI_get(e,t,n){return(SumoPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SumoPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SumoPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SumoPlayerAI_getPrototypeOf(e){return(SumoPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SumoPlayerAI_setPrototypeOf(e,t){return(SumoPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Pe=function(){function SumoPlayerAI(e,t){var n;switch(function SumoPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SumoPlayerAI),(n=SumoPlayerAI_possibleConstructorReturn(this,SumoPlayerAI_getPrototypeOf(SumoPlayerAI).call(this,e,t))).strategy=SumoPlayerAI.Strategy.ATTACK,n.minAngleRange=5,n.maxAngleRange=35,n.targetAngleOffset=Phaser.Math.RND.realInRange(n.minAngleRange,n.maxAngleRange),n.forceDirection=new Phaser.Math.Vector2,n.difficulty){case A.Difficulty.EASY:n.minAngleRange=10,n.maxAngleRange=45;break;case A.Difficulty.MEDIUM:n.minAngleRange=5,n.maxAngleRange=35;break;case A.Difficulty.HARD:n.minAngleRange=0,n.maxAngleRange=25}return n}return function SumoPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SumoPlayerAI_setPrototypeOf(e,t)}(SumoPlayerAI,A),function SumoPlayerAI_createClass(e,t,n){return t&&SumoPlayerAI_defineProperties(e.prototype,t),n&&SumoPlayerAI_defineProperties(e,n),e}(SumoPlayerAI,[{key:"update",value:function update(e,t){switch(SumoPlayerAI_get(SumoPlayerAI_getPrototypeOf(SumoPlayerAI.prototype),"update",this).call(this,e,t),this.scene.playerClosestToLosing==this.player?this.strategy=SumoPlayerAI.Strategy.DEFEND:this.strategy=SumoPlayerAI.Strategy.ATTACK,this.strategy){case SumoPlayerAI.Strategy.ATTACK:this.UpdateAttackStrategy(e,t);break;case SumoPlayerAI.Strategy.DEFEND:this.UpdateDefenseStrategy(e,t)}}},{key:"UpdateAttackStrategy",value:function UpdateAttackStrategy(){var e=this.player.enemyPlayer.x-this.player.x,t=this.player.enemyPlayer.y-this.player.y;this.CheckToThrust(e,t)}},{key:"UpdateDefenseStrategy",value:function UpdateDefenseStrategy(){var e=.5*this.scene.scale.width-this.player.x,t=.5*this.scene.scale.height-this.player.y;this.CheckToThrust(e,t)}},{key:"CheckToThrust",value:function CheckToThrust(e,t){var n=180*Math.atan2(e,-t)/Math.PI,r=I.GetAngleDifference(this.player.aimAngle,n);if(Math.abs(r-this.targetAngleOffset)<5*this.scene.gameScale){var o=Phaser.Math.DegToRad(this.player.aimAngle-90);this.forceDirection.set(Math.cos(o),Math.sin(o)),this.emit("thrust"),this.targetAngleOffset=Phaser.Math.RND.realInRange(this.minAngleRange,this.maxAngleRange),this.targetAngleOffset*=Phaser.Math.RND.pick([-1,1])}}}]),SumoPlayerAI}();function MinigamePlayerButtonInput_typeof(e){return(MinigamePlayerButtonInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MinigamePlayerButtonInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MinigamePlayerButtonInput_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MinigamePlayerButtonInput_get(e,t,n){return(MinigamePlayerButtonInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function MinigamePlayerButtonInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MinigamePlayerButtonInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MinigamePlayerButtonInput_getPrototypeOf(e){return(MinigamePlayerButtonInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MinigamePlayerButtonInput_setPrototypeOf(e,t){return(MinigamePlayerButtonInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function SumoPlayerAI_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Pe,"Strategy",Object.freeze({ATTACK:0,DEFEND:1}));var be=function(){function MinigamePlayerButtonInput(e,t){var n;if(function MinigamePlayerButtonInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MinigamePlayerButtonInput),!(n=function MinigamePlayerButtonInput_possibleConstructorReturn(e,t){return!t||"object"!==MinigamePlayerButtonInput_typeof(t)&&"function"!=typeof t?MinigamePlayerButtonInput_assertThisInitialized(e):t}(this,MinigamePlayerButtonInput_getPrototypeOf(MinigamePlayerButtonInput).call(this,e,t))).scene.deviceManager.desktop){n.buttonContainer=n.scene.add.container(0,n.scene.scale.height-150*n.scene.gameScale);var r=1<n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.TWO;n.buttonContainer.x=r?.5*n.scene.scale.width+.5*n.scene.viewport.width-150*n.scene.gameScale:.5*n.scene.scale.width-.5*n.scene.viewport.width+150*n.scene.gameScale,n.scene.ui.add(n.buttonContainer),n.button=new g(n.scene,n.buttonContainer,{frames:["button_action.png","button_action.png"],spriteWidth:128*n.scene.gameScale,spriteHeight:128*n.scene.gameScale,buttonWidth:128*n.scene.gameScale,buttonHeight:128*n.scene.gameScale,atlas:"ui_atlas",id:"domui_MENU_play",domClass:"dom_button play",title:"Play",onDown:n.OnButtonPressed,onDownContext:MinigamePlayerButtonInput_assertThisInitialized(n)})}return n}return function MinigamePlayerButtonInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MinigamePlayerButtonInput_setPrototypeOf(e,t)}(MinigamePlayerButtonInput,x),function MinigamePlayerButtonInput_createClass(e,t,n){return t&&MinigamePlayerButtonInput_defineProperties(e.prototype,t),n&&MinigamePlayerButtonInput_defineProperties(e,n),e}(MinigamePlayerButtonInput,[{key:"update",value:function update(e,t){MinigamePlayerButtonInput_get(MinigamePlayerButtonInput_getPrototypeOf(MinigamePlayerButtonInput.prototype),"update",this).call(this,e,t)}},{key:"OnButtonPressed",value:function OnButtonPressed(){this.emit("ondown")}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){MinigamePlayerButtonInput_get(MinigamePlayerButtonInput_getPrototypeOf(MinigamePlayerButtonInput.prototype),"OnEnterPreGameState",this).call(this),this.buttonContainer&&this.button.Enable()}},{key:"OnMinigameComplete",value:function OnMinigameComplete(){MinigamePlayerButtonInput_get(MinigamePlayerButtonInput_getPrototypeOf(MinigamePlayerButtonInput.prototype),"OnMinigameComplete",this).call(this),this.buttonContainer&&(this.buttonContainer.visible=!1,this.button.Disable())}}]),MinigamePlayerButtonInput}();function SumoPlayerInput_typeof(e){return(SumoPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SumoPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SumoPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==SumoPlayerInput_typeof(t)&&"function"!=typeof t?function SumoPlayerInput_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SumoPlayerInput_get(e,t,n){return(SumoPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SumoPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SumoPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SumoPlayerInput_getPrototypeOf(e){return(SumoPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SumoPlayerInput_setPrototypeOf(e,t){return(SumoPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Se=function(){function SumoPlayerInput(e,t){return function SumoPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SumoPlayerInput),SumoPlayerInput_possibleConstructorReturn(this,SumoPlayerInput_getPrototypeOf(SumoPlayerInput).call(this,e,t))}return function SumoPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SumoPlayerInput_setPrototypeOf(e,t)}(SumoPlayerInput,be),function SumoPlayerInput_createClass(e,t,n){return t&&SumoPlayerInput_defineProperties(e.prototype,t),n&&SumoPlayerInput_defineProperties(e,n),e}(SumoPlayerInput,[{key:"update",value:function update(e,t){SumoPlayerInput_get(SumoPlayerInput_getPrototypeOf(SumoPlayerInput.prototype),"update",this).call(this,e,t)}},{key:"OnButtonPressed",value:function OnButtonPressed(){SumoPlayerInput_get(SumoPlayerInput_getPrototypeOf(SumoPlayerInput.prototype),"OnButtonPressed",this).call(this),this.player.Thrust()}}]),SumoPlayerInput}();function SumoPlayerAnimation_typeof(e){return(SumoPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SumoPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SumoPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==SumoPlayerAnimation_typeof(t)&&"function"!=typeof t?function SumoPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SumoPlayerAnimation_get(e,t,n){return(SumoPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SumoPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SumoPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SumoPlayerAnimation_getPrototypeOf(e){return(SumoPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SumoPlayerAnimation_setPrototypeOf(e,t){return(SumoPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Oe=function(){function SumoPlayerAnimation(e,t){return function SumoPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SumoPlayerAnimation),SumoPlayerAnimation_possibleConstructorReturn(this,SumoPlayerAnimation_getPrototypeOf(SumoPlayerAnimation).call(this,e,t))}return function SumoPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SumoPlayerAnimation_setPrototypeOf(e,t)}(SumoPlayerAnimation,H),function SumoPlayerAnimation_createClass(e,t,n){return t&&SumoPlayerAnimation_defineProperties(e.prototype,t),n&&SumoPlayerAnimation_defineProperties(e,n),e}(SumoPlayerAnimation,[{key:"SetState",value:function SetState(e){SumoPlayerAnimation_get(SumoPlayerAnimation_getPrototypeOf(SumoPlayerAnimation.prototype),"SetState",this).call(this,e),e==SumoPlayerAnimation.State.React?this.spine.on("spine.complete",this.OnReactAnimationComplete,this):this.spine.off("spine.complete",this.OnReactAnimationComplete,this)}},{key:"update",value:function update(e,t){switch(SumoPlayerAnimation_get(SumoPlayerAnimation_getPrototypeOf(SumoPlayerAnimation.prototype),"update",this).call(this,e,t),this.state){case SumoPlayerAnimation.State.Idle:this.UpdateIdleState();break;case SumoPlayerAnimation.State.Surge:this.UpdateSurgeState()}}},{key:"UpdateIdleState",value:function UpdateIdleState(){this.SetFlipX(this.player.enemyPlayer.x<this.player.x)}},{key:"UpdateSurgeState",value:function UpdateSurgeState(){.5<this.timeInState&&this.player.velocityMagnitude<.5&&this.SetState(SumoPlayerAnimation.State.Idle)}},{key:"OnReactAnimationComplete",value:function OnReactAnimationComplete(){this.SetState(SumoPlayerAnimation.State.Idle)}},{key:"destroy",value:function destroy(){SumoPlayerAnimation_get(SumoPlayerAnimation_getPrototypeOf(SumoPlayerAnimation.prototype),"destroy",this).call(this)}}]),SumoPlayerAnimation}();function SumoDust_typeof(e){return(SumoDust_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SumoDust_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SumoDust_possibleConstructorReturn(e,t){return!t||"object"!==SumoDust_typeof(t)&&"function"!=typeof t?function SumoDust_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SumoDust_getPrototypeOf(e){return(SumoDust_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SumoDust_setPrototypeOf(e,t){return(SumoDust_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function SumoPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Oe,"State",Object.freeze({Idle:{animationName:"sumo_idle",loop:!0},Surge:{animationName:"sumo_surge",loop:!0},React:{animationName:"sumo_react",loop:!1},Win:{animationName:"sumo_success",loop:!1},Lose:{animationName:"sumo_fail",loop:!1}}));var ve=function(){function SumoDust(e){var t;return function SumoDust_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SumoDust),(t=SumoDust_possibleConstructorReturn(this,SumoDust_getPrototypeOf(SumoDust).call(this,e,0,0,"sumo_minigame_atlas","dust.png"))).setOrigin(.5,.5),t}return function SumoDust_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SumoDust_setPrototypeOf(e,t)}(SumoDust,Phaser.GameObjects.Sprite),function SumoDust_createClass(e,t,n){return t&&SumoDust_defineProperties(e.prototype,t),n&&SumoDust_defineProperties(e,n),e}(SumoDust,[{key:"Spawn",value:function Spawn(e,t){this.setPosition(e,t-30*this.scene.gameScale),this.visible=!0,this.setScale(1),this.scene.tweens.add({targets:this,scaleX:0,scaleY:0,duration:500,ease:"Linear",onComplete:this.OnShowTweenComplete,onCompleteScope:this})}},{key:"OnShowTweenComplete",value:function OnShowTweenComplete(){this.visible=!1}}]),SumoDust}();function SumoPlayer_typeof(e){return(SumoPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SumoPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SumoPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SumoPlayer_get(e,t,n){return(SumoPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SumoPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SumoPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SumoPlayer_getPrototypeOf(e){return(SumoPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SumoPlayer_setPrototypeOf(e,t){return(SumoPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var we=function(){function SumoPlayer(e,t){var n;switch(function SumoPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SumoPlayer),(n=function SumoPlayer_possibleConstructorReturn(e,t){return!t||"object"!==SumoPlayer_typeof(t)&&"function"!=typeof t?SumoPlayer_assertThisInitialized(e):t}(this,SumoPlayer_getPrototypeOf(SumoPlayer).call(this,e,t))).enemyPlayer=null,n.playerAI&&n.playerAI.on("thrust",n.Thrust,SumoPlayer_assertThisInitialized(n)),n.aimArrowSprite=n.scene.add.image(0,15*n.scene.gameScale,"sumo_rotator_atlas","rotator_animation_8.png"),n.aimArrowSprite.setOrigin(.5,.5),n.aimArrowSprite.visible=!1,n.add(n.aimArrowSprite),n.aimAngle=90,n.animation.y+=25*n.scene.gameScale,n.bringToTop(n.animation),1<n.scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO){case!0:n.setPosition(.5*n.scene.scale.width+200*n.scene.gameScale,.5*n.scene.scale.height+20*n.scene.gameScale),n.animation.SetFlipX(!0);break;case!1:n.setPosition(.5*n.scene.scale.width-200*n.scene.gameScale,.5*n.scene.scale.height+20*n.scene.gameScale),n.aimAngle=270}var r=n.scene.cache.json.get("physics_shapes");return n.body=n.scene.matter.add.image(n.x,n.y,void 0,void 0,{shape:r.sumo_player_body}),n.body.setBounce(1),n.body.setIgnoreGravity(!0),n.body.setFixedRotation(),n.body.setMass(1/n.scene.gameScale*10),n.body.setFriction(0,1/n.scene.gameScale*.12),n.body.setScale(n.scene.gameScale),n.body.gameObject=SumoPlayer_assertThisInitialized(n),n.add(n.body),n.dust=[],n.shapesInArena=0,n.forceDirection=new Phaser.Math.Vector2,n.forceStrength=.75*n.scene.gameScale,n.forceVector=new Phaser.Math.Vector2,n.thrustCooldownTimer=0,n.thrustCooldownTime=1,n.turnSpeed=270,n.velocityMagnitude=0,n.lastThrustTime=0,n.distanceBetweenDust=50*n.scene.gameScale,n.distanceSinceLastDust=10*n.scene.gameScale,n.UpdateAimArrowSprite(),n.animation.SetState(Oe.State.Idle),n.ShowAimArrowSprite(),n}return function SumoPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SumoPlayer_setPrototypeOf(e,t)}(SumoPlayer,L),function SumoPlayer_createClass(e,t,n){return t&&SumoPlayer_defineProperties(e.prototype,t),n&&SumoPlayer_defineProperties(e,n),e}(SumoPlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new Oe(this.scene,this)}},{key:"CreateInput",value:function CreateInput(){return new Se(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new Pe(this.scene,this)}},{key:"update",value:function update(e,t){SumoPlayer_get(SumoPlayer_getPrototypeOf(SumoPlayer.prototype),"update",this).call(this,e,t);var n=this.body.body.position.x,r=this.body.body.position.y-this.aimArrowSprite.y,o=Phaser.Math.Distance.Between(this.x,this.y,n,r);this.x=n,this.y=r,this.body.angle=0,this.aimArrowSprite.visible&&(this.aimAngle+=this.turnSpeed*t*.001,this.UpdateAimArrowSprite()),this.scene.state==F.State.Game&&(this.velocityMagnitude=Phaser.Math.Distance.Between(0,0,this.body.body.velocity.x,this.body.body.velocity.y),this.aimArrowSprite.visible&&.5<this.velocityMagnitude?this.aimArrowSprite.visible=!1:this.thrustCooldownTimer<=0&&!this.aimArrowSprite.visible&&this.velocityMagnitude<=.1&&this.ShowAimArrowSprite(),0<this.thrustCooldownTimer&&(this.thrustCooldownTimer-=.001*t,this.thrustCooldownTimer<=0&&this.ShowAimArrowSprite()),this.distanceSinceLastDust+=o,this.distanceSinceLastDust>=this.distanceBetweenDust&&(this.distanceSinceLastDust=0,this.SpawnDust()))}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){SumoPlayer_get(SumoPlayer_getPrototypeOf(SumoPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&(0==this.playerInput.moveVector.x&&0==this.playerInput.moveVector.y||this.Thrust())}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){SumoPlayer_get(SumoPlayer_getPrototypeOf(SumoPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state,F.State.Game}},{key:"UpdateAimArrowSprite",value:function UpdateAimArrowSprite(){var e=this.aimAngle%360/360,t=Math.ceil(34*e);this.aimArrowSprite.setFrame("rotator_animation_"+t+".png")}},{key:"Thrust",value:function Thrust(){if(this.scene.state==F.State.Game&&this.aimArrowSprite.visible&&1==this.aimArrowSprite.alpha){var e=Phaser.Math.DegToRad(this.aimAngle-90);this.forceDirection.set(Math.cos(e),Math.sin(e)),this.aimArrowSprite.visible=!1,this.aimAngle+=180,this.UpdateAimArrowSprite(),this.forceVector.set(this.forceDirection.x*this.forceStrength,this.forceDirection.y*this.forceStrength),this.body.applyForce(this.forceVector),this.animation.SetFlipX(this.enemyPlayer.x<this.x),this.thrustCooldownTimer=this.thrustCooldownTime,this.lastThrustTime=this.scene.time.now,this.distanceSinceLastDust=0,this.animation.SetState(Oe.State.Surge),h.Instance.Play("sfx_minigame","sumo_attack_"+this.characterData.id)}}},{key:"FlashAimArrow",value:function FlashAimArrow(){this.scene.tweens.add({targets:this.aimArrowSprite,alpha:.25,duration:200,ease:"Linear",repeat:3,yoyo:!0})}},{key:"SpawnDust",value:function SpawnDust(){for(var e=null,t=0;t<this.dust.length;t++)if(!this.dust[t].visible){e=this.dust[t];break}e||(e=new ve(this.scene),this.scene.depthWorld.add(e),this.dust.push(e)),e.Spawn(this.x,this.y)}},{key:"ShowAimArrowSprite",value:function ShowAimArrowSprite(){this.aimArrowSprite.visible||(this.aimArrowSprite.visible=!0,this.aimArrowSprite.alpha=0,this.scene.tweens.add({targets:this.aimArrowSprite,alpha:1,duration:200,ease:"Linear"}))}},{key:"OnShoved",value:function OnShoved(){this.distanceSinceLastDust=0,this.body.setVelocity(1.5*this.body.body.velocity.x,1.5*this.body.body.velocity.y),this.animation.SetState(Oe.State.React),h.Instance.Play("sfx_minigame","sumo_attack_hit")}},{key:"OnShapeEnterArena",value:function OnShapeEnterArena(){this.shapesInArena++}},{key:"OnShapeExitArena",value:function OnShapeExitArena(){this.shapesInArena--,0==this.shapesInArena&&this.scene.OnPlayerExitArena(this)}},{key:"OnGameEnterPostGameState",value:function OnGameEnterPostGameState(e){SumoPlayer_get(SumoPlayer_getPrototypeOf(SumoPlayer.prototype),"OnGameEnterPostGameState",this).call(this,e),this.aimArrowSprite.visible=!1,this.body.setVelocity(0,0)}},{key:"OnMinigameWon",value:function OnMinigameWon(){SumoPlayer_get(SumoPlayer_getPrototypeOf(SumoPlayer.prototype),"OnMinigameWon",this).call(this),this.animation.SetState(Oe.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){SumoPlayer_get(SumoPlayer_getPrototypeOf(SumoPlayer.prototype),"OnMinigameLost",this).call(this),this.animation.SetState(Oe.State.Lose)}},{key:"destroy",value:function destroy(){SumoPlayer_get(SumoPlayer_getPrototypeOf(SumoPlayer.prototype),"destroy",this).call(this)}}]),SumoPlayer}();function SumoArena_typeof(e){return(SumoArena_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SumoArena_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SumoArena_getPrototypeOf(e){return(SumoArena_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SumoArena_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SumoArena_setPrototypeOf(e,t){return(SumoArena_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Te=function(){function SumoArena(e){var t;!function SumoArena_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SumoArena),(t=function SumoArena_possibleConstructorReturn(e,t){return!t||"object"!==SumoArena_typeof(t)&&"function"!=typeof t?SumoArena_assertThisInitialized(e):t}(this,SumoArena_getPrototypeOf(SumoArena).call(this,e))).background=t.scene.add.sprite(.5*t.scene.scale.width,.5*t.scene.scale.height,"sumo_background"),t.add(t.background);var n=t.scene.cache.json.get("physics_shapes");return t.body=t.scene.matter.add.sprite(.5*t.scene.scale.width,.5*t.scene.scale.height,"sumo_background",void 0,{shape:n.sumo_minigame_background}),t.body.setScale(t.scene.gameScale),t.body.alpha=0,t.body.setPosition((-10+t.body.centerOfMass.x)*t.scene.gameScale,(-10+t.body.centerOfMass.y)*t.scene.gameScale),t.body.setFixedRotation(),t.body.setIgnoreGravity(!0),t.body.setSensor(!0),t.body.gameObject=SumoArena_assertThisInitialized(t),t.add(t.body),t}return function SumoArena_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SumoArena_setPrototypeOf(e,t)}(SumoArena,Phaser.GameObjects.Container),function SumoArena_createClass(e,t,n){return t&&SumoArena_defineProperties(e.prototype,t),n&&SumoArena_defineProperties(e,n),e}(SumoArena,[{key:"OnPlayerCollisionEnd",value:function OnPlayerCollisionEnd(){}}]),SumoArena}();function SumoCamera_typeof(e){return(SumoCamera_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SumoCamera_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SumoCamera_possibleConstructorReturn(e,t){return!t||"object"!==SumoCamera_typeof(t)&&"function"!=typeof t?function SumoCamera_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SumoCamera_getPrototypeOf(e){return(SumoCamera_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SumoCamera_setPrototypeOf(e,t){return(SumoCamera_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ce=function(){function SumoCamera(e){var t;return function SumoCamera_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SumoCamera),(t=SumoCamera_possibleConstructorReturn(this,SumoCamera_getPrototypeOf(SumoCamera).call(this,e))).SetLookAt(.5*t.scene.scale.width,.5*t.scene.scale.height),t}return function SumoCamera_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SumoCamera_setPrototypeOf(e,t)}(SumoCamera,j),function SumoCamera_createClass(e,t,n){return t&&SumoCamera_defineProperties(e.prototype,t),n&&SumoCamera_defineProperties(e,n),e}(SumoCamera,[{key:"update",value:function update(){}}]),SumoCamera}();function SumoTutorialPopup_typeof(e){return(SumoTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SumoTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==SumoTutorialPopup_typeof(t)&&"function"!=typeof t?function SumoTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SumoTutorialPopup_getPrototypeOf(e){return(SumoTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SumoTutorialPopup_setPrototypeOf(e,t){return(SumoTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ie=function(){function SumoTutorialPopup(e){var t;!function SumoTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SumoTutorialPopup),(t=SumoTutorialPopup_possibleConstructorReturn(this,SumoTutorialPopup_getPrototypeOf(SumoTutorialPopup).call(this,e))).panel.setTexture("sumo_minigame_atlas","how_to_sumo.png");for(var n=0;n<t.controlSpines.length;n++)t.scene.deviceManager.desktop?t.controlSpines[n].setAnimation(0,"all",!0):t.controlSpines[n].setAnimation(0,"tap",!0);return t}return function SumoTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SumoTutorialPopup_setPrototypeOf(e,t)}(SumoTutorialPopup,R),SumoTutorialPopup}();function SumoMinigame_typeof(e){return(SumoMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SumoMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SumoMinigame_possibleConstructorReturn(e,t){return!t||"object"!==SumoMinigame_typeof(t)&&"function"!=typeof t?function SumoMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SumoMinigame_get(e,t,n){return(SumoMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SumoMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SumoMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SumoMinigame_getPrototypeOf(e){return(SumoMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SumoMinigame_setPrototypeOf(e,t){return(SumoMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ke=function(){function SumoMinigame(){return function SumoMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SumoMinigame),SumoMinigame_possibleConstructorReturn(this,SumoMinigame_getPrototypeOf(SumoMinigame).call(this,"SumoMinigame"))}return function SumoMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SumoMinigame_setPrototypeOf(e,t)}(SumoMinigame,F),function SumoMinigame_createClass(e,t,n){return t&&SumoMinigame_defineProperties(e.prototype,t),n&&SumoMinigame_defineProperties(e,n),e}(SumoMinigame,[{key:"create",value:function create(){SumoMinigame_get(SumoMinigame_getPrototypeOf(SumoMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["sumo_start","sumo_attack_gumball","sumo_attack_darwin","sumo_attack_anais","sumo_attack_tobias","sumo_attack_penny","sumo_attack_carrie","sumo_player_out","sumo_attack_hit"]}),this.playerClosestToLosing=null,this.winingPlayer=null,this.collisionResultVelocity=new Phaser.Math.Vector2,h.Instance.AddLayer("music_minigame",{audioKeys:["music_sumo"]}),h.Instance.Play("music_minigame","music_sumo")}},{key:"CreateMinigameCamera",value:function CreateMinigameCamera(){return new Ce(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new Ie(this)}},{key:"CreateWorld",value:function CreateWorld(){SumoMinigame_get(SumoMinigame_getPrototypeOf(SumoMinigame.prototype),"CreateWorld",this).call(this),this.arena=new Te(this),this.world.add(this.arena),this.depthWorld=this.add.container(),this.world.add(this.depthWorld);for(var e=0;e<2;e++){var t=new we(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(t),this.depthWorld.add(t)}this.players[0].enemyPlayer=this.players[1],this.players[1].enemyPlayer=this.players[0],this.matterCollision.addOnCollideEnd({objectA:this.players[0].body,objectB:this.players[1].body,callback:this.OnPlayerCollisionEnd,context:this}),this.flashSpine=this.add.spine(.5*this.scale.width,.5*this.scale.height,"flash","flash",!1),this.flashSpine.setScale(this.gameScale),this.flashSpine.visible=!1,this.world.add(this.flashSpine);for(e=0;e<this.players.length;e++)this.matterCollision.addOnCollideStart({objectA:this.arena.body,objectB:this.players[e].body,callback:this.players[e].OnShapeEnterArena,context:this.players[e]}),this.matterCollision.addOnCollideEnd({objectA:this.arena.body,objectB:this.players[e].body,callback:this.players[e].OnShapeExitArena,context:this.players[e]})}},{key:"update",value:function update(e,t){SumoMinigame_get(SumoMinigame_getPrototypeOf(SumoMinigame.prototype),"update",this).call(this,e,t),this.playerClosestToLosing=null;for(var n=0,r=0;r<this.players.length;r++){var o=Phaser.Math.Distance.Between(this.players[r].x,this.players[r].y,.5*this.scale.width,.5*this.scale.height);n<o&&(n=o,this.playerClosestToLosing=this.players[r])}this.depthWorld.sort("y")}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){return this.winingPlayer}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){SumoMinigame_get(SumoMinigame_getPrototypeOf(SumoMinigame.prototype),"OnEnterPreGameState",this).call(this);for(var e=0;e<this.players.length;e++)this.players[e].FlashAimArrow()}},{key:"OnEnterGameState",value:function OnEnterGameState(){SumoMinigame_get(SumoMinigame_getPrototypeOf(SumoMinigame.prototype),"OnEnterGameState",this).call(this),h.Instance.Play("sfx_minigame","sumo_start")}},{key:"OnPlayerCollisionEnd",value:function OnPlayerCollisionEnd(e){this.collisionResultVelocity.x=Math.abs(e.gameObjectA.body.velocity.x)>Math.abs(e.gameObjectB.body.velocity.x)?e.gameObjectA.body.velocity.x-e.gameObjectB.body.velocity.x:e.gameObjectB.body.velocity.x-e.gameObjectA.body.velocity.x,this.collisionResultVelocity.y=Math.abs(e.gameObjectA.body.velocity.y)>Math.abs(e.gameObjectB.body.velocity.y)?e.gameObjectA.body.velocity.y-e.gameObjectB.body.velocity.y:e.gameObjectB.body.velocity.y-e.gameObjectA.body.velocity.y;var t=Math.abs(this.collisionResultVelocity.x)+Math.abs(this.collisionResultVelocity.y),n=Math.min(1,t/25),r=Phaser.Math.Linear(15e-5,.00275,n);if(this.minigameCamera.camera.shake(100,r),e.gameObjectA.gameObject.lastThrustTime>e.gameObjectB.gameObject.lastThrustTime?e.gameObjectB.gameObject.OnShoved():e.gameObjectA.gameObject.OnShoved(),.25<n){var o=.5*(e.gameObjectA.x+e.gameObjectB.x),i=.5*(e.gameObjectA.y+e.gameObjectB.y),a=Phaser.Math.Linear(.25,.6,n);this.flashSpine.visible=!0,this.flashSpine.setPosition(o,i),this.flashSpine.setScale(a*this.gameScale),this.flashSpine.setAnimation(0,"flash",!1)}this.collisionResultVelocity.normalize(),this.collisionResultVelocity.scale(6*this.gameScale),this.minigameCamera.SetLookAt(.5*this.scale.width+this.collisionResultVelocity.x,.5*this.scale.height+this.collisionResultVelocity.y),this.minigameCamera.LerpLookAt(.5*this.scale.width,.5*this.scale.height,1e3,"Sine.easeOut")}},{key:"OnPlayerExitArena",value:function OnPlayerExitArena(e){if(!this.winingPlayer&&this.state==F.State.Game){for(var t=0;t<this.players.length;t++)if(this.players[t]!=e){this.winingPlayer=this.players[t];break}h.Instance.Play("sfx_minigame","sumo_player_out"),this.EndGame()}}}]),SumoMinigame}();function CatchPlayerAI_typeof(e){return(CatchPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CatchPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CatchPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==CatchPlayerAI_typeof(t)&&"function"!=typeof t?function CatchPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function CatchPlayerAI_get(e,t,n){return(CatchPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function CatchPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CatchPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CatchPlayerAI_getPrototypeOf(e){return(CatchPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CatchPlayerAI_setPrototypeOf(e,t){return(CatchPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var xe=function(){function CatchPlayerAI(e,t){var n;switch(function CatchPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchPlayerAI),(n=CatchPlayerAI_possibleConstructorReturn(this,CatchPlayerAI_getPrototypeOf(CatchPlayerAI).call(this,e,t))).moveVector=new Phaser.Math.Vector2(0,0),n.speed=250*n.scene.gameScale,n.difficulty){case A.Difficulty.EASY:n.speed=150*n.scene.gameScale;break;case A.Difficulty.MEDIUM:n.speed=200*n.scene.gameScale;break;case A.Difficulty.HARD:n.speed=250*n.scene.gameScale}return n}return function CatchPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CatchPlayerAI_setPrototypeOf(e,t)}(CatchPlayerAI,A),function CatchPlayerAI_createClass(e,t,n){return t&&CatchPlayerAI_defineProperties(e.prototype,t),n&&CatchPlayerAI_defineProperties(e,n),e}(CatchPlayerAI,[{key:"update",value:function update(e,t){CatchPlayerAI_get(CatchPlayerAI_getPrototypeOf(CatchPlayerAI.prototype),"update",this).call(this,e,t),this.moveVector.set(0,0);for(var n=null,r=999999,o=0;o<this.scene.collectableSpawner.collectables.length;o++){var i=this.scene.collectableSpawner.collectables[o];if(i.visible){var a=Phaser.Math.Distance.Between(i.x,i.catchDepth,this.player.x,this.player.catchDepth);a<r&&(n=i,r=a)}}if(n){this.moveVector.set(n.x-this.player.x,n.catchDepth-this.player.catchDepth),this.moveVector.normalize();var s=this.speed*t*.001,l=1;r<s&&(l=r/s),this.moveVector.scale(this.speed*l)}}}]),CatchPlayerAI}();function CatchPlayerInput_typeof(e){return(CatchPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CatchPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CatchPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==CatchPlayerInput_typeof(t)&&"function"!=typeof t?function CatchPlayerInput_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function CatchPlayerInput_get(e,t,n){return(CatchPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function CatchPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CatchPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CatchPlayerInput_getPrototypeOf(e){return(CatchPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CatchPlayerInput_setPrototypeOf(e,t){return(CatchPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ae=function(){function CatchPlayerInput(e,t){var n;return function CatchPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchPlayerInput),(n=CatchPlayerInput_possibleConstructorReturn(this,CatchPlayerInput_getPrototypeOf(CatchPlayerInput).call(this,e,t))).inputRect&&n.inputRect.setOrigin(.5,1),n}return function CatchPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CatchPlayerInput_setPrototypeOf(e,t)}(CatchPlayerInput,ce),function CatchPlayerInput_createClass(e,t,n){return t&&CatchPlayerInput_defineProperties(e.prototype,t),n&&CatchPlayerInput_defineProperties(e,n),e}(CatchPlayerInput,[{key:"update",value:function update(e,t){CatchPlayerInput_get(CatchPlayerInput_getPrototypeOf(CatchPlayerInput.prototype),"update",this).call(this,e,t)}}]),CatchPlayerInput}();function CatchPlayerAnimation_typeof(e){return(CatchPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CatchPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CatchPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==CatchPlayerAnimation_typeof(t)&&"function"!=typeof t?function CatchPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function CatchPlayerAnimation_get(e,t,n){return(CatchPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function CatchPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CatchPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CatchPlayerAnimation_getPrototypeOf(e){return(CatchPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CatchPlayerAnimation_setPrototypeOf(e,t){return(CatchPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Be=function(){function CatchPlayerAnimation(e,t){return function CatchPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchPlayerAnimation),CatchPlayerAnimation_possibleConstructorReturn(this,CatchPlayerAnimation_getPrototypeOf(CatchPlayerAnimation).call(this,e,t))}return function CatchPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CatchPlayerAnimation_setPrototypeOf(e,t)}(CatchPlayerAnimation,H),function CatchPlayerAnimation_createClass(e,t,n){return t&&CatchPlayerAnimation_defineProperties(e.prototype,t),n&&CatchPlayerAnimation_defineProperties(e,n),e}(CatchPlayerAnimation,[{key:"SetState",value:function SetState(e){CatchPlayerAnimation_get(CatchPlayerAnimation_getPrototypeOf(CatchPlayerAnimation.prototype),"SetState",this).call(this,e),e==CatchPlayerAnimation.State.Catch?this.spine.on("spine.complete",this.OnCatchAnimationComplete,this):this.spine.off("spine.complete",this.OnCatchAnimationComplete,this)}},{key:"update",value:function update(e,t){CatchPlayerAnimation_get(CatchPlayerAnimation_getPrototypeOf(CatchPlayerAnimation.prototype),"update",this).call(this,e,t)}},{key:"OnCatchAnimationComplete",value:function OnCatchAnimationComplete(){this.SetState(CatchPlayerAnimation.State.Idle)}},{key:"destroy",value:function destroy(){CatchPlayerAnimation_get(CatchPlayerAnimation_getPrototypeOf(CatchPlayerAnimation.prototype),"destroy",this).call(this)}}]),CatchPlayerAnimation}();function CatchPlayer_typeof(e){return(CatchPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CatchPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CatchPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CatchPlayer_get(e,t,n){return(CatchPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function CatchPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CatchPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CatchPlayer_getPrototypeOf(e){return(CatchPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CatchPlayer_setPrototypeOf(e,t){return(CatchPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function CatchPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Be,"State",Object.freeze({Idle:{animationName:"catching_idle",loop:!0},Catch:{animationName:"catching_catch",loop:!1},Win:{animationName:"catching_success",loop:!1},Lose:{animationName:"catching_fail",loop:!1}}));var Me=function(){function CatchPlayer(e,t){var n;switch(function CatchPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchPlayer),1<(n=function CatchPlayer_possibleConstructorReturn(e,t){return!t||"object"!==CatchPlayer_typeof(t)&&"function"!=typeof t?CatchPlayer_assertThisInitialized(e):t}(this,CatchPlayer_getPrototypeOf(CatchPlayer).call(this,e,t))).scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO){case!0:n.setPosition(.5*n.scene.scale.width+300*n.scene.gameScale,.75*n.scene.scale.height);break;case!1:n.setPosition(.5*n.scene.scale.width-300*n.scene.gameScale,.75*n.scene.scale.height)}return n.scoreText=n.scene.add.text(0,-150*n.scene.gameScale,"0",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*n.scene.gameScale+"px",color:"#FF0000"}),n.scoreText.setOrigin(.5),n.scoreText.alpha=0,n.add(n.scoreText),n.bodyOffset=-10*n.scene.gameScale,n.bodyGraphics=n.scene.make.graphics(),n.bodyGraphics.generateTexture("catchPlayerBodyGraphics",100*n.scene.gameScale,20*n.scene.gameScale),n.body=n.scene.matter.add.image(n.x,n.y+n.bodyOffset,"catchPlayerBodyGraphics"),n.body.setIgnoreGravity(!0),n.body.setCollisionCategory(n.scene.playerCollisionCategory),n.body.setFixedRotation(),n.body.setMass(10*n.scene.gameScale),n.body.setFriction(0,.5),n.body.gameObject=CatchPlayer_assertThisInitialized(n),n.add(n.body),n.sensorGraphics=n.scene.make.graphics(),n.sensorGraphics.generateTexture("catchPlayerSensorGraphics",100*n.scene.gameScale,100*n.scene.gameScale),n.sensor=n.scene.matter.add.image(n.x,n.y,"catchPlayerSensorGraphics"),n.sensor.setIgnoreGravity(!0),n.sensor.setFixedRotation(),n.sensor.setSensor(!0),n.sensor.gameObject=CatchPlayer_assertThisInitialized(n),n.add(n.sensor),n.playerForceAmount=.1*n.scene.gameScale,n.force=new Phaser.Math.Vector2,n.dragSpeed=20*n.scene.gameScale,n.catchDepth=0,n.score=0,n.targetScore=10,n.animation.SetState(Be.State.Idle),n}return function CatchPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CatchPlayer_setPrototypeOf(e,t)}(CatchPlayer,L),function CatchPlayer_createClass(e,t,n){return t&&CatchPlayer_defineProperties(e.prototype,t),n&&CatchPlayer_defineProperties(e,n),e}(CatchPlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new Be(this.scene,this)}},{key:"CreateInput",value:function CreateInput(){return new Ae(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new xe(this.scene,this)}},{key:"update",value:function update(e,t){CatchPlayer_get(CatchPlayer_getPrototypeOf(CatchPlayer.prototype),"update",this).call(this,e,t),this.x=this.body.body.position.x,this.y=this.body.body.position.y-this.bodyOffset,this.catchDepth=this.y;var n=this.scene.GetDepthScale(this.y);this.setScale(n),this.sensor.setScale(n),this.sensor.x=this.x,this.sensor.y=this.y-50*n*this.scene.gameScale}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){CatchPlayer_get(CatchPlayer_getPrototypeOf(CatchPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&(0==this.playerInput.moveVector.x&&0==this.playerInput.moveVector.y||(this.force.set(this.playerInput.moveVector.x*this.playerForceAmount,this.playerInput.moveVector.y*this.playerForceAmount),this.body.applyForce(this.force)),0==this.playerInput.touchDirection.x&&0==this.playerInput.touchDirection.y||this.playerInput.touchDistance>this.dragSpeed&&(this.force.set(this.playerInput.touchDirection.x,this.playerInput.touchDirection.y),this.force.normalize(),this.force.scale(this.dragSpeed),this.body.setVelocity(this.force.x,this.force.y)))}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){CatchPlayer_get(CatchPlayer_getPrototypeOf(CatchPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state==F.State.Game&&(0==this.playerAI.moveVector.x&&0==this.playerAI.moveVector.y||(this.body.x+=this.playerAI.moveVector.x*t*.001,this.body.y+=this.playerAI.moveVector.y*t*.001))}},{key:"OnCollectablePickup",value:function OnCollectablePickup(){this.AddScore()}},{key:"AddScore",value:function AddScore(){switch(this.score++,this.scoreText.setText(this.score),this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","player_one_score_point");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","player_two_score_point")}this.scoreTween&&this.scoreTween.stop(),this.scoreText.setScale(.5),this.scoreText.y=-100*this.scene.gameScale,this.scoreText.alpha=0,this.scoreTween=this.scene.tweens.add({targets:this.scoreText,scaleX:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},scaleY:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},alpha:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},y:{value:-175*this.scene.gameScale,duration:1e3,ease:"Sine.easeInOut"}}),this.score>=this.targetScore?this.scene.EndGame():this.animation.SetState(Be.State.Catch)}},{key:"OnMinigameWon",value:function OnMinigameWon(){CatchPlayer_get(CatchPlayer_getPrototypeOf(CatchPlayer.prototype),"OnMinigameWon",this).call(this),this.animation.SetState(Be.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){CatchPlayer_get(CatchPlayer_getPrototypeOf(CatchPlayer.prototype),"OnMinigameLost",this).call(this),this.animation.SetState(Be.State.Lose)}},{key:"destroy",value:function destroy(){CatchPlayer_get(CatchPlayer_getPrototypeOf(CatchPlayer.prototype),"destroy",this).call(this)}}]),CatchPlayer}();function CatchUI_typeof(e){return(CatchUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CatchUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CatchUI_possibleConstructorReturn(e,t){return!t||"object"!==CatchUI_typeof(t)&&"function"!=typeof t?function CatchUI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function CatchUI_get(e,t,n){return(CatchUI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function CatchUI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CatchUI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CatchUI_getPrototypeOf(e){return(CatchUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CatchUI_setPrototypeOf(e,t){return(CatchUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var De=function(){function CatchUI(e){return function CatchUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchUI),CatchUI_possibleConstructorReturn(this,CatchUI_getPrototypeOf(CatchUI).call(this,e))}return function CatchUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CatchUI_setPrototypeOf(e,t)}(CatchUI,k),function CatchUI_createClass(e,t,n){return t&&CatchUI_defineProperties(e.prototype,t),n&&CatchUI_defineProperties(e,n),e}(CatchUI,[{key:"update",value:function update(e,t){CatchUI_get(CatchUI_getPrototypeOf(CatchUI.prototype),"update",this).call(this,e,t)}}]),CatchUI}();function CatchCollectable_typeof(e){return(CatchCollectable_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CatchCollectable_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CatchCollectable_getPrototypeOf(e){return(CatchCollectable_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CatchCollectable_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CatchCollectable_setPrototypeOf(e,t){return(CatchCollectable_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var je=function(){function CatchCollectable(e,t,n){var r;return function CatchCollectable_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchCollectable),(r=function CatchCollectable_possibleConstructorReturn(e,t){return!t||"object"!==CatchCollectable_typeof(t)&&"function"!=typeof t?CatchCollectable_assertThisInitialized(e):t}(this,CatchCollectable_getPrototypeOf(CatchCollectable).call(this,e,t,n))).scene=e,r.x=.5*r.scene.scale.width,r.y=.5*r.scene.scale.height,r.shadowSprite=r.scene.add.circle(0,0,25*r.scene.gameScale,0,.25),r.shadowSprite.setOrigin(.5),r.shadowSprite.setScale(1,.5),r.scene.world.add(r.shadowSprite),r.sprite=r.scene.add.sprite(0,0,"catch_minigame_atlas","falling_can.png"),r.sprite.setOrigin(.5),r.add(r.sprite),r.body=r.scene.matter.add.image(r.sprite.x,r.sprite.y,{shape:{type:"rectangle",width:20*r.scene.gameScale,height:20*r.scene.gameScale}}),r.body.setIgnoreGravity(!0),r.body.setAngle(r.angle),r.body.setFriction(0,0,0),r.body.setSensor(!0),r.body.alpha=0,r.body.gameObject=CatchCollectable_assertThisInitialized(r),r.add(r.body),r.trailParticles=r.scene.add.particles("catch_minigame_atlas","trail.png"),r.trailParticles.catchDepth=0,r.scene.depthLayer.add(r.trailParticles),r.trailParticleEmitter=r.trailParticles.createEmitter({on:!1,frequency:15,x:0,y:0,alpha:{start:.5,end:0,ease:"Sine.easeOut"},scale:{start:.6,end:.1,ease:"Sine.easeOut"},rotate:{start:0,end:0,ease:"Linear"},lifespan:1e3,follow:CatchCollectable_assertThisInitialized(r)}),r.trailParticleEmitter.reserve(Math.ceil(r.trailParticleEmitter.lifespan/r.trailParticleEmitter.frequency)),r.target=new Phaser.Math.Vector2,r.moveVector=new Phaser.Math.Vector2,r.speed=3*r.scene.gameScale,r.angularSpeed=.05,r.catchDepth=0,r.arrow=r.scene.add.sprite(0,0,"catch_minigame_atlas","catching_arrow.png"),r.scene.world.add(r.arrow),r.catchDistance=30*r.scene.gameScale,r.SetVisible(!1),r}return function CatchCollectable_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CatchCollectable_setPrototypeOf(e,t)}(CatchCollectable,Phaser.GameObjects.Container),function CatchCollectable_createClass(e,t,n){return t&&CatchCollectable_defineProperties(e.prototype,t),n&&CatchCollectable_defineProperties(e,n),e}(CatchCollectable,[{key:"update",value:function update(){if(this.visible){this.moveVector.set(this.target.x-this.x,this.target.y-this.y),this.moveVector.normalize(),this.body.x+=this.moveVector.x*this.speed,this.body.y+=this.moveVector.y*this.speed,this.body.setAngularVelocity(this.angularSpeed);var e=Math.atan2(this.moveVector.y,this.moveVector.x);e<0&&(e+=2*Math.PI),e=Phaser.Math.RadToDeg(e),this.trailParticleEmitter.rotate.start=e,this.trailParticleEmitter.rotate.end=e,this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.angle=this.body.angle,this.shadowSprite.x=this.x,this.shadowSprite.y=this.target.y,this.arrow.visible&&(this.arrow.x=this.shadowSprite.x,this.arrow.y=this.shadowSprite.y-50*this.scene.gameScale,this.arrow.alpha=this.shadowSprite.alpha),Phaser.Math.Distance.Between(this.x,this.y,this.target.x,this.target.y)<10*this.scene.gameScale&&this.OnHitGround()}}},{key:"Spawn",value:function Spawn(e,t,n,r,o,i){this.body.setPosition(t,n),this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.target.set(r,o),this.catchDepth=o;var a=this.scene.GetDepthScale(this.catchDepth);this.sprite.setScale(a),this.shadowSprite.setScale(1*a,.5*a),this.trailParticleEmitter.setScale({start:.6*a,end:.1*a,ease:"Sine.easeOut"}),this.trailParticles.catchDepth=this.catchDepth,this.shadowSprite.alpha=0,this.scene.tweens.add({targets:this.shadowSprite,alpha:{value:1,duration:800,ease:"Sine.easeIn"}}),this.sprite.setFrame(e),this.body.setBody({type:"rectangle",width:this.sprite.width,height:this.sprite.height}),this.body.setIgnoreGravity(!0),this.body.setScale(a),this.body.setAngle(Phaser.Math.RND.integerInRange(0,360)),this.angularSpeed=Phaser.Math.RND.realInRange(-.05,.05),this.body.setSensor(!0),this.SetVisible(!0),this.arrow.visible=i,this.arrow.alpha=0}},{key:"OnPlayerCollisionActive",value:function OnPlayerCollisionActive(e){this.scene.state==F.State.Game&&this.visible&&Math.abs(e.gameObjectB.gameObject.catchDepth-this.catchDepth)<this.catchDistance&&(e.gameObjectB.gameObject.OnCollectablePickup(),this.SetVisible(!1))}},{key:"OnHitGround",value:function OnHitGround(){this.SetVisible(!1),this.scene.OnCollectableHitGround(this)}},{key:"SetVisible",value:function SetVisible(e){this.trailParticleEmitter.on=e,this.visible=e,this.shadowSprite.visible=e,this.arrow.visible=e}}]),CatchCollectable}();function CatchCollectableSpawner_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Re=function(){function CatchCollectableSpawner(e){!function CatchCollectableSpawner_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchCollectableSpawner),this.scene=e,this.collectables=[],this.spawnTime=1,this.spawnTimer=this.spawnTime,this.spawnScreenOffset=100*this.scene.gameScale,this.poolSize=3;for(var t=0;t<this.poolSize;t++){var n=new je(this.scene,.5*this.scene.scale.width,.5*this.scene.scale.height);this.collectables.push(n),this.scene.depthLayer.add(n)}this.spawnCount=0,this.spawnFrames=["falling_can.png","falling_bottle.png","falling_shoe.png","falling_box.png","falling_newspapers.png","falling_saucepan.png"]}return function CatchCollectableSpawner_createClass(e,t,n){return t&&CatchCollectableSpawner_defineProperties(e.prototype,t),n&&CatchCollectableSpawner_defineProperties(e,n),e}(CatchCollectableSpawner,[{key:"update",value:function update(e,t){this.scene.state==F.State.Game&&0<this.spawnTimer&&(this.spawnTimer-=.001*t,this.spawnTimer<=0&&(this.Spawn(),this.spawnTimer=this.spawnTime));for(var n=0;n<this.collectables.length;n++)this.collectables[n].update(e,t)}},{key:"Spawn",value:function Spawn(){var e=.5*this.scene.scale.width-.5*this.scene.viewport.width+this.spawnScreenOffset,t=.5*this.scene.scale.width+.5*this.scene.viewport.width-this.spawnScreenOffset,n=.6*this.scene.scale.height,r=.9*this.scene.scale.height;h.Instance.Play("sfx_minigame","catch_drop");for(var o=0;o<this.collectables.length;o++)if(!this.collectables[o].visible){var i=Phaser.Math.RND.realInRange(e,t),a=Phaser.Math.RND.realInRange(e,t),s=Phaser.Math.RND.realInRange(n,r),l=this.spawnCount<3;this.collectables[o].Spawn(this.spawnFrames[Phaser.Math.RND.integerInRange(0,this.spawnFrames.length-1)],i,-50*this.scene.gameScale,a,s,l),this.spawnCount++;break}}}]),CatchCollectableSpawner}();function CatchBackground_typeof(e){return(CatchBackground_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CatchBackground_possibleConstructorReturn(e,t){return!t||"object"!==CatchBackground_typeof(t)&&"function"!=typeof t?function CatchBackground_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function CatchBackground_getPrototypeOf(e){return(CatchBackground_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CatchBackground_setPrototypeOf(e,t){return(CatchBackground_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ee=function(){function CatchBackground(e){var t;return function CatchBackground_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchBackground),(t=CatchBackground_possibleConstructorReturn(this,CatchBackground_getPrototypeOf(CatchBackground).call(this,e))).backgroundSprite=t.scene.add.sprite(.5*t.scene.scale.width,.5*t.scene.scale.height,"catch_background"),t.add(t.backgroundSprite),t.dust1=t.scene.add.sprite(.211*t.scene.scale.width,.525*t.scene.scale.height,"catch_minigame_atlas","dust_1.png"),t.dust1.catchDepth=t.dust1.y+.5*t.dust1.height,t.scene.depthLayer.add(t.dust1),t.dust2=t.scene.add.sprite(.163*t.scene.scale.width,.716*t.scene.scale.height,"catch_minigame_atlas","dust_2.png"),t.dust2.catchDepth=t.dust2.y+.5*t.dust2.height,t.scene.depthLayer.add(t.dust2),t.dust3=t.scene.add.sprite(.101*t.scene.scale.width,.822*t.scene.scale.height,"catch_minigame_atlas","dust_3.png"),t.dust3.catchDepth=t.dust3.y+.5*t.dust3.height,t.scene.depthLayer.add(t.dust3),t.dust4=t.scene.add.sprite(.246*t.scene.scale.width,.903*t.scene.scale.height,"catch_minigame_atlas","dust_4.png"),t.dust4.catchDepth=t.dust4.y+.5*t.dust4.height,t.scene.depthLayer.add(t.dust4),t.dust5=t.scene.add.sprite(.842*t.scene.scale.width,.59*t.scene.scale.height,"catch_minigame_atlas","dust_5.png"),t.dust5.catchDepth=t.dust5.y+.5*t.dust5.height,t.scene.depthLayer.add(t.dust5),t.dust6=t.scene.add.sprite(.871*t.scene.scale.width,.496*t.scene.scale.height,"catch_minigame_atlas","dust_6.png"),t.dust6.catchDepth=t.dust6.y+.5*t.dust6.height,t.scene.depthLayer.add(t.dust6),t.dust7=t.scene.add.sprite(.8*t.scene.scale.width,.698*t.scene.scale.height,"catch_minigame_atlas","dust_7.png"),t.dust7.catchDepth=t.dust7.y+.5*t.dust7.height,t.scene.depthLayer.add(t.dust7),t.dust8=t.scene.add.sprite(.804*t.scene.scale.width,.874*t.scene.scale.height,"catch_minigame_atlas","dust_8.png"),t.dust8.catchDepth=t.dust8.y+.5*t.dust8.height,t.scene.depthLayer.add(t.dust8),t}return function CatchBackground_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CatchBackground_setPrototypeOf(e,t)}(CatchBackground,Phaser.GameObjects.Container),CatchBackground}();function CatchTutorialPopup_typeof(e){return(CatchTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CatchTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==CatchTutorialPopup_typeof(t)&&"function"!=typeof t?function CatchTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function CatchTutorialPopup_getPrototypeOf(e){return(CatchTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CatchTutorialPopup_setPrototypeOf(e,t){return(CatchTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Fe=function(){function CatchTutorialPopup(e){var t;return function CatchTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchTutorialPopup),(t=CatchTutorialPopup_possibleConstructorReturn(this,CatchTutorialPopup_getPrototypeOf(CatchTutorialPopup).call(this,e))).panel.setTexture("catch_minigame_atlas","how_to_catching.png"),t}return function CatchTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CatchTutorialPopup_setPrototypeOf(e,t)}(CatchTutorialPopup,R),CatchTutorialPopup}();function CatchMinigame_typeof(e){return(CatchMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CatchMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CatchMinigame_possibleConstructorReturn(e,t){return!t||"object"!==CatchMinigame_typeof(t)&&"function"!=typeof t?function CatchMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function CatchMinigame_get(e,t,n){return(CatchMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function CatchMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CatchMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CatchMinigame_getPrototypeOf(e){return(CatchMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CatchMinigame_setPrototypeOf(e,t){return(CatchMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var He=function(){function CatchMinigame(){return function CatchMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CatchMinigame),CatchMinigame_possibleConstructorReturn(this,CatchMinigame_getPrototypeOf(CatchMinigame).call(this,"CatchMinigame"))}return function CatchMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CatchMinigame_setPrototypeOf(e,t)}(CatchMinigame,F),function CatchMinigame_createClass(e,t,n){return t&&CatchMinigame_defineProperties(e.prototype,t),n&&CatchMinigame_defineProperties(e,n),e}(CatchMinigame,[{key:"create",value:function create(){CatchMinigame_get(CatchMinigame_getPrototypeOf(CatchMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["catch_drop"]}),h.Instance.AddLayer("music_minigame",{audioKeys:["music_catch"]}),h.Instance.Play("music_minigame","music_catch")}},{key:"CreateMinigameUI",value:function CreateMinigameUI(){return new De(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new Fe(this)}},{key:"CreateWorld",value:function CreateWorld(){CatchMinigame_get(CatchMinigame_getPrototypeOf(CatchMinigame.prototype),"CreateWorld",this).call(this),this.matter.world.setBounds(.5*this.scale.width-.5*this.viewport.width,.5*this.scale.height+.05*this.viewport.height,this.viewport.width,.45*this.viewport.height,32,!0,!0,!1,!0),this.playerCollisionCategory=this.matter.world.nextCategory(),this.depthLayer=this.add.container(0,0),this.background=new Ee(this),this.world.add(this.background);var e=new Phaser.Math.Vector2(50*this.scene.gameScale,20*this.scene.gameScale),t=new Phaser.Geom.Rectangle(.5*-e.x,.5*-e.y,e.x,e.y);this.dustParticles=this.add.particles("catch_minigame_atlas","dust.png"),this.world.add(this.dustParticles),this.dustParticleEmitter=this.dustParticles.createEmitter({on:!1,x:10*this.gameScale,y:-5*this.gameScale,alpha:{start:1,end:0,ease:"Sine.easeOut"},scale:{start:.5,end:.3,ease:"Sine.easeOut"},angle:{min:0,max:360},lifespan:1e3,speedX:{min:-100*this.gameScale,max:100*this.gameScale},speedY:{start:-100*this.gameScale,end:-100*this.gameScale},accelerationY:{start:250*this.gameScale,end:250*this.gameScale},emitZone:{source:t}}),this.dustParticleEmitter.reserve(5);for(var n=0;n<2;n++){var r=new Me(this,{data:this.sys.settings.data.gameData.players[n],playerNumber:n,playerController:n<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(r),this.depthLayer.add(r)}this.collectableSpawner=new Re(this);for(n=0;n<this.players.length;n++)for(var o=0;o<this.collectableSpawner.collectables.length;o++)this.matterCollision.addOnCollideActive({objectA:this.collectableSpawner.collectables[o].body,objectB:this.players[n].sensor,callback:this.collectableSpawner.collectables[o].OnPlayerCollisionActive,context:this.collectableSpawner.collectables[o]});this.world.add(this.depthLayer)}},{key:"update",value:function update(e,t){CatchMinigame_get(CatchMinigame_getPrototypeOf(CatchMinigame.prototype),"update",this).call(this,e,t),this.collectableSpawner.update(e,t)}},{key:"UpdateGameState",value:function UpdateGameState(e,t){CatchMinigame_get(CatchMinigame_getPrototypeOf(CatchMinigame.prototype),"UpdateGameState",this).call(this,e,t),this.depthLayer.sort("catchDepth")}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){CatchMinigame_get(CatchMinigame_getPrototypeOf(CatchMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=null,t=-1,n=0;n<this.players.length;n++)this.players[n].score>t&&(e=this.players[n],t=this.players[n].score);return e}},{key:"GetDepthScale",value:function GetDepthScale(e){var t=Phaser.Math.Percent(e,415*this.gameScale,720*this.gameScale);return Phaser.Math.Linear(.75,1,t)}},{key:"OnCollectableHitGround",value:function OnCollectableHitGround(e){this.dustParticleEmitter.setPosition(e.x,e.y),this.dustParticleEmitter.explode(5)}},{key:"Destroy",value:function Destroy(){CatchMinigame_get(CatchMinigame_getPrototypeOf(CatchMinigame.prototype),"Destroy",this).call(this)}}]),CatchMinigame}();function DodgePlayerAI_typeof(e){return(DodgePlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DodgePlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DodgePlayerAI_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DodgePlayerAI_get(e,t,n){return(DodgePlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DodgePlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DodgePlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DodgePlayerAI_getPrototypeOf(e){return(DodgePlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DodgePlayerAI_setPrototypeOf(e,t){return(DodgePlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Le=function(){function DodgePlayerAI(e,t){var n;switch(function DodgePlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgePlayerAI),(n=function DodgePlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==DodgePlayerAI_typeof(t)&&"function"!=typeof t?DodgePlayerAI_assertThisInitialized(e):t}(this,DodgePlayerAI_getPrototypeOf(DodgePlayerAI).call(this,e,t))).moveVector=new Phaser.Math.Vector2(0,0),n.temp=new Phaser.Math.Vector2(0,0),n.moveSpeed=500*n.scene.gameScale,n.difficulty){case A.Difficulty.EASY:n.moveSpeed=300*n.scene.gameScale;break;case A.Difficulty.MEDIUM:n.moveSpeed=375*n.scene.gameScale;break;case A.Difficulty.HARD:n.moveSpeed=450*n.scene.gameScale}return n.finalTarget=new Phaser.Math.Vector2,n.currentTarget=new Phaser.Math.Vector2,n.collectableTarget=null,n.path=[],n.debugDraw=!1,n.debugControl=!1,n.debugDraw&&(n.pathLineGraphics=n.scene.add.graphics({lineStyle:{width:4,color:170}}),n.scene.world.add(n.pathLineGraphics)),n.debugControl&&n.scene.input.on("pointerdown",n.OnDebugPointerDown,DodgePlayerAI_assertThisInitialized(n)),n.targetingState=DodgePlayerAI.TargetingState.Inactive,n}return function DodgePlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DodgePlayerAI_setPrototypeOf(e,t)}(DodgePlayerAI,A),function DodgePlayerAI_createClass(e,t,n){return t&&DodgePlayerAI_defineProperties(e.prototype,t),n&&DodgePlayerAI_defineProperties(e,n),e}(DodgePlayerAI,[{key:"update",value:function update(e,t){switch(DodgePlayerAI_get(DodgePlayerAI_getPrototypeOf(DodgePlayerAI.prototype),"update",this).call(this,e,t),this.moveVector.set(0,0),this.targetingState){case DodgePlayerAI.TargetingState.Inactive:this.UpdateInactiveTargetingState();break;case DodgePlayerAI.TargetingState.Debug:this.UpdateDebugTargetingState();break;case DodgePlayerAI.TargetingState.RandomPoint:this.UpdateRandomPointTargetingState();break;case DodgePlayerAI.TargetingState.Collectable:this.UpdateCollectableTargetingState()}this.targetingState!=DodgePlayerAI.TargetingState.Inactive&&(this.HasReachedTarget(e,t)?this.SetTargetingState(DodgePlayerAI.TargetingState.Inactive):(this.temp.set(this.currentTarget.x-this.player.x,this.currentTarget.y-this.player.y),this.temp.normalize(),this.moveVector.x+=this.temp.x*this.moveSpeed,this.moveVector.y+=this.temp.y*this.moveSpeed))}},{key:"UpdateInactiveTargetingState",value:function UpdateInactiveTargetingState(){this.scene.collectableSpawner.HasAnyTargetableCollectables()?this.SetTargetingState(DodgePlayerAI.TargetingState.Collectable):this.SetTargetingState(DodgePlayerAI.TargetingState.RandomPoint)}},{key:"UpdateDebugTargetingState",value:function UpdateDebugTargetingState(){}},{key:"UpdateRandomPointTargetingState",value:function UpdateRandomPointTargetingState(){}},{key:"UpdateCollectableTargetingState",value:function UpdateCollectableTargetingState(){this.collectableTarget.visible||(this.collectableTarget=null,this.SetTargetingState(DodgePlayerAI.TargetingState.Inactive))}},{key:"SetTargetingState",value:function SetTargetingState(e){switch(this.targetingState=e,this.targetingState){case DodgePlayerAI.TargetingState.Inactive:this.SetInactiveTargetingState();break;case DodgePlayerAI.TargetingState.Debug:this.SetDebugTargetingState();break;case DodgePlayerAI.TargetingState.RandomPoint:this.SetRandomPointTargetingState();break;case DodgePlayerAI.TargetingState.Collectable:this.SetCollectableTargetingState()}}},{key:"SetInactiveTargetingState",value:function SetInactiveTargetingState(){}},{key:"SetDebugTargetingState",value:function SetDebugTargetingState(){}},{key:"SetRandomPointTargetingState",value:function SetRandomPointTargetingState(){var e=100*this.scene.gameScale,t=e+.5*this.scene.scale.width-.5*this.scene.viewport.width,n=.5*this.scene.scale.width+.5*this.scene.viewport.width-e;this.finalTarget.x=Phaser.Math.RND.realInRange(t,n),this.finalTarget.y=Phaser.Math.RND.realInRange(e,this.scene.scale.height-e),this.CalculatePath()}},{key:"SetCollectableTargetingState",value:function SetCollectableTargetingState(){for(var e=null,t=1e5,n=0;n<this.scene.collectableSpawner.collectables.length;n++){var r=this.scene.collectableSpawner.collectables[n];if(r.visible&&!r.blockedByObstacle){var o=Phaser.Math.Distance.Between(this.player.x,this.player.y,r.x,r.y);o<t&&(t=o,e=r)}}e&&(this.finalTarget.set(e.x,e.y),this.collectableTarget=e,this.CalculatePath())}},{key:"HasReachedTarget",value:function HasReachedTarget(e,t){var n=Phaser.Math.Distance.Between(this.player.x,this.player.y,this.currentTarget.x,this.currentTarget.y);return Phaser.Math.Distance.Between(this.player.x,this.player.y,this.finalTarget.x,this.finalTarget.y)<=this.moveSpeed*t*.002||(n<=this.moveSpeed*t*.002&&this.OnPathPointReached(),!1)}},{key:"OnPathPointReached",value:function OnPathPointReached(){if(0<this.path.length)if(this.path.splice(0,1),0<this.path.length){switch(this.targetingState){case DodgePlayerAI.TargetingState.RandomPoint:case DodgePlayerAI.TargetingState.Collectable:this.scene.collectableSpawner.HasAnyTargetableCollectables()?this.SetTargetingState(DodgePlayerAI.TargetingState.Collectable):this.targetingState==DodgePlayerAI.TargetingState.Collectable&&this.SetTargetingState(DodgePlayerAI.TargetingState.RandomPoint)}this.CalculatePath()}else this.currentTarget.set(this.finalTarget.x,this.finalTarget.y)}},{key:"OnDebugPointerDown",value:function OnDebugPointerDown(e){this.finalTarget.set(e.x,e.y),this.CalculatePath(),this.SetTargetingState(DodgePlayerAI.TargetingState.Debug)}},{key:"CalculatePath",value:function CalculatePath(){if(this.path=this.scene.pathfinding.GetPath(this.player.x,this.player.y,this.finalTarget.x,this.finalTarget.y),this.path&&1<this.path.length){if(this.path.splice(0,1),this.currentTarget.set(this.path[0].x,this.path[0].y),this.debugDraw){this.pathLineGraphics.clear(),this.pathLineGraphics.lineStyle(5,16711935,1),this.pathLineGraphics.beginPath(),this.pathLineGraphics.moveTo(this.path[0].x,this.path[0].y);for(var e=1;e<this.path.length;e++)this.pathLineGraphics.lineTo(this.path[e].x,this.path[e].y);this.pathLineGraphics.strokePath()}}else this.SetTargetingState(DodgePlayerAI.TargetingState.Inactive)}}]),DodgePlayerAI}();function DodgePlayerInput_typeof(e){return(DodgePlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DodgePlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DodgePlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==DodgePlayerInput_typeof(t)&&"function"!=typeof t?function DodgePlayerInput_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function DodgePlayerInput_get(e,t,n){return(DodgePlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DodgePlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DodgePlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DodgePlayerInput_getPrototypeOf(e){return(DodgePlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DodgePlayerInput_setPrototypeOf(e,t){return(DodgePlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function DodgePlayerAI_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Le,"TargetingState",Object.freeze({Inactive:0,Debug:1,RandomPoint:2,Collectable:3}));var Ge=function(){function DodgePlayerInput(e,t){return function DodgePlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgePlayerInput),DodgePlayerInput_possibleConstructorReturn(this,DodgePlayerInput_getPrototypeOf(DodgePlayerInput).call(this,e,t))}return function DodgePlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DodgePlayerInput_setPrototypeOf(e,t)}(DodgePlayerInput,ce),function DodgePlayerInput_createClass(e,t,n){return t&&DodgePlayerInput_defineProperties(e.prototype,t),n&&DodgePlayerInput_defineProperties(e,n),e}(DodgePlayerInput,[{key:"update",value:function update(e,t){DodgePlayerInput_get(DodgePlayerInput_getPrototypeOf(DodgePlayerInput.prototype),"update",this).call(this,e,t)}}]),DodgePlayerInput}();function DodgePlayerAnimation_typeof(e){return(DodgePlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DodgePlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DodgePlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==DodgePlayerAnimation_typeof(t)&&"function"!=typeof t?function DodgePlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function DodgePlayerAnimation_get(e,t,n){return(DodgePlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DodgePlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DodgePlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DodgePlayerAnimation_getPrototypeOf(e){return(DodgePlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DodgePlayerAnimation_setPrototypeOf(e,t){return(DodgePlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ne=function(){function DodgePlayerAnimation(e,t){var n;return function DodgePlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgePlayerAnimation),(n=DodgePlayerAnimation_possibleConstructorReturn(this,DodgePlayerAnimation_getPrototypeOf(DodgePlayerAnimation).call(this,e,t))).squashedSpine=n.scene.add.spine(0,55*n.scene.gameScale,"minigame_"+n.player.characterData.id,"dodge_squish",!0),n.squashedSpine.visible=!1,n.add(n.squashedSpine),n}return function DodgePlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DodgePlayerAnimation_setPrototypeOf(e,t)}(DodgePlayerAnimation,H),function DodgePlayerAnimation_createClass(e,t,n){return t&&DodgePlayerAnimation_defineProperties(e.prototype,t),n&&DodgePlayerAnimation_defineProperties(e,n),e}(DodgePlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id+"_topdown","dodge_idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){DodgePlayerAnimation_get(DodgePlayerAnimation_getPrototypeOf(DodgePlayerAnimation.prototype),"SetState",this).call(this,e),e==DodgePlayerAnimation.State.Squashed?(this.squashedSpine.visible=!0,this.spine.visible=!1):(this.squashedSpine.visible=!1,this.spine.visible=!0),e==DodgePlayerAnimation.State.Collect?this.spine.on("spine.complete",this.OnCollectAnimationComplete,this):this.spine.off("spine.complete",this.OnCollectAnimationComplete,this)}},{key:"update",value:function update(e,t){DodgePlayerAnimation_get(DodgePlayerAnimation_getPrototypeOf(DodgePlayerAnimation.prototype),"update",this).call(this,e,t)}},{key:"OnCollectAnimationComplete",value:function OnCollectAnimationComplete(){this.player.movedThisFrame?this.SetState(DodgePlayerAnimation.State.Walk):this.SetState(DodgePlayerAnimation.State.Idle)}},{key:"destroy",value:function destroy(){DodgePlayerAnimation_get(DodgePlayerAnimation_getPrototypeOf(DodgePlayerAnimation.prototype),"destroy",this).call(this)}}]),DodgePlayerAnimation}();function DodgePlayer_typeof(e){return(DodgePlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DodgePlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DodgePlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DodgePlayer_get(e,t,n){return(DodgePlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DodgePlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DodgePlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DodgePlayer_getPrototypeOf(e){return(DodgePlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DodgePlayer_setPrototypeOf(e,t){return(DodgePlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function DodgePlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Ne,"State",Object.freeze({Idle:{animationName:"dodge_idle",loop:!0},Walk:{animationName:"dodge_walk",loop:!0},Collect:{animationName:"dodge_success",loop:!1},Squashed:{animationName:"dodge_idle",loop:!1},Win:{animationName:"volley_success",loop:!1},Lose:{animationName:"volley_fail",loop:!1}}));var Ue=function(){function DodgePlayer(e,t){var n;switch(function DodgePlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgePlayer),1<(n=function DodgePlayer_possibleConstructorReturn(e,t){return!t||"object"!==DodgePlayer_typeof(t)&&"function"!=typeof t?DodgePlayer_assertThisInitialized(e):t}(this,DodgePlayer_getPrototypeOf(DodgePlayer).call(this,e,t))).scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO){case!0:n.setPosition(.5*n.scene.scale.width+300*n.scene.gameScale,.5*n.scene.scale.height);break;case!1:n.setPosition(.5*n.scene.scale.width-300*n.scene.gameScale,.5*n.scene.scale.height)}return n.scoreText=n.scene.add.text(0,-150*n.scene.gameScale,"0",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*n.scene.gameScale+"px",color:"#FF0000"}),n.scoreText.setOrigin(.5),n.scoreText.alpha=0,n.add(n.scoreText),n.body=n.scene.matter.add.image(n.x,n.y,void 0,void 0,{shape:{type:"circle",radius:40*n.scene.gameScale}}),n.body.setIgnoreGravity(!0),n.body.setFixedRotation(),n.body.setCollisionCategory(n.scene.playerCollisionCategory),n.body.setCollidesWith(1),n.body.setMass(10*n.scene.gameScale),n.body.setFriction(0,.5),n.body.gameObject=DodgePlayer_assertThisInitialized(n),n.add(n.body),n.flashSpine=n.scene.add.spine(.5*n.scale.width,.5*n.scale.height,"flash","flash",!1),n.flashSpine.setScale(n.gameScale),n.flashSpine.visible=!1,n.scene.world.add(n.flashSpine),n.playerForceAmount=.12*n.scene.gameScale,n.force=new Phaser.Math.Vector2,n.score=0,n.targetScore=10,n.squashed=!1,n.squashedTimer=0,n.minSquashedTime=.35,n.obstacleCollisionCount=0,n.movedThisFrame=!1,n.animation.SetState(Ne.State.Idle),n}return function DodgePlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DodgePlayer_setPrototypeOf(e,t)}(DodgePlayer,L),function DodgePlayer_createClass(e,t,n){return t&&DodgePlayer_defineProperties(e.prototype,t),n&&DodgePlayer_defineProperties(e,n),e}(DodgePlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new Ne(this.scene,this)}},{key:"CreateInput",value:function CreateInput(){return new Ge(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new Le(this.scene,this)}},{key:"update",value:function update(e,t){var n=this.movedThisFrame;this.movedThisFrame=!1,DodgePlayer_get(DodgePlayer_getPrototypeOf(DodgePlayer.prototype),"update",this).call(this,e,t),this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.velocityMagnitude=Phaser.Math.Distance.Between(0,0,this.body.body.velocity.x,this.body.body.velocity.y),0<this.squashedTimer&&(this.squashedTimer-=.001*t,this.squashedTimer<=0&&this.obstacleCollisionCount<=0&&this.Unsquash()),this.animation.state!=Ne.State.Walk&&this.animation.state!=Ne.State.Idle||this.movedThisFrame==n||(this.movedThisFrame?this.animation.SetState(Ne.State.Walk):this.animation.SetState(Ne.State.Idle))}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){DodgePlayer_get(DodgePlayer_getPrototypeOf(DodgePlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&(this.squashed||(0==this.playerInput.moveVector.x&&0==this.playerInput.moveVector.y||(this.body.x+=this.playerInput.moveVector.x*t*.5,this.body.y+=this.playerInput.moveVector.y*t*.5,this.movedThisFrame=!0),0==this.playerInput.dragMoveVector.x&&0==this.playerInput.dragMoveVector.y||(this.force.set(this.playerInput.dragMoveVector.x,this.playerInput.dragMoveVector.y),this.body.setVelocity(this.force.x,this.force.y),this.movedThisFrame=!0)))}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){DodgePlayer_get(DodgePlayer_getPrototypeOf(DodgePlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state==F.State.Game&&(this.squashed||0==this.playerAI.moveVector.x&&0==this.playerAI.moveVector.y||(this.body.x+=this.playerAI.moveVector.x*t*.001,this.body.y+=this.playerAI.moveVector.y*t*.001,this.movedThisFrame=!0))}},{key:"OnObstacleCollisionStart",value:function OnObstacleCollisionStart(e){this.squashed||this.Squash(e),0==this.obstacleCollisionCount&&this.score,this.obstacleCollisionCount++}},{key:"OnObstacleCollisionEnd",value:function OnObstacleCollisionEnd(){this.obstacleCollisionCount--,this.obstacleCollisionCount=Math.max(0,this.obstacleCollisionCount),this.obstacleCollisionCount<=0&&this.squashedTimer<=0&&this.Unsquash()}},{key:"Squash",value:function Squash(e){this.squashed=!0,this.animation.SetState(Ne.State.Squashed),this.squashedTimer=this.minSquashedTime,this.flashSpine.visible=!0,this.flashSpine.setPosition(e.pair.collision.supports[0].x,e.pair.collision.supports[0].y),this.flashSpine.setScale(.5),this.flashSpine.setAnimation(0,"flash",!1)}},{key:"Unsquash",value:function Unsquash(){this.squashed=!1,this.animation.SetState(Ne.State.Idle)}},{key:"OnCollectablePickup",value:function OnCollectablePickup(){this.AddScore()}},{key:"OnMinigameWon",value:function OnMinigameWon(){DodgePlayer_get(DodgePlayer_getPrototypeOf(DodgePlayer.prototype),"OnMinigameWon",this).call(this),this.animation.SetState(Ne.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){DodgePlayer_get(DodgePlayer_getPrototypeOf(DodgePlayer.prototype),"OnMinigameLost",this).call(this),this.animation.SetState(Ne.State.Lose)}},{key:"AddScore",value:function AddScore(){switch(this.score++,this.scoreText.setText(this.score),this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","player_one_score_point");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","player_two_score_point")}this.scoreTween&&this.scoreTween.stop(),this.scoreText.setScale(.5),this.scoreText.y=-50*this.scene.gameScale,this.scoreText.alpha=0,this.scoreTween=this.scene.tweens.add({targets:this.scoreText,scaleX:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},scaleY:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},alpha:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},y:{value:-75*this.scene.gameScale,duration:1e3,ease:"Sine.easeInOut"}}),this.score>=this.targetScore?this.scene.EndGame():this.animation.SetState(Ne.State.Collect)}},{key:"destroy",value:function destroy(){DodgePlayer_get(DodgePlayer_getPrototypeOf(DodgePlayer.prototype),"destroy",this).call(this)}}]),DodgePlayer}();function DodgeUI_typeof(e){return(DodgeUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DodgeUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DodgeUI_possibleConstructorReturn(e,t){return!t||"object"!==DodgeUI_typeof(t)&&"function"!=typeof t?function DodgeUI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function DodgeUI_get(e,t,n){return(DodgeUI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DodgeUI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DodgeUI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DodgeUI_getPrototypeOf(e){return(DodgeUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DodgeUI_setPrototypeOf(e,t){return(DodgeUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ze=function(){function DodgeUI(e){return function DodgeUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgeUI),DodgeUI_possibleConstructorReturn(this,DodgeUI_getPrototypeOf(DodgeUI).call(this,e))}return function DodgeUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DodgeUI_setPrototypeOf(e,t)}(DodgeUI,k),function DodgeUI_createClass(e,t,n){return t&&DodgeUI_defineProperties(e.prototype,t),n&&DodgeUI_defineProperties(e,n),e}(DodgeUI,[{key:"update",value:function update(e,t){DodgeUI_get(DodgeUI_getPrototypeOf(DodgeUI.prototype),"update",this).call(this,e,t)}}]),DodgeUI}();function DodgeObstacle_typeof(e){return(DodgeObstacle_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DodgeObstacle_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DodgeObstacle_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DodgeObstacle_get(e,t,n){return(DodgeObstacle_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DodgeObstacle_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DodgeObstacle_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DodgeObstacle_getPrototypeOf(e){return(DodgeObstacle_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DodgeObstacle_setPrototypeOf(e,t){return(DodgeObstacle_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ve=function(){function DodgeObstacle(e,t,n){var r;return function DodgeObstacle_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgeObstacle),(r=function DodgeObstacle_possibleConstructorReturn(e,t){return!t||"object"!==DodgeObstacle_typeof(t)&&"function"!=typeof t?DodgeObstacle_assertThisInitialized(e):t}(this,DodgeObstacle_getPrototypeOf(DodgeObstacle).call(this,e,t,n))).x=.5*r.scene.scale.width,r.y=.5*-r.scene.scale.height,r.angle=45,r.skidOffset=new Phaser.Math.Vector2(-70*r.scene.gameScale,0),r.skidSprite=r.scene.add.image(-70*r.scene.gameScale,0,"dodge_minigame_atlas","dodge_skid.png"),r.skidSprite.setOrigin(1,.5),r.skidSprite.setFlipX(!0),r.scene.world.add(r.skidSprite),r.scene.world.moveTo(r.skidSprite,r.scene.world.getIndex(r.scene.background)+1),r.sprite=r.scene.add.image(0,0,"dodge_minigame_atlas","dodge_trolley.png"),r.sprite.setFlipX(!0),r.add(r.sprite),r.bodyGraphics=r.scene.make.graphics(),r.bodyGraphics.generateTexture("dodgeObstacleGraphics",r.sprite.width,r.sprite.height),r.body=r.scene.matter.add.image(r.x,r.y,"dodgeObstacleGraphics"),r.body.setIgnoreGravity(!0),r.body.setFixedRotation(),r.body.setAngle(r.angle),r.body.setSensor(!0),r.body.setMass(1e3*r.scene.gameScale),r.body.setFriction(0,1),r.body.gameObject=DodgeObstacle_assertThisInitialized(r),r.add(r.body),r.force=new Phaser.Math.Vector2,r.speed=150*r.scene.gameScale,r.hasAppeared=!1,r.target=new Phaser.Math.Vector2,r.visible=!1,r}return function DodgeObstacle_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DodgeObstacle_setPrototypeOf(e,t)}(DodgeObstacle,Phaser.GameObjects.Container),function DodgeObstacle_createClass(e,t,n){return t&&DodgeObstacle_defineProperties(e.prototype,t),n&&DodgeObstacle_defineProperties(e,n),e}(DodgeObstacle,[{key:"update",value:function update(e,t){if(this.visible){this.force.set(Math.cos(this.rotation)*this.speed,Math.sin(this.rotation)*this.speed),this.body.x+=this.force.x*t*.001,this.body.y+=this.force.y*t*.001,this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.skidSprite.angle=this.angle;var n=I.RotateVector2(this.skidOffset,this.angle);this.skidSprite.setPosition(this.x+n.x,this.y+n.y),Phaser.Math.Distance.Between(this.x,this.y,this.target.x,this.target.y)<20*this.scene.gameScale&&this.Despawn()}}},{key:"Spawn",value:function Spawn(e,t,n,r,o,i){this.target.set(n,r),this.speed=i,this.body.setPosition(e,t),this.body.setAngle(o),this.angle=o,this.visible=!0,this.StartWobbleTween()}},{key:"Despawn",value:function Despawn(){this.visible=!1}},{key:"StartWobbleTween",value:function StartWobbleTween(){this.scene.state==F.State.Game&&(this.wobbleTween&&this.wobbleTween.isPlaying()&&this.wobbleTween.stop(),this.wobbleTween=this.scene.tweens.add({targets:this.sprite,angle:Phaser.Math.RND.between(-1,1),duration:Phaser.Math.RND.between(25,125),ease:"Linear",onComplete:this.StartWobbleTween,onCompleteScope:this}))}},{key:"OnPlayerCollisionStart",value:function OnPlayerCollisionStart(e){this.scene.state==F.State.Game&&this.visible&&(e.gameObjectB.gameObject.OnObstacleCollisionStart(e),this.scene.minigameCamera.camera.shake(250,.002),h.Instance.Play("sfx_minigame","dodge_trolley_impact"))}},{key:"OnPlayerCollisionEnd",value:function OnPlayerCollisionEnd(e){this.scene.state==F.State.Game&&this.visible&&e.gameObjectB.gameObject.OnObstacleCollisionEnd()}},{key:"destroy",value:function destroy(){DodgeObstacle_get(DodgeObstacle_getPrototypeOf(DodgeObstacle.prototype),"destroy",this).call(this)}}]),DodgeObstacle}();function Kn(e,t,n){!function DodgeObstacleSpawnPoint_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Kn),this.scene=e,this.x=t,this.y=n}function DodgeObstacleSpawner_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var We=function(){function DodgeObstacleSpawner(e){!function DodgeObstacleSpawner_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgeObstacleSpawner),this.scene=e,this.obstacles=[],this.spawnPointDistance=150*this.scene.gameScale,this.offScreenDistance=160*this.scene.gameScale,this.spawnPoints=[];for(var t=.5*this.scene.scale.width-.5*this.scene.viewport.width-this.offScreenDistance,n=.5*this.scene.scale.height-.5*this.scene.viewport.height-this.offScreenDistance,r=.5*this.scene.scale.width+.5*this.scene.viewport.width+this.offScreenDistance,o=.5*this.scene.scale.height+.5*this.scene.viewport.height+this.offScreenDistance,i=.5*this.scene.scale.width,a=.5*this.scene.scale.height,s=0;s<.5*this.scene.viewport.width-this.offScreenDistance;s+=this.spawnPointDistance){var l=new Kn(this.scene,i+s,n),c=new Kn(this.scene,i+s,o);if(this.spawnPoints.push(l),this.spawnPoints.push(c),0<s){var u=new Kn(this.scene,i-s,n),p=new Kn(this.scene,i-s,o);this.spawnPoints.push(u),this.spawnPoints.push(p)}}for(var h=0;h<.5*this.scene.viewport.height-this.offScreenDistance;h+=this.spawnPointDistance){l=new Kn(this.scene,t,a+h),c=new Kn(this.scene,r,a+h);if(this.spawnPoints.push(l),this.spawnPoints.push(c),0<s){u=new Kn(this.scene,t,a-h),p=new Kn(this.scene,r,a-h);this.spawnPoints.push(u),this.spawnPoints.push(p)}}for(var y=0;y<15;y++){var f=new Ve(this.scene);this.obstacles.push(f),this.scene.world.add(f)}this.debugDraw=!1,this.spawnIntersectLineLeft=new Phaser.Geom.Line,this.spawnIntersectLineRight=new Phaser.Geom.Line,this.obstacleIntersectLineLeft=new Phaser.Geom.Line,this.obstacleIntersectLineRight=new Phaser.Geom.Line,this.obstacleIntersectLineFront=new Phaser.Geom.Line,this.spawnIntersectLineLeftStartOffset=new Phaser.Math.Vector2,this.spawnIntersectLineRightStartOffset=new Phaser.Math.Vector2,this.obstacleIntersectLineLeftStartOffset=new Phaser.Math.Vector2,this.obstacleIntersectLineRightStartOffset=new Phaser.Math.Vector2,this.spawnIntersectLineLeftEndOffset=new Phaser.Math.Vector2,this.spawnIntersectLineRightEndOffset=new Phaser.Math.Vector2,this.obstacleIntersectLineLeftEndOffset=new Phaser.Math.Vector2,this.obstacleIntersectLineRightEndOffset=new Phaser.Math.Vector2,this.intersectPoint=new Phaser.Geom.Point,this.debugDraw&&(this.scene.cameras.main.zoom=.65,this.spawnIntersectLineLeftGraphics=this.scene.add.graphics({lineStyle:{width:4,color:170}}),this.scene.world.add(this.spawnIntersectLineLeftGraphics),this.spawnIntersectLineRightGraphics=this.scene.add.graphics({lineStyle:{width:4,color:170}}),this.scene.world.add(this.spawnIntersectLineRightGraphics),this.obstacleIntersectLineLeftGraphics=this.scene.add.graphics({lineStyle:{width:4,color:11141290}}),this.scene.world.add(this.obstacleIntersectLineLeftGraphics),this.obstacleIntersectLineRightGraphics=this.scene.add.graphics({lineStyle:{width:4,color:11141290}}),this.scene.world.add(this.obstacleIntersectLineRightGraphics),this.obstacleIntersectLineFrontGraphics=this.scene.add.graphics({lineStyle:{width:4,color:11141290}}),this.scene.world.add(this.obstacleIntersectLineFrontGraphics));var d=(this.scene.viewport.width-this.scene.scale.height)/(this.scene.scale.width-this.scene.scale.height);this.spawnTime=Phaser.Math.Linear(.5625,.15*1.5,d),this.spawnTimer=this.spawnTime,this.minSpawnSpeed=150*this.scene.gameScale,this.maxSpawnSpeed=350*this.scene.gameScale,this.spawnAttempts=0}return function DodgeObstacleSpawner_createClass(e,t,n){return t&&DodgeObstacleSpawner_defineProperties(e.prototype,t),n&&DodgeObstacleSpawner_defineProperties(e,n),e}(DodgeObstacleSpawner,[{key:"update",value:function update(e,t){if(this.scene.state==F.State.Game){0<this.spawnTimer&&(this.spawnTimer-=.001*t,this.spawnTimer<=0&&(this.AttemptSpawn(),this.spawnTimer=this.spawnTime));for(var n=0;n<this.obstacles.length;n++)this.obstacles[n].update(e,t)}}},{key:"AttemptSpawn",value:function AttemptSpawn(){for(var e=null,t=0;t<this.obstacles.length;t++)if(!this.obstacles[t].visible){e=this.obstacles[t];break}e&&(this.spawnAttempts=0,this.Spawn(e))}},{key:"Spawn",value:function Spawn(e){if(!(50<this.spawnAttempts)){var t=Phaser.Math.RND.integerInRange(0,this.spawnPoints.length-1),n=this.spawnPoints[t],r=Phaser.Math.RND.integerInRange(0,this.spawnPoints.length-1),o=this.spawnPoints[r],i=n.x<0&&o.x<0,a=n.x>this.scene.scale.width&&o.x>this.scene.scale.width,s=n.y<0&&o.y<0,l=n.y>this.scene.scale.height&&o.y>this.scene.scale.height;if(i||a||s||l)this.Spawn(e);else{this.debugDraw&&(this.spawnIntersectLineLeftGraphics.clear(),this.spawnIntersectLineRightGraphics.clear(),this.obstacleIntersectLineLeftGraphics.clear(),this.obstacleIntersectLineRightGraphics.clear(),this.obstacleIntersectLineFrontGraphics.clear());for(var c=Phaser.Math.RadToDeg(Math.atan2(o.x-n.x,-(o.y-n.y)))-90,u=Phaser.Math.RND.realInRange(this.minSpawnSpeed,this.maxSpawnSpeed),p=0;p<this.obstacles.length;p++)if(this.obstacles[p].visible&&this.WillCollide(n.x,n.y,o.x,o.y,c,u,this.obstacles[p]))return this.spawnAttempts++,void this.Spawn(e);e.Spawn(n.x,n.y,o.x,o.y,c,u)}}}},{key:"WillCollide",value:function WillCollide(e,t,n,r,o,i,a){var s=.5*this.scene.obstacleDimensions.x,l=.5*this.scene.obstacleDimensions.y,c=Phaser.Math.DegToRad(o),u=Phaser.Math.Distance.Between(e,t,n,r)/i,p=Phaser.Math.Distance.Between(a.x,a.y,a.target.x,a.target.y)/a.speed,h=Math.max(u,p),y=Math.max(i,a.speed),f=(this.scene.gameScale,this.scene.obstacleCollisionDistanceCheck);this.spawnIntersectLineLeftStartOffset.set(-l,s),this.spawnIntersectLineLeftStartOffset=this.RotateVector(this.spawnIntersectLineLeftStartOffset,c),this.spawnIntersectLineRightStartOffset.set(-l,-s),this.spawnIntersectLineRightStartOffset=this.RotateVector(this.spawnIntersectLineRightStartOffset,c),this.spawnIntersectLineLeftEndOffset.set(l,s),this.spawnIntersectLineLeftEndOffset=this.RotateVector(this.spawnIntersectLineLeftEndOffset,c),this.spawnIntersectLineRightEndOffset.set(l,-s),this.spawnIntersectLineRightEndOffset=this.RotateVector(this.spawnIntersectLineRightEndOffset,c);var d=a.rotation;this.obstacleIntersectLineLeftStartOffset.set(-l,s),this.obstacleIntersectLineLeftStartOffset=this.RotateVector(this.obstacleIntersectLineLeftStartOffset,d),this.obstacleIntersectLineRightStartOffset.set(-l,-s),this.obstacleIntersectLineRightStartOffset=this.RotateVector(this.obstacleIntersectLineRightStartOffset,d),this.obstacleIntersectLineLeftEndOffset.set(l,s),this.obstacleIntersectLineLeftEndOffset=this.RotateVector(this.obstacleIntersectLineLeftEndOffset,d),this.obstacleIntersectLineRightEndOffset.set(l,-s),this.obstacleIntersectLineRightEndOffset=this.RotateVector(this.obstacleIntersectLineRightEndOffset,d),this.spawnIntersectLineLeft.setTo(e+this.spawnIntersectLineLeftStartOffset.x,t+this.spawnIntersectLineLeftStartOffset.y,n+this.spawnIntersectLineLeftEndOffset.x,r+this.spawnIntersectLineLeftEndOffset.y),this.spawnIntersectLineRight.setTo(e+this.spawnIntersectLineRightStartOffset.x,t+this.spawnIntersectLineRightStartOffset.y,n+this.spawnIntersectLineRightEndOffset.x,r+this.spawnIntersectLineRightEndOffset.y),this.obstacleIntersectLineLeft.setTo(a.x+this.obstacleIntersectLineLeftStartOffset.x,a.y+this.obstacleIntersectLineLeftStartOffset.y,a.target.x+this.obstacleIntersectLineLeftEndOffset.x,a.target.y+this.obstacleIntersectLineLeftEndOffset.y),this.obstacleIntersectLineRight.setTo(a.x+this.obstacleIntersectLineRightStartOffset.x,a.y+this.obstacleIntersectLineRightStartOffset.y,a.target.x+this.obstacleIntersectLineRightEndOffset.x,a.target.y+this.obstacleIntersectLineRightEndOffset.y),this.obstacleIntersectLineFront.setTo(a.x+this.obstacleIntersectLineLeftEndOffset.x,a.y+this.obstacleIntersectLineLeftEndOffset.y,a.x+this.obstacleIntersectLineRightEndOffset.x,a.y+this.obstacleIntersectLineRightEndOffset.y),this.debugDraw&&(this.spawnIntersectLineLeftGraphics.strokeLineShape(this.spawnIntersectLineLeft),this.spawnIntersectLineRightGraphics.strokeLineShape(this.spawnIntersectLineRight),this.obstacleIntersectLineLeftGraphics.strokeLineShape(this.obstacleIntersectLineLeft),this.obstacleIntersectLineRightGraphics.strokeLineShape(this.obstacleIntersectLineRight),this.obstacleIntersectLineFrontGraphics.strokeLineShape(this.obstacleIntersectLineFront));for(var g=[{lineA:this.spawnIntersectLineLeft,lineB:this.obstacleIntersectLineFront,checkDistance:!0},{lineA:this.spawnIntersectLineRight,lineB:this.obstacleIntersectLineFront,checkDistance:!0},{lineA:this.spawnIntersectLineLeft,lineB:this.obstacleIntersectLineLeft,checkDistance:!0},{lineA:this.spawnIntersectLineLeft,lineB:this.obstacleIntersectLineRight,checkDistance:!0},{lineA:this.spawnIntersectLineRight,lineB:this.obstacleIntersectLineLeft,checkDistance:!0},{lineA:this.spawnIntersectLineRight,lineB:this.obstacleIntersectLineRight,checkDistance:!0}],m=0;m<g.length;m++){if(Phaser.Geom.Intersects.LineToLine(g[m].lineA,g[m].lineB,this.intersectPoint)){if(!g[m].checkDistance)return!0;for(var _=0;_<=h;_+=.1){var P=e+Math.cos(c)*i*_,b=t+Math.sin(c)*i*_,S=a.x+Math.cos(a.rotation)*a.speed*_,O=a.y+Math.sin(a.rotation)*a.speed*_;if(Phaser.Math.Distance.Between(P,b,S,O)<f)return!0}}}return!1}},{key:"RotateVector",value:function RotateVector(e,t){var n=Math.sin(t),r=Math.cos(t),o=e.x,i=e.y;return e.x=r*o-n*i,e.y=n*o+r*i,e}}]),DodgeObstacleSpawner}();function DodgeCollectable_typeof(e){return(DodgeCollectable_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DodgeCollectable_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DodgeCollectable_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DodgeCollectable_get(e,t,n){return(DodgeCollectable_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DodgeCollectable_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DodgeCollectable_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DodgeCollectable_getPrototypeOf(e){return(DodgeCollectable_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DodgeCollectable_setPrototypeOf(e,t){return(DodgeCollectable_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var qe=function(){function DodgeCollectable(e,t,n){var r;return function DodgeCollectable_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgeCollectable),(r=function DodgeCollectable_possibleConstructorReturn(e,t){return!t||"object"!==DodgeCollectable_typeof(t)&&"function"!=typeof t?DodgeCollectable_assertThisInitialized(e):t}(this,DodgeCollectable_getPrototypeOf(DodgeCollectable).call(this,e,t,n))).x=.5*r.scene.scale.width,r.y=.5*r.scene.scale.height,r.sprite=r.scene.add.sprite(0,0,"dodge_minigame_atlas","dodge_bread.png"),r.sprite.setOrigin(.5),r.add(r.sprite),r.body=r.scene.matter.add.image(r.x,r.y,void 0),r.body.setIgnoreGravity(!0),r.body.setFixedRotation(),r.body.setAngle(r.angle),r.body.setSensor(!0),r.body.gameObject=DodgeCollectable_assertThisInitialized(r),r.add(r.body),r.spawnX=0,r.spawnY=0,r.visible=!1,r.blockedByObstacle=!1,r.obstaclesBlocking=0,r}return function DodgeCollectable_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DodgeCollectable_setPrototypeOf(e,t)}(DodgeCollectable,Phaser.GameObjects.Container),function DodgeCollectable_createClass(e,t,n){return t&&DodgeCollectable_defineProperties(e.prototype,t),n&&DodgeCollectable_defineProperties(e,n),e}(DodgeCollectable,[{key:"update",value:function update(){this.visible}},{key:"Spawn",value:function Spawn(e,t,n){this.sprite.setFrame(n),this.angle=Phaser.Math.RND.realInRange(-60,60),this.spawnX=e,this.spawnY=t,this.body.setBody({type:"rectangle",width:this.sprite.width,height:this.sprite.height}),this.body.setPosition(e,t),this.body.setIgnoreGravity(!0),this.body.setFixedRotation(),this.body.setAngle(this.angle),this.body.setSensor(!0),this.sprite.setScale(0,0),this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.body.setPosition(-3e3,-3e3),this.visible=!0,this.blockedByObstacle=!1,this.appearTween&&this.appearTween.isPlaying()&&this.appearTween.stop(),this.appearTween=this.scene.tweens.add({targets:this.sprite,scaleX:1,scaleY:1,duration:500,ease:"Back.easeOut",onComplete:this.OnAppearTweenComplete,onCompleteScope:this}),h.Instance.Play("sfx_minigame","dodge_item_spawn")}},{key:"OnAppearTweenComplete",value:function OnAppearTweenComplete(){this.body.setPosition(this.spawnX,this.spawnY)}},{key:"OnPlayerCollisionStart",value:function OnPlayerCollisionStart(e){this.scene.state==F.State.Game&&this.visible&&(e.gameObjectB.gameObject.OnCollectablePickup(),this.visible=!1)}},{key:"OnObstacleCollisionStart",value:function OnObstacleCollisionStart(e){this.scene.state==F.State.Game&&e.gameObjectB.gameObject.visible&&this.visible&&(this.blockedByObstacle=!0,this.obstaclesBlocking++)}},{key:"OnObstacleCollisionEnd",value:function OnObstacleCollisionEnd(){this.scene.state==F.State.Game&&this.visible&&(1==this.obstaclesBlocking&&(this.blockedByObstacle=!1),this.obstaclesBlocking--,this.obstaclesBlocking=Math.max(this.obstaclesBlocking,0))}},{key:"destroy",value:function destroy(){DodgeCollectable_get(DodgeCollectable_getPrototypeOf(DodgeCollectable.prototype),"destroy",this).call(this)}}]),DodgeCollectable}();function DodgeCollectableSpawner_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ke=function(){function DodgeCollectableSpawner(e){!function DodgeCollectableSpawner_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgeCollectableSpawner),this.scene=e,this.collectables=[],this.spawnTime=1,this.spawnTimer=this.spawnTime,this.spawnScreenOffset=100*this.scene.gameScale,this.spawnAttempts=0,this.dodgeCollectableSprites=["dodge_bread.png","dodge_soda.png","dodge_cabbage.png","dodge_steak.png","dodge_milk.png"],this.lastDodgeCollectableSprite=null,this.poolSize=3;for(var t=0;t<this.poolSize;t++){var n=new qe(this.scene,.5*this.scene.scale.width,-5e3*this.scene.gameScale);this.collectables.push(n),this.scene.world.add(n)}}return function DodgeCollectableSpawner_createClass(e,t,n){return t&&DodgeCollectableSpawner_defineProperties(e.prototype,t),n&&DodgeCollectableSpawner_defineProperties(e,n),e}(DodgeCollectableSpawner,[{key:"update",value:function update(e,t){0<this.spawnTimer&&(this.spawnTimer-=.001*t,this.spawnTimer<=0&&(this.spawnAttempts=0,this.Spawn(),this.spawnTimer=this.spawnTime));for(var n=0;n<this.collectables.length;n++)this.collectables[n].update(e,t)}},{key:"Spawn",value:function Spawn(){for(var e=150*this.scene.gameScale,t=.5*this.scene.scale.width-.5*this.scene.viewport.width+this.spawnScreenOffset,n=.5*this.scene.scale.height-.5*this.scene.viewport.height+this.spawnScreenOffset,r=.5*this.scene.scale.width+.5*this.scene.viewport.width-this.spawnScreenOffset,o=.5*this.scene.scale.height+.5*this.scene.viewport.height-this.spawnScreenOffset,i=0;i<this.collectables.length;i++)if(!this.collectables[i].visible){for(var a=!1,s=Phaser.Math.RND.realInRange(t,r),l=Phaser.Math.RND.realInRange(n,o),c=0;c<this.collectables.length;c++){if(this.collectables[c].visible)Phaser.Math.Distance.Between(s,l,this.collectables[c].x,this.collectables[c].y)<e&&(a=!0)}for(c=0;c<this.scene.players.length;c++){Phaser.Math.Distance.Between(s,l,this.scene.players[c].x,this.scene.players[c].y)<e&&(a=!0)}if(a)this.spawnAttempts<10&&(this.spawnAttempts++,this.Spawn());else{var u=this.dodgeCollectableSprites.splice(Phaser.Math.RND.integerInRange(0,this.dodgeCollectableSprites.length-1),1);this.lastDodgeCollectableSprite&&this.dodgeCollectableSprites.push(this.lastDodgeCollectableSprite),this.lastDodgeCollectableSprite=u,this.collectables[i].Spawn(s,l,u)}break}}},{key:"HasAnyTargetableCollectables",value:function HasAnyTargetableCollectables(){for(var e=0;e<this.collectables.length;e++)if(this.collectables[e].visible&&!this.collectables[e].blockedByObstacle)return!0;return!1}}]),DodgeCollectableSpawner}();function DodgePathNode_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ye=function(){function DodgePathNode(e,t,n){!function DodgePathNode_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgePathNode),this.scene=e,this.x=t,this.y=n,this.connectedNodes=[],this.gCost=0,this.hCost=0,this.fCost=0,this.obstacleCost=0,this.traversable=!0,this.parent=null}return function DodgePathNode_createClass(e,t,n){return t&&DodgePathNode_defineProperties(e.prototype,t),n&&DodgePathNode_defineProperties(e,n),e}(DodgePathNode,[{key:"update",value:function update(){}},{key:"CalculateObstacleCost",value:function CalculateObstacleCost(){this.traversable=!0;for(var e=null,t=9999999,n=0;n<this.scene.obstacleSpawner.obstacles.length;n++){var r=this.scene.obstacleSpawner.obstacles[n];if(r.visible){var o=Phaser.Math.Distance.Between(r.x,r.y,this.x,this.y);o<t&&(t=o,e=r)}}var i=this.scene.obstacleCollisionDistanceCheck,a=.5*i;e&&(t<i&&(this.obstacleCost=i/t*1e3),t<a&&(this.traversable=!1))}},{key:"CalculateCost",value:function CalculateCost(e){var t=Phaser.Math.Distance.Between(e.x,e.y,this.x,this.y);this.gCost=e.gCost+t,this.fCost=this.gCost+this.hCost+this.obstacleCost}}]),DodgePathNode}();function DodgePathfinding_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xe=function(){function DodgePathfinding(e){!function DodgePathfinding_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgePathfinding),this.scene=e,this.nodes=[],this.screenEdgeOffset=10*this.scene.gameScale,this.nodeSpacing=75*this.scene.gameScale;for(var t=.5*this.scene.scale.width-.5*this.scene.viewport.width+this.screenEdgeOffset,n=.5*this.scene.scale.width+.5*this.scene.viewport.width-this.screenEdgeOffset,r=this.screenEdgeOffset,o=this.scene.scale.height-this.screenEdgeOffset,i=[],a=0;a<=this.scene.scale.height;a+=this.nodeSpacing)if(r<=a&&a<=o){var s=[];i.push(s);for(var l=0;l<=this.scene.scale.width;l+=this.nodeSpacing)if(t<=l&&l<=n){var c=new Ye(this.scene,l,a);this.nodes.push(c),s.push(c)}}for(var u=0;u<i.length;u++){s=i[u];for(var p=0;p<s.length;p++){var h=0<p,y=p<s.length-1,f=0<u,d=u<i.length-1,g=[];h&&(g.push(s[p-1]),f&&g.push(i[u-1][p-1]),d&&g.push(i[u+1][p-1])),y&&(g.push(s[p+1]),f&&g.push(i[u-1][p+1]),d&&g.push(i[u+1][p+1])),f&&g.push(i[u-1][p]),d&&g.push(i[u+1][p]);for(var m=0;m<g.length;m++)s[p].connectedNodes.push(g[m])}}}return function DodgePathfinding_createClass(e,t,n){return t&&DodgePathfinding_defineProperties(e.prototype,t),n&&DodgePathfinding_defineProperties(e,n),e}(DodgePathfinding,[{key:"update",value:function update(){}},{key:"GetPath",value:function GetPath(e,t,n,r){for(var o=null,i=null,a=999999,s=999999,l=0;l<this.nodes.length;l++){var c=Phaser.Math.Distance.Between(e,t,this.nodes[l].x,this.nodes[l].y),u=Phaser.Math.Distance.Between(n,r,this.nodes[l].x,this.nodes[l].y);c<a&&(o=this.nodes[l],a=c),u<s&&(i=this.nodes[l],s=u),this.nodes[l].parent=null,this.nodes[l].gCost=0,this.nodes[l].fCost=0,this.nodes[l].hCost=u,this.nodes[l].traversable=!0,this.nodes[l].CalculateObstacleCost()}return this.GetClosestPath(o,i)}},{key:"GetClosestPath",value:function GetClosestPath(e,t){var n=[e],r=[],o=null;do{o=this.GetCheapestNode(n);var i=n.indexOf(o);if(-1!=i&&n.splice(i,1),r.push(o),o==t)return this.ReturnFinalPath(t);for(var a=0;a<o.connectedNodes.length;a++){var s=o.connectedNodes[a];if(-1==r.indexOf(s)){var l=-1!=n.indexOf(s);l||(s.CalculateCost(o),s.parent=o,l||n.push(s))}}}while(0<n.length);if(o)return this.ReturnFinalPath(o)}},{key:"GetCheapestNode",value:function GetCheapestNode(e){for(var t=null,n=999999,r=0;r<e.length;r++){var o=e[r].fCost;o<n&&(n=o,t=e[r])}return t}},{key:"ReturnFinalPath",value:function ReturnFinalPath(e){for(var t=[];e;)e.traversable&&t.push(e),e=e.parent;return t.reverse()}}]),DodgePathfinding}();function DodgeTutorialPopup_typeof(e){return(DodgeTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DodgeTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==DodgeTutorialPopup_typeof(t)&&"function"!=typeof t?function DodgeTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function DodgeTutorialPopup_getPrototypeOf(e){return(DodgeTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DodgeTutorialPopup_setPrototypeOf(e,t){return(DodgeTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Je=function(){function DodgeTutorialPopup(e){var t;return function DodgeTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgeTutorialPopup),(t=DodgeTutorialPopup_possibleConstructorReturn(this,DodgeTutorialPopup_getPrototypeOf(DodgeTutorialPopup).call(this,e))).panel.setTexture("dodge_minigame_atlas","how_to_dodge.png"),t}return function DodgeTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DodgeTutorialPopup_setPrototypeOf(e,t)}(DodgeTutorialPopup,R),DodgeTutorialPopup}();function DodgeMinigame_typeof(e){return(DodgeMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DodgeMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DodgeMinigame_possibleConstructorReturn(e,t){return!t||"object"!==DodgeMinigame_typeof(t)&&"function"!=typeof t?function DodgeMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function DodgeMinigame_get(e,t,n){return(DodgeMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DodgeMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DodgeMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DodgeMinigame_getPrototypeOf(e){return(DodgeMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DodgeMinigame_setPrototypeOf(e,t){return(DodgeMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ze=function(){function DodgeMinigame(){return function DodgeMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DodgeMinigame),DodgeMinigame_possibleConstructorReturn(this,DodgeMinigame_getPrototypeOf(DodgeMinigame).call(this,"DodgeMinigame"))}return function DodgeMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DodgeMinigame_setPrototypeOf(e,t)}(DodgeMinigame,F),function DodgeMinigame_createClass(e,t,n){return t&&DodgeMinigame_defineProperties(e.prototype,t),n&&DodgeMinigame_defineProperties(e,n),e}(DodgeMinigame,[{key:"create",value:function create(){DodgeMinigame_get(DodgeMinigame_getPrototypeOf(DodgeMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["dodge_item_spawn","dodge_trolley_impact","music_dodge"]});var e=this.sys.textures.get("dodge_minigame_atlas").get("dodge_trolley.png");this.obstacleDimensions=new Phaser.Math.Vector2(e.height,e.width),this.obstacleCollisionDistanceCheck=Math.max(this.obstacleDimensions.x,this.obstacleDimensions.y)+15*this.gameScale,h.Instance.AddLayer("music_minigame",{audioKeys:["music_dodge"]}),h.Instance.Play("music_minigame","music_dodge")}},{key:"CreateMinigameUI",value:function CreateMinigameUI(){return new ze(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new Je(this)}},{key:"CreateWorld",value:function CreateWorld(){DodgeMinigame_get(DodgeMinigame_getPrototypeOf(DodgeMinigame.prototype),"CreateWorld",this).call(this),this.matter.world.setBounds(.5*this.scale.width-.5*this.viewport.width,.5*this.scale.height-.5*this.viewport.height,this.viewport.width,this.viewport.height,32,!0,!0,!1,!0),this.playerCollisionCategory=this.matter.world.nextCategory(),this.background=this.add.sprite(.5*this.scale.width,.5*this.scale.height,"dodge_background"),this.background.setScale(1.1),this.world.add(this.background),this.collectableSpawner=new Ke(this),this.depthWorld=this.add.container(),this.world.add(this.depthWorld);for(var e=0;e<2;e++){var t=new Ue(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(t),this.depthWorld.add(t)}this.obstacleSpawner=new We(this),this.pathfinding=new Xe(this);for(e=0;e<this.players.length;e++){for(var n=0;n<this.collectableSpawner.collectables.length;n++)this.matterCollision.addOnCollideStart({objectA:this.collectableSpawner.collectables[n].body,objectB:this.players[e].body,callback:this.collectableSpawner.collectables[n].OnPlayerCollisionStart,context:this.collectableSpawner.collectables[n]});for(n=0;n<this.obstacleSpawner.obstacles.length;n++)this.matterCollision.addOnCollideStart({objectA:this.obstacleSpawner.obstacles[n].body,objectB:this.players[e].body,callback:this.obstacleSpawner.obstacles[n].OnPlayerCollisionStart,context:this.obstacleSpawner.obstacles[n]}),this.matterCollision.addOnCollideEnd({objectA:this.obstacleSpawner.obstacles[n].body,objectB:this.players[e].body,callback:this.obstacleSpawner.obstacles[n].OnPlayerCollisionEnd,context:this.obstacleSpawner.obstacles[n]})}for(e=0;e<this.obstacleSpawner.obstacles.length;e++)for(n=0;n<this.collectableSpawner.collectables.length;n++)this.matterCollision.addOnCollideStart({objectA:this.collectableSpawner.collectables[n].body,objectB:this.obstacleSpawner.obstacles[e].body,callback:this.collectableSpawner.collectables[n].OnObstacleCollisionStart,context:this.collectableSpawner.collectables[n]}),this.matterCollision.addOnCollideEnd({objectA:this.collectableSpawner.collectables[n].body,objectB:this.obstacleSpawner.obstacles[e].body,callback:this.collectableSpawner.collectables[n].OnObstacleCollisionEnd,context:this.collectableSpawner.collectables[n]})}},{key:"update",value:function update(e,t){DodgeMinigame_get(DodgeMinigame_getPrototypeOf(DodgeMinigame.prototype),"update",this).call(this,e,t),this.obstacleSpawner.update(e,t),this.depthWorld.sort("y")}},{key:"UpdateGameState",value:function UpdateGameState(e,t){DodgeMinigame_get(DodgeMinigame_getPrototypeOf(DodgeMinigame.prototype),"UpdateGameState",this).call(this,e,t),this.collectableSpawner.update(e,t)}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){DodgeMinigame_get(DodgeMinigame_getPrototypeOf(DodgeMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=null,t=-1,n=0;n<this.players.length;n++)this.players[n].score>t&&(e=this.players[n],t=this.players[n].score);return e}},{key:"Destroy",value:function Destroy(){DodgeMinigame_get(DodgeMinigame_getPrototypeOf(DodgeMinigame.prototype),"Destroy",this).call(this)}}]),DodgeMinigame}();function BurgerPlayerAI_typeof(e){return(BurgerPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==BurgerPlayerAI_typeof(t)&&"function"!=typeof t?function BurgerPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerPlayerAI_get(e,t,n){return(BurgerPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerPlayerAI_getPrototypeOf(e){return(BurgerPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerPlayerAI_setPrototypeOf(e,t){return(BurgerPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var $e=function(){function BurgerPlayerAI(e,t){var n;switch(function BurgerPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerPlayerAI),(n=BurgerPlayerAI_possibleConstructorReturn(this,BurgerPlayerAI_getPrototypeOf(BurgerPlayerAI).call(this,e,t))).grab=!1,n.canGrabCooldown=1.5,n.canGrabCooldownTimer=0,n.canGrab=!0,n.grabChance=1,n.difficulty){case A.Difficulty.EASY:n.grabChance=.4;break;case A.Difficulty.MEDIUM:n.grabChance=.55;break;case A.Difficulty.HARD:n.grabChance=.75}return n}return function BurgerPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerPlayerAI_setPrototypeOf(e,t)}(BurgerPlayerAI,A),function BurgerPlayerAI_createClass(e,t,n){return t&&BurgerPlayerAI_defineProperties(e.prototype,t),n&&BurgerPlayerAI_defineProperties(e,n),e}(BurgerPlayerAI,[{key:"update",value:function update(e,t){BurgerPlayerAI_get(BurgerPlayerAI_getPrototypeOf(BurgerPlayerAI.prototype),"update",this).call(this,e,t);var n=this.player.burgerWorkStation.conveyor.selectedIngredient,r=this.player.burgerWorkStation.order.currentIngredient;this.grab=!1,0<this.canGrabCooldownTimer&&(this.canGrabCooldownTimer-=.001*t,this.canGrabCooldownTimer<=0&&(this.canGrab=!0)),this.canGrab&&n&&r&&n.type.id==r.id&&(Phaser.Math.RND.realInRange(0,1)<=this.grabChance?this.grab=!0:this.canGrab=!1,this.canGrabCooldownTimer=this.canGrabCooldown)}}]),BurgerPlayerAI}();function BurgerPlayerInput_typeof(e){return(BurgerPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerPlayerInput_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BurgerPlayerInput_get(e,t,n){return(BurgerPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerPlayerInput_getPrototypeOf(e){return(BurgerPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerPlayerInput_setPrototypeOf(e,t){return(BurgerPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Qe=function(){function BurgerPlayerInput(e,t){var n;return function BurgerPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerPlayerInput),(n=function BurgerPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==BurgerPlayerInput_typeof(t)&&"function"!=typeof t?BurgerPlayerInput_assertThisInitialized(e):t}(this,BurgerPlayerInput_getPrototypeOf(BurgerPlayerInput).call(this,e,t))).scene.deviceManager.desktop&&(n.rightKey.on("down",n.OnGrabInputPressed,BurgerPlayerInput_assertThisInitialized(n)),n.leftKey.on("down",n.OnGrabInputPressed,BurgerPlayerInput_assertThisInitialized(n))),n.wasGrab=!1,n.grab=!1,n}return function BurgerPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerPlayerInput_setPrototypeOf(e,t)}(BurgerPlayerInput,N),function BurgerPlayerInput_createClass(e,t,n){return t&&BurgerPlayerInput_defineProperties(e.prototype,t),n&&BurgerPlayerInput_defineProperties(e,n),e}(BurgerPlayerInput,[{key:"update",value:function update(e,t){BurgerPlayerInput_get(BurgerPlayerInput_getPrototypeOf(BurgerPlayerInput.prototype),"update",this).call(this,e,t),this.grab=this.wasGrab,this.wasGrab=!1}},{key:"OnPointerDown",value:function OnPointerDown(e,t,n){BurgerPlayerInput_get(BurgerPlayerInput_getPrototypeOf(BurgerPlayerInput.prototype),"OnPointerDown",this).call(this,e,t,n),this.OnGrabInputPressed()}},{key:"OnGrabInputPressed",value:function OnGrabInputPressed(){this.grab=!0,this.wasGrab=!0}},{key:"OnMinigameComplete",value:function OnMinigameComplete(){BurgerPlayerInput_get(BurgerPlayerInput_getPrototypeOf(BurgerPlayerInput.prototype),"OnMinigameComplete",this).call(this),this.buttonContainer&&(this.buttonContainer.visible=!1,this.grabButton.Disable())}}]),BurgerPlayerInput}();function BurgerPlayerAnimation_typeof(e){return(BurgerPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==BurgerPlayerAnimation_typeof(t)&&"function"!=typeof t?function BurgerPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerPlayerAnimation_get(e,t,n){return(BurgerPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerPlayerAnimation_getPrototypeOf(e){return(BurgerPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerPlayerAnimation_setPrototypeOf(e,t){return(BurgerPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var et=function(){function BurgerPlayerAnimation(e,t){return function BurgerPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerPlayerAnimation),BurgerPlayerAnimation_possibleConstructorReturn(this,BurgerPlayerAnimation_getPrototypeOf(BurgerPlayerAnimation).call(this,e,t))}return function BurgerPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerPlayerAnimation_setPrototypeOf(e,t)}(BurgerPlayerAnimation,H),function BurgerPlayerAnimation_createClass(e,t,n){return t&&BurgerPlayerAnimation_defineProperties(e.prototype,t),n&&BurgerPlayerAnimation_defineProperties(e,n),e}(BurgerPlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id+"_topdown","burger_idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){BurgerPlayerAnimation_get(BurgerPlayerAnimation_getPrototypeOf(BurgerPlayerAnimation.prototype),"SetState",this).call(this,e),e==BurgerPlayerAnimation.State.Grab?this.spine.on("spine.complete",this.OnGrabAnimationComplete,this):this.spine.off("spine.complete",this.OnGrabAnimationComplete,this)}},{key:"update",value:function update(e,t){BurgerPlayerAnimation_get(BurgerPlayerAnimation_getPrototypeOf(BurgerPlayerAnimation.prototype),"update",this).call(this,e,t)}},{key:"OnGrabAnimationComplete",value:function OnGrabAnimationComplete(){this.SetState(BurgerPlayerAnimation.State.Idle)}},{key:"destroy",value:function destroy(){BurgerPlayerAnimation_get(BurgerPlayerAnimation_getPrototypeOf(BurgerPlayerAnimation.prototype),"destroy",this).call(this)}}]),BurgerPlayerAnimation}();function BurgerIngredient_typeof(e){return(BurgerIngredient_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerIngredient_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerIngredient_possibleConstructorReturn(e,t){return!t||"object"!==BurgerIngredient_typeof(t)&&"function"!=typeof t?function BurgerIngredient_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerIngredient_get(e,t,n){return(BurgerIngredient_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerIngredient_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerIngredient_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerIngredient_getPrototypeOf(e){return(BurgerIngredient_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerIngredient_setPrototypeOf(e,t){return(BurgerIngredient_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function BurgerPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(et,"State",Object.freeze({Idle:{animationName:"burger_idle",loop:!0},Grab:{animationName:"burger_grab",loop:!1},Win:{animationName:"burger_success",loop:!1},Lose:{animationName:"burger_fail",loop:!1}}));var tt=function(){function BurgerIngredient(e,t,n){var r;return function BurgerIngredient_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerIngredient),(r=BurgerIngredient_possibleConstructorReturn(this,BurgerIngredient_getPrototypeOf(BurgerIngredient).call(this,e,t,n))).type=null,r.sprite=r.scene.add.sprite(0,0,"burger_minigame_atlas","burger_burger.png"),r.sprite.setOrigin(.5),r.add(r.sprite),r.visible=!1,r}return function BurgerIngredient_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerIngredient_setPrototypeOf(e,t)}(BurgerIngredient,Phaser.GameObjects.Container),function BurgerIngredient_createClass(e,t,n){return t&&BurgerIngredient_defineProperties(e.prototype,t),n&&BurgerIngredient_defineProperties(e,n),e}(BurgerIngredient,[{key:"Spawn",value:function Spawn(e){this.type=e,this.visible=!0,this.setPosition(0,-400*this.scene.gameScale),this.sprite.setFrame(this.type.ingredientFrameName)}},{key:"Hide",value:function Hide(){this.visible=!1}},{key:"destroy",value:function destroy(){BurgerIngredient_get(BurgerIngredient_getPrototypeOf(BurgerIngredient.prototype),"destroy",this).call(this)}}]),BurgerIngredient}();function BurgerConveyor_typeof(e){return(BurgerConveyor_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerConveyor_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerConveyor_possibleConstructorReturn(e,t){return!t||"object"!==BurgerConveyor_typeof(t)&&"function"!=typeof t?function BurgerConveyor_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerConveyor_get(e,t,n){return(BurgerConveyor_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerConveyor_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerConveyor_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerConveyor_getPrototypeOf(e){return(BurgerConveyor_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerConveyor_setPrototypeOf(e,t){return(BurgerConveyor_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function BurgerIngredient_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(tt,"Type",Object.freeze({BottomBun:{id:"bottom_bun",ingredientFrameName:"burger_bottom_bun.png",orderFrameName:"burger_ticket_bottom_bun.png"},TopBun:{id:"top_bun",ingredientFrameName:"burger_top_bun.png",orderFrameName:"burger_ticket_top_bun.png"},Meat:{id:"meat",ingredientFrameName:"burger_burger.png",orderFrameName:"burger_ticket_burger.png"},Lettuce:{id:"lettuce",ingredientFrameName:"burger_lettuce.png",orderFrameName:"burger_ticket_lettuce.png"},Tomatoes:{id:"tomatoes",ingredientFrameName:"burger_tomatoes.png",orderFrameName:"burger_ticket_tomatoes.png"},Cheese:{id:"cheese",ingredientFrameName:"burger_cheese.png",orderFrameName:"burger_ticket_cheese.png"}}));var nt=function(){function BurgerConveyor(e,t,n,r){var o;!function BurgerConveyor_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerConveyor),(o=BurgerConveyor_possibleConstructorReturn(this,BurgerConveyor_getPrototypeOf(BurgerConveyor).call(this,e,n,r))).burgerWorkStation=t,o.conveyorBeltSprite=o.scene.add.tileSprite(0,0,162*o.scene.gameScale,825*o.scene.gameScale,"burger_minigame_atlas","burger_conveyor.png"),o.conveyorBeltSprite.setOrigin(.5),o.add(o.conveyorBeltSprite),o.ingredientPool=[],o.ingredientsOnConveyor=[],o.ingredientPoolSize=8,o.selectorSprite=o.scene.add.sprite(0,0,"burger_minigame_atlas","burger_glow_square.png"),o.selectorSprite.visible=!1,o.add(o.selectorSprite);for(var i=0;i<o.ingredientPoolSize;i++){var a=new tt(o.scene,0,0);o.add(a),o.ingredientPool.push(a)}return o.conveyorMouthStartSprite=o.scene.add.sprite(0,.5*-o.scene.scale.height,"burger_minigame_atlas","burger_conveyor_mouth.png"),o.conveyorMouthStartSprite.setOrigin(.5,0),o.add(o.conveyorMouthStartSprite),o.conveyorMouthEndSprite=o.scene.add.sprite(0,.5*o.scene.scale.height,"burger_minigame_atlas","burger_conveyor_mouth.png"),o.conveyorMouthEndSprite.setOrigin(.5,1),o.add(o.conveyorMouthEndSprite),o.selectionY=50*o.scene.gameScale,o.selectedIngredientIndex=0,o.selectedIngredient=null,o.ingredientSpacing=165*o.scene.gameScale,o.lastIngredientTilePositionY=.5*o.ingredientSpacing,o.conveyorSpeed=225*o.scene.gameScale,o.canGrab=!1,o.closestIngredient=null,o}return function BurgerConveyor_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerConveyor_setPrototypeOf(e,t)}(BurgerConveyor,Phaser.GameObjects.Container),function BurgerConveyor_createClass(e,t,n){return t&&BurgerConveyor_defineProperties(e.prototype,t),n&&BurgerConveyor_defineProperties(e,n),e}(BurgerConveyor,[{key:"update",value:function update(e,t){this.conveyorBeltSprite.setTilePosition(0,this.conveyorBeltSprite.tilePositionY-this.conveyorSpeed*t*.001),this.conveyorBeltSprite.tilePositionY>this.conveyorBeltSprite.height&&this.conveyorBeltSprite.setTilePosition(0,0),this.canGrab||(this.selectorSprite.y+=this.conveyorSpeed*t*.001);for(var n=this.ingredientsOnConveyor.length-1;0<=n;n--)this.ingredientsOnConveyor[n].y+=this.conveyorSpeed*t*.001,this.ingredientsOnConveyor[n].y>400*this.scene.gameScale&&(this.ingredientsOnConveyor[n].Hide(),this.ingredientPool.push(this.ingredientsOnConveyor[n]),this.ingredientsOnConveyor.splice(n,1));this.conveyorBeltSprite.tilePositionY<=this.lastIngredientTilePositionY-this.ingredientSpacing&&(this.SpawnIngredient(),this.lastIngredientTilePositionY=this.lastIngredientTilePositionY-this.ingredientSpacing)}},{key:"UpdateStateBurgerCreation",value:function UpdateStateBurgerCreation(){for(var e=this.closestIngredient,t=this.selectorSprite.visible,n=this.ingredientSpacing,r=this.ingredientsOnConveyor.length-1;0<=r;r--)if(this.canGrab){var o=Math.abs(this.selectionY-this.ingredientsOnConveyor[r].y);o<=n&&(n=o,this.closestIngredient=this.ingredientsOnConveyor[r],this.selectedIngredientIndex=r,this.selectedIngredient=this.ingredientsOnConveyor[this.selectedIngredientIndex],this.selectorSprite.visible=!0,this.selectorSprite.y=this.ingredientsOnConveyor[r].y)}this.canGrab&&t&&e!=this.closestIngredient&&h.Instance.Play("sfx_minigame","burgers_target_move",{restart:!0})}},{key:"OnEnterStateBurgerCreation",value:function OnEnterStateBurgerCreation(){this.canGrab=!0,this.selectorSprite.alpha=1,this.selectorSprite.setScale(1)}},{key:"OnEnterStateMovingIngredient",value:function OnEnterStateMovingIngredient(){this.canGrab=!1,this.selectedIngredient=null,this.fadeSelectorTween=this.scene.tweens.add({targets:this.selectorSprite,scaleX:.75,scaleY:.75,alpha:0,duration:250,ease:"Linear"})}},{key:"SpawnIngredient",value:function SpawnIngredient(){if(0<this.ingredientPool.length){var e=this.ingredientPool[0];e.Spawn(this.burgerWorkStation.GetSpawnIngredientType()),this.ingredientPool.splice(0,1),this.ingredientsOnConveyor.push(e)}}},{key:"GrabClosestIngredient",value:function GrabClosestIngredient(){if(this.canGrab&&this.selectedIngredient){var e=this.selectedIngredient;return e.Hide(),this.ingredientPool.push(e),this.ingredientsOnConveyor.splice(this.selectedIngredientIndex,1),e}}},{key:"OnEnterStateGameComplete",value:function OnEnterStateGameComplete(){this.selectorSprite.alpha=0,this.moveBurgerTween=this.scene.tweens.add({targets:this,conveyorSpeed:0,duration:1e3,ease:"Sine.easeIn"})}},{key:"destroy",value:function destroy(){BurgerConveyor_get(BurgerConveyor_getPrototypeOf(BurgerConveyor.prototype),"destroy",this).call(this)}}]),BurgerConveyor}();function BurgerOrder_typeof(e){return(BurgerOrder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerOrder_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerOrder_possibleConstructorReturn(e,t){return!t||"object"!==BurgerOrder_typeof(t)&&"function"!=typeof t?function BurgerOrder_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerOrder_get(e,t,n){return(BurgerOrder_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerOrder_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerOrder_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerOrder_getPrototypeOf(e){return(BurgerOrder_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerOrder_setPrototypeOf(e,t){return(BurgerOrder_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var rt=function(){function BurgerOrder(e,t,n,r){var o;!function BurgerOrder_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerOrder),(o=BurgerOrder_possibleConstructorReturn(this,BurgerOrder_getPrototypeOf(BurgerOrder).call(this,e,n,r))).burgerWorkStation=t,o.orderPaperSprite=o.scene.add.sprite(0,75*o.scene.gameScale,"burger_minigame_atlas","burger_ticket.png"),o.orderPaperSprite.setOrigin(.5,.5),o.add(o.orderPaperSprite),o.orderNumberText=o.scene.add.text(0,200*o.scene.gameScale,"1",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:40*o.scene.gameScale+"px",color:"#000000"}),o.orderNumberText.setOrigin(.5),o.add(o.orderNumberText),o.ingredientContainer=o.scene.add.container(),o.add(o.ingredientContainer),o.ingredientSpritePool=[],o.displayIngredients=[],o.maxSize=8;for(var i=0;i<o.maxSize;i++){var a=o.scene.add.sprite(0,0,"burger_minigame_atlas","burger_ticket_bottom_bun.png");a.visible=!1,o.ingredientSpritePool.push(a),o.ingredientContainer.add(a)}var s=o.x>.5*o.scene.scale.width;return o.arrowSprite=o.scene.add.sprite(s?-65*o.scene.gameScale:65*o.scene.gameScale,0,"burger_minigame_atlas","burger_arrow.png"),o.arrowSprite.angle=s?180:0,o.arrowSprite.setOrigin(0,.5),o.add(o.arrowSprite),o.scene.tweens.add({targets:o.arrowSprite,scaleX:.8,scaleY:.8,duration:500,repeat:-1,ease:"Linear",yoyo:!0}),o.burgerOrdersData=o.scene.cache.json.get("burger_orders"),o.order=[],o.currentIngredientIndex=1,o.currentIngredient=null,o.isLastIngredient=!1,o}return function BurgerOrder_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerOrder_setPrototypeOf(e,t)}(BurgerOrder,Phaser.GameObjects.Container),function BurgerOrder_createClass(e,t,n){return t&&BurgerOrder_defineProperties(e.prototype,t),n&&BurgerOrder_defineProperties(e,n),e}(BurgerOrder,[{key:"update",value:function update(){}},{key:"CreateNewOrder",value:function CreateNewOrder(){this.orderNumberText.setText(this.burgerWorkStation.completedOrders+1),this.displayIngredients=[],this.currentIngredientIndex=1,this.isLastIngredient=!1;for(var e=0;e<this.ingredientSpritePool.length;e++)this.ingredientSpritePool[e].visible=!1;this.order=[];var t=this.burgerOrdersData[Phaser.Math.RND.integerInRange(0,this.burgerOrdersData.length-1)];for(e=0;e<t.length;e++){var n=t[e],r=tt.Type[n];this.order.push(r)}for(e=this.order.length-1;0<=e;e--)this.ingredientSpritePool[e].setFrame(this.order[e].orderFrameName),this.displayIngredients.push(this.ingredientSpritePool[e]),this.ingredientSpritePool[e].visible=!0;var o=20*this.scene.gameScale;Phaser.Actions.GridAlign(this.displayIngredients,{width:1,height:this.displayIngredients.length,cellWidth:0,cellHeight:o,position:Phaser.Display.Align.CENTER,y:-this.displayIngredients.length*o*.5+125*this.scene.gameScale}),this.moveTween=this.scene.tweens.add({targets:this,x:this.x,y:0,duration:500,ease:"Linear",onComplete:this.OnMoveTweenComplete,onCompleteScope:this}),this.currentIngredient=this.order[this.currentIngredientIndex],this.arrowSprite.y=this.ingredientContainer.y+this.ingredientSpritePool[this.currentIngredientIndex].y}},{key:"OnIngredientAdded",value:function OnIngredientAdded(){this.currentIngredientIndex++,this.currentIngredient=this.order[this.currentIngredientIndex],this.arrowSprite.y=this.ingredientContainer.y+this.ingredientSpritePool[this.currentIngredientIndex].y,this.isLastIngredient=this.currentIngredientIndex==this.order.length-1}},{key:"OnMoveTweenComplete",value:function OnMoveTweenComplete(){this.burgerWorkStation.usable&&this.burgerWorkStation.SetState(it.State.BurgerCreation)}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){for(var e=this.order.length-1;1<=e;e--)this.scene.tweens.add({targets:this.ingredientSpritePool[e],alpha:0,duration:250,delay:250*e,ease:"Linear",yoyo:!0})}},{key:"CompleteOrder",value:function CompleteOrder(){this.currentIngredient=null,this.moveTween=this.scene.tweens.add({targets:this,x:this.x,y:-250*this.scene.gameScale,duration:500,ease:"Linear",onComplete:this.OnCompleteOrderMoveTweenComplete,onCompleteScope:this})}},{key:"OnCompleteOrderMoveTweenComplete",value:function OnCompleteOrderMoveTweenComplete(){this.burgerWorkStation.usable&&this.CreateNewOrder()}},{key:"FailOrder",value:function FailOrder(){this.currentIngredientIndex=1,this.currentIngredient=this.order[this.currentIngredientIndex],this.arrowSprite.y=this.ingredientContainer.y+this.ingredientSpritePool[this.currentIngredientIndex].y,this.isLastIngredient=!1}},{key:"destroy",value:function destroy(){BurgerOrder_get(BurgerOrder_getPrototypeOf(BurgerOrder.prototype),"destroy",this).call(this)}}]),BurgerOrder}();function BurgerBurger_typeof(e){return(BurgerBurger_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerBurger_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerBurger_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BurgerBurger_get(e,t,n){return(BurgerBurger_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerBurger_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerBurger_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerBurger_getPrototypeOf(e){return(BurgerBurger_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerBurger_setPrototypeOf(e,t){return(BurgerBurger_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ot=function(){function BurgerBurger(e,t,n,r){var o;!function BurgerBurger_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerBurger),(o=function BurgerBurger_possibleConstructorReturn(e,t){return!t||"object"!==BurgerBurger_typeof(t)&&"function"!=typeof t?BurgerBurger_assertThisInitialized(e):t}(this,BurgerBurger_getPrototypeOf(BurgerBurger).call(this,e,n,r))).spawnPosition=new Phaser.Math.Vector2(n,r),o.burgerWorkStation=t,o.ingredientSpritePool=[],o.displayIngredients=[],o.addedIngredients=[],o.baseBunSprite=o.scene.add.sprite(0,0,"burger_minigame_atlas","burger_bottom_bun.png"),o.add(o.baseBunSprite),o.maxIngredients=6;for(var i=0;i<o.maxIngredients;i++){var a=o.scene.add.sprite(0,0,"burger_minigame_atlas","burger_bottom_bun.png");a.visible=!1,o.ingredientSpritePool.push(a),o.add(a)}var s=n>.5*o.scene.scale.width?o.scene.scale.width+100*o.scene.gameScale:-100*o.scene.gameScale;return o.completeOrderPosition=new Phaser.Math.Vector2(s,r),o.failOrderPosition=new Phaser.Math.Vector2(n,r+240*o.scene.gameScale),o.trailParticles=o.scene.add.particles("burger_minigame_atlas","trail.png"),o.scene.world.add(o.trailParticles),o.trailParticleEmitter=o.trailParticles.createEmitter({on:!1,frequency:15,x:0,y:0,alpha:{start:.5,end:0,ease:"Sine.easeOut"},scale:{start:.6,end:.1,ease:"Sine.easeOut"},rotate:{start:0,end:0,ease:"Linear"},lifespan:1e3,follow:BurgerBurger_assertThisInitialized(o)}),o.trailParticleEmitter.reserve(Math.ceil(o.trailParticleEmitter.lifespan/o.trailParticleEmitter.frequency)),o}return function BurgerBurger_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerBurger_setPrototypeOf(e,t)}(BurgerBurger,Phaser.GameObjects.Container),function BurgerBurger_createClass(e,t,n){return t&&BurgerBurger_defineProperties(e.prototype,t),n&&BurgerBurger_defineProperties(e,n),e}(BurgerBurger,[{key:"update",value:function update(){}},{key:"Reset",value:function Reset(){this.setPosition(this.spawnPosition.x,this.spawnPosition.y);for(var e=0;e<this.displayIngredients.length;e++)this.displayIngredients[e].visible=!1,this.ingredientSpritePool.push(this.displayIngredients[e]);this.displayIngredients=[],this.addedIngredients=[]}},{key:"AddIngredient",value:function AddIngredient(e){var t=this.ingredientSpritePool[0];t.setFrame(e.type.ingredientFrameName),t.visible=!0,t.setPosition(e.x+e.parentContainer.x-this.x,e.y+e.parentContainer.y-this.y),this.displayIngredients.push(t),this.ingredientSpritePool.splice(0,1),this.bringToTop(t),this.addedIngredients.push(e.type),this.moveIngredientTween&&this.moveIngredientTween.stop(),this.moveIngredientTween=this.scene.tweens.add({targets:t,x:0,y:0,duration:350,ease:"Linear",onComplete:this.OnMoveIngredientTweenComplete,onCompleteScope:this})}},{key:"OnMoveIngredientTweenComplete",value:function OnMoveIngredientTweenComplete(){var e=this.burgerWorkStation.order.order[this.addedIngredients.length].ingredientFrameName==this.addedIngredients[this.addedIngredients.length-1].ingredientFrameName,t=this.addedIngredients.length==this.burgerWorkStation.order.order.length-1;e?(this.burgerWorkStation.OnIngredientAdded(),t?this.burgerWorkStation.SetState(it.State.BurgerComplete):this.burgerWorkStation.SetState(it.State.BurgerCreation)):this.burgerWorkStation.SetState(it.State.BurgerFail)}},{key:"CompleteOrder",value:function CompleteOrder(){this.trailParticleEmitter.on=!0,this.moveBurgerTween=this.scene.tweens.add({targets:this,x:this.completeOrderPosition.x,y:this.completeOrderPosition.y,duration:600,ease:"Linear",onComplete:this.OnCompleteMoveTweenComplete,onCompleteScope:this})}},{key:"FailOrder",value:function FailOrder(){this.moveBurgerTween=this.scene.tweens.add({targets:this,x:this.failOrderPosition.x,y:this.failOrderPosition.y,duration:350,ease:"Sine.easeOut",onComplete:this.OnFailMoveTweenComplete,onCompleteScope:this})}},{key:"OnFailMoveTweenComplete",value:function OnFailMoveTweenComplete(){this.Reset(),this.burgerWorkStation.usable&&this.burgerWorkStation.SetState(it.State.BurgerCreation)}},{key:"OnCompleteMoveTweenComplete",value:function OnCompleteMoveTweenComplete(){this.trailParticleEmitter.on=!1,this.burgerWorkStation.usable&&this.Reset()}},{key:"destroy",value:function destroy(){BurgerBurger_get(BurgerBurger_getPrototypeOf(BurgerBurger.prototype),"destroy",this).call(this)}}]),BurgerBurger}();function BurgerWorkStation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var it=function(){function BurgerWorkStation(e,t){!function BurgerWorkStation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerWorkStation),this.scene=e,this.events=new Phaser.Events.EventEmitter;var n=.5*this.scene.scale.width,r=0==t?n+100*this.scene.gameScale:n-100*this.scene.gameScale;this.conveyor=new nt(this.scene,this,r,.5*this.scene.scale.height),this.scene.world.add(this.conveyor);var o=0==t?n+300*this.scene.gameScale:n-300*this.scene.gameScale;this.order=new rt(this.scene,this,o,-250*this.scene.gameScale),this.scene.world.add(this.order);var i=0==t?n+418*this.scene.gameScale:n-418*this.scene.gameScale;this.burger=new ot(this.scene,this,i,420*this.scene.gameScale),this.scene.world.add(this.burger);var a=0==t?n+418*this.scene.gameScale:n-418*this.scene.gameScale;this.bin=this.scene.add.sprite(a,720*this.scene.gameScale,"burger_minigame_atlas","burger_bin_lid_closed.png"),this.bin.setOrigin(.5,1),this.scene.world.add(this.bin),this.ingredients=[tt.Type.TopBun,tt.Type.Meat,tt.Type.Cheese,tt.Type.Lettuce,tt.Type.Tomatoes],this.ingredientQueue=[],this.completedOrders=0,this.targetOrders=5,this.orderWaitTime=1,this.orderWaitTimer=2,this.usable=!0,this.state=null,this.SetState(BurgerWorkStation.State.AwaitingOrder)}return function BurgerWorkStation_createClass(e,t,n){return t&&BurgerWorkStation_defineProperties(e.prototype,t),n&&BurgerWorkStation_defineProperties(e,n),e}(BurgerWorkStation,[{key:"update",value:function update(e,t){switch(this.conveyor.update(e,t),this.state){case BurgerWorkStation.State.AwaitingOrder:this.UpdateStateAwaitingOrder(e,t);break;case BurgerWorkStation.State.BurgerCreation:this.UpdateStateBurgerCreation(e,t);break;case BurgerWorkStation.State.BurgerComplete:this.UpdateStateBurgerComplete(e,t);break;case BurgerWorkStation.State.BurgerFail:this.UpdateStateBurgerFail(e,t)}}},{key:"UpdateStateAwaitingOrder",value:function UpdateStateAwaitingOrder(e,t){0<this.orderWaitTimer&&(this.orderWaitTimer-=.001*t,this.orderWaitTimer<=0&&this.order.CreateNewOrder())}},{key:"UpdateStateBurgerCreation",value:function UpdateStateBurgerCreation(e,t){this.conveyor.UpdateStateBurgerCreation(e,t)}},{key:"UpdateStateBurgerComplete",value:function UpdateStateBurgerComplete(){}},{key:"UpdateStateBurgerFail",value:function UpdateStateBurgerFail(){}},{key:"GetSpawnIngredientType",value:function GetSpawnIngredientType(){if(0==this.ingredientQueue.length){for(var e=0;e<this.ingredients.length;e++)this.ingredientQueue.push(this.ingredients[e]);I.ShuffleArray(this.ingredientQueue)}var t=this.ingredientQueue[0];return this.ingredientQueue.splice(0,1),t}},{key:"CanGrabIngredient",value:function CanGrabIngredient(){return this.usable&&this.conveyor.canGrab}},{key:"SetState",value:function SetState(e){if(this.state!=BurgerWorkStation.State.GameComplete)switch(this.state=e){case BurgerWorkStation.State.GameComplete:this.OnEnterStateGameComplete();break;case BurgerWorkStation.State.AwaitingOrder:this.OnEnterStateAwaitingOrder();break;case BurgerWorkStation.State.BurgerCreation:this.OnEnterStateBurgerCreation();break;case BurgerWorkStation.State.MovingIngredient:this.OnEnterStateMovingIngredient();break;case BurgerWorkStation.State.BurgerComplete:this.OnEnterStateBurgerComplete();break;case BurgerWorkStation.State.BurgerFail:this.OnEnterStateBurgerFail()}}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){this.order.OnEnterPreGameState()}},{key:"OnEnterStateAwaitingOrder",value:function OnEnterStateAwaitingOrder(){}},{key:"OnEnterStateBurgerCreation",value:function OnEnterStateBurgerCreation(){this.bin.setFrame("burger_bin_lid_closed.png"),this.conveyor.OnEnterStateBurgerCreation()}},{key:"OnEnterStateMovingIngredient",value:function OnEnterStateMovingIngredient(){var e=this.conveyor.GrabClosestIngredient();if(e){if(this.burger.AddIngredient(e),this.conveyor.OnEnterStateMovingIngredient(),e.type.id==this.order.currentIngredient.id&&this.completedOrders+1==this.targetOrders&&this.order.isLastIngredient)for(var t=0;t<this.scene.burgerWorkStations.length;t++)this.scene.burgerWorkStations[t].usable=!1}else this.SetState(BurgerWorkStation.State.BurgerCreation)}},{key:"OnEnterStateBurgerComplete",value:function OnEnterStateBurgerComplete(){this.completedOrders++,this.burger.CompleteOrder(),this.order.CompleteOrder(),this.events.emit("completeOrder"),this.completedOrders==this.targetOrders&&this.scene.EndGame()}},{key:"OnEnterStateBurgerFail",value:function OnEnterStateBurgerFail(){this.bin.setFrame("burger_bin_lid_open.png"),this.scene.minigameCamera.camera.shake(250,.003),this.burger.FailOrder(),this.order.FailOrder(),this.events.emit("failOrder")}},{key:"OnEnterStateGameComplete",value:function OnEnterStateGameComplete(){this.conveyor.OnEnterStateGameComplete()}},{key:"OnIngredientAdded",value:function OnIngredientAdded(){this.order.OnIngredientAdded(),this.events.emit("ingredientAdded")}}]),BurgerWorkStation}();function BurgerPlayer_typeof(e){return(BurgerPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BurgerPlayer_get(e,t,n){return(BurgerPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerPlayer_getPrototypeOf(e){return(BurgerPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerPlayer_setPrototypeOf(e,t){return(BurgerPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function BurgerWorkStation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(it,"State",Object.freeze({AwaitingOrder:0,BurgerCreation:1,MovingIngredient:2,BurgerComplete:3,BurgerFail:4,GameComplete:5}));var at=function(){function BurgerPlayer(e,t){var n;switch(function BurgerPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerPlayer),1<(n=function BurgerPlayer_possibleConstructorReturn(e,t){return!t||"object"!==BurgerPlayer_typeof(t)&&"function"!=typeof t?BurgerPlayer_assertThisInitialized(e):t}(this,BurgerPlayer_getPrototypeOf(BurgerPlayer).call(this,e,t))).scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO){case!0:n.setPosition(.5*n.scene.scale.width+250*n.scene.gameScale,400*n.scene.gameScale),n.animation.SetFlipX(!0);break;case!1:n.setPosition(.5*n.scene.scale.width-250*n.scene.gameScale,400*n.scene.gameScale)}return n.burgerWorkStation=t.burgerWorkStation,n.burgerWorkStation.events.on("completeOrder",n.OnOrderComplete,BurgerPlayer_assertThisInitialized(n)),n.burgerWorkStation.events.on("failOrder",n.OnOrderFail,BurgerPlayer_assertThisInitialized(n)),n.burgerWorkStation.events.on("ingredientAdded",n.OnIngredientAdded,BurgerPlayer_assertThisInitialized(n)),n.animation.SetState(et.State.Idle),n}return function BurgerPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerPlayer_setPrototypeOf(e,t)}(BurgerPlayer,L),function BurgerPlayer_createClass(e,t,n){return t&&BurgerPlayer_defineProperties(e.prototype,t),n&&BurgerPlayer_defineProperties(e,n),e}(BurgerPlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new et(this.scene,this)}},{key:"CreateInput",value:function CreateInput(){return new Qe(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new $e(this.scene,this)}},{key:"update",value:function update(e,t){BurgerPlayer_get(BurgerPlayer_getPrototypeOf(BurgerPlayer.prototype),"update",this).call(this,e,t)}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){BurgerPlayer_get(BurgerPlayer_getPrototypeOf(BurgerPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&this.playerInput.grab&&this.AttemptGrab()}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){BurgerPlayer_get(BurgerPlayer_getPrototypeOf(BurgerPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state==F.State.Game&&this.playerAI.grab&&this.AttemptGrab()}},{key:"AttemptGrab",value:function AttemptGrab(){if(this.burgerWorkStation.CanGrabIngredient())switch(this.animation.SetState(et.State.Grab),this.burgerWorkStation.SetState(it.State.MovingIngredient),this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","burgers_player_one_grab");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","burgers_player_two_grab")}}},{key:"OnIngredientAdded",value:function OnIngredientAdded(){switch(this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","burgers_player_one_correct");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","burgers_player_two_correct")}}},{key:"OnOrderFail",value:function OnOrderFail(){switch(this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","burgers_player_one_bin");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","burgers_player_two_bin")}}},{key:"OnOrderComplete",value:function OnOrderComplete(){switch(this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","player_one_score_point");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","player_two_score_point")}}},{key:"OnMinigameWon",value:function OnMinigameWon(){BurgerPlayer_get(BurgerPlayer_getPrototypeOf(BurgerPlayer.prototype),"OnMinigameWon",this).call(this),this.animation.SetState(et.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){BurgerPlayer_get(BurgerPlayer_getPrototypeOf(BurgerPlayer.prototype),"OnMinigameLost",this).call(this),this.animation.SetState(et.State.Lose)}},{key:"destroy",value:function destroy(){BurgerPlayer_get(BurgerPlayer_getPrototypeOf(BurgerPlayer.prototype),"destroy",this).call(this)}}]),BurgerPlayer}();function BurgerUI_typeof(e){return(BurgerUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerUI_possibleConstructorReturn(e,t){return!t||"object"!==BurgerUI_typeof(t)&&"function"!=typeof t?function BurgerUI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerUI_get(e,t,n){return(BurgerUI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerUI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerUI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerUI_getPrototypeOf(e){return(BurgerUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerUI_setPrototypeOf(e,t){return(BurgerUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var st=function(){function BurgerUI(e){return function BurgerUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerUI),BurgerUI_possibleConstructorReturn(this,BurgerUI_getPrototypeOf(BurgerUI).call(this,e))}return function BurgerUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerUI_setPrototypeOf(e,t)}(BurgerUI,k),function BurgerUI_createClass(e,t,n){return t&&BurgerUI_defineProperties(e.prototype,t),n&&BurgerUI_defineProperties(e,n),e}(BurgerUI,[{key:"update",value:function update(e,t){BurgerUI_get(BurgerUI_getPrototypeOf(BurgerUI.prototype),"update",this).call(this,e,t)}}]),BurgerUI}();function BurgerBackground_typeof(e){return(BurgerBackground_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerBackground_possibleConstructorReturn(e,t){return!t||"object"!==BurgerBackground_typeof(t)&&"function"!=typeof t?function BurgerBackground_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerBackground_getPrototypeOf(e){return(BurgerBackground_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerBackground_setPrototypeOf(e,t){return(BurgerBackground_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var lt=function(){function BurgerBackground(e){var t;return function BurgerBackground_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerBackground),(t=BurgerBackground_possibleConstructorReturn(this,BurgerBackground_getPrototypeOf(BurgerBackground).call(this,e))).backgroundSprite=t.scene.add.sprite(.5*t.scene.scale.width,.5*t.scene.scale.height,"burger_background"),t.add(t.backgroundSprite),t}return function BurgerBackground_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerBackground_setPrototypeOf(e,t)}(BurgerBackground,Phaser.GameObjects.Container),BurgerBackground}();function BurgerCamera_typeof(e){return(BurgerCamera_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerCamera_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerCamera_possibleConstructorReturn(e,t){return!t||"object"!==BurgerCamera_typeof(t)&&"function"!=typeof t?function BurgerCamera_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerCamera_get(e,t,n){return(BurgerCamera_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerCamera_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerCamera_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerCamera_getPrototypeOf(e){return(BurgerCamera_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerCamera_setPrototypeOf(e,t){return(BurgerCamera_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ct=function(){function BurgerCamera(e){return function BurgerCamera_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerCamera),BurgerCamera_possibleConstructorReturn(this,BurgerCamera_getPrototypeOf(BurgerCamera).call(this,e))}return function BurgerCamera_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerCamera_setPrototypeOf(e,t)}(BurgerCamera,j),function BurgerCamera_createClass(e,t,n){return t&&BurgerCamera_defineProperties(e.prototype,t),n&&BurgerCamera_defineProperties(e,n),e}(BurgerCamera,[{key:"update",value:function update(e,t){BurgerCamera_get(BurgerCamera_getPrototypeOf(BurgerCamera.prototype),"update",this).call(this,e,t)}}]),BurgerCamera}();function BurgerTutorialPopup_typeof(e){return(BurgerTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==BurgerTutorialPopup_typeof(t)&&"function"!=typeof t?function BurgerTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerTutorialPopup_getPrototypeOf(e){return(BurgerTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerTutorialPopup_setPrototypeOf(e,t){return(BurgerTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ut=function(){function BurgerTutorialPopup(e){var t;!function BurgerTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerTutorialPopup),(t=BurgerTutorialPopup_possibleConstructorReturn(this,BurgerTutorialPopup_getPrototypeOf(BurgerTutorialPopup).call(this,e))).panel.setTexture("burger_minigame_atlas","how_to_burger.png");for(var n=0;n<t.controlSpines.length;n++)t.scene.deviceManager.desktop?t.controlSpines[n].setAnimation(0,0==n?"right":"left",!0):t.controlSpines[n].setAnimation(0,"tap",!0);return t}return function BurgerTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerTutorialPopup_setPrototypeOf(e,t)}(BurgerTutorialPopup,R),BurgerTutorialPopup}();function BurgerMinigame_typeof(e){return(BurgerMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BurgerMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BurgerMinigame_possibleConstructorReturn(e,t){return!t||"object"!==BurgerMinigame_typeof(t)&&"function"!=typeof t?function BurgerMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BurgerMinigame_get(e,t,n){return(BurgerMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BurgerMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BurgerMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BurgerMinigame_getPrototypeOf(e){return(BurgerMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BurgerMinigame_setPrototypeOf(e,t){return(BurgerMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var pt=function(){function BurgerMinigame(){return function BurgerMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BurgerMinigame),BurgerMinigame_possibleConstructorReturn(this,BurgerMinigame_getPrototypeOf(BurgerMinigame).call(this,"BurgerMinigame"))}return function BurgerMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BurgerMinigame_setPrototypeOf(e,t)}(BurgerMinigame,F),function BurgerMinigame_createClass(e,t,n){return t&&BurgerMinigame_defineProperties(e.prototype,t),n&&BurgerMinigame_defineProperties(e,n),e}(BurgerMinigame,[{key:"create",value:function create(){BurgerMinigame_get(BurgerMinigame_getPrototypeOf(BurgerMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["burgers_start","burgers_player_one_grab","burgers_player_one_bin","burgers_player_two_grab","burgers_player_two_bin","burgers_player_one_correct","burgers_player_two_correct","burgers_target_move","music_burger"]}),h.Instance.AddLayer("music_minigame",{audioKeys:["music_burger"]}),h.Instance.Play("music_minigame","music_burger"),this.minigameUI.countdownDelay=1500,this.winner=null}},{key:"CreateMinigameCamera",value:function CreateMinigameCamera(){return new ct(this)}},{key:"CreateMinigameUI",value:function CreateMinigameUI(){return new st(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new ut(this)}},{key:"CreateWorld",value:function CreateWorld(){BurgerMinigame_get(BurgerMinigame_getPrototypeOf(BurgerMinigame.prototype),"CreateWorld",this).call(this),this.background=new lt(this),this.world.add(this.background),this.burgerWorkStations=[];for(var e=0;e<2;e++){var t=new it(this,e);this.burgerWorkStations.push(t)}for(e=0;e<2;e++){var n=1<this.playerCount&&e==M.PlayerNumber.ONE||1==this.playerCount&&e==M.PlayerNumber.TWO,r=new at(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI,burgerWorkStation:n?this.burgerWorkStations[0]:this.burgerWorkStations[1]});this.players.push(r),this.world.add(r)}}},{key:"update",value:function update(e,t){BurgerMinigame_get(BurgerMinigame_getPrototypeOf(BurgerMinigame.prototype),"update",this).call(this,e,t);for(var n=0;n<this.burgerWorkStations.length;n++)this.burgerWorkStations[n].update(e,t)}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=0;e<this.players.length;e++)if(this.players[e].burgerWorkStation.completedOrders==this.players[e].burgerWorkStation.targetOrders)return this.players[e]}},{key:"OnEnterGameState",value:function OnEnterGameState(){BurgerMinigame_get(BurgerMinigame_getPrototypeOf(BurgerMinigame.prototype),"OnEnterGameState",this).call(this),h.Instance.Play("sfx_minigame","burgers_start")}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){BurgerMinigame_get(BurgerMinigame_getPrototypeOf(BurgerMinigame.prototype),"OnEnterPreGameState",this).call(this);for(var e=0;e<this.burgerWorkStations.length;e++)this.burgerWorkStations[e].OnEnterPreGameState()}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){BurgerMinigame_get(BurgerMinigame_getPrototypeOf(BurgerMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end");for(var e=0;e<this.burgerWorkStations.length;e++)this.burgerWorkStations[e].SetState(it.State.GameComplete)}}]),BurgerMinigame}();function TrapdoorUI_typeof(e){return(TrapdoorUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorUI_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorUI_typeof(t)&&"function"!=typeof t?function TrapdoorUI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TrapdoorUI_get(e,t,n){return(TrapdoorUI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TrapdoorUI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TrapdoorUI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TrapdoorUI_getPrototypeOf(e){return(TrapdoorUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorUI_setPrototypeOf(e,t){return(TrapdoorUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ht=function(){function TrapdoorUI(e){return function TrapdoorUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorUI),TrapdoorUI_possibleConstructorReturn(this,TrapdoorUI_getPrototypeOf(TrapdoorUI).call(this,e))}return function TrapdoorUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorUI_setPrototypeOf(e,t)}(TrapdoorUI,k),function TrapdoorUI_createClass(e,t,n){return t&&TrapdoorUI_defineProperties(e.prototype,t),n&&TrapdoorUI_defineProperties(e,n),e}(TrapdoorUI,[{key:"update",value:function update(e,t){TrapdoorUI_get(TrapdoorUI_getPrototypeOf(TrapdoorUI.prototype),"update",this).call(this,e,t)}}]),TrapdoorUI}();function TrapdoorPlayerAI_typeof(e){return(TrapdoorPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorPlayerAI_typeof(t)&&"function"!=typeof t?function TrapdoorPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TrapdoorPlayerAI_get(e,t,n){return(TrapdoorPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TrapdoorPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TrapdoorPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TrapdoorPlayerAI_getPrototypeOf(e){return(TrapdoorPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorPlayerAI_setPrototypeOf(e,t){return(TrapdoorPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var yt=function(){function TrapdoorPlayerAI(e,t){var n;switch(function TrapdoorPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorPlayerAI),(n=TrapdoorPlayerAI_possibleConstructorReturn(this,TrapdoorPlayerAI_getPrototypeOf(TrapdoorPlayerAI).call(this,e,t))).moveVector=new Phaser.Math.Vector2(0,0),n.temp=new Phaser.Math.Vector2(0,0),n.path=[],n.patternCount=0,n.minFailChance=0,n.maxFailChance=.5,n.patternsTillMaxFailChance=5,n.minPatternsToSurvive=3,n.newPathTimer=0,n.difficulty){case A.Difficulty.EASY:n.maxFailChance=.75,n.patternsTillMaxFailChance=3,n.minPatternsToSurvive=1;break;case A.Difficulty.MEDIUM:n.maxFailChance=.5,n.patternsTillMaxFailChance=5,n.minPatternsToSurvive=2;break;case A.Difficulty.HARD:n.maxFailChance=.35,n.patternsTillMaxFailChance=7,n.minPatternsToSurvive=3}return n}return function TrapdoorPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorPlayerAI_setPrototypeOf(e,t)}(TrapdoorPlayerAI,A),function TrapdoorPlayerAI_createClass(e,t,n){return t&&TrapdoorPlayerAI_defineProperties(e.prototype,t),n&&TrapdoorPlayerAI_defineProperties(e,n),e}(TrapdoorPlayerAI,[{key:"update",value:function update(e,t){if(TrapdoorPlayerAI_get(TrapdoorPlayerAI_getPrototypeOf(TrapdoorPlayerAI.prototype),"update",this).call(this,e,t),this.moveVector.set(0,0),this.scene.trapdoorMachine.selectorActive)if(this.path&&0<this.path.length)Phaser.Math.Distance.Between(this.player.body.x,this.player.body.y,this.path[0].x+this.scene.trapdoorMachine.x,this.path[0].y+this.scene.trapdoorMachine.y)>50*this.scene.gameScale?(this.moveVector.set(this.path[0].x+this.scene.trapdoorMachine.x-this.player.body.x,this.path[0].y+this.scene.trapdoorMachine.y-this.player.body.y),this.moveVector.normalize()):(this.path.splice(0,1),0==this.path.length&&this.OnPathComplete());else if(0<this.newPathTimer&&(this.newPathTimer-=.01*t,this.newPathTimer<=0)){var n=this.scene.trapdoorMachine.patternTimer<3;this.ChooseNewPath(n)}}},{key:"OnTrapdoorMachinePatternStart",value:function OnTrapdoorMachinePatternStart(){this.patternCount++,this.ChooseNewPath(!1)}},{key:"ChooseNewPath",value:function ChooseNewPath(e){var t=[],n=null,r=999999;this.newPathTimer=.5;for(var o=0;o<this.scene.trapdoorMachine.trapdoors.length;o++){var i=Phaser.Math.Distance.Between(this.player.body.x,this.player.body.y,this.scene.trapdoorMachine.trapdoors[o].x+this.scene.trapdoorMachine.x,this.scene.trapdoorMachine.trapdoors[o].y+this.scene.trapdoorMachine.y);i<r&&(r=i,n=this.scene.trapdoorMachine.trapdoors[o])}for(o=0;o<this.scene.trapdoorMachine.trapdoors.length;o++){var a=n==this.scene.trapdoorMachine.trapdoors[o],s=this.scene.trapdoorMachine.trapdoors[o].isOpen;!(!e||!this.scene.trapdoorMachine.trapdoors[o].inDanger)||s||a||t.push(this.scene.trapdoorMachine.trapdoors[o])}if(e){var l=n,c=n;this.targetTrapdoor=1<t.length?null:t[0];do{l=l.nextTrapdoor,c=c.previousTrapdoor;for(o=0;o<t.length;o++){if(l==t[o]){this.targetTrapdoor=l;break}if(c==t[o]){this.targetTrapdoor=c;break}}}while(!this.targetTrapdoor)}else I.ShuffleArray(t),this.targetTrapdoor=t[0];if(n!=this.targetTrapdoor){Phaser.Math.RND.realInRange(0,1)>1-Phaser.Math.Linear(this.minFailChance,this.maxFailChance,(this.patternCount-this.minPatternsToSurvive)/(this.patternsTillMaxFailChance-this.minPatternsToSurvive))&&(this.targetTrapdoor=Phaser.Math.RND.pick([this.targetTrapdoor.nextTrapdoor,this.targetTrapdoor.previousTrapdoor]));var u=this.GetPathToTrapdoor(n,this.targetTrapdoor,1),p=this.GetPathToTrapdoor(n,this.targetTrapdoor,-1);this.path=u?p?u.length<p.length?u:p:u:p}}},{key:"OnPathComplete",value:function OnPathComplete(){(this.targetTrapdoor.inDanger||3<this.scene.trapdoorMachine.patternTimer)&&(this.newPathTimer=.25)}},{key:"GetPathToTrapdoor",value:function GetPathToTrapdoor(e,t,n){for(var r=[],o=e,i=!1;(o=0<n?o.nextTrapdoor:o.previousTrapdoor).isOpen&&(i=!0),r.push(o),o!=t;);return i?null:r}}]),TrapdoorPlayerAI}();function TrapdoorPlayerInput_typeof(e){return(TrapdoorPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorPlayerInput_typeof(t)&&"function"!=typeof t?function TrapdoorPlayerInput_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TrapdoorPlayerInput_get(e,t,n){return(TrapdoorPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TrapdoorPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TrapdoorPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TrapdoorPlayerInput_getPrototypeOf(e){return(TrapdoorPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorPlayerInput_setPrototypeOf(e,t){return(TrapdoorPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ft=function(){function TrapdoorPlayerInput(e,t){return function TrapdoorPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorPlayerInput),TrapdoorPlayerInput_possibleConstructorReturn(this,TrapdoorPlayerInput_getPrototypeOf(TrapdoorPlayerInput).call(this,e,t))}return function TrapdoorPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorPlayerInput_setPrototypeOf(e,t)}(TrapdoorPlayerInput,ce),function TrapdoorPlayerInput_createClass(e,t,n){return t&&TrapdoorPlayerInput_defineProperties(e.prototype,t),n&&TrapdoorPlayerInput_defineProperties(e,n),e}(TrapdoorPlayerInput,[{key:"update",value:function update(e,t){TrapdoorPlayerInput_get(TrapdoorPlayerInput_getPrototypeOf(TrapdoorPlayerInput.prototype),"update",this).call(this,e,t)}}]),TrapdoorPlayerInput}();function TrapdoorPlayerAnimation_typeof(e){return(TrapdoorPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorPlayerAnimation_typeof(t)&&"function"!=typeof t?function TrapdoorPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TrapdoorPlayerAnimation_get(e,t,n){return(TrapdoorPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TrapdoorPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TrapdoorPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TrapdoorPlayerAnimation_getPrototypeOf(e){return(TrapdoorPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorPlayerAnimation_setPrototypeOf(e,t){return(TrapdoorPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var dt=function(){function TrapdoorPlayerAnimation(e,t){return function TrapdoorPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorPlayerAnimation),TrapdoorPlayerAnimation_possibleConstructorReturn(this,TrapdoorPlayerAnimation_getPrototypeOf(TrapdoorPlayerAnimation).call(this,e,t))}return function TrapdoorPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorPlayerAnimation_setPrototypeOf(e,t)}(TrapdoorPlayerAnimation,H),function TrapdoorPlayerAnimation_createClass(e,t,n){return t&&TrapdoorPlayerAnimation_defineProperties(e.prototype,t),n&&TrapdoorPlayerAnimation_defineProperties(e,n),e}(TrapdoorPlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id+"_topdown","dodge_idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){TrapdoorPlayerAnimation_get(TrapdoorPlayerAnimation_getPrototypeOf(TrapdoorPlayerAnimation.prototype),"SetState",this).call(this,e)}},{key:"update",value:function update(e,t){switch(TrapdoorPlayerAnimation_get(TrapdoorPlayerAnimation_getPrototypeOf(TrapdoorPlayerAnimation.prototype),"update",this).call(this,e,t),this.state){case TrapdoorPlayerAnimation.State.Idle:this.UpdateIdleState();break;case TrapdoorPlayerAnimation.State.Walk:this.UpdateWalkState()}}},{key:"UpdateIdleState",value:function UpdateIdleState(){.1<this.player.velocityMagnitude&&this.SetState(TrapdoorPlayerAnimation.State.Walk)}},{key:"UpdateWalkState",value:function UpdateWalkState(){this.player.velocityMagnitude<=.1&&this.SetState(TrapdoorPlayerAnimation.State.Idle)}},{key:"destroy",value:function destroy(){TrapdoorPlayerAnimation_get(TrapdoorPlayerAnimation_getPrototypeOf(TrapdoorPlayerAnimation.prototype),"destroy",this).call(this)}}]),TrapdoorPlayerAnimation}();function TrapdoorPlayer_typeof(e){return(TrapdoorPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TrapdoorPlayer_get(e,t,n){return(TrapdoorPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TrapdoorPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TrapdoorPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TrapdoorPlayer_getPrototypeOf(e){return(TrapdoorPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorPlayer_setPrototypeOf(e,t){return(TrapdoorPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function TrapdoorPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(dt,"State",Object.freeze({Idle:{animationName:"dodge_idle",loop:!0},Walk:{animationName:"dodge_walk",loop:!0},Falling:{animationName:"volley_fail",loop:!1},Win:{animationName:"volley_success",loop:!1},Lose:{animationName:"volley_fail",loop:!1}}));var gt=function(){function TrapdoorPlayer(e,t){var n;return function TrapdoorPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorPlayer),(n=function TrapdoorPlayer_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorPlayer_typeof(t)&&"function"!=typeof t?TrapdoorPlayer_assertThisInitialized(e):t}(this,TrapdoorPlayer_getPrototypeOf(TrapdoorPlayer).call(this,e,t))).body=n.scene.matter.add.image(n.x,n.y,void 0,void 0,{shape:{type:"circle",radius:40*n.scene.gameScale}}),n.body.setIgnoreGravity(!0),n.body.setFixedRotation(),n.body.setCollisionCategory(n.scene.playerCollisionCategory),n.body.setCollidesWith(1),n.body.setMass(10*n.scene.gameScale),n.body.setFriction(0,.5),n.body.gameObject=TrapdoorPlayer_assertThisInitialized(n),n.add(n.body),n.feetBody=n.scene.matter.add.image(n.x,n.y,void 0,void 0,{shape:{type:"rectangle",height:10*n.scene.gameScale,width:25*n.scene.gameScale}}),n.feetBody.setIgnoreGravity(!0),n.feetBody.setFixedRotation(),n.feetBody.setCollisionCategory(n.scene.playerCollisionCategory),n.feetBody.setCollidesWith(1),n.feetBody.setSensor(!0),n.feetBody.gameObject=TrapdoorPlayer_assertThisInitialized(n),n.add(n.feetBody),n.playerForceAmount=.12*n.scene.gameScale,n.force=new Phaser.Math.Vector2,n.minDragTouchDistance=20*n.scene.gameScale,n.state=null,n.Respawn(),n}return function TrapdoorPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorPlayer_setPrototypeOf(e,t)}(TrapdoorPlayer,L),function TrapdoorPlayer_createClass(e,t,n){return t&&TrapdoorPlayer_defineProperties(e.prototype,t),n&&TrapdoorPlayer_defineProperties(e,n),e}(TrapdoorPlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new dt(this.scene,this)}},{key:"CreateInput",value:function CreateInput(){return new ft(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new yt(this.scene,this)}},{key:"update",value:function update(e,t){TrapdoorPlayer_get(TrapdoorPlayer_getPrototypeOf(TrapdoorPlayer.prototype),"update",this).call(this,e,t),this.state==TrapdoorPlayer.State.Active&&(this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.feetBody.x=this.body.x,this.feetBody.y=this.body.y+30*this.scene.gameScale,this.velocityMagnitude=Phaser.Math.Distance.Between(0,0,this.body.body.velocity.x,this.body.body.velocity.y))}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){TrapdoorPlayer_get(TrapdoorPlayer_getPrototypeOf(TrapdoorPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&this.state==TrapdoorPlayer.State.Active&&(0==this.playerInput.moveVector.x&&0==this.playerInput.moveVector.y||(this.force.set(this.playerInput.moveVector.x*this.playerForceAmount,this.playerInput.moveVector.y*this.playerForceAmount),this.body.applyForce(this.force)),(0!=this.playerInput.touchDirection.x||0!=this.playerInput.touchDirection.y)&&this.playerInput.touchDistance>this.minDragTouchDistance&&(this.force.set(this.playerInput.touchDirection.x*this.playerForceAmount,this.playerInput.touchDirection.y*this.playerForceAmount),this.body.applyForce(this.force)))}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){TrapdoorPlayer_get(TrapdoorPlayer_getPrototypeOf(TrapdoorPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state==F.State.Game&&this.state==TrapdoorPlayer.State.Active&&(0==this.playerAI.moveVector.x&&0==this.playerAI.moveVector.y||(this.force.set(this.playerAI.moveVector.x*this.playerForceAmount,this.playerAI.moveVector.y*this.playerForceAmount),this.body.applyForce(this.force)))}},{key:"SetState",value:function SetState(e){switch(this.state=e,this.state){case TrapdoorPlayer.State.Falling:this.OnEnterFallingState()}}},{key:"OnEnterFallingState",value:function OnEnterFallingState(){this.animation.SetState(dt.State.Falling),h.Instance.Play("sfx_minigame","trapdoor_player_fall")}},{key:"Respawn",value:function Respawn(){if(!(this.scene.state>F.State.Game)){switch(this.setScale(1),1<this.scene.playerCount&&this.playerNumber==M.PlayerNumber.ONE||1==this.scene.playerCount&&this.playerNumber==M.PlayerNumber.TWO){case!0:this.setPosition(.5*this.scene.scale.width+220*this.scene.gameScale,.5*this.scene.scale.height);break;case!1:this.setPosition(.5*this.scene.scale.width-220*this.scene.gameScale,.5*this.scene.scale.height)}this.body.setPosition(this.x,this.y),this.SetState(TrapdoorPlayer.State.Active),this.animation.SetState(dt.State.Idle)}}},{key:"OnMinigameWon",value:function OnMinigameWon(){TrapdoorPlayer_get(TrapdoorPlayer_getPrototypeOf(TrapdoorPlayer.prototype),"OnMinigameWon",this).call(this),this.animation.SetState(dt.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){TrapdoorPlayer_get(TrapdoorPlayer_getPrototypeOf(TrapdoorPlayer.prototype),"OnMinigameLost",this).call(this),this.animation.SetState(dt.State.Lose)}},{key:"OnTrapdoorSpaceCollision",value:function OnTrapdoorSpaceCollision(e){this.state==TrapdoorPlayer.State.Active&&(this.scene.time.delayedCall(1,this.scene.CheckDeaths,null,this.scene),this.SetState(TrapdoorPlayer.State.Falling),this.scene.tweens.add({targets:this,scaleX:{value:0,duration:750,ease:"Linear"},scaleY:{value:0,duration:750,ease:"Linear"},x:{value:e.gameObjectA.x,duration:750,ease:"Linear"},y:{value:e.gameObjectA.y,duration:750,ease:"Linear"},hold:1e3,onComplete:this.Respawn,onCompleteScope:this}))}},{key:"OnTrapdoorMachinePatternStart",value:function OnTrapdoorMachinePatternStart(){this.playerAI&&this.playerAI.OnTrapdoorMachinePatternStart()}},{key:"destroy",value:function destroy(){TrapdoorPlayer_get(TrapdoorPlayer_getPrototypeOf(TrapdoorPlayer.prototype),"destroy",this).call(this)}}]),TrapdoorPlayer}();function TrapdoorTrapdoor_typeof(e){return(TrapdoorTrapdoor_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorTrapdoor_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorTrapdoor_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TrapdoorTrapdoor_get(e,t,n){return(TrapdoorTrapdoor_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TrapdoorTrapdoor_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TrapdoorTrapdoor_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TrapdoorTrapdoor_getPrototypeOf(e){return(TrapdoorTrapdoor_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorTrapdoor_setPrototypeOf(e,t){return(TrapdoorTrapdoor_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function TrapdoorPlayer_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(gt,"State",Object.freeze({Active:0,Falling:1}));var mt=function(){function TrapdoorTrapdoor(e,t,n){var r;return function TrapdoorTrapdoor_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorTrapdoor),(r=function TrapdoorTrapdoor_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorTrapdoor_typeof(t)&&"function"!=typeof t?TrapdoorTrapdoor_assertThisInitialized(e):t}(this,TrapdoorTrapdoor_getPrototypeOf(TrapdoorTrapdoor).call(this,e,t,n))).spine=r.scene.add.spine(0,0,"trapdoor","idle_closed"),r.spine.setScale(r.scene.gameScale),r.add(r.spine),r.body=r.scene.matter.add.image(.5*r.scene.scale.width+r.x,.5*r.scene.scale.height+r.y,void 0,void 0,{shape:{type:"rectangle",width:211*r.scene.gameScale,height:206*r.scene.gameScale}}),r.body.setIgnoreGravity(!0),r.body.setFixedRotation(),r.body.setCollidesWith(0),r.body.setSensor(!0),r.body.gameObject=TrapdoorTrapdoor_assertThisInitialized(r),r.add(r.body),r.previousTrapdoor=null,r.nextTrapdoor=null,r.inDanger=!1,r.isOpen=!1,r.stayOpen=!1,r}return function TrapdoorTrapdoor_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorTrapdoor_setPrototypeOf(e,t)}(TrapdoorTrapdoor,Phaser.GameObjects.Container),function TrapdoorTrapdoor_createClass(e,t,n){return t&&TrapdoorTrapdoor_defineProperties(e.prototype,t),n&&TrapdoorTrapdoor_defineProperties(e,n),e}(TrapdoorTrapdoor,[{key:"update",value:function update(e,t){TrapdoorTrapdoor_get(TrapdoorTrapdoor_getPrototypeOf(TrapdoorTrapdoor.prototype),"update",this).call(this,e,t)}},{key:"AddConnectingTrapdoors",value:function AddConnectingTrapdoors(e,t){this.previousTrapdoor=e,this.nextTrapdoor=t}},{key:"Open",value:function Open(e){this.stayOpen=e,this.isOpen||(this.spine.setAnimation(0,"animation",!1),this.body.setCollidesWith(-1),this.isOpen=!0)}},{key:"OnBothPlayersFall",value:function OnBothPlayersFall(){this.stayOpen=!1}},{key:"Close",value:function Close(){this.isOpen&&(this.stayOpen?this.stayOpen=!1:(this.isOpen=!1,this.body.setCollidesWith(0),this.spine.setAnimation(0,"idle_closed",!1)))}},{key:"destroy",value:function destroy(){TrapdoorTrapdoor_get(TrapdoorTrapdoor_getPrototypeOf(TrapdoorTrapdoor.prototype),"destroy",this).call(this)}}]),TrapdoorTrapdoor}();function TrapdoorSelector_typeof(e){return(TrapdoorSelector_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorSelector_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorSelector_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorSelector_typeof(t)&&"function"!=typeof t?function TrapdoorSelector_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TrapdoorSelector_get(e,t,n){return(TrapdoorSelector_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TrapdoorSelector_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TrapdoorSelector_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TrapdoorSelector_getPrototypeOf(e){return(TrapdoorSelector_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorSelector_setPrototypeOf(e,t){return(TrapdoorSelector_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var _t=function(){function TrapdoorSelector(e){var t;return function TrapdoorSelector_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorSelector),(t=TrapdoorSelector_possibleConstructorReturn(this,TrapdoorSelector_getPrototypeOf(TrapdoorSelector).call(this,e))).sprite=t.scene.add.sprite(0,0,"trapdoor_minigame_atlas","trapdoor_door_highlight.png"),t.add(t.sprite),t.currentTrapdoor=null,t.visible=!1,t.moveTimer=0,t.moveSpeed=10,t.moveDirection=1,t.trapdoorsMovedOver=0,t.playChangeTargetSounds=!1,t}return function TrapdoorSelector_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorSelector_setPrototypeOf(e,t)}(TrapdoorSelector,Phaser.GameObjects.Container),function TrapdoorSelector_createClass(e,t,n){return t&&TrapdoorSelector_defineProperties(e.prototype,t),n&&TrapdoorSelector_defineProperties(e,n),e}(TrapdoorSelector,[{key:"update",value:function update(e,t){TrapdoorSelector_get(TrapdoorSelector_getPrototypeOf(TrapdoorSelector.prototype),"update",this).call(this,e,t),this.visible&&0<this.moveTimer&&(this.moveTimer-=.001*t*this.moveSpeed,this.moveTimer<=0&&this.MoveToNextTrapdoor())}},{key:"Show",value:function Show(e,t,n){this.visible=!0,this.trapdoorsMovedOver=0,this.moveDirection=n,this.sprite.alpha=1,this.moveSpeed=t,this.currentTrapdoor=e,this.x=e.x,this.y=e.y,this.moveTimer=1,this.playChangeTargetSounds&&h.Instance.Play("sfx_minigame","trapdoor_change_targets")}},{key:"MoveToNextTrapdoor",value:function MoveToNextTrapdoor(){switch(this.moveDirection){case 1:this.currentTrapdoor=this.currentTrapdoor.nextTrapdoor;break;case-1:this.currentTrapdoor=this.currentTrapdoor.previousTrapdoor}this.playChangeTargetSounds&&h.Instance.Play("sfx_minigame","trapdoor_change_targets"),this.trapdoorsMovedOver++,this.x=this.currentTrapdoor.x,this.y=this.currentTrapdoor.y,this.moveTimer+=1}},{key:"OnSelectionComplete",value:function OnSelectionComplete(e){this.currentTrapdoor.Open(e),this.scene.tweens.add({targets:this.sprite,alpha:{value:0,duration:750,ease:"Linear"},onComplete:this.OnHideComplete,onCompleteScope:this})}},{key:"OnHideComplete",value:function OnHideComplete(){this.visible=!1}},{key:"destroy",value:function destroy(){TrapdoorSelector_get(TrapdoorSelector_getPrototypeOf(TrapdoorSelector.prototype),"destroy",this).call(this)}}]),TrapdoorSelector}();function TrapdoorMachine_typeof(e){return(TrapdoorMachine_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorMachine_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorMachine_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TrapdoorMachine_get(e,t,n){return(TrapdoorMachine_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TrapdoorMachine_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TrapdoorMachine_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TrapdoorMachine_getPrototypeOf(e){return(TrapdoorMachine_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorMachine_setPrototypeOf(e,t){return(TrapdoorMachine_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Pt=function(){function TrapdoorMachine(e){var t;!function TrapdoorMachine_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorMachine),(t=function TrapdoorMachine_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorMachine_typeof(t)&&"function"!=typeof t?TrapdoorMachine_assertThisInitialized(e):t}(this,TrapdoorMachine_getPrototypeOf(TrapdoorMachine).call(this,e))).setPosition(.5*t.scene.scale.width,.5*t.scene.scale.height),t.trapdoors=[],t.trapdoorSelectors=[];for(var n=0;n<9;n++)if(4!=n){var r=n%3,o=Math.floor(n/3),i=new mt(t.scene,(215*r-215)*t.scene.gameScale,(210*o-210)*t.scene.gameScale);t.trapdoors.push(i),t.add(i)}t.trapdoors[0].AddConnectingTrapdoors(t.trapdoors[3],t.trapdoors[1]),t.trapdoors[1].AddConnectingTrapdoors(t.trapdoors[0],t.trapdoors[2]),t.trapdoors[2].AddConnectingTrapdoors(t.trapdoors[1],t.trapdoors[4]),t.trapdoors[3].AddConnectingTrapdoors(t.trapdoors[5],t.trapdoors[0]),t.trapdoors[4].AddConnectingTrapdoors(t.trapdoors[2],t.trapdoors[7]),t.trapdoors[5].AddConnectingTrapdoors(t.trapdoors[6],t.trapdoors[3]),t.trapdoors[6].AddConnectingTrapdoors(t.trapdoors[7],t.trapdoors[5]),t.trapdoors[7].AddConnectingTrapdoors(t.trapdoors[4],t.trapdoors[6]);for(n=0;n<7;n++){var a=new _t(t.scene);t.trapdoorSelectors.push(a),t.add(a)}t.trapdoorSelectors[0].playChangeTargetSounds=!0,t.centreSprite=t.scene.add.sprite(0,0,"trapdoor_minigame_atlas","trapdoor_centre.png"),t.add(t.centreSprite),t.centreHighlight=t.scene.add.sprite(-45*t.scene.gameScale,-55*t.scene.gameScale,"trapdoor_minigame_atlas","trapdoor_centre_shine.png"),t.add(t.centreHighlight),t.centreBody=t.scene.matter.add.image(.5*t.scene.scale.width,345*t.scene.gameScale,void 0,void 0,{shape:{type:"rectangle",width:200*t.scene.gameScale,height:170*t.scene.gameScale}}),t.centreBody.setIgnoreGravity(!0),t.centreBody.setStatic(!0),t.centreBody.setFixedRotation(),t.centreBody.setFriction(0,.5),t.centreBody.gameObject=TrapdoorMachine_assertThisInitialized(t),t.add(t.centreBody),t.newPatternTimer=0,t.patternDifficulties=[TrapdoorMachine.Patterns.VeryEasy,TrapdoorMachine.Patterns.Easy,TrapdoorMachine.Patterns.Medium,TrapdoorMachine.Patterns.Hard],t.patternDifficultyIndex=0,t.patternDifficulty=t.patternDifficulties[t.patternDifficultyIndex],t.increaseDifficultyAfterPatternCount=3,t.patternCountOnCurrentDifficulty=0,t.selectorDirection=1,t.selectorSpeed=0,t.selectorCount=0,t.selectorActive=!1,t.patternTimer=0;for(n=t.closeTimer=0;n<t.trapdoors.length;n++)3!=n&&4!=n&&t.trapdoors[n].Open();return t}return function TrapdoorMachine_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorMachine_setPrototypeOf(e,t)}(TrapdoorMachine,Phaser.GameObjects.Container),function TrapdoorMachine_createClass(e,t,n){return t&&TrapdoorMachine_defineProperties(e.prototype,t),n&&TrapdoorMachine_defineProperties(e,n),e}(TrapdoorMachine,[{key:"update",value:function update(e,t){if(TrapdoorMachine_get(TrapdoorMachine_getPrototypeOf(TrapdoorMachine.prototype),"update",this).call(this,e,t),this.centreSprite.angle=(this.centreSprite.angle+this.selectorSpeed*this.selectorDirection*.05*t)%360,this.scene.state==F.State.Game){0<this.newPatternTimer&&(this.newPatternTimer-=.001*t,this.newPatternTimer<=0&&this.StartPattern()),0<this.patternTimer&&(this.patternTimer-=.001*t),0<this.closeTimer&&(this.closeTimer-=.001*t,this.closeTimer<=0&&this.CloseTrapdoors());for(var n=0;n<this.trapdoors.length;n++)this.trapdoors[n].update(e,t);for(n=0;n<this.trapdoorSelectors.length;n++)this.trapdoorSelectors[n].update(e,t)}}},{key:"StartPattern",value:function StartPattern(){this.patternDifficultyIndex<this.patternDifficulties.length-1&&this.patternCountOnCurrentDifficulty>=this.increaseDifficultyAfterPatternCount&&(this.patternDifficultyIndex++,this.patternDifficulty=this.patternDifficulties[this.patternDifficultyIndex],this.patternCountOnCurrentDifficulty=0);var e=this.patternDifficulty[Phaser.Math.RND.integerInRange(0,this.patternDifficulty.length-1)];this.selectorCount=e.selectorCount;var t=e.selectorSpacing,n=e.startSpeed,r=this.trapdoors[Phaser.Math.RND.integerInRange(0,this.trapdoors.length-1)];this.selectorDirection=Phaser.Math.RND.pick([-1,1]),h.Instance.Play("sfx_minigame","trapdoor_new_round");for(var o=0;o<this.trapdoors.length;o++)this.trapdoors[o].inDanger=!1;for(o=0;o<this.selectorCount;o++){this.trapdoorSelectors[o].Show(r,n,this.selectorDirection);for(var i=2/(1/n),a=6/(1/Phaser.Math.Linear(n,.2,.5)),s=Math.round(i+a),l=r,c=0;c<s;c++)l=0<this.selectorDirection?l.nextTrapdoor:l.previousTrapdoor;l.inDanger=!0;for(c=0;c<t;c++)r=r.nextTrapdoor}this.selectorSpeed=n,this.scene.tweens.add({targets:this,selectorSpeed:{value:.25,duration:6e3,delay:2e3,ease:"Linear"},onUpdate:this.OnSelectorPatternTweenUpdate,onUpdateScope:this,onComplete:this.OnSelectorPatternTweenComplete,onCompleteScope:this}),this.patternTimer=8,this.newPatternTimer=10.5,this.patternCountOnCurrentDifficulty++,this.selectorActive=!0,this.emit("patternStart")}},{key:"CloseTrapdoors",value:function CloseTrapdoors(){for(var e=0;e<this.trapdoors.length;e++)this.trapdoors[e].Close()}},{key:"OnSelectorPatternTweenUpdate",value:function OnSelectorPatternTweenUpdate(){if(this.scene.state==F.State.Game)for(var e=0;e<this.trapdoorSelectors.length;e++)this.trapdoorSelectors[e].moveSpeed=this.selectorSpeed}},{key:"OnSelectorPatternTweenComplete",value:function OnSelectorPatternTweenComplete(){if(this.scene.state==F.State.Game){this.selectorSpeed=0,this.selectorActive=!1;var e=Phaser.Math.RND.integerInRange(0,this.selectorCount-1);this.closeTimer=1;for(var t=0;t<this.trapdoorSelectors.length;t++)this.trapdoorSelectors[t].visible&&(this.trapdoorSelectors[t].moveSpeed=this.selectorSpeed,this.trapdoorSelectors[t].OnSelectionComplete(t==e));h.Instance.Play("sfx_minigame","trapdoor_open")}}},{key:"OnBothPlayersFall",value:function OnBothPlayersFall(){for(var e=0;e<this.trapdoors.length;e++)this.trapdoors[e].OnBothPlayersFall()}},{key:"destroy",value:function destroy(){TrapdoorMachine_get(TrapdoorMachine_getPrototypeOf(TrapdoorMachine.prototype),"destroy",this).call(this)}}]),TrapdoorMachine}();function TrapdoorBackgroundConveyor_typeof(e){return(TrapdoorBackgroundConveyor_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorBackgroundConveyor_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorBackgroundConveyor_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorBackgroundConveyor_typeof(t)&&"function"!=typeof t?function TrapdoorBackgroundConveyor_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TrapdoorBackgroundConveyor_getPrototypeOf(e){return(TrapdoorBackgroundConveyor_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorBackgroundConveyor_setPrototypeOf(e,t){return(TrapdoorBackgroundConveyor_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function TrapdoorMachine_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Pt,"Patterns",Object.freeze({VeryEasy:[{selectorCount:1,selectorSpacing:1,startSpeed:6},{selectorCount:2,selectorSpacing:1,startSpeed:6}],Easy:[{selectorCount:3,selectorSpacing:1,startSpeed:7},{selectorCount:2,selectorSpacing:4,startSpeed:6},{selectorCount:4,selectorSpacing:1,startSpeed:6.5}],Medium:[{selectorCount:3,selectorSpacing:1,startSpeed:7.5},{selectorCount:4,selectorSpacing:1,startSpeed:7.5},{selectorCount:3,selectorSpacing:2,startSpeed:6.5}],Hard:[{selectorCount:3,selectorSpacing:2,startSpeed:7.5},{selectorCount:5,selectorSpacing:1,startSpeed:7.5},{selectorCount:4,selectorSpacing:1,startSpeed:7.5},{selectorCount:5,selectorSpacing:1,startSpeed:7.5}]}));var bt=function(){function TrapdoorBackgroundConveyor(e,t){var n;!function TrapdoorBackgroundConveyor_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorBackgroundConveyor),(n=TrapdoorBackgroundConveyor_possibleConstructorReturn(this,TrapdoorBackgroundConveyor_getPrototypeOf(TrapdoorBackgroundConveyor).call(this,e))).conveyorBeltSprite=n.scene.add.tileSprite(0,0,162*n.scene.gameScale,825*n.scene.gameScale,"trapdoor_minigame_atlas","trapdoor_conveyor.png"),n.conveyorBeltSprite.setOrigin(.5),n.add(n.conveyorBeltSprite),n.boxes=[];for(var r=0;r<4;r++){var o=n.scene.add.sprite(0,(Phaser.Math.RND.integerInRange(175,225)*r-200)*n.scene.gameScale,"trapdoor_minigame_atlas","trapdoor_conveyor_box_"+Phaser.Math.RND.integerInRange(1,3)+".png");n.add(o),n.boxes.push(o)}return n.mouthTop=n.scene.add.sprite(0,.5*-n.scene.scale.height,"trapdoor_minigame_atlas","trapdoor_conveyor_mouth.png"),n.mouthTop.setOrigin(.5,0),n.add(n.mouthTop),n.mouthBottom=n.scene.add.sprite(0,.5*n.scene.scale.height,"trapdoor_minigame_atlas","trapdoor_conveyor_mouth.png"),n.mouthBottom.setOrigin(.5,1),n.add(n.mouthBottom),n.direction=t,n.conveyorSpeed=100*t,n}return function TrapdoorBackgroundConveyor_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorBackgroundConveyor_setPrototypeOf(e,t)}(TrapdoorBackgroundConveyor,Phaser.GameObjects.Container),function TrapdoorBackgroundConveyor_createClass(e,t,n){return t&&TrapdoorBackgroundConveyor_defineProperties(e.prototype,t),n&&TrapdoorBackgroundConveyor_defineProperties(e,n),e}(TrapdoorBackgroundConveyor,[{key:"update",value:function update(e,t){this.conveyorBeltSprite.setTilePosition(0,this.conveyorBeltSprite.tilePositionY-this.conveyorSpeed*t*.001);for(var n=0;n<this.boxes.length;n++)this.boxes[n].y+=this.conveyorSpeed*t*.001,1==this.direction&&this.boxes[n].y>.6*this.scene.scale.height?(this.boxes[n].y-=1.2*this.scene.scale.height,this.boxes[n].setFrame("trapdoor_conveyor_box_"+Phaser.Math.RND.integerInRange(1,3)+".png")):-1==this.direction&&this.boxes[n].y<.6*-this.scene.scale.height&&(this.boxes[n].y+=1.2*this.scene.scale.height,this.boxes[n].setFrame("trapdoor_conveyor_box_"+Phaser.Math.RND.integerInRange(1,3)+".png"))}}]),TrapdoorBackgroundConveyor}();function TrapdoorBackground_typeof(e){return(TrapdoorBackground_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorBackground_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorBackground_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorBackground_typeof(t)&&"function"!=typeof t?function TrapdoorBackground_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TrapdoorBackground_getPrototypeOf(e){return(TrapdoorBackground_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorBackground_setPrototypeOf(e,t){return(TrapdoorBackground_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var St=function(){function TrapdoorBackground(e){var t;!function TrapdoorBackground_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorBackground),(t=TrapdoorBackground_possibleConstructorReturn(this,TrapdoorBackground_getPrototypeOf(TrapdoorBackground).call(this,e))).setPosition(.5*t.scene.scale.width,.5*t.scene.scale.height),t.backgroundSprite=t.scene.add.sprite(0,0,"trapdoor_background"),t.add(t.backgroundSprite),t.conveyors=[];for(var n=0;n<4;n++){var r=n%2==0?1:-1,o=new bt(t.scene,r);n<2?o.setPosition((200*n-700)*t.scene.gameScale,0):o.setPosition((700-200*(n-2))*t.scene.gameScale,0),t.conveyors.push(o),t.add(o)}return t}return function TrapdoorBackground_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorBackground_setPrototypeOf(e,t)}(TrapdoorBackground,Phaser.GameObjects.Container),function TrapdoorBackground_createClass(e,t,n){return t&&TrapdoorBackground_defineProperties(e.prototype,t),n&&TrapdoorBackground_defineProperties(e,n),e}(TrapdoorBackground,[{key:"update",value:function update(e,t){for(var n=0;n<this.conveyors.length;n++)this.conveyors[n].update(e,t)}}]),TrapdoorBackground}();function TrapdoorTutorialPopup_typeof(e){return(TrapdoorTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorTutorialPopup_typeof(t)&&"function"!=typeof t?function TrapdoorTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TrapdoorTutorialPopup_getPrototypeOf(e){return(TrapdoorTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorTutorialPopup_setPrototypeOf(e,t){return(TrapdoorTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ot=function(){function TrapdoorTutorialPopup(e){var t;return function TrapdoorTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorTutorialPopup),(t=TrapdoorTutorialPopup_possibleConstructorReturn(this,TrapdoorTutorialPopup_getPrototypeOf(TrapdoorTutorialPopup).call(this,e))).panel.setTexture("trapdoor_minigame_atlas","how_to_trapdoor.png"),t}return function TrapdoorTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorTutorialPopup_setPrototypeOf(e,t)}(TrapdoorTutorialPopup,R),TrapdoorTutorialPopup}();function TrapdoorMinigame_typeof(e){return(TrapdoorMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TrapdoorMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TrapdoorMinigame_possibleConstructorReturn(e,t){return!t||"object"!==TrapdoorMinigame_typeof(t)&&"function"!=typeof t?function TrapdoorMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TrapdoorMinigame_get(e,t,n){return(TrapdoorMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TrapdoorMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TrapdoorMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TrapdoorMinigame_getPrototypeOf(e){return(TrapdoorMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TrapdoorMinigame_setPrototypeOf(e,t){return(TrapdoorMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var vt=function(){function TrapdoorMinigame(){return function TrapdoorMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TrapdoorMinigame),TrapdoorMinigame_possibleConstructorReturn(this,TrapdoorMinigame_getPrototypeOf(TrapdoorMinigame).call(this,"TrapdoorMinigame"))}return function TrapdoorMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TrapdoorMinigame_setPrototypeOf(e,t)}(TrapdoorMinigame,F),function TrapdoorMinigame_createClass(e,t,n){return t&&TrapdoorMinigame_defineProperties(e.prototype,t),n&&TrapdoorMinigame_defineProperties(e,n),e}(TrapdoorMinigame,[{key:"create",value:function create(){TrapdoorMinigame_get(TrapdoorMinigame_getPrototypeOf(TrapdoorMinigame.prototype),"create",this).call(this);for(var e=0;e<this.players.length;e++)for(var t=0;t<this.trapdoorMachine.trapdoors.length;t++)this.matterCollision.addOnCollideStart({objectA:this.trapdoorMachine.trapdoors[t].body,objectB:this.players[e].feetBody,callback:this.players[e].OnTrapdoorSpaceCollision,context:this.players[e]});h.Instance.AddLayer("sfx_minigame",{audioKeys:["trapdoor_start","trapdoor_change_targets","trapdoor_open","trapdoor_player_fall","trapdoor_new_round"]}),h.Instance.AddLayer("music_minigame",{audioKeys:["music_factory"]}),h.Instance.Play("music_minigame","music_factory"),this.testCloseTimer=0}},{key:"CreateMinigameUI",value:function CreateMinigameUI(){return new ht(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new Ot(this)}},{key:"CreateWorld",value:function CreateWorld(){TrapdoorMinigame_get(TrapdoorMinigame_getPrototypeOf(TrapdoorMinigame.prototype),"CreateWorld",this).call(this),this.matter.world.setBounds(.5*this.scale.width-320*this.gameScale,15*this.gameScale,640*this.gameScale,655*this.gameScale,32,!0,!0,!1,!0),this.playerCollisionCategory=this.matter.world.nextCategory(),this.matter.world.engine.world.gravity.y=0,this.background=new St(this),this.world.add(this.background),this.trapdoorMachine=new Pt(this),this.trapdoorMachine.on("patternStart",this.OnTrapdoorMachinePatternStart,this),this.world.add(this.trapdoorMachine),this.depthWorld=this.add.container(),this.world.add(this.depthWorld);for(var e=0;e<2;e++){var t=new gt(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(t),this.depthWorld.add(t)}this.world.add(this.matter.world.debugGraphic)}},{key:"update",value:function update(e,t){TrapdoorMinigame_get(TrapdoorMinigame_getPrototypeOf(TrapdoorMinigame.prototype),"update",this).call(this,e,t),this.depthWorld.sort("y"),this.background.update(e,t),this.trapdoorMachine.update(e,t)}},{key:"UpdatePreGameState",value:function UpdatePreGameState(e,t){TrapdoorMinigame_get(TrapdoorMinigame_getPrototypeOf(TrapdoorMinigame.prototype),"UpdatePreGameState",this).call(this,e,t),0<this.testCloseTimer&&(this.testCloseTimer-=.001*t,this.testCloseTimer<=0&&this.trapdoorMachine.CloseTrapdoors())}},{key:"CheckDeaths",value:function CheckDeaths(){if(this.state==F.State.Game){for(var e=0,t=0;t<this.players.length;t++)this.players[t].state==gt.State.Falling&&e++;1==e?this.EndGame():this.trapdoorMachine.OnBothPlayersFall()}}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=this.players[0],t=0;t<this.players.length;t++)this.players[t].state!=gt.State.Falling&&(e=this.players[t]);return e}},{key:"OnTrapdoorMachinePatternStart",value:function OnTrapdoorMachinePatternStart(){for(var e=0;e<this.players.length;e++)this.players[e].OnTrapdoorMachinePatternStart()}},{key:"OnEnterPreGameState",value:function OnEnterPreGameState(){TrapdoorMinigame_get(TrapdoorMinigame_getPrototypeOf(TrapdoorMinigame.prototype),"OnEnterPreGameState",this).call(this),this.testCloseTimer=1.5}},{key:"OnEnterGameState",value:function OnEnterGameState(){TrapdoorMinigame_get(TrapdoorMinigame_getPrototypeOf(TrapdoorMinigame.prototype),"OnEnterGameState",this).call(this),this.trapdoorMachine.StartPattern(),h.Instance.Play("sfx_minigame","trapdoor_start")}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){TrapdoorMinigame_get(TrapdoorMinigame_getPrototypeOf(TrapdoorMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){TrapdoorMinigame_get(TrapdoorMinigame_getPrototypeOf(TrapdoorMinigame.prototype),"OnEnterPostGameState",this).call(this)}}]),TrapdoorMinigame}();function BoardCamera_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var wt=function(){function Board(e){!function BoardCamera_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Board),this.scene=e,this.camera=this.scene.cameras.add(0,0,this.scene.scale.width,this.scene.scale.height),this.camera.ignore(this.scene.ui),this.camera.ignore(this.scene.dom);var t=this.scene.cameras.cameras,n=t.indexOf(this.camera);t.splice(n,1),t.unshift(this.camera),this.minZoom=.9,this.maxZoom=.9,this.camera.setZoom(this.maxZoom)}return function BoardCamera_createClass(e,t,n){return t&&BoardCamera_defineProperties(e.prototype,t),n&&BoardCamera_defineProperties(e,n),e}(Board,[{key:"update",value:function update(){}},{key:"SetPosition",value:function SetPosition(e,t){this.camera.centerOn(e,t)}},{key:"TweenPosition",value:function TweenPosition(e,t,n,r){var o=Phaser.Math.Distance.Between(this.camera.midPoint.x,this.camera.midPoint.y,e,t),i=Math.min(500+3*o,2500),a=1750<i;if(this.camera.pan(e,t,i,Phaser.Math.Easing.Sine.InOut),this.camera.once(Phaser.Cameras.Scene2D.Events.PAN_COMPLETE,n,r),a){var s=this.scene.tweens.createTimeline();s.add({targets:this.camera,zoom:{value:this.minZoom,duration:.5*i,ease:"Sine.easeOut"}}),s.add({targets:this.camera,zoom:{value:this.maxZoom,duration:.5*i,ease:"Sine.easeIn"}}),s.play()}}},{key:"IsZooming",value:function IsZooming(){return this.doZoom}}]),Board}();function BoardPlayerAI_typeof(e){return(BoardPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==BoardPlayerAI_typeof(t)&&"function"!=typeof t?function BoardPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BoardPlayerAI_getPrototypeOf(e){return(BoardPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardPlayerAI_setPrototypeOf(e,t){return(BoardPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Tt=function(){function BoardPlayerAI(e,t){var n;return function BoardPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardPlayerAI),(n=BoardPlayerAI_possibleConstructorReturn(this,BoardPlayerAI_getPrototypeOf(BoardPlayerAI).call(this))).scene=e,n.player=t,n.difficulty=A.Difficulty[n.scene.sys.settings.data.gameData.aiDifficulty],n.state=It.State.Idle,n.timer=0,n.duration=1,n}return function BoardPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardPlayerAI_setPrototypeOf(e,t)}(BoardPlayerAI,Phaser.Events.EventEmitter),function BoardPlayerAI_createClass(e,t,n){return t&&BoardPlayerAI_defineProperties(e.prototype,t),n&&BoardPlayerAI_defineProperties(e,n),e}(BoardPlayerAI,[{key:"update",value:function update(e,t){var n=.001*t;switch(this.state){case It.State.Roll:this.UpdateRoll(n);break;case It.State.Branch:this.UpdateBranch(n)}}},{key:"UpdateRoll",value:function UpdateRoll(e){this.timer+=e,this.timer>=this.duration&&(this.SetState(It.State.Idle),this.emit("rollInput"))}},{key:"UpdateBranch",value:function UpdateBranch(e){if(this.timer+=e,this.timer>=this.duration){this.SetState(It.State.Idle);var t=this.GetFastestBranch();this.emit("branchInput",t)}}},{key:"GetFastestBranch",value:function GetFastestBranch(){var e=Phaser.Math.Between(0,1),t=this.GetPathToTrophy(this.player.tile);if(t)for(var n=0;n<this.player.tile.paths.length;n++)t[1]!=this.player.tile.paths[n].tileId||(e=n);return e}},{key:"GetPathToTrophy",value:function GetPathToTrophy(e){for(var t=this.scene.board.trophy.prevTileId,n=[{route:[],currentTileId:e.tileId}],r=[],o=0;o<n.length;o++){var i=!0;do{n[o].route.push(n[o].currentTileId);var a=this.scene.board.tileLookup[n[o].currentTileId];if(1<a.paths.length){for(var s=1;s<a.paths.length;s++){for(var l={route:[],currentTileId:a.paths[s].tileId},c=0;c<n[o].route.length;c++)l.route.push(n[o].route[c]);n.length<15&&n.push(l)}n[o].currentTileId=a.paths[0].tileId}else n[o].currentTileId=a.paths[0].tileId;if(n[o].currentTileId==t)r.push(n[o].route),i=!1;else for(c=0;c<n[o].route.length;c++)n[o].route[c]==n[o].currentTileId&&(i=!1)}while(i)}var u=0,p=9999;for(s=0;s<r.length;s++)r[s].length<p&&(p=r[u=s].length);return r[u]}},{key:"SetState",value:function SetState(e){this.state=e,this.timer=0}}]),BoardPlayerAI}();function BoardPlayerAnimation_typeof(e){return(BoardPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardPlayerAnimation_getPrototypeOf(e){return(BoardPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardPlayerAnimation_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardPlayerAnimation_setPrototypeOf(e,t){return(BoardPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ct=function(){function BoardPlayerAnimation(e,t){var n;return function BoardPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardPlayerAnimation),(n=function BoardPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==BoardPlayerAnimation_typeof(t)&&"function"!=typeof t?BoardPlayerAnimation_assertThisInitialized(e):t}(this,BoardPlayerAnimation_getPrototypeOf(BoardPlayerAnimation).call(this,e,t))).spine.on("spine.complete",n.OnAnimationComplete,BoardPlayerAnimation_assertThisInitialized(n)),n.spine.on("spine.event",n.OnSpineEvent,BoardPlayerAnimation_assertThisInitialized(n)),n.SetState(BoardPlayerAnimation.State.Idle),n}return function BoardPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardPlayerAnimation_setPrototypeOf(e,t)}(BoardPlayerAnimation,B),function BoardPlayerAnimation_createClass(e,t,n){return t&&BoardPlayerAnimation_defineProperties(e.prototype,t),n&&BoardPlayerAnimation_defineProperties(e,n),e}(BoardPlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id,"idle",!0);return I.ApplyWinterSkin(e),e}},{key:"OnAnimationComplete",value:function OnAnimationComplete(){switch(this.state){case BoardPlayerAnimation.State.BuyTrophy:case BoardPlayerAnimation.State.CantBuyTrophy:this.SetState(BoardPlayerAnimation.State.Idle)}}},{key:"OnSpineEvent",value:function OnSpineEvent(e,t){switch(t.data.name){case"OnFootstep":h.Instance.Play("sfx_boardgame","board_player_footstep_0"+Phaser.Math.RND.integerInRange(1,6))}}},{key:"LoadData",value:function LoadData(e){e&&this.SetFlipX(e.flipX)}},{key:"SaveData",value:function SaveData(){return{flipX:this.flipX}}}]),BoardPlayerAnimation}();function BoardPlayer_typeof(e){return(BoardPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardPlayer_get(e,t,n){return(BoardPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BoardPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BoardPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BoardPlayer_getPrototypeOf(e){return(BoardPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardPlayer_setPrototypeOf(e,t){return(BoardPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function BoardPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Ct,"State",Object.freeze({Idle:{animationName:"idle",loop:!0},Walk:{animationName:"hurdles_run",loop:!0},Freeze:{animationName:"board_freeze",loop:!1},Frozen:{animationName:"board_freeze_loop",loop:!0},FreezeBreak:{animationName:"board_freeze_break",loop:!1},BuyTrophy:{animationName:"board_trophy_buy",loop:!1},CantBuyTrophy:{animationName:"board_trophy_fail",loop:!1},TeleportDisappear:{animationName:"teleport_disappear",loop:!1},TeleportAppear:{animationName:"teleport_appear",loop:!1}}));var It=function(){function BoardPlayer(e,t,n){var r;return function BoardPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardPlayer),r=function BoardPlayer_possibleConstructorReturn(e,t){return!t||"object"!==BoardPlayer_typeof(t)&&"function"!=typeof t?BoardPlayer_assertThisInitialized(e):t}(this,BoardPlayer_getPrototypeOf(BoardPlayer).call(this,e,n)),I.AddChild(BoardPlayer_assertThisInitialized(r),t),r.controller==M.Controller.AI&&(r.playerAI=new Tt(r.scene,BoardPlayer_assertThisInitialized(r)),r.playerAI.on("rollInput",r.OnRollInput,BoardPlayer_assertThisInitialized(r)),r.playerAI.on("branchInput",r.OnBranchInput,BoardPlayer_assertThisInitialized(r))),r.offset=new Phaser.Math.Vector2((r.playerNumber?0:-24)*r.scene.gameScale,(r.playerNumber?-20:12)*r.scene.gameScale),r.playerUI=n.playerUI,r.tile=null,r.nextIndex=0,r.nextTile=null,r.isFrozen=!1,r.turnsFrozen=0,r.state=BoardPlayer.State.Idle,r.moveDuration=.75,r.moveTween=null,r.previousMoveTweenProgress=0,r}return function BoardPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardPlayer_setPrototypeOf(e,t)}(BoardPlayer,M),function BoardPlayer_createClass(e,t,n){return t&&BoardPlayer_defineProperties(e.prototype,t),n&&BoardPlayer_defineProperties(e,n),e}(BoardPlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new Ct(this.scene,this)}},{key:"update",value:function update(e,t){BoardPlayer_get(BoardPlayer_getPrototypeOf(BoardPlayer.prototype),"update",this).call(this,e,t);switch(this.state){case BoardPlayer.State.Roll:case BoardPlayer.State.Branch:this.playerAI&&this.playerAI.update(e,t)}}},{key:"Reset",value:function Reset(e){this.SetTile(e),this.state=BoardPlayer.State.Idle}},{key:"SetTile",value:function SetTile(e){this.tile=e,this.setPosition(this.tile.x+this.offset.x,this.tile.y+this.offset.y)}},{key:"Teleport",value:function Teleport(e){var t=this.scene.tweens.createTimeline();this.animation.SetState(Ct.State.TeleportDisappear),h.Instance.Play("sfx_boardgame","board_teleport_start",{delay:.15}),t.add({targets:this,alpha:{value:0,delay:150,duration:750,hold:150,ease:"Linear"},onComplete:this.SetTile.bind(this,e)}),t.add({targets:this,alpha:{value:1,duration:750,ease:"Linear"},onStart:this.OnTeleportAppearStart,onStartScope:this}),t.on("complete",this.OnTeleportComplete,this),t.play()}},{key:"OnTeleportAppearStart",value:function OnTeleportAppearStart(){h.Instance.Play("sfx_boardgame","board_teleport_end"),this.animation.SetState(Ct.State.TeleportAppear)}},{key:"OnTeleportComplete",value:function OnTeleportComplete(){this.emit("teleportComplete",this)}},{key:"Freeze",value:function Freeze(){this.isFrozen=!0,this.turnsFrozen=0,this.animation.SetState(Ct.State.Freeze),this.scene.board.camera.camera.shake(250,.002),this.animation.spine.once("spine.complete",this.OnFreezeComplete,this),h.Instance.Play("sfx_boardgame","board_freeze")}},{key:"OnFreezeComplete",value:function OnFreezeComplete(){this.animation.SetState(Ct.State.Frozen),this.scene.time.delayedCall(500,this.emit,["freezeComplete",this],this)}},{key:"OnFrozenTurn",value:function OnFrozenTurn(){this.turnsFrozen++,1<this.turnsFrozen?(h.Instance.Play("sfx_boardgame","board_freeze_over"),this.animation.SetState(Ct.State.FreezeBreak),this.animation.spine.once("spine.complete",this.OnFreezeBreakComplete,this),this.isFrozen=!1):(this.scene.board.camera.camera.shake(250,.002),this.scene.time.delayedCall(1750,this.OnFrozenTurnComplete.bind(this)))}},{key:"OnFreezeBreakComplete",value:function OnFreezeBreakComplete(){this.animation.SetState(Ct.State.Idle),this.OnFrozenTurnComplete()}},{key:"OnFrozenTurnComplete",value:function OnFrozenTurnComplete(){this.emit("frozenTurnComplete",this)}},{key:"StartInput",value:function StartInput(e){return this.state=e,!this.playerAI||(this.playerAI.SetState(e),!1)}},{key:"MoveToNextTile",value:function MoveToNextTile(e){var t=0<arguments.length&&void 0!==e?e:0;this.state=BoardPlayer.State.Moving,this.animation.SetState(Ct.State.Walk),this.nextIndex=t,this.nextTile=this.tile.paths[this.nextIndex];var n=this.nextTile.x+this.offset.x,r=this.nextTile.y+this.offset.y,o=this.x<n?1:-1;this.animation.SetFlipX(1!=o),this.previousMoveTweenProgress=0,this.moveTween&&this.moveTween.stop(),this.moveTween=this.scene.tweens.add({targets:this,x:n,y:r,duration:1e3*this.moveDuration,ease:"Linear",onUpdate:this.OnMoveToTileUpdate,onUpdateScope:this,onComplete:this.OnMoveToTileComplete,onCompleteScope:this})}},{key:"OnMoveToTileUpdate",value:function OnMoveToTileUpdate(){var e=this.moveTween.elapsed/this.moveTween.duration;.5<=e&&this.previousMoveTweenProgress<.5&&this.emit("moveHalfway",this,this.tile,this.nextTile),this.previousMoveTweenProgress=e}},{key:"PauseMove",value:function PauseMove(){this.animation.SetState(Ct.State.Idle),this.moveTween.pause()}},{key:"ResumeMove",value:function ResumeMove(){this.animation.SetState(Ct.State.Walk),this.moveTween.resume()}},{key:"OnMoveToTileComplete",value:function OnMoveToTileComplete(){this.state=BoardPlayer.State.Idle;var e=this.tile;this.tile=this.nextTile,this.emit("moveFinished",this,e,this.nextTile)}},{key:"OnRollInput",value:function OnRollInput(){this.emit("rollInput",this)}},{key:"OnBranchInput",value:function OnBranchInput(e){this.emit("branchInput",this,e)}},{key:"BuyTrophy",value:function BuyTrophy(){this.SetTrophies(this.trophies+1),this.animation.SetState(Ct.State.BuyTrophy)}},{key:"CantBuyTrophy",value:function CantBuyTrophy(){this.animation.SetState(Ct.State.CantBuyTrophy)}},{key:"SetPoints",value:function SetPoints(e){this.points=e,this.emit("setPoints",e)}},{key:"SetTrophies",value:function SetTrophies(e){this.trophies=e,this.emit("setTrophies",e)}},{key:"LoadData",value:function LoadData(e,t){t?(this.tile=e.tileLookup[t.tileId]||this.tile,this.isFrozen=t.isFrozen,this.turnsFrozen=t.turnsFrozen,this.Reset(this.tile)):this.Reset(e.startTile),this.animation.LoadData(t?t.animation:null),this.isFrozen&&this.animation.SetState(Ct.State.Frozen)}},{key:"SaveData",value:function SaveData(){return{tileId:this.tile.tileId,isFrozen:this.isFrozen,turnsFrozen:this.turnsFrozen,animation:this.animation.SaveData()}}}]),BoardPlayer}();function PathTile_typeof(e){return(PathTile_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PathTile_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PathTile_getPrototypeOf(e){return(PathTile_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PathTile_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PathTile_setPrototypeOf(e,t){return(PathTile_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function BoardPlayer_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(It,"State",Object.freeze({Idle:0,Roll:1,Moving:2,Branch:3}));var kt=function(){function PathTile(e,t,n,r){var o;!function PathTile_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PathTile),r||(r={}),(o=function PathTile_possibleConstructorReturn(e,t){return!t||"object"!==PathTile_typeof(t)&&"function"!=typeof t?PathTile_assertThisInitialized(e):t}(this,PathTile_getPrototypeOf(PathTile).call(this,e))).x=r.x||0,o.y=r.y||0;var i=r.frame||"floor1.png",a=r.atlas||"board_atlas",s=r.tileId,l=r.paths||[],c=r.powerup||!1;return o.sprite=o.scene.add.sprite(0,0,a,i),o.add(o.sprite),o.glowOverlay=o.scene.add.sprite(0,0,a,"board_square_gloverlay.png"),o.glowOverlay.alpha=0,o.add(o.glowOverlay),I.AddChild(PathTile_assertThisInitialized(o),n),o.board=t,o.tileId=s,o.paths=l,o.powerup=c,o.type=PathTile.Type[r.type],o}return function PathTile_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PathTile_setPrototypeOf(e,t)}(PathTile,Phaser.GameObjects.Container),function PathTile_createClass(e,t,n){return t&&PathTile_defineProperties(e.prototype,t),n&&PathTile_defineProperties(e,n),e}(PathTile,[{key:"OnPlayerLanded",value:function OnPlayerLanded(e){switch(this.OnPlayerStopped(e),this.Glow(),this.type){case PathTile.Type.Chance:this.board.StartPlayerChance(e);break;default:this.board.OnPlayerTurnComplete(e)}}},{key:"OnPlayerStopped",value:function OnPlayerStopped(){switch(this.Glow(),this.type){case PathTile.Type.Chance:h.Instance.Play("sfx_boardgame","board_tile_special");break;default:h.Instance.Play("sfx_boardgame","board_tile")}}},{key:"OnPlayerPass",value:function OnPlayerPass(){switch(this.Glow(),this.type){case PathTile.Type.Chance:h.Instance.Play("sfx_boardgame","board_tile_special");break;default:h.Instance.Play("sfx_boardgame","board_tile")}}},{key:"Glow",value:function Glow(){this.scene.tweens.add({targets:this.glowOverlay,alpha:{value:1,duration:250,ease:"Sine.easeOut",yoyo:!0}})}}]),PathTile}();function BoardTrophy_typeof(e){return(BoardTrophy_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardTrophy_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardTrophy_getPrototypeOf(e){return(BoardTrophy_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardTrophy_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardTrophy_setPrototypeOf(e,t){return(BoardTrophy_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function PathTile_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(kt,"Type",Object.freeze({Standard:0,Chance:1}));var xt=function(){function BoardTrophy(e,t,n){var r;return function BoardTrophy_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardTrophy),n||(n={}),r=function BoardTrophy_possibleConstructorReturn(e,t){return!t||"object"!==BoardTrophy_typeof(t)&&"function"!=typeof t?BoardTrophy_assertThisInitialized(e):t}(this,BoardTrophy_getPrototypeOf(BoardTrophy).call(this,e)),I.AddChild(BoardTrophy_assertThisInitialized(r),t),r.visible=!1,r.prevTileId=0,r.nextTileId=0,r.cost=10,r.spine=r.scene.add.spine(0,0,"board_trophy","animation",!0),r.add(r.spine),r}return function BoardTrophy_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardTrophy_setPrototypeOf(e,t)}(BoardTrophy,Phaser.GameObjects.Container),function BoardTrophy_createClass(e,t,n){return t&&BoardTrophy_defineProperties(e.prototype,t),n&&BoardTrophy_defineProperties(e,n),e}(BoardTrophy,[{key:"update",value:function update(){}},{key:"Appear",value:function Appear(e){var t=e.paths[0];this.setPosition(Phaser.Math.Linear(e.x,t.x,.5),Phaser.Math.Linear(e.y,t.y,.5)),this.visible=!0,this.prevTileId=e.tileId,this.nextTileId=t.tileId,h.Instance.Play("sfx_boardgame","trophy_spawn"),this.setScale(0),this.scene.tweens.add({targets:this,scaleX:{value:1,duration:1250,ease:"Back.easeOut"},scaleY:{value:1,duration:1250,ease:"Back.easeOut"},hold:750,onComplete:this.OnAppearComplete,onCompleteScope:this})}},{key:"OnAppearComplete",value:function OnAppearComplete(){this.emit("appearComplete")}},{key:"Disappear",value:function Disappear(){h.Instance.Play("sfx_boardgame","trophy_collect"),this.scene.tweens.add({targets:this,scaleX:{value:0,duration:500,ease:"Back.easeIn"},scaleY:{value:0,duration:500,ease:"Back.easeIn"},hold:750,onComplete:this.OnDisappearComplete,onCompleteScope:this})}},{key:"OnDisappearComplete",value:function OnDisappearComplete(){this.emit("disappearComplete")}},{key:"CanPlayerPurchase",value:function CanPlayerPurchase(e){return e.points>=this.cost}},{key:"AttemptPurchase",value:function AttemptPurchase(e){this.CanPlayerPurchase(e)?(e.BuyTrophy(),e.SetPoints(e.points-this.cost),this.Disappear()):(e.CantBuyTrophy(),this.scene.time.delayedCall(1e3,this.OnFailPurchase,[e],this))}},{key:"OnFailPurchase",value:function OnFailPurchase(e){this.emit("purchaseFailed",e)}},{key:"LoadData",value:function LoadData(e){e&&(this.visible=e.visible,this.prevTileId=e.prevTileId,this.nextTileId=e.nextTileId,this.setPosition(e.x,e.y))}},{key:"SaveData",value:function SaveData(){return{visible:this.visible,prevTileId:this.prevTileId,nextTileId:this.nextTileId,x:this.x,y:this.y}}}]),BoardTrophy}();function BoardChancePopup_typeof(e){return(BoardChancePopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardChancePopup_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardChancePopup_getPrototypeOf(e){return(BoardChancePopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardChancePopup_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardChancePopup_setPrototypeOf(e,t){return(BoardChancePopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var At=function(){function BoardChancePopup(e,t,n){var r;return function BoardChancePopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardChancePopup),n||(n={}),r=function BoardChancePopup_possibleConstructorReturn(e,t){return!t||"object"!==BoardChancePopup_typeof(t)&&"function"!=typeof t?BoardChancePopup_assertThisInitialized(e):t}(this,BoardChancePopup_getPrototypeOf(BoardChancePopup).call(this,e,.5*e.scale.width,.5*e.scale.height)),I.AddChild(BoardChancePopup_assertThisInitialized(r),t),r.background=r.scene.add.sprite(0,0,"board_ui_atlas","chance_popup_teleport.png"),r.add(r.background),r.titleText=r.scene.add.text(0*r.scene.gameScale,-150*r.scene.gameScale,v.Instance.GetString("Chance"),{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:40*r.scene.gameScale+"px",color:"#000000"}),r.titleText.setOrigin(.5),r.titleText.setStroke("#FFFFFF",8*r.scene.gameScale),r.add(r.titleText),r.visible=!1,r.showTimer=0,r.showTime=2,r.chanceTypes=[BoardChancePopup.ChanceType.RollAgain,BoardChancePopup.ChanceType.Teleport,BoardChancePopup.ChanceType.Freeze],r.chanceType=BoardChancePopup.ChanceType.RollAgain,r}return function BoardChancePopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardChancePopup_setPrototypeOf(e,t)}(BoardChancePopup,Phaser.GameObjects.Container),function BoardChancePopup_createClass(e,t,n){return t&&BoardChancePopup_defineProperties(e.prototype,t),n&&BoardChancePopup_defineProperties(e,n),e}(BoardChancePopup,[{key:"update",value:function update(e,t){this.visible&&0<this.showTimer&&(this.showTimer-=.001*t,this.showTimer<=0&&this.Hide())}},{key:"Show",value:function Show(){switch(this.visible=!0,this.setScale(0),this.chanceType=this.chanceTypes[Phaser.Math.RND.integerInRange(0,this.chanceTypes.length-1)],this.chanceType){case BoardChancePopup.ChanceType.RollAgain:this.background.setFrame("chance_popup_rollagain.png"),this.titleText.setText(v.Instance.GetString("Chance_Roll_Again"));break;case BoardChancePopup.ChanceType.Teleport:this.background.setFrame("chance_popup_teleport.png"),this.titleText.setText(v.Instance.GetString("Chance_Teleport"));break;case BoardChancePopup.ChanceType.Freeze:this.background.setFrame("chance_popup_freeze.png"),this.titleText.setText(v.Instance.GetString("Chance_Freeze"))}I.ClampTextToDimensions(this.titleText,280*this.scene.gameScale,150*this.scene.gameScale),this.scene.tweens.add({targets:this,scaleX:1,scaleY:1,duration:750,ease:"Back.easeOut",onComplete:this.OnShowComplete,onCompleteScope:this})}},{key:"OnShowComplete",value:function OnShowComplete(){this.showTimer=this.showTime}},{key:"Hide",value:function Hide(){this.scene.tweens.add({targets:this,scaleX:0,scaleY:0,duration:500,ease:"Sine.easeIn",onComplete:this.OnHideComplete,onCompleteScope:this})}},{key:"OnHideComplete",value:function OnHideComplete(){this.emit("execute",this.chanceType),this.visible=!1}}]),BoardChancePopup}();function IntroScreen_typeof(e){return(IntroScreen_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IntroScreen_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IntroScreen_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IntroScreen_get(e,t,n){return(IntroScreen_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function IntroScreen_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=IntroScreen_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function IntroScreen_getPrototypeOf(e){return(IntroScreen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IntroScreen_setPrototypeOf(e,t){return(IntroScreen_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function IntroScreen_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function BoardChancePopup_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(At,"ChanceType",Object.freeze({RollAgain:0,Teleport:1,Freeze:2}));var Bt=function(){function IntroScreen(e){var t;return function IntroScreen_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,IntroScreen),(t=function IntroScreen_possibleConstructorReturn(e,t){return!t||"object"!==IntroScreen_typeof(t)&&"function"!=typeof t?IntroScreen_assertThisInitialized(e):t}(this,IntroScreen_getPrototypeOf(IntroScreen).call(this,e))).brownUnderlay=t.scene.add.rectangle(.5*t.scene.scale.width,.5*t.scene.scale.height,t.scene.scale.width,t.scene.scale.height,1969430),t.add(t.brownUnderlay),t.introSequence1Container=t.scene.add.container(.5*t.scene.scale.width,.5*t.scene.scale.height),t.introSequence1Container.visible=!1,t.add(t.introSequence1Container),t.introSequence1=t.scene.add.spine(0,0,"intro_sequence_1","default"),t.introSequence1.setScale(t.scene.gameScale),t.introSequence1Container.add(t.introSequence1),t.introSequence1Container.add(t.scene.add.rectangle(-900*t.scene.gameScale,0,.475*t.scene.scale.width,t.scene.scale.height,1969430)),t.introSequence1Container.add(t.scene.add.rectangle(900*t.scene.gameScale,0,.475*t.scene.scale.width,t.scene.scale.height,1969430)),t.introSequence2Container=t.scene.add.container(.5*t.scene.scale.width,.5*t.scene.scale.height),t.introSequence2Container.visible=!1,t.add(t.introSequence2Container),t.introSequence2=t.scene.add.spine(0,0,"intro_sequence_2","default"),t.introSequence2.setScale(t.scene.gameScale),t.introSequence2Container.add(t.introSequence2),t.introSequence3Container=t.scene.add.container(.5*t.scene.scale.width,.5*t.scene.scale.height),t.introSequence3Container.visible=!1,t.add(t.introSequence3Container),t.introSequence3=t.scene.add.spine(0,0,"intro_sequence_3","default"),t.introSequence3.setScale(t.scene.gameScale),t.introSequence3Container.add(t.introSequence3),t.introSequence5Container=t.scene.add.container(.5*t.scene.scale.width,.5*t.scene.scale.height),t.introSequence5Container.visible=!1,t.add(t.introSequence5Container),t.introSequence5=t.scene.add.spine(0,0,"intro_sequence_5","default"),t.introSequence5.setScale(t.scene.gameScale),t.introSequence5Container.add(t.introSequence5),t.introSequence5Container.add(t.scene.add.rectangle(-900*t.scene.gameScale,0,.475*t.scene.scale.width,t.scene.scale.height,1969430)),t.introSequence5Container.add(t.scene.add.rectangle(900*t.scene.gameScale,0,.475*t.scene.scale.width,t.scene.scale.height,1969430)),t.introSequence4Container=t.scene.add.container(.5*t.scene.scale.width,.5*t.scene.scale.height),t.introSequence4Container.visible=!1,t.add(t.introSequence4Container),t.introSequence4=t.scene.add.spine(0,0,"intro_sequence_4","default"),t.introSequence4.setScale(t.scene.gameScale),t.introSequence4Container.add(t.introSequence4),t.speechText=t.scene.add.text(.5*t.scene.scale.width,.5*t.scene.scale.height,"",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:46*t.scene.gameScale+"px",color:"#000000",align:"center"}),t.speechText.setOrigin(.5),t.speechText.visible=!1,t.add(t.speechText),t.popupText=t.scene.add.text(.5*t.scene.scale.width,.5*t.scene.scale.height,"",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:46*t.scene.gameScale+"px",color:"#FFFFFF",align:"center"}),t.popupText.setShadow(2*t.scene.gameScale,2*t.scene.gameScale),t.popupText.setOrigin(.5),t.popupText.visible=!1,t.add(t.popupText),t.topLeftPanel=new d(t.scene,IntroScreen_assertThisInitialized(t),{domClass:"dom_panel top left"}),t.backButton=new g(t.scene,t.topLeftPanel,{frames:["button_back_unselected.png","button_back_selected.png"],atlas:"ui_atlas",id:"domui_MENU_pause",title:"Back",callback:t.OnBackButtonPressed,context:IntroScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.topRightPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel top right"}),t.audioButton=new m(t.scene,t.topRightPanel,{frames:["button_audio_on_unselected.png","button_audio_on_selected.png"],toggleOffFrames:["button_audio_off_unselected.png","button_audio_off_selected.png"],atlas:"ui_atlas",id:"domui_MENU_audio",title:"Audio",onToggle:t.scene.OnAudioButtonPressed.bind(t.scene),toggleActive:h.Instance.audioEnabled,toggleEvent:"audioEnabled",clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.bottomRightPanel=new d(t.scene,IntroScreen_assertThisInitialized(t),{domClass:"dom_panel bottom right"}),t.skipButton=new g(t.scene,t.bottomRightPanel,{frames:["button_skip_unselected.png","button_skip_selected.png"],atlas:"ui_atlas",id:"domui_MENU_skip",title:"Skip",callback:t.OnSkipButtonPressed,context:IntroScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.nextButton=new g(t.scene,t.scene.dom,{x:.5*t.scene.scale.width,y:.5*t.scene.scale.height+280*t.scene.gameScale,domClass:null,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:t.OnNextButtonPressed,context:IntroScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.state=null,t.startSequenceTimer=0,t.Disable(),t}return function IntroScreen_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IntroScreen_setPrototypeOf(e,t)}(IntroScreen,_),function IntroScreen_createClass(e,t,n){return t&&IntroScreen_defineProperties(e.prototype,t),n&&IntroScreen_defineProperties(e,n),e}(IntroScreen,[{key:"update",value:function update(e,t){IntroScreen_get(IntroScreen_getPrototypeOf(IntroScreen.prototype),"update",this).call(this),0<this.startSequenceTimer&&(this.startSequenceTimer-=.001*t,this.startSequenceTimer<=0&&this.StartSequence())}},{key:"Enable",value:function Enable(){IntroScreen_get(IntroScreen_getPrototypeOf(IntroScreen.prototype),"Enable",this).call(this),this.backButton.Show(),this.backButton.Enable(),this.audioButton.Show(),this.audioButton.Enable(),this.skipButton.Show(),this.skipButton.Enable(),this.popupText.visible=!1,this.speechText.visible=!1,this.introSequence1Container.setPosition(.5*this.scene.scale.width,.5*this.scene.scale.height),this.introSequence1Container.visible=!0,this.introSequence2Container.visible=!1,this.introSequence3Container.visible=!1,this.introSequence4Container.visible=!1,this.introSequence5Container.visible=!1,this.introSequence1.setAnimation(0,"default"),this.introSequence2.setAnimation(0,"default"),this.introSequence3.setAnimation(0,"default"),this.introSequence4.setAnimation(0,"default"),this.introSequence5.setAnimation(0,"default"),this.startSequenceTimer=.5}},{key:"Disable",value:function Disable(){IntroScreen_get(IntroScreen_getPrototypeOf(IntroScreen.prototype),"Disable",this).call(this),this.backButton.Hide(),this.audioButton.Hide(),this.backButton.Disable(),this.audioButton.Disable(),this.nextButton.Disable(),this.nextButton.Hide(),this.skipButton.Disable(),this.skipButton.Hide()}},{key:"StartSequence",value:function StartSequence(){this.SetState(IntroScreen.State.One)}},{key:"SetState",value:function SetState(e){if(this.visible)switch(this.state=e){case IntroScreen.State.One:this.ShowIntroSequence1();break;case IntroScreen.State.Two:this.ShowIntroSequence2();break;case IntroScreen.State.Three:this.ShowIntroSequence3();break;case IntroScreen.State.Four:this.ShowIntroSequence4();break;case IntroScreen.State.Five:this.ShowIntroSequence5();break;case IntroScreen.State.Five_DiceStay:this.nextButton.Show(),this.nextButton.Enable(),this.introSequence5.setAnimation(0,"panel_5_dice_stay",!0);break;case IntroScreen.State.Five_DiceToWheel:this.introSequence5.setAnimation(0,"panel_5_dice_to_wheel"),this.introSequence5.once("spine.complete",this.SetState.bind(this,IntroScreen.State.Five_WheelStay),this);break;case IntroScreen.State.Five_WheelStay:this.nextButton.Show(),this.nextButton.Enable(),this.introSequence5.setAnimation(0,"panel_5_wheel_stay",!0);break;case IntroScreen.State.Five_WheelToTrophy:this.introSequence5.setAnimation(0,"panel_5_wheel_to_trophy"),this.introSequence5.once("spine.complete",this.SetState.bind(this,IntroScreen.State.Five_TrophyStay),this);break;case IntroScreen.State.Five_TrophyStay:this.nextButton.Show(),this.nextButton.Enable(),this.introSequence5.setAnimation(0,"panel_5_trophy_stay",!0);break;case IntroScreen.State.Five_TrophyToWinner:this.introSequence5.setAnimation(0,"panel_5_trophy_to_winner"),this.introSequence5.once("spine.complete",this.SetState.bind(this,IntroScreen.State.Five_WinnerStay),this);break;case IntroScreen.State.Five_WinnerStay:this.nextButton.Show(),this.nextButton.Enable(),this.introSequence5.setAnimation(0,"panel_5_winner_stay",!0);break;case IntroScreen.State.Five_WinnerHide:this.introSequence5.setAnimation(0,"panel_5_winner_hide"),this.OnIntroComplete()}}},{key:"ShowIntroSequence1",value:function ShowIntroSequence1(){this.introSequence1Container.visible=!0,this.introSequence1.setAnimation(0,"panel_1"),this.introSequence1.once("spine.complete",this.HideIntroSequence1,this)}},{key:"HideIntroSequence1",value:function HideIntroSequence1(){this.SetState(IntroScreen.State.Two),this.hideTween=this.scene.tweens.add({targets:this.introSequence1Container,x:-500*this.scene.gameScale,duration:750,ease:"Sine.easeIn",onComplete:this.OnHideIntroSequence1Complete,onCompleteScope:this})}},{key:"OnHideIntroSequence1Complete",value:function OnHideIntroSequence1Complete(){this.introSequence1Container.visible=!1}},{key:"ShowIntroSequence2",value:function ShowIntroSequence2(){h.Instance.Play("sfx_intro","screen_in_intro",{delay:.25}),this.introSequence2Container.visible=!0,this.introSequence2Container.x=this.scene.scale.width+500*this.scene.gameScale,this.introSequence2.on("spine.event",this.OnIntroSequence2Event,this),this.showTween=this.scene.tweens.add({targets:this.introSequence2Container,x:.5*this.scene.scale.width,duration:750,ease:"Sine.easeOut",delay:250,onComplete:this.OnShowIntroSequence2Complete,onCompleteScope:this})}},{key:"OnShowIntroSequence2Complete",value:function OnShowIntroSequence2Complete(){this.introSequence2.setAnimation(0,"panel_2"),this.introSequence2.once("spine.complete",this.HideIntroSequence2,this)}},{key:"OnIntroSequence2Event",value:function OnIntroSequence2Event(e,t){switch(t.data.name){case"show_text_1":this.speechText.setPosition(.5*this.scene.scale.width-138*this.scene.gameScale,.5*this.scene.scale.height-211*this.scene.gameScale),this.speechText.setText(v.Instance.GetString("intro_01")),this.speechText.visible=!0,this.speechText.setFontSize(46*this.scene.gameScale),this.speechText.setWordWrapWidth(291*this.scene.gameScale),I.ClampTextToDimensions(this.speechText,285*this.scene.gameScale,210*this.scene.gameScale);break;case"hide_text_1":this.speechText.visible=!1;break;case"show_text_2":this.speechText.setPosition(.5*this.scene.scale.width+205*this.scene.gameScale,.5*this.scene.scale.height-105*this.scene.gameScale),this.speechText.setText(v.Instance.GetString("intro_02")),this.speechText.visible=!0,this.speechText.setFontSize(46*this.scene.gameScale),this.speechText.setWordWrapWidth(195*this.scene.gameScale),I.ClampTextToDimensions(this.speechText,195*this.scene.gameScale,105*this.scene.gameScale);break;case"hide_text_2":this.speechText.visible=!1}}},{key:"HideIntroSequence2",value:function HideIntroSequence2(){this.SetState(IntroScreen.State.Three),this.hideTween=this.scene.tweens.add({targets:this.introSequence2Container,x:-500*this.scene.gameScale,duration:750,ease:"Sine.easeIn",onComplete:this.OnHideIntroSequence2Complete,onCompleteScope:this})}},{key:"OnHideIntroSequence2Complete",value:function OnHideIntroSequence2Complete(){this.introSequence2Container.visible=!1}},{key:"ShowIntroSequence3",value:function ShowIntroSequence3(){h.Instance.Play("sfx_intro","screen_in_intro",{delay:.25}),this.introSequence3Container.visible=!0,this.introSequence3Container.x=this.scene.scale.width+500*this.scene.gameScale,this.introSequence3.on("spine.event",this.OnIntroSequence3Event,this),this.showTween=this.scene.tweens.add({targets:this.introSequence3Container,x:.5*this.scene.scale.width,duration:750,ease:"Sine.easeOut",delay:250,onComplete:this.OnShowIntroSequence3Complete,onCompleteScope:this})}},{key:"OnShowIntroSequence3Complete",value:function OnShowIntroSequence3Complete(){this.introSequence3.setAnimation(0,"panel_3"),this.introSequence3.once("spine.complete",this.HideIntroSequence3,this)}},{key:"OnIntroSequence3Event",value:function OnIntroSequence3Event(e,t){switch(t.data.name){case"show_text_1":this.speechText.setPosition(.5*this.scene.scale.width-290*this.scene.gameScale,.5*this.scene.scale.height-230*this.scene.gameScale),this.speechText.setText(v.Instance.GetString("intro_03")),this.speechText.visible=!0,this.speechText.setFontSize(46*this.scene.gameScale),this.speechText.setWordWrapWidth(315*this.scene.gameScale),I.ClampTextToDimensions(this.speechText,315*this.scene.gameScale,210*this.scene.gameScale);break;case"hide_text_1":this.speechText.visible=!1}}},{key:"HideIntroSequence3",value:function HideIntroSequence3(){this.SetState(IntroScreen.State.Four),this.hideTween=this.scene.tweens.add({targets:this.introSequence3Container,x:-500*this.scene.gameScale,duration:750,ease:"Sine.easeIn",onComplete:this.OnHideIntroSequence3Complete,onCompleteScope:this})}},{key:"ShowIntroSequence4",value:function ShowIntroSequence4(){h.Instance.Play("sfx_intro","screen_in_intro",{delay:.25}),this.introSequence4Container.visible=!0,this.introSequence4Container.x=this.scene.scale.width+500*this.scene.gameScale,this.introSequence4.on("spine.event",this.OnIntroSequence4Event,this),this.showTween=this.scene.tweens.add({targets:this.introSequence4Container,x:.5*this.scene.scale.width,duration:750,ease:"Sine.easeOut",delay:250,onComplete:this.OnShowIntroSequence4Complete,onCompleteScope:this}),h.Instance.Play("sfx_intro","intro_box_opening",{delay:3}),h.Instance.Play("sfx_intro","intro_box_absorb",{delay:5.5})}},{key:"OnShowIntroSequence4Complete",value:function OnShowIntroSequence4Complete(){this.introSequence4.setAnimation(0,"panel_4"),this.introSequence4.once("spine.complete",this.HideIntroSequence4,this)}},{key:"OnIntroSequence4Event",value:function OnIntroSequence4Event(e,t){switch(t.data.name){case"show_text_1":this.speechText.setPosition(.5*this.scene.scale.width+29.5*this.scene.gameScale,.5*this.scene.scale.height-197*this.scene.gameScale),this.speechText.setText(v.Instance.GetString("intro_04")),this.speechText.visible=!0,this.speechText.setFontSize(46*this.scene.gameScale),this.speechText.setWordWrapWidth(340*this.scene.gameScale),I.ClampTextToDimensions(this.speechText,340*this.scene.gameScale,123*this.scene.gameScale);break;case"hide_text_1":this.speechText.visible=!1;break;case"show_text_2":this.speechText.setPosition(.5*this.scene.scale.width+310*this.scene.gameScale,.5*this.scene.scale.height-150*this.scene.gameScale),this.speechText.setText(v.Instance.GetString("intro_05")),this.speechText.visible=!0,this.speechText.setFontSize(46*this.scene.gameScale),this.speechText.setWordWrapWidth(225*this.scene.gameScale),I.ClampTextToDimensions(this.speechText,225*this.scene.gameScale,125*this.scene.gameScale);break;case"hide_text_2":this.speechText.visible=!1;break;case"show_text_3":this.speechText.setPosition(.5*this.scene.scale.width-328*this.scene.gameScale,.5*this.scene.scale.height-185*this.scene.gameScale),this.speechText.setText(v.Instance.GetString("intro_06")),this.speechText.visible=!0,this.speechText.setFontSize(46*this.scene.gameScale),this.speechText.setWordWrapWidth(210*this.scene.gameScale),I.ClampTextToDimensions(this.speechText,210*this.scene.gameScale,140*this.scene.gameScale);break;case"hide_text_3":this.speechText.visible=!1}}},{key:"HideIntroSequence4",value:function HideIntroSequence4(){this.SetState(IntroScreen.State.Five),this.hideTween=this.scene.tweens.add({targets:this.introSequence4Container,x:-500*this.scene.gameScale,duration:750,ease:"Sine.easeIn",onComplete:this.OnHideIntroSequence4Complete,onCompleteScope:this})}},{key:"OnHideIntroSequence4Complete",value:function OnHideIntroSequence4Complete(){this.introSequence4Container.visible=!1}},{key:"ShowIntroSequence5",value:function ShowIntroSequence5(){this.introSequence5Container.visible=!0,this.introSequence5Container.x=this.scene.scale.width+500*this.scene.gameScale,this.introSequence5.on("spine.event",this.OnIntroSequence5Event,this),this.showTween=this.scene.tweens.add({targets:this.introSequence5Container,x:.5*this.scene.scale.width,duration:750,ease:"Sine.easeOut",delay:250,onComplete:this.OnShowIntroSequence5Complete,onCompleteScope:this})}},{key:"OnShowIntroSequence5Complete",value:function OnShowIntroSequence5Complete(){this.introSequence5.setAnimation(0,"panel_5"),this.introSequence5.once("spine.complete",this.SetState.bind(this,IntroScreen.State.Five_DiceStay),this)}},{key:"OnIntroSequence5Event",value:function OnIntroSequence5Event(e,t){switch(t.data.name){case"show_text_1":this.speechText.setPosition(.5*this.scene.scale.width+92*this.scene.gameScale,.5*this.scene.scale.height-105*this.scene.gameScale),this.speechText.setText(v.Instance.GetString("intro_07")),this.speechText.visible=!0,this.speechText.setFontSize(46*this.scene.gameScale),this.speechText.setWordWrapWidth(162*this.scene.gameScale),I.ClampTextToDimensions(this.speechText,155*this.scene.gameScale,100*this.scene.gameScale);break;case"hide_text_1":this.speechText.visible=!1;break;case"show_text_2":this.speechText.setPosition(.5*this.scene.scale.width-177*this.scene.gameScale,.5*this.scene.scale.height-100*this.scene.gameScale),this.speechText.setText(v.Instance.GetString("intro_08")),this.speechText.visible=!0,this.speechText.setFontSize(46*this.scene.gameScale),this.speechText.setWordWrapWidth(220*this.scene.gameScale),I.ClampTextToDimensions(this.speechText,200*this.scene.gameScale,175*this.scene.gameScale);break;case"hide_text_2":this.speechText.visible=!1;break;case"show_text_3":this.speechText.setPosition(.5*this.scene.scale.width-37*this.scene.gameScale,.5*this.scene.scale.height-120*this.scene.gameScale),this.speechText.setText(v.Instance.GetString("intro_09")),this.speechText.visible=!0,this.speechText.setFontSize(46*this.scene.gameScale),this.speechText.setWordWrapWidth(230*this.scene.gameScale),I.ClampTextToDimensions(this.speechText,230*this.scene.gameScale,85*this.scene.gameScale);break;case"hide_text_3":this.speechText.visible=!1,h.Instance.Play("sfx_intro","intro_tutorial_panel_out"),h.Instance.Play("sfx_intro","intro_tutorial_panel_in",{delay:1});break;case"show_text_4":this.popupText.setPosition(.5*this.scene.scale.width,.5*this.scene.scale.height-50*this.scene.gameScale),this.popupText.setText(v.Instance.GetString("intro_10")),this.popupText.visible=!0,this.popupText.setFontSize(32*this.scene.gameScale),this.popupText.setWordWrapWidth(295*this.scene.gameScale),I.ClampTextToDimensions(this.popupText,295*this.scene.gameScale,143*this.scene.gameScale);break;case"hide_text_4":this.popupText.visible=!1,h.Instance.Play("sfx_intro","intro_tutorial_panel_out"),h.Instance.Play("sfx_intro","intro_tutorial_panel_in",{delay:1});break;case"show_text_5":this.popupText.setPosition(.5*this.scene.scale.width,.5*this.scene.scale.height-8*this.scene.gameScale),this.popupText.setText(v.Instance.GetString("intro_11")),this.popupText.visible=!0,this.popupText.setFontSize(32*this.scene.gameScale),this.popupText.setWordWrapWidth(295*this.scene.gameScale),I.ClampTextToDimensions(this.popupText,295*this.scene.gameScale,115*this.scene.gameScale);break;case"hide_text_5":this.popupText.visible=!1,h.Instance.Play("sfx_intro","intro_tutorial_panel_out"),h.Instance.Play("sfx_intro","intro_tutorial_panel_in",{delay:1});break;case"show_text_6":this.popupText.setPosition(.5*this.scene.scale.width,.5*this.scene.scale.height-20*this.scene.gameScale),this.popupText.setText(v.Instance.GetString("intro_12")),this.popupText.visible=!0,this.popupText.setFontSize(32*this.scene.gameScale),this.popupText.setWordWrapWidth(295*this.scene.gameScale),I.ClampTextToDimensions(this.popupText,295*this.scene.gameScale,155*this.scene.gameScale);break;case"hide_text_6":this.popupText.visible=!1,h.Instance.Play("sfx_intro","intro_tutorial_panel_out"),h.Instance.Play("sfx_intro","intro_tutorial_panel_in",{delay:1});break;case"show_text_7":this.popupText.setPosition(.5*this.scene.scale.width,.5*this.scene.scale.height-15*this.scene.gameScale),this.popupText.setText(v.Instance.GetString("intro_13")),this.popupText.visible=!0,this.popupText.setFontSize(32*this.scene.gameScale),this.popupText.setWordWrapWidth(295*this.scene.gameScale),I.ClampTextToDimensions(this.popupText,295*this.scene.gameScale,191*this.scene.gameScale);break;case"hide_text_7":this.popupText.visible=!1}}},{key:"HideIntroSequence5",value:function HideIntroSequence5(){this.hideTween=this.scene.tweens.add({targets:this.introSequence5Container,x:-500*this.scene.gameScale,duration:750,ease:"Sine.easeIn",onComplete:this.OnHideIntroSequence5Complete,onCompleteScope:this})}},{key:"OnHideIntroSequence5Complete",value:function OnHideIntroSequence5Complete(){this.introSequence5Container.visible=!1}},{key:"ShowNextButton",value:function ShowNextButton(){this.nextButton.Enable(),this.nextButton.Show()}},{key:"OnNextButtonPressed",value:function OnNextButtonPressed(){switch(this.nextButton.Disable(),this.nextButton.Hide(),this.state){case IntroScreen.State.Five_DiceStay:this.SetState(IntroScreen.State.Five_DiceToWheel);break;case IntroScreen.State.Five_WheelStay:this.SetState(IntroScreen.State.Five_WheelToTrophy);break;case IntroScreen.State.Five_TrophyStay:this.SetState(IntroScreen.State.Five_TrophyToWinner);break;case IntroScreen.State.Five_WinnerStay:this.SetState(IntroScreen.State.Five_WinnerHide)}}},{key:"OnSkipButtonPressed",value:function OnSkipButtonPressed(){IntroScreen.hasPlayed=!0,a.Instance.StartTransitionScene(E,this.OnContinueTransitionComplete,this)}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){a.Instance.StartTransitionScene(E,this.OnBackTransitionComplete,this)}},{key:"OnBackTransitionComplete",value:function OnBackTransitionComplete(){this.showTween&&this.showTween.stop(),this.hideTween&&this.hideTween.stop(),h.Instance.StopLayer("sfx_intro"),this.scene.SetScreenState(er.ScreenState.Title),this.Stop()}},{key:"OnIntroComplete",value:function OnIntroComplete(){IntroScreen.hasPlayed=!0,a.Instance.StartTransitionScene(E,this.OnContinueTransitionComplete,this)}},{key:"OnContinueTransitionComplete",value:function OnContinueTransitionComplete(){h.Instance.StopLayer("sfx_intro"),this.scene.SetScreenState(er.ScreenState.PlayerSelect),this.Stop()}},{key:"Stop",value:function Stop(){this.introSequence1.removeAllListeners(),this.introSequence2.removeAllListeners(),this.introSequence3.removeAllListeners(),this.introSequence4.removeAllListeners(),this.introSequence5.removeAllListeners(),this.introSequence1.setAnimation(0,"default"),this.introSequence2.setAnimation(0,"default"),this.introSequence3.setAnimation(0,"default"),this.introSequence4.setAnimation(0,"default"),this.introSequence5.setAnimation(0,"default")}}]),IntroScreen}();function Board_typeof(e){return(Board_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Board_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Board_possibleConstructorReturn(e,t){return!t||"object"!==Board_typeof(t)&&"function"!=typeof t?Board_assertThisInitialized(e):t}function Board_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Board_get(e,t,n){return(Board_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function Board_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Board_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Board_getPrototypeOf(e){return(Board_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Board_setPrototypeOf(e,t){return(Board_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}IntroScreen_defineProperty(Bt,"hasPlayed",!1),IntroScreen_defineProperty(Bt,"State",Object.freeze({One:1,Two:2,Three:3,Four:4,Five:5,Five_DiceStay:51,Five_DiceToWheel:52,Five_WheelStay:53,Five_WheelToTrophy:54,Five_TrophyStay:55,Five_TrophyToWinner:56,Five_WinnerStay:57,Five_WinnerHide:58}));var Mt=function(){function Board(e,t,n){var r;!function Board_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Board),n||(n={});var o=n.x||0,i=n.y||0;r=Board_possibleConstructorReturn(this,Board_getPrototypeOf(Board).call(this,e,o,i)),I.AddChild(Board_assertThisInitialized(r),t);var a=n.data;if(!a)return console.error("No data, son."),Board_possibleConstructorReturn(r);I.ConvertTiledProperties(a),r.dice=n.dice,r.dice.on("ready",r.OnDiceReady,Board_assertThisInitialized(r)),r.dice.on("roll",r.OnRoll,Board_assertThisInitialized(r)),r.tileLookup={},r.content=r.scene.add.container(),r.add(r.content);for(var s=0,l=0,c=a.tilesets[0].tiles,u={path:r.CreatePathLayer},p=0,h=a.layers.length;p<h;p++){var y=a.layers[p],f=(u[y.name]||r.CreateLayer).call(Board_assertThisInitialized(r),y,c);f.x>s&&(s=f.x),f.y>l&&(l=f.y)}r.startTile=r.tileLookup[a.properties.start],r.content.setPosition(.5*-s,.5*-l),r.depthContent=r.scene.add.container(),r.content.add(r.depthContent),r.CreateBackgroundCharacters(),r.players=[];for(var d=0;d<2;d++){var g=new It(r.scene,r.depthContent,{data:r.scene.sys.settings.data.gameData.players[d],playerNumber:d,playerController:d<r.scene.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});g.on("rollInput",r.OnPlayerRollInput,Board_assertThisInitialized(r)),g.on("branchInput",r.OnPlayerBranchInput,Board_assertThisInitialized(r)),g.on("moveHalfway",r.OnPlayerMoveHalfway,Board_assertThisInitialized(r)),g.on("moveFinished",r.OnPlayerMoveFinished,Board_assertThisInitialized(r)),g.on("teleportComplete",r.OnPlayerTeleportComplete,Board_assertThisInitialized(r)),g.on("freezeComplete",r.OnPlayerTurnComplete,Board_assertThisInitialized(r)),g.on("frozenTurnComplete",r.OnPlayerFrozenTurnComplete,Board_assertThisInitialized(r)),r.players.push(g)}return r.trophy=new xt(r.scene,r.depthContent),r.trophy.on("appearComplete",r.OnTrophyAppearComplete,Board_assertThisInitialized(r)),r.trophy.on("disappearComplete",r.OnTrophyDisappearComplete,Board_assertThisInitialized(r)),r.trophy.on("purchaseFailed",r.OnTrophyPurchaseFailed,Board_assertThisInitialized(r)),r.trophyAppearIds=[104,102,93,105,101,92],r.trophyAppearIndex=0,r.state=Board.State.Idle,r.currentPlayerIndex=0,r.roundFinished=!1,r.count=0,r.isExistingGame=!1,r.hasRoundNotified=!1,r.camera=new wt(r.scene),r}return function Board_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Board_setPrototypeOf(e,t)}(Board,Phaser.GameObjects.Container),function Board_createClass(e,t,n){return t&&Board_defineProperties(e.prototype,t),n&&Board_defineProperties(e,n),e}(Board,[{key:"update",value:function update(e,t){Board_get(Board_getPrototypeOf(Board.prototype),"update",this).call(this,e,t);for(var n=.001*t,r=0,o=this.players.length;r<o;r++){this.players[r].update(e,t)}switch(this.camera.update(e,t),this.trophy.update(e,t),this.state){case Board.State.Moving:this.UpdateMoving(n)}this.depthContent.sort("y")}},{key:"UpdateMoving",value:function UpdateMoving(){var e=this.GetCurrentPlayerPosition();this.camera.SetPosition(e.x,e.y)}},{key:"CreateLayer",value:function CreateLayer(e,t){for(var n=new Phaser.Math.Vector2,r=0,o=e.objects.length;r<o;r++){var i=e.objects[r],a=this.CreateTile(i,t),s=(a.x+.5*a.frame.width)*this.scene.gameScale,l=(a.y+.5*a.frame.height)*this.scene.gameScale;switch(s>n.x&&(n.x=s),l>n.y&&(n.y=l),i.type){case"billboard":var c=this.scene.add.text(a.x,a.y-65*this.scene.gameScale,v.Instance.GetString("play!"),{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:20*this.scene.gameScale+"px",color:"#FFF"});c.setOrigin(.5),c.setStroke("#000",4*this.scene.gameScale),I.ClampTextToDimensions(c,70*this.scene.gameScale,50*this.scene.gameScale),this.content.add(c);var u=this.scene.add.rectangle(a.x,a.y+5*this.scene.gameScale,115*this.scene.gameScale,115*this.scene.gameScale,16776960,0);u.setOrigin(.5),u.setInteractive(),u.on("pointerdown",Pr.Instance.LoadAppLink,Pr.Instance),this.content.add(u)}}return n}},{key:"CreateTile",value:function CreateTile(e,t){var n=this.GetTileFrameName(e,t),r=this.GetTileFrameData(n),o=(e.x||0)*this.scene.gameScale+.5*r.sourceSize.w,i=(e.y||0)*this.scene.gameScale-.5*r.sourceSize.h,a=this.scene.add.sprite(o,i,"board_atlas",n);return a.setOrigin(.5),a.setScale(1.01),this.content.add(a),a}},{key:"CreatePathLayer",value:function CreatePathLayer(e,t){for(var n=new Phaser.Math.Vector2,r=[],o=0,i=e.objects.length;o<i;o++){var a=e.objects[o];I.ConvertTiledProperties(a);var s=this.GetTileFrameName(a,t),l=this.GetTileFrameData(s),c=a.x*this.scene.gameScale+.5*l.frame.w,u=a.y*this.scene.gameScale-.5*l.frame.h,p=a.id,h=[],y=a.properties&&a.properties.type;if(a.properties)for(var f=1;f<=3;f++){var d=a.properties["path"+f];void 0!==d&&h.push(d)}var g=new kt(this.scene,this,this.content,{x:c,y:u,frame:s,tileId:p,paths:h,type:y});this.tileLookup[p]=g,r.push(g),c>n.x&&(n.x=c),u>n.y&&(n.y=u)}for(var m=0,_=r.length;m<_;m++)for(var P=r[m],b=0,S=P.paths.length;b<S;b++){var O=P.paths[b],v=this.tileLookup[O];if(P.paths[b]=v){var w=.5*(P.x+v.x),T=.5*(P.y+v.y),C=this.scene.add.sprite(w,T,void 0);Math.abs(v.x-P.x)>Math.abs(v.y-P.y)?v.x>P.x?C.setTexture("board_atlas","level_dashline_triangle_right.png"):C.setTexture("board_atlas","level_dashline_triangle_left.png"):v.y>P.y?C.setTexture("board_atlas","level_dashline_triangle_down.png"):C.setTexture("board_atlas","level_dashline_triangle_up.png"),C.setOrigin(.5),this.content.add(C)}}return n}},{key:"GetTileFrameName",value:function GetTileFrameName(e,t){var n=t[e.gid-1].image,r=n.lastIndexOf("/");return n.substring(r+1)}},{key:"GetTileFrameData",value:function GetTileFrameData(e){var t=this.scene.cache.json.get("board_atlas");return t&&t.frames[e]}},{key:"StartGame",value:function StartGame(){if(this.hasRoundNotified)if(this.isExistingGame){var e=this.GetCurrentPlayerPosition();this.camera.TweenPosition(e.x,e.y,this.OnPlayerTurnCameraTransitionComplete,this)}else this.StartTrophyAppear();else this.hasRoundNotified=!0,this.StartRoundNotifier()}},{key:"GetCurrentPlayer",value:function GetCurrentPlayer(){return this.players[this.currentPlayerIndex]}},{key:"GetCurrentPlayerPosition",value:function GetCurrentPlayerPosition(e){var t=this.GetCurrentPlayer(),n=this.x+this.content.x+t.x,r=this.y+this.content.y+t.y;return e?e.setTo(n,r):e=new Phaser.Math.Vector2(n,r),e}},{key:"OnPlayerRollInput",value:function OnPlayerRollInput(e){this.state=Board.State.Rolling,this.dice.DoRoll(),this.emit("hideRollUI",e)}},{key:"OnDiceReady",value:function OnDiceReady(){this.GetCurrentPlayer().playerAI||this.emit("showRollUI")}},{key:"OnRoundNotifierComplete",value:function OnRoundNotifierComplete(){this.StartGame()}},{key:"OnRollButtonDown",value:function OnRollButtonDown(){this.dice.PopDown()}},{key:"OnRoll",value:function OnRoll(e){this.state=Board.State.Moving,this.count=e;var t=this.GetCurrentPlayer();this.StartPlayerMove(t,t.tile)}},{key:"OnPlayerBranchInput",value:function OnPlayerBranchInput(e,t){this.state=Board.State.Moving,this.emit("hideBranchUI",e),e.MoveToNextTile(t)}},{key:"OnPlayerMoveHalfway",value:function OnPlayerMoveHalfway(e,t,n){this.trophy.prevTileId==t.tileId&&this.trophy.nextTileId==n.tileId&&(e.PauseMove(),this.emit("showTrophyPopup",e,this.trophy))}},{key:"AttemptTrophyPurchase",value:function AttemptTrophyPurchase(){this.trophy.AttemptPurchase(this.GetCurrentPlayer())}},{key:"StartPlayerMove",value:function StartPlayerMove(e,t){this.count--,t.paths.length<=1?(e.steps++,e.MoveToNextTile()):(e.animation.SetState(Ct.State.Idle),this.StartPlayerBranchInput(e))}},{key:"OnPlayerMoveFinished",value:function OnPlayerMoveFinished(e,t,n){if(this.dice.StepNumber(),this.count<=0)return e.animation.SetState(Ct.State.Idle),e.tile=n,void e.tile.OnPlayerLanded(e);e.tile.OnPlayerPass(e),this.StartPlayerMove(e,n)}},{key:"OnPlayerTeleportComplete",value:function OnPlayerTeleportComplete(e){e.tile.OnPlayerStopped(e),this.OnPlayerTurnComplete(e)}},{key:"OnPlayerTurnComplete",value:function OnPlayerTurnComplete(e){this.emit("turnFinished",e);var t=(this.currentPlayerIndex+1)%this.players.length;if(0<t){this.currentPlayerIndex=t,this.state=Board.State.Idle;var n=this.GetCurrentPlayerPosition();this.camera.TweenPosition(n.x,n.y,this.OnPlayerTurnCameraTransitionComplete,this)}else this.RoundFinished()}},{key:"OnPlayerFrozenTurnComplete",value:function OnPlayerFrozenTurnComplete(e){e.isFrozen?this.OnPlayerTurnComplete(e):this.StartPlayerTurn(e)}},{key:"OnPlayerTurnCameraTransitionComplete",value:function OnPlayerTurnCameraTransitionComplete(){var e=this.GetCurrentPlayer();switch(e.state){case It.State.Moving:this.state=Board.State.Moving,e.ResumeMove();break;default:this.StartPlayerTurnNotifier(e)}}},{key:"OnTrophyPurchaseFailed",value:function OnTrophyPurchaseFailed(e){e.ResumeMove()}},{key:"StartRoundNotifier",value:function StartRoundNotifier(){this.state=Board.State.RoundNotifier,this.emit("showRoundNotifier")}},{key:"StartTrophyAppear",value:function StartTrophyAppear(){this.state=Board.State.TrophyAppear;var e=this.tileLookup[this.trophyAppearIds[this.trophyAppearIndex]];this.trophyAppearIndex=(this.trophyAppearIndex+1)%this.trophyAppearIds.length,this.trophy.Appear(e),this.camera.SetPosition(this.x+this.content.x+this.trophy.x,this.y+this.content.y+this.trophy.y-50*this.scene.gameScale)}},{key:"OnTrophyAppearComplete",value:function OnTrophyAppearComplete(){var e=this.GetCurrentPlayerPosition();this.camera.TweenPosition(e.x,e.y,this.OnPlayerTurnCameraTransitionComplete,this)}},{key:"OnTrophyDisappearComplete",value:function OnTrophyDisappearComplete(){this.StartTrophyAppear()}},{key:"OnPlayerTurnNotifierComplete",value:function OnPlayerTurnNotifierComplete(){this.StartPlayerTurn(this.GetCurrentPlayer())}},{key:"StartPlayerTurnNotifier",value:function StartPlayerTurnNotifier(e){this.emit("showPlayerTurnNotifier",e)}},{key:"StartPlayerTurn",value:function StartPlayerTurn(e){this.emit("turnStart",e),this.state=Board.State.Idle,e.isFrozen?e.OnFrozenTurn():this.StartPlayerRollInput(e)}},{key:"StartPlayerRollInput",value:function StartPlayerRollInput(e){this.state=Board.State.Idle,e||(e=this.GetCurrentPlayer());var t=e.StartInput(It.State.Roll);this.dice.Show(t)}},{key:"StartPlayerBranchInput",value:function StartPlayerBranchInput(e){this.state=Board.State.Branch,e||(e=this.GetCurrentPlayer()),e.StartInput(It.State.Branch)&&this.emit("showBranchUI",e)}},{key:"StartPlayerChance",value:function StartPlayerChance(e){e.chances++,this.emit("chance")}},{key:"ExecuteChance",value:function ExecuteChance(e){switch(e){case At.ChanceType.RollAgain:var t=this.GetCurrentPlayer();this.StartPlayerRollInput(t);break;case At.ChanceType.Teleport:for(var n=(t=this.GetCurrentPlayer()).tile;(n=n.paths[0]).type!=kt.Type.Chance;);t.Teleport(n);break;case At.ChanceType.Freeze:(t=this.GetCurrentPlayer()).Freeze()}}},{key:"RoundFinished",value:function RoundFinished(){this.roundFinished=!0,this.emit("roundFinished",this)}},{key:"CreateBackgroundCharacters",value:function CreateBackgroundCharacters(){var e=this.scene.add.spine(1507,2041,"minigame_teri","idle",!0);e.setScale(this.scene.gameScale),I.ApplyWinterSkin(e),this.depthContent.add(e);var t=this.scene.add.spine(1920,1632,"minigame_alan","idle",!0);t.setScale(this.scene.gameScale),I.ApplyWinterSkin(t),this.depthContent.add(t);var n=this.scene.add.spine(2972,1260,"minigame_bananajoe","idle",!0);n.setScale(this.scene.gameScale),I.ApplyWinterSkin(n),this.depthContent.add(n);var r=this.scene.add.spine(2083,1230,"minigame_brown","idle",!0);r.setScale(this.scene.gameScale),I.ApplyWinterSkin(r),this.depthContent.add(r);var o=this.scene.add.spine(2806,1644,"minigame_carmen","idle",!0);o.setScale(this.scene.gameScale),I.ApplyWinterSkin(o),this.depthContent.add(o)}},{key:"LoadData",value:function LoadData(){for(var e=p.Instance.GetData("Board"),t=0;t<this.players.length;t++)this.players[t].LoadData(this,e?e.players[t]:null);this.trophy.LoadData(e?e.trophy:null),this.currentPlayerIndex=e?1:0;this.GetCurrentPlayer();var n=this.GetCurrentPlayerPosition();this.camera.SetPosition(n.x,n.y),this.currentPlayerIndex=0,e&&(this.isExistingGame=e.isExistingGame,this.trophyAppearIndex=e.trophyAppearIndex),this.StartGame()}},{key:"SaveData",value:function SaveData(){for(var e=[],t=0;t<this.players.length;t++)e[t]=this.players[t].SaveData();p.Instance.SaveData("Board",{players:e,trophy:this.trophy.SaveData(),trophyAppearIndex:this.trophyAppearIndex,isExistingGame:!0})}}]),Board}();function BoardDice_typeof(e){return(BoardDice_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardDice_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardDice_getPrototypeOf(e){return(BoardDice_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardDice_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardDice_setPrototypeOf(e,t){return(BoardDice_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function Board_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Mt,"State",Object.freeze({Idle:0,RoundNotifier:1,Rolling:2,Rolled:3,Moving:4,TrophyAppear:5,Chance:6,Branch:7,GameOver:8}));var Dt=function(){function BoardDice(e,t,n){var r;return function BoardDice_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardDice),n||(n={}),r=function BoardDice_possibleConstructorReturn(e,t){return!t||"object"!==BoardDice_typeof(t)&&"function"!=typeof t?BoardDice_assertThisInitialized(e):t}(this,BoardDice_getPrototypeOf(BoardDice).call(this,e)),I.AddChild(BoardDice_assertThisInitialized(r),t),r.diceSpine=r.scene.add.spine(.5*r.scene.scale.width,r.scene.scale.height,"dice_roller","6",!0),r.diceSpine.setScale(r.scene.gameScale),r.add(r.diceSpine),r.numberText=r.scene.add.text(.5*r.scene.scale.width,.5*r.scene.scale.height,"6",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:300*r.scene.gameScale+"px",color:"#FF0000"}).setStroke("#000000",10*r.scene.gameScale),r.numberText.setOrigin(.5),r.numberText.setScale(0),r.add(r.numberText),r.state=BoardDice.State.Idle,r.visible=!1,r}return function BoardDice_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardDice_setPrototypeOf(e,t)}(BoardDice,Phaser.GameObjects.Container),function BoardDice_createClass(e,t,n){return t&&BoardDice_defineProperties(e.prototype,t),n&&BoardDice_defineProperties(e,n),e}(BoardDice,[{key:"update",value:function update(){}},{key:"Show",value:function Show(){this.numberText.setScale(0),this.visible=!0,this.diceSpine.y=this.scene.scale.height+210*this.scene.gameScale,this.scene.tweens.add({targets:this.diceSpine,y:this.scene.scale.height,duration:400,ease:"Sine.easeOut",onComplete:this.OnShowComplete,onCompleteScope:this})}},{key:"Hide",value:function Hide(){this.scene.tweens.add({targets:this.diceSpine,y:this.scene.scale.height+210*this.scene.gameScale,duration:400,delay:200,ease:"Sine.easeIn",onComplete:this.OnHideComplete,onCompleteScope:this})}},{key:"OnShowComplete",value:function OnShowComplete(){this.emit("ready")}},{key:"PopDown",value:function PopDown(){this.diceSpine.setScale(.9*this.scene.gameScale)}},{key:"PopUp",value:function PopUp(){this.diceSpine.setScale(1*this.scene.gameScale)}},{key:"DoRoll",value:function DoRoll(){this.PopUp(),this.state=BoardDice.State.Rolling,this.timer=0,h.Instance.Play("sfx_boardgame","board_roll_die"),this.diceSpine.setAnimation(0,"roll",!1),this.diceSpine.once("spine.complete",this.OnRollComplete,this),this.roll=Phaser.Math.Between(1,6)}},{key:"OnRollComplete",value:function OnRollComplete(){6==this.roll&&h.Instance.Play("sfx_boardgame","board_roll_six"),this.numberText.setText(this.roll),this.numberText.y=this.scene.scale.height,this.scene.tweens.add({targets:this.numberText,scaleX:{value:1,duration:500,yoyo:!0,hold:500,ease:"Sine.easeInOut"},scaleY:{value:1,duration:500,yoyo:!0,hold:500,ease:"Sine.easeInOut"},y:{value:.5*this.scene.scale.height,duration:500,yoyo:!0,hold:500,ease:"Sine.easeOut"},onComplete:this.EmitRoll,onCompleteScope:this}),this.Hide(),this.diceSpine.setAnimation(0,this.roll,!1)}},{key:"EmitRoll",value:function EmitRoll(){this.state=BoardDice.State.Idle,this.emit("roll",this.roll),this.visible=!1}},{key:"StepNumber",value:function StepNumber(){this.roll--}}]),BoardDice}();function MPPIDController_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function BoardDice_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Dt,"State",Object.freeze({Idle:0,Rolling:1}));var jt=function(){function MPPIDController(){!function MPPIDController_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MPPIDController),this.pGain=.05,this.iGain=.9,this.dGain=1e-4,this.input=0,this.target=0,this.output=0,this.integral=0,this.lastError=0}return function MPPIDController_createClass(e,t,n){return t&&MPPIDController_defineProperties(e.prototype,t),n&&MPPIDController_defineProperties(e,n),e}(MPPIDController,[{key:"Tick",value:function Tick(e){var t=this.target-this.input;this.integral=this.integral+t*e;var n=(t-this.lastError)/e;this.output=this.pGain*t+this.iGain*this.integral+this.dGain*n,this.lastError=t}},{key:"Reset",value:function Reset(){this.integral=0,this.lastError=0}}]),MPPIDController}();function MPPIDCarousel_typeof(e){return(MPPIDCarousel_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MPPIDCarousel_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MPPIDCarousel_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MPPIDCarousel_get(e,t,n){return(MPPIDCarousel_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function MPPIDCarousel_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MPPIDCarousel_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MPPIDCarousel_getPrototypeOf(e){return(MPPIDCarousel_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MPPIDCarousel_setPrototypeOf(e,t){return(MPPIDCarousel_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Rt=function(){function MPPIDCarousel(e,t,n){var r;!function MPPIDCarousel_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MPPIDCarousel),n||(n={});var o=void 0!==n.x?n.x:0,i=void 0!==n.y?n.y:0,a=void 0!==n.gainP?n.gainP:20,s=void 0!==n.gainI?n.gainI:.04,l=void 0!==n.gainD?n.gainD:6,c=void 0!==n.entries?n.entries:[],u=void 0!==n.angle?n.angle:0,p=void 0!==n.separation?n.separation:800,h=void 0===n.disableOffscreen||n.disableOffscreen,y=void 0!==n.wrapEntries&&n.wrapEntries,f=void 0!==n.maxVelocity?n.maxVelocity:1500,d=void 0!==n.swipeMultiplier?n.swipeMultiplier:3,g=void 0!==n.updateEntryDist?n.updateEntryDist:400,m=void 0!==n.clampDistance?n.clampDistance:1/0,_=void 0!==n.minDisableDist?n.minDisableDist:64,P=void 0!==n.touchBoundsRect?n.touchBoundsRect:null;r=function MPPIDCarousel_possibleConstructorReturn(e,t){return!t||"object"!==MPPIDCarousel_typeof(t)&&"function"!=typeof t?MPPIDCarousel_assertThisInitialized(e):t}(this,MPPIDCarousel_getPrototypeOf(MPPIDCarousel).call(this,e,o,i)),t&&(t.add.existing?t.add.existing(MPPIDCarousel_assertThisInitialized(r)):t.add(MPPIDCarousel_assertThisInitialized(r))),r.pidController=new jt,r.proportionalGain=a,r.integralGain=s,r.derivativeGain=l,r.content=r.scene.add.container(0,0),r.add(r.content),r.touchBoundsRect=P,r.entries=c,r.entryDirectionAngle=u,r.entrySeparationDistance=p;for(var b=r.selectedIndex=0,S=r.entries.length;b<S;b++){var O=r.entries[b];r.content.add(O)}r.disableOffscreenEntries=h,r.wrapEntries=y,r.wrappingPointValue=0,r.maxVelocity=f,r.swipeVelocityMultiplier=d,r.updateEntryDistance=g,r.clampDistance=m,r.minDisableDistance=_,r.dragHistory=[],r.dragHistory.length=5,r.touchDragStart=new Phaser.Math.Vector2,r.touchDragLast=new Phaser.Math.Vector2,r.contentDragStart=new Phaser.Math.Vector2;var v=r.entryDirection*Phaser.Math.DEG_TO_RAD;return r.entryDirection=new Phaser.Math.Vector2(Math.cos(v),Math.sign(v)),r.velocity=0,r.lastIndex=0,r.touchEnabled=!0,r.ResetEntryPositions(!0),r}return function MPPIDCarousel_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MPPIDCarousel_setPrototypeOf(e,t)}(MPPIDCarousel,Phaser.GameObjects.Container),function MPPIDCarousel_createClass(e,t,n){return t&&MPPIDCarousel_defineProperties(e.prototype,t),n&&MPPIDCarousel_defineProperties(e,n),e}(MPPIDCarousel,[{key:"update",value:function update(e,t){MPPIDCarousel_get(MPPIDCarousel_getPrototypeOf(MPPIDCarousel.prototype),"update",this).call(this,e,t);var n=.001*t;this.UpdateVelocity(n),this.wrapEntries&&this.UpdateWrapping(n),this.UpdateIndex(n),this.PostUpdate(n);for(var r=0,o=this.entries.length;r<o;r++){var i=this.entries[r];i.update&&i.update(e,t)}}},{key:"UpdateVelocity",value:function UpdateVelocity(e){var t=this.GetTouchLocation(),n=t.dot(this.entryDirection),r=new Phaser.Math.Vector2(this.content.x,this.content.y),o=r.dot(this.entryDirection);this.touchEnabled&&(this.GetTouchBegan()?this.OnTouchBegan(e,t,n,r,o):this.GetTouchEnded().equals(Phaser.Math.Vector2.ZERO)||this.touchDragStart.equals(Phaser.Math.Vector2.ZERO)||this.OnTouchEnd(e,t,n,r,o)),this.pidController.pGain=this.proportionalGain,this.pidController.iGain=this.integralGain,this.pidController.dGain=this.derivativeGain,this.GetTouched()&&!this.touchDragStart.equals(Phaser.Math.Vector2.ZERO)?this.OnDragging(e,t,n,r,o):this.OnSnapping(e,t,n,r,o);for(var i=n-this.touchDragLast.dot(this.entryDirection),a=this.dragHistory.length-1;0<a;a--)this.dragHistory[a]=this.dragHistory[a-1];this.dragHistory[0]=i,this.touchDragLast=t}},{key:"OnTouchBegan",value:function OnTouchBegan(e,t,n,r){this.IsPosWithinTouchBounds(t)?(this.ClearDragHistory(),this.touchDragStart=t,this.touchDragLast=t,this.contentDragStart=r.clone()):this.touchDragStart.setTo(0,0)}},{key:"OnTouchEnd",value:function OnTouchEnd(e,t,n,r,o){for(var i=1,a=this.dragHistory.length;i<a;i++)0===this.dragHistory[i]&&(this.dragHistory[i]=this.dragHistory[i-1]);for(var s=0,l=0,c=this.dragHistory.length;l<c;l++)s+=this.dragHistory[l];var u=o+(s/=this.dragHistory.length)*this.swipeVelocityMultiplier;u=this.entrySeparationDistance*Math.round(u/this.entrySeparationDistance),this.wrapEntries||(u=Phaser.Math.Clamp(u,-(this.entries.length-1)*this.entrySeparationDistance,0)),this.pidController.target=u;for(var p=0,h=this.entries.length;p<h;p++){var y=this.entries[p];y.Enable&&y.Enable()}this.touchDragStart.setTo(0)}},{key:"OnDragging",value:function OnDragging(e,t,n){var r=this.contentDragStart.dot(this.entryDirection)+(n-this.touchDragStart.dot(this.entryDirection));if(this.wrapEntries||(r=Phaser.Math.Clamp(r,-(this.entries.length-1)*this.entrySeparationDistance-this.clampDistance,this.clampDistance)),this.content.setPosition(this.entryDirection.x*r,this.entryDirection.y*r),t.distance(this.touchDragStart)>this.minDisableDistance)for(var o=0,i=this.entries.length;o<i;o++){var a=this.entries[o];a.Disable&&a.Disable()}}},{key:"OnSnapping",value:function OnSnapping(e,t,n,r,o){if(this.selectedIndex!=this.lastIndex){var i=this.selectedIndex*this.entrySeparationDistance;if(this.wrapEntries){var a=new Phaser.Math.Vector2(-this.content.x,-this.content.y).dot(this.entryDirection);if(Math.abs(i-a)/this.entrySeparationDistance>this.entries.length/2)i-=(0<=i-a?1:-1)*this.entrySeparationDistance*this.entries.length}this.pidController.target=-i}this.pidController.input=o,this.pidController.Tick(e);var s=this.pidController.output;this.content.setPosition(this.content.x+this.entryDirection.x*(this.velocity*e),this.content.y+this.entryDirection.y*(this.velocity*e)),this.velocity+=s*e,this.velocity=Phaser.Math.Clamp(this.velocity,-this.maxVelocity,this.maxVelocity)}},{key:"UpdateWrapping",value:function UpdateWrapping(){var e,t=new Phaser.Math.Vector2(-this.content.x,-this.content.y),n=t.dot(this.entryDirection),r=this.entries.length,o=new Phaser.Math.Vector2(this.entryDirection.x*r*this.entrySeparationDistance,this.entryDirection.y*r*this.entrySeparationDistance);if(n<=-.5*this.entrySeparationDistance)for(this.pidController.target-=r*this.entrySeparationDistance,this.content.setPosition(this.content.x-o.x,this.content.y-o.y),this.contentDragStart.subtract(o),e=0;e<r;e++){var i=this.entries[e];i.setPosition(i.x+o.x,i.y+o.y)}else if(n>=this.entrySeparationDistance*(this.entries.length-.5))for(this.pidController.target+=this.entries.length*this.entrySeparationDistance,this.content.setPosition(this.content.x+o.x,this.content.y+o.y),this.contentDragStart.add(o),e=0;e<r;e++){var a=this.entries[e];a.setPosition(a.x-o.x,a.y-o.y)}for(n=(t=new Phaser.Math.Vector2(-this.content.x,-this.content.y)).dot(this.entryDirection),e=0;e<r;e++){var s=this.entries[e],l=new Phaser.Math.Vector2(s.x,s.y).dot(this.entryDirection)-n-this.wrappingPointValue,c=Math.floor(l/this.entrySeparationDistance);if(Math.abs(c)>.5*this.entries.length){var u=0<=c?1:-1;s.setPosition(s.x-u*o.x,s.y-u*o.y)}}}},{key:"UpdateIndex",value:function UpdateIndex(){var e=new Phaser.Math.Vector2(-this.content.x,-this.content.y).dot(this.entryDirection),t=Phaser.Math.Clamp(Math.round(e/this.entrySeparationDistance),0,this.entries.length-1);t!=this.lastIndex&&(this.selectedIndex=t,this.lastIndex=this.selectedIndex,this.emit("indexChanged",this.selectedIndex))}},{key:"PostUpdate",value:function PostUpdate(){for(var e=new Phaser.Math.Vector2(-this.content.x,-this.content.y).dot(this.entryDirection),t=0,n=this.entries.length;t<n;t++){var r=this.entries[t];if(r&&r.exists){var o=t*this.entrySeparationDistance,i=0<=o-e?1:-1;this.wrapEntries&&Math.abs(o-e)/this.entrySeparationDistance>.5*n&&(o-=i*this.entrySeparationDistance*n);var a=Phaser.Math.Clamp(1-Math.abs(o-e)/this.updateEntryDistance,0,1);i=0<=o-e?1:-1,this.UpdateEntry(r,a,i,o)}}}},{key:"UpdateEntry",value:function UpdateEntry(){}},{key:"ResetCarousel",value:function ResetCarousel(){this.lastIndex=this.selectedIndex,this.velocity=0,this.ClearDragHistory(),this.content.setPosition(this.selectedIndex*(-this.entrySeparationDistance*this.entryDirection.x),this.selectedIndex*(-this.entrySeparationDistance*this.entryDirection.y)),this.pidController.target=this.selectedIndex*-this.entrySeparationDistance,this.pidController.Reset()}},{key:"ResetEntryPositions",value:function ResetEntryPositions(){var e=this.entryDirectionAngle*Phaser.Math.DEG_TO_RAD;this.entryDirection.setTo(Math.cos(e),Math.sin(e));for(var t=0,n=this.entries.length;t<n;t++){this.entries[t].setPosition(this.entryDirection.x*this.entrySeparationDistance*t,this.entryDirection.y*this.entrySeparationDistance*t)}}},{key:"ClearDragHistory",value:function ClearDragHistory(){for(var e=0,t=this.dragHistory.length;e<t;e++)this.dragHistory[e]=0}},{key:"IncrementIndex",value:function IncrementIndex(){this.wrapEntries?(this.selectedIndex++,this.selectedIndex%=this.entries.length):(this.selectedIndex++,Phaser.Math.Clamp(this.selectedIndex,0,this.entries.length-1))}},{key:"DecrementIndex",value:function DecrementIndex(){this.wrapEntries?(this.selectedIndex--,this.selectedIndex<0&&(this.selectedIndex+=this.entries.length)):(this.selectedIndex--,Phaser.Math.Clamp(this.selectedIndex,0,this.entries.length-1))}},{key:"GetTouchBegan",value:function GetTouchBegan(){var e=this.scene.time.now-this.scene.input.activePointer.downTime;return 0<=e?e<this.scene.game.loop.delta:(e=Date.now()-this.scene.input.activePointer.downTime)<1.1*this.scene.game.loop.delta}},{key:"GetTouched",value:function GetTouched(){return this.scene.input.activePointer.isDown}},{key:"GetTouchEnded",value:function GetTouchEnded(){var e=this.scene.input.activePointer,t=this.scene.time.now-e.upTime;if(0<=t){if(t>=this.scene.game.loop.delta)return new Phaser.Math.Vector2}else if((t=Date.now()-e.upTime)>=1.1*this.scene.game.loop.delta)return new Phaser.Math.Vector2;return new Phaser.Math.Vector2(e.upX,e.upY)}},{key:"GetTouchLocation",value:function GetTouchLocation(){var e=this.scene.input.activePointer;return new Phaser.Math.Vector2(e.x,e.y)}},{key:"IsPosWithinTouchBounds",value:function IsPosWithinTouchBounds(e){return!this.touchBoundsRect||this.touchBoundsRect.contains(e.x,e.y)}}]),MPPIDCarousel}();function BoardMinigamePopup_typeof(e){return(BoardMinigamePopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardMinigamePopup_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardMinigamePopup_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardMinigamePopup_get(e,t,n){return(BoardMinigamePopup_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BoardMinigamePopup_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BoardMinigamePopup_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BoardMinigamePopup_getPrototypeOf(e){return(BoardMinigamePopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardMinigamePopup_setPrototypeOf(e,t){return(BoardMinigamePopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Et=function(){function BoardMinigamePopup(e,t,n){var r;!function BoardMinigamePopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardMinigamePopup),n||(n={});var o=n.x||0,i=n.y||0,a=n.minigames||[],s=n.minigameIndex||0;r=function BoardMinigamePopup_possibleConstructorReturn(e,t){return!t||"object"!==BoardMinigamePopup_typeof(t)&&"function"!=typeof t?BoardMinigamePopup_assertThisInitialized(e):t}(this,BoardMinigamePopup_getPrototypeOf(BoardMinigamePopup).call(this,e,o,i)),I.AddChild(BoardMinigamePopup_assertThisInitialized(r),t),r.overlay=r.scene.add.graphics(),r.overlay.fillStyle("0x000000",.5),r.overlay.fillRect(.5*-r.scene.scale.width,.5*-r.scene.scale.height,r.scene.scale.width,r.scene.scale.height),r.add(r.overlay),r.popupContainer=r.scene.add.container(),r.add(r.popupContainer),r.wheelBackground=r.scene.add.sprite(0,0,"board_ui_atlas","wheel_base.png"),r.popupContainer.add(r.wheelBackground),r.wheelContainer=r.scene.add.container(),r.popupContainer.add(r.wheelContainer),r.wheel=r.scene.add.sprite(0,0,"board_ui_atlas","wheel_wheel.png"),r.wheel.setInteractive({useHandCursor:!0}),r.wheel.on("pointerdown",r.OnWheelInputDown,BoardMinigamePopup_assertThisInitialized(r)),r.wheel.on("pointerup",r.OnWheelInputUp,BoardMinigamePopup_assertThisInitialized(r)),r.wheel.on("pointerout",r.OnWheelInputUp,BoardMinigamePopup_assertThisInitialized(r)),r.wheelContainer.add(r.wheel),r.quadrantContainer=r.scene.add.container(),r.wheelContainer.add(r.quadrantContainer),r.wheelClicker=r.scene.add.sprite(0,-290*r.scene.gameScale,"board_ui_atlas","wheel_clicker.png"),r.wheelClicker.setOrigin(.5,.3),r.popupContainer.add(r.wheelClicker),r.arrowPrompt=r.scene.add.sprite(0,0,"board_ui_atlas","wheel_arrow.png"),r.arrowPrompt.setOrigin(-.32,.88),r.arrowPrompt.visible=!1,r.popupContainer.add(r.arrowPrompt),r.quadrantHighlight=r.scene.add.sprite(80*r.scene.gameScale,145*r.scene.gameScale,"board_ui_atlas","wheel_glow_sector.png"),r.quadrantContainer.add(r.quadrantHighlight),r.minigame=a[s],r.segmentIndex=Phaser.Math.RND.integerInRange(0,7),r.minigameIndexes=[];for(var l=0;l<a.length;l++)a[l]!=r.minigame&&r.minigameIndexes.push(l);I.ShuffleArray(r.minigameIndexes),r.state=BoardMinigamePopup.State.Off,r.visible=!1,r.activePointer=null,r.isSwipingClockwise=!1,r.swipeTimer=0,r.swipeTimeForSpin=.05,r.maxSpinSpeed=.15,r.spinSpeed=r.maxSpinSpeed,r.targetLandAngle=0,r.segmentCount=8,r.segmentAngleSize=360/r.segmentCount,r.prevWheelAngle=r.wheel.angle,r.currentRotations=0,r.targetRotations=2;for(l=0;l<r.segmentCount;l++){var c;c=l==r.segmentIndex?r.scene.add.sprite(0,0,"board_ui_atlas",r.minigame.wheelIcon):r.scene.add.sprite(0,0,"board_ui_atlas",a[r.minigameIndexes[l]].wheelIcon);var u=175*r.scene.gameScale;c.angle=r.segmentAngleSize*l-90-.5*r.segmentAngleSize,c.setPosition(Math.cos(c.rotation)*u,Math.sin(c.rotation)*u),c.angle+=90,r.wheelContainer.add(c)}return r.quadrantContainer.angle=r.segmentIndex*r.segmentAngleSize+180,r}return function BoardMinigamePopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardMinigamePopup_setPrototypeOf(e,t)}(BoardMinigamePopup,Phaser.GameObjects.Container),function BoardMinigamePopup_createClass(e,t,n){return t&&BoardMinigamePopup_defineProperties(e.prototype,t),n&&BoardMinigamePopup_defineProperties(e,n),e}(BoardMinigamePopup,[{key:"update",value:function update(e,t){if(this.visible)switch(BoardMinigamePopup_get(BoardMinigamePopup_getPrototypeOf(BoardMinigamePopup.prototype),"update",this).call(this,e,t),this.state){case BoardMinigamePopup.State.On:this.UpdateOnState(e,t);break;case BoardMinigamePopup.State.Spinning:this.UpdateSpinningState(e,t)}}},{key:"UpdateOnState",value:function UpdateOnState(e,t){if(this.activePointer){var n=Phaser.Math.RadToDeg(Math.atan2(this.activePointer.prevPosition.y-this.y,this.activePointer.prevPosition.x-this.x)),r=Phaser.Math.RadToDeg(Math.atan2(this.activePointer.position.y-this.y,this.activePointer.position.x-this.x)),o=I.GetAngleDifference(r,n);this.isSwipingClockwise=0<o,this.isSwipingClockwise?(this.swipeTimer+=.001*t,this.swipeTimer>=this.swipeTimeForSpin&&this.Spin()):this.swipeTimer=0}}},{key:"UpdateSpinningState",value:function UpdateSpinningState(e,t){this.wheelContainer.angle+=t*this.spinSpeed;var n=I.GetAngleDifference(this.prevWheelAngle,this.targetLandAngle),r=I.GetAngleDifference(this.wheelContainer.angle,this.targetLandAngle);this.prevWheelAngle=this.wheelContainer.angle,Math.abs(r)<45&&n<0&&0<=r&&(this.currentRotations++,this.currentRotations==this.targetRotations&&this.scene.tweens.add({targets:this,spinSpeed:0,duration:1/this.maxSpinSpeed*985,ease:"Sine.easeOut",onComplete:this.OnSpinComplete,onCompleteScope:this}));var o=120/this.segmentCount,i=0<this.wheelContainer.angle?this.wheelContainer.angle:360+this.wheelContainer.angle,a=I.NearestMultiple(i,o)-i,s=Phaser.Math.Linear(0,-6.5,5-Math.min(5,a));0!=this.wheelClicker.angle&&0==s&&h.Instance.Play("sfx_boardgame","wheel_spin_click_0"+Phaser.Math.RND.integerInRange(1,7)),this.wheelClicker.angle=s}},{key:"Show",value:function Show(){this.visible=!0,this.overlay.alpha=0,this.popupContainer.setScale(0),this.currentRotations=0,this.quadrantHighlight.visible=!1,this.state=BoardMinigamePopup.State.Showing,this.scene.tweens.add({targets:this.overlay,alpha:1,duration:750,ease:"Sine.easeOut"}),this.scene.tweens.add({targets:this.popupContainer,scaleX:1,scaleY:1,duration:750,ease:"Back.easeOut",onComplete:this.OnShowComplete,onCompleteScope:this})}},{key:"Hide",value:function Hide(){this.visible=!1}},{key:"OnShowComplete",value:function OnShowComplete(){this.state=BoardMinigamePopup.State.On,this.arrowPrompt.visible=!0;this.scene.tweens.add({targets:this.arrowPrompt,angle:{value:90,duration:1e3,ease:"Cubic.easeOut"},repeat:-1})}},{key:"OnWheelInputDown",value:function OnWheelInputDown(e){this.activePointer=e,this.swipeTimer=0}},{key:"OnWheelInputUp",value:function OnWheelInputUp(){this.activePointer=null,this.swipeTimer=0}},{key:"Spin",value:function Spin(){this.scene.tweens.killTweensOf(this.arrowPrompt),this.arrowPrompt.visible=!1,this.state=BoardMinigamePopup.State.Spinning,this.spinSpeed=this.maxSpinSpeed,this.currentRotations=0,this.targetLandAngle=-this.segmentIndex*this.segmentAngleSize+.5*this.segmentAngleSize,this.emit("spin"),h.Instance.Play("sfx_boardgame","wheel_spin")}},{key:"OnSpinComplete",value:function OnSpinComplete(){this.scene.tweens.add({targets:this.quadrantHighlight,alpha:1,yoyo:!0,repeat:3,duration:250,ease:"Linear"}),h.Instance.Play("sfx_boardgame","wheel_spin_result"),this.quadrantHighlight.visible=!0,this.quadrantHighlight.alpha=0,this.emit("minigameChosen")}}]),BoardMinigamePopup}();function BoardPlayerScorePanel_typeof(e){return(BoardPlayerScorePanel_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardPlayerScorePanel_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardPlayerScorePanel_getPrototypeOf(e){return(BoardPlayerScorePanel_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardPlayerScorePanel_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardPlayerScorePanel_setPrototypeOf(e,t){return(BoardPlayerScorePanel_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function BoardMinigamePopup_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Et,"State",Object.freeze({Off:0,Showing:1,On:2,Spinning:3,Spun:4}));var Ft=function(){function BoardPlayerScorePanel(e,t){var n;return function BoardPlayerScorePanel_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardPlayerScorePanel),(n=function BoardPlayerScorePanel_possibleConstructorReturn(e,t){return!t||"object"!==BoardPlayerScorePanel_typeof(t)&&"function"!=typeof t?BoardPlayerScorePanel_assertThisInitialized(e):t}(this,BoardPlayerScorePanel_getPrototypeOf(BoardPlayerScorePanel).call(this,e))).player=t,n.player.on("setPoints",n.OnPointsChanged,BoardPlayerScorePanel_assertThisInitialized(n)),n.player.on("setTrophies",n.OnTrophiesChanged,BoardPlayerScorePanel_assertThisInitialized(n)),n.pointsCount=t.points,n.trophiesCount=t.trophies,1<n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.TWO?(n.setPosition(.5*n.scene.viewport.width,.5*n.scene.viewport.height),n.background=n.scene.add.sprite(0,0,"board_ui_atlas","player_points_panel_p1_winter.png"),n.background.setOrigin(1,1),n.add(n.background),n.characterHead=n.scene.add.sprite(-195*n.scene.gameScale,-50*n.scene.gameScale,"board_ui_atlas","points_"+t.characterData.id+".png"),n.add(n.characterHead),n.pointsCountText=n.scene.add.text(-50*n.scene.gameScale,-90*n.scene.gameScale,n.pointsCount,{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:30*n.scene.gameScale+"px",color:"#FFFFFF",stroke:"#6e8db4",strokeThickness:2*n.scene.gameScale}),n.pointsCountText.setOrigin(.5),n.add(n.pointsCountText),n.trophiesCountText=n.scene.add.text(-50*n.scene.gameScale,-30*n.scene.gameScale,n.trophiesCount,{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:45*n.scene.gameScale+"px",color:"#FFFFFF",stroke:"#6e8db4",strokeThickness:2*n.scene.gameScale})):(n.setPosition(.5*-n.scene.viewport.width,.5*n.scene.viewport.height),n.background=n.scene.add.sprite(0,0,"board_ui_atlas","player_points_panel_p2_winter.png"),n.background.setOrigin(0,1),n.add(n.background),n.characterHead=n.scene.add.sprite(50*n.scene.gameScale,-50*n.scene.gameScale,"board_ui_atlas","points_"+t.characterData.id+".png"),n.add(n.characterHead),n.pointsCountText=n.scene.add.text(195*n.scene.gameScale,-90*n.scene.gameScale,n.pointsCount,{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:30*n.scene.gameScale+"px",color:"#FFFFFF",stroke:"#6e8db4",strokeThickness:2*n.scene.gameScale}),n.pointsCountText.setOrigin(.5),n.add(n.pointsCountText),n.trophiesCountText=n.scene.add.text(195*n.scene.gameScale,-30*n.scene.gameScale,n.trophiesCount,{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:45*n.scene.gameScale+"px",color:"#FFFFFF",stroke:"#6e8db4",strokeThickness:2*n.scene.gameScale})),n.trophiesCountText.setOrigin(.5),n.add(n.trophiesCountText),n}return function BoardPlayerScorePanel_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardPlayerScorePanel_setPrototypeOf(e,t)}(BoardPlayerScorePanel,Phaser.GameObjects.Container),function BoardPlayerScorePanel_createClass(e,t,n){return t&&BoardPlayerScorePanel_defineProperties(e.prototype,t),n&&BoardPlayerScorePanel_defineProperties(e,n),e}(BoardPlayerScorePanel,[{key:"update",value:function update(){}},{key:"OnTrophiesChanged",value:function OnTrophiesChanged(e){this.trophiesCountText.setText(e)}},{key:"OnPointsChanged",value:function OnPointsChanged(e){this.pointsCountTarget=e,this.scene.tweens.killTweensOf(this),this.scene.tweens.add({targets:this,pointsCount:{value:this.pointsCountTarget,duration:800,delay:250,ease:"Linear"},onUpdate:this.OnPointsCountTweenUpdate,onUpdateScope:this})}},{key:"OnPointsCountTweenUpdate",value:function OnPointsCountTweenUpdate(){this.pointsCountText.setText(Math.floor(this.pointsCount))}},{key:"OnTurnStart",value:function OnTurnStart(){this.characterHeadPulseTween=this.scene.tweens.add({targets:this.characterHead,scaleX:.8,scaleY:.8,duration:300,yoyo:!0,repeat:-1,ease:"Linear"})}},{key:"OnTurnFinished",value:function OnTurnFinished(){this.scene.tweens.killTweensOf(this.characterHead),this.characterHead.setScale(1)}}]),BoardPlayerScorePanel}();function BoardPlayerUI_typeof(e){return(BoardPlayerUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardPlayerUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardPlayerUI_getPrototypeOf(e){return(BoardPlayerUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardPlayerUI_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardPlayerUI_setPrototypeOf(e,t){return(BoardPlayerUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ht=function(){function BoardPlayerUI(e,t,n){var r;!function BoardPlayerUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardPlayerUI),r=function BoardPlayerUI_possibleConstructorReturn(e,t){return!t||"object"!==BoardPlayerUI_typeof(t)&&"function"!=typeof t?BoardPlayerUI_assertThisInitialized(e):t}(this,BoardPlayerUI_getPrototypeOf(BoardPlayerUI).call(this,e,.5*e.scale.width,.5*e.scale.height)),I.AddChild(BoardPlayerUI_assertThisInitialized(r),t),r.scorePanels=[];for(var o=0;o<n.length;o++){var i=new Ft(r.scene,n[o]);r.scorePanels.push(i),r.add(i)}return r}return function BoardPlayerUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardPlayerUI_setPrototypeOf(e,t)}(BoardPlayerUI,Phaser.GameObjects.Container),function BoardPlayerUI_createClass(e,t,n){return t&&BoardPlayerUI_defineProperties(e.prototype,t),n&&BoardPlayerUI_defineProperties(e,n),e}(BoardPlayerUI,[{key:"update",value:function update(){}},{key:"OnTurnStart",value:function OnTurnStart(e){for(var t=0;t<this.scorePanels.length;t++)if(this.scorePanels[t].player==e){this.scorePanels[t].OnTurnStart();break}}},{key:"OnTurnFinished",value:function OnTurnFinished(e){for(var t=0;t<this.scorePanels.length;t++)if(this.scorePanels[t].player==e){this.scorePanels[t].OnTurnFinished();break}}}]),BoardPlayerUI}();function BoardTurnNotifier_typeof(e){return(BoardTurnNotifier_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardTurnNotifier_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardTurnNotifier_getPrototypeOf(e){return(BoardTurnNotifier_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardTurnNotifier_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardTurnNotifier_setPrototypeOf(e,t){return(BoardTurnNotifier_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Lt=function(){function BoardTurnNotifier(e,t){var n;return function BoardTurnNotifier_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardTurnNotifier),n=function BoardTurnNotifier_possibleConstructorReturn(e,t){return!t||"object"!==BoardTurnNotifier_typeof(t)&&"function"!=typeof t?BoardTurnNotifier_assertThisInitialized(e):t}(this,BoardTurnNotifier_getPrototypeOf(BoardTurnNotifier).call(this,e,.5*e.scale.width,.5*e.scale.height-300*e.gameScale)),I.AddChild(BoardTurnNotifier_assertThisInitialized(n),t),n.panel=n.scene.add.sprite(0,0,"board_ui_atlas","player_turn_panel.png"),n.add(n.panel),n.titleText=n.scene.add.text(0,0,v.Instance.GetString("3_turns_left"),{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*n.scene.gameScale+"px",color:"#000000"}),n.titleText.setOrigin(.5),n.titleText.setStroke("#FFFFFF",8*n.scene.gameScale),n.add(n.titleText),I.ClampTextToDimensions(n.titleText,800*n.scene.gameScale,85*n.scene.gameScale),n.visible=!1,n}return function BoardTurnNotifier_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardTurnNotifier_setPrototypeOf(e,t)}(BoardTurnNotifier,Phaser.GameObjects.Container),function BoardTurnNotifier_createClass(e,t,n){return t&&BoardTurnNotifier_defineProperties(e.prototype,t),n&&BoardTurnNotifier_defineProperties(e,n),e}(BoardTurnNotifier,[{key:"update",value:function update(){this.visible}},{key:"ShowRounds",value:function ShowRounds(e,t){var n=t-e+1;if(n<=3)this.Show(v.Instance.GetString(n+"_turns_left"),this.OnRoundNotifierComplete);else{var r=v.Instance.GetString("turn");r=r.replace("<num>",e),this.Show(r,this.OnRoundNotifierComplete)}h.Instance.Play("sfx_boardgame","screen_in_board_turns_left"),h.Instance.Play("sfx_boardgame","screen_out_board_turns_left",{delay:1.5})}},{key:"ShowPlayerTurn",value:function ShowPlayerTurn(e){var t="";switch(e.playerNumber){case M.PlayerNumber.ONE:t=v.Instance.GetString("player_one_turn");break;case M.PlayerNumber.TWO:t=v.Instance.GetString("player_two_turn")}h.Instance.Play("sfx_boardgame","screen_in_board_player"),h.Instance.Play("sfx_boardgame","screen_out_board_player",{delay:1.5}),this.Show(t,this.OnPlayerTurnNotifierComplete)}},{key:"Show",value:function Show(e,t){this.visible=!0,this.y=.5*this.scene.scale.height-500*this.scene.gameScale,this.titleText.setText(e),I.ClampTextToDimensions(this.titleText,this.panel.width-50*this.scene.gameScale,200*this.scene.gameScale),this.scene.tweens.add({targets:this,y:{value:.5*this.scene.scale.height-300*this.scene.gameScale,duration:500,yoyo:!0,hold:1e3,ease:"Sine.easeInOut"},onComplete:t,onCompleteScope:this})}},{key:"OnRoundNotifierComplete",value:function OnRoundNotifierComplete(){this.emit("roundNotifierComplete"),this.visible=!1}},{key:"OnPlayerTurnNotifierComplete",value:function OnPlayerTurnNotifierComplete(){this.emit("playerTurnNotifierComplete"),this.visible=!1}}]),BoardTurnNotifier}();function ResultsPlayerAnimation_typeof(e){return(ResultsPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ResultsPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ResultsPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==ResultsPlayerAnimation_typeof(t)&&"function"!=typeof t?function ResultsPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ResultsPlayerAnimation_getPrototypeOf(e){return(ResultsPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ResultsPlayerAnimation_setPrototypeOf(e,t){return(ResultsPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Gt=function(){function ResultsPlayerAnimation(e,t){var n;return function ResultsPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ResultsPlayerAnimation),(n=ResultsPlayerAnimation_possibleConstructorReturn(this,ResultsPlayerAnimation_getPrototypeOf(ResultsPlayerAnimation).call(this,e,t))).SetState(ResultsPlayerAnimation.State.Idle),n}return function ResultsPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ResultsPlayerAnimation_setPrototypeOf(e,t)}(ResultsPlayerAnimation,B),function ResultsPlayerAnimation_createClass(e,t,n){return t&&ResultsPlayerAnimation_defineProperties(e.prototype,t),n&&ResultsPlayerAnimation_defineProperties(e,n),e}(ResultsPlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"characterselect_"+this.player.characterData.id,"idle",!0);if(1<e.skeletonData.skins.length)for(var t=e.skeletonData.skins,n=0;n<t.length;n++){var r=t[n];if("winter"===r.name){console.log("applied winter coat"),e.setSkin(r);break}}return e}}]),ResultsPlayerAnimation}();function ResultsPlayer_typeof(e){return(ResultsPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ResultsPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ResultsPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ResultsPlayer_get(e,t,n){return(ResultsPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function ResultsPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ResultsPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ResultsPlayer_getPrototypeOf(e){return(ResultsPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ResultsPlayer_setPrototypeOf(e,t){return(ResultsPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function ResultsPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Gt,"State",Object.freeze({Idle:{animationName:"idle",loop:!0},Win:{animationName:"win",loop:!0},Lose:{animationName:"lose",loop:!0}}));var Nt=function(){function ResultsPlayer(e,t,n){var r;switch(function ResultsPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ResultsPlayer),r=function ResultsPlayer_possibleConstructorReturn(e,t){return!t||"object"!==ResultsPlayer_typeof(t)&&"function"!=typeof t?ResultsPlayer_assertThisInitialized(e):t}(this,ResultsPlayer_getPrototypeOf(ResultsPlayer).call(this,e,n)),I.AddChild(ResultsPlayer_assertThisInitialized(r),t),r.trophyCountContainer=r.scene.add.container(0,0),r.trophyCountContainer.visible=!1,r.add(r.trophyCountContainer),r.trophyCountSprite=r.scene.add.sprite(0,0,"results_atlas","final_trophy_counter.png"),r.trophyCountContainer.add(r.trophyCountSprite),r.trophyCountText=r.scene.add.text(0,65*r.scene.gameScale,"0",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*r.scene.gameScale+"px",color:"#FFFFFF"}),r.trophyCountText.setOrigin(.5),r.trophyCountContainer.add(r.trophyCountText),r.trophyCount=0,r.trophyCountDelay=250,1<r.scene.playerCount&&r.playerNumber==M.PlayerNumber.ONE||1==r.scene.playerCount&&r.playerNumber==M.PlayerNumber.TWO){case!0:r.trophyCountContainer.setPosition(r.x+200*r.scene.gameScale,r.y-150*r.scene.gameScale),r.setPosition(.5*r.scene.scale.width+150*r.scene.gameScale,550*r.scene.gameScale),r.animation.SetFlipX(!0);break;case!1:r.trophyCountContainer.setPosition(r.x-200*r.scene.gameScale,r.y-150*r.scene.gameScale),r.setPosition(.5*r.scene.scale.width-150*r.scene.gameScale,550*r.scene.gameScale)}return r}return function ResultsPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ResultsPlayer_setPrototypeOf(e,t)}(ResultsPlayer,M),function ResultsPlayer_createClass(e,t,n){return t&&ResultsPlayer_defineProperties(e.prototype,t),n&&ResultsPlayer_defineProperties(e,n),e}(ResultsPlayer,[{key:"CreateAnimation",value:function CreateAnimation(){return new Gt(this.scene,this)}},{key:"PlayTrophyCount",value:function PlayTrophyCount(){var e=this.scene.tweens.createTimeline();this.trophyCountContainer.visible=!0,this.trophyCountContainer.alpha=0,e.add({targets:this.trophyCountContainer,alpha:{value:1,duration:750,ease:"Sine.easeOut"}});for(var t=1;t<this.trophies+1;t++)this.scene.time.delayedCall(750+250*t,function(){h.Instance.Play("sfx_results","results_trophy_count_up")},[],this);e.add({targets:this,trophyCount:{value:this.trophies,duration:this.trophies*this.trophyCountDelay,hold:300,ease:"Linear"},onUpdate:this.OnTrophyCountUpdate,onUpdateScope:this}),e.add({targets:this.trophyCountText,scaleX:{value:1.25,duration:350,yoyo:!0,ease:"Linear"},scaleY:{value:1.25,duration:350,yoyo:!0,ease:"Linear"}}),e.on("complete",this.OnTrophyCountComplete,this),e.play()}},{key:"HideTrophyCount",value:function HideTrophyCount(){this.scene.tweens.add({targets:this.trophyCountContainer,alpha:{value:0,duration:750,delay:300,ease:"Sine.easeIn"}})}},{key:"OnTrophyCountUpdate",value:function OnTrophyCountUpdate(){this.trophyCountText.setText(Math.floor(this.trophyCount))}},{key:"OnTrophyCountComplete",value:function OnTrophyCountComplete(){this.emit("trophyCountComplete",this)}},{key:"update",value:function update(e,t){ResultsPlayer_get(ResultsPlayer_getPrototypeOf(ResultsPlayer.prototype),"update",this).call(this,e,t)}}]),ResultsPlayer}();function ResultsBonusTrophyPopup_typeof(e){return(ResultsBonusTrophyPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ResultsBonusTrophyPopup_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ResultsBonusTrophyPopup_possibleConstructorReturn(e,t){return!t||"object"!==ResultsBonusTrophyPopup_typeof(t)&&"function"!=typeof t?function ResultsBonusTrophyPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ResultsBonusTrophyPopup_getPrototypeOf(e){return(ResultsBonusTrophyPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ResultsBonusTrophyPopup_setPrototypeOf(e,t){return(ResultsBonusTrophyPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Ut=function(){function ResultsBonusTrophyPopup(e){var t;return function ResultsBonusTrophyPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ResultsBonusTrophyPopup),(t=ResultsBonusTrophyPopup_possibleConstructorReturn(this,ResultsBonusTrophyPopup_getPrototypeOf(ResultsBonusTrophyPopup).call(this,e))).x=.5*t.scene.scale.width,t.y=.5*-t.scene.scale.height,t.background=t.scene.add.sprite(0,0,"results_atlas","winner_trophy_popup.png"),t.add(t.background),t.trophyIcon=t.scene.add.sprite(0,-150*t.scene.gameScale,"results_atlas","winner_trophy.png"),t.add(t.trophyIcon),t.titleText=t.scene.add.text(0,95*t.scene.gameScale,"",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:65*t.scene.gameScale+"px",color:"#FFFFFF",wordWrap:{width:400*t.scene.gameScale},align:"center"}),t.titleText.setOrigin(.5),t.titleText.setStroke("#000000",8*t.scene.gameScale),t.add(t.titleText),t.visible=!1,t}return function ResultsBonusTrophyPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ResultsBonusTrophyPopup_setPrototypeOf(e,t)}(ResultsBonusTrophyPopup,Phaser.GameObjects.Container),function ResultsBonusTrophyPopup_createClass(e,t,n){return t&&ResultsBonusTrophyPopup_defineProperties(e.prototype,t),n&&ResultsBonusTrophyPopup_defineProperties(e,n),e}(ResultsBonusTrophyPopup,[{key:"Show",value:function Show(e){switch(this.visible=!0,this.y=.5*-this.scene.scale.height,e){case Vt.BonusTrophyType.MinigameWins:this.titleText.setText(v.Instance.GetString("bonus_trophy_most_wins"));break;case Vt.BonusTrophyType.LeastSteps:this.titleText.setText(v.Instance.GetString("bonus_trophy_least_steps"));break;case Vt.BonusTrophyType.Chances:this.titleText.setText(v.Instance.GetString("bonus_trophy_most_chances"))}I.ClampTextToDimensions(this.titleText,600*this.scene.gameScale,450*this.scene.gameScale);var t=this.scene.tweens.createTimeline();h.Instance.Play("sfx_results","screen_in_results_panel"),t.add({targets:this,y:{value:.5*this.scene.scale.height,duration:750,ease:"Back.easeOut"},onComplete:this.OnShowComplete,onCompleteScope:this}),t.add({targets:this,y:{value:1.5*this.scene.scale.height,delay:1e3,duration:750,ease:"Back.easeIn"}}),h.Instance.Play("sfx_results","screen_out_results_panel",{delay:1.5}),t.on("complete",this.Hide,this),t.play()}},{key:"OnShowComplete",value:function OnShowComplete(){this.emit("showComplete")}},{key:"Hide",value:function Hide(){this.visible=!1,this.emit("hide")}}]),ResultsBonusTrophyPopup}();function ResultsOverallWinnerPopup_typeof(e){return(ResultsOverallWinnerPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ResultsOverallWinnerPopup_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ResultsOverallWinnerPopup_possibleConstructorReturn(e,t){return!t||"object"!==ResultsOverallWinnerPopup_typeof(t)&&"function"!=typeof t?function ResultsOverallWinnerPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ResultsOverallWinnerPopup_getPrototypeOf(e){return(ResultsOverallWinnerPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ResultsOverallWinnerPopup_setPrototypeOf(e,t){return(ResultsOverallWinnerPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var zt=function(){function ResultsOverallWinnerPopup(e){var t;!function ResultsOverallWinnerPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ResultsOverallWinnerPopup),(t=ResultsOverallWinnerPopup_possibleConstructorReturn(this,ResultsOverallWinnerPopup_getPrototypeOf(ResultsOverallWinnerPopup).call(this,e))).x=.5*t.scene.scale.width,t.y=.5*t.scene.scale.height,t.background=t.scene.add.sprite(0,0,"results_2_atlas","final_final_winner_popup.png"),t.add(t.background),t.winnerSprite=t.scene.add.sprite(0,750*t.scene.gameScale,"results_2_atlas","final_final_winner_gumball.png"),t.add(t.winnerSprite);var n=new Phaser.Math.Vector2(500*t.scene.gameScale,20*t.scene.gameScale),r=new Phaser.Geom.Rectangle(.5*-n.x,.5*-n.y,n.x,n.y);return t.confettiParticles=t.scene.add.particles("results_2_atlas"),t.add(t.confettiParticles),t.confettiParticleEmitter=t.confettiParticles.createEmitter({on:!1,x:100*t.scene.gameScale,y:230*t.scene.gameScale,frame:["confetto_0.png","confetto_1.png","confetto_2.png","confetto_3.png","confetto_4.png","confetto_5.png","confetto_6.png"],alpha:{start:1,end:0,ease:"Sine.easeIn"},scale:{start:1,end:0,ease:"Sine.easeIn"},rotate:{min:0,max:360,start:0,end:-720},speed:{min:-600*t.scene.gameScale,max:600*t.scene.gameScale},radial:!0,angle:{min:-140,max:-40},emitZone:{source:r},gravityY:300,lifespan:2e3}),t.confettiParticleEmitter.reserve(50),t.visible=!1,t}return function ResultsOverallWinnerPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ResultsOverallWinnerPopup_setPrototypeOf(e,t)}(ResultsOverallWinnerPopup,Phaser.GameObjects.Container),function ResultsOverallWinnerPopup_createClass(e,t,n){return t&&ResultsOverallWinnerPopup_defineProperties(e.prototype,t),n&&ResultsOverallWinnerPopup_defineProperties(e,n),e}(ResultsOverallWinnerPopup,[{key:"Show",value:function Show(e){this.visible=!0,this.winnerSprite.visible=!1,this.setScale(0),this.winnerSprite.setFrame("final_final_winner_"+e.characterData.id+".png");var t=this.scene.tweens.createTimeline();t.add({targets:this,scaleX:{value:1,delay:500,duration:750,ease:"Back.easeOut"},scaleY:{value:1,delay:500,duration:750,ease:"Back.easeOut"},onComplete:this.OnScaleInComplete,onCompleteScope:this}),t.add({targets:this.winnerSprite,y:{value:0,duration:750,hold:3500,ease:"Back.easeOut"}}),t.on("complete",this.OnShowComplete,this),t.play()}},{key:"OnScaleInComplete",value:function OnScaleInComplete(){this.winnerSprite.visible=!0,this.confettiParticleEmitter.explode(50),h.Instance.Play("sfx_results","winner_confetti_shot")}},{key:"OnShowComplete",value:function OnShowComplete(){this.emit("complete")}}]),ResultsOverallWinnerPopup}();function ResultsScene_typeof(e){return(ResultsScene_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ResultsScene_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ResultsScene_possibleConstructorReturn(e,t){return!t||"object"!==ResultsScene_typeof(t)&&"function"!=typeof t?function ResultsScene_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ResultsScene_get(e,t,n){return(ResultsScene_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function ResultsScene_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ResultsScene_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ResultsScene_getPrototypeOf(e){return(ResultsScene_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ResultsScene_setPrototypeOf(e,t){return(ResultsScene_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function ResultsScene_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Vt=function(){function ResultsScene(){return function ResultsScene_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ResultsScene),ResultsScene_possibleConstructorReturn(this,ResultsScene_getPrototypeOf(ResultsScene).call(this,"ResultsScene"))}return function ResultsScene_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ResultsScene_setPrototypeOf(e,t)}(ResultsScene,y),function ResultsScene_createClass(e,t,n){return t&&ResultsScene_defineProperties(e.prototype,t),n&&ResultsScene_defineProperties(e,n),e}(ResultsScene,[{key:"create",value:function create(){ResultsScene_get(ResultsScene_getPrototypeOf(ResultsScene.prototype),"create",this).call(this),this.background=this.add.rectangle(.5*this.scale.width,.5*this.scale.height,this.scale.width,this.scale.height,3680557),this.world.add(this.background),this.stage=this.add.sprite(.5*this.scale.width,this.scale.height,"results_atlas","final_stage.png"),this.stage.setOrigin(.5,1),this.world.add(this.stage),this.spotlight=this.add.sprite(.5*this.scale.width,.4*this.scale.height,"results_atlas","final_spotlight.png"),this.spotlight.visible=!1,this.world.add(this.spotlight),this.players=[],this.playerCount=this.sys.settings.data.gameData.playerCount;for(var e=0;e<2;e++){var t=new Nt(this,this.world,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});t.on("trophyCountComplete",this.OnTrophyCountTimelineComplete.bind(this)),this.players.push(t)}this.verticalCurtain=this.add.tileSprite(.5*this.scale.width,.475*this.scale.height,this.scale.width,760*this.gameScale,"results_atlas","winner_curtain.png"),this.world.add(this.verticalCurtain),this.leftCurtain=this.add.sprite(-450*this.gameScale,.5*this.scale.height,"results_atlas","final_curtain.png"),this.leftCurtain.setOrigin(0,.5),this.world.add(this.leftCurtain),this.rightCurtain=this.add.sprite(this.scale.width+450*this.gameScale,.5*this.scale.height,"results_atlas","final_curtain.png"),this.rightCurtain.setOrigin(0,.5),this.rightCurtain.setScale(-1,1),this.world.add(this.rightCurtain),this.titleContainer=this.add.container(.5*this.scale.width,.1*-this.scale.height),this.ui.add(this.titleContainer),this.titlePanel=this.add.sprite(0,0,"results_atlas","final_winner_panel.png"),this.titleContainer.add(this.titlePanel),this.titleText=this.add.text(0,0,"Title",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*this.gameScale+"px",color:"#FFFFFF"}),this.titleText.setOrigin(.5),this.titleText.setStroke("#000000",8*this.gameScale),this.titleContainer.add(this.titleText),this.bonusTrophyPopup=new Ut(this),this.bonusTrophyPopup.on("showComplete",this.OnBonusTrophyPopupShowComplete.bind(this)),this.bonusTrophyPopup.on("hide",this.OnBonusTrophyPopupHide.bind(this)),this.ui.add(this.bonusTrophyPopup),this.overallWinnerPopup=new zt(this),this.overallWinnerPopup.on("complete",this.OnComplete.bind(this)),this.ui.add(this.overallWinnerPopup),this.CreateDOM(),h.Instance.AddLayer("sfx_results",{audioKeys:["winner_confetti_shot","results_trophy_winner","results_curtain_raise","screen_in_results_panel","screen_out_results_panel","results_trophy_count_up","results_overall_winner"]}),h.Instance.AddLayer("music_results",{audioKeys:["music_results_in","music_results_out"]}),this.state=null,this.bonusTrophiesToAward=[],this.maxBonusTrophies=3,this.trophyCountPlayerIndex=this.players.length-1,this.winner=null,this.loser=null,this.CalculateBonusTrophies(),this.SetState(ResultsScene.State.Introduction),h.Instance.Play("music_results","music_results_in")}},{key:"update",value:function update(e,t){ResultsScene_get(ResultsScene_getPrototypeOf(ResultsScene.prototype),"update",this).call(this,e,t)}},{key:"CreateDOM",value:function CreateDOM(){}},{key:"SetState",value:function SetState(e){switch(this.state=e,this.state){case ResultsScene.State.Introduction:this.OnEnterIntroductionState();break;case ResultsScene.State.BonusTrophies:this.OnEnterBonusTrophiesState();break;case ResultsScene.State.OverallWinner:this.OnEnterOverallWinnerState()}}},{key:"OnEnterIntroductionState",value:function OnEnterIntroductionState(){h.Instance.Play("sfx_results","results_curtain_raise",{delay:.35}),this.tweens.add({targets:this.verticalCurtain,y:{value:-this.scale.height,duration:750,delay:350,ease:"Sine.easeIn"}}),this.tweens.add({targets:this.leftCurtain,x:{value:-50*this.gameScale,duration:750,delay:550,ease:"Back.easeOut"}}),this.tweens.add({targets:this.rightCurtain,x:{value:this.scale.width+50*this.gameScale,duration:750,delay:550,ease:"Back.easeOut"},onComplete:this.OnCompleteIntroductionState,onCompleteScope:this})}},{key:"OnCompleteIntroductionState",value:function OnCompleteIntroductionState(){0<this.bonusTrophiesToAward.length?this.SetState(ResultsScene.State.BonusTrophies):this.SetState(ResultsScene.State.OverallWinner)}},{key:"OnEnterBonusTrophiesState",value:function OnEnterBonusTrophiesState(){this.titleText.setText(v.Instance.GetString("bonus_trophies")),I.ClampTextToDimensions(this.titleText,550*this.scene.gameScale,100*this.scene.gameScale);var e=this.tweens.createTimeline();e.add({targets:this.titleContainer,y:{value:.1*this.scale.height,duration:750,ease:"Back.easeOut"}}),e.add({targets:this.titleContainer,y:{value:.1*-this.scale.height,duration:750,ease:"Back.easeIn"}}),e.on("complete",this.ShowNextBonusTrophy,this),e.play()}},{key:"OnEnterOverallWinnerState",value:function OnEnterOverallWinnerState(){this.titleText.setText(v.Instance.GetString("final_scores")),I.ClampTextToDimensions(this.titleText,550*this.scene.gameScale,100*this.scene.gameScale);var e=this.tweens.createTimeline();e.add({targets:this.titleContainer,y:{value:.1*this.scale.height,duration:750,ease:"Back.easeOut"}}),e.add({targets:this.titleContainer,y:{value:.1*-this.scale.height,duration:750,ease:"Back.easeIn"}});for(var t=350,n=0;n<this.players.length;n++)t+=this.players[n].trophies*this.players[n].trophyCountDelay;h.Instance.Play("music_results","music_results_out",{delay:.001*t}),e.on("complete",this.StartTrophyCount,this),e.play()}},{key:"StartTrophyCount",value:function StartTrophyCount(){this.PlayTrophyCountTimeline(this.players[this.trophyCountPlayerIndex])}},{key:"PlayTrophyCountTimeline",value:function PlayTrophyCountTimeline(e){e.PlayTrophyCount()}},{key:"OnTrophyCountTimelineComplete",value:function OnTrophyCountTimelineComplete(){this.trophyCountPlayerIndex--,0<=this.trophyCountPlayerIndex?this.PlayTrophyCountTimeline(this.players[this.trophyCountPlayerIndex]):this.OnOverallWinnerAnnounced()}},{key:"ShowNextBonusTrophy",value:function ShowNextBonusTrophy(){if(0<this.bonusTrophiesToAward.length)this.bonusTrophyPopup.Show(this.bonusTrophiesToAward[0].type);else{for(var e=0;e<this.players.length;e++)this.players[e].animation.SetState(Gt.State.Idle);this.SetState(ResultsScene.State.OverallWinner)}}},{key:"OnOverallWinnerAnnounced",value:function OnOverallWinnerAnnounced(){var e=this.tweens.createTimeline();this.loser=this.players[0].trophies>this.players[1].trophies?this.players[1]:this.players[0],this.winner=this.players[0].trophies>this.players[1].trophies?this.players[0]:this.players[1],this.spotlight.x=this.winner.x,this.loser.animation.SetState(Gt.State.Lose),this.winner.animation.SetState(Gt.State.Win),h.Instance.Play("sfx_results","results_overall_winner"),e.add({targets:this.spotlight,alpha:{value:1,duration:350,hold:750,ease:"Bounce.easeOut"}}),e.on("complete",this.ShowFinalPopup,this),e.play()}},{key:"ShowFinalPopup",value:function ShowFinalPopup(){for(var e=0;e<this.players.length;e++)this.players[e].HideTrophyCount();this.overallWinnerPopup.Show(this.winner)}},{key:"OnBonusTrophyPopupShowComplete",value:function OnBonusTrophyPopupShowComplete(){this.winner=this.bonusTrophiesToAward[0].winner,this.loser=this.players[0].playerNumber==this.winner.playerNumber?this.players[1]:this.players[0],this.loser.animation.SetState(Gt.State.Lose),this.winner.animation.SetState(Gt.State.Win)}},{key:"OnBonusTrophyPopupHide",value:function OnBonusTrophyPopupHide(){this.spotlight.x=this.winner.x,this.spotlight.visible=!0,this.spotlight.alpha=0;var e=this.tweens.createTimeline();e.add({targets:this.spotlight,alpha:{value:1,duration:350,ease:"Bounce.easeOut"}}),e.add({targets:this.spotlight,alpha:{value:0,duration:350,delay:500,ease:"Bounce.easeIn"}}),e.on("complete",this.ShowNextBonusTrophy,this),e.play(),h.Instance.Play("sfx_results","results_trophy_winner"),this.bonusTrophiesToAward[0].winner.trophies++,this.bonusTrophiesToAward.splice(0,1)}},{key:"OnComplete",value:function OnComplete(){a.Instance.StartTransitionScene(E,this.LoadMainMenu,this)}},{key:"LoadMainMenu",value:function LoadMainMenu(){a.Instance.StartLoadingScene(O,er)}},{key:"CalculateBonusTrophies",value:function CalculateBonusTrophies(){var e=[ResultsScene.BonusTrophyType.MinigameWins,ResultsScene.BonusTrophyType.LeastSteps,ResultsScene.BonusTrophyType.Chances];I.ShuffleArray(e);var t=this.players[0].trophies,n=this.players[1].trophies;0==this.players[0].steps&&(this.players[1].steps=10,this.players[0].minigamesWon=2,this.players[0].chances=1);for(var r=0;r<e.length;r++){var o=this.CalculateBonusTrophyWinner(e[r]);if(o){var i={type:e[r],winner:o};this.bonusTrophiesToAward.push(i),o.playerNumber==M.PlayerNumber.ONE?t++:n++}}0<this.bonusTrophiesToAward.length&&t==n&&this.bonusTrophiesToAward.splice(0,1)}},{key:"CalculateBonusTrophyWinner",value:function CalculateBonusTrophyWinner(e){switch(e){case ResultsScene.BonusTrophyType.MinigameWins:if(this.players[0].minigamesWon!=this.players[1].minigamesWon)return this.players[0].minigamesWon>this.players[1].minigamesWon?this.players[0]:this.players[1];break;case ResultsScene.BonusTrophyType.LeastSteps:if(this.players[0].steps!=this.players[1].steps)return this.players[0].steps<this.players[1].steps?this.players[0]:this.players[1];break;case ResultsScene.BonusTrophyType.Chances:if(this.players[0].chances!=this.players[1].chances)return this.players[0].chances>this.players[1].chances?this.players[0]:this.players[1]}return null}},{key:"OnContinueButtonPressed",value:function OnContinueButtonPressed(){a.Instance.StartLoadingScene(O,er)}},{key:"OnSleep",value:function OnSleep(){h.Instance.PauseLayer("sfx_results"),h.Instance.PauseLayer("music_results")}},{key:"OnWake",value:function OnWake(){h.Instance.ResumeLayer("sfx_results"),h.Instance.ResumeLayer("music_results")}},{key:"Destroy",value:function Destroy(){ResultsScene_get(ResultsScene_getPrototypeOf(ResultsScene.prototype),"Destroy",this).call(this),h.Instance.DestroyLayer("sfx_results"),h.Instance.DestroyLayer("music_results")}}]),ResultsScene}();function TurtlesTurtleLane_typeof(e){return(TurtlesTurtleLane_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TurtlesTurtleLane_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TurtlesTurtleLane_possibleConstructorReturn(e,t){return!t||"object"!==TurtlesTurtleLane_typeof(t)&&"function"!=typeof t?function TurtlesTurtleLane_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TurtlesTurtleLane_getPrototypeOf(e){return(TurtlesTurtleLane_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TurtlesTurtleLane_setPrototypeOf(e,t){return(TurtlesTurtleLane_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}ResultsScene_defineProperty(Vt,"State",Object.freeze({Introduction:0,BonusTrophies:1,OverallWinner:2})),ResultsScene_defineProperty(Vt,"BonusTrophyType",Object.freeze({MinigameWins:0,LeastSteps:1,Chances:2}));var Wt=function(){function TurtlesTurtleLane(e,t,n,r,o){var i;return function TurtlesTurtleLane_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesTurtleLane),(i=TurtlesTurtleLane_possibleConstructorReturn(this,TurtlesTurtleLane_getPrototypeOf(TurtlesTurtleLane).call(this,e))).spawnX=n,i.spawnY=r,i.spawnAngle=o,i.turtleSpawner=t,i.spawnTime=3,i.spawnTimer=i.spawnTime,i}return function TurtlesTurtleLane_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TurtlesTurtleLane_setPrototypeOf(e,t)}(TurtlesTurtleLane,Phaser.GameObjects.Container),function TurtlesTurtleLane_createClass(e,t,n){return t&&TurtlesTurtleLane_defineProperties(e.prototype,t),n&&TurtlesTurtleLane_defineProperties(e,n),e}(TurtlesTurtleLane,[{key:"update",value:function update(e,t){0<this.spawnTimer&&(this.spawnTimer-=.001*t,this.spawnTimer<=0&&(this.SpawnTurtle(),this.spawnTimer=this.spawnTime))}},{key:"SpawnTurtle",value:function SpawnTurtle(){var e=this.turtleSpawner.GetTurtleToSpawn();e&&e.Spawn(this.spawnX,this.spawnY,this.spawnAngle)}}]),TurtlesTurtleLane}();function TurtlesTurtleSpawner_typeof(e){return(TurtlesTurtleSpawner_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TurtlesTurtleSpawner_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TurtlesTurtleSpawner_getPrototypeOf(e){return(TurtlesTurtleSpawner_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TurtlesTurtleSpawner_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TurtlesTurtleSpawner_setPrototypeOf(e,t){return(TurtlesTurtleSpawner_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var qt=function(){function TurtlesTurtleSpawner(e){var t;!function TurtlesTurtleSpawner_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesTurtleSpawner),(t=function TurtlesTurtleSpawner_possibleConstructorReturn(e,t){return!t||"object"!==TurtlesTurtleSpawner_typeof(t)&&"function"!=typeof t?TurtlesTurtleSpawner_assertThisInitialized(e):t}(this,TurtlesTurtleSpawner_getPrototypeOf(TurtlesTurtleSpawner).call(this,e))).turtles=[];for(var n=0;n<10;n++){var r=new Kt(t.scene);t.turtles.push(r),t.add(r)}t.turtleLanes=[];var o=100*t.scene.gameScale;for(n=0;n<3;n++){var i=new Wt(t.scene,TurtlesTurtleSpawner_assertThisInitialized(t),.5*t.scene.scale.width+(n-1)*o,n%2==0?-100*t.scene.gameScale:t.scene.scale.height+100*t.scene.gameScale,n%2==0?180:0);t.turtleLanes.push(i),t.add(i)}return t}return function TurtlesTurtleSpawner_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TurtlesTurtleSpawner_setPrototypeOf(e,t)}(TurtlesTurtleSpawner,Phaser.GameObjects.Container),function TurtlesTurtleSpawner_createClass(e,t,n){return t&&TurtlesTurtleSpawner_defineProperties(e.prototype,t),n&&TurtlesTurtleSpawner_defineProperties(e,n),e}(TurtlesTurtleSpawner,[{key:"update",value:function update(e,t){for(var n=0;n<this.turtleLanes.length;n++)this.turtleLanes[n].update(e,t);for(n=0;n<this.turtles.length;n++)this.turtles[n].update(e,t)}},{key:"GetTurtleToSpawn",value:function GetTurtleToSpawn(){for(var e=0;e<this.turtles.length;e++){if(this.turtles[e].state==Kt.State.Inactive)return this.turtles[e]}}}]),TurtlesTurtleSpawner}();function TurtlesTurtle_typeof(e){return(TurtlesTurtle_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TurtlesTurtle_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TurtlesTurtle_getPrototypeOf(e){return(TurtlesTurtle_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TurtlesTurtle_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TurtlesTurtle_setPrototypeOf(e,t){return(TurtlesTurtle_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Kt=function(){function TurtlesTurtle(e){var t;!function TurtlesTurtle_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesTurtle),(t=function TurtlesTurtle_possibleConstructorReturn(e,t){return!t||"object"!==TurtlesTurtle_typeof(t)&&"function"!=typeof t?TurtlesTurtle_assertThisInitialized(e):t}(this,TurtlesTurtle_getPrototypeOf(TurtlesTurtle).call(this,e))).setPosition(.5*t.scene.scale.width,.5*t.scene.scale.height),t.spine=t.scene.add.spine(0,0,"turtle","walk",!0),t.spine.skeleton.setSkinByName("turtle_1"),t.spine.setScale(t.scene.gameScale),t.add(t.spine);var n=t.scene.cache.json.get("physics_shapes");return t.body=t.scene.matter.add.image(t.x,t.y,void 0,void 0,{shape:n.turtle}),t.body.setIgnoreGravity(!0),t.body.setSensor(!0),t.body.setScale(t.scene.gameScale),t.body.gameObject=TurtlesTurtle_assertThisInitialized(t),t.body.setMass(.01),t.trailParticles=t.scene.add.particles("turtles_minigame_atlas","trail.png"),t.scene.world.add(t.trailParticles),t.trailParticleEmitter=t.trailParticles.createEmitter({on:!1,frequency:15,x:0,y:0,alpha:{start:.5,end:0,ease:"Sine.easeOut"},scale:{start:.5,end:0,ease:"Sine.easeOut"},rotate:{start:0,end:0,ease:"Linear"},lifespan:1e3,follow:TurtlesTurtle_assertThisInitialized(t)}),t.trailParticleEmitter.reserve(Math.ceil(t.trailParticleEmitter.lifespan/t.trailParticleEmitter.frequency)),t.moveSpeed=120*t.scene.gameScale,t.state=null,t.SetState(TurtlesTurtle.State.Inactive),t.previousPosition=new Phaser.Math.Vector2,t.movedDirection=new Phaser.Math.Vector2,t.expectedPosition=new Phaser.Math.Vector2,t.spawnY=0,t.targetY=0,t}return function TurtlesTurtle_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TurtlesTurtle_setPrototypeOf(e,t)}(TurtlesTurtle,Phaser.GameObjects.Container),function TurtlesTurtle_createClass(e,t,n){return t&&TurtlesTurtle_defineProperties(e.prototype,t),n&&TurtlesTurtle_defineProperties(e,n),e}(TurtlesTurtle,[{key:"update",value:function update(e,t){this.angle=this.body.angle,this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.movedDirection.setTo(this.x-this.previousPosition.x,this.y-this.previousPosition.y);var n=Math.atan2(this.movedDirection.y,this.movedDirection.x);switch(n<0&&(n+=2*Math.PI),n=Phaser.Math.RadToDeg(n),this.trailParticleEmitter.rotate.start=n,this.trailParticleEmitter.rotate.end=n,this.state){case TurtlesTurtle.State.Active:this.UpdateActiveState(e,t)}this.previousPosition.setTo(this.x,this.y)}},{key:"Spawn",value:function Spawn(e,t,n){this.body.setPosition(e,t),this.body.angle=n,this.x=e,this.y=t,this.angle=n,this.spine.skeleton.setSkinByName("turtle_"+Phaser.Math.RND.integerInRange(1,3)),this.spawnY=t,this.targetY=.5*this.scene.scale.height+(.5*this.scene.scale.height-this.y),this.SetState(TurtlesTurtle.State.Active)}},{key:"SetState",value:function SetState(e){switch(this.state=e,this.state){case TurtlesTurtle.State.Active:this.OnEnterActiveState();break;case TurtlesTurtle.State.Inactive:this.OnEnterInactiveState();break;case TurtlesTurtle.State.Collecting:this.OnEnterCollectingState()}}},{key:"OnEnterActiveState",value:function OnEnterActiveState(){this.visible=!0,this.spine.setAnimation(0,"walk",!0)}},{key:"OnEnterInactiveState",value:function OnEnterInactiveState(){this.visible=!1,this.body.setVelocity(0,0),this.trailParticleEmitter.on=!1}},{key:"OnEnterCollectingState",value:function OnEnterCollectingState(){this.body.setVelocity(0,0),this.trailParticleEmitter.on=!0,this.spine.setAnimation(0,"hide",!1)}},{key:"UpdateActiveState",value:function UpdateActiveState(e,t){var n=Phaser.Math.DegToRad(this.angle-90);this.body.x+=Math.cos(n)*this.moveSpeed*t*.001,this.body.y+=Math.sin(n)*this.moveSpeed*t*.001,this.spawnY<this.targetY&&this.y>this.targetY?this.SetState(TurtlesTurtle.State.Inactive):this.spawnY>this.targetY&&this.y<this.targetY&&this.SetState(TurtlesTurtle.State.Inactive)}},{key:"GetExpectedPosition",value:function GetExpectedPosition(e){var t=Phaser.Math.DegToRad(this.angle-90);return this.expectedPosition.setTo(this.body.x+Math.cos(t)*this.moveSpeed*e*.001,this.body.y+Math.sin(t)*this.moveSpeed*e*.001),this.expectedPosition}},{key:"OnPlungerCollidesTurtle",value:function OnPlungerCollidesTurtle(){this.SetState(TurtlesTurtle.State.Collecting)}},{key:"OnRetractComplete",value:function OnRetractComplete(){this.SetState(TurtlesTurtle.State.Inactive)}}]),TurtlesTurtle}();function TurtlesPlayerAI_typeof(e){return(TurtlesPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TurtlesPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TurtlesPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==TurtlesPlayerAI_typeof(t)&&"function"!=typeof t?function TurtlesPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TurtlesPlayerAI_get(e,t,n){return(TurtlesPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TurtlesPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TurtlesPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TurtlesPlayerAI_getPrototypeOf(e){return(TurtlesPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TurtlesPlayerAI_setPrototypeOf(e,t){return(TurtlesPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function TurtlesTurtle_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Kt,"State",Object.freeze({Inactive:0,Active:1,Collecting:2}));var Yt=function(){function TurtlesPlayerAI(e,t){var n;switch(function TurtlesPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesPlayerAI),(n=TurtlesPlayerAI_possibleConstructorReturn(this,TurtlesPlayerAI_getPrototypeOf(TurtlesPlayerAI).call(this,e,t))).extend=!1,n.wasExtend=!1,n.minExtendCooldownTime=.85,n.maxExtendCooldownTime=1.25,n.successRatio=.75,n.difficulty){case A.Difficulty.EASY:n.minExtendCooldownTime=1,n.maxExtendCooldownTime=1.3,n.successRatio=.45;break;case A.Difficulty.MEDIUM:n.minExtendCooldownTime=.7,n.maxExtendCooldownTime=1,n.successRatio=.65;break;case A.Difficulty.HARD:n.minExtendCooldownTime=.5,n.maxExtendCooldownTime=.8,n.successRatio=.85}return n.extendCooldown=Phaser.Math.RND.realInRange(n.minExtendCooldownTime,n.maxExtendCooldownTime),n}return function TurtlesPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TurtlesPlayerAI_setPrototypeOf(e,t)}(TurtlesPlayerAI,A),function TurtlesPlayerAI_createClass(e,t,n){return t&&TurtlesPlayerAI_defineProperties(e.prototype,t),n&&TurtlesPlayerAI_defineProperties(e,n),e}(TurtlesPlayerAI,[{key:"update",value:function update(e,t){if(TurtlesPlayerAI_get(TurtlesPlayerAI_getPrototypeOf(TurtlesPlayerAI.prototype),"update",this).call(this,e,t),this.player.state==Zt.State.Idle)if(0<this.extendCooldown)this.extendCooldown-=.001*t;else{for(var n=Phaser.Math.RND.frac()<this.successRatio,r=null,o=70*this.scene.gameScale,i=.25*this.player.extendDuration,a=i;a<this.player.extendDuration;a+=i){for(var s=this.player.GetExpectedPlungerPosition(a),l=0;l<this.scene.turtleSpawner.turtles.length;l++){var c=this.scene.turtleSpawner.turtles[l];if(c.state==Kt.State.Active){var u=c.GetExpectedPosition(a);if(Phaser.Math.Distance.Between(u.x,u.y,s.x,s.y)<o){r=c;break}}}if(r)break}null!=r==n?(this.extendCooldown=Phaser.Math.RND.realInRange(this.minExtendCooldownTime,this.maxExtendCooldownTime),this.extend=!0,this.wasExtend=!0):this.extendCooldown=.1}this.extend=this.wasExtend,this.wasExtend=!1}}]),TurtlesPlayerAI}();function TurtlesPlayerInput_typeof(e){return(TurtlesPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TurtlesPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TurtlesPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==TurtlesPlayerInput_typeof(t)&&"function"!=typeof t?function TurtlesPlayerInput_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TurtlesPlayerInput_get(e,t,n){return(TurtlesPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TurtlesPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TurtlesPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TurtlesPlayerInput_getPrototypeOf(e){return(TurtlesPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TurtlesPlayerInput_setPrototypeOf(e,t){return(TurtlesPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Xt=function(){function TurtlesPlayerInput(e,t){var n;return function TurtlesPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesPlayerInput),(n=TurtlesPlayerInput_possibleConstructorReturn(this,TurtlesPlayerInput_getPrototypeOf(TurtlesPlayerInput).call(this,e,t))).extend=!1,n.wasExtend=!1,n}return function TurtlesPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TurtlesPlayerInput_setPrototypeOf(e,t)}(TurtlesPlayerInput,be),function TurtlesPlayerInput_createClass(e,t,n){return t&&TurtlesPlayerInput_defineProperties(e.prototype,t),n&&TurtlesPlayerInput_defineProperties(e,n),e}(TurtlesPlayerInput,[{key:"update",value:function update(e,t){TurtlesPlayerInput_get(TurtlesPlayerInput_getPrototypeOf(TurtlesPlayerInput.prototype),"update",this).call(this,e,t),this.extend=this.wasExtend,this.wasExtend=!1}},{key:"OnButtonPressed",value:function OnButtonPressed(){TurtlesPlayerInput_get(TurtlesPlayerInput_getPrototypeOf(TurtlesPlayerInput.prototype),"OnButtonPressed",this).call(this),this.extend=!0,this.wasExtend=!0}},{key:"OnMinigameComplete",value:function OnMinigameComplete(){TurtlesPlayerInput_get(TurtlesPlayerInput_getPrototypeOf(TurtlesPlayerInput.prototype),"OnMinigameComplete",this).call(this)}}]),TurtlesPlayerInput}();function TurtlesPlayerAnimation_typeof(e){return(TurtlesPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TurtlesPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TurtlesPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==TurtlesPlayerAnimation_typeof(t)&&"function"!=typeof t?function TurtlesPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TurtlesPlayerAnimation_get(e,t,n){return(TurtlesPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TurtlesPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TurtlesPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TurtlesPlayerAnimation_getPrototypeOf(e){return(TurtlesPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TurtlesPlayerAnimation_setPrototypeOf(e,t){return(TurtlesPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Jt=function(){function TurtlesPlayerAnimation(e,t){return function TurtlesPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesPlayerAnimation),TurtlesPlayerAnimation_possibleConstructorReturn(this,TurtlesPlayerAnimation_getPrototypeOf(TurtlesPlayerAnimation).call(this,e,t))}return function TurtlesPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TurtlesPlayerAnimation_setPrototypeOf(e,t)}(TurtlesPlayerAnimation,H),function TurtlesPlayerAnimation_createClass(e,t,n){return t&&TurtlesPlayerAnimation_defineProperties(e.prototype,t),n&&TurtlesPlayerAnimation_defineProperties(e,n),e}(TurtlesPlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id+"_topdown","dodge_idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){TurtlesPlayerAnimation_get(TurtlesPlayerAnimation_getPrototypeOf(TurtlesPlayerAnimation.prototype),"SetState",this).call(this,e)}},{key:"update",value:function update(e,t){TurtlesPlayerAnimation_get(TurtlesPlayerAnimation_getPrototypeOf(TurtlesPlayerAnimation.prototype),"update",this).call(this,e,t)}},{key:"destroy",value:function destroy(){TurtlesPlayerAnimation_get(TurtlesPlayerAnimation_getPrototypeOf(TurtlesPlayerAnimation.prototype),"destroy",this).call(this)}}]),TurtlesPlayerAnimation}();function TurtlesPlayer_typeof(e){return(TurtlesPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TurtlesPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TurtlesPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TurtlesPlayer_get(e,t,n){return(TurtlesPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TurtlesPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TurtlesPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TurtlesPlayer_getPrototypeOf(e){return(TurtlesPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TurtlesPlayer_setPrototypeOf(e,t){return(TurtlesPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function TurtlesPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Jt,"State",Object.freeze({Idle:{animationName:"dodge_idle",loop:!0},Win:{animationName:"volley_success",loop:!1},Lose:{animationName:"volley_fail",loop:!1}}));var Zt=function(){function TurtlesPlayer(e,t){var n;switch(function TurtlesPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesPlayer),(n=function TurtlesPlayer_possibleConstructorReturn(e,t){return!t||"object"!==TurtlesPlayer_typeof(t)&&"function"!=typeof t?TurtlesPlayer_assertThisInitialized(e):t}(this,TurtlesPlayer_getPrototypeOf(TurtlesPlayer).call(this,e,t))).minAngle=30,n.maxAngle=150,n.turtlesInPoolSpine=n.scene.add.spine(0,0,"turtles_in_pool","0",!0),n.turtlesInPoolSpineAnimationName="0",n.turtlesInPoolSpine.setScale(n.scene.gameScale),n.scene.world.add(n.turtlesInPoolSpine),n.plungerRopeSprite=n.scene.add.tileSprite(0,40*n.scene.gameScale,10*n.scene.gameScale,1e3*n.scene.gameScale,"turtles_minigame_atlas","turtles_plunger_rope.png"),n.plungerRopeSprite.setOrigin(.5,0),n.add(n.plungerRopeSprite),n.plungerSprite=n.scene.add.image(0,0,"turtles_minigame_atlas","turtles_plunger_head.png"),n.plungerSprite.angle=180,n.plungerSprite.setOrigin(.5,0),n.add(n.plungerSprite),n.turretSprite=n.scene.add.image(0,20*n.scene.gameScale,"turtles_minigame_atlas","pool_turret_right.png"),n.turretSprite.angle=90,n.add(n.turretSprite),n.bringToTop(n.animation),1<n.scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO){case!0:n.setPosition(.5*n.scene.scale.width+340*n.scene.gameScale,.5*n.scene.scale.height),n.setAngle(90),n.turtlesInPoolSpine.setPosition(.5*n.scene.scale.width+510*n.scene.gameScale,n.y);break;case!1:n.setPosition(.5*n.scene.scale.width-340*n.scene.gameScale,.5*n.scene.scale.height),n.setAngle(-90),n.turretSprite.setFrame("pool_turret_left.png"),n.turtlesInPoolSpine.setPosition(.5*n.scene.scale.width-510*n.scene.gameScale,n.y),n.minAngle=-150,n.maxAngle=-30}return n.scoreText=n.scene.add.text(n.x,n.y-150*n.scene.gameScale,"0",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*n.scene.gameScale+"px",color:"#FF0000"}),n.scoreText.setOrigin(.5),n.scoreText.alpha=0,n.scene.ui.add(n.scoreText),n.plungerBody=n.scene.matter.add.image(n.x+100*n.scene.gameScale,n.y,void 0,void 0,{shape:{type:"rectangle",width:50*n.scene.gameScale,height:5*n.scene.gameScale}}),n.plungerBody.setIgnoreGravity(!0),n.plungerBody.angle=n.angle,n.plungerBody.setSensor(!0),n.plungerBody.gameObject=TurtlesPlayer_assertThisInitialized(n),n.flashSpine=n.scene.add.spine(0,0,"flash","flash",!1),n.flashSpine.setScale(.25*n.scene.gameScale),n.add(n.flashSpine),n.flashSpine.visible=!1,n.rotateDirection=1,n.rotateSpeed=36,n.extendDuration=750,n.minJointLength=85*n.scene.gameScale,n.maxJointLength=365*n.scene.gameScale,n.jointLength=n.minJointLength,n.attachedTurtle=null,n.attachedTurtleJoint=null,n.expectedPlungerPosition=new Phaser.Math.Vector2,n.score=0,n.targetScore=15,n.animation.SetState(Jt.State.Idle),n}return function TurtlesPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TurtlesPlayer_setPrototypeOf(e,t)}(TurtlesPlayer,L),function TurtlesPlayer_createClass(e,t,n){return t&&TurtlesPlayer_defineProperties(e.prototype,t),n&&TurtlesPlayer_defineProperties(e,n),e}(TurtlesPlayer,[{key:"CreateInput",value:function CreateInput(){return new Xt(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new Yt(this.scene,this)}},{key:"CreateAnimation",value:function CreateAnimation(){return new Jt(this.scene,this)}},{key:"update",value:function update(e,t){if(TurtlesPlayer_get(TurtlesPlayer_getPrototypeOf(TurtlesPlayer.prototype),"update",this).call(this,e,t),!(this.scene.state>F.State.Game)){switch(this.state){case TurtlesPlayer.State.Idle:this.UpdateIdleState(e,t)}var n=Phaser.Math.DegToRad(this.angle+90),r=Math.cos(n)*this.jointLength,o=Math.sin(n)*this.jointLength;this.plungerBody.x=this.x+r,this.plungerBody.y=this.y+o,this.plungerSprite.y=this.jointLength+this.plungerBody.body.shape.height;var i=.001*(this.jointLength-50*this.scene.gameScale);this.plungerRopeSprite.setScale(1,i/this.scene.gameScale),this.plungerRopeSprite.setTileScale(1,1/(i/this.scene.gameScale))}}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){TurtlesPlayer_get(TurtlesPlayer_getPrototypeOf(TurtlesPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&this.state==TurtlesPlayer.State.Idle&&(this.playerInput.extend&&this.SetState(TurtlesPlayer.State.Extending),0==this.playerInput.moveVector.x&&0==this.playerInput.moveVector.y||this.SetState(TurtlesPlayer.State.Extending))}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){TurtlesPlayer_get(TurtlesPlayer_getPrototypeOf(TurtlesPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state==F.State.Game&&this.playerAI.extend&&this.SetState(TurtlesPlayer.State.Extending)}},{key:"SetState",value:function SetState(e){if(this.state!=e)switch(this.state=e,this.state){case TurtlesPlayer.State.Idle:this.OnEnterIdleState();break;case TurtlesPlayer.State.Extending:this.OnEnterExtendState();break;case TurtlesPlayer.State.Retracting:this.OnEnterRetractState();break;case TurtlesPlayer.State.EndGame:this.OnEnterEndGameState()}}},{key:"OnEnterIdleState",value:function OnEnterIdleState(){}},{key:"OnEnterExtendState",value:function OnEnterExtendState(){switch(this.canRotate=!1,this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","turtles_player_one_fire");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","turtles_player_two_fire")}this.extendTween=this.scene.tweens.add({targets:this,jointLength:this.maxJointLength,duration:this.extendDuration,ease:"Sine.easeOut",onComplete:this.OnExtendComplete,onCompleteScope:this})}},{key:"OnEnterRetractState",value:function OnEnterRetractState(){var e=(this.jointLength-this.minJointLength)/(this.maxJointLength-this.minJointLength);this.retractTween=this.scene.tweens.add({targets:this,jointLength:this.minJointLength,duration:e*this.extendDuration,ease:"Sine.easeIn",onComplete:this.OnRetractComplete,onCompleteScope:this})}},{key:"OnEnterEndGameState",value:function OnEnterEndGameState(){}},{key:"UpdateIdleState",value:function UpdateIdleState(e,t){this.setAngle(this.angle+this.rotateSpeed*this.rotateDirection*t*.001),this.angle>this.maxAngle?(this.angle=this.maxAngle,this.rotateDirection*=-1):this.angle<this.minAngle&&(this.angle=this.minAngle,this.rotateDirection*=-1),this.plungerBody.angle=this.angle}},{key:"OnPlungerCollidesTurtle",value:function OnPlungerCollidesTurtle(e,t){switch(this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","turtles_player_one_sucker");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","turtles_player_two_sucker")}this.scene.minigameCamera.camera.shake(100,.002),this.attachedTurtle=t,this.attachedTurtleJoint=this.scene.matter.add.joint(this.plungerBody,t.body,.5*(Math.abs(this.plungerBody.x-t.body.x)+Math.abs(this.plungerBody.y-t.body.y)),1),this.attachedTurtleJoint.angularStiffness=1,this.extendTween.stop(),this.SetState(TurtlesPlayer.State.Retracting),this.flashSpine.y=this.plungerSprite.y,this.flashSpine.visible=!0,this.flashSpine.setAnimation(0,"flash",!1)}},{key:"OnExtendComplete",value:function OnExtendComplete(){this.SetState(TurtlesPlayer.State.Retracting)}},{key:"OnRetractComplete",value:function OnRetractComplete(){this.attachedTurtle&&(this.attachedTurtle.OnRetractComplete(),this.attachedTurtle=null,this.scene.matter.world.removeConstraint(this.attachedTurtleJoint),this.attachedTurtleJoint=null,this.state!=TurtlesPlayer.State.EndGame&&this.AddScore()),this.state!=TurtlesPlayer.State.EndGame&&this.SetState(TurtlesPlayer.State.Idle)}},{key:"GetExpectedPlungerPosition",value:function GetExpectedPlungerPosition(e){var t=Phaser.Math.DegToRad(this.angle+90),n=Phaser.Math.Linear(this.minJointLength,this.maxJointLength,Phaser.Math.Easing.Sine.Out(e/this.extendDuration)),r=Math.cos(t)*n,o=Math.sin(t)*n;return this.expectedPlungerPosition.setTo(this.x+r,this.y+o),this.expectedPlungerPosition}},{key:"AddScore",value:function AddScore(){switch(this.score++,this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","player_one_score_point");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","player_two_score_point")}this.scoreText.setText(this.score),this.scoreTween&&this.scoreTween.stop(),this.scoreText.setScale(.5),this.scoreText.y=this.y-100*this.scene.gameScale,this.scoreText.alpha=0,this.scoreTween=this.scene.tweens.add({targets:this.scoreText,scaleX:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},scaleY:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},alpha:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},y:{value:this.y-175*this.scene.gameScale,duration:1e3,ease:"Sine.easeInOut"}});var e=Math.ceil(this.score/2).toString();this.turtlesInPoolSpineAnimationName!=e&&(this.turtlesInPoolSpineAnimationName=e,this.turtlesInPoolSpine.setAnimation(0,e,!0)),this.score>=this.targetScore&&this.scene.EndGame()}},{key:"OnGameEnterPostGameState",value:function OnGameEnterPostGameState(e){TurtlesPlayer_get(TurtlesPlayer_getPrototypeOf(TurtlesPlayer.prototype),"OnGameEnterPostGameState",this).call(this,e),this.SetState(TurtlesPlayer.State.EndGame)}},{key:"OnMinigameWon",value:function OnMinigameWon(){this.animation.SetState(Jt.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){this.animation.SetState(Jt.State.Lose)}},{key:"destroy",value:function destroy(){TurtlesPlayer_get(TurtlesPlayer_getPrototypeOf(TurtlesPlayer.prototype),"destroy",this).call(this)}}]),TurtlesPlayer}();function TurtlesTutorialPopup_typeof(e){return(TurtlesTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TurtlesTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==TurtlesTutorialPopup_typeof(t)&&"function"!=typeof t?function TurtlesTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TurtlesTutorialPopup_getPrototypeOf(e){return(TurtlesTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TurtlesTutorialPopup_setPrototypeOf(e,t){return(TurtlesTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function TurtlesPlayer_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Zt,"State",Object.freeze({Idle:0,Extending:1,Retracting:2,EndGame:3}));var $t=function(){function TurtlesTutorialPopup(e){var t;!function TurtlesTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesTutorialPopup),(t=TurtlesTutorialPopup_possibleConstructorReturn(this,TurtlesTutorialPopup_getPrototypeOf(TurtlesTutorialPopup).call(this,e))).panel.setTexture("turtles_minigame_atlas","how_to_turtles.png");for(var n=0;n<t.controlSpines.length;n++)t.scene.deviceManager.desktop?t.controlSpines[n].setAnimation(0,"all",!0):t.controlSpines[n].setAnimation(0,"tap",!0);return t}return function TurtlesTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TurtlesTutorialPopup_setPrototypeOf(e,t)}(TurtlesTutorialPopup,R),TurtlesTutorialPopup}();function TurtlesMinigame_typeof(e){return(TurtlesMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TurtlesMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TurtlesMinigame_possibleConstructorReturn(e,t){return!t||"object"!==TurtlesMinigame_typeof(t)&&"function"!=typeof t?function TurtlesMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function TurtlesMinigame_get(e,t,n){return(TurtlesMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TurtlesMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TurtlesMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TurtlesMinigame_getPrototypeOf(e){return(TurtlesMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TurtlesMinigame_setPrototypeOf(e,t){return(TurtlesMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Qt=function(){function TurtlesMinigame(){return function TurtlesMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesMinigame),TurtlesMinigame_possibleConstructorReturn(this,TurtlesMinigame_getPrototypeOf(TurtlesMinigame).call(this,"TurtlesMinigame"))}return function TurtlesMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TurtlesMinigame_setPrototypeOf(e,t)}(TurtlesMinigame,F),function TurtlesMinigame_createClass(e,t,n){return t&&TurtlesMinigame_defineProperties(e.prototype,t),n&&TurtlesMinigame_defineProperties(e,n),e}(TurtlesMinigame,[{key:"create",value:function create(){TurtlesMinigame_get(TurtlesMinigame_getPrototypeOf(TurtlesMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["turtles_player_one_fire","turtles_player_one_sucker","turtles_player_two_fire","turtles_player_two_sucker"]}),h.Instance.AddLayer("music_minigame",{audioKeys:["music_painting"]}),h.Instance.Play("music_minigame","music_painting")}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new $t(this)}},{key:"CreateWorld",value:function CreateWorld(){TurtlesMinigame_get(TurtlesMinigame_getPrototypeOf(TurtlesMinigame.prototype),"CreateWorld",this).call(this),this.background=this.add.sprite(.5*this.scale.width,.5*this.scale.height,"turtles_background"),this.world.add(this.background),this.turtleSpawner=new qt(this),this.world.add(this.turtleSpawner);for(var e=0;e<2;e++){var t=new Zt(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(t),this.world.add(this.players[e])}this.rainParticles=this.add.particles("turtles_minigame_atlas","turtles_rain_sprite.png"),this.world.add(this.rainParticles);var n=new Phaser.Geom.Rectangle(-200*this.gameScale,-200*this.gameScale,this.scale.width+200*this.gameScale,this.scale.height+200*this.gameScale),r=200*this.gameScale,o=200*this.gameScale,i=new Phaser.Geom.Rectangle(.5*this.scale.width-.5*r,.5*this.scale.height-.5*o,r,o);this.spawnPoint=new Phaser.Geom.Point,this.rainParticles.createEmitter({x:0,y:0,lifespan:400,scale:{start:1,end:.2},emitZone:{type:"random",source:{getRandomPoint:function(e){return Phaser.Geom.Rectangle.RandomOutside(n,i,this.spawnPoint),e.x=this.spawnPoint.x,e.y=this.spawnPoint.y,e}.bind(this)}},frequency:1,alpha:{start:.5,end:.25},rotate:{onEmit:function(e){return e.velocityX=.75*-(e.x-.5*this.scale.width),e.velocityY=.75*-(e.y-.5*this.scale.height),180*Math.atan2(e.velocityY,e.velocityX)/Math.PI+90}.bind(this)}});for(e=0;e<this.turtleSpawner.turtles.length;e++)for(var a=0;a<this.players.length;a++)this.matterCollision.addOnCollideStart({objectA:this.turtleSpawner.turtles[e].body,objectB:this.players[a].plungerBody,callback:this.OnPlungerCollidesTurtle,context:this})}},{key:"update",value:function update(e,t){TurtlesMinigame_get(TurtlesMinigame_getPrototypeOf(TurtlesMinigame.prototype),"update",this).call(this,e,t);for(var n=0;n<this.players.length;n++)this.players[n].update(e,t);this.turtleSpawner.update(e,t)}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){TurtlesMinigame_get(TurtlesMinigame_getPrototypeOf(TurtlesMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=this.players[0],t=0,n=0;n<this.players.length;n++)this.players[n].score>t&&(e=this.players[n],t=this.players[n].score);return e}},{key:"OnPlungerCollidesTurtle",value:function OnPlungerCollidesTurtle(e){var t=e.gameObjectA.gameObject,n=e.gameObjectB.gameObject;t.state==Kt.State.Active&&n.state==Zt.State.Extending&&(n.OnPlungerCollidesTurtle(e,t),t.OnPlungerCollidesTurtle(e,n))}}]),TurtlesMinigame}();function HerdingDuck_typeof(e){return(HerdingDuck_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HerdingDuck_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HerdingDuck_getPrototypeOf(e){return(HerdingDuck_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HerdingDuck_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HerdingDuck_setPrototypeOf(e,t){return(HerdingDuck_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var en=function(){function HerdingDuck(e){var t;!function HerdingDuck_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HerdingDuck),(t=function HerdingDuck_possibleConstructorReturn(e,t){return!t||"object"!==HerdingDuck_typeof(t)&&"function"!=typeof t?HerdingDuck_assertThisInitialized(e):t}(this,HerdingDuck_getPrototypeOf(HerdingDuck).call(this,e))).setPosition(.5*t.scene.scale.width,.5*-t.scene.scale.height);t.scene.cache.json.get("physics_shapes");return t.body=t.scene.matter.add.image(t.x,t.y,void 0,void 0,{shape:{type:"circle",radius:25}}),t.body.setIgnoreGravity(!0),t.body.setScale(t.scene.gameScale),t.body.gameObject=HerdingDuck_assertThisInitialized(t),t.body.setCollisionCategory(t.scene.duckCollisionCategory),t.body.setCollidesWith(t.scene.duckCollisionCategory),t.body.setMass(1),t.body.setFriction(.5,.05,.5),t.spine=t.scene.add.spine(0,0,"duck_herding","animation",!0),t.spine.setScale(t.scene.gameScale),t.add(t.spine),t.state=null,t.followingPlayer=null,t.distanceToStartFollow=100*t.scene.gameScale,t.minDistance=10*t.scene.gameScale,t.moveVector=new Phaser.Math.Vector2,t.moveSpeed=5*t.scene.gameScale,t.velocityMagnitude=0,t.spawnForce=new Phaser.Math.Vector2,t.goalTimer=0,t.SetState(HerdingDuck.State.Inactive),t}return function HerdingDuck_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HerdingDuck_setPrototypeOf(e,t)}(HerdingDuck,Phaser.GameObjects.Container),function HerdingDuck_createClass(e,t,n){return t&&HerdingDuck_defineProperties(e.prototype,t),n&&HerdingDuck_defineProperties(e,n),e}(HerdingDuck,[{key:"update",value:function update(e,t){if(this.state!=HerdingDuck.State.Inactive&&this.state!=HerdingDuck.State.Goal){if(this.angle=this.body.angle,this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.velocityMagnitude=Phaser.Math.Distance.Between(0,0,this.body.body.velocity.x,this.body.body.velocity.y),this.state==HerdingDuck.State.Idle||this.state==HerdingDuck.State.Following){for(var n=null,r=99999*this.scene.gameScale,o=0;o<this.scene.players.length;o++){var i=Phaser.Math.Distance.Between(this.x,this.y,this.scene.players[o].x,this.scene.players[o].y);i<=this.distanceToStartFollow&&i<r&&(r=i,n=this.scene.players[o])}n&&n!=this.followingPlayer&&(this.followingPlayer&&this.followingPlayer.LoseFollower(this),this.followingPlayer=n,this.followingPlayer.GainFollower(this),this.SetState(HerdingDuck.State.Following),this.Quack())}switch(this.state){case HerdingDuck.State.Following:this.OnUpdateFollowingState(e,t);break;case HerdingDuck.State.Goal:this.OnUpdateGoalState(e,t)}if(this.velocityMagnitude>.5*this.scene.gameScale){var a=Phaser.Math.RadToDeg(Math.atan2(this.body.body.velocity.y,this.body.body.velocity.x));this.body.angle=a+90}}}},{key:"Spawn",value:function Spawn(e,t){this.body.setPosition(e,t),this.x=e,this.y=t,this.followingPlayer=null,this.visible=!0;var n=t<.5*this.scene.scale.height?Phaser.Math.RND.realInRange(80,100):-Phaser.Math.RND.realInRange(80,100),r=Phaser.Math.DegToRad(n);this.spawnForce.setTo(Math.cos(r),Math.sin(r)),this.spawnForce.scale(Phaser.Math.RND.realInRange(.03,.06)),this.body.applyForce(this.spawnForce),this.SetState(HerdingDuck.State.Idle)}},{key:"Quack",value:function Quack(){.65<Phaser.Math.RND.frac()&&h.Instance.Play("sfx_minigame","herding_goose_0"+Phaser.Math.RND.integerInRange(1,7),{detune:Phaser.Math.RND.integerInRange(-250,250),volume:Phaser.Math.RND.realInRange(.5,1)})}},{key:"TweenTo",value:function TweenTo(e,t){this.setPosition(e,t)}},{key:"SetState",value:function SetState(e){if(this.state!=e)switch(this.state=e,this.state){case HerdingDuck.State.Inactive:this.OnEnterInactiveState();break;case HerdingDuck.State.Idle:this.OnEnterIdleState();break;case HerdingDuck.State.Following:this.OnEnterFollowingState();break;case HerdingDuck.State.Goal:this.OnEnterGoalState()}}},{key:"OnEnterIdleState",value:function OnEnterIdleState(){this.visible=!0,this.body.setCollidesWith(this.scene.duckCollisionCategory)}},{key:"OnEnterInactiveState",value:function OnEnterInactiveState(){this.visible=!1,this.body.setPosition(0,-this.scene.scale.height),this.body.setVelocity(0,0),this.body.setCollidesWith(0),this.followingPlayer=null}},{key:"OnEnterFollowingState",value:function OnEnterFollowingState(){}},{key:"OnEnterGoalState",value:function OnEnterGoalState(){this.Quack(),this.SetState(HerdingDuck.State.Inactive)}},{key:"OnUpdateFollowingState",value:function OnUpdateFollowingState(e,t){Phaser.Math.Distance.Between(this.x,this.y,this.followingPlayer.x,this.followingPlayer.y)>this.minDistance?(this.moveVector.setTo(this.followingPlayer.x-this.x,this.followingPlayer.y-this.y),this.moveVector.normalize()):this.moveVector.setTo(0,0),this.body.setVelocity(this.moveVector.x*this.moveSpeed*t*.001*60,this.moveVector.y*this.moveSpeed*t*.001*60)}},{key:"OnUpdateGoalState",value:function OnUpdateGoalState(){}},{key:"OnGoalCollide",value:function OnGoalCollide(){this.SetState(HerdingDuck.State.Goal)}}]),HerdingDuck}();function HerdingPlayerAI_typeof(e){return(HerdingPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HerdingPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HerdingPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==HerdingPlayerAI_typeof(t)&&"function"!=typeof t?function HerdingPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HerdingPlayerAI_get(e,t,n){return(HerdingPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HerdingPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HerdingPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HerdingPlayerAI_getPrototypeOf(e){return(HerdingPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HerdingPlayerAI_setPrototypeOf(e,t){return(HerdingPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function HerdingDuck_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(en,"State",Object.freeze({Inactive:0,Idle:1,Following:2,Goal:3}));var tn=function(){function HerdingPlayerAI(e,t){var n;switch(function HerdingPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HerdingPlayerAI),(n=HerdingPlayerAI_possibleConstructorReturn(this,HerdingPlayerAI_getPrototypeOf(HerdingPlayerAI).call(this,e,t))).moveVector=new Phaser.Math.Vector2(0,0),n.targetFollowers=5,n.previousFollowers=0,n.walkSpeedScalar=1,n.difficulty){case A.Difficulty.EASY:n.walkSpeedScalar=.5*n.scene.gameScale,n.targetFollowers=2;break;case A.Difficulty.MEDIUM:n.walkSpeedScalar=.65*n.scene.gameScale,n.targetFollowers=3;break;case A.Difficulty.HARD:n.walkSpeedScalar=.75*n.scene.gameScale,n.targetFollowers=4}return n.state=null,n.SetState(HerdingPlayerAI.State.Collecting),n}return function HerdingPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HerdingPlayerAI_setPrototypeOf(e,t)}(HerdingPlayerAI,A),function HerdingPlayerAI_createClass(e,t,n){return t&&HerdingPlayerAI_defineProperties(e.prototype,t),n&&HerdingPlayerAI_defineProperties(e,n),e}(HerdingPlayerAI,[{key:"update",value:function update(e,t){switch(HerdingPlayerAI_get(HerdingPlayerAI_getPrototypeOf(HerdingPlayerAI.prototype),"update",this).call(this,e,t),this.moveVector.set(0,0),this.state){case HerdingPlayerAI.State.Collecting:this.UpdateCollectingState(e,t);break;case HerdingPlayerAI.State.Depositing:this.UpdateDepositingState(e,t)}this.previousFollowers=this.player.followers.length}},{key:"SetState",value:function SetState(e){this.state!=e&&(this.state=e)}},{key:"UpdateCollectingState",value:function UpdateCollectingState(){var e=this.GetClosestDuck();e&&(this.moveVector.set(e.x-this.player.body.x,e.y-this.player.body.y),this.moveVector.normalize(),this.moveVector.x*=this.player.walkSpeed*this.walkSpeedScalar,this.moveVector.y*=this.player.walkSpeed*this.walkSpeedScalar),this.player.followers.length>=this.targetFollowers&&this.SetState(HerdingPlayerAI.State.Depositing)}},{key:"UpdateDepositingState",value:function UpdateDepositingState(){var e=Phaser.Math.Distance.Between(this.player.goal.x,this.player.goal.y,this.player.x,this.player.y);if(e>20*this.scene.gameScale&&(this.moveVector.set(this.player.goal.x-this.player.body.x,this.player.goal.y-this.player.body.y),this.moveVector.normalize(),this.moveVector.x*=this.player.walkSpeed*this.walkSpeedScalar,this.moveVector.y*=this.player.walkSpeed*this.walkSpeedScalar),this.player.followers.length<this.targetFollowers&&this.previousFollowers!=this.player.followers.length){var t=this.GetClosestDuck(),n=999999;t&&(n=Phaser.Math.Distance.Between(t.x,t.y,this.player.x,this.player.y)),(0==this.player.followers.length||n<e&&0==Phaser.Math.RND.integerInRange(0,3))&&this.SetState(HerdingPlayerAI.State.Collecting)}}},{key:"GetClosestDuck",value:function GetClosestDuck(){for(var e=null,t=Number.POSITIVE_INFINITY,n=0;n<this.scene.duckSpawner.ducks.length;n++){var r=this.scene.duckSpawner.ducks[n];if(r.state==en.State.Idle||r.state==en.State.Following&&r.followingPlayer!=this.player){var o=Phaser.Math.Distance.Between(r.x,r.y,this.player.x,this.player.y);o<t&&(t=o,e=r)}}return e}}]),HerdingPlayerAI}();function HerdingPlayerInput_typeof(e){return(HerdingPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HerdingPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HerdingPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==HerdingPlayerInput_typeof(t)&&"function"!=typeof t?function HerdingPlayerInput_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HerdingPlayerInput_get(e,t,n){return(HerdingPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HerdingPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HerdingPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HerdingPlayerInput_getPrototypeOf(e){return(HerdingPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HerdingPlayerInput_setPrototypeOf(e,t){return(HerdingPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function HerdingPlayerAI_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(tn,"State",Object.freeze({Collecting:0,Depositing:1}));var nn=function(){function HerdingPlayerInput(e,t){return function HerdingPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HerdingPlayerInput),HerdingPlayerInput_possibleConstructorReturn(this,HerdingPlayerInput_getPrototypeOf(HerdingPlayerInput).call(this,e,t))}return function HerdingPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HerdingPlayerInput_setPrototypeOf(e,t)}(HerdingPlayerInput,ce),function HerdingPlayerInput_createClass(e,t,n){return t&&HerdingPlayerInput_defineProperties(e.prototype,t),n&&HerdingPlayerInput_defineProperties(e,n),e}(HerdingPlayerInput,[{key:"update",value:function update(e,t){HerdingPlayerInput_get(HerdingPlayerInput_getPrototypeOf(HerdingPlayerInput.prototype),"update",this).call(this,e,t)}}]),HerdingPlayerInput}();function HerdingPlayerAnimation_typeof(e){return(HerdingPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HerdingPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HerdingPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==HerdingPlayerAnimation_typeof(t)&&"function"!=typeof t?function HerdingPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HerdingPlayerAnimation_get(e,t,n){return(HerdingPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HerdingPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HerdingPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HerdingPlayerAnimation_getPrototypeOf(e){return(HerdingPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HerdingPlayerAnimation_setPrototypeOf(e,t){return(HerdingPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var rn=function(){function HerdingPlayerAnimation(e,t){return function HerdingPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HerdingPlayerAnimation),HerdingPlayerAnimation_possibleConstructorReturn(this,HerdingPlayerAnimation_getPrototypeOf(HerdingPlayerAnimation).call(this,e,t))}return function HerdingPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HerdingPlayerAnimation_setPrototypeOf(e,t)}(HerdingPlayerAnimation,H),function HerdingPlayerAnimation_createClass(e,t,n){return t&&HerdingPlayerAnimation_defineProperties(e.prototype,t),n&&HerdingPlayerAnimation_defineProperties(e,n),e}(HerdingPlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id+"_topdown","dodge_idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){e!=this.state&&(HerdingPlayerAnimation_get(HerdingPlayerAnimation_getPrototypeOf(HerdingPlayerAnimation.prototype),"SetState",this).call(this,e),e==HerdingPlayerAnimation.State.Collect?this.spine.on("spine.complete",this.OnCollectAnimationComplete,this):this.spine.off("spine.complete",this.OnCollectAnimationComplete,this))}},{key:"update",value:function update(e,t){switch(HerdingPlayerAnimation_get(HerdingPlayerAnimation_getPrototypeOf(HerdingPlayerAnimation.prototype),"update",this).call(this,e,t),this.state){case HerdingPlayerAnimation.State.Idle:this.UpdateIdleState();break;case HerdingPlayerAnimation.State.Walk:this.UpdateWalkState()}}},{key:"UpdateIdleState",value:function UpdateIdleState(){.1<this.player.velocityMagnitude&&this.SetState(HerdingPlayerAnimation.State.Walk)}},{key:"UpdateWalkState",value:function UpdateWalkState(){this.player.velocityMagnitude<=.1&&this.SetState(HerdingPlayerAnimation.State.Idle)}},{key:"OnCollectAnimationComplete",value:function OnCollectAnimationComplete(){.1<this.player.velocityMagnitude?this.SetState(HerdingPlayerAnimation.State.Walk):this.SetState(HerdingPlayerAnimation.State.Idle)}},{key:"destroy",value:function destroy(){HerdingPlayerAnimation_get(HerdingPlayerAnimation_getPrototypeOf(HerdingPlayerAnimation.prototype),"destroy",this).call(this)}}]),HerdingPlayerAnimation}();function HerdingPlayer_typeof(e){return(HerdingPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HerdingPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HerdingPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HerdingPlayer_get(e,t,n){return(HerdingPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HerdingPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HerdingPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HerdingPlayer_getPrototypeOf(e){return(HerdingPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HerdingPlayer_setPrototypeOf(e,t){return(HerdingPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function HerdingPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(rn,"State",Object.freeze({Idle:{animationName:"dodge_idle",loop:!0},Walk:{animationName:"dodge_walk",loop:!0},Collect:{animationName:"herding_grab",loop:!1},Win:{animationName:"volley_success",loop:!1},Lose:{animationName:"volley_fail",loop:!1}}));var on=function(){function HerdingPlayer(e,t){var n;switch(function HerdingPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HerdingPlayer),(n=function HerdingPlayer_possibleConstructorReturn(e,t){return!t||"object"!==HerdingPlayer_typeof(t)&&"function"!=typeof t?HerdingPlayer_assertThisInitialized(e):t}(this,HerdingPlayer_getPrototypeOf(HerdingPlayer).call(this,e,t))).ducksInBathSpine=n.scene.add.spine(0,0,"ducks_in_bath","0",!0),n.ducksInBathSpine.setScale(n.scene.gameScale),n.scene.world.add(n.ducksInBathSpine),1<n.scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO){case!0:n.setPosition(.5*n.scene.scale.width+325*n.scene.gameScale,.5*n.scene.scale.height),n.ducksInBathSpine.setPosition(.5*n.scene.scale.width+415*n.scene.gameScale,n.y);break;case!1:n.setPosition(.5*n.scene.scale.width-325*n.scene.gameScale,.5*n.scene.scale.height),n.ducksInBathSpine.setPosition(.5*n.scene.scale.width-415*n.scene.gameScale,n.y)}return n.body=n.scene.matter.add.image(n.x,n.y,void 0,void 0,{shape:{type:"circle",radius:40*n.scene.gameScale}}),n.body.setIgnoreGravity(!0),n.body.setFixedRotation(),n.body.setMass(10*n.scene.gameScale),n.body.setFriction(0,.5),n.body.setCollisionCategory(n.scene.playerCollisionCategory),n.body.gameObject=HerdingPlayer_assertThisInitialized(n),n.add(n.body),n.scoreText=n.scene.add.text(0,-150*n.scene.gameScale,"0",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*n.scene.gameScale+"px",color:"#FF0000"}),n.scoreText.setOrigin(.5),n.scoreText.alpha=0,n.add(n.scoreText),n.force=new Phaser.Math.Vector2,n.maxWalkSpeed=12*n.scene.gameScale,n.minWalkSpeed=7*n.scene.gameScale,n.walkSpeed=n.maxWalkSpeed,n.followersForMinWalkSpeed=8,n.score=0,n.targetScore=25,n.followers=[],n.goal=null,n.animation.SetState(rn.State.Idle),n}return function HerdingPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HerdingPlayer_setPrototypeOf(e,t)}(HerdingPlayer,L),function HerdingPlayer_createClass(e,t,n){return t&&HerdingPlayer_defineProperties(e.prototype,t),n&&HerdingPlayer_defineProperties(e,n),e}(HerdingPlayer,[{key:"CreateInput",value:function CreateInput(){return new nn(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new tn(this.scene,this)}},{key:"CreateAnimation",value:function CreateAnimation(){return new rn(this.scene,this)}},{key:"update",value:function update(e,t){HerdingPlayer_get(HerdingPlayer_getPrototypeOf(HerdingPlayer.prototype),"update",this).call(this,e,t),this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.velocityMagnitude=Phaser.Math.Distance.Between(0,0,this.body.body.velocity.x,this.body.body.velocity.y),this.walkSpeed=Phaser.Math.Linear(this.maxWalkSpeed,this.minWalkSpeed,Math.min(1,this.followers.length/this.followersForMinWalkSpeed)),this.scene.state,F.State.Game}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){HerdingPlayer_get(HerdingPlayer_getPrototypeOf(HerdingPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state==F.State.Game&&(0==this.playerInput.moveVector.x&&0==this.playerInput.moveVector.y||(this.force.set(this.playerInput.moveVector.x,this.playerInput.moveVector.y),this.force.normalize(),this.force.scale(this.walkSpeed),this.body.setVelocity(this.force.x,this.force.y)),0==this.playerInput.touchDirection.x&&0==this.playerInput.touchDirection.y||this.playerInput.touchDistance>this.walkSpeed&&(this.force.set(this.playerInput.touchDirection.x,this.playerInput.touchDirection.y),this.force.normalize(),this.force.scale(this.walkSpeed),this.body.setVelocity(this.force.x,this.force.y)))}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){HerdingPlayer_get(HerdingPlayer_getPrototypeOf(HerdingPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state==F.State.Game&&(0==this.playerAI.moveVector.x&&0==this.playerAI.moveVector.y||(this.force.set(this.playerAI.moveVector.x,this.playerAI.moveVector.y),this.body.setVelocity(this.force.x*t*.001*60,this.force.y*t*.001*60),this.movedThisFrame=!0))}},{key:"AddScore",value:function AddScore(){switch(this.score++,this.scoreText.setText(this.score),this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","player_one_score_short");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","player_two_score_short")}this.scoreTween&&this.scoreTween.stop(),this.scoreText.setScale(.5),this.scoreText.y=-50*this.scene.gameScale,this.scoreText.alpha=0,this.scoreTween=this.scene.tweens.add({targets:this.scoreText,scaleX:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},scaleY:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},alpha:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},y:{value:-75*this.scene.gameScale,duration:1e3,ease:"Sine.easeInOut"}}),this.score>=this.targetScore&&this.scene.EndGame();var e=Phaser.Math.Clamp(Math.ceil(this.score/(this.targetScore/14)),0,14).toString();this.ducksInBathSpine.setAnimation(0,e,!0)}},{key:"GainFollower",value:function GainFollower(e){this.followers.push(e),this.animation.SetState(rn.State.Collect)}},{key:"LoseFollower",value:function LoseFollower(e){for(var t=this.followers.length-1;0<=t;t--)this.followers[t]==e&&this.followers.splice(t,1)}},{key:"OnMinigameWon",value:function OnMinigameWon(){}},{key:"OnMinigameLost",value:function OnMinigameLost(){}},{key:"destroy",value:function destroy(){HerdingPlayer_get(HerdingPlayer_getPrototypeOf(HerdingPlayer.prototype),"destroy",this).call(this)}}]),HerdingPlayer}();function HerdingTutorialPopup_typeof(e){return(HerdingTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HerdingTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==HerdingTutorialPopup_typeof(t)&&"function"!=typeof t?function HerdingTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HerdingTutorialPopup_getPrototypeOf(e){return(HerdingTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HerdingTutorialPopup_setPrototypeOf(e,t){return(HerdingTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var an=function(){function TurtlesTutorialPopup(e){var t;!function HerdingTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TurtlesTutorialPopup),(t=HerdingTutorialPopup_possibleConstructorReturn(this,HerdingTutorialPopup_getPrototypeOf(TurtlesTutorialPopup).call(this,e))).panel.setTexture("herding_minigame_atlas","how_to_herding.png");for(var n=0;n<t.controlSpines.length;n++)t.scene.deviceManager.desktop?t.controlSpines[n].setAnimation(0,"all",!0):t.controlSpines[n].setAnimation(0,"tap",!0);return t}return function HerdingTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HerdingTutorialPopup_setPrototypeOf(e,t)}(TurtlesTutorialPopup,R),TurtlesTutorialPopup}();function HerdingDuckSpawner_typeof(e){return(HerdingDuckSpawner_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HerdingDuckSpawner_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HerdingDuckSpawner_possibleConstructorReturn(e,t){return!t||"object"!==HerdingDuckSpawner_typeof(t)&&"function"!=typeof t?function HerdingDuckSpawner_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HerdingDuckSpawner_getPrototypeOf(e){return(HerdingDuckSpawner_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HerdingDuckSpawner_setPrototypeOf(e,t){return(HerdingDuckSpawner_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var sn=function(){function HerdingDuckSpawner(e){var t;return function HerdingDuckSpawner_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HerdingDuckSpawner),(t=HerdingDuckSpawner_possibleConstructorReturn(this,HerdingDuckSpawner_getPrototypeOf(HerdingDuckSpawner).call(this,e))).ducks=[],t.maxActiveDucks=10,t.spawnTime=1,t.spawnTimer=t.spawnTime,t}return function HerdingDuckSpawner_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HerdingDuckSpawner_setPrototypeOf(e,t)}(HerdingDuckSpawner,Phaser.GameObjects.Container),function HerdingDuckSpawner_createClass(e,t,n){return t&&HerdingDuckSpawner_defineProperties(e.prototype,t),n&&HerdingDuckSpawner_defineProperties(e,n),e}(HerdingDuckSpawner,[{key:"update",value:function update(e,t){for(var n=0;n<this.ducks.length;n++)this.ducks[n].update(e,t);0<this.spawnTimer&&(this.spawnTimer-=.001*t,this.spawnTimer<=0&&(this.SpawnDuck(),this.spawnTimer=this.spawnTime))}},{key:"SpawnDuck",value:function SpawnDuck(){for(var e=0,t=null,n=0;n<this.ducks.length;n++)this.ducks[n].state!=en.State.Inactive?e++:t||(t=this.ducks[n]);if(e<this.maxActiveDucks)if(t)t.Spawn(.5*this.scene.scale.width,0==Phaser.Math.RND.integerInRange(0,1)?1.1*this.scene.scale.height:.1*-this.scene.scale.height);else{var r=new en(this.scene);this.add(r),this.ducks.push(r),r.Spawn(.5*this.scene.scale.width,0==Phaser.Math.RND.integerInRange(0,1)?1.1*this.scene.scale.height:.1*-this.scene.scale.height)}}}]),HerdingDuckSpawner}();function HerdingGoal_typeof(e){return(HerdingGoal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HerdingGoal_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HerdingGoal_getPrototypeOf(e){return(HerdingGoal_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HerdingGoal_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HerdingGoal_setPrototypeOf(e,t){return(HerdingGoal_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ln=function(){function HerdingGoal(e,t,n,r){var o;return function HerdingGoal_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HerdingGoal),(o=function HerdingGoal_possibleConstructorReturn(e,t){return!t||"object"!==HerdingGoal_typeof(t)&&"function"!=typeof t?HerdingGoal_assertThisInitialized(e):t}(this,HerdingGoal_getPrototypeOf(HerdingGoal).call(this,e))).goalPlayer=t,o.goalPlayer.goal=HerdingGoal_assertThisInitialized(o),o.setPosition(n,r),o.body=o.scene.matter.add.image(o.x,o.y-15*o.scene.gameScale,void 0,void 0,{shape:{type:"rectangle",width:150,height:305}}),o.body.setIgnoreGravity(!0),o.body.setScale(o.scene.gameScale),o.body.gameObject=HerdingGoal_assertThisInitialized(o),o.body.setMass(1),o.body.setStatic(!0),o}return function HerdingGoal_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HerdingGoal_setPrototypeOf(e,t)}(HerdingGoal,Phaser.GameObjects.Container),function HerdingGoal_createClass(e,t,n){return t&&HerdingGoal_defineProperties(e.prototype,t),n&&HerdingGoal_defineProperties(e,n),e}(HerdingGoal,[{key:"update",value:function update(){}},{key:"OnPlayerCollide",value:function OnPlayerCollide(e){if(e.gameObjectA.gameObject.playerNumber==this.goalPlayer.playerNumber){for(var t=0;t<this.goalPlayer.followers.length;t++)this.goalPlayer.score<this.goalPlayer.targetScore&&(this.goalPlayer.followers[t].SetState(en.State.Goal),this.goalPlayer.followers[t].TweenTo(this.x,this.y,0),this.goalPlayer.AddScore());this.goalPlayer.followers=[]}else this.scene.minigameCamera.camera.shake(200,.002)}}]),HerdingGoal}();function HerdingMinigame_typeof(e){return(HerdingMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HerdingMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function HerdingMinigame_possibleConstructorReturn(e,t){return!t||"object"!==HerdingMinigame_typeof(t)&&"function"!=typeof t?function HerdingMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function HerdingMinigame_get(e,t,n){return(HerdingMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function HerdingMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HerdingMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function HerdingMinigame_getPrototypeOf(e){return(HerdingMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HerdingMinigame_setPrototypeOf(e,t){return(HerdingMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var cn=function(){function HerdingMinigame(){return function HerdingMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HerdingMinigame),HerdingMinigame_possibleConstructorReturn(this,HerdingMinigame_getPrototypeOf(HerdingMinigame).call(this,"HerdingMinigame"))}return function HerdingMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HerdingMinigame_setPrototypeOf(e,t)}(HerdingMinigame,F),function HerdingMinigame_createClass(e,t,n){return t&&HerdingMinigame_defineProperties(e.prototype,t),n&&HerdingMinigame_defineProperties(e,n),e}(HerdingMinigame,[{key:"create",value:function create(){HerdingMinigame_get(HerdingMinigame_getPrototypeOf(HerdingMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["herding_goose_01","herding_goose_02","herding_goose_03","herding_goose_04","herding_goose_05","herding_goose_06","herding_goose_07"]}),h.Instance.AddLayer("music_minigame",{audioKeys:["music_catch"]}),h.Instance.Play("music_minigame","music_catch")}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new an(this)}},{key:"CreateWorld",value:function CreateWorld(){HerdingMinigame_get(HerdingMinigame_getPrototypeOf(HerdingMinigame.prototype),"CreateWorld",this).call(this),this.background=this.add.sprite(.5*this.scale.width,.5*this.scale.height,"herding_background"),this.world.add(this.background),this.matter.world.setBounds(.5*this.scale.width-520*this.gameScale,.5*this.scale.height-.5*this.viewport.height,1040*this.gameScale,this.viewport.height,32,!0,!0,!1,!0),this.playerCollisionCategory=this.matter.world.nextCategory(),this.duckCollisionCategory=this.matter.world.nextCategory(),this.duckSpawner=new sn(this);for(var e=0;e<2;e++){var t=new on(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(t)}var n=1==this.playerCount;this.playerOneGoal=new ln(this,this.players[0],n?.5*this.scale.width-417*this.gameScale:.5*this.scale.width+417*this.gameScale,.5*this.scale.height),this.playerTwoGoal=new ln(this,this.players[1],n?.5*this.scale.width+417*this.gameScale:.5*this.scale.width-417*this.gameScale,.5*this.scale.height),this.world.add(this.playerOneGoal),this.world.add(this.playerTwoGoal),this.world.add(this.duckSpawner);for(e=0;e<this.players.length;e++)this.world.add(this.players[e]);for(e=0;e<this.players.length;e++)this.matterCollision.addOnCollideStart({objectA:this.players[e].body,objectB:this.playerOneGoal.body,callback:this.playerOneGoal.OnPlayerCollide,context:this.playerOneGoal}),this.matterCollision.addOnCollideStart({objectA:this.players[e].body,objectB:this.playerTwoGoal.body,callback:this.playerTwoGoal.OnPlayerCollide,context:this.playerTwoGoal})}},{key:"update",value:function update(e,t){HerdingMinigame_get(HerdingMinigame_getPrototypeOf(HerdingMinigame.prototype),"update",this).call(this,e,t);for(var n=0;n<this.players.length;n++)this.players[n].update(e,t);this.duckSpawner.update(e,t)}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){HerdingMinigame_get(HerdingMinigame_getPrototypeOf(HerdingMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=this.players[0],t=0,n=0;n<this.players.length;n++)this.players[n].score>t&&(e=this.players[n],t=this.players[n].score);return e}}]),HerdingMinigame}();function ArcheryPlayerAI_typeof(e){return(ArcheryPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ArcheryPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryPlayerAI_typeof(t)&&"function"!=typeof t?function ArcheryPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ArcheryPlayerAI_get(e,t,n){return(ArcheryPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function ArcheryPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ArcheryPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ArcheryPlayerAI_getPrototypeOf(e){return(ArcheryPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryPlayerAI_setPrototypeOf(e,t){return(ArcheryPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var un=function(){function ArcheryPlayerAI(e,t){var n;switch(function ArcheryPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryPlayerAI),(n=ArcheryPlayerAI_possibleConstructorReturn(this,ArcheryPlayerAI_getPrototypeOf(ArcheryPlayerAI).call(this,e,t))).attemptShotTime=1,n.attemptShotTimer=n.attemptShotTime,n.fireChanceOnMiss=0,n.idealTargetHitCount=1,n.collisionCheckRadius=50*n.scene.gameScale,n.maxTargetHitCount=20,n.difficulty){case A.Difficulty.EASY:n.fireChanceOnMiss=.75,n.idealTargetHitCount=1,n.collisionCheckRadius=80*n.scene.gameScale,n.maxTargetHitCount=4;break;case A.Difficulty.MEDIUM:n.fireChanceOnMiss=.5,n.idealTargetHitCount=2,n.collisionCheckRadius=60*n.scene.gameScale,n.maxTargetHitCount=6;break;case A.Difficulty.HARD:n.fireChanceOnMiss=.25,n.idealTargetHitCount=3,n.collisionCheckRadius=50*n.scene.gameScale,n.maxTargetHitCount=9}return n}return function ArcheryPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryPlayerAI_setPrototypeOf(e,t)}(ArcheryPlayerAI,A),function ArcheryPlayerAI_createClass(e,t,n){return t&&ArcheryPlayerAI_defineProperties(e.prototype,t),n&&ArcheryPlayerAI_defineProperties(e,n),e}(ArcheryPlayerAI,[{key:"update",value:function update(e,t){if(ArcheryPlayerAI_get(ArcheryPlayerAI_getPrototypeOf(ArcheryPlayerAI.prototype),"update",this).call(this,e,t),this.player.ballMachine.enabled&&this.player.ballMachine.shootCooldown<=0)if(0<this.attemptShotTimer)this.attemptShotTimer-=.001*t;else{var n=this.player.PredictedTargetsToHit(50*this.scene.gameScale),r=this.scene.targetSpawner.GetActiveTargetsCount(),o=n>=Math.max(0,Math.min(this.idealTargetHitCount,r-3)),i=0==n&&Phaser.Math.RND.frac()<=this.fireChanceOnMiss;!(n>this.maxTargetHitCount)&&(o||i)&&this.player.Shoot(),this.attemptShotTimer=this.attemptShotTime}}}]),ArcheryPlayerAI}();function ArcheryPlayerInput_typeof(e){return(ArcheryPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ArcheryPlayerInput_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ArcheryPlayerInput_get(e,t,n){return(ArcheryPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function ArcheryPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ArcheryPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ArcheryPlayerInput_getPrototypeOf(e){return(ArcheryPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryPlayerInput_setPrototypeOf(e,t){return(ArcheryPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var pn=function(){function ArcheryPlayerInput(e,t){var n;return function ArcheryPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryPlayerInput),(n=function ArcheryPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryPlayerInput_typeof(t)&&"function"!=typeof t?ArcheryPlayerInput_assertThisInitialized(e):t}(this,ArcheryPlayerInput_getPrototypeOf(ArcheryPlayerInput).call(this,e,t))).leftKey.on("down",n.OnKeyDown,ArcheryPlayerInput_assertThisInitialized(n)),n.downKey.on("down",n.OnKeyDown,ArcheryPlayerInput_assertThisInitialized(n)),n.rightKey.on("down",n.OnKeyDown,ArcheryPlayerInput_assertThisInitialized(n)),n.upKey.on("down",n.OnKeyDown,ArcheryPlayerInput_assertThisInitialized(n)),n}return function ArcheryPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryPlayerInput_setPrototypeOf(e,t)}(ArcheryPlayerInput,be),function ArcheryPlayerInput_createClass(e,t,n){return t&&ArcheryPlayerInput_defineProperties(e.prototype,t),n&&ArcheryPlayerInput_defineProperties(e,n),e}(ArcheryPlayerInput,[{key:"update",value:function update(e,t){ArcheryPlayerInput_get(ArcheryPlayerInput_getPrototypeOf(ArcheryPlayerInput.prototype),"update",this).call(this,e,t)}},{key:"OnButtonPressed",value:function OnButtonPressed(){ArcheryPlayerInput_get(ArcheryPlayerInput_getPrototypeOf(ArcheryPlayerInput.prototype),"OnButtonPressed",this).call(this),this.player.Shoot()}},{key:"OnKeyDown",value:function OnKeyDown(){this.player.Shoot()}}]),ArcheryPlayerInput}();function ArcheryPlayerAnimation_typeof(e){return(ArcheryPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ArcheryPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryPlayerAnimation_typeof(t)&&"function"!=typeof t?function ArcheryPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ArcheryPlayerAnimation_get(e,t,n){return(ArcheryPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function ArcheryPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ArcheryPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ArcheryPlayerAnimation_getPrototypeOf(e){return(ArcheryPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryPlayerAnimation_setPrototypeOf(e,t){return(ArcheryPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var hn=function(){function ArcheryPlayerAnimation(e,t){var n;switch(function ArcheryPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryPlayerAnimation),1<(n=ArcheryPlayerAnimation_possibleConstructorReturn(this,ArcheryPlayerAnimation_getPrototypeOf(ArcheryPlayerAnimation).call(this,e,t))).scene.playerCount&&n.player.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.TWO){case!0:n.SetFlipX(!0)}return n}return function ArcheryPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryPlayerAnimation_setPrototypeOf(e,t)}(ArcheryPlayerAnimation,H),function ArcheryPlayerAnimation_createClass(e,t,n){return t&&ArcheryPlayerAnimation_defineProperties(e.prototype,t),n&&ArcheryPlayerAnimation_defineProperties(e,n),e}(ArcheryPlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id,"sumo_idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){ArcheryPlayerAnimation_get(ArcheryPlayerAnimation_getPrototypeOf(ArcheryPlayerAnimation.prototype),"SetState",this).call(this,e),e==ArcheryPlayerAnimation.State.Shoot?this.spine.on("spine.complete",this.OnShootAnimationComplete,this):this.spine.off("spine.complete",this.OnShootAnimationComplete,this)}},{key:"update",value:function update(e,t){ArcheryPlayerAnimation_get(ArcheryPlayerAnimation_getPrototypeOf(ArcheryPlayerAnimation.prototype),"update",this).call(this,e,t)}},{key:"OnShootAnimationComplete",value:function OnShootAnimationComplete(){this.SetState(ArcheryPlayerAnimation.State.Idle)}},{key:"destroy",value:function destroy(){ArcheryPlayerAnimation_get(ArcheryPlayerAnimation_getPrototypeOf(ArcheryPlayerAnimation.prototype),"destroy",this).call(this)}}]),ArcheryPlayerAnimation}();function ArcheryTarget_typeof(e){return(ArcheryTarget_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryTarget_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ArcheryTarget_getPrototypeOf(e){return(ArcheryTarget_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryTarget_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ArcheryTarget_setPrototypeOf(e,t){return(ArcheryTarget_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function ArcheryPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(hn,"State",Object.freeze({Idle:{animationName:"archery_idle",loop:!0},Shoot:{animationName:"archery_shoot",loop:!1},Win:{animationName:"catching_success",loop:!1},Lose:{animationName:"catching_fail",loop:!1}}));var yn=function(){function ArcheryTarget(e,t){var n;return function ArcheryTarget_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryTarget),(n=function ArcheryTarget_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryTarget_typeof(t)&&"function"!=typeof t?ArcheryTarget_assertThisInitialized(e):t}(this,ArcheryTarget_getPrototypeOf(ArcheryTarget).call(this,e))).targetSpawner=t,n.setPosition(.5*n.scene.scale.width,.5*n.scene.scale.height),n.sprite=n.scene.add.image(0,3.5*n.scene.gameScale,"archery_minigame_atlas","balloon.png"),n.add(n.sprite),n.radius=25*n.scene.gameScale,n.body=n.scene.matter.add.image(n.x,n.y,void 0,void 0,{shape:{type:"circle",radius:n.radius}}),n.body.setIgnoreGravity(!0),n.body.setSensor(!0),n.body.setScale(n.scene.gameScale),n.body.gameObject=ArcheryTarget_assertThisInitialized(n),n.body.setMass(.01),n.state=null,n.SetState(ArcheryTarget.State.Inactive),n}return function ArcheryTarget_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryTarget_setPrototypeOf(e,t)}(ArcheryTarget,Phaser.GameObjects.Container),function ArcheryTarget_createClass(e,t,n){return t&&ArcheryTarget_defineProperties(e.prototype,t),n&&ArcheryTarget_defineProperties(e,n),e}(ArcheryTarget,[{key:"update",value:function update(){this.x=this.body.body.position.x,this.y=this.body.body.position.y}},{key:"Spawn",value:function Spawn(e,t){this.SetState(ArcheryTarget.State.Active),this.body.setPosition(e,t),this.x=e,this.y=t,this.setScale(0),this.scene.tweens.add({targets:this,scaleX:1,scaleY:1,duration:500,ease:"Back.easeOut"}),this.bobTween&&this.bobTween.stop(),this.bobTween=this.scene.tweens.add({targets:this.body,y:this.body.y-6*this.scene.gameScale,duration:Phaser.Math.RND.realInRange(1e3,1250),delay:Phaser.Math.RND.realInRange(0,300),yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}},{key:"SetState",value:function SetState(e){switch(this.state=e,this.state){case ArcheryTarget.State.Active:this.visible=!0;break;case ArcheryTarget.State.Inactive:this.visible=!1}}},{key:"OnBallCollision",value:function OnBallCollision(){this.state==ArcheryTarget.State.Active&&(this.SetState(ArcheryTarget.State.Inactive),this.scene.ShowFlash(this.x,this.y),this.targetSpawner.OnTargetHit())}}]),ArcheryTarget}();function ArcheryBall_typeof(e){return(ArcheryBall_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryBall_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ArcheryBall_getPrototypeOf(e){return(ArcheryBall_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryBall_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ArcheryBall_setPrototypeOf(e,t){return(ArcheryBall_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function ArcheryTarget_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(yn,"State",Object.freeze({Inactive:0,Active:1}));var fn=function(){function ArcheryBall(e,t){var n;!function ArcheryBall_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryBall),(n=function ArcheryBall_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryBall_typeof(t)&&"function"!=typeof t?ArcheryBall_assertThisInitialized(e):t}(this,ArcheryBall_getPrototypeOf(ArcheryBall).call(this,e))).player=t,n.setPosition(-9999,-9999),n.sprite=n.scene.add.image(0,0,"archery_minigame_atlas","cannon_cannon_ball.png"),n.add(n.sprite),n.body=n.scene.matter.add.image(n.x,n.y,void 0,void 0,{shape:{type:"circle",radius:18}}),n.body.setSensor(!0),n.body.setIgnoreGravity(!0),n.body.setScale(n.scene.gameScale),n.body.gameObject=ArcheryBall_assertThisInitialized(n),n.body.setMass(50),n.body.setFriction(1,0,0),n.body.setBounce(.25),n.visible=!1,n.trailParticles=n.scene.add.particles("archery_minigame_atlas","trail.png"),n.scene.world.add(n.trailParticles),n.trailParticleEmitter=n.trailParticles.createEmitter({on:!1,frequency:10,x:0,y:0,alpha:{start:1,end:0,ease:"Sine.easeOut"},scale:{start:1,end:0,ease:"Sine.easeOut"},rotate:{start:0,end:0,ease:"Linear"},lifespan:500,follow:ArcheryBall_assertThisInitialized(n)}),n.trailParticleEmitter.reserve(Math.ceil(n.trailParticleEmitter.lifespan/n.trailParticleEmitter.frequency)),n.force=new Phaser.Math.Vector2,n.scene.matterCollision.addOnCollideStart({objectA:n.scene.matter.world.walls.bottom,objectB:n.body,callback:n.OnBoundsCollision,context:ArcheryBall_assertThisInitialized(n)});for(var r=0;r<n.scene.targetSpawner.targets.length;r++)n.scene.matterCollision.addOnCollideStart({objectA:n.scene.targetSpawner.targets[r].body,objectB:n.body,callback:n.OnTargetCollision,context:ArcheryBall_assertThisInitialized(n)});return n.state=null,n.SetState(ArcheryBall.State.Inactive),n}return function ArcheryBall_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryBall_setPrototypeOf(e,t)}(ArcheryBall,Phaser.GameObjects.Container),function ArcheryBall_createClass(e,t,n){return t&&ArcheryBall_defineProperties(e.prototype,t),n&&ArcheryBall_defineProperties(e,n),e}(ArcheryBall,[{key:"update",value:function update(){if(this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.trailParticleEmitter.on){var e=Math.atan2(this.body.body.velocity.y,this.body.body.velocity.x);e=Phaser.Math.RadToDeg(e),this.trailParticleEmitter.rotate.start=e,this.trailParticleEmitter.rotate.end=e}}},{key:"SetState",value:function SetState(e){if(this.state!=e)switch(this.state=e,this.state){case ArcheryBall.State.Inactive:this.OnEnterInactiveState();break;case ArcheryBall.State.Flying:this.OnEnterFlyingState();break;case ArcheryBall.State.Despawning:this.OnEnterDespawningState()}}},{key:"OnEnterInactiveState",value:function OnEnterInactiveState(){this.visible=!1,this.body.setSensor(!0),this.body.setIgnoreGravity(!0),this.body.setVelocity(0,0),this.body.setCollidesWith(0),this.trailParticleEmitter.on=!1}},{key:"OnEnterFlyingState",value:function OnEnterFlyingState(){this.visible=!0,this.alpha=1,this.body.setIgnoreGravity(!1),this.body.setVelocity(0,0),this.body.setSensor(!1),this.body.setCollidesWith(1),this.trailParticleEmitter.on=!0}},{key:"OnEnterDespawningState",value:function OnEnterDespawningState(){this.scene.tweens.add({targets:this,alpha:0,duration:1e3,ease:"Sine.easeOut",onComplete:this.OnDespawnComplete,onCompleteScope:this}),this.trailParticleEmitter.on=!1}},{key:"UpdateInactiveState",value:function UpdateInactiveState(){}},{key:"UpdateFlyingState",value:function UpdateFlyingState(){}},{key:"OnDespawnComplete",value:function OnDespawnComplete(){this.SetState(ArcheryBall.State.Inactive)}},{key:"Spawn",value:function Spawn(e,t,n,r){this.SetState(ArcheryBall.State.Flying),this.body.setPosition(e,t),this.body.setAngle(n),this.x=e,this.y=t,this.angle=n;var o=Phaser.Math.DegToRad(n);this.force.setTo(Math.cos(o),Math.sin(o)),this.force.scale(r),this.body.applyForce(this.force)}},{key:"OnBoundsCollision",value:function OnBoundsCollision(){this.state==ArcheryBall.State.Flying&&this.SetState(ArcheryBall.State.Despawning)}},{key:"OnTargetCollision",value:function OnTargetCollision(e){e.gameObjectA.gameObject.state==yn.State.Active&&(e.gameObjectA.gameObject.OnBallCollision(e),this.player.AddScore())}}]),ArcheryBall}();function ArcheryBallMachine_typeof(e){return(ArcheryBallMachine_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryBallMachine_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ArcheryBallMachine_getPrototypeOf(e){return(ArcheryBallMachine_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryBallMachine_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ArcheryBallMachine_setPrototypeOf(e,t){return(ArcheryBallMachine_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function ArcheryBall_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(fn,"State",Object.freeze({Inactive:0,Flying:1,Despawning:2}));var dn=function(){function ArcheryBallMachine(e,t){var n;!function ArcheryBallMachine_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryBallMachine),(n=function ArcheryBallMachine_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryBallMachine_typeof(t)&&"function"!=typeof t?ArcheryBallMachine_assertThisInitialized(e):t}(this,ArcheryBallMachine_getPrototypeOf(ArcheryBallMachine).call(this,e))).player=t,n.cannonSpine=n.scene.add.spine(0,0,"cannon","idle"),n.cannonSpine.setScale(n.scene.gameScale),n.cannonSpine.on("spine.event",n.OnSpineEvent,ArcheryBallMachine_assertThisInitialized(n)),n.add(n.cannonSpine),n.baseSprite=n.scene.add.image(0,0*n.scene.gameScale,"archery_minigame_atlas","cannon_cannon_base.png"),n.add(n.baseSprite),n.shootCooldownTime=1,n.shootCooldown=0,n.balls=[],n.turnSpeed=.5,n.turnDirection=-1,n.minAngle=-80,n.maxAngle=-15,n.shootForce=1.75*n.scene.gameScale,n.spawnDistanceFromBase=125*n.scene.gameScale,n.enabled=!0;for(var r=0;r<10;r++){var o=new fn(n.scene,n.player);n.scene.ballContainer.add(o),n.balls.push(o)}switch(1<n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.player.playerNumber==M.PlayerNumber.TWO){case!0:n.baseSprite.setFlipX(-1),n.cannonSpine.x*=-1;var i=n.maxAngle;n.maxAngle=-90-(90+n.minAngle),n.minAngle=-90-(90+i),n.cannonSpine.angle=n.minAngle;break;case!1:n.cannonSpine.angle=n.maxAngle}return n}return function ArcheryBallMachine_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryBallMachine_setPrototypeOf(e,t)}(ArcheryBallMachine,Phaser.GameObjects.Container),function ArcheryBallMachine_createClass(e,t,n){return t&&ArcheryBallMachine_defineProperties(e.prototype,t),n&&ArcheryBallMachine_defineProperties(e,n),e}(ArcheryBallMachine,[{key:"update",value:function update(e,t){for(var n=0;n<this.balls.length;n++)this.balls[n].update(e,t);if(!(this.scene.state>F.State.Game)&&this.enabled)if(0<this.shootCooldown)this.shootCooldown-=.001*t;else{var r=this.cannonSpine.angle+this.turnSpeed*this.turnDirection*t*.001*60;r>=this.maxAngle?(this.turnDirection=-1,r=this.maxAngle):r<=this.minAngle&&(this.turnDirection=1,r=this.minAngle),this.cannonSpine.angle=r}}},{key:"CanShoot",value:function CanShoot(){return this.scene.state==F.State.Game&&this.shootCooldown<=0&&this.GetAvailableBall()}},{key:"Shoot",value:function Shoot(){this.CanShoot()&&(this.shootCooldown=this.shootCooldownTime,this.cannonSpine.setAnimation(0,"shoot"))}},{key:"OnSpineEvent",value:function OnSpineEvent(e,t){switch(t.data.name){case"shoot":var n=this.GetSpawnX(),r=this.GetSpawnY();switch(this.GetAvailableBall().Spawn(n,r,this.GetSpawnAngle(),this.shootForce),this.player.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","archery_player_one_fire");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","archery_player_two_fire")}}}},{key:"LaunchBall",value:function LaunchBall(){}},{key:"GetSpawnX",value:function GetSpawnX(){return this.x+this.cannonSpine.x+Math.cos(this.cannonSpine.rotation)*this.spawnDistanceFromBase}},{key:"GetSpawnY",value:function GetSpawnY(){return this.y+this.cannonSpine.y+Math.sin(this.cannonSpine.rotation)*this.spawnDistanceFromBase}},{key:"GetSpawnAngle",value:function GetSpawnAngle(){return this.cannonSpine.angle}},{key:"GetAvailableBall",value:function GetAvailableBall(){for(var e=0;e<this.balls.length;e++)if(this.balls[e].state==fn.State.Inactive)return this.balls[e]}},{key:"OnPatternComplete",value:function OnPatternComplete(){this.enabled=!1}},{key:"OnNewPattern",value:function OnNewPattern(){this.enabled=!0,this.shootCooldown=.5}}]),ArcheryBallMachine}();function ArcheryPlayer_typeof(e){return(ArcheryPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ArcheryPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ArcheryPlayer_get(e,t,n){return(ArcheryPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function ArcheryPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ArcheryPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ArcheryPlayer_getPrototypeOf(e){return(ArcheryPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryPlayer_setPrototypeOf(e,t){return(ArcheryPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var gn=function(){function ArcheryPlayer(e,t){var n;switch(function ArcheryPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryPlayer),(n=function ArcheryPlayer_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryPlayer_typeof(t)&&"function"!=typeof t?ArcheryPlayer_assertThisInitialized(e):t}(this,ArcheryPlayer_getPrototypeOf(ArcheryPlayer).call(this,e,t))).ballMachine=new dn(n.scene,ArcheryPlayer_assertThisInitialized(n)),n.scene.machineContainer.add(n.ballMachine),1<n.scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO){case!0:n.setPosition(.5*n.scene.scale.width+475*n.scene.gameScale,542*n.scene.gameScale),n.ballMachine.setPosition(n.x+0*n.scene.gameScale,n.y-55*n.scene.gameScale);break;case!1:n.setPosition(.5*n.scene.scale.width-475*n.scene.gameScale,542*n.scene.gameScale),n.ballMachine.setPosition(n.x-0*n.scene.gameScale,n.y-55*n.scene.gameScale)}return n.scoreText=n.scene.add.text(0,-150*n.scene.gameScale,"0",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*n.scene.gameScale+"px",color:"#FF0000"}),n.scoreText.setOrigin(.5),n.scoreText.alpha=0,n.add(n.scoreText),n.score=0,n.animation.SetState(hn.State.Idle),n}return function ArcheryPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryPlayer_setPrototypeOf(e,t)}(ArcheryPlayer,L),function ArcheryPlayer_createClass(e,t,n){return t&&ArcheryPlayer_defineProperties(e.prototype,t),n&&ArcheryPlayer_defineProperties(e,n),e}(ArcheryPlayer,[{key:"CreateInput",value:function CreateInput(){return new pn(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new un(this.scene,this)}},{key:"CreateAnimation",value:function CreateAnimation(){return new hn(this.scene,this)}},{key:"update",value:function update(e,t){ArcheryPlayer_get(ArcheryPlayer_getPrototypeOf(ArcheryPlayer.prototype),"update",this).call(this,e,t),this.ballMachine.update(e,t)}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){ArcheryPlayer_get(ArcheryPlayer_getPrototypeOf(ArcheryPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state,F.State.Game}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){ArcheryPlayer_get(ArcheryPlayer_getPrototypeOf(ArcheryPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state,F.State.Game}},{key:"AddScore",value:function AddScore(){switch(this.score++,this.scoreText.setText(this.score),this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","player_one_score_short");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","player_two_score_short")}this.scoreTween&&this.scoreTween.stop(),this.scoreText.setScale(.5),this.scoreText.y=-100*this.scene.gameScale,this.scoreText.alpha=0,this.scoreTween=this.scene.tweens.add({targets:this.scoreText,scaleX:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},scaleY:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},alpha:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},y:{value:-150*this.scene.gameScale,duration:1e3,ease:"Sine.easeInOut"}})}},{key:"Shoot",value:function Shoot(){this.ballMachine.CanShoot()&&(this.animation.SetState(hn.State.Shoot),this.ballMachine.Shoot())}},{key:"PredictedTargetsToHit",value:function PredictedTargetsToHit(e){for(var t=this.ballMachine.GetSpawnX(),n=this.ballMachine.GetSpawnY(),r=Phaser.Math.DegToRad(this.ballMachine.GetSpawnAngle()),o=Math.cos(r)*this.ballMachine.shootForce,i=Math.sin(r)*this.ballMachine.shootForce,a=0,s=0,l=Math.pow(16.6666,2),c=0,u=[],p=0;p<3e3;p+=16.6666){var h=a+o/50*l,y=s+(i+=50*this.scene.matter.world.engine.world.gravity.y*.001)/50*l;if(t+=a=h,n+=s=y,c%6==(i=o=0)){var f=this.scene.targetSpawner.TestCollision(t,n,e);-1!=f&&-1==u.indexOf(f)&&u.push(f)}if(n>this.y)break;c++}return u.length}},{key:"OnNewPattern",value:function OnNewPattern(){this.ballMachine.OnNewPattern()}},{key:"OnPatternComplete",value:function OnPatternComplete(){this.ballMachine.OnPatternComplete()}},{key:"OnMinigameWon",value:function OnMinigameWon(){ArcheryPlayer_get(ArcheryPlayer_getPrototypeOf(ArcheryPlayer.prototype),"OnMinigameWon",this).call(this),this.animation.SetState(hn.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){ArcheryPlayer_get(ArcheryPlayer_getPrototypeOf(ArcheryPlayer.prototype),"OnMinigameLost",this).call(this),this.animation.SetState(hn.State.Lose)}},{key:"destroy",value:function destroy(){ArcheryPlayer_get(ArcheryPlayer_getPrototypeOf(ArcheryPlayer.prototype),"destroy",this).call(this)}}]),ArcheryPlayer}();function ArcheryTutorialPopup_typeof(e){return(ArcheryTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryTutorialPopup_typeof(t)&&"function"!=typeof t?function ArcheryTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ArcheryTutorialPopup_getPrototypeOf(e){return(ArcheryTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryTutorialPopup_setPrototypeOf(e,t){return(ArcheryTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var mn=function(){function ArcheryTutorialPopup(e){var t;!function ArcheryTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryTutorialPopup),(t=ArcheryTutorialPopup_possibleConstructorReturn(this,ArcheryTutorialPopup_getPrototypeOf(ArcheryTutorialPopup).call(this,e))).panel.setTexture("archery_minigame_atlas","how_to_archery.png");for(var n=0;n<t.controlSpines.length;n++)t.scene.deviceManager.desktop?t.controlSpines[n].setAnimation(0,"all",!0):t.controlSpines[n].setAnimation(0,"tap",!0);return t}return function ArcheryTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryTutorialPopup_setPrototypeOf(e,t)}(ArcheryTutorialPopup,R),ArcheryTutorialPopup}();function ArcheryTargetSpawner_typeof(e){return(ArcheryTargetSpawner_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryTargetSpawner_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ArcheryTargetSpawner_getPrototypeOf(e){return(ArcheryTargetSpawner_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryTargetSpawner_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ArcheryTargetSpawner_setPrototypeOf(e,t){return(ArcheryTargetSpawner_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var _n=function(){function ArcheryTargetSpawner(e){var t;!function ArcheryTargetSpawner_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryTargetSpawner),(t=function ArcheryTargetSpawner_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryTargetSpawner_typeof(t)&&"function"!=typeof t?ArcheryTargetSpawner_assertThisInitialized(e):t}(this,ArcheryTargetSpawner_getPrototypeOf(ArcheryTargetSpawner).call(this,e))).targets=[];for(var n=0;n<20;n++){var r=new yn(t.scene,ArcheryTargetSpawner_assertThisInitialized(t));t.add(r),t.targets.push(r)}return t.hitTargets=0,t.completedPatterns=0,t.targetCompletedPatterns=3,t.waitingToSpawnNewPattern=!1,t.SpawnNewPattern(),t}return function ArcheryTargetSpawner_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryTargetSpawner_setPrototypeOf(e,t)}(ArcheryTargetSpawner,Phaser.GameObjects.Container),function ArcheryTargetSpawner_createClass(e,t,n){return t&&ArcheryTargetSpawner_defineProperties(e.prototype,t),n&&ArcheryTargetSpawner_defineProperties(e,n),e}(ArcheryTargetSpawner,[{key:"update",value:function update(e,t){for(var n=0;n<this.targets.length;n++)this.targets[n].update(e,t);if(this.waitingToSpawnNewPattern){var r=!0;for(n=0;n<this.scene.players.length;n++)if(r)for(var o=0;o<this.scene.players[n].ballMachine.balls.length;o++)if(this.scene.players[n].ballMachine.balls[o].state==fn.State.Flying){r=!1;break}r&&(this.waitingToSpawnNewPattern=!1,this.scene.OnNewPattern(),this.SpawnNewPattern())}}},{key:"OnTargetHit",value:function OnTargetHit(){this.hitTargets++,this.hitTargets>=this.targets.length&&this.OnPatternComplete()}},{key:"SpawnNewPattern",value:function SpawnNewPattern(){this.hitTargets=0;for(var e=Math.ceil(this.targets.length/5),t=75*this.scene.gameScale,n=.5*this.scene.scale.width,r=.375*this.scene.scale.height,o=0;o<this.targets.length;o++){var i=n+(o%5-2)*t,a=r+(Math.floor(o/5)-.5*(e-1))*t;this.targets[o].Spawn(i,a)}h.Instance.Play("sfx_minigame","archery_new_balloons")}},{key:"OnPatternComplete",value:function OnPatternComplete(){this.completedPatterns++,this.completedPatterns<this.targetCompletedPatterns?(this.scene.OnPatternComplete(),this.waitingToSpawnNewPattern=!0):this.scene.EndGame()}},{key:"TestCollision",value:function TestCollision(e,t,n){for(var r=0;r<this.targets.length;r++){if(this.targets[r].state==yn.State.Active)if(Phaser.Math.Distance.Between(e,t,this.targets[r].x,this.targets[r].y)<=n)return r}return-1}},{key:"GetActiveTargetsCount",value:function GetActiveTargetsCount(){for(var e=0,t=0;t<this.targets.length;t++)this.targets[t].state==yn.State.Active&&e++;return e}}]),ArcheryTargetSpawner}();function ArcheryMinigame_typeof(e){return(ArcheryMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ArcheryMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ArcheryMinigame_possibleConstructorReturn(e,t){return!t||"object"!==ArcheryMinigame_typeof(t)&&"function"!=typeof t?function ArcheryMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ArcheryMinigame_get(e,t,n){return(ArcheryMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function ArcheryMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ArcheryMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ArcheryMinigame_getPrototypeOf(e){return(ArcheryMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ArcheryMinigame_setPrototypeOf(e,t){return(ArcheryMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Pn=function(){function ArcheryMinigame(){return function ArcheryMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcheryMinigame),ArcheryMinigame_possibleConstructorReturn(this,ArcheryMinigame_getPrototypeOf(ArcheryMinigame).call(this,"ArcheryMinigame"))}return function ArcheryMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ArcheryMinigame_setPrototypeOf(e,t)}(ArcheryMinigame,F),function ArcheryMinigame_createClass(e,t,n){return t&&ArcheryMinigame_defineProperties(e.prototype,t),n&&ArcheryMinigame_defineProperties(e,n),e}(ArcheryMinigame,[{key:"create",value:function create(){ArcheryMinigame_get(ArcheryMinigame_getPrototypeOf(ArcheryMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("music_minigame",{audioKeys:["music_volleyball"]}),h.Instance.Play("music_minigame","music_volleyball")}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new mn(this)}},{key:"CreateWorld",value:function CreateWorld(){ArcheryMinigame_get(ArcheryMinigame_getPrototypeOf(ArcheryMinigame.prototype),"CreateWorld",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["archery_new_balloons","archery_player_one_fire","archery_player_two_fire"]}),this.background=this.add.sprite(.5*this.scale.width,.5*this.scale.height,"archery_background"),this.world.add(this.background),this.matter.world.engine.world.gravity.y=.4*this.gameScale,this.matter.world.setBounds(.5*this.scale.width-.5*this.viewport.width,.5*this.scale.height-555*this.gameScale,this.viewport.width,718*this.gameScale,32,!0,!0,!1,!0),this.machineContainer=this.add.container(),this.ballContainer=this.add.container(),this.targetSpawner=new _n(this),this.flashSpines=[];for(var e=0;e<6;e++){var t=this.add.spine(0,0,"flash","flash",!1);t.setScale(.25*this.gameScale),t.visible=!1,this.flashSpines.push(t)}for(e=0;e<2;e++){var n=new gn(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(n)}for(e=0;e<this.flashSpines.length;e++)this.world.add(this.flashSpines[e]);this.world.add(this.targetSpawner),this.world.add(this.ballContainer),this.world.add(this.machineContainer);for(e=0;e<this.players.length;e++)this.world.add(this.players[e])}},{key:"update",value:function update(e,t){ArcheryMinigame_get(ArcheryMinigame_getPrototypeOf(ArcheryMinigame.prototype),"update",this).call(this,e,t),this.targetSpawner.update(e,t)}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){ArcheryMinigame_get(ArcheryMinigame_getPrototypeOf(ArcheryMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=this.players[0],t=0,n=0;n<this.players.length;n++)this.players[n].score>t&&(e=this.players[n],t=this.players[n].score);return e}},{key:"ShowFlash",value:function ShowFlash(e,t){for(var n=this.flashSpines[0],r=0;r<this.flashSpines.length;r++)this.flashSpines[r].visible||(n=this.flashSpines[r]);n.setPosition(e,t),n.visible=!0,n.setAnimation(0,"flash",!1),n.once("spine.complete",this.OnFlashComplete,n)}},{key:"OnFlashComplete",value:function OnFlashComplete(){this.visible=!1}},{key:"OnPatternComplete",value:function OnPatternComplete(){for(var e=0;e<this.players.length;e++)this.players[e].OnPatternComplete()}},{key:"OnNewPattern",value:function OnNewPattern(){for(var e=0;e<this.players.length;e++)this.players[e].OnNewPattern()}}]),ArcheryMinigame}();function FlappyPlayerAI_typeof(e){return(FlappyPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FlappyPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==FlappyPlayerAI_typeof(t)&&"function"!=typeof t?function FlappyPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function FlappyPlayerAI_get(e,t,n){return(FlappyPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function FlappyPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FlappyPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function FlappyPlayerAI_getPrototypeOf(e){return(FlappyPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyPlayerAI_setPrototypeOf(e,t){return(FlappyPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var bn=function(){function FlappyPlayerAI(e,t){var n;switch(function FlappyPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyPlayerAI),(n=FlappyPlayerAI_possibleConstructorReturn(this,FlappyPlayerAI_getPrototypeOf(FlappyPlayerAI).call(this,e,t))).nextObstacle=null,n.targetY=0,n.jumpCooldown=0,n.jump=!1,n.obstaclesCleared=0,n.minObstaclesToClear=3,n.inaccuraryToAddEachObstacle=10*n.scene.gameScale,n.inaccurary=0,n.difficulty){case A.Difficulty.EASY:n.minObstaclesToClear=2,n.inaccuraryToAddEachObstacle=20*n.scene.gameScale;break;case A.Difficulty.MEDIUM:n.minObstaclesToClear=5,n.inaccuraryToAddEachObstacle=15*n.scene.gameScale;break;case A.Difficulty.HARD:n.minObstaclesToClear=8,n.inaccuraryToAddEachObstacle=10*n.scene.gameScale}return n}return function FlappyPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyPlayerAI_setPrototypeOf(e,t)}(FlappyPlayerAI,A),function FlappyPlayerAI_createClass(e,t,n){return t&&FlappyPlayerAI_defineProperties(e.prototype,t),n&&FlappyPlayerAI_defineProperties(e,n),e}(FlappyPlayerAI,[{key:"update",value:function update(e,t){FlappyPlayerAI_get(FlappyPlayerAI_getPrototypeOf(FlappyPlayerAI.prototype),"update",this).call(this,e,t),this.jump=!1;var n=this.scene.arena.GetNextObstacle(this.player.x-this.player.bodyDimensions.x);n&&(this.nextObstacle!=n&&(this.nextObstacle&&(this.obstaclesCleared++,this.obstaclesCleared>=this.minObstaclesToClear&&(this.inaccurary+=this.inaccuraryToAddEachObstacle)),this.nextObstacle=n,this.PickNewTargetY()),0<this.jumpCooldown?this.jumpCooldown-=.001*t:this.player.y>this.targetY+65*this.scene.gameScale&&this.Jump())}},{key:"PickNewTargetY",value:function PickNewTargetY(){this.targetY=Phaser.Math.RND.between(this.nextObstacle.safeTop-.5*this.inaccurary,this.nextObstacle.safeBottom+.5*this.inaccurary)}},{key:"Jump",value:function Jump(){this.jumpCooldown=.5,this.jump=!0}}]),FlappyPlayerAI}();function FlappyPlayerInput_typeof(e){return(FlappyPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FlappyPlayerInput_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FlappyPlayerInput_get(e,t,n){return(FlappyPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function FlappyPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FlappyPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function FlappyPlayerInput_getPrototypeOf(e){return(FlappyPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyPlayerInput_setPrototypeOf(e,t){return(FlappyPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Sn=function(){function FlappyPlayerInput(e,t){var n;return function FlappyPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyPlayerInput),(n=function FlappyPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==FlappyPlayerInput_typeof(t)&&"function"!=typeof t?FlappyPlayerInput_assertThisInitialized(e):t}(this,FlappyPlayerInput_getPrototypeOf(FlappyPlayerInput).call(this,e,t))).upKey.on("down",n.OnJumpKeyDown,FlappyPlayerInput_assertThisInitialized(n)),n.wasJump=!1,n.jump=!1,n}return function FlappyPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyPlayerInput_setPrototypeOf(e,t)}(FlappyPlayerInput,be),function FlappyPlayerInput_createClass(e,t,n){return t&&FlappyPlayerInput_defineProperties(e.prototype,t),n&&FlappyPlayerInput_defineProperties(e,n),e}(FlappyPlayerInput,[{key:"update",value:function update(e,t){FlappyPlayerInput_get(FlappyPlayerInput_getPrototypeOf(FlappyPlayerInput.prototype),"update",this).call(this,e,t),this.jump=this.wasJump,this.wasJump=!1}},{key:"OnJumpKeyDown",value:function OnJumpKeyDown(){this.jump=!0,this.wasJump=!0}},{key:"OnButtonPressed",value:function OnButtonPressed(){FlappyPlayerInput_get(FlappyPlayerInput_getPrototypeOf(FlappyPlayerInput.prototype),"OnButtonPressed",this).call(this),this.jump=!0,this.wasJump=!0}},{key:"OnMinigameComplete",value:function OnMinigameComplete(){FlappyPlayerInput_get(FlappyPlayerInput_getPrototypeOf(FlappyPlayerInput.prototype),"OnMinigameComplete",this).call(this)}}]),FlappyPlayerInput}();function FlappyPlayerAnimation_typeof(e){return(FlappyPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FlappyPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==FlappyPlayerAnimation_typeof(t)&&"function"!=typeof t?function FlappyPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function FlappyPlayerAnimation_get(e,t,n){return(FlappyPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function FlappyPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FlappyPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function FlappyPlayerAnimation_getPrototypeOf(e){return(FlappyPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyPlayerAnimation_setPrototypeOf(e,t){return(FlappyPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var On=function(){function FlappyPlayerAnimation(e,t){return function FlappyPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyPlayerAnimation),FlappyPlayerAnimation_possibleConstructorReturn(this,FlappyPlayerAnimation_getPrototypeOf(FlappyPlayerAnimation).call(this,e,t))}return function FlappyPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyPlayerAnimation_setPrototypeOf(e,t)}(FlappyPlayerAnimation,H),function FlappyPlayerAnimation_createClass(e,t,n){return t&&FlappyPlayerAnimation_defineProperties(e.prototype,t),n&&FlappyPlayerAnimation_defineProperties(e,n),e}(FlappyPlayerAnimation,[{key:"SetState",value:function SetState(e){e!=this.state&&(FlappyPlayerAnimation_get(FlappyPlayerAnimation_getPrototypeOf(FlappyPlayerAnimation.prototype),"SetState",this).call(this,e),e==FlappyPlayerAnimation.State.Hit?this.spine.on("spine.complete",this.OnHitAnimationComplete,this):this.spine.off("spine.complete",this.OnHitAnimationComplete,this))}},{key:"update",value:function update(e,t){FlappyPlayerAnimation_get(FlappyPlayerAnimation_getPrototypeOf(FlappyPlayerAnimation.prototype),"update",this).call(this,e,t)}},{key:"OnHitAnimationComplete",value:function OnHitAnimationComplete(){this.SetState(FlappyPlayerAnimation.State.Alive)}},{key:"destroy",value:function destroy(){FlappyPlayerAnimation_get(FlappyPlayerAnimation_getPrototypeOf(FlappyPlayerAnimation.prototype),"destroy",this).call(this)}}]),FlappyPlayerAnimation}();function FlappyPlayerLives_typeof(e){return(FlappyPlayerLives_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyPlayerLives_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FlappyPlayerLives_possibleConstructorReturn(e,t){return!t||"object"!==FlappyPlayerLives_typeof(t)&&"function"!=typeof t?function FlappyPlayerLives_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function FlappyPlayerLives_getPrototypeOf(e){return(FlappyPlayerLives_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyPlayerLives_setPrototypeOf(e,t){return(FlappyPlayerLives_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function FlappyPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(On,"State",Object.freeze({Alive:{animationName:"sewer_plane",loop:!0},Hit:{animationName:"sewer_plane_hit",loop:!1},Win:{animationName:"sewer_plane_success",loop:!1},Lose:{animationName:"sewer_plane_fail",loop:!1}}));var vn=function(){function FlappyPlayerLives(e){var t;!function FlappyPlayerLives_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyPlayerLives),(t=FlappyPlayerLives_possibleConstructorReturn(this,FlappyPlayerLives_getPrototypeOf(FlappyPlayerLives).call(this,e))).lives=3,t.lifeIcons=[];for(var n=0;n<t.lives;n++){var r=t.scene.add.sprite(65*(n-.5*(t.lives-1))*t.scene.gameScale,0,"flappy_minigame_atlas","sewer_heart_active.png");t.add(r),t.lifeIcons.push(r)}return t}return function FlappyPlayerLives_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyPlayerLives_setPrototypeOf(e,t)}(FlappyPlayerLives,Phaser.GameObjects.Container),function FlappyPlayerLives_createClass(e,t,n){return t&&FlappyPlayerLives_defineProperties(e.prototype,t),n&&FlappyPlayerLives_defineProperties(e,n),e}(FlappyPlayerLives,[{key:"update",value:function update(){}},{key:"LoseLife",value:function LoseLife(){this.lives--,this.lifeIcons[this.lives].setFrame("sewer_heart_inactive.png")}},{key:"IsDead",value:function IsDead(){return 0==this.lives}}]),FlappyPlayerLives}();function FlappyPlayer_typeof(e){return(FlappyPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FlappyPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FlappyPlayer_get(e,t,n){return(FlappyPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function FlappyPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FlappyPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function FlappyPlayer_getPrototypeOf(e){return(FlappyPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyPlayer_setPrototypeOf(e,t){return(FlappyPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var wn=function(){function FlappyPlayer(e,t){var n;switch(function FlappyPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyPlayer),(n=function FlappyPlayer_possibleConstructorReturn(e,t){return!t||"object"!==FlappyPlayer_typeof(t)&&"function"!=typeof t?FlappyPlayer_assertThisInitialized(e):t}(this,FlappyPlayer_getPrototypeOf(FlappyPlayer).call(this,e,t))).lives=new vn(n.scene),n.scene.ui.add(n.lives),n.playerNumber){case M.PlayerNumber.ONE:n.setPosition(.5*n.scene.scale.width-75*n.scene.gameScale,500*n.scene.gameScale),n.lives.setPosition(.5*n.scene.scale.width+200*n.scene.gameScale,50*n.scene.gameScale);break;case M.PlayerNumber.TWO:n.setPosition(.5*n.scene.scale.width-225*n.scene.gameScale,500*n.scene.gameScale),n.lives.setPosition(.5*n.scene.scale.width-200*n.scene.gameScale,50*n.scene.gameScale)}return n.playerCollisionCategory=n.scene.matter.world.nextCategory(),n.bodyDimensions=new Phaser.Math.Vector2(130*n.scene.gameScale,40*n.scene.gameScale),n.bodyOffset=new Phaser.Math.Vector2(10*n.scene.gameScale,-10*n.scene.gameScale),n.body=n.scene.matter.add.image(n.x+n.bodyOffset.x,n.y+n.bodyOffset.y),n.body.setBody({type:"rectangle",width:n.bodyDimensions.x,height:n.bodyDimensions.y}),n.body.setIgnoreGravity(!0),n.body.setFixedRotation(),n.body.setMass(50),n.body.setFriction(.5,0,100),n.body.setCollisionCategory(n.playerCollisionCategory),n.body.setCollidesWith([1,n.playerCollisionCategory]),n.body.gameObject=FlappyPlayer_assertThisInitialized(n),n.add(n.body),n.trailParticles=n.scene.add.particles("flappy_minigame_atlas","trail.png"),n.scene.world.add(n.trailParticles),n.trailParticleEmitter=n.trailParticles.createEmitter({on:!1,frequency:20,x:-45*n.scene.gameScale,y:-10*n.scene.gameScale,speedX:{start:-200,end:-200,ease:"Sine.easeOut"},alpha:{start:.5,end:0,ease:"Sine.easeOut"},scale:{start:.3,end:1,ease:"Sine.easeOut"},rotate:{start:0,end:0,ease:"Linear"},lifespan:500,follow:FlappyPlayer_assertThisInitialized(n)}),n.trailParticleEmitter.reserve(Math.ceil(n.trailParticleEmitter.lifespan/n.trailParticleEmitter.frequency)),n.jumpForce=new Phaser.Math.Vector2(0*n.scene.gameScale,-2*n.scene.gameScale),n.actualJumpForce=new Phaser.Math.Vector2,n.previousPosition=new Phaser.Math.Vector2,n.movedDirection=new Phaser.Math.Vector2,n.trailDisappearCooldown=0,n.state=null,n.SetState(FlappyPlayer.State.Alive),n}return function FlappyPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyPlayer_setPrototypeOf(e,t)}(FlappyPlayer,L),function FlappyPlayer_createClass(e,t,n){return t&&FlappyPlayer_defineProperties(e.prototype,t),n&&FlappyPlayer_defineProperties(e,n),e}(FlappyPlayer,[{key:"CreateInput",value:function CreateInput(){return new Sn(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new bn(this.scene,this)}},{key:"CreateAnimation",value:function CreateAnimation(){return new On(this.scene,this)}},{key:"update",value:function update(e,t){FlappyPlayer_get(FlappyPlayer_getPrototypeOf(FlappyPlayer.prototype),"update",this).call(this,e,t),this.x=this.body.body.position.x-this.bodyOffset.x,this.y=this.body.body.position.y-this.bodyOffset.y,this.movedDirection.setTo(2*this.scene.gameScale,this.y-this.previousPosition.y),0<this.trailDisappearCooldown?this.trailDisappearCooldown-=.001*t:this.trailParticleEmitter.on&&0<this.movedDirection.y&&(this.trailParticleEmitter.on=!1);var n=Math.atan2(this.movedDirection.y,this.movedDirection.x);n<0&&(n+=2*Math.PI),n=Phaser.Math.RadToDeg(n),this.trailParticleEmitter.rotate.start=n,this.trailParticleEmitter.rotate.end=n,this.previousPosition.setTo(this.x,this.y),this.scene.state==F.State.Game&&0!=this.body.body.velocity.x&&this.body.setVelocity(.9*this.body.body.velocity.x,this.body.body.velocity.y)}},{key:"UpdateHumanControl",value:function UpdateHumanControl(){FlappyPlayer_get(FlappyPlayer_getPrototypeOf(FlappyPlayer.prototype),"UpdateHumanControl",this).call(this),this.scene.state==F.State.Game&&this.playerInput.jump&&this.Jump()}},{key:"UpdateAIControl",value:function UpdateAIControl(){FlappyPlayer_get(FlappyPlayer_getPrototypeOf(FlappyPlayer.prototype),"UpdateAIControl",this).call(this),this.scene.state==F.State.Game&&this.playerAI.jump&&this.Jump()}},{key:"SetState",value:function SetState(e){if(this.state!=e){switch(this.state=e){case FlappyPlayer.State.Alive:this.OnEnterAliveState()}switch(e){case FlappyPlayer.State.Dead:this.OnEnterDeadState()}}}},{key:"OnEnterAliveState",value:function OnEnterAliveState(){this.animation.SetState(On.State.Alive)}},{key:"OnEnterDeadState",value:function OnEnterDeadState(){this.scene.OnPlayerDeath(),this.lives=0}},{key:"OnGameEnterPostGameState",value:function OnGameEnterPostGameState(e){FlappyPlayer_get(FlappyPlayer_getPrototypeOf(FlappyPlayer.prototype),"OnGameEnterPostGameState",this).call(this,e),this.trailParticleEmitter.on=!1}},{key:"OnMinigameWon",value:function OnMinigameWon(){FlappyPlayer_get(FlappyPlayer_getPrototypeOf(FlappyPlayer.prototype),"OnMinigameWon",this).call(this),this.body.setIgnoreGravity(!0),this.body.setVelocity(0,0),this.animation.SetState(On.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){FlappyPlayer_get(FlappyPlayer_getPrototypeOf(FlappyPlayer.prototype),"OnMinigameLost",this).call(this),this.body.setIgnoreGravity(!1),this.body.setVelocity(-3*this.scene.gameScale,-3*this.scene.gameScale),this.animation.SetState(On.State.Lose)}},{key:"Jump",value:function Jump(){switch(this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","flappy_player_one_jump");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","flappy_player_two_jump")}this.trailParticleEmitter.on=!0,this.trailDisappearCooldown=.2,this.body.setVelocity(0,0),this.actualJumpForce.set(this.jumpForce.x,this.jumpForce.y),this.body.applyForce(this.actualJumpForce),this.body.setIgnoreGravity(!1)}},{key:"OnArenaCollision",value:function OnArenaCollision(e){e.gameObjectA.gameObject.fountainSpine.visible&&e.gameObjectA.gameObject.body.y-this.y>300*this.scene.gameScale?h.Instance.Play("sfx_minigame","flappy_crash_spout"):h.Instance.Play("sfx_minigame","flappy_crash_pipe"),this.body.setVelocity(1.5*this.scene.gameScale*e.pair.collision.normal.x,1.5*this.scene.gameScale*e.pair.collision.normal.y),this.OnCrash()}},{key:"OnFloorCollision",value:function OnFloorCollision(){h.Instance.Play("sfx_minigame","flappy_crash_spout"),this.scene.minigameCamera.camera.shake(250,.002),this.SetState(FlappyPlayer.State.Dead)}},{key:"OnCrash",value:function OnCrash(){this.scene.minigameCamera.camera.shake(250,.002),this.lives.LoseLife(),this.lives.IsDead()?this.SetState(FlappyPlayer.State.Dead):(this.animation.SetState(On.State.Hit),this.Flash(),this.playerAI&&this.playerAI.PickNewTargetY())}},{key:"Flash",value:function Flash(){this.alpha=1,this.flashTween&&this.flashTween.stop(),this.flashTween=this.scene.tweens.add({targets:this,alpha:0,duration:100,ease:"Linear",yoyo:!0,repeat:2})}},{key:"destroy",value:function destroy(){FlappyPlayer_get(FlappyPlayer_getPrototypeOf(FlappyPlayer.prototype),"destroy",this).call(this)}}]),FlappyPlayer}();function FlappyObstacle_typeof(e){return(FlappyObstacle_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyObstacle_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FlappyObstacle_getPrototypeOf(e){return(FlappyObstacle_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyObstacle_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FlappyObstacle_setPrototypeOf(e,t){return(FlappyObstacle_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function FlappyPlayer_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(wn,"State",Object.freeze({Alive:0,Dead:1}));var Tn=function(){function FlappyObstacle(e,t){var n;return function FlappyObstacle_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyObstacle),(n=function FlappyObstacle_possibleConstructorReturn(e,t){return!t||"object"!==FlappyObstacle_typeof(t)&&"function"!=typeof t?FlappyObstacle_assertThisInitialized(e):t}(this,FlappyObstacle_getPrototypeOf(FlappyObstacle).call(this,e))).setPosition(t.x,t.y),n.sprite=n.scene.add.sprite(0,0,"flappy_minigame_atlas","sewer_top_pipe.png"),n.sprite.setFlipY(t.flipY),n.add(n.sprite),n.wheelSprite=n.scene.add.sprite(0,0,"flappy_minigame_atlas","sewer_pipe_top_wheel_blue.png"),n.add(n.wheelSprite),n.fountainSpine=n.scene.add.spine(0,0,"pipe_fountain","animation",!0),n.add(n.fountainSpine),n.body=n.scene.matter.add.image(.5*-n.scene.scale.width,.5*n.scene.scale.height,void 0,void 0),n.body.visible=!1,n.bodyDimensions=new Phaser.Math.Vector2(100*n.scene.gameScale,1e3*n.scene.gameScale),n.body.setBody({type:"rectangle",width:n.bodyDimensions.x,height:n.bodyDimensions.y}),n.body.setIgnoreGravity(!0),n.body.setSensor(!0),n.body.setFixedRotation(),n.body.setAngle(n.angle),n.body.setMass(1e3*n.scene.gameScale),n.body.setFriction(0,1),n.body.gameObject=FlappyObstacle_assertThisInitialized(n),n.bodyOffset=new Phaser.Math.Vector2(0,0),n.wheelColours=["blue","green","pink"],n}return function FlappyObstacle_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyObstacle_setPrototypeOf(e,t)}(FlappyObstacle,Phaser.GameObjects.Container),function FlappyObstacle_createClass(e,t,n){return t&&FlappyObstacle_defineProperties(e.prototype,t),n&&FlappyObstacle_defineProperties(e,n),e}(FlappyObstacle,[{key:"update",value:function update(){this.SnapBodyToPosition()}},{key:"Spawn",value:function Spawn(){var e=!this.sprite.flipY;this.bodyOffset.setTo(0),this.sprite.setPosition(0,0),this.fountainSpine.setPosition(0,this.sprite.flipY?.5*-this.sprite.height:.5*this.sprite.height),this.wheelSprite.setPosition(0,0),this.type=FlappyObstacle.Type.StraightPipe,this.fountainSpine.visible=!1,e&&.75<Phaser.Math.RND.frac()&&(this.type=FlappyObstacle.Type.BentPipe);var t=.35<Phaser.Math.RND.frac();if(this.wheelSprite.visible=t){var n=Phaser.Math.RND.pick(this.wheelColours);this.wheelSprite.setFrame("sewer_pipe_top_wheel_"+n+".png")}switch(this.type){case FlappyObstacle.Type.StraightPipe:this.sprite.setFrame("sewer_top_pipe.png"),this.bodyDimensions=new Phaser.Math.Vector2(100*this.scene.gameScale,1e3*this.scene.gameScale),this.body.setBody({type:"rectangle",width:this.bodyDimensions.x,height:this.bodyDimensions.y}),this.body.setIgnoreGravity(!0),this.body.setSensor(!0),this.body.setFixedRotation(),this.body.setAngle(this.angle),this.body.setMass(1e3*this.scene.gameScale),this.body.setFriction(0,1);break;case FlappyObstacle.Type.BentPipe:this.bodyOffset.setTo(-6*this.scene.gameScale,0),this.bodyDimensions=new Phaser.Math.Vector2(195*this.scene.gameScale,1e3*this.scene.gameScale),this.body.setBody({type:"rectangle",width:this.bodyDimensions.x,height:this.bodyDimensions.y}),this.body.setIgnoreGravity(!0),this.body.setSensor(!0),this.body.setFixedRotation(),this.body.setAngle(this.angle),this.body.setMass(1e3*this.scene.gameScale),this.body.setFriction(0,1),this.sprite.setFrame("sewer_top_pipe_bend.png"),this.fountainSpine.visible=!0,this.wheelSprite.setPosition(-60*this.scene.gameScale,0),this.fountainSpine.setPosition(this.fountainSpine.x+50*this.scene.gameScale,this.fountainSpine.y-140*this.scene.gameScale)}switch(this.SnapBodyToPosition(),this.type){case FlappyObstacle.Type.StraightPipe:var r=this.parentContainer.y+this.y,o=this.sprite.flipY&&r<this.scene.scale.height-.5*this.sprite.height*this.scene.gameScale||!this.sprite.flipY&&r>.5*this.sprite.height*this.scene.gameScale;if(!e&&o){this.fountainSpine.visible=o;var i=200*this.scene.gameScale;this.sprite.y+=i,this.fountainSpine.y+=i,this.wheelSprite.y+=i}}}},{key:"SnapBodyToPosition",value:function SnapBodyToPosition(){this.body.x=this.parentContainer.x+this.x+this.sprite.x+this.bodyOffset.x;var e=.5*this.bodyDimensions.y-.5*this.sprite.height;e=this.sprite.flipY?e:-1*e,this.body.y=this.parentContainer.y+this.y+e+this.bodyOffset.y}}]),FlappyObstacle}();function FlappyObstacleColumn_typeof(e){return(FlappyObstacleColumn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyObstacleColumn_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FlappyObstacleColumn_possibleConstructorReturn(e,t){return!t||"object"!==FlappyObstacleColumn_typeof(t)&&"function"!=typeof t?function FlappyObstacleColumn_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function FlappyObstacleColumn_getPrototypeOf(e){return(FlappyObstacleColumn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyObstacleColumn_setPrototypeOf(e,t){return(FlappyObstacleColumn_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function FlappyObstacle_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Tn,"Type",Object.freeze({StraightPipe:0,BentPipe:1}));var Cn=function(){function FlappyObstacleColumn(e){var t;return function FlappyObstacleColumn_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyObstacleColumn),(t=FlappyObstacleColumn_possibleConstructorReturn(this,FlappyObstacleColumn_getPrototypeOf(FlappyObstacleColumn).call(this,e))).topObstacle=new Tn(t.scene,{x:0,y:-275*t.scene.gameScale,flipY:!1}),t.add(t.topObstacle),t.bottomObstacle=new Tn(t.scene,{x:0,y:275*t.scene.gameScale,flipY:!0}),t.add(t.bottomObstacle),t.safeTop=0,t.safeBottom=0,t.obstacleWidth=250*t.scene.gameScale,t.visible=!1,t}return function FlappyObstacleColumn_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyObstacleColumn_setPrototypeOf(e,t)}(FlappyObstacleColumn,Phaser.GameObjects.Container),function FlappyObstacleColumn_createClass(e,t,n){return t&&FlappyObstacleColumn_defineProperties(e.prototype,t),n&&FlappyObstacleColumn_defineProperties(e,n),e}(FlappyObstacleColumn,[{key:"update",value:function update(e,t){this.topObstacle.update(e,t),this.bottomObstacle.update(e,t)}},{key:"Spawn",value:function Spawn(e){this.visible=!0;var t=e?.5*this.scene.scale.height-100*this.scene.gameScale:.5*this.scene.scale.height+Phaser.Math.RND.realInRange(-150,50)*this.scene.gameScale;this.setPosition(this.scene.scale.width+100*this.scene.gameScale,t),this.topObstacle.Spawn(),this.bottomObstacle.Spawn(),this.safeTop=this.topObstacle.body.y+.5*this.topObstacle.bodyDimensions.y+100*this.scene.gameScale,this.safeBottom=this.bottomObstacle.body.y-.5*this.bottomObstacle.bodyDimensions.y-100*this.scene.gameScale}}]),FlappyObstacleColumn}();function FlappyArena_typeof(e){return(FlappyArena_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyArena_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FlappyArena_possibleConstructorReturn(e,t){return!t||"object"!==FlappyArena_typeof(t)&&"function"!=typeof t?function FlappyArena_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function FlappyArena_getPrototypeOf(e){return(FlappyArena_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyArena_setPrototypeOf(e,t){return(FlappyArena_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var In=function(){function FlappyArena(e){var t;!function FlappyArena_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyArena),(t=FlappyArena_possibleConstructorReturn(this,FlappyArena_getPrototypeOf(FlappyArena).call(this,e))).backgrounds=[];for(var n=0;n<2;n++){var r=t.scene.add.sprite(.5*t.scene.scale.width+2048*n*t.scene.gameScale,.5*t.scene.scale.height,"flappy_background");t.add(r),t.backgrounds.push(r)}t.moveSpeed=200*t.scene.gameScale,t.obstaclePool=[];for(n=0;n<20;n++){var o=new Cn(t.scene);t.add(o),t.obstaclePool.push(o)}return t.obstacles=[],t.spawnTime=2,t.spawnTimer=4,t}return function FlappyArena_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyArena_setPrototypeOf(e,t)}(FlappyArena,Phaser.GameObjects.Container),function FlappyArena_createClass(e,t,n){return t&&FlappyArena_defineProperties(e.prototype,t),n&&FlappyArena_defineProperties(e,n),e}(FlappyArena,[{key:"update",value:function update(e,t){if(!(this.scene.state>F.State.Game)){for(var n=0;n<this.backgrounds.length;n++)this.backgrounds[n].x-=this.moveSpeed*t*.001,this.backgrounds[n].x<-1024*this.scene.gameScale&&(this.backgrounds[n].x+=2048*this.scene.gameScale*this.backgrounds.length);for(n=this.obstacles.length-1;0<=n;n--)this.obstacles[n].x-=this.moveSpeed*t*.001,this.obstacles[n].update(e,t),this.obstacles[n].x+.5*this.obstacles[n].obstacleWidth<0&&(this.obstacles[n].visible=!1,this.obstaclePool.push(this.obstacles[n]),this.obstacles.splice(n,1));this.scene.state<=F.State.Game&&(this.spawnTimer-=.001*t,this.spawnTimer<=0&&(this.SpawnObstacle(),this.spawnTimer+=this.spawnTime))}}},{key:"InitialiseCollisionCallbacks",value:function InitialiseCollisionCallbacks(){for(var e=0;e<this.obstaclePool.length;e++)for(var t=0;t<this.scene.players.length;t++)this.scene.matterCollision.addOnCollideStart({objectA:this.obstaclePool[e].topObstacle.body,objectB:this.scene.players[t].body,callback:this.OnPlayerArenaCollision,context:this}),this.scene.matterCollision.addOnCollideStart({objectA:this.obstaclePool[e].bottomObstacle.body,objectB:this.scene.players[t].body,callback:this.OnPlayerArenaCollision,context:this});for(e=0;e<this.scene.players.length;e++)this.scene.matterCollision.addOnCollideStart({objectA:this.scene.matter.world.walls.bottom,objectB:this.scene.players[e].body,callback:this.OnPlayerFloorCollision,context:this})}},{key:"GetNextObstacle",value:function GetNextObstacle(e){for(var t=9999999,n=null,r=0;r<this.obstacles.length;r++)if(this.obstacles[r].x>e){var o=Math.abs(this.obstacles[r].x-e);o<t&&(t=o,n=this.obstacles[r])}return n}},{key:"SpawnObstacle",value:function SpawnObstacle(){var e=this.obstaclePool[0];this.obstaclePool.splice(0,1);var t=0==this.obstacles.length;e.Spawn(t),this.obstacles.push(e)}},{key:"OnPlayerArenaCollision",value:function OnPlayerArenaCollision(e){this.scene.state==F.State.Game&&(e.gameObjectB.gameObject.OnArenaCollision(e),this.scene.OnPlayerArenaCollision(e))}},{key:"OnPlayerFloorCollision",value:function OnPlayerFloorCollision(e){this.scene.state==F.State.Game&&(e.gameObjectB.gameObject.OnFloorCollision(e),this.scene.OnPlayerArenaCollision(e))}}]),FlappyArena}();function FlappyTutorialPopup_typeof(e){return(FlappyTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==FlappyTutorialPopup_typeof(t)&&"function"!=typeof t?function FlappyTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function FlappyTutorialPopup_getPrototypeOf(e){return(FlappyTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyTutorialPopup_setPrototypeOf(e,t){return(FlappyTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var kn=function(){function FlappyTutorialPopup(e){var t;!function FlappyTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyTutorialPopup),(t=FlappyTutorialPopup_possibleConstructorReturn(this,FlappyTutorialPopup_getPrototypeOf(FlappyTutorialPopup).call(this,e))).panel.setTexture("flappy_minigame_atlas","how_to_flappy.png");for(var n=0;n<t.controlSpines.length;n++)t.scene.deviceManager.desktop?t.controlSpines[n].setAnimation(0,"up",!0):t.controlSpines[n].setAnimation(0,"tap",!0);return t}return function FlappyTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyTutorialPopup_setPrototypeOf(e,t)}(FlappyTutorialPopup,R),FlappyTutorialPopup}();function FlappyMinigame_typeof(e){return(FlappyMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FlappyMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FlappyMinigame_possibleConstructorReturn(e,t){return!t||"object"!==FlappyMinigame_typeof(t)&&"function"!=typeof t?function FlappyMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function FlappyMinigame_get(e,t,n){return(FlappyMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function FlappyMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=FlappyMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function FlappyMinigame_getPrototypeOf(e){return(FlappyMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FlappyMinigame_setPrototypeOf(e,t){return(FlappyMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var xn=function(){function FlappyMinigame(){var e;return function FlappyMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FlappyMinigame),e=FlappyMinigame_possibleConstructorReturn(this,FlappyMinigame_getPrototypeOf(FlappyMinigame).call(this,"FlappyMinigame")),h.Instance.AddLayer("sfx_minigame",{audioKeys:["flappy_crash_pipe","flappy_crash_spout","flappy_player_one_jump","flappy_player_two_jump"]}),h.Instance.AddLayer("music_minigame",{audioKeys:["music_factory"]}),h.Instance.Play("music_minigame","music_factory"),e}return function FlappyMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FlappyMinigame_setPrototypeOf(e,t)}(FlappyMinigame,F),function FlappyMinigame_createClass(e,t,n){return t&&FlappyMinigame_defineProperties(e.prototype,t),n&&FlappyMinigame_defineProperties(e,n),e}(FlappyMinigame,[{key:"create",value:function create(){FlappyMinigame_get(FlappyMinigame_getPrototypeOf(FlappyMinigame.prototype),"create",this).call(this),this.minigameTutorialPopup.on("onShowComplete",this.OnMinigameTutorialPopupShowComplete,this),this.minigameTutorialPopup.on("onHideStart",this.OnMinigameTutorialPopupHideStart,this),this.updateArena=!0}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new kn(this)}},{key:"CreateWorld",value:function CreateWorld(){FlappyMinigame_get(FlappyMinigame_getPrototypeOf(FlappyMinigame.prototype),"CreateWorld",this).call(this),this.matter.world.engine.world.gravity.y=2*this.gameScale,this.matter.world.setBounds(-200*this.gameScale,-50*this.gameScale,this.scale.width+400*this.gameScale,740*this.gameScale,50*this.gameScale,!0,!0,!1,!0),this.arena=new In(this),this.world.add(this.arena);for(var e=0;e<2;e++){var t=new wn(this,{data:this.sys.settings.data.gameData.players[e],playerNumber:e,playerController:e<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(t),this.world.add(this.players[e])}this.arena.InitialiseCollisionCallbacks(),this.flashSpine=this.add.spine(.5*this.scale.width,.5*this.scale.height,"flash","flash",!1),this.flashSpine.setScale(this.gameScale),this.flashSpine.visible=!1,this.world.add(this.flashSpine)}},{key:"update",value:function update(e,t){FlappyMinigame_get(FlappyMinigame_getPrototypeOf(FlappyMinigame.prototype),"update",this).call(this,e,t),this.updateArena&&this.arena.update(e,t)}},{key:"OnEnterGameState",value:function OnEnterGameState(){FlappyMinigame_get(FlappyMinigame_getPrototypeOf(FlappyMinigame.prototype),"OnEnterGameState",this).call(this)}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){FlappyMinigame_get(FlappyMinigame_getPrototypeOf(FlappyMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"OnMinigameTutorialPopupShowComplete",value:function OnMinigameTutorialPopupShowComplete(){this.updateArena=!1}},{key:"OnMinigameTutorialPopupHideStart",value:function OnMinigameTutorialPopupHideStart(){this.updateArena=!0}},{key:"OnPlayerArenaCollision",value:function OnPlayerArenaCollision(e){this.flashSpine.visible=!0,this.flashSpine.setPosition(e.pair.collision.supports[0].x,e.pair.collision.supports[0].y),this.flashSpine.setScale(.5),this.flashSpine.setAnimation(0,"flash",!1)}},{key:"OnPlayerDeath",value:function OnPlayerDeath(){this.EndGame()}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=this.players[0],t=0;t<this.players.length;t++)if(this.players[t].state==wn.State.Alive){e=this.players[t];break}return e}}]),FlappyMinigame}();function BoardTrophyIndicator_typeof(e){return(BoardTrophyIndicator_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardTrophyIndicator_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardTrophyIndicator_getPrototypeOf(e){return(BoardTrophyIndicator_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardTrophyIndicator_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardTrophyIndicator_setPrototypeOf(e,t){return(BoardTrophyIndicator_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var An=function(){function BoardTrophyIndicator(e,t){var n;return function BoardTrophyIndicator_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardTrophyIndicator),n=function BoardTrophyIndicator_possibleConstructorReturn(e,t){return!t||"object"!==BoardTrophyIndicator_typeof(t)&&"function"!=typeof t?BoardTrophyIndicator_assertThisInitialized(e):t}(this,BoardTrophyIndicator_getPrototypeOf(BoardTrophyIndicator).call(this,e,.5*e.scale.width,.5*e.scale.height)),I.AddChild(BoardTrophyIndicator_assertThisInitialized(n),t),n.indicatorBase=n.scene.add.sprite(0*n.scene.gameScale,0*n.scene.gameScale,"board_ui_atlas","board_trophy_indicator_base.png"),n.indicatorBase.setOrigin(.5,.67),n.add(n.indicatorBase),n.indicatorTrophy=n.scene.add.sprite(0*n.scene.gameScale,0*n.scene.gameScale,"board_ui_atlas","board_trophy_indicator_trophy.png"),n.add(n.indicatorTrophy),n.padding=75*n.scene.gameScale,n}return function BoardTrophyIndicator_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardTrophyIndicator_setPrototypeOf(e,t)}(BoardTrophyIndicator,Phaser.GameObjects.Container),function BoardTrophyIndicator_createClass(e,t,n){return t&&BoardTrophyIndicator_defineProperties(e.prototype,t),n&&BoardTrophyIndicator_defineProperties(e,n),e}(BoardTrophyIndicator,[{key:"update",value:function update(){var e=this.scene.board.x+this.scene.board.content.x+this.scene.board.trophy.x,t=this.scene.board.y+this.scene.board.content.y+this.scene.board.trophy.y,n=e-this.scene.board.camera.camera.midPoint.x,r=t-this.scene.board.camera.camera.midPoint.y,o=this.scene.board.trophy.visible&&(Math.abs(n)>.5*this.scene.viewport.width||Math.abs(r)>.5*this.scene.viewport.height);if(this.visible=o,this.visible){this.x=e-this.scene.board.camera.camera.midPoint.x,this.y=t-this.scene.board.camera.camera.midPoint.y;var i=this.x/(.5*this.scene.viewport.width-this.padding),a=this.y/(.5*this.scene.viewport.height-this.padding),s=Math.abs(i)>Math.abs(a)?i:a,l=Phaser.Math.RadToDeg(Math.atan2(a,i))+90;this.indicatorBase.angle=l,1<Math.abs(s)&&(this.x/=Math.abs(s),this.y/=Math.abs(s)),this.x+=.5*this.scene.scale.width,this.y+=.5*this.scene.scale.height}}}]),BoardTrophyIndicator}();function BoardTrophyPopup_typeof(e){return(BoardTrophyPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardTrophyPopup_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardTrophyPopup_getPrototypeOf(e){return(BoardTrophyPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardTrophyPopup_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BoardTrophyPopup_setPrototypeOf(e,t){return(BoardTrophyPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Bn=function(){function BoardTrophyPopup(e,t,n){var r;return function BoardTrophyPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardTrophyPopup),n||(n={}),r=function BoardTrophyPopup_possibleConstructorReturn(e,t){return!t||"object"!==BoardTrophyPopup_typeof(t)&&"function"!=typeof t?BoardTrophyPopup_assertThisInitialized(e):t}(this,BoardTrophyPopup_getPrototypeOf(BoardTrophyPopup).call(this,e,.5*e.scale.width,.5*e.scale.height)),I.AddChild(BoardTrophyPopup_assertThisInitialized(r),t),r.background=r.scene.add.sprite(0,0,"board_ui_atlas","popup_trophy_no.png"),r.add(r.background),r.titleText=r.scene.add.text(0*r.scene.gameScale,-145*r.scene.gameScale,"",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:40*r.scene.gameScale+"px",color:"#000000"}),r.titleText.setOrigin(.5),r.titleText.setStroke("#FFFFFF",8*r.scene.gameScale),r.add(r.titleText),r.descriptionText=r.scene.add.text(-120*r.scene.gameScale,20*r.scene.gameScale,"",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",align:"center",fontSize:40*r.scene.gameScale+"px",color:"#000000"}),r.descriptionText.setOrigin(.5),r.descriptionText.setStroke("#FFFFFF",8*r.scene.gameScale),r.add(r.descriptionText),r.showTime=2,r.showTimer=0,r.player=null,r.trophy=null,r.visible=!1,r.canPurchase=!1,r}return function BoardTrophyPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardTrophyPopup_setPrototypeOf(e,t)}(BoardTrophyPopup,Phaser.GameObjects.Container),function BoardTrophyPopup_createClass(e,t,n){return t&&BoardTrophyPopup_defineProperties(e.prototype,t),n&&BoardTrophyPopup_defineProperties(e,n),e}(BoardTrophyPopup,[{key:"update",value:function update(e,t){this.visible&&0<this.showTimer&&(this.showTimer-=.001*t,this.showTimer<=0&&this.Hide())}},{key:"Show",value:function Show(e,t){this.player=e,this.trophy=t,this.canPurchase=this.trophy.CanPlayerPurchase(e),this.canPurchase?(this.background.setFrame("popup_trophy_yes.png"),this.titleText.setText(v.Instance.GetString("congrats")),this.descriptionText.setPosition(-120*this.scene.gameScale,20*this.scene.gameScale),this.descriptionText.setText(v.Instance.GetString("trophy_can_purchase"))):(this.background.setFrame("popup_trophy_no.png"),this.titleText.setText(v.Instance.GetString("sorry")),this.descriptionText.setPosition(-120*this.scene.gameScale,20*this.scene.gameScale),this.descriptionText.setText(v.Instance.GetString("trophy_cant_purchase"))),this.descriptionText.setWordWrapWidth(250*this.scene.gameScale),I.ClampTextToDimensions(this.titleText,280*this.scene.gameScale,100*this.scene.gameScale),I.ClampTextToDimensions(this.descriptionText,250*this.scene.gameScale,300*this.scene.gameScale),this.visible=!0,this.setScale(0),this.scene.tweens.add({targets:this,scaleX:1,scaleY:1,duration:750,ease:"Back.easeOut",onComplete:this.OnShowComplete,onCompleteScope:this})}},{key:"OnShowComplete",value:function OnShowComplete(){this.showTimer=this.showTime}},{key:"Hide",value:function Hide(){this.scene.tweens.add({targets:this,scaleX:0,scaleY:0,duration:500,ease:"Sine.easeIn",onComplete:this.OnHideComplete,onCompleteScope:this})}},{key:"OnHideComplete",value:function OnHideComplete(){this.player=null,this.trophy=null,this.emit("attemptPurchase"),this.visible=!1}}]),BoardTrophyPopup}();function SnowballPersonLane_typeof(e){return(SnowballPersonLane_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballPersonLane_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowballPersonLane_possibleConstructorReturn(e,t){return!t||"object"!==SnowballPersonLane_typeof(t)&&"function"!=typeof t?function SnowballPersonLane_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SnowballPersonLane_getPrototypeOf(e){return(SnowballPersonLane_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballPersonLane_setPrototypeOf(e,t){return(SnowballPersonLane_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Mn=function(){function SnowballPersonLane(e,t,n,r,o){var i;return function SnowballPersonLane_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballPersonLane),(i=SnowballPersonLane_possibleConstructorReturn(this,SnowballPersonLane_getPrototypeOf(SnowballPersonLane).call(this,e))).laneCount=n,i.laneOffset=r,i.laneIndex=o,i.spawnAngle=o%2==0?90:-90,i.SnowballPersonSpawner=t,i.spawnTime=3,i.spawnTimer=i.spawnTime,i.x=.5*i.scene.scale.width,i.y=.75*i.scene.scale.height+(i.laneIndex-.5*(i.laneCount-1))*i.laneOffset,i.bushLeft=i.scene.add.sprite(-720*i.scene.gameScale+40*i.laneIndex*i.scene.gameScale,-75*i.scene.gameScale,"snowball_minigame_atlas","snowball_bush.png"),i.bushLeft.setScale(-1,1),i.add(i.bushLeft),i.bushRight=i.scene.add.sprite(720*i.scene.gameScale-40*i.laneIndex*i.scene.gameScale,-75*i.scene.gameScale,"snowball_minigame_atlas","snowball_bush.png"),i.add(i.bushRight),i}return function SnowballPersonLane_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballPersonLane_setPrototypeOf(e,t)}(SnowballPersonLane,Phaser.GameObjects.Container),function SnowballPersonLane_createClass(e,t,n){return t&&SnowballPersonLane_defineProperties(e.prototype,t),n&&SnowballPersonLane_defineProperties(e,n),e}(SnowballPersonLane,[{key:"update",value:function update(e,t){this.spawnTimer-=.001*t,this.spawnTimer<=0&&this.SpawnPerson()}},{key:"SpawnPerson",value:function SpawnPerson(){var e=this.SnowballPersonSpawner.GetPersonToSpawn(),t=this.x+Math.min(.5*this.scene.viewport.width+100*this.scene.gameScale,600*this.scene.gameScale)*(this.laneIndex%2==0?1:-1),n=this.y-1*this.scene.gameScale;e?(e.Spawn(t,n,this.spawnAngle),this.spawnTimer=this.spawnTime):console.log("no person available")}}]),SnowballPersonLane}();function SnowballUI_typeof(e){return(SnowballUI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballUI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowballUI_possibleConstructorReturn(e,t){return!t||"object"!==SnowballUI_typeof(t)&&"function"!=typeof t?function SnowballUI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SnowballUI_get(e,t,n){return(SnowballUI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SnowballUI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SnowballUI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SnowballUI_getPrototypeOf(e){return(SnowballUI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballUI_setPrototypeOf(e,t){return(SnowballUI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Dn=function(){function SnowballUI(e){return function SnowballUI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballUI),SnowballUI_possibleConstructorReturn(this,SnowballUI_getPrototypeOf(SnowballUI).call(this,e))}return function SnowballUI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballUI_setPrototypeOf(e,t)}(SnowballUI,k),function SnowballUI_createClass(e,t,n){return t&&SnowballUI_defineProperties(e.prototype,t),n&&SnowballUI_defineProperties(e,n),e}(SnowballUI,[{key:"update",value:function update(e,t){SnowballUI_get(SnowballUI_getPrototypeOf(SnowballUI.prototype),"update",this).call(this,e,t)}}]),SnowballUI}();function SnowballPersonSpawner_typeof(e){return(SnowballPersonSpawner_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballPersonSpawner_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowballPersonSpawner_getPrototypeOf(e){return(SnowballPersonSpawner_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballPersonSpawner_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SnowballPersonSpawner_setPrototypeOf(e,t){return(SnowballPersonSpawner_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var jn=function(){function SnowballPersonSpawner(e,t){var n;!function SnowballPersonSpawner_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballPersonSpawner),(n=function SnowballPersonSpawner_possibleConstructorReturn(e,t){return!t||"object"!==SnowballPersonSpawner_typeof(t)&&"function"!=typeof t?SnowballPersonSpawner_assertThisInitialized(e):t}(this,SnowballPersonSpawner_getPrototypeOf(SnowballPersonSpawner).call(this,e))).people=[],n.availableCharacters=t,n.peopleLanes=[];for(var r=150*n.scene.gameScale,o=0;o<n.availableCharacters.length;o++){var i=new Rn(n.scene,n.availableCharacters[o%n.availableCharacters.length]);n.people.push(i),n.add(i)}I.ShuffleArray(n.people);for(o=0;o<2;o++){var a=new Mn(n.scene,SnowballPersonSpawner_assertThisInitialized(n),2,r,o);n.peopleLanes.push(a),n.add(a)}return n.testPersonRect=new Phaser.Geom.Rectangle(0,0,n.people[0].body.body.shape.width,n.people[0].body.body.shape.height),n.testPersonBall=new Phaser.Geom.Rectangle(0,0,10*n.scene.gameScale,10*n.scene.gameScale),n}return function SnowballPersonSpawner_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballPersonSpawner_setPrototypeOf(e,t)}(SnowballPersonSpawner,Phaser.GameObjects.Container),function SnowballPersonSpawner_createClass(e,t,n){return t&&SnowballPersonSpawner_defineProperties(e.prototype,t),n&&SnowballPersonSpawner_defineProperties(e,n),e}(SnowballPersonSpawner,[{key:"TestCollision",value:function TestCollision(e,t,n,r){for(var o=0;o<this.people.length;o++)if(this.people[o].state!=Rn.State.Inactive){var i=this.people[o].GetExpectedPosition(r);this.testPersonRect.setPosition(i.x-.5*this.testPersonRect.width,i.y-.5*this.testPersonRect.height),this.testPersonBall.setPosition(e-.5*this.testPersonBall.width,t-.5*this.testPersonBall.height);var a=0<Phaser.Geom.Rectangle.Intersection(this.testPersonBall,this.testPersonRect).width;if(this.scene.debugDraw&&(this.scene.debugCanvas.context.beginPath(),this.scene.debugCanvas.context.fillStyle=a?"rgba(0, 255, 0, 1)":"rgba(255, 0, 0, 0.1)",this.scene.debugCanvas.context.rect(this.testPersonRect.x,this.testPersonRect.y,this.testPersonRect.width,this.testPersonRect.height),this.scene.debugCanvas.context.fill(),this.scene.debugCanvas.context.closePath()),a)return o}return-1}},{key:"GetActivePeopleCount",value:function GetActivePeopleCount(){for(var e=0,t=0;t<this.people.length;t++)this.people[t].state==Rn.State.Active&&e++;return e}},{key:"update",value:function update(e,t){for(var n=0;n<this.peopleLanes.length;n++)this.peopleLanes[n].update(e,t);for(n=0;n<this.people.length;n++)this.people[n].update(e,t);this.sort("y")}},{key:"GetPersonToSpawn",value:function GetPersonToSpawn(){for(var e=0;e<this.people.length;e++)if(this.people[e].state==Rn.State.Inactive){var t=this.people[e];return I.ShuffleArray(this.people),t}}}]),SnowballPersonSpawner}();function SnowballPerson_typeof(e){return(SnowballPerson_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballPerson_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowballPerson_getPrototypeOf(e){return(SnowballPerson_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballPerson_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SnowballPerson_setPrototypeOf(e,t){return(SnowballPerson_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Rn=function(){function SnowballPerson(e,t,n){var r;!function SnowballPerson_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballPerson),(r=function SnowballPerson_possibleConstructorReturn(e,t){return!t||"object"!==SnowballPerson_typeof(t)&&"function"!=typeof t?SnowballPerson_assertThisInitialized(e):t}(this,SnowballPerson_getPrototypeOf(SnowballPerson).call(this,e))).setPosition(.5*r.scene.scale.width,.5*r.scene.scale.height),r.spine=r.scene.add.spine(0,0,"minigame_"+t,"snowball_walk",!0),I.ApplyWinterSkin(r.spine),r.add(r.spine);r.scene.cache.json.get("physics_shapes");return r.body=r.scene.matter.add.image(r.x,r.y-50*r.scene.gameScale,void 0,void 0,{shape:{type:"rectangle",width:80*r.scene.gameScale,height:100*r.scene.gameScale}}),r.body.visible=!1,r.body.setIgnoreGravity(!0),r.body.setSensor(!0),r.body.setScale(r.scene.gameScale),r.body.gameObject=SnowballPerson_assertThisInitialized(r),r.body.setMass(.01),r.moveSpeed=120*r.scene.gameScale,r.state=null,r.SetState(SnowballPerson.State.Inactive),r.previousPosition=new Phaser.Math.Vector2,r.movedDirection=new Phaser.Math.Vector2,r.expectedPosition=new Phaser.Math.Vector2,r.spawnX=0,r.targetX=0,r}return function SnowballPerson_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballPerson_setPrototypeOf(e,t)}(SnowballPerson,Phaser.GameObjects.Container),function SnowballPerson_createClass(e,t,n){return t&&SnowballPerson_defineProperties(e.prototype,t),n&&SnowballPerson_defineProperties(e,n),e}(SnowballPerson,[{key:"update",value:function update(e,t){this.x=this.body.body.position.x,this.y=this.body.body.position.y+50*this.scene.gameScale,this.movedDirection.setTo(this.x-this.previousPosition.x,this.y-this.previousPosition.y);var n=Math.atan2(this.movedDirection.y,this.movedDirection.x);switch(n<0&&(n+=2*Math.PI),n=Phaser.Math.RadToDeg(n),this.state){case SnowballPerson.State.Active:case SnowballPerson.State.Leaving:this.UpdateActiveState(e,t)}this.previousPosition.setTo(this.x,this.y)}},{key:"Spawn",value:function Spawn(e,t){this.body.setPosition(e,t-50*this.scene.gameScale),this.x=e,this.y=t,this.spawnX=e,this.spawnX>.5*this.scene.scale.width?this.setScale(-1,1):this.setScale(1,1),this.SetState(SnowballPerson.State.Active)}},{key:"SetState",value:function SetState(e){switch(this.state=e,this.state){case SnowballPerson.State.Active:this.OnEnterActiveState();break;case SnowballPerson.State.Inactive:this.OnEnterInactiveState();break;case SnowballPerson.State.Collecting:this.OnEnterCollectingState();break;case SnowballPerson.State.Leaving:this.OnEnterLeavingState()}}},{key:"OnEnterActiveState",value:function OnEnterActiveState(){this.visible=!0,this.moveSpeed=120*this.scene.gameScale,this.spine.setAnimation(0,"snowball_walk",!0)}},{key:"OnEnterInactiveState",value:function OnEnterInactiveState(){this.visible=!1,this.body.setVelocity(0,0)}},{key:"OnEnterCollectingState",value:function OnEnterCollectingState(){this.body.setVelocity(0,0)}},{key:"OnEnterLeavingState",value:function OnEnterLeavingState(){this.visible=!0,this.moveSpeed=360*this.scene.gameScale,this.spine.setAnimation(0,"snowball_run",!0)}},{key:"UpdateActiveState",value:function UpdateActiveState(e,t){this.body.x+=this.moveSpeed*this.scaleX*t*.001;var n=Math.min(.5*this.scene.viewport.width+100*this.scene.gameScale,600*this.scene.gameScale),r=.5*this.scene.scale.width+(this.spawnX>.5*this.scene.scale.width?-n:n);this.spawnX<r&&this.x>r?this.SetState(SnowballPerson.State.Inactive):this.spawnX>r&&this.x<r&&this.SetState(SnowballPerson.State.Inactive)}},{key:"GetExpectedPosition",value:function GetExpectedPosition(e){return this.expectedPosition.setTo(this.body.x+this.moveSpeed*this.scaleX*e*.001,this.body.y),this.expectedPosition}},{key:"OnSnowballCollidesPerson",value:function OnSnowballCollidesPerson(){this.SetState(SnowballPerson.State.Leaving)}}]),SnowballPerson}();function SnowballPlayerAI_typeof(e){return(SnowballPlayerAI_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballPlayerAI_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowballPlayerAI_possibleConstructorReturn(e,t){return!t||"object"!==SnowballPlayerAI_typeof(t)&&"function"!=typeof t?function SnowballPlayerAI_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SnowballPlayerAI_get(e,t,n){return(SnowballPlayerAI_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SnowballPlayerAI_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SnowballPlayerAI_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SnowballPlayerAI_getPrototypeOf(e){return(SnowballPlayerAI_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballPlayerAI_setPrototypeOf(e,t){return(SnowballPlayerAI_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function SnowballPerson_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Rn,"State",Object.freeze({Inactive:0,Active:1,Collecting:2,Leaving:3}));var En=function(){function SnowballPlayerAI(e,t){var n;switch(function SnowballPlayerAI_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballPlayerAI),(n=SnowballPlayerAI_possibleConstructorReturn(this,SnowballPlayerAI_getPrototypeOf(SnowballPlayerAI).call(this,e,t))).attemptShotTime=1,n.attemptShotTimer=n.attemptShotTime,n.fireChanceOnMiss=0,n.idealTargetHitCount=1,n.collisionCheckRadius=50*n.scene.gameScale,n.maxTargetHitCount=20,n.difficulty){case A.Difficulty.EASY:n.fireChanceOnMiss=.95,n.fireChanceOnHit=.05;break;case A.Difficulty.MEDIUM:n.fireChanceOnMiss=.8,n.fireChanceOnHit=.2;break;case A.Difficulty.HARD:n.fireChanceOnMiss=.75,n.fireChanceOnHit=.35}return n}return function SnowballPlayerAI_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballPlayerAI_setPrototypeOf(e,t)}(SnowballPlayerAI,A),function SnowballPlayerAI_createClass(e,t,n){return t&&SnowballPlayerAI_defineProperties(e.prototype,t),n&&SnowballPlayerAI_defineProperties(e,n),e}(SnowballPlayerAI,[{key:"update",value:function update(e,t){if(SnowballPlayerAI_get(SnowballPlayerAI_getPrototypeOf(SnowballPlayerAI.prototype),"update",this).call(this,e,t),this.player.enabled&&this.player.CanShoot())if(0<this.attemptShotTimer)this.attemptShotTimer-=.001*t;else{var n=0<this.player.PredictedPeopleToHit(10*this.scene.gameScale),r=Math.random();(n?r<this.fireChanceOnHit:r<this.fireChanceOnMiss)&&this.player.Shoot(),this.attemptShotTimer=Math.random()*this.attemptShotTime}}}]),SnowballPlayerAI}();function SnowballPlayerInput_typeof(e){return(SnowballPlayerInput_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballPlayerInput_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowballPlayerInput_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SnowballPlayerInput_get(e,t,n){return(SnowballPlayerInput_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SnowballPlayerInput_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SnowballPlayerInput_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SnowballPlayerInput_getPrototypeOf(e){return(SnowballPlayerInput_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballPlayerInput_setPrototypeOf(e,t){return(SnowballPlayerInput_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Fn=function(){function SnowballPlayerInput(e,t){var n;return function SnowballPlayerInput_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballPlayerInput),(n=function SnowballPlayerInput_possibleConstructorReturn(e,t){return!t||"object"!==SnowballPlayerInput_typeof(t)&&"function"!=typeof t?SnowballPlayerInput_assertThisInitialized(e):t}(this,SnowballPlayerInput_getPrototypeOf(SnowballPlayerInput).call(this,e,t))).leftKey.on("down",n.OnKeyDown,SnowballPlayerInput_assertThisInitialized(n)),n.downKey.on("down",n.OnKeyDown,SnowballPlayerInput_assertThisInitialized(n)),n.rightKey.on("down",n.OnKeyDown,SnowballPlayerInput_assertThisInitialized(n)),n.upKey.on("down",n.OnKeyDown,SnowballPlayerInput_assertThisInitialized(n)),n}return function SnowballPlayerInput_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballPlayerInput_setPrototypeOf(e,t)}(SnowballPlayerInput,be),function SnowballPlayerInput_createClass(e,t,n){return t&&SnowballPlayerInput_defineProperties(e.prototype,t),n&&SnowballPlayerInput_defineProperties(e,n),e}(SnowballPlayerInput,[{key:"update",value:function update(e,t){SnowballPlayerInput_get(SnowballPlayerInput_getPrototypeOf(SnowballPlayerInput.prototype),"update",this).call(this,e,t)}},{key:"OnButtonPressed",value:function OnButtonPressed(){SnowballPlayerInput_get(SnowballPlayerInput_getPrototypeOf(SnowballPlayerInput.prototype),"OnButtonPressed",this).call(this),this.player.Shoot()}},{key:"OnKeyDown",value:function OnKeyDown(){this.player.Shoot()}}]),SnowballPlayerInput}();function SnowballPlayerAnimation_typeof(e){return(SnowballPlayerAnimation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballPlayerAnimation_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowballPlayerAnimation_possibleConstructorReturn(e,t){return!t||"object"!==SnowballPlayerAnimation_typeof(t)&&"function"!=typeof t?function SnowballPlayerAnimation_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SnowballPlayerAnimation_get(e,t,n){return(SnowballPlayerAnimation_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SnowballPlayerAnimation_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SnowballPlayerAnimation_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SnowballPlayerAnimation_getPrototypeOf(e){return(SnowballPlayerAnimation_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballPlayerAnimation_setPrototypeOf(e,t){return(SnowballPlayerAnimation_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Hn=function(){function SnowballPlayerAnimation(e,t){return function SnowballPlayerAnimation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballPlayerAnimation),SnowballPlayerAnimation_possibleConstructorReturn(this,SnowballPlayerAnimation_getPrototypeOf(SnowballPlayerAnimation).call(this,e,t))}return function SnowballPlayerAnimation_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballPlayerAnimation_setPrototypeOf(e,t)}(SnowballPlayerAnimation,H),function SnowballPlayerAnimation_createClass(e,t,n){return t&&SnowballPlayerAnimation_defineProperties(e.prototype,t),n&&SnowballPlayerAnimation_defineProperties(e,n),e}(SnowballPlayerAnimation,[{key:"CreateSpine",value:function CreateSpine(){var e=this.scene.add.spine(0,0,"minigame_"+this.player.characterData.id,"sumo_idle",!0);return I.ApplyWinterSkin(e),e}},{key:"SetState",value:function SetState(e){SnowballPlayerAnimation_get(SnowballPlayerAnimation_getPrototypeOf(SnowballPlayerAnimation.prototype),"SetState",this).call(this,e),e==SnowballPlayerAnimation.State.Throw?this.spine.on("spine.complete",this.OnThrowAnimationComplete,this):this.spine.off("spine.complete",this.OnThrowAnimationComplete,this)}},{key:"OnThrowAnimationComplete",value:function OnThrowAnimationComplete(){this.SetState(SnowballPlayerAnimation.State.Idle)}},{key:"update",value:function update(e,t){SnowballPlayerAnimation_get(SnowballPlayerAnimation_getPrototypeOf(SnowballPlayerAnimation.prototype),"update",this).call(this,e,t)}},{key:"destroy",value:function destroy(){SnowballPlayerAnimation_get(SnowballPlayerAnimation_getPrototypeOf(SnowballPlayerAnimation.prototype),"destroy",this).call(this)}}]),SnowballPlayerAnimation}();function SnowBall_typeof(e){return(SnowBall_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowBall_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowBall_getPrototypeOf(e){return(SnowBall_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowBall_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SnowBall_setPrototypeOf(e,t){return(SnowBall_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function SnowballPlayerAnimation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Hn,"State",Object.freeze({Idle:{animationName:"snowball_idle",loop:!0},Throw:{animationName:"snowball_throw",loop:!1,allowRestart:!0},Win:{animationName:"sumo_success",loop:!1},Lose:{animationName:"sumo_fail",loop:!1}}));var Ln=function(){function SnowBall(e,t){var n;!function SnowBall_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowBall),(n=function SnowBall_possibleConstructorReturn(e,t){return!t||"object"!==SnowBall_typeof(t)&&"function"!=typeof t?SnowBall_assertThisInitialized(e):t}(this,SnowBall_getPrototypeOf(SnowBall).call(this,e))).player=t,n.setPosition(-9999,-9999),n.sprite=n.scene.add.image(0,0,"snowball_minigame_atlas","snowball.png"),n.add(n.sprite),n.body=n.scene.matter.add.image(n.x,n.y,void 0,void 0,{shape:{type:"circle",radius:10*n.scene.gameScale}}),n.body.setSensor(!0),n.body.setIgnoreGravity(!0),n.body.setScale(n.scene.gameScale),n.body.gameObject=SnowBall_assertThisInitialized(n),n.body.setMass(50),n.body.setFriction(1,0,0),n.body.setBounce(.25),n.visible=!1,n.trailParticles=n.scene.add.particles("snowball_minigame_atlas","trail.png"),n.scene.trailContainer.add(n.trailParticles),n.trailParticleEmitter=n.trailParticles.createEmitter({on:!1,frequency:5,x:0,y:0,alpha:{start:1,end:0,ease:"Sine.easeOut"},scale:{start:1,end:0,ease:"Sine.easeOut"},rotate:{start:0,end:0,ease:"Linear"},lifespan:500,follow:SnowBall_assertThisInitialized(n)}),n.trailParticleEmitter.reserve(Math.ceil(n.trailParticleEmitter.lifespan/n.trailParticleEmitter.frequency)),n.force=new Phaser.Math.Vector2,n.scene.matterCollision.addOnCollideStart({objectA:n.scene.matter.world.walls.bottom,objectB:n.body,callback:n.OnBoundsCollision,context:SnowBall_assertThisInitialized(n)});for(var r=0;r<n.scene.snowballPersonSpawner.people.length;r++)n.scene.matterCollision.addOnCollideStart({objectA:n.scene.snowballPersonSpawner.people[r].body,objectB:n.body,callback:n.OnPersonCollision,context:SnowBall_assertThisInitialized(n)});return n.state=null,n.SetState(SnowBall.State.Inactive),n}return function SnowBall_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowBall_setPrototypeOf(e,t)}(SnowBall,Phaser.GameObjects.Container),function SnowBall_createClass(e,t,n){return t&&SnowBall_defineProperties(e.prototype,t),n&&SnowBall_defineProperties(e,n),e}(SnowBall,[{key:"update",value:function update(){if(this.x=this.body.body.position.x,this.y=this.body.body.position.y,this.trailParticleEmitter.on){var e=Math.atan2(this.body.body.velocity.y,this.body.body.velocity.x);e=Phaser.Math.RadToDeg(e),this.trailParticleEmitter.rotate.start=e,this.trailParticleEmitter.rotate.end=e}}},{key:"SetState",value:function SetState(e){if(this.state!=e)switch(this.state=e,this.state){case SnowBall.State.Inactive:this.OnEnterInactiveState();break;case SnowBall.State.Flying:this.OnEnterFlyingState();break;case SnowBall.State.Despawning:this.OnEnterDespawningState()}}},{key:"OnEnterInactiveState",value:function OnEnterInactiveState(){this.visible=!1,this.body.setSensor(!0),this.body.setIgnoreGravity(!0),this.body.setVelocity(0,0),this.body.setCollidesWith(0),this.trailParticleEmitter.on=!1}},{key:"OnEnterFlyingState",value:function OnEnterFlyingState(){this.visible=!0,this.alpha=1,this.body.setIgnoreGravity(!1),this.body.setVelocity(0,0),this.body.setSensor(!1),this.body.setCollisionCategory(this.scene.ballCollisionCategory),this.body.setCollidesWith([1]),this.trailParticleEmitter.on=!0}},{key:"OnEnterDespawningState",value:function OnEnterDespawningState(){this.scene.tweens.add({targets:this,alpha:0,duration:1e3,ease:"Sine.easeOut",onComplete:this.OnDespawnComplete,onCompleteScope:this}),this.trailParticleEmitter.on=!1}},{key:"UpdateInactiveState",value:function UpdateInactiveState(){}},{key:"UpdateFlyingState",value:function UpdateFlyingState(){}},{key:"OnDespawnComplete",value:function OnDespawnComplete(){this.SetState(SnowBall.State.Inactive)}},{key:"Spawn",value:function Spawn(e,t,n,r){this.SetState(SnowBall.State.Flying),this.body.setPosition(e,t),this.body.setAngle(n),this.x=e,this.y=t,this.angle=n;var o=Phaser.Math.DegToRad(n);this.force.setTo(Math.cos(o),Math.sin(o)),this.force.scale(r),this.body.applyForce(this.force)}},{key:"OnBoundsCollision",value:function OnBoundsCollision(){this.SetState(SnowBall.State.Inactive)}},{key:"OnPersonCollision",value:function OnPersonCollision(e){e.gameObjectA.gameObject.state!=Rn.State.Inactive&&(e.gameObjectA.gameObject.OnSnowballCollidesPerson(e),this.scene.OnSnowballHitPerson(this),this.player.AddScore(),this.SetState(SnowBall.State.Inactive))}}]),SnowBall}();function SnowballPlayer_typeof(e){return(SnowballPlayer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballPlayer_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowballPlayer_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SnowballPlayer_get(e,t,n){return(SnowballPlayer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SnowballPlayer_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SnowballPlayer_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SnowballPlayer_getPrototypeOf(e){return(SnowballPlayer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballPlayer_setPrototypeOf(e,t){return(SnowballPlayer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function SnowBall_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Ln,"State",Object.freeze({Inactive:0,Flying:1,Despawning:2}));var Gn=function(){function SnowballPlayer(e,t){var n;!function SnowballPlayer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballPlayer),(n=function SnowballPlayer_possibleConstructorReturn(e,t){return!t||"object"!==SnowballPlayer_typeof(t)&&"function"!=typeof t?SnowballPlayer_assertThisInitialized(e):t}(this,SnowballPlayer_getPrototypeOf(SnowballPlayer).call(this,e,t))).minAngle=120,n.maxAngle=210,n.aimArrowSprite=n.scene.add.image(0,0*n.scene.gameScale,"sumo_rotator_atlas","rotator_animation_8.png"),n.aimArrowSprite.setOrigin(.5,.5),n.add(n.aimArrowSprite),n.bringToTop(n.animation),n.shootCooldownTime=1,n.shootCooldown=0,n.balls=[],n.shootForce=1.75*n.scene.gameScale,n.spawnDistanceFromBase=125*n.scene.gameScale,n.enabled=!0;for(var r=n.aimAngle=0;r<1;r++){var o=new Ln(n.scene,SnowballPlayer_assertThisInitialized(n));n.scene.ballContainer.add(o),n.balls.push(o)}switch(1<n.scene.playerCount&&n.playerNumber==M.PlayerNumber.ONE||1==n.scene.playerCount&&n.playerNumber==M.PlayerNumber.TWO){case!0:n.setPosition(.5*n.scene.scale.width+150*n.scene.gameScale,.5*n.scene.scale.height-230*n.scene.gameScale),n.setAngle(0),n.aimAngle=140,n.minAngle=140,n.maxAngle=230;break;case!1:n.setPosition(.5*n.scene.scale.width-150*n.scene.gameScale,.5*n.scene.scale.height-230*n.scene.gameScale),n.setAngle(0),n.aimAngle=210,n.minAngle=120,n.maxAngle=210}return n.scoreText=n.scene.add.text(n.x,n.y-150*n.scene.gameScale,"0",{fontFamily:"ar"!=v.Instance.language?"FredBurger Black":"FredBurger Black Arabic",fontSize:50*n.scene.gameScale+"px",color:"#FF0000"}),n.scoreText.setOrigin(.5),n.scoreText.alpha=0,n.scene.ui.add(n.scoreText),n.flashSpine=n.scene.add.spine(0,0,"flash","flash",!1),n.flashSpine.setScale(.25*n.scene.gameScale),n.add(n.flashSpine),n.flashSpine.visible=!1,n.rotateDirection=1,n.rotateSpeed=36,n.launchAngle=0,n.launchAngleSnap=360/34,n.score=0,n.targetScore=15,n.animation.SetState(Hn.State.Idle),n.UpdateAimArrowSprite(),n}return function SnowballPlayer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballPlayer_setPrototypeOf(e,t)}(SnowballPlayer,L),function SnowballPlayer_createClass(e,t,n){return t&&SnowballPlayer_defineProperties(e.prototype,t),n&&SnowballPlayer_defineProperties(e,n),e}(SnowballPlayer,[{key:"CreateInput",value:function CreateInput(){return new Fn(this.scene,this)}},{key:"CreateAI",value:function CreateAI(){return new En(this.scene,this)}},{key:"CreateAnimation",value:function CreateAnimation(){return new Hn(this.scene,this)}},{key:"update",value:function update(e,t){SnowballPlayer_get(SnowballPlayer_getPrototypeOf(SnowballPlayer.prototype),"update",this).call(this,e,t);for(var n=0;n<this.balls.length;n++)this.balls[n].update(e,t);if(!(this.scene.state>F.State.Game))switch(this.state){case SnowballPlayer.State.Idle:this.UpdateIdleState(e,t)}}},{key:"UpdateHumanControl",value:function UpdateHumanControl(e,t){SnowballPlayer_get(SnowballPlayer_getPrototypeOf(SnowballPlayer.prototype),"UpdateHumanControl",this).call(this,e,t),this.scene.state,F.State.Game}},{key:"UpdateAIControl",value:function UpdateAIControl(e,t){SnowballPlayer_get(SnowballPlayer_getPrototypeOf(SnowballPlayer.prototype),"UpdateAIControl",this).call(this,e,t),this.scene.state,F.State.Game}},{key:"CanRotate",value:function CanRotate(){return this.GetAvailableBall()}},{key:"CanShoot",value:function CanShoot(){return this.scene.state==F.State.Game&&this.CanRotate()}},{key:"Shoot",value:function Shoot(){if(this.CanShoot()){this.animation.SetState(Hn.State.Throw),this.shootCooldown=this.shootCooldownTime;var e=this.x,t=this.y-30*this.scene.gameScale;switch(this.GetAvailableBall().Spawn(e,t,this.GetSpawnAngle(),this.shootForce),this.playerNumber){case M.PlayerNumber.ONE:case M.PlayerNumber.TWO:}}}},{key:"GetSpawnAngle",value:function GetSpawnAngle(){return this.launchAngle-90}},{key:"OnSpineEvent",value:function OnSpineEvent(e,t){switch(t.data.name){case"shoot":var n=this.GetSpawnX(),r=this.GetSpawnY();switch(this.GetAvailableBall().Spawn(n,r,this.GetSpawnAngle(),this.shootForce),this.player.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","archery_player_one_fire");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","archery_player_two_fire")}}}},{key:"LaunchBall",value:function LaunchBall(){}},{key:"GetAvailableBall",value:function GetAvailableBall(){for(var e=0;e<this.balls.length;e++)if(this.balls[e].state==Ln.State.Inactive)return this.balls[e]}},{key:"SetState",value:function SetState(e){if(this.state!=e)switch(this.state=e,this.state){case SnowballPlayer.State.Idle:this.OnEnterIdleState();break;case SnowballPlayer.State.EndGame:this.OnEnterEndGameState()}}},{key:"OnEnterIdleState",value:function OnEnterIdleState(){}},{key:"OnEnterEndGameState",value:function OnEnterEndGameState(){}},{key:"UpdateIdleState",value:function UpdateIdleState(e,t){this.CanRotate()&&(this.aimAngle+=this.rotateSpeed*this.rotateDirection*t*.001,this.aimAngle>this.maxAngle?(this.aimAngle=this.maxAngle,this.rotateDirection*=-1):this.aimAngle<this.minAngle&&(this.aimAngle=this.minAngle,this.rotateDirection*=-1),this.UpdateAimArrowSprite())}},{key:"UpdateAimArrowSprite",value:function UpdateAimArrowSprite(){var e=this.aimAngle%360/360,t=Math.ceil(34*e);this.launchAngle=t*this.launchAngleSnap,this.aimArrowSprite.setFrame("rotator_animation_"+t+".png")}},{key:"PredictedPeopleToHit",value:function PredictedPeopleToHit(e){this.scene.debugDraw&&this.scene.debugCanvas.context.clearRect(0,0,this.scene.debugCanvas.width,this.scene.debugCanvas.height);for(var t=this.x,n=this.y,r=Phaser.Math.DegToRad(this.GetSpawnAngle()),o=Math.cos(r)*this.shootForce,i=Math.sin(r)*this.shootForce,a=0,s=0,l=Math.pow(16.6666,2),c=0,u=[],p=0;p<3e3;p+=16.6666){var h=a+o/50*l,y=s+(i+=50*this.scene.matter.world.engine.world.gravity.y*.001)/50*l;if(t+=a=h,n+=s=y,c%6==(i=o=0)){var f=this.scene.snowballPersonSpawner.TestCollision(t,n,e,p),d=-1!=f;d&&-1==u.indexOf(f)&&u.push(f),this.scene.debugDraw&&(this.scene.debugCanvas.context.beginPath(),this.scene.debugCanvas.context.fillStyle=d?"rgba(0, 255, 0, 1)":"rgba(255, 0, 0, 0.1)",this.scene.debugCanvas.context.arc(t,n,e,0,360,!1),this.scene.debugCanvas.context.fill(),this.scene.debugCanvas.context.closePath())}if(n>this.scene.scale.height)break;c++}return u.length}},{key:"AddScore",value:function AddScore(){switch(this.score++,this.playerNumber){case M.PlayerNumber.ONE:h.Instance.Play("sfx_minigame","player_one_score_point");break;case M.PlayerNumber.TWO:h.Instance.Play("sfx_minigame","player_two_score_point")}this.scoreText.setText(this.score),this.scoreTween&&this.scoreTween.stop(),this.scoreText.setScale(.5),this.scoreText.y=this.y+100*this.scene.gameScale,this.scoreText.alpha=0,this.scoreTween=this.scene.tweens.add({targets:this.scoreText,scaleX:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},scaleY:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},alpha:{value:1,duration:400,hold:200,ease:"Sine.easeInOut",yoyo:!0},y:{value:this.y+175*this.scene.gameScale,duration:1e3,ease:"Sine.easeInOut"}}),this.score>=this.targetScore&&this.scene.EndGame()}},{key:"OnGameEnterPostGameState",value:function OnGameEnterPostGameState(e){SnowballPlayer_get(SnowballPlayer_getPrototypeOf(SnowballPlayer.prototype),"OnGameEnterPostGameState",this).call(this,e),this.SetState(SnowballPlayer.State.EndGame);for(var t=0;t<this.balls.length;t++)this.balls[t].SetState(Ln.State.Inactive)}},{key:"OnMinigameWon",value:function OnMinigameWon(){this.animation.SetState(Hn.State.Win)}},{key:"OnMinigameLost",value:function OnMinigameLost(){this.animation.SetState(Hn.State.Lose)}},{key:"destroy",value:function destroy(){SnowballPlayer_get(SnowballPlayer_getPrototypeOf(SnowballPlayer.prototype),"destroy",this).call(this)}}]),SnowballPlayer}();function SnowballTutorialPopup_typeof(e){return(SnowballTutorialPopup_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballTutorialPopup_possibleConstructorReturn(e,t){return!t||"object"!==SnowballTutorialPopup_typeof(t)&&"function"!=typeof t?function SnowballTutorialPopup_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SnowballTutorialPopup_getPrototypeOf(e){return(SnowballTutorialPopup_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballTutorialPopup_setPrototypeOf(e,t){return(SnowballTutorialPopup_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function SnowballPlayer_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(Gn,"State",Object.freeze({Idle:0,EndGame:2}));var Nn=function(){function SnowballTutorialPopup(e){var t;!function SnowballTutorialPopup_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballTutorialPopup),(t=SnowballTutorialPopup_possibleConstructorReturn(this,SnowballTutorialPopup_getPrototypeOf(SnowballTutorialPopup).call(this,e))).panel.setTexture("snowball_minigame_atlas","how_to_snowball.png");for(var n=0;n<t.controlSpines.length;n++)t.scene.deviceManager.desktop?t.controlSpines[n].setAnimation(0,"all",!0):t.controlSpines[n].setAnimation(0,"tap",!0);return t}return function SnowballTutorialPopup_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballTutorialPopup_setPrototypeOf(e,t)}(SnowballTutorialPopup,R),SnowballTutorialPopup}();function SnowballMinigame_typeof(e){return(SnowballMinigame_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SnowballMinigame_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SnowballMinigame_possibleConstructorReturn(e,t){return!t||"object"!==SnowballMinigame_typeof(t)&&"function"!=typeof t?function SnowballMinigame_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function SnowballMinigame_get(e,t,n){return(SnowballMinigame_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function SnowballMinigame_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SnowballMinigame_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SnowballMinigame_getPrototypeOf(e){return(SnowballMinigame_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SnowballMinigame_setPrototypeOf(e,t){return(SnowballMinigame_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Un=function(){function SnowballMinigame(){return function SnowballMinigame_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SnowballMinigame),SnowballMinigame_possibleConstructorReturn(this,SnowballMinigame_getPrototypeOf(SnowballMinigame).call(this,"SnowballMinigame"))}return function SnowballMinigame_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SnowballMinigame_setPrototypeOf(e,t)}(SnowballMinigame,F),function SnowballMinigame_createClass(e,t,n){return t&&SnowballMinigame_defineProperties(e.prototype,t),n&&SnowballMinigame_defineProperties(e,n),e}(SnowballMinigame,[{key:"create",value:function create(){SnowballMinigame_get(SnowballMinigame_getPrototypeOf(SnowballMinigame.prototype),"create",this).call(this),h.Instance.AddLayer("sfx_minigame",{audioKeys:["turtles_player_one_fire","turtles_player_one_sucker","turtles_player_two_fire","turtles_player_two_sucker"]}),h.Instance.AddLayer("music_minigame",{audioKeys:["music_painting"]}),h.Instance.Play("music_minigame","music_painting")}},{key:"CreateMinigameUI",value:function CreateMinigameUI(){return new Dn(this)}},{key:"CreateMinigameTutorial",value:function CreateMinigameTutorial(){return new Nn(this)}},{key:"CreateWorld",value:function CreateWorld(){SnowballMinigame_get(SnowballMinigame_getPrototypeOf(SnowballMinigame.prototype),"CreateWorld",this).call(this),this.matter.world.setBounds(.5*this.scale.width-.75*this.viewport.width,.5*this.scale.height-.5*this.viewport.height,1.5*this.viewport.width,1*this.viewport.height,32,!0,!0,!1,!0),this.matter.world.engine.world.gravity.y=0,this.background=this.add.sprite(.5*this.scale.width,.5*this.scale.height,"snowball_background"),this.world.add(this.background),this.ballCollisionCategory=this.matter.world.nextCategory();var e=this.getAvailableCharacters();this.snowballPersonSpawner=new jn(this,e),this.trailContainer=this.add.container(),this.ballContainer=this.add.container();for(var t=0;t<2;t++){var n=new Gn(this,{data:this.sys.settings.data.gameData.players[t],playerNumber:t,playerController:t<this.sys.settings.data.gameData.playerCount?M.Controller.HUMAN:M.Controller.AI});this.players.push(n),this.world.add(this.players[t])}this.world.add(this.trailContainer),this.world.add(this.ballContainer),this.world.add(this.snowballPersonSpawner),this.rainParticles=this.add.particles("snowball_minigame_atlas","snowflake_1.png"),this.world.add(this.rainParticles);var r=new Phaser.Math.Vector2(this.scale.width,100*this.gameScale),o=new Phaser.Geom.Rectangle(0,-100*this.gameScale,r.x,r.y),i=new Phaser.Geom.Rectangle(0,o.y,this.scale.width,this.scale.height+r.y);this.rainParticlesEmitter=this.rainParticles.createEmitter({x:0,y:0,lifespan:1e5,emitZone:{source:o},frequency:250,alpha:{start:1,end:1},scale:{min:.1,max:1},speedX:{min:-50*this.gameScale,max:50*this.gameScale},speedY:{min:50*this.gameScale,max:150*this.gameScale},deathZone:{type:"onExit",source:i},rotate:{min:0,max:360},frame:["snowflake_1.png","snowflake_2.png","snowflake_3.png","snowflake_4.png","snowflake_5.png"]}),this.rainParticlesEmitter.onParticleEmit(function(e,t){e.sineTime=Math.random()},this),this.snowballParticles=this.add.particles("snowball_minigame_atlas","snowball_particle.png"),this.world.add(this.snowballParticles),this.snowballParticleEmitter=this.snowballParticles.createEmitter({on:!1,x:10*this.gameScale,y:-5*this.gameScale,alpha:{start:1,end:0,ease:"Sine.easeOut"},scale:{start:1,end:.3,ease:"Sine.easeOut"},rotate:{min:0,max:360},lifespan:1e3,speedX:{min:-100*this.gameScale,max:100*this.gameScale},speedY:{min:-200*this.gameScale,max:0*this.gameScale}}),this.snowballParticleEmitter.reserve(50),this.debugDraw=!1,this.debugDraw&&(this.debugCanvas=this.textures.createCanvas("test_canvas",this.scale.width,this.scale.height),this.debugImage=this.add.image(.5*this.scale.width,.5*this.scale.height,"test_canvas"),this.world.add(this.debugImage))}},{key:"getAvailableCharacters",value:function getAvailableCharacters(){for(var e=[],t=["darwin","gumball","tobias","anais","carrie","carmen","teri","alan","brown","penny"],n=0;n<t.length;n++){for(var r=t[n],o=!1,i=0;i<2;i++){r===this.sys.settings.data.gameData.players[i].characterData.id&&(o=!0)}o||e.push(r)}return e}},{key:"update",value:function update(e,n){SnowballMinigame_get(SnowballMinigame_getPrototypeOf(SnowballMinigame.prototype),"update",this).call(this,e,n);for(var t=0;t<this.players.length;t++)this.players[t].update(e,n);this.rainParticlesEmitter.forEachAlive(function(e,t){e.sineTime+=n*e.velocityY*15e-6,e.velocityX=100*Math.sin(e.sineTime)*this.gameScale},this),this.snowballPersonSpawner.update(e,n)}},{key:"OnEnterPostGameState",value:function OnEnterPostGameState(){SnowballMinigame_get(SnowballMinigame_getPrototypeOf(SnowballMinigame.prototype),"OnEnterPostGameState",this).call(this),h.Instance.Play("sfx_minigame","minigame_end")}},{key:"OnSnowballHitPerson",value:function OnSnowballHitPerson(e){this.snowballParticleEmitter.setPosition(e.x,e.y),this.snowballParticleEmitter.explode(50)}},{key:"GetWinningPlayer",value:function GetWinningPlayer(){for(var e=this.players[0],t=0,n=0;n<this.players.length;n++)this.players[n].score>t&&(e=this.players[n],t=this.players[n].score);return e}}]),SnowballMinigame}();function BoardScene_typeof(e){return(BoardScene_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BoardScene_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function BoardScene_possibleConstructorReturn(e,t){return!t||"object"!==BoardScene_typeof(t)&&"function"!=typeof t?function BoardScene_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function BoardScene_get(e,t,n){return(BoardScene_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function BoardScene_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BoardScene_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BoardScene_getPrototypeOf(e){return(BoardScene_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BoardScene_setPrototypeOf(e,t){return(BoardScene_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function BoardScene_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var zn=function(){function BoardScene(){var e;if(function BoardScene_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BoardScene),e=BoardScene_possibleConstructorReturn(this,BoardScene_getPrototypeOf(BoardScene).call(this,"BoardScene")),-1==BoardScene.MinigameIndex){I.ShuffleArray(BoardScene.Minigames);for(var t=BoardScene.MinigameIndex=0;t<BoardScene.Minigames.length;t++)if(BoardScene.Minigames[t].scene==Un){var n=BoardScene.Minigames.splice(t,1)[0];BoardScene.Minigames.unshift(n);break}console.log(BoardScene.Minigames)}return e}return function BoardScene_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BoardScene_setPrototypeOf(e,t)}(BoardScene,C),function BoardScene_createClass(e,t,n){return t&&BoardScene_defineProperties(e.prototype,t),n&&BoardScene_defineProperties(e,n),e}(BoardScene,[{key:"create",value:function create(){BoardScene_get(BoardScene_getPrototypeOf(BoardScene.prototype),"create",this).call(this),this.CreateDOM(),this.cameras.main.ignore(this.world),this.dice=new Dt(this,this.ui);var e=this.game.cache.json.get("board");this.board=new Mt(this,this.world,{x:.5*this.scale.width,y:.5*this.scale.height,data:e,dice:this.dice}),this.board.on("showRollUI",this.ShowRollUI,this),this.board.on("showBranchUI",this.ShowBranchUI,this),this.board.on("hideRollUI",this.HideRollUI,this),this.board.on("hideBranchUI",this.HideBranchUI,this),this.board.on("turnStart",this.OnTurnStart,this),this.board.on("turnFinished",this.OnTurnFinished,this),this.board.on("roundFinished",this.RoundFinished,this),this.board.on("chance",this.ShowChancePopup,this),this.board.on("showRoundNotifier",this.ShowRoundNotifier,this),this.board.on("showPlayerTurnNotifier",this.ShowPlayerTurnNotifier,this),this.board.on("showTrophyPopup",this.ShowTrophyPopup,this),this.rainParticles=this.add.particles("board_atlas","snowflake_1.png"),this.ui.add(this.rainParticles);var t=new Phaser.Math.Vector2(this.scale.width,100*this.gameScale),n=new Phaser.Geom.Rectangle(0,-100*this.gameScale,t.x,t.y),r=new Phaser.Geom.Rectangle(0,n.y,this.scale.width,this.scale.height+t.y);this.rainParticlesEmitter=this.rainParticles.createEmitter({x:0,y:0,lifespan:1e5,emitZone:{source:n},frequency:250,alpha:{start:1,end:1},scale:{min:.1,max:1},speedX:{min:-50*this.gameScale,max:50*this.gameScale},speedY:{min:50*this.gameScale,max:150*this.gameScale},deathZone:{type:"onExit",source:r},rotate:{min:0,max:360},frame:["snowflake_1.png","snowflake_2.png","snowflake_3.png","snowflake_4.png","snowflake_5.png"]}),this.rainParticlesEmitter.onParticleEmit(function(e,t){e.sineTime=Math.random()},this),this.boardTrophyIndicator=new An(this,this.ui),this.boardPlayerUI=new Ht(this,this.ui,this.board.players),this.turnNotifier=new Lt(this,this.ui),this.turnNotifier.on("roundNotifierComplete",this.OnRoundNotifierComplete,this),this.turnNotifier.on("playerTurnNotifierComplete",this.OnPlayerTurnNotifierComplete,this),this.minigamePopup=new Et(this,this.ui,{x:.5*this.scale.width,y:.5*this.scale.height,minigames:BoardScene.Minigames,minigameIndex:BoardScene.MinigameIndex}),this.minigamePopup.on("spin",this.OnMinigamePopupSpin,this),this.minigamePopup.on("minigameChosen",this.OnMinigameChosen,this),this.chancePopup=new At(this,this.ui),this.chancePopup.on("execute",this.ExecuteChance,this),this.boardTrophyPopup=new Bn(this,this.ui),this.boardTrophyPopup.on("attemptPurchase",this.OnBoardTrophyAttemptPurchase,this),h.Instance.AddLayer("sfx_boardgame",{audioKeys:["board_ambience","screen_in_board_player","screen_out_board_player","screen_in_board_turns_left","screen_out_board_turns_left","board_which_direction","board_pick_direction","board_freeze","board_freeze_over","board_roll_die","board_roll_six","board_player_footstep_01","board_player_footstep_02","board_player_footstep_03","board_player_footstep_04","board_player_footstep_05","board_player_footstep_06","board_teleport_start","board_teleport_end","board_tile","board_tile_special","trophy_collect","trophy_spawn","wheel_spin","wheel_spin_result","wheel_spin_click_01","wheel_spin_click_02","wheel_spin_click_03","wheel_spin_click_04","wheel_spin_click_05","wheel_spin_click_06","wheel_spin_click_07"]}),h.Instance.AddLayer("music_boardgame",{audioKeys:["music_boardgame"]}),this.roundFinished=!1,this.timer=0,this.roundEndDuration=1,this.currentRound=1,this.totalRounds=BoardScene.totalRounds,this.LoadData(),h.Instance.Play("music_boardgame","music_boardgame"),h.Instance.Play("sfx_boardgame","board_ambience",{loop:!0,volume:.1}),this.fadeAmbienceInTimer=8.5}},{key:"update",value:function update(e,n){BoardScene_get(BoardScene_getPrototypeOf(BoardScene.prototype),"update",this).call(this,e,n);var t=.001*n;this.dice.update(e,n),this.board.update(e,n),this.boardTrophyIndicator.update(e,n),this.minigamePopup.update(e,n),this.chancePopup.update(e,n),this.boardTrophyPopup.update(e,n),this.rainParticlesEmitter.forEachAlive(function(e,t){e.sineTime+=n*e.velocityY*15e-6,e.velocityX=100*Math.sin(e.sineTime)*this.gameScale},this),0<this.fadeAmbienceInTimer&&(this.fadeAmbienceInTimer-=t,this.fadeAmbienceInTimer<=0&&h.Instance.FadeVolume("sfx_boardgame","board_ambience",this,1,1e3)),this.roundFinished&&(this.timer+=t,this.timer>=this.roundEndDuration&&(this.roundFinished=!1,this.StartMinigame()))}},{key:"CreateDOM",value:function CreateDOM(){BoardScene_get(BoardScene_getPrototypeOf(BoardScene.prototype),"CreateDOM",this).call(this),this.rollButton=new g(this,this.dom,{frames:["button_next_unselected.png"],x:.5*this.scale.width,y:this.scale.height,buttonOrigin:new Phaser.Math.Vector2(.5,1),spriteWidth:385*this.gameScale,spriteHeight:206*this.gameScale,buttonWidth:385*this.gameScale,buttonHeight:206*this.gameScale,atlas:"ui_atlas",id:"domui_MENU_roll",title:"Roll",callback:this.OnRollButtonPressed,context:this,onDown:this.OnRollButtonDown,onDownContext:this}),this.rollButton.button.alpha=1e-7,this.rollButton.Hide(),this.pathButtons=[],this.pathOneButton=new g(this,this.dom,{x:.5*this.scale.width+("tablet"!=this.game.buttonSize?-64:-88),y:.5*this.scale.height,frames:["board_direction_arrow_right.png"],atlas:"board_ui_atlas",domClass:null,id:"domui_path_1",title:"Left",callback:this.OnBranchButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.pathOneButton.SetHoverEffect({scaleX:{value:.925,duration:150,ease:"Sine.easeInOut"},scaleY:{value:.925,duration:150,ease:"Sine.easeInOut"}}),this.pathOneButton.Hide(),this.pathButtons.push(this.pathOneButton),this.pathTwoButton=new g(this,this.dom,{x:.5*this.scale.width,y:.5*this.scale.height,frames:["board_direction_arrow_right.png"],atlas:"board_ui_atlas",domClass:null,id:"domui_path_2",title:"Right",callback:this.OnBranchButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.pathTwoButton.SetHoverEffect({scaleX:{value:.9,duration:150,ease:"Sine.easeInOut"},scaleY:{value:.9,duration:150,ease:"Sine.easeInOut"}}),this.pathTwoButton.Hide(),this.pathButtons.push(this.pathTwoButton)}},{key:"ShowRollUI",value:function ShowRollUI(){this.rollButton.Enable(),this.rollButton.Show()}},{key:"ShowBranchUI",value:function ShowBranchUI(e){var t=e.tile;h.Instance.Play("sfx_boardgame","board_which_direction");for(var n=0;n<this.pathButtons.length;n++)this.pathButtons[n].x=this.board.x+this.board.content.x+Phaser.Math.Linear(t.x,t.paths[n].x,.65)-(this.board.camera.camera.midPoint.x-this.cameras.main.midPoint.x),this.pathButtons[n].y=this.board.y+this.board.content.y+Phaser.Math.Linear(t.y,t.paths[n].y,.65)-(this.board.camera.camera.midPoint.y-this.cameras.main.midPoint.y),Math.abs(t.paths[n].x-t.x)>Math.abs(t.paths[n].y-t.y)?t.paths[n].x>t.x?this.pathButtons[n].SetFrames(["board_direction_arrow_right.png"]):this.pathButtons[n].SetFrames(["board_direction_arrow_left.png"]):t.paths[n].y>t.y?this.pathButtons[n].SetFrames(["board_direction_arrow_down.png"]):this.pathButtons[n].SetFrames(["board_direction_arrow_up.png"]),this.pathButtons[n].setScale(1),this.pathButtons[n].Enable(),this.pathButtons[n].Show()}},{key:"ShowRoundNotifier",value:function ShowRoundNotifier(){this.turnNotifier.ShowRounds(this.currentRound,this.totalRounds)}},{key:"ShowTrophyPopup",value:function ShowTrophyPopup(e,t){this.boardTrophyPopup.Show(e,t)}},{key:"ShowPlayerTurnNotifier",value:function ShowPlayerTurnNotifier(e){this.turnNotifier.ShowPlayerTurn(e)}},{key:"OnTurnStart",value:function OnTurnStart(e){this.boardPlayerUI.OnTurnStart(e)}},{key:"OnTurnFinished",value:function OnTurnFinished(e){this.boardPlayerUI.OnTurnFinished(e)}},{key:"OnRoundNotifierComplete",value:function OnRoundNotifierComplete(){this.board.OnRoundNotifierComplete()}},{key:"OnPlayerTurnNotifierComplete",value:function OnPlayerTurnNotifierComplete(){this.board.OnPlayerTurnNotifierComplete()}},{key:"OnBoardTrophyAttemptPurchase",value:function OnBoardTrophyAttemptPurchase(){this.board.AttemptTrophyPurchase()}},{key:"HideRollUI",value:function HideRollUI(){this.rollButton.Disable(),this.rollButton.Hide()}},{key:"HideBranchUI",value:function HideBranchUI(){this.pathOneButton.Disable(),this.pathOneButton.Hide(),this.pathTwoButton.Disable(),this.pathTwoButton.Hide()}},{key:"RoundFinished",value:function RoundFinished(){this.currentRound++,this.SaveData(),this.currentRound<=this.totalRounds?this.minigamePopup.Show():a.Instance.StartTransitionScene(E,this.LoadResultsScene,this)}},{key:"LoadResultsScene",value:function LoadResultsScene(){this.CachePlayerData(),a.Instance.StartLoadingScene(O,Vt,this.sys.settings.data)}},{key:"ShowChancePopup",value:function ShowChancePopup(){this.chancePopup.Show()}},{key:"ExecuteChance",value:function ExecuteChance(e){this.board.ExecuteChance(e)}},{key:"StartMinigame",value:function StartMinigame(){a.Instance.StartTransitionScene(E,this.LoadMinigame,this)}},{key:"LoadMinigame",value:function LoadMinigame(){var e=BoardScene.Minigames[BoardScene.MinigameIndex].scene;BoardScene.MinigameIndex=(BoardScene.MinigameIndex+1)%BoardScene.Minigames.length,this.CachePlayerData(),this.sys.settings.data.gameData.parentScene=BoardScene,this.sys.settings.data.additionalAssetBundles=["Minigame"],a.Instance.StartLoadingScene(O,e,this.sys.settings.data)}},{key:"CachePlayerData",value:function CachePlayerData(){for(var e=0;e<this.board.players.length;e++)this.sys.settings.data.gameData.players[e].points=this.board.players[e].points,this.sys.settings.data.gameData.players[e].trophies=this.board.players[e].trophies,this.sys.settings.data.gameData.players[e].minigamesWon=this.board.players[e].minigamesWon,this.sys.settings.data.gameData.players[e].chances=this.board.players[e].chances,this.sys.settings.data.gameData.players[e].steps=this.board.players[e].steps}},{key:"OnRollButtonPressed",value:function OnRollButtonPressed(){this.board.GetCurrentPlayer().OnRollInput()}},{key:"OnRollButtonDown",value:function OnRollButtonDown(){this.board.OnRollButtonDown()}},{key:"OnBranchButtonPressed",value:function OnBranchButtonPressed(e){var t=e==this.pathOneButton.button?0:1;this.board.GetCurrentPlayer().OnBranchInput(t),h.Instance.Play("sfx_boardgame","board_pick_direction")}},{key:"OnMinigamePopupSpin",value:function OnMinigamePopupSpin(){h.Instance.FadeVolume("sfx_boardgame","board_ambience",this,0,250)}},{key:"OnMinigameChosen",value:function OnMinigameChosen(){this.roundFinished=!0,this.timer=0}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){a.Instance.StartLoadingScene(O,er)}},{key:"OnSleep",value:function OnSleep(){BoardScene_get(BoardScene_getPrototypeOf(BoardScene.prototype),"OnSleep",this).call(this),h.Instance.PauseLayer("sfx_boardgame"),h.Instance.PauseLayer("music_boardgame")}},{key:"OnWake",value:function OnWake(){BoardScene_get(BoardScene_getPrototypeOf(BoardScene.prototype),"OnWake",this).call(this),h.Instance.ResumeLayer("sfx_boardgame"),h.Instance.ResumeLayer("music_boardgame")}},{key:"LoadData",value:function LoadData(){var e=p.Instance.GetData("BoardScene");e&&(this.currentRound=e.currentRound,this.totalRounds=e.totalRounds),this.board.LoadData()}},{key:"SaveData",value:function SaveData(){p.Instance.SaveData("BoardScene",{currentRound:this.currentRound,totalRounds:this.totalRounds}),this.board.SaveData()}},{key:"Destroy",value:function Destroy(){BoardScene_get(BoardScene_getPrototypeOf(BoardScene.prototype),"Destroy",this).call(this),h.Instance.DestroyLayer("sfx_boardgame"),h.Instance.DestroyLayer("music_boardgame")}}]),BoardScene}();function DebugMenu_typeof(e){return(DebugMenu_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DebugMenu_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DebugMenu_possibleConstructorReturn(e,t){return!t||"object"!==DebugMenu_typeof(t)&&"function"!=typeof t?function DebugMenu_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function DebugMenu_get(e,t,n){return(DebugMenu_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DebugMenu_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DebugMenu_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DebugMenu_getPrototypeOf(e){return(DebugMenu_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DebugMenu_setPrototypeOf(e,t){return(DebugMenu_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}BoardScene_defineProperty(zn,"totalRounds",8),BoardScene_defineProperty(zn,"Minigames",[{scene:vt,wheelIcon:"wheel_icon_trapdoor.png"},{scene:He,wheelIcon:"wheel_icon_catch.png"},{scene:Ze,wheelIcon:"wheel_icon_dodge.png"},{scene:pt,wheelIcon:"wheel_icon_burger.png"},{scene:J,wheelIcon:"wheel_icon_volleyball.png"},{scene:le,wheelIcon:"wheel_icon_hurdles.png"},{scene:_e,wheelIcon:"wheel_icon_painting.png"},{scene:ke,wheelIcon:"wheel_icon_sumo.png"},{scene:Qt,wheelIcon:"wheel_icon_turtles.png"},{scene:cn,wheelIcon:"wheel_icon_herding.png"},{scene:Pn,wheelIcon:"wheel_icon_archery.png"},{scene:xn,wheelIcon:"wheel_icon_flappy.png"},{scene:Un,wheelIcon:"wheel_icon_snowball.png"}]),BoardScene_defineProperty(zn,"MinigameIndex",-1);var Vn=function(){function DebugMenu(){return function DebugMenu_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DebugMenu),DebugMenu_possibleConstructorReturn(this,DebugMenu_getPrototypeOf(DebugMenu).call(this,"DebugMenu"))}return function DebugMenu_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DebugMenu_setPrototypeOf(e,t)}(DebugMenu,y),function DebugMenu_createClass(e,t,n){return t&&DebugMenu_defineProperties(e.prototype,t),n&&DebugMenu_defineProperties(e,n),e}(DebugMenu,[{key:"create",value:function create(){DebugMenu_get(DebugMenu_getPrototypeOf(DebugMenu.prototype),"create",this).call(this),this.sceneOptions=[],this.playerOptions=[0,1,2],this.difficultyOptions=["EASY","MEDIUM","HARD"],this.characterOptions=[],this.clearDataOptions=["false","true"],this.trophyOptions=[0,1,2,3],this.pointsOptions=[0,10,20,30,40,50,60],this.charactersData=this.cache.json.get("characters_data"),this.minigamesData=this.cache.json.get("minigames_data");for(var e=0;e<this.minigamesData.length;e++){var t={title:this.minigamesData[e].id,scene:this.minigamesData[e].scene};this.sceneOptions.push(t)}this.sceneOptions.push({title:"Board",scene:"BoardScene"}),this.sceneOptions.push({title:"Results",scene:"ResultsScene"});for(e=0;e<this.charactersData.length;e++)this.characterOptions.push(this.charactersData[e].id);this.currentSceneOptionIndex=0,this.currentPlayerOptionIndex=2,this.currentDifficultyOptionIndex=0,this.currentPlayerOneOptionIndex=0,this.currentPlayerTwoOptionIndex=1,this.currentPlayerOneTrophiesOptionIndex=0,this.currentPlayerTwoTrophiesOptionIndex=0,this.currentPlayerOnePointsOptionIndex=0,this.currentPlayerTwoPointsOptionIndex=0,this.currentClearDataOptionIndex=0,this.LoadData(),this.sceneText=this.add.text(.5*this.scale.width,.1*this.scale.height,"Scene",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.sceneText.setOrigin(.5),this.selectedSceneText=this.add.text(.5*this.scale.width,.15*this.scale.height,this.sceneOptions[this.currentSceneOptionIndex].title,{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedSceneText.setOrigin(.5),this.playersText=this.add.text(.5*this.scale.width,.2*this.scale.height,"Human Players",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.playersText.setOrigin(.5),this.selectedPlayersText=this.add.text(.5*this.scale.width,.25*this.scale.height,this.playerOptions[this.currentPlayerOptionIndex],{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedPlayersText.setOrigin(.5),this.difficultyText=this.add.text(.5*this.scale.width,.3*this.scale.height,"Difficulty",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.difficultyText.setOrigin(.5),this.selectedDifficultyText=this.add.text(.5*this.scale.width,.35*this.scale.height,this.difficultyOptions[this.currentDifficultyOptionIndex],{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedDifficultyText.setOrigin(.5),this.playerOneText=this.add.text(.33*this.scale.width,.6*this.scale.height,"Player 1",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.playerOneText.setOrigin(.5),this.selectedPlayerOneText=this.add.text(this.playerOneText.x,this.playerOneText.y+35*this.gameScale,this.characterOptions[this.currentPlayerOneOptionIndex],{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedPlayerOneText.setOrigin(.5),this.playerTwoText=this.add.text(.66*this.scale.width,.6*this.scale.height,"Player 2",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.playerTwoText.setOrigin(.5),this.selectedPlayerTwoText=this.add.text(this.playerTwoText.x,this.playerTwoText.y+35*this.gameScale,this.characterOptions[this.currentPlayerTwoOptionIndex],{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedPlayerTwoText.setOrigin(.5),this.playerOneTrophiesText=this.add.text(.33*this.scale.width,.7*this.scale.height,"Trophies",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.playerOneTrophiesText.setOrigin(.5),this.selectedPlayerOneTrophiesText=this.add.text(this.playerOneTrophiesText.x,this.playerOneTrophiesText.y+35*this.gameScale,this.trophyOptions[this.currentPlayerOneTrophiesOptionIndex],{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedPlayerOneTrophiesText.setOrigin(.5),this.playerTwoTrophiesText=this.add.text(.66*this.scale.width,.7*this.scale.height,"Trophies",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.playerTwoTrophiesText.setOrigin(.5),this.selectedPlayerTwoTrophiesText=this.add.text(this.playerTwoTrophiesText.x,this.playerTwoTrophiesText.y+35*this.gameScale,this.trophyOptions[this.currentPlayerTwoTrophiesOptionIndex],{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedPlayerTwoTrophiesText.setOrigin(.5),this.playerOnePointsText=this.add.text(.33*this.scale.width,.8*this.scale.height,"Points",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.playerOnePointsText.setOrigin(.5),this.selectedPlayerOnePointsText=this.add.text(this.playerOnePointsText.x,this.playerOnePointsText.y+35*this.gameScale,this.pointsOptions[this.currentPlayerOnePointsOptionIndex],{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedPlayerOnePointsText.setOrigin(.5),this.playerTwoPointsText=this.add.text(.66*this.scale.width,.8*this.scale.height,"Points",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.playerTwoPointsText.setOrigin(.5),this.selectedPlayerTwoPointsText=this.add.text(this.playerTwoPointsText.x,this.playerTwoPointsText.y+35*this.gameScale,this.pointsOptions[this.currentPlayerTwoPointsOptionIndex],{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedPlayerTwoPointsText.setOrigin(.5),this.clearDataText=this.add.text(.5*this.scale.width,.4*this.scale.height,"Clear Board Data?",{fontSize:32*this.gameScale+"px",fill:"#FF00FF"}),this.clearDataText.setOrigin(.5),this.selectedClearDataText=this.add.text(this.clearDataText.x,this.clearDataText.y+35*this.gameScale,this.clearDataOptions[this.currentClearDataOptionIndex],{fontSize:32*this.gameScale+"px",fill:"#FFFFFF"}),this.selectedClearDataText.setOrigin(.5),this.CreateDom()}},{key:"CreateDom",value:function CreateDom(){this.topLeftPanel=new d(this,this,{domClass:"dom_panel top left"}),this.backButton=new g(this,this.topLeftPanel,{frames:["button_back_unselected.png","button_back_selected.png"],atlas:"ui_atlas",id:"domui_MENU_pause",title:"Back",callback:this.OnBackButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.backButton.Enable(),this.previousSceneButton=new g(this,this,{x:this.selectedSceneText.x-200*this.gameScale,y:this.selectedSceneText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousSceneButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousSceneButton.Enable(),this.nextSceneButton=new g(this,this,{x:this.selectedSceneText.x+200*this.gameScale,y:this.selectedSceneText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextSceneButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextSceneButton.Enable(),this.nextPlayersButton=new g(this,this,{x:this.selectedPlayersText.x+200*this.gameScale,y:this.selectedPlayersText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextPlayersButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextPlayersButton.Enable(),this.previousPlayersButton=new g(this,this,{x:this.selectedPlayersText.x-200*this.gameScale,y:this.selectedPlayersText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousPlayersButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousPlayersButton.Enable(),this.nextDifficultyButton=new g(this,this,{x:this.selectedDifficultyText.x+200*this.gameScale,y:this.selectedDifficultyText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextDifficultyButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextDifficultyButton.Enable(),this.previousDifficultyButton=new g(this,this,{x:this.selectedDifficultyText.x-200*this.gameScale,y:this.selectedDifficultyText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousDifficultyButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousDifficultyButton.Enable(),this.nextClearDataButton=new g(this,this,{x:this.selectedClearDataText.x+200*this.gameScale,y:this.selectedClearDataText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextClearDataButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextClearDataButton.Enable(),this.previousClearDataButton=new g(this,this,{x:this.selectedClearDataText.x-200*this.gameScale,y:this.selectedClearDataText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousClearDataButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousClearDataButton.Enable(),this.nextPlayerOneButton=new g(this,this,{x:this.selectedPlayerOneText.x+125*this.gameScale,y:this.selectedPlayerOneText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextPlayerOneButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextPlayerOneButton.Enable(),this.previousPlayerOneButton=new g(this,this,{x:this.selectedPlayerOneText.x-125*this.gameScale,y:this.selectedPlayerOneText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousPlayerOneButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousPlayerOneButton.Enable(),this.nextPlayerTwoButton=new g(this,this,{x:this.selectedPlayerTwoText.x+125*this.gameScale,y:this.selectedPlayerTwoText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextPlayerTwoButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextPlayerTwoButton.Enable(),this.previousPlayerTwoButton=new g(this,this,{x:this.selectedPlayerTwoText.x-125*this.gameScale,y:this.selectedPlayerTwoText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousPlayerTwoButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousPlayerTwoButton.Enable(),this.nextPlayerOneTrophiesButton=new g(this,this,{x:this.selectedPlayerOneTrophiesText.x+125*this.gameScale,y:this.selectedPlayerOneTrophiesText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextPlayerOneTrophiesButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextPlayerOneTrophiesButton.Enable(),this.previousPlayerOneTrophiesButton=new g(this,this,{x:this.selectedPlayerOneTrophiesText.x-125*this.gameScale,y:this.selectedPlayerOneTrophiesText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousPlayerOneTrophiesButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousPlayerOneTrophiesButton.Enable(),this.nextPlayerTwoTrophiesButton=new g(this,this,{x:this.selectedPlayerTwoTrophiesText.x+125*this.gameScale,y:this.selectedPlayerTwoTrophiesText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextPlayerTwoTrophiesButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextPlayerTwoTrophiesButton.Enable(),this.previousPlayerTwoTrophiesButton=new g(this,this,{x:this.selectedPlayerTwoTrophiesText.x-125*this.gameScale,y:this.selectedPlayerTwoTrophiesText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousPlayerTwoTrophiesButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousPlayerTwoTrophiesButton.Enable(),this.nextPlayerOnePointsButton=new g(this,this,{x:this.selectedPlayerOnePointsText.x+125*this.gameScale,y:this.selectedPlayerOnePointsText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextPlayerOnePointsButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextPlayerOnePointsButton.Enable(),this.previousPlayerOnePointsButton=new g(this,this,{x:this.selectedPlayerOnePointsText.x-125*this.gameScale,y:this.selectedPlayerOnePointsText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousPlayerOnePointsButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousPlayerOnePointsButton.Enable(),this.nextPlayerTwoPointsButton=new g(this,this,{x:this.selectedPlayerTwoPointsText.x+125*this.gameScale,y:this.selectedPlayerTwoPointsText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:this.OnNextPlayerTwoPointsButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.nextPlayerTwoPointsButton.Enable(),this.previousPlayerTwoPointsButton=new g(this,this,{x:this.selectedPlayerTwoPointsText.x-125*this.gameScale,y:this.selectedPlayerTwoPointsText.y,spriteWidth:70*this.gameScale,spriteHeight:70*this.gameScale,buttonWidth:70*this.gameScale,buttonHeight:70*this.gameScale,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:this.OnPreviousPlayerTwoPointsButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.previousPlayerTwoPointsButton.Enable(),this.playButton=new g(this,this,{x:.5*this.scale.width,y:.85*this.scale.height,frames:["button_play_unselected.png","button_play_selected.png"],atlas:"ui_atlas",id:"domui_MENU_play",domClass:"dom_button play",title:"Play",callback:this.OnPlayButtonPressed,context:this,clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),this.playButton.Enable()}},{key:"update",value:function update(e,t){DebugMenu_get(DebugMenu_getPrototypeOf(DebugMenu.prototype),"update",this).call(this,e,t)}},{key:"render",value:function render(){DebugMenu_get(DebugMenu_getPrototypeOf(DebugMenu.prototype),"render",this).call(this,time,delta)}},{key:"OnPreviousSceneButtonPressed",value:function OnPreviousSceneButtonPressed(){this.ChangeSceneOption(-1)}},{key:"OnNextSceneButtonPressed",value:function OnNextSceneButtonPressed(){this.ChangeSceneOption(1)}},{key:"OnPreviousPlayersButtonPressed",value:function OnPreviousPlayersButtonPressed(){this.ChangePlayerOption(-1)}},{key:"OnNextPlayersButtonPressed",value:function OnNextPlayersButtonPressed(){this.ChangePlayerOption(1)}},{key:"OnPreviousDifficultyButtonPressed",value:function OnPreviousDifficultyButtonPressed(){this.ChangeDifficultyOption(-1)}},{key:"OnNextDifficultyButtonPressed",value:function OnNextDifficultyButtonPressed(){this.ChangeDifficultyOption(1)}},{key:"OnPreviousPlayerOneButtonPressed",value:function OnPreviousPlayerOneButtonPressed(){this.ChangePlayerOneOption(-1)}},{key:"OnNextPlayerOneButtonPressed",value:function OnNextPlayerOneButtonPressed(){this.ChangePlayerOneOption(1)}},{key:"OnPreviousPlayerTwoButtonPressed",value:function OnPreviousPlayerTwoButtonPressed(){this.ChangePlayerTwoOption(-1)}},{key:"OnNextPlayerTwoButtonPressed",value:function OnNextPlayerTwoButtonPressed(){this.ChangePlayerTwoOption(1)}},{key:"OnPreviousPlayerOneTrophiesButtonPressed",value:function OnPreviousPlayerOneTrophiesButtonPressed(){this.ChangePlayerOneTrophiesOption(-1)}},{key:"OnNextPlayerOneTrophiesButtonPressed",value:function OnNextPlayerOneTrophiesButtonPressed(){this.ChangePlayerOneTrophiesOption(1)}},{key:"OnPreviousPlayerTwoTrophiesButtonPressed",value:function OnPreviousPlayerTwoTrophiesButtonPressed(){this.ChangePlayerTwoTrophiesOption(-1)}},{key:"OnNextPlayerTwoTrophiesButtonPressed",value:function OnNextPlayerTwoTrophiesButtonPressed(){this.ChangePlayerTwoTrophiesOption(1)}},{key:"OnPreviousPlayerOnePointsButtonPressed",value:function OnPreviousPlayerOnePointsButtonPressed(){this.ChangePlayerOnePointsOption(-1)}},{key:"OnNextPlayerOnePointsButtonPressed",value:function OnNextPlayerOnePointsButtonPressed(){this.ChangePlayerOnePointsOption(1)}},{key:"OnPreviousPlayerTwoPointsButtonPressed",value:function OnPreviousPlayerTwoPointsButtonPressed(){this.ChangePlayerTwoPointsOption(-1)}},{key:"OnNextPlayerTwoPointsButtonPressed",value:function OnNextPlayerTwoPointsButtonPressed(){this.ChangePlayerTwoPointsOption(1)}},{key:"OnPreviousClearDataButtonPressed",value:function OnPreviousClearDataButtonPressed(){this.ChangeClearDataOption(-1)}},{key:"OnNextClearDataButtonPressed",value:function OnNextClearDataButtonPressed(){this.ChangeClearDataOption(1)}},{key:"ChangeSceneOption",value:function ChangeSceneOption(e){this.currentSceneOptionIndex+=e,this.currentSceneOptionIndex>this.sceneOptions.length-1?this.currentSceneOptionIndex=0:this.currentSceneOptionIndex<0&&(this.currentSceneOptionIndex=this.sceneOptions.length-1),this.selectedSceneText.setText(this.sceneOptions[this.currentSceneOptionIndex].title)}},{key:"ChangePlayerOneOption",value:function ChangePlayerOneOption(e){this.currentPlayerOneOptionIndex+=e,this.currentPlayerOneOptionIndex>this.characterOptions.length-1?this.currentPlayerOneOptionIndex=0:this.currentPlayerOneOptionIndex<0&&(this.currentPlayerOneOptionIndex=this.characterOptions.length-1),this.selectedPlayerOneText.setText(this.characterOptions[this.currentPlayerOneOptionIndex])}},{key:"ChangePlayerTwoOption",value:function ChangePlayerTwoOption(e){this.currentPlayerTwoOptionIndex+=e,this.currentPlayerTwoOptionIndex>this.characterOptions.length-1?this.currentPlayerTwoOptionIndex=0:this.currentPlayerTwoOptionIndex<0&&(this.currentPlayerTwoOptionIndex=this.characterOptions.length-1),this.selectedPlayerTwoText.setText(this.characterOptions[this.currentPlayerTwoOptionIndex])}},{key:"ChangePlayerOneTrophiesOption",value:function ChangePlayerOneTrophiesOption(e){this.currentPlayerOneTrophiesOptionIndex+=e,this.currentPlayerOneTrophiesOptionIndex>this.trophyOptions.length-1?this.currentPlayerOneTrophiesOptionIndex=0:this.currentPlayerOneTrophiesOptionIndex<0&&(this.currentPlayerOneTrophiesOptionIndex=this.trophyOptions.length-1),this.selectedPlayerOneTrophiesText.setText(this.trophyOptions[this.currentPlayerOneTrophiesOptionIndex])}},{key:"ChangePlayerTwoTrophiesOption",value:function ChangePlayerTwoTrophiesOption(e){this.currentPlayerTwoTrophiesOptionIndex+=e,this.currentPlayerTwoTrophiesOptionIndex>this.trophyOptions.length-1?this.currentPlayerTwoTrophiesOptionIndex=0:this.currentPlayerTwoTrophiesOptionIndex<0&&(this.currentPlayerTwoTrophiesOptionIndex=this.trophyOptions.length-1),this.selectedPlayerTwoTrophiesText.setText(this.trophyOptions[this.currentPlayerTwoTrophiesOptionIndex])}},{key:"ChangePlayerOnePointsOption",value:function ChangePlayerOnePointsOption(e){this.currentPlayerOnePointsOptionIndex+=e,this.currentPlayerOnePointsOptionIndex>this.pointsOptions.length-1?this.currentPlayerOnePointsOptionIndex=0:this.currentPlayerOnePointsOptionIndex<0&&(this.currentPlayerOnePointsOptionIndex=this.pointsOptions.length-1),this.selectedPlayerOnePointsText.setText(this.pointsOptions[this.currentPlayerOnePointsOptionIndex])}},{key:"ChangePlayerTwoPointsOption",value:function ChangePlayerTwoPointsOption(e){this.currentPlayerTwoPointsOptionIndex+=e,this.currentPlayerTwoPointsOptionIndex>this.pointsOptions.length-1?this.currentPlayerTwoPointsOptionIndex=0:this.currentPlayerTwoPointsOptionIndex<0&&(this.currentPlayerTwoPointsOptionIndex=this.pointsOptions.length-1),this.selectedPlayerTwoPointsText.setText(this.pointsOptions[this.currentPlayerTwoPointsOptionIndex])}},{key:"ChangePlayerOption",value:function ChangePlayerOption(e){this.currentPlayerOptionIndex+=e,this.currentPlayerOptionIndex>this.playerOptions.length-1?this.currentPlayerOptionIndex=0:this.currentPlayerOptionIndex<0&&(this.currentPlayerOptionIndex=this.playerOptions.length-1),this.selectedPlayersText.setText(this.playerOptions[this.currentPlayerOptionIndex])}},{key:"ChangeDifficultyOption",value:function ChangeDifficultyOption(e){this.currentDifficultyOptionIndex+=e,this.currentDifficultyOptionIndex>this.difficultyOptions.length-1?this.currentDifficultyOptionIndex=0:this.currentDifficultyOptionIndex<0&&(this.currentDifficultyOptionIndex=this.difficultyOptions.length-1),this.selectedDifficultyText.setText(this.difficultyOptions[this.currentDifficultyOptionIndex])}},{key:"ChangeClearDataOption",value:function ChangeClearDataOption(e){this.currentClearDataOptionIndex+=e,this.currentClearDataOptionIndex>this.clearDataOptions.length-1?this.currentClearDataOptionIndex=0:this.currentClearDataOptionIndex<0&&(this.currentClearDataOptionIndex=this.clearDataOptions.length-1),this.selectedClearDataText.setText(this.clearDataOptions[this.currentClearDataOptionIndex])}},{key:"OnPlayButtonPressed",value:function OnPlayButtonPressed(){zn.totalRounds=8;var e=null;switch(this.sceneOptions[this.currentSceneOptionIndex].scene){case"VolleyballMinigame":e=J;break;case"SumoMinigame":e=ke;break;case"BurgerMinigame":e=pt;break;case"HurdlesMinigame":e=le;break;case"PaintingMinigame":e=_e;break;case"CatchMinigame":e=He;break;case"DodgeMinigame":e=Ze;break;case"TrapdoorMinigame":e=vt;break;case"FlappyMinigame":e=xn;break;case"TurtlesMinigame":e=Qt;break;case"SnowballMinigame":e=Un;break;case"HerdingMinigame":e=cn;break;case"ArcheryMinigame":e=Pn;break;case"BoardScene":e=zn;break;case"ResultsScene":e=Vt}"true"==this.clearDataOptions[this.currentClearDataOptionIndex]&&(p.Instance.ClearKey("Board"),p.Instance.SaveToStorage()),a.Instance.StartLoadingScene(O,e,{additionalAssetBundles:["Minigame"],gameData:{playerCount:this.playerOptions[this.currentPlayerOptionIndex],players:[{characterData:this.charactersData[this.currentPlayerOneOptionIndex],points:this.pointsOptions[this.currentPlayerOnePointsOptionIndex],trophies:this.trophyOptions[this.currentPlayerOneTrophiesOptionIndex]},{characterData:this.charactersData[this.currentPlayerTwoOptionIndex],points:this.pointsOptions[this.currentPlayerTwoPointsOptionIndex],trophies:this.trophyOptions[this.currentPlayerTwoTrophiesOptionIndex]}],aiDifficulty:this.difficultyOptions[this.currentDifficultyOptionIndex],parentScene:DebugMenu}})}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){a.Instance.StartLoadingScene(O,er)}},{key:"LoadData",value:function LoadData(){var e=p.Instance.GetData("DebugMenu");e&&(this.currentSceneOptionIndex=e.currentSceneOptionIndex,this.currentDifficultyOptionIndex=e.currentDifficultyOptionIndex,this.currentPlayerOptionIndex=e.currentPlayerOptionIndex,this.currentPlayerOnePointsOptionIndex=e.currentPlayerOnePointsOptionIndex,this.currentPlayerTwoPointsOptionIndex=e.currentPlayerTwoPointsOptionIndex,this.currentPlayerOneTrophiesOptionIndex=e.currentPlayerOneTrophiesOptionIndex,this.currentPlayerTwoTrophiesOptionIndex=e.currentPlayerTwoTrophiesOptionIndex,void 0!==e.currentPlayerOneOptionIndex&&(this.currentPlayerOneOptionIndex=e.currentPlayerOneOptionIndex,this.currentPlayerTwoOptionIndex=e.currentPlayerTwoOptionIndex),null!=e.currentClearDataOptionIndex&&(this.currentClearDataOptionIndex=e.currentClearDataOptionIndex))}},{key:"SaveData",value:function SaveData(){p.Instance.SaveData("DebugMenu",{currentSceneOptionIndex:this.currentSceneOptionIndex,currentDifficultyOptionIndex:this.currentDifficultyOptionIndex,currentPlayerOptionIndex:this.currentPlayerOptionIndex,currentPlayerOneOptionIndex:this.currentPlayerOneOptionIndex,currentPlayerTwoOptionIndex:this.currentPlayerTwoOptionIndex,currentClearDataOptionIndex:this.currentClearDataOptionIndex,currentPlayerOnePointsOptionIndex:this.currentPlayerOnePointsOptionIndex,currentPlayerTwoPointsOptionIndex:this.currentPlayerTwoPointsOptionIndex,currentPlayerOneTrophiesOptionIndex:this.currentPlayerOneTrophiesOptionIndex,currentPlayerTwoTrophiesOptionIndex:this.currentPlayerTwoTrophiesOptionIndex}),p.Instance.SaveToStorage()}},{key:"Destroy",value:function Destroy(){this.SaveData(),DebugMenu_get(DebugMenu_getPrototypeOf(DebugMenu.prototype),"Destroy",this).call(this)}}]),DebugMenu}();function TitleScreen_typeof(e){return(TitleScreen_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TitleScreen_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function TitleScreen_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TitleScreen_get(e,t,n){return(TitleScreen_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function TitleScreen_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TitleScreen_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TitleScreen_getPrototypeOf(e){return(TitleScreen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TitleScreen_setPrototypeOf(e,t){return(TitleScreen_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Wn=function(){function TitleScreen(e){var t;if(function TitleScreen_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TitleScreen),(t=function TitleScreen_possibleConstructorReturn(e,t){return!t||"object"!==TitleScreen_typeof(t)&&"function"!=typeof t?TitleScreen_assertThisInitialized(e):t}(this,TitleScreen_getPrototypeOf(TitleScreen).call(this,e))).background=t.scene.add.sprite(.5*t.scene.scale.width,.5*t.scene.scale.height,"title_screen_background"),t.add(t.background),t.logo=t.scene.add.sprite(.5*t.scene.scale.width,.2*t.scene.scale.height,"main_menu_title_atlas","main_menu_awog_logo.png"),t.add(t.logo),t.spine=t.scene.add.spine(.485*t.scene.scale.width,.525*t.scene.scale.height,"title_screen","animation",!0),1<t.spine.skeletonData.skins.length)for(var n=t.spine.skeletonData.skins,r=0;r<n.length;r++){var o=n[r];if("winter"===o.name){t.spine.setSkin(o);break}}return t.spine.setScale(t.scene.gameScale),t.add(t.spine),t.appLink=new g(t.scene,t.scene.dom,{frames:["gumball_party_icon.png","gumball_party_icon.png"],x:.5*t.scene.scale.width+.5*t.scene.viewport.width-100*t.scene.gameScale,y:t.scene.scale.height-80*t.scene.gameScale,domClass:null,atlas:"ui_atlas",id:"domui_app_link",title:"Gumball App",callback:t.OnAppLinkPressed,context:TitleScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.appText=t.scene.add.text(0,-100*t.scene.gameScale,v.Instance.GetString("check_out_new_app"),{fontFamily:'"FredBurger Black"',fontSize:30*t.scene.gameScale+"px",color:"#FFF",wordWrap:{width:150*t.scene.gameScale},align:"center"}).setOrigin(.5),t.appLink.add(t.appText),I.ClampTextToDimensions(t.appText,t.appText.style.wordWrapWidth,80*t.scene.gameScale),t.gameLogo=t.scene.add.sprite(.5*t.scene.scale.width,275*t.scene.gameScale,"main_menu_logo_atlas","title_screen_game_logo.png"),t.add(t.gameLogo),Pr.Instance.config.debug&&(t.bottomLeftPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel bottom left"}),t.debugButton=new g(t.scene,t.bottomLeftPanel,{frames:["debug_button.png","debug_button.png"],atlas:"ui_atlas",id:"domui_MENU_debug",title:"Debug",callback:t.OnDebugButtonPressed,context:TitleScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}})),t.topRightPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel top right"}),t.audioButton=new m(t.scene,t.topRightPanel,{frames:["button_audio_on_unselected.png","button_audio_on_selected.png"],toggleOffFrames:["button_audio_off_unselected.png","button_audio_off_selected.png"],atlas:"ui_atlas",id:"domui_MENU_audio",title:"Audio",onToggle:t.scene.OnAudioButtonPressed.bind(t.scene),toggleActive:h.Instance.audioEnabled,toggleEvent:"audioEnabled",clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.playPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel play"}),t.playButton=new g(t.scene,t.playPanel,{frames:["button_play_unselected.png","button_play_selected.png"],atlas:"ui_atlas",id:"domui_MENU_play",domClass:"dom_button play",title:"Play",callback:t.OnPlayButtonPressed,context:TitleScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_play"}}),t.Disable(),t}return function TitleScreen_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TitleScreen_setPrototypeOf(e,t)}(TitleScreen,_),function TitleScreen_createClass(e,t,n){return t&&TitleScreen_defineProperties(e.prototype,t),n&&TitleScreen_defineProperties(e,n),e}(TitleScreen,[{key:"update",value:function update(){TitleScreen_get(TitleScreen_getPrototypeOf(TitleScreen.prototype),"update",this).call(this)}},{key:"Enable",value:function Enable(){TitleScreen_get(TitleScreen_getPrototypeOf(TitleScreen.prototype),"Enable",this).call(this),p.Instance.ClearKey("Board"),p.Instance.SaveToStorage(),this.audioButton.Show(),this.audioButton.Enable(),this.debugButton&&(this.debugButton.Show(),this.debugButton.Enable()),this.playButton.Show(),this.playButton.Enable(),this.appLink.Show(),this.appLink.Enable(),this.logo.y=-100*this.scene.gameScale,this.gameLogo.setScale(0),this.scene.tweens.add({targets:this.logo,y:.1*this.scene.scale.height,duration:1e3,ease:"Sine.easeOut"}),this.scene.tweens.killTweensOf(this.gameLogo),this.scene.tweens.add({targets:this.gameLogo,scaleX:1,scaleY:1,duration:1e3,ease:"Back.easeOut"}),this.gameLogo.y=275*this.scene.gameScale,this.scene.tweens.add({targets:this.gameLogo,y:260*this.scene.gameScale,duration:1e3,ease:"Sine.easeInOut",yoyo:!0,repeat:-1})}},{key:"Disable",value:function Disable(){TitleScreen_get(TitleScreen_getPrototypeOf(TitleScreen.prototype),"Disable",this).call(this),this.audioButton.Hide(),this.audioButton.Disable(),this.debugButton&&(this.debugButton.Hide(),this.debugButton.Disable()),this.playButton.Hide(),this.playButton.Disable(),this.appLink.Hide(),this.appLink.Disable()}},{key:"Resize",value:function Resize(){this.appLink.x=.5*this.scene.scale.width+.5*this.scene.viewport.width-100*this.scene.gameScale}},{key:"OnAppLinkPressed",value:function OnAppLinkPressed(){Pr.Instance.LoadAppLink()}},{key:"OnPlayButtonPressed",value:function OnPlayButtonPressed(){a.Instance.StartTransitionScene(E,this.OnTransitionComplete,this)}},{key:"OnTransitionComplete",value:function OnTransitionComplete(){Bt.hasPlayed?this.scene.SetScreenState(er.ScreenState.PlayerSelect):this.scene.SetScreenState(er.ScreenState.Intro)}},{key:"OnDebugButtonPressed",value:function OnDebugButtonPressed(){a.Instance.StartScene(Vn)}}]),TitleScreen}();function CharacterPickerCarousel_typeof(e){return(CharacterPickerCarousel_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CharacterPickerCarousel_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CharacterPickerCarousel_possibleConstructorReturn(e,t){return!t||"object"!==CharacterPickerCarousel_typeof(t)&&"function"!=typeof t?function CharacterPickerCarousel_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function CharacterPickerCarousel_getPrototypeOf(e){return(CharacterPickerCarousel_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CharacterPickerCarousel_setPrototypeOf(e,t){return(CharacterPickerCarousel_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var qn=function(){function CharacterPickerCarousel(e,t,n){var r;return function CharacterPickerCarousel_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CharacterPickerCarousel),(r=CharacterPickerCarousel_possibleConstructorReturn(this,CharacterPickerCarousel_getPrototypeOf(CharacterPickerCarousel).call(this,e,t,n))).touchEnabled=r.scene.deviceManager.mobile,r}return function CharacterPickerCarousel_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CharacterPickerCarousel_setPrototypeOf(e,t)}(CharacterPickerCarousel,Rt),function CharacterPickerCarousel_createClass(e,t,n){return t&&CharacterPickerCarousel_defineProperties(e.prototype,t),n&&CharacterPickerCarousel_defineProperties(e,n),e}(CharacterPickerCarousel,[{key:"UpdateEntry",value:function UpdateEntry(e,t){var n=1-t;e.y=Phaser.Math.Linear(0,150,Phaser.Math.Easing.Quadratic.In(n))}}]),CharacterPickerCarousel}();function CharacterPickerCharacter_typeof(e){return(CharacterPickerCharacter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CharacterPickerCharacter_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CharacterPickerCharacter_possibleConstructorReturn(e,t){return!t||"object"!==CharacterPickerCharacter_typeof(t)&&"function"!=typeof t?function CharacterPickerCharacter_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function CharacterPickerCharacter_get(e,t,n){return(CharacterPickerCharacter_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function CharacterPickerCharacter_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CharacterPickerCharacter_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CharacterPickerCharacter_getPrototypeOf(e){return(CharacterPickerCharacter_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CharacterPickerCharacter_setPrototypeOf(e,t){return(CharacterPickerCharacter_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Yn=function(){function CharacterPickerCharacter(e,t,n,r){var o;return function CharacterPickerCharacter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CharacterPickerCharacter),(o=CharacterPickerCharacter_possibleConstructorReturn(this,CharacterPickerCharacter_getPrototypeOf(CharacterPickerCharacter).call(this,e,n,r))).characterData=t,o.rainbow=o.scene.add.sprite(150*o.scene.gameScale,150*o.scene.gameScale,"main_menu_character_select_atlas","character_select_rainbow.png"),o.add(o.rainbow),o.cloudSprite=o.scene.add.sprite(0,0*o.scene.gameScale,"main_menu_character_select_atlas","character_select_cloud.png"),o.add(o.cloudSprite),o.characterSpine=o.scene.add.spine(0,0,"characterselect_"+o.characterData.id,"idle",!0),o.characterSpine.setScale(o.scene.gameScale),o.add(o.characterSpine),o.alphaMultiplier=0,o}return function CharacterPickerCharacter_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CharacterPickerCharacter_setPrototypeOf(e,t)}(CharacterPickerCharacter,Phaser.GameObjects.Container),function CharacterPickerCharacter_createClass(e,t,n){return t&&CharacterPickerCharacter_defineProperties(e.prototype,t),n&&CharacterPickerCharacter_defineProperties(e,n),e}(CharacterPickerCharacter,[{key:"update",value:function update(){CharacterPickerCharacter_get(CharacterPickerCharacter_getPrototypeOf(CharacterPickerCharacter.prototype),"update",this).call(this);var e=this.x+this.parentContainer.x;this.cloudSprite.x=(0+-.05*e)*this.scene.gameScale,this.rainbow.x=(150+-.15*e)*this.scene.gameScale;var t=1-Math.min(1,Math.abs(e/500*this.scene.gameScale));this.rainbow.alpha=this.alphaMultiplier*t}},{key:"Show",value:function Show(){this.scene.tweens.killTweensOf(this.rainbow),this.alphaMultiplier=0,this.scene.tweens.add({targets:this,alphaMultiplier:1,duration:1250,ease:"Sine.easeOut"})}},{key:"Hide",value:function Hide(){this.scene.tweens.add({targets:this,alphaMultiplier:0,duration:500,delay:0,ease:"Sine.easeIn"})}},{key:"OnFocus",value:function OnFocus(){this.characterSpine.setAnimation(0,"wave",!1),this.characterSpine.once("spine.complete",this.OnWaveComplete,this)}},{key:"OnDefocus",value:function OnDefocus(){this.characterSpine.setAnimation(0,"idle",!0),this.characterSpine.off("spine.complete",this.OnWaveComplete,this)}},{key:"OnWaveComplete",value:function OnWaveComplete(){this.characterSpine.setAnimation(0,"wave_loop",!0)}},{key:"destroy",value:function destroy(){CharacterPickerCharacter_get(CharacterPickerCharacter_getPrototypeOf(CharacterPickerCharacter.prototype),"destroy",this).call(this)}}]),CharacterPickerCharacter}();function CharacterPicker_typeof(e){return(CharacterPicker_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CharacterPicker_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CharacterPicker_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CharacterPicker_get(e,t,n){return(CharacterPicker_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function CharacterPicker_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CharacterPicker_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CharacterPicker_getPrototypeOf(e){return(CharacterPicker_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CharacterPicker_setPrototypeOf(e,t){return(CharacterPicker_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Xn=function(){function CharacterPicker(e,t,n,r){var o;!function CharacterPicker_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CharacterPicker),(o=function CharacterPicker_possibleConstructorReturn(e,t){return!t||"object"!==CharacterPicker_typeof(t)&&"function"!=typeof t?CharacterPicker_assertThisInitialized(e):t}(this,CharacterPicker_getPrototypeOf(CharacterPicker).call(this,e,n,r))).screen=t,o.charactersData=o.scene.cache.json.get("characters_data"),o.carouselContainer=o.scene.add.container(),o.add(o.carouselContainer),o.characters=[],o.selectedCharacters=[],o.currentCharacterIndex=0,o.currentCharacter=null,o.nextButton=new g(o.scene,CharacterPicker_assertThisInitialized(o),{x:250*o.scene.gameScale,y:25*o.scene.gameScale,domClass:null,frames:["button_next_unselected.png","button_next_selected.png"],atlas:"ui_atlas",id:"domui_MENU_next",title:"Next",callback:o.OnNextButtonPressed,context:CharacterPicker_assertThisInitialized(o),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),o.previousButton=new g(o.scene,CharacterPicker_assertThisInitialized(o),{x:-250*o.scene.gameScale,y:25*o.scene.gameScale,domClass:null,frames:["button_previous_unselected.png","button_previous_selected.png"],atlas:"ui_atlas",id:"domui_MENU_previous",title:"Previous",callback:o.OnPreviousButtonPressed,context:CharacterPicker_assertThisInitialized(o),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),o.confirmButton=new g(o.scene,CharacterPicker_assertThisInitialized(o),{x:0,y:275*o.scene.gameScale,domClass:null,frames:["character_select_select.png","character_select_select.png"],atlas:"main_menu_character_select_atlas",id:"domui_confirm_character",title:"Confirm",callback:o.OnConfirmButtonPressed,context:CharacterPicker_assertThisInitialized(o)}),o.confirmButton.SetHoverEffect({scaleX:{value:.925,duration:150,ease:"Sine.easeInOut"},scaleY:{value:.925,duration:150,ease:"Sine.easeInOut"}});var i=o.scene.add.text(0*o.scene.gameScale,0*o.scene.gameScale,v.Instance.GetString("Confirm"),{fontFamily:'"FredBurger Black"',fontSize:50*o.scene.gameScale+"px",color:"#000000"}).setOrigin(.5).setStroke("#FFFFFF",8*o.scene.gameScale);return I.ClampTextToDimensions(i,350*o.scene.gameScale,100*o.scene.gameScale),o.confirmButton.add(i),o.canClick=!0,o}return function CharacterPicker_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CharacterPicker_setPrototypeOf(e,t)}(CharacterPicker,Phaser.GameObjects.Container),function CharacterPicker_createClass(e,t,n){return t&&CharacterPicker_defineProperties(e.prototype,t),n&&CharacterPicker_defineProperties(e,n),e}(CharacterPicker,[{key:"update",value:function update(e,t){CharacterPicker_get(CharacterPicker_getPrototypeOf(CharacterPicker.prototype),"update",this).call(this),this.carousel.update(e,t);for(var n=0;n<this.characters.length;n++)this.characters[n].update(e,t)}},{key:"Enable",value:function Enable(){this.scene.tweens.killTweensOf(this.nextButton),this.scene.tweens.killTweensOf(this.previousButton),this.scene.tweens.killTweensOf(this.confirmButton),this.selectedCharacters=[],this.nextButton.Show(),this.previousButton.Show(),this.confirmButton.Show(),this.CreateCarousel(),this.PlayShowTweens()}},{key:"Disable",value:function Disable(){this.nextButton.Disable(),this.previousButton.Disable(),this.confirmButton.Disable(),this.nextButton.Hide(),this.previousButton.Hide(),this.confirmButton.Hide()}},{key:"OnNextButtonPressed",value:function OnNextButtonPressed(){this.canClick&&(h.Instance.Play("sfx_menu","ui_slide_left"),this.carousel.IncrementIndex(),this.canClick=!1)}},{key:"OnPreviousButtonPressed",value:function OnPreviousButtonPressed(){this.canClick&&(h.Instance.Play("sfx_menu","ui_slide_right"),this.carousel.DecrementIndex(),this.canClick=!1)}},{key:"PlayShowTweens",value:function PlayShowTweens(){h.Instance.Play("sfx_menu","screen_in_character_select"),this.carousel.y=this.scene.scale.height,this.scene.tweens.add({targets:this.carousel,y:125*this.scene.gameScale,duration:600,ease:"Sine.easeOut"}),this.previousButton.setScale(0),this.nextButton.setScale(0),this.confirmButton.setScale(0),this.scene.tweens.add({targets:this.previousButton,scaleX:1,scaleY:1,delay:600,duration:600,ease:"Back.easeOut",onComplete:this.previousButton.Enable(),onCompleteScope:this.previousButton}),this.scene.tweens.add({targets:this.nextButton,scaleX:1,scaleY:1,duration:600,delay:800,ease:"Back.easeOut",onComplete:this.nextButton.Enable(),onCompleteScope:this.nextButton}),h.Instance.Play("sfx_menu","screen_in_confirm_button",{delay:1}),this.scene.tweens.add({targets:this.confirmButton,scaleX:1,scaleY:1,duration:600,delay:1e3,ease:"Back.easeOut",onComplete:this.confirmButton.Enable(),onCompleteScope:this.confirmButton});for(var e=0;e<this.characters.length;e++)this.characters[e].Show()}},{key:"PlayHideTweens",value:function PlayHideTweens(e,t){h.Instance.Play("sfx_menu","screen_out_character_select"),this.nextButton.Disable(),this.previousButton.Disable(),this.confirmButton.Disable(),this.scene.tweens.add({targets:this.confirmButton,scaleX:0,scaleY:0,duration:600,delay:0,ease:"Back.easeIn"}),this.scene.tweens.add({targets:this.nextButton,scaleX:0,scaleY:0,duration:600,delay:200,ease:"Back.easeIn"}),this.scene.tweens.add({targets:this.previousButton,scaleX:0,scaleY:0,delay:400,duration:600,ease:"Back.easeIn"}),this.scene.tweens.add(function CharacterPicker_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({targets:this.carousel,y:this.scene.scale.height,delay:400,duration:600,hold:400,ease:"Sine.easeIn",onComplete:e,onCompleteScope:t},"onCompleteScope",t))}},{key:"SetCharacterIndex",value:function SetCharacterIndex(e){this.currentCharacter.OnDefocus(),this.currentCharacterIndex=e,this.currentCharacter=this.characters[this.currentCharacterIndex],this.currentCharacter.OnFocus()}},{key:"OnCarouselIndexChanged",value:function OnCarouselIndexChanged(e){this.canClick=!0;this.currentCharacterIndex;Math.abs(this.currentCharacterIndex-e),this.SetCharacterIndex(e)}},{key:"SnapToIndex",value:function SnapToIndex(e){this.carousel.selectedIndex=e,this.carousel.ResetCarousel(),this.SetCharacterIndex(e)}},{key:"CreateCarousel",value:function CreateCarousel(){this.carousel&&(this.carousel.visible=!1,this.carousel.destroy());for(var e=0;e<this.characters.length;e++)this.characters[e].destroy();this.characters=[];for(var t=0;t<this.charactersData.length;t++){for(var n=!1,r=0;r<this.selectedCharacters.length;r++)this.charactersData[t]==this.selectedCharacters[r].characterData&&(n=!0);if(!n){var o=new Yn(this.scene,this.charactersData[t],0,0);this.characters.push(o),this.carouselContainer.add(o)}}this.currentCharacterIndex=0,this.currentCharacter=this.characters[this.currentCharacterIndex],this.carousel=new qn(this.scene,this.carouselContainer,{x:0,y:125*this.scene.gameScale,entries:this.characters,separation:.5*this.scene.viewport.width+300*this.scene.gameScale,wrapEntries:!0,updateEntryDist:.5*this.scene.scale.width,gainP:100,gainI:.04,gainD:20,maxVelocity:1e3,swipeMultiplier:3,touchBoundsRect:new Phaser.Geom.Rectangle(0,0,this.scene.scale.width,this.scene.scale.height)}),this.carousel.on("indexChanged",this.OnCarouselIndexChanged,this),this.currentCharacterIndex=0,this.currentCharacter=this.characters[this.currentCharacterIndex],this.carousel.ResetCarousel(),this.SetCharacterIndex(this.carousel.selectedIndex)}},{key:"SetToNextCharacter",value:function SetToNextCharacter(){this.CreateCarousel()}},{key:"OnConfirmButtonPressed",value:function OnConfirmButtonPressed(){if(Math.abs(this.carousel.velocity)<100){for(var e=0;e<this.selectedCharacters.length;e++)if(this.selectedCharacters[e]==this.currentCharacter)return;this.selectedCharacters.push(this.currentCharacter),this.screen.OnConfirmButtonPressed(this.currentCharacter),h.Instance.Play("sfx_menu","vo_"+this.currentCharacter.characterData.id+"_confirm")}}}]),CharacterPicker}();function CharacterSelectScreen_typeof(e){return(CharacterSelectScreen_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CharacterSelectScreen_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function CharacterSelectScreen_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CharacterSelectScreen_get(e,t,n){return(CharacterSelectScreen_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function CharacterSelectScreen_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CharacterSelectScreen_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CharacterSelectScreen_getPrototypeOf(e){return(CharacterSelectScreen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CharacterSelectScreen_setPrototypeOf(e,t){return(CharacterSelectScreen_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Jn=function(){function CharacterSelectScreen(e){var t;return function CharacterSelectScreen_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CharacterSelectScreen),(t=function CharacterSelectScreen_possibleConstructorReturn(e,t){return!t||"object"!==CharacterSelectScreen_typeof(t)&&"function"!=typeof t?CharacterSelectScreen_assertThisInitialized(e):t}(this,CharacterSelectScreen_getPrototypeOf(CharacterSelectScreen).call(this,e))).currentPlayerPanelContainer=t.scene.add.container(.5*t.scene.scale.width,.1*t.scene.scale.height),t.add(t.currentPlayerPanelContainer),t.currentPlayerPanel=t.scene.add.sprite(0,0,"main_menu_character_select_atlas","character_select_panel.png"),t.currentPlayerPanelContainer.add(t.currentPlayerPanel),t.currentPlayerText=t.scene.add.text(0,0,"Player 1",{fontFamily:'"FredBurger Black"',fontSize:50*t.scene.gameScale+"px",color:"#000000"}),t.currentPlayerText.setOrigin(.5),t.currentPlayerText.setStroke("#FFFFFF",8*t.scene.gameScale),t.currentPlayerPanelContainer.add(t.currentPlayerText),t.topLeftPanel=new d(t.scene,CharacterSelectScreen_assertThisInitialized(t),{domClass:"dom_panel top left"}),t.backButton=new g(t.scene,t.topLeftPanel,{frames:["button_back_unselected.png","button_back_selected.png"],atlas:"ui_atlas",id:"domui_MENU_pause",title:"Back",callback:t.OnBackButtonPressed,context:CharacterSelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.topRightPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel top right"}),t.audioButton=new m(t.scene,t.topRightPanel,{frames:["button_audio_on_unselected.png","button_audio_on_selected.png"],toggleOffFrames:["button_audio_off_unselected.png","button_audio_off_selected.png"],atlas:"ui_atlas",id:"domui_MENU_audio",title:"Audio",onToggle:t.scene.OnAudioButtonPressed.bind(t.scene),toggleActive:h.Instance.audioEnabled,toggleEvent:"audioEnabled",clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.currentPlayerIndex=0,t.characterPicker=new Xn(t.scene,CharacterSelectScreen_assertThisInitialized(t),.5*t.scene.scale.width,.5*t.scene.scale.height,0),t.add(t.characterPicker),t.Disable(),t}return function CharacterSelectScreen_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CharacterSelectScreen_setPrototypeOf(e,t)}(CharacterSelectScreen,_),function CharacterSelectScreen_createClass(e,t,n){return t&&CharacterSelectScreen_defineProperties(e.prototype,t),n&&CharacterSelectScreen_defineProperties(e,n),e}(CharacterSelectScreen,[{key:"update",value:function update(e,t){CharacterSelectScreen_get(CharacterSelectScreen_getPrototypeOf(CharacterSelectScreen.prototype),"update",this).call(this),this.characterPicker.update(e,t)}},{key:"Enable",value:function Enable(){CharacterSelectScreen_get(CharacterSelectScreen_getPrototypeOf(CharacterSelectScreen.prototype),"Enable",this).call(this),this.backButton.Show(),this.backButton.Enable(),this.audioButton.Show(),this.audioButton.Enable(),this.characterPicker.Enable(),this.scene.tweens.killTweensOf(this.currentPlayerPanelContainer),this.currentPlayerPanelContainer.y=-100*this.scene.gameScale,this.currentPlayerIndex=0;var e=v.Instance.GetString("player")+" "+(this.currentPlayerIndex+1);this.currentPlayerText.setText(e),I.ClampTextToDimensions(this.currentPlayerText,550*this.scene.gameScale,100*this.scene.gameScale),this.characterPicker.SnapToIndex(0),this.scene.tweens.add({targets:this.currentPlayerPanelContainer,y:.1*this.scene.scale.height,duration:400,ease:"Sine.easeOut"})}},{key:"Disable",value:function Disable(){CharacterSelectScreen_get(CharacterSelectScreen_getPrototypeOf(CharacterSelectScreen.prototype),"Disable",this).call(this),this.backButton.Hide(),this.audioButton.Hide(),this.backButton.Disable(),this.audioButton.Disable(),this.characterPicker.Disable()}},{key:"OnConfirmButtonPressed",value:function OnConfirmButtonPressed(e){this.scene.players[this.currentPlayerIndex].characterData=e.characterData,this.currentPlayerIndex++,this.currentPlayerIndex>this.scene.players.length-1&&this.HideCurrentPlayerPanel(),this.characterPicker.PlayHideTweens(this.OnCharacterSelectHideComplete,this)}},{key:"HideCurrentPlayerPanel",value:function HideCurrentPlayerPanel(){this.scene.tweens.add({targets:this.currentPlayerPanelContainer,y:-100*this.scene.gameScale,delay:300,duration:400,ease:"Sine.easeIn"})}},{key:"OnCharacterSelectHideComplete",value:function OnCharacterSelectHideComplete(){if(this.currentPlayerIndex>this.scene.players.length-1)this.LoadBoardGame();else{var e="";"ar"==v.Instance.language?(e="("+v.Instance.GetString("player")+" "+(this.currentPlayerIndex+1),this.currentPlayerIndex>=this.scene.playerCount&&(e+=" ("+v.Instance.GetString("AI"))):(e=v.Instance.GetString("player")+" "+(this.currentPlayerIndex+1),this.currentPlayerIndex>=this.scene.playerCount&&(e+=" ("+v.Instance.GetString("AI")+")")),this.currentPlayerText.setText(e),I.ClampTextToDimensions(this.currentPlayerText,550*this.scene.gameScale,100*this.scene.gameScale),this.characterPicker.SetToNextCharacter(),this.characterPicker.PlayShowTweens()}}},{key:"LoadBoardGame",value:function LoadBoardGame(){a.Instance.StartTransitionScene(E,this.OnTransitionComplete,this)}},{key:"OnTransitionComplete",value:function OnTransitionComplete(){p.Instance.ClearKey("Board"),a.Instance.StartLoadingScene(O,zn,{gameData:{playerCount:this.scene.playerCount,players:this.scene.players,aiDifficulty:this.scene.aiDifficulty}})}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){this.backButton.Disable(),this.HideCurrentPlayerPanel(),this.characterPicker.PlayHideTweens(this.OnBackHideTweenComplete,this)}},{key:"OnBackHideTweenComplete",value:function OnBackHideTweenComplete(){this.scene.SetScreenState(er.ScreenState.GameLengthSelect)}}]),CharacterSelectScreen}();function PlayerSelectScreen_typeof(e){return(PlayerSelectScreen_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PlayerSelectScreen_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PlayerSelectScreen_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function PlayerSelectScreen_get(e,t,n){return(PlayerSelectScreen_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function PlayerSelectScreen_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PlayerSelectScreen_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PlayerSelectScreen_getPrototypeOf(e){return(PlayerSelectScreen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PlayerSelectScreen_setPrototypeOf(e,t){return(PlayerSelectScreen_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Zn=function(){function PlayerSelectScreen(e){var t;!function PlayerSelectScreen_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PlayerSelectScreen),(t=function PlayerSelectScreen_possibleConstructorReturn(e,t){return!t||"object"!==PlayerSelectScreen_typeof(t)&&"function"!=typeof t?PlayerSelectScreen_assertThisInitialized(e):t}(this,PlayerSelectScreen_getPrototypeOf(PlayerSelectScreen).call(this,e))).singlePlayerButton=new g(t.scene,t.scene.dom,{x:-150*t.scene.gameScale,y:200*t.scene.gameScale,buttonOrigin:new Phaser.Math.Vector2(0,.5),domClass:null,frames:["panel_singleplayer.png"],atlas:"main_menu_player_select_atlas",id:"domui_singleplayer",title:"Single Player",callback:t.OnSinglePlayerButtonPressed,context:PlayerSelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}}),t.singlePlayerButton.SetHoverEffect({x:{value:-200*t.scene.gameScale,duration:150,ease:"Sine.easeInOut"}});var n=t.scene.add.text(1075*t.scene.gameScale,-100*t.scene.gameScale,v.Instance.GetString("singleplayer"),{fontFamily:'"FredBurger Black"',fontSize:50*t.scene.gameScale+"px",color:"#000000"}).setOrigin(.5).setStroke("#FFFFFF",8*t.scene.gameScale);I.ClampTextToDimensions(n,400*t.scene.gameScale,150*t.scene.gameScale),t.singlePlayerButton.add(n),t.multiPlayerButton=new g(t.scene,t.scene.dom,{x:t.scene.scale.width+150*t.scene.gameScale,y:550*t.scene.gameScale,buttonOrigin:new Phaser.Math.Vector2(1,.5),domClass:null,frames:["panel_multiplayer.png"],atlas:"main_menu_player_select_atlas",id:"domui_multiplayer",title:"Multi Player",callback:t.OnMultiPlayerButtonPressed,context:PlayerSelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}}),t.multiPlayerButton.SetHoverEffect({x:{value:t.scene.scale.width+200*t.scene.gameScale,duration:150,ease:"Sine.easeInOut"}});var r=t.scene.add.text(-1025*t.scene.gameScale,-100*t.scene.gameScale,v.Instance.GetString("multiplayer"),{fontFamily:'"FredBurger Black"',fontSize:50*t.scene.gameScale+"px",color:"#000000"}).setOrigin(.5).setStroke("#FFFFFF",8*t.scene.gameScale);return I.ClampTextToDimensions(r,400*t.scene.gameScale,150*t.scene.gameScale),t.multiPlayerButton.add(r),t.topLeftPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel top left"}),t.backButton=new g(t.scene,t.topLeftPanel,{frames:["button_back_unselected.png","button_back_selected.png"],atlas:"ui_atlas",id:"domui_MENU_pause",title:"Back",callback:t.OnBackButtonPressed,context:PlayerSelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.topRightPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel top right"}),t.audioButton=new m(t.scene,t.topRightPanel,{frames:["button_audio_on_unselected.png","button_audio_on_selected.png"],toggleOffFrames:["button_audio_off_unselected.png","button_audio_off_selected.png"],atlas:"ui_atlas",id:"domui_MENU_audio",title:"Audio",onToggle:t.scene.OnAudioButtonPressed.bind(t.scene),toggleActive:h.Instance.audioEnabled,toggleEvent:"audioEnabled",clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.Disable(),t}return function PlayerSelectScreen_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PlayerSelectScreen_setPrototypeOf(e,t)}(PlayerSelectScreen,_),function PlayerSelectScreen_createClass(e,t,n){return t&&PlayerSelectScreen_defineProperties(e.prototype,t),n&&PlayerSelectScreen_defineProperties(e,n),e}(PlayerSelectScreen,[{key:"update",value:function update(){PlayerSelectScreen_get(PlayerSelectScreen_getPrototypeOf(PlayerSelectScreen.prototype),"update",this).call(this)}},{key:"Enable",value:function Enable(){PlayerSelectScreen_get(PlayerSelectScreen_getPrototypeOf(PlayerSelectScreen.prototype),"Enable",this).call(this),this.backButton.Show(),this.backButton.Enable(),this.audioButton.Show(),this.audioButton.Enable(),this.singlePlayerButton.Show(),this.multiPlayerButton.Show(),this.singlePlayerButton.alpha=1,this.multiPlayerButton.alpha=1,this.singlePlayerButton.x=-this.singlePlayerButton.button.width,this.multiPlayerButton.x=this.scene.scale.width+this.multiPlayerButton.button.width,this.scene.tweens.add({targets:this.singlePlayerButton,x:-150*this.scene.gameScale,duration:750,delay:250,ease:"Back.easeOut",onComplete:this.singlePlayerButton.Enable,onCompleteScope:this.singlePlayerButton}),this.scene.tweens.add({targets:this.multiPlayerButton,x:this.scene.scale.width+150*this.scene.gameScale,duration:750,delay:250,ease:"Back.easeOut",onComplete:this.multiPlayerButton.Enable,onCompleteScope:this.multiPlayerButton}),h.Instance.Play("sfx_menu","screen_in_no_players")}},{key:"Disable",value:function Disable(){PlayerSelectScreen_get(PlayerSelectScreen_getPrototypeOf(PlayerSelectScreen.prototype),"Disable",this).call(this),this.scene.tweens.killTweensOf(this.singlePlayerButton),this.scene.tweens.killTweensOf(this.multiPlayerButton),this.backButton.Hide(),this.audioButton.Hide(),this.backButton.Disable(),this.audioButton.Disable(),this.backButton.Hide(),this.backButton.Disable(),this.singlePlayerButton.Hide(),this.singlePlayerButton.Disable(),this.multiPlayerButton.Hide(),this.multiPlayerButton.Disable()}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){a.Instance.StartTransitionScene(E,this.OnTransitionComplete,this)}},{key:"OnTransitionComplete",value:function OnTransitionComplete(){this.scene.SetScreenState(er.ScreenState.Title)}},{key:"OnPreviousButtonPressed",value:function OnPreviousButtonPressed(){this.ChangeOption(-1)}},{key:"OnNextButtonPressed",value:function OnNextButtonPressed(){this.ChangeOption(1)}},{key:"ChangeOption",value:function ChangeOption(e){this.currentOptionIndex+=e,this.currentOptionIndex>this.options.length-1?this.currentOptionIndex=0:this.currentOptionIndex<0&&(this.currentOptionIndex=this.options.length-1),this.selectedText.setText(this.options[this.currentOptionIndex])}},{key:"OnSinglePlayerButtonPressed",value:function OnSinglePlayerButtonPressed(){this.scene.playerCount=1,this.singlePlayerButton.Disable(),this.multiPlayerButton.Disable(),h.Instance.Play("sfx_menu","screen_out_no_players"),this.scene.tweens.add({targets:this.singlePlayerButton,x:-this.singlePlayerButton.button.width,duration:500,ease:"Back.easeIn",onComplete:function onComplete(){this.scene.SetScreenState(er.ScreenState.DifficultySelect)},onCompleteScope:this}),this.scene.tweens.add({targets:this.multiPlayerButton,alpha:0,duration:250,ease:"Linear"})}},{key:"OnMultiPlayerButtonPressed",value:function OnMultiPlayerButtonPressed(){this.scene.playerCount=2,h.Instance.Play("sfx_menu","screen_out_no_players"),this.singlePlayerButton.Disable(),this.multiPlayerButton.Disable(),this.scene.tweens.add({targets:this.multiPlayerButton,x:this.scene.scale.width+this.multiPlayerButton.button.width,duration:500,ease:"Back.easeIn",onComplete:function onComplete(){this.scene.SetScreenState(er.ScreenState.GameLengthSelect)},onCompleteScope:this}),this.scene.tweens.add({targets:this.singlePlayerButton,alpha:0,duration:250,ease:"Linear"})}}]),PlayerSelectScreen}();function DifficultySelectScreen_typeof(e){return(DifficultySelectScreen_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DifficultySelectScreen_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function DifficultySelectScreen_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DifficultySelectScreen_get(e,t,n){return(DifficultySelectScreen_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function DifficultySelectScreen_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DifficultySelectScreen_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DifficultySelectScreen_getPrototypeOf(e){return(DifficultySelectScreen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DifficultySelectScreen_setPrototypeOf(e,t){return(DifficultySelectScreen_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var $n=function(){function DifficultySelectScreen(e){var t;!function DifficultySelectScreen_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DifficultySelectScreen),(t=function DifficultySelectScreen_possibleConstructorReturn(e,t){return!t||"object"!==DifficultySelectScreen_typeof(t)&&"function"!=typeof t?DifficultySelectScreen_assertThisInitialized(e):t}(this,DifficultySelectScreen_getPrototypeOf(DifficultySelectScreen).call(this,e))).topLeftPanel=new d(t.scene,DifficultySelectScreen_assertThisInitialized(t),{domClass:"dom_panel top left"}),t.backButton=new g(t.scene,t.topLeftPanel,{frames:["button_back_unselected.png","button_back_selected.png"],atlas:"ui_atlas",id:"domui_MENU_pause",title:"Back",callback:t.OnBackButtonPressed,context:DifficultySelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.topRightPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel top right"}),t.audioButton=new m(t.scene,t.topRightPanel,{frames:["button_audio_on_unselected.png","button_audio_on_selected.png"],toggleOffFrames:["button_audio_off_unselected.png","button_audio_off_selected.png"],atlas:"ui_atlas",id:"domui_MENU_audio",title:"Audio",onToggle:t.scene.OnAudioButtonPressed.bind(t.scene),toggleActive:h.Instance.audioEnabled,toggleEvent:"audioEnabled",clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.easyDifficultyButton=new g(t.scene,t.scene.dom,{x:.5*t.scene.scale.width,y:120*t.scene.gameScale,domClass:null,frames:["difficulty_easy.png"],atlas:"main_menu_difficulty_select_atlas",id:"domui_easy_difficulty",title:"Easy",callback:t.OnEasyButtonPressed,context:DifficultySelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}}),t.easyDifficultyButton.SetHoverEffect({scaleX:{value:.925,duration:150,ease:"Sine.easeInOut"},scaleY:{value:.925,duration:150,ease:"Sine.easeInOut"}});var n=t.scene.add.text(0*t.scene.gameScale,25*t.scene.gameScale,v.Instance.GetString("easy"),{fontFamily:'"FredBurger Black"',fontSize:50*t.scene.gameScale+"px",color:"#000000"}).setOrigin(.5).setStroke("#FFFFFF",8*t.scene.gameScale);I.ClampTextToDimensions(n,350*t.scene.gameScale,150*t.scene.gameScale),t.easyDifficultyButton.add(n),t.mediumDifficultyButton=new g(t.scene,t.scene.dom,{x:.5*t.scene.scale.width,y:370*t.scene.gameScale,domClass:null,frames:["difficulty_medium.png"],atlas:"main_menu_difficulty_select_atlas",id:"domui_medium_difficulty",title:"Medium",callback:t.OnMediumButtonPressed,context:DifficultySelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}}),t.mediumDifficultyButton.SetHoverEffect({scaleX:{value:.925,duration:150,ease:"Sine.easeInOut"},scaleY:{value:.925,duration:150,ease:"Sine.easeInOut"}});var r=t.scene.add.text(0*t.scene.gameScale,0*t.scene.gameScale,v.Instance.GetString("medium"),{fontFamily:'"FredBurger Black"',fontSize:50*t.scene.gameScale+"px",color:"#000000"}).setOrigin(.5).setStroke("#FFFFFF",8*t.scene.gameScale);I.ClampTextToDimensions(r,350*t.scene.gameScale,150*t.scene.gameScale),t.mediumDifficultyButton.add(r),t.hardDifficultyButton=new g(t.scene,t.scene.dom,{x:.5*t.scene.scale.width,y:620*t.scene.gameScale,domClass:null,frames:["difficulty_hard.png"],atlas:"main_menu_difficulty_select_atlas",id:"domui_hard_difficulty",title:"Hard",callback:t.OnHardButtonPressed,context:DifficultySelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}}),t.hardDifficultyButton.SetHoverEffect({scaleX:{value:.925,duration:150,ease:"Sine.easeInOut"},scaleY:{value:.925,duration:150,ease:"Sine.easeInOut"}});var o=t.scene.add.text(0*t.scene.gameScale,0*t.scene.gameScale,v.Instance.GetString("hard"),{fontFamily:'"FredBurger Black"',fontSize:50*t.scene.gameScale+"px",color:"#000000"}).setOrigin(.5).setStroke("#FFFFFF",8*t.scene.gameScale);return I.ClampTextToDimensions(o,350*t.scene.gameScale,150*t.scene.gameScale),t.hardDifficultyButton.add(o),t.Disable(),t}return function DifficultySelectScreen_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DifficultySelectScreen_setPrototypeOf(e,t)}(DifficultySelectScreen,_),function DifficultySelectScreen_createClass(e,t,n){return t&&DifficultySelectScreen_defineProperties(e.prototype,t),n&&DifficultySelectScreen_defineProperties(e,n),e}(DifficultySelectScreen,[{key:"update",value:function update(){DifficultySelectScreen_get(DifficultySelectScreen_getPrototypeOf(DifficultySelectScreen.prototype),"update",this).call(this)}},{key:"Enable",value:function Enable(){DifficultySelectScreen_get(DifficultySelectScreen_getPrototypeOf(DifficultySelectScreen.prototype),"Enable",this).call(this),this.backButton.Show(),this.backButton.Enable(),this.audioButton.Show(),this.audioButton.Enable(),this.easyDifficultyButton.Show(),this.mediumDifficultyButton.Show(),this.hardDifficultyButton.Show(),this.easyDifficultyButton.setScale(0),this.mediumDifficultyButton.setScale(0),this.hardDifficultyButton.setScale(0),this.easyDifficultyButton.alpha=1,this.mediumDifficultyButton.alpha=1,this.hardDifficultyButton.alpha=1,this.easyDifficultyButton.y=120*this.scene.gameScale,this.mediumDifficultyButton.y=370*this.scene.gameScale,this.hardDifficultyButton.y=620*this.scene.gameScale,this.scene.tweens.add({targets:this.easyDifficultyButton,scaleX:1,scaleY:1,duration:500,ease:"Sine.easeOut",onComplete:this.easyDifficultyButton.Enable,onCompleteScope:this.easyDifficultyButton}),this.scene.tweens.add({targets:this.mediumDifficultyButton,scaleX:1,scaleY:1,delay:150,duration:500,ease:"Back.easeOut",onComplete:this.mediumDifficultyButton.Enable,onCompleteScope:this.mediumDifficultyButton}),this.scene.tweens.add({targets:this.hardDifficultyButton,scaleX:1,scaleY:1,duration:800,delay:0,ease:"Bounce.easeOut",onComplete:this.hardDifficultyButton.Enable,onCompleteScope:this.hardDifficultyButton}),h.Instance.Play("sfx_menu","screen_in_difficulty")}},{key:"Disable",value:function Disable(){DifficultySelectScreen_get(DifficultySelectScreen_getPrototypeOf(DifficultySelectScreen.prototype),"Disable",this).call(this),this.scene.tweens.killTweensOf(this.easyDifficultyButton),this.scene.tweens.killTweensOf(this.mediumDifficultyButton),this.scene.tweens.killTweensOf(this.hardDifficultyButton),this.backButton.Hide(),this.audioButton.Hide(),this.backButton.Disable(),this.audioButton.Disable(),this.easyDifficultyButton.Hide(),this.easyDifficultyButton.Disable(),this.mediumDifficultyButton.Hide(),this.mediumDifficultyButton.Disable(),this.hardDifficultyButton.Hide(),this.hardDifficultyButton.Disable()}},{key:"OnEasyButtonPressed",value:function OnEasyButtonPressed(){this.scene.aiDifficulty="EASY",this.TweenOutButtons(this.easyDifficultyButton,this.hardDifficultyButton,this.mediumDifficultyButton)}},{key:"OnMediumButtonPressed",value:function OnMediumButtonPressed(){this.scene.aiDifficulty="MEDIUM",this.TweenOutButtons(this.mediumDifficultyButton,this.easyDifficultyButton,this.hardDifficultyButton)}},{key:"OnHardButtonPressed",value:function OnHardButtonPressed(){this.scene.aiDifficulty="HARD",this.TweenOutButtons(this.hardDifficultyButton,this.easyDifficultyButton,this.mediumDifficultyButton)}},{key:"TweenOutButtons",value:function TweenOutButtons(e,t,n){this.easyDifficultyButton.Disable(),this.mediumDifficultyButton.Disable(),this.hardDifficultyButton.Disable(),this.scene.tweens.add({targets:t,alpha:0,duration:250,ease:"Linear"}),this.scene.tweens.add({targets:n,alpha:0,duration:250,ease:"Linear"}),this.scene.tweens.add({targets:e,y:{value:this.mediumDifficultyButton.y,duration:500,ease:"Sine.easeOut"},scaleX:{value:0,duration:500,delay:750,hold:300,ease:"Back.easeIn"},scaleY:{value:0,duration:500,delay:750,hold:300,ease:"Back.easeIn"},onComplete:this.OnAnyDifficultyButtonPressed,onCompleteScope:this}),h.Instance.Play("sfx_menu","screen_out_difficulty")}},{key:"OnAnyDifficultyButtonPressed",value:function OnAnyDifficultyButtonPressed(){this.scene.SetScreenState(er.ScreenState.GameLengthSelect)}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){this.scene.SetScreenState(er.ScreenState.PlayerSelect)}}]),DifficultySelectScreen}();function GameLengthSelectScreen_typeof(e){return(GameLengthSelectScreen_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GameLengthSelectScreen_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function GameLengthSelectScreen_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GameLengthSelectScreen_get(e,t,n){return(GameLengthSelectScreen_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function GameLengthSelectScreen_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=GameLengthSelectScreen_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function GameLengthSelectScreen_getPrototypeOf(e){return(GameLengthSelectScreen_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function GameLengthSelectScreen_setPrototypeOf(e,t){return(GameLengthSelectScreen_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var Qn=function(){function GameLengthSelectScreen(e){var t;!function GameLengthSelectScreen_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GameLengthSelectScreen),(t=function GameLengthSelectScreen_possibleConstructorReturn(e,t){return!t||"object"!==GameLengthSelectScreen_typeof(t)&&"function"!=typeof t?GameLengthSelectScreen_assertThisInitialized(e):t}(this,GameLengthSelectScreen_getPrototypeOf(GameLengthSelectScreen).call(this,e))).shortButton=new g(t.scene,t.scene.dom,{x:.5*t.scene.scale.width-300*t.scene.gameScale,y:.5*t.scene.scale.height,buttonOrigin:new Phaser.Math.Vector2(.5,.5),domClass:null,frames:["duration_quick.png"],atlas:"main_menu_difficulty_select_atlas",id:"domui_quick_game",title:"Quick Game",callback:t.OnShortButtonPressed,context:GameLengthSelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}}),t.shortButton.SetHoverEffect({scaleX:{value:.925,duration:150,ease:"Sine.easeInOut"},scaleY:{value:.925,duration:150,ease:"Sine.easeInOut"}});var n=t.scene.add.text(0,-20*t.scene.gameScale,v.Instance.GetString("quick"),{fontFamily:'"FredBurger Black"',fontSize:50*t.scene.gameScale+"px",color:"#000000"}).setOrigin(.5);I.ClampTextToDimensions(n,250*t.scene.gameScale,150*t.scene.gameScale),t.shortButton.add(n);var r=t.scene.add.text(0,35*t.scene.gameScale,v.Instance.GetString("5_rounds"),{fontFamily:'"FredBurger Black"',fontSize:32*t.scene.gameScale+"px",color:"#FFFFFF"}).setOrigin(.5);I.ClampTextToDimensions(r,250*t.scene.gameScale,150*t.scene.gameScale),t.shortButton.add(r),t.mediumButton=new g(t.scene,t.scene.dom,{x:.5*t.scene.scale.width,y:.5*t.scene.scale.height,buttonOrigin:new Phaser.Math.Vector2(.5,.5),domClass:null,frames:["duration_standard.png"],atlas:"main_menu_difficulty_select_atlas",id:"domui_standard_game",title:"Standard Game",callback:t.OnMediumButtonPressed,context:GameLengthSelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}}),t.mediumButton.SetHoverEffect({scaleX:{value:.925,duration:150,ease:"Sine.easeInOut"},scaleY:{value:.925,duration:150,ease:"Sine.easeInOut"}});var o=t.scene.add.text(0,-20*t.scene.gameScale,v.Instance.GetString("standard"),{fontFamily:'"FredBurger Black"',fontSize:50*t.scene.gameScale+"px",color:"#000000"}).setOrigin(.5);I.ClampTextToDimensions(o,250*t.scene.gameScale,150*t.scene.gameScale),t.mediumButton.add(o);var i=t.scene.add.text(0,35*t.scene.gameScale,v.Instance.GetString("8_rounds"),{fontFamily:'"FredBurger Black"',fontSize:32*t.scene.gameScale+"px",color:"#FFFFFF"}).setOrigin(.5);I.ClampTextToDimensions(i,250*t.scene.gameScale,150*t.scene.gameScale),t.mediumButton.add(i),t.longButton=new g(t.scene,t.scene.dom,{x:.5*t.scene.scale.width+300*t.scene.gameScale,y:.5*t.scene.scale.height,buttonOrigin:new Phaser.Math.Vector2(.5,.5),domClass:null,frames:["duration_marathon.png"],atlas:"main_menu_difficulty_select_atlas",id:"domui_marathon_game",title:"Marathon Game",callback:t.OnLongButtonPressed,context:GameLengthSelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_medium"}}),t.longButton.SetHoverEffect({scaleX:{value:.925,duration:150,ease:"Sine.easeInOut"},scaleY:{value:.925,duration:150,ease:"Sine.easeInOut"}});var a=t.scene.add.text(0,-20*t.scene.gameScale,v.Instance.GetString("marathon"),{fontFamily:'"FredBurger Black"',fontSize:50*t.scene.gameScale+"px",color:"#000000"}).setOrigin(.5);I.ClampTextToDimensions(a,250*t.scene.gameScale,150*t.scene.gameScale),t.longButton.add(a);var s=t.scene.add.text(0,35*t.scene.gameScale,v.Instance.GetString("12_rounds"),{fontFamily:'"FredBurger Black"',fontSize:32*t.scene.gameScale+"px",color:"#FFFFFF"}).setOrigin(.5);return I.ClampTextToDimensions(s,250*t.scene.gameScale,150*t.scene.gameScale),t.longButton.add(s),t.topLeftPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel top left"}),t.backButton=new g(t.scene,t.topLeftPanel,{frames:["button_back_unselected.png","button_back_selected.png"],atlas:"ui_atlas",id:"domui_MENU_pause",title:"Back",callback:t.OnBackButtonPressed,context:GameLengthSelectScreen_assertThisInitialized(t),clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.topRightPanel=new d(t.scene,t.scene.dom,{domClass:"dom_panel top right"}),t.audioButton=new m(t.scene,t.topRightPanel,{frames:["button_audio_on_unselected.png","button_audio_on_selected.png"],toggleOffFrames:["button_audio_off_unselected.png","button_audio_off_selected.png"],atlas:"ui_atlas",id:"domui_MENU_audio",title:"Audio",onToggle:t.scene.OnAudioButtonPressed.bind(t.scene),toggleActive:h.Instance.audioEnabled,toggleEvent:"audioEnabled",clickSound:{layer:"sfx_ui_shared",key:"ui_button_small"}}),t.Disable(),t}return function GameLengthSelectScreen_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GameLengthSelectScreen_setPrototypeOf(e,t)}(GameLengthSelectScreen,_),function GameLengthSelectScreen_createClass(e,t,n){return t&&GameLengthSelectScreen_defineProperties(e.prototype,t),n&&GameLengthSelectScreen_defineProperties(e,n),e}(GameLengthSelectScreen,[{key:"update",value:function update(){GameLengthSelectScreen_get(GameLengthSelectScreen_getPrototypeOf(GameLengthSelectScreen.prototype),"update",this).call(this)}},{key:"Enable",value:function Enable(){GameLengthSelectScreen_get(GameLengthSelectScreen_getPrototypeOf(GameLengthSelectScreen.prototype),"Enable",this).call(this),this.shortButton.setScale(1),this.mediumButton.setScale(1),this.longButton.setScale(1),this.backButton.Show(),this.backButton.Enable(),this.audioButton.Show(),this.audioButton.Enable(),this.shortButton.Show(),this.mediumButton.Show(),this.longButton.Show(),this.shortButton.y=-200*this.scene.gameScale,this.mediumButton.y=this.scene.scale.height+200*this.scene.gameScale,this.longButton.y=-200*this.scene.gameScale,this.scene.tweens.add({targets:this.shortButton,y:.5*this.scene.scale.height,duration:400,ease:"Back.easeOut"}),this.scene.tweens.add({targets:this.mediumButton,y:.5*this.scene.scale.height,duration:400,delay:200,ease:"Back.easeOut"}),this.scene.tweens.add({targets:this.longButton,y:.5*this.scene.scale.height,duration:400,delay:400,ease:"Back.easeOut",onComplete:this.OnEnableComplete,onCompleteScope:this}),h.Instance.Play("sfx_menu","screen_in_game_length")}},{key:"OnEnableComplete",value:function OnEnableComplete(){this.shortButton.Enable(),this.mediumButton.Enable(),this.longButton.Enable()}},{key:"Disable",value:function Disable(){GameLengthSelectScreen_get(GameLengthSelectScreen_getPrototypeOf(GameLengthSelectScreen.prototype),"Disable",this).call(this),this.scene.tweens.killTweensOf(this.shortButton),this.scene.tweens.killTweensOf(this.mediumButton),this.scene.tweens.killTweensOf(this.longButton),this.audioButton.Hide(),this.audioButton.Disable(),this.backButton.Hide(),this.backButton.Disable(),this.shortButton.Hide(),this.shortButton.Disable(),this.mediumButton.Hide(),this.mediumButton.Disable(),this.longButton.Hide(),this.longButton.Disable()}},{key:"OnBackButtonPressed",value:function OnBackButtonPressed(){switch(this.scene.playerCount){case 1:this.scene.SetScreenState(er.ScreenState.DifficultySelect);break;case 2:this.scene.SetScreenState(er.ScreenState.PlayerSelect)}}},{key:"OnShortButtonPressed",value:function OnShortButtonPressed(){zn.totalRounds=5,this.TweenOutButtons()}},{key:"OnMediumButtonPressed",value:function OnMediumButtonPressed(){zn.totalRounds=8,this.TweenOutButtons()}},{key:"OnLongButtonPressed",value:function OnLongButtonPressed(){zn.totalRounds=12,this.TweenOutButtons()}},{key:"TweenOutButtons",value:function TweenOutButtons(){this.shortButton.Disable(),this.mediumButton.Disable(),this.longButton.Disable(),h.Instance.Play("sfx_menu","screen_out_game_length"),this.scene.tweens.add({targets:this.shortButton,y:-200*this.scene.gameScale,duration:400,delay:150,ease:"Back.easeIn"}),this.scene.tweens.add({targets:this.mediumButton,y:this.scene.scale.height+200*this.scene.gameScale,duration:400,delay:150,ease:"Back.easeIn"}),this.scene.tweens.add({targets:this.longButton,y:-200*this.scene.gameScale,duration:400,delay:150,ease:"Back.easeIn",onComplete:this.OnTweenOutComplete,onCompleteScope:this})}},{key:"OnTweenOutComplete",value:function OnTweenOutComplete(){this.scene.SetScreenState(er.ScreenState.CharacterSelect)}}]),GameLengthSelectScreen}();function MainMenu_typeof(e){return(MainMenu_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MainMenu_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function MainMenu_possibleConstructorReturn(e,t){return!t||"object"!==MainMenu_typeof(t)&&"function"!=typeof t?function MainMenu_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function MainMenu_get(e,t,n){return(MainMenu_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function MainMenu_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MainMenu_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MainMenu_getPrototypeOf(e){return(MainMenu_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MainMenu_setPrototypeOf(e,t){return(MainMenu_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var er=function(){function MainMenu(){return function MainMenu_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MainMenu),MainMenu_possibleConstructorReturn(this,MainMenu_getPrototypeOf(MainMenu).call(this,"MainMenu"))}return function MainMenu_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MainMenu_setPrototypeOf(e,t)}(MainMenu,y),function MainMenu_createClass(e,t,n){return t&&MainMenu_defineProperties(e.prototype,t),n&&MainMenu_defineProperties(e,n),e}(MainMenu,[{key:"create",value:function create(){MainMenu_get(MainMenu_getPrototypeOf(MainMenu.prototype),"create",this).call(this),p.Instance.ClearKey("BoardScene"),p.Instance.SaveToStorage(),this.background=this.add.sprite(.5*this.scale.width,.5*this.scale.height,"main_menu_screens_background"),this.world.add(this.background),this.mainMenuTitle=new Wn(this),this.world.add(this.mainMenuTitle),this.mainMenuPlayerSelect=new Zn(this),this.world.add(this.mainMenuPlayerSelect),this.mainMenuDifficultySelect=new $n(this),this.world.add(this.mainMenuDifficultySelect),this.mainMenuGameLengthSelect=new Qn(this),this.world.add(this.mainMenuGameLengthSelect),this.mainMenuCharacterSelect=new Jn(this),this.world.add(this.mainMenuCharacterSelect),this.mainMenuIntro=new Bt(this),this.world.add(this.mainMenuIntro),h.Instance.AddLayer("music_menu",{audioKeys:["music_menu","music_titles","music_intro"],allowMultiple:!1}),h.Instance.AddLayer("sfx_menu",{audioKeys:["ui_slide_right","ui_slide_left","screen_in_no_players","screen_out_no_players","screen_in_difficulty","screen_out_difficulty","screen_in_character_select","screen_out_character_select","screen_in_confirm_button","screen_in_game_length","screen_out_game_length","vo_anais_confirm","vo_tobias_confirm","vo_penny_confirm","vo_gumball_confirm","vo_darwin_confirm","vo_carrie_confirm"]}),h.Instance.AddLayer("sfx_intro",{audioKeys:["intro_tutorial_panel_in","intro_tutorial_panel_out","intro_box_opening","intro_box_absorb","screen_in_intro"]}),h.Instance.AddLayer("sfx_ui_shared",{audioKeys:["ui_button_medium","ui_button_play","ui_button_small","ui_confirm","screen_wipe"]}),this.currentScreen=null,this.playerCount=1,this.aiDifficulty="MEDIUM",this.players=[{characterData:void 0,points:0,trophies:0},{characterData:void 0,points:0,trophies:0}],this.SetScreenState(MainMenu.ScreenState.Title)}},{key:"update",value:function update(e,t){MainMenu_get(MainMenu_getPrototypeOf(MainMenu.prototype),"update",this).call(this,e,t),this.currentScreen.update(e,t)}},{key:"render",value:function render(){MainMenu_get(MainMenu_getPrototypeOf(MainMenu.prototype),"render",this).call(this,time,delta)}},{key:"Resize",value:function Resize(){MainMenu_get(MainMenu_getPrototypeOf(MainMenu.prototype),"Resize",this).call(this),this.currentScreen&&this.currentScreen.Resize()}},{key:"SetScreenState",value:function SetScreenState(e){switch(this.currentScreen&&this.currentScreen.Disable(),h.Instance.Stop("music_menu","music_intro"),e){case MainMenu.ScreenState.Title:this.currentScreen=this.mainMenuTitle,h.Instance.Stop("music_menu","music_menu",{restart:!1}),h.Instance.Play("music_menu","music_titles",{restart:!1,loop:!0});break;case MainMenu.ScreenState.PlayerSelect:this.currentScreen=this.mainMenuPlayerSelect,h.Instance.Play("music_menu","music_menu",{restart:!1,loop:!0});break;case MainMenu.ScreenState.DifficultySelect:this.currentScreen=this.mainMenuDifficultySelect;break;case MainMenu.ScreenState.GameLengthSelect:this.currentScreen=this.mainMenuGameLengthSelect;break;case MainMenu.ScreenState.CharacterSelect:this.currentScreen=this.mainMenuCharacterSelect;break;case MainMenu.ScreenState.Intro:this.currentScreen=this.mainMenuIntro,h.Instance.Play("music_menu","music_intro",{restart:!1,loop:!0,volume:.25}),h.Instance.Stop("music_menu","music_titles")}this.currentScreen.Enable()}},{key:"Destroy",value:function Destroy(){MainMenu_get(MainMenu_getPrototypeOf(MainMenu.prototype),"Destroy",this).call(this),h.Instance.DestroyLayer("music_menu"),h.Instance.DestroyLayer("sfx_menu"),h.Instance.DestroyLayer("sfx_intro")}}]),MainMenu}();function IdentScene_typeof(e){return(IdentScene_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IdentScene_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IdentScene_possibleConstructorReturn(e,t){return!t||"object"!==IdentScene_typeof(t)&&"function"!=typeof t?function IdentScene_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function IdentScene_get(e,t,n){return(IdentScene_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function IdentScene_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=IdentScene_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function IdentScene_getPrototypeOf(e){return(IdentScene_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IdentScene_setPrototypeOf(e,t){return(IdentScene_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}!function MainMenu_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(er,"ScreenState",Object.freeze({Title:1,Intro:2,PlayerSelect:3,DifficultySelect:4,GameLengthSelect:5,CharacterSelect:6}));var tr=function(){function IdentScene(){return function IdentScene_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,IdentScene),IdentScene_possibleConstructorReturn(this,IdentScene_getPrototypeOf(IdentScene).call(this,"IdentScene"))}return function IdentScene_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IdentScene_setPrototypeOf(e,t)}(IdentScene,y),function IdentScene_createClass(e,t,n){return t&&IdentScene_defineProperties(e.prototype,t),n&&IdentScene_defineProperties(e,n),e}(IdentScene,[{key:"init",value:function init(){IdentScene_get(IdentScene_getPrototypeOf(IdentScene.prototype),"init",this).call(this)}},{key:"create",value:function create(){IdentScene_get(IdentScene_getPrototypeOf(IdentScene.prototype),"create",this).call(this),this.spine=this.add.spine(.5*this.scale.width,.5*this.scale.height,"cn_logo","animation"),this.spine.once("spine.complete",this.OnIdentComplete,this),this.world.add(this.spine)}},{key:"update",value:function update(e,t){IdentScene_get(IdentScene_getPrototypeOf(IdentScene.prototype),"update",this).call(this,e,t)}},{key:"OnIdentComplete",value:function OnIdentComplete(){this.time.delayedCall(300,function(){a.Instance.StartScene(er)})}}]),IdentScene}();function Boot_typeof(e){return(Boot_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Boot_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Boot_possibleConstructorReturn(e,t){return!t||"object"!==Boot_typeof(t)&&"function"!=typeof t?function Boot_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function Boot_get(e,t,n){return(Boot_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function Boot_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Boot_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Boot_getPrototypeOf(e){return(Boot_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Boot_setPrototypeOf(e,t){return(Boot_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var nr=function(){function Boot(){var e;return function Boot_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Boot),(e=Boot_possibleConstructorReturn(this,Boot_getPrototypeOf(Boot).call(this,"Boot"))).loading=!1,e.targetAspectRatio=Pr.Instance.maxWidth/Pr.Instance.maxHeight,e.fallbackAspectTimer=.5,e}return function Boot_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Boot_setPrototypeOf(e,t)}(Boot,y),function Boot_createClass(e,t,n){return t&&Boot_defineProperties(e.prototype,t),n&&Boot_defineProperties(e,n),e}(Boot,[{key:"init",value:function init(){Boot_get(Boot_getPrototypeOf(Boot.prototype),"init",this).call(this)}},{key:"preload",value:function preload(){switch(Boot_get(Boot_getPrototypeOf(Boot.prototype),"preload",this).call(this),this.load.image("loading_bar_back",I.GetAssetURL()+"images/loading/loading_bar_back.png"),this.load.image("loading_bar_fill",I.GetAssetURL()+"images/loading/loading_bar_fill.png"),this.load.scenePlugin("SpineCanvasPlugin",I.GetGameDir()+"lib/plugins/SpineCanvasPlugin.js"),this.load.json("assets",I.GetAssetURL()+"data/asset_pack.json"),this.load.json("subtitles",I.GetAssetURL()+"data/subtitles.json"),this.load.json("localisation",I.GetAssetURL()+"data/localisation.json"),this.load.json("config",I.GetGameDir()+"config.json"),this.load.json("domJSON",I.GetAssetURL()+"data/dom_classes.json"),this.gameScale){case 1:this.load.image("loading_background",I.GetAssetURL()+"images/loading/loading_background.png");break;case.75:this.load.image("loading_background",I.GetAssetURL()+"images/loading/loading_background_0_75.png")}}},{key:"create",value:function create(){Boot_get(Boot_getPrototypeOf(Boot.prototype),"create",this).call(this),this.input.on("pointerdown",this.ResumeAudioContext,this),this.game.domContainer.style.position="absolute",this.game.domContainer.style.transformOrigin="left top",this.game.domContainer.style.pointerEvents="none",Pr.Instance.config=this.cache.json.get("config"),Pr.Instance.config.offline&&"serviceWorker"in navigator&&(navigator.serviceWorker.register("service-worker.js",{scope:"./"}).then(function(e){console.log("Service Worker Registered")}),navigator.serviceWorker.ready.then(function(e){console.log("Service Worker Ready")})),v.Instance.SetLocalisationData(this.game.cache.json.get("localisation")),s.Instance.SetSubtitlesData(this.game.cache.json.get("subtitles"),v.Instance.language),b.LoadData(this,"domJSON"),setInterval(function(){this.game.canvas.focus()}.bind(this),1e3)}},{key:"update",value:function update(e,t){if(Boot_get(Boot_getPrototypeOf(Boot.prototype),"update",this).call(this,e,t),!this.loading){if(this.fallbackAspectTimer-=.001*t,(Pr.Instance.isLandscape?this.game.scale.parentSize.aspectRatio>this.targetAspectRatio:this.game.scale.parentSize.aspectRatio<this.targetAspectRatio)&&0<this.fallbackAspectTimer)return;this.loading=!0,a.Instance.StartLoadingScene(O,tr,{additionalAssetBundles:["MainMenu"]})}}},{key:"ResumeAudioContext",value:function ResumeAudioContext(){this.game.sound&&this.game.sound.context&&"suspended"===this.game.sound.context.state&&setTimeout(this.game.sound.context.resume,10)}},{key:"Destroy",value:function Destroy(){Boot_get(Boot_getPrototypeOf(Boot.prototype),"Destroy",this).call(this),this.input.off("pointerdown",this.ResumeAudioContext,this)}}]),Boot}();function Brim_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rr=function(){function Brim(e,t){if(function Brim_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Brim),this.visible=!1,e){var n=this.GetSpec();n&&(this.height=n[0],window.addEventListener("resize",this.OnResize.bind(this)),this.brimElement=document.createElement("div"),this.brimElement.id="brim",t.appendChild(this.brimElement),this.OnResize())}}return function Brim_createClass(e,t,n){return t&&Brim_defineProperties(e.prototype,t),n&&Brim_defineProperties(e,n),e}(Brim,[{key:"GetSpec",value:function GetSpec(){for(var e=[[320,480,2,"iPhone 4"],[320,568,2,"iPhone 5 or 5s"],[375,667,2,"iPhone 6"],[414,736,3,"iPhone 6 plus"]],t=0;t<e.length;t++){var n=e[t];if(window.screen.height==n[0]&&window.screen.width==n[1]||window.screen.width==n[0]&&window.screen.height==n[1])return n}return[Math.min(window.screen.height,window.screen.width),Math.max(window.screen.height,window.screen.width),3,"Unknown device"]}},{key:"ShowBrim",value:function ShowBrim(){this.visible=!0,this.brimElement.style.visibility="visible",this.brimElement.style.height="999999px",this.brimElement.style.pointerEvents="all"}},{key:"ShowGame",value:function ShowGame(){this.visible=!1,this.brimElement.style.visibility="hidden",this.brimElement.style.height=this.height+1+"px",this.brimElement.style.pointerEvents="none"}},{key:"OnResize",value:function OnResize(){window.innerHeight>window.innerWidth||window.innerHeight==this.height?this.ShowGame():this.ShowBrim(),window.scrollTo(0,0)}}]),Brim}();function DeviceManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var or=function(){function DeviceManager(){!function DeviceManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DeviceManager),this.kindle=/Kindle/i.test(platform.ua)||/Silk/i.test(platform.ua),this.ipadOS=navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints,this.iOS="iOS"==platform.os.family||this.ipadOS,this.ipad="iPad"==platform.product||this.ipadOS,this.android="Android"==platform.os.family,this.iphone="iPhone"==platform.product,this.ipad2=this.IsIpad2(),this.disableFullscreen=navigator.userAgent.match(/SM-T280/),this.mobile=this.iOS||this.android||this.kindle,this.desktop=!this.mobile,this.isWKWebView=this.IsWKWebView(),this.displayBrim=this.ShouldDisplayBrim(),this.renderMode=Phaser.CANVAS,this.gameScale=1,this.mobile&&(this.gameScale=.75)}return function DeviceManager_createClass(e,t,n){return t&&DeviceManager_defineProperties(e.prototype,t),n&&DeviceManager_defineProperties(e,n),e}(DeviceManager,[{key:"IsIpad2",value:function IsIpad2(){return"iPad"==platform.product&&1===window.devicePixelRatio&&(768===window.screen.height&&1024===window.screen.width||1024===window.screen.height&&768===window.screen.width)}},{key:"IsWKWebView",value:function IsWKWebView(){return!(!window.webkit||!window.webkit.messageHandlers)}},{key:"ShouldDisplayBrim",value:function ShouldDisplayBrim(){return"iPad"!=platform.product&&!this.isWKWebView&&("iOS"==platform.os.family&&8<parseInt(platform.os.version,10)||-1!=platform.ua.indexOf("like Mac OS X"))&&"standalone"in window.navigator&&!window.navigator.standalone}}]),DeviceManager}();function DeviceOrientationChecker_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ir=function(){function DeviceOrientationChecker(e){!function DeviceOrientationChecker_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DeviceOrientationChecker),this.isValidOrientation=!1,this.isLandscape=e,this.rotateElement=document.createElement("div"),this.rotateElement.id="rotate-screen",this.rotateElement.className="hidden",this.rotateElement.style.textIndent="-100%",this.rotateElement.innerHTML="please rotate your device",I.GetRootElement().appendChild(this.rotateElement),this.onValidOrientation=null,window.addEventListener("resize",this.OnResize.bind(this)),window.addEventListener("orientationchange",this.CheckOrientation.bind(this))}return function DeviceOrientationChecker_createClass(e,t,n){return t&&DeviceOrientationChecker_defineProperties(e.prototype,t),n&&DeviceOrientationChecker_defineProperties(e,n),e}(DeviceOrientationChecker,[{key:"CheckOrientation",value:function CheckOrientation(){var e=this.isValidOrientation;this.isValidOrientation=this.isLandscape?window.innerWidth>window.innerHeight:window.innerWidth<window.innerHeight,this.rotateElement.className=this.isValidOrientation?"hidden":"visible",this.isValidOrientation&&this.onValidOrientation&&this.onValidOrientation.call(),e!=this.isValidOrientation&&(this.isValidOrientation?Pr.Instance.Resume():Pr.Instance.Pause())}},{key:"OnResize",value:function OnResize(){setTimeout(function(){Pr.Instance.deviceOrientationChecker.Resize()},50)}},{key:"Resize",value:function Resize(){var e=window.innerWidth,t=window.innerHeight;this.rotateElement.style.width=e+"px",this.rotateElement.style.height=t+"px",this.CheckOrientation()}}]),DeviceOrientationChecker}(),ar=n(1);function webFontFile_typeof(e){return(webFontFile_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function webFontFile_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function webFontFile_possibleConstructorReturn(e,t){return!t||"object"!==webFontFile_typeof(t)&&"function"!=typeof t?function webFontFile_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function webFontFile_getPrototypeOf(e){return(webFontFile_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function webFontFile_setPrototypeOf(e,t){return(webFontFile_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function eq(e,t){return cr(e)?(t=e).hasOwnProperty("config")?(t.type="webfont",t.url=""):t={key:"webfont",type:"webfont",url:"",config:t}:t={type:"webfont",url:"",key:e,config:t},this.addFile(new lr(this,t)),this}var sr=Phaser.Loader.FILE_POPULATED,lr=function(){function WebFontFile(e,t){return function webFontFile_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WebFontFile),webFontFile_possibleConstructorReturn(this,webFontFile_getPrototypeOf(WebFontFile).call(this,e,t))}return function webFontFile_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&webFontFile_setPrototypeOf(e,t)}(WebFontFile,Phaser.Loader.File),function webFontFile_createClass(e,t,n){return t&&webFontFile_defineProperties(e.prototype,t),n&&webFontFile_defineProperties(e,n),e}(WebFontFile,[{key:"load",value:function load(){if(this.state===sr)this.loader.nextFile(this,!0);else{var e=this.config;e.active=this.onLoad.bind(this),e.inactive=this.onError.bind(this),e.fontactive=this.onFontActive.bind(this),e.fontinactive=this.onFontInactive.bind(this),window.WebFont?window.WebFont.load(e):ar.load(e)}}},{key:"onLoad",value:function onLoad(){this.loader.nextFile(this,!0)}},{key:"onError",value:function onError(){this.loader.nextFile(this,!1)}},{key:"onFontActive",value:function onFontActive(e){this.loader.emit("webfontactive",this,e)}},{key:"onFontInactive",value:function onFontInactive(e){this.loader.emit("webfontinactive",this,e)}}]),WebFontFile}(),cr=Phaser.Utils.Objects.IsPlainObject;function rexwebfontloaderplugin_typeof(e){return(rexwebfontloaderplugin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rexwebfontloaderplugin_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rexwebfontloaderplugin_possibleConstructorReturn(e,t){return!t||"object"!==rexwebfontloaderplugin_typeof(t)&&"function"!=typeof t?function rexwebfontloaderplugin_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function rexwebfontloaderplugin_getPrototypeOf(e){return(rexwebfontloaderplugin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rexwebfontloaderplugin_setPrototypeOf(e,t){return(rexwebfontloaderplugin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var ur=function(){function WebFontLoaderPlugin(e){var t;return function rexwebfontloaderplugin_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,WebFontLoaderPlugin),t=rexwebfontloaderplugin_possibleConstructorReturn(this,rexwebfontloaderplugin_getPrototypeOf(WebFontLoaderPlugin).call(this,e)),e.registerFileType("rexWebFont",eq),t}return function rexwebfontloaderplugin_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rexwebfontloaderplugin_setPrototypeOf(e,t)}(WebFontLoaderPlugin,Phaser.Plugins.BasePlugin),function rexwebfontloaderplugin_createClass(e,t,n){return t&&rexwebfontloaderplugin_defineProperties(e.prototype,t),n&&rexwebfontloaderplugin_defineProperties(e,n),e}(WebFontLoaderPlugin,[{key:"addToScene",value:function addToScene(e){e.sys.load.rexWebFont=eq}}]),WebFontLoaderPlugin}();function phaser_matter_collision_plugin_typeof(e){return(phaser_matter_collision_plugin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function phaser_matter_collision_plugin_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function phaser_matter_collision_plugin_getPrototypeOf(e){return(phaser_matter_collision_plugin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function phaser_matter_collision_plugin_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function phaser_matter_collision_plugin_setPrototypeOf(e,t){return(phaser_matter_collision_plugin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function getRootBody(e){for(;e.parent!==e;)e=e.parent;return e}function isPhysicsObject(e){return function isMatterBody(e){return e.hasOwnProperty("collisionFilter")&&e.hasOwnProperty("parts")&&e.hasOwnProperty("slop")}(e)||e.body||e instanceof Phaser.Tilemaps.Tile}function warnInvalidObject(e){console.warn("Expected a Matter body, Tile or an object with a body property, but instead, recieved: ".concat(e))}var pr=function(){function MatterCollisionPlugin(e,t){var n;return function phaser_matter_collision_plugin_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MatterCollisionPlugin),(n=function phaser_matter_collision_plugin_possibleConstructorReturn(e,t){return!t||"object"!==phaser_matter_collision_plugin_typeof(t)&&"function"!=typeof t?phaser_matter_collision_plugin_assertThisInitialized(e):t}(this,phaser_matter_collision_plugin_getPrototypeOf(MatterCollisionPlugin).call(this,e,t))).scene=e,n.events=new Phaser.Events.EventEmitter,n.collisionStartListeners=new Map,n.collisionEndListeners=new Map,n.collisionActiveListeners=new Map,n.onCollisionStart=n.onCollisionEvent.bind(phaser_matter_collision_plugin_assertThisInitialized(n),n.collisionStartListeners,"collisionstart"),n.onCollisionEnd=n.onCollisionEvent.bind(phaser_matter_collision_plugin_assertThisInitialized(n),n.collisionEndListeners,"collisionend"),n.onCollisionActive=n.onCollisionEvent.bind(phaser_matter_collision_plugin_assertThisInitialized(n),n.collisionActiveListeners,"collisionactive"),n.scene.events.once("start",n.start,phaser_matter_collision_plugin_assertThisInitialized(n)),n.scene.events.once("destroy",n.destroy,phaser_matter_collision_plugin_assertThisInitialized(n)),n}return function phaser_matter_collision_plugin_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&phaser_matter_collision_plugin_setPrototypeOf(e,t)}(MatterCollisionPlugin,Phaser.Plugins.ScenePlugin),function phaser_matter_collision_plugin_createClass(e,t,n){return t&&phaser_matter_collision_plugin_defineProperties(e.prototype,t),n&&phaser_matter_collision_plugin_defineProperties(e,n),e}(MatterCollisionPlugin,[{key:"addOnCollideStart",value:function addOnCollideStart(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.objectA,r=t.objectB,o=t.callback,i=t.context;return this.addOnCollide(this.collisionStartListeners,n,r,o,i),this.removeOnCollideStart.bind(this,{objectA:n,objectB:r,callback:o,context:i})}},{key:"addOnCollideEnd",value:function addOnCollideEnd(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.objectA,r=t.objectB,o=t.callback,i=t.context;return this.addOnCollide(this.collisionEndListeners,n,r,o,i),this.removeOnCollideEnd.bind(this,{objectA:n,objectB:r,callback:o,context:i})}},{key:"addOnCollideActive",value:function addOnCollideActive(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.objectA,r=t.objectB,o=t.callback,i=t.context;return this.addOnCollide(this.collisionActiveListeners,n,r,o,i),this.removeOnCollideActive.bind(this,{objectA:n,objectB:r,callback:o,context:i})}},{key:"removeOnCollideStart",value:function removeOnCollideStart(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.objectA,r=t.objectB,o=t.callback,i=t.context;this.removeOnCollide(this.collisionStartListeners,n,r,o,i)}},{key:"removeOnCollideEnd",value:function removeOnCollideEnd(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.objectA,r=t.objectB,o=t.callback,i=t.context;this.removeOnCollide(this.collisionEndListeners,n,r,o,i)}},{key:"removeOnCollideActive",value:function removeOnCollideActive(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.objectA,r=t.objectB,o=t.callback,i=t.context;this.removeOnCollide(this.collisionActiveListeners,n,r,o,i)}},{key:"removeAllCollideStartListeners",value:function removeAllCollideStartListeners(){this.collisionStartListeners.clear()}},{key:"removeAllCollideActiveListeners",value:function removeAllCollideActiveListeners(){this.collisionActiveListeners.clear()}},{key:"removeAllCollideEndListeners",value:function removeAllCollideEndListeners(){this.collisionEndListeners.clear()}},{key:"removeAllCollideListeners",value:function removeAllCollideListeners(){this.removeAllCollideStartListeners(),this.removeAllCollideActiveListeners(),this.removeAllCollideEndListeners()}},{key:"addOnCollide",value:function addOnCollide(n,e,t,r,o){var i=this;if(r&&"function"==typeof r){var a=Array.isArray(e)?e:[e],s=Array.isArray(t)?t:[t];a.forEach(function(t){s.forEach(function(e){i.addOnCollideObjectVsObject(n,t,e,r,o)})})}else console.warn("No valid callback specified. Received: ".concat(r))}},{key:"removeOnCollide",value:function removeOnCollide(n,e,r,o,i){var t=Array.isArray(e)?e:[e],a=Array.isArray(r)?r:[r];t.forEach(function(e){if(r){var t=(n.get(e)||[]).filter(function(e){return!(a.includes(e.target)&&(!o||e.callback===o)&&(!i||e.context===i))});0<t.length?n.set(e,t):n.delete(e)}else n.delete(e)})}},{key:"addOnCollideObjectVsObject",value:function addOnCollideObjectVsObject(e,t,n,r,o){if(t&&isPhysicsObject(t))if(!n||isPhysicsObject(n)){var i=e.get(t)||[];i.push({target:n,callback:r,context:o}),e.set(t,i)}else warnInvalidObject(t);else warnInvalidObject(t)}},{key:"onCollisionEvent",value:function onCollisionEvent(a,e,t){var s=this,l=t.pairs,c="pair"+e,u={},p={isReversed:!0};l.map(function(e,t){var n=e.bodyA,r=e.bodyB,o=getRootBody(n).gameObject,i=getRootBody(r).gameObject;o&&o.tile&&(o=o.tile),i&&i.tile&&(i=i.tile),l[t].gameObjectA=o,l[t].gameObjectB=i,u.bodyA=n,u.bodyB=r,u.gameObjectA=o,u.gameObjectB=i,u.pair=e,s.events.emit(c,u),a.size&&(p.bodyB=n,p.bodyA=r,p.gameObjectB=o,p.gameObjectA=i,p.pair=e,s.checkPairAndEmit(a,n,r,i,u),s.checkPairAndEmit(a,r,n,o,p),o&&s.checkPairAndEmit(a,o,r,i,u),i&&s.checkPairAndEmit(a,i,n,o,p))}),this.events.emit(e,t)}},{key:"checkPairAndEmit",value:function checkPairAndEmit(e,t,o,i,a){var n=e.get(t);n&&n.forEach(function(e){var t=e.target,n=e.callback,r=e.context;t&&t!==o&&t!==i||n.call(r,a)})}},{key:"subscribeMatterEvents",value:function subscribeMatterEvents(){var e=this.scene.matter;e&&e.world?(e.world.on("collisionstart",this.onCollisionStart),e.world.on("collisionactive",this.onCollisionActive),e.world.on("collisionend",this.onCollisionEnd)):console.warn("Plugin requires matter!")}},{key:"unsubscribeMatterEvents",value:function unsubscribeMatterEvents(){var e=this.scene.matter;e&&e.world&&(e.world.off("collisionstart",this.onCollisionStart),e.world.off("collisionactive",this.onCollisionActive),e.world.off("collisionend",this.onCollisionEnd))}},{key:"start",value:function start(){this.scene.events.off("shutdown",this.shutdown,this),this.scene.events.on("shutdown",this.shutdown,this),this.subscribeMatterEvents()}},{key:"shutdown",value:function shutdown(){this.removeAllCollideListeners(),this.unsubscribeMatterEvents(),this.scene.events.once("start",this.start,this)}},{key:"destroy",value:function destroy(){this.scene.events.off("start",this.start,this),this.scene.events.off("shutdown",this.shutdown,this),this.removeAllCollideListeners(),this.unsubscribeMatterEvents(),this.scene=void 0}}]),MatterCollisionPlugin}(),hr=function murmurhash3_32_gc(e,t){var n,r,o,i,a,s,l,c;for(n=3&e.length,r=e.length-n,o=t,a=3432918353,s=461845907,c=0;c<r;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,o=27492+(65535&(i=5*(65535&(o=(o^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|o>>>19))+((5*(o>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:o^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(c)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return o^=e.length,o=2246822507*(65535&(o^=o>>>16))+((2246822507*(o>>>16)&65535)<<16)&4294967295,o=3266489909*(65535&(o^=o>>>13))+((3266489909*(o>>>16)&65535)<<16)&4294967295,(o^=o>>>16)>>>0};function NineSlice_typeof(e){return(NineSlice_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NineSlice_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NineSlice_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NineSlice_get(e,t,n){return(NineSlice_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var r=function NineSlice_superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=NineSlice_getPrototypeOf(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function NineSlice_getPrototypeOf(e){return(NineSlice_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NineSlice_setPrototypeOf(e,t){return(NineSlice_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function lq(e){return{tl:{x:e.topLeft.width,y:e.topLeft.height},tr:{x:e.topRight.width,y:e.topRight.height},bl:{x:e.bottomLeft.width,y:e.bottomLeft.height},br:{x:e.bottomRight.width,y:e.bottomRight.height}}}var yr="updatesafebounds",fr=function(){function NineSlice(e,t){var n,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;!function NineSlice_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,NineSlice),(n=function NineSlice_possibleConstructorReturn(e,t){return!t||"object"!==NineSlice_typeof(t)&&"function"!=typeof t?NineSlice_assertThisInitialized(e):t}(this,NineSlice_getPrototypeOf(NineSlice).call(this,e,0,0,32,32))).initFrames=n.initFrames.bind(NineSlice_assertThisInitialized(n)),n.getUsableBounds=n.getUsableBounds.bind(NineSlice_assertThisInitialized(n)),n.drawFrames=n.drawFrames.bind(NineSlice_assertThisInitialized(n)),n.resize=n.resize.bind(NineSlice_assertThisInitialized(n)),n.updateSafeBounds=n.updateSafeBounds.bind(NineSlice_assertThisInitialized(n)),n.enableDebugDraw=n.enableDebugDraw.bind(NineSlice_assertThisInitialized(n)),n.events=new Phaser.Events.EventEmitter,n.sliceConfig=function defaultSliceConfig(e){var t=e;if("number"==typeof t.sourceLayout.width){var n=t.sourceLayout,r=n.width,o=n.height;t.sourceLayout={topLeft:{width:r,height:o}}}var i=t.sourceLayout;i.topRight=i.topRight||i.topLeft,i.bottomRight=i.bottomRight||i.topLeft,i.bottomLeft=i.bottomLeft||i.topLeft;var a=Math.max(i.topLeft.height,i.topRight.height),s=Math.max(i.topRight.width,i.bottomRight.width),l=Math.max(i.bottomLeft.height,i.bottomRight.height),c=Math.max(i.topLeft.width,i.bottomLeft.width);if(t.safeOffsets||(t.safeOffsets={top:a,right:s,bottom:l,left:c}),void 0===t.minSizing||!1!==t.minSizing){var u=t.safeOffsets;t.minSizing={width:u?Math.max(u.left+u.right,c+s):c+s,height:u?Math.max(u.top+u.bottom,a+l):a+l}}else t.minSizing=!1;return t}(t),n._safeBounds=new Phaser.Geom.Rectangle;var o=n.sliceConfig,i=o.sourceKey,a=o.sourceFrame;if(n.sourceTex=e.sys.textures.get(n.sliceConfig.sourceKey),!i)throw new Error("NineSlice requires a texture sourceKey to be specified.");if(!n.sourceTex||"__MISSING"===n.sourceTex.key)throw new Error("Expected source image ".concat(i," not found."));n._framePrefix="".concat(hr(JSON.stringify({sourceKey:i,sourceFrame:a},404))),n.mkFrameName=function(e){return"".concat(n._framePrefix,"-").concat(e)},n._frameCache={};var s="string"==typeof a||"number"==typeof a?a:"__BASE";n.sourceFrame=n.sourceTex.get(s),n.initFrames(),n._initalized=!0;var l=r.x,c=r.y,u=r.width,p=r.height;return n.setPosition(l||0,c||0),n.resize(u||n.sourceFrame.width,p||n.sourceFrame.height),n.updateSafeBounds(),n}return function NineSlice_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NineSlice_setPrototypeOf(e,t)}(NineSlice,Phaser.GameObjects.RenderTexture),function NineSlice_createClass(e,t,n){return t&&NineSlice_defineProperties(e.prototype,t),n&&NineSlice_defineProperties(e,n),e}(NineSlice,[{key:"updateSafeBounds",value:function updateSafeBounds(){if(this._initalized){var e=this.sliceConfig.safeOffsets,t=e.top,n=e.right,r=e.bottom,o=e.left,i=this.x+o,a=this.y+t,s=this.width-(o+n),l=this.height-(t+r),c=this._safeBounds,u=c.x,p=c.y,h=c.width,y=c.height;i===u&&a===p&&s===h&&l===y||(this._safeBounds.setTo(this.x+o,this.y+t,this.width-(o+n),this.height-(t+r)),this.events.emit(yr,this,this._safeBounds)),this._g&&(this._g.lineStyle(1,65280),this._g.strokeRectShape(this._safeBounds))}}},{key:"resize",value:function resize(e,t){var n=(this.sliceConfig||{}).minSizing,r=n?Math.max(n.height,t):t,o=n?Math.max(n.width,e):e;if(t<r||e<o){var i="Attempted to set NineSlice size less than minimum (".concat(e,"x").concat(t,").");console.error(i)}NineSlice_get(NineSlice_getPrototypeOf(NineSlice.prototype),"resize",this).call(this,o,r),this._initalized&&(this._g&&this._g.clear(),this.drawFrames(),this.updateSafeBounds())}},{key:"initFrames",value:function initFrames(){function $5b(e,t,n,r,o){var i=a.mkFrameName(e);s.has(i)?a._frameCache[e]=s.frames[i]:a._frameCache[e]=s.add(i,0,l+t,c+n,r,o)}var a=this,s=this.sourceTex,e=this.sourceFrame.width,t=this.sourceFrame.height,l=this.sourceFrame.cutX,c=this.sourceFrame.cutY,n=lq(this.sliceConfig.sourceLayout);$5b("topLeft",0,0,n.tl.x,n.tl.y),$5b("topRight",e-n.tr.x,0,n.tr.x,n.tr.y),$5b("bottomRight",e-n.br.x,t-n.br.y,n.br.x,n.br.y),$5b("bottomLeft",0,t-n.bl.y,n.bl.x,n.bl.y),$5b("topMiddle",n.tl.x,0,e-(n.tl.x+n.tr.x),Math.max(n.tl.y,n.tr.y)),$5b("bottomMiddle",n.bl.x,t-Math.max(n.bl.y,n.br.y),e-(n.bl.x+n.br.x),Math.max(n.bl.y,n.br.y)),$5b("leftMiddle",0,n.tl.y,Math.max(n.tl.x,n.bl.x),t-(n.tl.y+n.bl.y)),$5b("rightMiddle",e-Math.max(n.tr.x,n.br.x),n.tr.y,Math.max(n.tr.x,n.br.x),t-n.tr.y-n.br.y);var r=Math.min(n.tl.x,n.bl.x),o=Math.min(n.tl.y,n.tr.y);$5b("center",r,o,e-r-Math.min(n.tr.x,n.br.x),t-o-Math.min(n.br.y,n.bl.y))}},{key:"getUsableBounds",value:function getUsableBounds(){return this._initalized?this._safeBounds:null}},{key:"drawFrames",value:function drawFrames(){var l=this;if(this._initalized){this._g&&this._g.lineStyle(1,16711680);var e=lq(this.sliceConfig.sourceLayout),t=this._frameCache,n=function draw(e,t,n,r,o){if(0<r&&0<o){l._g&&l._g.strokeRect(l.x+t,l.y+n,r,o);var i=l.scene.make.image({key:l.sourceTex.key,frame:e.name,x:0,y:0}),a=r/e.width,s=o/e.height;i.setOrigin(0).setScale(a,s),l.draw(i,t,n),i.destroy()}},r=Math.min(e.tl.x,e.bl.x),o=Math.min(e.tr.x,e.br.x),i=Math.min(e.tl.y,e.tr.y),a=Math.min(e.bl.y,e.br.y);this.clear(),n(t.center,r,i,this.width-r-o,this.height-i-a),n(t.topMiddle,e.tl.x,0,this.width-e.tl.x-e.tr.x,t.topMiddle.height),n(t.bottomMiddle,e.bl.x,this.height-t.bottomMiddle.height,this.width-e.bl.x-e.br.x,t.bottomMiddle.height),n(t.leftMiddle,0,e.tl.y,t.leftMiddle.width,this.height-e.tl.y-e.bl.y),n(t.rightMiddle,this.width-e.tr.x,e.tr.y,t.rightMiddle.width,this.height-e.tr.y-e.br.y),n(t.topLeft,0,0,e.tl.x,e.tl.y),n(t.topRight,this.width-e.tr.x,0,e.tr.x,e.tr.y),n(t.bottomRight,this.width-e.br.x,this.height-e.br.y,e.br.x,e.br.y),n(t.bottomLeft,0,this.height-e.bl.y,e.bl.x,e.bl.y)}}},{key:"enableDebugDraw",value:function enableDebugDraw(e){var t=!(0<arguments.length&&void 0!==e)||e;this._g&&this._g.clear(),this._g=t?this.scene.add.graphics(this.x,this.y):null,this.drawFrames(),this.updateSafeBounds()}},{key:"y",get:function get(){return this._y},set:function set(e){this._y!==e&&(this._g&&(this._g.clear(),this.drawFrames()),this._y=e,this.updateSafeBounds())}},{key:"x",get:function get(){return this._x},set:function set(e){this._x!==e&&(this._g&&(this._g.clear(),this.drawFrames()),this._x=e,this.updateSafeBounds())}}]),NineSlice}(),dr=function processsOffsetArray(e){switch(e.length){case 1:return[e[0],e[0],e[0],e[0]];case 2:return[e[0],e[1],e[0],e[1]];case 3:return[e[0],e[1],e[2],e[1]];case 4:return e}throw new Error("Received ${arr.length} offset values, expected 1 to 4.")};function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Plugin_typeof(e){return(Plugin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Plugin_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Plugin_possibleConstructorReturn(e,t){return!t||"object"!==Plugin_typeof(t)&&"function"!=typeof t?function Plugin_assertThisInitialized(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function Plugin_getPrototypeOf(e){return(Plugin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Plugin_setPrototypeOf(e,t){return(Plugin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}var gr=function(){function Plugin(e){var t;return function Plugin_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Plugin),t=Plugin_possibleConstructorReturn(this,Plugin_getPrototypeOf(Plugin).call(this,e)),e.registerGameObject("nineslice",t.addNineSlice,t.makeNineSlice),t}return function Plugin_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Plugin_setPrototypeOf(e,t)}(Plugin,Phaser.Plugins.BasePlugin),function Plugin_createClass(e,t,n){return t&&Plugin_defineProperties(e.prototype,t),n&&Plugin_defineProperties(e,n),e}(Plugin,[{key:"addNineSlice",value:function addNineSlice(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=mr(this.scene,t);return this.displayList.add(r),r}},{key:"makeNineSlice",value:function makeNineSlice(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return mr(this.scene,t)}}]),Plugin}(),mr=function mkNineSlice(e,t){if(2===t.length)return new fr(e,t[0],t[1]);if(t.length<6)throw new Error("Expected at least 6 arguments to NineSlice creator, received ".concat(t.length,"."));7<t.length&&console.error("Expected less than 7 arguments for NineSlice creation, received ".concat(t.length,"."));var n=_slicedToArray(t,6),r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=n[5],c={},u={x:r,y:o,width:i,height:a};if("string"==typeof s)c.sourceKey=s;else{var p=s.key,h=s.frame;c.sourceKey=p,"string"!=typeof h&&"number"!=typeof h||(c.sourceFrame=s.frame)}if("number"==typeof l)c.sourceLayout={width:l,height:l};else if(Array.isArray(l)){var y=_slicedToArray(dr(l),4),f=y[0],d=y[1],g=y[2],m=y[3];c.sourceLayout={topLeft:{width:m,height:f},topRight:{width:d,height:f},bottomRight:{width:d,height:g},bottomLeft:{width:m,height:g}}}else c.sourceLayout=l;if(6<t.length)if("number"==typeof t[6]){var _=t[6];c.safeOffsets={top:_,right:_,bottom:_,left:_}}else{if(!Array.isArray(t[6]))throw new Error("Expected argument number or array for argument 7, got ".concat(Plugin_typeof(t[6]),"."));var P=_slicedToArray(dr(t[6]),4),b=P[0],S=P[1],O=P[2],v=P[3];c.safeOffsets={top:b,right:S,bottom:O,left:v}}return new fr(e,c,u)},_r={key:"NineSlice",plugin:gr,start:!0};function GameManager_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}gr.DefaultCfg=_r;var Pr=function(){function GameManager(){!function GameManager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GameManager),(GameManager.Instance=this).config=null,this.maxHeight=720,this.maxWidth=1800,this.isLandscape=this.maxWidth>this.maxHeight,this.LoadStylesheets(),this.deviceManager=new or,this.brim=new rr(this.deviceManager.displayBrim,I.GetRootElement()),this.deviceOrientationChecker=new ir(this.isLandscape),this.deviceOrientationChecker.onValidOrientation=this.OnValidOrientation.bind(this),this.deviceOrientationChecker.CheckOrientation()}return function GameManager_createClass(e,t,n){return t&&GameManager_defineProperties(e.prototype,t),n&&GameManager_defineProperties(e,n),e}(GameManager,[{key:"LoadStylesheets",value:function LoadStylesheets(){var e=document.getElementsByTagName("head")[0],t="css/main.css";this.cacheBust&&(t+="?bust="+this.dateTime);var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=I.GetAssetURL()+t,e.appendChild(n),t="css/game.css",this.cacheBust&&(t+="?bust="+this.dateTime),(n=document.createElement("link")).type="text/css",n.rel="stylesheet",n.href=I.GetAssetURL()+t,e.appendChild(n)}},{key:"OnValidOrientation",value:function OnValidOrientation(){this.brim.visible||(this.StartGame(),this.deviceOrientationChecker.onValidOrientation=null)}},{key:"StartGame",value:function StartGame(){var e=document.createElement("div");e.id="stage-container",I.GetRootElement().appendChild(e);var t=this.isLandscape?Phaser.Structs.Size.HEIGHT_CONTROLS_WIDTH:Phaser.Structs.Size.WIDTH_CONTROLS_HEIGHT;this.game=new r({banner:!1,type:this.deviceManager.renderMode,gameScale:this.deviceManager.gameScale,parent:e.id,fullscreenTarget:I.GetRootElement(),scale:{mode:t,autoCenter:Phaser.Scale.CENTER_BOTH,width:this.maxWidth*this.deviceManager.gameScale,height:this.maxHeight*this.deviceManager.gameScale,autoRound:!0},render:{antialias:!0,pixelArt:!1,roundPixels:!1,transparent:!1},dom:{createContainer:!0},input:{gamepad:!0,activePointers:3},plugins:{global:[{key:"WebFontLoader",plugin:ur,start:!0},gr.DefaultCfg],scene:[{plugin:pr,key:"matterCollision",mapping:"matterCollision"}]},physics:{default:"matter",matter:{debug:!0,debugShowInternalEdges:!1,debugShowConvexHulls:!1,runner:{isFixed:!0}}},audio:{noAudio:!0},scene:[nr]}),this.game.plugins.install("SaveDataManager",p,!0),this.game.plugins.install("SceneManager",a,!0),this.game.plugins.install("AssetManager",P,!0),this.game.plugins.install("AudioManager",h,!0),this.game.plugins.install("AccessibilityManager",s,!0),this.game.plugins.install("LocalisationManager",v,!0)}},{key:"Pause",value:function Pause(){a.Instance&&a.Instance.PauseAllScenes()}},{key:"Resume",value:function Resume(){a.Instance&&a.Instance.ResumeAllScenes()}},{key:"LoadAppLink",value:function LoadAppLink(){window.open("https://geoip.turner-apps.com/gumballsamazingparty-trophychallenge")}}]),GameManager}();new Pr}]);