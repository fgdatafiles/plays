(function(Pg){function r(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function w(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=Wg++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var F=function(){};F.__name__=["HxOverrides"];F.cca=function(a,
b){var c=a.charCodeAt(b);return c!=c?void 0:c};F.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};F.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};F.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var x=function(){};x.__name__=["Main"];x.main=function(){x.init()};x.validateBrowser=function(){var a=document.createElement("canvas");
if(null==a.getContext||null==a.getContext("2d").fillText)return!1;a=window.audioContextInstance;return p.isMobile()&&null==a?!1:!0};x.validateCookies=function(){return null!=Ya.getLocalStorage()&&null!=Ya.getSessionStorage()&&null!=navigator.cookieEnabled&&navigator.cookieEnabled};x.init=function(){if(x.validateBrowser())if(x.validateCookies()){x.container=x.getDocument().createElement("div");window.tabindex="0";x.container.style.position="relative";x.container.className="container";window.document.body.appendChild(x.container);
var a=x.getWindow().location.href,a=x.getQueryStringValue(a,"locale");""==a&&(a="en-us");x.dataLocale=a;x.root=new p("scooby_doo_good_animal",1024,1024);x.root.addGameState(new Vd);x.root.init();window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){a=p.isMobile()?x.TARGET_FPS_MOBILE:x.TARGET_FPS;window.setTimeout(x.update,1E3/a)};x.update()}else window.location.href="cookies.html";else window.location.href="unsupported.html"};x.getQueryStringValue=
function(a,b){var c=a.split("?");if(2>c.length)return"";for(var c=c[1].split("&"),d=0,e=c.length;d<e;){var f=d++;if(Hb.startsWith(c[f],b)&&(f=c[f].split("="),!(2>f.length)))return f[1]}return""};x.update=function(){x.root.processFrame();"1"==R.getProperty("debugDraw")&&x.root.debugRender();window.requestAnimFrame(x.update)};x.getDocument=function(){return window.document};x.getWindow=function(){return window};x.getCanvas=function(){return x.canvas};x.getContainer=function(){return x.container};x.getBasePath=
function(){for(var a=window.location.href.split("/"),b="",c=0,d=a.length-1;c<d;)var e=c++,b=b+(a[e]+"/");return b};Math.__name__=["Math"];var xa=function(){};xa.__name__=["Reflect"];xa.field=function(a,b){try{return a[b]}catch(c){return null}};xa.setProperty=function(a,b,c){var d,e;e=a.__properties__?d=a.__properties__["set_"+b]:!1;if(e)a[d](c);else a[b]=c};xa.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&("hx__closures__"!=d&&c.call(a,d))&&
b.push(d)}return b};xa.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};xa.compareMethods=function(a,b){return a==b?!0:xa.isFunction(a)&&xa.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};var ga=function(){};ga.__name__=["Std"];ga.string=function(a){return y.__string_rec(a,"")};ga.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=F.cca(a,1)&&88!=F.cca(a,1)||(b=parseInt(a));return isNaN(b)?null:b};var ec=function(){this.b=""};ec.__name__=
["StringBuf"];ec.prototype={__class__:ec};var Hb=function(){};Hb.__name__=["StringTools"];Hb.startsWith=function(a,b){return a.length>=b.length?F.substr(a,0,b.length)==b:!1};Hb.replace=function(a,b,c){return a.split(b).join(c)};var hb=function(){};hb.__name__=["Type"];hb.getClassName=function(a){a=a.__name__;return null==a?null:a.join(".")};hb.createEnum=function(a,b,c){var d=xa.field(a,b);if(null==d)throw new H("No such constructor "+b);if(xa.isFunction(d)){if(null==c)throw new H("Constructor "+
b+" need parameters");return d.apply(a,c)}if(null!=c&&0!=c.length)throw new H("Constructor "+b+" does not need parameters");return d};hb.createEnumIndex=function(a,b,c){var d=a.__constructs__[b];if(null==d)throw new H(b+" is not a valid enum constructor index");return hb.createEnum(a,d,c)};var A=function(a){this.nodeType=a;this.children=[];this.attributeMap=new Ba};A.__name__=["Xml"];A.parse=function(a){return Ib.parse(a)};A.createElement=function(a){var b=new A(A.Element);if(b.nodeType!=A.Element)throw new H("Bad node type, expected Element but found "+
b.nodeType);b.nodeName=a;return b};A.createPCData=function(a){var b=new A(A.PCData);if(b.nodeType==A.Document||b.nodeType==A.Element)throw new H("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};A.createCData=function(a){var b=new A(A.CData);if(b.nodeType==A.Document||b.nodeType==A.Element)throw new H("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};A.createComment=function(a){var b=new A(A.Comment);if(b.nodeType==A.Document||b.nodeType==A.Element)throw new H("Bad node type, unexpected "+
b.nodeType);b.nodeValue=a;return b};A.createDocType=function(a){var b=new A(A.DocType);if(b.nodeType==A.Document||b.nodeType==A.Element)throw new H("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};A.createProcessingInstruction=function(a){var b=new A(A.ProcessingInstruction);if(b.nodeType==A.Document||b.nodeType==A.Element)throw new H("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};A.createDocument=function(){return new A(A.Document)};A.prototype={get:function(a){if(this.nodeType!=
A.Element)throw new H("Bad node type, expected Element but found "+this.nodeType);var b=this.attributeMap;return null!=N[a]?b.getReserved(a):b.h[a]},set:function(a,b){if(this.nodeType!=A.Element)throw new H("Bad node type, expected Element but found "+this.nodeType);var c=this.attributeMap;null!=N[a]?c.setReserved(a,b):c.h[a]=b},exists:function(a){if(this.nodeType!=A.Element)throw new H("Bad node type, expected Element but found "+this.nodeType);var b=this.attributeMap;return null!=N[a]?b.existsReserved(a):
b.h.hasOwnProperty(a)},elementsNamed:function(a){if(this.nodeType!=A.Document&&this.nodeType!=A.Element)throw new H("Bad node type, expected Element or Document but found "+this.nodeType);for(var b=[],c=0,d=this.children;c<d.length;){var e=d[c];++c;var f;if(e.nodeType==A.Element){if(e.nodeType!=A.Element)throw new H("Bad node type, expected Element but found "+e.nodeType);f=e.nodeName==a}else f=!1;f&&b.push(e)}return F.iter(b)},addChild:function(a){if(this.nodeType!=A.Document&&this.nodeType!=A.Element)throw new H("Bad node type, expected Element or Document but found "+
this.nodeType);null!=a.parent&&a.parent.removeChild(a);this.children.push(a);a.parent=this},removeChild:function(a){if(this.nodeType!=A.Document&&this.nodeType!=A.Element)throw new H("Bad node type, expected Element or Document but found "+this.nodeType);return F.remove(this.children,a)?(a.parent=null,!0):!1},__class__:A};var Za=function(){this.lowerBound=new t;this.upperBound=new t};Za.__name__=["box2D","collision","B2AABB"];Za.prototype={isValid:function(){var a=this.upperBound.y-this.lowerBound.y;
return a=(a=0<=this.upperBound.x-this.lowerBound.x&&0<=a)&&this.lowerBound.isValid()?this.upperBound.isValid():!1},getCenter:function(){return new t((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},getExtents:function(){return new t((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},contains:function(a){var b;return b=(b=(b=(b=this.lowerBound.x<=a.lowerBound.x)?this.lowerBound.y<=a.lowerBound.y:!1)?a.upperBound.x<=this.upperBound.x:!1)?
a.upperBound.y<=this.upperBound.y:!1},rayCast:function(a,b){var c=-Number.MAX_VALUE,d=Number.MAX_VALUE,e=b.p1.x,f=b.p1.y,g=b.p2.x-b.p1.x,k=b.p2.y-b.p1.y,h=Math.abs(g),l=Math.abs(k),P=a.normal;if(h<Number.MIN_VALUE){if(e<this.lowerBound.x||this.upperBound.x<e)return!1}else if(h=1/g,g=(this.lowerBound.x-e)*h,e=(this.upperBound.x-e)*h,h=-1,g>e&&(h=g,g=e,e=h,h=1),g>c&&(P.x=h,P.y=0,c=g),d=Math.min(d,e),c>d)return!1;if(l<Number.MIN_VALUE){if(f<this.lowerBound.y||this.upperBound.y<f)return!1}else if(h=1/
k,g=(this.lowerBound.y-f)*h,e=(this.upperBound.y-f)*h,h=-1,g>e&&(h=g,g=e,e=h,h=1),g>c&&(P.y=h,P.x=0,c=g),d=Math.min(d,e),c>d)return!1;a.fraction=c;return!0},testOverlap:function(a){var b=a.lowerBound.y-this.upperBound.y,c=this.lowerBound.y-a.upperBound.y;return 0<a.lowerBound.x-this.upperBound.x||0<b||0<this.lowerBound.x-a.upperBound.x||0<c?!1:!0},combine:function(a,b){this.lowerBound.x=Math.min(a.lowerBound.x,b.lowerBound.x);this.lowerBound.y=Math.min(a.lowerBound.y,b.lowerBound.y);this.upperBound.x=
Math.max(a.upperBound.x,b.upperBound.x);this.upperBound.y=Math.max(a.upperBound.y,b.upperBound.y)},__class__:Za};var t=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};t.__name__=["box2D","common","math","B2Vec2"];t.make=function(a,b){return new t(a,b)};t.prototype={setZero:function(){this.y=this.x=0},set:function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b},setV:function(a){this.x=a.x;this.y=a.y},getNegative:function(){return new t(-this.x,-this.y)},negativeSelf:function(){this.x=
-this.x;this.y=-this.y},copy:function(){return new t(this.x,this.y)},add:function(a){this.x+=a.x;this.y+=a.y},subtract:function(a){this.x-=a.x;this.y-=a.y},multiply:function(a){this.x*=a;this.y*=a},mulM:function(a){var b=this.x;this.x=a.col1.x*b+a.col2.x*this.y;this.y=a.col1.y*b+a.col2.y*this.y},mulTM:function(a){var b=q.dot(this,a.col1);this.y=q.dot(this,a.col2);this.x=b},crossVF:function(a){var b=this.x;this.x=a*this.y;this.y=-a*b},crossFV:function(a){var b=this.x;this.x=-a*this.y;this.y=a*b},minV:function(a){this.x=
this.x<a.x?this.x:a.x;this.y=this.y<a.y?this.y:a.y},maxV:function(a){this.x=this.x>a.x?this.x:a.x;this.y=this.y>a.y?this.y:a.y},abs:function(){0>this.x&&(this.x=-this.x);0>this.y&&(this.y=-this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSquared:function(){return this.x*this.x+this.y*this.y},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var b=1/a;this.x*=b;this.y*=b;return a},isValid:function(){return q.isValid(this.x)?
q.isValid(this.y):!1},__class__:t};var Wd=function(){this.v=new t;this.id=new Dc};Wd.__name__=["box2D","collision","ClipVertex"];Wd.prototype={set:function(a){this.v.setV(a.v);this.id.set(a.id)},__class__:Wd};var Dc=function(){this.features=new vf;this.features._m_id=this};Dc.__name__=["box2D","collision","B2ContactID"];Dc.prototype={set:function(a){this.set_key(a._key)},copy:function(){var a=new Dc;a.set_key(this.get_key());return a},get_key:function(){return this._key},set_key:function(a){this._key=
a;this.features._referenceEdge=this._key&255;this.features._incidentEdge=(this._key&65280)>>8&255;this.features._incidentVertex=(this._key&16711680)>>16&255;this.features._flip=(this._key&-16777216)>>24&255;return this._key},__class__:Dc,__properties__:{set_key:"set_key",get_key:"get_key"}};var vf=function(){};vf.__name__=["box2D","collision","Features"];vf.prototype={get_referenceEdge:function(){return this._referenceEdge},set_referenceEdge:function(a){this._referenceEdge=a;this._m_id._key=this._m_id._key&
-256|this._referenceEdge&255;return a},get_incidentEdge:function(){return this._incidentEdge},set_incidentEdge:function(a){this._incidentEdge=a;this._m_id._key=this._m_id._key&-65281|this._incidentEdge<<8&65280;return a},get_incidentVertex:function(){return this._incidentVertex},set_incidentVertex:function(a){this._incidentVertex=a;this._m_id._key=this._m_id._key&-16711681|this._incidentVertex<<16&16711680;return a},get_flip:function(){return this._flip},set_flip:function(a){this._flip=a;this._m_id._key=
this._m_id._key&16777215|this._flip<<24&-16777216;return a},__class__:vf,__properties__:{set_flip:"set_flip",get_flip:"get_flip",set_incidentVertex:"set_incidentVertex",get_incidentVertex:"get_incidentVertex",set_incidentEdge:"set_incidentEdge",get_incidentEdge:"get_incidentEdge",set_referenceEdge:"set_referenceEdge",get_referenceEdge:"get_referenceEdge"}};var J=function(){};J.__name__=["box2D","collision","B2Collision"];J.clipSegmentToLine=function(a,b,c,d){var e,f=0;e=b[0];var g=e.v;e=b[1];var k=
e.v,h=c.x*g.x+c.y*g.y-d;e=c.x*k.x+c.y*k.y-d;0>=h&&a[f++].set(b[0]);0>=e&&a[f++].set(b[1]);0>h*e&&(c=h/(h-e),e=a[f],e=e.v,e.x=g.x+c*(k.x-g.x),e.y=g.y+c*(k.y-g.y),e=a[f],e.id=(0<h?b[0]:b[1]).id,++f);return f};J.edgeSeparation=function(a,b,c,d,e){var f=a.m_vertices;a=a.m_normals;var g=d.m_vertexCount,k=d.m_vertices,h,l;h=b.R;l=a[c];a=h.col1.x*l.x+h.col2.x*l.y;d=h.col1.y*l.x+h.col2.y*l.y;h=e.R;var P=h.col1.x*a+h.col1.y*d;h=h.col2.x*a+h.col2.y*d;for(var u=0,m=Number.MAX_VALUE,q=0;q<g;){var p=q++;l=k[p];
l=l.x*P+l.y*h;l<m&&(m=l,u=p)}l=f[c];h=b.R;c=b.position.x+(h.col1.x*l.x+h.col2.x*l.y);b=b.position.y+(h.col1.y*l.x+h.col2.y*l.y);l=k[u];h=e.R;f=e.position.x+(h.col1.x*l.x+h.col2.x*l.y);e=e.position.y+(h.col1.y*l.x+h.col2.y*l.y);return(f-c)*a+(e-b)*d};J.findMaxSeparation=function(a,b,c,d,e){var f=b.m_vertexCount,g=b.m_normals,k,h=e.R;k=d.m_centroid;var l=e.position.x+(h.col1.x*k.x+h.col2.x*k.y),P=e.position.y+(h.col1.y*k.x+h.col2.y*k.y),h=c.R;k=b.m_centroid;for(var l=l-(c.position.x+(h.col1.x*k.x+h.col2.x*
k.y)),P=P-(c.position.y+(h.col1.y*k.x+h.col2.y*k.y)),h=l*c.R.col1.x+P*c.R.col1.y,P=l*c.R.col2.x+P*c.R.col2.y,l=0,u=-Number.MAX_VALUE,m=0;m<f;){var q=m++;k=g[q];k=k.x*h+k.y*P;k>u&&(u=k,l=q)}g=J.edgeSeparation(b,c,l,d,e);u=0<=l-1?l-1:f-1;h=J.edgeSeparation(b,c,u,d,e);m=l+1<f?l+1:0;P=J.edgeSeparation(b,c,m,d,e);if(h>g&&h>P)k=-1;else if(P>g)k=1,u=m,h=P;else return a[0]=l,g;for(;;)if(l=-1==k?0<=u-1?u-1:f-1:u+1<f?u+1:0,g=J.edgeSeparation(b,c,l,d,e),g>h)u=l,h=g;else break;a[0]=u;return h};J.findIncidentEdge=
function(a,b,c,d,e,f){var g=b.m_normals,k=e.m_vertexCount;b=e.m_vertices;e=e.m_normals;var h;h=c.R;c=g[d];var g=h.col1.x*c.x+h.col2.x*c.y,l=h.col1.y*c.x+h.col2.y*c.y;h=f.R;c=h.col1.x*g+h.col1.y*l;l=h.col2.x*g+h.col2.y*l;g=c;h=0;for(var P=Number.MAX_VALUE,u=0;u<k;){var m=u++;c=e[m];c=g*c.x+l*c.y;c<P&&(P=c,h=m)}e=h;g=e+1<k?e+1:0;k=a[0];c=b[e];h=f.R;k.v.x=f.position.x+(h.col1.x*c.x+h.col2.x*c.y);k.v.y=f.position.y+(h.col1.y*c.x+h.col2.y*c.y);k.id.features.set_referenceEdge(d);k.id.features.set_incidentEdge(e);
k.id.features.set_incidentVertex(0);k=a[1];c=b[g];h=f.R;k.v.x=f.position.x+(h.col1.x*c.x+h.col2.x*c.y);k.v.y=f.position.y+(h.col1.y*c.x+h.col2.y*c.y);k.id.features.set_referenceEdge(d);k.id.features.set_incidentEdge(g);k.id.features.set_incidentVertex(1)};J.makeClipPointVector=function(){var a=[];a[0]=new Wd;a[1]=new Wd;return a};J.collidePolygons=function(a,b,c,d,e){var f;a.m_pointCount=0;var g=b.m_radius+d.m_radius,k;J.s_edgeAO[0]=0;var h=J.findMaxSeparation(J.s_edgeAO,b,c,d,e);k=J.s_edgeAO[0];
if(!(h>g)){var l;J.s_edgeBO[0]=0;var P=J.findMaxSeparation(J.s_edgeBO,d,e,b,c);l=J.s_edgeBO[0];if(!(P>g)){P>0.98*h+0.001?(h=d,d=b,b=e,a.m_type=ya.FACE_B,k=1):(h=b,b=c,c=e,l=k,a.m_type=ya.FACE_A,k=0);e=J.s_incidentEdge;J.findIncidentEdge(e,h,b,l,d,c);P=h.m_vertices;d=P[l];var u;u=l+1<h.m_vertexCount?P[l+1|0]:P[0];h=J.s_localTangent;h.set(u.x-d.x,u.y-d.y);h.normalize();P=J.s_localNormal;P.x=h.y;P.y=-h.x;var m=J.s_planePoint;m.set(0.5*(d.x+u.x),0.5*(d.y+u.y));f=J.s_tangent;l=b.R;f.x=l.col1.x*h.x+l.col2.x*
h.y;f.y=l.col1.y*h.x+l.col2.y*h.y;var q=J.s_tangent2;q.x=-f.x;q.y=-f.y;h=J.s_normal;h.x=f.y;h.y=-f.x;var p=J.s_v11,r=J.s_v12;p.x=b.position.x+(l.col1.x*d.x+l.col2.x*d.y);p.y=b.position.y+(l.col1.y*d.x+l.col2.y*d.y);r.x=b.position.x+(l.col1.x*u.x+l.col2.x*u.y);r.y=b.position.y+(l.col1.y*u.x+l.col2.y*u.y);b=h.x*p.x+h.y*p.y;l=f.x*r.x+f.y*r.y+g;u=J.s_clipPoints1;d=J.s_clipPoints2;e=J.clipSegmentToLine(u,e,q,-f.x*p.x-f.y*p.y+g);if(!(2>e||(e=J.clipSegmentToLine(d,u,f,l),2>e))){a.m_localPlaneNormal.setV(P);
a.m_localPoint.setV(m);P=e=0;for(m=v.b2_maxManifoldPoints;P<m;)l=P++,f=d[l],h.x*f.v.x+h.y*f.v.y-b<=g&&(q=a.m_points[e],l=c.R,p=f.v.x-c.position.x,u=f.v.y-c.position.y,q.m_localPoint.x=p*l.col1.x+u*l.col1.y,q.m_localPoint.y=p*l.col2.x+u*l.col2.y,q.m_id.set(f.id),q.m_id.features.set_flip(k),++e);a.m_pointCount=e}}}};J.collideCircles=function(a,b,c,d,e){a.m_pointCount=0;var f,g;f=c.R;g=b.m_p;var k=c.position.x+(f.col1.x*g.x+f.col2.x*g.y);c=c.position.y+(f.col1.y*g.x+f.col2.y*g.y);f=e.R;g=d.m_p;k=e.position.x+
(f.col1.x*g.x+f.col2.x*g.y)-k;e=e.position.y+(f.col1.y*g.x+f.col2.y*g.y)-c;f=b.m_radius+d.m_radius;k*k+e*e>f*f||(a.m_type=ya.CIRCLES,a.m_localPoint.setV(b.m_p),a.m_localPlaneNormal.setZero(),a.m_pointCount=1,a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0))};J.collidePolygonAndCircle=function(a,b,c,d,e){a.m_pointCount=0;var f,g,k,h=e.R;k=d.m_p;var l=e.position.y+(h.col1.y*k.x+h.col2.y*k.y);f=e.position.x+(h.col1.x*k.x+h.col2.x*k.y)-c.position.x;g=l-c.position.y;h=c.R;c=f*h.col1.x+
g*h.col1.y;var h=f*h.col2.x+g*h.col2.y,P=0;e=-Number.MAX_VALUE;var l=b.m_radius+d.m_radius,u=b.m_vertexCount,m=b.m_vertices;b=b.m_normals;for(var q=0;q<u;){var p=q++;k=m[p];f=c-k.x;g=h-k.y;k=b[p];k=k.x*f+k.y*g;if(k>l)return;k>e&&(e=k,P=p)}k=P;f=m[k];u=m[k+1<u?k+1:0];e<Number.MIN_VALUE?(a.m_pointCount=1,a.m_type=ya.FACE_A,a.m_localPlaneNormal.setV(b[P]),a.m_localPoint.x=0.5*(f.x+u.x),a.m_localPoint.y=0.5*(f.y+u.y),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):(e=(c-u.x)*(f.x-
u.x)+(h-u.y)*(f.y-u.y),0>=(c-f.x)*(u.x-f.x)+(h-f.y)*(u.y-f.y)?(c-f.x)*(c-f.x)+(h-f.y)*(h-f.y)>l*l||(a.m_pointCount=1,a.m_type=ya.FACE_A,a.m_localPlaneNormal.x=c-f.x,a.m_localPlaneNormal.y=h-f.y,a.m_localPlaneNormal.normalize(),a.m_localPoint.setV(f),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):0>=e?(c-u.x)*(c-u.x)+(h-u.y)*(h-u.y)>l*l||(a.m_pointCount=1,a.m_type=ya.FACE_A,a.m_localPlaneNormal.x=c-u.x,a.m_localPlaneNormal.y=h-u.y,a.m_localPlaneNormal.normalize(),a.m_localPoint.setV(u),
a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):(P=0.5*(f.x+u.x),f=0.5*(f.y+u.y),e=(c-P)*b[k].x+(h-f)*b[k].y,e>l||(a.m_pointCount=1,a.m_type=ya.FACE_A,a.m_localPlaneNormal.x=b[k].x,a.m_localPlaneNormal.y=b[k].y,a.m_localPlaneNormal.normalize(),a.m_localPoint.set(P,f),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0))))};J.testOverlap=function(a,b){var c=b.lowerBound,d=a.upperBound,e=c.x-d.x,f=c.y-d.y,c=a.lowerBound,d=b.upperBound,g=c.y-d.y;return 0<e||0<f||
0<c.x-d.x||0<g?!1:!0};var wf=function(){this.position=new t;this.velocity=new t;this.normal=new t;this.id=new Dc};wf.__name__=["box2D","collision","B2ContactPoint"];wf.prototype={__class__:wf};var xf=function(){this.m_v1=new cd;this.m_v2=new cd;this.m_v3=new cd;this.m_vertices=[];this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};xf.__name__=["box2D","collision","B2Simplex"];xf.prototype={readCache:function(a,b,c,d,e){v.b2Assert(0<=a.count&&3>=a.count);var f,g;
this.m_count=a.count;for(var k=this.m_vertices,h,l=0,P=this.m_count;l<P;)f=l++,h=k[f],h.indexA=a.indexA[f],h.indexB=a.indexB[f],f=b.getVertex(h.indexA),g=d.getVertex(h.indexB),h.wA=q.mulX(c,f),h.wB=q.mulX(e,g),h.w=q.subtractVV(h.wB,h.wA),h.a=0;1<this.m_count&&(a=a.metric,h=this.getMetric(),h<0.5*a||2*a<h||h<Number.MIN_VALUE)&&(this.m_count=0);0==this.m_count&&(h=k[0],h.indexA=0,h.indexB=0,f=b.getVertex(0),g=d.getVertex(0),h.wA=q.mulX(c,f),h.wB=q.mulX(e,g),h.w=q.subtractVV(h.wB,h.wA),this.m_count=
1)},writeCache:function(a){a.metric=this.getMetric();a.count=this.m_count|0;for(var b=this.m_vertices,c=0,d=this.m_count;c<d;){var e=c++;a.indexA[e]=b[e].indexA|0;a.indexB[e]=b[e].indexB|0}},getSearchDirection:function(){switch(this.m_count){case 1:return this.m_v1.w.getNegative();case 2:var a=q.subtractVV(this.m_v2.w,this.m_v1.w);return 0<q.crossVV(a,this.m_v1.w.getNegative())?q.crossFV(1,a):q.crossVF(a,1);default:return v.b2Assert(!1),new t}},getClosestPoint:function(){switch(this.m_count){case 0:return v.b2Assert(!1),
new t;case 1:return this.m_v1.w;case 2:return new t(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return v.b2Assert(!1),new t}},getWitnessPoints:function(a,b){switch(this.m_count){case 0:v.b2Assert(!1);break;case 1:a.setV(this.m_v1.wA);b.setV(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;b.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;
b.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:b.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;b.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:v.b2Assert(!1)}},getMetric:function(){switch(this.m_count){case 0:return v.b2Assert(!1),0;case 1:return 0;case 2:return q.subtractVV(this.m_v1.w,this.m_v2.w).length();case 3:return q.crossVV(q.subtractVV(this.m_v2.w,this.m_v1.w),q.subtractVV(this.m_v3.w,
this.m_v1.w));default:return v.b2Assert(!1),0}},solve2:function(){var a=this.m_v1.w,b=this.m_v2.w,c=q.subtractVV(b,a),a=-(a.x*c.x+a.y*c.y);0>=a?this.m_count=this.m_v1.a=1:(b=b.x*c.x+b.y*c.y,0>=b?(this.m_count=this.m_v2.a=1,this.m_v1.set(this.m_v2)):(c=1/(b+a),this.m_v1.a=b*c,this.m_v2.a=a*c,this.m_count=2))},solve3:function(){var a=this.m_v1.w,b=this.m_v2.w,c=this.m_v3.w,d=q.subtractVV(b,a),e=q.dot(a,d),f=q.dot(b,d),e=-e,g=q.subtractVV(c,a),k=q.dot(a,g),h=q.dot(c,g),k=-k,l=q.subtractVV(c,b),P=q.dot(b,
l),l=q.dot(c,l),P=-P,g=q.crossVV(d,g),d=g*q.crossVV(b,c),c=g*q.crossVV(c,a),a=g*q.crossVV(a,b);0>=e&&0>=k?this.m_count=this.m_v1.a=1:0<f&&0<e&&0>=a?(h=1/(f+e),this.m_v1.a=f*h,this.m_v2.a=e*h,this.m_count=2):0<h&&0<k&&0>=c?(f=1/(h+k),this.m_v1.a=h*f,this.m_v3.a=k*f,this.m_count=2,this.m_v2.set(this.m_v3)):0>=f&&0>=P?(this.m_count=this.m_v2.a=1,this.m_v1.set(this.m_v2)):0>=h&&0>=l?(this.m_count=this.m_v3.a=1,this.m_v1.set(this.m_v3)):0<l&&0<P&&0>=d?(f=1/(l+P),this.m_v2.a=l*f,this.m_v3.a=P*f,this.m_count=
2,this.m_v1.set(this.m_v3)):(f=1/(d+c+a),this.m_v1.a=d*f,this.m_v2.a=c*f,this.m_v3.a=a*f,this.m_count=3)},__class__:xf};var cd=function(){};cd.__name__=["box2D","collision","B2SimplexVertex"];cd.prototype={set:function(a){this.wA.setV(a.wA);this.wB.setV(a.wB);this.w.setV(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB},__class__:cd};var $a=function(){};$a.__name__=["box2D","collision","B2Distance"];$a.distance=function(a,b,c){++$a.b2_gjkCalls;var d=c.proxyA,e=c.proxyB,f=c.transformA,g=c.transformB,
k=$a.s_simplex;k.readCache(b,d,f,e,g);var h=k.m_vertices,l=$a.s_saveA,P=$a.s_saveB,u=0;k.getClosestPoint().lengthSquared();for(var m,p=0;20>p;){u=k.m_count;m=0;for(var r=u;m<r;){var n=m++;l[n]=h[n].indexA;P[n]=h[n].indexB}switch(k.m_count){case 1:break;case 2:k.solve2();break;case 3:k.solve3();break;default:v.b2Assert(!1)}if(3==k.m_count)break;m=k.getClosestPoint();m.lengthSquared();r=k.getSearchDirection();if(r.lengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;m=h[k.m_count];m.indexA=d.getSupport(q.mulTMV(f.R,
r.getNegative()))|0;m.wA=q.mulX(f,d.getVertex(m.indexA));m.indexB=e.getSupport(q.mulTMV(g.R,r))|0;m.wB=q.mulX(g,e.getVertex(m.indexB));m.w=q.subtractVV(m.wB,m.wA);++p;++$a.b2_gjkIters;r=!1;for(n=0;n<u;){var s=n++;if(m.indexA==l[s]&&m.indexB==P[s]){r=!0;break}}if(r)break;++k.m_count}$a.b2_gjkMaxIters=q.max($a.b2_gjkMaxIters,p)|0;k.getWitnessPoints(a.pointA,a.pointB);a.distance=q.subtractVV(a.pointA,a.pointB).length();a.iterations=p;k.writeCache(b);c.useRadii&&(b=d.m_radius,e=e.m_radius,a.distance>
b+e&&a.distance>Number.MIN_VALUE?(a.distance-=b+e,c=q.subtractVV(a.pointB,a.pointA),c.normalize(),a.pointA.x+=b*c.x,a.pointA.y+=b*c.y,a.pointB.x-=e*c.x,a.pointB.y-=e*c.y):(m=new t,m.x=0.5*(a.pointA.x+a.pointB.x),m.y=0.5*(a.pointA.y+a.pointB.y),a.pointA.x=a.pointB.x=m.x,a.pointA.y=a.pointB.y=m.y,a.distance=0))};var yf=function(){};yf.__name__=["box2D","collision","B2DistanceInput"];yf.prototype={__class__:yf};var zf=function(){this.pointA=new t;this.pointB=new t};zf.__name__=["box2D","collision","B2DistanceOutput"];
zf.prototype={__class__:zf};var Xd=function(){this.m_vertices=[]};Xd.__name__=["box2D","collision","B2DistanceProxy"];Xd.prototype={set:function(a){switch(a.getType()[1]){case 1:a=y.__cast(a,ab);this.m_vertices=[];this.m_vertices[0]=a.m_p;this.m_count=1;this.m_radius=a.m_radius;break;case 2:a=y.__cast(a,qa);this.m_vertices=a.m_vertices;this.m_count=a.m_vertexCount;this.m_radius=a.m_radius;break;default:v.b2Assert(!1)}},getSupport:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*
a.y,d=1,e=this.m_count;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return b},getSupportVertex:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_count;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return this.m_vertices[b]},getVertexCount:function(){return this.m_count},getVertex:function(a){v.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a]},__class__:Xd};var Af=function(){this.m_freeList=
this.m_root=null;this.m_insertionCount=this.m_path=0};Af.__name__=["box2D","collision","B2DynamicTree"];Af.prototype={createProxy:function(a,b){var c=this.allocateNode(),d=v.b2_aabbExtension,e=v.b2_aabbExtension;c.aabb.lowerBound.x=a.lowerBound.x-d;c.aabb.lowerBound.y=a.lowerBound.y-e;c.aabb.upperBound.x=a.upperBound.x+d;c.aabb.upperBound.y=a.upperBound.y+e;c.userData=b;this.insertLeaf(c);return c},destroyProxy:function(a){this.removeLeaf(a);this.freeNode(a)},moveProxy:function(a,b,c){v.b2Assert(a.isLeaf());
if(a.aabb.contains(b))return!1;this.removeLeaf(a);var d=v.b2_aabbExtension+v.b2_aabbMultiplier*(0<c.x?c.x:-c.x);c=v.b2_aabbExtension+v.b2_aabbMultiplier*(0<c.y?c.y:-c.y);a.aabb.lowerBound.x=b.lowerBound.x-d;a.aabb.lowerBound.y=b.lowerBound.y-c;a.aabb.upperBound.x=b.upperBound.x+d;a.aabb.upperBound.y=b.upperBound.y+c;this.insertLeaf(a);return!0},rebalance:function(a){if(null!=this.m_root)for(var b=0;b<a;){b++;for(var c=this.m_root,d=0;!1==c.isLeaf();)c=0!=(this.m_path>>d&1)?c.child2:c.child1,d=d+1&
31;++this.m_path;this.removeLeaf(c);this.insertLeaf(c)}},getFatAABB:function(a){return a.aabb},getUserData:function(a){return a.userData},query:function(a,b){if(null!=this.m_root){var c=[],d=0;for(c[d++]=this.m_root;0<d;){var e=c[--d];if(e.aabb.testOverlap(b))if(e.isLeaf()){if(!a(e))break}else c[d++]=e.child1,c[d++]=e.child2}}},rayCast:function(a,b){if(null!=this.m_root){var c=b.p1,d=b.p2,e=q.subtractVV(c,d);e.normalize();var e=q.crossFV(1,e),f=q.absV(e),g=b.maxFraction,k=new Za,h;h=c.x+g*(d.x-c.x);
g=c.y+g*(d.y-c.y);k.lowerBound.x=Math.min(c.x,h);k.lowerBound.y=Math.min(c.y,g);k.upperBound.x=Math.max(c.x,h);k.upperBound.y=Math.max(c.y,g);var l=[],m=0;for(l[m++]=this.m_root;0<m;)if(h=l[--m],!1!=h.aabb.testOverlap(k)){var g=h.aabb.getCenter(),u=h.aabb.getExtents();if(!(0<Math.abs(e.x*(c.x-g.x)+e.y*(c.y-g.y))-f.x*u.x-f.y*u.y))if(h.isLeaf()){g=new Yd;g.p1=b.p1;g.p2=b.p2;g.maxFraction=b.maxFraction;g=a(g,h);if(0==g)break;h=c.x+g*(d.x-c.x);g=c.y+g*(d.y-c.y);k.lowerBound.x=Math.min(c.x,h);k.lowerBound.y=
Math.min(c.y,g);k.upperBound.x=Math.max(c.x,h);k.upperBound.y=Math.max(c.y,g)}else l[m++]=h.child1,l[m++]=h.child2}}},allocateNode:function(){if(null!=this.m_freeList){var a=this.m_freeList;this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;return a}return new dd},freeNode:function(a){a.parent=this.m_freeList;this.m_freeList=a},insertLeaf:function(a){++this.m_insertionCount;if(null==this.m_root)this.m_root=a,this.m_root.parent=null;else{var b=a.aabb.getCenter(),c=this.m_root;if(!1==
c.isLeaf())for(;;){var d=c.child1,c=c.child2,e=Math.abs((d.aabb.lowerBound.x+d.aabb.upperBound.x)/2-b.x)+Math.abs((d.aabb.lowerBound.y+d.aabb.upperBound.y)/2-b.y),f=Math.abs((c.aabb.lowerBound.x+c.aabb.upperBound.x)/2-b.x)+Math.abs((c.aabb.lowerBound.y+c.aabb.upperBound.y)/2-b.y),c=e<f?d:c;if(!1!=c.isLeaf())break}b=c.parent;d=this.allocateNode();d.parent=b;d.userData=null;d.aabb.combine(a.aabb,c.aabb);if(null!=b)for(c.parent.child1==c?b.child1=d:b.child2=d,d.child1=c,d.child2=a,c.parent=d,a.parent=
d;!b.aabb.contains(d.aabb)&&(b.aabb.combine(b.child1.aabb,b.child2.aabb),d=b,b=b.parent,null!=b););else d.child1=c,d.child2=a,c.parent=d,this.m_root=a.parent=d}},removeLeaf:function(a){if(a==this.m_root)this.m_root=null;else{var b=a.parent,c=b.parent;a=b.child1==a?b.child2:b.child1;if(null!=c)for(c.child1==b?c.child1=a:c.child2=a,a.parent=c,this.freeNode(b);null!=c;){b=c.aabb;c.aabb=new Za;c.aabb.combine(c.child1.aabb,c.child2.aabb);if(b.contains(c.aabb))break;c=c.parent}else this.m_root=a,a.parent=
null,this.freeNode(b)}},__class__:Af};var Bf=function(){};Bf.__name__=["box2D","collision","IBroadPhase"];Bf.prototype={__class__:Bf};var Zd=function(){this.m_tree=new Af;this.m_moveBuffer=[];this.m_pairBuffer=[];this.m_pairCount=0};Zd.__name__=["box2D","collision","B2DynamicTreeBroadPhase"];Zd.__interfaces__=[Bf];Zd.prototype={createProxy:function(a,b){var c=this.m_tree.createProxy(a,b);++this.m_proxyCount;this.bufferMove(c);return c},destroyProxy:function(a){this.unBufferMove(a);--this.m_proxyCount;
this.m_tree.destroyProxy(a)},moveProxy:function(a,b,c){this.m_tree.moveProxy(a,b,c)&&this.bufferMove(a)},testOverlap:function(a,b){var c=this.m_tree.getFatAABB(a),d=this.m_tree.getFatAABB(b);return c.testOverlap(d)},getUserData:function(a){return this.m_tree.getUserData(a)},getFatAABB:function(a){return this.m_tree.getFatAABB(a)},getProxyCount:function(){return this.m_proxyCount},updatePairs:function(a){for(var b=this,c=this.m_pairCount=0,d=this.m_moveBuffer;c<d.length;){var e=[d[c]];++c;var f=function(a){return function(c){if(c==
a[0])return!0;b.m_pairCount==b.m_pairBuffer.length&&(b.m_pairBuffer[b.m_pairCount]=new Cf);var d=b.m_pairBuffer[b.m_pairCount];c.id<a[0].id?(d.proxyA=c,d.proxyB=a[0]):(d.proxyA=a[0],d.proxyB=c);++b.m_pairCount;return!0}}(e),e=this.m_tree.getFatAABB(e[0]);this.m_tree.query(f,e)}this.m_moveBuffer=[];c=!0;for(d=0;c;)if(d>=this.m_pairCount)c=!1;else{var f=this.m_pairBuffer[d],e=this.m_tree.getUserData(f.proxyA),g=this.m_tree.getUserData(f.proxyB);a(e,g);for(++d;d<this.m_pairCount;){e=this.m_pairBuffer[d];
if(e.proxyA!=f.proxyA||e.proxyB!=f.proxyB)break;++d}}},query:function(a,b){this.m_tree.query(a,b)},rayCast:function(a,b){this.m_tree.rayCast(a,b)},validate:function(){},rebalance:function(a){this.m_tree.rebalance(a)},bufferMove:function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a},unBufferMove:function(a){F.remove(this.m_moveBuffer,a)},comparePairs:function(a,b){return 0},__class__:Zd};var dd=function(){this.aabb=new Za;this.id=dd.currentID++};dd.__name__=["box2D","collision","B2DynamicTreeNode"];
dd.prototype={isLeaf:function(){return null==this.child1},__class__:dd};var Cf=function(){};Cf.__name__=["box2D","collision","B2DynamicTreePair"];Cf.prototype={__class__:Cf};var ed=function(){this.m_pointCount=0;this.m_points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new Df}this.m_localPlaneNormal=new t;this.m_localPoint=new t};ed.__name__=["box2D","collision","B2Manifold"];ed.prototype={reset:function(){for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c].reset()}this.m_localPlaneNormal.setZero();
this.m_localPoint.setZero();this.m_type=ya.CIRCLES;this.m_pointCount=0},set:function(a){this.m_pointCount=a.m_pointCount;for(var b=0,c=v.b2_maxManifoldPoints;b<c;){var d=b++;this.m_points[d].set(a.m_points[d])}this.m_localPlaneNormal.setV(a.m_localPlaneNormal);this.m_localPoint.setV(a.m_localPoint);this.m_type=a.m_type},copy:function(){var a=new ed;a.set(this);return a},__class__:ed};var Df=function(){this.m_localPoint=new t;this.m_id=new Dc;this.reset()};Df.__name__=["box2D","collision","B2ManifoldPoint"];
Df.prototype={reset:function(){this.m_localPoint.setZero();this.m_tangentImpulse=this.m_normalImpulse=0;this.m_id.set_key(0)},set:function(a){this.m_localPoint.setV(a.m_localPoint);this.m_normalImpulse=a.m_normalImpulse;this.m_tangentImpulse=a.m_tangentImpulse;this.m_id.set(a.m_id)},__class__:Df};var ya={__ename__:!0,__constructs__:["CIRCLES","FACE_A","FACE_B"],CIRCLES:["CIRCLES",0]};ya.CIRCLES.__enum__=ya;ya.FACE_A=["FACE_A",1];ya.FACE_A.__enum__=ya;ya.FACE_B=["FACE_B",2];ya.FACE_B.__enum__=ya;ya.__empty_constructs__=
[ya.CIRCLES,ya.FACE_A,ya.FACE_B];var Yd=function(a,b,c){null==c&&(c=1);this.p1=new t;this.p2=new t;null!=a&&this.p1.setV(a);null!=b&&this.p2.setV(b);this.maxFraction=c};Yd.__name__=["box2D","collision","B2RayCastInput"];Yd.prototype={__class__:Yd};var Ef=function(){this.normal=new t};Ef.__name__=["box2D","collision","B2RayCastOutput"];Ef.prototype={__class__:Ef};var Ff=function(){this.m_localPoint=new t;this.m_axis=new t};Ff.__name__=["box2D","collision","B2SeparationFunction"];Ff.prototype={initialize:function(a,
b,c,d,e){this.m_proxyA=b;this.m_proxyB=d;b=a.count;v.b2Assert(0<b&&3>b);var f=new t,g=new t,k,h;if(1==b)this.m_type=Ia.POINTS,f=this.m_proxyA.getVertex(a.indexA[0]),g=this.m_proxyB.getVertex(a.indexB[0]),h=f,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=g,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*h.y),e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),this.m_axis.x=g-f,this.m_axis.y=e-c,this.m_axis.normalize();else{if(a.indexB[0]==a.indexB[1])this.m_type=
Ia.FACE_A,b=this.m_proxyA.getVertex(a.indexA[0]),d=this.m_proxyA.getVertex(a.indexA[1]),g=this.m_proxyB.getVertex(a.indexB[0]),this.m_localPoint.x=0.5*(b.x+d.x),this.m_localPoint.y=0.5*(b.y+d.y),this.m_axis=q.crossVF(q.subtractVV(d,b),1),this.m_axis.normalize(),h=this.m_axis,k=c.R,b=k.col1.x*h.x+k.col2.x*h.y,d=k.col1.y*h.x+k.col2.y*h.y,h=this.m_localPoint,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=g,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*h.y),
e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),a=(g-f)*b+(e-c)*d;else if(a.indexA[0]==a.indexA[0])this.m_type=Ia.FACE_B,k=this.m_proxyB.getVertex(a.indexB[0]),h=this.m_proxyB.getVertex(a.indexB[1]),f=this.m_proxyA.getVertex(a.indexA[0]),this.m_localPoint.x=0.5*(k.x+h.x),this.m_localPoint.y=0.5*(k.y+h.y),this.m_axis=q.crossVF(q.subtractVV(h,k),1),this.m_axis.normalize(),h=this.m_axis,k=e.R,b=k.col1.x*h.x+k.col2.x*h.y,d=k.col1.y*h.x+k.col2.y*h.y,h=this.m_localPoint,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*
h.y),e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=f,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),a=(f-g)*b+(c-e)*d;else{b=this.m_proxyA.getVertex(a.indexA[0]);d=this.m_proxyA.getVertex(a.indexA[1]);k=this.m_proxyB.getVertex(a.indexB[0]);h=this.m_proxyB.getVertex(a.indexB[1]);q.mulX(c,f);f=q.mulMV(c.R,q.subtractVV(d,b));q.mulX(e,g);a=q.mulMV(e.R,q.subtractVV(h,k));e=f.x*f.x+f.y*f.y;c=a.x*a.x+a.y*a.y;var l=q.subtractVV(a,f),g=f.x*l.x+f.y*l.y,l=a.x*l.x+
a.y*l.y,f=f.x*a.x+f.y*a.y,m=e*c-f*f;a=0;0!=m&&(a=q.clamp((f*l-g*c)/m,0,1));0>(f*a+l)/c&&(a=q.clamp((f-g)/e,0,1));f=new t;f.x=b.x+a*(d.x-b.x);f.y=b.y+a*(d.y-b.y);g=new t;g.x=k.x+a*(h.x-k.x);g.y=k.y+a*(h.y-k.y);0==a||1==a?(this.m_type=Ia.FACE_B,this.m_axis=q.crossVF(q.subtractVV(h,k),1),this.m_axis.normalize(),this.m_localPoint=g):(this.m_type=Ia.FACE_A,this.m_axis=q.crossVF(q.subtractVV(d,b),1),this.m_localPoint=f)}0>a&&this.m_axis.negativeSelf()}},evaluate:function(a,b){var c,d,e;switch(this.m_type[1]){case 0:return c=
q.mulTMV(a.R,this.m_axis),d=q.mulTMV(b.R,this.m_axis.getNegative()),c=this.m_proxyA.getSupportVertex(c),d=this.m_proxyB.getSupportVertex(d),c=q.mulX(a,c),d=q.mulX(b,d),e=(d.x-c.x)*this.m_axis.x+(d.y-c.y)*this.m_axis.y;case 1:return e=q.mulMV(a.R,this.m_axis),c=q.mulX(a,this.m_localPoint),d=q.mulTMV(b.R,e.getNegative()),d=this.m_proxyB.getSupportVertex(d),d=q.mulX(b,d),e=(d.x-c.x)*e.x+(d.y-c.y)*e.y;case 2:return e=q.mulMV(b.R,this.m_axis),d=q.mulX(b,this.m_localPoint),c=q.mulTMV(a.R,e.getNegative()),
c=this.m_proxyA.getSupportVertex(c),c=q.mulX(a,c),e=(c.x-d.x)*e.x+(c.y-d.y)*e.y}},__class__:Ff};var Ia={__ename__:!0,__constructs__:["POINTS","FACE_A","FACE_B"],POINTS:["POINTS",0]};Ia.POINTS.__enum__=Ia;Ia.FACE_A=["FACE_A",1];Ia.FACE_A.__enum__=Ia;Ia.FACE_B=["FACE_B",2];Ia.FACE_B.__enum__=Ia;Ia.__empty_constructs__=[Ia.POINTS,Ia.FACE_A,Ia.FACE_B];var Gf=function(){this.indexA=[];this.indexB=[]};Gf.__name__=["box2D","collision","B2SimplexCache"];Gf.prototype={__class__:Gf};var Hf=function(){this.proxyA=
new Xd;this.proxyB=new Xd;this.sweepA=new Jb;this.sweepB=new Jb};Hf.__name__=["box2D","collision","B2TOIInput"];Hf.prototype={__class__:Hf};var qb=function(a,b){this.position=new t;this.R=new ja;null!=a&&(this.position.setV(a),this.R.setM(b))};qb.__name__=["box2D","common","math","B2Transform"];qb.prototype={initialize:function(a,b){this.position.setV(a);this.R.setM(b)},setIdentity:function(){this.position.setZero();this.R.setIdentity()},set:function(a){this.position.setV(a.position);this.R.setM(a.R)},
getAngle:function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},__class__:qb};var ja=function(){this.col1=new t(0,1);this.col2=new t(0,1)};ja.__name__=["box2D","common","math","B2Mat22"];ja.fromAngle=function(a){var b=new ja;b.set(a);return b};ja.fromVV=function(a,b){var c=new ja;c.setVV(a,b);return c};ja.prototype={set:function(a){var b=Math.cos(a);a=Math.sin(a);this.col1.x=b;this.col2.x=-a;this.col1.y=a;this.col2.y=b},setVV:function(a,b){this.col1.setV(a);this.col2.setV(b)},copy:function(){var a=
new ja;a.setM(this);return a},setM:function(a){this.col1.setV(a.col1);this.col2.setV(a.col2)},addM:function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y},setIdentity:function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1},setZero:function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0},getAngle:function(){return Math.atan2(this.col1.y,this.col1.x)},getInverse:function(a){var b=this.col1.x,c=this.col2.x,d=this.col1.y,e=this.col2.y,
f=b*e-c*d;0!=f&&(f=1/f);a.col1.x=f*e;a.col2.x=-f*c;a.col1.y=-f*d;a.col2.y=f*b;return a},solve:function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,k=d*g-e*f;0!=k&&(k=1/k);a.x=k*(g*b-e*c);a.y=k*(d*c-f*b);return a},abs:function(){this.col1.abs();this.col2.abs()},__class__:ja};var C=function(){};C.__name__=["box2D","collision","B2TimeOfImpact"];C.timeOfImpact=function(a){++C.b2_toiCalls;var b=a.proxyA,c=a.proxyB,d=a.sweepA,e=a.sweepB;v.b2Assert(d.t0==e.t0);v.b2Assert(1-d.t0>Number.MIN_VALUE);
var f=b.m_radius+c.m_radius;a=a.tolerance;var g=0,k=0,h=0;C.s_cache.count=0;for(C.s_distanceInput.useRadii=!1;;){d.getTransform(C.s_xfA,g);e.getTransform(C.s_xfB,g);C.s_distanceInput.proxyA=b;C.s_distanceInput.proxyB=c;C.s_distanceInput.transformA=C.s_xfA;C.s_distanceInput.transformB=C.s_xfB;$a.distance(C.s_distanceOutput,C.s_cache,C.s_distanceInput);if(0>=C.s_distanceOutput.distance){g=1;break}C.s_fcn.initialize(C.s_cache,b,C.s_xfA,c,C.s_xfB);var l=C.s_fcn.evaluate(C.s_xfA,C.s_xfB);if(0>=l){g=1;
break}0==k&&(h=l>f?q.max(f-a,0.75*f):q.max(l-a,0.02*f));if(l-h<0.5*a){if(0==k){g=1;break}break}var m=g,u=g,p=1;d.getTransform(C.s_xfA,p);e.getTransform(C.s_xfB,p);var r=C.s_fcn.evaluate(C.s_xfA,C.s_xfB);if(r>=h){g=1;break}for(var n=0;;){var t;t=0!=(n&1)?u+(h-l)*(p-u)/(r-l):0.5*(u+p);d.getTransform(C.s_xfA,t);e.getTransform(C.s_xfB,t);var s=C.s_fcn.evaluate(C.s_xfA,C.s_xfB);if(q.abs(s-h)<0.025*a){m=t;break}s>h?(u=t,l=s):(p=t,r=s);++n;++C.b2_toiRootIters;if(50==n)break}C.b2_toiMaxRootIters=q.max(C.b2_toiMaxRootIters,
n)|0;if(m<(1+100*Number.MIN_VALUE)*g)break;g=m;++k;++C.b2_toiIters;if(1E3==k)break}C.b2_toiMaxIters=q.max(C.b2_toiMaxIters,k)|0;return g};var If=function(){this.m_normal=new t;this.m_points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new t}};If.__name__=["box2D","collision","B2WorldManifold"];If.prototype={initialize:function(a,b,c,d,e){if(0!=a.m_pointCount){var f,g,k,h,l,m,u;switch(a.m_type[1]){case 0:g=b.R;f=a.m_localPoint;k=b.position.x+g.col1.x*f.x+g.col2.x*f.y;h=
b.position.y+g.col1.y*f.x+g.col2.y*f.y;g=d.R;f=a.m_points[0].m_localPoint;a=d.position.x+g.col1.x*f.x+g.col2.x*f.y;f=d.position.y+g.col1.y*f.x+g.col2.y*f.y;g=a-k;d=f-h;l=g*g+d*d;l>Number.MIN_VALUE*Number.MIN_VALUE?(l=Math.sqrt(l),this.m_normal.x=g/l,this.m_normal.y=d/l):(this.m_normal.x=1,this.m_normal.y=0);g=h+c*this.m_normal.y;f-=e*this.m_normal.y;this.m_points[0].x=0.5*(k+c*this.m_normal.x+(a-e*this.m_normal.x));this.m_points[0].y=0.5*(g+f);break;case 1:g=b.R;f=a.m_localPlaneNormal;k=g.col1.x*
f.x+g.col2.x*f.y;h=g.col1.y*f.x+g.col2.y*f.y;g=b.R;f=a.m_localPoint;l=b.position.x+g.col1.x*f.x+g.col2.x*f.y;m=b.position.y+g.col1.y*f.x+g.col2.y*f.y;this.m_normal.x=k;this.m_normal.y=h;b=0;for(var q=a.m_pointCount;b<q;){var p=b++;g=d.R;f=a.m_points[p].m_localPoint;u=d.position.x+g.col1.x*f.x+g.col2.x*f.y;f=d.position.y+g.col1.y*f.x+g.col2.y*f.y;this.m_points[p].x=u+0.5*(c-(u-l)*k-(f-m)*h-e)*k;this.m_points[p].y=f+0.5*(c-(u-l)*k-(f-m)*h-e)*h}break;case 2:for(g=d.R,f=a.m_localPlaneNormal,k=g.col1.x*
f.x+g.col2.x*f.y,h=g.col1.y*f.x+g.col2.y*f.y,g=d.R,f=a.m_localPoint,l=d.position.x+g.col1.x*f.x+g.col2.x*f.y,m=d.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_normal.x=-k,this.m_normal.y=-h,d=0,q=a.m_pointCount;d<q;)p=d++,g=b.R,f=a.m_points[p].m_localPoint,u=b.position.x+g.col1.x*f.x+g.col2.x*f.y,f=b.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_points[p].x=u+0.5*(e-(u-l)*k-(f-m)*h-c)*k,this.m_points[p].y=f+0.5*(e-(u-l)*k-(f-m)*h-c)*h}}},__class__:If};var za=function(){this.m_type=ba.UNKNOWN_SHAPE;this.m_radius=
v.b2_linearSlop};za.__name__=["box2D","collision","shapes","B2Shape"];za.testOverlap=function(a,b,c,d){return!0};za.prototype={copy:function(){return null},set:function(a){this.m_radius=a.m_radius},getType:function(){return this.m_type},testPoint:function(a,b){return!1},rayCast:function(a,b,c){return!1},computeAABB:function(a,b){},computeMass:function(a,b){},computeSubmergedArea:function(a,b,c,d){return 0},__class__:za};var ab=function(a){null==a&&(a=0);za.call(this);this.m_p=new t;this.m_type=ba.CIRCLE_SHAPE;
this.m_radius=a};ab.__name__=["box2D","collision","shapes","B2CircleShape"];ab.__super__=za;ab.prototype=r(za.prototype,{copy:function(){var a=new ab;a.set(this);return a},set:function(a){za.prototype.set.call(this,a);y.__instanceof(a,ab)&&(a=y.__cast(a,ab),this.m_p.setV(a.m_p))},testPoint:function(a,b){var c=a.R,d=a.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),c=a.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y),d=b.x-d,c=b.y-c;return d*d+c*c<=this.m_radius*this.m_radius},rayCast:function(a,
b,c){var d=c.R,e=b.p1.x-(c.position.x+(d.col1.x*this.m_p.x+d.col2.x*this.m_p.y));c=b.p1.y-(c.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y));var d=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y,g=e*d+c*f,k=d*d+f*f,h=g*g-k*(e*e+c*c-this.m_radius*this.m_radius);if(0>h||k<Number.MIN_VALUE)return!1;g=-(g+Math.sqrt(h));return 0<=g&&g<=b.maxFraction*k?(g/=k,a.fraction=g,a.normal.x=e+g*d,a.normal.y=c+g*f,a.normal.normalize(),!0):!1},computeAABB:function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),
c=b.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);a.lowerBound.set(d-this.m_radius,c-this.m_radius);a.upperBound.set(d+this.m_radius,c+this.m_radius)},computeMass:function(a,b){a.mass=b*v.b2_pi*this.m_radius*this.m_radius;a.center.setV(this.m_p);a.I=a.mass*(0.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},computeSubmergedArea:function(a,b,c,d){c=q.mulX(c,this.m_p);var e=-(q.dot(a,c)-b);if(e<-this.m_radius+Number.MIN_VALUE)return 0;if(e>this.m_radius)return d.setV(c),
Math.PI*this.m_radius*this.m_radius;b=this.m_radius*this.m_radius;var f=e*e,e=b*(Math.asin(e/this.m_radius)+Math.PI/2)+e*Math.sqrt(b-f);b=-0.6666666666666666*Math.pow(b-f,1.5)/e;d.x=c.x+a.x*b;d.y=c.y+a.y*b;return e},getLocalPosition:function(){return this.m_p},setLocalPosition:function(a){this.m_p.setV(a)},getRadius:function(){return this.m_radius},setRadius:function(a){this.m_radius=a},__class__:ab});var Ec=function(a,b){za.call(this);this.s_supportVec=new t;this.m_v1=new t;this.m_v2=new t;this.m_coreV1=
new t;this.m_coreV2=new t;this.m_normal=new t;this.m_direction=new t;this.m_cornerDir1=new t;this.m_cornerDir2=new t;this.m_type=ba.EDGE_SHAPE;this.m_nextEdge=this.m_prevEdge=null;this.m_v1=a;this.m_v2=b;this.m_direction.set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.normalize();this.m_normal.set(this.m_direction.y,-this.m_direction.x);this.m_coreV1.set(-v.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-v.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+
this.m_v1.y);this.m_coreV2.set(-v.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-v.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.set(-this.m_normal.x,-this.m_normal.y)};Ec.__name__=["box2D","collision","shapes","B2EdgeShape"];Ec.__super__=za;Ec.prototype=r(za.prototype,{testPoint:function(a,b){return!1},rayCast:function(a,b,c){var d,e=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y;d=c.R;var g=c.position.x+(d.col1.x*this.m_v1.x+d.col2.x*
this.m_v1.y),k=c.position.y+(d.col1.y*this.m_v1.x+d.col2.y*this.m_v1.y),h=c.position.y+(d.col1.y*this.m_v2.x+d.col2.y*this.m_v2.y)-k;c=-(c.position.x+(d.col1.x*this.m_v2.x+d.col2.x*this.m_v2.y)-g);d=100*Number.MIN_VALUE;var l=-(e*h+f*c);if(l>d){var g=b.p1.x-g,m=b.p1.y-k,k=g*h+m*c;if(0<=k&&k<=b.maxFraction*l&&(b=-e*m+f*g,-d*l<=b&&b<=l*(1+d)))return a.fraction=k/l,b=Math.sqrt(h*h+c*c),a.normal.x=h/b,a.normal.y=c/b,!0}return!1},computeAABB:function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_v1.x+
c.col2.x*this.m_v1.y),e=b.position.y+(c.col1.y*this.m_v1.x+c.col2.y*this.m_v1.y),f=b.position.x+(c.col1.x*this.m_v2.x+c.col2.x*this.m_v2.y),c=b.position.y+(c.col1.y*this.m_v2.x+c.col2.y*this.m_v2.y);d<f?(a.lowerBound.x=d,a.upperBound.x=f):(a.lowerBound.x=f,a.upperBound.x=d);e<c?(a.lowerBound.y=e,a.upperBound.y=c):(a.lowerBound.y=c,a.upperBound.y=e)},computeMass:function(a,b){a.mass=0;a.center.setV(this.m_v1);a.I=0},computeSubmergedArea:function(a,b,c,d){var e=new t(a.x*b,a.y*b),f=q.mulX(c,this.m_v1);
c=q.mulX(c,this.m_v2);var g=q.dot(a,f)-b;a=q.dot(a,c)-b;if(0<g){if(0<a)return 0;f.x=-a/(g-a)*f.x+g/(g-a)*c.x;f.y=-a/(g-a)*f.y+g/(g-a)*c.y}else 0<a&&(c.x=-a/(g-a)*f.x+g/(g-a)*c.x,c.y=-a/(g-a)*f.y+g/(g-a)*c.y);d.x=(e.x+f.x+c.x)/3;d.y=(e.y+f.y+c.y)/3;return 0.5*((f.x-e.x)*(c.y-e.y)-(f.y-e.y)*(c.x-e.x))},getLength:function(){return this.m_length},getVertex1:function(){return this.m_v1},getVertex2:function(){return this.m_v2},getCoreVertex1:function(){return this.m_coreV1},getCoreVertex2:function(){return this.m_coreV2},
getNormalVector:function(){return this.m_normal},getDirectionVector:function(){return this.m_direction},getCorner1Vector:function(){return this.m_cornerDir1},getCorner2Vector:function(){return this.m_cornerDir2},corner1IsConvex:function(){return this.m_cornerConvex1},corner2IsConvex:function(){return this.m_cornerConvex2},getFirstVertex:function(a){var b=a.R;return new t(a.position.x+(b.col1.x*this.m_coreV1.x+b.col2.x*this.m_coreV1.y),a.position.y+(b.col1.y*this.m_coreV1.x+b.col2.y*this.m_coreV1.y))},
getNextEdge:function(){return this.m_nextEdge},getPrevEdge:function(){return this.m_prevEdge},support:function(a,b,c){var d=a.R,e=a.position.x+(d.col1.x*this.m_coreV1.x+d.col2.x*this.m_coreV1.y),f=a.position.y+(d.col1.y*this.m_coreV1.x+d.col2.y*this.m_coreV1.y),g=a.position.x+(d.col1.x*this.m_coreV2.x+d.col2.x*this.m_coreV2.y);a=a.position.y+(d.col1.y*this.m_coreV2.x+d.col2.y*this.m_coreV2.y);e*b+f*c>g*b+a*c?(this.s_supportVec.x=e,this.s_supportVec.y=f):(this.s_supportVec.x=g,this.s_supportVec.y=
a);return this.s_supportVec},setPrevEdge:function(a,b,c,d){this.m_prevEdge=a;this.m_coreV1=b;this.m_cornerDir1=c;this.m_cornerConvex1=d},setNextEdge:function(a,b,c,d){this.m_nextEdge=a;this.m_coreV2=b;this.m_cornerDir2=c;this.m_cornerConvex2=d},__class__:Ec});var $d=function(){this.mass=0;this.center=new t(0,0);this.I=0};$d.__name__=["box2D","collision","shapes","B2MassData"];$d.prototype={__class__:$d};var qa=function(){za.call(this);this.m_type=ba.POLYGON_SHAPE;this.m_centroid=new t;this.m_vertices=
[];this.m_normals=[]};qa.__name__=["box2D","collision","shapes","B2PolygonShape"];qa.asArray=function(a,b){var c=new qa;c.setAsArray(a,b);return c};qa.asVector=function(a,b){var c=new qa;c.setAsVector(a,b);return c};qa.asBox=function(a,b){var c=new qa;c.setAsBox(a,b);return c};qa.asOrientedBox=function(a,b,c,d){null==d&&(d=0);var e=new qa;e.setAsOrientedBox(a,b,c,d);return e};qa.asEdge=function(a,b){var c=new qa;c.setAsEdge(a,b);return c};qa.computeCentroid=function(a,b){for(var c=new t,d=0,e=0;e<
b;){var f=e++,g=a[f],f=f+1<b?a[f+1|0]:a[0],k=0.5*((g.x-0)*(f.y-0)-(g.y-0)*(f.x-0)),d=d+k;c.x+=0.3333333333333333*k*(0+g.x+f.x);c.y+=0.3333333333333333*k*(0+g.y+f.y)}c.x*=1/d;c.y*=1/d;return c};qa.computeOBB=function(a,b,c){for(var d=[],e=0;e<c;){var f=e++;d[f]=b[f]}d[c]=d[0];b=Number.MAX_VALUE;e=1;for(f=c+1;e<f;){for(var g=e++,k=d[g-1|0],h=d[g].x-k.x,l=d[g].y-k.y,g=Math.sqrt(h*h+l*l),h=h/g,l=l/g,m=-l,u=h,q=g=Number.MAX_VALUE,p=-Number.MAX_VALUE,r=-Number.MAX_VALUE,n=0,t=c;n<t;){var s=n++,v=d[s].x-
k.x,w=d[s].y-k.y,s=h*v+l*w,v=m*v+u*w;s<g&&(g=s);v<q&&(q=v);s>p&&(p=s);v>r&&(r=v)}n=(p-g)*(r-q);n<0.95*b&&(b=n,a.R.col1.x=h,a.R.col1.y=l,a.R.col2.x=m,a.R.col2.y=u,h=0.5*(g+p),l=0.5*(q+r),m=a.R,a.center.x=k.x+(m.col1.x*h+m.col2.x*l),a.center.y=k.y+(m.col1.y*h+m.col2.y*l),a.extents.x=0.5*(p-g),a.extents.y=0.5*(r-q))}};qa.__super__=za;qa.prototype=r(za.prototype,{copy:function(){var a=new qa;a.set(this);return a},set:function(a){za.prototype.set.call(this,a);if(y.__instanceof(a,qa)){a=y.__cast(a,qa);
this.m_centroid.setV(a.m_centroid);this.m_vertexCount=a.m_vertexCount;this.reserve(this.m_vertexCount);for(var b=0,c=this.m_vertexCount;b<c;){var d=b++;this.m_vertices[d].setV(a.m_vertices[d]);this.m_normals[d].setV(a.m_normals[d])}}},setAsArray:function(a,b){null==b&&(b=0);for(var c=[],d=0;d<a.length;){var e=a[d];++d;c.push(e)}this.setAsVector(c,b)},setAsVector:function(a,b){null==b&&(b=0);0==b&&(b=a.length);v.b2Assert(2<=b);this.m_vertexCount=b|0;this.reserve(b|0);for(var c=0,d=this.m_vertexCount;c<
d;){var e=c++;this.m_vertices[e].setV(a[e])}c=0;for(d=this.m_vertexCount;c<d;){var e=c++,f=q.subtractVV(this.m_vertices[e+1<this.m_vertexCount?e+1:0],this.m_vertices[e]);v.b2Assert(f.lengthSquared()>Number.MIN_VALUE);this.m_normals[e].setV(q.crossVF(f,1));this.m_normals[e].normalize()}this.m_centroid=qa.computeCentroid(this.m_vertices,this.m_vertexCount)},setAsBox:function(a,b){this.m_vertexCount=4;this.reserve(4);this.m_vertices[0].set(-a,-b);this.m_vertices[1].set(a,-b);this.m_vertices[2].set(a,
b);this.m_vertices[3].set(-a,b);this.m_normals[0].set(0,-1);this.m_normals[1].set(1,0);this.m_normals[2].set(0,1);this.m_normals[3].set(-1,0);this.m_centroid.setZero()},setAsOrientedBox:function(a,b,c,d){null==d&&(d=0);this.m_vertexCount=4;this.reserve(4);this.m_vertices[0].set(-a,-b);this.m_vertices[1].set(a,-b);this.m_vertices[2].set(a,b);this.m_vertices[3].set(-a,b);this.m_normals[0].set(0,-1);this.m_normals[1].set(1,0);this.m_normals[2].set(0,1);this.m_normals[3].set(-1,0);this.m_centroid=c;a=
new qb;a.position=c;a.R.set(d);c=0;for(d=this.m_vertexCount;c<d;)b=c++,this.m_vertices[b]=q.mulX(a,this.m_vertices[b]),this.m_normals[b]=q.mulMV(a.R,this.m_normals[b])},setAsEdge:function(a,b){this.m_vertexCount=2;this.reserve(2);this.m_vertices[0].setV(a);this.m_vertices[1].setV(b);this.m_centroid.x=0.5*(a.x+b.x);this.m_centroid.y=0.5*(a.y+b.y);this.m_normals[0]=q.crossVF(q.subtractVV(b,a),1);this.m_normals[0].normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y},
testPoint:function(a,b){var c;c=a.R;for(var d=b.x-a.position.x,e=b.y-a.position.y,f=d*c.col1.x+e*c.col1.y,g=d*c.col2.x+e*c.col2.y,k=0,h=this.m_vertexCount;k<h;){var l=k++;c=this.m_vertices[l];d=f-c.x;e=g-c.y;c=this.m_normals[l];if(0<c.x*d+c.y*e)return!1}return!0},rayCast:function(a,b,c){var d=0,e=b.maxFraction,f,g,k,h;f=b.p1.x-c.position.x;g=b.p1.y-c.position.y;k=c.R;var l=f*k.col1.x+g*k.col1.y,m=f*k.col2.x+g*k.col2.y;f=b.p2.x-c.position.x;g=b.p2.y-c.position.y;k=c.R;b=f*k.col1.x+g*k.col1.y-l;k=f*
k.col2.x+g*k.col2.y-m;for(var u=-1,q=0,p=this.m_vertexCount;q<p;){var r=q++;h=this.m_vertices[r];f=h.x-l;g=h.y-m;h=this.m_normals[r];f=h.x*f+h.y*g;g=h.x*b+h.y*k;if(0==g){if(0>f)return!1}else 0>g&&f<d*g?(d=f/g,u=r):0<g&&f<e*g&&(e=f/g);if(e<d-Number.MIN_VALUE)return!1}return 0<=u?(a.fraction=d,k=c.R,h=this.m_normals[u],a.normal.x=k.col1.x*h.x+k.col2.x*h.y,a.normal.y=k.col1.y*h.x+k.col2.y*h.y,!0):!1},computeAABB:function(a,b){for(var c=b.R,d=this.m_vertices[0],e=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),
f=b.position.y+(c.col1.y*d.x+c.col2.y*d.y),g=e,k=f,h=1,l=this.m_vertexCount;h<l;){var m=h++,d=this.m_vertices[m],m=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),d=b.position.y+(c.col1.y*d.x+c.col2.y*d.y);e<m||(e=m);f<d||(f=d);g>m||(g=m);k>d||(k=d)}a.lowerBound.x=e-this.m_radius;a.lowerBound.y=f-this.m_radius;a.upperBound.x=g+this.m_radius;a.upperBound.y=k+this.m_radius},computeMass:function(a,b){if(2==this.m_vertexCount)a.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=0.5*(this.m_vertices[0].y+
this.m_vertices[1].y),a.mass=0,a.I=0;else{for(var c=0,d=0,e=0,f=0,g=0,k=this.m_vertexCount;g<k;)var h=g++,l=this.m_vertices[h],m=h+1<this.m_vertexCount?this.m_vertices[h+1|0]:this.m_vertices[0],u=l.x-0,q=l.y-0,p=m.x-0,r=m.y-0,h=u*r-q*p,n=0.5*h,e=e+n,c=c+0.3333333333333333*n*(0+l.x+m.x),d=d+0.3333333333333333*n*(0+l.y+m.y),l=u,f=f+h*(0.3333333333333333*(0.25*(l*l+p*l+p*p)+(0*l+0*p))+0+(0.3333333333333333*(0.25*(q*q+r*q+r*r)+(0*q+0*r))+0));a.mass=b*e;a.center.set(c*(1/e),d*(1/e));a.I=b*f}},computeSubmergedArea:function(a,
b,c,d){var e=q.mulTMV(c.R,a),f=b-q.dot(a,c.position),g=[],k=0;a=b=-1;for(var h=!1,l=0,m=this.m_vertexCount;l<m;){var u=l++;g[u]=q.dot(e,this.m_vertices[u])-f;var p=g[u]<-Number.MIN_VALUE;0<u&&(p?h||(b=u-1,++k):h&&(a=u-1,++k));h=p}switch(k){case 0:return h?(a=new $d,this.computeMass(a,1),d.setV(q.mulX(c,a.center)),a.mass):0;case 1:-1==b?b=this.m_vertexCount-1:a=this.m_vertexCount-1}f=(b+1)%this.m_vertexCount;e=(a+1)%this.m_vertexCount;k=(0-g[b])/(g[f]-g[b]);g=(0-g[a])/(g[e]-g[a]);b=new t(this.m_vertices[b].x*
(1-k)+this.m_vertices[f].x*k,this.m_vertices[b].y*(1-k)+this.m_vertices[f].y*k);a=new t(this.m_vertices[a].x*(1-g)+this.m_vertices[e].x*g,this.m_vertices[a].y*(1-g)+this.m_vertices[e].y*g);g=0;k=new t;for(h=this.m_vertices[f];f!=e;)f=(f+1)%this.m_vertexCount,l=f==e?a:this.m_vertices[f],m=0.5*((h.x-b.x)*(l.y-b.y)-(h.y-b.y)*(l.x-b.x)),g+=m,k.x+=m*(b.x+h.x+l.x)/3,k.y+=m*(b.y+h.y+l.y)/3,h=l;k.multiply(1/g);d.setV(q.mulX(c,k));return g},getVertexCount:function(){return this.m_vertexCount},getVertices:function(){return this.m_vertices},
getNormals:function(){return this.m_normals},getSupport:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_vertexCount;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return b},getSupportVertex:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_vertexCount;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return this.m_vertices[b]},validate:function(){return!1},
reserve:function(a){for(var b=this.m_vertices.length;b<a;){var c=b++;this.m_vertices[c]=new t;this.m_normals[c]=new t}},__class__:qa});var ba={__ename__:!0,__constructs__:["UNKNOWN_SHAPE","CIRCLE_SHAPE","POLYGON_SHAPE","EDGE_SHAPE"],UNKNOWN_SHAPE:["UNKNOWN_SHAPE",0]};ba.UNKNOWN_SHAPE.__enum__=ba;ba.CIRCLE_SHAPE=["CIRCLE_SHAPE",1];ba.CIRCLE_SHAPE.__enum__=ba;ba.POLYGON_SHAPE=["POLYGON_SHAPE",2];ba.POLYGON_SHAPE.__enum__=ba;ba.EDGE_SHAPE=["EDGE_SHAPE",3];ba.EDGE_SHAPE.__enum__=ba;ba.__empty_constructs__=
[ba.UNKNOWN_SHAPE,ba.CIRCLE_SHAPE,ba.POLYGON_SHAPE,ba.EDGE_SHAPE];var ae=function(a,b,c){this._r=255*q.clamp(a,0,1)|0;this._g=255*q.clamp(b,0,1)|0;this._b=255*q.clamp(c,0,1)|0};ae.__name__=["box2D","common","B2Color"];ae.prototype={set:function(a,b,c){this._r=255*q.clamp(a,0,1)|0;this._g=255*q.clamp(b,0,1)|0;this._b=255*q.clamp(c,0,1)|0},toHex:function(){return"#"+this.componentToHex(this._r)+this.componentToHex(this._g)+this.componentToHex(this._b)},componentToHex:function(a){a=a.toString(16);return"1"==
a.length?"0"+a:a},set_r:function(a){return this._r=255*q.clamp(a,0,1)|0},set_g:function(a){return this._g=255*q.clamp(a,0,1)|0},set_b:function(a){return this._b=255*q.clamp(a,0,1)|0},get_r:function(){return this._r},get_g:function(){return this._g},get_b:function(){return this._b},get_color:function(){return this._r<<16|this._g<<8|this._b},__class__:ae,__properties__:{get_color:"get_color",set_b:"set_b",set_g:"set_g",set_r:"set_r"}};var v=function(){};v.__name__=["box2D","common","B2Settings"];v.b2MixFriction=
function(a,b){return Math.sqrt(a*b)};v.b2MixRestitution=function(a,b){return a>b?a:b};v.b2Assert=function(a){if(!a)throw new H("Assertion Failed");};var fc=function(a,b,c){this.col1=new Oa;this.col2=new Oa;this.col3=new Oa;null==a&&null==b&&null==c?(this.col1.setZero(),this.col2.setZero(),this.col3.setZero()):(this.col1.setV(a),this.col2.setV(b),this.col3.setV(c))};fc.__name__=["box2D","common","math","B2Mat33"];fc.prototype={setVVV:function(a,b,c){this.col1.setV(a);this.col2.setV(b);this.col3.setV(c)},
copy:function(){return new fc(this.col1,this.col2,this.col3)},setM:function(a){this.col1.setV(a.col1);this.col2.setV(a.col2);this.col3.setV(a.col3)},addM:function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col1.z+=a.col1.z;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y;this.col2.z+=a.col2.z;this.col3.x+=a.col3.x;this.col3.y+=a.col3.y;this.col3.z+=a.col3.z},setIdentity:function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=
1},setZero:function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0},solve22:function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,k=d*g-e*f;0!=k&&(k=1/k);a.x=k*(g*b-e*c);a.y=k*(d*c-f*b);return a},solve33:function(a,b,c,d){var e=this.col1.x,f=this.col1.y,g=this.col1.z,k=this.col2.x,h=this.col2.y,l=this.col2.z,m=this.col3.x,u=this.col3.y,q=this.col3.z,p=e*(h*q-l*u)+f*(l*m-k*q)+g*(k*u-h*m);0!=p&&(p=
1/p);a.x=p*(b*(h*q-l*u)+c*(l*m-k*q)+d*(k*u-h*m));a.y=p*(e*(c*q-d*u)+f*(d*m-b*q)+g*(b*u-c*m));a.z=p*(e*(h*d-l*c)+f*(l*b-k*d)+g*(k*c-h*b));return a},__class__:fc};var q=function(){};q.__name__=["box2D","common","math","B2Math"];q.__properties__={get_MAX_VALUE:"get_MAX_VALUE",get_MIN_VALUE:"get_MIN_VALUE"};q.isValid=function(a){return isNaN(a)||-Infinity==a||Infinity==a?!1:!0};q.dot=function(a,b){return a.x*b.x+a.y*b.y};q.crossVV=function(a,b){return a.x*b.y-a.y*b.x};q.crossVF=function(a,b){return new t(b*
a.y,-b*a.x)};q.crossFV=function(a,b){return new t(-a*b.y,a*b.x)};q.mulMV=function(a,b){return new t(a.col1.x*b.x+a.col2.x*b.y,a.col1.y*b.x+a.col2.y*b.y)};q.mulTMV=function(a,b){return new t(q.dot(b,a.col1),q.dot(b,a.col2))};q.mulX=function(a,b){var c=q.mulMV(a.R,b);c.x+=a.position.x;c.y+=a.position.y;return c};q.mulXT=function(a,b){var c=q.subtractVV(b,a.position),d=c.x*a.R.col1.x+c.y*a.R.col1.y;c.y=c.x*a.R.col2.x+c.y*a.R.col2.y;c.x=d;return c};q.addVV=function(a,b){return new t(a.x+b.x,a.y+b.y)};
q.subtractVV=function(a,b){return new t(a.x-b.x,a.y-b.y)};q.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)};q.distanceSquared=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};q.mulFV=function(a,b){return new t(a*b.x,a*b.y)};q.addMM=function(a,b){return ja.fromVV(q.addVV(a.col1,b.col1),q.addVV(a.col2,b.col2))};q.mulMM=function(a,b){return ja.fromVV(q.mulMV(a,b.col1),q.mulMV(a,b.col2))};q.mulTMM=function(a,b){var c=new t(q.dot(a.col1,b.col1),q.dot(a.col2,b.col1)),d=new t(q.dot(a.col1,
b.col2),q.dot(a.col2,b.col2));return ja.fromVV(c,d)};q.abs=function(a){return 0<a?a:-a};q.absV=function(a){return new t(q.abs(a.x),q.abs(a.y))};q.absM=function(a){return ja.fromVV(q.absV(a.col1),q.absV(a.col2))};q.min=function(a,b){return a<b?a:b};q.minV=function(a,b){return new t(q.min(a.x,b.x),q.min(a.y,b.y))};q.max=function(a,b){return a>b?a:b};q.maxV=function(a,b){return new t(q.max(a.x,b.x),q.max(a.y,b.y))};q.clamp=function(a,b,c){return a<b?b:a>c?c:a};q.clampV=function(a,b,c){return q.maxV(b,
q.minV(a,c))};q.swap=function(a,b){var c=a[0];a[0]=b[0];b[0]=c};q.random=function(){return 2*Math.random()-1};q.randomRange=function(a,b){var c=Math.random();return(b-a)*c+a};q.nextPowerOfTwo=function(a){a|=a>>1&2147483647;a|=a>>2&1073741823;a|=a>>4&268435455;a|=a>>8&16777215;return(a|a>>16&65535)+1};q.isPowerOfTwo=function(a){return 0<a&&0==(a&a-1)};q.get_MIN_VALUE=function(){return Number.MIN_VALUE};q.get_MAX_VALUE=function(){return Number.MAX_VALUE};var Jb=function(){this.localCenter=new t;this.c0=
new t;this.c=new t};Jb.__name__=["box2D","common","math","B2Sweep"];Jb.prototype={set:function(a){this.localCenter.setV(a.localCenter);this.c0.setV(a.c0);this.c.setV(a.c);this.a0=a.a0;this.a=a.a;this.t0=a.t0},copy:function(){var a=new Jb;a.localCenter.setV(this.localCenter);a.c0.setV(this.c0);a.c.setV(this.c);a.a0=this.a0;a.a=this.a;a.t0=this.t0;return a},getTransform:function(a,b){a.position.x=(1-b)*this.c0.x+b*this.c.x;a.position.y=(1-b)*this.c0.y+b*this.c.y;a.R.set((1-b)*this.a0+b*this.a);var c=
a.R;a.position.x-=c.col1.x*this.localCenter.x+c.col2.x*this.localCenter.y;a.position.y-=c.col1.y*this.localCenter.x+c.col2.y*this.localCenter.y},advance:function(a){if(this.t0<a&&1-this.t0>Number.MIN_VALUE){var b=(a-this.t0)/(1-this.t0);this.c0.x=(1-b)*this.c0.x+b*this.c.x;this.c0.y=(1-b)*this.c0.y+b*this.c.y;this.a0=(1-b)*this.a0+b*this.a;this.t0=a}},__class__:Jb};var Oa=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c};Oa.__name__=["box2D","common","math",
"B2Vec3"];Oa.prototype={setZero:function(){this.x=this.y=this.z=0},set:function(a,b,c){this.x=a;this.y=b;this.z=c},setV:function(a){this.x=a.x;this.y=a.y;this.z=a.z},getNegative:function(){return new Oa(-this.x,-this.y,-this.z)},negativeSelf:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z},copy:function(){return new Oa(this.x,this.y,this.z)},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z},subtract:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z},multiply:function(a){this.x*=a;this.y*=
a;this.z*=a},__class__:Oa};var z=function(a,b){this.m_xf=new qb;this.m_sweep=new Jb;this.m_linearVelocity=new t;this.m_force=new t;this.m_flags=0;a.bullet&&(this.m_flags|=z.e_bulletFlag);a.fixedRotation&&(this.m_flags|=z.e_fixedRotationFlag);a.allowSleep&&(this.m_flags|=z.e_allowSleepFlag);a.awake&&(this.m_flags|=z.e_awakeFlag);a.active&&(this.m_flags|=z.e_activeFlag);this.m_world=b;this.m_xf.position.setV(a.position);this.m_xf.R.set(a.angle);this.m_sweep.localCenter.setZero();this.m_sweep.t0=1;this.m_sweep.a0=
this.m_sweep.a=a.angle;var c=this.m_xf.R,d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.setV(this.m_sweep.c);this.m_contactList=this.m_controllerList=this.m_jointList=null;this.m_controllerCount=0;this.m_next=this.m_prev=null;this.m_linearVelocity.setV(a.linearVelocity);this.m_angularVelocity=a.angularVelocity;this.m_linearDamping=a.linearDamping;
this.m_angularDamping=a.angularDamping;this.m_force.set(0,0);this.m_sleepTime=this.m_torque=0;this.m_type=a.type;this.m_invMass=this.m_type==z.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_inertiaScale=a.inertiaScale;this.m_userData=a.userData;this.m_fixtureList=null;this.m_fixtureCount=0};z.__name__=["box2D","dynamics","B2Body"];z.prototype={connectEdges:function(a,b,c){var d=Math.atan2(b.getDirectionVector().y,b.getDirectionVector().x);c=Math.tan(0.5*(d-c));c=q.mulFV(c,
b.getDirectionVector());c=q.subtractVV(c,b.getNormalVector());c=q.mulFV(v.b2_toiSlop,c);c=q.addVV(c,b.getVertex1());var e=q.addVV(a.getDirectionVector(),b.getDirectionVector());e.normalize();var f=0<q.dot(a.getDirectionVector(),b.getNormalVector());a.setNextEdge(b,c,e,f);b.setPrevEdge(a,c,e,f);return d},createFixture:function(a){if(!0==this.m_world.isLocked())return null;var b=new zb;b.create(this,this.m_xf,a);0!=(this.m_flags&z.e_activeFlag)&&b.createProxy(this.m_world.m_contactManager.m_broadPhase,
this.m_xf);b.m_next=this.m_fixtureList;this.m_fixtureList=b;++this.m_fixtureCount;b.m_body=this;0<b.m_density&&this.resetMassData();this.m_world.m_flags|=ea.e_newFixture;return b},createFixture2:function(a,b){null==b&&(b=0);var c=new Jf;c.shape=a;c.density=b;return this.createFixture(c)},DestroyFixture:function(a){if(!0!=this.m_world.isLocked()){for(var b=this.m_fixtureList,c=null;null!=b;){if(b==a){null!=c?c.m_next=a.m_next:this.m_fixtureList=a.m_next;break}c=b;b=b.m_next}for(b=this.m_contactList;null!=
b;){var c=b.contact,b=b.next,d=c.getFixtureA(),e=c.getFixtureB();a!=d&&a!=e||this.m_world.m_contactManager.destroy(c)}0!=(this.m_flags&z.e_activeFlag)&&a.destroyProxy(this.m_world.m_contactManager.m_broadPhase);a.destroy();a.m_body=null;a.m_next=null;--this.m_fixtureCount;this.resetMassData()}},setPositionAndAngle:function(a,b){var c;if(!0!=this.m_world.isLocked()){this.m_xf.R.set(b);this.m_xf.position.setV(a);c=this.m_xf.R;var d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;
this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.setV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=b;d=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;null!=c;)c.synchronize(d,this.m_xf,this.m_xf),c=c.m_next;this.m_world.m_contactManager.findNewContacts()}},setTransform:function(a){this.setPositionAndAngle(a.position,a.getAngle())},getTransform:function(){return this.m_xf},getPosition:function(){return this.m_xf.position},
setPosition:function(a){this.setPositionAndAngle(a,this.getAngle())},getAngle:function(){return this.m_sweep.a},setAngle:function(a){this.setPositionAndAngle(this.getPosition(),a)},getWorldCenter:function(){return this.m_sweep.c},getLocalCenter:function(){return this.m_sweep.localCenter},setLinearVelocity:function(a){this.m_type!=z.b2_staticBody&&this.m_linearVelocity.setV(a)},getLinearVelocity:function(){return this.m_linearVelocity},setAngularVelocity:function(a){this.m_type!=z.b2_staticBody&&(this.m_angularVelocity=
a)},getAngularVelocity:function(){return this.m_angularVelocity},getDefinition:function(){var a=new be;a.type=this.getType();a.allowSleep=(this.m_flags&z.e_allowSleepFlag)==z.e_allowSleepFlag;a.angle=this.getAngle();a.angularDamping=this.m_angularDamping;a.angularVelocity=this.m_angularVelocity;a.fixedRotation=(this.m_flags&z.e_fixedRotationFlag)==z.e_fixedRotationFlag;a.bullet=(this.m_flags&z.e_bulletFlag)==z.e_bulletFlag;a.awake=(this.m_flags&z.e_awakeFlag)==z.e_awakeFlag;a.linearDamping=this.m_linearDamping;
a.linearVelocity.setV(this.getLinearVelocity());a.position=this.getPosition();a.userData=this.getUserData();return a},applyForce:function(a,b){this.m_type==z.b2_dynamicBody&&(!1==this.isAwake()&&this.setAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)},applyTorque:function(a){this.m_type==z.b2_dynamicBody&&(!1==this.isAwake()&&this.setAwake(!0),this.m_torque+=a)},applyImpulse:function(a,b){this.m_type==z.b2_dynamicBody&&(!1==this.isAwake()&&
this.setAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x))},split:function(a){for(var b=this.getLinearVelocity().copy(),c=this.getAngularVelocity(),d=this.getWorldCenter(),e=this.m_world.createBody(this.getDefinition()),f=null,g=this.m_fixtureList;null!=g;)if(a(g)){var k=g.m_next;null!=f?f.m_next=k:this.m_fixtureList=k;this.m_fixtureCount--;g.m_next=e.m_fixtureList;
e.m_fixtureList=g;e.m_fixtureCount++;g.m_body=e;g=k}else f=g,g=g.m_next;this.resetMassData();e.resetMassData();f=this.getWorldCenter();a=e.getWorldCenter();f=q.addVV(b,q.crossFV(c,q.subtractVV(f,d)));b=q.addVV(b,q.crossFV(c,q.subtractVV(a,d)));this.setLinearVelocity(f);e.setLinearVelocity(b);this.setAngularVelocity(c);e.setAngularVelocity(c);this.synchronizeFixtures();e.synchronizeFixtures();return e},merge:function(a){for(var b=a.m_fixtureList;null!=b;){var c=b.m_next;a.m_fixtureCount--;b.m_next=
this.m_fixtureList;this.m_fixtureList=b;this.m_fixtureCount++;b.m_body=a;b=c}this.m_fixtureCount=0;this.getWorldCenter();a.getWorldCenter();this.getLinearVelocity().copy();a.getLinearVelocity().copy();this.getAngularVelocity();a.getAngularVelocity();this.resetMassData();this.synchronizeFixtures()},getMass:function(){return this.m_mass},getInertia:function(){return this.m_I},getMassData:function(a){a.mass=this.m_mass;a.I=this.m_I;a.center.setV(this.m_sweep.localCenter)},setMassData:function(a){v.b2Assert(!1==
this.m_world.isLocked());if(!0!=this.m_world.isLocked()&&this.m_type==z.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=a.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<a.I&&0==(this.m_flags&z.e_fixedRotationFlag)&&(this.m_I=a.I-this.m_mass*(a.center.x*a.center.x+a.center.y*a.center.y),this.m_invI=1/this.m_I);var b=this.m_sweep.c.copy();this.m_sweep.localCenter.setV(a.center);this.m_sweep.c0.setV(q.mulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.setV(this.m_sweep.c0);
this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-b.y);this.m_linearVelocity.y+=this.m_angularVelocity*(this.m_sweep.c.x-b.x)}},resetMassData:function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.setZero();if(this.m_type!=z.b2_staticBody&&this.m_type!=z.b2_kinematicBody){for(var a=t.make(0,0),b=this.m_fixtureList;null!=b;)if(0!=b.m_density){var c=b.getMassData();this.m_mass+=c.mass;a.x+=c.center.x*c.mass;a.y+=c.center.y*c.mass;this.m_I+=c.I;b=b.m_next}0<
this.m_mass?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&0==(this.m_flags&z.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(a.x*a.x+a.y*a.y),this.m_I*=this.m_inertiaScale,v.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;b=this.m_sweep.c.copy();this.m_sweep.localCenter.setV(a);this.m_sweep.c0.setV(q.mulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.setV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*
-(this.m_sweep.c.y-b.y);this.m_linearVelocity.y+=this.m_angularVelocity*(this.m_sweep.c.x-b.x)}},getWorldPoint:function(a){var b=this.m_xf.R;a=new t(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return a},getWorldVector:function(a){return q.mulMV(this.m_xf.R,a)},getLocalPoint:function(a){return q.mulXT(this.m_xf,a)},getLocalVector:function(a){return q.mulTMV(this.m_xf.R,a)},getLinearVelocityFromWorldPoint:function(a){return new t(this.m_linearVelocity.x-
this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},getLinearVelocityFromLocalPoint:function(a){var b=this.m_xf.R;a=new t(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return new t(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},getLinearDamping:function(){return this.m_linearDamping},
setLinearDamping:function(a){this.m_linearDamping=a},getAngularDamping:function(){return this.m_angularDamping},setAngularDamping:function(a){this.m_angularDamping=a},setType:function(a){if(this.m_type!=a)for(this.m_type=a,this.resetMassData(),this.m_type==z.b2_staticBody&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0,a=this.m_contactList;null!=a;)a.contact.flagForFiltering(),a=a.next},getType:function(){return this.m_type},setBullet:function(a){this.m_flags=
a?this.m_flags|z.e_bulletFlag:this.m_flags&~z.e_bulletFlag},isBullet:function(){return(this.m_flags&z.e_bulletFlag)==z.e_bulletFlag},setSleepingAllowed:function(a){a?this.m_flags|=z.e_allowSleepFlag:(this.m_flags&=~z.e_allowSleepFlag,this.setAwake(!0))},setAwake:function(a){a?(this.m_flags|=z.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~z.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},isAwake:function(){return(this.m_flags&
z.e_awakeFlag)==z.e_awakeFlag},setFixedRotation:function(a){this.m_flags=a?this.m_flags|z.e_fixedRotationFlag:this.m_flags&~z.e_fixedRotationFlag;this.resetMassData()},isFixedRotation:function(){return(this.m_flags&z.e_fixedRotationFlag)==z.e_fixedRotationFlag},setActive:function(a){if(a!=this.isActive()){var b;if(a)for(this.m_flags|=z.e_activeFlag,a=this.m_world.m_contactManager.m_broadPhase,b=this.m_fixtureList;null!=b;)b.createProxy(a,this.m_xf),b=b.m_next;else{this.m_flags&=~z.e_activeFlag;a=
this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;null!=b;)b.destroyProxy(a),b=b.m_next;for(a=this.m_contactList;null!=a;)b=a,a=a.next,this.m_world.m_contactManager.destroy(b.contact);this.m_contactList=null}}},isActive:function(){return(this.m_flags&z.e_activeFlag)==z.e_activeFlag},isSleepingAllowed:function(){return(this.m_flags&z.e_allowSleepFlag)==z.e_allowSleepFlag},getFixtureList:function(){return this.m_fixtureList},getJointList:function(){return this.m_jointList},getControllerList:function(){return this.m_controllerList},
getContactList:function(){return this.m_contactList},getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},setUserData:function(a){this.m_userData=a},getWorld:function(){return this.m_world},synchronizeFixtures:function(){var a=z.s_xf1;a.R.set(this.m_sweep.a0);var b=a.R,c=this.m_sweep.localCenter;a.position.x=this.m_sweep.c0.x-(b.col1.x*c.x+b.col2.x*c.y);a.position.y=this.m_sweep.c0.y-(b.col1.y*c.x+b.col2.y*c.y);c=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;null!=
b;)b.synchronize(c,a,this.m_xf),b=b.m_next},synchronizeTransform:function(){this.m_xf.R.set(this.m_sweep.a);var a=this.m_xf.R,b=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*b.x+a.col2.x*b.y);this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*b.x+a.col2.y*b.y)},shouldCollide:function(a){if(this.m_type!=z.b2_dynamicBody&&a.m_type!=z.b2_dynamicBody)return!1;for(var b=this.m_jointList;null!=b;){if(b.other==a&&!1==b.joint.m_collideConnected)return!1;b=b.next}return!0},advance:function(a){this.m_sweep.advance(a);
this.m_sweep.c.setV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.synchronizeTransform()},__class__:z};var be=function(){this.position=new t;this.linearVelocity=new t;this.userData=null;this.angularDamping=this.linearDamping=this.angularVelocity=this.angle=0;this.awake=this.allowSleep=!0;this.bullet=this.fixedRotation=!1;this.type=z.b2_staticBody;this.active=!0;this.inertiaScale=1};be.__name__=["box2D","dynamics","B2BodyDef"];be.prototype={__class__:be};var fd=function(){};fd.__name__=["box2D",
"dynamics","B2ContactFilter"];fd.prototype={shouldCollide:function(a,b){var c=a.getFilterData(),d=b.getFilterData();return c.groupIndex==d.groupIndex&&0!=c.groupIndex?0<c.groupIndex:0!=(c.maskBits&d.categoryBits)&&0!=(c.categoryBits&d.maskBits)},rayCollide:function(a,b){return null==a?!0:this.shouldCollide(y.__cast(a,zb),b)},__class__:fd};var Kf=function(){this.normalImpulses=[];this.tangentImpulses=[]};Kf.__name__=["box2D","dynamics","B2ContactImpulse"];Kf.prototype={__class__:Kf};var ib=function(){};
ib.__name__=["box2D","dynamics","B2ContactListener"];ib.prototype={beginContact:function(a){},endContact:function(a){},preSolve:function(a,b){},postSolve:function(a,b){},__class__:ib};var ce=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=fd.b2_defaultFilter;this.m_contactListener=ib.b2_defaultListener;this.m_contactFactory=new Lf(this.m_allocator);this.m_broadPhase=new Zd};ce.__name__=["box2D","dynamics","B2ContactManager"];ce.prototype={addPair:function(a,b){var c=y.__cast(a,
zb),d=y.__cast(b,zb),e=c.getBody(),f=d.getBody();if(e!=f){for(var g=f.getContactList();null!=g;){if(g.other==e){var k=g.contact.getFixtureA(),h=g.contact.getFixtureB();if(k==c&&h==d||k==d&&h==c)return}g=g.next}!1!=f.shouldCollide(e)&&!1!=this.m_contactFilter.shouldCollide(c,d)&&(g=this.m_contactFactory.create(c,d),c=g.getFixtureA(),d=g.getFixtureB(),e=c.m_body,f=d.m_body,g.m_prev=null,g.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=g),this.m_world.m_contactList=
g,g.m_nodeA.contact=g,g.m_nodeA.other=f,g.m_nodeA.prev=null,g.m_nodeA.next=e.m_contactList,null!=e.m_contactList&&(e.m_contactList.prev=g.m_nodeA),e.m_contactList=g.m_nodeA,g.m_nodeB.contact=g,g.m_nodeB.other=e,g.m_nodeB.prev=null,g.m_nodeB.next=f.m_contactList,null!=f.m_contactList&&(f.m_contactList.prev=g.m_nodeB),f.m_contactList=g.m_nodeB,++this.m_world.m_contactCount)}},findNewContacts:function(){this.m_broadPhase.updatePairs(w(this,this.addPair))},destroy:function(a){var b=a.getFixtureA(),c=
a.getFixtureB(),b=b.getBody(),c=c.getBody();a.isTouching()&&this.m_contactListener.endContact(a);null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_world.m_contactList&&(this.m_world.m_contactList=a.m_next);null!=a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next);null!=a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev);a.m_nodeA==b.m_contactList&&(b.m_contactList=a.m_nodeA.next);null!=a.m_nodeB.prev&&(a.m_nodeB.prev.next=a.m_nodeB.next);null!=a.m_nodeB.next&&
(a.m_nodeB.next.prev=a.m_nodeB.prev);a.m_nodeB==c.m_contactList&&(c.m_contactList=a.m_nodeB.next);this.m_contactFactory.destroy(a);--this.m_contactCount},collide:function(){for(var a=this.m_world.m_contactList;null!=a;){var b=a.getFixtureA(),c=a.getFixtureB(),d=b.getBody(),e=c.getBody();if(!1==d.isAwake()&&!1==e.isAwake())a=a.getNext();else{if(0!=(a.m_flags&D.e_filterFlag)){if(!1==e.shouldCollide(d)){b=a;a=b.getNext();this.destroy(b);continue}if(!1==this.m_contactFilter.shouldCollide(b,c)){b=a;a=
b.getNext();this.destroy(b);continue}a.m_flags&=~D.e_filterFlag}!1==this.m_broadPhase.testOverlap(b.m_proxy,c.m_proxy)?(b=a,a=b.getNext(),this.destroy(b)):(a.update(this.m_contactListener),a=a.getNext())}}},__class__:ce};var Ca=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;this.m_drawFlags=0};Ca.__name__=["box2D","dynamics","B2DebugDraw"];Ca.prototype={setFlags:function(a){this.m_drawFlags=a},getFlags:function(){return this.m_drawFlags},appendFlags:function(a){this.m_drawFlags|=
a},clearFlags:function(a){this.m_drawFlags&=~a},setSprite:function(a){this.m_sprite=a},getSprite:function(){return this.m_sprite},setDrawScale:function(a){this.m_drawScale=a},getDrawScale:function(){return this.m_drawScale},setLineThickness:function(a){this.m_lineThickness=a},getLineThickness:function(){return this.m_lineThickness},setAlpha:function(a){this.m_alpha=a},getAlpha:function(){return this.m_alpha},setFillAlpha:function(a){this.m_fillAlpha=a},getFillAlpha:function(){return this.m_fillAlpha},
setXFormScale:function(a){this.m_xformScale=a},getXFormScale:function(){return this.m_xformScale},drawPolygon:function(a,b,c){console.log("drawPolygon()");this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);for(c=1;c<b;){var d=c++;this.m_sprite.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale)}this.m_sprite.lineTo(a[0].x*this.m_drawScale,
a[0].y*this.m_drawScale);this.m_sprite.stroke()},drawSolidPolygon:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);c="rgba("+c.get_r()+","+c.get_g()+","+c.get_b()+","+this.m_fillAlpha;this.m_sprite.fillStyle=c+")";for(c=1;c<b;){var d=c++;this.m_sprite.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale)}this.m_sprite.lineTo(a[0].x*
this.m_drawScale,a[0].y*this.m_drawScale);this.m_sprite.stroke();this.m_sprite.fill()},drawCircle:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.arc(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale,0,2*Math.PI,!1);this.m_sprite.stroke()},drawSolidCircle:function(a,b,c,d){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=d.toHex();this.m_sprite.globalAlpha=
this.m_alpha;this.m_sprite.beginPath();c="rgba("+d.get_r()+","+d.get_g()+","+d.get_b()+","+this.m_fillAlpha;this.m_sprite.fillStyle=c+")";this.m_sprite.arc(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale,0,2*Math.PI,!1);this.m_sprite.stroke();this.m_sprite.fill()},drawSegment:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a.x*this.m_drawScale,a.y*this.m_drawScale);
this.m_sprite.lineTo(b.x*this.m_drawScale,b.y*this.m_drawScale);this.m_sprite.stroke()},drawTransform:function(a){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle="#FF0000";this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a.position.x*this.m_drawScale,a.position.y*this.m_drawScale);this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col1.x)*this.m_drawScale,(a.position.y+this.m_xformScale*a.R.col1.y)*this.m_drawScale);this.m_sprite.lineWidth=
this.m_lineThickness;this.m_sprite.strokeStyle="#00FF00";this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.moveTo(a.position.x*this.m_drawScale,a.position.y*this.m_drawScale);this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col2.x)*this.m_drawScale,(a.position.y+this.m_xformScale*a.R.col2.y)*this.m_drawScale);this.m_sprite.stroke()},__class__:Ca};var gd=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};gd.__name__=["box2D","dynamics","B2FilterData"];gd.prototype={copy:function(){var a=
new gd;a.categoryBits=this.categoryBits;a.maskBits=this.maskBits;a.groupIndex=this.groupIndex;return a},__class__:gd};var zb=function(){this.m_filter=new gd;this.m_aabb=new Za;this.m_shape=this.m_next=this.m_body=this.m_userData=null;this.m_restitution=this.m_friction=this.m_density=0};zb.__name__=["box2D","dynamics","B2Fixture"];zb.prototype={getType:function(){return this.m_shape.getType()},getShape:function(){return this.m_shape},setSensor:function(a){if(this.m_isSensor!=a&&(this.m_isSensor=a,
null!=this.m_body))for(a=this.m_body.getContactList();null!=a;){var b=a.contact,c=b.getFixtureA(),d=b.getFixtureB();c!=this&&d!=this||b.setSensor(c.isSensor()||d.isSensor());a=a.next}},isSensor:function(){return this.m_isSensor},setFilterData:function(a){this.m_filter=a.copy();if(null==this.m_body)for(a=this.m_body.getContactList();null!=a;){var b=a.contact,c=b.getFixtureA(),d=b.getFixtureB();c!=this&&d!=this||b.flagForFiltering();a=a.next}},getFilterData:function(){return this.m_filter.copy()},getBody:function(){return this.m_body},
getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},SetUserData:function(a){this.m_userData=a},testPoint:function(a){return this.m_shape.testPoint(this.m_body.getTransform(),a)},rayCast:function(a,b){return this.m_shape.rayCast(a,b,this.m_body.getTransform())},getMassData:function(a){null==a&&(a=new $d);this.m_shape.computeMass(a,this.m_density);return a},setDensity:function(a){this.m_density=a},getDensity:function(){return this.m_density},getFriction:function(){return this.m_friction},
setFriction:function(a){this.m_friction=a},getRestitution:function(){return this.m_restitution},setRestitution:function(a){this.m_restitution=a},getAABB:function(){return this.m_aabb},create:function(a,b,c){this.m_userData=c.userData;this.m_friction=c.friction;this.m_restitution=c.restitution;this.m_body=a;this.m_next=null;this.m_filter=c.filter.copy();this.m_isSensor=c.isSensor;this.m_shape=c.shape.copy();this.m_density=c.density},destroy:function(){this.m_shape=null},createProxy:function(a,b){this.m_shape.computeAABB(this.m_aabb,
b);this.m_proxy=a.createProxy(this.m_aabb,this)},destroyProxy:function(a){null!=this.m_proxy&&(a.destroyProxy(this.m_proxy),this.m_proxy=null)},synchronize:function(a,b,c){if(null!=this.m_proxy){var d=new Za,e=new Za;this.m_shape.computeAABB(d,b);this.m_shape.computeAABB(e,c);this.m_aabb.combine(d,e);b=q.subtractVV(c.position,b.position);a.moveProxy(this.m_proxy,this.m_aabb,b)}},__class__:zb};var Jf=function(){this.filter=new gd;this.userData=this.shape=null;this.friction=0.2;this.density=this.restitution=
0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;this.isSensor=!1};Jf.__name__=["box2D","dynamics","B2FixtureDef"];Jf.prototype={__class__:Jf};var gc=function(){this.m_bodies=[];this.m_contacts=[];this.m_joints=[]};gc.__name__=["box2D","dynamics","B2Island"];gc.prototype={initialize:function(a,b,c,d,e,f){this.m_bodyCapacity=a;this.m_contactCapacity=b;this.m_jointCapacity=c;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=d;this.m_listener=e;
this.m_contactSolver=f;for(d=this.m_bodies.length;d<a;)e=d++,this.m_bodies[e]=null;for(a=this.m_contacts.length;a<b;)d=a++,this.m_contacts[d]=null;for(b=this.m_joints.length;b<c;)a=b++,this.m_joints[a]=null},clear:function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0},solve:function(a,b,c){for(var d,e=0,f=this.m_bodyCount;e<f;)d=e++,d=this.m_bodies[d],d.getType()==z.b2_dynamicBody&&(d.m_linearVelocity.x+=a.dt*(b.x+d.m_invMass*d.m_force.x),d.m_linearVelocity.y+=a.dt*(b.y+d.m_invMass*
d.m_force.y),d.m_angularVelocity+=a.dt*d.m_invI*d.m_torque,d.m_linearVelocity.multiply(q.clamp(1-a.dt*d.m_linearDamping,0,1)),d.m_angularVelocity*=q.clamp(1-a.dt*d.m_angularDamping,0,1));this.m_contactSolver.initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);b=this.m_contactSolver;b.initVelocityConstraints(a);e=0;for(f=this.m_jointCount;e<f;)d=e++,d=this.m_joints[d],d.initVelocityConstraints(a);e=0;for(f=a.velocityIterations;e<f;){e++;for(var g=0,k=this.m_jointCount;g<k;)d=g++,d=this.m_joints[d],
d.solveVelocityConstraints(a);b.solveVelocityConstraints()}e=0;for(f=this.m_jointCount;e<f;)d=e++,d=this.m_joints[d],d.finalizeVelocityConstraints();b.finalizeVelocityConstraints();e=0;for(f=this.m_bodyCount;e<f;)d=e++,d=this.m_bodies[d],d.getType()!=z.b2_staticBody&&(g=a.dt*d.m_linearVelocity.x,k=a.dt*d.m_linearVelocity.y,g*g+k*k>v.b2_maxTranslationSquared&&(d.m_linearVelocity.normalize(),d.m_linearVelocity.x*=v.b2_maxTranslation*a.inv_dt,d.m_linearVelocity.y*=v.b2_maxTranslation*a.inv_dt),g=a.dt*
d.m_angularVelocity,g*g>v.b2_maxRotationSquared&&(d.m_angularVelocity=0>d.m_angularVelocity?-v.b2_maxRotation*a.inv_dt:v.b2_maxRotation*a.inv_dt),d.m_sweep.c0.setV(d.m_sweep.c),d.m_sweep.a0=d.m_sweep.a,d.m_sweep.c.x+=a.dt*d.m_linearVelocity.x,d.m_sweep.c.y+=a.dt*d.m_linearVelocity.y,d.m_sweep.a+=a.dt*d.m_angularVelocity,d.synchronizeTransform());e=0;for(f=a.positionIterations;e<f;){e++;for(var g=b.solvePositionConstraints(v.b2_contactBaumgarte),k=!0,h=0,l=this.m_jointCount;h<l;)d=h++,d=this.m_joints[d],
d=d.solvePositionConstraints(v.b2_contactBaumgarte),k=k?d:!1;if(g&&k)break}this.report(b.m_constraints);if(c){c=Number.MAX_VALUE;b=v.b2_linearSleepTolerance*v.b2_linearSleepTolerance;e=v.b2_angularSleepTolerance*v.b2_angularSleepTolerance;f=0;for(g=this.m_bodyCount;f<g;)d=f++,d=this.m_bodies[d],d.getType()!=z.b2_staticBody&&(0==(d.m_flags&z.e_allowSleepFlag)&&(c=d.m_sleepTime=0),0==(d.m_flags&z.e_allowSleepFlag)||d.m_angularVelocity*d.m_angularVelocity>e||q.dot(d.m_linearVelocity,d.m_linearVelocity)>
b?c=d.m_sleepTime=0:(d.m_sleepTime+=a.dt,c=q.min(c,d.m_sleepTime)));if(c>=v.b2_timeToSleep)for(a=0,c=this.m_bodyCount;a<c;)b=a++,d=this.m_bodies[b],d.setAwake(!1)}},solveTOI:function(a){this.m_contactSolver.initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);for(var b=this.m_contactSolver,c=0,d=this.m_jointCount;c<d;){var e=c++;this.m_joints[e].initVelocityConstraints(a)}c=0;for(d=a.velocityIterations;c<d;){c++;b.solveVelocityConstraints();for(var e=0,f=this.m_jointCount;e<f;){var g=
e++;this.m_joints[g].solveVelocityConstraints(a)}}c=0;for(d=this.m_bodyCount;c<d;)e=c++,e=this.m_bodies[e],e.getType()!=z.b2_staticBody&&(f=a.dt*e.m_linearVelocity.x,g=a.dt*e.m_linearVelocity.y,f*f+g*g>v.b2_maxTranslationSquared&&(e.m_linearVelocity.normalize(),e.m_linearVelocity.x*=v.b2_maxTranslation*a.inv_dt,e.m_linearVelocity.y*=v.b2_maxTranslation*a.inv_dt),f=a.dt*e.m_angularVelocity,f*f>v.b2_maxRotationSquared&&(e.m_angularVelocity=0>e.m_angularVelocity?-v.b2_maxRotation*a.inv_dt:v.b2_maxRotation*
a.inv_dt),e.m_sweep.c0.setV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=a.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=a.dt*e.m_linearVelocity.y,e.m_sweep.a+=a.dt*e.m_angularVelocity,e.synchronizeTransform());c=0;for(a=a.positionIterations;c<a;){c++;d=b.solvePositionConstraints(0.75);e=!0;f=0;for(g=this.m_jointCount;f<g;)var k=f++,k=this.m_joints[k].solvePositionConstraints(v.b2_contactBaumgarte),e=e?k:!1;if(d&&e)break}this.report(b.m_constraints)},report:function(a){if(null!=this.m_listener)for(var b=
0,c=this.m_contactCount;b<c;){for(var d=b++,e=this.m_contacts[d],d=a[d],f=0,g=d.pointCount;f<g;){var k=f++;gc.s_impulse.normalImpulses[k]=d.points[k].normalImpulse;gc.s_impulse.tangentImpulses[k]=d.points[k].tangentImpulse}this.m_listener.postSolve(e,gc.s_impulse)}},addBody:function(a){a.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=a},addContact:function(a){this.m_contacts[this.m_contactCount++]=a},addJoint:function(a){this.m_joints[this.m_jointCount++]=a},__class__:gc};var hd=
function(){};hd.__name__=["box2D","dynamics","B2TimeStep"];hd.prototype={set:function(a){this.dt=a.dt;this.inv_dt=a.inv_dt;this.positionIterations=a.positionIterations;this.velocityIterations=a.velocityIterations;this.warmStarting=a.warmStarting},__class__:hd};var ea=function(a,b){this.s_stack=[];this.m_contactManager=new ce;this.m_contactSolver=new Ga;this.m_island=new gc;this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null;this.m_controllerCount=
this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;ea.m_warmStarting=!0;ea.m_continuousPhysics=!0;this.m_allowSleep=b;this.m_gravity=a;this.m_inv_dt0=0;this.m_contactManager.m_world=this;var c=new be;this.m_groundBody=this.createBody(c)};ea.__name__=["box2D","dynamics","B2World"];ea.prototype={setDestructionListener:function(a){this.m_destructionListener=a},setContactFilter:function(a){this.m_contactManager.m_contactFilter=a},setContactListener:function(a){this.m_contactManager.m_contactListener=
a},setDebugDraw:function(a){this.m_debugDraw=a},setBroadPhase:function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;null!=c;){for(var d=c.m_fixtureList;null!=d;)d.m_proxy=a.createProxy(b.getFatAABB(d.m_proxy),d),d=d.m_next;c=c.m_next}},validate:function(){this.m_contactManager.m_broadPhase.validate()},getProxyCount:function(){return this.m_contactManager.m_broadPhase.getProxyCount()},createBody:function(a){if(!0==this.isLocked())return null;
a=new z(a,this);a.m_prev=null;a.m_next=this.m_bodyList;null!=this.m_bodyList&&(this.m_bodyList.m_prev=a);this.m_bodyList=a;++this.m_bodyCount;return a},destroyBody:function(a){if(!0!=this.isLocked()){for(var b=a.m_jointList;null!=b;){var c=b,b=b.next;null!=this.m_destructionListener&&this.m_destructionListener.sayGoodbyeJoint(c.joint);this.destroyJoint(c.joint)}for(b=a.m_controllerList;null!=b;)c=b,b=b.nextController,c.controller.removeBody(a);for(b=a.m_contactList;null!=b;)c=b,b=b.next,this.m_contactManager.destroy(c.contact);
a.m_contactList=null;for(b=a.m_fixtureList;null!=b;)c=b,b=b.m_next,null!=this.m_destructionListener&&this.m_destructionListener.sayGoodbyeFixture(c),c.destroyProxy(this.m_contactManager.m_broadPhase),c.destroy();a.m_fixtureList=null;a.m_fixtureCount=0;null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_bodyList&&(this.m_bodyList=a.m_next);--this.m_bodyCount}},createJoint:function(a){var b=fa.create(a,null);b.m_prev=null;b.m_next=this.m_jointList;null!=this.m_jointList&&
(this.m_jointList.m_prev=b);this.m_jointList=b;++this.m_jointCount;b.m_edgeA.joint=b;b.m_edgeA.other=b.m_bodyB;b.m_edgeA.prev=null;b.m_edgeA.next=b.m_bodyA.m_jointList;null!=b.m_bodyA.m_jointList&&(b.m_bodyA.m_jointList.prev=b.m_edgeA);b.m_bodyA.m_jointList=b.m_edgeA;b.m_edgeB.joint=b;b.m_edgeB.other=b.m_bodyA;b.m_edgeB.prev=null;b.m_edgeB.next=b.m_bodyB.m_jointList;null!=b.m_bodyB.m_jointList&&(b.m_bodyB.m_jointList.prev=b.m_edgeB);b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,d=a.bodyB;if(!1==a.collideConnected)for(a=
d.getContactList();null!=a;)a.other==c&&a.contact.flagForFiltering(),a=a.next;return b},destroyJoint:function(a){var b=a.m_collideConnected;null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_jointList&&(this.m_jointList=a.m_next);var c=a.m_bodyA,d=a.m_bodyB;c.setAwake(!0);d.setAwake(!0);null!=a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next);null!=a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev);a.m_edgeA==c.m_jointList&&(c.m_jointList=a.m_edgeA.next);
a.m_edgeA.prev=null;a.m_edgeA.next=null;null!=a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next);null!=a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev);a.m_edgeB==d.m_jointList&&(d.m_jointList=a.m_edgeB.next);a.m_edgeB.prev=null;a.m_edgeB.next=null;fa.destroy(a,null);--this.m_jointCount;if(!1==b)for(a=d.getContactList();null!=a;)a.other==c&&a.contact.flagForFiltering(),a=a.next},addController:function(a){a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList=a;a.m_world=this;this.m_controllerCount++;
return a},removeController:function(a){null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);this.m_controllerList==a&&(this.m_controllerList=a.m_next);this.m_controllerCount--},createController:function(a){if(a.m_world!=this)throw new H("Controller can only be a member of one world");a.m_next=this.m_controllerList;a.m_prev=null;null!=this.m_controllerList&&(this.m_controllerList.m_prev=a);this.m_controllerList=a;++this.m_controllerCount;a.m_world=this;return a},destroyController:function(a){a.clear();
null!=a.m_next&&(a.m_next.m_prev=a.m_prev);null!=a.m_prev&&(a.m_prev.m_next=a.m_next);a==this.m_controllerList&&(this.m_controllerList=a.m_next);--this.m_controllerCount},setWarmStarting:function(a){ea.m_warmStarting=a},setContinuousPhysics:function(a){ea.m_continuousPhysics=a},getBodyCount:function(){return this.m_bodyCount},getJointCount:function(){return this.m_jointCount},getContactCount:function(){return this.m_contactCount},setGravity:function(a){this.m_gravity=a},getGravity:function(){return this.m_gravity},
getGroundBody:function(){return this.m_groundBody},step:function(a,b,c){0!=(this.m_flags&ea.e_newFixture)&&(this.m_contactManager.findNewContacts(),this.m_flags&=~ea.e_newFixture);this.m_flags|=ea.e_locked;var d=ea.s_timestep2;d.dt=a;d.velocityIterations=b;d.positionIterations=c;d.inv_dt=0<a?1/a:0;d.dtRatio=this.m_inv_dt0*a;d.warmStarting=ea.m_warmStarting;this.m_contactManager.collide();0<d.dt&&this.solve(d);ea.m_continuousPhysics&&0<d.dt&&this.solveTOI(d);0<d.dt&&(this.m_inv_dt0=d.inv_dt);this.m_flags&=
~ea.e_locked},clearForces:function(){for(var a=this.m_bodyList;null!=a;)a.m_force.setZero(),a.m_torque=0,a=a.m_next},drawDebugData:function(){if(null!=this.m_debugDraw){var a=this.m_debugDraw.getFlags(),b,c,d;new t;new t;new t;var e;new Za;new Za;e=[new t,new t,new t,new t];var f=new ae(0,0,0);if(0!=(a&Ca.e_shapeBit))for(b=this.m_bodyList;null!=b;){e=b.m_xf;for(c=b.getFixtureList();null!=c;)d=c.getShape(),!1==b.isActive()?f.set(0.5,0.5,0.3):b.getType()==z.b2_staticBody?f.set(0.5,0.9,0.5):b.getType()==
z.b2_kinematicBody?f.set(0.5,0.5,0.9):!1==b.isAwake()?f.set(0.6,0.6,0.6):f.set(0.9,0.7,0.7),this.drawShape(d,e,f),c=c.m_next;b=b.m_next}if(0!=(a&Ca.e_jointBit))for(b=this.m_jointList;null!=b;)this.drawJoint(b),b=b.m_next;if(0!=(a&Ca.e_controllerBit))for(b=this.m_controllerList;null!=b;)b.draw(this.m_debugDraw),b=b.m_next;if(0!=(a&Ca.e_pairBit))for(f.set(0.3,0.9,0.9),b=this.m_contactManager.m_contactList;null!=b;)d=b.getFixtureA(),c=b.getFixtureB(),d=d.getAABB().getCenter(),c=c.getAABB().getCenter(),
this.m_debugDraw.drawSegment(d,c,f),b=b.getNext();if(0!=(a&Ca.e_aabbBit))for(d=this.m_contactManager.m_broadPhase,e=[new t,new t,new t,new t],b=this.m_bodyList;null!=b;){if(!1!=b.isActive())for(c=b.getFixtureList();null!=c;){var g=d.getFatAABB(c.m_proxy);e[0].set(g.lowerBound.x,g.lowerBound.y);e[1].set(g.upperBound.x,g.lowerBound.y);e[2].set(g.upperBound.x,g.upperBound.y);e[3].set(g.lowerBound.x,g.upperBound.y);this.m_debugDraw.drawPolygon(e,4,f);c=c.getNext()}b=b.getNext()}if(0!=(a&Ca.e_centerOfMassBit))for(b=
this.m_bodyList;null!=b;)e=ea.s_xf,e.R=b.m_xf.R,e.position=b.getWorldCenter(),this.m_debugDraw.drawTransform(e),b=b.m_next}},queryAABB:function(a,b){var c=this.m_contactManager.m_broadPhase;c.query(function(b){b=c.getUserData(b);return a(b)},b)},queryShape:function(a,b,c){null==c&&(c=new qb,c.setIdentity());var d=this.m_contactManager.m_broadPhase,e=new Za;b.computeAABB(e,c);d.query(function(e){e=y.__cast(d.getUserData(e),zb);var g=e.getShape(),k=e.getBody().getTransform();return za.testOverlap(b,
c,g,k)?a(e):!0},e)},queryPoint:function(a,b){var c=this.m_contactManager.m_broadPhase,d=new Za;d.lowerBound.set(b.x-v.b2_linearSlop,b.y-v.b2_linearSlop);d.upperBound.set(b.x+v.b2_linearSlop,b.y+v.b2_linearSlop);c.query(function(d){d=y.__cast(c.getUserData(d),zb);return d.testPoint(b)?a(d):!0},d)},rayCast:function(a,b,c){var d=this.m_contactManager.m_broadPhase,e=new Ef,f=new Yd(b,c);d.rayCast(function(f,k){var h=d.getUserData(k),h=y.__cast(h,zb);if(h.rayCast(e,f)){var l=e.fraction,m=new t((1-l)*b.x+
l*c.x,(1-l)*b.y+l*c.y);return a(h,m,e.normal,l)}return f.maxFraction},f)},rayCastOne:function(a,b){var c;this.rayCast(function(a,b,f,g){c=a;return g},a,b);return c},rayCastAll:function(a,b){var c=[];this.rayCast(function(a,b,f,g){c[c.length]=a;return 1},a,b);return c},getBodyList:function(){return this.m_bodyList},getJointList:function(){return this.m_jointList},getContactList:function(){return this.m_contactList},isLocked:function(){return 0<(this.m_flags&ea.e_locked)},solve:function(a){for(var b,
c=this.m_controllerList;null!=c;)c.step(a),c=c.m_next;var d=this.m_island;d.initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(b=this.m_bodyList;null!=b;)b.m_flags&=~z.e_islandFlag,b=b.m_next;for(c=this.m_contactList;null!=c;)c.m_flags&=~D.e_islandFlag,c=c.m_next;for(c=this.m_jointList;null!=c;)c.m_islandFlag=!1,c=c.m_next;for(var c=this.s_stack,e=this.m_bodyList;null!=e;){if(0==(e.m_flags&z.e_islandFlag)&&!1!=e.isAwake()&&
!1!=e.isActive()&&e.getType()!=z.b2_staticBody){d.clear();var f=0;c[f++]=e;for(e.m_flags|=z.e_islandFlag;0<f;)if(b=c[--f],d.addBody(b),!1==b.isAwake()&&b.setAwake(!0),b.getType()!=z.b2_staticBody){for(var g,k=b.m_contactList;null!=k;)0==(k.contact.m_flags&D.e_islandFlag)&&(!0!=k.contact.isSensor()&&!1!=k.contact.isEnabled()&&!1!=k.contact.isTouching())&&(d.addContact(k.contact),k.contact.m_flags|=D.e_islandFlag,g=k.other,0==(g.m_flags&z.e_islandFlag)&&(c[f++]=g,g.m_flags|=z.e_islandFlag)),k=k.next;
for(b=b.m_jointList;null!=b;)!0!=b.joint.m_islandFlag&&(g=b.other,!1!=g.isActive()&&(d.addJoint(b.joint),b.joint.m_islandFlag=!0,0==(g.m_flags&z.e_islandFlag)&&(c[f++]=g,g.m_flags|=z.e_islandFlag))),b=b.next}d.solve(a,this.m_gravity,this.m_allowSleep);f=0;for(g=d.m_bodyCount;f<g;)b=f++,b=d.m_bodies[b],b.getType()==z.b2_staticBody&&(b.m_flags&=~z.e_islandFlag)}e=e.m_next}a=0;for(d=c.length;a<d;){e=a++;if(null==c[e])break;c[e]=null}for(b=this.m_bodyList;null!=b;)!1!=b.isAwake()&&!1!=b.isActive()&&b.getType()!=
z.b2_staticBody&&b.synchronizeFixtures(),b=b.m_next;this.m_contactManager.findNewContacts()},solveTOI:function(a){var b,c,d,e,f=this.m_island;f.initialize(this.m_bodyCount,v.b2_maxTOIContactsPerIsland,v.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var g=ea.s_queue;for(b=this.m_bodyList;null!=b;)b.m_flags&=~z.e_islandFlag,b.m_sweep.t0=0,b=b.m_next;for(b=this.m_contactList;null!=b;)b.m_flags&=~(D.e_toiFlag|D.e_islandFlag),b=b.m_next;for(e=this.m_jointList;null!=
e;)e.m_islandFlag=!1,e=e.m_next;for(;;){e=null;var k=1;for(b=this.m_contactList;null!=b;){if(!0!=b.isSensor()&&!1!=b.isEnabled()&&!1!=b.isContinuous()){c=1;if(0!=(b.m_flags&D.e_toiFlag))c=b.m_toi;else{c=b.m_fixtureA;d=b.m_fixtureB;c=c.m_body;d=d.m_body;if(!(c.getType()==z.b2_dynamicBody&&!1!=c.isAwake()||d.getType()==z.b2_dynamicBody&&!1!=d.isAwake())){b=b.m_next;continue}var h=c.m_sweep.t0;c.m_sweep.t0<d.m_sweep.t0?(h=d.m_sweep.t0,c.m_sweep.advance(h)):d.m_sweep.t0<c.m_sweep.t0&&(h=c.m_sweep.t0,
d.m_sweep.advance(h));c=b.computeTOI(c.m_sweep,d.m_sweep);v.b2Assert(0<=c&&1>=c);0<c&&1>c&&(c=(1-c)*h+c,1<c&&(c=1));b.m_toi=c;b.m_flags|=D.e_toiFlag}Number.MIN_VALUE<c&&c<k&&(e=b,k=c)}b=b.m_next}if(null==e||1-100*Number.MIN_VALUE<k)break;c=e.m_fixtureA;d=e.m_fixtureB;c=c.m_body;d=d.m_body;ea.s_backupA.set(c.m_sweep);ea.s_backupB.set(d.m_sweep);c.advance(k);d.advance(k);e.update(this.m_contactManager.m_contactListener);e.m_flags&=~D.e_toiFlag;if(!0==e.isSensor()||!1==e.isEnabled())c.m_sweep.set(ea.s_backupA),
d.m_sweep.set(ea.s_backupB),c.synchronizeTransform(),d.synchronizeTransform();else if(!1!=e.isTouching()){b=c;b.getType()!=z.b2_dynamicBody&&(b=d);f.clear();d=c=0;g[c+d++]=b;for(b.m_flags|=z.e_islandFlag;0<d;)if(b=g[c++],--d,f.addBody(b),!1==b.isAwake()&&b.setAwake(!0),b.getType()==z.b2_dynamicBody){for(e=b.m_contactList;null!=e&&f.m_contactCount!=f.m_contactCapacity;)0==(e.contact.m_flags&D.e_islandFlag)&&(!0!=e.contact.isSensor()&&!1!=e.contact.isEnabled()&&!1!=e.contact.isTouching())&&(f.addContact(e.contact),
e.contact.m_flags|=D.e_islandFlag,h=e.other,0==(h.m_flags&z.e_islandFlag)&&(h.getType()!=z.b2_staticBody&&(h.advance(k),h.setAwake(!0)),g[c+d]=h,++d,h.m_flags|=z.e_islandFlag)),e=e.next;for(b=b.m_jointList;null!=b;)f.m_jointCount!=f.m_jointCapacity&&!0!=b.joint.m_islandFlag&&(h=b.other,!1!=h.isActive()&&(f.addJoint(b.joint),b.joint.m_islandFlag=!0,0==(h.m_flags&z.e_islandFlag)&&(h.getType()!=z.b2_staticBody&&(h.advance(k),h.setAwake(!0)),g[c+d]=h,++d,h.m_flags|=z.e_islandFlag))),b=b.next}b=ea.s_timestep;
b.warmStarting=!1;b.dt=(1-k)*a.dt;b.inv_dt=1/b.dt;b.dtRatio=0;b.velocityIterations=a.velocityIterations;b.positionIterations=a.positionIterations;f.solveTOI(b);k=0;for(c=f.m_bodyCount;k<c;)if(b=k++,b=f.m_bodies[b],b.m_flags&=~z.e_islandFlag,!1!=b.isAwake()&&b.getType()==z.b2_dynamicBody)for(b.synchronizeFixtures(),e=b.m_contactList;null!=e;)e.contact.m_flags&=~D.e_toiFlag,e=e.next;k=0;for(e=f.m_contactCount;k<e;)b=k++,b=f.m_contacts[b],b.m_flags&=~(D.e_toiFlag|D.e_islandFlag);k=0;for(b=f.m_jointCount;k<
b;)e=k++,e=f.m_joints[e],e.m_islandFlag=!1;this.m_contactManager.findNewContacts()}}},drawJoint:function(a){var b=a.getBodyA(),c=a.getBodyB(),d=b.m_xf.position,e=c.m_xf.position,f=a.getAnchorA(),g=a.getAnchorB(),k=ea.s_jointColor;switch(a.m_type[1]){case 3:this.m_debugDraw.drawSegment(f,g,k);break;case 4:b=y.__cast(a,rb);a=b.getGroundAnchorA();b=b.getGroundAnchorB();this.m_debugDraw.drawSegment(a,f,k);this.m_debugDraw.drawSegment(b,g,k);this.m_debugDraw.drawSegment(a,b,k);break;case 5:this.m_debugDraw.drawSegment(f,
g,k);break;default:b!=this.m_groundBody&&this.m_debugDraw.drawSegment(d,f,k),this.m_debugDraw.drawSegment(f,g,k),c!=this.m_groundBody&&this.m_debugDraw.drawSegment(e,g,k)}},drawShape:function(a,b,c){switch(a.m_type[1]){case 1:a=y.__cast(a,ab);var d=q.mulX(b,a.m_p);this.m_debugDraw.drawSolidCircle(d,a.m_radius,b.R.col1,c);break;case 2:d=y.__cast(a,qa);a=d.getVertexCount();for(var d=d.getVertices(),e=[],f=0;f<a;){var g=f++;e[g]=q.mulX(b,d[g])}this.m_debugDraw.drawSolidPolygon(e,a,c);break;case 3:a=
y.__cast(a,Ec),this.m_debugDraw.drawSegment(q.mulX(b,a.getVertex1()),q.mulX(b,a.getVertex2()),c)}},__class__:ea};var D=function(){this.m_nodeA=new de;this.m_nodeB=new de;this.m_manifold=new ed;this.m_oldManifold=new ed};D.__name__=["box2D","dynamics","contacts","B2Contact"];D.prototype={getManifold:function(){return this.m_manifold},getWorldManifold:function(a){var b=this.m_fixtureA.getBody(),c=this.m_fixtureB.getBody(),d=this.m_fixtureA.getShape(),e=this.m_fixtureB.getShape();a.initialize(this.m_manifold,
b.getTransform(),d.m_radius,c.getTransform(),e.m_radius)},isTouching:function(){return(this.m_flags&D.e_touchingFlag)==D.e_touchingFlag},isContinuous:function(){return(this.m_flags&D.e_continuousFlag)==D.e_continuousFlag},setSensor:function(a){this.m_flags=a?this.m_flags|D.e_sensorFlag:this.m_flags&~D.e_sensorFlag},isSensor:function(){return(this.m_flags&D.e_sensorFlag)==D.e_sensorFlag},setEnabled:function(a){this.m_flags=a?this.m_flags|D.e_enabledFlag:this.m_flags&~D.e_enabledFlag},isEnabled:function(){return(this.m_flags&
D.e_enabledFlag)==D.e_enabledFlag},getNext:function(){return this.m_next},getFixtureA:function(){return this.m_fixtureA},getFixtureB:function(){return this.m_fixtureB},flagForFiltering:function(){this.m_flags|=D.e_filterFlag},reset:function(a,b){this.m_flags=D.e_enabledFlag;if(null==a||null==b)this.m_fixtureB=this.m_fixtureA=null;else{if(a.isSensor()||b.isSensor())this.m_flags|=D.e_sensorFlag;var c=a.getBody(),d=b.getBody();if(c.getType()!=z.b2_dynamicBody||c.isBullet()||d.getType()!=z.b2_dynamicBody||
d.isBullet())this.m_flags|=D.e_continuousFlag;this.m_fixtureA=a;this.m_fixtureB=b;this.m_manifold.m_pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null}},update:function(a){var b=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=b;this.m_flags|=D.e_enabledFlag;var c=!1,b=(this.m_flags&D.e_touchingFlag)==
D.e_touchingFlag,d=this.m_fixtureA.m_body,e=this.m_fixtureB.m_body,f=this.m_fixtureA.m_aabb.testOverlap(this.m_fixtureB.m_aabb);if(0!=(this.m_flags&D.e_sensorFlag))f&&(c=this.m_fixtureA.getShape(),f=this.m_fixtureB.getShape(),d=d.getTransform(),e=e.getTransform(),c=za.testOverlap(c,d,f,e)),this.m_manifold.m_pointCount=0;else{d.getType()!=z.b2_dynamicBody||d.isBullet()||e.getType()!=z.b2_dynamicBody||e.isBullet()?this.m_flags|=D.e_continuousFlag:this.m_flags&=~D.e_continuousFlag;if(f){this.evaluate();
for(var c=0<this.m_manifold.m_pointCount,f=0,g=this.m_manifold.m_pointCount;f<g;){var k=f++,k=this.m_manifold.m_points[k];k.m_normalImpulse=0;k.m_tangentImpulse=0;for(var h=k.m_id,l=0,m=this.m_oldManifold.m_pointCount;l<m;){var u=l++,u=this.m_oldManifold.m_points[u];if(u.m_id.get_key()==h.get_key()){k.m_normalImpulse=u.m_normalImpulse;k.m_tangentImpulse=u.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;c!=b&&(d.setAwake(!0),e.setAwake(!0))}this.m_flags=c?this.m_flags|D.e_touchingFlag:
this.m_flags&~D.e_touchingFlag;!1==b&&!0==c&&a.beginContact(this);!0==b&&!1==c&&a.endContact(this);0==(this.m_flags&D.e_sensorFlag)&&a.preSolve(this,this.m_oldManifold)},evaluate:function(){},computeTOI:function(a,b){D.s_input.proxyA.set(this.m_fixtureA.getShape());D.s_input.proxyB.set(this.m_fixtureB.getShape());D.s_input.sweepA=a;D.s_input.sweepB=b;D.s_input.tolerance=v.b2_linearSlop;return C.timeOfImpact(D.s_input)},__class__:D};var Kb=function(){D.call(this)};Kb.__name__=["box2D","dynamics","contacts",
"B2CircleContact"];Kb.create=function(a){return new Kb};Kb.destroy=function(a,b){};Kb.__super__=D;Kb.prototype=r(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();J.collideCircles(this.m_manifold,y.__cast(this.m_fixtureA.getShape(),ab),a.m_xf,y.__cast(this.m_fixtureB.getShape(),ab),b.m_xf)},__class__:Kb});var Nf=function(){this.localPlaneNormal=new t;this.localPoint=new t;this.normal=new t;this.normalMass=
new ja;this.K=new ja;this.points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.points[c]=new Mf}};Nf.__name__=["box2D","dynamics","contacts","B2ContactConstraint"];Nf.prototype={__class__:Nf};var Mf=function(){this.localPoint=new t;this.rA=new t;this.rB=new t};Mf.__name__=["box2D","dynamics","contacts","B2ContactConstraintPoint"];Mf.prototype={__class__:Mf};var de=function(){};de.__name__=["box2D","dynamics","contacts","B2ContactEdge"];de.prototype={__class__:de};var Lf=function(a){this.m_allocator=
a;this.initializeRegisters()};Lf.__name__=["box2D","dynamics","contacts","B2ContactFactory"];Lf.prototype={addType:function(a,b,c,d){var e=c[1],f=d[1];this.m_registers[e][f].createFcn=a;this.m_registers[e][f].destroyFcn=b;this.m_registers[e][f].primary=!0;c!=d&&(this.m_registers[f][e].createFcn=a,this.m_registers[f][e].destroyFcn=b,this.m_registers[f][e].primary=!1)},initializeRegisters:function(){this.m_registers=[];for(var a=0,b=ba.__empty_constructs__.length;a<b;){var c=a++;this.m_registers[c]=
[];for(var d=0,e=ba.__empty_constructs__.length;d<e;){var f=d++;this.m_registers[c][f]=new Of}}this.addType(Kb.create,Kb.destroy,ba.CIRCLE_SHAPE,ba.CIRCLE_SHAPE);this.addType(Lb.create,Lb.destroy,ba.POLYGON_SHAPE,ba.CIRCLE_SHAPE);this.addType(Mb.create,Mb.destroy,ba.POLYGON_SHAPE,ba.POLYGON_SHAPE);this.addType(Nb.create,Nb.destroy,ba.EDGE_SHAPE,ba.CIRCLE_SHAPE);this.addType(Ob.create,Ob.destroy,ba.POLYGON_SHAPE,ba.EDGE_SHAPE)},create:function(a,b){var c=a.getType(),d=b.getType(),c=this.m_registers[c[1]][d[1]];
if(null!=c.pool)return d=c.pool,c.pool=d.m_next,c.poolCount--,d.reset(a,b),d;d=c.createFcn;return null!=d?(c.primary?(d=d(this.m_allocator),d.reset(a,b)):(d=d(this.m_allocator),d.reset(b,a)),d):null},destroy:function(a){0<a.m_manifold.m_pointCount&&(a.m_fixtureA.m_body.setAwake(!0),a.m_fixtureB.m_body.setAwake(!0));var b=a.m_fixtureA.getType(),c=a.m_fixtureB.getType(),b=this.m_registers[b[1]][c[1]];b.poolCount++;a.m_next=b.pool;b.pool=a;b=b.destroyFcn;b(a,this.m_allocator)},__class__:Lf};var Of=function(){};
Of.__name__=["box2D","dynamics","contacts","B2ContactRegister"];Of.prototype={__class__:Of};var id=function(){this.m_normal=new t;this.m_separations=[];this.m_points=[];for(var a=0,b=v.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new t}};id.__name__=["box2D","dynamics","contacts","B2PositionSolverManifold"];id.prototype={initialize:function(a){v.b2Assert(0<a.pointCount);var b,c,d,e,f;switch(a.type[1]){case 0:d=a.bodyA.m_xf.R;c=a.localPoint;b=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*
c.y);e=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyB.m_xf.R;c=a.points[0].localPoint;f=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);d=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);c=f-b;var g=d-e,k=c*c+g*g;k>Number.MIN_VALUE*Number.MIN_VALUE?(k=Math.sqrt(k),this.m_normal.x=c/k,this.m_normal.y=g/k):(this.m_normal.x=1,this.m_normal.y=0);this.m_points[0].x=0.5*(b+f);this.m_points[0].y=0.5*(e+d);this.m_separations[0]=c*this.m_normal.x+g*this.m_normal.y-a.radius;break;case 1:d=
a.bodyA.m_xf.R;c=a.localPlaneNormal;this.m_normal.x=d.col1.x*c.x+d.col2.x*c.y;this.m_normal.y=d.col1.y*c.x+d.col2.y*c.y;d=a.bodyA.m_xf.R;c=a.localPoint;e=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);f=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyB.m_xf.R;g=0;for(k=a.pointCount;g<k;){var h=g++;c=a.points[h].localPoint;b=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);c=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);this.m_separations[h]=(b-e)*this.m_normal.x+(c-f)*this.m_normal.y-
a.radius;this.m_points[h].x=b;this.m_points[h].y=c}break;case 2:d=a.bodyB.m_xf.R;c=a.localPlaneNormal;this.m_normal.x=d.col1.x*c.x+d.col2.x*c.y;this.m_normal.y=d.col1.y*c.x+d.col2.y*c.y;d=a.bodyB.m_xf.R;c=a.localPoint;e=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);f=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyA.m_xf.R;g=0;for(k=a.pointCount;g<k;)h=g++,c=a.points[h].localPoint,b=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y),c=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*
c.y),this.m_separations[h]=(b-e)*this.m_normal.x+(c-f)*this.m_normal.y-a.radius,this.m_points[h].set(b,c);this.m_normal.x*=-1;this.m_normal.y*=-1}},__class__:id};var Ga=function(){this.m_step=new hd;this.m_constraints=[]};Ga.__name__=["box2D","dynamics","contacts","B2ContactSolver"];Ga.prototype={initialize:function(a,b,c,d){var e;this.m_step.set(a);this.m_allocator=d;for(this.m_constraintCount=c;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new Nf;
for(a=0;a<c;){d=a++;e=b[d];var f=e.m_fixtureA,g=e.m_fixtureB,k=f.m_shape.m_radius,h=g.m_shape.m_radius,l=f.m_body,m=g.m_body;e=e.getManifold();var u=v.b2MixFriction(f.getFriction(),g.getFriction()),q=v.b2MixRestitution(f.getRestitution(),g.getRestitution()),p=l.m_linearVelocity.x,r=l.m_linearVelocity.y,n=m.m_linearVelocity.x,t=m.m_linearVelocity.y,s=l.m_angularVelocity,w=m.m_angularVelocity;v.b2Assert(0<e.m_pointCount);Ga.s_worldManifold.initialize(e,l.m_xf,k,m.m_xf,h);f=Ga.s_worldManifold.m_normal.x;
g=Ga.s_worldManifold.m_normal.y;d=this.m_constraints[d];d.bodyA=l;d.bodyB=m;d.manifold=e;d.normal.x=f;d.normal.y=g;d.pointCount=e.m_pointCount;d.friction=u;d.restitution=q;d.localPlaneNormal.x=e.m_localPlaneNormal.x;d.localPlaneNormal.y=e.m_localPlaneNormal.y;d.localPoint.x=e.m_localPoint.x;d.localPoint.y=e.m_localPoint.y;d.radius=k+h;d.type=e.m_type;k=0;for(h=d.pointCount;k<h;){var x=k++,q=e.m_points[x],u=d.points[x];u.normalImpulse=q.m_normalImpulse;u.tangentImpulse=q.m_tangentImpulse;u.localPoint.setV(q.m_localPoint);
var q=u.rA.x=Ga.s_worldManifold.m_points[x].x-l.m_sweep.c.x,z=u.rA.y=Ga.s_worldManifold.m_points[x].y-l.m_sweep.c.y,y=u.rB.x=Ga.s_worldManifold.m_points[x].x-m.m_sweep.c.x,x=u.rB.y=Ga.s_worldManifold.m_points[x].y-m.m_sweep.c.y,B=q*g-z*f,A=y*g-x*f,B=B*B,A=A*A;u.normalMass=1/(l.m_invMass+m.m_invMass+l.m_invI*B+m.m_invI*A);var D=l.m_mass*l.m_invMass+m.m_mass*m.m_invMass,D=D+(l.m_mass*l.m_invI*B+m.m_mass*m.m_invI*A);u.equalizedMass=1/D;A=g;D=-f;B=q*D-z*A;A=y*D-x*A;B*=B;A*=A;u.tangentMass=1/(l.m_invMass+
m.m_invMass+l.m_invI*B+m.m_invI*A);u.velocityBias=0;q=d.normal.x*(n+-w*x-p- -s*z)+d.normal.y*(t+w*y-r-s*q);q<-v.b2_velocityThreshold&&(u.velocityBias+=-d.restitution*q)}2==d.pointCount&&(t=d.points[0],n=d.points[1],e=l.m_invMass,l=l.m_invI,p=m.m_invMass,m=m.m_invI,r=t.rA.x*g-t.rA.y*f,t=t.rB.x*g-t.rB.y*f,s=n.rA.x*g-n.rA.y*f,n=n.rB.x*g-n.rB.y*f,f=e+p+l*r*r+m*t*t,g=e+p+l*s*s+m*n*n,m=e+p+l*r*s+m*t*n,f*f<100*(f*g-m*m)?(d.K.col1.set(f,m),d.K.col2.set(m,g),d.K.getInverse(d.normalMass)):d.pointCount=1)}},
initVelocityConstraints:function(a){for(var b=0,c=this.m_constraintCount;b<c;){var d=b++,d=this.m_constraints[d],e=d.bodyA,f=d.bodyB,g=e.m_invMass,k=e.m_invI,h=f.m_invMass,l=f.m_invI,m=d.normal.x,u=d.normal.y,q=u,p=-m,r;if(a.warmStarting){r=d.pointCount;for(var n=0;n<r;){var t=n++,t=d.points[t];t.normalImpulse*=a.dtRatio;t.tangentImpulse*=a.dtRatio;var s=t.normalImpulse*m+t.tangentImpulse*q,v=t.normalImpulse*u+t.tangentImpulse*p;e.m_angularVelocity-=k*(t.rA.x*v-t.rA.y*s);e.m_linearVelocity.x-=g*s;
e.m_linearVelocity.y-=g*v;f.m_angularVelocity+=l*(t.rB.x*v-t.rB.y*s);f.m_linearVelocity.x+=h*s;f.m_linearVelocity.y+=h*v}}else for(r=d.pointCount,e=0,f=r;e<f;)g=e++,g=d.points[g],g.normalImpulse=0,g.tangentImpulse=0}},solveVelocityConstraints:function(){for(var a,b,c,d,e,f,g,k,h,l,m=0,u=this.m_constraintCount;m<u;){var p=m++;d=this.m_constraints[p];var p=d.bodyA,r=d.bodyB,n=p.m_angularVelocity,t=r.m_angularVelocity,s=p.m_linearVelocity,v=r.m_linearVelocity,w=p.m_invMass,x=p.m_invI,z=r.m_invMass,B=
r.m_invI;k=d.normal.x;var y=h=d.normal.y,A=-k;l=d.friction;g=0;for(f=d.pointCount;g<f;)a=g++,a=d.points[a],b=v.x-t*a.rB.y-s.x+n*a.rA.y,c=v.y+t*a.rB.x-s.y-n*a.rA.x,b=b*y+c*A,b=a.tangentMass*-b,c=l*a.normalImpulse,c=q.clamp(a.tangentImpulse+b,-c,c),b=c-a.tangentImpulse,e=b*y,b*=A,s.x-=w*e,s.y-=w*b,n-=x*(a.rA.x*b-a.rA.y*e),v.x+=z*e,v.y+=z*b,t+=B*(a.rB.x*b-a.rB.y*e),a.tangentImpulse=c;if(1==d.pointCount)a=d.points[0],b=v.x+-t*a.rB.y-s.x- -n*a.rA.y,c=v.y+t*a.rB.x-s.y-n*a.rA.x,d=b*k+c*h,b=-a.normalMass*
(d-a.velocityBias),c=a.normalImpulse+b,0<c||(c=0),b=c-a.normalImpulse,e=b*k,b*=h,s.x-=w*e,s.y-=w*b,n-=x*(a.rA.x*b-a.rA.y*e),v.x+=z*e,v.y+=z*b,t+=B*(a.rB.x*b-a.rB.y*e),a.normalImpulse=c;else{a=d.points[0];y=d.points[1];f=a.normalImpulse;g=y.normalImpulse;e=(v.x-t*a.rB.y-s.x+n*a.rA.y)*k+(v.y+t*a.rB.x-s.y-n*a.rA.x)*h;var D=(v.x-t*y.rB.y-s.x+n*y.rA.y)*k+(v.y+t*y.rB.x-s.y-n*y.rA.x)*h;b=e-a.velocityBias;c=D-y.velocityBias;l=d.K;b-=l.col1.x*f+l.col2.x*g;for(c-=l.col1.y*f+l.col2.y*g;;){l=d.normalMass;A=-(l.col1.x*
b+l.col2.x*c);l=-(l.col1.y*b+l.col2.y*c);if(0<=A&&0<=l){f=A-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;s.x-=w*(d+k);s.y-=w*(f+h);n-=x*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=z*(d+k);v.y+=z*(f+h);t+=B*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=A;y.normalImpulse=l;break}A=-a.normalMass*b;l=0;D=d.K.col1.y*A+c;if(0<=A&&0<=D){f=A-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;s.x-=w*(d+k);s.y-=w*(f+h);n-=x*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=z*(d+k);v.y+=z*(f+h);t+=B*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=
A;y.normalImpulse=l;break}A=0;l=-y.normalMass*c;e=d.K.col2.x*l+b;if(0<=l&&0<=e){f=A-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;s.x-=w*(d+k);s.y-=w*(f+h);n-=x*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=z*(d+k);v.y+=z*(f+h);t+=B*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=A;y.normalImpulse=l;break}l=A=0;e=b;D=c;if(0<=e&&0<=D){f=A-f;g=l-g;d=f*k;f*=h;k*=g;h*=g;s.x-=w*(d+k);s.y-=w*(f+h);n-=x*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);v.x+=z*(d+k);v.y+=z*(f+h);t+=B*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=
A;y.normalImpulse=l;break}break}}p.m_angularVelocity=n;r.m_angularVelocity=t}},finalizeVelocityConstraints:function(){for(var a=0,b=this.m_constraintCount;a<b;)for(var c=a++,c=this.m_constraints[c],d=c.manifold,e=0,f=c.pointCount;e<f;){var g=e++,k=d.m_points[g],g=c.points[g];k.m_normalImpulse=g.normalImpulse;k.m_tangentImpulse=g.tangentImpulse}},solvePositionConstraints:function(a){for(var b=0,c=0,d=this.m_constraintCount;c<d;){var e=c++,e=this.m_constraints[e],f=e.bodyA,g=e.bodyB,k=f.m_mass*f.m_invMass,
h=f.m_mass*f.m_invI,l=g.m_mass*g.m_invMass,m=g.m_mass*g.m_invI;Ga.s_psm.initialize(e);for(var u=Ga.s_psm.m_normal,p=0,n=e.pointCount;p<n;){var r=p++,t=e.points[r],s=Ga.s_psm.m_points[r],w=Ga.s_psm.m_separations[r],r=s.x-f.m_sweep.c.x,x=s.y-f.m_sweep.c.y,y=s.x-g.m_sweep.c.x,s=s.y-g.m_sweep.c.y;b<w||(b=w);w=q.clamp(a*(w+v.b2_linearSlop),-v.b2_maxLinearCorrection,0);w*=-t.equalizedMass;t=w*u.x;w*=u.y;f.m_sweep.c.x-=k*t;f.m_sweep.c.y-=k*w;f.m_sweep.a-=h*(r*w-x*t);f.synchronizeTransform();g.m_sweep.c.x+=
l*t;g.m_sweep.c.y+=l*w;g.m_sweep.a+=m*(y*w-s*t);g.synchronizeTransform()}}return b>-1.5*v.b2_linearSlop},__class__:Ga};var Nb=function(){D.call(this)};Nb.__name__=["box2D","dynamics","contacts","B2EdgeAndCircleContact"];Nb.create=function(a){return new Nb};Nb.destroy=function(a,b){};Nb.__super__=D;Nb.prototype=r(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();this.b2CollideEdgeAndCircle(this.m_manifold,
y.__cast(this.m_fixtureA.getShape(),Ec),a.m_xf,y.__cast(this.m_fixtureB.getShape(),ab),b.m_xf)},b2CollideEdgeAndCircle:function(a,b,c,d,e){},__class__:Nb});var Lb=function(){D.call(this)};Lb.__name__=["box2D","dynamics","contacts","B2PolyAndCircleContact"];Lb.create=function(a){return new Lb};Lb.destroy=function(a,b){};Lb.__super__=D;Lb.prototype=r(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b);v.b2Assert(a.getType()==ba.POLYGON_SHAPE);v.b2Assert(b.getType()==ba.CIRCLE_SHAPE)},
evaluate:function(){var a=this.m_fixtureA.m_body,b=this.m_fixtureB.m_body;J.collidePolygonAndCircle(this.m_manifold,y.__cast(this.m_fixtureA.getShape(),qa),a.m_xf,y.__cast(this.m_fixtureB.getShape(),ab),b.m_xf)},__class__:Lb});var Ob=function(){D.call(this)};Ob.__name__=["box2D","dynamics","contacts","B2PolyAndEdgeContact"];Ob.create=function(a){return new Ob};Ob.destroy=function(a,b){};Ob.__super__=D;Ob.prototype=r(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b);v.b2Assert(a.getType()==
ba.POLYGON_SHAPE);v.b2Assert(b.getType()==ba.EDGE_SHAPE)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();this.b2CollidePolyAndEdge(this.m_manifold,y.__cast(this.m_fixtureA.getShape(),qa),a.m_xf,y.__cast(this.m_fixtureB.getShape(),Ec),b.m_xf)},b2CollidePolyAndEdge:function(a,b,c,d,e){},__class__:Ob});var Mb=function(){D.call(this)};Mb.__name__=["box2D","dynamics","contacts","B2PolygonContact"];Mb.create=function(a){return new Mb};Mb.destroy=function(a,b){};Mb.__super__=
D;Mb.prototype=r(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();J.collidePolygons(this.m_manifold,y.__cast(this.m_fixtureA.getShape(),qa),a.m_xf,y.__cast(this.m_fixtureB.getShape(),qa),b.m_xf)},__class__:Mb});var fa=function(a){this.m_edgeA=new ee;this.m_edgeB=new ee;this.m_localCenterA=new t;this.m_localCenterB=new t;v.b2Assert(a.bodyA!=a.bodyB);this.m_type=a.type;this.m_next=this.m_prev=null;this.m_bodyA=
a.bodyA;this.m_bodyB=a.bodyB;this.m_collideConnected=a.collideConnected;this.m_islandFlag=!1;this.m_userData=a.userData};fa.__name__=["box2D","dynamics","joints","B2Joint"];fa.create=function(a,b){var c=null;switch(a.type[1]){case 1:c=new sb(y.__cast(a,fe));break;case 2:c=new Fc(y.__cast(a,ge));break;case 3:c=new he(y.__cast(a,ie));break;case 4:c=new rb(y.__cast(a,je));break;case 5:c=new ke(y.__cast(a,le));break;case 6:c=new me(y.__cast(a,ne));break;case 7:c=new oe(y.__cast(a,pe));break;case 8:c=
new qe(y.__cast(a,re));break;case 9:c=new se(y.__cast(a,te))}return c};fa.destroy=function(a,b){};fa.prototype={getType:function(){return this.m_type},getAnchorA:function(){return null},getAnchorB:function(){return null},getReactionForce:function(a){return null},getReactionTorque:function(a){return 0},getBodyA:function(){return this.m_bodyA},getBodyB:function(){return this.m_bodyB},getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},setUserData:function(a){this.m_userData=
a},isActive:function(){return this.m_bodyA.isActive()?this.m_bodyB.isActive():!1},initVelocityConstraints:function(a){},solveVelocityConstraints:function(a){},finalizeVelocityConstraints:function(){},solvePositionConstraints:function(a){return!1},__class__:fa};var he=function(a){fa.call(this,a);this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_u=new t;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_length=a.length;this.m_frequencyHz=a.frequencyHz;
this.m_dampingRatio=a.dampingRatio;this.m_bias=this.m_gamma=this.m_impulse=0};he.__name__=["box2D","dynamics","joints","B2DistanceJoint"];he.__super__=fa;he.prototype=r(fa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)},getReactionTorque:function(a){return 0},getLength:function(){return this.m_length},
setLength:function(a){this.m_length=a},getFrequency:function(){return this.m_frequencyHz},setFrequency:function(a){this.m_frequencyHz=a},getDampingRatio:function(){return this.m_dampingRatio},setDampingRatio:function(a){this.m_dampingRatio=a},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchor1.x-d.m_sweep.localCenter.x,g=this.m_localAnchor1.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchor2.x-
e.m_sweep.localCenter.x,h=this.m_localAnchor2.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;this.m_u.x=e.m_sweep.c.x+k-d.m_sweep.c.x-f;this.m_u.y=e.m_sweep.c.y+h-d.m_sweep.c.y-g;c=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);c>v.b2_linearSlop?this.m_u.multiply(1/c):this.m_u.setZero();b=f*this.m_u.y-g*this.m_u.x;var l=k*this.m_u.y-h*this.m_u.x;b=d.m_invMass+d.m_invI*b*b+e.m_invMass+e.m_invI*l*l;this.m_mass=0!=b?1/b:0;if(0<this.m_frequencyHz){c-=this.m_length;
var l=2*Math.PI*this.m_frequencyHz,m=this.m_mass*l*l;this.m_gamma=a.dt*(2*this.m_mass*this.m_dampingRatio*l+a.dt*m);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_bias=c*a.dt*m*this.m_gamma;this.m_mass=b+this.m_gamma;this.m_mass=0!=this.m_mass?1/this.m_mass:0}a.warmStarting?(this.m_impulse*=a.dtRatio,a=this.m_impulse*this.m_u.x,b=this.m_impulse*this.m_u.y,d.m_linearVelocity.x-=d.m_invMass*a,d.m_linearVelocity.y-=d.m_invMass*b,d.m_angularVelocity-=d.m_invI*(f*b-g*a),e.m_linearVelocity.x+=e.m_invMass*
a,e.m_linearVelocity.y+=e.m_invMass*b,e.m_angularVelocity+=e.m_invI*(k*b-h*a)):this.m_impulse=0},solveVelocityConstraints:function(a){var b;a=this.m_bodyA;var c=this.m_bodyB;b=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=b.col1.x*d+b.col2.x*e,e=b.col1.y*d+b.col2.y*e,d=f;b=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*k,k=b.col1.y*g+b.col2.y*k,g=f,f=
-this.m_mass*(this.m_u.x*(c.m_linearVelocity.x+-c.m_angularVelocity*k-(a.m_linearVelocity.x+-a.m_angularVelocity*e))+this.m_u.y*(c.m_linearVelocity.y+c.m_angularVelocity*g-(a.m_linearVelocity.y+a.m_angularVelocity*d))+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;b=f*this.m_u.x;f*=this.m_u.y;a.m_linearVelocity.x-=a.m_invMass*b;a.m_linearVelocity.y-=a.m_invMass*f;a.m_angularVelocity-=a.m_invI*(d*f-e*b);c.m_linearVelocity.x+=c.m_invMass*b;c.m_linearVelocity.y+=c.m_invMass*f;c.m_angularVelocity+=
c.m_invI*(g*f-k*b)},solvePositionConstraints:function(a){var b;if(0<this.m_frequencyHz)return!0;a=this.m_bodyA;var c=this.m_bodyB;b=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=b.col1.x*d+b.col2.x*e,e=b.col1.y*d+b.col2.y*e,d=f;b=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*k,k=b.col1.y*g+b.col2.y*k,g=f,f=c.m_sweep.c.x+g-a.m_sweep.c.x-d,h=c.m_sweep.c.y+
k-a.m_sweep.c.y-e;b=Math.sqrt(f*f+h*h);f/=b;h/=b;b-=this.m_length;b=q.clamp(b,-v.b2_maxLinearCorrection,v.b2_maxLinearCorrection);var l=-this.m_mass*b;this.m_u.set(f,h);f=l*this.m_u.x;h=l*this.m_u.y;a.m_sweep.c.x-=a.m_invMass*f;a.m_sweep.c.y-=a.m_invMass*h;a.m_sweep.a-=a.m_invI*(d*h-e*f);c.m_sweep.c.x+=c.m_invMass*f;c.m_sweep.c.y+=c.m_invMass*h;c.m_sweep.a+=c.m_invI*(g*h-k*f);a.synchronizeTransform();c.synchronizeTransform();return q.abs(b)<v.b2_linearSlop},__class__:he});var ka=function(){this.type=
O.UNKNOWN_JOINT;this.bodyB=this.bodyA=this.userData=null;this.collideConnected=!1};ka.__name__=["box2D","dynamics","joints","B2JointDef"];ka.prototype={__class__:ka};var ie=function(){ka.call(this);this.localAnchorA=new t;this.localAnchorB=new t;this.type=O.DISTANCE_JOINT;this.length=1;this.dampingRatio=this.frequencyHz=0};ie.__name__=["box2D","dynamics","joints","B2DistanceJointDef"];ie.__super__=ka;ie.prototype=r(ka.prototype,{initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));
this.localAnchorB.setV(this.bodyB.getLocalPoint(d));a=d.x-c.x;c=d.y-c.y;this.length=Math.sqrt(a*a+c*c);this.dampingRatio=this.frequencyHz=0},__class__:ie});var se=function(a){fa.call(this,a);this.m_localAnchorA=new t;this.m_localAnchorB=new t;this.m_linearMass=new ja;this.m_linearImpulse=new t;this.m_localAnchorA.setV(a.localAnchorA);this.m_localAnchorB.setV(a.localAnchorB);this.m_linearMass.setZero();this.m_angularMass=0;this.m_linearImpulse.setZero();this.m_angularImpulse=0;this.m_maxForce=a.maxForce;
this.m_maxTorque=a.maxTorque};se.__name__=["box2D","dynamics","joints","B2FrictionJoint"];se.__super__=fa;se.prototype=r(fa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},getReactionForce:function(a){return new t(a*this.m_linearImpulse.x,a*this.m_linearImpulse.y)},getReactionTorque:function(a){return a*this.m_angularImpulse},setMaxForce:function(a){this.m_maxForce=a},getMaxForce:function(){return this.m_maxForce},
setMaxTorque:function(a){this.m_maxTorque=a},getMaxTorque:function(){return this.m_maxTorque},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchorB.x-e.m_sweep.localCenter.x,h=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;b=d.m_invMass;
c=e.m_invMass;var l=d.m_invI,m=e.m_invI,u=new ja;u.col1.x=b+c;u.col2.x=0;u.col1.y=0;u.col2.y=b+c;u.col1.x+=l*g*g;u.col2.x+=-l*f*g;u.col1.y+=-l*f*g;u.col2.y+=l*f*f;u.col1.x+=m*h*h;u.col2.x+=-m*k*h;u.col1.y+=-m*k*h;u.col2.y+=m*k*k;u.getInverse(this.m_linearMass);this.m_angularMass=l+m;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);a.warmStarting?(this.m_linearImpulse.x*=a.dtRatio,this.m_linearImpulse.y*=a.dtRatio,this.m_angularImpulse*=a.dtRatio,a=this.m_linearImpulse,d.m_linearVelocity.x-=
b*a.x,d.m_linearVelocity.y-=b*a.y,d.m_angularVelocity-=l*(f*a.y-g*a.x+this.m_angularImpulse),e.m_linearVelocity.x+=c*a.x,e.m_linearVelocity.y+=c*a.y,e.m_angularVelocity+=m*(k*a.y-h*a.x+this.m_angularImpulse)):(this.m_linearImpulse.setZero(),this.m_angularImpulse=0)},solveVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB,f=d.m_linearVelocity,g=d.m_angularVelocity,k=e.m_linearVelocity,h=e.m_angularVelocity,l=d.m_invMass,m=e.m_invMass,u=d.m_invI,p=e.m_invI;b=d.m_xf.R;var r=this.m_localAnchorA.x-
d.m_sweep.localCenter.x,n=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*r+b.col2.x*n;n=b.col1.y*r+b.col2.y*n;r=c;b=e.m_xf.R;var s=this.m_localAnchorB.x-e.m_sweep.localCenter.x,v=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*s+b.col2.x*v;v=b.col1.y*s+b.col2.y*v;s=c;c=-this.m_angularMass*(h-g);var w=this.m_angularImpulse;b=a.dt*this.m_maxTorque;this.m_angularImpulse=q.clamp(this.m_angularImpulse+c,-b,b);c=this.m_angularImpulse-w;g-=u*c;h+=p*c;b=q.mulMV(this.m_linearMass,new t(-(k.x-
h*v-f.x+g*n),-(k.y+h*s-f.y-g*r)));c=this.m_linearImpulse.copy();this.m_linearImpulse.add(b);b=a.dt*this.m_maxForce;this.m_linearImpulse.lengthSquared()>b*b&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.multiply(b));b=q.subtractVV(this.m_linearImpulse,c);f.x-=l*b.x;f.y-=l*b.y;g-=u*(r*b.y-n*b.x);k.x+=m*b.x;k.y+=m*b.y;h+=p*(s*b.y-v*b.x);d.m_angularVelocity=g;e.m_angularVelocity=h},solvePositionConstraints:function(a){return!0},__class__:se});var te=function(){ka.call(this);this.localAnchorA=
new t;this.localAnchorB=new t;this.type=O.FRICTION_JOINT;this.maxTorque=this.maxForce=0};te.__name__=["box2D","dynamics","joints","B2FrictionJointDef"];te.__super__=ka;te.prototype=r(ka.prototype,{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(c))},__class__:te});var me=function(a){fa.call(this,a);this.m_groundAnchor1=new t;this.m_groundAnchor2=new t;this.m_localAnchor1=new t;this.m_localAnchor2=
new t;this.m_J=new Pf;var b=a.joint1.m_type,c=a.joint2.m_type;this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;this.m_ground1=a.joint1.getBodyA();this.m_bodyA=a.joint1.getBodyB();b==O.REVOLUTE_JOINT?(this.m_revolute1=y.__cast(a.joint1,sb),this.m_groundAnchor1.setV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.setV(this.m_revolute1.m_localAnchor2),b=this.m_revolute1.getJointAngle()):(this.m_prismatic1=y.__cast(a.joint1,Fc),this.m_groundAnchor1.setV(this.m_prismatic1.m_localAnchor1),
this.m_localAnchor1.setV(this.m_prismatic1.m_localAnchor2),b=this.m_prismatic1.getJointTranslation());this.m_ground2=a.joint2.getBodyA();this.m_bodyB=a.joint2.getBodyB();c==O.REVOLUTE_JOINT?(this.m_revolute2=y.__cast(a.joint2,sb),this.m_groundAnchor2.setV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.setV(this.m_revolute2.m_localAnchor2),c=this.m_revolute2.getJointAngle()):(this.m_prismatic2=y.__cast(a.joint2,Fc),this.m_groundAnchor2.setV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.setV(this.m_prismatic2.m_localAnchor2),
c=this.m_prismatic2.getJointTranslation());this.m_ratio=a.ratio;this.m_constant=b+this.m_ratio*c;this.m_impulse=0};me.__name__=["box2D","dynamics","joints","B2GearJoint"];me.__super__=fa;me.prototype=r(fa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*this.m_impulse*this.m_J.linearB.x,a*this.m_impulse*this.m_J.linearB.y)},getReactionTorque:function(a){var b=
this.m_bodyB.m_xf.R,c=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,d=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,e=b.col1.x*c+b.col2.x*d,d=b.col1.y*c+b.col2.y*d;return a*(this.m_impulse*this.m_J.angularB-e*this.m_impulse*this.m_J.linearB.y+d*this.m_impulse*this.m_J.linearB.x)},getRatio:function(){return this.m_ratio},setRatio:function(a){this.m_ratio=a},initVelocityConstraints:function(a){var b=this.m_ground1,c=this.m_ground2,d=this.m_bodyA,e=this.m_bodyB,f,g,k,h,l,m=0;this.m_J.setZero();
null!=this.m_revolute1?(this.m_J.angularA=-1,m+=d.m_invI):(h=b.m_xf.R,f=this.m_prismatic1.m_localXAxis1,b=h.col1.x*f.x+h.col2.x*f.y,f=h.col1.y*f.x+h.col2.y*f.y,h=d.m_xf.R,g=this.m_localAnchor1.x-d.m_sweep.localCenter.x,k=this.m_localAnchor1.y-d.m_sweep.localCenter.y,l=h.col1.x*g+h.col2.x*k,k=h.col1.y*g+h.col2.y*k,h=l*f-k*b,this.m_J.linearA.set(-b,-f),this.m_J.angularA=-h,m+=d.m_invMass+d.m_invI*h*h);null!=this.m_revolute2?(this.m_J.angularB=-this.m_ratio,m+=this.m_ratio*this.m_ratio*e.m_invI):(h=
c.m_xf.R,f=this.m_prismatic2.m_localXAxis1,b=h.col1.x*f.x+h.col2.x*f.y,f=h.col1.y*f.x+h.col2.y*f.y,h=e.m_xf.R,g=this.m_localAnchor2.x-e.m_sweep.localCenter.x,k=this.m_localAnchor2.y-e.m_sweep.localCenter.y,l=h.col1.x*g+h.col2.x*k,k=h.col1.y*g+h.col2.y*k,h=l*f-k*b,this.m_J.linearB.set(-this.m_ratio*b,-this.m_ratio*f),this.m_J.angularB=-this.m_ratio*h,m+=this.m_ratio*this.m_ratio*(e.m_invMass+e.m_invI*h*h));this.m_mass=0<m?1/m:0;a.warmStarting?(d.m_linearVelocity.x+=d.m_invMass*this.m_impulse*this.m_J.linearA.x,
d.m_linearVelocity.y+=d.m_invMass*this.m_impulse*this.m_J.linearA.y,d.m_angularVelocity+=d.m_invI*this.m_impulse*this.m_J.angularA,e.m_linearVelocity.x+=e.m_invMass*this.m_impulse*this.m_J.linearB.x,e.m_linearVelocity.y+=e.m_invMass*this.m_impulse*this.m_J.linearB.y,e.m_angularVelocity+=e.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},solveVelocityConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=this.m_J.compute(a.m_linearVelocity,a.m_angularVelocity,b.m_linearVelocity,b.m_angularVelocity),
c=-this.m_mass*c;this.m_impulse+=c;a.m_linearVelocity.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_linearVelocity.y+=a.m_invMass*c*this.m_J.linearA.y;a.m_angularVelocity+=a.m_invI*c*this.m_J.angularA;b.m_linearVelocity.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_linearVelocity.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_angularVelocity+=b.m_invI*c*this.m_J.angularB},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c,d;c=null!=this.m_revolute1?this.m_revolute1.getJointAngle():this.m_prismatic1.getJointTranslation();
d=null!=this.m_revolute2?this.m_revolute2.getJointAngle():this.m_prismatic2.getJointTranslation();c=-this.m_mass*(this.m_constant-(c+this.m_ratio*d));a.m_sweep.c.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_sweep.c.y+=a.m_invMass*c*this.m_J.linearA.y;a.m_sweep.a+=a.m_invI*c*this.m_J.angularA;b.m_sweep.c.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_sweep.c.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_sweep.a+=b.m_invI*c*this.m_J.angularB;a.synchronizeTransform();b.synchronizeTransform();return 0<v.b2_linearSlop},
__class__:me});var ne=function(){ka.call(this);this.type=O.GEAR_JOINT;this.joint2=this.joint1=null;this.ratio=1};ne.__name__=["box2D","dynamics","joints","B2GearJointDef"];ne.__super__=ka;ne.prototype=r(ka.prototype,{__class__:ne});var Pf=function(){this.linearA=new t;this.linearB=new t};Pf.__name__=["box2D","dynamics","joints","B2Jacobian"];Pf.prototype={setZero:function(){this.linearA.setZero();this.angularA=0;this.linearB.setZero();this.angularB=0},set:function(a,b,c,d){this.linearA.setV(a);this.angularA=
b;this.linearB.setV(c);this.angularB=d},compute:function(a,b,c,d){return this.linearA.x*a.x+this.linearA.y*a.y+this.angularA*b+(this.linearB.x*c.x+this.linearB.y*c.y)+this.angularB*d},__class__:Pf};var ee=function(){};ee.__name__=["box2D","dynamics","joints","B2JointEdge"];ee.prototype={__class__:ee};var O={__ename__:!0,__constructs__:"UNKNOWN_JOINT REVOLUTE_JOINT PRISMATIC_JOINT DISTANCE_JOINT PULLEY_JOINT MOUSE_JOINT GEAR_JOINT LINE_JOINT WELD_JOINT FRICTION_JOINT".split(" "),UNKNOWN_JOINT:["UNKNOWN_JOINT",
0]};O.UNKNOWN_JOINT.__enum__=O;O.REVOLUTE_JOINT=["REVOLUTE_JOINT",1];O.REVOLUTE_JOINT.__enum__=O;O.PRISMATIC_JOINT=["PRISMATIC_JOINT",2];O.PRISMATIC_JOINT.__enum__=O;O.DISTANCE_JOINT=["DISTANCE_JOINT",3];O.DISTANCE_JOINT.__enum__=O;O.PULLEY_JOINT=["PULLEY_JOINT",4];O.PULLEY_JOINT.__enum__=O;O.MOUSE_JOINT=["MOUSE_JOINT",5];O.MOUSE_JOINT.__enum__=O;O.GEAR_JOINT=["GEAR_JOINT",6];O.GEAR_JOINT.__enum__=O;O.LINE_JOINT=["LINE_JOINT",7];O.LINE_JOINT.__enum__=O;O.WELD_JOINT=["WELD_JOINT",8];O.WELD_JOINT.__enum__=
O;O.FRICTION_JOINT=["FRICTION_JOINT",9];O.FRICTION_JOINT.__enum__=O;O.__empty_constructs__=[O.UNKNOWN_JOINT,O.REVOLUTE_JOINT,O.PRISMATIC_JOINT,O.DISTANCE_JOINT,O.PULLEY_JOINT,O.MOUSE_JOINT,O.GEAR_JOINT,O.LINE_JOINT,O.WELD_JOINT,O.FRICTION_JOINT];var G={__ename__:!0,__constructs__:["INACTIVE_LIMIT","AT_LOWER_LIMIT","AT_UPPER_LIMIT","EQUAL_LIMITS"],INACTIVE_LIMIT:["INACTIVE_LIMIT",0]};G.INACTIVE_LIMIT.__enum__=G;G.AT_LOWER_LIMIT=["AT_LOWER_LIMIT",1];G.AT_LOWER_LIMIT.__enum__=G;G.AT_UPPER_LIMIT=["AT_UPPER_LIMIT",
2];G.AT_UPPER_LIMIT.__enum__=G;G.EQUAL_LIMITS=["EQUAL_LIMITS",3];G.EQUAL_LIMITS.__enum__=G;G.__empty_constructs__=[G.INACTIVE_LIMIT,G.AT_LOWER_LIMIT,G.AT_UPPER_LIMIT,G.EQUAL_LIMITS];var oe=function(a){fa.call(this,a);this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_localXAxis1=new t;this.m_localYAxis1=new t;this.m_axis=new t;this.m_perp=new t;this.m_K=new ja;this.m_impulse=new t;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_localXAxis1.setV(a.localAxisA);
this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.setZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=G.INACTIVE_LIMIT;this.m_axis.setZero();this.m_perp.setZero()};oe.__name__=["box2D","dynamics","joints","B2LineJoint"];
oe.__super__=fa;oe.prototype=r(fa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},getReactionTorque:function(a){return a*this.m_impulse.y},getJointTranslation:function(){var a=
this.m_bodyA,b=this.m_bodyB,c=a.getWorldPoint(this.m_localAnchor1),d=b.getWorldPoint(this.m_localAnchor2),b=d.x-c.x,c=d.y-c.y,a=a.getWorldVector(this.m_localXAxis1);return a.x*b+a.y*c},getJointSpeed:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,
f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,c=b.m_sweep.c.x+g-(a.m_sweep.c.x+d),f=b.m_sweep.c.y+k-(a.m_sweep.c.y+e),h=a.getWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*h.y+f*a*h.x+(h.x*(m.x+-b*k-l.x- -a*e)+h.y*(m.y+b*g-l.y-a*d))},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableLimit=a},getLowerLimit:function(){return this.m_lowerTranslation},
getUpperLimit:function(){return this.m_upperTranslation},setLimits:function(a,b){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b},isMotorEnabled:function(){return this.m_enableMotor},enableMotor:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorForce:function(a){this.m_bodyA.setAwake(!0);
this.m_bodyB.setAwake(!0);this.m_maxMotorForce=a},getMaxMotorForce:function(){return this.m_maxMotorForce},getMotorForce:function(){return this.m_motorImpulse},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;this.m_localCenterA.setV(b.getLocalCenter());this.m_localCenterB.setV(c.getLocalCenter());var f=b.getTransform();c.getTransform();d=b.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-this.m_localCenterA.y;e=d.col1.x*g+d.col2.x*k;k=d.col1.y*
g+d.col2.y*k;g=e;d=c.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,l=this.m_localAnchor2.y-this.m_localCenterB.y;e=d.col1.x*h+d.col2.x*l;l=d.col1.y*h+d.col2.y*l;h=e;d=c.m_sweep.c.x+h-b.m_sweep.c.x-g;e=c.m_sweep.c.y+l-b.m_sweep.c.y-k;this.m_invMassA=b.m_invMass;this.m_invMassB=c.m_invMass;this.m_invIA=b.m_invI;this.m_invIB=c.m_invI;this.m_axis.setV(q.mulMV(f.R,this.m_localXAxis1));this.m_a1=(d+g)*this.m_axis.y-(e+k)*this.m_axis.x;this.m_a2=h*this.m_axis.y-l*this.m_axis.x;this.m_motorMass=
this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.setV(q.mulMV(f.R,this.m_localYAxis1));this.m_s1=(d+g)*this.m_perp.y-(e+k)*this.m_perp.x;this.m_s2=h*this.m_perp.y-l*this.m_perp.x;f=this.m_invMassA;g=this.m_invMassB;k=this.m_invIA;h=this.m_invIB;this.m_K.col1.x=f+g+k*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2;this.m_K.col1.y=k*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2;
this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=f+g+k*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*e,q.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?this.m_limitState=G.EQUAL_LIMITS:d<=this.m_lowerTranslation?this.m_limitState!=G.AT_LOWER_LIMIT&&(this.m_limitState=G.AT_LOWER_LIMIT,this.m_impulse.y=0):d>=this.m_upperTranslation?this.m_limitState!=G.AT_UPPER_LIMIT&&(this.m_limitState=G.AT_UPPER_LIMIT,this.m_impulse.y=0):(this.m_limitState=
G.INACTIVE_LIMIT,this.m_impulse.y=0)):this.m_limitState=G.INACTIVE_LIMIT;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,e=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,f=this.m_impulse.x*this.m_s2+
(this.m_motorImpulse+this.m_impulse.y)*this.m_a2,b.m_linearVelocity.x-=this.m_invMassA*a,b.m_linearVelocity.y-=this.m_invMassA*d,b.m_angularVelocity-=this.m_invIA*e,c.m_linearVelocity.x+=this.m_invMassB*a,c.m_linearVelocity.y+=this.m_invMassB*d,c.m_angularVelocity+=this.m_invIB*f):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,f=c.m_linearVelocity,g=c.m_angularVelocity,k,h,l;this.m_enableMotor&&
this.m_limitState!=G.EQUAL_LIMITS&&(l=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e)),k=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=q.clamp(this.m_motorImpulse+l,-a,a),l=this.m_motorImpulse-k,k=l*this.m_axis.x,a=l*this.m_axis.y,h=l*this.m_a1,l*=this.m_a2,d.x-=this.m_invMassA*k,d.y-=this.m_invMassA*a,e-=this.m_invIA*h,f.x+=this.m_invMassB*k,f.y+=this.m_invMassB*a,g+=this.m_invIB*l);a=this.m_perp.x*(f.x-d.x)+this.m_perp.y*
(f.y-d.y)+this.m_s2*g-this.m_s1*e;this.m_enableLimit&&this.m_limitState!=G.INACTIVE_LIMIT?(h=this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e,k=this.m_impulse.copy(),l=this.m_K.solve(new t,-a,-h),this.m_impulse.add(l),this.m_limitState==G.AT_LOWER_LIMIT?this.m_impulse.y=q.max(this.m_impulse.y,0):this.m_limitState==G.AT_UPPER_LIMIT&&(this.m_impulse.y=q.min(this.m_impulse.y,0)),a=-a-(this.m_impulse.y-k.y)*this.m_K.col2.x,this.m_impulse.x=0!=this.m_K.col1.x?a/this.m_K.col1.x+k.x:
k.x,l.x=this.m_impulse.x-k.x,l.y=this.m_impulse.y-k.y,k=l.x*this.m_perp.x+l.y*this.m_axis.x,a=l.x*this.m_perp.y+l.y*this.m_axis.y,h=l.x*this.m_s1+l.y*this.m_a1,l=l.x*this.m_s2+l.y*this.m_a2):(l=0!=this.m_K.col1.x?-a/this.m_K.col1.x:0,this.m_impulse.x+=l,k=l*this.m_perp.x,a=l*this.m_perp.y,h=l*this.m_s1,l*=this.m_s2);d.x-=this.m_invMassA*k;d.y-=this.m_invMassA*a;e-=this.m_invIA*h;f.x+=this.m_invMassB*k;f.y+=this.m_invMassB*a;g+=this.m_invIB*l;b.m_linearVelocity.setV(d);b.m_angularVelocity=e;c.m_linearVelocity.setV(f);
c.m_angularVelocity=g},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=a.m_sweep.c,d=a.m_sweep.a,e=b.m_sweep.c,f=b.m_sweep.a,g,k,h,l,m,u=0,p=0;h=!1;var r=0,n=ja.fromAngle(d);l=ja.fromAngle(f);g=n;var p=this.m_localAnchor1.x-this.m_localCenterA.x,s=this.m_localAnchor1.y-this.m_localCenterA.y;k=g.col1.x*p+g.col2.x*s;s=g.col1.y*p+g.col2.y*s;p=k;g=l;l=this.m_localAnchor2.x-this.m_localCenterB.x;m=this.m_localAnchor2.y-this.m_localCenterB.y;k=g.col1.x*l+g.col2.x*m;m=g.col1.y*l+
g.col2.y*m;l=k;g=e.x+l-c.x-p;k=e.y+m-c.y-s;if(this.m_enableLimit){this.m_axis=q.mulMV(n,this.m_localXAxis1);this.m_a1=(g+p)*this.m_axis.y-(k+s)*this.m_axis.x;this.m_a2=l*this.m_axis.y-m*this.m_axis.x;var w=this.m_axis.x*g+this.m_axis.y*k;q.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?(r=q.clamp(w,-v.b2_maxLinearCorrection,v.b2_maxLinearCorrection),u=q.abs(w),h=!0):w<=this.m_lowerTranslation?(r=q.clamp(w-this.m_lowerTranslation+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),
u=this.m_lowerTranslation-w,h=!0):w>=this.m_upperTranslation&&(r=q.clamp(w-this.m_upperTranslation+v.b2_linearSlop,0,v.b2_maxLinearCorrection),u=w-this.m_upperTranslation,h=!0)}this.m_perp=q.mulMV(n,this.m_localYAxis1);this.m_s1=(g+p)*this.m_perp.y-(k+s)*this.m_perp.x;this.m_s2=l*this.m_perp.y-m*this.m_perp.x;n=new t;s=this.m_perp.x*g+this.m_perp.y*k;u=q.max(u,q.abs(s));p=0;h?(h=this.m_invMassA,l=this.m_invMassB,m=this.m_invIA,g=this.m_invIB,this.m_K.col1.x=h+l+m*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,
this.m_K.col1.y=m*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=h+l+m*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_K.solve(n,-s,-r)):(h=this.m_invMassA,l=this.m_invMassB,m=this.m_invIA,g=this.m_invIB,r=h+l+m*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,n.x=0!=r?-s/r:0,n.y=0);r=n.x*this.m_perp.x+n.y*this.m_axis.x;h=n.x*this.m_perp.y+n.y*this.m_axis.y;s=n.x*this.m_s1+n.y*this.m_a1;n=n.x*this.m_s2+n.y*this.m_a2;c.x-=this.m_invMassA*r;c.y-=this.m_invMassA*
h;d-=this.m_invIA*s;e.x+=this.m_invMassB*r;e.y+=this.m_invMassB*h;f+=this.m_invIB*n;a.m_sweep.a=d;b.m_sweep.a=f;a.synchronizeTransform();b.synchronizeTransform();return u<=v.b2_linearSlop?p<=v.b2_angularSlop:!1},__class__:oe});var pe=function(){ka.call(this)};pe.__name__=["box2D","dynamics","joints","B2LineJointDef"];pe.__super__=ka;pe.prototype=r(ka.prototype,{b2LineJointDef:function(){this.localAnchorA=new t;this.localAnchorB=new t;this.localAxisA=new t;this.type=O.LINE_JOINT;this.localAxisA.set(1,
0);this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0},initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.localAxisA=this.bodyA.getLocalVector(d)},__class__:pe});var ke=function(a){fa.call(this,a);this.K=new ja;this.K1=new ja;this.K2=new ja;this.m_localAnchor=new t;this.m_target=new t;this.m_impulse=new t;this.m_mass=new ja;this.m_C=
new t;this.m_target.setV(a.target);var b=this.m_target.x-this.m_bodyB.m_xf.position.x,c=this.m_target.y-this.m_bodyB.m_xf.position.y,d=this.m_bodyB.m_xf.R;this.m_localAnchor.x=b*d.col1.x+c*d.col1.y;this.m_localAnchor.y=b*d.col2.x+c*d.col2.y;this.m_maxForce=a.maxForce;this.m_impulse.setZero();this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_gamma=this.m_beta=0};ke.__name__=["box2D","dynamics","joints","B2MouseJoint"];ke.__super__=fa;ke.prototype=r(fa.prototype,{getAnchorA:function(){return this.m_target},
getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor)},getReactionForce:function(a){return new t(a*this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return 0},getTarget:function(){return this.m_target},setTarget:function(a){!1==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0);this.m_target=a},getMaxForce:function(){return this.m_maxForce},setMaxForce:function(a){this.m_maxForce=a},getFrequency:function(){return this.m_frequencyHz},setFrequency:function(a){this.m_frequencyHz=
a},getDampingRatio:function(){return this.m_dampingRatio},setDampingRatio:function(a){this.m_dampingRatio=a},initVelocityConstraints:function(a){var b=this.m_bodyB,c=b.getMass(),d=2*Math.PI*this.m_frequencyHz,e=c*d*d;this.m_gamma=a.dt*(2*c*this.m_dampingRatio*d+a.dt*e);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_beta=a.dt*e*this.m_gamma;var e=b.m_xf.R,c=this.m_localAnchor.x-b.m_sweep.localCenter.x,d=this.m_localAnchor.y-b.m_sweep.localCenter.y,f=e.col1.x*c+e.col2.x*d,d=e.col1.y*c+e.col2.y*
d,c=f,e=b.m_invMass,f=b.m_invI;this.K1.col1.x=e;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=e;this.K2.col1.x=f*d*d;this.K2.col2.x=-f*c*d;this.K2.col1.y=-f*c*d;this.K2.col2.y=f*c*c;this.K.setM(this.K1);this.K.addM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.getInverse(this.m_mass);this.m_C.x=b.m_sweep.c.x+c-this.m_target.x;this.m_C.y=b.m_sweep.c.y+d-this.m_target.y;b.m_angularVelocity*=0.98;this.m_impulse.x*=a.dtRatio;this.m_impulse.y*=a.dtRatio;b.m_linearVelocity.x+=
e*this.m_impulse.x;b.m_linearVelocity.y+=e*this.m_impulse.y;b.m_angularVelocity+=f*(c*this.m_impulse.y-d*this.m_impulse.x)},solveVelocityConstraints:function(a){var b=this.m_bodyB,c,d,e;c=b.m_xf.R;var f=this.m_localAnchor.x-b.m_sweep.localCenter.x,g=this.m_localAnchor.y-b.m_sweep.localCenter.y;d=c.col1.x*f+c.col2.x*g;g=c.col1.y*f+c.col2.y*g;f=d;d=b.m_linearVelocity.x+-b.m_angularVelocity*g;var k=b.m_linearVelocity.y+b.m_angularVelocity*f;c=this.m_mass;d=d+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;
e=k+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;k=-(c.col1.x*d+c.col2.x*e);e=-(c.col1.y*d+c.col2.y*e);c=this.m_impulse.x;d=this.m_impulse.y;this.m_impulse.x+=k;this.m_impulse.y+=e;a=a.dt*this.m_maxForce;this.m_impulse.lengthSquared()>a*a&&this.m_impulse.multiply(a/this.m_impulse.length());k=this.m_impulse.x-c;e=this.m_impulse.y-d;b.m_linearVelocity.x+=b.m_invMass*k;b.m_linearVelocity.y+=b.m_invMass*e;b.m_angularVelocity+=b.m_invI*(f*e-g*k)},solvePositionConstraints:function(a){return!0},
__class__:ke});var le=function(){ka.call(this);this.target=new t;this.type=O.MOUSE_JOINT;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=0.7};le.__name__=["box2D","dynamics","joints","B2MouseJointDef"];le.__super__=ka;le.prototype=r(ka.prototype,{__class__:le});var Fc=function(a){fa.call(this,a);this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_localXAxis1=new t;this.m_localYAxis1=new t;this.m_axis=new t;this.m_perp=new t;this.m_K=new fc;this.m_impulse=new Oa;this.m_localAnchor1.setV(a.localAnchorA);
this.m_localAnchor2.setV(a.localAnchorB);this.m_localXAxis1.setV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=a.referenceAngle;this.m_impulse.setZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=G.INACTIVE_LIMIT;
this.m_axis.setZero();this.m_perp.setZero()};Fc.__name__=["box2D","dynamics","joints","B2PrismaticJoint"];Fc.__super__=fa;Fc.prototype=r(fa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*
this.m_axis.y))},getReactionTorque:function(a){return a*this.m_impulse.y},getJointTranslation:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.getWorldPoint(this.m_localAnchor1),d=b.getWorldPoint(this.m_localAnchor2),b=d.x-c.x,c=d.y-c.y,a=a.getWorldVector(this.m_localXAxis1);return a.x*b+a.y*c},getJointSpeed:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*
e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,c=b.m_sweep.c.x+g-(a.m_sweep.c.x+d),f=b.m_sweep.c.y+k-(a.m_sweep.c.y+e),h=a.getWorldVector(this.m_localXAxis1),l=a.m_linearVelocity,m=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*h.y+f*a*h.x+(h.x*(m.x+-b*k-l.x- -a*e)+h.y*(m.y+b*g-l.y-a*d))},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_bodyA.setAwake(!0);
this.m_bodyB.setAwake(!0);this.m_enableLimit=a},getLowerLimit:function(){return this.m_lowerTranslation},getUpperLimit:function(){return this.m_upperTranslation},setLimits:function(a,b){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b},isMotorEnabled:function(){return this.m_enableMotor},enableMotor:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);
this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorForce:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_maxMotorForce=a},getMotorForce:function(){return this.m_motorImpulse},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;this.m_localCenterA.setV(b.getLocalCenter());this.m_localCenterB.setV(c.getLocalCenter());var f=b.getTransform();c.getTransform();d=b.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-
this.m_localCenterA.y;e=d.col1.x*g+d.col2.x*k;k=d.col1.y*g+d.col2.y*k;g=e;d=c.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,l=this.m_localAnchor2.y-this.m_localCenterB.y;e=d.col1.x*h+d.col2.x*l;l=d.col1.y*h+d.col2.y*l;h=e;d=c.m_sweep.c.x+h-b.m_sweep.c.x-g;e=c.m_sweep.c.y+l-b.m_sweep.c.y-k;this.m_invMassA=b.m_invMass;this.m_invMassB=c.m_invMass;this.m_invIA=b.m_invI;this.m_invIB=c.m_invI;this.m_axis.setV(q.mulMV(f.R,this.m_localXAxis1));this.m_a1=(d+g)*this.m_axis.y-(e+k)*this.m_axis.x;
this.m_a2=h*this.m_axis.y-l*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass);this.m_perp.setV(q.mulMV(f.R,this.m_localYAxis1));this.m_s1=(d+g)*this.m_perp.y-(e+k)*this.m_perp.x;this.m_s2=h*this.m_perp.y-l*this.m_perp.x;f=this.m_invMassA;g=this.m_invMassB;k=this.m_invIA;h=this.m_invIB;this.m_K.col1.x=f+g+k*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2;
this.m_K.col1.y=k*this.m_s1+h*this.m_s2;this.m_K.col1.z=k*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=k+h;this.m_K.col2.z=k*this.m_a1+h*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=f+g+k*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*e,q.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?this.m_limitState=G.EQUAL_LIMITS:d<=this.m_lowerTranslation?
this.m_limitState!=G.AT_LOWER_LIMIT&&(this.m_limitState=G.AT_LOWER_LIMIT,this.m_impulse.z=0):d>=this.m_upperTranslation?this.m_limitState!=G.AT_UPPER_LIMIT&&(this.m_limitState=G.AT_UPPER_LIMIT,this.m_impulse.z=0):(this.m_limitState=G.INACTIVE_LIMIT,this.m_impulse.z=0)):this.m_limitState=G.INACTIVE_LIMIT;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+
this.m_impulse.z)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,e=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,f=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,b.m_linearVelocity.x-=this.m_invMassA*a,b.m_linearVelocity.y-=this.m_invMassA*d,b.m_angularVelocity-=this.m_invIA*e,c.m_linearVelocity.x+=this.m_invMassB*a,c.m_linearVelocity.y+=this.m_invMassB*
d,c.m_angularVelocity+=this.m_invIB*f):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,f=c.m_linearVelocity,g=c.m_angularVelocity,k,h,l;this.m_enableMotor&&this.m_limitState!=G.EQUAL_LIMITS&&(l=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e)),k=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=q.clamp(this.m_motorImpulse+
l,-a,a),l=this.m_motorImpulse-k,k=l*this.m_axis.x,a=l*this.m_axis.y,h=l*this.m_a1,l*=this.m_a2,d.x-=this.m_invMassA*k,d.y-=this.m_invMassA*a,e-=this.m_invIA*h,f.x+=this.m_invMassB*k,f.y+=this.m_invMassB*a,g+=this.m_invIB*l);h=this.m_perp.x*(f.x-d.x)+this.m_perp.y*(f.y-d.y)+this.m_s2*g-this.m_s1*e;a=g-e;this.m_enableLimit&&this.m_limitState!=G.INACTIVE_LIMIT?(l=this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e,k=this.m_impulse.copy(),l=this.m_K.solve33(new Oa,-h,-a,-l),this.m_impulse.add(l),
this.m_limitState==G.AT_LOWER_LIMIT?this.m_impulse.z=q.max(this.m_impulse.z,0):this.m_limitState==G.AT_UPPER_LIMIT&&(this.m_impulse.z=q.min(this.m_impulse.z,0)),h=-h-(this.m_impulse.z-k.z)*this.m_K.col3.x,a=-a-(this.m_impulse.z-k.z)*this.m_K.col3.y,a=this.m_K.solve22(new t,h,a),a.x+=k.x,a.y+=k.y,this.m_impulse.x=a.x,this.m_impulse.y=a.y,l.x=this.m_impulse.x-k.x,l.y=this.m_impulse.y-k.y,l.z=this.m_impulse.z-k.z,k=l.x*this.m_perp.x+l.z*this.m_axis.x,a=l.x*this.m_perp.y+l.z*this.m_axis.y,h=l.x*this.m_s1+
l.y+l.z*this.m_a1,l=l.x*this.m_s2+l.y+l.z*this.m_a2):(l=this.m_K.solve22(new t,-h,-a),this.m_impulse.x+=l.x,this.m_impulse.y+=l.y,k=l.x*this.m_perp.x,a=l.x*this.m_perp.y,h=l.x*this.m_s1+l.y,l=l.x*this.m_s2+l.y);d.x-=this.m_invMassA*k;d.y-=this.m_invMassA*a;e-=this.m_invIA*h;f.x+=this.m_invMassB*k;f.y+=this.m_invMassB*a;g+=this.m_invIB*l;b.m_linearVelocity.setV(d);b.m_angularVelocity=e;c.m_linearVelocity.setV(f);c.m_angularVelocity=g},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,
c=a.m_sweep.c,d=a.m_sweep.a,e=b.m_sweep.c,f=b.m_sweep.a,g,k,h,l,m=0,u=0;h=!1;var p=0,n=ja.fromAngle(d),r=ja.fromAngle(f);g=n;var u=this.m_localAnchor1.x-this.m_localCenterA.x,s=this.m_localAnchor1.y-this.m_localCenterA.y;k=g.col1.x*u+g.col2.x*s;s=g.col1.y*u+g.col2.y*s;u=k;g=r;r=this.m_localAnchor2.x-this.m_localCenterB.x;l=this.m_localAnchor2.y-this.m_localCenterB.y;k=g.col1.x*r+g.col2.x*l;l=g.col1.y*r+g.col2.y*l;r=k;g=e.x+r-c.x-u;k=e.y+l-c.y-s;if(this.m_enableLimit){this.m_axis=q.mulMV(n,this.m_localXAxis1);
this.m_a1=(g+u)*this.m_axis.y-(k+s)*this.m_axis.x;this.m_a2=r*this.m_axis.y-l*this.m_axis.x;var w=this.m_axis.x*g+this.m_axis.y*k;q.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*v.b2_linearSlop?(p=q.clamp(w,-v.b2_maxLinearCorrection,v.b2_maxLinearCorrection),m=q.abs(w),h=!0):w<=this.m_lowerTranslation?(p=q.clamp(w-this.m_lowerTranslation+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),m=this.m_lowerTranslation-w,h=!0):w>=this.m_upperTranslation&&(p=q.clamp(w-this.m_upperTranslation+v.b2_linearSlop,
0,v.b2_maxLinearCorrection),m=w-this.m_upperTranslation,h=!0)}this.m_perp=q.mulMV(n,this.m_localYAxis1);this.m_s1=(g+u)*this.m_perp.y-(k+s)*this.m_perp.x;this.m_s2=r*this.m_perp.y-l*this.m_perp.x;n=new Oa;s=this.m_perp.x*g+this.m_perp.y*k;r=f-d-this.m_refAngle;m=q.max(m,q.abs(s));u=q.abs(r);h?(h=this.m_invMassA,l=this.m_invMassB,g=this.m_invIA,k=this.m_invIB,this.m_K.col1.x=h+l+g*this.m_s1*this.m_s1+k*this.m_s2*this.m_s2,this.m_K.col1.y=g*this.m_s1+k*this.m_s2,this.m_K.col1.z=g*this.m_s1*this.m_a1+
k*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=g+k,this.m_K.col2.z=g*this.m_a1+k*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=h+l+g*this.m_a1*this.m_a1+k*this.m_a2*this.m_a2,this.m_K.solve33(n,-s,-r,-p)):(h=this.m_invMassA,l=this.m_invMassB,g=this.m_invIA,k=this.m_invIB,p=g*this.m_s1+k*this.m_s2,w=g+k,this.m_K.col1.set(h+l+g*this.m_s1*this.m_s1+k*this.m_s2*this.m_s2,p,0),this.m_K.col2.set(p,w,0),p=this.m_K.solve22(new t,-s,-r),n.x=
p.x,n.y=p.y,n.z=0);p=n.x*this.m_perp.x+n.z*this.m_axis.x;h=n.x*this.m_perp.y+n.z*this.m_axis.y;s=n.x*this.m_s1+n.y+n.z*this.m_a1;n=n.x*this.m_s2+n.y+n.z*this.m_a2;c.x-=this.m_invMassA*p;c.y-=this.m_invMassA*h;d-=this.m_invIA*s;e.x+=this.m_invMassB*p;e.y+=this.m_invMassB*h;f+=this.m_invIB*n;a.m_sweep.a=d;b.m_sweep.a=f;a.synchronizeTransform();b.synchronizeTransform();return m<=v.b2_linearSlop?u<=v.b2_angularSlop:!1},__class__:Fc});var ge=function(){ka.call(this);this.localAnchorA=new t;this.localAnchorB=
new t;this.localAxisA=new t;this.type=O.PRISMATIC_JOINT;this.localAxisA.set(1,0);this.referenceAngle=0;this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};ge.__name__=["box2D","dynamics","joints","B2PrismaticJointDef"];ge.__super__=ka;ge.prototype=r(ka.prototype,{initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.localAxisA=this.bodyA.getLocalVector(d);
this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:ge});var rb=function(a){fa.call(this,a);this.m_groundAnchor1=new t;this.m_groundAnchor2=new t;this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_u1=new t;this.m_u2=new t;this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=a.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=a.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=a.groundAnchorB.x-this.m_ground.m_xf.position.x;
this.m_groundAnchor2.y=a.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_ratio=a.ratio;this.m_constant=a.lengthA+this.m_ratio*a.lengthB;this.m_maxLength1=q.min(a.maxLengthA,this.m_constant-this.m_ratio*rb.b2_minPulleyLength);this.m_maxLength2=q.min(a.maxLengthB,(this.m_constant-rb.b2_minPulleyLength)/this.m_ratio);this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};rb.__name__=["box2D","dynamics","joints",
"B2PulleyJoint"];rb.__super__=fa;rb.prototype=r(fa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*this.m_impulse*this.m_u2.x,a*this.m_impulse*this.m_u2.y)},getReactionTorque:function(a){return 0},getGroundAnchorA:function(){var a=this.m_ground.m_xf.position.copy();a.add(this.m_groundAnchor1);return a},getGroundAnchorB:function(){var a=
this.m_ground.m_xf.position.copy();a.add(this.m_groundAnchor2);return a},getLength1:function(){var a=this.m_bodyA.getWorldPoint(this.m_localAnchor1),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y);return Math.sqrt(b*b+a*a)},getLength2:function(){var a=this.m_bodyB.getWorldPoint(this.m_localAnchor2),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor2.y);return Math.sqrt(b*
b+a*a)},getRatio:function(){return this.m_ratio},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_xf.R,e=this.m_localAnchor1.x-b.m_sweep.localCenter.x,f=this.m_localAnchor1.y-b.m_sweep.localCenter.y,g=d.col1.x*e+d.col2.x*f,f=d.col1.y*e+d.col2.y*f,e=g,d=c.m_xf.R,k=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y,g=d.col1.x*k+d.col2.x*h,h=d.col1.y*k+d.col2.y*h,k=g,d=c.m_sweep.c.x+k,g=c.m_sweep.c.y+h,l=this.m_ground.m_xf.position.x+
this.m_groundAnchor2.x,m=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.set(b.m_sweep.c.x+e-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),b.m_sweep.c.y+f-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y));this.m_u2.set(d-l,g-m);d=this.m_u1.length();g=this.m_u2.length();d>v.b2_linearSlop?this.m_u1.multiply(1/d):this.m_u1.setZero();g>v.b2_linearSlop?this.m_u2.multiply(1/g):this.m_u2.setZero();0<this.m_constant-d-this.m_ratio*g?(this.m_state=G.INACTIVE_LIMIT,this.m_impulse=
0):this.m_state=G.AT_UPPER_LIMIT;d<this.m_maxLength1?(this.m_limitState1=G.INACTIVE_LIMIT,this.m_limitImpulse1=0):this.m_limitState1=G.AT_UPPER_LIMIT;g<this.m_maxLength2?(this.m_limitState2=G.INACTIVE_LIMIT,this.m_limitImpulse2=0):this.m_limitState2=G.AT_UPPER_LIMIT;d=e*this.m_u1.y-f*this.m_u1.x;g=k*this.m_u2.y-h*this.m_u2.x;this.m_limitMass1=b.m_invMass+b.m_invI*d*d;this.m_limitMass2=c.m_invMass+c.m_invI*g*g;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=
1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;a.warmStarting?(this.m_impulse*=a.dtRatio,this.m_limitImpulse1*=a.dtRatio,this.m_limitImpulse2*=a.dtRatio,a=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,d=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,g=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,l=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*a,b.m_linearVelocity.y+=b.m_invMass*
d,b.m_angularVelocity+=b.m_invI*(e*d-f*a),c.m_linearVelocity.x+=c.m_invMass*g,c.m_linearVelocity.y+=c.m_invMass*l,c.m_angularVelocity+=c.m_invI*(k*l-h*g)):this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0},solveVelocityConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,
k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,h,l;this.m_state==G.AT_UPPER_LIMIT&&(c=a.m_linearVelocity.x+-a.m_angularVelocity*e,f=a.m_linearVelocity.y+a.m_angularVelocity*d,h=b.m_linearVelocity.x+-b.m_angularVelocity*k,l=b.m_linearVelocity.y+b.m_angularVelocity*g,c=-(this.m_u1.x*c+this.m_u1.y*f)-this.m_ratio*(this.m_u2.x*h+this.m_u2.y*l),l=this.m_pulleyMass*-c,c=this.m_impulse,this.m_impulse=q.max(0,this.m_impulse+l),l=this.m_impulse-c,c=-l*this.m_u1.x,
f=-l*this.m_u1.y,h=-this.m_ratio*l*this.m_u2.x,l=-this.m_ratio*l*this.m_u2.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*f,a.m_angularVelocity+=a.m_invI*(d*f-e*c),b.m_linearVelocity.x+=b.m_invMass*h,b.m_linearVelocity.y+=b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(g*l-k*h));this.m_limitState1==G.AT_UPPER_LIMIT&&(c=a.m_linearVelocity.x+-a.m_angularVelocity*e,f=a.m_linearVelocity.y+a.m_angularVelocity*d,c=-(this.m_u1.x*c+this.m_u1.y*f),l=-this.m_limitMass1*c,c=this.m_limitImpulse1,
this.m_limitImpulse1=q.max(0,this.m_limitImpulse1+l),l=this.m_limitImpulse1-c,c=-l*this.m_u1.x,f=-l*this.m_u1.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*f,a.m_angularVelocity+=a.m_invI*(d*f-e*c));this.m_limitState2==G.AT_UPPER_LIMIT&&(h=b.m_linearVelocity.x+-b.m_angularVelocity*k,l=b.m_linearVelocity.y+b.m_angularVelocity*g,c=-(this.m_u2.x*h+this.m_u2.y*l),l=-this.m_limitMass2*c,c=this.m_limitImpulse2,this.m_limitImpulse2=q.max(0,this.m_limitImpulse2+l),l=this.m_limitImpulse2-
c,h=-l*this.m_u2.x,l=-l*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*h,b.m_linearVelocity.y+=b.m_invMass*l,b.m_angularVelocity+=b.m_invI*(g*l-k*h))},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c,d=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,e=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,f=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,g=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,k,h,l,m,u,p,n,r=0;this.m_state==G.AT_UPPER_LIMIT&&(c=a.m_xf.R,
k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,h=this.m_localAnchor1.y-a.m_sweep.localCenter.y,u=c.col1.x*k+c.col2.x*h,h=c.col1.y*k+c.col2.y*h,k=u,c=b.m_xf.R,l=this.m_localAnchor2.x-b.m_sweep.localCenter.x,m=this.m_localAnchor2.y-b.m_sweep.localCenter.y,u=c.col1.x*l+c.col2.x*m,m=c.col1.y*l+c.col2.y*m,l=u,c=a.m_sweep.c.x+k,u=a.m_sweep.c.y+h,p=b.m_sweep.c.x+l,n=b.m_sweep.c.y+m,this.m_u1.set(c-d,u-e),this.m_u2.set(p-f,n-g),c=this.m_u1.length(),u=this.m_u2.length(),c>v.b2_linearSlop?this.m_u1.multiply(1/
c):this.m_u1.setZero(),u>v.b2_linearSlop?this.m_u2.multiply(1/u):this.m_u2.setZero(),c=this.m_constant-c-this.m_ratio*u,r=q.max(r,-c),c=q.clamp(c+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),n=-this.m_pulleyMass*c,c=-n*this.m_u1.x,u=-n*this.m_u1.y,p=-this.m_ratio*n*this.m_u2.x,n=-this.m_ratio*n*this.m_u2.y,a.m_sweep.c.x+=a.m_invMass*c,a.m_sweep.c.y+=a.m_invMass*u,a.m_sweep.a+=a.m_invI*(k*u-h*c),b.m_sweep.c.x+=b.m_invMass*p,b.m_sweep.c.y+=b.m_invMass*n,b.m_sweep.a+=b.m_invI*(l*n-m*p),a.synchronizeTransform(),
b.synchronizeTransform());this.m_limitState1==G.AT_UPPER_LIMIT&&(c=a.m_xf.R,k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,h=this.m_localAnchor1.y-a.m_sweep.localCenter.y,u=c.col1.x*k+c.col2.x*h,h=c.col1.y*k+c.col2.y*h,k=u,c=a.m_sweep.c.x+k,u=a.m_sweep.c.y+h,this.m_u1.set(c-d,u-e),c=this.m_u1.length(),c>v.b2_linearSlop?(this.m_u1.x*=1/c,this.m_u1.y*=1/c):this.m_u1.setZero(),c=this.m_maxLength1-c,r=q.max(r,-c),c=q.clamp(c+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),n=-this.m_limitMass1*c,c=-n*this.m_u1.x,
u=-n*this.m_u1.y,a.m_sweep.c.x+=a.m_invMass*c,a.m_sweep.c.y+=a.m_invMass*u,a.m_sweep.a+=a.m_invI*(k*u-h*c),a.synchronizeTransform());this.m_limitState2==G.AT_UPPER_LIMIT&&(c=b.m_xf.R,l=this.m_localAnchor2.x-b.m_sweep.localCenter.x,m=this.m_localAnchor2.y-b.m_sweep.localCenter.y,u=c.col1.x*l+c.col2.x*m,m=c.col1.y*l+c.col2.y*m,l=u,p=b.m_sweep.c.x+l,n=b.m_sweep.c.y+m,this.m_u2.set(p-f,n-g),u=this.m_u2.length(),u>v.b2_linearSlop?(this.m_u2.x*=1/u,this.m_u2.y*=1/u):this.m_u2.setZero(),c=this.m_maxLength2-
u,r=q.max(r,-c),c=q.clamp(c+v.b2_linearSlop,-v.b2_maxLinearCorrection,0),n=-this.m_limitMass2*c,p=-n*this.m_u2.x,n=-n*this.m_u2.y,b.m_sweep.c.x+=b.m_invMass*p,b.m_sweep.c.y+=b.m_invMass*n,b.m_sweep.a+=b.m_invI*(l*n-m*p),b.synchronizeTransform());return r<v.b2_linearSlop},__class__:rb});var je=function(){ka.call(this);this.groundAnchorA=new t;this.groundAnchorB=new t;this.localAnchorA=new t;this.localAnchorB=new t;this.type=O.PULLEY_JOINT;this.groundAnchorA.set(-1,1);this.groundAnchorB.set(1,1);this.localAnchorA.set(-1,
0);this.localAnchorB.set(1,0);this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0;this.ratio=1;this.collideConnected=!0};je.__name__=["box2D","dynamics","joints","B2PulleyJointDef"];je.__super__=ka;je.prototype=r(ka.prototype,{initialize:function(a,b,c,d,e,f,g){this.bodyA=a;this.bodyB=b;this.groundAnchorA.setV(c);this.groundAnchorB.setV(d);this.localAnchorA=this.bodyA.getLocalPoint(e);this.localAnchorB=this.bodyB.getLocalPoint(f);a=e.x-c.x;c=e.y-c.y;this.lengthA=Math.sqrt(a*a+c*c);c=f.x-d.x;
d=f.y-d.y;this.lengthB=Math.sqrt(c*c+d*d);this.ratio=g;g=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=g-this.ratio*rb.b2_minPulleyLength;this.maxLengthB=(g-rb.b2_minPulleyLength)/this.ratio},__class__:je});var sb=function(a){fa.call(this,a);this.K=new ja;this.K1=new ja;this.K2=new ja;this.K3=new ja;this.impulse3=new Oa;this.impulse2=new t;this.reduced=new t;this.m_localAnchor1=new t;this.m_localAnchor2=new t;this.m_impulse=new Oa;this.m_mass=new fc;this.m_localAnchor1.setV(a.localAnchorA);
this.m_localAnchor2.setV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.setZero();this.m_motorImpulse=0;this.m_lowerAngle=a.lowerAngle;this.m_upperAngle=a.upperAngle;this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=G.INACTIVE_LIMIT};sb.__name__=["box2D","dynamics","joints","B2RevoluteJoint"];sb.__super__=fa;sb.prototype=r(fa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},
getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new t(a*this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return a*this.m_impulse.z},getJointAngle:function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},getJointSpeed:function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_enableLimit=
a},getLowerLimit:function(){return this.m_lowerAngle},getUpperLimit:function(){return this.m_upperAngle},setLimits:function(a,b){this.m_lowerAngle=a;this.m_upperAngle=b},isMotorEnabled:function(){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);return this.m_enableMotor},enableMotor:function(a){this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorTorque:function(a){this.m_maxMotorTorque=
a},getMotorTorque:function(){return this.m_maxMotorTorque},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;d=b.m_xf.R;var f=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y;e=d.col1.x*f+d.col2.x*g;g=d.col1.y*f+d.col2.y*g;f=e;d=c.m_xf.R;var k=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y;e=d.col1.x*k+d.col2.x*h;h=d.col1.y*k+d.col2.y*h;k=e;d=b.m_invMass;e=c.m_invMass;var l=b.m_invI,
m=c.m_invI;this.m_mass.col1.x=d+e+g*g*l+h*h*m;this.m_mass.col2.x=-g*f*l-h*k*m;this.m_mass.col3.x=-g*l-h*m;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=d+e+f*f*l+k*k*m;this.m_mass.col3.y=f*l+k*m;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=l+m;this.m_motorMass=1/(l+m);!1==this.m_enableMotor&&(this.m_motorImpulse=0);if(this.m_enableLimit){var u=c.m_sweep.a-b.m_sweep.a-this.m_referenceAngle;q.abs(this.m_upperAngle-this.m_lowerAngle)<2*v.b2_angularSlop?
this.m_limitState=G.EQUAL_LIMITS:u<=this.m_lowerAngle?(this.m_limitState!=G.AT_LOWER_LIMIT&&(this.m_impulse.z=0),this.m_limitState=G.AT_LOWER_LIMIT):u>=this.m_upperAngle?(this.m_limitState!=G.AT_UPPER_LIMIT&&(this.m_impulse.z=0),this.m_limitState=G.AT_UPPER_LIMIT):(this.m_limitState=G.INACTIVE_LIMIT,this.m_impulse.z=0)}else this.m_limitState=G.INACTIVE_LIMIT;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x,u=this.m_impulse.y,
b.m_linearVelocity.x-=d*a,b.m_linearVelocity.y-=d*u,b.m_angularVelocity-=l*(f*u-g*a+this.m_motorImpulse+this.m_impulse.z),c.m_linearVelocity.x+=e*a,c.m_linearVelocity.y+=e*u,c.m_angularVelocity+=m*(k*u-h*a+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e,f,g,k,h=b.m_linearVelocity,l=b.m_angularVelocity,m=c.m_linearVelocity,u=c.m_angularVelocity,p=b.m_invMass,n=c.m_invMass,r=b.m_invI,
s=c.m_invI;this.m_enableMotor&&this.m_limitState!=G.EQUAL_LIMITS&&(f=this.m_motorMass*-(u-l-this.m_motorSpeed),g=this.m_motorImpulse,a=a.dt*this.m_maxMotorTorque,this.m_motorImpulse=q.clamp(this.m_motorImpulse+f,-a,a),f=this.m_motorImpulse-g,l-=r*f,u+=s*f);if(this.m_enableLimit&&this.m_limitState!=G.INACTIVE_LIMIT){d=b.m_xf.R;f=this.m_localAnchor1.x-b.m_sweep.localCenter.x;g=this.m_localAnchor1.y-b.m_sweep.localCenter.y;e=d.col1.x*f+d.col2.x*g;g=d.col1.y*f+d.col2.y*g;f=e;d=c.m_xf.R;a=this.m_localAnchor2.x-
c.m_sweep.localCenter.x;k=this.m_localAnchor2.y-c.m_sweep.localCenter.y;e=d.col1.x*a+d.col2.x*k;k=d.col1.y*a+d.col2.y*k;a=e;e=m.x+-u*k-h.x- -l*g;var t=m.y+u*a-h.y-l*f;this.m_mass.solve33(this.impulse3,-e,-t,-(u-l));this.m_limitState==G.EQUAL_LIMITS?this.m_impulse.add(this.impulse3):this.m_limitState==G.AT_LOWER_LIMIT?(d=this.m_impulse.z+this.impulse3.z,0>d&&(this.m_mass.solve22(this.reduced,-e,-t),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=
this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==G.AT_UPPER_LIMIT&&(d=this.m_impulse.z+this.impulse3.z,0<d&&(this.m_mass.solve22(this.reduced,-e,-t),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0));h.x-=p*this.impulse3.x;h.y-=p*this.impulse3.y;l-=r*(f*this.impulse3.y-g*this.impulse3.x+this.impulse3.z);m.x+=n*this.impulse3.x;m.y+=
n*this.impulse3.y;u+=s*(a*this.impulse3.y-k*this.impulse3.x+this.impulse3.z)}else d=b.m_xf.R,f=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y,e=d.col1.x*f+d.col2.x*g,g=d.col1.y*f+d.col2.y*g,f=e,d=c.m_xf.R,a=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,e=d.col1.x*a+d.col2.x*k,k=d.col1.y*a+d.col2.y*k,a=e,this.m_mass.solve22(this.impulse2,-(m.x+-u*k-h.x- -l*g),-(m.y+u*a-h.y-l*f)),this.m_impulse.x+=this.impulse2.x,
this.m_impulse.y+=this.impulse2.y,h.x-=p*this.impulse2.x,h.y-=p*this.impulse2.y,l-=r*(f*this.impulse2.y-g*this.impulse2.x),m.x+=n*this.impulse2.x,m.y+=n*this.impulse2.y,u+=s*(a*this.impulse2.y-k*this.impulse2.x);b.m_linearVelocity.setV(h);b.m_angularVelocity=l;c.m_linearVelocity.setV(m);c.m_angularVelocity=u},solvePositionConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB,e=0;c=0;var f,g,k;if(this.m_enableLimit&&this.m_limitState!=G.INACTIVE_LIMIT){b=d.m_sweep.a-a.m_sweep.a-this.m_referenceAngle;
var h=0;this.m_limitState==G.EQUAL_LIMITS?(b=q.clamp(b-this.m_lowerAngle,-v.b2_maxAngularCorrection,v.b2_maxAngularCorrection),h=-this.m_motorMass*b,e=q.abs(b)):this.m_limitState==G.AT_LOWER_LIMIT?(b-=this.m_lowerAngle,e=-b,b=q.clamp(b+v.b2_angularSlop,-v.b2_maxAngularCorrection,0),h=-this.m_motorMass*b):this.m_limitState==G.AT_UPPER_LIMIT&&(e=b-=this.m_upperAngle,b=q.clamp(b-v.b2_angularSlop,0,v.b2_maxAngularCorrection),h=-this.m_motorMass*b);a.m_sweep.a-=a.m_invI*h;d.m_sweep.a+=d.m_invI*h;a.synchronizeTransform();
d.synchronizeTransform()}c=a.m_xf.R;h=this.m_localAnchor1.x-a.m_sweep.localCenter.x;b=this.m_localAnchor1.y-a.m_sweep.localCenter.y;f=c.col1.x*h+c.col2.x*b;b=c.col1.y*h+c.col2.y*b;h=f;c=d.m_xf.R;var l=this.m_localAnchor2.x-d.m_sweep.localCenter.x,m=this.m_localAnchor2.y-d.m_sweep.localCenter.y;f=c.col1.x*l+c.col2.x*m;m=c.col1.y*l+c.col2.y*m;l=f;g=d.m_sweep.c.x+l-a.m_sweep.c.x-h;k=d.m_sweep.c.y+m-a.m_sweep.c.y-b;var u=g*g+k*k;c=Math.sqrt(u);f=a.m_invMass;var p=d.m_invMass,n=a.m_invI,r=d.m_invI,s=10*
v.b2_linearSlop;u>s*s&&(u=1/(f+p),g=u*-g,k=u*-k,a.m_sweep.c.x-=0.5*f*g,a.m_sweep.c.y-=0.5*f*k,d.m_sweep.c.x+=0.5*p*g,d.m_sweep.c.y+=0.5*p*k,g=d.m_sweep.c.x+l-a.m_sweep.c.x-h,k=d.m_sweep.c.y+m-a.m_sweep.c.y-b);this.K1.col1.x=f+p;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=f+p;this.K2.col1.x=n*b*b;this.K2.col2.x=-n*h*b;this.K2.col1.y=-n*h*b;this.K2.col2.y=n*h*h;this.K3.col1.x=r*m*m;this.K3.col2.x=-r*l*m;this.K3.col1.y=-r*l*m;this.K3.col2.y=r*l*l;this.K.setM(this.K1);this.K.addM(this.K2);this.K.addM(this.K3);
this.K.solve(sb.tImpulse,-g,-k);g=sb.tImpulse.x;k=sb.tImpulse.y;a.m_sweep.c.x-=a.m_invMass*g;a.m_sweep.c.y-=a.m_invMass*k;a.m_sweep.a-=a.m_invI*(h*k-b*g);d.m_sweep.c.x+=d.m_invMass*g;d.m_sweep.c.y+=d.m_invMass*k;d.m_sweep.a+=d.m_invI*(l*k-m*g);a.synchronizeTransform();d.synchronizeTransform();return c<=v.b2_linearSlop?e<=v.b2_angularSlop:!1},__class__:sb});var fe=function(){ka.call(this);this.localAnchorA=new t;this.localAnchorB=new t;this.type=O.REVOLUTE_JOINT;this.localAnchorA.set(0,0);this.localAnchorB.set(0,
0);this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0;this.enableMotor=this.enableLimit=!1};fe.__name__=["box2D","dynamics","joints","B2RevoluteJointDef"];fe.__super__=ka;fe.prototype=r(ka.prototype,{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:fe});var qe=function(a){fa.call(this,a);this.m_localAnchorA=
new t;this.m_localAnchorB=new t;this.m_impulse=new Oa;this.m_mass=new fc;this.m_localAnchorA.setV(a.localAnchorA);this.m_localAnchorB.setV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.setZero();this.m_mass=new fc};qe.__name__=["box2D","dynamics","joints","B2WeldJoint"];qe.__super__=fa;qe.prototype=r(fa.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},getReactionForce:function(a){return new t(a*
this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return a*this.m_impulse.z},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchorB.x-e.m_sweep.localCenter.x,h=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;b=d.m_invMass;
c=e.m_invMass;var l=d.m_invI,m=e.m_invI;this.m_mass.col1.x=b+c+g*g*l+h*h*m;this.m_mass.col2.x=-g*f*l-h*k*m;this.m_mass.col3.x=-g*l-h*m;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+f*f*l+k*k*m;this.m_mass.col3.y=f*l+k*m;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=l+m;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_impulse.z*=a.dtRatio,d.m_linearVelocity.x-=b*this.m_impulse.x,d.m_linearVelocity.y-=b*this.m_impulse.y,
d.m_angularVelocity-=l*(f*this.m_impulse.y-g*this.m_impulse.x+this.m_impulse.z),e.m_linearVelocity.x+=c*this.m_impulse.x,e.m_linearVelocity.y+=c*this.m_impulse.y,e.m_angularVelocity+=m*(k*this.m_impulse.y-h*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.setZero()},solveVelocityConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB,e=a.m_linearVelocity,f=a.m_angularVelocity,g=d.m_linearVelocity,k=d.m_angularVelocity,h=a.m_invMass,l=d.m_invMass,m=a.m_invI,u=d.m_invI;b=a.m_xf.R;var p=
this.m_localAnchorA.x-a.m_sweep.localCenter.x,n=this.m_localAnchorA.y-a.m_sweep.localCenter.y;c=b.col1.x*p+b.col2.x*n;n=b.col1.y*p+b.col2.y*n;p=c;b=d.m_xf.R;var r=this.m_localAnchorB.x-d.m_sweep.localCenter.x,q=this.m_localAnchorB.y-d.m_sweep.localCenter.y;c=b.col1.x*r+b.col2.x*q;q=b.col1.y*r+b.col2.y*q;r=c;b=g.x-k*q-e.x+f*n;c=g.y+k*r-e.y-f*p;var s=k-f,t=new Oa;this.m_mass.solve33(t,-b,-c,-s);this.m_impulse.add(t);e.x-=h*t.x;e.y-=h*t.y;f-=m*(p*t.y-n*t.x+t.z);g.x+=l*t.x;g.y+=l*t.y;k+=u*(r*t.y-q*t.x+
t.z);a.m_angularVelocity=f;d.m_angularVelocity=k},solvePositionConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB;b=a.m_xf.R;var e=this.m_localAnchorA.x-a.m_sweep.localCenter.x,f=this.m_localAnchorA.y-a.m_sweep.localCenter.y;c=b.col1.x*e+b.col2.x*f;f=b.col1.y*e+b.col2.y*f;e=c;b=d.m_xf.R;var g=this.m_localAnchorB.x-d.m_sweep.localCenter.x,k=this.m_localAnchorB.y-d.m_sweep.localCenter.y;c=b.col1.x*g+b.col2.x*k;k=b.col1.y*g+b.col2.y*k;g=c;b=a.m_invMass;c=d.m_invMass;var h=a.m_invI,l=d.m_invI,
m=d.m_sweep.c.x+g-a.m_sweep.c.x-e,u=d.m_sweep.c.y+k-a.m_sweep.c.y-f,p=d.m_sweep.a-a.m_sweep.a-this.m_referenceAngle,n=10*v.b2_linearSlop,r=Math.sqrt(m*m+u*u),s=q.abs(p);r>n&&(h*=1,l*=1);this.m_mass.col1.x=b+c+f*f*h+k*k*l;this.m_mass.col2.x=-f*e*h-k*g*l;this.m_mass.col3.x=-f*h-k*l;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+e*e*h+g*g*l;this.m_mass.col3.y=e*h+g*l;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=h+l;n=new Oa;this.m_mass.solve33(n,
-m,-u,-p);a.m_sweep.c.x-=b*n.x;a.m_sweep.c.y-=b*n.y;a.m_sweep.a-=h*(e*n.y-f*n.x+n.z);d.m_sweep.c.x+=c*n.x;d.m_sweep.c.y+=c*n.y;d.m_sweep.a+=l*(g*n.y-k*n.x+n.z);a.synchronizeTransform();d.synchronizeTransform();return r<=v.b2_linearSlop?s<=v.b2_angularSlop:!1},__class__:qe});var re=function(){ka.call(this);this.localAnchorA=new t;this.localAnchorB=new t;this.type=O.WELD_JOINT;this.referenceAngle=0};re.__name__=["box2D","dynamics","joints","B2WeldJointDef"];re.__super__=ka;re.prototype=r(ka.prototype,
{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(c));this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:re});var T={__ename__:!0,__constructs__:"Image Audio Other Javascript Css Font".split(" "),Image:["Image",0]};T.Image.__enum__=T;T.Audio=["Audio",1];T.Audio.__enum__=T;T.Other=["Other",2];T.Other.__enum__=T;T.Javascript=["Javascript",3];T.Javascript.__enum__=T;T.Css=["Css",
4];T.Css.__enum__=T;T.Font=["Font",5];T.Font.__enum__=T;T.__empty_constructs__=[T.Image,T.Audio,T.Other,T.Javascript,T.Css,T.Font];var Qf=function(a,b,c,d,e){null==d&&(d=!1);this.isAbsolute=!1;this.asset=null;this.name=a;this.type=c;this.source=b;this.isAbsolute=d;this.options=e};Qf.__name__=["engine","AssetLoadingInfo"];Qf.prototype={__class__:Qf};var ua=function(){this._eventListeners=[]};ua.__name__=["engine","events","EventDispatcher"];ua.prototype={addEventListener:function(a,b){this.hasEventListener(a,
b)||this._eventListeners.push(new Rf(a,b))},hasEventListener:function(a,b){for(var c=this._eventListeners.length-1;0<=c;){if(this._eventListeners[c].eventName==a&&xa.compareMethods(this._eventListeners[c].action,b))return!0;--c}return!1},dispatchEvent:function(a){a.target=this;for(var b=this._eventListeners.length-1;0<=b;){var c=this._eventListeners[b];c.eventName==a.getType()&&c.action(a);--b}},removeAllEventListeners:function(){this._eventListeners=[]},removeEventListener:function(a,b){if(this.hasEventListener(a,
b))for(var c=this._eventListeners.length-1;0<=c;){var d=this._eventListeners[c];if(d.eventName==a&&xa.compareMethods(d.action,b)){this._eventListeners.splice(c,1);break}--c}},__class__:ua};var M=function(){this._instanceId=0;this._isActive=this._isUpdating=!0;this._isInitialized=this._isMarkedForDeletion=!1;this._eventListeners=[];this._instanceId=M._currentInstanceId++;this._name="GameObject"+this._instanceId;this._properties=new Ba};M.__name__=["engine","GameObject"];M.__super__=ua;M.prototype=
r(ua.prototype,{init:function(){this._isInitialized=!0;this.dispatchEvent(new jb("initialize"))},update:function(){!this._isInitialized&&this._isActive&&(this.init(),this.setActive(!0))},fixedUpdate:function(){},postUpdate:function(){},render:function(){},onActivate:function(){this._isActive=!0;this.dispatchEvent(new jb("activate"))},onDeactivate:function(){this._isActive=!1;this.dispatchEvent(new jb("deactivate"))},debugRender:function(){},handleMessage:function(a,b){},setProperty:function(a,b){var c=
this._properties;null!=N[a]?c.setReserved(a,b):c.h[a]=b},getProperty:function(a){var b=this._properties;return null!=N[a]?b.getReserved(a):b.h[a]},hasProperty:function(a){var b=this._properties;return null!=N[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},isMarkedForDeletion:function(){return this._isMarkedForDeletion},getName:function(){return this._name},setName:function(a){this._name=a},getInstanceId:function(){return this._instanceId},isActive:function(){return this._isActive},setActive:function(a){if(!this._isActive&&
a)this._isInitialized||this.init(),this.onActivate();else if(this._isActive&&!a)this.onDeactivate()},setUpdating:function(a){this._isUpdating=a},isUpdating:function(){return this._isUpdating},destroy:function(){this._isMarkedForDeletion=!0;this.setActive(!1)},onDestroy:function(){this.dispatchEvent(new jb("destroy"))},log:function(a){Da.log(a)},__class__:M});var m=function(a){M.call(this);a.addComponent(this);this.setName(hb.getClassName(y.getClass(this)))};m.__name__=["engine","Component"];m.__super__=
M;m.prototype=r(M.prototype,{getEntity:function(){return this._entity},setEntity:function(a){this._entity=a},getTags:function(){return this.getEntity().getTags()},addTag:function(a){this.getEntity().addTag(a)},hasTag:function(a){return this.getEntity().hasTag(a)},removeTag:function(a){this.getEntity().removeTag(a)},getComponent:function(a){return this.getEntity().getComponent(a)},getGameState:function(){return this.getEntity().getGameState()},destroy:function(){M.prototype.destroy.call(this)},addEntity:function(a){null==
a&&(a=!0);return this.getEntity().addEntity(a)},onPause:function(){},onResume:function(){},onDestroy:function(){M.prototype.onDestroy.call(this)},__class__:m});var hc=function(){this._prevScale=new K;this._prevRotation=new K;this._prevPosition=new K;this._cachedWorldScale=new K;this._cachedWorldRotation=new K;this._cachedWorldPosition=new K;this._isVisible=this._worldPositionDirty=this._worldRotationDirty=this._worldScaleDirty=!0;this._parent=null;M.call(this);this._components=[];this._children=[];
this._tags=[];this._transform=new Gc(this);this._transform.addEventListener("update",w(this,this.onTransformUpdate))};hc.__name__=["engine","Entity"];hc.instantiate=function(a){return a.addEntity()};hc.__super__=M;hc.prototype=r(M.prototype,{getTransform:function(){return this._transform},init:function(){M.prototype.init.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.init()}},getGameState:function(){return this._gameState},setGameState:function(a){this._gameState=
a},addTag:function(a){this._tags.push(a)},removeTag:function(a){for(var b=0,c=this._tags.length;b<c;){var d=b++;this._tags[d]==a&&this._tags.splice(d,1)}},hasTag:function(a){for(var b=0,c=this._tags.length;b<c;){var d=b++;if(this._tags[d]==a)return!0}return!1},getTags:function(){return this._tags},hasChild:function(a){for(var b=0,c=this._children.length;b<c;){var d=b++;if(this._children[d]==a)return!0}return!1},removeChild:function(a,b){null==b&&(b=!1);for(var c=0,d=this._children.length;c<d;){var e=
c++,f=this._children[e];if(f==a){f.setParent(null,b);this._children.splice(e,1);break}}},addChild:function(a,b){null==b&&(b=!1);a==this&&this.log("Cannot parent an Entity to itself.");null!=a.getParent()&&a.getParent().removeChild(a,b);this._children.push(a);a.setParent(this,b)},insertChild:function(a,b){a==this&&this.log("Cannot parent an Entity to itself.");null!=a.getParent()&&a.getParent().removeChild(a);this._children.splice(b,0,a);a.setParent(this)},destroyAllChildren:function(){for(var a=0,
b=this._children.length;a<b;){var c=a++;this._children[c].destroy()}this._children=[]},getParent:function(){return this._parent},getRootEntity:function(){return null!=this.getParent()?this.getParent():this},setParent:function(a,b){null==b&&(b=!1);if(this._parent!=a){var c=this.getPosition(),d=this.getRotation(),e=this.getScale();this._parent=a;null!=this.getParent()?this.dispatchEvent(new V("addedToParent",{parent:this.getParent()})):this.dispatchEvent(new V("removedFromParent"));b&&(this.setPosition(c.x,
c.y,c.z),this.setRotation(d.x,d.y,d.z),this.setScale(e.x,e.y,e.z));this.dispatchEvent(new V("displayUpdate"));this.dispatchEvent(new V("parentUpdate"));c=0;for(d=this._children;c<d.length;)e=d[c],++c,e.dispatchEvent(new V("parentUpdate"));this._worldScaleDirty=this._worldRotationDirty=this._worldPositionDirty=!0}},setActive:function(a){M.prototype.setActive.call(this,a)},isActive:function(){return this._isActive},isActiveInHierarchy:function(){return null!=this.getParent()?this.isActive()?this.getParent().isActive():
!1:this._isActive},getChildren:function(a){null==a&&(a=!1);if(!a)return this._children;a=this._children;for(var b=[].concat(a),c=0,d=b.length;c<d;){var e=c++;a=a.concat(b[e].getChildren(!0))}return a},findChildByName:function(a){for(var b=0,c=this._children.length;b<c;){var d=b++,d=this._children[d];if(d.getName()==a)return d;d=d.findChildByName(a);if(null!=d)return d}return null},isVisible:function(){return null!=this._parent?this._parent.isVisible()?this._isVisible:!1:this._isVisible},setVisible:function(a){(this._isVisible=
a)?this.dispatchEvent(new V("visibilityOn")):this.dispatchEvent(new V("visibilityOff"));this.dispatchEvent(new V("displayUpdate"))},onActivate:function(){M.prototype.onActivate.call(this);for(var a=0,b=this._children.length;a<b;){var c=a++;this._children[c].setActive(!0)}this.dispatchEvent(new V("displayUpdate"))},onDeactivate:function(){M.prototype.onDeactivate.call(this);for(var a=0,b=this._children.length;a<b;){var c=a++;this._children[c].setActive(!1)}this.dispatchEvent(new V("displayUpdate"))},
getPositionRef:function(){return this._transform.getPositionRef()},getPosition:function(){if(this._worldPositionDirty){this._cachedWorldPosition=this._transform.getPosition(U.World);this._worldPositionDirty=!1;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldPosition.getClone()},getLocalPosition:function(){return this._transform.getPosition(U.Local)},setLocalPosition:function(a,b,c){null==c&&(c=
0);null==b&&(b=0);null==a&&(a=0);this._transform.setPosition(new K(a,b,c),U.Local);this.dispatchEvent(new V("displayUpdate"))},setPosition:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setPosition(new K(a,b,c),U.World);this.dispatchEvent(new V("displayUpdate"))},translate:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.translate(a,b,c);this.dispatchEvent(new V("displayUpdate"))},getRotationRef:function(){return this._transform.getRotationRef()},
getRotation:function(){if(this._worldRotationDirty){this._cachedWorldRotation=this._transform.getRotation(U.World);this._worldRotationDirty=!0;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldRotation.getClone()},getLocalRotation:function(){return this._transform.getRotation(U.Local)},setLocalRotation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setRotation(a,b,
c,U.Local);this.dispatchEvent(new V("displayUpdate"))},setRotation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setRotation(a,b,c,U.World);this.dispatchEvent(new V("displayUpdate"))},setLocalRotation2d:function(a){null==a&&(a=0);var b=this._transform.getRotation(U.Local);this._transform.setRotation(b.x,b.y,a,U.Local);this.dispatchEvent(new V("displayUpdate"))},setRotation2d:function(a){null==a&&(a=0);var b=this._transform.getRotation(U.World);this._transform.setRotation(b.x,
b.y,a,U.World);this.dispatchEvent(new V("displayUpdate"))},rotate:function(a,b,c){this._transform.rotate(a,b,c)},rotate2d:function(a){this._transform.rotate(0,0,a)},getScaleRef:function(){return this._transform.getScaleRef()},getScale:function(){if(this._worldScaleDirty){this._cachedWorldScale=this._transform.getScale(U.World);this._worldScaleDirty=!1;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldScale.getClone()},
getLocalScale:function(){return this._transform.getScale(U.Local)},setScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._transform.setScale(a,b,c,U.World);this.dispatchEvent(new V("displayUpdate"))},setLocalScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._transform.setScale(a,b,c,U.Local);this.dispatchEvent(new V("displayUpdate"))},onPause:function(){for(var a=0,b=this._components.length;a<b;){var c=a++;this._components[c].onPause()}},onResume:function(){for(var a=
0,b=this._components.length;a<b;){var c=a++;this._components[c].onResume()}},update:function(){M.prototype.update.call(this);for(var a=this._components.length,b=a;0<b--;)a=this._components[b],a.isMarkedForDeletion()&&(a.onDestroy(),this._components.splice(b,1));a=this._components.length;for(b=0;b<a;){var c=b++,c=this._components[c];c.isActive()&&c.isUpdating()&&c.update()}},fixedUpdate:function(){M.prototype.fixedUpdate.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];
c.isActive()&&c.fixedUpdate()}},render:function(){M.prototype.render.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.render()}},postUpdate:function(){M.prototype.postUpdate.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.isUpdating()&&c.postUpdate()}},debugRender:function(){M.prototype.debugRender.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&
c.debugRender()}a=p.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ha.getDebugCamera()){var d=ha.getDebugCamera().getEntity(),b=ha.getDebugCamera().getZoomScale(),c=ha.getDebugCamera().getComponent(Ab),d=d.getPosition();a.translate(-d.x*b+c.getContainerOffset().x,-d.y*b+c.getContainerOffset().y);a.scale(b,b)}a.beginPath();a.globalAlpha=0.65;a.lineWidth=1;a.strokeStyle="#44FF44";b=this.getPosition();a.moveTo(b.x,b.y-10);a.lineTo(b.x,b.y+10);a.moveTo(b.x-10,b.y);
a.lineTo(b.x+10,b.y);a.moveTo(b.x-10,b.y-10);a.lineTo(b.x+10,b.y+10);a.moveTo(b.x+10,b.y-10);a.lineTo(b.x-10,b.y+10);a.stroke();a.restore();p.getInstance().getLayerByName("debug").setWholeCanvasDirty(!0)},addComponent:function(a){for(var b=0,c=this._components.length;b<c;){var d=b++;if(this._components[d]==a)return null}this._components.push(a);a.setEntity(this);return a},getComponent:function(a){for(var b=0,c=this._components.length;b<c;){var d=b++;if(y.__instanceof(this._components[d],a))return this._components[d]}return null},
getComponentsInChildren:function(a){var b=[],c=this.getComponents(a);null!=c&&(b=b.concat(c));for(var c=0,d=this._children.length;c<d;){var e=c++,e=this._children[e].getComponentsInChildren(a);null!=e&&(b=b.concat(e))}return b},getComponents:function(a){if(null==a)return this._components;for(var b=[],c=0,d=this._components.length;c<d;){var e=c++;y.__instanceof(this._components[e],a)&&b.push(this._components[e])}return 0<b.length?b:null},getComponentInParent:function(a){var b=this.getParent();return null==
b?null:null==b.getComponent(a)?b.getComponentInParent(a):null},handleMessage:function(a,b){for(var c=this._components.length-1;0<=c;){var d=this._components[c];d.isActive()&&d.handleMessage(a,b);--c}},isUpdating:function(){return null!=this._parent?this._isUpdating?this._parent.isUpdating():!1:this._isUpdating},destroy:function(){M.prototype.destroy.call(this);null!=this._gameState&&this._gameState.scheduleEntityForDeletion(this);for(var a=this._components.length;0<a--;){var b=this._components[a];
b.destroy();b.onDestroy()}for(a=this._children.length;0<a--;)b=this._children[a],b.destroy(),b.onDestroy();null!=this.getParent()&&this.getParent().removeChild(this)},addEntity:function(a){null==a&&(a=!0);var b=this.getGameState().addEntity();a&&this.addChild(b);return b},onTransformUpdate:function(){this.setTransformsDirty()},setTransformsDirty:function(){this._worldScaleDirty=this._worldRotationDirty=this._worldPositionDirty=!0;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c.setTransformsDirty()}},
onDestroy:function(){M.prototype.onDestroy.call(this)},__class__:hc});var R=function(){};R.__name__=["engine","GameConfig"];R.getProperty=function(a,b){var c=R._properties;if(null!=N[a]?!c.existsReserved(a):!c.h.hasOwnProperty(a))return b;c=R._properties;return null!=N[a]?c.getReserved(a):c.h[a]};R.getBoolProperty=function(a){a=R.getProperty(a);return"TRUE"!=a.toUpperCase()?"1"==a:!0};R.setProperty=function(a,b){var c=R._properties,d=ga.string(b);null!=N[a]?c.setReserved(a,d):c.h[a]=d};R.parseGameConfig=
function(a){for(var b=0,c=xa.fields(a);b<c.length;){var d=c[b];++b;var e=R._properties,f=xa.field(a,d);null!=N[d]?e.setReserved(d,f):e.h[d]=f}};R.prototype={__class__:R};var aa=function(){this._activeEntities=this._entitiesToDelete=null;this._isPaused=!1;this._elapsedTime=0;this._hasInitialized=!1;M.call(this);this._entities=[];this._activeEntities=[];this._entitiesToDelete=[];this._sceneRoot=this.addEntity()};aa.__name__=["engine","GameState"];aa.__super__=M;aa.prototype=r(M.prototype,{getPaused:function(){return this._isPaused},
init:function(){M.prototype.init.call(this)},getSceneRoot:function(){return this._sceneRoot},update:function(){M.prototype.update.call(this);for(var a=this._entitiesToDelete.length,b=0,c=a;b<c;){var d=b++,d=this._entitiesToDelete[d];d.onDestroy();F.remove(this._entities,d)}tb.clear(this._entitiesToDelete);b=0;if(!this._isPaused){tb.clear(this._activeEntities);c=[].concat(this._entities);a=c.length;for(d=0;d<a;){var e=d++,e=c[e];null!=e&&e.isActiveInHierarchy()&&(this._activeEntities.push(e),++b,e.isUpdating()&&
e.update())}this._elapsedTime+=p.getDeltaTime()}"1"==R.getProperty("debugCheats")&&ma.getInstance().isKeyPressed(105)&&(this.log(this._entities),this.log(this._activeEntities),I.outputAssets(),this.log("Active entities: "+b))},fixedUpdate:function(){M.prototype.fixedUpdate.call(this);if(!this._isPaused)for(var a=0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isActiveInHierarchy()&&c.fixedUpdate()}},postUpdate:function(){M.prototype.postUpdate.call(this);if(!this._isPaused)for(var a=
0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isUpdating()&&c.isActiveInHierarchy()&&c.postUpdate()}},render:function(){M.prototype.render.call(this);for(var a=0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isVisible()&&c.isActiveInHierarchy()&&c.render()}},debugRender:function(){M.prototype.debugRender.call(this);for(var a=0,b=this._entities.length;a<b;){var c=a++,c=this._entities[c];c.isActive()&&c.isVisible()&&c.debugRender()}},addEntity:function(a){null==
a&&(a=new hc);a.setGameState(this);this._entities.push(a);null!=this._sceneRoot&&this._sceneRoot.addChild(a);return a},removeEntity:function(a){F.remove(this._entities,a)},getHasEntity:function(a){return-1!=tb.indexOf(this._entities,a)},getEntities:function(){return this._entities},findEntityByName:function(a){for(var b=0,c=this._entities.length;b<c;){var d=b++,d=this._entities[d];if(d.getName()==a)return d}return null},getEntitiesByTag:function(a,b){null==b&&(b=!0);for(var c=[],d=0,e=this._entities.length;d<
e;){var f=d++,f=this._entities[f];(!b||f.isActiveInHierarchy())&&f.hasTag(a)&&c.push(f)}return c},getClosestEntityToPointByTag:function(a,b,c){null==c&&(c=!0);b=this.getEntitiesByTag(b);for(var d=-1,e=null,f=0,g=b.length;f<g;){var k=f++,k=b[k];if(!c||k.isActiveInHierarchy()){var h=k.getPosition(),h=(new K(h.x-a.x,h.y-a.y,h.z-a.z)).getLength();if(-1==d||h<d)d=h,e=k}}return e},sortEntitiesByZ:function(){this._entities.sort(function(a,b){var c=a.getPosition(),d=b.getPosition();return c.z==d.z?a.getInstanceId()>
b.getInstanceId()?1:-1:c.z<d.z?1:-1})},handleMessage:function(a,b){M.prototype.handleMessage.call(this,a,b);if(!this._isPaused)for(var c=this._activeEntities.length-1;0<=c;)this._activeEntities[c].isActive()&&this._activeEntities[c].handleMessage(a,b),--c},pause:function(){this._isPaused=!0;for(var a=0,b=this._entities.length;a<b;){var c=a++;this._entities[c].onPause()}},resume:function(){this._isPaused=!1;for(var a=0,b=this._entities.length;a<b;){var c=a++;this._entities[c].onResume()}},bringEntityToFront:function(a,
b){null==b&&(b=!1);F.remove(this._entities,a)&&this._entities.push(a);if(b)for(var c=a.getChildren(),d=0,e=c.length;d<e;){var f=d++;this.bringEntityToFront(c[f],!0)}},sendEntityToBack:function(a,b){null==b&&(b=!1);F.remove(this._entities,a)&&this._entities.splice(0,0,a);if(b)for(var c=a.getChildren(),d=0,e=c.length;d<e;){var f=d++;this.sendEntityToBack(c[f],!0)}},insertEntityAfter:function(a,b){if(F.remove(this._entities,a)){var c=this._entities,d=tb.indexOf(this._entities,b)+1;c.splice(d,0,a)}},
scheduleEntityForDeletion:function(a){this._entitiesToDelete.push(a)},destroy:function(){M.prototype.destroy.call(this);for(var a=this._entities.length-1;0<=a;)this._entities[a].destroy(),this._entities[a].onDestroy(),--a;this._isMarkedForDeletion=!0},__class__:aa});var Sf=function(){};Sf.__name__=["engine","TimeService"];Sf.prototype={__class__:Sf,__properties__:{get_fixedIterationsThisFrame:"get_fixedIterationsThisFrame",get_realDeltaTime:"get_realDeltaTime",set_isFixedTimeStep:"set_isFixedTimeStep",
get_isFixedTimeStep:"get_isFixedTimeStep",set_maxTimeStep:"set_maxTimeStep",get_maxTimeStep:"get_maxTimeStep",set_fixedTimeStep:"set_fixedTimeStep",get_fixedTimeStep:"get_fixedTimeStep",set_timeScale:"set_timeScale",get_timeScale:"get_timeScale",get_deltaTime:"get_deltaTime"}};var ue=function(){this._timeScale=1;this._maxTimeStep=0.5;this._isFixedTimeStep=!1;this._remainderTimeStep=0;this._fixedTimeStep=0.016666666666666666;this._prevTimeStamp=this._currentTimeStamp=0;this.updateTimeStamp();this._prevTimeStamp=
this._currentTimeStamp};ue.__name__=["engine","HaxeTimerTimeService"];ue.__interfaces__=[Sf];ue.prototype={get_deltaTime:function(){return this.get_isFixedTimeStep()?this.get_fixedTimeStep()*this.get_timeScale():Math.min(this.get_maxTimeStep(),this.get_realDeltaTime())*this.get_timeScale()},get_timeScale:function(){return this._timeScale},set_timeScale:function(a){return this._timeScale=a},get_fixedTimeStep:function(){return this._fixedTimeStep},set_fixedTimeStep:function(a){return this._fixedTimeStep=
a},get_maxTimeStep:function(){return this._maxTimeStep},set_maxTimeStep:function(a){return this._maxTimeStep=a},get_isFixedTimeStep:function(){return this._isFixedTimeStep},set_isFixedTimeStep:function(a){return this._isFixedTimeStep=a},get_realDeltaTime:function(){return this._currentTimeStamp-this._prevTimeStamp},get_fixedIterationsThisFrame:function(){var a=Math.min(this.get_maxTimeStep(),this.get_realDeltaTime()+this._remainderTimeStep),b=Math.floor(a/this.get_fixedTimeStep()),b=Math.max(1,b)|
0;this._remainderTimeStep=a-b*this._fixedTimeStep;return b},update:function(){this.updateTimeStamp()},updateTimeStamp:function(){this._prevTimeStamp=this._currentTimeStamp;this._currentTimeStamp=(new Date).getTime()/1E3},__class__:ue,__properties__:{get_fixedIterationsThisFrame:"get_fixedIterationsThisFrame",get_realDeltaTime:"get_realDeltaTime",set_isFixedTimeStep:"set_isFixedTimeStep",get_isFixedTimeStep:"get_isFixedTimeStep",set_maxTimeStep:"set_maxTimeStep",get_maxTimeStep:"get_maxTimeStep",set_fixedTimeStep:"set_fixedTimeStep",
get_fixedTimeStep:"get_fixedTimeStep",set_timeScale:"set_timeScale",get_timeScale:"get_timeScale",get_deltaTime:"get_deltaTime"}};var Bb=function(a,b,c,d,e){null==e&&(e=!1);this._context2d=null;this._wholeCanvasDirty=this._renderedThisFrame=!1;this._canvasWidth=this._canvasHeight=0;this._autoClear=!0;this._backgroundColor="#000000";M.call(this);this.setName(a);this._container=x.getContainer();this._canvas=x.getDocument().createElement("canvas");this._canvas.width=b;this._canvas.height=c;this._canvasWidth=
b;this._canvasHeight=c;this._canvas.setAttribute("webkitTransform","translate3d(0px, 0px, 0px);");this._canvas.style.position="absolute";this._context2d=this._canvas.getContext("2d");e?(Bb._masterLayer=this,this._container.appendChild(this._canvas)):this._canvas.style.visibility="hidden"};Bb.__name__=["engine","Layer"];Bb.getMasterLayer=function(){return Bb._masterLayer};Bb.__super__=M;Bb.prototype=r(M.prototype,{getClearBounds:function(){return this._clearBounds},setClearBounds:function(a){this._clearBounds=
a},getContext:function(){return this._context2d},getWholeCanvasDirty:function(){return this._wholeCanvasDirty},setWholeCanvasDirty:function(a){this._wholeCanvasDirty=a;this._renderedThisFrame=!0},clear:function(a){null==a&&(a=!1);if(Bb._masterLayer!=this||a)a=this._canvas.getContext("2d"),null==this._clearBounds?a.clearRect(0,0,this._canvas.width,this._canvas.height):a.clearRect(this._clearBounds.ul.x,this._clearBounds.ul.y,this._clearBounds.wh.x,this._clearBounds.wh.y),this._wholeCanvasDirty=!1},
render:function(){M.prototype.render.call(this);ia.getInstance().getWebGlEnabled()||(ia.getInstance().getRenderer().view.getContext("2d",null).setTransform(1,0,0,1,0,0),ia.getInstance().getRenderer().view.getContext("2d",null).drawImage(this._canvas,0,0,this._canvasWidth,this._canvasHeight))},getSize:function(){return new s(this._canvasWidth,this._canvasHeight)},setSize:function(a,b){this._canvasWidth=a;this._canvasHeight=b;this._canvas.width=a;this._canvas.height=b},update:function(){M.prototype.update.call(this);
this._renderedThisFrame=!1},getMaskFunction:function(){return this._maskFunction},setMaskFunction:function(a){this._maskFunction=a},getContainer:function(){return this._container},getCanvas:function(){return this._canvas},getAutoClear:function(){return this._autoClear},setAutoClear:function(a){this._autoClear=a},destroy:function(){M.prototype.destroy.call(this);null!=this.getCanvas().parentNode&&this.getCanvas().parentNode.removeChild(this.getCanvas())},__class__:Bb});var Pb=function(a){null==a&&
(a=!1);this._currentRequestsActive=0;this._minLoadTimeElapsed=!1;this._currentAssetToLoad=0;this._loadCompleted=!1;this._assetsToLoad=0;this._onCompleteCallback=null;this._assetLoadingInfo=[];a&&(this._minLoadTimeElapsed=!0)};Pb.__name__=["engine","LoadBatch"];Pb.prototype={getLoadComplete:function(){return this._loadCompleted},addAsset:function(a,b,c,d){this._assetLoadingInfo.push(new Qf(a,b,c,!1,d))},getAssetLoadingInfoByAssetName:function(a){for(var b=0,c=this._assetLoadingInfo.length;b<c;){var d=
b++,d=this._assetLoadingInfo[d];if(d.name==a)return d}return null},numAssets:function(){return this._assetsToLoad},onAssetLoaded:function(a){this._assetsToLoad--;this.checkAssetsLoaded();a=this._assetLoadingInfo.length-this._assetsToLoad;p.getInstance().sendGlobalMessage("onFileLoaded",{progress:a,total:this._assetLoadingInfo.length});this.loadNext()},onXmlHttpRequestLoaded:function(a){},checkAssetsLoaded:function(){if(!(0<this._currentRequestsActive)){var a=this._assetLoadingInfo.length-this._assetsToLoad;
p.getInstance().sendGlobalMessage("onFileLoaded",{progress:a,total:this._assetLoadingInfo.length});this._loadCompleted||0<this._assetsToLoad||this.fireAllAssetsLoaded()}},fireAllAssetsLoaded:function(){this._minLoadTimeElapsed&&(this._loadCompleted=!0,null!=this._onCompleteCallback&&this._onCompleteCallback())},load:function(a){this._onCompleteCallback=a;this._assetsToLoad=this._assetLoadingInfo.length;this._loadCompleted=!1;this._currentAssetToLoad=0;0==this._assetLoadingInfo.length?(a(),this._loadCompleted=
!0):(this.loadNext(),p.getInstance().setDeferredActionsPaused(!1),p.getInstance().invokeAsyncDeferredAction(0.5,w(this,this.onMinLoadElapsed)))},unload:function(){for(var a=0,b=this._assetLoadingInfo.length;a<b;){var c=a++;I.unloadAsset(this._assetLoadingInfo[c].name)}},loadNext:function(){var a=this;if(!(10<=this._currentRequestsActive||0>=this._assetsToLoad&&this._minLoadTimeElapsed)){for(var b=null;null==b&&0<this._assetsToLoad;)if(b=this._assetLoadingInfo[this._currentAssetToLoad++],null==b)this._assetsToLoad--,
this.checkAssetsLoaded();else break;if(!(0>=this._assetsToLoad)){b.source=Hb.replace(b.source,"${locale}",x.dataLocale);switch(b.type[1]){case 0:var c=x.getDocument().createElement("img");I.registerAsset(b.name,c);this._currentRequestsActive++;var d=this;c.addEventListener("load",function(d){PIXI.Texture.addTextureToCache(PIXI.Texture.fromImage(c.src,!1,null!=b.options?b.options.scaleMode:PIXI.SCALE_MODES.DEFAULT),b.name);a._currentRequestsActive--;a.onAssetLoaded(d)});c.addEventListener("onerror",
function(){d._assetsToLoad--;alert("file not found: "+b.source);a._currentRequestsActive--;d.checkAssetsLoaded();var c=d._assetLoadingInfo.length-d._assetsToLoad;p.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:d._assetLoadingInfo.length});d.loadNext()});c.id=b.name;c.src=b.source;break;case 1:if(!p.isMobile()||n.isWebkitEnabled()||p.isCocoon()){var e=null,f=this;if(I.assetExists(b.name)){f._assetsToLoad--;f.checkAssetsLoaded();e=f._assetLoadingInfo.length-f._assetsToLoad;p.getInstance().sendGlobalMessage("onFileLoaded",
{progress:e,total:f._assetLoadingInfo.length});f.loadNext();return}var e=F.substr(b.source,b.source.length-3,3),g=-1<navigator.userAgent.toLowerCase().indexOf("firefox");"mp3"==e&&g&&(b.source=Hb.replace(b.source,"mp3","ogg"));if(!n.isWebkitEnabled()||g)e=document.createElement("audio"),e.src=b.source,e.preload=!0,e.autoplay=!1,e.id=b.name,this._currentRequestsActive++,e.addEventListener("canplay",function(){f._assetsToLoad--;a._currentRequestsActive--;f.checkAssetsLoaded();var b=f._assetLoadingInfo.length-
f._assetsToLoad;p.getInstance().sendGlobalMessage("onFileLoaded",{progress:b,total:f._assetLoadingInfo.length});f.loadNext()},!1),e.addEventListener("onerror",function(){f._assetsToLoad--;console.log("File not found: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;p.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),e.addEventListener("stalled",function(){f._assetsToLoad--;console.log("File not found: "+
b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;p.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),e.addEventListener("suspend",function(){f._assetsToLoad--;console.log("Loading suspended: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;p.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});
f.loadNext()}),I.registerAsset(b.name,e),e.load();else{var k=new XMLHttpRequest;k.open("GET",b.source,!0);k.responseType="arraybuffer";I.registerAsset(b.name+"_src",b.source);this._currentRequestsActive++;k.onload=function(){n.getAudioContextInstance().decodeAudioData(k.response,function(c){I.registerAsset(b.name,c);f._assetsToLoad--;a._currentRequestsActive--;f.checkAssetsLoaded();c=f._assetLoadingInfo.length-f._assetsToLoad;p.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});
f.loadNext()})};k.send()}}else I.registerAsset(b.name,b.source),this._assetsToLoad--,this.checkAssetsLoaded(),this.loadNext();break;case 2:var h=new XMLHttpRequest,l=this;this._currentRequestsActive++;h.onload=function(){I.registerAsset(b.name,h.responseText);l._assetsToLoad--;a._currentRequestsActive--;l.checkAssetsLoaded();var c=l._assetLoadingInfo.length-l._assetsToLoad;p.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:l._assetLoadingInfo.length});l.loadNext()};h.onerror=function(){l._assetsToLoad--;
alert("File not found: "+b.source);a._currentRequestsActive--;l.checkAssetsLoaded();l.loadNext()};h.open("GET",b.source,!0);h.send();break;case 3:e=x.getDocument().createElement("script");e.type="text/javascript";e.async=!0;e.src=b.source;e.id=b.name;x.getDocument().body.appendChild(e);this._currentRequestsActive++;e.onload=function(){a._currentRequestsActive--;a.checkAssetsLoaded();a.loadNext()};break;case 4:e=x.getDocument().createElement("link");e.rel="stylesheet";e.type="text/css";e.href=b.source;
e.id=b.name;x.getDocument().head.appendChild(e);this.checkAssetsLoaded();this.loadNext();break;case 5:e='<style type="text/css"> @font-face { font-family: \''+b.name+"'; src: url('"+b.source+"'); } </style>",x.getDocument().head.innerHTML+=e,this.checkAssetsLoaded(),this.loadNext()}this.loadNext()}}},onMinLoadElapsed:function(){this._minLoadTimeElapsed=!0;this.checkAssetsLoaded()},concatLoadBatch:function(a){for(var b=0,c=a._assetLoadingInfo.length;b<c;){var d=b++,d=a._assetLoadingInfo[d];this.hasAsset(d.name)||
this._assetLoadingInfo.push(d)}},hasAsset:function(a){for(var b=0,c=this._assetLoadingInfo.length;b<c;){var d=b++;if(this._assetLoadingInfo[d].name==a)return!0}return!1},__class__:Pb};var oa=function(){};oa.__name__=["engine","Localizer"];oa.initStrings=function(){if(!oa._isInitialized){var a=I.getAsset("strings"),a=A.parse(a);oa.stringsXml=a.elementsNamed("strings").next();oa._isInitialized=!0}};oa.getString=function(a){try{var b=oa.stringsXml.elementsNamed(a).next();if(b.nodeType!=A.Document&&b.nodeType!=
A.Element)throw new H("Bad node type, expected Element or Document but found "+b.nodeType);var c=b.children[0];if(c.nodeType==A.Document||c.nodeType==A.Element)throw new H("Bad node type, unexpected "+c.nodeType);return c.nodeValue}catch(d){throw new H("Could not find string: "+a);}};var da=function(){M.call(this)};da.__name__=["engine","Manager"];da.__super__=M;da.prototype=r(M.prototype,{__class__:da});var Cb=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.ul=
new s(a,b);this.wh=new s(c,d)};Cb.__name__=["engine","Rect2D"];Cb.prototype={getClone:function(){return new Cb(this.ul.x,this.ul.y,this.wh.x,this.wh.y)},getIntersect:function(a){return!(this.ul.x>a.ul.x+a.wh.x||this.ul.x+this.wh.x<a.ul.x||this.ul.y>a.ul.y+a.wh.y||this.ul.y+this.wh.y<a.ul.y)},containsPoint:function(a){return a.x>this.ul.x&&a.y>this.ul.y&&a.x<this.ul.x+this.wh.x?a.y<this.ul.y+this.wh.y:!1},__class__:Cb};var p=function(a,b,c){this._iosAudioEnabled=!1;this._prevWidth=this._prevHeight=
0;this._isUpdating=!0;this._hasFocus=!1;this._screenScale=null;this._isOrientationScreenShowing=!1;this._currentOrientation=0;this._isDeferredActionsPaused=!1;this._gameStates=this._managers=this._layers=this._deferredActions=null;this._gameHeight=768;this._gameWidth=1024;this._gameId=a;this._gameWidth=b;this._gameHeight=c;this._screenScale=new s(1,1);this._gameStates=[];p._instance=this;this._layers=[];this._managers=[];this._deferredActions=[]};p.__name__=["engine","Root"];p.getTimeScale=function(){return p._timeService.get_timeScale()};
p.setTimeScale=function(a){p._timeService.set_timeScale(a)};p.getDeltaTime=function(){return p._timeService.get_deltaTime()};p.getRealDeltaTime=function(){return p._timeService.get_realDeltaTime()};p.getInstance=function(){return p._instance};p.isAppMode=function(){return window.isStandalone};p.isPhone=function(){return-1!=navigator.userAgent.toLowerCase().indexOf("iphone")||-1!=navigator.userAgent.toLowerCase().indexOf("ipod")||-1!=navigator.userAgent.toLowerCase().indexOf("android")||-1!=navigator.userAgent.toLowerCase().indexOf("Linux")?
!0:!1};p.isIOS=function(){x.getWindow();var a=x.getWindow().navigator.platform;return-1!=a.indexOf("iPhone")||-1!=a.indexOf("iPod")||-1!=a.indexOf("iPad")?!0:!1};p.isCocoon=function(){return!1};p.isMobile=function(){x.getWindow();var a=x.getWindow().navigator.platform;return-1!=a.indexOf("iPhone")||-1!=a.indexOf("iPod")||-1!=a.indexOf("iPad")||-1!=a.indexOf("android")||-1!=a.indexOf("Linux")?!0:!1};p.isInternetExplorer=function(){return-1!=navigator.userAgent.toLowerCase().indexOf("msie")};p.isFirefox=
function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")};p.isSafari=function(){return-1<navigator.userAgent.toLowerCase().indexOf("safari/")};p.getDevicePixelRatio=function(){return 1};p.prototype={getGameStates:function(){return this._gameStates},getLayers:function(){return this._layers},getGameWidth:function(){return this._gameWidth},setGameWidth:function(a){this._gameWidth=a},getGameHeight:function(){return this._gameHeight},setGameHeight:function(a){this._gameHeight=a},getGameId:function(){return this._gameId},
init:function(){n.init();x.getContainer().focus();for(var a=0,b=this._gameStates;a<b.length;){var c=b[a];++a;c.init()}this._prevWidth=x.getWindow().innerWidth;this._prevHeight=x.getWindow().innerHeight;a=window;a.addEventListener("orientationchange",w(this,this.onOrientationChange),!1);a.addEventListener("pageshow",w(this,this.onOrientationChange),!1);a.addEventListener("resize",w(this,this.onResizeWindow),!1);a.onfocus=w(this,this.onFocusGained);a.onblur=w(this,this.onFocusLost);window.document.addEventListener("webkitvisibilitychange",
w(this,this.onWebkitVisibilityChange),!1);a.addEventListener("pagehide",w(this,this.onFocusLost),!1);p.isMobile()&&p.isIOS()&&a.addEventListener("touchend",w(this,this.onIosTouchEnd),!1);if(p.isMobile())this.onOrientationChange();else this.setScreenScale(1,1)},update:function(){if(!this._hasFocus)this.onFocusGained();if(this._isUpdating){for(var a=0,b=this._managers.length,a=b;0<a--;)b=this._managers[a],b.isMarkedForDeletion()&&(b.onDestroy(),this._managers.splice(a,1));b=this._managers.length;for(a=
0;a<b;){var c=a++,c=this._managers[c];c.isActive()&&c.update()}n.update();for(a=b=this._gameStates.length;0<a--;)b=this._gameStates[a],b.isMarkedForDeletion()&&(b.onDestroy(),this._gameStates.splice(a,1));b=this._gameStates.length;for(a=0;a<b;)c=a++,this._gameStates[c].isActive()&&this._gameStates[c].update();for(a=this._layers.length;0<a--;)b=this._layers[a],b.isMarkedForDeletion()&&(b.onDestroy(),F.remove(this._layers,b));a=0;for(b=this._layers.length;a<b;)c=a++,this._layers[c].update()}if(!this._isDeferredActionsPaused)for(a=
this._deferredActions.length;0<a--;)b=this._deferredActions[a],null!=b&&(b.timeUntilExecute-=p.getDeltaTime(),0>=b.timeUntilExecute&&(b.params?b.actionToExecute(b.params):b.actionToExecute(),this._deferredActions.splice(a,1)))},fixedUpdate:function(){var a=p._timeService.get_fixedIterationsThisFrame();p._timeService.set_isFixedTimeStep(!0);for(var b=0;b<a;){b++;for(var c=0,d=this._managers.length;c<d;){var e=c++,e=this._managers[e];e.isActive()&&e.fixedUpdate()}c=0;for(d=this._gameStates.length;c<
d;)e=c++,this._gameStates[e].isActive()&&this._gameStates[e].fixedUpdate()}p._timeService.set_isFixedTimeStep(!1)},postUpdate:function(){for(var a=0,b=this._managers.length;a<b;){var c=a++,c=this._managers[c];c.isActive()&&c.postUpdate()}a=0;for(b=this._gameStates.length;a<b;)c=a++,this._gameStates[c].isActive()&&this._gameStates[c].postUpdate()},processFrame:function(){p._timeService.update();this.fixedUpdate();this.update();this.render();this.postUpdate()},updateDivClass:function(){var a="container";
1==this._currentOrientation&&(a+=" portrait");x.getContainer().className=a},render:function(){for(var a=this._layers.length,b=0;b<a;){var c=b++,c=this._layers[c];c.getAutoClear()&&c.getWholeCanvasDirty()&&c.clear()}b=0;for(a=this._gameStates.length;b<a;)c=b++,this._gameStates[c].isActive()&&this._gameStates[c].render();b=0;for(a=this._managers.length;b<a;)c=b++,this._managers[c].isActive()&&this._managers[c].render();a=this._layers.length;for(b=0;b<a;)c=b++,c=this._layers[c],"debug"!=c.getName()&&
c.render()},debugRender:function(){for(var a=0,b=this._gameStates.length;a<b;){var c=a++;this._gameStates[c].debugRender()}a=0;for(b=this._managers.length;a<b;)c=a++,this._managers[c].debugRender();a=0;for(b=this._layers.length;a<b;)c=a++,c=this._layers[c],"debug"==c.getName()&&c.render(),c.debugRender()},addGameState:function(a){0<=this._gameStates.indexOf(a)&&(F.remove(this._gameStates,a),this._gameStates.push(a));for(var b=0,c=this._gameStates.length;b<c;){var d=b++;if(a==this._gameStates[d])return a}this._gameStates.push(a);
return a},removeGameState:function(a){a.destroy()},addManager:function(a){this._managers.push(a);a.init()},removeManager:function(a){for(var b=0,c=this._managers.length;b<c;){var d=b++;if(this._managers[d]==a){this._managers.splice(d,1);a.destroy();break}}},getManager:function(a){for(var b=0,c=this._managers.length;b<c;){var d=b++;if(y.__instanceof(this._managers[d],a))return this._managers[d]}return null},setDeferredActionsPaused:function(a){this._isDeferredActionsPaused=a},destroyAllDeferredActions:function(){this._deferredActions=
[]},switchToGameState:function(a,b){null!=a&&this.removeGameState(a);null!=b&&this.addGameState(b)},addLayer:function(a,b){null==b&&(b=!1);b?this._layers.splice(0,0,a):this._layers.push(a)},insertLayerAfter:function(a,b){var c=this._layers,d=this._layers.indexOf(b)+1;c.splice(d,0,a)},removeLayer:function(a){a.destroy();F.remove(this._layers,a)},getLayerByName:function(a){for(var b=0,c=this._layers.length;b<c;){var d=b++,d=this._layers[d];if(d.getName()==a)return d}return null},sendGlobalMessage:function(a,
b){for(var c=this._managers.length-1;0<=c;)this._managers[c].handleMessage(a,b),--c;for(c=this._gameStates.length-1;0<=c;)this._gameStates[c].handleMessage(a,b),--c},invokeAsyncDeferredAction:function(a,b,c){a=new ve(a,b,c);this._deferredActions.push(a);return a},destroyDeferredAction:function(a){F.remove(this._deferredActions,a)},onOrientationChange:function(){var a=this;this.invokeAsyncDeferredAction(0.35,function(){var b=!1,b=p.isMobile()?x.getWindow().innerWidth>x.getWindow().innerHeight:!0;"HORIZONTAL"==
R.getProperty("forceOrientation")?(a._currentOrientation=0,b=!0):"VERTICAL"==R.getProperty("forceOrientation")?(a._currentOrientation=1,b=!1):a._currentOrientation=b?0:1;a.onResizeWindow();a.sendGlobalMessage("onOrientationChanged",{isHorizontal:b})})},setScreenScale:function(a,b){this.updateDivClass();this._screenScale.x=a;this._screenScale.y=b;this.onScreenScaleUpdated()},getScreenScale:function(){return null!=ia.getInstance()&&null!=ia.getInstance().getStage()?new s(ia.getInstance().getStage().scale.x,
ia.getInstance().getStage().scale.y):new s(1,1)},getGameSize:function(){return new s(this._gameWidth,this._gameHeight)},getScreenOffset:function(){var a=x.getWindow().innerWidth,b=x.getWindow().innerHeight;return new s(Math.max(0,a/2-this._gameWidth*this.getScreenScale().x/2),Math.max(0,b/2-this._gameHeight*this.getScreenScale().y/2))},getCurrentOrientation:function(){return this._currentOrientation},onWebkitVisibilityChange:function(){if(x.getDocument().webkitHidden)this.onFocusLost();else this.onFocusGained()},
onFocusGained:function(){this._hasFocus||(ma.getInstance().disablePageKeyPresses(),n.resumeAllSounds(),this._isUpdating=this._hasFocus=!0,this.sendGlobalMessage("onFocusGained"))},onFocusLost:function(){n.pauseAllSounds();this._hasFocus&&(ma.getInstance().enablePageKeyPresses(),this._isUpdating=this._hasFocus=!1,this.sendGlobalMessage("onFocusLost"))},onResizeWindow:function(){var a=1,b=a,b="1"==R.getProperty("scaleToScreenOnDesktop");p.isMobile()||b?(b=x.getWindow(),b=a=Math.min(b.innerHeight/this._gameHeight,
b.innerWidth/this._gameWidth)):a=b=1;this.sendGlobalMessage("onResizedWindow");this.setScreenScale(b,a)},onScreenScaleUpdated:function(){x.getWindow();x.getWindow();x.getContainer();p.getDevicePixelRatio();p.isMobile()&&this.hideAddressBar();this.sendGlobalMessage("onScreenScaleUpdated")},stopUpdates:function(){this._isUpdating=!1},resumeUpdates:function(){this._isUpdating=!0},hideAddressBar:function(){if(p.isPhone()&&!window.location.hash){var a=window.outerHeight;document.height<a&&(document.body.style.height=
a+50+"px");setTimeout(function(){window.scrollTo(0,1)},50)}},requestFullscreen:function(){if(!p.isIOS()){var a=window.document,b=a.documentElement,c=b.requestFullscreen||b.mozRequestFullScreen||b.webkitRequestFullScreen||b.msRequestFullscreen;a.fullscreenElement||(a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement)||c.call(b)}},onIosTouchEnd:function(){if(!1==this._iosAudioEnabled)try{var a=n.getAudioContextInstance(),b=a.createBuffer(1,1,22050),c=a.createBufferSource();c.buffer=
b;c.connect(a.destination);c.start(0);this._iosAudioEnabled=!0;Da.log("Audio enabled for iOS")}catch(d){Da.log("error")}},__class__:p};var Tf=function(){this._data={};this.load()};Tf.__name__=["engine","SaveData"];Tf.prototype={setItem:function(a,b){this._data[a]=b;this.save()},getItem:function(a,b){if(Object.prototype.hasOwnProperty.call(this._data,a))return xa.field(this._data,a);this.setItem(a,b);return b},save:function(){var a=p.getInstance().getGameId()+"Data";if(null!=Ya.getSessionStorage())try{Ya.getSessionStorage().setItem(a,
JSON.stringify(this._data))}catch(b){Da.log("Error saving to session storage")}if(null!=Ya.getLocalStorage())try{Ya.getLocalStorage().setItem(a,JSON.stringify(this._data))}catch(c){Da.log("Error saving to local storage")}},load:function(){var a=p.getInstance().getGameId()+"Data";if(null!=Ya.getSessionStorage()||null!=Ya.getLocalStorage()){var b=null;try{b=Ya.getSessionStorage().getItem(a)}catch(c){Da.log("Failed to get item from session storage")}if(null==b)try{b=Ya.getLocalStorage().getItem(a)}catch(d){Da.log("Failed to get item from session storage")}null!=
b&&(this._data=JSON.parse(b))}},deleteAllSaveData:function(){this._data={};this.save()},__class__:Tf};var s=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=this.y=0;this.x=a;this.y=b};s.__name__=["engine","Vector2"];s.prototype={getClone:function(){return new s(this.x,this.y)},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},scaleBy:function(a,b){this.x*=a;this.y*=b},dotProduct:function(a){return this.x*a.x+this.y*a.y},getNormalized:function(){var a=this.getLength();return new s(this.x/
a,this.y/a)},__class__:s};var K=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=this.y=this.z=0;this.x=a;this.y=b;this.z=c};K.__name__=["engine","Vector3"];K.lerp=function(a,b,c){return new K(a.x+(b.x-a.x)*c,a.y+(b.y-a.y)*c,a.z+(b.z-a.z)*c)};K.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};K.prototype={add:function(a){return new K(this.x+a.x,this.y+a.y,this.z+a.z)},subtract:function(a){return new K(this.x-a.x,this.y-a.y,this.z-a.z)},scaleBy:function(a){this.x*=a;this.y*=a;this.z*=
a},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},getClone:function(){return new K(this.x,this.y,this.z)},getNormalized:function(){var a=this.getLength();return new K(this.x/a,this.y/a,this.z/a)},__class__:K};var ca=function(a,b,c){this._isMuted=!1;this._currentTime=0;this._isInitialized=!1;this._soundName=a;this._volume=b;this._loop=c;this.init()};ca.__name__=["engine","audio","SoundData"];ca.prototype={init:function(){this._isInitialized=!0},play:function(a){},
resume:function(){},update:function(){this._currentTime+=p.getDeltaTime()},pause:function(){},stop:function(){n.removeSoundFromPlayingSounds(this)},getVolume:function(){return this._volume},setVolume:function(a){this._volume=a},getMuted:function(){return this._isMuted},setMuted:function(a){this._isMuted=a},getLoop:function(){return this._loop},setLoop:function(a){this._loop=a},getSoundLength:function(){return 1},getCurrentTime:function(){return this._currentTime},setCurrentTime:function(a){this._currentTime=
a},getSoundName:function(){return this._soundName},__class__:ca};var jd=function(a,b,c){ca.call(this,a,b,c)};jd.__name__=["engine","audio","FlashSoundData"];jd.__super__=ca;jd.prototype=r(ca.prototype,{init:function(){ca.prototype.init.call(this);this._audio=soundManager.createSound({id:this._soundName});this._audio.setVolume(100*this._volume)},play:function(a){null==a&&(a=0);ca.prototype.play.call(this,a);var b=this;this._audio.play({onfinish:function(){b._loop&&b.play(0);n.removeSoundFromPlayingSounds(b)},
onstop:function(){n.removeSoundFromPlayingSounds(b)}})},pause:function(){ca.prototype.pause.call(this);this._audio.pause()},stop:function(){ca.prototype.stop.call(this);this._audio.stop()},resume:function(){ca.prototype.resume.call(this);this._audio.resume()},setVolume:function(a){ca.prototype.setVolume.call(this,a);this._audio.setVolume(100*a)},__class__:jd});var kd=function(a,b,c){ca.call(this,a,b,c)};kd.__name__=["engine","audio","Html5SoundData"];kd.__super__=ca;kd.prototype=r(ca.prototype,{init:function(){ca.prototype.init.call(this)},
play:function(a){null==a&&(a=0);var b=this;ca.prototype.play.call(this,a);this._audio=I.getAsset(this._soundName);0!=a&&this._audio.addEventListener("canplay",function(c){b._audio.currentTime=a});this._audio.play();this._audio.addEventListener("ended",w(this,this.onSoundComplete),!1);this._audio.loop=this._loop;this._audio.volume=this._volume},resume:function(){ca.prototype.resume.call(this);this._audio.play()},pause:function(){ca.prototype.pause.call(this);this._audio.pause()},stop:function(){ca.prototype.stop.call(this);
this._audio.pause()},onSoundComplete:function(a){n.removeSoundFromPlayingSounds(this)},setVolume:function(a){ca.prototype.setVolume.call(this,a);this._audio.volume=a},setMuted:function(a){ca.prototype.setMuted.call(this,a);this._audio.muted=a},setLoop:function(a){ca.prototype.setLoop.call(this,a);null!=this._audio&&(this._audio.loop=a)},getCurrentTime:function(){return this._audio.currentTime},setCurrentTime:function(a){this._audio.currentTime=a},__class__:kd});var n=function(){};n.__name__=["engine",
"audio","SoundManager"];n.getMusicTrack=function(){return n._musicTrack};n.init=function(){try{n._audioContext=new AudioContext,n._isWebkitEnabled=!p.isFirefox()&&null!=n._audioContext}catch(a){if(p.isInternetExplorer())try{soundManager.setup({url:"soundmanager2_flash9.swf",flashVersion:9,onready:n.onSoundManagerReady,ontimeout:n.onSoundManagerTimeout,useHighPerformance:!0})}catch(b){n._useFlashSound=!1}}window.document.body.addEventListener("pointerdown",n.onPointerDown);n._musicTrack=new ld(null)};
n.onPointerDown=function(){null!=n._audioContext&&n._audioContext.resume();window.document.body.removeEventListener("pointerdown",n.onPointerDown)};n.onSoundManagerReady=function(){n._useFlashSound=!0==soundManager.html5.usingFlash};n.onSoundManagerTimeout=function(){n._useFlashSound=!1==soundManager.html5.usingFlash};n.getAudioContextInstance=function(){return n._audioContext};n.isWebkitEnabled=function(){return n._isWebkitEnabled?!n._useFlashSound:!1};n.setWebkitEnabled=function(a){n._isWebkitEnabled=
a};n.isMusicMuted=function(){return n._musicMuted};n.setMusicMuted=function(a){n._musicMuted=a;null!=n._musicTrack.get()&&n._musicTrack.get().setMuted(a);n.isWebkitEnabled()||(p.isMobile()&&a?n._musicTrack.get().pause():p.isMobile()&&!a&&n._musicTrack.get().play())};n.isSoundMuted=function(){return n._soundMuted};n.setSoundMuted=function(a){n._soundMuted=a;for(var b=0,c=n._soundsPlaying.length;b<c;){var d=b++;n._soundsPlaying[d].setMuted(a)}};n.getMasterVolume=function(){return n._masterVolume};n.setMasterVolume=
function(a){n._masterVolume=a;n.setMusicVolume(n._musicVolume);n.setSoundVolume(n._soundVolume)};n.getMusicVolume=function(){return n._musicVolume};n.setMusicVolume=function(a){n._musicVolume=a;null!=n._musicTrack&&null!=n._musicTrack.get()&&n._musicTrack.get().setVolume(n.getMusicVolume()*n.getMasterVolume())};n.getSoundVolume=function(){return n._soundVolume};n.setSoundVolume=function(a){n._soundVolume=a;a=0;for(var b=n._soundsPlaying.length;a<b;){var c=a++;n._soundsPlaying[c].setVolume(n.getSoundVolume()*
n.getMasterVolume())}};n.playRandomSoundByName=function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);return n.playSoundByName(a[S.randomInt(0,a.length)],b,c)};n.playSoundByName=function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);if(!n.isWebkitEnabled()&&p.isMobile()&&!b||!I.assetExists(a))return null;a=n.isWebkitEnabled()?new md(a,n.getSoundVolume()*n.getMasterVolume(),c):n.getUseFlashSound()?new jd(a,n.getMasterVolume()*n.getSoundVolume(),c):new kd(a,n.getSoundVolume()*n.getMasterVolume(),c);a.play();a.setMuted(n._soundMuted);
n._soundsPlaying.push(a);return a};n.update=function(){for(var a=0,b=n._soundsPlaying.length;a<b;){var c=a++,c=n._soundsPlaying[c];null==c?n.removeSoundFromPlayingSounds(c):c.update()}null!=n._musicTrack.get()&&n._musicTrack.get().update()};n.onSoundComplete=function(a){n.removeSoundFromPlayingSounds(a.currentTarget)};n.removeSoundFromPlayingSounds=function(a){F.remove(n._soundsPlaying,a)};n.addSoundToPlayingSounds=function(a){n._soundsPlaying.push(a)};n.isSoundPlaying=function(a){return-1!=n._soundsPlaying.indexOf(a)};
n.pauseAllSounds=function(){null!=n._musicTrack.get()&&n._musicTrack.get().pause();for(var a=0,b=n._soundsPlaying.length;a<b;){var c=a++,c=n._soundsPlaying[c];null!=c&&c.pause()}};n.resumeAllSounds=function(){for(var a=n._soundsPlaying.length,b=[].concat(n._soundsPlaying),c=0;c<a;){var d=c++;b[d].resume()}null!=n._musicTrack.get()&&(n._musicTrack.get().pause(),n._musicTrack.get().resume())};n.playMusicByNameOnMobileOnly=function(a){return p.isMobile()?n.playMusicByName(a,!0):null};n.playMusicByName=
function(a,b){null==b&&(b=!0);if(p.isMobile()&&!b)return null;if(!I.assetExists(a))return Da.log(a+" doesn't exist!"),null;if(null!=n._musicTrack.get()){if(n._musicTrack.get().getSoundName()==a)return n._musicTrack.get();n._musicTrack.get().stop()}var c;c=n.isWebkitEnabled()?new md(a,n.getMasterVolume()*n.getMusicVolume(),!0):n._useFlashSound?new jd(a,n.getMusicVolume()*n.getMasterVolume(),!0):new kd(a,n.getMasterVolume()*n.getMusicVolume(),!0);c.play(0);n._musicTrack.set(c);n.setMusicVolume(n._musicVolume);
n._musicTrack.get().setMuted(n._musicMuted);return n._musicTrack.get()};n.stopMusic=function(){null!=n._musicTrack.get()&&(n._musicTrack.get().stop(),n._musicTrack=new ld(null))};n.stopAllSounds=function(){for(var a=n._soundsPlaying.length-1;0<=a;){var b=n._soundsPlaying[a];null!=b&&b.stop();n.removeSoundFromPlayingSounds(b);--a}n._soundsPlaying=[]};n.getUseFlashSound=function(){return n._useFlashSound};n.prototype={__class__:n};var md=function(a,b,c){null==c&&(c=!1);null==b&&(b=1);this._audio=null;
ca.call(this,a,b,c)};md.__name__=["engine","audio","WebkitSoundData"];md.__super__=ca;md.prototype=r(ca.prototype,{init:function(){ca.prototype.init.call(this);this._audioContext=n.getAudioContextInstance();this._audio=this._audioContext.createBufferSource();this._audio.buffer=I.getAsset(this._soundName);this._gainNode=null!=(Ha=this._audioContext,w(Ha,Ha.createGain))?this._audioContext.createGain():this._audioContext.createGainNode();this._audio.connect(this._gainNode,0,0);this._gainNode.connect(this._audioContext.destination,
0,0);this._audio.loop=this._loop;this._audio.id=this._soundName;this.setVolume(this._volume)},play:function(a){null==a&&(a=0);ca.prototype.play.call(this,a);this._currentTime=a;try{null!=(Ha=this._audio,w(Ha,Ha.start))?this._audio.start(this._audioContext.currentTime,a):0==a?this._audio.noteOn():this._audio.noteGrainOn(this._audioContext.currentTime,a)}catch(b){this._audio.noteOn(this._audioContext.currentTime,a,this._audio.buffer.duration-a)}},pause:function(){ca.prototype.pause.call(this);if(!(null==
this._audio||null!=this._audio&&null!=this._audio.buffer&&this.getCurrentTime()>this.getSoundLength()&&!this.getLoop())){if(null!=(Ha=this._audio,w(Ha,Ha.stop)))try{this._audio.stop(this._audioContext.currentTime)}catch(a){}else try{this._audio.noteOff(this._audioContext.currentTime)}catch(b){}n.removeSoundFromPlayingSounds(this)}},resume:function(){ca.prototype.resume.call(this);null!=this._audio&&null!=this._audio.buffer&&this.getCurrentTime()>this.getSoundLength()&&!this.getLoop()||(this.stop(),
this.init(),this.play(this._currentTime),n.addSoundToPlayingSounds(this))},stop:function(){ca.prototype.stop.call(this);if(null!=this._audio){if(null!=(Ha=this._audio,w(Ha,Ha.stop)))try{this._audio.stop(this._audioContext.currentTime)}catch(a){}else try{this._audio.noteOff(this._audioContext.currentTime)}catch(b){}this._audio=null;n.removeSoundFromPlayingSounds(this)}},getSoundLength:function(){return this._audio.buffer.duration},update:function(){ca.prototype.update.call(this);this.getCurrentTime()>
this.getSoundLength()&&!this.getLoop()?n.removeSoundFromPlayingSounds(this):this.getCurrentTime()>this.getSoundLength()&&(this._currentTime-=this.getSoundLength())},onSoundComplete:function(){},setCurrentTime:function(a){ca.prototype.setCurrentTime.call(this,a);this.stop();this.init();this.play(a)},setVolume:function(a){ca.prototype.setVolume.call(this,a);if(null!=this._audio||null!=this._gainNode)this._gainNode.gain.value=this._isMuted?0:a},setMuted:function(a){ca.prototype.setMuted.call(this,a);
this._gainNode.gain.value=this._isMuted?0:this._volume},setLoop:function(a){ca.prototype.setLoop.call(this,a);null!=this._audio&&(this._audio.loop=a)},__class__:md});var we=function(){};we.__name__=["engine","box2d","Box2dContactListener"];we.__super__=ib;we.prototype=r(ib.prototype,{beginContact:function(a){ib.prototype.beginContact.call(this,a);var b=a.getFixtureA().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new Db("beginContact",{contact:a})));b=a.getFixtureB().getBody().getUserData();
null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new Db("beginContact",{contact:a})))},endContact:function(a){ib.prototype.endContact.call(this,a);var b=a.getFixtureA().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new Db("endContact",{contact:a})));b=a.getFixtureB().getBody().getUserData();null!=b&&(b=b.entity,null!=b&&b.dispatchEvent(new Db("endContact",{contact:a})))},preSolve:function(a,b){ib.prototype.preSolve.call(this,a,b)},postSolve:function(a,b){ib.prototype.postSolve.call(this,
a,b)},__class__:we});var L=function(a){this._type=a};L.__name__=["engine","events","Event"];L.prototype={getType:function(){return this._type},__class__:L};var Db=function(a,b){this._data=null;this._type=a;this._data=b};Db.__name__=["engine","box2d","Box2dEvent"];Db.__super__=L;Db.prototype=r(L.prototype,{getData:function(){return this._data},setData:function(a){this._data=a},__class__:Db});var nd=function(a,b){null==b&&(b="debug");this._debugLayerName="";this._physicsScale=0.03333333333333333;this._positionIterations=
2;this._velocityIterations=6;this._b2World=this._gravity=null;M.call(this);null==a&&(a=new s(0,0));this._gravity=new t(a.x,a.y);this._debugLayerName=b;this._b2World=new ea(this._gravity,!1)};nd.__name__=["engine","box2d","Box2dManager"];nd.__super__=da;nd.prototype=r(da.prototype,{get_velocityIterations:function(){return this._velocityIterations},set_velocityIterations:function(a){return this._velocityIterations=a},get_positionIterations:function(){return this._positionIterations},set_positionIterations:function(a){return this._positionIterations=
a},init:function(){da.prototype.init.call(this);this._debugDrawLayer=p.getInstance().getLayerByName(this._debugLayerName);this._debugDraw=new Ca;this._debugDraw.setSprite(this._debugDrawLayer.getCanvas().getContext("2d"));this._debugDraw.setDrawScale(30);this._debugDraw.setLineThickness(1);this._debugDraw.setAlpha(0.5);this._debugDraw.setFillAlpha(0.1);this._debugDraw.setFlags(Ca.e_shapeBit|Ca.e_jointBit|Ca.e_centerOfMassBit);this._b2World.setDebugDraw(this._debugDraw);this._b2World.setContactListener(new we)},
getB2World:function(){return this._b2World},getGravity:function(){return this._gravity},setGravity:function(a){this._gravity=a;this._b2World.setGravity(a);return a},getPhysicsScale:function(){return this._physicsScale},getInversePhysicsScale:function(){return 1/this._physicsScale},setPhysicsScale:function(a){this._physicsScale=a},update:function(){da.prototype.update.call(this);this.dispatchEvent(new ic("preUpdate"));for(var a=0,b=Math.max(1,Math.floor(p.getDeltaTime()/0.016666666666666666));a<b;)a++,
this._b2World.step(0.016666666666666666,this._velocityIterations,this._positionIterations),this._b2World.clearForces();this.dispatchEvent(new ic("update"))},getPixelToWorld:function(a,b){return new t(a*this._physicsScale,b*this._physicsScale)},getWorldToPixel:function(a,b){return new s(a/this._physicsScale,b/this._physicsScale)},debugRender:function(){da.prototype.debugRender.call(this);this._b2World.drawDebugData();this._debugDrawLayer.setWholeCanvasDirty(!0)},__class__:nd,__properties__:{set_positionIterations:"set_positionIterations",
get_positionIterations:"get_positionIterations",set_velocityIterations:"set_velocityIterations",get_velocityIterations:"get_velocityIterations"}});var ic=function(a){this._type=a};ic.__name__=["engine","box2d","Box2dManagerEvent"];ic.__super__=L;ic.prototype=r(L.prototype,{__class__:ic});var ra=function(a,b,c){this._loop=!0;this._length=0;this._name=a;this._animationKeyframes=[];null!=b&&(this._length=b);this._offset=new s};ra.__name__=["engine","components","Animation"];ra.parseFromXmlString=function(a,
b){for(var c=A.parse(b),d=c.elementsNamed("animation").next().get("name"),d=new ra(d,c.elementsNamed("animation").next().get("length")),c=c.elementsNamed("animation").next().elementsNamed("keyframe");c.hasNext();){var e=c.next(),e=new xe(e.get("index"),e.get("spriteIndex"),a);d.addKeyframe(e)}Pa.getInstance().registerAnimation(d);return d};ra.makeLinearAnimationFromSheetBySpriteName=function(a,b,c,d,e,f,g){null==g&&(g=0);null==f&&(f=-1);null==e&&(e=!1);var k=Sa.getInstance().getSpriteSheetByName(b),
h=k.getNumSprites();-1==f&&(f=h);for(var l=0,m=0,u=f;m<u;){var n=m++;Hb.startsWith(k.getSpriteInfoByIndex(n).getName(),c)&&++l}a=new ra(a,l*d);for(m=l=0;m<h&&!(u=m++,Hb.startsWith(k.getSpriteInfoByIndex(u).getName(),c)&&(u=new xe(g,u,b),a.addKeyframe(u),g+=d,++l,l>=f)););a.setLoop(e);Pa.getInstance().registerAnimation(a);return a};ra.createAnimation=function(a,b,c,d,e){null==e&&(e=!0);null==d&&(d=1);null==Pa.getInstance().getAnimationByName(a)&&(jc.parseFromXmlString(a,a,I.getAsset(b)),ra.makeLinearAnimationFromSheetBySpriteName(a,
a,"",d,e).setOffset(c.x,c.y))};ra.appendAnimation=function(a,b,c,d,e){null==e&&(e=1);if(null==Pa.getInstance().getAnimationByName(b))for(a=Pa.getInstance().getAnimationByName(a),jc.parseFromXmlString(b,b,I.getAsset(c)),b=ra.makeLinearAnimationFromSheetBySpriteName("tempAnim",b,"",e,!1,-1,a.getKeyframeLength()),b.setOffset(d.x,d.y),d=b.getAnimationKeyframes(),b=0,c=d.length;b<c;)e=b++,a.addKeyframe(d[e])};ra.prototype={getAnimationKeyframes:function(){return this._animationKeyframes},getKeyframeLength:function(){return this._length},
getLength:function(){return this._length/30},getName:function(){return this._name},getLoop:function(){return this._loop},setLoop:function(a){this._loop=a},getOffset:function(){return this._offset},setOffset:function(a,b){this._offset.x=a;this._offset.y=b},addKeyframe:function(a){this._animationKeyframes.push(a);var b=a.getPosition();this._length=Math.max(this._length,a.getPosition());b>this._length&&(this._length=b)},getSpriteIndexAtPosition:function(a){for(var b=this._animationKeyframes.length,c=
this._animationKeyframes[0].getSpriteIndex(),d=0;d<b;){var e=d++;if(a>=this._animationKeyframes[e].getPosition()/30)c=this._animationKeyframes[e].getSpriteIndex();else break}return c},getSpriteSheetNameAtPosition:function(a){for(var b=this._animationKeyframes.length,c=this._animationKeyframes[0].getSpriteSheetName(),d=0;d<b;){var e=d++;if(a>=this._animationKeyframes[e].getPosition()/30)c=this._animationKeyframes[e].getSpriteSheetName();else break}return c},__class__:ra};var Ja=function(a,b,c,d,e){this._inactiveOneFrame=
!1;this._killMessageOnMouseDown=!0;this._isMouseOver=!1;this._handPointer=!0;this._onClicked=this._onMouseDown=this._onMouseUp=this._onMouseMoved=this._onMouseOver=this._onMouseOut=null;m.call(this,a);this._boxCollision=new Hc;this._collisionSize=b;this._collisionOffset=c;this._camera=e;this.setOnMouseDown(d)};Ja.__name__=["engine","components","Button"];Ja.createFromHTMLElement=function(a){return new Ja(a.getEntity(),a.getSize(),new s(0,0))};Ja.createFromHTMLElementID=function(a,b,c){null==c&&(c=
0);b=x.getDocument().getElementById(b);var d=b.clientWidth+c,e=b.clientHeight+c;return new Ja(a,new s(d,e),new s(b.offsetLeft-a.getPosition().x-c/2+d/2,b.offsetTop-a.getPosition().y-c/2+e/2))};Ja.createFromEdgeHTMLElementID=function(a,b,c,d){null==d&&(d=0);var e=x.getDocument().getElementById(b);b=ga.parseInt(e.style.width)+d;var f=ga.parseInt(e.style.height)+d,g=bb.getStylePositionOfDomElement(e).y-d/2;d=bb.getStylePositionOfDomElement(e).x-d/2;return new Ja(a,new s(b,f),new s(d-a.getPosition().x+
b/2,g-a.getPosition().y+f/2),c)};Ja.createFromPixiSprite=function(a){return new Ja(a.getEntity(),new s(a.getSprite().texture.width,a.getSprite().texture.height),null)};Ja.__super__=m;Ja.prototype=r(m.prototype,{setOnClicked:function(a){this._onClicked=a},setOnMouseDown:function(a){this._onMouseDown=a},setOnMouseMoved:function(a){this._onMouseMoved=a},setOnMouseUp:function(a){this._onMouseUp=a},setOnMouseOut:function(a){this._onMouseOut=a},getKillMessageOnMouseDown:function(){return this._killMessageOnMouseDown},
setKillMessageOnMouseDown:function(a){this._killMessageOnMouseDown=a},getData:function(){return this._data},getCollisionSize:function(){return this._collisionSize},setData:function(a){this._data=a},init:function(){m.prototype.init.call(this);this._prevPosition=new s(this.getEntity().getPosition().x,this.getEntity().getPosition().y);this.updateCollision()},update:function(){m.prototype.update.call(this);this._inactiveOneFrame=!1;!1==this.getEntity().isVisible()&&(this._inactiveOneFrame=!0);if(this._isMouseOver&&
this.isButtonDisabledByButtonGroup(this.getEntity()))this.onMouseOut(ma.getInstance().getMousePosition());this.updateCollision()},setOffset:function(a,b){this._collisionOffset=new s(a,b)},getOffset:function(){return this._collisionOffset},updateCollision:function(){var a=this.getEntity().getPosition();this._boxCollision.ul.x=a.x-this._collisionSize.x/2;this._boxCollision.ul.y=a.y-this._collisionSize.y/2;this._boxCollision.wh.x=this._collisionSize.x;this._boxCollision.wh.y=this._collisionSize.y;null!=
this._collisionOffset&&(this._boxCollision.ul.x+=this._collisionOffset.x,this._boxCollision.ul.y+=this._collisionOffset.y)},onMouseClick:function(a){a=a.getClone();a.x>p.getInstance().getGameSize().x||(0>a.x||a.y>p.getInstance().getGameSize().y||0>a.y)||(null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale())),this._boxCollision.checkPointIntersect(a)&&
(this.getEntity().dispatchEvent(new V("mouseClick",{button:this,entity:this.getEntity()})),null!=this._onClicked&&this._onClicked(this)))},onMouseDown:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));return this._boxCollision.checkPointIntersect(a)?(this.getEntity().dispatchEvent(new V("mouseDown",
{button:this,entity:this.getEntity()})),null!=this._onMouseDown&&this._onMouseDown(this),p.isMobile()&&(this._isMouseOver=!0),!0):!1},onMouseMoved:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));if(this._boxCollision.checkPointIntersect(a)){this.getEntity().dispatchEvent(new V("mouseOver",
{button:this,entity:this.getEntity()}));if(!this._isMouseOver)this.onMouseOver(a);this._isMouseOver=!0;this.getEntity().dispatchEvent(new V("mouseMove",{button:this,entity:this.getEntity()}));null!=this._onMouseMoved&&this._onMouseMoved(this)}else this._isMouseOver&&!p.isMobile()&&(this.onMouseOut(a),this._isMouseOver=!1)},onMouseUp:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*
this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));this._boxCollision.checkPointIntersect(a)&&(this.getEntity().dispatchEvent(new V("mouseUp",{button:this,entity:this.getEntity()})),null!=this._onMouseUp&&this._onMouseUp(this))},onMouseOver:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),
1/this._camera.getZoomScale()));this._handPointer&&(x.getDocument().body.style.cursor="pointer");this.getEntity().dispatchEvent(new V("mouseOver",{button:this,entity:this.getEntity()}));null!=this._onMouseOver&&this._onMouseOver(this);this._isMouseOver=!0},onMouseOut:function(a){null!=a&&(a=a.getClone(),null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),
1/this._camera.getZoomScale())),this._handPointer&&(x.getDocument().body.style.cursor="default"),this.getEntity().dispatchEvent(new V("mouseOut",{button:this,entity:this.getEntity()})),null!=this._onMouseOut&&this._onMouseOut(this),this._isMouseOver=!1)},verifyTouches:function(a){var b=!1;if(null!=a&&null!=a.touches){for(var c=0,d=a.touches.length;c<d;){var e=c++,f=a.touches[e],g=p.getInstance().getScreenOffset(),e=(f.pageX-g.x)/p.getInstance().getScreenScale().x,f=(f.pageY-g.y)/p.getInstance().getScreenScale().y;
this._boxCollision.checkPointIntersect(new s(e,f))&&(b=!0)}if(!b&&this._isMouseOver)this.onMouseOut(null);else if(b&&!this._isMouseOver)this.onMouseOver(null)}},setCollisionProperties:function(a,b){this._collisionSize=a;this._collisionOffset=b},isButtonDisabledByButtonGroup:function(a){var b=a.getComponent(kc);if(null!=b&&!b.isInputEnabled())return!0;a=a.getParent();return null!=a?this.isButtonDisabledByButtonGroup(a):!1},handleMessage:function(a,b){m.prototype.handleMessage.call(this,a,b);if(!(b&&
b.isDisabled||!this.getEntity().isVisible()||!this.isActive()||this.isButtonDisabledByButtonGroup(this.getEntity())||this._inactiveOneFrame))switch(a){case "mouseClick":this.onMouseClick(b);break;case "mouseDown":this.onMouseDown(b)&&this._killMessageOnMouseDown&&(b.isDisabled=!0);break;case "mouseMove":this.onMouseMoved(b);break;case "mouseUp":this.onMouseUp(b);break;case "verifyTouches":this.verifyTouches(b)}},onActivate:function(){m.prototype.onActivate.call(this);this._inactiveOneFrame=!0},onDeactivate:function(){m.prototype.onDeactivate.call(this);
this._isMouseOver&&this._handPointer&&(x.getDocument().body.style.cursor="default")},debugRender:function(){m.prototype.debugRender.call(this);var a=p.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ha.getDebugCamera()){var b=ha.getDebugCamera().getEntity();a.translate(-b.getPosition().x,-b.getPosition().y)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(this._boxCollision.ul.x,this._boxCollision.ul.y);a.lineTo(this._boxCollision.ul.x+this._boxCollision.wh.x,
this._boxCollision.ul.y);a.lineTo(this._boxCollision.ul.x+this._boxCollision.wh.x,this._boxCollision.ul.y+this._boxCollision.wh.y);a.lineTo(this._boxCollision.ul.x,this._boxCollision.ul.y+this._boxCollision.wh.y);a.lineTo(this._boxCollision.ul.x,this._boxCollision.ul.y);a.stroke();a.restore()},destroy:function(){m.prototype.destroy.call(this);if(this._isMouseOver)this.onMouseOut(null)},__class__:Ja});var ha=function(a){this._offset=null;this._zoomScale=1;this._target=this._cameraBounds=this._slackMovement=
null;m.call(this,a);this._offset=new s;this._lensWidth=p.getInstance().getGameSize().x;this._lensHeight=p.getInstance().getGameSize().y;null==ha._debugCamera&&(ha._debugCamera=this)};ha.__name__=["engine","components","Camera"];ha.getDebugCamera=function(){return ha._debugCamera};ha.__super__=m;ha.prototype=r(m.prototype,{getTarget:function(){return this._target},setTarget:function(a){null!=this._target&&this._target.removeEventListener("destroy",w(this,this.onTargetDestroy));this._target=a;null!=
this._target&&this._target.addEventListener("destroy",w(this,this.onTargetDestroy))},setOffset:function(a){this._offset=a},getOffset:function(){return this._offset},getZoomScale:function(){return this._zoomScale},setZoomScale:function(a){this._zoomScale=a},getLensSize:function(){return new s(this._lensWidth,this._lensHeight)},setLensSize:function(a,b){this._lensWidth=a;this._lensHeight=b},init:function(){m.prototype.init.call(this);this._slackMovement=this.getComponent(lc)},getSlackMovement:function(){return this._slackMovement},
jumpToTarget:function(){null!=this._target&&this.getEntity().setLocalPosition(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z)},getCenter:function(){var a=this.getEntity().getPosition();return new K(a.x-this._lensWidth/this._zoomScale/2,a.y-this._lensHeight/this._zoomScale/2,a.z)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);
null!=this._target&&(null==this._slackMovement?this.getEntity().setLocalPosition(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z):this._slackMovement.setTarget(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/
this._zoomScale,this.getEntity().getPosition().z));this.updateCameraBounds()},updateCameraBounds:function(){if(null!=this._cameraBounds){var a=this.getEntity().getPosition().getClone(),b=this._lensWidth/2/this._zoomScale,c=this._lensHeight/2/this._zoomScale,d=new s(a.x+b,a.y+c),e=!1;d.x-b<this._cameraBounds.ul.x&&(d.x=this._cameraBounds.ul.x+b,e=!0);d.y-c<this._cameraBounds.ul.y&&(d.y=this._cameraBounds.ul.y+c,e=!0);d.x+b>this._cameraBounds.ul.x+this._cameraBounds.wh.x&&(d.x=this._cameraBounds.ul.x+
this._cameraBounds.wh.x-b,e=!0);d.y+c>this._cameraBounds.ul.y+this._cameraBounds.wh.y&&(d.y=this._cameraBounds.ul.y+this._cameraBounds.wh.y-c,e=!0);a.x=d.x-b;a.y=d.y-c;e&&this.getEntity().setLocalPosition(a.x,a.y,a.z)}},getPointConstrainedToCameraBounds:function(a,b){if(null!=this._cameraBounds){var c=new K(a,b),d=this._lensWidth/2/this._zoomScale,e=this._lensHeight/2/this._zoomScale,f=new s(a,b);f.x-d<this._cameraBounds.ul.x&&(f.x=this._cameraBounds.ul.x+d);f.y-e<this._cameraBounds.ul.y&&(f.y=this._cameraBounds.ul.y+
e);f.x+d>this._cameraBounds.ul.x+this._cameraBounds.wh.x&&(f.x=this._cameraBounds.ul.x+this._cameraBounds.wh.x-d);c.y+e>this._cameraBounds.ul.y+this._cameraBounds.wh.y&&(f.y=this._cameraBounds.ul.y+this._cameraBounds.wh.y-e);a=f.x;b=f.y}return new s(a,b)},getBounds:function(){return this._cameraBounds},setBounds:function(a,b,c,d){this._cameraBounds=new Cb(a,b,c-a,d-b)},getViewBounds:function(){var a=this.getEntity().getPosition();return new Cb(a.x,a.y,2*(this._lensWidth/2/this._zoomScale),2*(this._lensHeight/
2/this._zoomScale))},destroyBounds:function(){this._cameraBounds=null},destroy:function(){m.prototype.destroy.call(this);ha._debugCamera==this&&(ha._debugCamera=null)},onTargetDestroy:function(){this.setTarget(null)},__class__:ha});var Ua=function(a,b){this._offset=this._onEnter=this._onInside=this._onExit=null;m.call(this,a);this._offset=b};Ua.__name__=["engine","components","Collider"];Ua.__super__=m;Ua.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);cb.getInstance().registerCollider(this)},
getCollision:function(){return null},checkPointIntersect:function(a){return!1},update:function(){m.prototype.update.call(this)},getRaycastPoint:function(a,b,c,d,e){cb.getInstance().dispatchEvent(new od("raycastCheck",a,b));return-1},debugRender:function(){m.prototype.debugRender.call(this)},setOnEnter:function(a){this._onEnter=a},setOnExit:function(a){this._onExit=a},setOnInside:function(a){this._onInside=a},onEnter:function(a){this._isActive&&null!=this._onEnter&&this._onEnter(a,this)},onInside:function(a){this._isActive&&
null!=this._onInside&&this._onInside(a,this)},onExit:function(a){this._isActive&&null!=this._onExit&&this._onExit(a,this)},onDestroy:function(){m.prototype.onDestroy.call(this);cb.getInstance().removeCollider(this)},__class__:Ua});var ve=function(a,b,c,d){null==d&&(d=!1);this.isPaused=this.repeating=!1;this.timeUntilExecute=a;this.actionToExecute=b;this.params=c;this.repeating=d;this.duration=a};ve.__name__=["engine","components","DeferredAction"];ve.prototype={update:function(){this.isPaused||(this.timeUntilExecute-=
p.getDeltaTime())},__class__:ve};var Va=function(a){m.call(this,a);this._deferredActions=[]};Va.__name__=["engine","components","DeferredActionController"];Va.addDeferredActionToTarget=function(a,b,c,d){var e=a.getComponent(Va);null==e&&(e=new Va(a));e.addDeferredAction(b,c,d);return e};Va.__super__=m;Va.prototype=r(m.prototype,{update:function(){m.prototype.update.call(this);for(var a=this._deferredActions.length-1;0<=a;){var b=this._deferredActions[a];null==b?F.remove(this._deferredActions,b):(b.update(),
0>=b.timeUntilExecute&&(b.actionToExecute(b.params),b.repeating?b.timeUntilExecute=b.duration:F.remove(this._deferredActions,b)),--a,a>this._deferredActions.length-1&&(a=this._deferredActions.length-1))}},addDeferredAction:function(a,b,c){a=new ve(a,b,c);this._deferredActions.push(a);return a},removeDeferredAction:function(a){F.remove(this._deferredActions,a)},destroyAllDeferredActions:function(){this._deferredActions=[]},__class__:Va});var Uf=function(a,b,c){this._followX=this._followY=!0;this._offset=
this._target=null;m.call(this,a);this._target=b;this._offset=null!=c?c:new K;this.updatePosition()};Uf.__name__=["engine","components","FollowEntity"];Uf.__super__=m;Uf.prototype=r(m.prototype,{getOffset:function(){return this._offset},setOffset:function(a){this._offset=a},getTarget:function(){return this._target},setTarget:function(a){this._target=a},getFollowX:function(){return this._followX},setFollowX:function(a){this._followX=a},getFollowY:function(){return this._followY},setFollowY:function(a){this._followY=
a},update:function(){m.prototype.update.call(this);this.updatePosition()},updatePosition:function(){var a=this._target.getPosition();this._followX||(a.x=this.getEntity().getPosition().x);this._followY||(a.y=this.getEntity().getPosition().y);this.getEntity().setLocalPosition(a.x+this._offset.x,a.y+this._offset.y,a.z+this._offset.z)},__class__:Uf});var ye=function(a,b,c,d){this._context=this._image=this._cachedSize=this._clipRect=null;this._forceRenderRequired=!1;this._skew=this._rotation=this._spriteInfo=
this._coords=null;this._alpha=1;this._maskFunction=null;this._imageName="";this.IsLargeImage=!1;m.call(this,a);this._imageName=b;this._layer=c;this._cameraPositionScale=new s(1,1);this._pivotPoint=new s;this._camera=d;this._offset=new s;this._scale=new K(1,1,1);this._skew=new s;this._rotation=new K(0,0,0);this._clipRect=null};ye.__name__=["engine","components","GameImage"];ye.__super__=m;ye.prototype=r(m.prototype,{getClipRect:function(){return this._clipRect},setClipRect:function(a){1>a.wh.x&&(a.wh.x=
1);1>a.wh.y&&(a.wh.y=1);this._clipRect=a},getCamera:function(){return this._camera},setCamera:function(a){this._camera=a},getCoords:function(){return this._coords},setCoords:function(a){this._coords=a},getRotation:function(){return this._rotation},setRotation:function(a){this._rotation=a},setSpriteInfo:function(a){this._spriteInfo=a},setImage:function(a){I.assetExists(a)&&""!=a&&(this._imageName=a,this._image=this.getImageAsset(),this._cachedSize=null)},getImageAsset:function(){return I.getAsset(this._imageName)},
getSkew:function(){return this._skew},setSkew:function(a,b){this._skew=new s(a,b)},setSource:function(a){this._imageName=a},getOffset:function(){return this._offset},setOffset:function(a,b){this._offset=new s(a,b)},centerOffsetOnEntity:function(){if(""!=this._imageName){var a=this.getSize(),a=null!=this._spriteInfo?new s(this._spriteInfo.getCoords().wh.x,this._spriteInfo.getCoords().wh.y):new s(this._image.width,this._image.height);this.setOffset(-a.x/2,-a.y/2)}},setOffsetBasedOnPivotPoint:function(a,
b){var c=this.getSize(),c=null!=this._spriteInfo?new s(this._spriteInfo.getCoords().wh.x,this._spriteInfo.getCoords().wh.y):new s(this._image.width,this._image.height);this.setOffset(-(c.x*a),-(c.y*(1-b)))},getAlpha:function(){return this._alpha},setAlpha:function(a){this._alpha=a},getPivotPoint:function(){return this._pivotPoint},setPivotPoint:function(a,b){this._pivotPoint=new s(a,b)},getLayer:function(){return this._layer},setLayer:function(a){this._layer=a;this._context=null},getImageName:function(){return this._imageName},
getSize:function(){if(null!=this._cachedSize)return this._cachedSize;null==this._image&&(this._image=this.getImageAsset());var a=this.getEntity().getScale();return null!=this._spriteInfo?this._cachedSize=new s(this._spriteInfo.getCoords().wh.x*Math.abs(a.x*this._scale.x),this._spriteInfo.getCoords().wh.y*Math.abs(a.y*this._scale.y)):""==this._imageName?new s(0,0):this._cachedSize=new s(this._image.width*Math.abs(a.x*this._scale.x),this._image.height*Math.abs(a.y*this._scale.y))},getMaskFunction:function(){return this._maskFunction},
setMaskFunction:function(a){this._maskFunction=a},setScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._scale=new K(a,b,c)},getScale:function(){return this._scale},getCameraPositionScale:function(){return this._cameraPositionScale},setCameraPositionScale:function(a){this._cameraPositionScale=a},render:function(){m.prototype.render.call(this);if(0!=this._alpha&&(""!=this._imageName||null!=this._spriteInfo)){var a=this.getEntity(),b=a.getPosition(),c=1,d=new s(0,0),e=new s(1,1);
null!=this._camera&&(d=this._camera.getEntity(),c=this._camera.getZoomScale(),d=d.getPosition(),d=new s(-(d.x/this._cameraPositionScale.x)*e.x,-(d.y/this._cameraPositionScale.y)*e.y),d.scaleBy(c,c));null==this._context&&(this._context=this._layer.getCanvas().getContext("2d"));this._context.save();null!=this._maskFunction&&(this._context.translate(d.x/e.x*c,d.y/e.y*c),this._maskFunction(this._context,this),this._context.clip(),this._context.translate(-d.x*e.x*c,-d.y*e.y*c));var f=a.getScale().getClone();
f.x*=this._scale.x;f.y*=this._scale.y;this._context.setTransform(1,this._skew.x/f.x,this._skew.y/f.y,1,Math.floor(b.x*e.x*c+d.x)*p.getDevicePixelRatio(),Math.floor(b.y*e.y*c+d.y)*p.getDevicePixelRatio());0!=a.getRotation().z+this._rotation.z&&this._context.rotate(S.degToRad(a.getRotation().z+this._rotation.z));this._context.scale(f.x*c,f.y*c);a=this._offset.getClone();null!=this._spriteInfo&&(a.x+=this._spriteInfo.getOffset().x,a.y+=this._spriteInfo.getOffset().y);this._context.translate(Math.floor(a.x*
e.x)*p.getDevicePixelRatio(),Math.floor(a.y*e.y)*p.getDevicePixelRatio());this._context.globalAlpha=this._alpha;this._context.scale(e.x*p.getDevicePixelRatio(),e.y*p.getDevicePixelRatio());null==this._spriteInfo&&null==this._coords?(null==this._image&&(this._image=this.getImageAsset()),null==this._clipRect?this._context.drawImage(this._image,0,0):(this._clipRect.ul.x=Math.max(0,this._clipRect.ul.x),this._clipRect.ul.y=Math.max(0,this._clipRect.ul.y),this._context.drawImage(this._image,this._clipRect.ul.x,
this._clipRect.ul.y,this._clipRect.wh.x,this._clipRect.wh.y,0,0,this._clipRect.wh.x*e.x*p.getDevicePixelRatio(),this._clipRect.wh.y*e.y*p.getDevicePixelRatio()))):null==this._spriteInfo&&null!=this._coords?(null==this._image&&(this._image=I.getAsset(this._imageName)),this._context.drawImage(this._image,this._coords.ul.x,this._coords.ul.y,this._coords.wh.x,this._coords.wh.y,0,0,this._coords.wh.x,this._coords.wh.y)):(e=this._spriteInfo.getCoords(),a=Sa.getInstance().getSpriteSheetByName(this._spriteInfo.getSpriteSheetName()),
null==this._image&&(this._image=I.getAsset(a.getImageName())),this._context.drawImage(a.getImage(),e.ul.x,e.ul.y,e.wh.x,e.wh.y,0,0,e.wh.x,e.wh.y));this._layer.setWholeCanvasDirty(!0);this._context.restore()}},quickRender:function(){m.prototype.render.call(this);new s(1,1);this._context=this._layer.getCanvas().getContext("2d");null!=this._maskFunction&&(this._maskFunction(this._context,this),this._context.clip());this._context.scale(this._scale.x,this._scale.y);this._context.rotate(this._rotation.z);
if(null==this._spriteInfo&&null==this._coords)null==this._image&&(this._image=I.getAsset(this._imageName));else if(null==this._spriteInfo&&null!=this._coords)null==this._image&&(this._image=I.getAsset(this._imageName)),this._context.drawImage(this._image,Math.floor(this._coords.ul.x),Math.floor(this._coords.ul.y),Math.floor(this._coords.wh.x),Math.floor(this._coords.wh.y),this._offset.x,this._offset.y,Math.floor(this._coords.wh.x)+2,Math.floor(this._coords.wh.y)+2);else{var a=this._spriteInfo.getCoords(),
b=Sa.getInstance().getSpriteSheetByName(this._spriteInfo.getSpriteSheetName());null==this._image&&(this._image=I.getAsset(b.getImageName()));this._context.drawImage(this._image,a.ul.x,a.ul.y,a.wh.x,a.wh.y,this._offset.x,this._offset.y,a.wh.x,a.wh.y)}this._context.rotate(-this._rotation.z);this._context.scale(1/this._scale.x,this._scale.y);this._layer.setWholeCanvasDirty(!0)},destroy:function(){m.prototype.destroy.call(this)},onDestroy:function(){m.prototype.onDestroy.call(this);this._camera=null},
__class__:ye});var Vf=function(a,b,c,d,e){null==d&&(d=!0);this._entities=this._buffer=this._camera=this._cameraPositionScale=this._context=this._layer=this._gameImages=null;this._removeGameImageComponents=!0;m.call(this,a);this._removeGameImageComponents=d;this._entities=b;this._camera=e;this._cameraPositionScale=new s(1,1);this._context=null;this._layer=c;this._gameImages=[]};Vf.__name__=["engine","components","GameImageBatch"];Vf.__super__=m;Vf.prototype=r(m.prototype,{getCameraPositionScale:function(){return this._cameraPositionScale},
setCameraPositionScale:function(a){this._cameraPositionScale=a},getLayer:function(){return this._layer},setLayer:function(a){this._layer=a},init:function(){m.prototype.init.call(this);for(var a=[],b=0,c=this._entities.length;b<c;){var d=b++,d=this._entities[d],e=d.getComponent(ye),f=d.getPosition().getClone(),g=d.getScale().getClone(),k=d.getRotation().getClone();e.setOffset(e.getOffset().x+f.x*g.x,e.getOffset().y+f.y*g.y);e.setScale(g.x,g.y,1);e.setRotation(k);e.setEntity(this.getEntity());e.setLayer(this._layer);
d.destroy();a.push(e)}this._gameImages=a},render:function(){m.prototype.render.call(this);var a=this._gameImages.length;if(0!=a)if(null==this._camera){var b=new s(1,1),c=this._layer.getCanvas().getContext("2d");c.save();c.setTransform(b.x*p.getDevicePixelRatio(),0,0,b.y*p.getDevicePixelRatio(),0,0);for(b=0;b<a;){var d=b++;this._gameImages[d].quickRender()}c.restore()}else{var d=1,e=new s(0,0),f=new s(1,1),c=new K(0,0);null!=this._camera&&(c=this._camera.getEntity(),d=this._camera.getZoomScale(),c=
c.getPosition(),e=new s(-(c.x/this._cameraPositionScale.x)*f.x*p.getDevicePixelRatio(),-(c.y/this._cameraPositionScale.y)*f.y*p.getDevicePixelRatio()),e.scaleBy(d,d));b=this._layer.getCanvas().getContext("2d");b.save();b.setTransform(d*f.x*p.getDevicePixelRatio(),0,0,d*f.y*p.getDevicePixelRatio(),Math.floor(e.x),Math.floor(e.y));this._camera.getViewBounds();this.getCameraPositionScale();this._gameImages[0].getSize();for(d=0;d<a;){var f=d++,f=this._gameImages[f],e=f.getOffset().getClone(),g=f.getScale(),
k=f.getSize().x,h=f.getSize().y;e.scaleBy(g.x,g.y);e.x-k>c.x+800||(e.x+k<c.x-800||e.y-h>c.y+600||e.y+h<c.y-600)||f.quickRender()}b.restore()}},__class__:Vf});var bb=function(a,b,c,d){null==d&&(d="");null==c&&(c="");this._alwaysUpdatePosition=!1;this._className="";this._div=null;this._isDirty=!0;m.call(this,a);this._html=c;this._className=d;this._layer=b;this.updateHtml()};bb.__name__=["engine","components","HtmlElements"];bb.showElementById=function(a,b){null==b&&(b=!0);var c=bb.getChildDivById(x.getContainer(),
a);null!=c?c.style.display=b?"block":"none":Da.log("Could not find element with id of "+a+" to "+(b?"show":"hide"))};bb.getStylePositionOfDomElement=function(a){for(var b=ga.parseInt(a.style.top),c=ga.parseInt(a.style.left);;)if(null!=a.parentNode&&Object.prototype.hasOwnProperty.call(a.parentNode,"style")&&"layer"!=a.parentElement.className)b+=ga.parseInt(a.parentElement.style.top),c+=ga.parseInt(a.parentElement.style.left),a=a.parentElement;else break;return new s(c,b)};bb.setElementTextById=function(a,
b){var c=x.getDocument().getElementById(a);null==c?Da.log("Could not find '"+a+"' on the page!"):c.innerHTML=b};bb.getChildDivById=function(a,b){for(var c=0,d=a.children.length;c<d;){var e=c++,e=a.children[e];if(e.id==b||e.hasChildNodes()&&(e=bb.getChildDivById(e,b),null!=e))return e}return null};bb.__super__=m;bb.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this.getEntity().addEventListener("displayUpdate",w(this,this.onDisplayUpdated))},getChildElementById:function(a){return x.getDocument().getElementById(a)},
setChildElementTextById:function(a,b){var c=bb.getChildDivById(this.getDiv(),a);null!=c&&(c.innerHTML=b);this._html=this.getDiv().innerHTML},getDiv:function(){null==this._div&&this._isDirty&&this.updateHtml();return this._div},update:function(){m.prototype.update.call(this);null!=this._div&&this._isDirty&&this.updateHtml();null!=this._div&&this._alwaysUpdatePosition&&this.updatePosition();var a=this.getEntity().isVisible()?"block":"none";this._div.style.display=a},updateHtml:function(){Da.log("updateHtml");
null!=this._div&&null!=this._div.parentNode&&this._div.parentNode.removeChild(this._div);this._isDirty=!1;this._div=x.getDocument().createElement("div");this._div.className=this._className;this._div.innerHTML=this._html;this._div.style.position="absolute";var a="translate(0, 0px) scale("+this.getEntity().getScale().x*p.getInstance().getScreenScale().x+","+this.getEntity().getScale().y*p.getInstance().getScreenScale().y;this._div.style.webkitTransform=a+")";a="translate(0, 0px) scale("+this.getEntity().getScale().x*
p.getInstance().getScreenScale().x+","+this.getEntity().getScale().y*p.getInstance().getScreenScale().y;this._div.style.transform=a+")";this._layer.getContainer().appendChild(this._div);this.updatePosition()},updatePosition:function(){var a=this.getEntity().getPosition().x*p.getInstance().getScreenScale().x;this._div.style.left=a-(this._center?this._div.clientWidth/2:0)+"px";a=this.getEntity().getPosition().y*p.getInstance().getScreenScale().y;this._div.style.top=a-(this._center?this._div.clientHeight/
2:0)+"px"},setId:function(a){null==this._div&&this._isDirty&&this.updateHtml();this._id=a;this._div.id=a},getId:function(){return this._id},getHtml:function(){return this._html},setHtml:function(a){this._html=a},setClassName:function(a){this._className=a},getClassName:function(){return this._className},addClassName:function(a){this._className=0<this._className.length?this._className+(" "+a):a},removeClassName:function(a){this._className=Hb.replace(this._className,a,"")},forceUpdateNextFrame:function(){this._html=
this._div.innerHTML},centerOnEntity:function(a){null==a&&(a=!0);this._center=a;this.updatePosition()},getSize:function(){return new s(this._div.clientWidth*p.getInstance().getScreenScale().y,this._div.clientHeight*p.getInstance().getScreenScale().y)},destroy:function(){m.prototype.destroy.call(this);null!=this._div.parentNode&&this._layer.getContainer().removeChild(this._div)},handleMessage:function(a,b){m.prototype.handleMessage.call(this,a,b)},onDisplayUpdated:function(){},alwaysUpdatePosition:function(a){null==
a&&(a=!0);this._alwaysUpdatePosition=a},__class__:bb});var db=function(a,b,c,d,e,f,g,k,h){null==h&&(h=0);null==k&&(k=0);null==g&&(g=!1);this._magnitudeDecayRate=0;this._half=!1;this._propertyName="";this._target=null;this._theta=this._rate=this._base=this._magnitude=0;m.call(this,a);this._base=d;this._magnitude=e;this._rate=f;this._propertyName=c;this._target=b;this._half=g;this._theta=k;this._magnitudeDecayRate=h};db.__name__=["engine","components","PropertyOscillator"];db.__super__=m;db.prototype=
r(m.prototype,{getTheta:function(){return this._theta},setTheta:function(a){this._theta=a},getMagnitude:function(){return this._magnitude},setMagnitude:function(a){this._magnitude=a},getRate:function(){return this._rate},setRate:function(a){this._rate=a},getMagnitudeDecayRate:function(){return this._magnitudeDecayRate},setMagnitudeDecayRate:function(a){this._magnitudeDecayRate=a},getBase:function(){return this._base},setBase:function(a){this._base=a},update:function(){m.prototype.update.call(this);
if(0<this._magnitude){this._magnitude-=this._magnitudeDecayRate*p.getDeltaTime();0>this._magnitude&&(this._magnitude=0);this._theta+=this._rate*p.getDeltaTime();this._theta>=(this._half?Math.PI:2*Math.PI)&&(this._theta-=this._half?Math.PI:2*Math.PI);var a=this._base+Math.sin(this._theta)*this._magnitude;xa.setProperty(this._target,this._propertyName,a)}},__class__:db});var lc=function(a,b){null==b&&(b=0.5);this._slack=1;this._targetPosition=null;m.call(this,a);this._slack=b};lc.__name__=["engine",
"components","SlackMovement"];lc.__super__=m;lc.prototype=r(m.prototype,{getSlack:function(){return this._slack},setSlack:function(a){this._slack=a},update:function(){m.prototype.update.call(this);if(null!=this._targetPosition){var a=this._targetPosition.subtract(this.getEntity().getPosition()),b=a.getLength();0!=b&&(a=a.getNormalized(),a.scaleBy(b*this._slack),5E-5>a.x&&-5E-5<a.x&&(a.x=0),5E-5>a.y&&-5E-5<a.y&&(a.y=0),5E-5>a.z&&-5E-5<a.z&&(a.z=0),b=this.getEntity().getPosition(),this.getEntity().setLocalPosition(b.x+
a.x,b.y+a.y,b.z+a.z))}},getTarget:function(){return this._targetPosition},setTarget:function(a,b,c){this._targetPosition=new K(a,b,c)},__class__:lc});var U={__ename__:!0,__constructs__:["Local","World"],Local:["Local",0]};U.Local.__enum__=U;U.World=["World",1];U.World.__enum__=U;U.__empty_constructs__=[U.Local,U.World];var Gc=function(a){m.call(this,a);this._localPosition=new K;this._localRotation=new K;this._localScale=new K(1,1,1)};Gc.__name__=["engine","components","Transform"];Gc.getIdentity=
function(){return window.glMatrix.mat4.identity(window.glMatrix.mat4.create())};Gc.__super__=m;Gc.prototype=r(m.prototype,{getParent:function(){return null!=this.getEntity().getParent()?this.getEntity().getParent().getTransform():null},getPositionRef:function(){return this._localPosition},getRotationRef:function(){return this._localRotation},getScaleRef:function(){return this._localScale},getPosition:function(a){if(a==U.Local)return this._localPosition.getClone();a=window.glMatrix.mat4.identity(window.glMatrix.mat4.create());
for(var b=this;null!=b;){var c=window.glMatrix.mat4.create(),d=b.getRotation(U.Local),e=b.getPosition(U.Local),f=b.getScale(U.Local),c=window.glMatrix.mat4.fromRotationTranslationScale(c,window.glMatrix.quat.fromEuler(window.glMatrix.quat.create(),d.x,d.y,d.z),window.glMatrix.vec3.fromValues(e.x,e.y,e.z),window.glMatrix.vec3.fromValues(f.x,f.y,f.z));window.glMatrix.mat4.multiply(a,c,a);b=b.getParent()}b=window.glMatrix.vec3.create();window.glMatrix.vec3.transformMat4(b,b,a);return new K(b[0],b[1],
b[2])},setPosition:function(a,b){switch(b[1]){case 0:this._localPosition.x=a.x;this._localPosition.y=a.y;this._localPosition.z=a.z;break;case 1:if(this._localPosition.x=a.x,this._localPosition.y=a.y,this._localPosition.z=a.z,null!=this.getParent()){for(var c=Gc.getIdentity(),d=this.getParent();null!=d;){var e=d.getRotation(U.Local),f=d.getPosition(U.Local),g=d.getScale(U.Local),e=window.glMatrix.quat.fromEuler(window.glMatrix.quat.create(),e.x,e.y,e.z),f=window.glMatrix.vec3.fromValues(f.x,f.y,f.z),
g=window.glMatrix.vec3.fromValues(g.x,g.y,g.z),k=window.glMatrix.mat4.create(),k=window.glMatrix.mat4.fromRotationTranslationScale(k,e,f,g);window.glMatrix.mat4.multiply(c,k,c);d=d.getParent()}c=window.glMatrix.mat4.invert(window.glMatrix.mat4.create(),c);d=window.glMatrix.vec3.fromValues(this._localPosition.x,this._localPosition.y,this._localPosition.z);d=window.glMatrix.vec3.transformMat4(d,d,c);this._localPosition.x=d[0];this._localPosition.y=d[1];this._localPosition.z=d[2]}else this.setPosition(this._localPosition,
U.Local)}this.dispatchEvent(new Eb("update"))},translate:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._localPosition.x+=a;this._localPosition.y+=b;this._localPosition.z+=c},getScale:function(a){if(a==U.Local)return this._localScale.getClone();a=new K(1,1,1);for(var b=this;null!=b;)a.x*=b.getScale(U.Local).x,a.y*=b.getScale(U.Local).y,a.z*=b.getScale(U.Local).z,b=b.getParent();return a},setScale:function(a,b,c,d){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);switch(d[1]){case 0:this._localScale.x=
a;this._localScale.y=b;this._localScale.z=c;break;case 1:for(this._localScale.x=a,this._localScale.y=b,this._localScale.z=c,a=this.getEntity().getParent();null!=a;)this._localScale.x/=a.getTransform().getScale(U.Local).x,this._localScale.y/=a.getTransform().getScale(U.Local).y,this._localScale.z/=a.getTransform().getScale(U.Local).z,a=a.getParent()}this.dispatchEvent(new Eb("update"))},scale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._localScale.x*=a;this._localScale.y*=b;this._localScale.z*=
c;this.dispatchEvent(new Eb("update"))},getRotation:function(a){if(a==U.Local)return this._localRotation.getClone();a=new K;for(var b=this;null!=b;)a.x+=b.getRotation(U.Local).x,a.y+=b.getRotation(U.Local).y,a.z+=b.getRotation(U.Local).z,b=b.getParent();return a},setRotation:function(a,b,c,d){switch(d[1]){case 0:this._localRotation.x=a;this._localRotation.y=b;this._localRotation.z=c;break;case 1:null!=this.getParent()&&(this._localRotation.x=a,this._localRotation.y=b,this._localRotation.z=c,this._localRotation.x-=
this.getParent().getRotation(d).x,this._localRotation.y-=this.getParent().getRotation(d).y,this._localRotation.z-=this.getParent().getRotation(d).z)}this.dispatchEvent(new Eb("update"))},rotate:function(a,b,c){this._localRotation.x+=a;this._localRotation.y+=b;this._localRotation.z+=c;this.dispatchEvent(new Eb("update"))},__class__:Gc});var Eb=function(a){this._type=a};Eb.__name__=["engine","components","TransformEvent"];Eb.__super__=L;Eb.prototype=r(L.prototype,{__class__:Eb});var ta=function(a){this._tweens=
null;m.call(this,a);this._tweens=[]};ta.__name__=["engine","components","Tweener"];ta.addTweenToTarget=function(a,b,c,d,e,f,g,k,h,l){null==k&&(k=0);var m=a.getComponent(ta);null==m&&(m=new ta(a));m.addTween(b,c,d,e,f,g,k,h,l);return m};ta.__super__=m;ta.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this)},addTween:function(a,b,c,d,e,f,g,k,h){null==g&&(g=0);a=new Wf(a,b,c,d,e,f,g,k,h);this._tweens.push(a);return a},skipAll:function(){for(var a=0,b=this._tweens.length;a<b;){var c=a++;
this._tweens[c].skip()}},destroyTween:function(a){F.remove(this._tweens,a)},destroyAllTweens:function(){this._tweens=[]},update:function(){m.prototype.update.call(this);for(var a=this._tweens.length-1;0<=a;){var b=this._tweens[a];b.update(p.getDeltaTime());this.getEntity().setTransformsDirty();b._isCompleted&&this._tweens.splice(a,1);--a}},__class__:ta});var mc=function(a,b){this._velocity=this._angularVelocity=this._gravity=null;m.call(this,a);this._velocity=new K;this._angularVelocity=new K;null!=
b&&(this._gravity=b.getClone())};mc.__name__=["engine","components","VelocityController"];mc.__super__=m;mc.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);null!=this._gravity&&(this._velocity.x+=this._gravity.x*p.getDeltaTime(),this._velocity.y+=this._gravity.y*p.getDeltaTime(),this._velocity.z+=this._gravity.z*p.getDeltaTime());var a=this._velocity.getClone();a.scaleBy(p.getDeltaTime());var b=this._angularVelocity.getClone();
b.scaleBy(p.getDeltaTime());var c=this.getEntity().getLocalPosition();this.getEntity().getLocalRotation();this.getEntity().setLocalPosition(c.x+a.x,c.y+a.y,c.z+a.z);this.getEntity().rotate(b.x,b.y,b.z)},getXyAngleFromVector:function(a){return S.getAngleInDegreesBetween2dVectors(a,new s(this._velocity.x,this._velocity.y))},getGravity:function(){return this._gravity.getClone()},setGravity:function(a){this._gravity=new K(a.x,a.y,a.z)},getVelocity:function(){return this._velocity},addVelocity:function(a,
b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._velocity=this._velocity.add(new K(a,b,c))},setVelocity:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._velocity=new K(a,b,c)},setVelocityX:function(a){this._velocity.x=a},setVelocityY:function(a){this._velocity.y=a},setVelocityZ:function(a){this._velocity.z=a},getVelocityX:function(){return this._velocity.x},getVelocityY:function(){return this._velocity.y},getVelocityZ:function(){return this._velocity.z},getAngularVelocity:function(){return this._angularVelocity},
setAngularVelocity:function(a){this._angularVelocity=a},__class__:mc});var Qa=function(a){m.call(this,a);null!=Qa._instance&&(window.console.warn("An AudioListener instance already exists. There should only be one!"),Qa._instance.destroy());Qa._instance=this;this._audioSources=[]};Qa.__name__=["engine","components","audio","AudioListener"];Qa.getInstance=function(){return Qa._instance};Qa.__super__=m;Qa.prototype=r(m.prototype,{registerAudioSource:function(a){-1==this._audioSources.indexOf(a)&&(this._audioSources.push(a),
a.addEventListener("destroy",w(this,this.onAudioSourceDestroyed)))},removeAudioSource:function(a){F.remove(this._audioSources,a)},onAudioSourceDestroyed:function(a){a.target.removeEventListener("destroy",w(this,this.onAudioSourceDestroyed));this.removeAudioSource(a.target)},update:function(){m.prototype.update.call(this);if(!this.getGameState().getPaused())for(var a=this.getEntity().getPosition(),b=0,c=this._audioSources.length;b<c;){var d=b++,d=this._audioSources[d],e=Math.abs(a.subtract(d.getEntity().getPosition()).getLength()),
f=d.getRolloff();0<f?e<=f?(e=E.linear(1-e/f,0,1,1),d.setVolumePercent(e)):d.setVolumePercent(0):d.setVolumePercent(1)}},onPause:function(){m.prototype.onPause.call(this);for(var a=0,b=this._audioSources.length;a<b;){var c=a++;this._audioSources[c].setVolumePercent(0)}},destroy:function(){m.prototype.destroy.call(this);Qa._instance=null},__class__:Qa});var ze=function(a,b,c){null==c&&(c=1);null==b&&(b=0);m.call(this,a);this._maxVolume=c;this._rolloff=b;this._volume=0};ze.__name__=["engine","components",
"audio","AudioSource"];ze.__super__=m;ze.prototype=r(m.prototype,{get_maxVolume:function(){return this._maxVolume},set_maxVolume:function(a){return this._maxVolume=a},setRolloff:function(a){this._rolloff=a},getRolloff:function(){return this._rolloff},setVolumePercent:function(a){this.setVolume(this._maxVolume*a)},setVolume:function(a){a!=this._volume&&(this._volume=a,null!=this._soundData&&this._soundData.setVolume(this._volume))},play:function(a,b){null==b&&(b=!1);null!=Qa.getInstance()&&(Qa.getInstance().registerAudioSource(this),
n.isSoundMuted()||(this._soundData=n.playSoundByName(a,!1,b),null!=this._soundData&&this._soundData.setVolume(this._volume)))},pause:function(){null!=this._soundData&&this._soundData.pause()},resume:function(){null!=this._soundData&&this._soundData.resume()},stop:function(){null!=this._soundData&&(this._soundData.stop(),this._soundData=null)},setLoop:function(a){null!=this._soundData&&this._soundData.setLoop(a)},setActive:function(a){m.prototype.setActive.call(this,a);null!=Qa.getInstance()&&(a?Qa.getInstance().registerAudioSource(this):
(Qa.getInstance().removeAudioSource(this),this.setVolumePercent(0)))},destroy:function(){m.prototype.destroy.call(this);this.stop()},__class__:ze,__properties__:{set_maxVolume:"set_maxVolume",get_maxVolume:"get_maxVolume"}});var Ka=function(a,b,c,d){this._lockDelayButtonNextFrame=!1;this._inputEnabled=!0;this._action=this._instantAction=this._deferredAction=null;this._delayTime=0;m.call(this,a);this._delayTime=c;this._action=b;this._instantAction=d};Ka.__name__=["engine","components","buttons","ButtonActionDelay"];
Ka.getDelayButtonLock=function(){return Ka._delayButtonLock};Ka.__super__=m;Ka.prototype=r(m.prototype,{setOnAction:function(a){this._action=a},init:function(){m.prototype.init.call(this);this._deferredAction=new Va(this.getEntity());this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown))},onMouseDown:function(){this._inputEnabled&&!Ka._delayButtonLock&&(this._inputEnabled=!1,this._lockDelayButtonNextFrame=!0,null!=this._instantAction&&this._instantAction(),this._deferredAction.addDeferredAction(this._delayTime,
w(this,this.onMouseDownDelayElapse)))},postUpdate:function(){m.prototype.update.call(this);this._lockDelayButtonNextFrame&&(Ka._delayButtonLock=!0);this._lockDelayButtonNextFrame=!1},onMouseDownDelayElapse:function(){this._lockDelayButtonNextFrame=Ka._delayButtonLock=!1;null!=this._action&&this._action();this._inputEnabled=!0},destroy:function(){m.prototype.destroy.call(this);0<=this._delayTime&&(Ka._delayButtonLock=!1)},__class__:Ka});var kc=function(a){this._inputEnabled=!0;m.call(this,a)};kc.__name__=
["engine","components","buttons","ButtonGroup"];kc.__super__=m;kc.prototype=r(m.prototype,{isInputEnabled:function(){return this._inputEnabled},setInputEnabled:function(a){this._inputEnabled=a},__class__:kc});var Ic=function(a,b,c,d,e){null==e&&(e=!0);this._allowOnce=!0;this._buttonMouseOverScale=this._tweener=null;this._isPulseActive=!1;m.call(this,a);this._pulseFromScale=b;this._pulseToScale=c;this._pulseDuration=d;this._allowOnce=e;this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown))};
Ic.__name__=["engine","components","buttons","ButtonMouseDownPulse"];Ic.__super__=m;Ic.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._buttonMouseOverScale=this.getComponent(nc);this._tweener=new ta(this.getEntity())},disableButton:function(){this.getEntity().removeEventListener("mouseDown",w(this,this.onMouseDown))},enableButton:function(){this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown))},onMouseDown:function(){if(!this._isPulseActive&&!Ka.getDelayButtonLock()){var a=
this.getEntity().getComponent(X);this._isPulseActive=!0;null!=this._buttonMouseOverScale&&this._buttonMouseOverScale.setActive(!1);null!=a?(this._tweener.addTween(a.getScaleRef(),"x",this._pulseFromScale,this._pulseToScale,this._pulseDuration,E.easeOutBack,0,w(this,this.onPulseComplete)),this._tweener.addTween(a.getScaleRef(),"y",this._pulseFromScale,this._pulseToScale,this._pulseDuration,E.easeOutBack,0)):(this._tweener.addTween(this.getEntity().getScaleRef(),"x",this._pulseFromScale,this._pulseToScale,
this._pulseDuration,E.easeOutBack,0,w(this,this.onPulseComplete)),this._tweener.addTween(this.getEntity().getScaleRef(),"y",this._pulseFromScale,this._pulseToScale,this._pulseDuration,E.easeOutBack,0))}},onPulseComplete:function(){this._allowOnce||(this._isPulseActive=!1,null!=this._buttonMouseOverScale&&this._buttonMouseOverScale.setActive(!0))},__class__:Ic});var oc=function(a,b,c){this._pixiSprite=null;m.call(this,a);this._defaultImageName=b;this._mouseOverImageName=c;this.getEntity().addEventListener("mouseOver",
w(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",w(this,this.onMouseOut))};oc.__name__=["engine","components","buttons","ButtonMouseOverImage"];oc.__super__=m;oc.prototype=r(m.prototype,{setDefaultImage:function(a){this._defaultImageName=a;this.updateImage(this._defaultImageName)},setMouseOverImage:function(a){this._mouseOverImageName=a;this.updateImage(this._mouseOverImageName)},init:function(){m.prototype.init.call(this);this._pixiSprite=this.getComponent(B);null!=this._pixiSprite&&
(this._pixiSprite.setImage(this._defaultImageName),this._pixiSprite.getSprite().anchor.x=0.5,this._pixiSprite.getSprite().anchor.y=0.5)},disableButton:function(){this.getEntity().removeEventListener("mouseOver",w(this,this.onMouseOver));this.getEntity().removeEventListener("mouseOut",w(this,this.onMouseOut))},enableButton:function(){this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",w(this,this.onMouseOut))},onMouseOver:function(a){this.updateImage(this._mouseOverImageName)},
onMouseOut:function(a){this.updateImage(this._defaultImageName)},updateImage:function(a){null==this._pixiSprite&&(this._pixiSprite=this.getComponent(B));null!=this._pixiSprite&&this._pixiSprite.setImage(a)},__class__:oc});var nc=function(a,b,c,d,e){null==c&&(c=0.35);null==b&&(b=1.25);this._baseScaleX=this._baseScaleY=1;this._button=this._tweener=null;m.call(this,a);this._scaleSize=b;this._scaleDuration=c;this._mouseOverEasingFunction=d;this._mouseOutEasingFunction=e;null==this._mouseOverEasingFunction&&
(this._mouseOverEasingFunction=E.linear);null==this._mouseOutEasingFunction&&(this._mouseOutEasingFunction=E.linear);this._baseScaleX=this.getEntity().getScaleRef().x;this._baseScaleY=this.getEntity().getScaleRef().y;this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",w(this,this.onMouseOut))};nc.__name__=["engine","components","buttons","ButtonMouseOverScale"];nc.__super__=m;nc.prototype=r(m.prototype,{onDeactivate:function(){m.prototype.onDeactivate.call(this);
this._tweener.setActive(!1)},onActivate:function(){m.prototype.onActivate.call(this);this._tweener.setActive(!0)},init:function(){m.prototype.init.call(this);this._tweener=new ta(this.getEntity());var a=this.getEntity().getComponent(X);null!=a&&(this._baseScaleX=a.getScaleRef().x,this._baseScaleY=a.getScaleRef().y)},disableButton:function(){this.onMouseOut(null);this.getEntity().removeEventListener("mouseOver",w(this,this.onMouseOver))},enableButton:function(){this.getEntity().addEventListener("mouseOver",
w(this,this.onMouseOver))},onMouseOver:function(a){a=this.getEntity().getComponent(X);if(!Ka.getDelayButtonLock())if(this._tweener.destroyAllTweens(),null!=a){var b=a.getScaleRef().x,c=a.getScaleRef().y;this._tweener.addTween(a.getScaleRef(),"x",b,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction);this._tweener.addTween(a.getScaleRef(),"y",c,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction)}else a=this.getEntity().getScaleRef().x,b=this.getEntity().getScaleRef().y,
this._tweener.addTween(this.getEntity().getScaleRef(),"x",a,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction),this._tweener.addTween(this.getEntity().getScaleRef(),"y",b,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction)},onMouseOut:function(a){if(null!=this._tweener)if(a=this.getEntity().getComponent(X),this._tweener.destroyAllTweens(),null!=a){var b=a.getScaleRef().x,c=a.getScaleRef().y;this._tweener.addTween(a.getScaleRef(),"x",b,this._baseScaleX,this._scaleDuration,
this._mouseOutEasingFunction);this._tweener.addTween(a.getScaleRef(),"y",c,this._baseScaleY,this._scaleDuration,this._mouseOutEasingFunction)}else a=this.getEntity().getScaleRef().x,b=this.getEntity().getScaleRef().y,this._tweener.addTween(this.getEntity().getScaleRef(),"x",a,this._baseScaleX,this._scaleDuration,this._mouseOutEasingFunction),this._tweener.addTween(this.getEntity().getScaleRef(),"y",b,this._baseScaleY,this._scaleDuration,this._mouseOutEasingFunction)},__class__:nc});var Jc=function(a,
b,c){m.call(this,a);this._soundName=b;this._overSoundName=c};Jc.__name__=["engine","components","buttons","ButtonSoundPlay"];Jc.__super__=m;Jc.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this.getEntity().addEventListener("mouseDown",w(this,this.onMouseDown));this.getEntity().addEventListener("mouseOver",w(this,this.onMouseOver))},onMouseDown:function(){""!=this._soundName&&n.playSoundByName(this._soundName)},onMouseOver:function(){""!=this._soundName&&n.playSoundByName(this._overSoundName)},
destroy:function(){m.prototype.destroy.call(this);this.getEntity().removeEventListener("mouseDown",w(this,this.onMouseDown))},__class__:Jc});var pd=function(a,b,c){Ua.call(this,a,c);this._collision=b};pd.__name__=["engine","components","colliders","BoxCollider"];pd.__super__=Ua;pd.prototype=r(Ua.prototype,{update:function(){Ua.prototype.update.call(this);var a=this.getEntity().getPosition().getClone(),b=null!=this._offset?this._offset:new K,c=a.x-this._collision.wh.x/2,d=b.x*this.getEntity().getScale().x;
this._collision.ul.x=c+d;a=a.y-this._collision.wh.y/2;b=b.y*this.getEntity().getScale().y;this._collision.ul.y=a+b},checkPointIntersect:function(a){return this._collision.checkPointIntersect(a)},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);return this._collision.getRaycastPoint(a,b,c,d,e)},debugRender:function(){Ua.prototype.debugRender.call(this);var a=p.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ha.getDebugCamera()){var b=ha.getDebugCamera().getEntity(),
c=ha.getDebugCamera().getZoomScale(),d=ha.getDebugCamera().getComponent(Ab);a.translate(-b.getPosition().x*c+d.getContainerOffset().x,-b.getPosition().y*c+d.getContainerOffset().y);a.scale(c,c)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(this._collision.ul.x,this._collision.ul.y);a.lineTo(this._collision.ul.x+this._collision.wh.x,this._collision.ul.y);a.lineTo(this._collision.ul.x+this._collision.wh.x,this._collision.ul.y+this._collision.wh.y);a.lineTo(this._collision.ul.x,this._collision.ul.y+
this._collision.wh.y);a.lineTo(this._collision.ul.x,this._collision.ul.y);a.stroke();a.restore()},getCollision:function(){return this._collision},__class__:pd});var qd=function(a,b,c){Ua.call(this,a,c);this._collision=b};qd.__name__=["engine","components","colliders","PolygonCollider"];qd.__super__=Ua;qd.prototype=r(Ua.prototype,{update:function(){Ua.prototype.update.call(this);var a=this.getEntity().getPosition().getClone(),b=null!=this._offset?this._offset:new K,c=a.x-this._collision.wh.x/2,d=b.x*
this.getEntity().getScale().x;this._collision.ul.x=c+d;a=a.y-this._collision.wh.y/2;b=b.y*this.getEntity().getScale().y;this._collision.ul.y=a+b},checkPointIntersect:function(a){return this._collision.checkPointIntersect(a)},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);return this._collision.getRaycastPoint(a,b,c,d,e)},debugRender:function(){Ua.prototype.debugRender.call(this);var a=p.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=ha.getDebugCamera()){var b=
ha.getDebugCamera().getEntity(),c=ha.getDebugCamera().getZoomScale(),d=ha.getDebugCamera().getComponent(Ab);a.translate(-b.getPosition().x*c+d.getContainerOffset().x,-b.getPosition().y*c+d.getContainerOffset().y);a.scale(c,c)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";b=0;for(c=this._collision.getPoints().length;b<c;)d=b++,0==d?a.moveTo(this._collision.ul.x+this._collision.getPoints()[d].x,this._collision.ul.y+this._collision.getPoints()[d].y):a.lineTo(this._collision.ul.x+this._collision.getPoints()[d].x,
this._collision.ul.y+this._collision.getPoints()[d].y);a.lineTo(this._collision.ul.x+this._collision.getPoints()[0].x,this._collision.ul.y+this._collision.getPoints()[0].y);a.stroke();a.restore()},getCollision:function(){return this._collision},__class__:qd});var xe=function(a,b,c){this._position=this._spriteIndex=0;this._position=a;this._spriteIndex=b;this._spriteSheetName=c};xe.__name__=["engine","components","flashAnimation","AnimationKeyframe"];xe.prototype={getSpriteSheetName:function(){return this._spriteSheetName},
getPosition:function(){return this._position},getSpriteIndex:function(){return this._spriteIndex},__class__:xe};var E=function(){};E.__name__=["engine","components","tween","EasingFunctions"];E.linear=function(a,b,c,d){return b+c*(a/d)};E.easeOutExpo=function(a,b,c,d){return c*(-Math.pow(2,-10*a/d)+1)+b};E.easeInCubic=function(a,b,c,d){a/=d;return c*a*a*a+b};E.easeOutCubic=function(a,b,c,d){a/=d;--a;return c*(a*a*a+1)+b};E.easeInQuad=function(a,b,c,d){a/=d;return c*a*a+b};E.easeOutQuad=function(a,
b,c,d){a/=d;return-c*a*(a-2)+b};E.easeInOutQuad=function(a,b,c,d){a/=d/2;if(1>a)return c/2*a*a+b;--a;return-c/2*(a*(a-2)-1)+b};E.easeInOutSine=function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b};E.easeInQuint=function(a,b,c,d){a/=d;return c*a*a*a*a*a+b};E.easeOutQuint=function(a,b,c,d){a/=d;--a;return c*(a*a*a*a*a+1)+b};E.easeOutBounce=function(a,b,c,d){a/=d;return 0.36363636363636365>a?c*7.5625*a*a+b:0.7272727272727273>a?c*(7.5625*(a-=0.5454545454545454)*a+0.75)+b:0.9090909090909091>a?c*(7.5625*
(a-=0.8181818181818182)*a+0.9375)+b:c*(7.5625*(a-=0.9545454545454546)*a+0.984375)+b};E.easeInBack=function(a,b,c,d){return c*(a/=d)*a*(2.70158*a-1.70158)+b};E.easeOutBack=function(a,b,c,d){a=a/d-1;return c*(a*a*(3.70158*a+2.70158)+1)+b};E.easeInOutExpo=function(a,b,c,d){a/=d/2;if(1>a)return c/2*Math.pow(2,10*(a-1))+b;--a;return c/2*(-Math.pow(2,-10*a)+2)+b};var Wf=function(a,b,c,d,e,f,g,k,h){this._elapsedTime=0;this._isCompleted=!1;this._action=this._params=null;this._change=this._delay=0;this._target=
this._easingFunction=null;this._propertyName="";this._begin=this._end=this._duration=0;this._target=a;this._propertyName=b;this._begin=c;this._end=d;this._duration=e;this._easingFunction=f;this._delay=g;this._action=k;this._params=h};Wf.__name__=["engine","components","tween","Tween"];Wf.prototype={getOnUpdate:function(){return this._onUpdate},setOnUpdate:function(a){this._onUpdate=a},update:function(a){this._change=this._end-this._begin;this._elapsedTime+=a;this._elapsedTime<this._delay||(this._elapsedTime>
this._duration+this._delay&&(this._elapsedTime=this._duration+this._delay),a=0,a=this._easingFunction(this.getTransitionTimeElapsed(),this._begin,this._change,this._duration),xa.setProperty(this._target,this._propertyName,a),null!=this._onUpdate&&this._onUpdate(),!this._isCompleted&&this.getTransitionTimeElapsed()>=this._duration&&(this._isCompleted=!0,null!=this._action&&(a=this._action,this._action=null,a(this._params))))},skip:function(){xa.setProperty(this._target,this._propertyName,this._end);
this._isCompleted=!0;this._elapsedTime=this._duration},getTransitionTimeElapsed:function(){return Math.max(0,this._elapsedTime-this._delay)},__class__:Wf};var V=function(a,b){this.data=null;this._type=a;this.data=b};V.__name__=["engine","events","EntityEvent"];V.__super__=L;V.prototype=r(L.prototype,{__class__:V});var Rf=function(a,b){this.eventName=a;this.action=b};Rf.__name__=["engine","events","EventListener"];Rf.prototype={__class__:Rf};var jb=function(a){this._type=a};jb.__name__=["engine","events",
"GameObjectEvent"];jb.__super__=L;jb.prototype=r(L.prototype,{__class__:jb});var od=function(a,b,c){this.start=this.end=null;this._type=a;this.start=b;this.end=c};od.__name__=["engine","events","RaycastCheckEvent"];od.__super__=L;od.prototype=r(L.prototype,{__class__:od});var Pa=function(){this._animations=new Ba};Pa.__name__=["engine","managers","AnimationManager"];Pa.getInstance=function(){null==Pa._instance&&(Pa._instance=new Pa);return Pa._instance};Pa.prototype={getAnimationByName:function(a){var b=
this._animations;return null!=N[a]?b.getReserved(a):b.h[a]},registerAnimation:function(a){var b=this._animations,c=a.getName();null!=N[c]?b.setReserved(c,a):b.h[c]=a},removeAnimationByName:function(a){this._animations.remove(a)},removeAllAnimations:function(){this._animations=new Ba},__class__:Pa};var I=function(){};I.__name__=["engine","managers","AssetManager"];I.outputAssets=function(){Da.log(I.assetList)};I.getAsset=function(a){var b=I.assetList;if(null!=N[a]?!b.existsReserved(a):!b.h.hasOwnProperty(a))throw new H(a+
" does not exist in asset list!");b=I.assetList;return null!=N[a]?b.getReserved(a):b.h[a]};I.assetExists=function(a){var b=I.assetList;return null!=N[a]?b.existsReserved(a):b.h.hasOwnProperty(a)};I.unloadAsset=function(a){var b=I.assetList;null!=N[a]?b.setReserved(a,null):b.h[a]=null;I.assetList.remove(a);a=PIXI.Texture.removeTextureFromCache(a);null!=a&&a.destroy(!0)};I.unloadLoadBatch=function(a){I.getAsset(a).unload()};I.registerAsset=function(a,b,c){null==c&&(c=!0);var d=I.assetList;(null!=N[a]?
d.existsReserved(a):d.h.hasOwnProperty(a))&&!c||(c=I.assetList,null!=N[a]?c.setReserved(a,b):c.h[a]=b)};I.prototype={__class__:I};var ub=function(){M.call(this);ub._instance=this};ub.__name__=["engine","managers","DebugManager"];ub.getInstance=function(){return ub._instance};ub.__super__=da;ub.prototype=r(da.prototype,{update:function(){da.prototype.update.call(this);"1"==R.getProperty("debugCheats")&&(ma.getInstance().isKeyPressed(104)&&R.setProperty("debugDraw","1"==R.getProperty("debugDraw")?"0":
"1"),ma.getInstance().isKeyPressed(101)&&this.dispatchEvent(new vb("beatLevel")),ma.getInstance().isKeyPressed(102)&&this.dispatchEvent(new vb("failLevel")),ma.getInstance().isKeyPressed(100)&&(R.setProperty("forceOrientation","HORIZONTAL"==R.getProperty("forceOrientation")?"VERTICAL":"HORIZONTAL"),p.getInstance().onOrientationChange()),ma.getInstance().isKeyPressed(99)&&this.outputHierarchyToWindow())},destroy:function(){da.prototype.destroy.call(this);ub._instance=null},outputHierarchyToWindow:function(){Da.log("Outputting Hierarchy to window...");
for(var a=window.document.createElement("div"),b=window.open("","_blank"),c=0,d=p.getInstance().getGameStates().length;c<d;){var e=c++,e=p.getInstance().getGameStates()[e],f=window.document.createElement("details");a.appendChild(f);f.style.color="#FF0000";var g=window.document.createElement("summary");f.appendChild(g);g.innerText=hb.getClassName(null==e?null:y.getClass(e));for(var g=0,k=e.getEntities().length;g<k;){var h=g++,h=e.getEntities()[h];null==h.getParent()&&(h=this.createDetailsElementForEntity(h),
h.style.marginLeft="10px",f.appendChild(h))}}b.document.body.appendChild(a)},createDetailsElementForEntity:function(a){var b=a.getName();if(""==b||null==b)b="Entity";var c=window.document.createElement("details");c.style.marginLeft="10px";c.style.color="#00b700";var d=window.document.createElement("summary");c.appendChild(d);for(var e=null!=a.getComponents(m)?a.getComponents(m).length:0,f=a.getChildren().length,g=a.getChildren(!0).length,k="",h=0;h<e;){var l=h++,l=a.getComponents(m)[l],n=window.document.createElement("details");
n.style.marginLeft="10px";n.style.color="#439eff";var u=window.document.createElement("summary");n.appendChild(u);var p=hb.getClassName(null==l?null:y.getClass(l));l.isActive()||(p="(INACTIVE) "+p);u.innerText=p;""!=k&&(k+=", ");u=hb.getClassName(null==l?null:y.getClass(l)).split(".");k+=u[u.length-1];c.appendChild(n);for(var u=xa.fields(l),p=0,r=u.length;p<r;){var q=p++,s=u[q],q=window.document.createElement("details");q.style.marginLeft="10px";q.style.color="#AAAAAA";var t=window.document.createElement("summary");
q.appendChild(t);var v=xa.field(l,s),w=v;null==w||y.getClass(w);t.innerText=s;s=window.document.createElement("span");s.style.marginLeft="10px";s.style.color="#888888";s.innerText=v;n.appendChild(q);q.appendChild(s)}}a.isActive()||(b="(INACTIVE) "+b);d.innerHTML=0<e?b+" - Children("+f+"/"+g+") <font color='#439eff'> Components("+e+": "+k+")</font>":b+" - Children("+f+"/"+g+")";for(b=0;b<f;)d=b++,d=a.getChildren()[d],d=this.createDetailsElementForEntity(d),c.appendChild(d);return c},__class__:ub});
var vb=function(a){this._type=a};vb.__name__=["engine","managers","DebugManagerEvent"];vb.__super__=L;vb.prototype=r(L.prototype,{__class__:vb});var ma=function(){this._keysDown=this._keysPressedThisFrame=null;this._isInputDisabled=this._isLeftMouseDown=!1;this._mousePosition=null;M.call(this);ma._instance=this;this._mousePosition=new s(0,0);this._keysDown=[];this._keysPressedThisFrame=[];for(var a=0;255>a;)a++,this._keysDown.push(!1),this._keysPressedThisFrame.push(!1)};ma.__name__=["engine","managers",
"InputManager"];ma.getInstance=function(){return ma._instance};ma.__super__=da;ma.prototype=r(da.prototype,{init:function(){da.prototype.init.call(this);x.getWindow().addEventListener("mousemove",w(this,this.onMouseMoved));x.getWindow().addEventListener("mousedown",w(this,this.onMouseDown));x.getWindow().addEventListener("mouseup",w(this,this.onMouseUp));x.getWindow().addEventListener("mouseleave",w(this,this.onMouseLeave));x.getWindow().addEventListener("mouseout",w(this,this.onMouseOut));x.getDocument().addEventListener("keydown",
w(this,this.onKeyDown));x.getDocument().addEventListener("keyup",w(this,this.onKeyUp));x.getDocument().addEventListener("keypress",w(this,this.onKeyPressed));x.getWindow().addEventListener("click",w(this,this.onMouseClick));document.addEventListener("touchstart",w(this,this.onMouseDown));document.addEventListener("touchend",w(this,this.onMouseUp));document.addEventListener("touchmove",w(this,this.onMouseMoved))},update:function(){da.prototype.update.call(this)},postUpdate:function(){da.prototype.postUpdate.call(this);
for(var a=0,b=this._keysPressedThisFrame.length;a<b;){var c=a++;this._keysPressedThisFrame[c]=!1}},getMousePosition:function(){var a=p.getInstance().getScreenOffset();return new s((this._mousePosition.x-a.x)/p.getInstance().getScreenScale().x,(this._mousePosition.y-a.y)/p.getInstance().getScreenScale().y)},onMouseMoved:function(a){if(!this._isInputDisabled)if(p.isMobile()){for(var b=a.changedTouches,c=0,d=b.length;c<d;){var e=c++,f=b[e],e=f.pageX-x.getContainer().offsetParent.offsetLeft,f=f.pageY-
x.getContainer().offsetParent.offsetTop;this._mousePosition.x=e;this._mousePosition.y=f;p.getInstance().sendGlobalMessage("mouseMove",this.getMousePosition())}p.getInstance().sendGlobalMessage("verifyTouches",a)}else b=a.pageX-x.getContainer().offsetParent.offsetLeft,a=a.pageY-x.getContainer().offsetParent.offsetTop,this._mousePosition.x=b,this._mousePosition.y=a,p.getInstance().sendGlobalMessage("mouseMove",this.getMousePosition())},onMouseDown:function(a){p.getInstance().hideAddressBar();p.isMobile()&&
!p.isIOS()&&p.getInstance().requestFullscreen();if(!this._isInputDisabled)if(p.isMobile()){this._isLeftMouseDown=!0;var b=a.changedTouches;a=0;for(var c=b.length;a<c;){var d=a++,e=b[d],d=e.pageX-x.getContainer().offsetParent.offsetLeft,e=e.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=d;this._mousePosition.y=e;p.getInstance().sendGlobalMessage("mouseDown",this.getMousePosition())}}else this._isLeftMouseDown=!0,b=a.pageX-x.getContainer().offsetParent.offsetLeft,a=a.pageY-x.getContainer().offsetParent.offsetTop,
this._mousePosition.x=b,this._mousePosition.y=a,p.getInstance().sendGlobalMessage("mouseDown",this.getMousePosition())},onMouseUp:function(a){if(!this._isInputDisabled){if(p.isMobile())this._isLeftMouseDown=!1;else{this._isLeftMouseDown=!1;var b;b=a.pageX-x.getContainer().offsetParent.offsetLeft;a=a.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a}p.getInstance().sendGlobalMessage("mouseUp",this.getMousePosition())}},onMouseClick:function(a){if(!this._isInputDisabled){var b=
a.pageX-x.getContainer().offsetParent.offsetLeft;a=a.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;p.getInstance().sendGlobalMessage("mouseClick",this.getMousePosition())}},onMouseLeave:function(a){if(!this._isInputDisabled){var b=a.pageX-x.getContainer().offsetParent.offsetLeft;a=a.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;p.getInstance().sendGlobalMessage("mouseLeave",this.getMousePosition())}},onMouseOut:function(a){if(!this._isInputDisabled){var b=
a.pageX-x.getContainer().offsetParent.offsetLeft;a=a.pageY-x.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;p.getInstance().sendGlobalMessage("mouseOut",this.getMousePosition())}},onKeyDown:function(a){a.stopPropagation();this._isInputDisabled||this._keysDown[a.keyCode]||(this._keysDown[a.keyCode]=!0,this._keysPressedThisFrame[a.keyCode]=!0,p.getInstance().sendGlobalMessage("keyDown",a.keyCode))},onKeyUp:function(a){this._isInputDisabled||(this._keysDown[a.keyCode]=
!1,p.getInstance().sendGlobalMessage("keyUp",a.keyCode))},onKeyPressed:function(a){a.stopPropagation();this._isInputDisabled||p.getInstance().sendGlobalMessage("keyPressed",a.keyCode)},disablePageKeyPresses:function(){document.onkeydown=function(a){a.preventDefault();return!1}},enablePageKeyPresses:function(){document.onkeydown=null},getInputDisabled:function(){return this._isInputDisabled},setInputDisabled:function(a){this._isInputDisabled=a},isKeyDown:function(a){return this._keysDown[a]},isKeyPressed:function(a){return this._keysPressedThisFrame[a]},
isLeftMouseDown:function(){return this._isLeftMouseDown},__class__:ma});var cb=function(){this._colliders=this._raycastsThisFrame=null;M.call(this);cb._instance=this;this._raycastsThisFrame=[];this._colliders=[];this._debugDrawEnabled="1"==R.getProperty("debugDraw");this.addEventListener("raycastCheck",w(this,this.onRaycastCheck))};cb.__name__=["engine","managers","PhysicsManager"];cb.getInstance=function(){return cb._instance};cb.createBoxColliderEntity=function(a,b,c,d,e,f,g,k){null==k&&(k=!0);
d=f.addEntity();d.setLocalPosition(a,b,c);a=new Hc;k=new pd(d,a,k?new K:new K(0.5*a.wh.x,0.5*a.wh.y));if(null!=g)for(a=0,b=g.length;a<b;)c=a++,k.addTag(g[c]);return d};cb.createBoxCollider=function(a,b,c,d,e,f,g){null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);b=new Hc;a=new pd(a,b,new K(d,e,f));if(null!=g)for(d=0,e=g.length;d<e;)f=d++,a.addTag(g[f]);return a};cb.__super__=da;cb.prototype=r(da.prototype,{update:function(){da.prototype.update.call(this)},registerCollider:function(a){for(var b=0,c=this._colliders.length;b<
c;){var d=b++;if(this._colliders[d]==a)return}this._colliders.push(a)},removeCollider:function(a){for(var b=0,c=this._colliders.length;b<c;){var d=b++;if(this._colliders[d]==a){this._colliders.splice(d,1);break}}},getColliders:function(){return this._colliders},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!0);for(var f=-1,g=null,k=null,h=0,l=0,m=0,u=this._colliders.length;m<u;){var n=m++;++l;n=this._colliders[n];if(!1!=n.isActive()){if(null!=e){for(var p=!1,r=0,q=e.length;r<q;){var t=r++;if(n.hasTag(e[t])){p=
!0;break}}if(!p)continue}++h;p=new s;if(d){if(r=new s,q=n.getRaycastPoint(a,b,p,d,r),-1==f&&0<q||0<q&&q<f)c.distance=q,c.collider=n,c.collisionPoint=p,k=c.normal=r,g=p,f=q,F.remove(this._colliders,n),this._colliders.unshift(n)}else if(r=new s,q=n.getRaycastPoint(a,b,p,d,r),0<q){c.distance=q;c.collider=n;c.collisionPoint=p;k=c.normal=r;g=p;f=q;F.remove(this._colliders,n);this._colliders.unshift(n);break}}}this._raycastsThisFrame.push({start:a,end:b,hitPoint:g,normal:k});return f},render:function(){da.prototype.render.call(this);
"0"==R.getProperty("debugDraw")&&(this._raycastsThisFrame=[])},debugRender:function(){da.prototype.debugRender.call(this);for(var a=0,b=this._raycastsThisFrame.length;a<b;){var c=a++,d=this._raycastsThisFrame[c],e=d.start,f=d.end,c=d.hitPoint,g=p.getInstance().getLayerByName("debug").getCanvas().getContext("2d");g.save();if(null!=ha.getDebugCamera()){var k=ha.getDebugCamera().getEntity(),h=ha.getDebugCamera().getZoomScale(),l=ha.getDebugCamera().getComponent(Ab);g.translate(-k.getPosition().x*h+l.getContainerOffset().x,
-k.getPosition().y*h+l.getContainerOffset().y);g.scale(h,h)}null==c?(g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#AAAAFF",g.moveTo(e.x,e.y),g.lineTo(f.x,f.y),g.stroke()):(g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#AAAAFF",g.moveTo(e.x,e.y),g.lineTo(c.x,c.y),g.stroke(),g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#FFFF00",g.moveTo(c.x,c.y),g.lineTo(f.x,f.y),g.stroke(),null!=d.normal&&(e=(new s(f.x-c.x,f.y-c.y)).getLength(),d=new s(c.x+d.normal.x*e,c.y+
d.normal.y*e),g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#FF00FF",g.moveTo(c.x,c.y),g.lineTo(d.x,d.y),g.stroke()));g.restore()}this._raycastsThisFrame=[]},destroyAllColliders:function(){for(var a=this._colliders.length-1;0<=a;)this.removeCollider(this._colliders[a]),--a;this._colliders=[]},onRaycastCheck:function(a){this._raycastsThisFrame.push({start:a.start,end:a.end})},__class__:cb});var pc=function(){this._isCurrentVoLocked=!1;this._voTrack=null;M.call(this);pc._instance=this};
pc.__name__=["engine","managers","VoManager"];pc.getInstance=function(){return pc._instance};pc.__super__=da;pc.prototype=r(da.prototype,{playVo:function(a,b,c,d){null==d&&(d=!1);null==c&&(c=!1);null==b&&(b=!1);if(!this._isCurrentVoLocked||b)this.stopVo(),this._voTrack=n.playSoundByName(a,c,d),b&&(p.getInstance().invokeAsyncDeferredAction(this._voTrack.getSoundLength(),w(this,this.onHighPrioritySoundElapse)),this._isCurrentVoLocked=!0)},onHighPrioritySoundElapse:function(){this._isCurrentVoLocked=
!1},stopVo:function(){null!=this._voTrack&&(this._voTrack.stop(),this._voTrack=null)},__class__:pc});var Ae=function(){};Ae.__name__=["engine","ui","ILayoutElement"];Ae.prototype={__class__:Ae,__properties__:{set_localPosition:"set_localPosition",get_localPosition:"get_localPosition",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width"}};var la=function(a){this._updateContainerEveryFrame=!0;m.call(this,a);this._positionOffset=new s(0,0);this._scaleModifier=new s(1,
1);this._scaleOffset=new s(0,0);this._rotationOffset=0;this.initContainer()};la.__name__=["engine","pixi","PixiContainer"];la.__interfaces__=[Ae];la.__super__=m;la.prototype=r(m.prototype,{get_width:function(){return this._container.width},set_width:function(a){return this._container.width=a},get_height:function(){return this._container.height},set_height:function(a){return this._container.height=a},get_localPosition:function(){return this.getEntity().getLocalPosition()},set_localPosition:function(a){this.getEntity().setLocalPosition(a.x,
a.y,a.z);return a},getUpdateContainerEveryFrame:function(){return this._updateContainerEveryFrame},setUpdateContainerEveryFrame:function(a){this._updateContainerEveryFrame=a},getPositionOffset:function(){return this._positionOffset},setPositionOffset:function(a){this._positionOffset=a},getScaleModifier:function(){return this._scaleModifier},setScaleModifier:function(a){this._scaleModifier=a},getScaleOffset:function(){return this._scaleOffset},setScaleOffset:function(a){this._scaleOffset=a},getRotationOffset:function(){return this._rotationOffset},
setRotationOffset:function(a){this._rotationOffset=a},getContainer:function(){return this._container},initContainer:function(){this._container=new PIXI.Container},onActivate:function(){m.prototype.onActivate.call(this);null!=this._container&&(this._container.renderable=!0)},onDeactivate:function(){m.prototype.onDeactivate.call(this);null!=this._container&&(this._container.renderable=!1)},init:function(){m.prototype.init.call(this);this.updateTransforms();this.updateParenting()},updateParenting:function(){if(!this.isMarkedForDeletion()){var a=
this.getEntity().getParent();if(null!=a){var b=a.getComponent(la);null==b&&(b=new la(a));0<b.getContainer().children.length?b.getContainer().addChildAt(this._container,b.getContainer().children.length):b.getContainer().addChild(this._container);this._parentContainer=b}else 0<ia.getInstance().getStage().children.length?ia.getInstance().getStage().addChildAt(this._container,ia.getInstance().getStage().children.length):ia.getInstance().getStage().addChild(this._container)}},update:function(){m.prototype.update.call(this);
this._container.visible=this.getEntity().isVisible()},render:function(){m.prototype.render.call(this);this._updateContainerEveryFrame&&(this.updateTransforms(),this.updateParenting())},bringToFront:function(){var a=this._container.parent;null!=a&&(a.removeChild(this._container),a.addChild(this._container))},updateTransforms:function(){var a=this.getEntity().getLocalPosition(),b=this.getEntity().getLocalScale();this._container.position=new PIXI.Point(a.x+this._positionOffset.x,a.y+this._positionOffset.y);
a=this.getEntity().getLocalRotation().z+this._rotationOffset;this._container.rotation=S.degToRad(a);this._container.scale=new PIXI.Point(b.x*this._scaleModifier.x+this._scaleOffset.x,b.y*this._scaleModifier.y+this._scaleOffset.y)},destroy:function(){m.prototype.destroy.call(this);null!=this._container.parent&&this._container.parent.removeChild(this._container)},__class__:la,__properties__:{set_localPosition:"set_localPosition",get_localPosition:"get_localPosition",set_height:"set_height",get_height:"get_height",
set_width:"set_width",get_width:"get_width"}});var B=function(a,b,c){la.call(this,a);this.setImage(b,c)};B.__name__=["engine","pixi","PixiSprite"];B.__interfaces__=[Ae];B.__super__=la;B.prototype=r(la.prototype,{getSprite:function(){return this._container},getFrame:function(){return this.getSprite().texture.frame},getAnchor:function(){return new s(this.getSprite().anchor.x,this.getSprite().anchor.y)},setAnchor:function(a,b){this.getSprite().anchor.x=a;this.getSprite().anchor.y=b},getSize:function(){return new s(this.getSprite().width,
this.getSprite().height)},setSize:function(a,b){this.getEntity().setScale(a/this.getSprite().texture.width,b/this.getSprite().texture.height)},setImageElement:function(a,b){this._currentImageElement=a;var c;null==b?c=PIXI.Texture.fromImage(this._currentImageElement.src):(c=PIXI.BaseTexture.fromImage(this._currentImageElement.src),c=new PIXI.Texture(c,b));this.getSprite().texture=c;this.updateTransforms()},setImage:function(a,b){if(I.assetExists(a)){var c=I.getAsset(a);this.setImageElement(c,b)}},
initContainer:function(){la.prototype.initContainer.call(this);this._container=new PIXI.Sprite(null)},__class__:B});var va=function(a,b){this._onAnimationComplete=null;this._position=0;this._updateScale=1;this._isPlaying=!0;B.call(this,a,"");this._currentAnimationName=b};va.__name__=["engine","pixi","PixiAnimation"];va.__super__=B;va.prototype=r(B.prototype,{getAnimation:function(){return Pa.getInstance().getAnimationByName(this._currentAnimationName)},getAnimationLength:function(){return this.getAnimation().getLength()},
getUpdateScale:function(){return this._updateScale},setUpdateScale:function(a){this._updateScale=a},fixedUpdate:function(){B.prototype.update.call(this);var a=this.getAnimation();if(null!=a){if(this._isPlaying){this._position+=p.getDeltaTime()*this.getUpdateScale();if(0<this._updateScale&&this._position>=a.getLength()&&(a.getLoop()?this._position-=a.getLength():(this._position=a.getLength(),this.stop()),null!=this._onAnimationComplete)){var b=this._onAnimationComplete;this._onAnimationComplete=null;
b(this.getEntity());a=Pa.getInstance().getAnimationByName(this._currentAnimationName)}0>this._updateScale&&0>=this._position&&(a.getLoop()?this._position+=a.getLength():(this._position=0,this.stop()),null!=this._onAnimationComplete&&(b=this._onAnimationComplete,this._onAnimationComplete=null,b(this.getEntity()),a=Pa.getInstance().getAnimationByName(this._currentAnimationName)))}if(null!=a){var b=a.getSpriteIndexAtPosition(this._position),c=a.getSpriteSheetNameAtPosition(this._position),b=Sa.getInstance().getSpriteSheetByName(c).getSpriteInfoByIndex(b),
d=b.getCoords();this.setImage(c,new PIXI.Rectangle(d.ul.x,d.ul.y,d.wh.x,d.wh.y));c=a.getOffset().x/b.getCoords().wh.x;a=a.getOffset().y/b.getCoords().wh.y;d=b.getOffset().x/b.getCoords().wh.x;b=b.getOffset().y/b.getCoords().wh.y;this.getSprite().anchor.x=-c-d;this.getSprite().anchor.y=-a-b}}},setPosition:function(a){this._position=a},getPosition:function(){return this._position},setAnimation:function(a,b,c){null==c&&(c=!1);if(this._currentAnimationName!=a||c)this._position=0;this._currentAnimationName=
a;this._onAnimationComplete=b;this._isPlaying=!0},getAnimationName:function(){return this._currentAnimationName},play:function(){this._isPlaying=!0},stop:function(){this._isPlaying=!1},playing:function(){return this._isPlaying},setOnAnimationComplete:function(a){this._onAnimationComplete=a},getOnAnimationComplete:function(){return this._onAnimationComplete},__class__:va});var Ab=function(a){this._containerOffset=new s(0,0);this._muteRotation=!1;this._layers=[];ha.call(this,a)};Ab.__name__=["engine",
"pixi","PixiCamera"];Ab.__super__=ha;Ab.prototype=r(ha.prototype,{getContainerOffset:function(){return this._containerOffset},setContainerOffset:function(a){this._containerOffset.x=a.x;this._containerOffset.y=a.y},getMuteRotation:function(){return this._muteRotation},setMuteRotation:function(a){this._muteRotation=a},addLayer:function(a,b,c,d,e,f){null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=1);null==b&&(b=1);a=new Xf(a,b,c,d,e,f);this._layers.push(a);return a},removeLayer:function(a){F.remove(this._layers,
a)},getLayerByContainer:function(a){for(var b=0,c=this._layers.length;b<c;){var d=b++,d=this._layers[d];if(d.pixiContainer==a)return d}return null},getLayers:function(){return this._layers},postUpdate:function(){ha.prototype.postUpdate.call(this);for(var a=this.getEntity().getPosition(),b=0,c=this._layers.length;b<c;){var d=b++,e=this._zoomScale,d=this._layers[d],e=0==d.zoomModifier?1:e*d.zoomModifier;0==d.parallaxX&&0==d.parallaxY&&(e=1);d.muteXMovement?d.pixiContainer.setPositionOffset(new s(d.pixiContainer.getPositionOffset().x,
p.getInstance().getGameSize().y/2+this._containerOffset.y*d.parallaxY)):d.muteYMovement?d.pixiContainer.setPositionOffset(new s(p.getInstance().getGameSize().x/2+this._containerOffset.x*d.parallaxX,d.pixiContainer.getPositionOffset().y)):d.muteXMovement||d.muteYMovement||d.pixiContainer.setPositionOffset(new s(p.getInstance().getGameSize().x/2+this._containerOffset.x*d.parallaxX,p.getInstance().getGameSize().y/2+this._containerOffset.y*d.parallaxY));this._muteRotation||d.pixiContainer.setRotationOffset(this.getEntity().getRotation().z);
var f=Math.floor(a.x*d.parallaxX)-d.originX+p.getInstance().getGameSize().x/e/2,g=Math.floor(a.y*d.parallaxY)-d.originY+p.getInstance().getGameSize().y/e/2;d.pixiContainer.getContainer().pivot=new PIXI.Point(f,g);d.pixiContainer.setScaleModifier(new s(e,e))}},__class__:Ab});var Xf=function(a,b,c,d,e,f){null==f&&(f=1);this.muteXMovement=this.muteYMovement=!1;this.zoomModifier=1;this.originX=this.originY=0;this.parallaxX=this.parallaxY=1;this.pixiContainer=a;this.parallaxX=b;this.parallaxY=c;this.originX=
d;this.originY=e;this.zoomModifier=f};Xf.__name__=["engine","pixi","PixiCameraLayer"];Xf.prototype={__class__:Xf};var ia=function(a){this._isSetup=!1;this.scaleHeightToWidth=0;M.call(this)};ia.__name__=["engine","pixi","PixiManager"];ia.getInstance=function(){null==ia._instance&&(ia._instance=new ia,p.getInstance().addManager(ia._instance));return ia._instance};ia.__super__=da;ia.prototype=r(da.prototype,{getWebGlEnabled:function(){return this._renderer.type==PIXI.RENDERER_TYPE.WEBGL},getStage:function(){return this._stage},
getRenderer:function(){return this._renderer},setup:function(a){this._baseWidth=R.getProperty("gameWidth",1024);this._baseHeight=R.getProperty("gameHeight",768);this._stage=new PIXI.Container;this._renderer=PIXI.autoDetectRenderer(p.getInstance().getGameSize().x,p.getInstance().getGameSize().y,a,!1);this._masterLayer=p.getInstance().getLayerByName("master");x.getContainer().appendChild(this._renderer.view);this._isSetup=!0;this.updateSize()},render:function(){da.prototype.render.call(this);null!=
this._renderer&&this._renderer.render(this._stage)},handleMessage:function(a,b){da.prototype.handleMessage.call(this,a,b);if(null!=this._renderer)switch(a){case "onOrientationChanged":this.updateSize();break;case "onResizedWindow":this.updateSize()}},updateSize:function(){if(null!=this._stage)if(p.isMobile()){var a=window.innerWidth,b=window.innerHeight,c=S.lerp(b/this._baseHeight,a/this._baseWidth,this.scaleHeightToWidth);this._stage.scale.x=c;this._stage.scale.y=c;this._stage.x=0.5*a-0.5*this._baseWidth*
c;this._stage.y=0.5*b-0.5*this._baseHeight*c;this._renderer.view.style.left="0px";this._renderer.view.style.top="0px";this._renderer.resize(a,b)}else a=window.innerHeight,this._renderer.view.style.left=0.5*window.innerWidth-0.5*this._baseWidth+"px",this._renderer.view.style.top=0.5*a-0.5*this._baseHeight+"px"},__class__:ia});var Yf=function(a,b,c,d){la.call(this,a);Da.log("WARNING: Spine is not enabled. Set the SPINE preprocessor to enable this");a=I.getAsset(b);c=I.getAsset(c);this.generateSpine(a,
c,d)};Yf.__name__=["engine","pixi","PixiSpineAnimation"];Yf.__super__=la;Yf.prototype=r(la.prototype,{generateSpine:function(a,b,c){null!=this._spine&&(this._container.removeChild(this._spine),this._spine=null);a=JSON.parse(a);b=new PIXI.spine.core.TextureAtlas(b,function(a,b){b(PIXI.BaseTexture.fromImage(c+a))},null);a=(new PIXI.spine.core.SkeletonJson(new PIXI.spine.core.AtlasAttachmentLoader(b))).readSkeletonData(a);this._spine=new PIXI.spine.Spine(a);this._container.addChild(this._spine);a=this._spine.getBounds();
this._spine.position.set(-a.x,-a.y);this._spine.skeleton.setToSetupPose();this._spine.update(0)},setToSetupPose:function(){this._spine.skeleton.setToSetupPose()},setAnimation:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);this._spine.state.setAnimation(c,a,b)},setSkinByName:function(a){this._spine.skeleton.setSkinByName(a)},setSlotsToSetupPose:function(){this._spine.skeleton.setSlotsToSetupPose()},__class__:Yf});var na=function(a,b,c){la.call(this,a);this.getText().anchor.x=0.5;this.getText().anchor.y=
0.5;a=this._container;a.text=b;a.style=c};na.__name__=["engine","pixi","PixiText"];na.__super__=la;na.prototype=r(la.prototype,{getText:function(){return this._container},getTextString:function(){return this.getText().text},setTextString:function(a){this.getText().text=a},initContainer:function(){la.prototype.initContainer.call(this);this._container=new PIXI.Text("")},init:function(){la.prototype.init.call(this)},destroy:function(){la.prototype.destroy.call(this);this.getText().texture.baseTexture.destroy()},
__class__:na});var La=function(a,b,c){null==c&&(c=!0);aa.call(this);this._from=a;this._to=b;this._destroyFrom=c;n.playSoundByName("transition_1")};La.__name__=["engine","screenTransition","TransitionScreen"];La.__super__=aa;La.prototype=r(aa.prototype,{onTransitionMidpoint:function(){this._destroyFrom&&this._from.destroy();p.getInstance().addGameState(this._to);this.dispatchEvent(new qc("midpoint"))},onTransitionComplete:function(){this.destroy();this.dispatchEvent(new qc("complete"))},__class__:La});
var qc=function(a){this._type=a};qc.__name__=["engine","screenTransition","TransitionScreenEvent"];qc.__super__=L;qc.prototype=r(L.prototype,{__class__:qc});var wb=function(){this.layers=[];this.ul=new s;this.wh=new s};wb.__name__=["engine","shapes","Shape"];wb.prototype={hasLayer:function(a){for(var b=0,c=this.layers.length;b<c;){var d=b++;if(this.layers[d]==a)return!0}return!1},getClone:function(){var a=new wb;a.ul=this.ul.getClone();a.wh=this.wh.getClone();for(var b=0,c=this.layers.length;b<c;){var d=
b++;a.layers.push(this.layers[d])}return a},checkPointIntersect:function(a){return!1},getRaycastPoint:function(a,b,c,d,e){return-1},__class__:wb};var Hc=function(){wb.call(this)};Hc.__name__=["engine","shapes","BoxShape"];Hc.__super__=wb;Hc.prototype=r(wb.prototype,{checkPointIntersect:function(a){wb.prototype.checkPointIntersect.call(this,a);return a.x>=this.ul.x&&a.y>=this.ul.y&&a.x<=this.ul.x+this.wh.x?a.y<=this.ul.y+this.wh.y:!1},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);e=new s;for(var f=
[new s(this.ul.x,this.ul.y),new s(this.ul.x+this.wh.x,this.ul.y),new s(this.ul.x+this.wh.x,this.ul.y+this.wh.y),new s(this.ul.x,this.ul.y+this.wh.y)],g=-1,k=0,h=f.length-1;k<h;){var l=k++,l=S.lineIntersect2D(a,b,f[l],f[l+1],e);if(0<l)if(d){if(-1==g||l<g)c.x=e.x,c.y=e.y,g=l}else return c.x=e.x,c.y=e.y,l}a=S.lineIntersect2D(a,b,f[0],f[f.length-1],e);if(0<a)if(d){if(-1==g||a<g)c.x=e.x,c.y=e.y,g=a}else return c.x=e.x,c.y=e.y,a;return g},getClone:function(){return null},__class__:Hc});var rd=function(){this._lowestPoint=
this._highestPoint=null;wb.call(this);this._lowestPoint=new s(999999,999999);this._highestPoint=new s(-999999,-999999);this._points=[]};rd.__name__=["engine","shapes","PolygonShape"];rd.__super__=wb;rd.prototype=r(wb.prototype,{addPoint:function(a,b){this._points.push(new s(a,b));a<this._lowestPoint.x&&(this._lowestPoint.x=a);b<this._lowestPoint.y&&(this._lowestPoint.y=b);a>this._highestPoint.x&&(this._highestPoint.x=a);b>this._highestPoint.y&&(this._highestPoint.y=b)},getPoints:function(){return this._points},
checkPointIntersect:function(a){for(var b=this._points.length,c=0,d=!1,e=null,f=null;c<b;){e=this._points[c].getClone();f=this._points[(c+1)%b].getClone();e.x+=this.ul.x;e.y+=this.ul.y;f.x+=this.ul.x;f.y+=this.ul.y;if(0==c)d=0<(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y);else if(d&&0>(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y)||!d&&0<(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y))return!1;++c}return!0},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);var f=new Cb;f.ul=this._lowestPoint.getClone();f.wh=new s(this._highestPoint.x-
this._lowestPoint.x,this._highestPoint.y-this._lowestPoint.y);f.ul.x+=this.ul.x;f.ul.y+=this.ul.y;var g=Math.abs(b.x-a.x),k=Math.abs(b.y-a.y),g=new Cb(a.x<b.x?a.x:b.x,a.y<b.y?a.y:b.y,g,k);if(!f.getIntersect(g))return-1;for(var f=new s,k=this._points,g=-1,h=0,l=k.length-1;h<l;){var m=h++,n=k[m].getClone();n.x+=this.ul.x;n.y+=this.ul.y;var p=k[m+1].getClone();p.x+=this.ul.x;p.y+=this.ul.y;m=S.lineIntersect2D(a,b,n,p,f);if(0<m)if(d){if(-1==g||m<g)c.x=f.x,c.y=f.y,null!=e&&(g=(new s(p.y-n.y,n.x-p.x)).getNormalized(),
e.x=g.x,e.y=g.y,0<(new s(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),g=m}else return c.x=f.x,c.y=f.y,null!=e&&(c=(new s(p.y-n.y,n.x-p.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new s(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),m}h=k[0].getClone();h.x+=this.ul.x;h.y+=this.ul.y;l=k[k.length-1].getClone();l.x+=this.ul.x;l.y+=this.ul.y;k=S.lineIntersect2D(a,b,h,l,f);if(0<k)if(d){if(-1==g||k<g)c.x=f.x,c.y=f.y,null!=e&&(c=(new s(l.y-h.y,h.x-l.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new s(b.x-
a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),g=k}else return c.x=f.x,c.y=f.y,null!=e&&(c=(new s(l.y-h.y,h.x-l.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new s(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),k;return g},getClone:function(){return null},__class__:rd});var Zf=function(a){this.soundName=a;this.subtitles=[]};Zf.__name__=["engine","speechManager","Dialogue"];Zf.prototype={__class__:Zf};var Qb=function(a,b){null==b&&(b=!0);null==a&&(a=!0);this._voTrack=this._speechMap=this._currentDeferredActions=
null;M.call(this);this._speechMap=new $f;this._voiceOversEnabled=a;this._subtitlesEnabled=b;this._currentDeferredActions=[];Qb._instance=this};Qb.__name__=["engine","speechManager","SpeechManager"];Qb.getInstance=function(){return Qb._instance};Qb.__super__=da;Qb.prototype=r(da.prototype,{getVoiceOversEnabled:function(){return this._voiceOversEnabled},setVoiceOversEnabled:function(a){this._voiceOversEnabled=a},getSubtitlesEnabled:function(){return this._subtitlesEnabled},setSubtitlesEnabled:function(a){this._subtitlesEnabled=
a},init:function(){da.prototype.init.call(this)},setup:function(){this.parseSpeechMap()},parseSpeechMap:function(){for(var a=A.parse(I.getAsset("speechMap")).elementsNamed("speech_map").next().elementsNamed("dialogue");a.hasNext();){for(var b=a.next(),c=new Zf(b.get("soundName")),b=b.elementsNamed("subtitle");b.hasNext();){var d=b.next(),d=new ag(d.get("stringId"),parseFloat(d.get("time")),parseFloat(d.get("duration")));c.subtitles.push(d)}this._speechMap.dialogue.push(c)}},stopVo:function(){null!=
this._voTrack&&(this._voTrack.stop(),this._voTrack=null)},playVo:function(a){var b=this;null!=this._voTrack&&this.stopVo();if("0"==R.getProperty("speechMode")||"2"==R.getProperty("speechMode"))this._voTrack=n.playSoundByName(a);if("1"==R.getProperty("speechMode")||"2"==R.getProperty("speechMode")){var c=this._speechMap.getDialogueBySoundName(a);if(null!=c){for(;0<this._currentDeferredActions.length;)a=this._currentDeferredActions.pop(),p.getInstance().destroyDeferredAction(a);a=0;for(var d=c.subtitles.length;a<
d;){var e=a++,e=[c.subtitles[e]];this._currentDeferredActions.push(p.getInstance().invokeAsyncDeferredAction(e[0].time,function(a){return function(){b.dispatchSubtitle(a[0])}}(e)))}}else Da.log("WARNING: '"+a+"' has no subtitles.")}return this._voTrack},dispatchSubtitle:function(a){this.dispatchEvent(new sd("showSubtitle",a.duration,oa.getString(a.stringId)))},__class__:Qb});var $f=function(){this.dialogue=[]};$f.__name__=["engine","speechManager","SpeechMap"];$f.prototype={getDialogueBySoundName:function(a){for(var b=
0,c=this.dialogue.length;b<c;){var d=b++;if(this.dialogue[d].soundName==a)return this.dialogue[d]}return null},__class__:$f};var ag=function(a,b,c){this.stringId=a;this.time=b;this.duration=c};ag.__name__=["engine","speechManager","Subtitle"];ag.prototype={__class__:ag};var sd=function(a,b,c){this._duration=0;this._type=a;this._duration=b;this._subtitleText=c};sd.__name__=["engine","speechManager","SubtitleEvent"];sd.__super__=L;sd.prototype=r(L.prototype,{getDuration:function(){return this._duration},
getSubtitleText:function(){return this._subtitleText},__class__:sd});var Be=function(a,b,c,d){this._name=a;this._coords=b.getClone();this._spriteSheetName=c;null==d||isNaN(d.x)&&isNaN(d.y)?this._offset=new s:this._offset=new s(d.x,d.y)};Be.__name__=["engine","spriteSheets","SpriteInfo"];Be.prototype={getCoords:function(){return this._coords},setOffset:function(a,b){this._offset.x=a;this._offset.y=b},getOffset:function(){return this._offset},getSpriteSheetName:function(){return this._spriteSheetName},
getName:function(){return this._name},__class__:Be};var jc=function(a,b){this._image=null;this._spriteInfo=[];this._spriteInfoHashTable=new Ba;this._name=a;null==b?this._imageName=a:(this._imageName=b,this._image=I.getAsset(this._imageName))};jc.__name__=["engine","spriteSheets","SpriteSheet"];jc.parseFromXmlString=function(a,b,c){c=A.parse(c);b=new jc(a,b);for(c=c.elementsNamed("TextureAtlas").next().elementsNamed("sprite");c.hasNext();){var d=c.next(),d=new Be(d.get("n"),new Cb(parseFloat(d.get("x")),
parseFloat(d.get("y")),parseFloat(d.get("w")),parseFloat(d.get("h"))),a,new s(parseFloat(d.get("oX")),parseFloat(d.get("oY"))));b.addSpriteInfo(d)}Sa.getInstance().registerSpriteSheet(b);return b};jc.prototype={getNumSprites:function(){return this._spriteInfo.length},getName:function(){return this._name},getImage:function(){return this._image},getImageName:function(){return this._imageName},addSpriteInfo:function(a){this._spriteInfo.push(a);var b=this._spriteInfoHashTable,c=a.getName();null!=N[c]?
b.setReserved(c,a):b.h[c]=a},getSpriteInfoByIndex:function(a){return this._spriteInfo[a]},getSpriteInfoByName:function(a){var b=this._spriteInfoHashTable;return null!=N[a]?b.getReserved(a):b.h[a]},addToAllOffsets:function(a,b){for(var c=0,d=this._spriteInfo.length;c<d;){var e=c++,e=this._spriteInfo[e];e.setOffset(e.getOffset().x+a,e.getOffset().y+b)}},__class__:jc};var Sa=function(){this._spriteSheets=new Ba};Sa.__name__=["engine","spriteSheets","SpriteSheetManager"];Sa.getInstance=function(){null==
Sa._instance&&(Sa._instance=new Sa);return Sa._instance};Sa.createSpriteSheetFromGrid=function(a,b,c,d,e){var f=I.getAsset(a),g=Math.floor(f.width/c),f=Math.floor(f.height/d);b=new jc(a,b);for(var k=0;k<f;)for(var h=k++,l=0,m=g;l<m;){var n=l++,n=new Be(a+n+"-"+h,new Cb(n*c,h*d,c,d),a,e);b.addSpriteInfo(n)}Sa.getInstance().registerSpriteSheet(b)};Sa.prototype={addToAllSpriteSheetOffsets:function(a,b,c){this.getSpriteSheetByName(a).addToAllOffsets(b,c)},getSpriteSheetByName:function(a){var b=this._spriteSheets;
return null!=N[a]?b.getReserved(a):b.h[a]},registerSpriteSheet:function(a){var b=this._spriteSheets,c=a.getName();null!=N[c]?b.setReserved(c,a):b.h[c]=a},removeSpriteSheetByName:function(a){this._spriteSheets.remove(a)},removeAllSpriteSheets:function(){this._spriteSheets=new Ba},__class__:Sa};var td=function(){this.image=null;this.width=this.height=0;this.trans="#000000";this.source=""};td.__name__=["engine","tmx","TmxImage"];td.prototype={__class__:td};var bg=function(){this.image=null;this.width=
this.height=0;this.properties=new Ba};bg.__name__=["engine","tmx","TmxImageLayer"];bg.prototype={__class__:bg};var cg=function(){this.data="";this.width=this.height=0;this.name="";this.properties=new Ba;this.tileValues=[]};cg.__name__=["engine","tmx","TmxLayer"];cg.prototype={decompressData:function(){for(var a=this.data.split(","),b=0,c=a.length;b<c;){var d=b++,d=ga.parseInt(a[d]);this.tileValues.push(d)}},isSpace:function(a,b){var c=F.cca(a,b);return 9<=c&&13>=c?!0:32==c},__class__:cg};var dg=function(a,
b,c,d,e,f,g){this._tiles=this._colliderEntities=this._layerContainers=null;this._isLoaded=!1;this._layer=this._fgLayer=this._camera=this._onLevelLoaded=null;this._basePath="";this._tmxMap=null;m.call(this,a);this._tmxMap=b;this._layer=d;this._fgLayer=e;this._camera=f;this._basePath=c;this._onLevelLoaded=g;this._tiles=[];this._colliderEntities=[];this._layers=[];this._layerContainers=[]};dg.__name__=["engine","tmx","TmxLevel"];dg.__super__=m;dg.prototype=r(m.prototype,{getLayerContainerByName:function(a){for(var b=
0,c=this._layerContainers.length;b<c;){var d=b++,d=this._layerContainers[d];if(d.getName()==a)return d}return null},getTiles:function(){return this._tiles},getTmxMap:function(){return this._tmxMap},init:function(){m.prototype.init.call(this);new la(this.getEntity());for(var a=new Pb(!0),b=0,c=this._tmxMap.tilesets.length;b<c;){var d=b++,d=this._tmxMap.tilesets[d];if(0<d.images.length)d=this._basePath+d.images[0].source,a.addAsset("tmxImage"+d,d,T.Image);else if("undefined"!=d.source&&null!=d.source){var e=
this._basePath+d.source;console.log(d.source);a.addAsset("tmxTileset"+e,e,T.Other)}}b=0;for(c=this._tmxMap.imageLayers.length;b<c;)d=b++,d=this._tmxMap.imageLayers[d],console.log("ADDING tmxImage"+this._basePath+d.image.source),a.addAsset("tmxImage"+this._basePath+d.image.source,this._basePath+d.image.source,T.Image);a.load(w(this,this.onTilesetsLoaded))},onTilesetsLoaded:function(){for(var a=new Pb(!0),b=0,c=this._tmxMap.tilesets.length;b<c;){var d=b++,d=this._tmxMap.tilesets[d];if(0==d.images.length){var e=
"tmxTileset"+this._basePath+d.source;if(I.assetExists(e)){e=A.parse(I.getAsset(e)).elementsNamed("tileset").next();d.name=e.get("name");d.tileWidth=parseInt(e.get("tilewidth"));d.tileHeight=parseInt(e.get("tileheight"));var e=e.elementsNamed("image").next(),f=e.get("source"),g=new td;g.source=f;g.width=parseInt(e.get("width"));g.height=parseInt(e.get("height"));g.trans=e.get("trans");d.images[0]=g;a.addAsset("tmxImage"+this._basePath+f,this._basePath+f,T.Image)}}else d.images[0].image=I.getAsset("tmxImage"+
this._basePath+d.images[0].source)}a.load(w(this,this.onTilesetImagesLoaded))},onTilesetImagesLoaded:function(){for(var a=0,b=this._tmxMap.tilesets.length;a<b;){var c=a++,c=this._tmxMap.tilesets[c];null!=c.images[0]&&null==c.images[0].image&&(c.images[0].image=I.getAsset("tmxImage"+this._basePath+c.images[0].source))}this.onLevelLoaded()},onLevelLoaded:function(){this._isLoaded||(this._isLoaded=!0,null!=this._onLevelLoaded&&(this._onLevelLoaded(),this._onLevelLoaded=null))},createLevel:function(){this._isLoaded||
Da.log("Level not loaded; Cannot execute 'createLevel()'!");this.instantiateEntities();this.processCollision()},instantiateEntities:function(){for(var a=0,b=this._tmxMap.imageLayers.length;a<b;){var c=a++,d=this._tmxMap.imageLayers[c],c=this.getEntity().getGameState().addEntity();this.getEntity().addChild(c);new B(c,"tmxImage"+this._basePath+d.image.source);var e=1,f=1,g=d.properties;if(null!=N.ParallaxX?g.existsReserved("ParallaxX"):g.h.hasOwnProperty("ParallaxX"))if(g=d.properties,parseFloat(null!=
N.ParallaxX?g.getReserved("ParallaxX"):g.h.ParallaxX),g=d.properties,null!=N.ParallaxX?g.existsReserved("ParallaxX"):g.h.hasOwnProperty("ParallaxX"))e=d.properties,e=parseFloat(null!=N.ParallaxX?e.getReserved("ParallaxX"):e.h.ParallaxX);g=d.properties;if(null!=N.ParallaxY?g.existsReserved("ParallaxY"):g.h.hasOwnProperty("ParallaxY"))if(g=d.properties,parseFloat(null!=N.ParallaxY?g.getReserved("ParallaxY"):g.h.ParallaxY),g=d.properties,null!=N.ParallaxY?g.existsReserved("ParallaxY"):g.h.hasOwnProperty("ParallaxY"))f=
d.properties,f=parseFloat(null!=N.ParallaxY?f.getReserved("ParallaxY"):f.h.ParallaxY);var g=this._camera,k=this.getGameState().addEntity();this.getEntity().addChild(k);var h=new la(k);k.addChild(c);g.addLayer(h,e,f);e=d.properties;if(null!=N.OriginX?e.existsReserved("OriginX"):e.h.hasOwnProperty("OriginX"))e=d.properties,e=parseFloat(null!=N.OriginX?e.getReserved("OriginX"):e.h.OriginX),c.setLocalPosition(c.getLocalPosition().x+e*this._tmxMap.tileWidth,c.getLocalPosition().y,c.getLocalPosition().z);
e=d.properties;if(null!=N.OriginY?e.existsReserved("OriginY"):e.h.hasOwnProperty("OriginY"))d=d.properties,d=parseFloat(null!=N.OriginY?d.getReserved("OriginY"):d.h.OriginY),c.setLocalPosition(c.getLocalPosition().x,c.getLocalPosition().y+d*this._tmxMap.tileHeight,c.getLocalPosition().z)}a=0;for(b=this._tmxMap.layers.length;a<b;){c=a++;d=this._tmxMap.layers[c];c=this.getGameState().addEntity();c.setName(d.name);this._layerContainers.push(c);new la(c);this.getEntity().addChild(c);for(var e=d.height,
f=d.width,g=this._tmxMap.tileWidth,k=this._tmxMap.tileHeight,h=this._tmxMap.tilesets.length,l=[],m=0,n=h;m<n;){var p=m++,p=this._tmxMap.tilesets[p];if(null!=p.images[0])for(var r="tmxImage"+this._basePath+p.images[0].source,q=I.getAsset("tmxImage"+this._basePath+p.images[0].source),t=p.tileWidth,v=p.tileHeight,w=q.width,x=q.height,z=w/t,A=(t-1)/w,D=(v-1)/x,E=0,F=e;E<F;)for(var G=E++,H=0,K=f;H<K;){var J=H++,L=J*g,M=G*k,C=d.tileValues[G*f+J];if(0!=C){for(var J=C&-2147483648,O=C&1073741824,S=C&536870912,
C=C&536870911,Q=1,R=0,U=h;R<U;){var T=R++;C>=this._tmxMap.tilesets[T].firstgid&&(Q=this._tmxMap.tilesets[T].firstgid)}Q==p.firstgid&&(C-=Q,0>C||(Q=C%z*t/w,R=Math.floor(C/z)*v/x,C=this.getEntity().getGameState().addEntity(),c.addChild(C),C.setLocalPosition(L,M+k,this.getEntity().getPosition().z),l.push(C),L=new B(C,r,new PIXI.Rectangle(Math.round(Q*q.width),Math.round(R*q.height),Math.round(A*q.width)+1,Math.round(D*q.height)+1)),L.setUpdateContainerEveryFrame(!1),L.setPositionOffset(new s(0,-p.tileHeight)),
S&&(C.setLocalRotation(0,0,90),C.setLocalScale(1,-1),C.setLocalPosition(C.getLocalPosition().x,C.getLocalPosition().y,C.getLocalPosition().z)),J&&(S?(C.setLocalPosition(C.getLocalPosition().x+t,C.getLocalPosition().y,C.getLocalPosition().z),C.setLocalScale(C.getScale().x,-C.getScale().y,1)):(C.setLocalPosition(C.getLocalPosition().x+t,C.getLocalPosition().y,C.getLocalPosition().z),C.setLocalScale(-C.getScale().x,C.getScale().y,1))),O&&(S?(C.setLocalPosition(C.getLocalPosition().x,C.getLocalPosition().y+
t,C.getLocalPosition().z),C.setLocalScale(-C.getScale().x,C.getScale().y,1)):(C.setLocalPosition(C.getLocalPosition().x,C.getLocalPosition().y+v,C.getLocalPosition().z),C.setLocalScale(C.getScale().x,-C.getScale().y,1)))))}}}e=this._camera;(null==e?null:y.getClass(e))==Ab&&(e=this._camera,f=d.properties,(null!=N.ParallaxX?f.existsReserved("ParallaxX"):f.h.hasOwnProperty("ParallaxX"))?(f=d.properties,f=parseFloat(null!=N.ParallaxX?f.getReserved("ParallaxX"):f.h.ParallaxX)):f=1,g=d.properties,(null!=
N.ParallaxY?g.existsReserved("ParallaxY"):g.h.hasOwnProperty("ParallaxY"))?(d=d.properties,d=parseFloat(null!=N.ParallaxY?d.getReserved("ParallaxY"):d.h.ParallaxY)):d=1,e.addLayer(c.getComponent(la),f,d))}},processCollision:function(){for(var a=0,b=this._tmxMap.objectGroups.length;a<b;)for(var c=a++,c=this._tmxMap.objectGroups[c],d=0,e=c.objects.length;d<e;){var f=d++,f=c.objects[f],g=f.polygon;if(("Collision"==f.type||"SoftCollision"==f.type)&&null!=g){var k=this.getEntity().getGameState().addEntity();
this.getEntity().addChild(k);for(var h=new rd,l=0,m=g.points.length;l<m;){var n=l++,n=g.points[n];h.addPoint(Math.floor(n.x),Math.floor(n.y))}(new qd(k,h)).addTag("Collision"==f.type?"ground":"softGround");k.setLocalPosition(Math.floor(f.x),Math.floor(f.y));this._colliderEntities.push(k)}else if("Collision"==f.type||"SoftCollision"==f.type)g=this.getEntity().getGameState().addEntity(),this.getEntity().addChild(g),k=new rd,k.addPoint(0,0),k.addPoint(f.width,0),k.addPoint(f.width,f.height),k.addPoint(0,
f.height),k.addPoint(0,0),(new qd(g,k)).addTag("Collision"==f.type?"ground":"softGround"),g.setLocalPosition(Math.floor(f.x),Math.floor(f.y)),this._colliderEntities.push(g)}},getAllObjectsByType:function(a){for(var b=this.getAllObjects(),c=[],c=c.concat(b),b=c.length-1;0<=b;)c[b].type!=a&&c.splice(b,1),--b;return c},getAllObjects:function(){for(var a=[],b=0,c=this._tmxMap.objectGroups.length;b<c;)for(var d=b++,d=this._tmxMap.objectGroups[d],e=0,f=d.objects.length;e<f;){var g=e++;a.push(d.objects[g])}return a},
getClosestObjectToPointByArray:function(a,b){for(var c=-1,d=null,e=0,f=b.length;e<f;){var g=e++,g=b[g],k=new s(g.x+g.width/2,g.y+g.height/2),k=new s(k.x-a.x,k.y-a.y);if(-1==c||k.getLength()<c)c=k.getLength(),d=g}return d},findObjectByName:function(a){for(var b=this.getAllObjects(),c=0,d=b.length;c<d;){var e=c++,e=b[e];if(e.name==a)return e}return null},findObjectByType:function(a){for(var b=this.getAllObjects(),c=0,d=b.length;c<d;){var e=c++,e=b[e];if(e.type==a)return e}return null},getColliderEntities:function(){return this._colliderEntities},
onDestroy:function(){m.prototype.onDestroy.call(this);this._tmxMap=null},__class__:dg});var eg=function(){this.tilesets=this.layers=this.objectGroups=this.imageLayers=this.properties=null;this.width=this.height=this.tileWidth=this.tileHeight=0;this.orientation="orthogonal";this.tilesets=[];this.layers=[];this.objectGroups=[];this.imageLayers=[];this.properties=new Ba};eg.__name__=["engine","tmx","TmxMap"];eg.prototype={createPixiSpriteByTileId:function(a,b,c){for(var d=this.tilesets.length,e=0;e<
d;){var f=e++,f=this.tilesets[f];if(0!=f.tiles.length){var g=b;if(0!=g){for(var g=g&536870911,k=1,h=0,l=d;h<l;){var m=h++;g>=this.tilesets[m].firstgid&&(k=this.tilesets[m].firstgid)}if(k==f.firstgid&&(g-=k,!(0>g)))return b="tmxImage"+c+f.tiles[g].image.source,I.getAsset(b),new B(a,b)}}}return null},__class__:eg};var fg=function(){this.polygon=this.polyline=null;this.x=this.y=this.rotation=this.width=this.height=0;this.name=this.type="";this.properties=new Ba};fg.__name__=["engine","tmx","TmxObject"];
fg.prototype={isFlippedHorizontally:function(){return this.gid&-2147483648},isFlippedVertically:function(){return this.gid&1073741824},isFlippedDiagonally:function(){return this.gid&536870912},parsePolygon:function(a){this.polygon=new gg;a=a.split(" ");for(var b=0,c=a.length;b<c;){var d=b++,d=a[d].split(","),d=new s(parseFloat(d[0]),parseFloat(d[1]));this.polygon.points.push(d)}},parsePolyline:function(a){this.polyline=new hg;a=a.split(" ");for(var b=0,c=a.length;b<c;){var d=b++,d=a[d].split(","),
d=new s(parseFloat(d[0]),parseFloat(d[1]));this.polyline.points.push(d)}},getBoolProperty:function(a,b){null==b&&(b=!1);var c=this.properties;return(null!=N[a]?c.existsReserved(a):c.h.hasOwnProperty(a))?(c=this.properties,"true"==(null!=N[a]?c.getReserved(a):c.h[a])):b},__class__:fg};var ig=function(){this.visible=!0;this.width=this.height=0;this.name="";this.objects=[]};ig.__name__=["engine","tmx","TmxObjectGroup"];ig.prototype={__class__:ig};var gg=function(){this.points=[]};gg.__name__=["engine",
"tmx","TmxPolygon"];gg.prototype={__class__:gg};var hg=function(){this.points=[]};hg.__name__=["engine","tmx","TmxPolyline"];hg.prototype={__class__:hg};var Ce=function(){};Ce.__name__=["engine","tmx","TmxReader"];Ce.getMapFromXmlString=function(a){var b=new eg;a=A.parse(a).elementsNamed("map").next();b.tileWidth=parseFloat(a.get("tilewidth"));b.tileHeight=parseFloat(a.get("tileheight"));b.width=parseFloat(a.get("width"));b.height=parseFloat(a.get("height"));b.orientation=a.get("orientation");for(var c=
a.elementsNamed("properties");c.hasNext();)for(var d=c.next().elementsNamed("property");d.hasNext();){var e=d.next(),f=b.properties,g=e.get("name"),e=e.get("value");null!=N[g]?f.setReserved(g,e):f.h[g]=e}for(c=a.elementsNamed("tileset");c.hasNext();)g=c.next(),d=new jg,d.firstgid=ga.parseInt(g.get("firstgid")),d.source=g.get("source"),d.name=g.get("name"),d.tileWidth=ga.parseInt(g.get("tilewidth")),d.tileHeight=ga.parseInt(g.get("tileheight")),b.tilesets.push(d),g.elementsNamed("image").hasNext()&&
(g=g.elementsNamed("image").next(),e=new td,e.width=ga.parseInt(g.get("width")),e.height=ga.parseInt(g.get("height")),e.source=g.get("source"),e.trans=g.get("trans"),d.images.push(e));for(c=a.elementsNamed("layer");c.hasNext();){g=c.next();d=new cg;d.name=g.get("name");d.width=parseFloat(g.get("width"));d.height=parseFloat(g.get("height"));if(g.elementsNamed("data").hasNext()){e=g.elementsNamed("data").next();if(e.nodeType!=A.Document&&e.nodeType!=A.Element)throw new H("Bad node type, expected Element or Document but found "+
e.nodeType);e=e.children[0];if(e.nodeType==A.Document||e.nodeType==A.Element)throw new H("Bad node type, unexpected "+e.nodeType);e=e.nodeValue}else e=null;d.data=e;d.decompressData();b.layers.push(d);if(g.elementsNamed("properties").hasNext())for(g=g.elementsNamed("properties").next().elementsNamed("property");g.hasNext();){var f=g.next(),k=d.properties,e=f.get("name"),f=f.get("value");null!=N[e]?k.setReserved(e,f):k.h[e]=f}}for(c=a.elementsNamed("objectgroup");c.hasNext();){g=c.next();d=new ig;
d.width=parseFloat(g.get("width"));d.height=parseFloat(g.get("height"));d.visible=1==ga.parseInt(g.get("visible"));d.name=g.get("name");for(g=g.elementsNamed("object");g.hasNext();)if(f=g.next(),e=new fg,e.name=f.get("name"),e.width=parseFloat(f.get("width")),e.height=parseFloat(f.get("height")),e.x=parseFloat(f.get("x")),e.y=parseFloat(f.get("y")),e.type=f.get("type"),e.gid=ga.parseInt(f.get("gid")),f.exists("rotation")&&(e.rotation=parseFloat(f.get("rotation"))),d.objects.push(e),f.elementsNamed("polygon").hasNext()&&
e.parsePolygon(f.elementsNamed("polygon").next().get("points")),f.elementsNamed("polyline").hasNext()&&e.parsePolyline(f.elementsNamed("polyline").next().get("points")),f.elementsNamed("properties").hasNext())for(f=f.elementsNamed("properties").next().elementsNamed("property");f.hasNext();){var h=f.next(),l=e.properties,k=h.get("name"),h=h.get("value");null!=N[k]?l.setReserved(k,h):l.h[k]=h}b.objectGroups.push(d)}for(a=a.elementsNamed("imagelayer");a.hasNext();)if(d=a.next(),!d.exists("visible")||
"0"!=d.get("visible")){c=new bg;c.name=d.get("name");c.width=ga.parseInt("width");c.height=ga.parseInt("height");g=new td;c.image=g;g.source=d.elementsNamed("image").next().get("source");if(d.elementsNamed("properties").hasNext())for(d=d.elementsNamed("properties").next().elementsNamed("property");d.hasNext();)e=d.next(),f=c.properties,g=e.get("name"),e=e.get("value"),null!=N[g]?f.setReserved(g,e):f.h[g]=e;b.imageLayers.push(c)}return b};Ce.prototype={__class__:Ce};var jg=function(){this.name="";
this.tileWidth=this.tileHeight=0;this.source="";this.firstgid=0;this.images=[];this.tiles=[]};jg.__name__=["engine","tmx","TmxTileset"];jg.prototype={__class__:jg};var De=function(a){m.call(this,a)};De.__name__=["engine","ui","KeepUiPanelCentered"];De.__super__=m;De.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._uiPanel=this.getEntity().getComponent(Kc)},update:function(){m.prototype.update.call(this);if(p.isMobile()){ia.getInstance().getRenderer();ia.getInstance().getRenderer();
var a=p.getInstance().getGameSize();this.getEntity().setPosition(0.5*a.x,0.5*a.y)}else a=p.getInstance().getGameSize(),this.getEntity().setPosition(a.x/2,a.y/2)},__class__:De});var rc=function(a,b){m.call(this,a);this._size=b};rc.__name__=["engine","ui","ScaleBackgroundToWindow"];rc.__super__=m;rc.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);if(null==this._size){var a=this.getComponent(B);this._size=null!=a?new s(a.getSprite().texture.baseTexture.width,a.getSprite().texture.baseTexture.height):
new s}this._uiElement=this.getComponent(X)},update:function(){m.prototype.update.call(this);var a=new s(ia.getInstance().getStage().scale.x,ia.getInstance().getStage().scale.y),b=ia.getInstance().getRenderer().view.width/this._size.x,c=ia.getInstance().getRenderer().view.height/this._size.y,b=Math.max(b,c),b=b/a.x;null!=this._uiElement?this._uiElement.setScale(b,b):this.getEntity().setScale(b,b)},__class__:rc});var kb={__ename__:!0,__constructs__:["Left","Center","Right"],Left:["Left",0]};kb.Left.__enum__=
kb;kb.Center=["Center",1];kb.Center.__enum__=kb;kb.Right=["Right",2];kb.Right.__enum__=kb;kb.__empty_constructs__=[kb.Left,kb.Center,kb.Right];var lb={__ename__:!0,__constructs__:["Top","Center","Bottom"],Top:["Top",0]};lb.Top.__enum__=lb;lb.Center=["Center",1];lb.Center.__enum__=lb;lb.Bottom=["Bottom",2];lb.Bottom.__enum__=lb;lb.__empty_constructs__=[lb.Top,lb.Center,lb.Bottom];var X=function(a,b){this._updateEveryFrame=!0;this._positionDirty=this._pixelPerfect=!1;this._uiPanel=this._coords=this._size=
this._scale=null;m.call(this,a);this.setUiPanel(b);this._coords=new s(0,0);this._scale=new s(1,1)};X.__name__=["engine","ui","UiElement"];X.__super__=m;X.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);if(null==this._size){var a=this.getComponent(B);null!=a?this.setSize(new s(a.getSprite().width,a.getSprite().height)):this.setSize(new s(0,0))}this.updateDisplay()},getScaleRef:function(){return this._scale},getSize:function(){return this._size},getPixelPerfect:function(){return this._pixelPerfect},
setPixelPerfect:function(a){this._pixelPerfect=a},setSize:function(a){null==this._size&&(this._size=new s);this._size.x=a.x;this._size.y=a.y},getUiPanel:function(){return this._uiPanel},setScale:function(a,b){null==b&&(b=1);null==a&&(a=1);this._scale=new s(a,b);this.updateDisplay()},setUiPanel:function(a){null!=this._uiPanel&&this._uiPanel.removeEventListener("updateDisplay",w(this,this.onUiPanelUpdateDisplay));this._uiPanel=a;this._uiPanel.addEventListener("updateDisplay",w(this,this.onUiPanelUpdateDisplay));
this._uiPanel.getEntity().addChild(this.getEntity())},getCoords:function(){return this._coords},getCoordsRef:function(){return this._coords},setCoords:function(a){this._coords=a},update:function(){m.prototype.update.call(this)},postUpdate:function(){m.prototype.postUpdate.call(this);(this._positionDirty||this._updateEveryFrame)&&this.updateDisplay()},onUiPanelUpdateDisplay:function(){this._positionDirty=!0},updateDisplay:function(){x.getWindow();this._uiPanel.getSize();p.getInstance().getGameSize();
this._uiPanel.getSize();p.getInstance().getGameSize();var a=this._uiPanel.getSize().x/2*this._coords.x,b=this._uiPanel.getSize().y/2*this._coords.y;this._pixelPerfect?this.getEntity().setLocalScale(this._scale.x,this._scale.y):this.getEntity().setLocalScale(this._scale.x/this._uiPanel.getEntity().getScale().x,this._scale.y/this._uiPanel.getEntity().getScale().y);this.getEntity().setLocalPosition(a/ia.getInstance().getStage().scale.x,b/ia.getInstance().getStage().scale.y,0);this._positionDirty=!1},
debugRender:function(){m.prototype.debugRender.call(this);if(null!=this._size){var a=p.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();var b=this.getEntity().getPosition();a.beginPath();a.lineWidth=1;a.strokeStyle="#0000FF";a.moveTo(b.x-this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y-this._size.y/2);a.stroke();
a.restore()}},__class__:X});var Kc=function(a,b){m.call(this,a);this._size=b;this._window=x.getWindow()};Kc.__name__=["engine","ui","UiPanel"];Kc.__super__=m;Kc.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this.setSize(this._size)},getSize:function(){return this._size},setSize:function(a){this._size=a;this.updateDisplay()},updateDisplay:function(){this.dispatchEvent(new ud("updateDisplay"))},debugRender:function(){m.prototype.debugRender.call(this);var a=p.getInstance().getLayerByName("debug").getCanvas().getContext("2d");
a.save();var b=this.getEntity().getPosition();a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(b.x-this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y-this._size.y/2);a.stroke();a.restore()},__class__:Kc});var ud=function(a){this._type=a};ud.__name__=["engine","ui","UiPanelEvent"];ud.__super__=L;ud.prototype=r(L.prototype,{__class__:ud});
var Ee=function(a,b){this._prevWidth=this._prevHeight=0;this._uiPanel=this._window=null;m.call(this,a);this._uiPanel=b;this._window=x.getWindow()};Ee.__name__=["engine","ui","UiPanelSizeToWindow"];Ee.__super__=m;Ee.prototype=r(m.prototype,{update:function(){m.prototype.update.call(this);var a=ia.getInstance().getRenderer().width,b=ia.getInstance().getRenderer().height;this._uiPanel.setSize(new s(a,b));this.getEntity().setLocalPosition(0.5*a,0.5*b,0);this._prevWidth=a;this._prevHeight=b},__class__:Ee});
var tb=function(){};tb.__name__=["engine","utilities","ArrayUtils"];tb.indexOf=function(a,b){for(var c=0,d=a.length;c<d;){var e=c++;if(a[e]==b)return e}return-1};tb.clear=function(a){a.length=0};tb.prototype={__class__:tb};var Da=function(){};Da.__name__=["engine","utilities","Debug"];Da.log=function(a){};Da.alert=function(a){};var S=function(){};S.__name__=["engine","utilities","Math2"];S.lerp=function(a,b,c){return a+(b-a)*c};S.degToRad=function(a){return 0.0174532925*a};S.radToDeg=function(a){return 57.2957795*
a};S.randomFloat=function(a,b){return a+Math.random()*(b-a)};S.randomInt=function(a,b){return Math.floor(S.randomFloat(a,b))};S.getClosestPointOnSegment=function(a,b,c){b=new s(b.x-a.x,b.y-a.y);c=(new s(c.x-a.x,c.y-a.y)).dotProduct(b)/b.dotProduct(b);0>c&&(c=0);1<c&&(c=1);c=new s(b.x*c,b.y*c);return new s(a.x+c.x,a.y+c.y)};S.lineIntersect2D=function(a,b,c,d,e){var f=(b.x-a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x),g=(b.x-a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x);if(0==f||0==g)return-2;d=((a.y-c.y)*(d.x-c.x)-(a.x-
c.x)*(d.y-c.y))/f;c=((a.y-c.y)*(b.x-a.x)-(a.x-c.x)*(b.y-a.y))/g;return 0<d&&1>d&&0<c&&1>c?(c=(new s(a.x-b.x,a.y-b.y)).getLength()*d,b=new s(b.x-a.x,b.y-a.y),b.scaleBy(d,d),b=new s(a.x+b.x,a.y+b.y),e.x=b.x,e.y=b.y,c):-1};S.clamp=function(a,b,c){return a<b?b:a>c?c:a};S.getRotated2dVector=function(a,b){var c=S.degToRad(b),d=Math.cos(c),c=Math.sin(c),e=new s(a.x,a.y),f=e.x*c+e.y*d;e.x=e.x*d-e.y*c;e.y=f;return e};S.getAngleInDegreesBetween2dVectors=function(a,b){return S.radToDeg(Math.atan2(a.x*b.y-a.y*
b.x,a.dotProduct(b)))};var ld=function(a){this._value=null;this._eventListeners=[];this._value=a};ld.__name__=["engine","utilities","WatchableValue"];ld.__super__=ua;ld.prototype=r(ua.prototype,{set:function(a){var b=this._value;this._value=a;this._value!=b&&this.dispatchEvent(new vd("change",this._value,b))},get:function(){return this._value},__class__:ld});var vd=function(a,b,c){this._type=a;this.value=b;this.oldValue=c};vd.__name__=["engine","utilities","WatchableValueEvent"];vd.__super__=L;vd.prototype=
r(L.prototype,{__class__:vd});var Lc=function(){this._entries=null;this._entries=[]};Lc.__name__=["engine","weightedVector","WeightedArray"];Lc.prototype={get_numChoices:function(){return this._entries.length},addEntry:function(a,b){var c=new kg(a,b);this._entries.push(c);return c},getRandomValue:function(a){null==a&&(a=!1);for(var b=0,c=this._entries.length,d=0;d<c;)var e=d++,b=b+this._entries[e].weight;b=S.randomFloat(0,b);for(e=d=0;e<c;){var f=e++,g=this._entries[f],d=d+g.weight;if(d>=b)return a&&
this._entries.splice(f,1),g.value}return null},clear:function(){this._entries=[]},__class__:Lc,__properties__:{get_numChoices:"get_numChoices"}};var kg=function(a,b){this.weight=a;this.value=b};kg.__name__=["engine","weightedVector","WeightedArrayEntry"];kg.prototype={__class__:kg};var wd=function(){};wd.__name__=["game","EntityFactory"];wd.createCamera=function(a,b,c,d){d=d.addEntity();d.setLocalPosition(a,b,c);a=new ha(d);new lc(d,0.1);a.setZoomScale(1);a.setOffset(new s(0,-125));new ta(d);return d};
wd.createHud=function(a,b){var c=a.addEntity();new xd(c,b);return c};wd.prototype={__class__:wd};var eb=function(a,b){La.call(this,a,b)};eb.__name__=["game","FadeTransition"];eb.doTransition=function(a,b){var c=new eb(a,b);p.getInstance().addGameState(c)};eb.doMidpointTransition=function(a,b,c){a=new eb(a,b);a.addEventListener("midpoint",c);p.getInstance().addGameState(a)};eb.__super__=La;eb.prototype=r(La.prototype,{init:function(){var a=this;La.prototype.init.call(this);ma.getInstance().setInputDisabled(!0);
var b=this.addEntity();b.setLocalPosition(512,384,0);this._pixiSprite=new B(b,"blackSquare");this._pixiSprite.getSprite().anchor.x=0.5;this._pixiSprite.getSprite().anchor.y=0.5;b.setLocalScale(200,200,1);this._tweener=new ta(b);this._tweener.addTween(this._pixiSprite.getSprite(),"alpha",0,1,0.2,E.linear,0,function(){a.onTransitionMidpoint()});this._tweener.addTween(this._pixiSprite.getSprite(),"alpha",1,0,0.2,E.linear,0.25,function(){a.onTransitionComplete()})},render:function(){La.prototype.render.call(this);
null!=this._pixiSprite&&this._pixiSprite.bringToFront()},update:function(){La.prototype.update.call(this);F.remove(p.getInstance().getGameStates(),this);p.getInstance().getGameStates().push(this)},onTransitionMidpoint:function(){La.prototype.onTransitionMidpoint.call(this);ma.getInstance().setInputDisabled(!1)},__class__:eb});var lg=function(){this.alwaysPlayTutorials=this.skipIntro=this.skipDrivingTutorial=this.instantDrivingGameOver=!1};lg.__name__=["game","FlowConfig"];lg.prototype={__class__:lg};
var ng=function(){this.isFirstPlayThisSession=!0;this.flowConfig=new lg;this._scoreController=new mg};ng.__name__=["game","GameController"];ng.prototype={get_isTutorialComplete:function(){return Y.getInstance().isTutorialComplete()},set_isTutorialComplete:function(a){Y.getInstance().setTutorialComplete(a);return a},get_isSortingTutorialComplete:function(){return Y.getInstance().isSortingTutorialComplete()},set_isSortingTutorialComplete:function(a){Y.getInstance().setSortingTutorialComplete(a);return a},
get_scoreController:function(){return this._scoreController},__class__:ng,__properties__:{get_scoreController:"get_scoreController",set_isSortingTutorialComplete:"set_isSortingTutorialComplete",get_isSortingTutorialComplete:"get_isSortingTutorialComplete",set_isTutorialComplete:"set_isTutorialComplete",get_isTutorialComplete:"get_isTutorialComplete"}};var Y=function(){this._isTutorialComplete=!1;this._currentLevelNumber=1;this._eventListeners=[];Y._instance=this;this._saveData=new Tf};Y.__name__=
["game","GameTracker"];Y.getInstance=function(){null==Y._instance&&(Y._instance=new Y);return Y._instance};Y.getScoreSaveKeyForLevel=function(a){return"levelScore"+(null==a?"null":""+a)};Y.__super__=ua;Y.prototype=r(ua.prototype,{getSaveData:function(){return this._saveData},getNumLevels:function(){return ga.parseInt(R.getProperty("numLevels"))},getNumLevelsUnlocked:function(){return this.getSaveData().getItem("numLevelsUnlocked",1)},setNumLevelsUnlocked:function(a){this.getSaveData().setItem("numLevelsUnlocked",
Math.min(this.getNumLevels(),Math.max(a,this.getNumLevelsUnlocked())))},setScoreForLevel:function(a,b){a>this.getScoreForLevel(b)&&this.getSaveData().setItem(Y.getScoreSaveKeyForLevel(b),a)},getScoreForLevel:function(a){return this.getSaveData().getItem(Y.getScoreSaveKeyForLevel(a),0)},setScoreForCurrentLevel:function(a){this.setScoreForLevel(a,this._currentLevelNumber)},setCurrentLevelNumber:function(a){this._currentLevelNumber=a},getCurrentLevelNumber:function(){return this._currentLevelNumber},
getHasBeatenGame:function(){return this.getSaveData().getItem("hasBeatenGame",!1)},setHasBeatenGame:function(a){this.getSaveData().setItem("hasBeatenGame",a)},getHasStartedGame:function(){return this.getSaveData().getItem("hasStartedGame",!1)},setHasStartedGame:function(a){this.getSaveData().setItem("hasStartedGame",a)},getHighScore:function(){return this.getSaveData().getItem("highScore",0)},setHighScore:function(a){a<=this.getHighScore()||this.getSaveData().setItem("highScore",a)},isTutorialComplete:function(){return this._isTutorialComplete},
setTutorialComplete:function(a){this._isTutorialComplete=a},isSortingTutorialComplete:function(){return this.getSaveData().getItem("isSortingTutorialComplete",!1)},setSortingTutorialComplete:function(a){this.getSaveData().setItem("isSortingTutorialComplete",a)},__class__:Y});var Ma=function(a,b,c){null==c&&(c=!0);La.call(this,a,b,c);this._uiPanel=Ea.createFullscreenUiPanel(this);this._pixiContainer=this._uiPanel.getComponent(la)};Ma.__name__=["game","WhooshTransition"];Ma.doTransition=function(a,
b){var c=new Ma(a,b);p.getInstance().addGameState(c)};Ma.doMidpointTransition=function(a,b,c){a=new Ma(a,b);a.addEventListener("midpoint",c);p.getInstance().addGameState(a)};Ma.__super__=La;Ma.prototype=r(La.prototype,{init:function(){var a=this;La.prototype.init.call(this);this._background=this.addEntity();new rc(this._background,new s(1024,576));this._tweener=new ta(this._uiPanel.getEntity());var b=new X(this._background,this._uiPanel);this._tweener.addTween(b.getCoordsRef(),"x",-2.75,0,0.25,E.linear,
0,function(){a.onTransitionMidpoint()});this._tweener.addTween(b.getCoordsRef(),"x",0,2.75,0.25,E.linear,0.25,function(){a.onTransitionComplete()});b=this.addEntity();(new B(b,"transition")).setAnchor(0.5,0.5);b.setPosition(0,0);b.setScale(-1,1);this._background.addChild(b);n.playSoundByName("sfxTransition1")},render:function(){La.prototype.render.call(this);null!=this._pixiContainer&&(this.bringEntityToFront(this._pixiContainer.getEntity()),this._pixiContainer.bringToFront())},onTransitionMidpoint:function(){La.prototype.onTransitionMidpoint.call(this);
F.remove(p.getInstance().getGameStates(),this);p.getInstance().getGameStates().push(this)},__class__:Ma});var og=function(){};og.__name__=["game","aStar","AStarNode"];og.prototype={__class__:og};var Ra=function(){this._nodes=[]};Ra.__name__=["game","aStar","Pathfinder"];Ra.findPath=function(a,b,c,d){var e=[],f=[],g=b,k,h,l,m;g.g=0;g.h=Ra.heuristic(g,c,1);g.f=g.g+g.h;for(var n=a.length,p;g!=c;){k=d(g);n=k.length;for(p=0;p<n;)a=k[p],a!=g&&a.traversable&&(h=g.g+1,l=Ra.heuristic(a,c,1),m=h+l,-1!=tb.indexOf(e,
a)||-1!=tb.indexOf(f,a)?a.f>m&&(a.f=m,a.g=h,a.h=l,a.parentNode=g):(a.f=m,a.g=h,a.h=l,a.parentNode=g,e.push(a))),++p;f.push(g);if(0==e.length)return null;e.sort(Ra.sortOnF);g=e.shift()}return Ra.buildPath(c,b)};Ra.buildPath=function(a,b){var c=[],d=a;for(c.push(d);d!=b;)d=d.parentNode,c.unshift(d);return c};Ra.diagonalHeuristic=function(a,b,c,d){null==d&&(d=2);null==c&&(c=1);var e=Math.abs(a.x-b.x);a=Math.abs(a.y-b.y);b=Math.min(e,a);return d*b+c*(e+a-2*b)};Ra.manhattanHeuristic=function(a,b,c){null==
c&&(c=1);var d=Math.abs(a.x-b.x);a=Math.abs(a.y-b.y);return d+a*c};Ra.sortOnF=function(a,b){return a.f>b.f?1:a.f<b.f?-1:0};Ra.prototype={__class__:Ra};var Vd=function(){aa.call(this)};Vd.__name__=["game","boot","BootState"];Vd.__super__=aa;Vd.prototype=r(aa.prototype,{init:function(){aa.prototype.init.call(this);this._root=p.getInstance();var a=new cb;this._root.addManager(a);a=new ma;this._root.addManager(a);var b=new ub;this._root.addManager(b);b=new pc;this._root.addManager(b);b=new Qb;this._root.addManager(b);
a.disablePageKeyPresses();this.initLayers();this.getAssetsList()},getAssetsList:function(){var a=new Pb;a.addAsset("assetList","asset_list.js",T.Other);a.addAsset("strings","./locale/${locale}/strings.xml",T.Other);a.addAsset("globalGameConfig","game_config.js",T.Other);a.addAsset("gameConfig","./locale/${locale}/game_config.js",T.Other);a.addAsset("styleCss","./locale/${locale}/css/style.css",T.Css);a.addAsset("speechMap","./media/xml/speech_map.xml",T.Other);a.addAsset("ipadOrientationImage","./media/images/system/orientation_ipad.png",
T.Image);a.addAsset("iphoneOrientationImage","./media/images/system/orientation_iphone.png",T.Image);a.load(w(this,this.onAssetListLoaded))},onAssetListLoaded:function(){R.parseGameConfig(JSON.parse(I.getAsset("globalGameConfig")));R.parseGameConfig(JSON.parse(I.getAsset("gameConfig")));p.getInstance().setGameWidth(R.getProperty("gameWidth",1024));p.getInstance().setGameHeight(R.getProperty("gameHeight",768));oa.initStrings();Qb.getInstance().setup();if(p.isMobile()||"NONE"!=R.getProperty("forceOrientation")){var a=
new Fe;this._root.addGameState(a);p.getInstance().onOrientationChange()}for(var a=JSON.parse(I.getAsset("assetList")),b=0,c=a.loadBatches.length;b<c;){for(var d=b++,e=new Pb,d=a.loadBatches[d],f=0,g=d.assets.length;f<g;){var k=f++,k=d.assets[k],h=k.source.split("."),l=T.Other;switch(h[h.length-1]){case "css":l=T.Css;break;case "eot":case "ttf":case "woff":l=T.Font;break;case "jpeg":case "jpg":case "png":l=T.Image;break;case "js":l=T.Other;break;case "mp3":case "wav":l=T.Audio}e.addAsset(k.name,k.source,
l)}I.registerAsset(d.name,e)}I.getAsset("loadScreenBatchPreload").load(w(this,this.onLoadScreenPreloadComplete))},onLoadScreenPreloadComplete:function(){ia.getInstance().setup({backgroundColor:0});ia.getInstance().scaleHeightToWidth=R.getProperty("scaleHeightToWidth");this._loadingScreen=new yd;this._root.addGameState(this._loadingScreen);this._root.onResizeWindow();I.getAsset("loadBatchPreload").load(w(this,this.onPreloadComplete))},onPreloadComplete:function(){this.destroy();var a=new ng;Ma.doTransition(this._loadingScreen,
new Rb(a))},initLayers:function(){this._root.addLayer(new Bb("debug",p.getInstance().getGameWidth()|0,p.getInstance().getGameHeight()|0))},__class__:Vd});var Sb=function(){this._eventListeners=[]};Sb.__name__=["game","commands","Command"];Sb.__super__=ua;Sb.prototype=r(ua.prototype,{execute:function(){},onComplete:function(){this.dispatchEvent(new zd("complete"))},__class__:Sb});var zd=function(a){this._type="complete"};zd.__name__=["game","commands","CommandEvent"];zd.__super__=L;zd.prototype=r(L.prototype,
{__class__:zd});var Mc=function(){this._shouldTrace=!1;this._eventListeners=[];this._sequence=[];this._commandsLeft=[]};Mc.__name__=["game","commands","CommandSequence"];Mc.__super__=ua;Mc.prototype=r(ua.prototype,{clear:function(){for(var a=0,b=this._commandsLeft.length;a<b;){var c=a++;this._commandsLeft[c].removeEventListener("complete",w(this,this.onCommandComplete))}this._commandsLeft=[];this._sequence=[]},addParallel:function(a){this._sequence.push(a)},addSequential:function(a){for(var b=0,c=
a.length;b<c;){var d=b++;this.addCommand(a[d])}},addCommand:function(a){this._sequence.push([a])},execute:function(){this._shouldTrace&&console.log(this._sequence);0<this._commandsLeft.length&&(this._shouldTrace&&(console.log("Warning: Previous sequence never finished!"),console.log(this._commandsLeft)),this._commandsLeft=[]);this.executeNextSequence()},executeNextSequence:function(){this._shouldTrace&&console.log("Executing Sequence...");if(0<this._sequence.length){var a=this._sequence[0];this._sequence.splice(0,
1);this.executeSequence(a)}else this.dispatchEvent(new Ad("complete")),this._shouldTrace&&console.log("Sequence Complete.")},executeSequence:function(a){for(var b=0,c=a.length;b<c;){var d=b++,d=a[d];this._commandsLeft.push(d);d.addEventListener("complete",w(this,this.onCommandComplete))}if(0==this._commandsLeft.length)this.executeNextSequence();else for(a=[].concat(this._commandsLeft),b=0;b<a.length;)c=a[b],++b,this._shouldTrace&&console.log("Executing: "+hb.getClassName(null==c?null:y.getClass(c))),
c.execute()},onCommandComplete:function(a){a=a.target;this._shouldTrace&&console.log("Command Complete: "+hb.getClassName(null==a?null:y.getClass(a)));a.removeEventListener("complete",w(this,this.onCommandComplete));F.remove(this._commandsLeft,a);if(0==this._commandsLeft.length)this.onSequenceComplete()},onSequenceComplete:function(){this._shouldTrace&&console.log("onSequenceComplete()");this.executeNextSequence()},__class__:Mc});var Ad=function(a){this._type=a};Ad.__name__=["game","commands","CommandSequenceEvent"];
Ad.__super__=L;Ad.prototype=r(L.prototype,{__class__:Ad});var Nc=function(a,b){this._eventListeners=[];this._duration=b;this._deferredActionController=a};Nc.__name__=["game","commands","DelayCommand"];Nc.__super__=Sb;Nc.prototype=r(Sb.prototype,{execute:function(){Sb.prototype.execute.call(this);this._deferredActionController.addDeferredAction(this._duration,w(this,this.onDelayElapse))},onDelayElapse:function(){this.onComplete()},__class__:Nc});var Ge=function(a){this._fruitCollected=this.fruitToCollect=
0;this._eventListeners=[];this._maze=a;this._maze.addEventListener("collect",w(this,this.onCollectItem))};Ge.__name__=["game","froggerGame","FruitController"];Ge.__super__=ua;Ge.prototype=r(ua.prototype,{get_allFruitCollected:function(){return this.get_fruitCollected()>=this.fruitToCollect},get_fruitCollected:function(){return this._fruitCollected},onCollectItem:function(a){if(y.__instanceof(a.collectible,Oc))this.onCollectFruit(a.collectible)},onCollectFruit:function(a){this._fruitCollected++;this.get_allFruitCollected()&&
this.dispatchEvent(new Pc("allFruitCollected"))},reset:function(){this._fruitCollected=0},__class__:Ge,__properties__:{get_fruitCollected:"get_fruitCollected",get_allFruitCollected:"get_allFruitCollected"}});var Pc=function(a){this._type=a};Pc.__name__=["game","froggerGame","FruitControllerEvent"];Pc.__super__=L;Pc.prototype=r(L.prototype,{__class__:Pc});var pg=function(a,b,c){this._levelNum=1;this._loadingScreen=null;this._levelNum=c;this._fromGameState=b;this._gameController=a};pg.__name__=["game",
"froggerGame","LevelLoader"];pg.prototype={loadLevel:function(){var a=I.getAsset("gameplayLoad");Y.getInstance().setCurrentLevelNumber(this._levelNum);this._loadingScreen=new yd;eb.doTransition(this._fromGameState,this._loadingScreen);var b="level"+Y.getInstance().getCurrentLevelNumber()+"Load";a.concatLoadBatch(I.getAsset(b));a.load(w(this,this.onLevelLoadComplete))},onLevelLoadComplete:function(){var a=new Qc(this._gameController);Ma.doTransition(this._loadingScreen,a)},__class__:pg};var He=function(){this.numWaitingLives=
0;this._numLives=1;this._eventListeners=[]};He.__name__=["game","froggerGame","LivesController"];He.__super__=ua;He.prototype=r(ua.prototype,{get_isOutOfLives:function(){return 0>=this.get_numLives()},get_numLives:function(){return this._numLives},set_numLives:function(a){this._numLives=a;if(0>=this._numLives)this.onDepleteAllLives();return this._numLives},onDepleteAllLives:function(){this.dispatchEvent(new Bd("outOfLives"))},__class__:He,__properties__:{set_numLives:"set_numLives",get_numLives:"get_numLives",
get_isOutOfLives:"get_isOutOfLives"}});var Bd=function(a){this._type=a};Bd.__name__=["game","froggerGame","LivesControllerEvent"];Bd.__super__=L;Bd.prototype=r(L.prototype,{__class__:Bd});var Rc=function(a,b,c){this.overridePlayerStart=!1;this._currentRound=1;this._fruitBlockers=[];this._villains=[];this._startPosition=new s(8,3);m.call(this,a);new la(this.getEntity());this._gameController=b;this._level=c;this._fruitController=new Ge(this);this._livesController=new He;this._snackController=new Ie(this);
this._livesController.addEventListener("outOfLives",w(this,this.onOutOfLives));this._mazeGameUiFactory=new qg(this)};Rc.__name__=["game","froggerGame","MazeGameController"];Rc.__super__=m;Rc.prototype=r(m.prototype,{get_hud:function(){return this._hud},get_currentRound:function(){return this._currentRound},get_player:function(){return this._player},get_mazeGameConfig:function(){return this._mazeGameConfig},get_livesController:function(){return this._livesController},init:function(){m.prototype.init.call(this);
this._scoreController=this._gameController.get_scoreController();this._scoreController.reset();this.initMazeFactory();this.initMaze();this.initHud();this._fruitController.addEventListener("allFruitCollected",w(this,this.onCollectAllFruit));this._deferredAction=new Va(this.getEntity());this._camera.jumpToTarget();this._deferredAction.addDeferredAction(0.35,w(this,this.onStartGameplayDelayElapse));this.disablePlayerInput()},onStartGameplayDelayElapse:function(){this.checkStartGameplay()},checkStartGameplay:function(){var a=
Y.getInstance();a.isTutorialComplete()?this.startGameplay():(this.checkTutorial(),a.setTutorialComplete(!0))},checkTutorial:function(){var a=this;Sc.show(this.getGameState(),this);this._deferredAction.addDeferredAction(0.1,function(){a.getGameState().pause()})},startGameplay:function(){if(!(0>=this._livesController.get_numLives())){var a=new Mc;a.addCommand(new Je(this));a.addCommand(new Nc(this._deferredAction,0.75));a.addCommand(new Ke(this));a.addCommand(new Le(this));a.addCommand(new Tc(this,
!0));a.execute()}},addScore:function(a){this._player.isDoubleScoreActive&&(a*=2);var b=this._scoreController.get_score(),c=this._scoreController;c.set_score(c.get_score()+a);if(this.get_mazeGameConfig().canEarnExtraLives&&(a=Math.floor(b/this.get_mazeGameConfig().extraLifePoints),a=Math.floor(this._scoreController.get_score()/this.get_mazeGameConfig().extraLifePoints)-a,0<a))this.onGainLives(a)},onGainLives:function(a){var b=this._livesController;b.set_numLives(b.get_numLives()+a);a=this.get_hud().get_uiPanel().getEntity().findChildByName("livesTarget");
this._mazeGameUiFactory.createExtraLifeUi(this._player.getEntity(),a)},initHud:function(){this._hud=wd.createHud(this.getGameState(),this).getComponent(xd);this._hud.fruitController=this._fruitController;this._hud.livesController=this._livesController;this._hud.snackController=this._snackController;this._hud.scoreController=this._scoreController;this._hud.addEventListener(Tb.SHOW_MENU,w(this,this.showPauseMenu))},showPauseMenu:function(){this.getGameState().pause();Uc.show(this.getGameState(),this._gameController)},
initMazeFactory:function(){this._mazeGameConfig=new rg;var a=new fb;a.maxEnemies=1;this._mazeGameConfig.roundConfigs.push(a);a=new fb;a.maxEnemies=2;this._mazeGameConfig.roundConfigs.push(a);a=new fb;a.maxEnemies=3;this._mazeGameConfig.roundConfigs.push(a);a=new fb;a.maxEnemies=3;a.speedModifier=0.05;this._mazeGameConfig.roundConfigs.push(a);a=new fb;a.maxEnemies=3;a.speedModifier=0.1;this._mazeGameConfig.roundConfigs.push(a);a=new fb;a.maxEnemies=3;a.speedModifier=0.15;this._mazeGameConfig.roundConfigs.push(a);
a=new fb;a.maxEnemies=3;a.speedModifier=0.2;this._mazeGameConfig.roundConfigs.push(a);a=new fb;a.maxEnemies=3;a.speedModifier=0.25;this._mazeGameConfig.roundConfigs.push(a);a=new fb;a.maxEnemies=3;a.speedModifier=0.3;this._mazeGameConfig.roundConfigs.push(a);a=new fb;a.maxEnemies=3;a.speedModifier=0.35;this._mazeGameConfig.roundConfigs.push(a);this._mazeFactory=new sg(this.getEntity(),this._mazeGameConfig)},processDesignerConfig:function(){var a=this._designerConfigReader.getCurrentMilestoneConfig();
this._froggerMazeConfig.levelScrollSpeed=a.scrollSpeed;null!=this._scrollingCameraController&&(this._scrollingCameraController.scrollSpeed=this._froggerMazeConfig.levelScrollSpeed)},initMaze:function(){this._tmxMap=this._mazeFactory.getRandomMazeTmxMap();this._designerConfig=new tg;this._designerConfig.parse(JSON.parse(I.getAsset("designerConfig")));this._designerConfigReader=new Me(this.getEntity(),this._designerConfig,this._scoreController);var a=JSON.parse(I.getAsset("froggerMazeConfig"));this._froggerMazeConfig=
new ug;this._froggerMazeConfig.parse(a);this.processDesignerConfig();this._maze=this._mazeFactory.generateFroggerMaze(this._froggerMazeConfig,this,this._designerConfigReader);this._mazeCharacterFactory=new Ne(this._maze,this);this.spawnPlayer();this.glowPlayer();this.spawnCamera(this._player.getEntity());this.processDesignerConfig()},spawnCamera:function(a){a=this.getGameState().addEntity();this._camera=new Ab(a);var b=this.getComponent(la);this._camera.addLayer(b);this._cameraTarget=this.getGameState().addEntity();
this._scrollingCameraController=new Oe(a,this._cameraTarget,this._player);this._scrollingCameraController.setActive(!1);this._scrollingCameraController.scrollSpeed=this._froggerMazeConfig.levelScrollSpeed;new lc(a,0.1);this._camera.setTarget(this._cameraTarget);a.setPosition(this._mazeGameConfig.cameraFollowOffsetX,this._mazeGameConfig.cameraFollowOffsetY);this._cameraTarget.setPosition(0.5*p.getInstance().getGameSize().x,0);this._camera.jumpToTarget()},startScrolling:function(){this._scrollingCameraController.setActive(!0)},
stopScrolling:function(){this._scrollingCameraController.setActive(!1)},glowPlayer:function(){this._player.getEntity().getComponentsInChildren(Cd)[0].glow(2)},addVillain:function(a){this._villains.push(a)},onCollectAllFruit:function(a){a=this._maze.getEntity().getComponentsInChildren(sc);for(var b=0;b<a.length;){var c=a[b];++b;c.isExit&&c.set_isExitActive(!0)}n.playSoundByName("sfx_exit_available")},spawnPlayer:function(){null==this._player&&(this._player=this._mazeCharacterFactory.createScooby(Math.floor(0.5*
this._froggerMazeConfig.width),this._froggerMazeConfig.startRow|0),this._player.addEventListener("respawn",w(this,this.onRespawnPlayer)),this._player.addEventListener("changeTileEnd",w(this,this.onPlayerTileChange)),this._player.addEventListener("collectLostPuppy",w(this,this.onPlayerCollectLostPuppy)),this._player.getEntity().setRotation(0,0,180),this._player.getEntity().getComponentsInChildren(Dd)[0].addEventListener("collect",w(this,this.onCollectItem)),new Pe(this._player.getEntity(),this._maze),
this._prevPlayerCoords=this._player.get_mazeCoords().getClone())},onPlayerCollectLostPuppy:function(a){this._scoreController.addLostPuppiesCollected(1)},onPlayerTileChange:function(a){a=this._player.get_mazeCoords().getClone();if(a.y>this._prevPlayerCoords.y)this.onPlayerMoveForward();this._prevPlayerCoords=a;this.processDesignerConfig()},onPlayerMoveForward:function(){this.addScore(this._mazeGameConfig.moveForwardScore)},onRespawnPlayer:function(a){this._player.getComponent(Vc).removeAllStatusEffects();
n.playSoundByName("sfx_lose_life");a.target==this._player&&this.startGameplay()},destroyFruitAtOverriddenPlayerStart:function(){for(var a=this._maze.getEntity().getComponentsInChildren(Oc),b=0;b<a.length;){var c=a[b];++b;this.overridePlayerStart&&(c.get_mazeCoords().x==this.overridePlayerStartCoords.x&&c.get_mazeCoords().y==this.overridePlayerStartCoords.y)&&(c.getEntity().destroy(),this._fruitController.fruitToCollect--)}},onOutOfLives:function(a){this._livesController.removeEventListener("outOfLives",
w(this,this.onOutOfLives));this.showLevelComplete()},showLevelComplete:function(){this._player.inputEnabled=!1;this._player.getEntity().setVisible(!1);this._hud.getEntity().destroy();this._level.showLevelComplete();Y.getInstance().setHighScore(this._gameController.get_scoreController().get_score())},onVillainHitPlayer:function(){var a=new Mc;a.addCommand(new Qe(this));a.addCommand(new Tc(this,!1));a.addCommand(new Nc(this._deferredAction,0.7));a.addCommand(new Ed(this));a.execute();n.playSoundByName("sfx_caught_1")},
onPlayerFallIntoHole:function(){var a=new Mc;a.addCommand(new Tc(this,!1));a.addCommand(new Nc(this._deferredAction,0.7));a.addCommand(new Ed(this));a.execute()},freezeCharacters:function(){this.get_player().freeze(this,!0);for(var a=0,b=this._villains;a<b.length;){var c=b[a];++a;c.freeze(this,!1)}},startPlayerRespawnSequence:function(){var a=this._livesController,b=a.get_numLives();a.set_numLives(b-1);this.get_livesController().get_isOutOfLives()||this._player.respawn()},onCollectItem:function(a){this.dispatchEvent(a);
y.__instanceof(a.collectible,Oc)?this.addScore(this._mazeGameConfig.collectFruitScore):y.__instanceof(a.collectible,Wc)?this.addScore(this._mazeGameConfig.collectScoobySnackScore):y.__instanceof(a.collectible,Ub)&&this.addScore(this._mazeGameConfig.rescueLostPuppyScore)},disablePlayerDamagersOnVillains:function(){for(var a=0,b=this._villains;a<b.length;){var c=b[a];++a;c.getComponent(Vb).setActive(!1)}},refreshHud:function(){this._hud.getEntity().destroy();this.initHud()},advanceRound:function(){this._fruitController.reset();
this._currentRound++},showReadyGo:function(a){this._mazeGameUiFactory.createReadyGoUi(a)},enablePlayerInput:function(){this._player.inputEnabled=!0},disablePlayerInput:function(){this._player.inputEnabled=!1},__class__:Rc,__properties__:{get_livesController:"get_livesController",get_mazeGameConfig:"get_mazeGameConfig",get_player:"get_player",get_currentRound:"get_currentRound",get_hud:"get_hud"}});var qg=function(a){this._mazeGameController=a};qg.__name__=["game","froggerGame","MazeGameUiFactory"];
qg.prototype={createReadyGoUi:function(a){var b=Ea.createFullscreenUiPanel(this._mazeGameController.getGameState()),c=b.addEntity(),d=c.addEntity();new X(c,b);d=new na(d,oa.getString("GO"),{fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",stroke:"#00CCCC",strokeThickness:20,fontSize:128});c=new Fd(c);c.textField=d;c.addEventListener("destroy",a);return b},createExtraLifeUi:function(a,b){var c=this;this._mazeGameController.get_livesController().numWaitingLives++;var d=this._mazeGameController.getGameState().getSceneRoot().addEntity(),
e=new B(d,"extraLife");e.setAnchor(0.5,0.5);var f=a.getPosition().x,g=a.getPosition().y,k=b.getPosition().x,h=b.getPosition().y;d.setPosition(f,g);var l=new ta(d);l.addTween(d.getScaleRef(),"x",0,1,0.35,E.easeOutBack);l.addTween(d.getScaleRef(),"y",0,1,0.35,E.easeOutBack);l.addTween(d.getPositionRef(),"y",g,g-50,0.35,E.easeOutBack);l.addTween(d.getPositionRef(),"x",f,k,1.5,E.easeInQuint,0.5);l.addTween(d.getPositionRef(),"y",g-50,h,1.5,E.easeInQuint,0.5);l.addTween(d.getScaleRef(),"x",1,1.2,1.5,E.linear,
0.5);l.addTween(d.getScaleRef(),"y",1,1.2,1.5,E.linear,0.5);l.addTween(e.getSprite(),"alpha",1,0,0.1,E.linear,1.9,function(){c._mazeGameController.get_livesController().numWaitingLives--})},__class__:qg};var vg=function(){this.badgeTiers=[0,1,2,3]};vg.__name__=["game","froggerGame","ScoreConfig"];vg.prototype={parse:function(a){this.badgeTiers=a.badgeTiers},__class__:vg};var mg=function(){this._score=this.numLitterCollected=this.numLostPuppiesCollected=0;this._config=new vg;this._config.parse(JSON.parse(I.getAsset("scoreConfig")))};
mg.__name__=["game","froggerGame","ScoreController"];mg.prototype={get_score:function(){return this._score},set_score:function(a){return this._score=a},get_badgeTierIndex:function(){return this.getBadgeIndexFromScore(this.get_score())},get_numBadges:function(){return this._config.badgeTiers.length+1},getBadgeIndexFromScore:function(a){for(var b=this._config.badgeTiers.length,c=0;c<b;){var d=c++;if(a<this._config.badgeTiers[d])return d}return b},getScoreRequiredForBadgeIndex:function(a){return this._config.badgeTiers[a]},
getHighScore:function(){return Y.getInstance().getHighScore()},addLostPuppiesCollected:function(a){this.numLostPuppiesCollected+=a},setHighScore:function(a){Y.getInstance().setHighScore(a)},reset:function(){this.set_score(0);this.numLostPuppiesCollected=0},__class__:mg,__properties__:{get_numBadges:"get_numBadges",get_badgeTierIndex:"get_badgeTierIndex",set_score:"set_score",get_score:"get_score"}};var Oe=function(a,b,c){this.killPlayerDistance=-340;this.maxCameraDistance=-50;this.scrollSpeed=60;
m.call(this,a);this._cameraTarget=b;this._player=c};Oe.__name__=["game","froggerGame","ScrollingCameraController"];Oe.__super__=m;Oe.prototype=r(m.prototype,{get_distanceFromPlayer:function(){return this._cameraTarget.getPosition().y-this._player.getEntity().getPosition().y},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);this.scroll(p.getDeltaTime());this.enforceBaseline();this.enforceKillDistance()},scroll:function(a){var b=this._cameraTarget.getPosition();b.y-=this.scrollSpeed*a;this._cameraTarget.setPosition(b.x,
b.y)},enforceBaseline:function(){if(this.get_distanceFromPlayer()>this.maxCameraDistance){var a=this._player.getEntity().getPosition();a.y+=this.maxCameraDistance;this._cameraTarget.setPosition(this._cameraTarget.getPosition().x,a.y)}},enforceKillDistance:function(){this._player.get_isDead()||this.get_distanceFromPlayer()<this.killPlayerDistance&&this._player.fallToDeath()},__class__:Oe,__properties__:{get_distanceFromPlayer:"get_distanceFromPlayer"}});var Ie=function(a){this._eventListeners=[];this._maze=
a;this._maze.addEventListener("collect",w(this,this.onCollectItem))};Ie.__name__=["game","froggerGame","SnackController"];Ie.__super__=ua;Ie.prototype=r(ua.prototype,{onCollectItem:function(a){y.__instanceof(a.collectible,Wc)&&(this._scoobySnackStatusEffect=a.collectible.scoobySnackStatusEffect)},getTimeLeft:function(){return null==this._scoobySnackStatusEffect?0:this._scoobySnackStatusEffect.timeLeft},getTimeLeftPercentage:function(){return null==this._scoobySnackStatusEffect?0:this._scoobySnackStatusEffect.timeLeft/
this._scoobySnackStatusEffect.duration},__class__:Ie});var pa=function(a){this._eventListeners=[];this._mazeGameController=a};pa.__name__=["game","froggerGame","froggerGameCommands","FroggerGameCommand"];pa.__super__=Sb;pa.prototype=r(Sb.prototype,{__class__:pa});var Je=function(a){pa.call(this,a)};Je.__name__=["game","froggerGame","froggerGameCommands","DisablePlayerInputCommand"];Je.__super__=pa;Je.prototype=r(pa.prototype,{execute:function(){pa.prototype.execute.call(this);this._mazeGameController.disablePlayerInput();
this.onComplete()},__class__:Je});var Le=function(a){pa.call(this,a)};Le.__name__=["game","froggerGame","froggerGameCommands","EnablePlayerInputCommand"];Le.__super__=pa;Le.prototype=r(pa.prototype,{execute:function(){pa.prototype.execute.call(this);this._mazeGameController.enablePlayerInput();this._mazeGameController.startScrolling();this.onComplete()},__class__:Le});var Qe=function(a){pa.call(this,a)};Qe.__name__=["game","froggerGame","froggerGameCommands","FreezeCharactersCommand"];Qe.__super__=
pa;Qe.prototype=r(pa.prototype,{execute:function(){pa.prototype.execute.call(this);this._mazeGameController.freezeCharacters();this.onComplete()},__class__:Qe});var Ed=function(a){pa.call(this,a)};Ed.__name__=["game","froggerGame","froggerGameCommands","RespawnCharactersCommand"];Ed.__super__=pa;Ed.prototype=r(pa.prototype,{execute:function(){pa.prototype.execute.call(this);this._mazeGameController.startPlayerRespawnSequence();this.onComplete()},__class__:Ed});var Tc=function(a,b){pa.call(this,a);
this._scrolling=b};Tc.__name__=["game","froggerGame","froggerGameCommands","SetScrollingCommand"];Tc.__super__=pa;Tc.prototype=r(pa.prototype,{execute:function(){pa.prototype.execute.call(this);this._scrolling?this._mazeGameController.startScrolling():this._mazeGameController.stopScrolling();this.onComplete()},__class__:Tc});var Ke=function(a){pa.call(this,a)};Ke.__name__=["game","froggerGame","froggerGameCommands","ShowReadyGoCommand"];Ke.__super__=pa;Ke.prototype=r(pa.prototype,{execute:function(){pa.prototype.execute.call(this);
this._mazeGameController.showReadyGo(w(this,this.onComplete))},__class__:Ke});var Q={__ename__:!0,__constructs__:["North","South","West","East"],North:["North",0]};Q.North.__enum__=Q;Q.South=["South",1];Q.South.__enum__=Q;Q.West=["West",2];Q.West.__enum__=Q;Q.East=["East",3];Q.East.__enum__=Q;Q.__empty_constructs__=[Q.North,Q.South,Q.West,Q.East];var Me=function(a,b,c){m.call(this,a);this._designerConfig=b;this._scoreController=c};Me.__name__=["game","froggerGame","maze","DesignerConfigReader"];Me.__super__=
m;Me.prototype=r(m.prototype,{get_config:function(){return this._designerConfig},init:function(){m.prototype.init.call(this)},getCurrentMilestoneConfig:function(){for(var a=new Re,b=this._designerConfig.milestones,c=0,d=b.length;c<d;){var e=c++,e=b[e];this._scoreController.get_score()<e.score||(0<=e.caveRowSpawnRatio&&(a.caveRowSpawnRatio=e.caveRowSpawnRatio),0<=e.riverRowSpawnRatio&&(a.riverRowSpawnRatio=e.riverRowSpawnRatio),0<=e.railRowSpawnRatio&&(a.railRowSpawnRatio=e.railRowSpawnRatio),0<=e.scrollSpeed&&
(a.scrollSpeed=e.scrollSpeed),0<=e.rowsPerMinerFortyNiner&&(a.rowsPerMinerFortyNiner=e.rowsPerMinerFortyNiner),0<=e.chanceOfLostPuppy&&(a.chanceOfLostPuppy=e.chanceOfLostPuppy),0<=e.chanceOfScoobySnack&&(a.chanceOfScoobySnack=e.chanceOfScoobySnack),0<=e.cartSpeed&&(a.cartSpeed=e.cartSpeed),0<=e.timePerCartSpawn&&(a.timePerCartSpawn=e.timePerCartSpawn),0<=e.numCartsPerRow&&(a.numCartsPerRow=e.numCartsPerRow),0<=e.raftSpeed&&(a.raftSpeed=e.raftSpeed),0<=e.timePerRaftSpawn&&(a.timePerRaftSpawn=e.timePerRaftSpawn),
0<=e.numRaftsPerRow&&(a.numRaftsPerRow=e.numRaftsPerRow),0<=e.chanceForBoxSpawn&&(a.chanceForBoxSpawn=e.chanceForBoxSpawn),0<=e.chanceForHole&&(a.chanceForHole=e.chanceForHole),0<=e.chanceForCoveredHole&&(a.chanceForCoveredHole=e.chanceForCoveredHole))}return a},getMilestoneConfigForScore:function(a){a=null;for(var b=[],c=b.length,d=this._scoreController.get_score(),e=0;e<c;){var f=e++,f=b[f];if(d>f.score)a=f;else break}return a},__class__:Me,__properties__:{get_config:"get_config"}});var Se=function(){};
Se.__name__=["game","froggerGame","maze","IMaze"];Se.prototype={__class__:Se};var Gd=function(a,b,c){this._numRowsPerSideTile=5;this._tileConfigs=[];this._rows=[];this.currentRowIndex=this._deletedRowIndexOffset=0;this.maxRowsActive=20;this.numInitialRowsToSpawn=10;m.call(this,a);this.mazeGameController=b;this._config=c;this._objectFactory=new Xc(this);this.processTileConfigs()};Gd.__name__=["game","froggerGame","maze","FroggerMaze"];Gd.__interfaces__=[Se];Gd.__super__=m;Gd.prototype=r(m.prototype,
{get_width:function(){return this._config.width},get_numRows:function(){return this._rows.length},processTileConfigs:function(){for(var a=0,b=this._config.tileConfigs.length;a<b;){var c=a++;this._tileConfigs.push(this._config.tileConfigs[c])}},getTileById:function(a){for(var b=0,c=this._tileConfigs;b<c.length;){var d=c[b];++b;if(d.id==a)return d}return null},spawnInitialRows:function(){for(var a=0,b=this.numInitialRowsToSpawn;a<b;)a++,this.addNextRowSection()},addRowSectionConfig:function(a){this._config.rowSectionConfigs.push(a)},
addNextRowSection:function(){null!=this.designConfigReader?this.addRowSectionFromDesignConfig():this.addRandomRowSection()},addRowSectionFromDesignConfig:function(){var a=this.designConfigReader.getCurrentMilestoneConfig(),b=new Lc;b.addEntry(a.caveRowSpawnRatio,Na.Cave);b.addEntry(a.riverRowSpawnRatio,Na.River);b.addEntry(a.railRowSpawnRatio,Na.Rail);var c=this.currentRowIndex<this.designConfigReader.get_config().numSafeRows;if(c)this.addRandomRowSection();else{var b=c?Na.Cave:b.getRandomValue(),
c=[],d=0==this.currentRowIndex%2;if(0==this.currentRowIndex%a.rowsPerMinerFortyNiner&&this.currentRowIndex>=a.rowsPerMinerFortyNiner)c=["minerFortyNiner_right","minerFortyNiner_left"];else switch(b[1]){case 0:c=["dirtRowClear1","dirtRowClearAlternating","dirtRow1","lotsOfBoxesLeft","lotsOfBoxesRight"];break;case 1:c=d?["riverRow1_Right","riverRowWithRocks1"]:["riverRow1_Left","riverRowWithRocks1"];break;case 2:c=d?["railRowWithCart1_Right"]:["railRowWithCart1_Left"]}for(var d=new Lc,e=0,f=this._config.rowSectionConfigs;e<
f.length;){var g=f[e];++e;0<=c.indexOf(g.id)&&d.addEntry(g.chance,g)}c=d.getRandomValue();d=0;for(e=c.rows;d<e.length;)if(f=e[d],++d,b==Na.Cave)for(var g=0,k=f.objectSpawnConfigs;g<k.length;){var h=k[g];++g;if(0<=h.objectTypes.indexOf("lostPuppy")||0<=h.objectTypes.indexOf("scoobySnack"))f.objectSpawnConfigs=[],h=new Wb,h.validColumns=[1,2,3,4,5,6,7,8,9,10,11],h.objectTypes=["lostPuppy"],h.chance=a.chanceOfLostPuppy,f.objectSpawnConfigs.push(h),h=new Wb,h.validColumns=[1,2,3,4,5,6,7,8,9,10,11],h.objectTypes=
["scoobySnack"],h.chance=a.chanceOfScoobySnack,f.objectSpawnConfigs.push(h),h=new Wb,h.validColumns=[1,2,3,4,5,6,7,8,9,10,11],h.objectTypes="barrel1 barrel2 crate1 crate2 rock1 rock2".split(" "),h.chance=a.chanceForBoxSpawn,f.objectSpawnConfigs.push(h),h=new Wb,h.validColumns=[1,2,3,4,5,6,7,8,9,10,11],h.objectTypes=["hole"],h.chance=a.chanceForHole,f.objectSpawnConfigs.push(h),h=new Wb,h.validColumns=[1,2,3,4,5,6,7,8,9,10,11],h.objectTypes=["coveredHole"],h.chance=a.chanceForCoveredHole,f.objectSpawnConfigs.push(h)}else for(g=
0,k=f.objectSpawnConfigs;g<k.length;){h=k[g];++g;if(0<=h.objectTypes.indexOf("waterPlatformSpawner")){var l=5<h.validColumns[0];f.objectSpawnConfigs=[];h.minObjectSpeed=a.raftSpeed*(l?-1:1);h.maxObjectSpeed=a.raftSpeed*(l?-1:1);h.maxObjectsActive=a.numRaftsPerRow;h.minObjectSpawnTime=a.timePerRaftSpawn;h.maxObjectSpawnTime=a.timePerRaftSpawn;h.minIterations=1;h.maxIterations=1;f.objectSpawnConfigs.push(h)}0<=h.objectTypes.indexOf("mineCartSpawner")&&(l=5<h.validColumns[0],f.objectSpawnConfigs=[],
h.minObjectSpeed=a.raftSpeed*(l?-1:1),h.maxObjectSpeed=a.raftSpeed*(l?-1:1),h.maxObjectsActive=a.numCartsPerRow,h.minObjectSpawnTime=a.timePerCartSpawn,h.maxObjectSpawnTime=a.timePerCartSpawn,h.minIterations=1,h.maxIterations=1,f.objectSpawnConfigs.push(h))}this.addRowFromConfig(c)}},addRandomRowSection:function(){for(var a=0,b=0,c=this._config.rowSectionConfigs;b<c.length;){var d=c[b];++b;this.doesRowPassTests(d)&&d.priority>a&&(a=d.priority)}b=new Lc;c=0;for(d=this._config.rowSectionConfigs;c<d.length;){var e=
d[c];++c;this.doesRowPassTests(e)&&(a>e.priority||b.addEntry(e.chance,e))}a=b.getRandomValue();this.addRowFromConfig(a)},addRowFromConfig:function(a){if(null==a)throw new H("Could not select a valid FroggerRowConfig to use for index: "+this.currentRowIndex);for(var b=0,c=a.rows.length;b<c;)for(var d=b++,e=0,f=S.randomInt(a.rows[d].minNumIterations,a.rows[d].maxNumIterations);e<f;)e++,this.addRow(a.rows[d])},doesRowPassTests:function(a){return this.doesRowConfigPassIndexModuliTest(a)&&this.doesRowConfigPassExclusionIndexModuliTest(a)&&
this.doesRowConfigPassRowIndexTest(a)?!0:!1},doesRowConfigPassIndexModuliTest:function(a){if(null!=a.indexModuli){var b=!1,c=0;for(a=a.indexModuli;c<a.length;){var d=a[c];++c;if(0==this.currentRowIndex%d){b=!0;break}}if(!b)return!1}return!0},doesRowConfigPassRowIndexTest:function(a){return 0<=a.minRowIndex&&this.currentRowIndex<a.minRowIndex||0<=a.maxRowIndex&&this.currentRowIndex>a.maxRowIndex?!1:!0},doesRowConfigPassExclusionIndexModuliTest:function(a){if(null!=a.exclusionIndexModuli){var b=!0,
c=0;for(a=a.exclusionIndexModuli;c<a.length;){var d=a[c];++c;if(0==this.currentRowIndex%d){b=!1;break}}if(!b)return!1}return!0},addRow:function(a){var b=this.currentRowIndex,c=this.backgroundLayer.addEntity(),d=c.addEntity();(new B(d,a.rowImage)).setAnchor(0.5,0.5);d=new K(0,-b*this._config.tileHeight);b=new Te(c,b,this._config.tileWidth);b.generateRowNodes(a,this.get_width());c.setLocalPosition(d.x,d.y);this._rows.push(b);this.spawnTilesOnRow(b,a);this.spawnObjectsOnRow(b,a);this.currentRowIndex++;
0==this.currentRowIndex%this._numRowsPerSideTile&&(a=c.addEntity(),a.setScale(-1,1),a.setLocalPosition(-512,0),(new B(a,"mazeBackgroundEdge")).setAnchor(0,0),a=c.addEntity(),a.setLocalPosition(512,0),(new B(a,"mazeBackgroundEdge")).setAnchor(0,0));this.removeExcessiveRows();this.getGameState().sendEntityToBack(c)},spawnTilesOnRow:function(a,b){for(var c=this._config.width,d=new tc,e=0;e<c;){for(var f=e++,g=new Lc,k=0,h=b.tilePlacements;k<h.length;){var l=h[k];++k;if(0<=l.columns.indexOf(f)){var m=
l.chance;l.accumulateChance&&(null!=d.h.__keys__[l.__id__]?d.set(l,d.h[l.__id__]+l.chance):d.set(l,l.chance),m=d.h[l.__id__]);g.addEntry(m,l)}}g=g.getRandomValue();null==g?console.log("Tile placement could not be found in column "+f):(g.accumulateChance&&null!=d.h.__keys__[g.__id__]&&d.set(g,d.h[g.__id__]-g.chance),k=S.randomInt(0,g.tileIds.length),g=this.getTileById(g.tileIds[k]),k=this.createTile(a.getEntity(),g),h=[this.createTileForeground(this.frontItemsLayer,g)],this.getGameState().sendEntityToBack(h[0]),
l=function(a){return function(){a[0].destroy()}}(h),k.addEventListener("destroy",l),k.setLocalPosition(0.5*-(c-1)*this._config.tileWidth+f*this._config.tileWidth,0),l=k.getPosition().x,h[0].setPosition(l,k.getPosition().y),g.traversable||(a.getTileNode(f).traversable=!1),a.getTileNode(f).isWater=g.isWater,a.getTileNode(f).isHole=g.isHole)}},createTile:function(a,b){for(var c=a.addEntity(),d=0,e=b.images;d<e.length;){var f=e[d];++d;if(!f.isForeground){var g=c.addEntity();g.setLocalPosition(0,0,0);
(new B(g,f.imageId)).setAnchor(f.anchorX,f.anchorY);g.setLocalScale(f.scaleX,f.scaleY);g.setLocalRotation(0,0,f.rotation)}}d=0;for(e=b.animations;d<e.length;)if(f=e[d],++d,!f.isForeground){g=c.addEntity();g.setLocalPosition(0,0,0);var k=new va(g,f.animationId);f.startOnRandomFrame&&k.setPosition(S.randomFloat(0,k.getAnimationLength()));g.setLocalPosition(f.offsetX,f.offsetY);g.setLocalScale(f.scaleX,f.scaleY);g.setLocalRotation(0,0,f.rotation)}return c},createTileForeground:function(a,b){for(var c=
a.addEntity(),d=0,e=b.images;d<e.length;){var f=e[d];++d;if(f.isForeground){var g=c.addEntity();g.setLocalPosition(0,0,0);(new B(g,f.imageId)).setAnchor(f.anchorX,f.anchorY);g.setLocalScale(f.scaleX,f.scaleY);g.setLocalRotation(0,0,f.rotation)}}d=0;for(e=b.animations;d<e.length;)if(f=e[d],++d,f.isForeground){g=c.addEntity();g.setLocalPosition(0,0,0);var k=new va(g,f.animationId);f.startOnRandomFrame&&k.setPosition(S.randomFloat(0,k.getAnimationLength()));g.setLocalPosition(f.offsetX,f.offsetY);g.setLocalScale(f.scaleX,
f.scaleY);g.setLocalRotation(0,0,f.rotation)}return c},spawnObjectsOnRow:function(a,b){for(var c=0,d=b.objectSpawnConfigs;c<d.length;){var e=d[c];++c;for(var f=0,g=S.randomInt(e.minIterations,e.maxIterations+1);f<g;)if(f++,S.randomFloat(0,1)<=e.chance){var k=S.randomInt(0,e.objectTypes.length),k=e.objectTypes[k],h=S.randomInt(0,e.validColumns.length),h=e.validColumns[h];0<a.getTileNode(h).get_attachedObjects().length||this._objectFactory.createObjectByType(k,h,this.currentRowIndex,e)}}},localPositionToCoords:function(a,
b){return new K(Math.round((a-0.5*this._config.tileWidth+0.5*this._config.tileWidth*this._config.width)/this._config.tileWidth),-Math.round(b/this._config.tileHeight))},removeExcessiveRows:function(){for(;this.get_numRows()>this.maxRowsActive;)this.removeFirstRow()},removeFirstRow:function(){this._rows.splice(0,1)[0].getEntity().destroy();this._deletedRowIndexOffset--},getAllTileNodes:function(){for(var a=[],b=0,c=this._rows.length;b<c;)for(var d=b++,e=0,f=this._config.width;e<f;){var g=e++;a.push(this.getTileNodeAt(g,
d))}return a},getTileNodeAt:function(a,b){var c=this._rows[b+this._deletedRowIndexOffset];return null==c?null:c.getTileNode(a)},setTileNodeAt:function(a,b,c){this._rows[b].setTileNode(a,c)},getTileAbove:function(a,b){return this.getTileNodeAt(a,b+1)},getTileBelow:function(a,b){return this.getTileNodeAt(a,b-1)},getTileLeft:function(a,b){return this.getTileNodeAt(a-1,b)},getTileRight:function(a,b){return this.getTileNodeAt(a+1,b)},isWallAbove:function(a,b){return!1},isWallBelow:function(a,b){return!1},
isWallLeft:function(a,b){return!1},isWallRight:function(a,b){return!1},__class__:Gd,__properties__:{get_numRows:"get_numRows",get_width:"get_width"}});var Xc=function(a){this._froggerMaze=a};Xc.__name__=["game","froggerGame","maze","FroggerMazeObjectFactory"];Xc.prototype={createObjectByType:function(a,b,c,d){switch(a){case "barrel1":return this.createObstacleWithImage("hazardBarrel1",b,c);case "barrel2":return this.createObstacleWithImage("hazardBarrel2",b,c);case "coveredHole":return this.createCoveredHole(b,
c);case "crate1":return this.createObstacleWithImage("hazardCrate1",b,c);case "crate2":return this.createObstacleWithImage("hazardCrate2",b,c);case "hazardSheet":return this.createObstacleWithImage("hazardSheet",b,c);case "hole":return this.createHole(b,c);case "lostPuppy":return this.createLostPuppy(b,c);case "mineCartSpawner":return this.createMineCartSpawner(b,c,d);case "minerFortyNinerSpawner":return this.createMinerFortyNinerSpawner(b,c,d);case "rock1":return this.createObstacleWithImage("hazardRock1",
b,c);case "rock2":return this.createObstacleWithImage("hazardRock2",b,c);case "scoobySnack":return this.createScoobySnack(b,c);case "waterPlatformSpawner":return this.createWaterPlatformSpawner(b,c,d);default:throw new H("No object found by type: "+a);}},createObstacle:function(a,b){var c=this.createBaseObstacle(a,b),d=c.addEntity();(new B(d,"tempObstacle")).setAnchor(0.5,0.5);return c},createHole:function(a,b){var c=this._froggerMaze.backgroundLayer.addEntity(),d=new Hd(c);d.mazeGameController=this._froggerMaze.mazeGameController;
d.attachToMaze(this._froggerMaze,a,b);this._froggerMaze.getTileNodeAt(a,b);(new B(c,"hazardHole")).setAnchor(0.5,0.5);return d},createCoveredHole:function(a,b){var c=this._froggerMaze.backgroundLayer.addEntity(),d=new Hd(c);d.mazeGameController=this._froggerMaze.mazeGameController;d.attachToMaze(this._froggerMaze,a,b);d.addCover();this._froggerMaze.getTileNodeAt(a,b);(new B(c,"hazardHole")).setAnchor(0.5,0.5);return d},createObstacleWithImage:function(a,b,c){b=this.createBaseObstacle(b,c);c=b.addEntity();
(new B(c,a)).setAnchor(0.5,0.5);return b},createBaseObstacle:function(a,b){var c=this._froggerMaze.addEntity(),c=new Z(c);this._froggerMaze.getTileNodeAt(a,b).traversable=!1;c.attachToMaze(this._froggerMaze,a,b);return c},createLostPuppy:function(a,b){var c=this._froggerMaze.itemsLayer.addEntity(),d=new Ub(c);d.attachToMaze(this._froggerMaze,a,b);var c=c.addEntity(),e=S.randomInt(0,Xc.LOST_PUPPY_IMAGES.length);(new B(c,Xc.LOST_PUPPY_IMAGES[e])).setAnchor(0.5,0.5);return d},createScoobySnack:function(a,
b){var c=this._froggerMaze.itemsLayer.addEntity(),d=new Wc(c);d.attachToMaze(this._froggerMaze,a,b);c=c.addEntity();(new B(c,"scoobySnack")).setAnchor(0.5,0.5);new db(c,c.getScaleRef(),"x",1,0.1,6);new db(c,c.getScaleRef(),"y",1,0.1,6);new db(c,c.getRotationRef(),"z",0,15,6);return d},createWaterPlatformSpawner:function(a,b,c){if(0==c.minObjectSpeed||0==c.maxObjectSpeed)throw new H("No object speed defined for FroggerMazeRowObjectSpawnConfig containing a Water Platform Spawner (minObjectSpeed and maxObjectSpeed)");
if(0==c.minObjectSpawnTime||0==c.maxObjectSpawnTime)throw new H("No object spawn time defined for FroggerMazeRowObjectSpawnConfig containing a Water Platform Spawner (minObjectSpawnTime and maxObjectSpawnTime)");var d=this._froggerMaze.addEntity(),e=new Ue(this._froggerMaze);e.platformSpeed=S.randomFloat(c.minObjectSpeed,c.maxObjectSpeed);d=new Yc(d,["barrel","plank1","collapsiblePlank1"],e);d.minTimeUntilSpawn=c.minObjectSpawnTime;d.maxTimeUntilSpawn=c.maxObjectSpawnTime;d.attachToMaze(this._froggerMaze,
a,b);return d},createMineCartSpawner:function(a,b,c){if(0==c.minObjectSpeed||0==c.maxObjectSpeed)throw new H("No object speed defined for FroggerMazeRowObjectSpawnConfig containing a Water Platform Spawner (minObjectSpeed and maxObjectSpeed)");if(0==c.minObjectSpawnTime||0==c.maxObjectSpawnTime)throw new H("No object spawn time defined for FroggerMazeRowObjectSpawnConfig containing a Water Platform Spawner (minObjectSpawnTime and maxObjectSpawnTime)");var d=this._froggerMaze.addEntity(),e=new Ve(this._froggerMaze);
e.platformSpeed=S.randomFloat(c.minObjectSpeed,c.maxObjectSpeed);d=new Yc(d,["mineCart1","mineCart2"],e);d.minTimeUntilSpawn=c.minObjectSpawnTime;d.maxTimeUntilSpawn=c.maxObjectSpawnTime;d.attachToMaze(this._froggerMaze,a,b);return d},createMinerFortyNinerSpawner:function(a,b,c){if(0==c.minObjectSpeed||0==c.maxObjectSpeed)throw new H("No object speed defined for FroggerMazeRowObjectSpawnConfig containing a Water Platform Spawner (minObjectSpeed and maxObjectSpeed)");if(0==c.minObjectSpawnTime||0==
c.maxObjectSpawnTime)throw new H("No object spawn time defined for FroggerMazeRowObjectSpawnConfig containing a Water Platform Spawner (minObjectSpawnTime and maxObjectSpawnTime)");var d=this._froggerMaze.addEntity(),e=new We(this._froggerMaze);e.platformSpeed=S.randomFloat(c.minObjectSpeed,c.maxObjectSpeed);d=new Yc(d,["mineCart1","mineCart2"],e);d.minTimeUntilSpawn=c.minObjectSpawnTime;d.maxTimeUntilSpawn=c.maxObjectSpawnTime;d.attachToMaze(this._froggerMaze,a,b);return d},__class__:Xc};var Te=
function(a,b,c){this._tileNodes=[];m.call(this,a);this._tileWidth=c;this._rowIndex=b};Te.__name__=["game","froggerGame","maze","FroggerMazeRow"];Te.__super__=m;Te.prototype=r(m.prototype,{generateRowNodes:function(a,b){for(var c=this._tileWidth*(b-1),d=0;d<b;){var e=d++,f=new Xe;f.tileWidth=b;var g=this.addEntity(),k=new K(this._tileWidth*e-0.5*c,0);g.setLocalPosition(k.x,k.y);f=new sc(g,f);f.coordsX=e;f.coordsY=this._rowIndex;new na(g,this._rowIndex+", "+(null==e?"null":""+e),{fontSize:14});this.setTileNode(e,
f)}},getTileNode:function(a){return this._tileNodes[a]},setTileNode:function(a,b){this._tileNodes[a]=b},destroy:function(){m.prototype.destroy.call(this);for(var a=0,b=this._tileNodes;a<b.length;){var c=b[a];++a;c.getEntity().destroy()}this._tileNodes=[]},__class__:Te});var Pe=function(a,b){this._minRowDistance=10;m.call(this,a);this._froggerMaze=b};Pe.__name__=["game","froggerGame","maze","FroggerMazeRowAgent"];Pe.__super__=m;Pe.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);
this._mazeObject=this.getComponent(Z)},update:function(){m.prototype.update.call(this);var a=this._froggerMaze.currentRowIndex-this._minRowDistance;this._mazeObject.get_mazeCoords().y>a&&this._froggerMaze.addNextRowSection()},__class__:Pe});var Ye=function(a,b){m.call(this,a);this._maze=b;this.createBackground(this.getEntity());this._maze.backgroundLayer=this.addEntity();this._maze.charactersLayer=this.addEntity();this._maze.itemsLayer=this.addEntity();this._maze.frontItemsLayer=this.addEntity();
this._maze.frontItemsLayer.setLocalPosition(0,0)};Ye.__name__=["game","froggerGame","maze","FroggerMazeVisuals"];Ye.__super__=m;Ye.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this)},createBackground:function(a){a.addEntity()},__class__:Ye});var Id=function(a,b){this._cachedTileNodes=null;this._tileNodes=[];m.call(this,a);this.mazeGameController=b};Id.__name__=["game","froggerGame","maze","GridMaze"];Id.__interfaces__=[Se];Id.__super__=m;Id.prototype=r(m.prototype,{getAllTileNodes:function(){if(null==
this._cachedTileNodes){for(var a=[],b=0,c=this._tileNodes;b<c.length;){var d=c[b];++b;a=a.concat(d)}this._cachedTileNodes=a}return[].concat(this._cachedTileNodes)},getTileNodeAt:function(a,b){return null==this._tileNodes[b]?null:this._tileNodes[b][a]},setTileNodeAt:function(a,b,c){null==this.getTileNodeAt(a,b)&&(null==this._tileNodes[b]&&(this._tileNodes[b]=[]),this._tileNodes[b][a]=c)},getTileAbove:function(a,b){return this.getTileNodeAt(a,b-1)},getTileBelow:function(a,b){return this.getTileNodeAt(a,
b+1)},getTileLeft:function(a,b){return this.getTileNodeAt(a-1,b)},getTileRight:function(a,b){return this.getTileNodeAt(a+1,b)},isWallAbove:function(a,b){return this.getTileNodeAt(a,b).get_wallAbove()},isWallBelow:function(a,b){return this.getTileNodeAt(a,b).get_wallBelow()},isWallLeft:function(a,b){return this.getTileNodeAt(a,b).get_wallLeft()},isWallRight:function(a,b){return this.getTileNodeAt(a,b).get_wallRight()},isExitAbove:function(a,b){return this.getTileNodeAt(a,b).get_exitAbove()},isExitBelow:function(a,
b){return this.getTileNodeAt(a,b).get_exitBelow()},isExitLeft:function(a,b){return this.getTileNodeAt(a,b).get_exitLeft()},isExitRight:function(a,b){return this.getTileNodeAt(a,b).get_exitRight()},getTilePosition:function(a,b){return this.getTileNodeAt(a,b).getEntity().getPosition()},smashWallLeft:function(a){a.smashLeftWall();a=this.getTileNodeAt(a.coordsX-1,a.coordsY);null!=a&&a.smashWallRight()},smashWallRight:function(a){a.smashWallRight();a=this.getTileNodeAt(a.coordsX+1,a.coordsY);null!=a&&
a.smashLeftWall()},smashWallTop:function(a){a.smashWallTop();a=this.getTileNodeAt(a.coordsX,a.coordsY-1);null!=a&&a.smashWallBottom()},smashWallBottom:function(a){a.smashWallBottom();a=this.getTileNodeAt(a.coordsX,a.coordsY+1);null!=a&&a.smashWallTop()},canSmashLeft:function(a){return 0<a.coordsX},canSmashRight:function(a){return a.coordsX<this.gridWidth-1},canSmashTop:function(a){return 0<a.coordsY},canSmashBottom:function(a){return a.coordsY<this.gridHeight-1},__class__:Id});var wg=function(){this.walls=
[];this.mazeNumber=1;this.wallPadding=0;this.height=7;this.width=16;this.tileWidth=this.tileHeight=54;this.setSize(16,7)};wg.__name__=["game","froggerGame","maze","GridMazeConfig"];wg.prototype={setSize:function(a,b){this.width=a;this.height=b;for(var c=0,d=b+1;c<d;){var e=c++;this.walls[e]=[];for(var e=this.walls[e],f=0,g=a+1;f<g;)f++,e.push(null)}},getWallAt:function(a,b){return this.walls[b][a]},parseTmx:function(a){this.setSize(a.width|0,a.height|0);for(var b=0,c=a.objectGroups;b<c.length;){var d=
c[b];++b;for(var e=0,d=d.objects;e<d.length;){var f=d[e];++e;if("Wall"==f.type){for(var g=[].concat(f.polyline.points),k=0;k<g.length;){var h=g[k];++k;h.x+=f.x;h.y+=f.y}this.pointsToWalls(g,a.tileWidth)}}}},pointsToWalls:function(a,b){null==b&&(b=1);for(var c=null,d=new s,e=0;e<a.length;){var f=a[e];++e;var g=Math.round(f.x/b),f=Math.round(f.y/b);new s(g,f);if(null!=c)for(var k=new s(g-d.x,f-d.y),h=Math.round(k.getLength()),l=0,m=h+1;l<m;){var n=l++/h,p=new s(d.x+k.x*n|0,d.y+k.y*n|0),n=p.x|0,p=p.y|
0,q=this.walls[p][n];null==q&&(q=new Ze(!1,!1,!1,!1),this.walls[p][n]=q);this.initWallConfigConnections(c,q,k);c=q}else c=this.walls[f|0][g|0],null==c&&(c=new Ze(!1,!1,!1,!1),this.walls[f|0][g|0]=c);d=new s(g,f)}},initWallConfigConnections:function(a,b,c){0<c.x&&(b.connectLeft=!0,a.connectRight=!0);0<c.y&&(b.connectUp=!0,a.connectDown=!0);0>c.x&&(b.connectRight=!0,a.connectLeft=!0);0>c.y&&(b.connectDown=!0,a.connectUp=!0)},__class__:wg};var xg=function(){};xg.__name__=["game","froggerGame","maze",
"IMazeObject"];xg.prototype={__class__:xg,__properties__:{get_tileRight:"get_tileRight",get_tileLeft:"get_tileLeft",get_tileBelow:"get_tileBelow",get_tileAbove:"get_tileAbove",get_isWallRight:"get_isWallRight",get_isWallLeft:"get_isWallLeft",get_isWallBelow:"get_isWallBelow",get_isWallAbove:"get_isWallAbove",set_tileNode:"set_tileNode",get_tileNode:"get_tileNode",set_mazeCoords:"set_mazeCoords",get_mazeCoords:"get_mazeCoords",set_maze:"set_maze",get_maze:"get_maze"}};var Jd=function(a,b){this._type=
a;this.collectible=b};Jd.__name__=["game","froggerGame","maze","ItemCollectEvent"];Jd.__super__=L;Jd.prototype=r(L.prototype,{__class__:Jd});var sg=function(a,b){this._prevMazeNumber=-1;this._mazeNumberPool=[];this.container=a;this._mazeGameConfig=b;this.initMazePool()};sg.__name__=["game","froggerGame","maze","MazeFactory"];sg.prototype={initMazePool:function(){for(var a=0,b=this._mazeGameConfig.numMazes;a<b;){var c=a++ +1;this._mazeNumberPool.push(c)}},getRandomMazeTmxMap:function(){0==this._mazeNumberPool.length&&
this.initMazePool();for(var a;a=S.randomInt(0,this._mazeNumberPool.length),a=this._mazeNumberPool[a],a==this._prevMazeNumber;);this._prevMazeNumber=a;F.remove(this._mazeNumberPool,a);var b=Ce.getMapFromXmlString(I.getAsset("maze"+a)),c=b.properties;null!=N.mazeNumber?c.setReserved("mazeNumber",a):c.h.mazeNumber=a;return b},getMazeReader:function(a){var b=a.properties,b=(null!=N.mazeNumber?b.getReserved("mazeNumber"):b.h.mazeNumber)|0;this._mazeConfig=new wg;this._mazeConfig.parseTmx(a);this._mazeConfig.mazeNumber=
b;return new yg(this._mazeConfig)},getMaxMonstersForRound:function(a){return this.getMazeRoundConfig(a).maxEnemies},getMonsterSpeedModifierForRound:function(a){return this.getMazeRoundConfig(a).speedModifier},getMazeRoundConfig:function(a){a=Math.min(a,this._mazeGameConfig.roundConfigs.length)-1|0;return this._mazeGameConfig.roundConfigs[a]},getMazeConfig:function(){return this._mazeConfig},generateMaze:function(a,b){var c=this.container.addEntity(),d=new Id(c,b);d.mazeNumber=a.get_mazeNumber();var e=
a.get_mazeWidth(),f=a.get_mazeHeight();d.gridWidth=a.get_mazeGridWidth();d.gridHeight=a.get_mazeGridHeight();for(var g=0,k=a.get_mazeGridHeight();g<k;)for(var h=g++,l=0,m=a.get_mazeGridWidth();l<m;){var n=l++,p=a.getTilePosition(n,h);p.x-=0.5*e;p.y-=0.5*f;var q=a.getTileAt(n,h),q=this.createTileNode(c,q);q.coordsX=n;q.coordsY=h;q.x=n;q.y=h;q.getEntity().setLocalPosition(p.x,p.y);d.setTileNodeAt(n,h,q)}new $e(c,d);return d},generateFroggerMaze:function(a,b,c){var d=this.container.addEntity();a=new Gd(d,
b,a);a.designConfigReader=c;new Ye(d,a);a.spawnInitialRows();return a},createTileNode:function(a,b){var c=a.addEntity();return new sc(c,b)},makeTileNodeExit:function(a){a.isExit=!0},__class__:sg};var rg=function(){this.cameraFollowOffsetY=-200;this.cameraFollowOffsetX=0;this.extraLifePoints=5E3;this.canEarnExtraLives=!1;this.defeatVillainScore=500;this.rescueLostPuppyScore=10;this.collectScoobySnackScore=5;this.jumpHoleScore=25;this.smashFenceScore=10;this.collectFruitScore=5;this.moveForwardScore=
1;this.roundConfigs=[];this.numMazes=10};rg.__name__=["game","froggerGame","maze","MazeGameConfig"];rg.prototype={__class__:rg};var Z=function(a){this._mazeCoords=new s;m.call(this,a)};Z.__name__=["game","froggerGame","maze","MazeObject"];Z.__interfaces__=[xg];Z.__super__=m;Z.prototype=r(m.prototype,{get_tileNode:function(){return this._tileNode},set_tileNode:function(a){return this._tileNode=a},get_maze:function(){return this._maze},set_maze:function(a){return this._maze=a},get_mazeCoords:function(){return this._mazeCoords},
set_mazeCoords:function(a){return this._mazeCoords=a},get_isWallAbove:function(){return this._maze.isWallAbove(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isWallBelow:function(){return this._maze.isWallBelow(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isWallLeft:function(){return this._maze.isWallLeft(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isWallRight:function(){return this._maze.isWallRight(this._mazeCoords.x|0,this._mazeCoords.y|0)},get_isTileAboveTraversable:function(){var a=this._maze.getTileAbove(this._mazeCoords.x|
0,this._mazeCoords.y|0);return null==a?!1:a.traversable},get_isTileBelowTraversable:function(){var a=this._maze.getTileBelow(this._mazeCoords.x|0,this._mazeCoords.y|0);return null==a?!1:a.traversable},get_isTileLeftTraversable:function(){var a=this._maze.getTileLeft(this._mazeCoords.x|0,this._mazeCoords.y|0);return null==a?!1:a.traversable},get_isTileRightTraversable:function(){var a=this._maze.getTileRight(this._mazeCoords.x|0,this._mazeCoords.y|0);return null==a?!1:a.traversable},attachToMaze:function(a,
b,c){this._maze=a;a=this._maze.getTileNodeAt(b,c);if(null==a)throw new H("No Tile Node was found at coordinates "+b+", "+c);this.attachToTileAndSnapPosition(a)},moveToTileCoords:function(a,b){var c=this._maze.getTileNodeAt(a,b);this.attachToTileAndSnapPosition(c)},moveToTileCoordsWithoutReposition:function(a,b){var c=this._maze.getTileNodeAt(a,b);this.attachToTile(c)},attachToTileAndSnapPosition:function(a){this.attachToTile(a);a=a.getEntity().getPosition();this.getEntity().setPosition(a.x,a.y)},
removeFromTile:function(){null!=this._tileNode&&(this._tileNode.detachMazeObject(this),this._tileNode=null)},attachToTile:function(a){this._tileNode!=a&&(null!=this._tileNode&&this._tileNode.detachMazeObject(this),this.set_mazeCoords(new s(a.coordsX,a.coordsY)),this._tileNode=a,this._tileNode.attachMazeObject(this))},get_tileAbove:function(){return this._maze.getTileAbove(this.get_mazeCoords().x|0,this.get_mazeCoords().y|0)},get_tileBelow:function(){return this._maze.getTileBelow(this.get_mazeCoords().x|
0,this.get_mazeCoords().y|0)},get_tileLeft:function(){return this._maze.getTileLeft(this.get_mazeCoords().x|0,this.get_mazeCoords().y|0)},get_tileRight:function(){return this._maze.getTileRight(this.get_mazeCoords().x|0,this.get_mazeCoords().y|0)},onOtherMazeObjectJoinTile:function(a){this.dispatchEvent(new Kd("joinTile",a))},__class__:Z,__properties__:{get_tileRight:"get_tileRight",get_tileLeft:"get_tileLeft",get_tileBelow:"get_tileBelow",get_tileAbove:"get_tileAbove",get_isTileRightTraversable:"get_isTileRightTraversable",
get_isTileLeftTraversable:"get_isTileLeftTraversable",get_isTileBelowTraversable:"get_isTileBelowTraversable",get_isTileAboveTraversable:"get_isTileAboveTraversable",get_isWallRight:"get_isWallRight",get_isWallLeft:"get_isWallLeft",get_isWallBelow:"get_isWallBelow",get_isWallAbove:"get_isWallAbove",set_mazeCoords:"set_mazeCoords",get_mazeCoords:"get_mazeCoords",set_maze:"set_maze",get_maze:"get_maze",set_tileNode:"set_tileNode",get_tileNode:"get_tileNode"}});var Kd=function(a,b){this._type=a;this.mazeObject=
b};Kd.__name__=["game","froggerGame","maze","MazeObjectJoinTileEvent"];Kd.__super__=L;Kd.prototype=r(L.prototype,{__class__:Kd});var yg=function(a){this._mazeConfig=a};yg.__name__=["game","froggerGame","maze","MazeReader"];yg.prototype={get_mazeNumber:function(){return this._mazeConfig.mazeNumber},get_wallPadding:function(){return this._mazeConfig.wallPadding},get_mazeGridWidth:function(){return this._mazeConfig.width},get_mazeGridHeight:function(){return this._mazeConfig.height},get_mazeWidth:function(){return this.get_mazeGridWidth()*
this.get_tileWidth()+this.get_wallPadding()*this.get_mazeGridWidth()},get_mazeHeight:function(){return this.get_mazeGridHeight()*this.get_tileHeight()+this.get_wallPadding()*this.get_mazeGridHeight()},get_tileWidth:function(){return this._mazeConfig.tileWidth},get_tileHeight:function(){return this._mazeConfig.tileHeight},getTileAt:function(a,b){var c=0==a,d=a>=this.get_mazeGridWidth()-1,e=0==b,f=b>=this.get_mazeGridHeight()-1,g=this._mazeConfig.getWallAt(a,b),k=this._mazeConfig.getWallAt(a+1,b),h=
this._mazeConfig.getWallAt(a,b+1),l=this._mazeConfig.getWallAt(a+1,b+1),m=null!=g&&null!=k&&g.connectRight&&k.connectLeft,g=null!=g&&null!=h&&g.connectDown&&h.connectUp,k=null!=k&&null!=l&&k.connectDown&&l.connectUp,h=null!=h&&null!=l&&h.connectRight&&l.connectLeft,l=new Xe;l.tileWidth=this.get_tileWidth();l.tileHeight=this.get_tileHeight();l.leftWall=g;l.upWall=m;l.rightWall=k;l.downWall=h;e&&!m&&(l.upExit=!0,l.loopCounterpartCoords=new s(a,this.get_mazeGridHeight()-1));f&&!h&&(l.downExit=!0,l.loopCounterpartCoords=
new s(a,0));c&&!g&&(l.leftExit=!0,l.loopCounterpartCoords=new s(this.get_mazeGridWidth()-1,b));d&&!k&&(l.rightExit=!0,l.loopCounterpartCoords=new s(0,b));return l},getTilePosition:function(a,b){return new K(a*(this.get_tileWidth()+this.get_wallPadding())+0.5*this.get_tileWidth()+this.get_wallPadding(),b*(this.get_tileHeight()+this.get_wallPadding())+this.get_tileHeight()+this.get_wallPadding())},__class__:yg,__properties__:{get_tileHeight:"get_tileHeight",get_tileWidth:"get_tileWidth",get_mazeHeight:"get_mazeHeight",
get_mazeWidth:"get_mazeWidth",get_mazeGridHeight:"get_mazeGridHeight",get_mazeGridWidth:"get_mazeGridWidth",get_wallPadding:"get_wallPadding",get_mazeNumber:"get_mazeNumber"}};var fb=function(){this.speedModifier=0;this.maxEnemies=1};fb.__name__=["game","froggerGame","maze","MazeRoundConfig"];fb.prototype={__class__:fb};var $e=function(a,b){m.call(this,a);this._maze=b;this.createBackground(this.getEntity());this.createSpacesLayer(this.getEntity());this.createWallsLayer(this.getEntity());this._maze.itemsLayer=
this.addEntity();this._maze.charactersLayer=this.addEntity();this._maze.frontItemsLayer=this.addEntity();this.createMazeEdge(this._maze.frontItemsLayer)};$e.__name__=["game","froggerGame","maze","MazeVisuals"];$e.__super__=m;$e.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this)},createBackground:function(a){a=a.addEntity();(new B(a,"mazeBackground"+this._maze.mazeNumber)).setAnchor(0.5,0.5)},createMazeEdge:function(a){var b=a.addEntity();b.setLocalPosition(-460,0);(new B(b,"mazeBackgroundEdge")).setAnchor(1,
0.5);a=a.addEntity();a.setLocalPosition(460,0);a.setLocalScale(-1,1);(new B(a,"mazeBackgroundEdge")).setAnchor(1,0.5)},createSpacesLayer:function(a){a=a.addEntity();for(var b=0,c=this._maze.gridHeight;b<c;)for(var d=b++,e=0,f=this._maze.gridWidth;e<f;){var g=e++,g=[this._maze.getTileNodeAt(g,d)],k=g[0].getEntity().getPosition(),h=a.addEntity();h.setPosition(k.x,k.y);var l=!1,k=0,m=1;g[0].get_exitAbove()?(l=!0,k=0):g[0].get_exitRight()?(l=!0,k=90,m=-1):g[0].get_exitBelow()?(l=!0,k=180):g[0].get_exitLeft()&&
(l=!0,k=270);if(l){l=[h.addEntity()];l[0].setVisible(!1);var n=[l[0].addEntity()],p=new B(n[0],"exitArrow");h.setScale(1,m);p.setAnchor(0.5,0.5);l[0].setRotation2d(k);h=[null];k=function(a,b,c,d){return function(e){d[0].removeEventListener("exitActivate",a[0]);new db(b[0],b[0].getPositionRef(),"y",-55,5,5);c[0].setVisible(!0)}}(h,n,l,g);h[0]=k;g[0].addEventListener("exitActivate",h[0])}}return this._entity},createWallsLayer:function(a){a=a.addEntity();for(var b=0,c=this._maze.gridHeight;b<c;)for(var d=
b++,e=0,f=this._maze.gridWidth;e<f;){var g=e++,g=this._maze.getTileNodeAt(g,d),k=g.getEntity().getPosition();if(g.get_wallAbove()){var h=this.createWall(a,90);h.getEntity().setPosition(k.x,k.y-0.5*g.get_height());h.addTileNodeRelationship(g,Q.North)}g.get_wallLeft()&&(h=this.createWall(a,0),h.getEntity().setPosition(k.x-0.5*g.get_width(),k.y),h.addTileNodeRelationship(g,Q.West));g.get_wallRight()&&(h=this.createWall(a,0),h.getEntity().setPosition(k.x+0.5*g.get_width(),k.y),h.addTileNodeRelationship(g,
Q.East));g.get_wallBelow()&&(h=this.createWall(a,90),h.getEntity().setPosition(k.x,k.y+0.5*g.get_height()),h.addTileNodeRelationship(g,Q.South))}return this._entity},createWall:function(a,b){var c=a.addEntity(),d=new Ld(c,this._maze.mazeGameController);c.setRotation2d(b);return d},__class__:$e});var Ld=function(a,b){this._destroyed=!1;this._tileNodeRelationships=new tc;m.call(this,a);this._mazeGameController=b};Ld.__name__=["game","froggerGame","maze","MazeWall"];Ld.__super__=m;Ld.prototype=r(m.prototype,
{addTileNodeRelationship:function(a,b){var c=new zg;c.tileNode=a;c.direction=b;this._tileNodeRelationships.set(a,c);a.addEventListener("wallSmash",w(this,this.onTileNodeWallSmash))},onTileNodeWallSmash:function(a){console.log("onTileNodeWallSmash()");if(!this._destroyed){var b=a.target;null!=b&&(null==this._tileNodeRelationships.h.__keys__[b.__id__]?console.log("TileNode key not in map"):this._tileNodeRelationships.h[b.__id__].direction==a.direction&&this.explode())}},explode:function(){var a=this.addEntity();
(new B(a,"breakFenceOverlay")).setAnchor(0.5,0.5);var b=new ta(a);b.addTween(a.getScaleRef(),"x",0.5,1,0.5,E.easeOutQuint);b.addTween(a.getScaleRef(),"y",0.5,1,0.5,E.easeOutQuint);this._mazeGameController.addScore(this._mazeGameController.get_mazeGameConfig().smashFenceScore);b=S.randomFloat(-15,15);a.setLocalRotation2d(a.getLocalRotation().z+b);this._destroyed=!0;n.playSoundByName("sfx_fence_break_1")},__class__:Ld});var Na={__ename__:!0,__constructs__:["Cave","River","Rail"],Cave:["Cave",0]};Na.Cave.__enum__=
Na;Na.River=["River",1];Na.River.__enum__=Na;Na.Rail=["Rail",2];Na.Rail.__enum__=Na;Na.__empty_constructs__=[Na.Cave,Na.River,Na.Rail];var Xe=function(){};Xe.__name__=["game","froggerGame","maze","TileConfig"];Xe.prototype={__class__:Xe};var sc=function(a,b){this.isExit=!1;this.traversable=!0;this.parentNode=null;this.isDangerous=this.isWater=this.isHole=!1;this.fruitType=sa.Cabbage;this.dontSpawnFruit=!1;this.coordsX=this.coordsY=0;this._isExitActive=!1;this._attachedObjects=[];m.call(this,a);this._tileConfig=
b};sc.__name__=["game","froggerGame","maze","TileNode"];sc.__interfaces__=[og];sc.__super__=m;sc.prototype=r(m.prototype,{get_attachedObjects:function(){return this._attachedObjects},get_isEmpty:function(){return 0==this._attachedObjects.length},get_wallAbove:function(){return this._tileConfig.upWall},get_wallBelow:function(){return this._tileConfig.downWall},get_wallLeft:function(){return this._tileConfig.leftWall},get_wallRight:function(){return this._tileConfig.rightWall},get_exitAbove:function(){return this._tileConfig.upExit},
get_exitBelow:function(){return this._tileConfig.downExit},get_exitLeft:function(){return this._tileConfig.leftExit},get_exitRight:function(){return this._tileConfig.rightExit},get_width:function(){return this._tileConfig.tileWidth},get_height:function(){return this._tileConfig.tileHeight},get_loopCounterpartCoords:function(){return this._tileConfig.loopCounterpartCoords},get_isExitActive:function(){return this._isExitActive},set_isExitActive:function(a){(this._isExitActive=a)&&this.dispatchEvent(new Md("exitActivate"));
return this._isExitActive},attachMazeObject:function(a){if(!(0<=this._attachedObjects.indexOf(a))){this._attachedObjects.push(a);a.addEventListener("destroy",w(this,this.onDestroyMazeObject));for(var b=0,c=this._attachedObjects;b<c.length;){var d=c[b];++b;if(d!=a)d.onOtherMazeObjectJoinTile(a)}}},detachMazeObject:function(a){0>this._attachedObjects.indexOf(a)||(F.remove(this._attachedObjects,a),a.removeEventListener("destroy",w(this,this.onDestroyMazeObject)))},onDestroyMazeObject:function(a){this.detachMazeObject(a.target)},
getDirectionRelativeToTile:function(a){var b=this.getEntity().getPosition();a=a.getEntity().getPosition();var c=b.y<a.y,d=b.x<a.x;return b.y>a.y?Q.South:c?Q.North:d?Q.West:Q.East},smashLeftWall:function(){this._tileConfig.leftWall=!1;this.dispatchEvent(new Xb("wallSmash",Q.West))},smashWallRight:function(){this._tileConfig.rightWall=!1;this.dispatchEvent(new Xb("wallSmash",Q.East))},smashWallTop:function(){this._tileConfig.upWall=!1;this.dispatchEvent(new Xb("wallSmash",Q.North))},smashWallBottom:function(){this._tileConfig.downWall=
!1;this.dispatchEvent(new Xb("wallSmash",Q.South))},onDestroy:function(){m.prototype.onDestroy.call(this);for(var a=0,b=this._attachedObjects;a<b.length;){var c=b[a];++a;c.getEntity().destroy()}},__class__:sc,__properties__:{set_isExitActive:"set_isExitActive",get_isExitActive:"get_isExitActive",get_loopCounterpartCoords:"get_loopCounterpartCoords",get_height:"get_height",get_width:"get_width",get_exitRight:"get_exitRight",get_exitLeft:"get_exitLeft",get_exitBelow:"get_exitBelow",get_exitAbove:"get_exitAbove",
get_wallRight:"get_wallRight",get_wallLeft:"get_wallLeft",get_wallBelow:"get_wallBelow",get_wallAbove:"get_wallAbove",get_isEmpty:"get_isEmpty",get_attachedObjects:"get_attachedObjects"}});var Md=function(a){this._type=a};Md.__name__=["game","froggerGame","maze","TileNodeEvent"];Md.__super__=L;Md.prototype=r(L.prototype,{__class__:Md});var Ze=function(a,b,c,d){this.connectLeft=this.connectRight=this.connectUp=this.connectDown=!1;this.connectLeft=a;this.connectUp=b;this.connectRight=c;this.connectDown=
d};Ze.__name__=["game","froggerGame","maze","WallConfig"];Ze.prototype={__class__:Ze};var Xb=function(a,b){this._type=a;this.direction=b};Xb.__name__=["game","froggerGame","maze","WallSmashEvent"];Xb.__super__=L;Xb.prototype=r(L.prototype,{__class__:Xb});var zg=function(){};zg.__name__=["game","froggerGame","maze","WallToTileNodeRelation"];zg.prototype={__class__:zg};var af=function(){};af.__name__=["game","froggerGame","maze","collectibles","ICollectible"];af.prototype={__class__:af};var mb=function(a){Z.call(this,
a)};mb.__name__=["game","froggerGame","maze","collectibles","Collectible"];mb.__interfaces__=[af];mb.__super__=Z;mb.prototype=r(Z.prototype,{collect:function(a){this.getEntity().destroy()},__class__:mb});var Oc=function(a){this.tint=16777215;Z.call(this,a)};Oc.__name__=["game","froggerGame","maze","collectibles","Fruit"];Oc.__super__=mb;Oc.prototype=r(mb.prototype,{collect:function(a){this.playCollectFx();mb.prototype.collect.call(this,a);this.getEntity().destroy()},playCollectFx:function(){n.playSoundByName("sfxCollect1");
var a=this.getEntity().getPosition(),b=this.getEntity().getParent().addEntity();b.setScale(0.5,0.5);b.setPosition(a.x,a.y);a=new va(b,"collectionParticle");a.getSprite().tint=this.tint;a.setOnAnimationComplete(function(){b.destroy()})},__class__:Oc});var sa={__ename__:!0,__constructs__:"Corn Carrot Cabbage Eggplant Tomato Pumpkin".split(" "),Corn:["Corn",0]};sa.Corn.__enum__=sa;sa.Carrot=["Carrot",1];sa.Carrot.__enum__=sa;sa.Cabbage=["Cabbage",2];sa.Cabbage.__enum__=sa;sa.Eggplant=["Eggplant",3];
sa.Eggplant.__enum__=sa;sa.Tomato=["Tomato",4];sa.Tomato.__enum__=sa;sa.Pumpkin=["Pumpkin",5];sa.Pumpkin.__enum__=sa;sa.__empty_constructs__=[sa.Corn,sa.Carrot,sa.Cabbage,sa.Eggplant,sa.Tomato,sa.Pumpkin];var Ub=function(a){Z.call(this,a)};Ub.__name__=["game","froggerGame","maze","collectibles","LostPuppy"];Ub.__super__=mb;Ub.prototype=r(mb.prototype,{collect:function(a){a.getComponent(wa).dispatchCollectLostPuppyEvent();a=S.randomInt(0,Ub.LOST_PUPPY_SOUNDS.length);n.playSoundByName(Ub.LOST_PUPPY_SOUNDS[a]);
this.playSnackFx();this.getEntity().destroy()},playSnackFx:function(){var a=this.getEntity().getParent().addEntity(),b=this.getEntity().getPosition().x;a.setPosition(b,this.getEntity().getPosition().y);(new va(a,"puppyCollection")).setOnAnimationComplete(function(){a.destroy()})},__class__:Ub});var Wc=function(a){Z.call(this,a)};Wc.__name__=["game","froggerGame","maze","collectibles","ScoobySnack"];Wc.__super__=mb;Wc.prototype=r(mb.prototype,{collect:function(a){var b=a.getComponent(Vc);a=a.getComponent(wa);
this.scoobySnackStatusEffect=new bf(b,a);b.addStatusEffect(this.scoobySnackStatusEffect);n.playSoundByName("sfx_scooby_snack_1");this.playSnackFx();this.getEntity().destroy()},playSnackFx:function(){var a=this.getEntity().getParent().addEntity(),b=this.getEntity().getPosition().x;a.setPosition(b,this.getEntity().getPosition().y);(new va(a,"snackEffect")).setOnAnimationComplete(function(){a.destroy()})},__class__:Wc});var tg=function(){this.numSafeRows=8;this.milestones=[]};tg.__name__=["game","froggerGame",
"maze","config","DesignerConfig"];tg.prototype={parse:function(a){for(var b=0,c=a.milestones.length;b<c;){var d=b++,d=a.milestones[d],e=new Re;e.parse(d);this.milestones.push(e)}},__class__:tg};var Re=function(){this.caveRowSpawnRatio=this.riverRowSpawnRatio=this.railRowSpawnRatio=this.scrollSpeed=this.rowsPerMinerFortyNiner=this.numRaftsPerRow=this.numCartsPerRow=this.raftSpeed=this.cartSpeed=this.timePerCartSpawn=this.timePerRaftSpawn=this.chanceOfScoobySnack=this.chanceOfLostPuppy=this.chanceForBoxSpawn=
this.chanceForHole=this.chanceForCoveredHole=-1;this.score=0};Re.__name__=["game","froggerGame","maze","config","DesignerScoreMilestoneConfig"];Re.prototype={parse:function(a){this.score=a.score;this.caveRowSpawnRatio=a.caveRowSpawnRatio;this.riverRowSpawnRatio=a.riverRowSpawnRatio;this.railRowSpawnRatio=a.railRowSpawnRatio;this.scrollSpeed=a.scrollSpeed;this.rowsPerMinerFortyNiner=a.rowsPerMinerFortyNiner;this.numRaftsPerRow=a.numRaftsPerRow;this.numCartsPerRow=a.numCartsPerRow;this.raftSpeed=a.raftSpeed;
this.cartSpeed=a.cartSpeed;this.timePerCartSpawn=a.timePerCartSpawn;this.timePerRaftSpawn=a.timePerRaftSpawn;this.chanceOfScoobySnack=a.chanceOfScoobySnack;this.chanceOfLostPuppy=a.chanceOfLostPuppy;this.chanceForBoxSpawn=a.chanceForBoxSpawn;this.chanceForHole=a.chanceForHole;this.chanceForCoveredHole=a.chanceForCoveredHole},__class__:Re};var ug=function(){this.levelScrollSpeed=60;this.tileConfigs=[];this.rowSectionConfigs=[];this.startRow=3;this.width=13;this.tileWidth=this.tileHeight=80};ug.__name__=
["game","froggerGame","maze","config","FroggerMazeConfig"];ug.prototype={setSize:function(a){this.width=a},parse:function(a){this.tileWidth=a.tileWidth;this.tileHeight=a.tileHeight;this.width=a.width;for(var b=0,c=a.rowSectionConfigs.length;b<c;){var d=b++,d=a.rowSectionConfigs[d],e=new Ag;e.parse(d);this.rowSectionConfigs.push(e)}b=0;for(c=a.tileConfigs.length;b<c;)d=b++,d=a.tileConfigs[d],e=new Bg,e.parse(d),this.tileConfigs.push(e)},__class__:ug};var Cg=function(){this.minNumIterations=this.maxNumIterations=
1;this.tilePlacements=[];this.objectSpawnConfigs=[]};Cg.__name__=["game","froggerGame","maze","config","FroggerMazeRowConfig"];Cg.prototype={parse:function(a){null!=a.minNumIterations&&(this.minNumIterations=a.minNumIterations);null!=a.maxNumIterations&&(this.maxNumIterations=a.maxNumIterations);null!=a.rowImage&&(this.rowImage=a.rowImage);if(null!=a.objectSpawnConfigs)for(var b=0,c=a.objectSpawnConfigs.length;b<c;){var d=b++,d=a.objectSpawnConfigs[d],e=new Wb;e.parse(d);this.objectSpawnConfigs.push(e)}b=
0;for(c=a.tilePlacements.length;b<c;)d=b++,d=a.tilePlacements[d],e=new Dg,e.parse(d),this.tilePlacements.push(e)},__class__:Cg};var Wb=function(){this.maxObjectsActive=-1;this.minObjectSpeed=this.maxObjectSpeed=this.minObjectSpawnTime=this.maxObjectSpawnTime=0;this.minIterations=this.maxIterations=1;this.objectTypes=[];this.chance=1;this.validColumns=[]};Wb.__name__=["game","froggerGame","maze","config","FroggerMazeRowObjectSpawnConfig"];Wb.prototype={parse:function(a){null!=a.validColumns&&(this.validColumns=
a.validColumns);this.chance=a.chance;this.objectTypes=a.objectTypes;this.minIterations=a.minIterations;this.maxIterations=a.maxIterations;null!=a.minObjectSpeed&&(this.minObjectSpeed=a.minObjectSpeed);null!=a.maxObjectSpeed&&(this.maxObjectSpeed=a.maxObjectSpeed);null!=a.minObjectSpawnTime&&(this.minObjectSpawnTime=a.minObjectSpawnTime);null!=a.maxObjectSpawnTime&&(this.maxObjectSpawnTime=a.maxObjectSpawnTime);null!=a.maxObjectsActive&&(this.maxObjectsActive=a.maxObjectsActive)},__class__:Wb};var Ag=
function(){this.priority=0;this.minRowIndex=this.maxRowIndex=-1;this.rows=[];this.indexModuli=this.exclusionIndexModuli=null;this.chance=1;this.width=13};Ag.__name__=["game","froggerGame","maze","config","FroggerMazeRowSectionConfig"];Ag.prototype={parse:function(a){this.width=a.width;this.chance=a.chance;this.id=a.id;null!=a.priority&&(this.priority=a.priority);null!=a.minRowIndex&&(this.minRowIndex=a.minRowIndex);null!=a.maxRowIndex&&(this.maxRowIndex=a.maxRowIndex);null!=a.indexModuli&&(this.indexModuli=
a.indexModuli);null!=a.exclusionIndexModuli&&(this.exclusionIndexModuli=a.exclusionIndexModuli);for(var b=0,c=a.rows.length;b<c;){var d=b++,d=a.rows[d],e=new Cg;e.parse(d);this.rows.push(e)}},__class__:Ag};var Dg=function(){this.accumulateChance=!1;this.tileIds=[];this.chance=1;this.columns=[]};Dg.__name__=["game","froggerGame","maze","config","FroggerMazeRowTilePlacementConfig"];Dg.prototype={parse:function(a){this.columns=a.columns;this.chance=a.chance;this.tileIds=a.tileIds;null!=a.accumulateChance&&
(this.accumulateChance=a.accumulateChance)},__class__:Dg};var Eg=function(){this.startOnRandomFrame=this.isForeground=!1;this.offsetX=this.offsetY=0;this.scaleX=this.scaleY=1;this.rotation=0};Eg.__name__=["game","froggerGame","maze","config","FroggerMazeTileAnimationConfig"];Eg.prototype={parse:function(a){this.animationId=a.animationId;null!=a.rotation&&(this.rotation=a.rotation);null!=a.scaleX&&(this.scaleX=a.scaleX);null!=a.scaleY&&(this.scaleY=a.scaleY);null!=a.offsetX&&(this.offsetX=a.offsetX);
null!=a.offsetY&&(this.offsetY=a.offsetY);null!=a.startOnRandomFrame&&(this.startOnRandomFrame=a.startOnRandomFrame);null!=a.isForeground&&(this.isForeground=a.isForeground)},__class__:Eg};var Bg=function(){this.isWater=this.isHole=!1;this.traversable=!0;this.animations=[];this.images=[]};Bg.__name__=["game","froggerGame","maze","config","FroggerMazeTileConfig"];Bg.prototype={parse:function(a){this.id=a.id;this.isWater=a.isWater;this.isHole=a.isHole;null!=a.traversable&&(this.traversable=a.traversable);
if(null!=a.images)for(var b=0,c=a.images.length;b<c;){var d=b++,d=a.images[d],e=new Fg;e.parse(d);this.images.push(e)}if(null!=a.animations)for(b=0,c=a.animations.length;b<c;)d=b++,d=a.animations[d],e=new Eg,e.parse(d),this.animations.push(e)},__class__:Bg};var Fg=function(){this.isForeground=!1;this.scaleX=this.scaleY=1;this.anchorX=this.anchorY=0.5;this.rotation=0};Fg.__name__=["game","froggerGame","maze","config","FroggerMazeTileImageConfig"];Fg.prototype={parse:function(a){this.imageId=a.imageId;
null!=a.rotation&&(this.rotation=a.rotation);null!=a.anchorX&&(this.anchorX=a.anchorX);null!=a.anchorY&&(this.anchorY=a.anchorY);null!=a.scaleX&&(this.scaleX=a.scaleX);null!=a.scaleY&&(this.scaleY=a.scaleY);null!=a.isForeground&&(this.isForeground=a.isForeground)},__class__:Fg};var Zc=function(a){Z.call(this,a)};Zc.__name__=["game","froggerGame","maze","hazards","Hazard"];Zc.__super__=Z;Zc.prototype=r(Z.prototype,{attachToTileAndSnapPosition:function(a){Z.prototype.attachToTileAndSnapPosition.call(this,
a);a.isDangerous=!0},onOtherMazeObjectJoinTile:function(a){Z.prototype.onOtherMazeObjectJoinTile.call(this,a);if(y.__instanceof(a,wa))this.onCatchCharacter(a)},onCatchCharacter:function(a){},__class__:Zc});var Hd=function(a){Z.call(this,a);this._deferredAction=new Va(this.getEntity())};Hd.__name__=["game","froggerGame","maze","hazards","Hole"];Hd.__super__=Zc;Hd.prototype=r(Zc.prototype,{onCatchCharacter:function(a){Zc.prototype.onCatchCharacter.call(this,a);null!=this._cover?this.startBreakingCover():
a.canJumpOverHoles||this.dropPlayerInside(a)},dropPlayerInside:function(a){var b=this;a.set_state(new Nd(a,function(){if("Player"==a.getEntity().getName())b.mazeGameController.onPlayerFallIntoHole()}));this.playHoleFx()},startBreakingCover:function(){var a=this._cover.getComponent(va);a.playing()||(a.play(),a.setOnAnimationComplete(w(this,this.onBreakAnimationComplete)))},onBreakAnimationComplete:function(){this._cover.destroy();this._cover=null;for(var a=0,b=this.get_tileNode().get_attachedObjects();a<
b.length;){var c=b[a];++a;y.__instanceof(c,wa)&&this.dropPlayerInside(c)}},playHoleFx:function(){var a=this.getEntity().addEntity();(new va(a,"holeEffect")).setOnAnimationComplete(function(){a.destroy()})},addCover:function(){this._cover=this.addEntity();var a=new va(this._cover,"boardBreak");a.setPosition(0);a.stop()},__class__:Hd});var Yb=function(a,b){this.chaseLifetime=20;this.scatterLifetime=7;m.call(this,a);this._mazeCharacter=b};Yb.__name__=["game","froggerGame","maze","mazeCharacters","AiController"];
Yb.__super__=m;Yb.prototype=r(m.prototype,{get_mazeCharacter:function(){return this._mazeCharacter},get_state:function(){return this._state},set_state:function(a){if(null!=this._state)this._state.onExit();this._state=a;this._state.onEnter();return this._state=a},update:function(){m.prototype.update.call(this);if(null!=this.get_state())this.get_state().onUpdate()},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);if(null!=this.get_state())this.get_state().onFixedUpdate()},moveInDirection:function(a){switch(a[1]){case 0:this._mazeCharacter.handleUpStay();
break;case 1:this._mazeCharacter.handleDownStay();break;case 2:this._mazeCharacter.handleLeftStay();break;case 3:this._mazeCharacter.handleRightStay()}},__class__:Yb,__properties__:{set_state:"set_state",get_state:"get_state",get_mazeCharacter:"get_mazeCharacter"}});var uc=function(a,b){this._type=a;this.tileNode=b};uc.__name__=["game","froggerGame","maze","mazeCharacters","ChangeTileEvent"];uc.__super__=L;uc.prototype=r(L.prototype,{__class__:uc});var vc=function(a){this._wasWalking=!1;this._timeUntilFootstep=
0;this._timePerFootstep=0.25;m.call(this,a);this._timeUntilFootstep=this._timePerFootstep};vc.__name__=["game","froggerGame","maze","mazeCharacters","FootstepController"];vc.__super__=m;vc.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._mazeCharacter=this.getComponent(wa)},update:function(){m.prototype.update.call(this);var a=y.__instanceof(this._mazeCharacter.get_state(),wc);a&&this.processFootstep();if(!this._wasWalking&&a)this.onFootstepTimeElapse();this._wasWalking=
a},processFootstep:function(){this._timeUntilFootstep-=p.getDeltaTime();if(0>=this._timeUntilFootstep)this.onFootstepTimeElapse()},onFootstepTimeElapse:function(){this._timeUntilFootstep=this._timePerFootstep;var a=this.getRandomFootstepSoundId();n.playSoundByName(a)},getRandomFootstepSoundId:function(){var a=S.randomInt(0,vc.FOOTSTEP_SOUNDS.length);return vc.FOOTSTEP_SOUNDS[a]},__class__:vc});var Gg=function(){};Gg.__name__=["game","playerInput","IDirectionalInputReceiver"];Gg.prototype={__class__:Gg};
var wa=function(a){this.canJumpOverHoles=this._isDead=this.isDoubleScoreActive=!1;this.respawnCoords=new s;this.direction=Q.South;this.hasMoved=!1;this.inputEnabled=!0;this.turnDuration=0.1;this.movementSpeed=500;Z.call(this,a);this._tweener=new ta(this.getEntity());this.audioSource=new ze(this.getEntity(),100)};wa.__name__=["game","froggerGame","maze","mazeCharacters","MazeCharacter"];wa.__interfaces__=[Gg];wa.__super__=Z;wa.prototype=r(Z.prototype,{get_isDead:function(){return this._isDead},get_velocity:function(){return this.velocityController.getVelocity()},
set_velocity:function(a){this.velocityController.setVelocity(a.x,a.y,a.z);return a},get_state:function(){return this._state},set_state:function(a){if(null!=this._state)this._state.onExit();this._state=a;this._state.onEnter();return a},attemptMoveInDirection:function(a){switch(a[1]){case 0:this.attemptMoveUp();break;case 1:this.attemptMoveDown();break;case 2:this.attemptMoveLeft();break;case 3:this.attemptMoveRight()}},attemptMoveUp:function(){},attemptMoveDown:function(){},attemptMoveLeft:function(){},
attemptMoveRight:function(){},startMovingToTile:function(a){},freeze:function(a,b){this.set_state(new cf(this,a,b))},update:function(){Z.prototype.update.call(this);if(null!=this.get_state())this.get_state().onUpdate()},fixedUpdate:function(){Z.prototype.fixedUpdate.call(this);if(null!=this.get_state())this.get_state().onFixedUpdate()},handleUpStart:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleUpStart()},handleUpEnd:function(){this.inputEnabled&&null!=this.get_state()&&
this.get_state().handleUpEnd()},handleDownStart:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleDownStart()},handleDownEnd:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleDownEnd()},handleLeftStart:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleLeftStart()},handleLeftEnd:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleLeftEnd()},handleRightStart:function(){this.inputEnabled&&null!=
this.get_state()&&this.get_state().handleRightStart()},handleRightEnd:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleRightEnd()},handleUpStay:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleUpStay()},handleDownStay:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleDownStay()},handleLeftStay:function(){this.inputEnabled&&null!=this.get_state()&&this.get_state().handleLeftStay()},handleRightStay:function(){this.inputEnabled&&
null!=this.get_state()&&this.get_state().handleRightStay()},attachToMaze:function(a,b,c){Z.prototype.attachToMaze.call(this,a,b,c);this.dispatchTileChangeEvent();this.dispatchTileChangeFinishEvent()},respawn:function(){this.moveToTileCoords(this.respawnCoords.x|0,this.respawnCoords.y|0);this.gotoIdle();this.dispatchEvent(new gb("respawn"));this.getEntity().setLocalScale(1,1);this.dispatchTileChangeEvent();this.dispatchTileChangeFinishEvent()},dispatchTileChangeEvent:function(){this.dispatchEvent(new uc("changeTileStart",
this._tileNode))},dispatchTileChangeFinishEvent:function(){this.dispatchEvent(new uc("changeTileEnd",this._tileNode))},dispatchCollectLostPuppyEvent:function(){this.dispatchEvent(new gb("collectLostPuppy"))},rotateToDirection:function(a,b){null==b&&(b=!1);this._tweener.destroyAllTweens();for(var c=S.getAngleInDegreesBetween2dVectors(new s(0,-1),a)+180,d=this.getEntity().getRotationRef().z,c=c-d;180<c;)c-=360;for(;-180>c;)c+=360;b?this.getEntity().setLocalRotation2d(d+c):this._tweener.addTween(this.getEntity().getRotationRef(),
"z",d,d+c,this.turnDuration,E.easeOutQuad)},setCharacterFlashing:function(a,b){null==b&&(b=10);null!=this.sprite&&(null==this._alphaOscillator&&(this._alphaOscillator=new db(this.sprite.getEntity(),this.sprite.getSprite(),"alpha",1,0,b)),a?(this._alphaOscillator.setRate(b),this._alphaOscillator.setMagnitude(1)):(this._alphaOscillator.setMagnitude(0),this.sprite.getSprite().alpha=1))},hit:function(){this._isDead||(this.dispatchEvent(new gb("hit")),this._isDead=!0)},fallToDeath:function(){this._isDead||
(this.set_state(new Nd(this,(Ha=this.get_maze().mazeGameController,w(Ha,Ha.onPlayerFallIntoHole)))),this._isDead=!0)},fallIntoWater:function(){this._isDead||(this.set_state(new xc(this,(Ha=this.get_maze().mazeGameController,w(Ha,Ha.onPlayerFallIntoHole)))),this._isDead=!0)},gotoIdle:function(){this.set_state(new Fb(this))},__class__:wa,__properties__:r(Z.prototype.__properties__,{set_state:"set_state",get_state:"get_state",set_velocity:"set_velocity",get_velocity:"get_velocity",get_isDead:"get_isDead"})});
var df=function(a){this._canMoveBackwards=!1;wa.call(this,a)};df.__name__=["game","froggerGame","maze","mazeCharacters","FroggerMazeCharacter"];df.__super__=wa;df.prototype=r(wa.prototype,{attemptMoveUp:function(){if(this.get_isTileAboveTraversable()){var a=this.get_tileAbove();this.startMovingToTile(a)}},attemptMoveDown:function(){if(this._canMoveBackwards&&this.get_isTileBelowTraversable()){var a=this.get_tileBelow();this.startMovingToTile(a)}},attemptMoveLeft:function(){if(this.get_isTileLeftTraversable()){var a=
this.get_tileLeft();this.startMovingToTile(a)}},attemptMoveRight:function(){if(this.get_isTileRightTraversable()){var a=this.get_tileRight();this.startMovingToTile(a)}},startMovingToTile:function(a){var b=a.getDirectionRelativeToTile(this.get_tileNode());this.set_state(new wc(this,a));this.direction=b;this.hasMoved=!0},update:function(){wa.prototype.update.call(this)},__class__:df});var Ne=function(a,b){this._maze=a;this._mazeGameController=b};Ne.__name__=["game","froggerGame","maze","mazeCharacters",
"FroggerMazeCharacterFactory"];Ne.prototype={createScooby:function(a,b){var c=this.createMazeCharacter(a,b);c.getEntity().setName("Player");c.movementSpeed=500;new ef(c.getEntity(),c);new ff(c.getEntity(),c);new Vc(c.getEntity());var d=c.addEntity();(new B(d,"scoobyShadow")).setAnchor(0.5,0.5);d=c.addEntity();(new B(d,"spawnBlur")).setAnchor(0.5,0.5);new Cd(d);new db(d,d.getScaleRef(),"x",1,0.1,15,null,5);new db(d,d.getScaleRef(),"y",1,0.1,15,null,5);d=c.addEntity();d=new va(d,"scoobyWalk");c.sprite=
d;new Dd(c.getEntity());new gf(c.getEntity(),this._mazeGameController);c.set_state(new Fb(c));new Qa(c.getEntity());new vc(c.getEntity());return c},createGhost:function(a,b){var c=this.createVillain(a,b),d=c.addEntity(),d=new va(d,"ghostWalk");c.sprite=d;return c},createMonsterMan:function(a,b){var c=this.createVillain(a,b),d=c.addEntity(),d=new va(d,"mountainManWalk");c.sprite=d;return c},createScarecrow:function(a,b){var c=this.createVillain(a,b),d=c.addEntity(),d=new va(d,"scarecrowWalk");c.sprite=
d;return c},createVillain:function(a,b){var c=this.createMazeCharacter(a,b);c.movementSpeed=115;var d=c.addEntity();(new B(d,"villainShadow")).setAnchor(0.5,0.5);new Yb(c.getEntity(),c);new Vb(c.getEntity(),this._mazeGameController.get_player());c.set_state(new Fb(c));return c},createMazeCharacter:function(a,b){var c=this._maze.charactersLayer.addEntity(),c=new df(c);c.velocityController=new mc(c.getEntity());c.attachToMaze(this._maze,a,b);return c},__class__:Ne};var Hg=function(a,b){Yb.call(this,
a,b)};Hg.__name__=["game","froggerGame","maze","mazeCharacters","GridAiController"];Hg.__super__=Yb;Hg.prototype=r(Yb.prototype,{get_gridMazeCharacter:function(){return this._mazeCharacter},__class__:Hg,__properties__:r(Yb.prototype.__properties__,{get_gridMazeCharacter:"get_gridMazeCharacter"})});var Od=function(a){this.canBreakThroughWalls=!1;wa.call(this,a)};Od.__name__=["game","froggerGame","maze","mazeCharacters","GridMazeCharacter"];Od.__super__=wa;Od.prototype=r(wa.prototype,{get_gridMaze:function(){return this.get_maze()},
get_nodeBehind:function(){var a=null,b=this.get_mazeCoords().x|0,c=this.get_mazeCoords().y|0;switch(this.direction[1]){case 0:a=c>=this.get_gridMaze().gridHeight-1?this.get_gridMaze().getTileNodeAt(b,0):this.get_gridMaze().getTileBelow(b,c);break;case 1:a=0>=c?this.get_gridMaze().getTileNodeAt(b,this.get_gridMaze().gridHeight-1):this.get_gridMaze().getTileAbove(b,c);break;case 2:a=b>=this.get_gridMaze().gridWidth-1?this.get_gridMaze().getTileNodeAt(0,c):this.get_gridMaze().getTileRight(b,c);break;
case 3:a=0>=b?this.get_gridMaze().getTileNodeAt(this.get_gridMaze().gridWidth-1,c):this.get_gridMaze().getTileLeft(b,c)}return a},get_isExitAbove:function(){var a=this._mazeCoords.x|0,b=this._mazeCoords.y|0;return this.get_gridMaze().isExitAbove(a,b)},get_isExitBelow:function(){var a=this._mazeCoords.x|0,b=this._mazeCoords.y|0;return this.get_gridMaze().isExitBelow(a,b)},get_isExitLeft:function(){var a=this._mazeCoords.x|0,b=this._mazeCoords.y|0;return this.get_gridMaze().isExitLeft(a,b)},get_isExitRight:function(){var a=
this._mazeCoords.x|0,b=this._mazeCoords.y|0;return this.get_gridMaze().isExitRight(a,b)},attemptMoveUp:function(){if(this.get_isWallAbove())if(this.canBreakThroughWalls&&this.get_gridMaze().canSmashTop(this._tileNode))this.get_gridMaze().smashWallTop(this._tileNode);else{this.gotoIdle();return}if(this.get_isExitAbove())if(this._tileNode.get_isExitActive())this.exitLevel(Q.North);else{var a=this.get_gridMaze().getTileNodeAt(this._tileNode.get_loopCounterpartCoords().x|0,this._tileNode.get_loopCounterpartCoords().y|
0);this.loopToTile(this._tileNode,a)}else this.get_isTileAboveTraversable()&&(a=this.get_tileAbove(),this.startMovingToTile(a))},attemptMoveDown:function(){if(this.get_isWallBelow())if(this.canBreakThroughWalls&&this.get_gridMaze().canSmashBottom(this._tileNode))this.get_gridMaze().smashWallBottom(this._tileNode);else{this.gotoIdle();return}if(this.get_isExitBelow())if(this._tileNode.get_isExitActive())this.exitLevel(Q.South);else{var a=this.get_gridMaze().getTileNodeAt(this._tileNode.get_loopCounterpartCoords().x|
0,this._tileNode.get_loopCounterpartCoords().y|0);this.loopToTile(this._tileNode,a)}else this.get_isTileBelowTraversable()&&(a=this.get_tileBelow(),this.startMovingToTile(a))},attemptMoveLeft:function(){if(this.get_isWallLeft())if(this.canBreakThroughWalls&&this.get_gridMaze().canSmashLeft(this._tileNode))this.get_gridMaze().smashWallLeft(this._tileNode);else{this.gotoIdle();return}if(this.get_isExitLeft())if(this._tileNode.get_isExitActive())this.exitLevel(Q.West);else{var a=this.get_gridMaze().getTileNodeAt(this._tileNode.get_loopCounterpartCoords().x|
0,this._tileNode.get_loopCounterpartCoords().y|0);this.loopToTile(this._tileNode,a)}else this.get_isTileLeftTraversable()&&(a=this.get_tileLeft(),this.startMovingToTile(a))},attemptMoveRight:function(){if(this.get_isWallRight())if(this.canBreakThroughWalls&&this.get_gridMaze().canSmashRight(this._tileNode))this.get_gridMaze().smashWallRight(this._tileNode);else{this.gotoIdle();return}if(this.get_isExitRight())if(this._tileNode.get_isExitActive())this.exitLevel(Q.East);else{var a=this.get_gridMaze().getTileNodeAt(this._tileNode.get_loopCounterpartCoords().x|
0,this._tileNode.get_loopCounterpartCoords().y|0);this.loopToTile(this._tileNode,a)}else this.get_isTileRightTraversable()&&(a=this.get_tileRight(),this.startMovingToTile(a))},startMovingToTile:function(a){var b=a.getDirectionRelativeToTile(this.get_tileNode());if(a.isDangerous&&this.canJumpOverHoles){var c=a.coordsX;a=a.coordsY;switch(b[1]){case 0:--a;break;case 1:++a;break;case 2:--c;break;case 3:++c}c=this.get_gridMaze().getTileNodeAt(c,a);this.set_state(new Pd(this,c))}else this.set_state(new wc(this,
a));this.direction=b;this.hasMoved=!0},loopToTile:function(a,b){var c=b.getEntity().getPosition(),d=a.getDirectionRelativeToTile(b);switch(d[1]){case 0:c.y+=b.get_height();break;case 1:c.y-=b.get_height();break;case 2:c.x+=b.get_width();break;case 3:c.x-=b.get_width()}this.getEntity().setPosition(c.x,c.y);c=new wc(this,b);c.set_movementDirection(d);this.set_state(c)},exitLevel:function(a){switch(a[1]){case 0:this.rotateToDirection(new s(0,-1),!1);break;case 1:this.rotateToDirection(new s(0,1),!1);
break;case 2:this.rotateToDirection(new s(-1,0),!1);break;case 3:this.rotateToDirection(new s(1,0),!1)}this.dispatchEvent(new gb("exitLevel"))},__class__:Od,__properties__:r(wa.prototype.__properties__,{get_isExitRight:"get_isExitRight",get_isExitLeft:"get_isExitLeft",get_isExitBelow:"get_isExitBelow",get_isExitAbove:"get_isExitAbove",get_nodeBehind:"get_nodeBehind",get_gridMaze:"get_gridMaze"})});var gb=function(a){this._type=a};gb.__name__=["game","froggerGame","maze","mazeCharacters","MazeCharacterEvent"];
gb.__super__=L;gb.prototype=r(L.prototype,{__class__:gb});var Dd=function(a){m.call(this,a)};Dd.__name__=["game","froggerGame","maze","mazeCharacters","MazeCharacterItemCollector"];Dd.__super__=m;Dd.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._mazeCharacter=this.getComponent(wa);this._mazeCharacter.addEventListener("changeTileStart",w(this,this.onChangeTile))},onChangeTile:function(a){a=a.tileNode.get_attachedObjects();for(var b=0;b<a.length;){var c=a[b];++b;y.__instanceof(c,
af)&&(c.collect(this._mazeCharacter.getEntity()),this.dispatchEvent(new Jd("collect",c)))}},__class__:Dd});var Vb=function(a,b){this.playSoundIdsOnHitPlayer=null;m.call(this,a);this._player=b};Vb.__name__=["game","froggerGame","maze","mazeCharacters","MazeCharacterPlayerDamager"];Vb.__super__=m;Vb.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this)},onRespawn:function(a){this.setActive(!0)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);this._player.get_isDead()||this.checkForPlayer()},
checkForPlayer:function(){if(!(35<this._player.getEntity().getPosition().subtract(this.getEntity().getPosition()).getLength())){this._player.hit();if(null!=this.playSoundIdsOnHitPlayer){var a=S.randomInt(0,this.playSoundIdsOnHitPlayer.length);n.playSoundByName(this.playSoundIdsOnHitPlayer[a])}this.setActive(!1)}},__class__:Vb});var gf=function(a,b){this.respawnCoords=new s;m.call(this,a);this._mazeGameController=b};gf.__name__=["game","froggerGame","maze","mazeCharacters","RespawnPlayerOnHit"];gf.__super__=
m;gf.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._mazeCharacter=this.getComponent(wa);this._mazeCharacter.addEventListener("hit",w(this,this.onHit))},onHit:function(a){this._mazeGameController.onVillainHitPlayer()},__class__:gf});var Cd=function(a){this._timeUntilFade=0;m.call(this,a);this._tweener=new ta(this.getEntity())};Cd.__name__=["game","froggerGame","maze","mazeCharacters","SpawnGlow"];Cd.__super__=m;Cd.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);
null==this._pixiSprite&&(this._pixiSprite=this.getComponent(B),this._pixiSprite.getSprite().alpha=0)},update:function(){m.prototype.update.call(this);0<this._timeUntilFade&&(this._timeUntilFade-=p.getDeltaTime(),0>=this._timeUntilFade&&(this.onFadeTimeElapse(),this._timeUntilFade=0))},glow:function(a){null==this._pixiSprite&&(this._pixiSprite=this.getComponent(B));this._pixiSprite.getSprite().alpha=1;this._timeUntilFade=a},onFadeTimeElapse:function(){this._tweener.addTween(this._pixiSprite.getSprite(),
"alpha",1,0,0.5,E.linear)},__class__:Cd});var $c=function(a){this.context=a};$c.__name__="game froggerGame maze mazeCharacters aiStates AiState".split(" ");$c.prototype={onEnter:function(){},onUpdate:function(){},onFixedUpdate:function(){},onExit:function(){},__class__:$c};var nb=function(a){this.context=a};nb.__name__="game froggerGame maze mazeCharacters aiStates GridAiState".split(" ");nb.__super__=$c;nb.prototype=r($c.prototype,{get_gridAiController:function(){return this.context},__class__:nb,
__properties__:{get_gridAiController:"get_gridAiController"}});var hf=function(a){this._lifetime=0;this.context=a;this._lifetime=a.chaseLifetime};hf.__name__="game froggerGame maze mazeCharacters aiStates ChasePlayerState".split(" ");hf.__super__=nb;hf.prototype=r(nb.prototype,{onEnter:function(){nb.prototype.onEnter.call(this)},onUpdate:function(){nb.prototype.onUpdate.call(this);if(null==this._player||this._player.isMarkedForDeletion())this._player=this.context.getEntity().getGameState().findEntityByName("Player").getComponent(Od);
var a=this._player.get_maze().getAllTileNodes(),b=Ra.findPath(a,this.context.get_mazeCharacter().get_tileNode(),this._player.get_tileNode(),w(this,this.getConnectedNodes));null==b&&(b=Ra.findPath(a,this.context.get_mazeCharacter().get_tileNode(),this._player.get_tileNode(),w(this,this.getConnectedNodesLenient)));null!=b&&1<b.length&&(a=b[1],null==this.context.get_mazeCharacter().get_tileNode().get_loopCounterpartCoords()||this.context.get_mazeCharacter().get_tileNode().get_loopCounterpartCoords().x!=
a.x||this.context.get_mazeCharacter().get_tileNode().get_loopCounterpartCoords().y!=a.y?this.context.moveInDirection(a.getDirectionRelativeToTile(this.context.get_mazeCharacter().get_tileNode())):this.context.moveInDirection(this.context.get_mazeCharacter().get_tileNode().getDirectionRelativeToTile(a)));this._lifetime-=p.getDeltaTime();if(0>=this._lifetime)this.onLifetimeElapse()},onLifetimeElapse:function(){this.context.set_state(new jf(this.get_gridAiController()))},getConnectedNodes:function(a){var b=
this.context.get_mazeCharacter().get_maze(),c=[],d=a==this.context.get_mazeCharacter().get_tileNode();this.context.get_mazeCharacter();var e=a.x|0,f=a.y|0,g=this.get_gridAiController().get_gridMazeCharacter().get_nodeBehind();if(!d||this.context.get_mazeCharacter().hasMoved)b.isWallLeft(e,f)||c.push(b.getTileLeft(e,f)),b.isWallAbove(e,f)||c.push(b.getTileAbove(e,f)),b.isWallRight(e,f)||c.push(b.getTileRight(e,f));b.isWallBelow(e,f)||c.push(b.getTileBelow(e,f));b.isExitBelow(e,f)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|
0,a.get_loopCounterpartCoords().y|0));b.isExitAbove(e,f)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitLeft(e,f)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitRight(e,f)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));for(a=c.length-1;0<=a;){e=c[a];if(null==e)c.splice(a,1);else for(b=0,e=e.get_attachedObjects();b<e.length;)f=e[b],++b,y.__instanceof(f,
Od)&&f!=this._player&&c.splice(a,1);--a}if(!this._player.canJumpOverHoles)for(a=c.length;0<=--a;)b=c[a],b.isDangerous&&F.remove(c,b);d&&F.remove(c,g);return c},getConnectedNodesLenient:function(a){var b=this.context.get_mazeCharacter().get_maze(),c=[];this.context.get_mazeCharacter().get_tileNode();this.context.get_mazeCharacter();var d=a.x|0,e=a.y|0;b.isWallLeft(d,e)||c.push(b.getTileLeft(d,e));b.isWallAbove(d,e)||c.push(b.getTileAbove(d,e));b.isWallRight(d,e)||c.push(b.getTileRight(d,e));b.isWallBelow(d,
e)||c.push(b.getTileBelow(d,e));b.isExitBelow(d,e)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitAbove(d,e)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitLeft(d,e)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));b.isExitRight(d,e)&&c.push(b.getTileNodeAt(a.get_loopCounterpartCoords().x|0,a.get_loopCounterpartCoords().y|0));for(a=c.length-1;0<=
a;)null==c[a]&&c.splice(a,1),--a;return c},__class__:hf});var Ig=function(a){this.context=a};Ig.__name__="game froggerGame maze mazeCharacters aiStates IdleAiState".split(" ");Ig.__super__=$c;Ig.prototype=r($c.prototype,{__class__:Ig});var jf=function(a){this._lifetime=0;this._movementDirection=Q.North;this._timeUntilDirectionChange=0;this._minTimeUntilDirectionChange=this._maxTimeUntilDirectionChange=0.05;this.context=a;this._lifetime=a.scatterLifetime};jf.__name__="game froggerGame maze mazeCharacters aiStates ScatterAiState".split(" ");
jf.__super__=nb;jf.prototype=r(nb.prototype,{onEnter:function(){nb.prototype.onEnter.call(this);this.rollNextDirection()},onFixedUpdate:function(){nb.prototype.onFixedUpdate.call(this);this.processDirectionChange();this.moveInCurrentDirection();this._lifetime-=p.getDeltaTime();if(0>=this._lifetime)this.onLifetimeElapse()},onLifetimeElapse:function(){this.context.set_state(new hf(this.get_gridAiController()))},moveInCurrentDirection:function(){var a=!0,b=this.get_gridAiController().get_gridMazeCharacter();
switch(this._movementDirection[1]){case 0:this.shouldMoveToTile(b.get_tileAbove())||(a=!1);break;case 1:this.shouldMoveToTile(b.get_tileBelow())||(a=!1);break;case 2:this.shouldMoveToTile(b.get_tileLeft())||(a=!1);break;case 3:this.shouldMoveToTile(b.get_tileRight())||(a=!1)}if(a)this.context.moveInDirection(this._movementDirection);else if(a=this._movementDirection,this.rollNextDirection(),this._movementDirection==a)for(;this.rollNextDirectionLenient(),this._movementDirection==a;);},turnIfStuck:function(){},
shouldMoveToTile:function(a){return null==a||a.isDangerous?!1:!0},processDirectionChange:function(){this._timeUntilDirectionChange-=p.getDeltaTime();if(0>=this._timeUntilDirectionChange)this.onDirectionChangeTimeElapse()},onDirectionChangeTimeElapse:function(){this.rollNextDirection()},rollNextDirection:function(a){null==a&&(a=!1);var b=this.get_gridAiController().get_gridMazeCharacter(),c=b.get_nodeBehind().getDirectionRelativeToTile(this.context.get_mazeCharacter().get_tileNode()),d=[].concat(Q.__empty_constructs__);
b.get_isWallLeft()&&F.remove(d,Q.West);b.get_isWallRight()&&F.remove(d,Q.East);b.get_isWallBelow()&&F.remove(d,Q.South);b.get_isWallAbove()&&F.remove(d,Q.North);a||F.remove(d,c);a=S.randomInt(0,d.length);this._movementDirection=d[a];this._timeUntilDirectionChange=S.randomFloat(this._minTimeUntilDirectionChange,this._maxTimeUntilDirectionChange)},rollNextDirectionLenient:function(){this.rollNextDirection(!0)},__class__:jf});var W=function(a){this.context=a};W.__name__="game froggerGame maze mazeCharacters mazeCharacterStates MazeCharacterState".split(" ");
W.prototype={onEnter:function(){},onUpdate:function(){},onFixedUpdate:function(){},onExit:function(){},handleUpStart:function(){},handleUpStay:function(){},handleUpEnd:function(){},handleDownStart:function(){},handleDownStay:function(){},handleDownEnd:function(){},handleLeftStart:function(){},handleLeftStay:function(){},handleLeftEnd:function(){},handleRightStart:function(){},handleRightStay:function(){},handleRightEnd:function(){},__class__:W};var Nd=function(a,b){this._onComplete=null;this.context=
a;this._onComplete=b};Nd.__name__="game froggerGame maze mazeCharacters mazeCharacterStates FallDownHole".split(" ");Nd.__super__=W;Nd.prototype=r(W.prototype,{onEnter:function(){W.prototype.onEnter.call(this);this.context.velocityController.setAngularVelocity(new K(0,0,720));this._tweener=new ta(this.context.getEntity());this._tweener.addTween(this.context.getEntity().getScaleRef(),"x",1,0,0.2,E.easeInQuad);this._tweener.addTween(this.context.getEntity().getScaleRef(),"y",1,0,0.2,E.easeInQuad);this._deferredAction=
new Va(this.context.getEntity());this._deferredAction.addDeferredAction(0.35,w(this,this.onFallAnimationComplete));n.playSoundByName("sfx_hole_fall")},onExit:function(){W.prototype.onExit.call(this);this._deferredAction.destroy();this._tweener.destroy();this._tweener=null;this.context.velocityController.setAngularVelocity(new K(0,0,0));this.context.getEntity().setScale(1,1,1);this.context.getEntity().setRotation(0,0,0)},onFallAnimationComplete:function(){null!=this._onComplete&&this._onComplete();
this.context.velocityController.setVelocity(0,0,0)},__class__:Nd});var xc=function(a,b){this._onComplete=null;this.context=a;this._onComplete=b};xc.__name__="game froggerGame maze mazeCharacters mazeCharacterStates FallIntoWater".split(" ");xc.__super__=W;xc.prototype=r(W.prototype,{onEnter:function(){W.prototype.onEnter.call(this);this._tweener=new ta(this.context.getEntity());this._tweener.addTween(this.context.getEntity().getScaleRef(),"x",1,0,0.2,E.easeInQuad);this._tweener.addTween(this.context.getEntity().getScaleRef(),
"y",1,0,0.2,E.easeInQuad);this._deferredAction=new Va(this.context.getEntity());this._deferredAction.addDeferredAction(0.1,w(this,this.onFallAnimationComplete));n.playSoundByName("sfx_hole_fall")},onExit:function(){W.prototype.onExit.call(this);this._deferredAction.destroy();this._tweener.destroy();this._tweener=null;this.context.velocityController.setAngularVelocity(new K(0,0,0));this.context.getEntity().setScale(1,1,1);this.context.getEntity().setRotation(0,0,0)},onFallAnimationComplete:function(){null!=
this._onComplete&&this._onComplete();this.context.getEntity().setVisible(!1);var a=this.context.getEntity().getParent().addEntity(),b=this.context.getEntity().getPosition();a.setPosition(b.x,b.y);new va(a,"splash");a=S.randomInt(0,xc.SPLASH_SOUNDS.length);n.playSoundByName(xc.SPLASH_SOUNDS[a]);this.context.velocityController.setVelocity(0,0,0)},__class__:xc});var cf=function(a,b,c){this.context=a;this._flashing=c;this._gameController=b};cf.__name__="game froggerGame maze mazeCharacters mazeCharacterStates FreezeState".split(" ");
cf.__super__=W;cf.prototype=r(W.prototype,{onEnter:function(){W.prototype.onEnter.call(this);this.context.set_velocity(new K);var a=this.context.getEntity().getComponentsInChildren(va)[0];null!=a&&a.stop();this._flashing&&this.context.setCharacterFlashing(!0,40)},onExit:function(){W.prototype.onExit.call(this);this._flashing&&this.context.setCharacterFlashing(!1,0)},__class__:cf});var Fb=function(a){this.context=a};Fb.__name__="game froggerGame maze mazeCharacters mazeCharacterStates IdleState".split(" ");
Fb.__super__=W;Fb.prototype=r(W.prototype,{onEnter:function(){W.prototype.onEnter.call(this);this.context.set_velocity(new K);var a=this.context.getEntity().getComponentsInChildren(va)[0];null!=a&&a.stop()},onExit:function(){W.prototype.onExit.call(this)},handleUpStay:function(){W.prototype.handleUpStay.call(this);this.context.attemptMoveUp()},handleDownStay:function(){W.prototype.handleDownStay.call(this);this.context.attemptMoveDown()},handleLeftStay:function(){W.prototype.handleLeftStay.call(this);
this.context.attemptMoveLeft()},handleRightStay:function(){W.prototype.handleRightStay.call(this);this.context.attemptMoveRight()},__class__:Fb});var Pd=function(a,b){this.context=a;this._targetTile=b;this._movementDirection=this._targetTile.getDirectionRelativeToTile(a.get_tileNode())};Pd.__name__="game froggerGame maze mazeCharacters mazeCharacterStates JumpToTileState".split(" ");Pd.__super__=W;Pd.prototype=r(W.prototype,{get_movementDirection:function(){return this._movementDirection},set_movementDirection:function(a){return this._movementDirection=
a},onEnter:function(){W.prototype.onEnter.call(this);this._tweener=this.context.getComponent(ta);this._targetPosition=this._targetTile.getEntity().getPosition();var a=this._targetPosition.subtract(this.context.getEntity().getPosition());a.z=0;var b=a.getNormalized().getClone();b.scaleBy(this.context.movementSpeed);this.context.set_velocity(b);this._prevPosition=this.context.getEntity().getPosition();var c=this.context.getEntity().getComponentsInChildren(va)[0];null!=c&&c.stop();this.context.rotateToDirection((new s(b.x,
b.y)).getNormalized());this.context.attachToTile(this._targetTile);this.context.dispatchTileChangeEvent();a=a.getLength()/this.context.movementSpeed;this._tweener.addTween(this.context.getEntity().getScaleRef(),"x",1,1.5,0.5*a,E.easeOutQuad);this._tweener.addTween(this.context.getEntity().getScaleRef(),"y",1,1.5,0.5*a,E.easeOutQuad);this._tweener.addTween(this.context.getEntity().getScaleRef(),"x",1.5,1,0.5*a,E.easeInQuad,0.5*a);this._tweener.addTween(this.context.getEntity().getScaleRef(),"y",1.5,
1,0.5*a,E.easeInQuad,0.5*a);n.playSoundByName("sfx_jump_1")},onExit:function(){W.prototype.onExit.call(this);this._tweener.destroyAllTweens();this.context.getEntity().setLocalScale(1,1)},onFixedUpdate:function(){W.prototype.onFixedUpdate.call(this);var a=this._targetPosition.subtract(this._prevPosition).getNormalized(),b=this._targetPosition.subtract(this.context.getEntity().getPosition()).getNormalized();if(0>=K.dot(b,a))this.onPassPoint();this._prevPosition=this.context.getEntity().getPosition()},
onPassPoint:function(){if(this.context.get_tileNode().isDangerous){var a=this.context.get_maze(),b=a.mazeGameController.get_mazeGameConfig().jumpHoleScore;a.mazeGameController.addScore(b)}this.context.getEntity().setPosition(this._targetPosition.x,this._targetPosition.y);this.context.set_velocity(new K);this.context.set_state(new Fb(this.context))},handleUpStay:function(){W.prototype.handleUpStay.call(this);this._movementDirection=Q.North},handleLeftStay:function(){W.prototype.handleLeftStay.call(this);
this._movementDirection=Q.West},handleRightStay:function(){W.prototype.handleRightStay.call(this);this._movementDirection=Q.East},handleDownStay:function(){W.prototype.handleDownStay.call(this);this._movementDirection=Q.South},__class__:Pd,__properties__:{set_movementDirection:"set_movementDirection",get_movementDirection:"get_movementDirection"}});var wc=function(a,b){this._useBufferedDirection=!1;this.context=a;this._targetTile=b;this._bufferedDirection=this._movementDirection=this._targetTile.getDirectionRelativeToTile(a.get_tileNode())};
wc.__name__="game froggerGame maze mazeCharacters mazeCharacterStates MoveToTileState".split(" ");wc.__super__=W;wc.prototype=r(W.prototype,{get_movementDirection:function(){return this._movementDirection},set_movementDirection:function(a){return this._movementDirection=a},onEnter:function(){W.prototype.onEnter.call(this);this._targetPosition=this._targetTile.getEntity().getPosition();var a=this._targetPosition.subtract(this.context.getEntity().getPosition());a.z=0;a=a.getNormalized().getClone();
a.scaleBy(this.context.movementSpeed);this.context.set_velocity(a);this._prevPosition=this.context.getEntity().getPosition();var b=this.context.getEntity().getComponentsInChildren(va)[0];null!=b&&b.play();this.context.rotateToDirection((new s(a.x,a.y)).getNormalized());this.context.attachToTile(this._targetTile);this.context.dispatchTileChangeEvent()},onFixedUpdate:function(){W.prototype.onFixedUpdate.call(this);var a=this._targetPosition.subtract(this._prevPosition).getNormalized(),b=this._targetPosition.subtract(this.context.getEntity().getPosition()).getNormalized(),
c=0==this._targetPosition.subtract(this.context.getEntity().getPosition()).getLength(),a=K.dot(b,a);if(c||0>=a)this.onPassPoint();this._prevPosition=this.context.getEntity().getPosition()},onPassPoint:function(){if(this.context.get_tileNode().isDangerous){var a=this.context.get_maze().mazeGameController.get_mazeGameConfig().jumpHoleScore;this.context.get_maze().mazeGameController.addScore(a)}this.context.getEntity().setPosition(this._targetPosition.x,this._targetPosition.y);this.context.set_velocity(new K);
for(var a=0,b=this.context.get_tileNode().get_attachedObjects();a<b.length;){var c=b[a];++a;if(y.__instanceof(c,Qd)){c.addToCarrying(this.context);this.context.set_state(new Fb(this.context));this.context.dispatchTileChangeFinishEvent();return}}this.context.get_tileNode().isWater||this.context.get_tileNode().isHole?(this.context.get_tileNode().isWater?this.context.fallIntoWater():this.context.fallToDeath(),this.context.dispatchTileChangeFinishEvent()):(this.context.set_state(new Fb(this.context)),
this.context.dispatchTileChangeFinishEvent(),this._useBufferedDirection&&this.context.attemptMoveInDirection(this._bufferedDirection))},onExit:function(){W.prototype.onExit.call(this)},handleUpStay:function(){W.prototype.handleUpStay.call(this);this._bufferedDirection=Q.North;this.updateUseBufferedDirection()},handleLeftStay:function(){W.prototype.handleLeftStay.call(this);this._bufferedDirection=Q.West;this.updateUseBufferedDirection()},handleRightStay:function(){W.prototype.handleRightStay.call(this);
this._bufferedDirection=Q.East;this.updateUseBufferedDirection()},handleDownStay:function(){W.prototype.handleDownStay.call(this);this._bufferedDirection=Q.South;this.updateUseBufferedDirection()},updateUseBufferedDirection:function(){this._useBufferedDirection=this._bufferedDirection!=this._movementDirection},__class__:wc,__properties__:{set_movementDirection:"set_movementDirection",get_movementDirection:"get_movementDirection"}});var Rd=function(a){this._statusEffectController=a};Rd.__name__="game froggerGame maze mazeCharacters statusEffects StatusEffect".split(" ");
Rd.prototype={onActivate:function(){},onDeactivate:function(){},onUpdate:function(){},__class__:Rd};var Zb=function(a){this.duration=this.timeLeft=8;this._statusEffectController=a};Zb.__name__="game froggerGame maze mazeCharacters statusEffects TimedStatusEffect".split(" ");Zb.__super__=Rd;Zb.prototype=r(Rd.prototype,{onUpdate:function(){Rd.prototype.onUpdate.call(this);this.timeLeft-=p.getDeltaTime();if(0>=this.timeLeft)this.onTimeElapse()},onTimeElapse:function(){this._statusEffectController.removeStatusEffect(this)},
reset:function(){this.timeLeft=this.duration},__class__:Zb});var bf=function(a,b){Zb.call(this,a);this._target=b};bf.__name__="game froggerGame maze mazeCharacters statusEffects ScoobySnackStatusEffect".split(" ");bf.__super__=Zb;bf.prototype=r(Zb.prototype,{onActivate:function(){Zb.prototype.onActivate.call(this);this._target.isDoubleScoreActive=!0;this._effect=this._target.addEntity();new va(this._effect,"snackEffectOverlay")},onDeactivate:function(){Zb.prototype.onDeactivate.call(this);this.timeLeft=
0;this._target.audioSource.stop();this._target.isDoubleScoreActive=!1;this._effect.destroy()},__class__:bf});var Vc=function(a){this._statusEffects=[];m.call(this,a)};Vc.__name__="game froggerGame maze mazeCharacters statusEffects StatusEffectController".split(" ");Vc.__super__=m;Vc.prototype=r(m.prototype,{addStatusEffect:function(a){if(!(0<=this._statusEffects.indexOf(a))){for(var b=0,c=this._statusEffects;b<c.length;){var d=c[b];++b;y.__instanceof(a,null==d?null:y.getClass(d))&&this.removeStatusEffect(d)}this._statusEffects.push(a);
a.onActivate()}},removeStatusEffect:function(a){0>this._statusEffects.indexOf(a)||(F.remove(this._statusEffects,a),a.onDeactivate())},removeAllStatusEffects:function(){for(;0<this._statusEffects.length;)this.removeStatusEffect(this._statusEffects[0])},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);for(var a=[].concat(this._statusEffects),b=0;b<a.length;){var c=a[b];++b;c.onUpdate()}},__class__:Vc});var Qd=function(a,b){null==b&&(b=-1);this.oscillators=[];this._isShaking=!1;this._prevPosition=
new K;this._carrying=[];Z.call(this,a);this._timeUntilCollapse=this._collapseTime=b};Qd.__name__=["game","froggerGame","maze","platforms","Platform"];Qd.__super__=Z;Qd.prototype=r(Z.prototype,{init:function(){Z.prototype.init.call(this);this._froggerMaze=this._maze;this.stopShaking()},addToCarrying:function(a){this._carrying.push(a);a.addEventListener("changeTileStart",w(this,this.onMazeObjectChangeTileStart))},onMazeObjectChangeTileStart:function(a){this.removeFromCarrying(a.target)},removeFromCarrying:function(a){F.remove(this._carrying,
a)},fixedUpdate:function(){Z.prototype.fixedUpdate.call(this);var a=this.getEntity().getPosition().subtract(this._prevPosition),b=this._froggerMaze.localPositionToCoords(this.getEntity().getLocalPosition().x,this.getEntity().getLocalPosition().y);if(b.x>=this._froggerMaze.get_width())this.getEntity().destroy();else if(0>=b.x)this.getEntity().destroy();else if(null==this._maze.getTileNodeAt(b.x|0,b.y|0))this.getEntity().destroy();else{this.moveToTileCoordsWithoutReposition(b.x|0,b.y|0);for(var c=this._carrying.length,
d=0,e=this._carrying;d<e.length;){var f=e[d];++d;f.getEntity().translate(a.x,a.y);f.moveToTileCoordsWithoutReposition(b.x|0,b.y|0)}0<c?this.degradeIfCollapsible(p.getDeltaTime()):this._isShaking&&this.stopShaking();this._prevPosition=this.getEntity().getPosition()}},degradeIfCollapsible:function(a){0>=this._timeUntilCollapse||(this._isShaking||this.startShaking(),this._timeUntilCollapse-=a,0>=this._timeUntilCollapse&&this.collapse())},collapse:function(){this.getEntity().destroy()},destroy:function(){Z.prototype.destroy.call(this);
this.dropCarriedCharacters()},startShaking:function(){for(var a=0,b=this.oscillators;a<b.length;){var c=b[a];++a;c.setActive(!0)}this._isShaking=!0},stopShaking:function(){for(var a=0,b=this.oscillators;a<b.length;){var c=b[a];++a;c.setActive(!1)}this._isShaking=!1},dropCarriedCharacters:function(){for(var a=0,b=this._carrying;a<b.length;){var c=b[a];++a;y.__instanceof(c,wa)&&c.fallToDeath()}},__class__:Qd});var Yc=function(a,b,c){this.maxObjectsActive=-1;this.maxTimeUntilSpawn=2;this.minTimeUntilSpawn=
1;this._spawnedObjects=[];this._timeUntilSpawn=2;Z.call(this,a);this._mazeObjectSpawnerFactory=c;this._typesToSpawn=b;this.rollNextSpawn()};Yc.__name__=["game","froggerGame","maze","spawners","MazeObjectSpawner"];Yc.__super__=Z;Yc.prototype=r(Z.prototype,{fixedUpdate:function(){Z.prototype.fixedUpdate.call(this);this._timeUntilSpawn-=p.getDeltaTime();if(0>=this._timeUntilSpawn)this.onSpawnTimeElapse()},rollNextSpawn:function(){this._timeUntilSpawn=S.randomFloat(this.minTimeUntilSpawn,this.maxTimeUntilSpawn)},
onSpawnTimeElapse:function(){if(!(0<this.maxObjectsActive&&this._spawnedObjects.length>=this.maxObjectsActive)){var a=S.randomInt(0,this._typesToSpawn.length),a=this._mazeObjectSpawnerFactory.spawnObjectByType(this._typesToSpawn[a],this.get_mazeCoords().x|0,this.get_mazeCoords().y|0);this._spawnedObjects.push(a);a.addEventListener("destroy",w(this,this.onDestroyMazeObject));this.rollNextSpawn()}},onDestroyMazeObject:function(a){F.remove(this._spawnedObjects,a.target)},__class__:Yc});var $b=function(a){this._maze=
a};$b.__name__=["game","froggerGame","maze","spawners","MazeObjectSpawnerFactory"];$b.prototype={spawnObjectByType:function(a,b,c){throw new H("Not implemented.");},__class__:$b};var Ve=function(a){this.platformSpeed=125;this._maze=a};Ve.__name__=["game","froggerGame","maze","spawners","MineCartSpawnerFactory"];Ve.__super__=$b;Ve.prototype=r($b.prototype,{spawnObjectByType:function(a,b,c){var d=null;switch(a){case "mineCart1":d=this.createMineCart1(b,c);break;case "mineCart2":d=this.createMineCart1(b,
c)}return d},createMineCart1:function(a,b){var c=this.createMineCart(a,b),d=c.addEntity();(new B(d,"mineCart1")).setAnchor(0.5,0.5);return c},createMineCart2:function(a,b){var c=this.createMineCart(a,b),d=c.addEntity();(new B(d,"mineCart2")).setAnchor(0.5,0.5);return c},createMineCart:function(a,b){var c=this._maze.backgroundLayer.addEntity(),d=new Z(c);d.attachToMaze(this._maze,a,b);(new Vb(c,this._maze.mazeGameController.get_player())).playSoundIdsOnHitPlayer=["sfxMinecartImpact1","sfxMinecartImpact2"];
(new mc(c,null)).setVelocity(this.platformSpeed,0,0);return d},__class__:Ve});var We=function(a){this.platformSpeed=125;this._maze=a};We.__name__=["game","froggerGame","maze","spawners","MinerFortyNinerSpawnerFactory"];We.__super__=$b;We.prototype=r($b.prototype,{spawnObjectByType:function(a,b,c){a=null;return a=this.createMinerFortyNiner(b,c)},createMinerFortyNiner:function(a,b){var c=this._maze.backgroundLayer.addEntity(),d=c.addEntity();new va(d,"mountainManWalk");var e=new Z(c);e.attachToMaze(this._maze,
a,b);new Vb(c,this._maze.mazeGameController.get_player());(new mc(c,null)).setVelocity(this.platformSpeed,0,0);0<this.platformSpeed?d.setLocalRotation2d(-90):d.setLocalRotation2d(90);return e},__class__:We});var Ue=function(a){this.platformSpeed=125;this._maze=a};Ue.__name__=["game","froggerGame","maze","spawners","WaterPlatformSpawnerFactory"];Ue.__super__=$b;Ue.prototype=r($b.prototype,{spawnObjectByType:function(a,b,c){var d=null;switch(a){case "barrel":d=this.createBarrel(b,c);break;case "collapsiblePlank1":d=
this.createCollapsiblePlank1(b,c);break;case "plank1":d=this.createPlank1(b,c)}return d},createPlank1:function(a,b){var c=this.createWaterPlatform(a,b),d=c.addEntity();(new B(d,"waterPlank")).setAnchor(0.5,0.5);return c},createPlank2:function(a,b){var c=this.createWaterPlatform(a,b),d=c.addEntity();(new B(d,"waterCollapsable")).setAnchor(0.5,0.5);return c},createCollapsiblePlank1:function(a,b){var c=this.createWaterPlatform(a,b,2),d=c.addEntity(),e=new db(d,d.getPositionRef(),"y",0,2,45);c.oscillators=
[e];(new B(d,"waterPlankCollapsible")).setAnchor(0.5,0.5);return c},createBarrel:function(a,b){var c=this.createWaterPlatform(a,b),d=c.addEntity();(new B(d,"waterBarrel")).setAnchor(0.5,0.5);return c},createWaterPlatform:function(a,b,c){null==c&&(c=-1);var d=this._maze.backgroundLayer.addEntity();c=new Qd(d,c);c.attachToMaze(this._maze,a,b);(new mc(d,null)).setVelocity(this.platformSpeed,0,0);return c},__class__:Ue});var xd=function(a,b){m.call(this,a);this._mazeGameController=b};xd.__name__=["game",
"gameplay","Hud"];xd.__super__=m;xd.prototype=r(m.prototype,{get_uiPanel:function(){return this._uiPanel},getButtonGroup:function(){return this._buttonGroup},init:function(){m.prototype.init.call(this);this.construct()},construct:function(){this._uiPanel=Ea.createFullscreenUiPanel(this.getGameState());this._buttonGroup=new kc(this._uiPanel.getEntity());var a=this._uiPanel.addEntity();(new X(a,this._uiPanel)).setCoords(new s(0,-1));(new B(a,"hudOverlay")).setAnchor(0.5,0);a=this._uiPanel.addEntity();
(new X(a,this._uiPanel)).setCoords(new s(0,-0.85));(new B(a,"hudScoreBg")).setAnchor(0.5,0.5);var b={fontFamily:"riffic_free_mediumbold",fill:"#44FF44",fontSize:16},c=a.addEntity();c.setLocalPosition(-7,0);(new na(c,oa.getString("HUD_SCORE"),b)).getText().anchor.x=1;b.fill="#FFFFFF";b.fontSize=22;c=a.addEntity();c.setLocalPosition(-2,0);(new na(c,"",b)).getText().anchor.x=0;new kf(c,this.scoreController);a=a.addEntity();a.setLocalPosition(-99,0);b=a.addEntity();(new B(b,"score2xIcon")).setAnchor(0.5,
0.5);new db(b,a.getRotationRef(),"z",0,10,10);new lf(a,this.snackController);a=new xb;a.deactivateButtonOnClick=!1;a.x=0.91796875;a.y=-0.8472222222222222;a.defaultImageName="buttonPause";this._pauseButton=Wa.createButton(a,this._uiPanel.getEntity(),w(this,this.onPauseClick));a=this._uiPanel.addEntity();(new X(a,this._uiPanel)).setCoords(new s(-0.45,-0.875));(new B(a,"snackMeterBg")).setAnchor(0.5,0.5);b=a.addEntity();b.setLocalPosition(-16,3);b=new B(b,"snackMeter");b.setAnchor(0,0.5);(new mf(a,this.snackController)).meterSprite=
b;a=this._uiPanel.addEntity();(new X(a,this._uiPanel)).setCoords(new s(-0.85,-0.85));(new B(a,"animalHudLife")).setAnchor(0.5,0.5);a=a.addEntity();a.setLocalPosition(12,-10);(new na(a,"",{fontFamily:"riffic_free_mediumbold",fill:"#44FF44",fontSize:16,fill:"#FFFFFF",fontSize:22})).getText().anchor.x=0;new nf(a,this.scoreController)},onPauseClick:function(){this.dispatchEvent(new Tb(Tb.SHOW_MENU))},destroy:function(){m.prototype.destroy.call(this);null!=this._uiPanel&&this._uiPanel.getEntity().destroy()},
__class__:xd,__properties__:{get_uiPanel:"get_uiPanel"}});var Tb=function(a){this._type=a};Tb.__name__=["game","gameplay","HudEvent"];Tb.__super__=L;Tb.prototype=r(L.prototype,{__class__:Tb});var of=function(a,b){m.call(this,a);this._levelStats=new Jg;this._gameController=b};of.__name__=["game","gameplay","Level"];of.__super__=m;of.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);ub.getInstance().addEventListener("beatLevel",w(this,this.onBeatLevel));var a=this.addEntity();a.setScale(2,
2);var b=new B(a,"grayBg");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;a.setPosition(0.5*p.getInstance().getGameWidth(),0.5*p.getInstance().getGameHeight());a=Ea.createFullscreenUiPanel(this.getGameState());b=this.addEntity();(new X(b,a)).setCoords(new s(0,0));this._mazeGameController=new Rc(b,this._gameController,this)},update:function(){m.prototype.update.call(this)},showLevelComplete:function(){var a=this.getGameState().getSceneRoot().addEntity();(new pf(a,this._levelStats,this._gameController)).addEventListener("destroy",
w(this,this.onLevelCompleteDestroy));this.removeDebugListeners()},onLevelCompleteDestroy:function(a){a.target.removeEventListener("destroy",w(this,this.onLevelCompleteDestroy));this.getGameState().destroy()},onLevelFailDestroy:function(a){a.target.removeEventListener("destroy",w(this,this.onLevelFailDestroy));this.getGameState().destroy()},removeDebugListeners:function(){ub.getInstance().removeEventListener("beatLevel",w(this,this.onBeatLevel))},onBeatLevel:function(a){this.showLevelComplete()},__class__:of});
var Jg=function(){this._score=this._levelTime=0};Jg.__name__=["game","gameplay","LevelStats"];Jg.prototype={getScore:function(){return this._score},setScore:function(a){this._score=a},setLevelTime:function(a){this._levelTime=a},getLevelTime:function(){return this._levelTime},__class__:Jg};var Kg=function(){};Kg.__name__=["game","gestures","IGesture"];Kg.prototype={__class__:Kg,__properties__:{get_completionPercent:"get_completionPercent"}};var Xa=function(){this._eventListeners=[]};Xa.__name__=["game",
"gestures","Gesture"];Xa.__interfaces__=[Kg];Xa.__super__=ua;Xa.prototype=r(ua.prototype,{get_completionPercent:function(){throw new H("Not implemented");},onStartInput:function(a,b){},onMoveInput:function(a,b){},onStopInput:function(){},onComplete:function(){this.dispatchEvent(new Sd("complete"))},__class__:Xa,__properties__:{get_completionPercent:"get_completionPercent"}});var yc=function(a){this._boundsWh=new s;this._boundsUl=new s;this._useBounds=!1;this._eventListeners=[];this._inputService=
a};yc.__name__=["game","gestures","GestureDetector"];yc.__super__=ua;yc.prototype=r(ua.prototype,{get_useBounds:function(){return this._useBounds},set_useBounds:function(a){return this._useBounds=a},get_boundsUl:function(){return this._boundsUl},set_boundsUl:function(a){return this._boundsUl=a},get_boundsWh:function(){return this._boundsWh},set_boundsWh:function(a){return this._boundsWh=a},get_gesture:function(){return this._gesture},set_gesture:function(a){null!=this._gesture&&this._gesture.removeEventListener("complete",
w(this,this.onGestureComplete));this._gesture=a;null!=this._gesture&&this._gesture.addEventListener("complete",w(this,this.onGestureComplete));return this._gesture},update:function(){this.updateGesture()},updateGesture:function(){if(null!=this._gesture)if(this._inputService.get_pointerDownThisFrame())this._inputService.get_pointerPosition(),this._gesture.onStartInput(this._inputService.get_pointerPosition().x,this._inputService.get_pointerPosition().y);else if(this._inputService.get_pointerDown()){if(!this._useBounds||
this.isCursorInBounds()){var a=this._inputService.get_pointerDelta();this._gesture.onMoveInput(a.x,a.y)}}else if(this._inputService.get_pointerUpThisFrame())this._gesture.onStopInput()},isCursorInBounds:function(){var a=this._inputService.get_pointerPosition();return a.x>this._boundsUl.x&&a.x<this._boundsUl.x+this._boundsWh.x&&a.y>this._boundsUl.y?a.y<this._boundsUl.y+this._boundsWh.y:!1},onGestureComplete:function(a){this.dispatchEvent(a)},__class__:yc,__properties__:{set_gesture:"set_gesture",get_gesture:"get_gesture",
set_boundsWh:"set_boundsWh",get_boundsWh:"get_boundsWh",set_boundsUl:"set_boundsUl",get_boundsUl:"get_boundsUl",set_useBounds:"set_useBounds",get_useBounds:"get_useBounds"}});var Sd=function(a){this._type=a};Sd.__name__=["game","gestures","GestureEvent"];Sd.__super__=L;Sd.prototype=r(L.prototype,{__class__:Sd});var Lg=function(){};Lg.__name__=["game","gestures","IGestureInputService"];Lg.prototype={__class__:Lg,__properties__:{get_pointerDelta:"get_pointerDelta",get_pointerPosition:"get_pointerPosition",
get_pointerUpThisFrame:"get_pointerUpThisFrame",get_pointerDown:"get_pointerDown",get_pointerDownThisFrame:"get_pointerDownThisFrame"}};var zc=function(a,b){this._resetOnBreakLine=this._endLineOnComplete=this._swipeAllowed=!0;this._lineDotTolerance=0.35;this._totalSwipeCompletion=0;this._eventListeners=[];this._direction=a;this._swipeLength=b};zc.__name__=["game","gestures","LineSwipeGesture"];zc.__super__=Xa;zc.prototype=r(Xa.prototype,{get_resetOnBreakLine:function(){return this._resetOnBreakLine},
set_resetOnBreakLine:function(a){return this._resetOnBreakLine=a},get_direction:function(){return this._direction},get_completionPercent:function(){return Math.min(1,this._totalSwipeCompletion/this._swipeLength)},onStartInput:function(a,b){this._totalSwipeCompletion=0},onMoveInput:function(a,b){if(this._swipeAllowed){var c=(new s(a,b)).getLength();if(!(0>=c)){var d=(new s(a,b)).getNormalized(),d=this._direction.getNormalized().dotProduct(d);d<1-this._lineDotTolerance?this.get_resetOnBreakLine()&&
(this._totalSwipeCompletion=0):(this._totalSwipeCompletion+=d*c,this._totalSwipeCompletion>=this._swipeLength&&(this.onComplete(),this._endLineOnComplete&&(this._swipeAllowed=!1)))}}},onStopInput:function(){Xa.prototype.onStopInput.call(this);this._swipeAllowed=!0},__class__:zc,__properties__:r(Xa.prototype.__properties__,{get_direction:"get_direction",set_resetOnBreakLine:"set_resetOnBreakLine",get_resetOnBreakLine:"get_resetOnBreakLine"})});var ac=function(a,b){this._mousePosition=new s(0,0);this._prevMousePosition=
new s(0,0);this._prevPointerDown=this._pointerDown=!1;this._inputManager=null;m.call(this,a);this._inputManager=b};ac.__name__=["game","gestures","MouseGestureInput"];ac.__interfaces__=[Lg];ac.__super__=m;ac.prototype=r(m.prototype,{get_pointerDownThisFrame:function(){return this._prevPointerDown?!1:this._pointerDown},get_pointerDown:function(){return this._pointerDown},get_pointerUpThisFrame:function(){return this._prevPointerDown?!this._pointerDown:!1},get_pointerPosition:function(){return new K(this._mousePosition.x,
this._mousePosition.y)},get_pointerDelta:function(){return new K(this._mousePosition.x-this._prevMousePosition.x,this._mousePosition.y-this._prevMousePosition.y)},update:function(){m.prototype.update.call(this);this._prevMousePosition=new s(this.get_pointerPosition().x,this.get_pointerPosition().y);this._prevPointerDown=this.get_pointerDown();this._pointerDown=this._inputManager.isLeftMouseDown();this._mousePosition=this._inputManager.getMousePosition()},__class__:ac,__properties__:{get_pointerDelta:"get_pointerDelta",
get_pointerPosition:"get_pointerPosition",get_pointerUpThisFrame:"get_pointerUpThisFrame",get_pointerDown:"get_pointerDown",get_pointerDownThisFrame:"get_pointerDownThisFrame"}});var qf=function(){this._isTap=!1;this._eventListeners=[]};qf.__name__=["game","gestures","TapGesture"];qf.__super__=Xa;qf.prototype=r(Xa.prototype,{onStartInput:function(a,b){Xa.prototype.onStartInput.call(this,a,b);this._isTap=!0},onMoveInput:function(a,b){Xa.prototype.onMoveInput.call(this,a,b);if(0<Math.abs(a)||0<Math.abs(b))this._isTap=
!1},onStopInput:function(){Xa.prototype.onStopInput.call(this);if(this._isTap)this.onComplete()},__class__:qf});var ef=function(a,b){this._upKeyDownPrev=this._downKeyDownPrev=this._leftKeyDownPrev=this._rightKeyDownPrev=!1;m.call(this,a);this._upKey=R.getProperty("keyUp");this._downKey=R.getProperty("keyDown");this._leftKey=R.getProperty("keyLeft");this._rightKey=R.getProperty("keyRight");this._inputManager=ma.getInstance();this._target=b};ef.__name__=["game","playerInput","PlayerArrowInputController"];
ef.__super__=m;ef.prototype=r(m.prototype,{update:function(){m.prototype.update.call(this);this._inputManager.isKeyDown(this._downKey)&&!this._downKeyDownPrev?(this._target.handleDownStart(),this._downKeyDownPrev=!0):!this._inputManager.isKeyDown(this._downKey)&&this._downKeyDownPrev?(this._target.handleDownEnd(),this._downKeyDownPrev=!1):this._inputManager.isKeyDown(this._downKey)&&this._downKeyDownPrev&&this._target.handleDownStay();this._inputManager.isKeyDown(this._upKey)&&!this._upKeyDownPrev?
(this._target.handleUpStart(),this._upKeyDownPrev=!0):!this._inputManager.isKeyDown(this._upKey)&&this._upKeyDownPrev?(this._target.handleUpEnd(),this._upKeyDownPrev=!1):this._inputManager.isKeyDown(this._upKey)&&this._upKeyDownPrev&&this._target.handleUpStay();this._inputManager.isKeyDown(this._leftKey)&&!this._leftKeyDownPrev?(this._target.handleLeftStart(),this._leftKeyDownPrev=!0):!this._inputManager.isKeyDown(this._leftKey)&&this._leftKeyDownPrev?(this._target.handleLeftEnd(),this._leftKeyDownPrev=
!1):this._inputManager.isKeyDown(this._leftKey)&&this._leftKeyDownPrev&&this._target.handleLeftStay();this._inputManager.isKeyDown(this._rightKey)&&!this._rightKeyDownPrev?(this._target.handleRightStart(),this._rightKeyDownPrev=!0):!this._inputManager.isKeyDown(this._rightKey)&&this._rightKeyDownPrev?(this._target.handleRightEnd(),this._rightKeyDownPrev=!1):this._inputManager.isKeyDown(this._rightKey)&&this._rightKeyDownPrev&&this._target.handleRightStay()},__class__:ef});var ff=function(a,b){m.call(this,
a);this._target=b;this._upGestureDetector=new yc(new ac(this.getEntity(),ma.getInstance()));this._downGestureDetector=new yc(new ac(this.getEntity(),ma.getInstance()));this._leftGestureDetector=new yc(new ac(this.getEntity(),ma.getInstance()));this._rightGestureDetector=new yc(new ac(this.getEntity(),ma.getInstance()));p.isMobile()?this._upGesture=new qf:this._upGesture=new zc(new s(0,-1),100);this._downGesture=new zc(new s(0,1),100);this._leftGesture=new zc(new s(-1,0),100);this._rightGesture=new zc(new s(1,
0),100);this._leftGestureDetector.set_gesture(this._leftGesture);this._rightGestureDetector.set_gesture(this._rightGesture);this._upGestureDetector.set_gesture(this._upGesture);this._downGestureDetector.set_gesture(this._downGesture);this._leftGestureDetector.addEventListener("complete",w(this,this.onLeftGestureComplete));this._rightGestureDetector.addEventListener("complete",w(this,this.onRightGestureComplete));this._upGestureDetector.addEventListener("complete",w(this,this.onUpGestureComplete));
this._downGestureDetector.addEventListener("complete",w(this,this.onDownGestureComplete))};ff.__name__=["game","playerInput","PlayerSwipeInputController"];ff.__super__=m;ff.prototype=r(m.prototype,{update:function(){m.prototype.update.call(this);this._upGestureDetector.update();this._downGestureDetector.update();this._leftGestureDetector.update();this._rightGestureDetector.update()},onUpGestureComplete:function(a){this._target.handleUpStart();this._target.handleUpStay();this._target.handleUpEnd()},
onDownGestureComplete:function(a){this._target.handleDownStart();this._target.handleDownStay();this._target.handleDownEnd()},onLeftGestureComplete:function(a){this._target.handleLeftStart();this._target.handleLeftStay();this._target.handleLeftEnd()},onRightGestureComplete:function(a){this._target.handleRightStart();this._target.handleRightStay();this._target.handleRightEnd()},__class__:ff});var Qc=function(a){this._level=null;aa.call(this);this._gameController=a};Qc.__name__=["game","screens","GameplayScreen"];
Qc.__super__=aa;Qc.prototype=r(aa.prototype,{init:function(){aa.prototype.init.call(this);ra.createAnimation("scoobyWalk","scoobyWalkXml",new s(-25,-35),2);ra.createAnimation("collectionParticle","collectionParticleXml",new s(-64,-64),2,!1);ra.createAnimation("holeEffect","holeEffectXml",new s(-74,-61),1.5,!1);ra.createAnimation("snackEffect","snackEffectXml",new s(-60,-68),1.5,!1);ra.createAnimation("ghostWalk","ghostWalkXml",new s(-17,-31),2);ra.createAnimation("mountainManWalk","mountainManWalkXml",
new s(-20,-33),2);ra.createAnimation("scarecrowWalk","scarecrowWalkXml",new s(-21,-31),2);ra.createAnimation("snackEffectOverlay","snackEffectOverlayXml",new s(-31,-68),2);ra.createAnimation("splash","splashXml",new s(-19,-19),2);ra.createAnimation("reflection","reflectionXml",new s(-31,-6),3,!0);ra.createAnimation("waterfall","waterfallXml",new s(-32,-32),2);ra.createAnimation("waterfallBottom","waterfallBottomXml",new s(-32,-32),2);ra.createAnimation("boardBreak","boardBreakXml",new s(-72,-56),
3);ra.createAnimation("puppyCollection","puppyCollectionXml",new s(-32,-32),2);var a=this.addEntity();this._level=new of(a,this._gameController);n.playMusicByName("music_gameplay")},__class__:Qc});var yd=function(){aa.call(this)};yd.__name__=["game","screens","LoadingScreen"];yd.__super__=aa;yd.prototype=r(aa.prototype,{init:function(){aa.prototype.init.call(this);var a=Ea.createFullscreenUiPanel(this);this._background=this.addEntity();(new X(this._background,a)).setCoords(new s(0,0));var b=new B(this._background,
"loadingBG");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;new rc(this._background);b=this.addEntity();(new X(b,a)).setCoords(new s(0,0));a=new B(b,"loadingBarBG");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;this._loadingBar=b.addEntity();this._loadingBar.setLocalPosition(0,0,0);a=new B(this._loadingBar,"loadingBar");a.setAnchor(0.5,0.5);this._fillMask=new PIXI.Graphics;a.getSprite().mask=this._fillMask;a.getSprite().addChild(this._fillMask);a=this.addEntity();a.setPosition(-9E3,
-9E3);new na(a,"x",{fontFamily:"riffic_free_mediumbold"})},onFileLoaded:function(a,b){if(null!=this._loadingBar){var c=a/b;1<c&&(c=1);this.updateLoadingMeter(c)}},updateLoadingMeter:function(a){this._fillMask.clear();this._fillMask.beginFill();this._fillMask.drawRect(-200,200-300*a,400,300);this._fillMask.endFill()},handleMessage:function(a,b){aa.prototype.handleMessage.call(this,a,b);if("onFileLoaded"==a)this.onFileLoaded(b.progress,b.total)},__class__:yd});var Uc=function(a,b){aa.call(this);this._parentState=
a;this._gameController=b;this._pauseMenu=ad.show(this.getSceneRoot());this._pauseMenu.addEventListener("resume",w(this,this.onPauseMenuResume));this._pauseMenu.addEventListener("quit",w(this,this.onPauseMenuQuit))};Uc.__name__=["game","screens","MenusState"];Uc.show=function(a,b){var c=new Uc(a,b);p.getInstance().addGameState(c)};Uc.__super__=aa;Uc.prototype=r(aa.prototype,{onPauseMenuQuit:function(a){this.destroy();Ma.doTransition(this._parentState,new Rb(this._gameController))},onPauseMenuResume:function(a){var b=
this;this._pauseMenu.dismiss();this._pauseMenu.addEventListener("dismissComplete",function(){b._parentState.resume();p.getInstance().removeGameState(b)})},__class__:Uc});var Fe=function(){this._orientationEntity=this._div=this._image=null;aa.call(this)};Fe.__name__=["game","screens","OrientationState"];Fe.__super__=aa;Fe.prototype=r(aa.prototype,{init:function(){aa.prototype.init.call(this)},onOrientationChanged:function(a){p.isMobile()&&!p.isPhone()?a&&0==R.getProperty("isLandscapeAllowedIPad")?
this.showOrientationScreen(1):a||0!=R.getProperty("isPortraitAllowedIPad")?this.hideOrientationScreen():this.showOrientationScreen(0):p.isMobile()&&(a&&0==R.getProperty("isLandscapeAllowedIPhone")?this.showOrientationScreen(1):a||0!=R.getProperty("isPortraitAllowedIPhone")?this.hideOrientationScreen():this.showOrientationScreen(0))},showOrientationScreen:function(a){this.hideOrientationScreen(!1);p.getInstance().addGameState(this);p.getInstance().stopUpdates();ma.getInstance().setInputDisabled(!0);
n.pauseAllSounds();this._div=x.getDocument().createElement("div");this._div.style.position="fixed";this._div.style.backgroundColor="#000000";this._div.style.width="100%";this._div.style.height="100%";x.getContainer().appendChild(this._div);switch(a){case 0:this._orientationEntity=this.addEntity();this._image=I.getAsset(p.isPhone()?"iphoneOrientationImage":"ipadOrientationImage");this._div.appendChild(this._image);this._image.style.position="fixed";this._image.style.margin="auto auto auto auto";this._image.style.display=
"block";this._image.style.maxWidth="100%";this._image.style.maxHeight="auto";this._image.style.top="0px";this._image.style.bottom="0px";this._image.style.left="0px";this._image.style.right="0px";break;case 1:this._orientationEntity=this.addEntity(),this._image=I.getAsset(p.isPhone()?"iphoneOrientationImage":"ipadOrientationImage"),this._div.appendChild(this._image),this._image.style.position="fixed",this._image.style.margin="auto auto auto auto",this._image.style.display="block",this._image.style.maxWidth=
"100%",this._image.style.maxHeight="auto",this._image.style.top="0px",this._image.style.bottom="0px",this._image.style.left="0px",this._image.style.right="0px"}},update:function(){aa.prototype.update.call(this)},hideOrientationScreen:function(a){null==a&&(a=!0);null!=this._div&&(this._div.parentNode.removeChild(this._div),this._div=null);a&&(p.getInstance().resumeUpdates(),ma.getInstance().setInputDisabled(!1),n.resumeAllSounds(),p.getInstance().hideAddressBar(),p.getInstance().onScreenScaleUpdated())},
handleMessage:function(a,b){aa.prototype.handleMessage.call(this,a,b);if("onOrientationChanged"==a)this.onOrientationChanged(b.isHorizontal)},__class__:Fe});var Rb=function(a){this._shouldShowHighScore=!0;aa.call(this);this._gameController=a};Rb.__name__=["game","screens","TitleScreen"];Rb.__super__=aa;Rb.prototype=r(aa.prototype,{init:function(){aa.prototype.init.call(this);this.createMenuScreen();n.playMusicByName("music_menus")},createMenuScreen:function(){var a=Ea.createFullscreenUiPanel(this);
this._buttonGroup=new kc(a.getEntity());var b=new bc(a);b.createSplashBackground();b.createImage(0.62890625,-0.2951388888888889,"splashLogo");b.createImage(-0.84,-0.75,"environmentLogo");b.createPlayButton(0.736328125,0.6631944444444444,w(this,this.onPlayButtonClicked));if(this._shouldShowHighScore){var c=this.addEntity();(new X(c,a)).setCoords(new s(-0.7,0.8));(new B(c,"scoreContainer")).setAnchor(0.5,0.5);a=Y.getInstance().getHighScore();b.createCurrentBadgeLocal(c,-68,5,a,this._gameController.get_scoreController()).setScale(0.45,
0.45);var b=c.addEntity(),d=oa.getString("BADGE_"+(this._gameController.get_scoreController().getBadgeIndexFromScore(a)+1));new na(b,d,{fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",fontSize:14});b.setLocalPosition(-68,-25);b=c.addEntity();new na(b,oa.getString("LEVEL_COMPLETE_HIGH_SCORE_LABEL"),{fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A",fontSize:14});b.setLocalPosition(55,-22);c=c.addEntity();new na(c,null==a?"null":""+a,{fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",fontSize:34});
c.setLocalPosition(55,7)}},update:function(){aa.prototype.update.call(this)},onPlayButtonClicked:function(){if(Y.getInstance().isTutorialComplete())this.onStartGame();else Y.getInstance().setHasStartedGame(!0),this.onStoryPage()},onStoryPage:function(){var a=this.addEntity();new rf(a,this);this._buttonGroup.setInputEnabled(!1)},onStartGame:function(){(new pg(this._gameController,this,1)).loadLevel()},onLevelSelect:function(){Ma.doTransition(this,new Rb(this._gameController))},onResetGameYes:function(){Y.getInstance().getSaveData().deleteAllSaveData();
Y.getInstance().setHasStartedGame(!1);Ma.doTransition(this,new Rb(this._gameController));this._buttonGroup.setInputEnabled(!0)},onResetGameNo:function(){this._buttonGroup.setInputEnabled(!0)},__class__:Rb});var Sc=function(a,b){aa.call(this);this._parentState=a;this._gameController=b;this._helpScreen=cc.show(this.getSceneRoot(),!0);this._helpScreen.addEventListener("resume",w(this,this.onTutorialResume))};Sc.__name__=["game","screens","TutorialState"];Sc.show=function(a,b){var c=new Sc(a,b);p.getInstance().addGameState(c)};
Sc.__super__=aa;Sc.prototype=r(aa.prototype,{onTutorialResume:function(a){var b=this;this._helpScreen.dismiss();this._helpScreen.addEventListener("dismissComplete",function(){b._parentState.resume();b._gameController.startGameplay();p.getInstance().removeGameState(b)})},__class__:Sc});var Gb=function(a){m.call(this,a)};Gb.__name__=["game","ui","TextFieldController"];Gb.__super__=m;Gb.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._pixiText=this.getComponent(na)},update:function(){m.prototype.update.call(this);
this._pixiText.setTextString(this.getText())},getText:function(){throw new H("Not implemented.");},__class__:Gb});var kf=function(a,b){m.call(this,a);this._scoreController=b};kf.__name__=["game","ui","FruitText"];kf.__super__=Gb;kf.prototype=r(Gb.prototype,{getText:function(){return ga.string(this._scoreController.get_score())},__class__:kf});var sf=function(a,b){this._isCountingUp=!1;this._countdownDelay=0.5;this._maxScoreCountDuration=2.5;this._scoreCountSpeed=2E3;this._currentScore=this._targetScore=
0;m.call(this,a);this._deferredAction=new Va(this.getEntity());this._tweener=new ta(this.getEntity());this._scoreController=b;var c=this._scoreController.get_numBadges()-2;this._meterMaxScore=this._scoreController.getScoreRequiredForBadgeIndex(c);this._targetScore=this._scoreController.get_score();this._targetScore/this._scoreCountSpeed>this._maxScoreCountDuration&&(this._scoreCountSpeed=this._targetScore/this._maxScoreCountDuration);this._meterMask=new PIXI.Graphics};sf.__name__=["game","ui","LevelCompleteBadgeContainer"];
sf.__super__=m;sf.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this.badgeIcon.setScale(0,0);this.badgeText.setScale(0,0);this._deferredAction.addDeferredAction(this._countdownDelay,w(this,this.onDelayElapse));this.meterFillSprite.getSprite().addChild(this._meterMask);this.meterFillSprite.getSprite().mask=this._meterMask},onDelayElapse:function(){this._isCountingUp=!0;this._countingLoop=n.playSoundByName("sfxScoreCountLoop1",!1,!0)},update:function(){m.prototype.update.call(this);
var a=Math.min(1,this._currentScore/this._meterMaxScore);if(this._isCountingUp){this._currentScore+=this._scoreCountSpeed*p.getDeltaTime();var b=Math.round(this._currentScore);b>=this._targetScore&&(b=this._currentScore=this._targetScore,this.onReachTargetScore());this.scoreText.setTextString(null==b?"null":""+b)}this._meterMask.clear();this._meterMask.beginFill(16711935);this._meterMask.drawRect(0,0,this.meterFillSprite.get_width()*a,this.meterFillSprite.get_height());this._meterMask.endFill()},
onReachTargetScore:function(){this._isCountingUp=!1;this._tweener.addTween(this.badgeIcon.getScaleRef(),"x",0,1,0.25,E.easeOutBack);this._tweener.addTween(this.badgeIcon.getScaleRef(),"y",0,1,0.25,E.easeOutBack);this._tweener.addTween(this.badgeText.getScaleRef(),"x",0,1,0.25,E.easeOutBack);this._tweener.addTween(this.badgeText.getScaleRef(),"y",0,1,0.25,E.easeOutBack);null!=this._countingLoop&&(this._countingLoop.stop(),this._countingLoop=null);var a=this._scoreController.getBadgeIndexFromScore(this._targetScore);
n.playSoundByName(["sfxScoreCountEnd1","sfxScoreCountEnd2","sfxScoreCountEnd3","sfxScoreCountEnd4","sfxScoreCountEnd5"][a])},destroy:function(){m.prototype.destroy.call(this);null!=this._countingLoop&&this._countingLoop.stop()},__class__:sf});var Mg=function(a,b){m.call(this,a);this._mazeGameController=b};Mg.__name__=["game","ui","LevelText"];Mg.__super__=Gb;Mg.prototype=r(Gb.prototype,{getText:function(){return ga.string(this._mazeGameController.get_currentRound())},__class__:Mg});var Ng=function(a,
b,c){m.call(this,a);this._livesController=c;this._text=b};Ng.__name__=["game","ui","LivesText"];Ng.__super__=m;Ng.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this)},update:function(){m.prototype.update.call(this);this.updateSprites()},updateSprites:function(){this._text.setTextString("x"+(this._livesController.get_numLives()-this._livesController.numWaitingLives))},__class__:Ng});var nf=function(a,b){m.call(this,a);this._scoreController=b};nf.__name__=["game","ui","LostPuppiesText"];
nf.__super__=Gb;nf.prototype=r(Gb.prototype,{getText:function(){return ga.string(this._scoreController.numLostPuppiesCollected)},__class__:nf});var bc=function(a){this._uiPanel=a};bc.__name__=["game","ui","PopupUiFactory"];bc.prototype={createSplashBackground:function(){var a=this._uiPanel.addEntity();new X(a,this._uiPanel);new rc(a);var b=new B(a,"splashBg");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;return a},createImage:function(a,b,c,d,e){null==e&&(e=0.5);null==d&&(d=0.5);var f=this._uiPanel.addEntity();
(new X(f,this._uiPanel)).setCoords(new s(a,b));(new B(f,c)).setAnchor(d,e);return f},createImageWithParent:function(a,b,c,d){c=c.addEntity();c.setLocalPosition(a,b);(new B(c,d)).setAnchor(0.5,0.5);return c},createPlayButton:function(a,b,c){var d=new xb;d.defaultImageName="splashPlayButton";d.x=a;d.y=b;return Wa.createButton(d,this._uiPanel.getEntity(),c)},createCurrentBadge:function(a,b,c,d){var e=this._uiPanel.getEntity().addEntity();(new X(e,this._uiPanel)).setCoords(new s(a,b));a="badge"+d.getBadgeIndexFromScore(c);
(new B(e,a)).setAnchor(0.5,0.5);return e},createCurrentBadgeLocal:function(a,b,c,d,e){a=a.addEntity();a.setLocalPosition(b,c);b="badge"+e.getBadgeIndexFromScore(d);(new B(a,b)).setAnchor(0.5,0.5);return a},createHeadingText:function(a,b,c){var d=this._uiPanel.addEntity();(new X(d,this._uiPanel)).setCoords(new s(a,b));new na(d,c,{fontSize:"28px",fontFamily:"Arial"});return d},createPromptRoot:function(a,b){var c=this._uiPanel.addEntity(),d=new X(c,this._uiPanel);p.isMobile()&&d.setScale(0.9,0.9);var d=
c.addEntity(),e=new B(d,"popupBg");e.getSprite().anchor.x=0.5;e.getSprite().anchor.y=0.5;e=d.addEntity();(new B(e,"headingLogo")).setAnchor(0.5,0.5);e.setLocalPosition(0,-235);d=d.addEntity();(new B(d,"environmentLogo")).setAnchor(0.5,0.5);d.setLocalPosition(-270,-200);return c},createPromptRootNoBadge:function(a,b){var c=this._uiPanel.addEntity(),d=new X(c,this._uiPanel);p.isMobile()&&d.setScale(0.9,0.9);var d=c.addEntity(),e=new B(d,"popupBg");e.getSprite().anchor.x=0.5;e.getSprite().anchor.y=0.5;
d=d.addEntity();(new B(d,"headingLogo")).setAnchor(0.5,0.5);d.setLocalPosition(0,-235);return c},createPromptRootNoBadgeNoLogo:function(a,b){var c=this._uiPanel.addEntity(),d=new X(c,this._uiPanel);p.isMobile()&&d.setScale(0.9,0.9);d=c.addEntity();d=new B(d,"popupBg");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;return c},createLagrgPromptRoot:function(a,b){var c=this._uiPanel.addEntity(),d=new X(c,this._uiPanel);p.isMobile()&&d.setScale(0.9,0.9);d=c.addEntity();d.setLocalPosition(0,-6);
(new B(d,"popupBoxLarge")).setAnchor(0.5,0.5);d=c.addEntity();d.setLocalPosition(0,-233);(new B(d,"popupHeaderLogo")).setAnchor(0.5,0.5);return c},__class__:bc};var Fd=function(a){m.call(this,a);this._tweener=new ta(this.getEntity());this._deferredAction=new Va(this.getEntity())};Fd.__name__=["game","ui","ReadyGoUi"];Fd.__super__=m;Fd.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this.textField.setTextString(oa.getString("READY"));this._tweener.addTween(this.textField.getEntity().getScaleRef(),
"x",3,1,0.8,E.easeInQuad,0);this._tweener.addTween(this.textField.getEntity().getScaleRef(),"y",3,1,0.8,E.easeInQuad,0);this._tweener.addTween(this.textField.getText(),"alpha",0,1,0.8,E.linear);this._tweener.addTween(this.getEntity().getScaleRef(),"x",1.15,1,1.6,E.linear);this._tweener.addTween(this.getEntity().getScaleRef(),"y",1.15,1,1.6,E.linear);this._deferredAction.addDeferredAction(1.6,w(this,this.onReadyDelayElapse))},onReadyDelayElapse:function(){this.textField.setTextString(oa.getString("GO"));
this._tweener.addTween(this.getEntity().getScaleRef(),"x",1,1.15,1.6,E.linear);this._tweener.addTween(this.getEntity().getScaleRef(),"y",1,1.15,1.6,E.linear);this._tweener.addTween(this.textField.getEntity().getRotationRef(),"z",0,360,0.13999999999999999,E.easeOutQuad);this._tweener.addTween(this.textField.getEntity().getScaleRef(),"x",0,1,0.27999999999999997,E.easeOutBack,0);this._tweener.addTween(this.textField.getEntity().getScaleRef(),"y",0,1,0.27999999999999997,E.easeOutBack,0);this._deferredAction.addDeferredAction(0.8,
w(this,this.onGoDelayElapse));n.playSoundByName("sfx_go")},onGoDelayElapse:function(){var a=this;this._tweener.addTween(this.textField.getEntity().getScaleRef(),"x",1,3,0.27999999999999997,E.easeInQuad,0);this._tweener.addTween(this.textField.getText(),"alpha",1,0,0.27999999999999997,E.linear);this._tweener.addTween(this.textField.getEntity().getScaleRef(),"y",1,3,0.27999999999999997,E.easeInQuad,0,function(){a.getEntity().destroy()});n.playSoundByName("sfx_go_exit")},__class__:Fd});var lf=function(a,
b){m.call(this,a);this._snackController=b};lf.__name__=["game","ui","ScoreBoostIcon"];lf.__super__=m;lf.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._tweener=new ta(this.getEntity());this.hide(!0)},update:function(){m.prototype.update.call(this);this.updateVisibility()},updateVisibility:function(){var a=this.getEntity().isVisible(),b=0<this._snackController.getTimeLeftPercentage();!a&&b?this.show():a&&!b&&this.hide()},show:function(){this._tweener.addTween(this.getEntity().getScaleRef(),
"x",0,1,0.35,E.easeOutBack);this._tweener.addTween(this.getEntity().getScaleRef(),"y",0,1,0.35,E.easeOutBack);this.getEntity().setVisible(!0)},hide:function(a){null==a&&(a=!1);var b=this;a?(this.getEntity().setScale(0,0),this.getEntity().setVisible(!1)):(this._tweener.addTween(this.getEntity().getScaleRef(),"x",1,0,0.35,E.easeInQuad),this._tweener.addTween(this.getEntity().getScaleRef(),"y",1,0,0.35,E.easeInQuad,0,function(){b.getEntity().setVisible(!1)}))},__class__:lf});var Og=function(a,b){this._baseHeight=
500;this._baseWidth=750;M.call(this);this._baseWidth=a;this._baseHeight=b};Og.__name__=["game","ui","ScreenSizeToBrowserSize"];Og.__super__=da;Og.prototype=r(da.prototype,{postUpdate:function(){da.prototype.postUpdate.call(this);p.getDevicePixelRatio();if(1==p.getInstance().getCurrentOrientation()){var a=this._baseWidth/window.innerWidth;p.getInstance().setGameWidth(this._baseWidth);p.getInstance().setGameHeight(Math.ceil(window.innerHeight*a))}else a=this._baseHeight/window.innerHeight,p.getInstance().setGameWidth(Math.ceil(window.innerWidth*
a)),p.getInstance().setGameHeight(this._baseHeight);p.getInstance().onResizeWindow()},__class__:Og});var mf=function(a,b){this._hideIfInactive=!0;m.call(this,a);this._snackController=b};mf.__name__=["game","ui","SnackText"];mf.__super__=m;mf.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._mask=new PIXI.Graphics;this.meterSprite.getSprite().addChild(this._mask);this.meterSprite.getSprite().mask=this._mask},update:function(){m.prototype.update.call(this);this.updateMask();
this._hideIfInactive&&this.updateVisibility()},updateMask:function(){this._mask.clear();this._mask.beginFill(16711935,1);this._mask.drawRect(0,0.5*-this.meterSprite.get_height(),this.meterSprite.get_width()*this._snackController.getTimeLeftPercentage(),this.meterSprite.get_height());this._mask.endFill()},updateVisibility:function(){this.getEntity().setVisible(0<this._snackController.getTimeLeftPercentage())},__class__:mf});var tf=function(a,b,c){m.call(this,a);this._soundOnImage=b;this._soundOffImage=
c};tf.__name__=["game","ui","SoundButton"];tf.__super__=m;tf.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._button=this.getEntity().getComponent(Ja);this._buttonActionDelay=this.getEntity().getComponent(Ka);this._buttonMouseOverImage=this.getEntity().getComponent(oc);this._buttonActionDelay.setOnAction(w(this,this.onClick))},update:function(){m.prototype.update.call(this);this._buttonMouseOverImage.setDefaultImage(n.isMusicMuted()?this._soundOffImage:this._soundOnImage);
this._buttonMouseOverImage.setMouseOverImage(n.isMusicMuted()?this._soundOffImage:this._soundOnImage)},onClick:function(){n.setMusicMuted(!n.isMusicMuted());n.setSoundMuted(n.isMusicMuted())},__class__:tf});var Ea=function(){};Ea.__name__=["game","ui","UiFactory"];Ea.createFullscreenUiPanel=function(a){var b=p.getInstance().getGameSize();b.getClone();b.x*=p.getInstance().getScreenScale().x;b.y*=p.getInstance().getScreenScale().y;a=a.addEntity();b=new Kc(a,b);new Ee(a,b);new De(a);return b};Ea.createPulseButton=
function(a,b,c,d,e,f,g,k,h,l,m,n,p,q,r,t){var v=hc.instantiate(a.getGameState());(new X(v,a)).setCoords(new s(b,c));a=new B(v,h);Ja.createFromPixiSprite(a);new Ic(v,d,e,f,q);new nc(v,g,k,E.easeOutQuint,E.easeOutQuint);new Ka(v,m,n,p);new oc(v,h,l);new Jc(v,r,t);return v};Ea.createPulseButtonQuick=function(a,b,c,d,e,f,g,k,h,l,m){null==l&&(l=0.35);null==h&&(h=!0);null==k&&(k="");null==g&&(g="");return Ea.createPulseButton(a,b,c,0.35,1,0.15,1.15,0.35,d,e,f,l,m,h,g,k)};Ea.createPulseButtonAbsolute=function(a,
b,c,d,e,f,g,k,h,l,m,n,p,q,r,s){a=hc.instantiate(a);a.setLocalPosition(b,c,0);b=new B(a,h);Ja.createFromPixiSprite(b);new Ic(a,d,e,f,q);new nc(a,g,k,E.easeOutQuint,E.easeOutQuint);new Ka(a,m,n,p);new oc(a,h,l);new Jc(a,r,s);return a};Ea.createPulseButtonQuickAbsolute=function(a,b,c,d,e,f,g,k,h,l,m){null==l&&(l=0.35);null==h&&(h=!0);null==k&&(k="");null==g&&(g="");return Ea.createPulseButtonAbsolute(a,b,c,0.35,1,0.15,1.15,0.35,d,e,f,l,m,h,g,k)};Ea.createTextButton=function(a,b,c,d,e,f,g,k,h){null==
h&&(h=!0);null==k&&(k="");null==g&&(g="");var l=e.getGameState();a=Ea.createPulseButtonQuick(e,a,b,d,d,f,g,k,h,0.35);l=l.addEntity();l.setLocalPosition(0,-5,0);new na(l,c,{fontSize:"24px",fontFamily:"Arial",fill:"#000000"});a.addChild(l);return a.getComponent(X)};Ea.prototype={__class__:Ea};var uf=function(a,b){this._isMouseDown=!1;m.call(this,a);this._target=b};uf.__name__=["game","ui","VirtualController"];uf.__super__=m;uf.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._button=
this.getComponent(Ja);this._button.setOnMouseDown(w(this,this.onMouseDown));this._button.setOnMouseUp(w(this,this.onMouseUp))},onMouseDown:function(){this._isMouseDown=!0;this._mouseDownPosition=ma.getInstance().getMousePosition();null!=this._ui&&this._ui.destroy();this._ui=this.addEntity();this._ui.setPosition(this._mouseDownPosition.x,this._mouseDownPosition.y);(new B(this._ui,"virtualController")).setAnchor(0.5,0.5)},fixedUpdate:function(){m.prototype.fixedUpdate.call(this);if(this._isMouseDown){var a=
new s(this._mouseDownPosition.x-ma.getInstance().getMousePosition().x,this._mouseDownPosition.y-ma.getInstance().getMousePosition().y);Math.abs(a.x)>Math.abs(a.y)?25<a.x?this._target.handleLeftStay():-25>a.x&&this._target.handleRightStay():25<a.y?this._target.handleUpStay():-25>a.y&&this._target.handleDownStay()}},onMouseUp:function(){this._isMouseDown=!1;null!=this._ui&&this._ui.destroy()},__class__:uf});var xb=function(){this.buttonAnchorX=this.buttonAnchorY=0.5;this.textX=this.textY=0;this.text=
"";this.textStyle=null;this.overSoundId="";this.clickSoundId="sfx_click_1";this.deactivateButtonOnClick=!0;this.onClickDelay=0.35;this.defaultImageName=this.mouseOverImageName="";this.mouseOverScaleDuration=0.35;this.mouseOverScaleTo=1.15;this.mouseDownPulseDuration=0.15;this.mouseDownPulseToScale=1;this.mouseDownPulseFromScale=0.35;this.positionType=Ta.UiPanel;this.x=this.y=0};xb.__name__=["game","ui","buttonFactory","ButtonConfig"];xb.prototype={__class__:xb};var Wa=function(){};Wa.__name__=["game",
"ui","buttonFactory","ButtonFactory"];Wa.createButton=function(a,b,c,d){var e=b.addEntity();b=b.getComponent(Kc);null!=b&&a.positionType==Ta.UiPanel?(new X(e,b)).setCoords(new s(a.x,a.y)):a.positionType==Ta.World?e.setPosition(a.x,a.y):e.setLocalPosition(a.x,a.y);b=new B(e,a.defaultImageName);b.setAnchor(a.buttonAnchorX,a.buttonAnchorY);Ja.createFromPixiSprite(b).setData(a.data);new Ic(e,a.mouseDownPulseFromScale,a.mouseDownPulseToScale,a.mouseDownPulseDuration,a.deactivateButtonOnClick);new nc(e,
a.mouseOverScaleTo,a.mouseOverScaleDuration,E.easeOutQuint,E.easeOutQuint);new Ka(e,c,a.onClickDelay,d);new oc(e,a.defaultImageName,0<a.mouseOverImageName.length?a.mouseOverImageName:a.defaultImageName);new Jc(e,a.clickSoundId,a.overSoundId);0<a.text.length&&(c=e.addEntity(),c.setLocalPosition(a.textX,a.textY),new na(c,a.text,null==a.textStyle?{}:a.textStyle));return e};var Ta={__ename__:!0,__constructs__:["Local","World","UiPanel"],Local:["Local",0]};Ta.Local.__enum__=Ta;Ta.World=["World",1];Ta.World.__enum__=
Ta;Ta.UiPanel=["UiPanel",2];Ta.UiPanel.__enum__=Ta;Ta.__empty_constructs__=[Ta.Local,Ta.World,Ta.UiPanel];var Td=function(a){m.call(this,a)};Td.__name__=["game","ui","popups","Popup"];Td.__super__=m;Td.prototype=r(m.prototype,{init:function(){m.prototype.init.call(this);this._uiPanel=Ea.createFullscreenUiPanel(this.getGameState());new la(this._uiPanel.getEntity());this._buttonGroup=new kc(this._uiPanel.getEntity());this.enter()},enter:function(){this.onEnterComplete()},onEnterComplete:function(){this.dispatchEvent(new Ac("enterComplete"))},
dismiss:function(){this.onDismissComplete()},onDismissComplete:function(){this.dispatchEvent(new Ac("dismissComplete"));null!=this._uiPanel&&(this._uiPanel.getEntity().destroy(),this._uiPanel=null);this.getEntity().destroy()},__class__:Td});var Fa=function(a){m.call(this,a)};Fa.__name__=["game","ui","popups","FadingPopup"];Fa.__super__=Td;Fa.prototype=r(Td.prototype,{enter:function(){var a=this,b=this._uiPanel.getComponent(la);ta.addTweenToTarget(this.getEntity(),b.getContainer(),"alpha",0,1,0.1,
E.linear,0,function(){a.onEnterComplete()})},dismiss:function(){var a=this;this._buttonGroup.setInputEnabled(!1);var b=this._uiPanel.getComponent(la);ta.addTweenToTarget(this.getEntity(),b.getContainer(),"alpha",1,0,0.1,E.linear,0,function(){a.onDismissComplete()})},__class__:Fa});var cc=function(a,b){this._fromTutorial=!1;this._pageIndex=0;m.call(this,a);this._fromTutorial=b};cc.__name__=["game","ui","popups","HelpScreen"];cc.show=function(a,b){var c=a.addEntity();return new cc(c,b)};cc.__super__=
Fa;cc.prototype=r(Fa.prototype,{init:function(){Fa.prototype.init.call(this);var a=this.addEntity(),b=new B(a,"blackSquare");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.5;a=new X(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);a=new bc(this._uiPanel);this._promptBg=a.createLagrgPromptRoot(0,0);this._pageIndex=0;b=p.isMobile();this.createContent(-158,-84,this._promptBg,b?"tutorialMoveMobile":"tutorialMovePC",oa.getString("HELP_SCREEN_MOVE"));this.createContent(158,
-84,this._promptBg,"tutorialCollect",oa.getString("HELP_SCREEN_COLLECT"));this.createContent(-158,92,this._promptBg,"tutorialEat",oa.getString("HELP_SCREEN_EAT"));this.createContent(158,92,this._promptBg,"tutorialAvoid",oa.getString("HELP_SCREEN_AVOID"));a.createImage(-0.74609375,1,"popScooby",0.5,1);a=new xb;a.x=0.787109375;a.y=0.6631944444444444;a.defaultImageName="splashPlayButton";Wa.createButton(a,this._uiPanel.getEntity(),w(this,this.onClose))},createContent:function(a,b,c,d,e){c=c.addEntity();
c.setLocalPosition(a,b);(new B(c,d)).setAnchor(0.5,0.5);a=c.addEntity();a.setLocalPosition(0,63);new na(a,e,{fontSize:22,fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF"});return c},deleteUiElementAndPositionLocally:function(a,b,c,d){a.getComponent(X).destroy();b.addChild(a);a.setLocalPosition(c,d)},onClose:function(){this._fromTutorial?this.dispatchEvent(new Ud("resume")):this.dismiss()},__class__:cc});var pf=function(a,b,c){this._displayedScore=this.totalScore=0;this._scoreModifier=5;this._loadingScreen=
this._playerData=null;m.call(this,a);this._playerData=b;this._gameController=c};pf.__name__=["game","ui","popups","LevelCompleteScreen"];pf.__super__=Fa;pf.prototype=r(Fa.prototype,{init:function(){Fa.prototype.init.call(this);var a=this.addEntity();(new X(a,this._uiPanel)).setScale(1E3,1E3);a=new B(a,"blackSquare");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;a.getSprite().alpha=0.5;a=this.addEntity();new X(a,this._uiPanel);new rc(a,new s(1024,576));var a=(new bc(this._uiPanel)).createPromptRootNoBadge(0,
0),b=this.addEntity();b.setLocalPosition(0,-150,0);a.addChild(b);new na(b,oa.getString("LEVEL_COMPLETE_HEADER").toUpperCase(),{fontSize:42,fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A"});b=a.addEntity();b.setLocalPosition(0,-2);var c=new sf(b,this._gameController.get_scoreController());(new B(b,"badgeContainer")).setAnchor(0.5,0.5);var d=b.addEntity();d.setLocalPosition(-170,-14);(new B(d,"badgeUnknown")).setAnchor(0.5,0.5);var e=b.addEntity(),f=new B(e,"badgeMeterFill");f.setAnchor(0,0);c.meterFillSprite=
f;e.setLocalPosition(-275,71);e=b.addEntity();(new B(e,"badgeOverlay")).setAnchor(0.5,0.5);e.setLocalPosition(-173,78);e=a.addEntity();e.setLocalPosition(-170,-82);f=this._gameController.get_scoreController().get_badgeTierIndex()+1;f=oa.getString("BADGE_"+f);new na(e,f,{fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",fontSize:18});c.badgeText=e;d=d.addEntity();c.badgeIcon=d;e="badge"+this._gameController.get_scoreController().get_badgeTierIndex();(new B(d,e)).setAnchor(0.5,0.5);d=b.addEntity();
d.setLocalPosition(115,-60,0);a.addChild(d);new na(d,oa.getString("LEVEL_COMPLETE_SCORE_LABEL").toUpperCase(),{fontSize:24,fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A"});d=b.addEntity();d.setLocalPosition(115,-5,0);a.addChild(d);d=new na(d,"0",{fontSize:82,fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF"});c.scoreText=d;c=b.addEntity();c.setLocalPosition(165,48,0);a.addChild(c);c=new na(c,oa.getString("LEVEL_COMPLETE_HIGH_SCORE_LABEL").toUpperCase(),{fontSize:24,align:"right",fontFamily:"riffic_free_mediumbold",
fill:"#B7EC6A"});c.getText().anchor.x=1;c.getText().anchor.y=0.5;c=b.addEntity();c.setLocalPosition(115,110);(new B(c,"animalHudLife")).setAnchor(0.5,0.5);c=c.addEntity();c.setLocalPosition(2,-10);c=new na(c,"x"+ga.string(this._gameController.get_scoreController().numLostPuppiesCollected),{fontSize:24,align:"left",fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF"});c.getText().anchor.x=0;c.getText().anchor.y=0.5;b=b.addEntity();b.setLocalPosition(170,48,0);a.addChild(b);b=new na(b,ga.string(Y.getInstance().getHighScore()),
{fontSize:24,align:"left",fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF"});b.getText().anchor.x=0;b.getText().anchor.y=0.5;b=new xb;b.x=0;b.y=190;b.defaultImageName="splashPlayButton";Wa.createButton(b,a,w(this,this.onReplayButtonClick));b=new xb;b.x=-145;b.y=210;b.defaultImageName="homeButton";Wa.createButton(b,a,w(this,this.onLevelCompleteNextClicked));a=this.addEntity();(new B(a,"recapScooby")).setAnchor(1,1);(new X(a,this._uiPanel)).setCoords(new s(0.91,1));n.playSoundByName("level_win_1");
Y.getInstance().setScoreForCurrentLevel(this.totalScore);Y.getInstance().setNumLevelsUnlocked(Y.getInstance().getCurrentLevelNumber()+1)},onReplayButtonClick:function(){n.playSoundByName("ui_select_1");Ma.doTransition(this.getGameState(),new Qc(this._gameController))},onLevelCompleteNextClicked:function(){n.playSoundByName("ui_select_1");Y.getInstance().getCurrentLevelNumber();Y.getInstance().getNumLevels();Ma.doTransition(this.getGameState(),new Rb(this._gameController))},onLevelLoadComplete:function(){this.destroy();
Ma.doTransition(this._loadingScreen,new Qc(this._gameController))},__class__:pf});var bd=function(a,b,c,d,e,f,g){m.call(this,a);this._headingText=b;this._bodyText=c;this._yesText=d;this._noText=e;this._onYes=f;this._onNo=g};bd.__name__=["game","ui","popups","MessageBoxYesNo"];bd.show=function(a,b,c,d,e,f,g){a=a.addEntity();new bd(a,b,c,d,e,f,g)};bd.__super__=Fa;bd.prototype=r(Fa.prototype,{init:function(){Fa.prototype.init.call(this);var a=this.addEntity(),b=new B(a,"blackSquare");b.getSprite().anchor.x=
0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.5;a=new X(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);a=(new bc(this._uiPanel)).createPromptRoot(0,0);b=this.addEntity();b.setLocalPosition(0,-115,0);a.addChild(b);new na(b,this._headingText.toUpperCase(),{fontSize:62,fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A"});b=this.addEntity();b.setLocalPosition(0,-40,0);a.addChild(b);b=new na(b,this._bodyText.toUpperCase(),{fontSize:22,fontFamily:"riffic_free_mediumbold",fill:"#FFFFFF",
align:"center",wordWrapWidth:300,wordWrap:!0});b.getText().anchor.x=0.5;b.getText().anchor.y=0.5;b=new xb;b.x=-85;b.y=65;b.defaultImageName="yesButton";Wa.createButton(b,a,w(this,this.onYesClick));b.x=85;b.y=65;b.defaultImageName="noButton";Wa.createButton(b,a,w(this,this.onNoClick))},onYesClick:function(){var a=this;this.addEventListener("dismissComplete",function(){null!=a._onYes&&a._onYes()});this.dismiss()},onNoClick:function(){var a=this;this.addEventListener("dismissComplete",function(){null!=
a._onNo&&a._onNo()});this.dismiss()},__class__:bd});var ad=function(a){m.call(this,a)};ad.__name__=["game","ui","popups","PauseMenu"];ad.show=function(a){a=a.addEntity();return new ad(a)};ad.__super__=Fa;ad.prototype=r(Fa.prototype,{init:function(){Fa.prototype.init.call(this);var a=this.addEntity(),b=new B(a,"blackSquare");b.getSprite().alpha=0.5;b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;(new X(a,this._uiPanel)).setScale(1E3,1E3);a=(new bc(this._uiPanel)).createPromptRoot(0,0);b=new xb;
b.x=0;b.y=75;b.defaultImageName="splashPlayButton";b.deactivateButtonOnClick=!0;Wa.createButton(b,a,w(this,this.onResumeClicked));b.x=120;b.y=-55;b.defaultImageName="soundOnButton";b.deactivateButtonOnClick=!1;this._soundButton=Wa.createButton(b,a);new tf(this._soundButton,"soundOnButton","soundOffButton");b.x=0;b.y=-90;b.defaultImageName="helpButton";b.deactivateButtonOnClick=!1;Wa.createButton(b,a,w(this,this.onHelpClicked));b.x=-120;b.y=-55;b.defaultImageName="quitButton";b.deactivateButtonOnClick=
!1;Wa.createButton(b,a,w(this,this.onQuitClicked))},onResumeClicked:function(){this.dispatchEvent(new Bc("resume"))},onHelpClicked:function(){var a=this;this.hideMenu();var b=this.getGameState().getSceneRoot().addEntity();(new cc(b,!1)).addEventListener("dismissComplete",function(){a.showMenu()})},onQuitClicked:function(){this.hideMenu();bd.show(this.getGameState().getSceneRoot(),oa.getString("GAMEPLAY_SCREEN_QUIT_CONFIRM"),oa.getString("GAMEPLAY_SCREEN_QUIT_CONFIRM_TEXT"),"","",w(this,this.onConfirmQuitYes),
w(this,this.onConfirmQuitNo))},onConfirmQuitYes:function(){this.dispatchEvent(new Bc("quit"))},onConfirmQuitNo:function(){this.showMenu()},hideMenu:function(){this._uiPanel.getEntity().setVisible(!1)},showMenu:function(){this._uiPanel.getEntity().setVisible(!0)},__class__:ad});var Bc=function(a){this._type=a};Bc.__name__=["game","ui","popups","PauseMenuEvent"];Bc.__super__=L;Bc.prototype=r(L.prototype,{__class__:Bc});var Ac=function(a){this._type=a};Ac.__name__=["game","ui","popups","PopupEvent"];
Ac.__super__=L;Ac.prototype=r(L.prototype,{__class__:Ac});var rf=function(a,b){m.call(this,a);this._titleScreen=b};rf.__name__=["game","ui","popups","StoryScreen"];rf.__super__=Fa;rf.prototype=r(Fa.prototype,{init:function(){Fa.prototype.init.call(this);var a=this.addEntity(),b=new B(a,"blackSquare");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.8;a=new X(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);a=this.addEntity();new X(a,this._uiPanel);b=a.addEntity();
b.setLocalPosition(0,-6);(new B(b,"popupBoxLarge")).setAnchor(0.5,0.5);b=a.addEntity();b.setLocalPosition(0,-233);(new B(b,"popupHeaderLogo")).setAnchor(0.5,0.5);b=a.addEntity();b.setLocalPosition(255,0);(new B(b,"storyScoob")).setAnchor(0.5,0.5);b=a.addEntity();b.setLocalPosition(-135,-125);new na(b,oa.getString("STORY_SCREEN_HEADING"),{fontFamily:"riffic_free_mediumbold",fill:"#B7EC6A",fontSize:48,align:"center"});b=a.addEntity();b.setLocalPosition(-135,-50);(new na(b,oa.getString("STORY_SCREEN_BODY"),
{fontFamily:"Arial",fill:"#FFFFFF",fontSize:20,wordWrap:!0,wordWrapWidth:500,align:"center",lineHeight:25})).getText().anchor.y=0;b=a.addEntity();b.setLocalPosition(-431,-212);(new B(b,"popupRoundLogo")).setAnchor(0.5,0.5);b=new xb;b.x=285;b.y=192;b.defaultImageName="splashPlayButton";Wa.createButton(b,a,w(this,this.onClose))},onClose:function(){this._titleScreen.onStartGame()},__class__:rf});var Ud=function(a){this._type=a};Ud.__name__=["game","ui","popups","TutorialScreenEvent"];Ud.__super__=L;
Ud.prototype=r(L.prototype,{__class__:Ud});var Qg=function(){};Qg.__name__=["haxe","IMap"];var tc=function(){this.h={__keys__:{}}};tc.__name__=["haxe","ds","ObjectMap"];tc.__interfaces__=[Qg];tc.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++tc.count);this.h[c]=b;this.h.__keys__[c]=a},__class__:tc};var Ba=function(){this.h={}};Ba.__name__=["haxe","ds","StringMap"];Ba.__interfaces__=[Qg];Ba.prototype={setReserved:function(a,b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==
this.rh?null:this.rh["$"+a]},existsReserved:function(a){return null==this.rh?!1:this.rh.hasOwnProperty("$"+a)},remove:function(a){if(null!=N[a]){a="$"+a;if(null==this.rh||!this.rh.hasOwnProperty(a))return!1;delete this.rh[a]}else{if(!this.h.hasOwnProperty(a))return!1;delete this.h[a]}return!0},__class__:Ba};var Aa=function(a,b,c){this.xml=b;this.message=a;this.position=c;this.lineNumber=1;for(a=this.positionAtLine=0;a<c;){var d=a++,d=b.charCodeAt(d);10==d?(this.lineNumber++,this.positionAtLine=0):
13!=d&&this.positionAtLine++}};Aa.__name__=["haxe","xml","XmlParserException"];Aa.prototype={toString:function(){return hb.getClassName(y.getClass(this))+": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:Aa};var Ib=function(){};Ib.__name__=["haxe","xml","Parser"];Ib.parse=function(a,b){null==b&&(b=!1);var c=A.createDocument();Ib.doParse(a,b,0,c);return c};Ib.doParse=function(a,b,c,d){null==c&&(c=0);for(var e=null,f=1,g=1,k=null,h=0,l=0,m=0,n=a.charCodeAt(c),p=new ec,
q=1,r=-1;n==n;){switch(f){case 0:switch(n){case 9:case 10:case 13:case 32:break;default:f=g;continue}break;case 1:if(60==n)f=0,g=2;else{h=c;f=13;continue}break;case 2:switch(n){case 33:if(91==a.charCodeAt(c+1)){c+=2;if("CDATA["!=F.substr(a,c,6).toUpperCase())throw new H(new Aa("Expected <![CDATA[",a,c));c+=5;f=17}else if(68==a.charCodeAt(c+1)||100==a.charCodeAt(c+1)){if("OCTYPE"!=F.substr(a,c+2,6).toUpperCase())throw new H(new Aa("Expected <!DOCTYPE",a,c));c+=8;f=16}else{if(45!=a.charCodeAt(c+1)||
45!=a.charCodeAt(c+2))throw new H(new Aa("Expected \x3c!--",a,c));c+=2;f=15}h=c+1;break;case 47:if(null==d)throw new H(new Aa("Expected node name",a,c));h=c+1;f=0;g=10;break;case 63:f=14;h=c;break;default:f=3;h=c;continue}break;case 3:if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)){if(c==h)throw new H(new Aa("Expected node name",a,c));e=A.createElement(F.substr(a,h,c-h));d.addChild(e);++l;f=0;g=4;continue}break;case 4:switch(n){case 47:f=11;break;case 62:f=9;break;default:f=
5;h=c;continue}break;case 5:if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)){if(h==c)throw new H(new Aa("Expected attribute name",a,c));k=F.substr(a,h,c-h);if(e.exists(k))throw new H(new Aa("Duplicate attribute ["+k+"]",a,c));f=0;g=6;continue}break;case 6:if(61==n)f=0,g=7;else throw new H(new Aa("Expected =",a,c));break;case 7:switch(n){case 34:case 39:p=new ec;f=8;h=c+1;r=n;break;default:throw new H(new Aa('Expected "',a,c));}break;case 8:switch(n){case 38:q=c-h;p.b+=
null==q?F.substr(a,h,null):F.substr(a,h,q);f=18;q=8;h=c+1;break;case 60:case 62:if(b)throw new H(new Aa("Invalid unescaped "+String.fromCharCode(n)+" in attribute value",a,c));n==r&&(g=c-h,p.b+=null==g?F.substr(a,h,null):F.substr(a,h,g),g=p.b,p=new ec,e.set(k,g),f=0,g=4);break;default:n==r&&(g=c-h,p.b+=null==g?F.substr(a,h,null):F.substr(a,h,g),g=p.b,p=new ec,e.set(k,g),f=0,g=4)}break;case 9:h=c=Ib.doParse(a,b,c,e);f=1;break;case 10:if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==
n||45==n)){if(h==c)throw new H(new Aa("Expected node name",a,c));g=F.substr(a,h,c-h);if(d.nodeType!=A.Element)throw new H("Bad node type, expected Element but found "+d.nodeType);if(g!=d.nodeName){if(d.nodeType!=A.Element)throw new H("Bad node type, expected Element but found "+d.nodeType);throw new H(new Aa("Expected </"+d.nodeName+">",a,c));}f=0;g=12;continue}break;case 11:if(62==n)f=1;else throw new H(new Aa("Expected >",a,c));break;case 12:if(62==n)return 0==l&&d.addChild(A.createPCData("")),
c;throw new H(new Aa("Expected >",a,c));case 13:60==n?(g=c-h,p.b+=null==g?F.substr(a,h,null):F.substr(a,h,g),g=A.createPCData(p.b),p=new ec,d.addChild(g),++l,f=0,g=2):38==n&&(q=c-h,p.b+=null==q?F.substr(a,h,null):F.substr(a,h,q),f=18,q=13,h=c+1);break;case 14:63==n&&62==a.charCodeAt(c+1)&&(++c,n=F.substr(a,h+1,c-h-2),d.addChild(A.createProcessingInstruction(n)),++l,f=1);break;case 15:45==n&&(45==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(d.addChild(A.createComment(F.substr(a,h,c-h))),++l,c+=2,f=
1);break;case 16:91==n?++m:93==n?--m:62==n&&0==m&&(d.addChild(A.createDocType(F.substr(a,h,c-h))),++l,f=1);break;case 17:93==n&&(93==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(n=A.createCData(F.substr(a,h,c-h)),d.addChild(n),++l,c+=2,f=1);break;case 18:if(59==n){h=F.substr(a,h,c-h);if(35==h.charCodeAt(0))h=120==h.charCodeAt(1)?ga.parseInt("0"+F.substr(h,1,h.length-1)):ga.parseInt(F.substr(h,1,h.length-1)),p.b+=String.fromCharCode(h);else if(n=Ib.escapes,null!=N[h]?n.existsReserved(h):n.h.hasOwnProperty(h))n=
Ib.escapes,h=null!=N[h]?n.getReserved(h):n.h[h],p.b+=ga.string(h);else{if(b)throw new H(new Aa("Undefined entity: "+h,a,c));p.b+=ga.string("&"+h+";")}h=c+1;f=q}else if(!(97<=n&&122>=n||65<=n&&90>=n||48<=n&&57>=n||58==n||46==n||95==n||45==n)&&35!=n){if(b)throw new H(new Aa("Invalid character in entity: "+String.fromCharCode(n),a,c));p.b+="&";n=c-h;p.b+=null==n?F.substr(a,h,null):F.substr(a,h,n);h=c--;f=q}}n=a.charCodeAt(++c)}1==f&&(h=c,f=13);if(13==f){if(c!=h||0==l)b=c-h,p.b+=null==b?F.substr(a,h,
null):F.substr(a,h,b),d.addChild(A.createPCData(p.b));return c}if(!b&&18==f&&13==q)return p.b+="&",b=c-h,p.b+=null==b?F.substr(a,h,null):F.substr(a,h,b),d.addChild(A.createPCData(p.b)),c;throw new H(new Aa("Unexpected end",a,c));};var H=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,H)};H.__name__=["js","_Boot","HaxeError"];H.wrap=function(a){return a instanceof Error?a:new H(a)};H.__super__=Error;H.prototype=r(Error.prototype,
{__class__:H});var y=function(){};y.__name__=["js","Boot"];y.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=y.__nativeClassName(a);return null!=a?y.__resolveNativeClass(a):null};y.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];
c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+y.__string_rec(a[f],b)):c+y.__string_rec(a[f],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)f=e++,d+=(0<f?",":"")+y.__string_rec(a[f],b);return d+"]"}try{d=a.toString}catch(g){return"???"}if(null!=d&&(d!=Object.toString&&"function"==typeof d)&&(c=a.toString(),"[object Object]"!=c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||("prototype"==c||"__class__"==c||"__super__"==c||
"__interfaces__"==c||"__properties__"==c)||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+y.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "string":return a;default:return String(a)}};y.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||y.__interfLoop(f,b))return!0}return y.__interfLoop(a.__super__,b)};y.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof
Array?null==a.__enum__:!1;case Sg:return"boolean"==typeof a;case Xg:return!0;case Tg:return"number"==typeof a;case Yg:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==typeof b){if(a instanceof b||y.__interfLoop(y.getClass(a),b))return!0}else{if("object"==typeof b&&y.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==Zg&&null!=a.__name__||b==$g&&null!=a.__ename__?!0:a.__enum__==b}};y.__cast=function(a,b){if(y.__instanceof(a,
b))return a;throw new H("Cannot cast "+ga.string(a)+" to "+ga.string(b));};y.__nativeClassName=function(a){a=y.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};y.__isNativeObj=function(a){return null!=y.__nativeClassName(a)};y.__resolveNativeClass=function(a){return Pg[a]};var Ya=function(){};Ya.__name__=["js","Browser"];Ya.getLocalStorage=function(){try{var a=window.localStorage;a.getItem("");return a}catch(b){return null}};Ya.getSessionStorage=function(){try{var a=
window.sessionStorage;a.getItem("");return a}catch(b){return null}};var yb=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};yb.__name__=["js","html","compat","ArrayBuffer"];yb.sliceImpl=function(a,b){var c=new Ug(this,a,null==b?null:b-a),d=new Rg(c.byteLength);(new Ug(d)).set(c);return d};yb.prototype={slice:function(a,b){return new yb(this.a.slice(a,b))},__class__:yb};var dc=function(){};
dc.__name__=["js","html","compat","Uint8Array"];dc._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new yb(c)}else if(y.__instanceof(a,yb))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,c.byteOffset=0,c.buffer=new yb(c);else throw new H("TODO "+ga.string(a));c.subarray=dc._subarray;
c.set=dc._set;return c};dc._set=function(a,b){if(y.__instanceof(a.buffer,yb)){if(a.byteLength+b>this.byteLength)throw new H("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new H("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new H("TODO");};dc._subarray=function(a,b){var c=dc._new(this.slice(a,b));c.byteOffset=a;return c};var Cc={__ename__:!0,__constructs__:["Fixed",
"Percent"],Fixed:["Fixed",0]};Cc.Fixed.__enum__=Cc;Cc.Percent=["Percent",1];Cc.Percent.__enum__=Cc;Cc.__empty_constructs__=[Cc.Fixed,Cc.Percent];var ob={__ename__:!0,__constructs__:["Length","Fixed","Percent"],Length:["Length",0]};ob.Length.__enum__=ob;ob.Fixed=["Fixed",1];ob.Fixed.__enum__=ob;ob.Percent=["Percent",2];ob.Percent.__enum__=ob;ob.__empty_constructs__=[ob.Length,ob.Fixed,ob.Percent];var pb={__ename__:!0,__constructs__:["Tangent","Chain","ChainScale"],Tangent:["Tangent",0]};pb.Tangent.__enum__=
pb;pb.Chain=["Chain",1];pb.Chain.__enum__=pb;pb.ChainScale=["ChainScale",2];pb.ChainScale.__enum__=pb;pb.__empty_constructs__=[pb.Tangent,pb.Chain,pb.ChainScale];var Ha,Wg=0;String.prototype.__class__=String;String.__name__=["String"];Array.__name__=["Array"];Date.prototype.__class__=Date;Date.__name__=["Date"];var Yg={__name__:["Int"]},Xg={__name__:["Dynamic"]},Tg=Number;Tg.__name__=["Float"];var Sg=Boolean;Sg.__ename__=["Bool"];var Zg={__name__:["Class"]},$g={},N={},Vg=Vg||{};Vg.JQuery=window.jQuery;
var Rg=Pg.ArrayBuffer||yb;null==Rg.prototype.slice&&(Rg.prototype.slice=yb.sliceImpl);var Ug=Pg.Uint8Array||dc._new;x.TARGET_FPS=60;x.TARGET_FPS_MOBILE=30;x.GAME_ID="scooby_doo_good_animal";x.DEFAULT_SCREEN_WIDTH=1024;x.DEFAULT_SCREEN_HEIGHT=768;x.DEFAULT_LOCALE="en-us";x.BACKGROUND_COLOR="#000000";x.dataLocale="";A.Element=0;A.PCData=1;A.CData=2;A.Comment=3;A.DocType=4;A.ProcessingInstruction=5;A.Document=6;J.b2_nullFeature=255;J.s_incidentEdge=J.makeClipPointVector();J.s_clipPoints1=J.makeClipPointVector();
J.s_clipPoints2=J.makeClipPointVector();J.s_edgeAO=[];J.s_edgeBO=[];J.s_localTangent=new t;J.s_localNormal=new t;J.s_planePoint=new t;J.s_normal=new t;J.s_tangent=new t;J.s_tangent2=new t;J.s_v11=new t;J.s_v12=new t;J.b2CollidePolyTempVec=new t;$a.s_simplex=new xf;$a.s_saveA=[];$a.s_saveB=[];dd.currentID=0;C.b2_toiCalls=0;C.b2_toiIters=0;C.b2_toiMaxIters=0;C.b2_toiRootIters=0;C.b2_toiMaxRootIters=0;C.s_cache=new Gf;C.s_distanceInput=new yf;C.s_xfA=new qb;C.s_xfB=new qb;C.s_fcn=new Ff;C.s_distanceOutput=
new zf;za.e_hitCollide=1;za.e_missCollide=0;za.e_startsInsideCollide=-1;qa.s_mat=new ja;v.VERSION="2.1alpha";v.USHRT_MAX=65535;v.b2_pi=Math.PI;v.b2_maxManifoldPoints=2;v.b2_aabbExtension=0.1;v.b2_aabbMultiplier=2;v.b2_polygonRadius=2*v.b2_linearSlop;v.b2_linearSlop=0.005;v.b2_angularSlop=0.011111111111111112*v.b2_pi;v.b2_toiSlop=8*v.b2_linearSlop;v.b2_maxTOIContactsPerIsland=32;v.b2_maxTOIJointsPerIsland=32;v.b2_velocityThreshold=1;v.b2_maxLinearCorrection=0.2;v.b2_maxAngularCorrection=0.044444444444444446*
v.b2_pi;v.b2_maxTranslation=2;v.b2_maxTranslationSquared=v.b2_maxTranslation*v.b2_maxTranslation;v.b2_maxRotation=0.5*v.b2_pi;v.b2_maxRotationSquared=v.b2_maxRotation*v.b2_maxRotation;v.b2_contactBaumgarte=0.2;v.b2_timeToSleep=0.5;v.b2_linearSleepTolerance=0.01;v.b2_angularSleepTolerance=0.011111111111111112*v.b2_pi;q.b2Vec2_zero=new t(0,0);q.b2Mat22_identity=ja.fromVV(new t(1,0),new t(0,1));q.b2Transform_identity=new qb(q.b2Vec2_zero,q.b2Mat22_identity);z.s_xf1=new qb;z.e_islandFlag=1;z.e_awakeFlag=
2;z.e_allowSleepFlag=4;z.e_bulletFlag=8;z.e_fixedRotationFlag=16;z.e_activeFlag=32;z.b2_staticBody=0;z.b2_kinematicBody=1;z.b2_dynamicBody=2;fd.b2_defaultFilter=new fd;ib.b2_defaultListener=new ib;ce.s_evalCP=new wf;Ca.e_shapeBit=1;Ca.e_jointBit=2;Ca.e_aabbBit=4;Ca.e_pairBit=8;Ca.e_centerOfMassBit=16;Ca.e_controllerBit=32;gc.s_impulse=new Kf;ea.s_timestep2=new hd;ea.s_xf=new qb;ea.s_backupA=new Jb;ea.s_backupB=new Jb;ea.s_timestep=new hd;ea.s_queue=[];ea.s_jointColor=new ae(0.5,0.8,0.8);ea.e_newFixture=
1;ea.e_locked=2;D.e_sensorFlag=1;D.e_continuousFlag=2;D.e_islandFlag=4;D.e_toiFlag=8;D.e_touchingFlag=16;D.e_enabledFlag=32;D.e_filterFlag=64;D.s_input=new Hf;id.circlePointA=new t;id.circlePointB=new t;Ga.staticFix=v.b2_maxManifoldPoints;Ga.s_worldManifold=new If;Ga.s_psm=new id;rb.b2_minPulleyLength=2;sb.tImpulse=new t;M._currentInstanceId=0;R._properties=new Ba;Bb._currentZIndex=0;Pb.MIN_LOAD_TIME=0.5;Pb.MAX_ACTIVE_REQUESTS=10;oa._isInitialized=!1;p.ORIENTATION_HORIZONTAL=0;p.ORIENTATION_VERTICAL=
1;p._devicePixelRatio=-1;p._timeService=new ue;n._masterVolume=1;n._musicVolume=0.25;n._soundVolume=1;n._musicMuted=!1;n._soundMuted=!1;n._soundsPlaying=[];n._isWebkitEnabled=!1;n._useFlashSound=!1;n._soundTimers=new Ba;Db.BEGIN_CONTACT="beginContact";Db.END_CONTACT="endContact";nd.PHYSICS_FPS=60;nd.TIMESTEP=0.016666666666666666;ic.PRE_UPDATE="preUpdate";ic.UPDATE="update";ra.FRAMERATE=30;lc.EPSILON=5E-5;Eb.UPDATE="update";Ka._delayButtonLock=!1;V.VISIBILITY_OFF="visibilityOff";V.VISIBILITY_ON="visibilityOn";
V.DISPLAY_UPDATE="displayUpdate";V.ADDED_TO_PARENT="addedToParent";V.REMOVED_FROM_PARENT="removedFromParent";V.PARENT_UPDATE="parentUpdate";V.MOUSE_DOWN="mouseDown";V.MOUSE_UP="mouseUp";V.MOUSE_MOVE="mouseMove";V.MOUSE_OUT="mouseOut";V.MOUSE_OVER="mouseOver";V.MOUSE_CLICK="mouseClick";jb.DESTROY="destroy";jb.ACTIVATE="activate";jb.DEACTIVATE="deactivate";jb.INITIALIZE="initialize";od.RAYCAST_CHECK="raycastCheck";I.assetList=new Ba;vb.BEAT_LEVEL="beatLevel";vb.FAIL_LEVEL="failLevel";vb.TURBO_START=
"turboStart";vb.TURBO_END="turboEnd";vb.COMIC_SNAPSHOT="comicSnapshot";qc.MIDPOINT="midpoint";qc.COMPLETE="complete";sd.SHOW_SUBTITLE="showSubtitle";ud.UPDATE_DISPLAY="updateDisplay";vd.CHANGE="change";eb.TIME_SCALE=2;eb.TRANSITION_TIME=0.325;eb.FADE_TIME=7.3;eb.FADE_DURATION=0;Y.NUM_LEVELS_UNLOCKED_KEY="numLevelsUnlocked";Y.LEVEL_SCORE_SAVE_KEY="levelScore";Y.HAS_BEATEN_GAME_KEY="hasBeatenGame";Y.HAS_STARTED_GAME_KEY="hasStartedGame";Ma.TRANSITION_DURATION=0.5;Ra.heuristic=Ra.manhattanHeuristic;
zd.COMPLETE="complete";Ad.COMPLETE="complete";Pc.COLLECT_ALL_FRUIT="allFruitCollected";Pc.COLLECT_FRUIT="collectFruit";Bd.OUT_OF_LIVES="outOfLives";Rc.BASE_SCREEN_WIDTH=1024;Rc.MAZE_SCROLL_DURATION=0.5;Xc.LOST_PUPPY_IMAGES=["rescuePuppy1","rescuePuppy2","rescuePuppy3","rescuePuppy4","rescuePuppy5"];Jd.COLLECT="collect";Kd.JOIN_TILE="joinTile";Ld.ROTATION_VARIANCE=15;Md.EXIT_ACTIVATE="exitActivate";Xb.WALL_SMASH="wallSmash";Ub.LOST_PUPPY_SOUNDS=["sfxPupRescue1","sfxPupRescue2","sfxPupRescue3","sfxPupRescue4"];
uc.CHANGE_TILE_START="changeTileStart";uc.CHANGE_TILE_END="changeTileEnd";vc.FOOTSTEP_SOUNDS=["sfxScoobyWalking1","sfxScoobyWalking2","sfxScoobyWalking3","sfxScoobyWalking4"];Ne.MONSTER_NUMBER_SPAWN_DELAYS=[5,15,25];gb.HIT="hit";gb.RESPAWN="respawn";gb.EXIT_LEVEL="exitLevel";gb.FINISH_MOVING_TO_TILE="finishMovingToTile";gb.COLLECT_LOST_PUPPY="collectLostPuppy";Vb.REQUIRED_DISTANCE=35;xc.SPLASH_SOUNDS=["sfxWaterSplash1","sfxWaterSplash2","sfxWaterSplash3"];Pd.JUMP_SCALE=1.5;Tb.SHOW_MENU="OnMenu";Tb.TOGGLE_MUSIC=
"onToggleMusic";Sd.COMPLETE="complete";bc.MOBILE_POPUP_SCALE=0.9;Fd.TIME_SCALE=0.8;uf.THRESHHOLD=25;cc.NUM_PAGES=0;Bc.RESUME="resume";Bc.QUIT="quit";Ac.ENTER_COMPLETE="enterComplete";Ac.DISMISS_COMPLETE="dismissComplete";Ud.RESUME="resume";tc.count=0;Ib.escapes=function(a){a=new Ba;null!=N.lt?a.setReserved("lt","<"):a.h.lt="<";null!=N.gt?a.setReserved("gt",">"):a.h.gt=">";null!=N.amp?a.setReserved("amp","&"):a.h.amp="&";null!=N.quot?a.setReserved("quot",'"'):a.h.quot='"';null!=N.apos?a.setReserved("apos",
"'"):a.h.apos="'";return a}(this);y.__toStr={}.toString;dc.BYTES_PER_ELEMENT=1;x.main()})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
