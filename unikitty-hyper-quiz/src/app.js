

if(createjs){
    var c = createjs;
}

var globals = globals || {};



var stage;
var isDebugging=true;

globals.strings;
globals.bSound=true;
globals.isDebugging=true;
globals.soundInstance;
globals.isMobile = detectMobile();
var main;



var app =  app || {};
app.country='uk';
app.prefix='unikitty';
app.points=0;
app.step=0;
app.quizes={};
app.game1={};
app.game2={};
app.game3={};
app.game4={};
app.global = {};
app.times={};
app.gameConfig =[1,2,3,4];
app.isMore=false;


app.currentGame=0;

for(var i=1;i<6;i++){
    app.times['game'+i]={};
    app.times['game'+i].points=0;
    app.times['game'+i].time='0:00';
    app.times['game'+i].mili='0';
}

app.animSad ={
    "framerate":24,
    "images":["img/anim/sad_0.png", "img/anim/sad_1.png", "img/anim/sad_2.png"],
    "frames":[
        [2023, 0, 1, 1, 0, 0, 0],
        [1652, 378, 320, 257, 0, -123, -165],
        [1554, 0, 469, 316, 0, -108, -114],
        [1149, 725, 498, 344, 0, -96, -92],
        [534, 0, 510, 354, 0, -95, -84],
        [1044, 0, 510, 354, 0, -95, -84],
        [0, 378, 555, 347, 0, -66, -90],
        [555, 378, 555, 347, 0, -66, -90],
        [1196, 0, 608, 318, 1, -28, -118],
        [0, 571, 608, 263, 2, -28, -118],
        [1175, 571, 647, 245, 2, 0, -136],
        [0, 1064, 647, 191, 2, 0, -136],
        [1177, 0, 631, 285, 2, -24, -120],
        [545, 0, 632, 285, 2, -24, -120],
        [0, 0, 625, 323, 1, -32, -120],
        [1139, 1414, 620, 323, 0, -32, -120],
        [573, 1253, 611, 292, 1, -19, -120],
        [1184, 1253, 611, 292, 1, -19, -120],
        [0, 287, 618, 284, 2, -20, -129],
        [577, 1546, 618, 289, 1, -20, -124],
        [1195, 1546, 595, 287, 1, -23, -124],
        [0, 725, 595, 345, 0, -23, -66],
        [538, 1070, 574, 343, 0, -25, -66],
        [562, 948, 564, 302, 1, -35, -47],
        [1126, 948, 558, 302, 1, -17, -47],
        [560, 638, 558, 310, 1, -17, -40],
        [0, 638, 560, 310, 1, -38, -40],
        [0, 948, 562, 305, 1, -36, -44],
        [1118, 638, 580, 305, 1, -32, -44],
        [618, 287, 575, 280, 2, -37, -68],
        [0, 834, 583, 230, 2, -37, -68],
        [583, 834, 589, 215, 2, -49, -83],
        [1172, 834, 591, 203, 2, -47, -83],
        [608, 571, 567, 251, 2, -48, -70],
        [0, 1546, 577, 292, 1, -59, -70],
        [0, 1253, 573, 293, 1, -63, -69],
        [563, 323, 584, 315, 1, -64, -69],
        [0, 323, 563, 315, 1, -85, -69],
        [625, 0, 571, 322, 1, -85, -69],
        [1147, 323, 579, 314, 1, -77, -77],
        [560, 1414, 579, 324, 0, -77, -72],
        [0, 1414, 560, 324, 0, -96, -72],
        [595, 725, 554, 344, 0, -96, -54],
        [0, 1070, 538, 344, 0, -112, -54],
        [0, 0, 534, 378, 0, -112, -52],
        [1110, 378, 542, 345, 0, -81, -52],
        [1112, 1070, 542, 332, 0, -81, -64],
        [0, 0, 545, 287, 2, -58, -64],
        [1193, 287, 548, 267, 2, -58, -84],
        [1220, 1064, 573, 167, 2, -35, -85],
        [585, 1422, 570, 150, 2, -35, -102],
        [0, 1422, 585, 154, 2, -20, -115],
        [647, 1064, 573, 172, 2, -20, -97],
        [1155, 1422, 585, 119, 2, -9, -97],
        [572, 1255, 585, 155, 2, -9, -92],
        [1157, 1255, 576, 155, 2, -8, -92],
        [0, 1255, 572, 167, 2, -8, -104]
    ],
    "animations":{
        "idle": {"speed": 1, "frames": [0]},
        "anim": {
            "speed": 1,
            "next": "anim",
            "frames": [
                1,
                2,
                2,
                3,
                3,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
                26,
                27,
                28,
                29,
                30,
                31,
                32,
                33,
                34,
                35,
                36,
                37,
                38,
                39,
                40,
                41,
                42,
                43,
                44,
                45,
                46,
                47,
                48,
                49,
                50,
                51,
                52,
                53,
                54,
                55,
                56
            ]
        }
    }
}
app.animAngry ={
    "framerate":24,
    "images":["img/anim/angry_0.png", "img/anim/angry_1.png"],
    "frames":[
        [1931, 0, 1, 1, 0, 0, 0],
        [652, 487, 633, 460, 0, -20, -36],
        [638, 968, 646, 443, 0, -14, -42],
        [1346, 0, 673, 323, 1, -4, -38],
        [668, 0, 678, 323, 1, 0, -37],
        [0, 0, 668, 340, 1, -16, -27],
        [1281, 1424, 679, 386, 0, -15, -8],
        [0, 1424, 650, 422, 0, -49, 0],
        [1284, 968, 629, 427, 0, -45, 0],
        [650, 1424, 631, 397, 0, -44, 0],
        [0, 968, 638, 456, 0, -36, 0],
        [1285, 487, 650, 457, 0, -22, -2],
        [1298, 0, 633, 483, 0, -19, -13],
        [0, 0, 645, 487, 0, -11, -14],
        [645, 0, 653, 484, 0, -5, -17],
        [0, 487, 652, 481, 0, -5, -23]
    ],
    "animations":{
        "idle": {"speed": 1, "frames": [0]},
        "anim": {
            "speed": 1,
            "next": "anim",
            "frames": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
        }
    }
};
app.animHappy ={
    "framerate":24,
    "images":["img/anim/happy_0.png", "img/anim/happy_1.png", "img/anim/happy_2.png", "img/anim/happy_3.png"],
    "frames":[
        [1914, 0, 1, 1, 0, 0, 0],
        [1866, 0, 48, 45, 0, -119, -404],
        [1672, 0, 367, 304, 2, -119, -145],
        [1497, 1145, 404, 353, 1, -102, -106],
        [1185, 0, 553, 387, 1, -89, -78],
        [0, 851, 567, 401, 0, -90, -66],
        [567, 851, 567, 401, 0, -90, -66],
        [1134, 851, 573, 399, 0, -96, -67],
        [0, 1252, 573, 399, 0, -96, -67],
        [0, 0, 571, 388, 1, -100, -77],
        [1212, 1395, 557, 326, 2, -114, -77],
        [0, 1722, 585, 308, 2, -85, -95],
        [1299, 0, 585, 239, 3, -85, -95],
        [0, 1395, 635, 327, 2, -32, -105],
        [635, 1395, 577, 327, 2, -32, -105],
        [500, 0, 595, 353, 2, -14, -84],
        [0, 0, 500, 353, 2, -14, -84],
        [489, 1145, 489, 360, 1, -1, -84],
        [0, 1145, 489, 360, 1, -1, -84],
        [639, 705, 501, 341, 2, 0, -101],
        [1238, 774, 501, 362, 1, 0, -80],
        [978, 1145, 519, 359, 1, -3, -80],
        [0, 1651, 519, 392, 0, -3, -47],
        [1149, 1651, 564, 390, 0, -6, -47],
        [0, 1055, 537, 340, 2, -33, -22],
        [537, 1055, 564, 340, 2, -33, -22],
        [1095, 0, 577, 352, 2, -20, -12],
        [0, 353, 609, 352, 2, -20, -12],
        [1229, 353, 620, 350, 2, -9, -13],
        [0, 705, 639, 350, 2, -9, -13],
        [1140, 705, 640, 341, 2, -8, -21],
        [0, 0, 650, 286, 3, -8, -21],
        [650, 0, 649, 269, 3, -9, -38],
        [0, 286, 638, 230, 3, -9, -38],
        [638, 286, 636, 222, 3, -11, -46],
        [1101, 1055, 651, 335, 2, -62, -46],
        [633, 1505, 651, 354, 1, -62, -27],
        [613, 388, 598, 378, 1, -128, -27],
        [1211, 388, 602, 378, 1, -124, -27],
        [0, 388, 613, 386, 1, -124, -27],
        [0, 774, 608, 371, 1, -129, -42],
        [573, 1252, 615, 395, 0, -120, -24],
        [1188, 1252, 615, 395, 0, -120, -24],
        [1258, 0, 608, 421, 0, -121, 0],
        [627, 0, 631, 421, 0, -98, 0],
        [0, 0, 627, 431, 0, -98, 0],
        [0, 431, 584, 420, 0, -75, 0],
        [584, 431, 584, 419, 0, -75, 0],
        [1168, 431, 614, 406, 0, -47, 0],
        [571, 0, 614, 388, 1, -47, -18],
        [519, 1651, 630, 390, 0, -30, -18],
        [608, 774, 630, 367, 1, -30, -41],
        [0, 1505, 633, 356, 1, -21, -51],
        [1284, 1505, 633, 353, 1, -21, -54],
        [609, 353, 620, 352, 2, -31, -54],
        [585, 1722, 607, 296, 2, -31, -55],
        [1192, 1722, 616, 291, 2, -47, -60],
        [1274, 286, 512, 210, 3, -151, -82],
        [522, 516, 558, 200, 3, -152, -90],
        [1080, 516, 506, 187, 3, -204, -90],
        [0, 516, 522, 207, 3, -204, -71],
        [0, 723, 438, 126, 3, -288, -71],
        [1586, 516, 428, 149, 3, -309, -71],
        [877, 723, 439, 112, 3, -299, -86],
        [438, 723, 439, 112, 3, -299, -86],
        [0, 849, 455, 98, 3, -281, -100],
        [1316, 723, 455, 98, 3, -281, -100],
        [455, 849, 439, 88, 3, -294, -123],
        [1290, 849, 399, 86, 3, -294, -128],
        [894, 849, 396, 88, 3, -297, -128]
    ],
    "animations":{
        "idle": {"speed": 1, "frames": [0]},
        "anim": {
            "speed": 1,
            "next": "anim",
            "frames": [
                1,
                2,
                3,
                3,
                4,
                4,
                5,
                6,
                7,
                8,
                9,
                10,
                11,
                12,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                21,
                22,
                23,
                24,
                25,
                26,
                27,
                28,
                29,
                30,
                31,
                32,
                33,
                34,
                35,
                36,
                37,
                38,
                39,
                40,
                41,
                42,
                43,
                44,
                45,
                46,
                47,
                48,
                49,
                50,
                51,
                52,
                53,
                54,
                55,
                56,
                57,
                58,
                59,
                60,
                61,
                62,
                62,
                63,
                64,
                65,
                66,
                67,
                68,
                69
            ]
        }
    }
};


if(  document.addEventListener  ){

    $(document).ready(function(){


        var music = document.getElementById("music");
        music.play();
        music.volume=0.2;
       loadLocally();


    });
    function loadLocally()
    {
        main=new Main();


        $.getJSON( "strings/strings.json?rand="+Math.random(), function( data ) {


            $.cookie.json = true;

            globals.strings = data.game;


            ///quiz
            console.log('przed')
            var cookie  = $.cookie(app.prefix+"_"+app.country+"_quizes");
            console.log('po')
            console.log(cookie);
            if(cookie==undefined){
                app.quizes = data.game.pages.text_quizes;
                app.quizes = app.quizes.concat( data.game.pages.image_quizes);
            }else{
                app.quizes = cookie;
            }

           //game1
            cookie  = $.cookie(app.prefix+"_"+app.country+"_game1");
            if(cookie==undefined){
                app.game1 = data.game.pages.game1.images;
            }else{
                app.game1 = cookie;
            }

            cookie  = $.cookie(app.prefix+"_"+app.country+"_game2");
            if(cookie==undefined){
                app.game2 = data.game.pages.game2.images;
            }else{
                app.game2 = cookie;
            }


            cookie  = $.cookie(app.prefix+"_"+app.country+"_game3");
            if(cookie==undefined){
                app.game3 = data.game.pages.game3.images;
            }else{
                app.game3 = cookie;
            }

            cookie  = $.cookie(app.prefix+"_"+app.country+"_game4");
            if(cookie==undefined){
                app.game4 = data.game.pages.game4.images;
            }else{
                app.game4 = cookie;
            }

            app.global = data.game.pages.global;
            shuffle(app.gameConfig);


            var toPut = app.gameConfig[Math.floor(Math.random()*3)];

            app.gameConfig.push(toPut);

            shuffle(app.quizes);
            shuffle(app.game1);
            shuffle(app.game2);
            shuffle(app.game3);
            shuffle(app.game4);




            main.init();
        });

    }


}

window.addEventListener("orientationchange", resizeCanvas, false);
window.addEventListener('resize', resizeCanvas, false);

function resizeCanvas() {

    main.resize();
}