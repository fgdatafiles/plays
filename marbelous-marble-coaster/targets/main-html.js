/* global document, window */
var SMALL_ASSETS = (function () {
	var ua = window.navigator.userAgent.toLowerCase(),
        platforms = [
            [           "os 9_",       ""],
            [          "os 10_",       ""],
            [          "os 11_",       ""],
            [          "iphone",   "dpi2"], // narrow to older iPhones
            ["ipad; cpu os 12_", "scr4:3"], // A bit aggressive in grabbing some newer models, but have found no reliable way to detect gpu capabilities and/or narrow to older iPad minis
            [      "android 4.",       ""],
            [      "android 5.",       ""],
            [      "android 6.",       ""]
		],
		i = 0,
		match = null;
    
    for (i = 0; i < platforms.length; i++) {
        match = platforms[i];
        if (ua.indexOf(match[0]) >= 0) {
            if (!match[1] ||
                ((match[1] === 'scr4:3') && ((window.screen.height / window.screen.width) === (1024 / 768))) ||
                ((match[1] === 'dpi2') && (window.devicePixelRatio === 2))) {
                return true;
            }
        }
	}
	
	return false;
}());

(function () { "use strict";
var $hxClasses = {},$estr = function() { return js.Boot.__string_rec(this,''); };
function $extend(from, fields) {
	function inherit() {}; inherit.prototype = from; var proto = new inherit();
	for (var name in fields) proto[name] = fields[name];
	return proto;
}
var EReg = function(r,opt) {
	opt = opt.split("u").join("");
	this.r = new RegExp(r,opt);
};
$hxClasses["EReg"] = EReg;
EReg.__name__ = ["EReg"];
EReg.prototype = {
	replace: function(s,by) {
		return s.replace(this.r,by);
	}
	,matched: function(n) {
		return this.r.m != null && n >= 0 && n < this.r.m.length?this.r.m[n]:(function($this) {
			var $r;
			throw "EReg::matched";
			return $r;
		}(this));
	}
	,match: function(s) {
		if(this.r.global) this.r.lastIndex = 0;
		this.r.m = this.r.exec(s);
		this.r.s = s;
		return this.r.m != null;
	}
	,__class__: EReg
}
var Hash = function() {
	this.h = { };
};
$hxClasses["Hash"] = Hash;
Hash.__name__ = ["Hash"];
Hash.prototype = {
	iterator: function() {
		return { ref : this.h, it : this.keys(), hasNext : function() {
			return this.it.hasNext();
		}, next : function() {
			var i = this.it.next();
			return this.ref["$" + i];
		}};
	}
	,keys: function() {
		var a = [];
		for( var key in this.h ) {
		if(this.h.hasOwnProperty(key)) a.push(key.substr(1));
		}
		return HxOverrides.iter(a);
	}
	,remove: function(key) {
		key = "$" + key;
		if(!this.h.hasOwnProperty(key)) return false;
		delete(this.h[key]);
		return true;
	}
	,exists: function(key) {
		return this.h.hasOwnProperty("$" + key);
	}
	,get: function(key) {
		return this.h["$" + key];
	}
	,set: function(key,value) {
		this.h["$" + key] = value;
	}
	,__class__: Hash
}
var HxOverrides = function() { }
$hxClasses["HxOverrides"] = HxOverrides;
HxOverrides.__name__ = ["HxOverrides"];
HxOverrides.dateStr = function(date) {
	var m = date.getMonth() + 1;
	var d = date.getDate();
	var h = date.getHours();
	var mi = date.getMinutes();
	var s = date.getSeconds();
	return date.getFullYear() + "-" + (m < 10?"0" + m:"" + m) + "-" + (d < 10?"0" + d:"" + d) + " " + (h < 10?"0" + h:"" + h) + ":" + (mi < 10?"0" + mi:"" + mi) + ":" + (s < 10?"0" + s:"" + s);
}
HxOverrides.strDate = function(s) {
	switch(s.length) {
	case 8:
		var k = s.split(":");
		var d = new Date();
		d.setTime(0);
		d.setUTCHours(k[0]);
		d.setUTCMinutes(k[1]);
		d.setUTCSeconds(k[2]);
		return d;
	case 10:
		var k = s.split("-");
		return new Date(k[0],k[1] - 1,k[2],0,0,0);
	case 19:
		var k = s.split(" ");
		var y = k[0].split("-");
		var t = k[1].split(":");
		return new Date(y[0],y[1] - 1,y[2],t[0],t[1],t[2]);
	default:
		throw "Invalid date format : " + s;
	}
}
HxOverrides.cca = function(s,index) {
	var x = s.charCodeAt(index);
	if(x != x) return undefined;
	return x;
}
HxOverrides.substr = function(s,pos,len) {
	if(pos != null && pos != 0 && len != null && len < 0) return "";
	if(len == null) len = s.length;
	if(pos < 0) {
		pos = s.length + pos;
		if(pos < 0) pos = 0;
	} else if(len < 0) len = s.length + len - pos;
	return s.substr(pos,len);
}
HxOverrides.remove = function(a,obj) {
	var i = 0;
	var l = a.length;
	while(i < l) {
		if(a[i] == obj) {
			a.splice(i,1);
			return true;
		}
		i++;
	}
	return false;
}
HxOverrides.iter = function(a) {
	return { cur : 0, arr : a, hasNext : function() {
		return this.cur < this.arr.length;
	}, next : function() {
		return this.arr[this.cur++];
	}};
}
var IntHash = function() {
	this.h = { };
};
$hxClasses["IntHash"] = IntHash;
IntHash.__name__ = ["IntHash"];
IntHash.prototype = {
	keys: function() {
		var a = [];
		for( var key in this.h ) {
		if(this.h.hasOwnProperty(key)) a.push(key | 0);
		}
		return HxOverrides.iter(a);
	}
	,remove: function(key) {
		if(!this.h.hasOwnProperty(key)) return false;
		delete(this.h[key]);
		return true;
	}
	,exists: function(key) {
		return this.h.hasOwnProperty(key);
	}
	,get: function(key) {
		return this.h[key];
	}
	,set: function(key,value) {
		this.h[key] = value;
	}
	,__class__: IntHash
}
var Lambda = function() { }
$hxClasses["Lambda"] = Lambda;
Lambda.__name__ = ["Lambda"];
Lambda.array = function(it) {
	var a = new Array();
	var $it0 = $iterator(it)();
	while( $it0.hasNext() ) {
		var i = $it0.next();
		a.push(i);
	}
	return a;
}
Lambda.count = function(it,pred) {
	var n = 0;
	if(pred == null) {
		var $it0 = $iterator(it)();
		while( $it0.hasNext() ) {
			var _ = $it0.next();
			n++;
		}
	} else {
		var $it1 = $iterator(it)();
		while( $it1.hasNext() ) {
			var x = $it1.next();
			if(pred(x)) n++;
		}
	}
	return n;
}
var List = function() {
	this.length = 0;
};
$hxClasses["List"] = List;
List.__name__ = ["List"];
List.prototype = {
	iterator: function() {
		return { h : this.h, hasNext : function() {
			return this.h != null;
		}, next : function() {
			if(this.h == null) return null;
			var x = this.h[0];
			this.h = this.h[1];
			return x;
		}};
	}
	,add: function(item) {
		var x = [item];
		if(this.h == null) this.h = x; else this.q[1] = x;
		this.q = x;
		this.length++;
	}
	,__class__: List
}
var flambe = {}
flambe.math = {}
flambe.math.Point = function(x,y) {
	if(y == null) y = 0;
	if(x == null) x = 0;
	this.x = x;
	this.y = y;
};
$hxClasses["flambe.math.Point"] = flambe.math.Point;
flambe.math.Point.__name__ = ["flambe","math","Point"];
flambe.math.Point.prototype = {
	toString: function() {
		return "(" + this.x + "," + this.y + ")";
	}
	,__class__: flambe.math.Point
}
var Main = function() {
};
$hxClasses["Main"] = Main;
Main.__name__ = ["Main"];
Main.main = function() {
	Main.registerCompositionReference();
	Main.setWrapper();
}
Main.registerCompositionReference = function() {
	var composition = { groups: [{ id: "backBtn", classes: ["btn_back"], components: [com.cmm.common.components.btn.BackBtn] }, { id: "nextBtn", classes: ["btn_next"], components: [com.cmm.common.components.btn.PlayBtn] }, { id: "playBtn", classes: ["btn_play", "btn_continue", "btn_playAgain"], components: [com.cmm.common.components.btn.PlayBtn] }, { id: "backBtn", classes: ["btn_playAgain"], components: [com.cmm.mmc.app.endGameState.BackToGameBtn] }, { id: "skipBtn", classes: ["btn_skip"], components: [com.cmm.common.components.btn.SkipBtn] }, { id: "toggleContainer", classes: ["mc_mute"], components: [com.cmm.common.components.mc.ToggleContainer] }, { id: "dosHudBtn", classes: ["btn_DOSHudBtn"], components: [com.cmm.client.dos.components.btn.DOSHudBtn] }, { id: "dosCloseBtn", classes: ["btn_DOSMenuClose"], components: [com.cmm.client.dos.components.btn.DOSCloseBtn] }, { id: "dosHelpBtn", classes: ["btn_DOSHelpBtn"], components: [com.cmm.client.dos.components.btn.DOSHelpBtn] }, { id: "trackPiece", classes: ["mc_piece1", "mc_piece2", "mc_piece3", "mc_piece4", "mc_piece5", "mc_piece6", "mc_piece7", "mc_piece8", "mc_piece9", "mc_piece10", "mc_piece11", "mc_piece12", "mc_piece13", "mc_piece14", "mc_piece15", "mc_piece16", "mc_piece17", "mc_piece18", "mc_piece19", "mc_piece20", "mc_piece21", "mc_piece22", "mc_piece23", "mc_piece24", "mc_piece25"], components: [com.cmm.mmc.app.gameState.TrackPiece] }, { id: "componentBtn", classes: ["btn_piece1", "btn_piece2", "btn_piece3", "btn_piece4", "btn_piece5", "btn_piece6", "btn_piece7", "btn_piece8", "btn_piece9", "btn_piece10", "btn_piece11", "btn_piece12", "btn_piece13", "btn_piece14", "btn_piece15", "btn_piece16", "btn_piece17", "btn_piece18", "btn_piece19", "btn_piece20", "btn_piece21", "btn_piece22", "btn_piece23", "btn_piece24", "btn_piece25"], components: [com.cmm.activityEngines.customBuilder.components.btn.BuilderComponentBtn] }, { id: "launcherBtn", classes: ["btn_launcher"], components: [com.cmm.mmc.app.gameState.LauncherBtn] }, { id: "clearAllBtn", classes: ["btn_clearAll"], components: [com.cmm.mmc.app.gameState.ClearAllBtn] }, { id: "helpBtn", classes: ["btn_help"], components: [com.cmm.mmc.app.gameState.HelpBtn] }, { id: "confirmYesBtn", classes: ["btn_confirmYes"], components: [com.cmm.mmc.app.gameState.YesBtn] }, { id: "confirmNoBtn", classes: ["btn_confirmNo"], components: [com.cmm.mmc.app.gameState.NoBtn] }, { id: "forwardBtn", classes: ["btn_forwardScroll"], components: [com.cmm.common.components.btn.GenericBtn] }, { id: "backwardBtn", classes: ["btn_backwardScroll"], components: [com.cmm.common.components.btn.GenericBtn] }, { id: "gamesBtn", classes: ["btn_games"], components: [com.cmm.mmc.app.endGameState.GamesBtn] }, { id: "arrows", classes: ["btn_arrownext", "btn_arrowback"], components: [com.cmm.common.components.btn.GenericBtn] }, { id: "switchBtn", classes: ["btn_piecesSwitch", "btn_coastersSwitch"], components: [com.cmm.mmc.app.gameState.SwitchBtn] }, { id: "coasterBtn", classes: ["btn_coaster1", "btn_coaster2", "btn_coaster3", "btn_coaster4", "btn_coaster5", "btn_coaster6", "btn_coaster7"], components: [com.cmm.mmc.app.gameState.PresetCoasterBtn] }], compositions: [{ id: "scroller", className: "mc_scrollBtns", components: [com.cmm.common.components.mc.SimpleScroller] }, { id: "backBtn", className: "btn_close", components: [com.cmm.common.components.btn.SkipBtn] }, { id: "timeline", className: "mc_scrollthumb", components: [com.cmm.mmc.app.gameState.TimelineScrollThumb], params: { dist: 300, axis: "Y", target: "mc_scroller" } }] };
	com.cmm.common.app.CompositionFactory.registerCompositionReference(composition);
}
Main.setWrapper = function() {
	var wrapper = new com.cmm.mmc.MMC();
}
Main.prototype = {
	__class__: Main
}
var Reflect = function() { }
$hxClasses["Reflect"] = Reflect;
Reflect.__name__ = ["Reflect"];
Reflect.field = function(o,field) {
	var v = null;
	try {
		v = o[field];
	} catch( e ) {
	}
	return v;
}
Reflect.setField = function(o,field,value) {
	o[field] = value;
}
Reflect.callMethod = function(o,func,args) {
	return func.apply(o,args);
}
Reflect.fields = function(o) {
	var a = [];
	if(o != null) {
		var hasOwnProperty = Object.prototype.hasOwnProperty;
		for( var f in o ) {
		if(hasOwnProperty.call(o,f)) a.push(f);
		}
	}
	return a;
}
Reflect.isFunction = function(f) {
	return typeof(f) == "function" && !(js.Boot.isClass(f) || js.Boot.isEnum(f));
}
Reflect.compareMethods = function(f1,f2) {
	if(f1 == f2) return true;
	if(!Reflect.isFunction(f1) || !Reflect.isFunction(f2)) return false;
	return f1.scope == f2.scope && f1.method == f2.method && f1.method != null;
}
Reflect.copy = function(o) {
	var o2 = { };
	var _g = 0, _g1 = Reflect.fields(o);
	while(_g < _g1.length) {
		var f = _g1[_g];
		++_g;
		Reflect.setField(o2,f,Reflect.field(o,f));
	}
	return o2;
}
var Std = function() { }
$hxClasses["Std"] = Std;
Std.__name__ = ["Std"];
Std["is"] = function(v,t) {
	return js.Boot.__instanceof(v,t);
}
Std.string = function(s) {
	return js.Boot.__string_rec(s,"");
}
Std["int"] = function(x) {
	return x | 0;
}
Std.parseInt = function(x) {
	var v = parseInt(x,10);
	if(v == 0 && (HxOverrides.cca(x,1) == 120 || HxOverrides.cca(x,1) == 88)) v = parseInt(x);
	if(isNaN(v)) return null;
	return v;
}
Std.parseFloat = function(x) {
	return parseFloat(x);
}
Std.random = function(x) {
	return Math.floor(Math.random() * x);
}
var StringBuf = function() {
	this.b = "";
};
$hxClasses["StringBuf"] = StringBuf;
StringBuf.__name__ = ["StringBuf"];
StringBuf.prototype = {
	toString: function() {
		return this.b;
	}
	,addSub: function(s,pos,len) {
		this.b += HxOverrides.substr(s,pos,len);
	}
	,addChar: function(c) {
		this.b += String.fromCharCode(c);
	}
	,add: function(x) {
		this.b += Std.string(x);
	}
	,__class__: StringBuf
}
var StringTools = function() { }
$hxClasses["StringTools"] = StringTools;
StringTools.__name__ = ["StringTools"];
StringTools.urlEncode = function(s) {
	return encodeURIComponent(s);
}
StringTools.urlDecode = function(s) {
	return decodeURIComponent(s.split("+").join(" "));
}
StringTools.startsWith = function(s,start) {
	return s.length >= start.length && HxOverrides.substr(s,0,start.length) == start;
}
StringTools.replace = function(s,sub,by) {
	return s.split(sub).join(by);
}
StringTools.hex = function(n,digits) {
	var s = "";
	var hexChars = "0123456789ABCDEF";
	do {
		s = hexChars.charAt(n & 15) + s;
		n >>>= 4;
	} while(n > 0);
	if(digits != null) while(s.length < digits) s = "0" + s;
	return s;
}
StringTools.fastCodeAt = function(s,index) {
	return s.charCodeAt(index);
}
StringTools.isEOF = function(c) {
	return c != c;
}
var ValueType = $hxClasses["ValueType"] = { __ename__ : ["ValueType"], __constructs__ : ["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"] }
ValueType.TNull = ["TNull",0];
ValueType.TNull.toString = $estr;
ValueType.TNull.__enum__ = ValueType;
ValueType.TInt = ["TInt",1];
ValueType.TInt.toString = $estr;
ValueType.TInt.__enum__ = ValueType;
ValueType.TFloat = ["TFloat",2];
ValueType.TFloat.toString = $estr;
ValueType.TFloat.__enum__ = ValueType;
ValueType.TBool = ["TBool",3];
ValueType.TBool.toString = $estr;
ValueType.TBool.__enum__ = ValueType;
ValueType.TObject = ["TObject",4];
ValueType.TObject.toString = $estr;
ValueType.TObject.__enum__ = ValueType;
ValueType.TFunction = ["TFunction",5];
ValueType.TFunction.toString = $estr;
ValueType.TFunction.__enum__ = ValueType;
ValueType.TClass = function(c) { var $x = ["TClass",6,c]; $x.__enum__ = ValueType; $x.toString = $estr; return $x; }
ValueType.TEnum = function(e) { var $x = ["TEnum",7,e]; $x.__enum__ = ValueType; $x.toString = $estr; return $x; }
ValueType.TUnknown = ["TUnknown",8];
ValueType.TUnknown.toString = $estr;
ValueType.TUnknown.__enum__ = ValueType;
var Type = function() { }
$hxClasses["Type"] = Type;
Type.__name__ = ["Type"];
Type.getClass = function(o) {
	if(o == null) return null;
	return js.Boot.getClass(o);
}
Type.getClassName = function(c) {
	var a = c.__name__;
	return a.join(".");
}
Type.getEnumName = function(e) {
	var a = e.__ename__;
	return a.join(".");
}
Type.resolveClass = function(name) {
	var cl = $hxClasses[name];
	if(cl == null || !js.Boot.isClass(cl)) return null;
	return cl;
}
Type.resolveEnum = function(name) {
	var e = $hxClasses[name];
	if(e == null || !js.Boot.isEnum(e)) return null;
	return e;
}
Type.createInstance = function(cl,args) {
	switch(args.length) {
	case 0:
		return new cl();
	case 1:
		return new cl(args[0]);
	case 2:
		return new cl(args[0],args[1]);
	case 3:
		return new cl(args[0],args[1],args[2]);
	case 4:
		return new cl(args[0],args[1],args[2],args[3]);
	case 5:
		return new cl(args[0],args[1],args[2],args[3],args[4]);
	case 6:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5]);
	case 7:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6]);
	case 8:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);
	default:
		throw "Too many arguments";
	}
	return null;
}
Type.createEmptyInstance = function(cl) {
	function empty() {}; empty.prototype = cl.prototype;
	return new empty();
}
Type.createEnum = function(e,constr,params) {
	var f = Reflect.field(e,constr);
	if(f == null) throw "No such constructor " + constr;
	if(Reflect.isFunction(f)) {
		if(params == null) throw "Constructor " + constr + " need parameters";
		return Reflect.callMethod(e,f,params);
	}
	if(params != null && params.length != 0) throw "Constructor " + constr + " does not need parameters";
	return f;
}
Type.getEnumConstructs = function(e) {
	var a = e.__constructs__;
	return a.slice();
}
Type["typeof"] = function(v) {
	switch(typeof(v)) {
	case "boolean":
		return ValueType.TBool;
	case "string":
		return ValueType.TClass(String);
	case "number":
		if(Math.ceil(v) == v % 2147483648.0) return ValueType.TInt;
		return ValueType.TFloat;
	case "object":
		if(v == null) return ValueType.TNull;
		var e = v.__enum__;
		if(e != null) return ValueType.TEnum(e);
		var c = js.Boot.getClass(v);
		if(c != null) return ValueType.TClass(c);
		return ValueType.TObject;
	case "function":
		if(js.Boot.isClass(v) || js.Boot.isEnum(v)) return ValueType.TObject;
		return ValueType.TFunction;
	case "undefined":
		return ValueType.TNull;
	default:
		return ValueType.TUnknown;
	}
}
var Xml = function() {
};
$hxClasses["Xml"] = Xml;
Xml.__name__ = ["Xml"];
Xml.parse = function(str) {
	return haxe.xml.Parser.parse(str);
}
Xml.createElement = function(name) {
	var r = new Xml();
	r.nodeType = Xml.Element;
	r._children = new Array();
	r._attributes = new Hash();
	r.setNodeName(name);
	return r;
}
Xml.createPCData = function(data) {
	var r = new Xml();
	r.nodeType = Xml.PCData;
	r.setNodeValue(data);
	return r;
}
Xml.createCData = function(data) {
	var r = new Xml();
	r.nodeType = Xml.CData;
	r.setNodeValue(data);
	return r;
}
Xml.createComment = function(data) {
	var r = new Xml();
	r.nodeType = Xml.Comment;
	r.setNodeValue(data);
	return r;
}
Xml.createDocType = function(data) {
	var r = new Xml();
	r.nodeType = Xml.DocType;
	r.setNodeValue(data);
	return r;
}
Xml.createProlog = function(data) {
	var r = new Xml();
	r.nodeType = Xml.Prolog;
	r.setNodeValue(data);
	return r;
}
Xml.createDocument = function() {
	var r = new Xml();
	r.nodeType = Xml.Document;
	r._children = new Array();
	return r;
}
Xml.prototype = {
	addChild: function(x) {
		if(this._children == null) throw "bad nodetype";
		if(x._parent != null) HxOverrides.remove(x._parent._children,x);
		x._parent = this;
		this._children.push(x);
	}
	,firstChild: function() {
		if(this._children == null) throw "bad nodetype";
		return this._children[0];
	}
	,elementsNamed: function(name) {
		if(this._children == null) throw "bad nodetype";
		return { cur : 0, x : this._children, hasNext : function() {
			var k = this.cur;
			var l = this.x.length;
			while(k < l) {
				var n = this.x[k];
				if(n.nodeType == Xml.Element && n._nodeName == name) break;
				k++;
			}
			this.cur = k;
			return k < l;
		}, next : function() {
			var k = this.cur;
			var l = this.x.length;
			while(k < l) {
				var n = this.x[k];
				k++;
				if(n.nodeType == Xml.Element && n._nodeName == name) {
					this.cur = k;
					return n;
				}
			}
			return null;
		}};
	}
	,elements: function() {
		if(this._children == null) throw "bad nodetype";
		return { cur : 0, x : this._children, hasNext : function() {
			var k = this.cur;
			var l = this.x.length;
			while(k < l) {
				if(this.x[k].nodeType == Xml.Element) break;
				k += 1;
			}
			this.cur = k;
			return k < l;
		}, next : function() {
			var k = this.cur;
			var l = this.x.length;
			while(k < l) {
				var n = this.x[k];
				k += 1;
				if(n.nodeType == Xml.Element) {
					this.cur = k;
					return n;
				}
			}
			return null;
		}};
	}
	,exists: function(att) {
		if(this.nodeType != Xml.Element) throw "bad nodeType";
		return this._attributes.exists(att);
	}
	,set: function(att,value) {
		if(this.nodeType != Xml.Element) throw "bad nodeType";
		this._attributes.set(att,value);
	}
	,get: function(att) {
		if(this.nodeType != Xml.Element) throw "bad nodeType";
		return this._attributes.get(att);
	}
	,getParent: function() {
		return this._parent;
	}
	,setNodeValue: function(v) {
		if(this.nodeType == Xml.Element || this.nodeType == Xml.Document) throw "bad nodeType";
		return this._nodeValue = v;
	}
	,getNodeValue: function() {
		if(this.nodeType == Xml.Element || this.nodeType == Xml.Document) throw "bad nodeType";
		return this._nodeValue;
	}
	,setNodeName: function(n) {
		if(this.nodeType != Xml.Element) throw "bad nodeType";
		return this._nodeName = n;
	}
	,getNodeName: function() {
		if(this.nodeType != Xml.Element) throw "bad nodeType";
		return this._nodeName;
	}
	,__class__: Xml
}
flambe.util = {}
flambe.util.Disposable = function() { }
$hxClasses["flambe.util.Disposable"] = flambe.util.Disposable;
flambe.util.Disposable.__name__ = ["flambe","util","Disposable"];
flambe.util.Disposable.prototype = {
	__class__: flambe.util.Disposable
}
flambe.Component = function() { }
$hxClasses["flambe.Component"] = flambe.Component;
flambe.Component.__name__ = ["flambe","Component"];
flambe.Component.__interfaces__ = [flambe.util.Disposable];
flambe.Component.prototype = {
	_internal_setNext: function(next) {
		this.next = next;
	}
	,_internal_init: function(owner,next) {
		this.owner = owner;
		this.next = next;
	}
	,get_name: function() {
		return null;
	}
	,dispose: function() {
		if(this.owner != null) this.owner.remove(this);
	}
	,onUpdate: function(dt) {
	}
	,onRemoved: function() {
	}
	,onAdded: function() {
	}
	,__class__: flambe.Component
}
var com = window.com = {}
com.cmm = {}
com.cmm.common = {}
com.cmm.common.components = {}
com.cmm.common.components.CMMComponent = function(pid,paramObject) {
	this.id = pid;
	this.params = paramObject;
};
$hxClasses["com.cmm.common.components.CMMComponent"] = com.cmm.common.components.CMMComponent;
com.cmm.common.components.CMMComponent.__name__ = ["com","cmm","common","components","CMMComponent"];
com.cmm.common.components.CMMComponent.__super__ = flambe.Component;
com.cmm.common.components.CMMComponent.prototype = $extend(flambe.Component.prototype,{
	onRemoved: function() {
		flambe.Component.prototype.onRemoved.call(this);
		this._signalConnection.dispose();
		this._ownerSprite = null;
	}
	,onAdded: function() {
		flambe.Component.prototype.onAdded.call(this);
		this._ownerSprite = com.cmm.common.display.SpriteContainer.getFrom(this.owner);
		var disposer = flambe.Disposer.getFrom(this.owner);
		if(disposer == null) {
			this._signalConnection = new flambe.Disposer();
			this.owner.add(this._signalConnection);
		} else this._signalConnection = disposer;
	}
	,get_name: function() {
		return "CMMComponent_4";
	}
	,__class__: com.cmm.common.components.CMMComponent
});
com.cmm.common.components.btn = {}
com.cmm.common.components.btn.GenericBtn = function(pid,paramObject) {
	this._over = false;
	com.cmm.common.components.CMMComponent.call(this,pid,paramObject);
};
$hxClasses["com.cmm.common.components.btn.GenericBtn"] = com.cmm.common.components.btn.GenericBtn;
com.cmm.common.components.btn.GenericBtn.__name__ = ["com","cmm","common","components","btn","GenericBtn"];
com.cmm.common.components.btn.GenericBtn.__super__ = com.cmm.common.components.CMMComponent;
com.cmm.common.components.btn.GenericBtn.prototype = $extend(com.cmm.common.components.CMMComponent.prototype,{
	onPointerOut: function() {
		this._over = false;
		if(this._voTimer != null) {
			this._voTimer.stop();
			this._voTimer = null;
		}
	}
	,playVO: function() {
		this._voTimer = null;
		if(this._over == true) {
			if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this._ownerSprite.get_instanceName() + "VO")) com.cmm.common.audio.SoundPlayerRemote.play(this._ownerSprite.get_instanceName() + "VO"); else if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this.id + "VO")) com.cmm.common.audio.SoundPlayerRemote.play(this.id + "VO");
		}
	}
	,onPointerOver: function() {
		this._over = true;
		if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this._ownerSprite.get_instanceName() + "RO")) com.cmm.common.audio.SoundPlayerRemote.play(this._ownerSprite.get_instanceName() + "RO"); else if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this.id + "RO")) com.cmm.common.audio.SoundPlayerRemote.play(this.id + "RO");
		this._voTimer = haxe.Timer.delay($bind(this,this.playVO),1000);
	}
	,onPointerClick: function(e) {
		flambe.System.get_mouse().set_cursor(flambe.input.MouseCursor.Default);
		this._over = false;
		if(this._voTimer != null) {
			this._voTimer.stop();
			this._voTimer = null;
		}
	}
	,onPointerUp: function(e) {
	}
	,onPointerDown: function(e) {
		if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this._ownerSprite.get_instanceName() + "Click")) com.cmm.common.audio.SoundPlayerRemote.play(this._ownerSprite.get_instanceName() + "Click"); else if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this.id + "Click")) com.cmm.common.audio.SoundPlayerRemote.play(this.id + "Click");
		if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this._ownerSprite.get_instanceName() + "VO")) com.cmm.common.audio.SoundPlayerRemote.play(this._ownerSprite.get_instanceName() + "VO"); else if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this.id + "Click")) com.cmm.common.audio.SoundPlayerRemote.play(this.id + "Click");
	}
	,onAdded: function() {
		com.cmm.common.components.CMMComponent.prototype.onAdded.call(this);
		this._signalConnection.connect1(this._ownerSprite.get_pointerDown(),$bind(this,this.onPointerDown));
		this._signalConnection.connect1(this._ownerSprite.get_pointerUp(),$bind(this,this.onPointerUp));
		this._signalConnection.connect1(this._ownerSprite.get_pointerClick(),$bind(this,this.onPointerClick));
		this._signalConnection.connect0(this._ownerSprite.get_pointerOver(),$bind(this,this.onPointerOver));
		this._signalConnection.connect0(this._ownerSprite.get_pointerOut(),$bind(this,this.onPointerOut));
	}
	,__class__: com.cmm.common.components.btn.GenericBtn
});
com.cmm.activityEngines = {}
com.cmm.activityEngines.customBuilder = {}
com.cmm.activityEngines.customBuilder.components = {}
com.cmm.activityEngines.customBuilder.components.btn = {}
com.cmm.activityEngines.customBuilder.components.btn.BuilderComponentBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.activityEngines.customBuilder.components.btn.BuilderComponentBtn"] = com.cmm.activityEngines.customBuilder.components.btn.BuilderComponentBtn;
com.cmm.activityEngines.customBuilder.components.btn.BuilderComponentBtn.__name__ = ["com","cmm","activityEngines","customBuilder","components","btn","BuilderComponentBtn"];
com.cmm.activityEngines.customBuilder.components.btn.BuilderComponentBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.activityEngines.customBuilder.components.btn.BuilderComponentBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerDown: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerDown.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.activityEngines.customBuilder.event.CustomBuilderEvent("com.cmm.activityEngines.customBuilder.event.builderComponentSelected",com.cmm.common.utils.StringUtil.returnNumbers(this._ownerSprite.get_instanceName())));
	}
	,onAdded: function() {
		com.cmm.common.components.btn.GenericBtn.prototype.onAdded.call(this);
		var mc1 = this._ownerSprite;
		mc1.gotoAndStop(1);
		if(Type.getClass(mc1.getChildByName("graphic")) == com.cmm.common.display.MovieClip) {
			var mc2 = js.Boot.__cast(mc1.getChildByName("graphic") , com.cmm.common.display.MovieClip);
			mc2.gotoAndStop(1);
			var _g1 = 0, _g = mc2.get_numChildren();
			while(_g1 < _g) {
				var i = _g1++;
				if(Type.getClass(mc2.getChildAt(i)) == com.cmm.common.display.MovieClip) {
					var mc3 = js.Boot.__cast(mc2.getChildAt(i) , com.cmm.common.display.MovieClip);
					mc3.gotoAndStop(1);
				}
			}
		}
	}
	,__class__: com.cmm.activityEngines.customBuilder.components.btn.BuilderComponentBtn
});
com.cmm.common.event = {}
com.cmm.common.event.Event = function(eType,pdata,isNew) {
	if(isNew == null) isNew = true;
	this.type = "Event";
	this.newEvent = true;
	this.data = pdata;
	this.newEvent = isNew;
	this.type = eType;
};
$hxClasses["com.cmm.common.event.Event"] = com.cmm.common.event.Event;
com.cmm.common.event.Event.__name__ = ["com","cmm","common","event","Event"];
com.cmm.common.event.Event.prototype = {
	toString: function() {
		var className = flambe.util.Strings.getFileExtension(Type.getClassName(Type.getClass(this)));
		return "[" + className + "]" + " TYPE: " + this.type + " DATA: " + Std.string(this.data);
	}
	,clone: function() {
		return new com.cmm.common.event.Event(this.type,this.data,false);
	}
	,__class__: com.cmm.common.event.Event
}
com.cmm.activityEngines.customBuilder.event = {}
com.cmm.activityEngines.customBuilder.event.CustomBuilderEvent = function(eType,pdata,isNew) {
	if(isNew == null) isNew = true;
	com.cmm.common.event.Event.call(this,eType,pdata,isNew);
};
$hxClasses["com.cmm.activityEngines.customBuilder.event.CustomBuilderEvent"] = com.cmm.activityEngines.customBuilder.event.CustomBuilderEvent;
com.cmm.activityEngines.customBuilder.event.CustomBuilderEvent.__name__ = ["com","cmm","activityEngines","customBuilder","event","CustomBuilderEvent"];
com.cmm.activityEngines.customBuilder.event.CustomBuilderEvent.__super__ = com.cmm.common.event.Event;
com.cmm.activityEngines.customBuilder.event.CustomBuilderEvent.prototype = $extend(com.cmm.common.event.Event.prototype,{
	clone: function() {
		return new com.cmm.activityEngines.customBuilder.event.CustomBuilderEvent(this.type,this.data,false);
	}
	,__class__: com.cmm.activityEngines.customBuilder.event.CustomBuilderEvent
});
com.cmm.common.components.btn.PlayBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.common.components.btn.PlayBtn"] = com.cmm.common.components.btn.PlayBtn;
com.cmm.common.components.btn.PlayBtn.__name__ = ["com","cmm","common","components","btn","PlayBtn"];
com.cmm.common.components.btn.PlayBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.common.components.btn.PlayBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		var mc = this._ownerSprite.get_parent();
		mc.gotoAndPlay(mc.get_currentFrame(),mc.get_nextLabelFrame(),0);
	}
	,__class__: com.cmm.common.components.btn.PlayBtn
});
com.cmm.client = {}
com.cmm.client.dos = {}
com.cmm.client.dos.components = {}
com.cmm.client.dos.components.btn = {}
com.cmm.client.dos.components.btn.DOSPlayBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.PlayBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.client.dos.components.btn.DOSPlayBtn"] = com.cmm.client.dos.components.btn.DOSPlayBtn;
com.cmm.client.dos.components.btn.DOSPlayBtn.__name__ = ["com","cmm","client","dos","components","btn","DOSPlayBtn"];
com.cmm.client.dos.components.btn.DOSPlayBtn.__super__ = com.cmm.common.components.btn.PlayBtn;
com.cmm.client.dos.components.btn.DOSPlayBtn.prototype = $extend(com.cmm.common.components.btn.PlayBtn.prototype,{
	onComplete: function() {
		this._onCompleteSignalConn.dispose();
	}
	,onPointerClick: function(e) {
		var _g = this;
		com.cmm.common.components.btn.PlayBtn.prototype.onPointerClick.call(this,e);
		this._onCompleteSignalConn = com.cmm.common.app.SceneManager.get_currentScene().get_onComplete().connect(function() {
			_g.onComplete();
		});
	}
	,__class__: com.cmm.client.dos.components.btn.DOSPlayBtn
});
com.cmm.client.dos.components.btn.DOSCloseBtn = function(pid,paramObject) {
	com.cmm.client.dos.components.btn.DOSPlayBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.client.dos.components.btn.DOSCloseBtn"] = com.cmm.client.dos.components.btn.DOSCloseBtn;
com.cmm.client.dos.components.btn.DOSCloseBtn.__name__ = ["com","cmm","client","dos","components","btn","DOSCloseBtn"];
com.cmm.client.dos.components.btn.DOSCloseBtn.__super__ = com.cmm.client.dos.components.btn.DOSPlayBtn;
com.cmm.client.dos.components.btn.DOSCloseBtn.prototype = $extend(com.cmm.client.dos.components.btn.DOSPlayBtn.prototype,{
	onComplete: function() {
		com.cmm.client.dos.components.btn.DOSPlayBtn.prototype.onComplete.call(this);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.CMMEvent("com.cmm.common.events.resume"));
	}
	,__class__: com.cmm.client.dos.components.btn.DOSCloseBtn
});
com.cmm.client.dos.components.btn.DOSHelpBtn = function(pid,paramObject) {
	com.cmm.client.dos.components.btn.DOSPlayBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.client.dos.components.btn.DOSHelpBtn"] = com.cmm.client.dos.components.btn.DOSHelpBtn;
com.cmm.client.dos.components.btn.DOSHelpBtn.__name__ = ["com","cmm","client","dos","components","btn","DOSHelpBtn"];
com.cmm.client.dos.components.btn.DOSHelpBtn.__super__ = com.cmm.client.dos.components.btn.DOSPlayBtn;
com.cmm.client.dos.components.btn.DOSHelpBtn.prototype = $extend(com.cmm.client.dos.components.btn.DOSPlayBtn.prototype,{
	onComplete: function() {
		com.cmm.client.dos.components.btn.DOSPlayBtn.prototype.onComplete.call(this);
		com.cmm.common.app.SceneManager.playSceneQueue(["mc_helpScene","mc_DOSHudMenu"]);
	}
	,__class__: com.cmm.client.dos.components.btn.DOSHelpBtn
});
com.cmm.client.dos.components.btn.DOSHudBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.client.dos.components.btn.DOSHudBtn"] = com.cmm.client.dos.components.btn.DOSHudBtn;
com.cmm.client.dos.components.btn.DOSHudBtn.__name__ = ["com","cmm","client","dos","components","btn","DOSHudBtn"];
com.cmm.client.dos.components.btn.DOSHudBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.client.dos.components.btn.DOSHudBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.CMMEvent("com.cmm.common.events.pause"));
		com.cmm.common.app.SceneManager.playSceneAt("mc_DOSHudMenu",1);
	}
	,__class__: com.cmm.client.dos.components.btn.DOSHudBtn
});
com.cmm.common.app = {}
com.cmm.common.app.ClipSequencer = function() {
	this._clipHash = new Hash();
};
$hxClasses["com.cmm.common.app.ClipSequencer"] = com.cmm.common.app.ClipSequencer;
com.cmm.common.app.ClipSequencer.__name__ = ["com","cmm","common","app","ClipSequencer"];
com.cmm.common.app.ClipSequencer.prototype = {
	getClip: function(clipID) {
		if(this._clipHash.get(clipID) == null) this.addClipToList(clipID);
		return this._clipHash.get(clipID);
	}
	,set_completeCallback: function(value) {
		return this._completeCallback = value;
	}
	,get_completeCallback: function() {
		return this._completeCallback;
	}
	,get_currentClip: function() {
		return this._currentClip;
	}
	,cancelClipQueue: function() {
		if(this._clipQueue != null) while(this._clipQueue.length > 0) this._clipQueue.pop();
		if(this._currentSignalConnection != null) this._currentSignalConnection.dispose();
		if(this._currentClip != null) {
			this._currentClip.gotoAndStop(1);
			if(this._target.containsSprite(this._currentClip)) this._target.removeChild(this._currentClip);
		}
		this._interimCallback = null;
		this._completeCallback = null;
	}
	,playbackCompleteHandler: function() {
		this._currentSignalConnection.dispose();
		this._currentClip.gotoAndStop(1);
		this._target.removeChild(this._currentClip);
		if(this._clipQueue != null && this._clipQueue.length > 0) {
			if(this._interimCallback != null) this._interimCallback(this._currentClip.symbol.get_name());
			this.playClip(this._clipQueue.shift());
		} else {
			if(this._completeCallback != null) this._completeCallback();
			this._interimCallback = null;
		}
	}
	,sectionPlaybackComplete: function() {
		console.log("SECTION Complete " + this._currentClip.symbol.get_name());
		if(this._currentClip.get_currentFrame() == this._currentClip.get_totalFrames()) {
			console.log("PLAYBACK Complete " + this._currentClip.symbol.get_name());
			this.playbackCompleteHandler();
		}
	}
	,playClipQueue: function(queue,completeCallback,interimCallback) {
		this.cancelClipQueue();
		this._clipQueue = queue;
		if(interimCallback != null) this._interimCallback = interimCallback;
		this.playClip(queue.shift(),completeCallback);
	}
	,playClipAt: function(clipID,playFrom,completeCallback) {
		var _g = this;
		this.addClipToStage(clipID);
		this._currentSignalConnection = this._currentClip.get_onComplete().connect(function() {
			_g.sectionPlaybackComplete();
		});
		if(completeCallback != null) this._completeCallback = completeCallback;
		this._currentClip.gotoAndPlay(playFrom,this._currentClip.get_nextLabelFrame(),0);
		console.log("Starting: " + this._currentClip.symbol.get_name());
	}
	,playClip: function(clipID,completeCallback) {
		this.playClipAt(clipID,this.getClip(clipID).get_currentFrame(),completeCallback);
	}
	,addClipToStage: function(clipID) {
		this._currentClip = this.getClip(clipID);
		this._target.addChild(this._currentClip);
	}
	,addClipToList: function(clipID) {
		this._clipHash.set(clipID,com.cmm.common.utils.LibraryTools.createMovieClip(clipID));
	}
	,setTarget: function(target) {
		this._target = target;
	}
	,__class__: com.cmm.common.app.ClipSequencer
}
com.cmm.common.app.CompositionFactory = function() {
};
$hxClasses["com.cmm.common.app.CompositionFactory"] = com.cmm.common.app.CompositionFactory;
com.cmm.common.app.CompositionFactory.__name__ = ["com","cmm","common","app","CompositionFactory"];
com.cmm.common.app.CompositionFactory.registerCompositionReference = function(compositionRef) {
	if(com.cmm.common.app.CompositionFactory._compositionObjectHash == null) com.cmm.common.app.CompositionFactory._compositionObjectHash = new Hash();
	var _g1 = 0, _g = compositionRef.groups.length;
	while(_g1 < _g) {
		var i = _g1++;
		var classID = compositionRef.groups[i].id;
		var classes = compositionRef.groups[i].classes;
		var comps = compositionRef.groups[i].components;
		var params = compositionRef.groups[i].params;
		var _g3 = 0, _g2 = classes.length;
		while(_g3 < _g2) {
			var j = _g3++;
			compositionRef.compositions.push({ className : classes[j], id : classID, components : comps, params : params});
		}
	}
	var _g1 = 0, _g = compositionRef.compositions.length;
	while(_g1 < _g) {
		var i = _g1++;
		com.cmm.common.app.CompositionFactory._compositionObjectHash.set(compositionRef.compositions[i].className,compositionRef.compositions[i]);
	}
	console.log(compositionRef.compositions);
}
com.cmm.common.app.CompositionFactory.getCompositionObjectByClassName = function(className) {
	return com.cmm.common.app.CompositionFactory._compositionObjectHash.get(className);
}
com.cmm.common.app.CompositionFactory.prototype = {
	__class__: com.cmm.common.app.CompositionFactory
}
com.cmm.common.app.SceneManager = function() {
};
$hxClasses["com.cmm.common.app.SceneManager"] = com.cmm.common.app.SceneManager;
com.cmm.common.app.SceneManager.__name__ = ["com","cmm","common","app","SceneManager"];
com.cmm.common.app.SceneManager.createClipSeqInstance = function() {
	if(com.cmm.common.app.SceneManager._clipSequencer == null) {
		com.cmm.common.app.SceneManager._clipSequencer = new com.cmm.common.app.ClipSequencer();
		com.cmm.common.app.SceneManager._clipSequencer.setTarget(com.cmm.common.app.Wrapper.instance.get_animLayer());
	}
}
com.cmm.common.app.SceneManager.playScene = function(sceneID,completeCallback) {
	com.cmm.common.app.SceneManager.createClipSeqInstance();
	com.cmm.common.app.SceneManager._clipSequencer.playClipAt(sceneID,com.cmm.common.app.SceneManager._clipSequencer.getClip(sceneID).get_currentFrame(),completeCallback);
}
com.cmm.common.app.SceneManager.playSceneAt = function(sceneID,playFrom,completeCallback) {
	com.cmm.common.app.SceneManager.createClipSeqInstance();
	com.cmm.common.app.SceneManager._clipSequencer.playClipAt(sceneID,playFrom,completeCallback);
}
com.cmm.common.app.SceneManager.playSceneQueue = function(queue,completeCallback,interimCallback) {
	com.cmm.common.app.SceneManager.createClipSeqInstance();
	com.cmm.common.app.SceneManager._clipSequencer.playClipQueue(queue,completeCallback,interimCallback);
}
com.cmm.common.app.SceneManager.get_currentScene = function() {
	return com.cmm.common.app.SceneManager._clipSequencer.get_currentClip();
}
com.cmm.common.app.SceneManager.prototype = {
	__class__: com.cmm.common.app.SceneManager
}
com.cmm.common.app.State = function() {
	this._aborted = false;
	this.nextState = "";
};
$hxClasses["com.cmm.common.app.State"] = com.cmm.common.app.State;
com.cmm.common.app.State.__name__ = ["com","cmm","common","app","State"];
com.cmm.common.app.State.prototype = {
	stateComplete: function() {
		if(this._aborted == false) this.completeHandler();
	}
	,exitState: function() {
	}
	,enterState: function() {
		this._aborted = false;
	}
	,__class__: com.cmm.common.app.State
}
com.cmm.common.app.StateList = function() {
	this.statePackagePath = "";
};
$hxClasses["com.cmm.common.app.StateList"] = com.cmm.common.app.StateList;
com.cmm.common.app.StateList.__name__ = ["com","cmm","common","app","StateList"];
com.cmm.common.app.StateList.prototype = {
	__class__: com.cmm.common.app.StateList
}
com.cmm.common.app.StateMachine = function(stateList,structureXML) {
	this._states = [];
	this._stateIDs = [];
	if(structureXML == null) this.createStateMachineFromClassEnum(stateList); else this.createStateMachineFromXML(stateList,structureXML);
};
$hxClasses["com.cmm.common.app.StateMachine"] = com.cmm.common.app.StateMachine;
com.cmm.common.app.StateMachine.__name__ = ["com","cmm","common","app","StateMachine"];
com.cmm.common.app.StateMachine.prototype = {
	stopMachine: function() {
		this._currentState = null;
		this.completeHandler = null;
	}
	,transitionToNextState: function() {
		console.log("StateMachine EXITING STATE: " + this._currentStateID);
		this._currentState.exitState();
		if(this._currentState.nextState.length > 0) {
			console.log("StateMachine NEXT STATE: " + this._currentState.nextState);
			this.startState(this._currentState.nextState);
		} else {
			var nextStateIndex = com.cmm.common.utils.ArrayUtil.indexOf(this._currentStateID,this._stateIDs) + 1;
			if(nextStateIndex < this._stateIDs.length) {
				console.log("StateMachine NEXT STATE: " + this._stateIDs[nextStateIndex]);
				this.startState(this._stateIDs[nextStateIndex]);
			} else {
				console.log("StateMachine STOPPING MACHINE");
				if(this.completeHandler != null) this.completeHandler();
				this.stopMachine();
			}
		}
	}
	,startState: function(stateID) {
		this._currentStateID = stateID;
		console.log("StateMachine STARTING STATE: " + this._currentStateID);
		var stateOBJ = this._states[com.cmm.common.utils.ArrayUtil.indexOf(this._currentStateID,this._stateIDs)];
		this._currentState = stateOBJ.state;
		this._currentState.nextState = stateOBJ.nextState;
		this._currentState.completeHandler = $bind(this,this.transitionToNextState);
		this._currentState.enterState();
	}
	,startMachine: function() {
		this.startState(this._stateIDs[0]);
	}
	,addState: function(stateID,stateClass,nextState) {
		this._stateIDs.push(stateID);
		var stateObj;
		stateObj = { };
		stateObj.state = Type.createInstance(stateClass,[]);
		stateObj.nextState = nextState;
		this._states.push(stateObj);
	}
	,createStateMachineFromXML: function(stateList,xml) {
		var stateMachineData = xml.elementsNamed("stateMachine").next();
		var states = stateMachineData.elementsNamed("state");
		while( states.hasNext() ) {
			var state = states.next();
			var stateID = state.get("classID");
			if(stateList.statePackagePath.length > 0) stateID = stateList.statePackagePath + "." + stateID;
			this.addState(stateID,Type.resolveClass(stateID),state.get("nextState"));
		}
	}
	,createStateMachineFromClassEnum: function(stateList) {
		var stateMachineData = stateList.stateClassList;
		var n = stateMachineData.length;
		var _g = 0;
		while(_g < n) {
			var i = _g++;
			this.addState(Type.getClassName(stateMachineData[i]),stateMachineData[i],"");
		}
	}
	,__class__: com.cmm.common.app.StateMachine
}
com.cmm.common.app.Wrapper = function() {
	this.ignoreResize = false;
	this.LOADER_ID = "mc_loader";
	this.PRELOADER_ID = "mc_preloader";
	com.cmm.common.app.Wrapper.instance = this;
	this.initPlatform();
	this.initGameLayers();
	this.loadPreloader();
};
$hxClasses["com.cmm.common.app.Wrapper"] = com.cmm.common.app.Wrapper;
com.cmm.common.app.Wrapper.__name__ = ["com","cmm","common","app","Wrapper"];
com.cmm.common.app.Wrapper.prototype = {
	get_gameLayer: function() {
		return this._gameLayer;
	}
	,get_animLayer: function() {
		return this._animLayer;
	}
	,onResize: function() {
		if(!this.ignoreResize) {
			/*
			 * I removed this line to allow for responsive behavior on desktops. - DDD 8/2/2016
			 *
			 * if(com.cmm.common.utils.browserDetect.BrowserDetect.isMobile == false) return;
			 */
			var xScale = 1.0;
			var yScale = 1.0;
			var actualWidth = flambe.System.get_stage().get_width();
			var actualHeight = flambe.System.get_stage().get_height();
			var scaledWidth = Main.DEFAULT_WIDTH;
			var scaledHeight = Main.DEFAULT_HEIGHT;
			var gameSetup = "default";
			if(actualWidth > scaledWidth && actualHeight > scaledHeight) {
				xScale = actualWidth / scaledWidth;
				yScale = actualHeight / scaledHeight;
				Main.GLOBAL_SCALE = Math.min(xScale,yScale);
				gameSetup = yScale > xScale?"heightLarger":"widthLarger";
			} else if(actualWidth > scaledWidth && actualHeight <= scaledHeight) {
				yScale = actualHeight / scaledHeight;
				Main.GLOBAL_SCALE = yScale;
				gameSetup = "widthLarger";
			} else if(actualWidth <= scaledWidth && actualHeight > scaledHeight) {
				xScale = actualWidth / scaledWidth;
				Main.GLOBAL_SCALE = xScale;
				gameSetup = "heightLarger";
			} else if(actualWidth < scaledWidth && actualHeight < scaledHeight) {
				xScale = actualWidth / scaledWidth;
				yScale = actualHeight / scaledHeight;
				Main.GLOBAL_SCALE = Math.min(xScale,yScale);
				gameSetup = yScale > xScale?"heightLarger":"widthLarger";
			}
			if(this._gameLayer != null) {
				Main.ASSET_SCALE_INV = Main.GLOBAL_SCALE / Main.ASSET_SCALE - Main.GLOBAL_SCALE;
				this._gameLayer.setScale(Main.GLOBAL_SCALE + Main.ASSET_SCALE_INV);
				this._animLayer.setScale(Main.GLOBAL_SCALE + Main.ASSET_SCALE_INV);
			}
			if(gameSetup == "widthLarger") {
				this._animLayer.x.set__(this._gameLayer.x.set__(Main.GLOBAL_OFFSET.x = flambe.System.get_stage().get_width() / 2 - Main.DEFAULT_WIDTH * Main.GLOBAL_SCALE / 2));
				this._animLayer.y.set__(this._gameLayer.y.set__(Main.GLOBAL_OFFSET.y = 0));
			} else if(gameSetup == "heightLarger") {
				this._animLayer.x.set__(this._gameLayer.x.set__(Main.GLOBAL_OFFSET.x = 0));
				this._animLayer.y.set__(this._gameLayer.y.set__(Main.GLOBAL_OFFSET.y = flambe.System.get_stage().get_height() / 2 - Main.DEFAULT_HEIGHT * Main.GLOBAL_SCALE / 2));
			}
			if(flambe.System.get_stage().orientation.get__() == flambe.display.Orientation.Landscape) this._animLayer.y.set__(this._gameLayer.y.set__(Main.GLOBAL_OFFSET.y = 0));
		}
	}
	,onOrientationChange: function(newValue,oldValue) {
		this.onResize();
	}
	,initOrientationWatch: function() {
		this.onResize();
		flambe.System.get_stage().orientation.watch($bind(this,this.onOrientationChange));
	}
	,init: function() {
		console.log("Wrapper: !!! INIT CALLED !!!");
	}
	,onPrimaryLoadSuccess: function(packID) {
		console.log("Wrapper: PRIMARY ASSET PACK LOADED");
		this.init();
	}
	,loadPrimary: function() {
		console.log("Wrapper: LOAD PRIMARY ASSET PACK");
		com.cmm.common.io.LoadMaster.loadBatch("primary",$bind(this,this.onPrimaryLoadSuccess));
	}
	,onLoaderSuccess: function(packID) {
		if(this._preloader != null) this._gameLayer.removeChild(this._preloader);
		var loader = com.cmm.common.utils.LibraryTools.createMovieClip(this.LOADER_ID);
		com.cmm.common.io.LoadMaster.loadMC = loader;
		this.loadPrimary();
	}
	,loadLoader: function() {
		console.log("Wrapper: LOAD PRELOADER ASSET PACK");
		com.cmm.common.io.LoadMaster.loadBatch("loader",$bind(this,this.onLoaderSuccess));
	}
	,createDynamicTextLibrary: function() {
		com.cmm.common.text.DynamicTextLibrary.createLibrary(com.cmm.common.io.LoadMaster.getJSON("config","strings.json"));
	}
	,onConfigLoadSuccess: function(packID) {
		console.log("Wrapper: INITIAL ASSETS LOADED");
		com.cmm.common.audio.SoundPlayerRemote.init(com.cmm.common.io.LoadMaster.getXML("config","soundFiles.xml"));
		this.createDynamicTextLibrary();
		this.initOrientationWatch();
		this.loadLoader();
	}
	,loadConfig: function() {
		console.log("Wrapper: LOAD INITIAL ASSET PACK");
		com.cmm.common.io.LoadMaster.loadBatch("config",$bind(this,this.onConfigLoadSuccess));
	}
	,onPreLoadSuccess: function(packID) {
		flambe.System.get_stage().resize.connect($bind(this,this.onResize));
		this.onResize();
		this._preloader = com.cmm.common.utils.LibraryTools.createMovieClip(this.PRELOADER_ID);
		if(this._preloader != null) this._gameLayer.addChild(this._preloader);
		this.loadConfig();
	}
	,loadPreloader: function() {
		console.log("Wrapper: LOAD PRELOADER ASSET PACK");
		com.cmm.common.io.LoadMaster.loadBatch("preload",$bind(this,this.onPreLoadSuccess));
	}
	,initGameLayers: function() {
		console.log("Wrapper: INIT GAME LAYERS");
		this._gameLayer = new com.cmm.common.display.SpriteContainer();
		//this._gameLayer.scissor = new flambe.math.Rectangle(0,0,Main.DEFAULT_WIDTH * Main.ASSET_SCALE,Main.DEFAULT_HEIGHT * Main.ASSET_SCALE);
		this._animLayer = new com.cmm.common.display.SpriteContainer();
		//this._animLayer.scissor = new flambe.math.Rectangle(0,0,Main.DEFAULT_WIDTH * Main.ASSET_SCALE,Main.DEFAULT_HEIGHT * Main.ASSET_SCALE);
		this._animLayer.scissor = new flambe.math.Rectangle(-109, -69, 1200, 738);
		var gameEnt = new flambe.Entity();
		gameEnt.add(this._gameLayer);
		flambe.System.root.addChild(gameEnt);
		var animEnt = new flambe.Entity();
		animEnt.add(this._animLayer);
		flambe.System.root.addChild(animEnt);
	}
	,initPlatform: function() {
		console.log("Wrapper: INIT PLATFORM");
		flambe.System.init();
		com.cmm.common.utils.browserDetect.BrowserDetect.init();
	}
	,__class__: com.cmm.common.app.Wrapper
}
com.cmm.common.audio = {}
com.cmm.common.audio.SoundClip = function(soundFiles,onSoundFilesComplete) {
	this.muted = false;
	this.playing = false;
	this.channelIdx = -1;
	this.onSoundFileFinish = null;
	this.onSoundFileStart = null;
	this.channel = "";
	this._emittedThisFrame = false;
	this._onCompleteFunc = null;
	this.curSoundIdx = 0;
	this.soundFiles = soundFiles;
	var _g = 0, _g1 = this.soundFiles;
	while(_g < _g1.length) {
		var sf = _g1[_g];
		++_g;
		sf.sc = this;
	}
	this._onCompleteFunc = onSoundFilesComplete;
};
$hxClasses["com.cmm.common.audio.SoundClip"] = com.cmm.common.audio.SoundClip;
com.cmm.common.audio.SoundClip.__name__ = ["com","cmm","common","audio","SoundClip"];
com.cmm.common.audio.SoundClip.__super__ = flambe.Component;
com.cmm.common.audio.SoundClip.prototype = $extend(flambe.Component.prototype,{
	get_duration: function() {
		var retDuration = 0;
		var _g1 = 0, _g = this.soundFiles.length;
		while(_g1 < _g) {
			var i = _g1++;
			retDuration += this.soundFiles[i].get_duration();
		}
		return retDuration;
	}
	,get_playingSoundFile: function() {
		if(this.curSoundIdx > -1 && this.curSoundIdx <= this.soundFiles.length) {
			if(this.curSoundIdx == 0) return this.soundFiles[this.curSoundIdx]; else return this.soundFiles[this.curSoundIdx - 1];
		}
		return null;
	}
	,onUpdate: function(dt) {
		flambe.Component.prototype.onUpdate.call(this,dt);
		this._emittedThisFrame = false;
		if(this.playback != null) {
			if(this.playback.get_ended() && this.curSoundIdx < this.soundFiles.length + 1) {
				if(this.curSoundIdx - 1 > -1 && this.curSoundIdx - 1 < this.soundFiles.length) {
					if(this.onSoundFileFinish != null) {
						this._emittedThisFrame = true;
						this.onSoundFileFinish(this.soundFiles[this.curSoundIdx - 1]);
					}
				}
				this.play();
			}
		}
	}
	,registerOnFinishFunc: function(onSoundClipFinishFunc) {
		this.onSoundClipFinishFunc = onSoundClipFinishFunc;
	}
	,get_channel: function() {
		return this.soundFiles[0].channel;
	}
	,set_channelIdx: function(val) {
		return this.channelIdx = val;
	}
	,get_playing: function() {
		return !this.playback.get_paused();
	}
	,unmute: function() {
		this.muted = false;
		if(this.playback != null) {
			if(this.curSoundIdx < this.soundFiles.length + 1) this.playback.volume.set__(this.soundFiles[this.curSoundIdx - 1].volume);
		}
	}
	,mute: function() {
		this.muted = true;
		if(this.playback != null) this.playback.volume.set__(0);
	}
	,resume: function() {
		if(this.playback != null) this.playback.set_paused(false);
	}
	,pause: function() {
		if(this.playback != null) this.playback.set_paused(true);
	}
	,stop: function() {
		if(this.curSoundIdx - 1 > -1 && this.curSoundIdx - 1 < this.soundFiles.length && this.playback != null && this._emittedThisFrame == false) {
			if(this.onSoundFileFinish != null) this.onSoundFileFinish(this.soundFiles[this.curSoundIdx - 1]);
		}
		this.curSoundIdx = 2147483647;
		if(this.playback != null) this.playback.dispose();
		if(this.onSoundClipFinishFunc != null) this.onSoundClipFinishFunc(this);
	}
	,play: function() {
		if(this.curSoundIdx < this.soundFiles.length) {
			var soundFile = this.soundFiles[this.curSoundIdx];
			if(soundFile != null) {
				if(soundFile.loops > 0) this.playback = com.cmm.common.io.LoadMaster.getSound(soundFile.packName,com.cmm.common.audio.SoundPlayerRemote.path + soundFile.channel + "/" + soundFile.filename).loop(soundFile.volume); else this.playback = com.cmm.common.io.LoadMaster.getSound(soundFile.packName,com.cmm.common.audio.SoundPlayerRemote.path + soundFile.channel + "/" + soundFile.filename).play(soundFile.volume);
				if(this.onSoundFileStart != null) this.onSoundFileStart(soundFile);
			}
		} else {
			this.playback.dispose();
			this.playback = null;
			if(this._onCompleteFunc != null) this._onCompleteFunc();
			if(this.onSoundClipFinishFunc != null) this.onSoundClipFinishFunc(this);
		}
		this.curSoundIdx++;
	}
	,get_name: function() {
		return "SoundClip_5";
	}
	,__class__: com.cmm.common.audio.SoundClip
});
com.cmm.common.audio.SoundClipChannel = function(channelID,overrideSound,muteable) {
	if(muteable == null) muteable = false;
	if(overrideSound == null) overrideSound = false;
	this.onSoundFileFinish = null;
	this.onSoundFileStart = null;
	this.muteable = false;
	this.muted = false;
	this.overrideSound = false;
	this.channelID = "";
	this.name = this.get_name();
	this.setOverrideSound(overrideSound);
	this.muteable = muteable;
	this.soundClips = new Array();
	this.setChannelID(channelID);
};
$hxClasses["com.cmm.common.audio.SoundClipChannel"] = com.cmm.common.audio.SoundClipChannel;
com.cmm.common.audio.SoundClipChannel.__name__ = ["com","cmm","common","audio","SoundClipChannel"];
com.cmm.common.audio.SoundClipChannel.__super__ = flambe.Component;
com.cmm.common.audio.SoundClipChannel.prototype = $extend(flambe.Component.prototype,{
	getPlaying: function() {
		var _g1 = 0, _g = this.soundClips.length;
		while(_g1 < _g) {
			var i = _g1++;
			if(this.soundClips[i].get_playing()) return true;
		}
		return false;
	}
	,setOverrideSound: function(val) {
		return this.overrideSound = val;
	}
	,setChannelID: function(val) {
		return this.channelID = val;
	}
	,onSoundClipFinish: function(sc) {
		if(sc.channelIdx > -1) {
			this.owner.removeChild(sc.owner);
			this.soundClips.splice(sc.channelIdx,1);
			sc.set_channelIdx(-1);
			var _g1 = 0, _g = this.soundClips.length;
			while(_g1 < _g) {
				var i = _g1++;
				this.soundClips[i].set_channelIdx(i);
			}
		}
	}
	,unmute: function() {
		this.muted = false;
		var _g1 = 0, _g = this.soundClips.length;
		while(_g1 < _g) {
			var i = _g1++;
			this.soundClips[i].unmute();
		}
	}
	,mute: function() {
		this.muted = true;
		var _g1 = 0, _g = this.soundClips.length;
		while(_g1 < _g) {
			var i = _g1++;
			this.soundClips[i].mute();
		}
	}
	,resume: function() {
		var _g1 = 0, _g = this.soundClips.length;
		while(_g1 < _g) {
			var i = _g1++;
			this.soundClips[i].resume();
		}
	}
	,pause: function() {
		var _g1 = 0, _g = this.soundClips.length;
		while(_g1 < _g) {
			var i = _g1++;
			this.soundClips[i].pause();
		}
	}
	,stop: function() {
		if(this.soundClips.length > 0) {
			var _g1 = 0, _g = this.soundClips.length;
			while(_g1 < _g) {
				var i = _g1++;
				if(i >= this.soundClips.length) break; else this.soundClips[i].stop();
			}
			while(this.soundClips.length > 0) {
				var sc = this.soundClips.pop();
				sc.set_channelIdx(-1);
			}
		}
	}
	,play: function(sc) {
		if(this.overrideSound == true) this.stop();
		this.soundClips.push(sc);
		this.owner.addChild(new flambe.Entity().add(sc));
		sc.set_channelIdx(this.soundClips.length - 1);
		sc.registerOnFinishFunc($bind(this,this.onSoundClipFinish));
		sc.onSoundFileStart = this.onSoundFileStart;
		sc.onSoundFileFinish = this.onSoundFileFinish;
		sc.play();
		if(this.muted) sc.mute();
	}
	,get_name: function() {
		return "SoundClipChannel_6";
	}
	,__class__: com.cmm.common.audio.SoundClipChannel
});
com.cmm.common.audio.SoundFile = function(channel,id,filename,loops,volume,packName) {
	if(packName == null) packName = "";
	if(volume == null) volume = 0;
	if(loops == null) loops = 0;
	if(filename == null) filename = "";
	if(id == null) id = "";
	if(channel == null) channel = "";
	this.sc = null;
	this.packName = "";
	this.volume = 0;
	this.loops = 0;
	this.filename = "";
	this.id = "";
	this.channel = "";
	this.set_channel(channel);
	this.set_id(id);
	this.set_filename(filename);
	this.set_loops(loops);
	this.set_volume(volume);
	this.set_packName(packName);
};
$hxClasses["com.cmm.common.audio.SoundFile"] = com.cmm.common.audio.SoundFile;
com.cmm.common.audio.SoundFile.__name__ = ["com","cmm","common","audio","SoundFile"];
com.cmm.common.audio.SoundFile.prototype = {
	get_duration: function() {
		var sound = com.cmm.common.io.LoadMaster.getSound(this.packName,com.cmm.common.audio.SoundPlayerRemote.path + this.channel + "/" + this.filename);
		return sound.get_duration();
	}
	,toString: function() {
		var className = flambe.util.Strings.getFileExtension(Type.getClassName(Type.getClass(this)));
		return "[" + className + "] " + "id = " + this.id;
	}
	,clone: function() {
		return new com.cmm.common.audio.SoundFile(this.channel,this.id,this.filename,this.loops,this.volume,this.packName);
	}
	,set_packName: function(newPackName) {
		return this.packName = newPackName;
	}
	,set_volume: function(newVolume) {
		if(newVolume > 100) newVolume = 100; else if(newVolume < 0) newVolume = 0;
		if(newVolume > 1) this.volume = newVolume / 100; else this.volume = newVolume;
		return this.volume;
	}
	,set_loops: function(newLoops) {
		return this.loops = newLoops;
	}
	,set_filename: function(newFilename) {
		return this.filename = newFilename;
	}
	,set_id: function(newID) {
		return this.id = newID;
	}
	,set_channel: function(newChannel) {
		return this.channel = newChannel;
	}
	,__class__: com.cmm.common.audio.SoundFile
}
flambe.Entity = function() {
	this.firstComponent = null;
	this.next = null;
	this.firstChild = null;
	this.parent = null;
	this._compMap = { };
};
$hxClasses["flambe.Entity"] = flambe.Entity;
flambe.Entity.__name__ = ["flambe","Entity"];
flambe.Entity.__interfaces__ = [flambe.util.Disposable];
flambe.Entity.prototype = {
	toStringImpl: function(indent) {
		var output = "";
		var p = this.firstComponent;
		while(p != null) {
			output += p.get_name();
			if(p.next != null) output += ", ";
			p = p.next;
		}
		output += "\n";
		var u2514 = String.fromCharCode(9492);
		var u241c = String.fromCharCode(9500);
		var u2500 = String.fromCharCode(9472);
		var u2502 = String.fromCharCode(9474);
		var p1 = this.firstChild;
		while(p1 != null) {
			var last = p1.next == null;
			output += indent + (last?u2514:u241c) + u2500 + u2500 + " ";
			output += p1.toStringImpl(indent + (last?" ":u2502) + "   ");
			p1 = p1.next;
		}
		return output;
	}
	,toString: function() {
		return this.toStringImpl("");
	}
	,dispose: function() {
		if(this.parent != null) this.parent.removeChild(this);
		while(this.firstComponent != null) this.firstComponent.dispose();
		this.disposeChildren();
	}
	,disposeChildren: function() {
		while(this.firstChild != null) this.firstChild.dispose();
	}
	,insertChild: function(toInsert,pos,after) {
		if(after == null) after = true;
		if(this.firstChild == null) return this.addChild(toInsert,false);
		if(!after) {
			if(pos == 0) return this.addChild(toInsert,false);
		}
		var prev = null;
		var cur = this.firstChild;
		var next = this.firstChild.next;
		var idx = 0;
		while(cur != null && idx != pos) {
			prev = cur;
			cur = cur.next;
			if(cur != null) next = cur.next;
			idx++;
		}
		if(cur != null) {
			if(toInsert.parent != null) toInsert.parent.removeChild(toInsert);
			toInsert.parent = this;
			if(after) {
				cur.next = toInsert;
				toInsert.next = next;
			} else {
				prev.next = toInsert;
				toInsert.next = cur;
			}
		} else return this.addChild(toInsert);
		return toInsert;
	}
	,removeChild: function(entity) {
		var prev = null, p = this.firstChild;
		while(p != null) {
			var next = p.next;
			if(p == entity) {
				if(prev == null) this.firstChild = next; else prev.next = next;
				p.parent = null;
				p.next = null;
				return;
			}
			prev = p;
			p = next;
		}
	}
	,addChild: function(entity,append) {
		if(append == null) append = true;
		if(entity.parent != null) entity.parent.removeChild(entity);
		entity.parent = this;
		if(append) {
			var tail = null, p = this.firstChild;
			while(p != null) {
				tail = p;
				p = p.next;
			}
			if(tail != null) tail.next = entity; else this.firstChild = entity;
		} else {
			entity.next = this.firstChild;
			this.firstChild = entity;
		}
		return this;
	}
	,getComponent: function(name) {
		return this._compMap[name];
	}
	,remove: function(component) {
		var prev = null, p = this.firstComponent;
		while(p != null) {
			var next = p.next;
			if(p == component) {
				if(prev == null) this.firstComponent = next; else prev._internal_init(this,next);
				delete(this._compMap[p.get_name()]);
				p.onRemoved();
				p._internal_init(null,null);
				return;
			}
			prev = p;
			p = next;
		}
	}
	,add: function(component) {
		if(component.owner != null) component.owner.remove(component);
		var name = component.get_name();
		var prev = this.getComponent(name);
		if(prev != null) this.remove(prev);
		this._compMap[name] = component;
		var tail = null, p = this.firstComponent;
		while(p != null) {
			tail = p;
			p = p.next;
		}
		if(tail != null) tail._internal_setNext(component); else this.firstComponent = component;
		component._internal_init(this,null);
		component.onAdded();
		return this;
	}
	,__class__: flambe.Entity
}
com.cmm.common.audio.SoundPlayerRemote = function() {
};
$hxClasses["com.cmm.common.audio.SoundPlayerRemote"] = com.cmm.common.audio.SoundPlayerRemote;
com.cmm.common.audio.SoundPlayerRemote.__name__ = ["com","cmm","common","audio","SoundPlayerRemote"];
com.cmm.common.audio.SoundPlayerRemote.init = function(soundFilesXml,onInitComplete) {
	flambe.System.root.addChild(com.cmm.common.audio.SoundPlayerRemote.entity);
	com.cmm.common.audio.SoundPlayerRemote._onInitComplete = onInitComplete;
	com.cmm.common.audio.SoundPlayerRemote._soundFilesXml = soundFilesXml;
	var startXml = com.cmm.common.audio.SoundPlayerRemote._soundFilesXml.firstChild();
	var $it0 = startXml.elements();
	while( $it0.hasNext() ) {
		var element = $it0.next();
		var muteable = false;
		if(element.get("muteable") != null) muteable = true;
		var channel = element.get("channel");
		if(channel != null) {
			if(com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel(channel) == null) com.cmm.common.audio.SoundPlayerRemote.setSoundClipChannel(channel,false,muteable);
		}
		var $it1 = element.elements();
		while( $it1.hasNext() ) {
			var sound = $it1.next();
			if(sound != null) {
				var sf = new com.cmm.common.audio.SoundFile();
				if(channel != null) sf.set_channel(channel);
				var loops = sound.get("loops");
				var volume = sound.get("volume");
				if(loops != null) sf.set_loops(Std.parseInt(loops));
				if(volume != null) sf.set_volume(Std.parseFloat(volume));
				var id = sound.get("id");
				var filename = sound.get("file");
				if(filename.indexOf(".") > -1) filename = filename.split(".")[0];
				if(id != null) {
					sf.set_id(id);
					if(com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByID.get(id) == null) com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByID.set(id,[sf]); else com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByID.get(id).push(sf);
				}
				if(filename != null) {
					sf.set_filename(filename);
					com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByFilename.set(filename,sf);
				}
				var packName = sound.get("packName");
				if(packName != null) {
					sf.set_packName(packName);
					if(packName == "") sf.set_packName("soundCommonPack");
				} else sf.set_packName("soundCommonPack");
			}
		}
	}
	if(com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel("music") == null) com.cmm.common.audio.SoundPlayerRemote.setSoundClipChannel("music");
	if(com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel("vo") == null) com.cmm.common.audio.SoundPlayerRemote.setSoundClipChannel("vo");
	com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel("music").setOverrideSound(true);
	com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel("vo").setOverrideSound(true);
	com.cmm.common.audio.SoundPlayerRemote._unpausedBeforeFocusOut = new Array();
	com.cmm.common.event.EDispatcher.addEventListener("com.cmm.common.events.onFocusOut",com.cmm.common.audio.SoundPlayerRemote.onFocusOut);
	com.cmm.common.event.EDispatcher.addEventListener("com.cmm.common.events.onFocusIn",com.cmm.common.audio.SoundPlayerRemote.onFocusIn);
	if(com.cmm.common.audio.SoundPlayerRemote._onInitComplete != null) com.cmm.common.audio.SoundPlayerRemote._onInitComplete();
}
com.cmm.common.audio.SoundPlayerRemote.onFocusOut = function(e) {
	while(com.cmm.common.audio.SoundPlayerRemote._unpausedBeforeFocusOut.length > 0) com.cmm.common.audio.SoundPlayerRemote._unpausedBeforeFocusOut.pop();
	var $it0 = com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.keys();
	while( $it0.hasNext() ) {
		var key = $it0.next();
		if(com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.get(key).muted == false) com.cmm.common.audio.SoundPlayerRemote._unpausedBeforeFocusOut.push(key);
	}
	com.cmm.common.audio.SoundPlayerRemote.pauseAllChannels();
}
com.cmm.common.audio.SoundPlayerRemote.onFocusIn = function(e) {
	var _g1 = 0, _g = com.cmm.common.audio.SoundPlayerRemote._unpausedBeforeFocusOut.length;
	while(_g1 < _g) {
		var i = _g1++;
		com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel(com.cmm.common.audio.SoundPlayerRemote._unpausedBeforeFocusOut[i]).resume();
	}
}
com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel = function(channelID) {
	if(com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.exists(channelID) == true) return com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.get(channelID);
	return null;
}
com.cmm.common.audio.SoundPlayerRemote.setSoundClipChannel = function(channelID,overrideSound,muteable) {
	if(muteable == null) muteable = false;
	if(overrideSound == null) overrideSound = false;
	var newSoundClipChannel = new com.cmm.common.audio.SoundClipChannel(channelID,overrideSound,muteable);
	com.cmm.common.audio.SoundPlayerRemote.entity.addChild(new flambe.Entity().add(newSoundClipChannel));
	com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.set(channelID,newSoundClipChannel);
	newSoundClipChannel.onSoundFileStart = com.cmm.common.audio.SoundPlayerRemote.soundFileStartHandler;
	newSoundClipChannel.onSoundFileFinish = com.cmm.common.audio.SoundPlayerRemote.soundFileFinishHandler;
}
com.cmm.common.audio.SoundPlayerRemote.getSoundFilesFromID = function(soundID) {
	var soundFiles = new Array();
	var ids = soundID.split(",");
	var _g1 = 0, _g = ids.length;
	while(_g1 < _g) {
		var i = _g1++;
		if(com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByID.exists(ids[i])) {
			var _g2 = 0, _g3 = com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByID.get(ids[i]);
			while(_g2 < _g3.length) {
				var sf = _g3[_g2];
				++_g2;
				soundFiles.push(sf.clone());
			}
		} else if(com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByFilename.exists(ids[i])) soundFiles.push(com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByFilename.get(ids[i]).clone());
	}
	return soundFiles;
}
com.cmm.common.audio.SoundPlayerRemote.isChannelMuted = function(channelID) {
	return com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel(channelID).muted;
}
com.cmm.common.audio.SoundPlayerRemote.isValidFile = function(soundID) {
	if(com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByID.exists(soundID)) return true; else if(com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByFilename.exists(soundID)) return true;
	return false;
}
com.cmm.common.audio.SoundPlayerRemote.play = function(soundID,onComplete) {
	var soundFiles = com.cmm.common.audio.SoundPlayerRemote.getSoundFilesFromID(soundID);
	var sc = new com.cmm.common.audio.SoundClip(soundFiles,onComplete);
	var channel = null;
	try {
		var channel = sc.get_channel();
		if ((channel === 'vo') || (channel === 'tutorial')) {
			com.cmm.common.audio.SoundPlayerRemote.stopChannel('vo');
			com.cmm.common.audio.SoundPlayerRemote.stopChannel('tutorial');
		}
		com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel(channel).play(sc);
	} catch( e ) {
	}
	return sc;
}
com.cmm.common.audio.SoundPlayerRemote.stopChannel = function(channelID) {
	if(channelID == null) channelID = "";
	if(channelID == "") com.cmm.common.audio.SoundPlayerRemote.stopAllChannels(); else com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel(channelID).stop();
}
com.cmm.common.audio.SoundPlayerRemote.stopAllChannels = function() {
	var $it0 = com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.iterator();
	while( $it0.hasNext() ) {
		var element = $it0.next();
		element.stop();
	}
}
com.cmm.common.audio.SoundPlayerRemote.pauseAllChannels = function() {
	var $it0 = com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.iterator();
	while( $it0.hasNext() ) {
		var element = $it0.next();
		element.pause();
	}
}
com.cmm.common.audio.SoundPlayerRemote.muteChannel = function(channelID) {
	if(channelID == null) channelID = "";
	if(channelID == "") com.cmm.common.audio.SoundPlayerRemote.muteAllChannels(); else com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel(channelID).mute();
}
com.cmm.common.audio.SoundPlayerRemote.muteAllChannels = function() {
	var $it0 = com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.iterator();
	while( $it0.hasNext() ) {
		var element = $it0.next();
		element.mute();
	}
}
com.cmm.common.audio.SoundPlayerRemote.unmuteChannel = function(channelID) {
	if(channelID == null) channelID = "";
	if(channelID == "") com.cmm.common.audio.SoundPlayerRemote.unmuteAllChannels(); else com.cmm.common.audio.SoundPlayerRemote.getSoundClipChannel(channelID).unmute();
}
com.cmm.common.audio.SoundPlayerRemote.unmuteAllChannels = function() {
	var $it0 = com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.iterator();
	while( $it0.hasNext() ) {
		var element = $it0.next();
		element.unmute();
	}
}
com.cmm.common.audio.SoundPlayerRemote.unmuteMuteableChannels = function() {
	com.cmm.common.audio.SoundPlayerRemote.isMuted = false;
	var $it0 = com.cmm.common.audio.SoundPlayerRemote._soundClipChannels.iterator();
	while( $it0.hasNext() ) {
		var channel = $it0.next();
		if(channel.muteable == true) channel.unmute();
	}
}
com.cmm.common.audio.SoundPlayerRemote.soundFileStartHandler = function(sf) {
	if(com.cmm.common.audio.SoundPlayerRemote._onSoundFileStart != null) com.cmm.common.audio.SoundPlayerRemote._onSoundFileStart.emit(sf);
}
com.cmm.common.audio.SoundPlayerRemote.soundFileFinishHandler = function(sf) {
	if(com.cmm.common.audio.SoundPlayerRemote._onSoundFileFinish != null) com.cmm.common.audio.SoundPlayerRemote._onSoundFileFinish.emit(sf);
}
com.cmm.common.audio.SoundPlayerRemote.get_onSoundFileStart = function() {
	if(com.cmm.common.audio.SoundPlayerRemote._onSoundFileStart == null) com.cmm.common.audio.SoundPlayerRemote._onSoundFileStart = new flambe.util.Signal1();
	return com.cmm.common.audio.SoundPlayerRemote._onSoundFileStart;
}
com.cmm.common.audio.SoundPlayerRemote.get_onSoundFileFinish = function() {
	if(com.cmm.common.audio.SoundPlayerRemote._onSoundFileFinish == null) com.cmm.common.audio.SoundPlayerRemote._onSoundFileFinish = new flambe.util.Signal1();
	return com.cmm.common.audio.SoundPlayerRemote._onSoundFileFinish;
}
com.cmm.common.audio.SoundPlayerRemote.__super__ = flambe.Component;
com.cmm.common.audio.SoundPlayerRemote.prototype = $extend(flambe.Component.prototype,{
	get_name: function() {
		return "SoundPlayerRemote_2";
	}
	,__class__: com.cmm.common.audio.SoundPlayerRemote
});
com.cmm.common.components.btn.BackBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.common.components.btn.BackBtn"] = com.cmm.common.components.btn.BackBtn;
com.cmm.common.components.btn.BackBtn.__name__ = ["com","cmm","common","components","btn","BackBtn"];
com.cmm.common.components.btn.BackBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.common.components.btn.BackBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		var mc = this._ownerSprite.get_parent();
		mc.prevFrame();
	}
	,__class__: com.cmm.common.components.btn.BackBtn
});
com.cmm.common.components.btn.SkipBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.common.components.btn.SkipBtn"] = com.cmm.common.components.btn.SkipBtn;
com.cmm.common.components.btn.SkipBtn.__name__ = ["com","cmm","common","components","btn","SkipBtn"];
com.cmm.common.components.btn.SkipBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.common.components.btn.SkipBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		var mc = this._ownerSprite.get_parent();
		mc.gotoAndStop(mc.get_totalFrames());
		mc.skip();
	}
	,__class__: com.cmm.common.components.btn.SkipBtn
});
com.cmm.common.components.mc = {}
com.cmm.common.components.mc.ConfirmationPopup = function(pid,paramObject) {
	com.cmm.common.components.CMMComponent.call(this,pid,paramObject);
};
$hxClasses["com.cmm.common.components.mc.ConfirmationPopup"] = com.cmm.common.components.mc.ConfirmationPopup;
com.cmm.common.components.mc.ConfirmationPopup.__name__ = ["com","cmm","common","components","mc","ConfirmationPopup"];
com.cmm.common.components.mc.ConfirmationPopup.__super__ = com.cmm.common.components.CMMComponent;
com.cmm.common.components.mc.ConfirmationPopup.prototype = $extend(com.cmm.common.components.CMMComponent.prototype,{
	onNoClick: function(e) {
		var _g = this;
		console.log("NO CLICK");
		this._sConnOnComplete = com.cmm.common.app.SceneManager.get_currentScene().get_onComplete().connect(function() {
			_g.onNoComplete();
		});
		var mc = this._ownerSprite;
		mc.gotoAndPlay(mc.get_currentFrame(),mc.get_nextLabelFrame(),0);
	}
	,onYesClick: function(e) {
		var _g = this;
		console.log("YES CLICK");
		this._sConnOnComplete = com.cmm.common.app.SceneManager.get_currentScene().get_onComplete().connect(function() {
			_g.onYesComplete();
		});
		var mc = this._ownerSprite;
		mc.gotoAndPlay(mc.get_currentFrame(),mc.get_nextLabelFrame(),0);
	}
	,onNoComplete: function() {
		this._sConnOnComplete.dispose();
		if(this.onNoCallback != null) {
			this.onNoCallback();
			this.onNoCallback = null;
		}
	}
	,onYesComplete: function() {
		this._sConnOnComplete.dispose();
		if(this.onYesCallback != null) {
			this.onYesCallback();
			this.onYesCallback = null;
		}
	}
	,onRemoved: function() {
		this._sConnYesBtn.dispose();
		this._sConnNoBtn.dispose();
	}
	,onAdded: function() {
		var _g = this;
		com.cmm.common.components.CMMComponent.prototype.onAdded.call(this);
		this._btn_yes = com.cmm.common.display.SpriteContainer.getFrom(this.owner).getChildByName("btn_yes");
		if(this._btn_yes == null) throw "ConfirmationPopup.hx onAdded: could not find yes button child. Make sure there is a layer/child with the name btn_yes";
		this._btn_no = com.cmm.common.display.SpriteContainer.getFrom(this.owner).getChildByName("btn_no");
		if(this._btn_no == null) throw "ConfirmationPopup.hx onAdded: could not find no button child. Make sure there is a layer/child with the name btn_no";
		this._sConnYesBtn = this._btn_yes.get_pointerClick().connect(function(e) {
			_g.onYesClick(e);
		});
		this._sConnNoBtn = this._btn_no.get_pointerClick().connect(function(e) {
			_g.onNoClick(e);
		});
	}
	,__class__: com.cmm.common.components.mc.ConfirmationPopup
});
com.cmm.common.components.mc.SimpleScroller = function(pid,paramObject) {
	this._moving = false;
	this._page = 1;
	this._bidirectional = true;
	com.cmm.common.components.CMMComponent.call(this,pid,paramObject);
	this._resetable = true;
	this._swipeScrollDelayInMSec = 300;
	this._swipeScrollTimeDeltaMaxInSec = this._swipeScrollDelayInMSec / 1000;
	this._xSwipeMax = 40;
	this._ySwipeMin = 50;
};
$hxClasses["com.cmm.common.components.mc.SimpleScroller"] = com.cmm.common.components.mc.SimpleScroller;
com.cmm.common.components.mc.SimpleScroller.__name__ = ["com","cmm","common","components","mc","SimpleScroller"];
com.cmm.common.components.mc.SimpleScroller.__super__ = com.cmm.common.components.CMMComponent;
com.cmm.common.components.mc.SimpleScroller.prototype = $extend(com.cmm.common.components.CMMComponent.prototype,{
	stopSwipeTimers: function() {
		if(this._swipeStartTimer != null) {
			this._swipeStartTimer.stop();
			this._swipeStartTimer = null;
		}
		if(this._swipeCompleteTimer != null) {
			this._swipeCompleteTimer.stop();
			this._swipeCompleteTimer = null;
		}
	}
	,swipeFailHandler: function() {
		this.stopSwipeTimers();
		if(this._swipeScrollPoint != null) {
			this._swipeScrollPoint = null;
			com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.CMMEvent("swipeAborted"));
		}
	}
	,swipeTimerComplete: function() {
		this._swipeCompleteTimer = null;
		this.swipeFailHandler();
	}
	,swipeStartCheck: function() {
		this._swipeStartTimer = null;
		if(this._swipeStarted == false) this.swipeFailHandler();
	}
	,swipeScrollCheck: function() {
		this.stopSwipeTimers();
		if(this._swipeScrollPoint != null) {
			var xDistSwiped = flambe.System.get_pointer().get_x() - this._swipeScrollPoint.x;
			var yDistSwiped = flambe.System.get_pointer().get_y() - this._swipeScrollPoint.y;
			if(flambe.System.get_pointer().get_x() <= 200 && Math.abs(xDistSwiped) <= this._xSwipeMax && Math.abs(yDistSwiped) >= this._ySwipeMin) {
				if(yDistSwiped > 0) this.onBackwardClick(null); else this.onForwardClick(null);
				com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.CMMEvent("swipeDetected"));
			} else com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.CMMEvent("swipeAborted"));
			this._swipeScrollPoint = null;
		}
	}
	,addSwipeFunctionality: function() {
		var _g = this;
		flambe.System.get_pointer().down.connect(function(event) {
			_g._swipeStarted = false;
			_g._swipeScrollPoint = new flambe.math.Point(flambe.System.get_pointer().get_x(),flambe.System.get_pointer().get_y());
			_g._swipeStamp = haxe.Timer.stamp();
			_g._swipeStartTimer = haxe.Timer.delay($bind(_g,_g.swipeStartCheck),Std["int"](_g._swipeScrollDelayInMSec / 3));
			_g._swipeCompleteTimer = haxe.Timer.delay($bind(_g,_g.swipeTimerComplete),_g._swipeScrollDelayInMSec);
		});
		flambe.System.get_pointer().up.connect(function(event) {
			if(haxe.Timer.stamp() - _g._swipeStamp <= _g._swipeScrollTimeDeltaMaxInSec) _g.swipeScrollCheck(); else _g.swipeFailHandler();
		});
		flambe.System.get_pointer().move.connect(function(event) {
			_g._swipeStarted = true;
			if(_g._swipeScrollPoint != null && Math.abs(flambe.System.get_pointer().get_x() - _g._swipeScrollPoint.x) > _g._xSwipeMax) _g.swipeFailHandler();
		});
	}
	,continueBackwardScroll: function() {
		this.cancelContinuedScroll();
		if(flambe.System.get_pointer().isDown()) {
			console.log("continueBackwardScroll");
			this.onBackwardClick(new flambe.input.PointerEvent());
		}
	}
	,continueForwardScroll: function() {
		this.cancelContinuedScroll();
		if(flambe.System.get_pointer().isDown()) {
			console.log("continueForwardScroll");
			this.onForwardClick(new flambe.input.PointerEvent());
		}
	}
	,cancelContinuedScroll: function() {
		if(this._scrollTimer != null) {
			this._scrollTimer.stop();
			this._scrollTimer = null;
		}
	}
	,isOffPageFrame: function(pageIndex) {
		if(pageIndex == null) pageIndex = 0;
		if(pageIndex == 0) pageIndex = Std["int"](this._page); else if(pageIndex < 0 || pageIndex > this._lastPage) throw "SimpleScroller: pageIndex argument of " + pageIndex + " used in method isOffPageFrame is out of range";
		return this._scrollContent.get_currentFrame() != this._pageFramePairs[pageIndex][0];
	}
	,setBtnEnabledState: function() {
		if(this._bidirectional) {
			if(this._page == 1 && !this.isOffPageFrame()) this._backwardBtn.disable(); else this._backwardBtn.enable();
			if(this._page == this._lastPage && this._scrollContent.get_currentFrame() == this._pageFramePairs[this._lastPage][0]) this._forwardBtn.disable(); else this._forwardBtn.enable();
		}
	}
	,onBackwardClick: function(e) {
		if(this._backwardBtn.get_pointerEnabled() && this._moving == false) {
			this._moving = true;
			var pageIndex = Std["int"](this._page);
			var start = 0;
			var target = 0;
			if(this.isOffPageFrame()) {
				start = Std["int"](this._pageFramePairs[pageIndex][1] - (this._scrollContent.get_currentFrame() - this._pageFramePairs[pageIndex][0]));
				target = this._pageFramePairs[pageIndex][1];
			} else if(this._page > 1) {
				start = this._pageFramePairs[pageIndex][1];
				target = this._pageFramePairs[pageIndex - 1][1];
				this._page--;
			}
			this._scrollContent.gotoAndPlay(start,target,0);
			this.setBtnEnabledState();
			if(e != null) {
				this.cancelContinuedScroll();
				this._scrollTimer = new haxe.Timer(1000);
				this._scrollTimer.run = $bind(this,this.continueBackwardScroll);
			}
		}
	}
	,onForwardClick: function(e) {
		if(this._forwardBtn.get_pointerEnabled() && this._moving == false) {
			this._moving = true;
			if(this._bidirectional) {
				if(this._page < this._lastPage) {
					var pageIndex = Std["int"](this._page);
					var start = this.isOffPageFrame()?this._scrollContent.get_currentFrame():this._pageFramePairs[pageIndex][0];
					var target = this._pageFramePairs[pageIndex + 1][0];
					this._scrollContent.gotoAndPlay(start,target,0);
					this._page++;
				}
			} else {
				if(this._scrollContent.get_currentFrame() == this._scrollContent.get_totalFrames()) {
					this._scrollContent.gotoAndStop(1);
					this._page = 1;
				} else this._page++;
				this._scrollContent.gotoAndPlay(this._scrollContent.get_currentFrame(),this._scrollContent.get_nextLabelFrame());
			}
			this.setBtnEnabledState();
			if(e != null) {
				this.cancelContinuedScroll();
				this._scrollTimer = new haxe.Timer(1000);
				this._scrollTimer.run = $bind(this,this.continueForwardScroll);
			}
		}
	}
	,addClickFunctionality: function() {
		this._forwardBtn = (js.Boot.__cast(this._ownerSprite , com.cmm.common.display.MovieClip)).getChildByName("btn_forwardScroll");
		this._backwardBtn = (js.Boot.__cast(this._ownerSprite , com.cmm.common.display.MovieClip)).getChildByName("btn_backwardScroll");
		if(this._forwardBtn == null) throw "Missing forwardBtn in SimpleScroller"; else {
			this._signalConnection.connect1(this._forwardBtn.get_pointerDown(),$bind(this,this.onForwardClick));
			this._signalConnection.connect0(this._forwardBtn.get_pointerOut(),$bind(this,this.cancelContinuedScroll));
		}
		if(this._backwardBtn == null) this._bidirectional = false; else {
			this._signalConnection.connect1(this._backwardBtn.get_pointerDown(),$bind(this,this.onBackwardClick));
			this._signalConnection.connect0(this._backwardBtn.get_pointerOut(),$bind(this,this.cancelContinuedScroll));
		}
		if(this._resetable) {
			this.reset();
			this._resetable = false;
		}
	}
	,setPage: function(page) {
		this._page = Math.abs(page);
		this._scrollContent.gotoAndStop(this._pageFramePairs[Std["int"](this._page)][0]);
	}
	,reset: function() {
		this.setPage(1);
	}
	,adjustPageAndFrameAfterAnimationCompletion: function() {
		if(this._moving == true) {
			this._moving = false;
			this._scrollContent.gotoAndStop(this._pageFramePairs[Std["int"](this._page)][0]);
		} else {
			console.log("FALSE SET FRAME");
			var frameToCheck = this._scrollContent.get_currentFrame();
			console.log(frameToCheck);
			var _g1 = 1, _g = this._pageFramePairs.length;
			while(_g1 < _g) {
				var i = _g1++;
				console.log(i);
				console.log(this._pageFramePairs[i]);
				if(this._pageFramePairs[i][0] == frameToCheck) this._page = i; else if(this._pageFramePairs[i][1] < frameToCheck) {
					this._page = i;
					break;
				} else if(this._pageFramePairs[i][0] < frameToCheck) this._page = i;
			}
			console.log(this._page);
		}
		this.setBtnEnabledState();
	}
	,addAnimationCompleteHandler: function() {
		this._scrollContent.get_onComplete().connect($bind(this,this.adjustPageAndFrameAfterAnimationCompletion));
	}
	,createPageFrameLookup: function() {
		this._pageFramePairs = [];
		var frameArray = this._scrollContent.currentLabels;
		var _g = 0;
		while(_g < frameArray.length) {
			var frame = frameArray[_g];
			++_g;
			if(Std.parseFloat(frame.name) > 0) {
				var page = Std["int"](Std.parseFloat(frame.name));
				this._pageFramePairs[page] = [frame.frame,this._scrollContent.getFrameFromLabel(Std.string(-page))];
			}
		}
		this._lastPage = this._pageFramePairs.length - 1;
	}
	,onAdded: function() {
		com.cmm.common.components.CMMComponent.prototype.onAdded.call(this);
		this._scrollContent = this._ownerSprite.get_parent();
		if(this._scrollContent != null) {
			this.createPageFrameLookup();
			this.addAnimationCompleteHandler();
			this.addClickFunctionality();
			this.addSwipeFunctionality();
			this.setBtnEnabledState();
		}
	}
	,__class__: com.cmm.common.components.mc.SimpleScroller
});
com.cmm.common.components.mc.ToggleContainer = function(pid,paramObject) {
	com.cmm.common.components.CMMComponent.call(this,pid,paramObject);
};
$hxClasses["com.cmm.common.components.mc.ToggleContainer"] = com.cmm.common.components.mc.ToggleContainer;
com.cmm.common.components.mc.ToggleContainer.__name__ = ["com","cmm","common","components","mc","ToggleContainer"];
com.cmm.common.components.mc.ToggleContainer.__super__ = com.cmm.common.components.CMMComponent;
com.cmm.common.components.mc.ToggleContainer.prototype = $extend(com.cmm.common.components.CMMComponent.prototype,{
	onSecondaryClick: function(e) {
		this._primary.set_visible(true);
		this._secondary.set_visible(false);
	}
	,onPrimaryClick: function(e) {
		this._primary.set_visible(false);
		this._secondary.set_visible(true);
	}
	,onAdded: function() {
		com.cmm.common.components.CMMComponent.prototype.onAdded.call(this);
		this._primary = this._ownerSprite.getChildByName("primary");
		this._secondary = this._ownerSprite.getChildByName("secondary");
		this._signalConnection.connect1(this._primary.get_pointerClick(),$bind(this,this.onPrimaryClick));
		this._signalConnection.connect1(this._secondary.get_pointerClick(),$bind(this,this.onSecondaryClick));
		this._primary.set_visible(true);
		this._secondary.set_visible(false);
	}
	,__class__: com.cmm.common.components.mc.ToggleContainer
});
com.cmm.common.data = {}
com.cmm.common.data.RandomNoRepeatArray = function(origArray) {
	this._origArray = new Array();
	this._indexArray = new Array();
	var _g1 = 0, _g = origArray.length;
	while(_g1 < _g) {
		var i = _g1++;
		this._origArray.push(origArray[i]);
	}
};
$hxClasses["com.cmm.common.data.RandomNoRepeatArray"] = com.cmm.common.data.RandomNoRepeatArray;
com.cmm.common.data.RandomNoRepeatArray.__name__ = ["com","cmm","common","data","RandomNoRepeatArray"];
com.cmm.common.data.RandomNoRepeatArray.prototype = {
	shuffle: function() {
		var ret = new Array();
		while(this._indexArray.length > 0) {
			var index = Std.random(this._indexArray.length);
			ret.push(this._indexArray[index]);
			this._indexArray.splice(index,1);
		}
		var _g1 = 0, _g = ret.length;
		while(_g1 < _g) {
			var i = _g1++;
			this._indexArray.push(ret[i]);
		}
	}
	,getNextItem: function() {
		if(this._indexArray.length == 0) {
			var _g1 = 0, _g = this._origArray.length;
			while(_g1 < _g) {
				var i = _g1++;
				this._indexArray.push(i);
			}
			this.shuffle();
		}
		var index = this._indexArray.pop();
		var obj = this._origArray[index];
		return obj;
	}
	,__class__: com.cmm.common.data.RandomNoRepeatArray
}
com.cmm.common.display = {}
com.cmm.common.display.FlumpLibrary = function(pack,baseDir) {
	this._symbols = new Hash();
	this.name = baseDir;
	var json = haxe.Json.parse(pack.getFile(baseDir + "/library.json"));
	this.frameRate = json.frameRate;
	var movies = [];
	var _g = 0, _g1 = json.movies;
	while(_g < _g1.length) {
		var movieObject = _g1[_g];
		++_g;
		var movie = new com.cmm.common.display.MovieClipSymbol(this,movieObject);
		movies.push(movie);
		this._symbols.set(movie.get_name(),movie);
	}
	var groups = json.textureGroups;
	if(groups[0].scaleFactor != 1 || groups.length > 1) flambe.Log.warn("Flambe doesn't support Flump's Additional Scale Factors. " + "Use Base Scales and load from different asset packs instead.");
	var atlases = groups[0].atlases;
	var _g = 0;
	while(_g < atlases.length) {
		var atlasObject = atlases[_g];
		++_g;
		var atlas = pack.getTexture(baseDir + "/" + flambe.util.Strings.removeFileExtension(atlasObject.file));
		var _g1 = 0, _g2 = atlasObject.textures;
		while(_g1 < _g2.length) {
			var textureObject = _g2[_g1];
			++_g1;
			var bitmap = new com.cmm.common.display.TextureSpriteSymbol(textureObject,atlas);
			this._symbols.set(bitmap.get_name(),bitmap);
		}
	}
	var _g = 0;
	while(_g < movies.length) {
		var movie = movies[_g];
		++_g;
		var _g1 = 0, _g2 = movie.layers;
		while(_g1 < _g2.length) {
			var layer = _g2[_g1];
			++_g1;
			var kfIndex = 0;
			var _g3 = 0, _g4 = layer.keyframes;
			while(_g3 < _g4.length) {
				var kf = _g4[_g3];
				++_g3;
				if(kf.symbolName != null) {
					var symbol = this._symbols.get(kf.symbolName);
					flambe.util.Assert.that(symbol != null);
					if(layer.lastSymbol == null) {
						layer.lastSymbol = symbol;
						layer.lastSymbolKeyFrameIndex = kfIndex;
					} else if(layer.lastSymbol != symbol) layer.multipleSymbols = true;
					kf.symbol = symbol;
				}
				kfIndex++;
			}
		}
	}
};
$hxClasses["com.cmm.common.display.FlumpLibrary"] = com.cmm.common.display.FlumpLibrary;
com.cmm.common.display.FlumpLibrary.__name__ = ["com","cmm","common","display","FlumpLibrary"];
com.cmm.common.display.FlumpLibrary.prototype = {
	createSprite: function(symbolName,required) {
		if(required == null) required = true;
		var symbol = this._symbols.get(symbolName);
		if(symbol == null) {
			if(required) throw flambe.util.Strings.withFields("Missing symbol",["name",symbolName]);
			return null;
		}
		return symbol.createSprite();
	}
	,getSymbol: function(symbolName) {
		return this._symbols.get(symbolName);
	}
	,__class__: com.cmm.common.display.FlumpLibrary
}
flambe.display = {}
flambe.display.Sprite = function() {
	this._parentViewMatrixUpdateCount = 0;
	this._viewMatrixUpdateCount = 0;
	this._viewMatrix = null;
	this.scissor = null;
	this.blendMode = null;
	var _g = this;
	this._flags = 1 << 0 | 1 << 1 | 1 << 3;
	this._localMatrix = new flambe.math.Matrix();
	var dirtyMatrix = function(_,_1) {
		_g._flags = flambe.util.BitSets.add(_g._flags,1 << 2 | 1 << 3);
	};
	this.x = new flambe.animation.AnimatedFloat(0,dirtyMatrix);
	this.y = new flambe.animation.AnimatedFloat(0,dirtyMatrix);
	this.rotation = new flambe.animation.AnimatedFloat(0,dirtyMatrix);
	this.scaleX = new flambe.animation.AnimatedFloat(1,dirtyMatrix);
	this.scaleY = new flambe.animation.AnimatedFloat(1,dirtyMatrix);
	this.anchorX = new flambe.animation.AnimatedFloat(0,dirtyMatrix);
	this.anchorY = new flambe.animation.AnimatedFloat(0,dirtyMatrix);
	this.alpha = new flambe.animation.AnimatedFloat(1);
};
$hxClasses["flambe.display.Sprite"] = flambe.display.Sprite;
flambe.display.Sprite.__name__ = ["flambe","display","Sprite"];
flambe.display.Sprite.getFrom = function(entity) {
	return entity.getComponent("Sprite_1");
}
flambe.display.Sprite.hitTest = function(entity,x,y) {
	var sprite = flambe.display.Sprite.getFrom(entity);
	if(sprite != null) {
		if(!flambe.util.BitSets.containsAll(sprite._flags,1 << 0 | 1 << 1)) return null;
		if(sprite.getLocalMatrix().inverseTransform(x,y,flambe.display.Sprite._scratchPoint)) {
			x = flambe.display.Sprite._scratchPoint.x;
			y = flambe.display.Sprite._scratchPoint.y;
		}
		var scissor = sprite.scissor;
		if(scissor != null && !scissor.contains(x,y)) return null;
	}
	var result = flambe.display.Sprite.hitTestBackwards(entity.firstChild,x,y);
	if(result != null) return result;
	return sprite != null && sprite.containsLocal(x,y)?sprite:null;
}
flambe.display.Sprite.getBounds = function(entity,result) {
	if(result == null) result = new flambe.math.Rectangle();
	result.set(1.79769313486231e+308,1.79769313486231e+308,-1.79769313486231e+308,-1.79769313486231e+308);
	flambe.display.Sprite.getBoundsImpl(entity,null,result);
	result.width -= result.x;
	result.height -= result.y;
	return result;
}
flambe.display.Sprite.render = function(entity,g) {
	var sprite = flambe.display.Sprite.getFrom(entity);
	if(sprite != null) {
		var alpha = sprite.alpha.get__();
		if(!sprite.get_visible() || alpha <= 0) return;
		g.save();
		if(alpha < 1) g.multiplyAlpha(alpha);
		if(sprite.blendMode != null) g.setBlendMode(sprite.blendMode);
		var matrix = sprite.getLocalMatrix();
		g.transform(matrix.m00,matrix.m10,matrix.m01,matrix.m11,matrix.m02,matrix.m12);
		var scissor = sprite.scissor;
		if(scissor != null) g.applyScissor(scissor.x,scissor.y,scissor.width,scissor.height);
		sprite.draw(g);
	}
	var director = flambe.scene.Director.getFrom(entity);
	if(director != null) {
		var scenes = director.occludedScenes;
		var _g = 0;
		while(_g < scenes.length) {
			var scene = scenes[_g];
			++_g;
			flambe.display.Sprite.render(scene,g);
		}
	}
	var p = entity.firstChild;
	while(p != null) {
		var next = p.next;
		flambe.display.Sprite.render(p,g);
		p = next;
	}
	if(sprite != null) g.restore();
}
flambe.display.Sprite.hitTestBackwards = function(entity,x,y) {
	if(entity != null) {
		var result = flambe.display.Sprite.hitTestBackwards(entity.next,x,y);
		return result != null?result:flambe.display.Sprite.hitTest(entity,x,y);
	}
	return null;
}
flambe.display.Sprite.getBoundsImpl = function(entity,matrix,result) {
	var sprite = flambe.display.Sprite.getFrom(entity);
	if(sprite != null) {
		matrix = matrix != null?flambe.math.Matrix.multiply(matrix,sprite.getLocalMatrix()):sprite.getLocalMatrix();
		var x1 = 0.0, y1 = 0.0;
		var x2 = sprite.getNaturalWidth(), y2 = sprite.getNaturalHeight();
		if(x2 > x1 && y2 > y1) {
			flambe.display.Sprite.extendRect(matrix,x1,y1,result);
			flambe.display.Sprite.extendRect(matrix,x2,y1,result);
			flambe.display.Sprite.extendRect(matrix,x2,y2,result);
			flambe.display.Sprite.extendRect(matrix,x1,y2,result);
		}
	}
	var director = flambe.scene.Director.getFrom(entity);
	if(director != null) {
		var scenes = director.occludedScenes;
		var ii = 0, ll = scenes.length;
		while(ii < ll) {
			flambe.display.Sprite.getBoundsImpl(scenes[ii],matrix,result);
			++ii;
		}
	}
	var p = entity.firstChild;
	while(p != null) {
		var next = p.next;
		flambe.display.Sprite.getBoundsImpl(p,matrix,result);
		p = next;
	}
}
flambe.display.Sprite.extendRect = function(matrix,x,y,rect) {
	var p = matrix.transform(x,y,flambe.display.Sprite._scratchPoint);
	x = p.x;
	y = p.y;
	if(x < rect.x) rect.x = x;
	if(y < rect.y) rect.y = y;
	if(x > rect.width) rect.width = x;
	if(y > rect.height) rect.height = y;
}
flambe.display.Sprite.__super__ = flambe.Component;
flambe.display.Sprite.prototype = $extend(flambe.Component.prototype,{
	set_pointerEnabled: function(pointerEnabled) {
		this._flags = flambe.util.BitSets.set(this._flags,1 << 1,pointerEnabled);
		return pointerEnabled;
	}
	,get_pointerEnabled: function() {
		return flambe.util.BitSets.contains(this._flags,1 << 1);
	}
	,set_visible: function(visible) {
		this._flags = flambe.util.BitSets.set(this._flags,1 << 0,visible);
		return visible;
	}
	,get_visible: function() {
		return flambe.util.BitSets.contains(this._flags,1 << 0);
	}
	,get_pointerUp: function() {
		if(this._internal_pointerUp == null) this._internal_pointerUp = new flambe.util.Signal1();
		return this._internal_pointerUp;
	}
	,get_pointerMove: function() {
		if(this._internal_pointerMove == null) this._internal_pointerMove = new flambe.util.Signal1();
		return this._internal_pointerMove;
	}
	,get_pointerDown: function() {
		if(this._internal_pointerDown == null) this._internal_pointerDown = new flambe.util.Signal1();
		return this._internal_pointerDown;
	}
	,getParentSprite: function() {
		if(this.owner == null) return null;
		var entity = this.owner.parent;
		while(entity != null) {
			var sprite = flambe.display.Sprite.getFrom(entity);
			if(sprite != null) return sprite;
			entity = entity.parent;
		}
		return null;
	}
	,isViewMatrixDirty: function() {
		if(flambe.util.BitSets.contains(this._flags,1 << 3)) return true;
		var parentSprite = this.getParentSprite();
		if(parentSprite == null) return false;
		return this._parentViewMatrixUpdateCount != parentSprite._viewMatrixUpdateCount || parentSprite.isViewMatrixDirty();
	}
	,draw: function(g) {
	}
	,onUpdate: function(dt) {
		this.x.update(dt);
		this.y.update(dt);
		this.rotation.update(dt);
		this.scaleX.update(dt);
		this.scaleY.update(dt);
		this.alpha.update(dt);
		this.anchorX.update(dt);
		this.anchorY.update(dt);
	}
	,setScale: function(scale) {
		this.scaleX.set__(scale);
		this.scaleY.set__(scale);
		return this;
	}
	,setXY: function(x,y) {
		this.x.set__(x);
		this.y.set__(y);
		return this;
	}
	,getViewMatrix: function() {
		if(this.isViewMatrixDirty()) {
			var parentSprite = this.getParentSprite();
			this._viewMatrix = parentSprite != null?flambe.math.Matrix.multiply(parentSprite.getViewMatrix(),this.getLocalMatrix(),this._viewMatrix):this.getLocalMatrix().clone(this._viewMatrix);
			this._flags = flambe.util.BitSets.remove(this._flags,1 << 3);
			if(parentSprite != null) this._parentViewMatrixUpdateCount = parentSprite._viewMatrixUpdateCount;
			++this._viewMatrixUpdateCount;
		}
		return this._viewMatrix;
	}
	,getLocalMatrix: function() {
		if(flambe.util.BitSets.contains(this._flags,1 << 2)) {
			this._flags = flambe.util.BitSets.remove(this._flags,1 << 2);
			this._localMatrix.compose(this.x.get__(),this.y.get__(),this.scaleX.get__(),this.scaleY.get__(),flambe.math.FMath.toRadians(this.rotation.get__()));
			this._localMatrix.translate(-this.anchorX.get__(),-this.anchorY.get__());
		}
		return this._localMatrix;
	}
	,containsLocal: function(localX,localY) {
		return localX >= 0 && localX < this.getNaturalWidth() && localY >= 0 && localY < this.getNaturalHeight();
	}
	,getNaturalHeight: function() {
		return 0;
	}
	,getNaturalWidth: function() {
		return 0;
	}
	,get_name: function() {
		return "Sprite_1";
	}
	,__class__: flambe.display.Sprite
});
com.cmm.common.display.SpriteContainer = function() {
	this._rolledOut = true;
	flambe.display.Sprite.call(this);
	this._children = new Array();
	if(this.get_instanceName() == null) this.set_instanceName("instance_" + Std.string(com.cmm.common.display.SpriteContainer._instanceNum)); else this.set_instanceName(this.get_instanceName());
	com.cmm.common.display.SpriteContainer._instanceNum++;
	if(com.cmm.common.display.SpriteContainer._connectedGlobalPointerUp == false) {
		flambe.System.get_pointer().up.connect(function(e) {
			com.cmm.common.display.SpriteContainer.onPointerUp_SystemGlobal(e);
		});
		com.cmm.common.display.SpriteContainer._connectedGlobalPointerUp = true;
	}
	this._buttonState = com.cmm.common.display.BUTTON_STATE.UP;
	var entity = new flambe.Entity();
	entity.add(this);
};
$hxClasses["com.cmm.common.display.SpriteContainer"] = com.cmm.common.display.SpriteContainer;
com.cmm.common.display.SpriteContainer.__name__ = ["com","cmm","common","display","SpriteContainer"];
com.cmm.common.display.SpriteContainer.getFrom = function(entity) {
	return entity.getComponent("Sprite_1");
}
com.cmm.common.display.SpriteContainer.hasIn = function(entity) {
	return entity.getComponent("Sprite_1") != null;
}
com.cmm.common.display.SpriteContainer.onPointerUp_SystemGlobal = function(e) {
	com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("onGlobalPointerUp"));
}
com.cmm.common.display.SpriteContainer.__super__ = flambe.display.Sprite;
com.cmm.common.display.SpriteContainer.prototype = $extend(flambe.display.Sprite.prototype,{
	get_pointerOut: function() {
		if(this._pointerOut == null) this._pointerOut = new flambe.util.Signal0();
		return this._pointerOut;
	}
	,get_pointerOver: function() {
		if(this._pointerOver == null) this._pointerOver = new flambe.util.Signal0();
		return this._pointerOver;
	}
	,get_pointerClick: function() {
		if(this._pointerClick == null) this._pointerClick = new flambe.util.Signal1();
		return this._pointerClick;
	}
	,onPointerOut: function() {
		this._buttonState = com.cmm.common.display.BUTTON_STATE.UP;
		this._rolledOut = true;
		if(this._pointerOut != null) this._pointerOut.emit();
	}
	,onPointerOver: function() {
		this._buttonState = com.cmm.common.display.BUTTON_STATE.OVER;
		this._rolledOut = false;
		if(this._pointerOver != null) this._pointerOver.emit();
	}
	,rolloverActive: function() {
		return !flambe.System.get_touch().get_supported() && (this._pointerOut != null || this._pointerOver != null) && this.get_pointerEnabled();
	}
	,localToGlobal: function() {
		var matrix = this.getViewMatrix(),
			v = matrix.transform(0, 0),
			x = v.x,
			y = v.y,
			parent = this.get_parent();

		while (parent != null) {
			matrix = parent.getLocalMatrix();
			v = matrix.transform(x, y);
			x = v.x;
			y = v.y;
			parent = parent.get_parent();
		}

		return new flambe.math.Point(x, y);
	}
	,onUpdate: function(dt) {
		flambe.display.Sprite.prototype.onUpdate.call(this,dt);
		if(this.rolloverActive()) {
			if(this._buttonState == com.cmm.common.display.BUTTON_STATE.OVER) {
				if(!this.checkPointerInBounds() && this._rolledOut == false) this.onPointerOut();
			}
		}
	}
	,onGlobalPointerUp: function(e) {
		this._buttonState = com.cmm.common.display.BUTTON_STATE.UP;
		this._rolledOut = true;
	}
	,onPointerUp: function(e) {
		if(this._buttonState == com.cmm.common.display.BUTTON_STATE.DOWN || this._buttonState == com.cmm.common.display.BUTTON_STATE.OVER) {
			if(this._rolledOut == true) this._buttonState = com.cmm.common.display.BUTTON_STATE.UP; else this._buttonState = com.cmm.common.display.BUTTON_STATE.OVER;
			if(this._pointerClick != null) this._pointerClick.emit(e.clone());
		}
	}
	,onPointerDown: function(e) {
		if(this._rolledOut == false && this.checkPointerInBounds() == true || !this.rolloverActive()) this._buttonState = com.cmm.common.display.BUTTON_STATE.DOWN;
	}
	,_internal_set_visible: function(visible) {
		return flambe.display.Sprite.prototype.set_visible.call(this,visible);
	}
	,toString: function() {
		var className = flambe.util.Strings.getFileExtension(Type.getClassName(Type.getClass(this)));
		return "[" + className + "] " + this.get_instanceName();
	}
	,set_visible: function(visible) {
		if(this.get_parent() != null) {
			if(Std["is"](this.get_parent(),com.cmm.common.display.MovieClip)) {
				(js.Boot.__cast(this.get_parent() , com.cmm.common.display.MovieClip))._internal_setLayerVisible(this.get_instanceName(),visible);
				return flambe.display.Sprite.prototype.set_visible.call(this,visible);
			} else return flambe.display.Sprite.prototype.set_visible.call(this,visible);
		} else return flambe.display.Sprite.prototype.set_visible.call(this,visible);
	}
	,get_parent: function() {
		if(this.owner == null || this.owner.parent == null) return null;
		return com.cmm.common.display.SpriteContainer.getFrom(this.owner.parent);
	}
	,get_numChildren: function() {
		return this._children.length;
	}
	,set_instanceName: function(value) {
		return this.instanceName = value;
	}
	,get_instanceName: function() {
		return this.instanceName;
	}
	,swapChildren: function(child1,child2) {
		if(child1 == child2) return;
		var foundChildIdx1 = -1;
		var foundChildIdx2 = -1;
		var _g1 = 0, _g = this._children.length;
		while(_g1 < _g) {
			var i = _g1++;
			if(this._children[i] == child1) {
				foundChildIdx1 = i;
				if(foundChildIdx2 != -1) break;
			} else if(this._children[i] == child2) {
				foundChildIdx2 = i;
				if(foundChildIdx1 != -1) break;
			}
		}
		if(foundChildIdx1 != -1 && foundChildIdx2 != -1) {
			this.addChildAt(child1,foundChildIdx2);
			this.addChildAt(child2,foundChildIdx1);
		} else if(foundChildIdx1 == -1 && foundChildIdx2 == -1) throw "SpriteContainer.hx swapChildren: neither sprite is a child of this container."; else if(foundChildIdx1 == -1) throw "SpriteContainer.hx swapChildren: child1 " + Std.string(child1) + " is not a child of this container."; else if(foundChildIdx2 == -1) throw "SpriteContainer.hx swapChildren: child2 " + Std.string(child2) + " is not a child of this container.";
	}
	,getChildIndex: function(child) {
		var _g1 = 0, _g = this._children.length;
		while(_g1 < _g) {
			var i = _g1++;
			if(this._children[i] == child) return i;
		}
		return -1;
	}
	,getChildByName: function(name) {
		var _g = 0, _g1 = this._children;
		while(_g < _g1.length) {
			var child = _g1[_g];
			++_g;
			if(Std["is"](child,com.cmm.common.display.SpriteContainer)) {
				if((js.Boot.__cast(child , com.cmm.common.display.SpriteContainer)).get_instanceName() == name) return child;
			}
		}
		return null;
	}
	,getChildAt: function(index) {
		if(index >= 0 && index < this._children.length) return this._children[index];
		throw "SpriteContainer.hx: getChildAt: index: " + index + " is out of range";
		return null;
	}
	,containsSprite: function(child) {
		var _g = 0, _g1 = this._children;
		while(_g < _g1.length) {
			var c = _g1[_g];
			++_g;
			if(c == child) return true;
		}
		return false;
	}
	,removeChildAt: function(index) {
		if(index >= 0 && index < this._children.length) {
			var child = this._children.splice(index,1)[0];
			this.owner.removeChild(child.owner);
			return child;
		}
		throw "SpriteContainer.hx: removeChildAt index is out of range";
		return null;
	}
	,removeChild: function(child) {
		var index = 0;
		var retChild = null;
		var _g = 0, _g1 = this._children;
		while(_g < _g1.length) {
			var c = _g1[_g];
			++_g;
			if(c == child) {
				retChild = c;
				this.owner.removeChild(c.owner);
				var _owner = this.owner;
				do _owner = _owner.parent; while(_owner != flambe.System.root && _owner != null);
				if(_owner == flambe.System.root) this.onRemovedFromStage();
				this._children.splice(index,1);
				break;
			}
			index++;
		}
		if(retChild == null) throw "SpriteContainer.hx removeChild: child was not found.";
		return retChild;
	}
	,addChildAt: function(child,index) {
		if(index >= 0 && index <= this._children.length) {
			var childEntity = null;
			if(child.owner == null) {
				childEntity = new flambe.Entity();
				childEntity.add(child);
			} else {
				if(child.owner.parent != null) {
					if(com.cmm.common.display.SpriteContainer.hasIn(child.owner.parent)) com.cmm.common.display.SpriteContainer.getFrom(child.owner.parent).removeChild(child);
				}
				childEntity = child.owner;
			}
			this._children.splice(index,0,child);
			this.owner.insertChild(childEntity,index,false);
			return child;
		} else {
			throw "SpriteContainer.hx: addChildAt: index: " + index + " is out of range";
			return null;
		}
	}
	,addChild: function(child) {
		if(child.owner == null) {
			var newChild = new flambe.Entity();
			newChild.add(child);
			this.owner.addChild(newChild);
		} else {
			if(child.owner.parent != null) {
				if(com.cmm.common.display.SpriteContainer.hasIn(child.owner.parent)) com.cmm.common.display.SpriteContainer.getFrom(child.owner.parent).removeChild(child);
			}
			this.owner.addChild(child.owner);
		}
		this._children.push(child);
		var _owner = this.owner;
		do _owner = _owner.parent; while(_owner != flambe.System.root && _owner != null);
		if(_owner == flambe.System.root) this.onAddedToStage();
		return child;
	}
	,onRemovedFromStage: function() {
	}
	,onAddedToStage: function() {
		var _g1 = 0, _g = this._children.length;
		while(_g1 < _g) {
			var i = _g1++;
			if(Std["is"](this._children[i],com.cmm.common.display.SpriteContainer)) (js.Boot.__cast(this._children[i] , com.cmm.common.display.SpriteContainer)).onAddedToStage();
		}
	}
	,onAdded: function() {
		flambe.display.Sprite.prototype.onAdded.call(this);
		var disposer = flambe.Disposer.getFrom(this.owner);
		if(disposer == null) {
			this._signalConnection = new flambe.Disposer();
			this.owner.add(this._signalConnection);
		} else this._signalConnection = disposer;
	}
	,checkPointerInBounds: function() {
		var bounds = flambe.display.Sprite.getBounds(this.owner),
			matrix = this.getViewMatrix(),
			v = new flambe.math.Point(),
			x = 0,
			y = 0;

		matrix.inverseTransform(flambe.System.get_pointer().get_x(), flambe.System.get_pointer().get_y(), v);
		x = v.x;
		y = v.y;
		this.getLocalMatrix().transform(x, y, v);

		if (bounds.contains(v.x, v.y)) {
			if (this._hitClips.length > 0) {
				var _g = 0, _g1 = this._hitClips;
				while (_g < _g1.length) {
					var child = _g1[_g];
					++_g;
					if (child.checkPointerInBounds()) {
						return true;
					}
				}
			} else {
				return true;
			}
		}
		return false;
	}
	,onPointerMove: function(e) {
		if(this.rolloverActive()) {
			if(this._buttonState == com.cmm.common.display.BUTTON_STATE.UP) {
				if(this.checkPointerInBounds() == true && this._rolledOut == true) {
					if(flambe.System.get_pointer().isDown() == true) {
					} else this.onPointerOver();
				}
			}
		}
	}
	,setHitAreas: function() {
		var nonhit = [];
		this._hitClips = [];
		var _g = 0, _g1 = this._children;
		while(_g < _g1.length) {
			var child = _g1[_g];
			++_g;
			if(Std["is"](child,com.cmm.common.display.MovieClip)) {
				if((js.Boot.__cast(child , com.cmm.common.display.MovieClip)).get_instanceName() == "hit") this._hitClips.push(js.Boot.__cast(child , com.cmm.common.display.SpriteContainer)); else nonhit.push(child);
			} else nonhit.push(child);
			if(this._hitClips.length > 0) {
				var _g2 = 0;
				while(_g2 < nonhit.length) {
					var child1 = nonhit[_g2];
					++_g2;
					child1.set_pointerEnabled(false);
				}
			}
		}
	}
	,__class__: com.cmm.common.display.SpriteContainer
});
com.cmm.common.display.MovieClip = function(symbol) {
	this._curCallbackLabelIdx = -1;
	this._curAudioLabelIdx = -1;
	this._frameMS = 0;
	this._onCallbackLabel = null;
	this._onAudioLabel = null;
	this._onComplete = null;
	this._onLoop = null;
	this.resetToStartFrame = false;
	this.endFrame = 0;
	this.startFrame = 0;
	this.totalLoops = 0;
	this.curLoops = 0;
	this.totalFrames = 0;
	this.currentFrame = 1;
	com.cmm.common.display.SpriteContainer.call(this);
	this.symbol = symbol;
	this.speed = new flambe.animation.AnimatedFloat(1);
	this.currentLabels = new Array();
	this.audioLabels = new Array();
	this.callbackLabels = new Array();
	this._frameMS = 1000 / symbol.frameRate * 0.001;
	this._animators = flambe.util.Arrays.create(symbol.layers.length);
	var _g1 = 0, _g = this._animators.length;
	while(_g1 < _g) {
		var ii = _g1++;
		var layer = symbol.layers[ii];
		this._animators[ii] = new com.cmm.common.display._MovieClip.MovieClipLayerAnimator(layer);
		if(layer.name == "sequence") {
			var _g2 = 0, _g3 = layer.keyframes;
			while(_g2 < _g3.length) {
				var kf = _g3[_g2];
				++_g2;
				if(kf.label != null) this.currentLabels.push(new com.cmm.common.display.FrameLabel(kf.label,kf.index + 1));
			}
		} else if(layer.name == "audio") {
			var _g2 = 0, _g3 = layer.keyframes;
			while(_g2 < _g3.length) {
				var kf = _g3[_g2];
				++_g2;
				if(kf.label != null) this.audioLabels.push(new com.cmm.common.display.FrameLabel(kf.label,kf.index + 1));
			}
			this._curAudioLabelIdx = -1;
			if(this.audioLabels.length > 0) {
				this._curAudioLabelIdx = 0;
				this.get_onAudioLabel().connect($bind(this,this.onAudioLabelTriggered));
			}
		} else if(layer.name == "callback") {
			var _g2 = 0, _g3 = layer.keyframes;
			while(_g2 < _g3.length) {
				var kf = _g3[_g2];
				++_g2;
				if(kf.label != null) this.callbackLabels.push(new com.cmm.common.display.FrameLabel(kf.label,kf.index + 1));
			}
			this._curCallbackLabelIdx = -1;
			if(this.callbackLabels.length > 0) {
				this._curCallbackLabelIdx = 0;
				this.get_onCallbackLabel().connect($bind(this,this.onCallbackLabelTriggered));
			}
		}
		if(com.cmm.common.display.SpriteContainer.hasIn(this._animators[ii].content)) com.cmm.common.display.SpriteContainer.getFrom(this._animators[ii].content).set_instanceName(layer.name);
		this._children.push(flambe.display.Sprite.getFrom(this._animators[ii].content));
	}
	this.startFrame = 1;
	this.endFrame = this.get_totalFrames();
	this.curLoops = 0;
	this.totalLoops = -1;
	this._frame = 1;
	this._position = 1;
	this["goto"](1);
	if(this.symbol.frames == 1) this.gotoAndStop(1);
	this.compose();
	this.setHitAreas();
};
$hxClasses["com.cmm.common.display.MovieClip"] = com.cmm.common.display.MovieClip;
com.cmm.common.display.MovieClip.__name__ = ["com","cmm","common","display","MovieClip"];
com.cmm.common.display.MovieClip.getFrom = function(entity) {
	return entity.getComponent("Sprite_1");
}
com.cmm.common.display.MovieClip.__super__ = com.cmm.common.display.SpriteContainer;
com.cmm.common.display.MovieClip.prototype = $extend(com.cmm.common.display.SpriteContainer.prototype,{
	get_prevLabelFrame: function() {
		if(this.get_prevLabel() != null) return this.get_prevLabel().frame;
		return 1;
	}
	,get_prevLabel: function() {
		var _g1 = 0, _g = this.currentLabels.length;
		while(_g1 < _g) {
			var i = _g1++;
			var fL = this.currentLabels[i];
			if(fL.frame >= this.get_currentFrame()) {
				if(i > 0) return this.currentLabels[i - 1]; else return null;
			}
		}
		return null;
	}
	,get_currentLabel: function() {
		var _g1 = 0, _g = this.currentLabels.length;
		while(_g1 < _g) {
			var i = _g1++;
			var fL = this.currentLabels[i];
			if(fL.frame == this.get_currentFrame()) return fL.name; else if(fL.frame > this.get_currentFrame()) {
				if(i == 0) return null; else return this.currentLabels[i - 1].name;
			}
		}
		if(this.currentLabels.length > 0) return this.currentLabels[this.currentLabels.length - 1].name;
		return null;
	}
	,get_currentFrameLabel: function() {
		var _g1 = 0, _g = this.currentLabels.length;
		while(_g1 < _g) {
			var i = _g1++;
			var fL = this.currentLabels[i];
			if(fL.frame == this.get_currentFrame()) return fL.name;
		}
		return null;
	}
	,get_nextLabelFrame: function() {
		if(this.get_nextLabel() != null) return this.get_nextLabel().frame;
		return this.get_totalFrames();
	}
	,get_nextLabel: function() {
		var _g1 = 0, _g = this.currentLabels.length;
		while(_g1 < _g) {
			var i = _g1++;
			var fL = this.currentLabels[i];
			if(fL.frame > this.get_currentFrame()) return fL;
		}
		return null;
	}
	,get_className: function() {
		return this.symbol.get_name();
	}
	,_internal_setLayerVisible: function(layerName,visible) {
		var _g = 0, _g1 = this._animators;
		while(_g < _g1.length) {
			var animator = _g1[_g];
			++_g;
			if(animator.layer.name == layerName) {
				animator.visible = visible;
				break;
			}
		}
	}
	,toString: function() {
		return com.cmm.common.display.SpriteContainer.prototype.toString.call(this);
	}
	,get_onCallbackLabel: function() {
		if(this._onCallbackLabel == null) this._onCallbackLabel = new flambe.util.Signal1();
		return this._onCallbackLabel;
	}
	,get_onAudioLabel: function() {
		if(this._onAudioLabel == null) this._onAudioLabel = new flambe.util.Signal1();
		return this._onAudioLabel;
	}
	,get_onComplete: function() {
		if(this._onComplete == null) this._onComplete = new flambe.util.Signal0();
		return this._onComplete;
	}
	,get_onLoop: function() {
		if(this._onLoop == null) this._onLoop = new flambe.util.Signal0();
		return this._onLoop;
	}
	,get_currentFrame: function() {
		return Math.floor(this._frame);
	}
	,get_totalFrames: function() {
		return this.symbol.frames;
	}
	,set_paused: function(paused) {
		this._flags = flambe.util.BitSets.set(this._flags,1 << 4,paused);
		return paused;
	}
	,get_paused: function() {
		return flambe.util.BitSets.contains(this._flags,1 << 4);
	}
	,set_position: function(position) {
		return this._position = flambe.math.FMath.clamp(position,0,this.symbol.duration);
	}
	,'goto': function(newFrame) {
		if(this._frame == newFrame) return;
		var wrapped = newFrame < this._frame;
		if(wrapped) {
			var _g = 0, _g1 = this._animators;
			while(_g < _g1.length) {
				var animator = _g1[_g];
				++_g;
				animator.changedKeyframe = true;
				animator.keyframeIdx = 0;
			}
		}
		var _g = 0, _g1 = this._animators;
		while(_g < _g1.length) {
			var animator = _g1[_g];
			++_g;
			animator.composeFrame(newFrame - 1);
		}
		this._frame = newFrame;
	}
	,removeAnimatorForSprite: function(sprite) {
		if(Std["is"](sprite,com.cmm.common.display.SpriteContainer)) {
			var idx = 0;
			var _g = 0, _g1 = this._animators;
			while(_g < _g1.length) {
				var animator = _g1[_g];
				++_g;
				if(animator.layer.name == (js.Boot.__cast(sprite , com.cmm.common.display.SpriteContainer)).get_instanceName()) {
					this._animators.splice(idx,1);
					return;
				}
				idx++;
			}
		}
	}
	,checkCallbackLabel: function(newFrame) {
		if(this.callbackLabels.length > 0 && this._curCallbackLabelIdx > -1) {
			var curCallbackLabel = this.callbackLabels[this._curCallbackLabelIdx];
			if(curCallbackLabel.frame <= newFrame) {
				if(this._onCallbackLabel != null) this._onCallbackLabel.emit(curCallbackLabel.name);
				this._curCallbackLabelIdx++;
				if(this._curCallbackLabelIdx >= this.callbackLabels.length) this._curCallbackLabelIdx = -1;
			}
		}
	}
	,checkAudioLabel: function(newFrame) {
		if(this.audioLabels.length > 0 && this._curAudioLabelIdx > -1) {
			var curAudioLabel = this.audioLabels[this._curAudioLabelIdx];
			if(curAudioLabel.frame <= newFrame) {
				if(this._onAudioLabel != null) this._onAudioLabel.emit(curAudioLabel.name);
				this._curAudioLabelIdx++;
				if(this._curAudioLabelIdx >= this.audioLabels.length) this._curAudioLabelIdx = -1;
			}
		}
	}
	,findClosestLabelIdx: function(labelArray,newFrame) {
		var _g1 = 0, _g = labelArray.length;
		while(_g1 < _g) {
			var i = _g1++;
			if(labelArray[i].frame >= newFrame) return i;
		}
		return -1;
	}
	,onCallbackLabelTriggered: function(label) {
		console.log(label);
	}
	,onAudioLabelTriggered: function(label) {
		com.cmm.common.audio.SoundPlayerRemote.play(label);
	}
	,getFrameFromLabel: function(label) {
		var _g1 = 0, _g = this.currentLabels.length;
		while(_g1 < _g) {
			var i = _g1++;
			if(this.currentLabels[i].name == label) return this.currentLabels[i].frame;
		}
		return -1;
	}
	,removeChildAt: function(index) {
		var retSprite = com.cmm.common.display.SpriteContainer.prototype.removeChildAt.call(this,index);
		this.removeAnimatorForSprite(retSprite);
		return retSprite;
	}
	,removeChild: function(child) {
		var retSprite = com.cmm.common.display.SpriteContainer.prototype.removeChild.call(this,child);
		this.removeAnimatorForSprite(retSprite);
		return retSprite;
	}
	,onUpdate: function(dt) {
		com.cmm.common.display.SpriteContainer.prototype.onUpdate.call(this,dt);
		this.speed.update(dt);
		if(this.speed.get__() == 0) return;
		if(!this.get_paused()) {
			this._position += this.speed.get__() * dt;
			var extraFrameTime = 1 * this._frameMS;
			var startFrameTime = this.startFrame * this._frameMS;
			var endFrameTime = this.endFrame * this._frameMS;
			if(this._position > endFrameTime + extraFrameTime) {
				this._position = startFrameTime;
				if(this.totalLoops > -1) {
					if(this.curLoops >= this.totalLoops) {
						this.gotoAndStop(this.endFrame);
						if(this._onComplete != null) this._onComplete.emit();
						if(this.resetToStartFrame) this.gotoAndStop(this.startFrame);
						return;
					}
				}
				this.curLoops++;
				if(this._onLoop != null) this._onLoop.emit();
			}
		}
		var newFrame = this._position * this.symbol.frameRate;
		this.checkAudioLabel(newFrame);
		this.checkCallbackLabel(newFrame);
		this["goto"](newFrame);
	}
	,onRemovedFromStage: function() {
		com.cmm.common.display.SpriteContainer.prototype.onRemovedFromStage.call(this);
	}
	,onRemoved: function() {
		com.cmm.common.display.SpriteContainer.prototype.onRemoved.call(this);
		var _g = 0, _g1 = this._animators;
		while(_g < _g1.length) {
			var animator = _g1[_g];
			++_g;
			this.owner.removeChild(animator.content);
		}
	}
	,onAddedToStage: function() {
		com.cmm.common.display.SpriteContainer.prototype.onAddedToStage.call(this);
		var _g = 0, _g1 = this._components;
		while(_g < _g1.length) {
			var component = _g1[_g];
			++_g;
			this.owner.add(component);
		}
	}
	,onAdded: function() {
		com.cmm.common.display.SpriteContainer.prototype.onAdded.call(this);
		if(this._animators != null) {
			var _g = 0, _g1 = this._animators;
			while(_g < _g1.length) {
				var animator = _g1[_g];
				++_g;
				this.owner.addChild(animator.content);
			}
		}
	}
	,stop: function() {
		this.speed.set__(0);
	}
	,prevFrame: function() {
		var start = 1;
		var end = this.get_totalFrames();
		if(this.get_currentFrame() > start) this.gotoAndStop(this.get_currentFrame() - 1); else this.gotoAndStop(end);
	}
	,skip: function() {
		this.stop();
		if(this._onComplete != null) this._onComplete.emit();
	}
	,gotoAndStop: function(frame) {
		var frameIndex = 1;
		if(Std["is"](frame,Int)) frameIndex = frame; else if(Std["is"](frame,String)) frameIndex = this.getFrameFromLabel(frame);
		if(frameIndex < 1 || frameIndex > this.get_totalFrames()) throw "MovieClip.hx: frameIndex is out of range: " + frameIndex;
		this._frame = this.symbol.frames + 1;
		var framePercentage = frameIndex * this._frameMS;
		this._position = framePercentage;
		this._curAudioLabelIdx = this.findClosestLabelIdx(this.audioLabels,this._frame);
		this._curCallbackLabelIdx = this.findClosestLabelIdx(this.callbackLabels,this._frame);
		this.speed.set__(0);
		this["goto"](frameIndex);
	}
	,gotoAndPlay: function(startFrame,endFrame,loops,resetToStartFrame) {
		if(resetToStartFrame == null) resetToStartFrame = false;
		if(loops == null) loops = -1;
		var startFrameIndex = 1;
		if(Std["is"](startFrame,Int)) startFrameIndex = startFrame; else if(Std["is"](startFrame,String)) startFrameIndex = this.getFrameFromLabel(startFrame);
		if(startFrameIndex < 1 || startFrameIndex > this.get_totalFrames()) throw "MovieClip.hx: startFrameIndex is out of range";
		var endFrameIndex = this.get_totalFrames();
		if(endFrame != null) {
			if(Std["is"](endFrame,Int)) endFrameIndex = endFrame; else if(Std["is"](endFrame,String)) endFrameIndex = this.getFrameFromLabel(endFrame);
		}
		if(endFrameIndex < 1 || endFrameIndex > this.get_totalFrames()) throw "MovieClip.hx: endFrameIndex is out of range";
		if(endFrameIndex < this.get_totalFrames()) {
			if(startFrameIndex >= endFrameIndex) throw "MovieClip.hx gotoAndPlay: startFrame is greater than or equal to endFrame";
		}
		this.totalLoops = loops;
		this.curLoops = 0;
		this.startFrame = startFrameIndex;
		this.endFrame = endFrameIndex;
		this.resetToStartFrame = resetToStartFrame;
		this._frame = this.symbol.frames + 1;
		var framePercentage = startFrameIndex * this._frameMS;
		this._position = framePercentage;
		this._curAudioLabelIdx = this.findClosestLabelIdx(this.audioLabels,this.startFrame);
		this._curCallbackLabelIdx = this.findClosestLabelIdx(this.callbackLabels,this.startFrame);
		this["goto"](startFrameIndex);
		this.speed.set__(1);
		if(endFrame == null) this.startFrame = 1;
	}
	,compose: function() {
		if(this._components == null) this._components = [];
		var compositionObject = com.cmm.common.app.CompositionFactory.getCompositionObjectByClassName(this.symbol.get_name());
		if(compositionObject != null) {
			var _g = 0, _g1 = compositionObject.components;
			while(_g < _g1.length) {
				var componentClass = _g1[_g];
				++_g;
				this._components.push(Type.createInstance(componentClass,[compositionObject.id,compositionObject.params]));
			}
		}
	}
	,__class__: com.cmm.common.display.MovieClip
});
com.cmm.common.display.FrameLabel = function(name,frame) {
	this.name = name;
	this.frame = frame;
};
$hxClasses["com.cmm.common.display.FrameLabel"] = com.cmm.common.display.FrameLabel;
com.cmm.common.display.FrameLabel.__name__ = ["com","cmm","common","display","FrameLabel"];
com.cmm.common.display.FrameLabel.prototype = {
	__class__: com.cmm.common.display.FrameLabel
}
com.cmm.common.display._MovieClip = {}
com.cmm.common.display._MovieClip.MovieClipLayerAnimator = function(layer) {
	this._sprites = null;
	this.visible = true;
	this.changedKeyframe = false;
	this.keyframeIdx = 0;
	this.layer = layer;
	var sprite;
	if(layer.multipleSymbols) {
		this._sprites = flambe.util.Arrays.create(layer.keyframes.length);
		var _g1 = 0, _g = this._sprites.length;
		while(_g1 < _g) {
			var ii = _g1++;
			var kf = layer.keyframes[ii];
			this._sprites[ii] = kf.symbol != null?kf.symbol.createSprite():new com.cmm.common.display.SpriteContainer();
		}
		sprite = this._sprites[0];
	} else if(layer.lastSymbol != null) sprite = layer.lastSymbol.createSprite(); else sprite = new com.cmm.common.display.SpriteContainer();
	this.content = new flambe.Entity().add(sprite);
};
$hxClasses["com.cmm.common.display._MovieClip.MovieClipLayerAnimator"] = com.cmm.common.display._MovieClip.MovieClipLayerAnimator;
com.cmm.common.display._MovieClip.MovieClipLayerAnimator.__name__ = ["com","cmm","common","display","_MovieClip","MovieClipLayerAnimator"];
com.cmm.common.display._MovieClip.MovieClipLayerAnimator.prototype = {
	composeFrame: function(frame) {
		var keyframes = this.layer.keyframes;
		var finalFrame = keyframes.length - 1;
		while(this.keyframeIdx < finalFrame && keyframes[this.keyframeIdx + 1].index <= frame) {
			++this.keyframeIdx;
			this.changedKeyframe = true;
		}
		var sprite;
		if(this.changedKeyframe && this._sprites != null) {
			sprite = this._sprites[this.keyframeIdx];
			this.content.add(sprite);
		} else sprite = flambe.display.Sprite.getFrom(this.content);
		this.changedKeyframe = false;
		var kf = keyframes[this.keyframeIdx];
		var visible = kf.visible && kf.symbol != null && this.visible;
		(js.Boot.__cast(sprite , com.cmm.common.display.SpriteContainer))._internal_set_visible(visible);
		if(!visible) return;
		var x = kf.x;
		var y = kf.y;
		var scaleX = kf.scaleX;
		var scaleY = kf.scaleY;
		var skewX = kf.skewX;
		var skewY = kf.skewY;
		var alpha = kf.alpha;
		if(kf.tweened && kf.duration > 1 && this.keyframeIdx < finalFrame) {
			var interp = (frame - kf.index) / kf.duration;
			var ease = kf.ease;
			if(ease != 0) {
				var t;
				if(ease < 0) {
					var inv = 1 - interp;
					t = 1 - inv * inv;
					ease = -ease;
				} else t = interp * interp;
				interp = ease * t + (1 - ease) * interp;
			}
			var nextKf = keyframes[this.keyframeIdx + 1];
			x += (nextKf.x - x) * interp;
			y += (nextKf.y - y) * interp;
			scaleX += (nextKf.scaleX - scaleX) * interp;
			scaleY += (nextKf.scaleY - scaleY) * interp;
			skewX += (nextKf.skewX - skewX) * interp;
			skewY += (nextKf.skewY - skewY) * interp;
			alpha += (nextKf.alpha - alpha) * interp;
		}
		var matrix = sprite.getLocalMatrix();
		var sinX = Math.sin(skewX), cosX = Math.cos(skewX);
		var sinY = Math.sin(skewY), cosY = Math.cos(skewY);
		matrix.set(cosY * scaleX,sinY * scaleX,-sinX * scaleY,cosX * scaleY,x,y);
		matrix.translate(-kf.pivotX,-kf.pivotY);
		sprite.alpha.set__(alpha);
	}
	,__class__: com.cmm.common.display._MovieClip.MovieClipLayerAnimator
}
com.cmm.common.display.MovieClipButton = function(symbol) {
	var _g = this;
	com.cmm.common.display.MovieClip.call(this,symbol);
	this.checkConstruction();
	this.hideHitClip();
	this.get_pointerDown().connect(function(e) {
		_g.onPointerDown(e);
	});
	this.get_pointerUp().connect(function(e) {
		_g.onPointerUp(e);
	});
	this.get_pointerMove().connect(function(e) {
		_g.onPointerMove(e);
	});
	com.cmm.common.event.EDispatcher.addEventListener("onGlobalPointerUp",$bind(this,this.onGlobalPointerUp));
	this._buttonState = com.cmm.common.display.BUTTON_STATE.UP;
	this.gotoAndStop("up");
};
$hxClasses["com.cmm.common.display.MovieClipButton"] = com.cmm.common.display.MovieClipButton;
com.cmm.common.display.MovieClipButton.__name__ = ["com","cmm","common","display","MovieClipButton"];
com.cmm.common.display.MovieClipButton.__super__ = com.cmm.common.display.MovieClip;
com.cmm.common.display.MovieClipButton.prototype = $extend(com.cmm.common.display.MovieClip.prototype,{
	onPointerOut: function() {
		if(this._buttonState == com.cmm.common.display.BUTTON_STATE.OVER) {
			com.cmm.common.display.MovieClip.prototype.onPointerOut.call(this);
			if(flambe.System.get_pointer().isDown() == true) {
				this._buttonState = com.cmm.common.display.BUTTON_STATE.DOWN;
				this.gotoAndStop("over");
			} else {
				flambe.System.get_mouse().set_cursor(flambe.input.MouseCursor.Default);
				this.gotoAndStop("up");
			}
		}
	}
	,checkPosition: function(e) {
		if(!this.checkPointerInBounds()) {
			this._moveconnex.dispose();
			this.onPointerOut();
		}
	}
	,onPointerOver: function() {
		com.cmm.common.display.MovieClip.prototype.onPointerOver.call(this);
		flambe.System.get_mouse().set_cursor(flambe.input.MouseCursor.Button);
		if(this.getFrameFromLabel("over") != -1) this.gotoAndStop("over");
		this._moveconnex = flambe.System.get_pointer().move.connect($bind(this,this.checkPosition));
	}
	,onGlobalPointerUp: function(e) {
		if(this._buttonState == com.cmm.common.display.BUTTON_STATE.DOWN) {
			com.cmm.common.display.MovieClip.prototype.onGlobalPointerUp.call(this,e);
			this.gotoAndStop("up");
			flambe.System.get_mouse().set_cursor(flambe.input.MouseCursor.Default);
			this.hideHitClip();
		}
	}
	,onPointerUp: function(e) {
		if(this._buttonState == com.cmm.common.display.BUTTON_STATE.DOWN) {
			com.cmm.common.display.MovieClip.prototype.onPointerUp.call(this,e);
			if(this._buttonState == com.cmm.common.display.BUTTON_STATE.UP) {
				this.gotoAndStop("up");
				this.hideHitClip();
			} else if(this._buttonState == com.cmm.common.display.BUTTON_STATE.OVER) {
				if(this.getFrameFromLabel("over") != -1) this.gotoAndStop("over"); else this.gotoAndStop("up");
			}
		}
	}
	,onPointerDown: function(e) {
		com.cmm.common.display.MovieClip.prototype.onPointerDown.call(this,e);
		this.gotoAndStop("down");
		this.hideHitClip();
	}
	,disable: function() {
		if(this.get_pointerEnabled() == true) {
			this.set_pointerEnabled(false);
			this._buttonState = com.cmm.common.display.BUTTON_STATE.DISABLED;
			if(this.getFrameFromLabel("disabled") != -1) this.gotoAndStop("disabled");
			this.hideHitClip();
		}
	}
	,enable: function() {
		if(this.get_pointerEnabled() == false) {
			this.set_pointerEnabled(true);
			this._buttonState = com.cmm.common.display.BUTTON_STATE.UP;
			this.gotoAndStop(this.get_totalFrames());
			this.gotoAndStop("up");
			this.hideHitClip();
		}
	}
	,hideHitClip: function() {
		var _g = 0, _g1 = this._hitClips;
		while(_g < _g1.length) {
			var child = _g1[_g];
			++_g;
			child.alpha.set__(0);
		}
	}
	,checkConstruction: function() {
		if(this.getFrameFromLabel("up") == -1) throw "No 'up' label: " + this.symbol.get_name();
		if(this.getFrameFromLabel("down") == -1) throw "No 'down' label: " + this.symbol.get_name();
	}
	,__class__: com.cmm.common.display.MovieClipButton
});
flambe.swf = {}
flambe.swf.Symbol = function() { }
$hxClasses["flambe.swf.Symbol"] = flambe.swf.Symbol;
flambe.swf.Symbol.__name__ = ["flambe","swf","Symbol"];
flambe.swf.Symbol.prototype = {
	__class__: flambe.swf.Symbol
}
com.cmm.common.display.MovieClipSymbol = function(lib,json) {
	this.classType = "com.cmm.common.display.MovieClip";
	[com.cmm.common.display.MovieClip,com.cmm.common.event.Event];
	this._name = json.id;
	this.frameRate = lib.frameRate;
	switch(this.getSymbolType(this._name)) {
	case "mc":
		this.classType = "com.cmm.common.display.MovieClip";
		break;
	case "btn":
		this.classType = "com.cmm.common.display.MovieClipButton";
		break;
	case "txt":
		this.classType = "com.cmm.common.text.DynamicTextSprite";
		break;
	default:
	}
	this.frames = 0;
	this.layers = flambe.util.Arrays.create(json.layers.length);
	var _g1 = 0, _g = this.layers.length;
	while(_g1 < _g) {
		var ii = _g1++;
		var layer = new com.cmm.common.display.MovieClipLayer(json.layers[ii]);
		this.frames = Math.max(layer.get_frames(),this.frames);
		this.layers[ii] = layer;
	}
	this.duration = this.frames / this.frameRate;
};
$hxClasses["com.cmm.common.display.MovieClipSymbol"] = com.cmm.common.display.MovieClipSymbol;
com.cmm.common.display.MovieClipSymbol.__name__ = ["com","cmm","common","display","MovieClipSymbol"];
com.cmm.common.display.MovieClipSymbol.__interfaces__ = [flambe.swf.Symbol];
com.cmm.common.display.MovieClipSymbol.prototype = {
	getSymbolType: function(symbolName) {
		var index = symbolName.indexOf("_");
		if(index > 0) return symbolName.substring(0,index);
		return null;
	}
	,createSprite: function() {
		var retSprite = null;
		switch(this.classType) {
		case "com.cmm.common.display.MovieClip":
			retSprite = new com.cmm.common.display.MovieClip(this);
			break;
		case "com.cmm.common.display.MovieClipButton":
			retSprite = new com.cmm.common.display.MovieClipButton(this);
			break;
		case "com.cmm.common.text.DynamicTextSprite":
			retSprite = new com.cmm.common.text.DynamicTextSprite(this._name);
			break;
		default:
		}
		if(retSprite != null) {
			var newEntity = new flambe.Entity();
			newEntity.add(retSprite);
			return retSprite;
		} else {
			throw "MovieClipSymbol.hx type: " + this.classType + " not found.";
			return null;
		}
	}
	,get_name: function() {
		return this._name;
	}
	,__class__: com.cmm.common.display.MovieClipSymbol
}
com.cmm.common.display.MovieClipLayer = function(json) {
	this.multipleSymbols = false;
	this.lastSymbolKeyFrameIndex = 0;
	this.lastSymbol = null;
	this.name = json.name;
	var prevKf = null;
	this.keyframes = flambe.util.Arrays.create(json.keyframes.length);
	var _g1 = 0, _g = this.keyframes.length;
	while(_g1 < _g) {
		var ii = _g1++;
		prevKf = new com.cmm.common.display.MovieClipKeyframe(json.keyframes[ii],prevKf);
		this.keyframes[ii] = prevKf;
	}
};
$hxClasses["com.cmm.common.display.MovieClipLayer"] = com.cmm.common.display.MovieClipLayer;
com.cmm.common.display.MovieClipLayer.__name__ = ["com","cmm","common","display","MovieClipLayer"];
com.cmm.common.display.MovieClipLayer.prototype = {
	get_frames: function() {
		var lastKf = this.keyframes[this.keyframes.length - 1];
		return lastKf.index + Std["int"](lastKf.duration);
	}
	,__class__: com.cmm.common.display.MovieClipLayer
}
com.cmm.common.display.MovieClipKeyframe = function(json,prevKf) {
	this.ease = 0;
	this.tweened = true;
	this.visible = true;
	this.alpha = 1;
	this.pivotY = 0;
	this.pivotX = 0;
	this.skewY = 0;
	this.skewX = 0;
	this.scaleY = 1;
	this.scaleX = 1;
	this.y = 0;
	this.x = 0;
	this.symbol = null;
	this.index = prevKf != null?prevKf.index + prevKf.duration:0;
	this.duration = json.duration;
	this.label = json.label;
	this.symbolName = json.ref;
	var loc = json.loc;
	if(loc != null) {
		this.x = loc[0];
		this.y = loc[1];
	}
	var scale = json.scale;
	if(scale != null) {
		this.scaleX = scale[0];
		this.scaleY = scale[1];
	}
	var skew = json.skew;
	if(skew != null) {
		this.skewX = skew[0];
		this.skewY = skew[1];
	}
	var pivot = json.pivot;
	if(pivot != null) {
		this.pivotX = pivot[0];
		this.pivotY = pivot[1];
	}
	if(json.alpha != null) this.alpha = json.alpha;
	if(json.visible != null) this.visible = json.visible;
	if(json.tweened != null) this.tweened = json.tweened;
	if(json.ease != null) this.ease = json.ease;
};
$hxClasses["com.cmm.common.display.MovieClipKeyframe"] = com.cmm.common.display.MovieClipKeyframe;
com.cmm.common.display.MovieClipKeyframe.__name__ = ["com","cmm","common","display","MovieClipKeyframe"];
com.cmm.common.display.MovieClipKeyframe.prototype = {
	__class__: com.cmm.common.display.MovieClipKeyframe
}
com.cmm.common.display.BUTTON_STATE = $hxClasses["com.cmm.common.display.BUTTON_STATE"] = { __ename__ : ["com","cmm","common","display","BUTTON_STATE"], __constructs__ : ["UP","DOWN","DISABLED","HIGHLIGHT","OVER"] }
com.cmm.common.display.BUTTON_STATE.UP = ["UP",0];
com.cmm.common.display.BUTTON_STATE.UP.toString = $estr;
com.cmm.common.display.BUTTON_STATE.UP.__enum__ = com.cmm.common.display.BUTTON_STATE;
com.cmm.common.display.BUTTON_STATE.DOWN = ["DOWN",1];
com.cmm.common.display.BUTTON_STATE.DOWN.toString = $estr;
com.cmm.common.display.BUTTON_STATE.DOWN.__enum__ = com.cmm.common.display.BUTTON_STATE;
com.cmm.common.display.BUTTON_STATE.DISABLED = ["DISABLED",2];
com.cmm.common.display.BUTTON_STATE.DISABLED.toString = $estr;
com.cmm.common.display.BUTTON_STATE.DISABLED.__enum__ = com.cmm.common.display.BUTTON_STATE;
com.cmm.common.display.BUTTON_STATE.HIGHLIGHT = ["HIGHLIGHT",3];
com.cmm.common.display.BUTTON_STATE.HIGHLIGHT.toString = $estr;
com.cmm.common.display.BUTTON_STATE.HIGHLIGHT.__enum__ = com.cmm.common.display.BUTTON_STATE;
com.cmm.common.display.BUTTON_STATE.OVER = ["OVER",4];
com.cmm.common.display.BUTTON_STATE.OVER.toString = $estr;
com.cmm.common.display.BUTTON_STATE.OVER.__enum__ = com.cmm.common.display.BUTTON_STATE;
com.cmm.common.display.TextureSprite = function(symbol) {
	com.cmm.common.display.SpriteContainer.call(this);
	this.symbol = symbol;
	this.anchorX.set__(symbol.anchorX);
	this.anchorY.set__(symbol.anchorY);
};
$hxClasses["com.cmm.common.display.TextureSprite"] = com.cmm.common.display.TextureSprite;
com.cmm.common.display.TextureSprite.__name__ = ["com","cmm","common","display","TextureSprite"];
com.cmm.common.display.TextureSprite.__super__ = com.cmm.common.display.SpriteContainer;
com.cmm.common.display.TextureSprite.prototype = $extend(com.cmm.common.display.SpriteContainer.prototype,{
	getNaturalHeight: function() {
		return this.symbol.height;
	}
	,getNaturalWidth: function() {
		return this.symbol.width;
	}
	,draw: function(g) {
		g.drawSubImage(this.symbol.atlas,0,0,this.symbol.x,this.symbol.y,this.symbol.width,this.symbol.height);
	}
	,__class__: com.cmm.common.display.TextureSprite
});
com.cmm.common.display.TextureSpriteSymbol = function(json,atlas) {
	this._name = json.symbol;
	this.atlas = atlas;
	var rect = json.rect;
	this.x = rect[0];
	this.y = rect[1];
	this.width = rect[2];
	this.height = rect[3];
	var origin = json.origin;
	if(origin != null) {
		this.anchorX = origin[0];
		this.anchorY = origin[1];
	} else {
		this.anchorX = 0;
		this.anchorY = 0;
	}
};
$hxClasses["com.cmm.common.display.TextureSpriteSymbol"] = com.cmm.common.display.TextureSpriteSymbol;
com.cmm.common.display.TextureSpriteSymbol.__name__ = ["com","cmm","common","display","TextureSpriteSymbol"];
com.cmm.common.display.TextureSpriteSymbol.__interfaces__ = [flambe.swf.Symbol];
com.cmm.common.display.TextureSpriteSymbol.prototype = {
	get_name: function() {
		return this._name;
	}
	,createSprite: function() {
		return new com.cmm.common.display.TextureSprite(this);
	}
	,__class__: com.cmm.common.display.TextureSpriteSymbol
}
com.cmm.common.event.CMMEvent = function(eType,pdata,isNew) {
	if(isNew == null) isNew = true;
	com.cmm.common.event.Event.call(this,eType,pdata,isNew);
};
$hxClasses["com.cmm.common.event.CMMEvent"] = com.cmm.common.event.CMMEvent;
com.cmm.common.event.CMMEvent.__name__ = ["com","cmm","common","event","CMMEvent"];
com.cmm.common.event.CMMEvent.__super__ = com.cmm.common.event.Event;
com.cmm.common.event.CMMEvent.prototype = $extend(com.cmm.common.event.Event.prototype,{
	toString: function() {
		return com.cmm.common.event.Event.prototype.toString.call(this);
	}
	,clone: function() {
		return new com.cmm.common.event.CMMEvent(this.type,this.data,false);
	}
	,__class__: com.cmm.common.event.CMMEvent
});
com.cmm.common.event.EDispatcher = function() { }
$hxClasses["com.cmm.common.event.EDispatcher"] = com.cmm.common.event.EDispatcher;
com.cmm.common.event.EDispatcher.__name__ = ["com","cmm","common","event","EDispatcher"];
com.cmm.common.event.EDispatcher.addEventListener = function(type,listener) {
	if(com.cmm.common.event.EDispatcher._signals.exists(type) == false) com.cmm.common.event.EDispatcher._signals.set(type,new flambe.util.Signal1());
	var sConn = com.cmm.common.event.EDispatcher._signals.get(type).connect(listener);
	if(com.cmm.common.event.EDispatcher._signalConnections.exists(type) == false) com.cmm.common.event.EDispatcher._signalConnections.set(type,new Array());
	com.cmm.common.event.EDispatcher._signalConnections.get(type).push(sConn);
}
com.cmm.common.event.EDispatcher.dispatchEvent = function(event) {
	if(com.cmm.common.event.EDispatcher._signals.exists(event.type)) com.cmm.common.event.EDispatcher._signals.get(event.type).emit(event);
}
com.cmm.common.event.EDispatcher.removeEventListener = function(type,listener) {
	if(com.cmm.common.event.EDispatcher._signalConnections.exists(type)) {
		var _g1 = 0, _g = com.cmm.common.event.EDispatcher._signalConnections.get(type).length;
		while(_g1 < _g) {
			var i = _g1++;
			if(Reflect.compareMethods(listener,com.cmm.common.event.EDispatcher._signalConnections.get(type)[i]._internal_listener)) {
				com.cmm.common.event.EDispatcher._signalConnections.get(type)[i].dispose();
				com.cmm.common.event.EDispatcher._signalConnections.get(type).splice(i,1);
				return;
			}
		}
	}
}
com.cmm.common.io = {}
com.cmm.common.io.LoadMaster = function() {
};
$hxClasses["com.cmm.common.io.LoadMaster"] = com.cmm.common.io.LoadMaster;
com.cmm.common.io.LoadMaster.__name__ = ["com","cmm","common","io","LoadMaster"];
com.cmm.common.io.LoadMaster.loadBatch = function(packIDs,onSuccess) {
	if(com.cmm.common.io.LoadMaster.loadMC != null) com.cmm.common.app.Wrapper.instance.get_gameLayer().addChild(com.cmm.common.io.LoadMaster.loadMC);
	var assetPackLoader = new flambe.platform.BasicAssetPackLoader(null,null);
	assetPackLoader = new flambe.platform.html.HtmlAssetPackLoader(flambe.platform.html.HtmlPlatform.instance,null);
	assetPackLoader.getAssetFormats(com.cmm.common.io.LoadMaster.getSupportedAudioFormats);
	com.cmm.common.io.LoadMaster._onSuccess = onSuccess;
	com.cmm.common.io.LoadMaster._batchQueue = packIDs.split(",");
	com.cmm.common.io.LoadMaster._bytesTotal = com.cmm.common.io.LoadMaster._bytesLoaded = 0;
	var _g = 0, _g1 = com.cmm.common.io.LoadMaster._batchQueue;
	while(_g < _g1.length) {
		var packID = _g1[_g];
		++_g;
		com.cmm.common.io.LoadMaster._manifestHash.set(packID,flambe.asset.Manifest.build(packID));
		var $it0 = com.cmm.common.io.LoadMaster._manifestHash.get(packID).iterator();
		while( $it0.hasNext() ) {
			var assetEntry = $it0.next();
			if(com.cmm.common.io.LoadMaster.isAudioFormat(assetEntry.format)) {
				var _g2 = 0, _g3 = com.cmm.common.io.LoadMaster._supportedAudioFormats;
				while(_g2 < _g3.length) {
					var format = _g3[_g2];
					++_g2;
					if(assetEntry.format == format) {
						if(com.cmm.common.io.LoadMaster.shouldCountAudioFileInLoad(assetEntry,packID)) {
							com.cmm.common.io.LoadMaster._bytesTotal += assetEntry.bytes;
							console.log("ADDING BYTES - NEW TOTAL = " + com.cmm.common.io.LoadMaster._bytesTotal + " " + assetEntry.url);
							break;
						}
					}
				}
			} else {
				com.cmm.common.io.LoadMaster._bytesTotal += assetEntry.bytes;
				console.log("ADDING BYTES - NEW TOTAL = " + com.cmm.common.io.LoadMaster._bytesTotal + " " + assetEntry.url);
			}
		}
	}
	com.cmm.common.io.LoadMaster.loadPack(com.cmm.common.io.LoadMaster._batchQueue.shift());
}
com.cmm.common.io.LoadMaster.isAudioFormat = function(format) {
	if(format == flambe.asset.AssetFormat.MP3 || format == flambe.asset.AssetFormat.M4A || format == flambe.asset.AssetFormat.OGG || format == flambe.asset.AssetFormat.WAV) return true;
	return false;
}
com.cmm.common.io.LoadMaster.getSupportedAudioFormats = function(supportedFormats) {
	com.cmm.common.io.LoadMaster._supportedAudioFormats = new Array();
	var _g = 0;
	while(_g < supportedFormats.length) {
		var format = supportedFormats[_g];
		++_g;
		if(com.cmm.common.io.LoadMaster.isAudioFormat(format)) com.cmm.common.io.LoadMaster._supportedAudioFormats.push(format);
	}
}
com.cmm.common.io.LoadMaster.shouldCountAudioFileInLoad = function(checkEntry,packID) {
	if(checkEntry.format == flambe.asset.AssetFormat.MP3) return true; else {
		var $it0 = com.cmm.common.io.LoadMaster._manifestHash.get(packID).iterator();
		while( $it0.hasNext() ) {
			var assetEntry = $it0.next();
			if(checkEntry.name == assetEntry.name && com.cmm.common.io.LoadMaster.getAudioFormatPriority(checkEntry.format) < com.cmm.common.io.LoadMaster.getAudioFormatPriority(assetEntry.format)) return false;
		}
		return true;
	}
}
com.cmm.common.io.LoadMaster.getAudioFormatPriority = function(format) {
	if(com.cmm.common.io.LoadMaster.isAudioFormat(format)) {
		switch( (format)[1] ) {
		case 5:
			return 3;
		case 6:
			return 2;
		case 7:
			return 1;
		case 8:
			return 0;
		default:
			return 0;
		}
	}
	return 0;
}
com.cmm.common.io.LoadMaster.loadPack = function(packID) {
	console.log("LOADMASTER: Loading batch " + packID);
	com.cmm.common.io.LoadMaster._currentBatchBytesLoaded = 0;
	var loader = flambe.System.loadAssetPack(com.cmm.common.io.LoadMaster._manifestHash.get(packID));
	loader.progressChanged.connect(function() {
		com.cmm.common.io.LoadMaster._bytesLoaded -= com.cmm.common.io.LoadMaster._currentBatchBytesLoaded;
		com.cmm.common.io.LoadMaster._currentBatchBytesLoaded += loader.get_progress() - com.cmm.common.io.LoadMaster._currentBatchBytesLoaded;
		com.cmm.common.io.LoadMaster._bytesLoaded += com.cmm.common.io.LoadMaster._currentBatchBytesLoaded;
		if(com.cmm.common.io.LoadMaster.loadMC != null) {
			var frame = Math.ceil(com.cmm.common.io.LoadMaster._bytesLoaded / com.cmm.common.io.LoadMaster._bytesTotal * 100);
			com.cmm.common.io.LoadMaster.loadMC.gotoAndStop(Math.max(1,Math.min(frame,com.cmm.common.io.LoadMaster.loadMC.get_totalFrames())));
		}
		console.log(com.cmm.common.io.LoadMaster._bytesLoaded / com.cmm.common.io.LoadMaster._bytesTotal);
	});
	loader.get(function(pack) {
		com.cmm.common.io.LoadMaster._assetPackHash.set(packID,pack);
		com.cmm.common.utils.LibraryTools.addLibrariesFromAssetPack(com.cmm.common.io.LoadMaster._assetPackHash.get(packID));
		if(com.cmm.common.io.LoadMaster._batchQueue.length > 0) com.cmm.common.io.LoadMaster.loadPack(com.cmm.common.io.LoadMaster._batchQueue.shift()); else if(com.cmm.common.io.LoadMaster._onSuccess != null) {
			if(com.cmm.common.io.LoadMaster.loadMC != null) com.cmm.common.app.Wrapper.instance.get_gameLayer().removeChild(com.cmm.common.io.LoadMaster.loadMC);
			com.cmm.common.io.LoadMaster._onSuccess(packID);
		}
	});
}
com.cmm.common.io.LoadMaster.getAssetPack = function(assetPackID) {
	if(com.cmm.common.io.LoadMaster._assetPackHash.exists(assetPackID)) return com.cmm.common.io.LoadMaster._assetPackHash.get(assetPackID);
	throw "LoadMaster.hx getAssetPack: assetPack with " + assetPackID + " does not exist.";
	return null;
}
com.cmm.common.io.LoadMaster.getSound = function(packID,assetID) {
	return com.cmm.common.io.LoadMaster._assetPackHash.get(packID).getSound(assetID);
}
com.cmm.common.io.LoadMaster.getTexture = function(packID,assetID) {
	return com.cmm.common.io.LoadMaster._assetPackHash.get(packID).getTexture(assetID);
}
com.cmm.common.io.LoadMaster.getXML = function(packID,assetID) {
	return Xml.parse(com.cmm.common.io.LoadMaster.getAssetAsString(packID,assetID));
}
com.cmm.common.io.LoadMaster.getJSON = function(packID,assetID) {
	return haxe.Json.parse(com.cmm.common.io.LoadMaster.getAssetAsString(packID,assetID));
}
com.cmm.common.io.LoadMaster.getAssetAsString = function(packID,assetID) {
	return com.cmm.common.io.LoadMaster._assetPackHash.get(packID).getFile(assetID);
}
com.cmm.common.io.LoadMaster.prototype = {
	__class__: com.cmm.common.io.LoadMaster
}
com.cmm.common.text = {}
com.cmm.common.text.DynamicTextLibrary = function() {
};
$hxClasses["com.cmm.common.text.DynamicTextLibrary"] = com.cmm.common.text.DynamicTextLibrary;
com.cmm.common.text.DynamicTextLibrary.__name__ = ["com","cmm","common","text","DynamicTextLibrary"];
com.cmm.common.text.DynamicTextLibrary.createLibrary = function(json) {
	var dtf = json;
	com.cmm.common.text.DynamicTextLibrary.settings = dtf.settings;
	if(com.cmm.common.io.LoadMaster.getAssetPack("config").getFile("fonts/fonts.css",false) != null) {
		var ss = js.Lib.document.createElement("link");
		ss.type = "text/css";
		ss.rel = "stylesheet";
		ss.href = "assets/config/fonts/fonts.css";
		js.Lib.document.getElementsByTagName("head")[0].appendChild(ss);
	}
	var _g = 0, _g1 = dtf.strings;
	while(_g < _g1.length) {
		var string = _g1[_g];
		++_g;
		com.cmm.common.text.DynamicTextLibrary._txtDict.set(string.id,string);
	}
}
com.cmm.common.text.DynamicTextLibrary.getFormat = function(txtID) {
	return com.cmm.common.text.DynamicTextLibrary._txtDict.get(txtID);
}
com.cmm.common.text.DynamicTextLibrary.prototype = {
	__class__: com.cmm.common.text.DynamicTextLibrary
}
com.cmm.common.text.DynamicTextSprite = function(id) {
	this._textRotation = 0;
	this._lineSpacing = 0;
	this._fontSize = 0;
	com.cmm.common.display.SpriteContainer.call(this);
	if(id != null) this._format = com.cmm.common.text.DynamicTextLibrary.getFormat(id); else this._format = { id : null, style : { fontFamily : "Times New Roman", fontSize : "12px", textAlign : "left", verticalAlign : "top", lineSpacing : "0px", fontStyle : "normal", fontVariant : "normal", fontWeight : "normal", color : "#000000", rotation : 0, stroke : "#000000", lineWidth : 1}, textMetrics : { top : 0, left : 0, width : 100, height : 100}, text : ""};
	if(com.cmm.common.text.DynamicTextLibrary.settings.useDeviceFonts) this.set_fontFamily("sans-serif");
	this.updateFontProps();
	this._textArray = this._format.text.split("<br/>");
	if(id != null) this.compose();
};
$hxClasses["com.cmm.common.text.DynamicTextSprite"] = com.cmm.common.text.DynamicTextSprite;
com.cmm.common.text.DynamicTextSprite.__name__ = ["com","cmm","common","text","DynamicTextSprite"];
com.cmm.common.text.DynamicTextSprite.__super__ = com.cmm.common.display.SpriteContainer;
com.cmm.common.text.DynamicTextSprite.prototype = $extend(com.cmm.common.display.SpriteContainer.prototype,{
	updateFontProps: function() {
		this._font = "";
		if(this._format.style.fontStyle != null) this._font += this._format.style.fontStyle + " ";
		if(this._format.style.fontVariant != null) this._font += this._format.style.fontVariant + " ";
		if(this._format.style.fontWeight != null) this._font += this._format.style.fontWeight + " ";
		if(this._format.style.lineSpacing != null) this._lineSpacing = Std.parseFloat(this._format.style.lineSpacing);
		if(this._format.style.rotation != null) this._textRotation = this._format.style.rotation;
		this._font += this._format.style.fontSize + " " + this._format.style.fontFamily;
		this._fontSize = Std.parseInt(this._format.style.fontSize);
		var text = js.Lib.document.createElement("span");
		text.innerHTML = "Hg";
		text.style.font = this._font;
		var block = js.Lib.document.createElement("div");
		block.style.display = "inline-block";
		block.style.width = "1px";
		block.style.height = "0px";
		var div = js.Lib.document.createElement("div");
		div.appendChild(text);
		div.appendChild(block);
		js.Lib.document.body.appendChild(div);
		block.style.verticalAlign = "bottom";
		this.lineHeight = block.offsetTop - text.offsetTop;
		js.Lib.document.body.removeChild(div);
	}
	,set_lineWidth: function(value) {
		this._format.style.lineWidth = value;
		this.updateFontProps();
		return this._format.style.lineWidth;
	}
	,get_lineWidth: function() {
		return this._format.style.lineWidth;
	}
	,set_strokeColor: function(value) {
		this._format.style.stroke = StringTools.hex(value,6);
		this.updateFontProps();
		return Std.parseInt(this._format.style.stroke);
	}
	,get_strokeColor: function() {
		return Std.parseInt(this._format.style.stroke);
	}
	,set_textRotation: function(value) {
		this._textRotation = value;
		return this._textRotation;
	}
	,get_textRotation: function() {
		return this._textRotation;
	}
	,set_text: function(value) {
		this._format.text = value;
		this._format.text = StringTools.replace(this._format.text,"\n","<br/>");
		this._textArray = this._format.text.split("<br/>");
		return this._format.text;
	}
	,get_text: function() {
		return this._format.text;
	}
	,set_textMetrics: function(value) {
		this._format.textMetrics = value;
		return this._format.textMetrics;
	}
	,get_textMetrics: function() {
		return this._format.textMetrics;
	}
	,set_color: function(value) {
		this._format.style.color = StringTools.hex(value,6);
		this.updateFontProps();
		return Std.parseInt(this._format.style.color);
	}
	,get_color: function() {
		var retColor = StringTools.replace(this._format.style.color,"#","0x");
		return Std.parseInt(retColor);
	}
	,set_fontWeight: function(value) {
		this._format.style.fontWeight = value;
		this.updateFontProps();
		return this._format.style.fontWeight;
	}
	,get_fontWeight: function() {
		return this._format.style.fontWeight;
	}
	,set_fontVariant: function(value) {
		this._format.style.fontVariant = value;
		this.updateFontProps();
		return this._format.style.fontVariant;
	}
	,get_fontVariant: function() {
		return this._format.style.fontVariant;
	}
	,set_fontStyle: function(value) {
		this._format.style.fontStyle = value;
		this.updateFontProps();
		return this._format.style.fontStyle;
	}
	,get_fontStyle: function() {
		return this._format.style.fontStyle;
	}
	,set_lineSpacing: function(value) {
		this._format.style.lineSpacing = Std.string(value) + "px";
		this.updateFontProps();
		return Std.parseFloat(this._format.style.lineSpacing);
	}
	,get_lineSpacing: function() {
		return Std.parseFloat(this._format.style.lineSpacing);
	}
	,set_verticalAlign: function(value) {
		this._format.style.verticalAlign = value;
		this.updateFontProps();
		return this._format.style.verticalAlign;
	}
	,get_verticalAlign: function() {
		return this._format.style.verticalAlign;
	}
	,set_textAlign: function(value) {
		this._format.style.textAlign = value;
		this.updateFontProps();
		return this._format.style.textAlign;
	}
	,get_textAlign: function() {
		return this._format.style.textAlign;
	}
	,set_fontSize: function(value) {
		this._format.style.fontSize = Std.string(value) + "px";
		this.updateFontProps();
		return Std.parseInt(this._format.style.fontSize);
	}
	,get_fontSize: function() {
		return Std.parseInt(this._format.style.fontSize);
	}
	,set_fontFamily: function(value) {
		this._format.style.fontFamily = value;
		this.updateFontProps();
		return this._format.style.fontFamily;
	}
	,get_fontFamily: function() {
		return this._format.style.fontFamily;
	}
	,draw: function(g) {
		this._canvas = js.Lib.document.getElementById("content-canvas");
		this._ctx = this._canvas.getContext("2d");
		this._ctx.font = this._font;
		if(this._format.style.stroke != null) {
			this._ctx.strokeStyle = this._format.style.stroke;
			this._ctx.lineWidth = this._format.style.lineWidth;
		}
		this._ctx.fillStyle = this._format.style.color;
		this._ctx.textBaseline = "top";
		var verticalAlign = 0;
		var textHeight = this._textArray.length * this.lineHeight + (this._textArray.length - 1) * this.get_lineSpacing();
		var textHalfHeight = textHeight * 0.5;
		var textBoxHalfHeight = this.get_textMetrics().height * 0.5;
		if(this._format.style.verticalAlign == "center") verticalAlign = textBoxHalfHeight - textHalfHeight; else if(this._format.style.verticalAlign == "bottom") verticalAlign = this.get_textMetrics().height - textHeight; else verticalAlign = 0;
		var yAdjust = 0;
		if(this._format.style.textAlign == "center") {
			var _g1 = 0, _g = this._textArray.length;
			while(_g1 < _g) {
				var i = _g1++;
				var halfWidth = this._ctx.measureText(this._textArray[i]).width * 0.5;
				yAdjust = i > 0?this._lineSpacing * i:0;
				if(this._format.style.stroke != null) this._ctx.strokeText(this._textArray[i],this._format.textMetrics.left + this._format.textMetrics.width * 0.5 - halfWidth,this._format.textMetrics.top + verticalAlign + i * this.lineHeight + yAdjust);
				this._ctx.fillText(this._textArray[i],this._format.textMetrics.left + this._format.textMetrics.width * 0.5 - halfWidth,this._format.textMetrics.top + verticalAlign + i * this.lineHeight + yAdjust);
			}
		} else if(this._format.style.textAlign == "right") {
			var _g1 = 0, _g = this._textArray.length;
			while(_g1 < _g) {
				var i = _g1++;
				var width = this._ctx.measureText(this._textArray[i]).width;
				yAdjust = i > 0?this._lineSpacing * i:0;
				if(this._format.style.stroke != null) this._ctx.strokeText(this._textArray[i],this._format.textMetrics.left + this._format.textMetrics.width - width,this._format.textMetrics.top + verticalAlign + i * this.lineHeight + yAdjust);
				this._ctx.fillText(this._textArray[i],this._format.textMetrics.left + this._format.textMetrics.width - width,this._format.textMetrics.top + verticalAlign + i * this.lineHeight + yAdjust);
			}
		} else {
			var _g1 = 0, _g = this._textArray.length;
			while(_g1 < _g) {
				var i = _g1++;
				yAdjust = i > 0?this._lineSpacing * i:0;
				if(this._format.style.stroke != null) this._ctx.strokeText(this._textArray[i],this._format.textMetrics.left,this._format.textMetrics.top + verticalAlign + i * this.lineHeight + yAdjust);
				this._ctx.fillText(this._textArray[i],this._format.textMetrics.left,this._format.textMetrics.top + verticalAlign + i * this.lineHeight + yAdjust);
			}
		}
	}
	,onAddedToStage: function() {
		com.cmm.common.display.SpriteContainer.prototype.onAddedToStage.call(this);
		if(this._components != null) {
			var _g = 0, _g1 = this._components;
			while(_g < _g1.length) {
				var component = _g1[_g];
				++_g;
				this.owner.add(component);
			}
		}
	}
	,compose: function() {
		if(this._components == null) this._components = [];
		var compositionObject = com.cmm.common.app.CompositionFactory.getCompositionObjectByClassName(this._format.id);
		if(compositionObject != null) {
			var _g = 0, _g1 = compositionObject.components;
			while(_g < _g1.length) {
				var componentClass = _g1[_g];
				++_g;
				this._components.push(Type.createInstance(componentClass,[this._format.id,compositionObject.params]));
			}
		}
	}
	,__class__: com.cmm.common.text.DynamicTextSprite
});
com.cmm.common.text.TextAlign = function() { }
$hxClasses["com.cmm.common.text.TextAlign"] = com.cmm.common.text.TextAlign;
com.cmm.common.text.TextAlign.__name__ = ["com","cmm","common","text","TextAlign"];
com.cmm.common.text.VerticalAlign = function() { }
$hxClasses["com.cmm.common.text.VerticalAlign"] = com.cmm.common.text.VerticalAlign;
com.cmm.common.text.VerticalAlign.__name__ = ["com","cmm","common","text","VerticalAlign"];
com.cmm.common.utils = {}
com.cmm.common.utils.ArrayUtil = function() {
};
$hxClasses["com.cmm.common.utils.ArrayUtil"] = com.cmm.common.utils.ArrayUtil;
com.cmm.common.utils.ArrayUtil.__name__ = ["com","cmm","common","utils","ArrayUtil"];
com.cmm.common.utils.ArrayUtil.indexOf = function(item,arr) {
	var _g1 = 0, _g = arr.length;
	while(_g1 < _g) {
		var i = _g1++;
		if(arr[i] == item) return i;
	}
	return -1;
}
com.cmm.common.utils.ArrayUtil.prototype = {
	__class__: com.cmm.common.utils.ArrayUtil
}
com.cmm.common.utils.DelayPrompt = function() {
};
$hxClasses["com.cmm.common.utils.DelayPrompt"] = com.cmm.common.utils.DelayPrompt;
com.cmm.common.utils.DelayPrompt.__name__ = ["com","cmm","common","utils","DelayPrompt"];
com.cmm.common.utils.DelayPrompt.addPrompt = function(timeInSec,onFireFunc,mouseListenerTarget) {
	com.cmm.common.utils.DelayPrompt.stop();
	com.cmm.common.utils.DelayPrompt._timeout = timeInSec * 1000;
	com.cmm.common.utils.DelayPrompt._onFireFunc = onFireFunc;
	if(mouseListenerTarget != null) com.cmm.common.utils.DelayPrompt._triggers.push(new com.cmm.common.utils._DelayPrompt.DelayPromptListener(mouseListenerTarget,true,true,true));
}
com.cmm.common.utils.DelayPrompt.start = function() {
	com.cmm.common.utils.DelayPrompt.destroyTimer();
	if(com.cmm.common.utils.DelayPrompt._onFireFunc != null) {
		com.cmm.common.utils.DelayPrompt._timer = haxe.Timer.delay(com.cmm.common.utils.DelayPrompt._onFireFunc,com.cmm.common.utils.DelayPrompt._timeout);
		if(com.cmm.common.utils.DelayPrompt._triggers.length > 0) {
			var _g1 = 0, _g = com.cmm.common.utils.DelayPrompt._triggers.length;
			while(_g1 < _g) {
				var i = _g1++;
				if(com.cmm.common.utils.DelayPrompt._triggers[i] != null) {
					if(com.cmm.common.utils.DelayPrompt._triggers[i].moveEnabled) com.cmm.common.utils.DelayPrompt._triggers[i].addMoveEventListener(com.cmm.common.utils.DelayPrompt.reset);
					if(com.cmm.common.utils.DelayPrompt._triggers[i].downEnabled) com.cmm.common.utils.DelayPrompt._triggers[i].addDownEventListener(com.cmm.common.utils.DelayPrompt.reset);
					if(com.cmm.common.utils.DelayPrompt._triggers[i].upEnabled) com.cmm.common.utils.DelayPrompt._triggers[i].addUpEventListener(com.cmm.common.utils.DelayPrompt.reset);
				}
			}
		}
	}
}
com.cmm.common.utils.DelayPrompt.destroyTimer = function() {
	if(com.cmm.common.utils.DelayPrompt._timer != null) {
		com.cmm.common.utils.DelayPrompt._timer.run = null;
		com.cmm.common.utils.DelayPrompt._timer.stop();
		com.cmm.common.utils.DelayPrompt._timer = null;
	}
}
com.cmm.common.utils.DelayPrompt.stop = function() {
	com.cmm.common.utils.DelayPrompt.destroyTimer();
	if(com.cmm.common.utils.DelayPrompt._triggers.length > 0) {
		var _g1 = 0, _g = com.cmm.common.utils.DelayPrompt._triggers.length;
		while(_g1 < _g) {
			var i = _g1++;
			if(com.cmm.common.utils.DelayPrompt._triggers[i] != null) com.cmm.common.utils.DelayPrompt._triggers[i].removeAllMoveEventListeners();
		}
	}
}
com.cmm.common.utils.DelayPrompt.reset = function() {
	com.cmm.common.utils.DelayPrompt.stop();
	com.cmm.common.utils.DelayPrompt.start();
}
com.cmm.common.utils.DelayPrompt.destroy = function() {
	com.cmm.common.utils.DelayPrompt._onFireFunc = null;
	com.cmm.common.utils.DelayPrompt._timeout = 0;
	com.cmm.common.utils.DelayPrompt.stop();
	while(com.cmm.common.utils.DelayPrompt._triggers.length > 0) com.cmm.common.utils.DelayPrompt._triggers.pop();
}
com.cmm.common.utils.DelayPrompt.prototype = {
	__class__: com.cmm.common.utils.DelayPrompt
}
com.cmm.common.utils._DelayPrompt = {}
com.cmm.common.utils._DelayPrompt.DelayPromptListener = function(listener,moveEnabled,upEnabled,downEnabled) {
	if(downEnabled == null) downEnabled = false;
	if(upEnabled == null) upEnabled = false;
	if(moveEnabled == null) moveEnabled = false;
	this.downEnabled = false;
	this.upEnabled = false;
	this.moveEnabled = false;
	this._listener = listener;
	this._signalConnections = new Array();
	this.moveEnabled = moveEnabled;
	this.upEnabled = upEnabled;
	this.downEnabled = downEnabled;
};
$hxClasses["com.cmm.common.utils._DelayPrompt.DelayPromptListener"] = com.cmm.common.utils._DelayPrompt.DelayPromptListener;
com.cmm.common.utils._DelayPrompt.DelayPromptListener.__name__ = ["com","cmm","common","utils","_DelayPrompt","DelayPromptListener"];
com.cmm.common.utils._DelayPrompt.DelayPromptListener.prototype = {
	removeAllMoveEventListeners: function() {
		var _g1 = 0, _g = this._signalConnections.length;
		while(_g1 < _g) {
			var i = _g1++;
			this._signalConnections[i].dispose();
		}
	}
	,addUpEventListener: function(onPromptFunc) {
		this._signalConnections.push(this._listener.get_pointerUp().connect(function(_) {
			onPromptFunc();
		}));
	}
	,addDownEventListener: function(onPromptFunc) {
		this._signalConnections.push(this._listener.get_pointerDown().connect(function(_) {
			onPromptFunc();
		}));
	}
	,addMoveEventListener: function(onPromptFunc) {
		this._signalConnections.push(this._listener.get_pointerMove().connect(function(_) {
			onPromptFunc();
		}));
	}
	,__class__: com.cmm.common.utils._DelayPrompt.DelayPromptListener
}
com.cmm.common.utils.LibraryTools = function() { }
$hxClasses["com.cmm.common.utils.LibraryTools"] = com.cmm.common.utils.LibraryTools;
com.cmm.common.utils.LibraryTools.__name__ = ["com","cmm","common","utils","LibraryTools"];
com.cmm.common.utils.LibraryTools.addLibrary = function(lib) {
	if(com.cmm.common.utils.LibraryTools._libraries == null) com.cmm.common.utils.LibraryTools._libraries = new Hash();
	com.cmm.common.utils.LibraryTools._libraries.set(lib.name,lib);
}
com.cmm.common.utils.LibraryTools.addLibrariesFromAssetPack = function(pack) {
	var fileDirectory = new Array();
	var assetPackPath = "";
	var $it0 = pack.get_manifest().iterator();
	while( $it0.hasNext() ) {
		var entry = $it0.next();
		var libraryFileIdx = entry.name.indexOf("library.json");
		if(libraryFileIdx > -1) com.cmm.common.utils.LibraryTools.addLibrary(new com.cmm.common.display.FlumpLibrary(pack,entry.name.substring(0,libraryFileIdx - 1)));
	}
}
com.cmm.common.utils.LibraryTools.createLibraryItem = function(className,libraryName) {
	if(libraryName != null) {
		if(com.cmm.common.utils.LibraryTools._libraries.exists(libraryName)) return com.cmm.common.utils.LibraryTools._libraries.get(libraryName).createSprite(className);
		console.log("LibrayTools.hx: getLibraryItem: libraryName " + libraryName + " is not tied to a valid library.");
		return null;
	} else {
		var symbol = null;
		var retSymbol = null;
		var foundLibraries = new Array();
		if(com.cmm.common.utils.LibraryTools._libraries == null) return null;
		var $it0 = com.cmm.common.utils.LibraryTools._libraries.iterator();
		while( $it0.hasNext() ) {
			var lib = $it0.next();
			symbol = lib.getSymbol(className);
			if(symbol != null) {
				retSymbol = symbol;
				foundLibraries.push(lib.name);
			}
		}
		if(retSymbol == null) {
			console.log("LibrayTools.hx createLibraryItem(): className " + className + " could not be found in any libraries.");
			return null;
		} else {
			if(foundLibraries.length > 1) throw "LibrayTools.hx createLibraryItem(): symbol " + className + " was found multiple times in the following libraries: " + Std.string(foundLibraries);
			return retSymbol.createSprite();
		}
	}
}
com.cmm.common.utils.LibraryTools.createMovieClip = function(className,libraryName) {
	return com.cmm.common.utils.LibraryTools.createLibraryItem(className,libraryName);
}
com.cmm.common.utils.PointerUtil = function() {
};
$hxClasses["com.cmm.common.utils.PointerUtil"] = com.cmm.common.utils.PointerUtil;
com.cmm.common.utils.PointerUtil.__name__ = ["com","cmm","common","utils","PointerUtil"];
com.cmm.common.utils.PointerUtil.get_globalPointerX = function() {
	return (flambe.System.get_pointer().get_x() - Main.GLOBAL_OFFSET.x) / Main.GLOBAL_SCALE;
}
com.cmm.common.utils.PointerUtil.get_globalPointerY = function() {
	return (flambe.System.get_pointer().get_y() - Main.GLOBAL_OFFSET.y) / Main.GLOBAL_SCALE;
}
com.cmm.common.utils.PointerUtil.get_globalPointerPoint = function() {
	return new flambe.math.Point(com.cmm.common.utils.PointerUtil.get_globalPointerX(),com.cmm.common.utils.PointerUtil.get_globalPointerY());
}
com.cmm.common.utils.PointerUtil.prototype = {
	__class__: com.cmm.common.utils.PointerUtil
}
com.cmm.common.utils.StringUtil = function() {
};
$hxClasses["com.cmm.common.utils.StringUtil"] = com.cmm.common.utils.StringUtil;
com.cmm.common.utils.StringUtil.__name__ = ["com","cmm","common","utils","StringUtil"];
com.cmm.common.utils.StringUtil.returnNumbers = function(string,asFloat) {
	if(asFloat == null) asFloat = true;
	var r = new EReg("[^0-9]+","g");
	var numString = r.replace(string,"");
	if(asFloat) return Std.parseFloat(numString);
	return numString;
}
com.cmm.common.utils.StringUtil.prototype = {
	__class__: com.cmm.common.utils.StringUtil
}
com.cmm.common.utils.browserDetect = {}
com.cmm.common.utils.browserDetect.BrowserDetect = function() { }
$hxClasses["com.cmm.common.utils.browserDetect.BrowserDetect"] = com.cmm.common.utils.browserDetect.BrowserDetect;
com.cmm.common.utils.browserDetect.BrowserDetect.__name__ = ["com","cmm","common","utils","browserDetect","BrowserDetect"];
com.cmm.common.utils.browserDetect.BrowserDetect.init = function() {
	var ua = js.Lib.window.navigator.userAgent;
	var firefoxIdx = ua.indexOf("Firefox");
	var chromeIdx = ua.indexOf("Chrome");
	var chromeIdx2 = ua.indexOf("CriOS");
	var safariIdx = ua.indexOf("Safari");
	var ieIdx = ua.indexOf("MSIE");
	var operaIdx = ua.indexOf("Opera");
	var ieIdx11 = ua.indexOf("rv");
	var mobileOperaIdx = ua.indexOf("OPR");
	var chromiumIdx = ua.indexOf("Chromium");
	var seamonkeyIdx = ua.indexOf("Seamonkey");
	var silkIdx = ua.indexOf("Silk");
	if(firefoxIdx > -1) {
		if(seamonkeyIdx < 0) {
			com.cmm.common.utils.browserDetect.BrowserDetect.browserType = "Firefox";
			com.cmm.common.utils.browserDetect.BrowserDetect.browserVersion = com.cmm.common.utils.browserDetect.BrowserDetect.getBrowserVersion(firefoxIdx);
		}
	} else if(chromeIdx > -1 || chromeIdx2 > -1) {
		if(chromiumIdx < 0 && mobileOperaIdx < 0) {
			com.cmm.common.utils.browserDetect.BrowserDetect.browserType = "Chrome";
			com.cmm.common.utils.browserDetect.BrowserDetect.browserVersion = com.cmm.common.utils.browserDetect.BrowserDetect.getBrowserVersion(chromeIdx);
		}
	} else if(silkIdx > -1) {
		com.cmm.common.utils.browserDetect.BrowserDetect.browserType = "Silk";
		com.cmm.common.utils.browserDetect.BrowserDetect.browserVersion = com.cmm.common.utils.browserDetect.BrowserDetect.getBrowserVersion(silkIdx);
	} else if(safariIdx > -1) {
		if(chromiumIdx < 0 && chromeIdx < 0) {
			com.cmm.common.utils.browserDetect.BrowserDetect.browserType = "Safari";
			var versionIdx = ua.indexOf("Version");
			com.cmm.common.utils.browserDetect.BrowserDetect.browserVersion = com.cmm.common.utils.browserDetect.BrowserDetect.getBrowserVersion(versionIdx);
		}
	} else if(ieIdx > -1) {
		com.cmm.common.utils.browserDetect.BrowserDetect.browserType = "MSIE";
		com.cmm.common.utils.browserDetect.BrowserDetect.browserVersion = com.cmm.common.utils.browserDetect.BrowserDetect.getBrowserVersion(ieIdx," ");
	} else if(operaIdx > -1) {
		com.cmm.common.utils.browserDetect.BrowserDetect.browserType = "Opera";
		var versionIdx = ua.indexOf("Version");
		com.cmm.common.utils.browserDetect.BrowserDetect.browserVersion = com.cmm.common.utils.browserDetect.BrowserDetect.getBrowserVersion(versionIdx);
	} else if(ieIdx11 > -1) {
		com.cmm.common.utils.browserDetect.BrowserDetect.browserType = "MSIE";
		com.cmm.common.utils.browserDetect.BrowserDetect.browserVersion = com.cmm.common.utils.browserDetect.BrowserDetect.getBrowserVersion(ieIdx11,":");
	}
	if(ua.indexOf("Windows") > -1) com.cmm.common.utils.browserDetect.BrowserDetect.platformType = "Windows"; else if(ua.indexOf("iPad") > -1 || ua.indexOf("iPhone") > -1 || ua.indexOf("iPod") > -1) {
		com.cmm.common.utils.browserDetect.BrowserDetect.platformType = "iOS";
		com.cmm.common.utils.browserDetect.BrowserDetect.platformVersion = Std.parseFloat(StringTools.replace(HxOverrides.substr(ua,ua.indexOf("OS ") + 3,3),"_","."));
	} else if(ua.indexOf("Mac") > -1) com.cmm.common.utils.browserDetect.BrowserDetect.platformType = "Mac"; else if(ua.indexOf("Android") > -1) {
		com.cmm.common.utils.browserDetect.BrowserDetect.platformType = "Android";
		com.cmm.common.utils.browserDetect.BrowserDetect.platformVersion = Std.parseFloat(HxOverrides.substr(ua,ua.indexOf("Android") + 8,3));
	} else if(ua.indexOf("Linux") > -1) com.cmm.common.utils.browserDetect.BrowserDetect.platformType = "Linux";
	if(ua.indexOf("Mobi") > -1 || com.cmm.common.utils.browserDetect.BrowserDetect.platformType == "Android" || com.cmm.common.utils.browserDetect.BrowserDetect.platformType == "iOS" || com.cmm.common.utils.browserDetect.BrowserDetect.browserType == "Silk") com.cmm.common.utils.browserDetect.BrowserDetect.isMobile = true;
	if(com.cmm.common.utils.browserDetect.BrowserDetect.browserType == "Silk") flambe.platform.html.HtmlAssetPackLoader.set_detectBlobSupport(false);
	if(ua.indexOf("iPhone") > -1 || ua.indexOf("iPod") > -1) {
		console.log("IPHONE " + Std.string(flambe.System.get_stage().orientation));
		console.log(flambe.System.get_stage().get_width() + " x " + flambe.System.get_stage().get_height());
		console.log(flambe.System.get_stage().fullscreen);
		var window = js.Lib.window;
		console.log(window.devicePixelRatio);
		if(flambe.System.get_stage().orientation.get__() == flambe.display.Orientation.Landscape) {
			if(flambe.System.get_stage().get_width() == 960) {
				com.cmm.common.utils.browserDetect.BrowserDetect.iPhone4 = true;
				com.cmm.common.utils.browserDetect.BrowserDetect.iPhoneVersion = 4;
			} else com.cmm.common.utils.browserDetect.BrowserDetect.iPhoneVersion = 5;
		} else if(flambe.System.get_stage().get_height() == 832) {
			com.cmm.common.utils.browserDetect.BrowserDetect.iPhone4 = true;
			com.cmm.common.utils.browserDetect.BrowserDetect.iPhoneVersion = 4;
		} else com.cmm.common.utils.browserDetect.BrowserDetect.iPhoneVersion = 5;
	}
}
com.cmm.common.utils.browserDetect.BrowserDetect.getBrowserVersion = function(startIdx,key) {
	if(key == null) key = "/";
	var ua = js.Lib.window.navigator.userAgent;
	var versionIdx = ua.indexOf(key,startIdx);
	var whiteSpaceIdx = ua.indexOf(" ",versionIdx + 1);
	whiteSpaceIdx = whiteSpaceIdx < 0?ua.length - 1:whiteSpaceIdx;
	var versionString = ua.substring(versionIdx + 1,whiteSpaceIdx);
	var periodIdx = versionString.indexOf(".");
	if(periodIdx > -1) {
		var period2Idx = versionString.indexOf(".",periodIdx + 1);
		if(period2Idx > -1) versionString = versionString.substring(0,period2Idx);
	}
	console.log(versionString);
	return Std.parseFloat(versionString);
}
com.cmm.mmc = {}
com.cmm.mmc.MMC = function() {
	com.cmm.common.app.Wrapper.call(this);
};
$hxClasses["com.cmm.mmc.MMC"] = com.cmm.mmc.MMC;
com.cmm.mmc.MMC.__name__ = ["com","cmm","mmc","MMC"];
com.cmm.mmc.MMC.__super__ = com.cmm.common.app.Wrapper;
com.cmm.mmc.MMC.prototype = $extend(com.cmm.common.app.Wrapper.prototype,{
	init: function() {
		com.cmm.common.app.Wrapper.prototype.init.call(this);
		var sm = new com.cmm.common.app.StateMachine(new com.cmm.mmc.app.MainStateList());
		sm.startMachine();
	}
	,__class__: com.cmm.mmc.MMC
});
com.cmm.mmc.app = {}
com.cmm.mmc.app.EndGameState = function() {
	com.cmm.common.app.State.call(this);
};
$hxClasses["com.cmm.mmc.app.EndGameState"] = com.cmm.mmc.app.EndGameState;
com.cmm.mmc.app.EndGameState.__name__ = ["com","cmm","mmc","app","EndGameState"];
com.cmm.mmc.app.EndGameState.__super__ = com.cmm.common.app.State;
com.cmm.mmc.app.EndGameState.prototype = $extend(com.cmm.common.app.State.prototype,{
	stateComplete: function() {
		com.cmm.common.utils.DelayPrompt.destroy();
		com.cmm.common.app.State.prototype.stateComplete.call(this);
	}
	,playVO: function() {
		if (this._voCounter == 1) {
		 	com.cmm.common.audio.SoundPlayerRemote.play("MMC_38",$bind(this,this.playVO))
		}
		this._voCounter++;
	}
	,enterState: function() {
		com.cmm.common.app.State.prototype.enterState.call(this);
		com.cmm.common.app.SceneManager.playScene("mc_endScene",$bind(this,this.stateComplete));
		this._scene = com.cmm.common.app.SceneManager.get_currentScene();
		this._scene.stop();
		this.nextState = "com.cmm.mmc.app.GameState";
		this._voCounter = 1;
		this.playVO();
	}
	,__class__: com.cmm.mmc.app.EndGameState
});
com.cmm.mmc.app.GameState = function() {
	com.cmm.common.app.State.call(this);
};
$hxClasses["com.cmm.mmc.app.GameState"] = com.cmm.mmc.app.GameState;
com.cmm.mmc.app.GameState.__name__ = ["com","cmm","mmc","app","GameState"];
com.cmm.mmc.app.GameState.prepareAllCoasters = function() {
	var coasterSettings;
	coasterSettings = com.cmm.common.io.LoadMaster.getJSON("config","Coaster1.json");
	com.cmm.mmc.app.GameState._presetCoaster1 = new Array();
	var _g1 = 0, _g = coasterSettings.pieces.length;
	while(_g1 < _g) {
		var i = _g1++;
		com.cmm.mmc.app.GameState._presetCoaster1.push(coasterSettings.pieces[i].type);
		com.cmm.mmc.app.GameState._presetCoaster1.push(coasterSettings.pieces[i].xPos);
		com.cmm.mmc.app.GameState._presetCoaster1.push(coasterSettings.pieces[i].yPos);
	}
	coasterSettings = com.cmm.common.io.LoadMaster.getJSON("config","Coaster2.json");
	com.cmm.mmc.app.GameState._presetCoaster2 = new Array();
	var _g1 = 0, _g = coasterSettings.pieces.length;
	while(_g1 < _g) {
		var i = _g1++;
		com.cmm.mmc.app.GameState._presetCoaster2.push(coasterSettings.pieces[i].type);
		com.cmm.mmc.app.GameState._presetCoaster2.push(coasterSettings.pieces[i].xPos);
		com.cmm.mmc.app.GameState._presetCoaster2.push(coasterSettings.pieces[i].yPos);
	}
	coasterSettings = com.cmm.common.io.LoadMaster.getJSON("config","Coaster3.json");
	com.cmm.mmc.app.GameState._presetCoaster3 = new Array();
	var _g1 = 0, _g = coasterSettings.pieces.length;
	while(_g1 < _g) {
		var i = _g1++;
		com.cmm.mmc.app.GameState._presetCoaster3.push(coasterSettings.pieces[i].type);
		com.cmm.mmc.app.GameState._presetCoaster3.push(coasterSettings.pieces[i].xPos);
		com.cmm.mmc.app.GameState._presetCoaster3.push(coasterSettings.pieces[i].yPos);
	}
	coasterSettings = com.cmm.common.io.LoadMaster.getJSON("config","Coaster4.json");
	com.cmm.mmc.app.GameState._presetCoaster4 = new Array();
	var _g1 = 0, _g = coasterSettings.pieces.length;
	while(_g1 < _g) {
		var i = _g1++;
		com.cmm.mmc.app.GameState._presetCoaster4.push(coasterSettings.pieces[i].type);
		com.cmm.mmc.app.GameState._presetCoaster4.push(coasterSettings.pieces[i].xPos);
		com.cmm.mmc.app.GameState._presetCoaster4.push(coasterSettings.pieces[i].yPos);
	}
	coasterSettings = com.cmm.common.io.LoadMaster.getJSON("config","Coaster5.json");
	com.cmm.mmc.app.GameState._presetCoaster5 = new Array();
	var _g1 = 0, _g = coasterSettings.pieces.length;
	while(_g1 < _g) {
		var i = _g1++;
		com.cmm.mmc.app.GameState._presetCoaster5.push(coasterSettings.pieces[i].type);
		com.cmm.mmc.app.GameState._presetCoaster5.push(coasterSettings.pieces[i].xPos);
		com.cmm.mmc.app.GameState._presetCoaster5.push(coasterSettings.pieces[i].yPos);
	}
	coasterSettings = com.cmm.common.io.LoadMaster.getJSON("config","Coaster6.json");
	com.cmm.mmc.app.GameState._presetCoaster6 = new Array();
	var _g1 = 0, _g = coasterSettings.pieces.length;
	while(_g1 < _g) {
		var i = _g1++;
		com.cmm.mmc.app.GameState._presetCoaster6.push(coasterSettings.pieces[i].type);
		com.cmm.mmc.app.GameState._presetCoaster6.push(coasterSettings.pieces[i].xPos);
		com.cmm.mmc.app.GameState._presetCoaster6.push(coasterSettings.pieces[i].yPos);
	}
	coasterSettings = com.cmm.common.io.LoadMaster.getJSON("config","Coaster7.json");
	com.cmm.mmc.app.GameState._presetCoaster7 = new Array();
	var _g1 = 0, _g = coasterSettings.pieces.length;
	while(_g1 < _g) {
		var i = _g1++;
		com.cmm.mmc.app.GameState._presetCoaster7.push(coasterSettings.pieces[i].type);
		com.cmm.mmc.app.GameState._presetCoaster7.push(coasterSettings.pieces[i].xPos);
		com.cmm.mmc.app.GameState._presetCoaster7.push(coasterSettings.pieces[i].yPos);
	}
}
com.cmm.mmc.app.GameState.__super__ = com.cmm.common.app.State;
com.cmm.mmc.app.GameState.prototype = $extend(com.cmm.common.app.State.prototype,{
	stateComplete: function() {
		this.stopVO();
		com.cmm.common.event.EDispatcher.removeEventListener("com.cmm.activityEngines.customBuilder.event.builderComponentSelected",$bind(this,this.componentSelected));
		com.cmm.common.event.EDispatcher.removeEventListener("launcher_click",$bind(this,this.prepareLaunch));
		com.cmm.common.event.EDispatcher.removeEventListener("piece_down",$bind(this,this.pieceDown));
		com.cmm.common.event.EDispatcher.removeEventListener("piece_up",$bind(this,this.pieceUp));
		this.removeAllPieces();
		com.cmm.mmc.app.gameState.PhysicsController.finish();
		com.cmm.common.app.State.prototype.stateComplete.call(this);
	}
	,resetEndScreen: function(e) {
		console.log("resetEndScreen");
		this._endMC.get_parent().removeChild(this._endMC);
		com.cmm.common.utils.DelayPrompt.destroy();
		com.cmm.common.utils.DelayPrompt.addPrompt(26,com.cmm.mmc.app.gameState.GameVOPlayer.playDelayPrompt);
		com.cmm.common.utils.DelayPrompt.start();
		this.stopVO();
	}
	,confirmedNo: function(e) {
		this._clearConfirmation.gotoAndStop("hide");
		this._resetConfirmation.gotoAndStop("hide");
		this.stopVO();
	}
	,confirmedYes: function(e) {
		this._clearConfirmation.gotoAndStop("hide");
		this._resetConfirmation.gotoAndStop("hide");
		this.removeAllPieces();
		if(com.cmm.mmc.app.GameState._presetCoasterPieces.length > 0) this.assembleCoaster();
		this.stopVO();
	}
	,showResetConfirmation: function() {
		if(this._coasterModified) {
			this._resetConfirmation.gotoAndStop("show");
			com.cmm.common.audio.SoundPlayerRemote.play("MMC_52");
		} else {
			this.removeAllPieces();
			if(com.cmm.mmc.app.GameState._presetCoasterPieces.length > 0) this.assembleCoaster();
		}
	}
	,showClearConfirmation: function(e) {
		if(this._pieces.length > 0) {
			this._clearConfirmation.gotoAndStop("show");
			com.cmm.common.audio.SoundPlayerRemote.play("MMC_48");
		}
	}
	,stopVO: function() {
		com.cmm.common.audio.SoundPlayerRemote.stopChannel("vo");
	}
	,showHelp: function(e) {
		if(this._tutorial.get_currentFrame() == this._tutorial.get_totalFrames()) {
			this._tutorial.gotoAndPlay("help",this._tutorial.get_totalFrames(),0);
			this._tutorialUpdateComponent = new com.cmm.mmc.app.customTools.UpdateComponent($bind(this,this.checkTutorialStatus));
			this._tutorial.owner.add(this._tutorialUpdateComponent);
			com.cmm.common.audio.SoundPlayerRemote.muteChannel("vo");
			this._interruptTutorial = false;
			this._showTutorialCoaster = false;
		}
	}
	,createPhysicsWorld: function() {
		com.cmm.mmc.app.gameState.PhysicsController.start();
	}
	,resetBall: function() {
		this._launcherMc.gotoAndStop("vaccuum_start");
		this._windMc.gotoAndStop(1);
		this._launcherMc.gotoAndStop("ready_to_launch");
		this._launcherBtn.set_pointerEnabled(true);
		com.cmm.common.audio.SoundPlayerRemote.play("suckBack2");
	}
	,setBallPosition: function(f) {
		if(this._animatedBall.x.get__() < 285 || this._animatedBall.x.get__() > 295 || this._animatedBall.y.get__() < 55 || this._animatedBall.y.get__() > 65) {
			if(this._animatedBall.x.get__() < 285 || this._animatedBall.x.get__() > 295) {
				var _g = this._animatedBall.x;
				_g.set__(_g.get__() - (this._originalX - 290) * 0.02);
			}
			if(this._animatedBall.y.get__() < 55 || this._animatedBall.y.get__() > 65) {
				var _g = this._animatedBall.y;
				_g.set__(_g.get__() - (this._originalY - 60) * 0.02);
			}
		} else {
			this._ballLayer.removeChild(this._animatedBall);
			this._animatedBall.owner.remove(this._ballUpdateComponent);
			this._ballUpdateComponent = null;
			this.resetBall();
		}
	}
	,retrieveBall: function(e) {
		this._launcherMc.gotoAndPlay("vaccuum_start","vaccuum_stop",3,false);
		this._windMc.gotoAndPlay(1,this._windMc.get_totalFrames(),3,false);
		this._animatedBall = com.cmm.common.utils.LibraryTools.createMovieClip("mc_ball");
		this._ballUpdateComponent = new com.cmm.mmc.app.customTools.UpdateComponent($bind(this,this.setBallPosition));
		this._animatedBall.owner.add(this._ballUpdateComponent);
		this._animatedBall.x.set__(com.cmm.common.display.MovieClip.getFrom(com.cmm.mmc.app.gameState.PhysicsController._ball).x.get__());
		this._animatedBall.y.set__(com.cmm.common.display.MovieClip.getFrom(com.cmm.mmc.app.gameState.PhysicsController._ball).y.get__());
		this._animatedBall.rotation.set__(com.cmm.common.display.MovieClip.getFrom(com.cmm.mmc.app.gameState.PhysicsController._ball).rotation.get__());
		this._ballLayer.addChild(this._animatedBall);
		this._originalX = this._animatedBall.x.get__();
		this._originalY = this._animatedBall.y.get__();
		com.cmm.mmc.app.gameState.PhysicsController.removeBall();
		this._launcherBtn.set_pointerEnabled(false);
		this._resetTimer.stop();
		this._resetTimer = null;
		if(e != null && this._launches % 2 == 0) com.cmm.mmc.app.gameState.GameVOPlayer.ballRetieved(true); else com.cmm.mmc.app.gameState.GameVOPlayer.ballRetieved(false);
		this._launches++;
		com.cmm.common.audio.SoundPlayerRemote.play("suckBack1");
	}
	,timesUp: function() {
		this.retrieveBall(new com.cmm.common.event.Event("times_up"));
	}
	,animateLauncher: function() {
		this._launcherBtn.gotoAndPlay("down","disabled",0);
	}
	,launchBall: function() {
		haxe.Timer.delay($bind(this,this.animateLauncher),10);
		if(this._launcherMc.get_currentFrame() == 1) {
			com.cmm.mmc.app.gameState.PhysicsController.addBall();
			com.cmm.mmc.app.gameState.GameVOPlayer.ballLaunched();
			this._launcherMc.gotoAndStop("launched");
			this._resetTimer = new haxe.Timer(60000);
			this._resetTimer.run = $bind(this,this.timesUp);
		} else if(this._launcherMc.get_currentFrame() == 2) this.retrieveBall(null);
		this._readyToLaunch = false;
	}
	,prepareLaunch: function(e) {
		this._readyToLaunch = true;
	}
	,removeAllPieces: function() {
		if(this._launcherMc.get_currentFrame() == 2) this.retrieveBall(null);
		var _g1 = 0, _g = this._pieces.length;
		while(_g1 < _g) {
			var i = _g1++;
			com.cmm.mmc.app.gameState.PhysicsController.removePiece(0);
			this._pieceLayer.removeChild(this._pieces[i]).dispose();
		}
		this._pieces = new Array();
		com.cmm.mmc.app.gameState.GameVOPlayer.setPromptIndex(this._pieces.length);
		this._coasterModified = false;
		var _g = 1;
		while(_g < 8) {
			var i = _g++;
			var coasterBtn = js.Boot.__cast(this._scene.getChildByName("mc_coastersScroller").getChildByName("btn_coaster" + i) , com.cmm.common.display.MovieClipButton);
			coasterBtn.enable();
		}
	}
	,removePiece: function() {
		var _g1 = 0, _g = this._pieces.length;
		while(_g1 < _g) {
			var i = _g1++;
			if(this._pieces[i].get_instanceName() == this._activePiece.get_instanceName()) {
				com.cmm.mmc.app.gameState.PhysicsController.removePiece(i * 2);
				this._pieceLayer.removeChild(this._pieces[i]).dispose();
				HxOverrides.remove(this._pieces,this._pieces[i]);
				break;
			}
		}
	}
	,pieceUp: function(e) {
	}
	,pieceDown: function(e) {
		if(this._activePiece == null) {
			this._pieceUpdateComponent = new com.cmm.mmc.app.customTools.UpdateComponent($bind(this,this.setPiecePosition));
			var _g1 = 0, _g = this._pieces.length;
			while(_g1 < _g) {
				var i = _g1++;
				if(this._pieces[i].get_instanceName() == e.data) {
					com.cmm.mmc.app.gameState.PhysicsController.removePiece(i * 2);
					this._activePiece = this._pieces[i];
					this._scene.addChild(this._activePiece);
					this._activePiece.owner.add(this._pieceUpdateComponent);
					var _g2 = 1;
					while(_g2 < 8) {
						var i1 = _g2++;
						var coasterBtn = js.Boot.__cast(this._scene.getChildByName("mc_coastersScroller").getChildByName("btn_coaster" + i1) , com.cmm.common.display.MovieClipButton);
						coasterBtn.enable();
					}
				}
			}
		}
	}
	,collisionEffect: function(e) {
		var index = e.data;
		var _g1 = 0, _g = this._pieces.length;
		while(_g1 < _g) {
			var i = _g1++;
			var piece = this._pieces[i];
			var pieceNumber = Std.parseInt(com.cmm.common.utils.StringUtil.returnNumbers(piece.get_className()));
			if(index == i * 2) {
				if(Type.getClass(piece.getChildByName("graphic")) == com.cmm.common.display.MovieClip) {
					var animation = js.Boot.__cast(piece.getChildByName("graphic") , com.cmm.common.display.MovieClip);
					if(pieceNumber >= 23 && pieceNumber <= 25 && animation.get_currentFrame() != 1) {
					} else {
						animation.gotoAndPlay(1,animation.get_totalFrames(),0,true);
						com.cmm.mmc.app.gameState.GameVOPlayer.playCollisionAudio(pieceNumber);
						var _g3 = 0, _g2 = animation.get_numChildren();
						while(_g3 < _g2) {
							var j = _g3++;
							if(Type.getClass(animation.getChildAt(j)) == com.cmm.common.display.MovieClip) {
								var childAnimation = js.Boot.__cast(animation.getChildAt(j) , com.cmm.common.display.MovieClip);
								childAnimation.gotoAndPlay(1,childAnimation.get_totalFrames(),0,true);
							}
						}
					}
				}
				var physicsSettings = com.cmm.common.io.LoadMaster.getJSON("config","PhysicsSettings.json");
				if(pieceNumber == 17) com.cmm.mmc.app.gameState.BodyComponent.getFrom(com.cmm.mmc.app.gameState.PhysicsController._ball).setVelocity(physicsSettings.conveyorRight.velocityX,physicsSettings.conveyorRight.velocityY); else if(pieceNumber == 18) com.cmm.mmc.app.gameState.BodyComponent.getFrom(com.cmm.mmc.app.gameState.PhysicsController._ball).setVelocity(physicsSettings.conveyorDown.velocityX,physicsSettings.conveyorDown.velocityY); else if(pieceNumber == 19) com.cmm.mmc.app.gameState.BodyComponent.getFrom(com.cmm.mmc.app.gameState.PhysicsController._ball).setVelocity(physicsSettings.conveyorLeft.velocityX,physicsSettings.conveyorLeft.velocityY); else if(pieceNumber == 20) com.cmm.mmc.app.gameState.BodyComponent.getFrom(com.cmm.mmc.app.gameState.PhysicsController._ball).setVelocity(physicsSettings.conveyorUp.velocityX,physicsSettings.conveyorUp.velocityY);
				if(pieceNumber >= 1 && pieceNumber <= 22) com.cmm.mmc.app.gameState.GameVOPlayer.playCollisionAudio(pieceNumber);
			}
		}
	}
	,presetPiece: function(pieceNumber,xPos,yPos) {
		var component = pieceNumber;
		var pieceType = "btn_piece1";
		if(component >= 1 && component <= 25) {
			pieceType = "mc_piece" + component;
			this._activePiece = com.cmm.common.utils.LibraryTools.createMovieClip(pieceType);
			this._pieceLayer.addChild(this._activePiece);
			this._activePiece.x.set__(xPos);
			this._activePiece.y.set__(yPos);
			this._pieces.push(this._activePiece);
			this.repositionPiece();
			this.checkBoundary();
		}
	}
	,assembleCoaster: function() {
		var _g1 = 0, _g = com.cmm.mmc.app.GameState._presetCoasterPieces.length;
		while(_g1 < _g) {
			var i = _g1++;
			if(i % 3 == 0) this.presetPiece(com.cmm.mmc.app.GameState._presetCoasterPieces[i],com.cmm.mmc.app.GameState._presetCoasterPieces[i + 1],com.cmm.mmc.app.GameState._presetCoasterPieces[i + 2]);
		}
		com.cmm.mmc.app.GameState._presetCoasterPieces = new Array();
		this._activePiece = null;
		this._coasterModified = false;
		var coasterBtn = js.Boot.__cast(this._scene.getChildByName("mc_coastersScroller").getChildByName("btn_coaster" + this._coasterNumber) , com.cmm.common.display.MovieClipButton);
		coasterBtn.disable();
	}
	,createCoaster: function(e) {
		this._coasterNumber = e.data;
		com.cmm.mmc.app.GameState._presetCoasterPieces = new Array();
		if(this._coasterNumber == 1) com.cmm.mmc.app.GameState._presetCoasterPieces = com.cmm.mmc.app.GameState._presetCoaster1; else if(this._coasterNumber == 2) com.cmm.mmc.app.GameState._presetCoasterPieces = com.cmm.mmc.app.GameState._presetCoaster2; else if(this._coasterNumber == 3) com.cmm.mmc.app.GameState._presetCoasterPieces = com.cmm.mmc.app.GameState._presetCoaster3; else if(this._coasterNumber == 4) com.cmm.mmc.app.GameState._presetCoasterPieces = com.cmm.mmc.app.GameState._presetCoaster4; else if(this._coasterNumber == 5) com.cmm.mmc.app.GameState._presetCoasterPieces = com.cmm.mmc.app.GameState._presetCoaster5; else if(this._coasterNumber == 6) com.cmm.mmc.app.GameState._presetCoasterPieces = com.cmm.mmc.app.GameState._presetCoaster6; else if(this._coasterNumber == 7) com.cmm.mmc.app.GameState._presetCoasterPieces = com.cmm.mmc.app.GameState._presetCoaster7;
		if(this._pieces.length > 0) this.showResetConfirmation(); else {
			this.removeAllPieces();
			this.assembleCoaster();
		}
	}
	,showPieceAndPosition: function() {
		console.log("\nLatest piece info:");
		console.log("type = " + Std.string(com.cmm.common.utils.StringUtil.returnNumbers(this._activePiece.get_className())));
		console.log("xPos = " + this._activePiece.x.get__());
		console.log("yPos = " + this._activePiece.y.get__() + "\n");
	}
	,checkBoundary: function() {
		var placementArea = js.Boot.__cast(this._scene.getChildByName("placementArea") , flambe.display.Sprite);
		var boundary = flambe.display.Sprite.getBounds(placementArea.owner);
		var piece = js.Boot.__cast(this._activePiece.getChildByName("hit") , flambe.display.Sprite);
		var hitZone = flambe.display.Sprite.getBounds(piece.owner);
		var shouldRemovePiece = true;
		if(boundary.contains(this._activePiece.x.get__(),this._activePiece.y.get__()) || boundary.contains(this._activePiece.x.get__() + hitZone.width,this._activePiece.y.get__()) || boundary.contains(this._activePiece.x.get__(),this._activePiece.y.get__() + hitZone.height) || boundary.contains(this._activePiece.x.get__() + hitZone.width,this._activePiece.y.get__() + hitZone.height)) shouldRemovePiece = false;
		com.cmm.mmc.app.gameState.PhysicsController.addPiece(this._activePiece.x.get__(),this._activePiece.y.get__(),Std.parseInt(com.cmm.common.utils.StringUtil.returnNumbers(this._activePiece.get_className())));
		if(shouldRemovePiece) this.removePiece();
		com.cmm.mmc.app.gameState.GameVOPlayer.setPromptIndex(this._pieces.length);
		return !shouldRemovePiece;
	}
	,repositionPiece: function() {
		var x = this._activePiece.x.get__();
		var y = this._activePiece.y.get__();
		var gridX = 270;
		var gridXMax = 910;
		var gridY = 15;
		var gridYMax = 575;
		var adjustmentX = 0;
		var adjustmentY = 0;
		while(gridX <= gridXMax) {
			if(x >= gridX - 20 && x <= gridX + 20) x = gridX;
			gridX += 40;
		}
		while(gridY <= gridYMax) {
			if(y >= gridY - 20 && y <= gridY + 20) y = gridY;
			gridY += 40;
		}
		if(x > 150 && x < 270) x = 270; else if(x > 910 && x < 1100) x = 910;
		if(y > -100 && y < 15) y = 15; else if(y > 575 && y < 700) y = 575;
		if(x > 830 && y > 495) {
			x = 870;
			y = 535;
		}
		this._activePiece.x.set__(x + adjustmentX);
		this._activePiece.y.set__(y + adjustmentY);
	}
	,setPiecePosition: function(f) {
		if(flambe.System.get_pointer().isDown() || this._clickAndStickActive == true) this._activePiece.setXY(com.cmm.common.utils.PointerUtil.get_globalPointerX(),com.cmm.common.utils.PointerUtil.get_globalPointerY()); else {
			this._pieceLayer.addChild(this._activePiece);
			this._activePiece.owner.remove(this._pieceUpdateComponent);
			this._pieceUpdateComponent = null;
			if(this._newPiece) {
				this._pieces.push(this._activePiece);
				this._newPiece = false;
			} else {
				var _g1 = 0, _g = this._pieces.length;
				while(_g1 < _g) {
					var i = _g1++;
					if(this._pieces[i].get_instanceName() == this._activePiece.get_instanceName()) {
						HxOverrides.remove(this._pieces,this._pieces[i]);
						this._pieces.push(this._activePiece);
						break;
					}
				}
			}
			this.repositionPiece();
			if(this.checkBoundary()) com.cmm.mmc.app.gameState.GameVOPlayer.playPlacementVO(com.cmm.common.utils.StringUtil.returnNumbers(this._activePiece.get_className()),this._pieces.length);
			this.showPieceAndPosition();
			this._clickAndDragActive = false;
			this._clickAndStickActive = false;
			this._activePiece = null;
			this._coasterModified = true;
		}
	}
	,swipeAborted: function(e) {
		com.cmm.common.event.EDispatcher.removeEventListener("swipeDetected",$bind(this,this.swipeDetected));
		com.cmm.common.event.EDispatcher.removeEventListener("swipeAborted",$bind(this,this.swipeAborted));
		this._activePiece.set_visible(true);
	}
	,swipeDetected: function(e) {
		com.cmm.common.event.EDispatcher.removeEventListener("swipeDetected",$bind(this,this.swipeDetected));
		com.cmm.common.event.EDispatcher.removeEventListener("swipeAborted",$bind(this,this.swipeAborted));
	}
	,componentSelected: function(e) {
		var component = e.data;
		var pieceType = "btn_piece1";
		if(component >= 1 && component <= 25) {
			pieceType = "mc_piece" + component;
			this._activePiece = com.cmm.common.utils.LibraryTools.createMovieClip(pieceType);
			this._newPiece = true;
			this._activePiece.set_visible(false);
			this._pieceUpdateComponent = new com.cmm.mmc.app.customTools.UpdateComponent($bind(this,this.setPiecePosition));
			this._activePiece.owner.add(this._pieceUpdateComponent);
			this._scene.addChild(this._activePiece);
			com.cmm.common.event.EDispatcher.addEventListener("swipeDetected",$bind(this,this.swipeDetected));
			com.cmm.common.event.EDispatcher.addEventListener("swipeAborted",$bind(this,this.swipeAborted));
		}
	}
	,checkPosition: function() {
		if(flambe.System.get_pointer().get_x() == this._xPos && flambe.System.get_pointer().get_y() == this._yPos) {
			this._clickAndStickActive = true;
			this._clickAndDragActive = false;
			if(com.cmm.common.utils.browserDetect.BrowserDetect.isMobile == true) this._clickAndStickActive = false;
		}
	}
	,getPosition: function() {
		if(!this._clickAndStickActive) {
			this._xPos = flambe.System.get_pointer().get_x();
			this._yPos = flambe.System.get_pointer().get_y();
		}
		this._clickAndDragActive = true;
		this._clickAndStickActive = false;
	}
	,checkTutorialStatus: function(f) {
		if(this._tutorial.get_currentFrame() == 215 && !this._interruptTutorial) {
			var piecesScroller = js.Boot.__cast(this._scene.getChildByName("mc_piecesScroller") , com.cmm.common.display.MovieClip);
			var coastersScroller = js.Boot.__cast(this._scene.getChildByName("mc_coastersScroller") , com.cmm.common.display.MovieClip);
			var piecesSwitch1 = js.Boot.__cast(piecesScroller.getChildByName("btn_piecesSwitch") , com.cmm.common.display.MovieClipButton);
			var piecesSwitch2 = js.Boot.__cast(coastersScroller.getChildByName("btn_piecesSwitch") , com.cmm.common.display.MovieClipButton);
			var coastersSwitch1 = js.Boot.__cast(piecesScroller.getChildByName("btn_coastersSwitch") , com.cmm.common.display.MovieClipButton);
			var coastersSwitch2 = js.Boot.__cast(coastersScroller.getChildByName("btn_coastersSwitch") , com.cmm.common.display.MovieClipButton);
			if(this._scene.getChildIndex(coastersScroller) < this._scene.getChildIndex(piecesScroller)) {
				piecesSwitch1.enable();
				piecesSwitch2.enable();
				coastersSwitch2.disable();
				this._scene.swapChildren(piecesScroller,coastersScroller);
				com.cmm.mmc.app.gameState.GameVOPlayer._ignoreAlternatePrompt = true;
			}
		} else if(this._tutorial.get_currentFrame() == 250 && !this._interruptTutorial && this._showTutorialCoaster) {
			this.createCoaster(new com.cmm.common.event.Event("new_coaster",2));
			console.log("new coaster");
		} else if(this._tutorial.get_currentFrame() == 335 && !this._interruptTutorial) {
			var piecesScroller = js.Boot.__cast(this._scene.getChildByName("mc_piecesScroller") , com.cmm.common.display.MovieClip);
			var coastersScroller = js.Boot.__cast(this._scene.getChildByName("mc_coastersScroller") , com.cmm.common.display.MovieClip);
			var piecesSwitch1 = js.Boot.__cast(piecesScroller.getChildByName("btn_piecesSwitch") , com.cmm.common.display.MovieClipButton);
			var piecesSwitch2 = js.Boot.__cast(coastersScroller.getChildByName("btn_piecesSwitch") , com.cmm.common.display.MovieClipButton);
			var coastersSwitch1 = js.Boot.__cast(piecesScroller.getChildByName("btn_coastersSwitch") , com.cmm.common.display.MovieClipButton);
			var coastersSwitch2 = js.Boot.__cast(coastersScroller.getChildByName("btn_coastersSwitch") , com.cmm.common.display.MovieClipButton);
			if(this._scene.getChildIndex(piecesScroller) < this._scene.getChildIndex(coastersScroller)) {
				piecesSwitch1.disable();
				coastersSwitch1.enable();
				coastersSwitch2.enable();
				this._scene.swapChildren(piecesScroller,coastersScroller);
				com.cmm.mmc.app.gameState.GameVOPlayer._ignoreAlternatePrompt = false;
			}
		} else if(this._tutorial.get_currentFrame() == 855 && !this._interruptTutorial) this._launcherBtn.gotoAndStop("over"); else if(this._tutorial.get_currentFrame() == 890 && !this._interruptTutorial) this._launcherBtn.gotoAndStop("up"); else if(this._tutorial.get_currentFrame() == this._tutorial.get_totalFrames()) {
			com.cmm.common.audio.SoundPlayerRemote.unmuteChannel("vo");
			this._tutorial.owner.remove(this._tutorialUpdateComponent);
			this._tutorialUpdateComponent = null;
		}
		if(this._interruptTutorial) this._tutorial.gotoAndStop(this._tutorial.get_totalFrames());
	}
	,setTutorial: function() {
		this._tutorial = js.Boot.__cast(this._scene.getChildByName("mc_tutorial") , com.cmm.common.display.MovieClip);
		var showTutorial = flambe.System.get_storage().get("firstPlay",true);
		if(showTutorial) {
			this._tutorial.gotoAndPlay("tutorial",this._tutorial.get_totalFrames(),0);
			this._tutorialUpdateComponent = new com.cmm.mmc.app.customTools.UpdateComponent($bind(this,this.checkTutorialStatus));
			this._tutorial.owner.add(this._tutorialUpdateComponent);
			com.cmm.mmc.app.gameState.GameVOPlayer.playGameIntro();
			com.cmm.common.audio.SoundPlayerRemote.muteChannel("vo");
			this._interruptTutorial = false;
			this._showTutorialCoaster = true;
		} else {
			this.createCoaster(new com.cmm.common.event.Event("new_coaster",2));
			this._tutorial.gotoAndStop("hide");
			com.cmm.mmc.app.gameState.GameVOPlayer.startDelayPrompt();
		}
		flambe.System.get_storage().set("firstPlay",false);
	}
	,enterState: function() {
		var _g = this,
			stage = flambe.platform.html.HtmlPlatform.instance.getStage();

		com.cmm.common.app.State.prototype.enterState.call(this);
		com.cmm.common.app.SceneManager.playScene("mc_game",$bind(this,this.stateComplete));
		this._scene = com.cmm.common.app.SceneManager.get_currentScene();
		this._scene.stop();
		this._clearConfirmation = js.Boot.__cast(this._scene.getChildByName("mc_clearConfirmation") , com.cmm.common.display.MovieClip);
		this._clearConfirmation.gotoAndStop("hide");
		this._resetConfirmation = js.Boot.__cast(this._scene.getChildByName("mc_resetConfirmation") , com.cmm.common.display.MovieClip);
		this._resetConfirmation.gotoAndStop("hide");
		this._coasterLoader = js.Boot.__cast(this._scene.getChildByName("mc_coasterLoader") , com.cmm.common.display.MovieClip);
		this._coasterLoader.gotoAndStop("hide");
		this._launcherBtn = js.Boot.__cast(this._scene.getChildByName("btn_launcher") , com.cmm.common.display.MovieClip);
		this._launcherMc = js.Boot.__cast(this._scene.getChildByName("mc_launcher") , com.cmm.common.display.MovieClip);
		this._launcherMc.gotoAndStop("vaccuum_start");
		this._windMc = js.Boot.__cast(this._launcherMc.getChildByName("wind") , com.cmm.common.display.MovieClip);
		this._windMc.gotoAndStop(1);
		this._launcherMc.gotoAndStop("ready_to_launch");
		this._pieceLayer = js.Boot.__cast(this._scene.getChildByName("mc_pieceLayer") , com.cmm.common.display.MovieClip);
		this._ballLayer = js.Boot.__cast(this._scene.getChildByName("mc_ballLayer") , com.cmm.common.display.MovieClip);
		this._pieces = new Array();
		this.createPhysicsWorld();
		com.cmm.common.event.EDispatcher.addEventListener("com.cmm.activityEngines.customBuilder.event.builderComponentSelected",$bind(this,this.componentSelected));
		com.cmm.common.event.EDispatcher.addEventListener("launcher_click",$bind(this,this.prepareLaunch));
		com.cmm.common.event.EDispatcher.addEventListener("ball_sleeping",$bind(this,this.retrieveBall));
		com.cmm.common.event.EDispatcher.addEventListener("ball_piece_collision",$bind(this,this.collisionEffect));
		com.cmm.common.event.EDispatcher.addEventListener("piece_down",$bind(this,this.pieceDown));
		com.cmm.common.event.EDispatcher.addEventListener("piece_up",$bind(this,this.pieceUp));
		com.cmm.common.event.EDispatcher.addEventListener("clear_all",$bind(this,this.showClearConfirmation));
		com.cmm.common.event.EDispatcher.addEventListener("show_help",$bind(this,this.showHelp));
		com.cmm.common.event.EDispatcher.addEventListener("yes_click",$bind(this,this.confirmedYes));
		com.cmm.common.event.EDispatcher.addEventListener("no_click",$bind(this,this.confirmedNo));
		com.cmm.common.event.EDispatcher.addEventListener("create_coaster",$bind(this,this.createCoaster));
		com.cmm.common.event.EDispatcher.addEventListener("close_end_screen",$bind(this,this.resetEndScreen));
		flambe.System.get_pointer().down.connect(function(event) {
			_g.getPosition();
			_g._interruptTutorial = true;
		});
		this._readyToLaunch = false;
		flambe.System.get_pointer().up.connect(function(event) {
			_g.checkPosition();
			if(_g._readyToLaunch) _g.launchBall();
		});
		this._clickAndDragActive = false;
		this._clickAndStickActive = false;
		com.cmm.mmc.app.gameState.GameVOPlayer.setRandomVOArrays();
		com.cmm.mmc.app.gameState.GameVOPlayer.setPromptIndex(this._pieces.length);
		this.setTutorial();
		this._launches = 0;

		stage.resizeCanvas(stage._canvas.width - 0.0001, stage._canvas.height); // Tabs don't work until after a resize event... :shrug: - DDD 4/17/2019
	}
	,__class__: com.cmm.mmc.app.GameState
});
com.cmm.mmc.app.MainStateList = function() {
	com.cmm.common.app.StateList.call(this);
	this.statePackagePath = "com.mmc.app";
	this.stateClassList = [com.cmm.mmc.app.PregameState,com.cmm.mmc.app.GameState,com.cmm.mmc.app.EndGameState];
};
$hxClasses["com.cmm.mmc.app.MainStateList"] = com.cmm.mmc.app.MainStateList;
com.cmm.mmc.app.MainStateList.__name__ = ["com","cmm","mmc","app","MainStateList"];
com.cmm.mmc.app.MainStateList.__super__ = com.cmm.common.app.StateList;
com.cmm.mmc.app.MainStateList.prototype = $extend(com.cmm.common.app.StateList.prototype,{
	__class__: com.cmm.mmc.app.MainStateList
});
com.cmm.mmc.app.PregameState = function() {
	com.cmm.common.app.State.call(this);
};
$hxClasses["com.cmm.mmc.app.PregameState"] = com.cmm.mmc.app.PregameState;
com.cmm.mmc.app.PregameState.__name__ = ["com","cmm","mmc","app","PregameState"];
com.cmm.mmc.app.PregameState.__super__ = com.cmm.common.app.State;
com.cmm.mmc.app.PregameState.prototype = $extend(com.cmm.common.app.State.prototype,{
	stateComplete: function() {
		com.cmm.common.app.State.prototype.stateComplete.call(this);
	}
	,sceneComplete: function() {
		this._scene.stop();
		if(this._sceneName == "mc_titleScene") this.showIntroScene(); else if(this._sceneName == "mc_introScene") this.stateComplete();
	}
	,playAnimation: function(f) {
		if(this._scene.get_currentFrame() == 121) {
			var animation = js.Boot.__cast(this._scene.getChildByName("animation") , com.cmm.common.display.MovieClip);
			animation.gotoAndPlay(1,animation.get_totalFrames(),0,false);
			this._scene.owner.remove(this._updateComponent);
			this._updateComponent = null;
		}
	}
	,showIntroScene: function() {
		this._sceneName = "mc_introScene";
		com.cmm.common.app.SceneManager.playScene(this._sceneName,$bind(this,this.sceneComplete));
		this._scene = js.Boot.__cast(com.cmm.common.app.SceneManager.get_currentScene() , com.cmm.common.display.MovieClip);
		this._updateComponent = new com.cmm.mmc.app.customTools.UpdateComponent($bind(this,this.playAnimation));
		this._scene.owner.add(this._updateComponent);
		this.playMusic();
		com.cmm.mmc.app.GameState.prepareAllCoasters();
	}
	,playMusic: function() {
		if(!this._musicPlaying) {
			com.cmm.common.audio.SoundPlayerRemote.play("loop");
			this._musicPlaying = true;
		}
	}
	,showTitleScene: function() {
		this._sceneName = "mc_titleScene";
		com.cmm.common.app.SceneManager.playScene(this._sceneName,$bind(this,this.sceneComplete));
		this._scene = js.Boot.__cast(com.cmm.common.app.SceneManager.get_currentScene() , com.cmm.common.display.MovieClip);
		com.cmm.common.audio.SoundPlayerRemote.play("sting",$bind(this,this.playMusic));
		com.cmm.common.audio.SoundPlayerRemote.play("MMC_1");
		this._musicPlaying = false;
	}
	,enterState: function() {
		com.cmm.common.app.State.prototype.enterState.call(this);
		this.showTitleScene();
	}
	,__class__: com.cmm.mmc.app.PregameState
});
com.cmm.mmc.app.customTools = {}
com.cmm.mmc.app.customTools.CustomMaterial = function() { }
$hxClasses["com.cmm.mmc.app.customTools.CustomMaterial"] = com.cmm.mmc.app.customTools.CustomMaterial;
com.cmm.mmc.app.customTools.CustomMaterial.__name__ = ["com","cmm","mmc","app","customTools","CustomMaterial"];
com.cmm.mmc.app.customTools.CustomMaterial.ball = function() {
	return new nape.phys.Material(com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().ball.elasticity,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().ball.dynamicFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().ball.staticFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().ball.density,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().ball.rollingFriction);
}
com.cmm.mmc.app.customTools.CustomMaterial.border = function() {
	return new nape.phys.Material(com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().border.elasticity,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().border.dynamicFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().border.staticFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().border.density,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().border.rollingFriction);
}
com.cmm.mmc.app.customTools.CustomMaterial.track = function() {
	return new nape.phys.Material(com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().track.elasticity,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().track.dynamicFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().track.staticFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().track.density,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().track.rollingFriction);
}
com.cmm.mmc.app.customTools.CustomMaterial.spring = function() {
	return new nape.phys.Material(com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().spring.elasticity,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().spring.dynamicFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().spring.staticFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().spring.density,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().spring.rollingFriction);
}
com.cmm.mmc.app.customTools.CustomMaterial.conveyor = function() {
	return new nape.phys.Material(com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().conveyor.elasticity,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().conveyor.dynamicFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().conveyor.staticFriction,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().conveyor.density,com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings().conveyor.rollingFriction);
}
com.cmm.mmc.app.customTools.CustomMaterial.get_physicsSettings = function() {
	if(com.cmm.mmc.app.customTools.CustomMaterial._physicsSettings == null) com.cmm.mmc.app.customTools.CustomMaterial._physicsSettings = com.cmm.common.io.LoadMaster.getJSON("config","PhysicsSettings.json");
	return com.cmm.mmc.app.customTools.CustomMaterial._physicsSettings;
}
com.cmm.mmc.app.customTools.SpecialMovieClipButton = function() { }
$hxClasses["com.cmm.mmc.app.customTools.SpecialMovieClipButton"] = com.cmm.mmc.app.customTools.SpecialMovieClipButton;
com.cmm.mmc.app.customTools.SpecialMovieClipButton.__name__ = ["com","cmm","mmc","app","customTools","SpecialMovieClipButton"];
com.cmm.mmc.app.customTools.SpecialMovieClipButton.__super__ = com.cmm.common.display.MovieClipButton;
com.cmm.mmc.app.customTools.SpecialMovieClipButton.prototype = $extend(com.cmm.common.display.MovieClipButton.prototype,{
	onPointerOut: function() {
		if(this._buttonState == com.cmm.common.display.BUTTON_STATE.OVER) {
			com.cmm.common.display.MovieClipButton.prototype.onPointerOut.call(this);
			if(flambe.System.get_pointer().isDown() == true) {
				this._buttonState = com.cmm.common.display.BUTTON_STATE.DOWN;
				this.gotoAndStop("over");
			} else {
				flambe.System.get_mouse().set_cursor(flambe.input.MouseCursor.Default);
				this.gotoAndStop("up");
			}
		}
	}
	,onPointerOver: function() {
		com.cmm.common.display.MovieClipButton.prototype.onPointerOver.call(this);
		flambe.System.get_mouse().set_cursor(flambe.input.MouseCursor.Button);
		if(this.getFrameFromLabel("over") != -1) this.gotoAndStop("over");
		this._moveconnex = flambe.System.get_pointer().move.connect($bind(this,this.checkPosition));
	}
	,__class__: com.cmm.mmc.app.customTools.SpecialMovieClipButton
});
com.cmm.mmc.app.customTools.UpdateComponent = function(onUpdate) {
	this._onUpdate = null;
	this._onUpdate = onUpdate;
};
$hxClasses["com.cmm.mmc.app.customTools.UpdateComponent"] = com.cmm.mmc.app.customTools.UpdateComponent;
com.cmm.mmc.app.customTools.UpdateComponent.__name__ = ["com","cmm","mmc","app","customTools","UpdateComponent"];
com.cmm.mmc.app.customTools.UpdateComponent.__super__ = flambe.Component;
com.cmm.mmc.app.customTools.UpdateComponent.prototype = $extend(flambe.Component.prototype,{
	onUpdate: function(dt) {
		flambe.Component.prototype.onUpdate.call(this,dt);
		if(this._onUpdate != null) this._onUpdate(dt);
	}
	,get_name: function() {
		return "UpdateComponent_7";
	}
	,__class__: com.cmm.mmc.app.customTools.UpdateComponent
});
com.cmm.mmc.app.endGameState = {}
com.cmm.mmc.app.gameState = {}
com.cmm.mmc.app.gameState.BodyComponent = function(body) {
	this._body = body;
};
$hxClasses["com.cmm.mmc.app.gameState.BodyComponent"] = com.cmm.mmc.app.gameState.BodyComponent;
com.cmm.mmc.app.gameState.BodyComponent.__name__ = ["com","cmm","mmc","app","gameState","BodyComponent"];
com.cmm.mmc.app.gameState.BodyComponent.getFrom = function(entity) {
	return entity.getComponent("BodyComponent_8");
}
com.cmm.mmc.app.gameState.BodyComponent.__super__ = flambe.Component;
com.cmm.mmc.app.gameState.BodyComponent.prototype = $extend(flambe.Component.prototype,{
	onRemoved: function() {
		this._body.set_space(null);
		this.owner.dispose();
	}
	,setVelocity: function(velX,velY) {
		this._body.set_velocity(new nape.geom.Vec2(velX,velY));
	}
	,getVelocity: function() {
		return this._body.get_velocity();
	}
	,onUpdate: function(dt) {
		var pos = this._body.get_position();
		var sprite = flambe.display.Sprite.getFrom(this.owner);
		sprite.x.set__(pos.get_x());
		sprite.y.set__(pos.get_y());
		sprite.rotation.set__(flambe.math.FMath.toDegrees(this._body.get_rotation()));
		if(this._body.get_isSleeping()) com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("ball_sleeping"));
	}
	,get_name: function() {
		return "BodyComponent_8";
	}
	,__class__: com.cmm.mmc.app.gameState.BodyComponent
});
com.cmm.mmc.app.gameState.ClearAllBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.mmc.app.gameState.ClearAllBtn"] = com.cmm.mmc.app.gameState.ClearAllBtn;
com.cmm.mmc.app.gameState.ClearAllBtn.__name__ = ["com","cmm","mmc","app","gameState","ClearAllBtn"];
com.cmm.mmc.app.gameState.ClearAllBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.mmc.app.gameState.ClearAllBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("clear_all"));
	}
	,__class__: com.cmm.mmc.app.gameState.ClearAllBtn
});
com.cmm.mmc.app.gameState.GameVOPlayer = function() {
};
$hxClasses["com.cmm.mmc.app.gameState.GameVOPlayer"] = com.cmm.mmc.app.gameState.GameVOPlayer;
com.cmm.mmc.app.gameState.GameVOPlayer.__name__ = ["com","cmm","mmc","app","gameState","GameVOPlayer"];
com.cmm.mmc.app.gameState.GameVOPlayer.playGameIntro = function() {
	haxe.Timer.delay(com.cmm.mmc.app.gameState.GameVOPlayer.startDelayPrompt,20000);
}
com.cmm.mmc.app.gameState.GameVOPlayer.startDelayPrompt = function() {
	var delayInSec;
	delayInSec = 15;
	com.cmm.common.utils.DelayPrompt.addPrompt(delayInSec,com.cmm.mmc.app.gameState.GameVOPlayer.playDelayPrompt);
	com.cmm.common.utils.DelayPrompt.start();
	com.cmm.mmc.app.gameState.GameVOPlayer.setPromptIndex(0);
	flambe.System.get_pointer().down.connect(function(event) {
		com.cmm.common.utils.DelayPrompt.reset();
	});
	com.cmm.common.audio.SoundPlayerRemote.get_onSoundFileFinish().connect(com.cmm.mmc.app.gameState.GameVOPlayer.audioCallBack);
	flambe.System.get_pointer().down.connect(function(event) {
		com.cmm.mmc.app.gameState.GameVOPlayer._inputReceived = true;
	});
}
com.cmm.mmc.app.gameState.GameVOPlayer.ballLaunched = function() {
	com.cmm.mmc.app.gameState.GameVOPlayer._startTime = haxe.Timer.stamp();
	com.cmm.mmc.app.gameState.GameVOPlayer._resetTimer = new haxe.Timer(13000);
	com.cmm.mmc.app.gameState.GameVOPlayer._resetTimer.run = com.cmm.mmc.app.gameState.GameVOPlayer.recoveryPrompt;
	com.cmm.mmc.app.gameState.GameVOPlayer._ballLaunched = true;
	com.cmm.common.utils.DelayPrompt.reset();
}
com.cmm.mmc.app.gameState.GameVOPlayer.recoveryPrompt = function() {
	if(com.cmm.mmc.app.gameState.GameVOPlayer._ballLaunched) {
		com.cmm.common.audio.SoundPlayerRemote.play("gameDelay4");
		if(com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer == null) {
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer = new haxe.Timer(1000);
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer.run = com.cmm.mmc.app.gameState.GameVOPlayer.highlightLaunchBtn;
		}
	}
}
com.cmm.mmc.app.gameState.GameVOPlayer.setPromptIndex = function(number) {
	if(number >= 0 && number < 6) com.cmm.mmc.app.gameState.GameVOPlayer._index = 1; else if(number >= 6 && number < 8) com.cmm.mmc.app.gameState.GameVOPlayer._index = 2; else if(number >= 8) com.cmm.mmc.app.gameState.GameVOPlayer._index = 3;
	com.cmm.common.utils.DelayPrompt.reset();
}
com.cmm.mmc.app.gameState.GameVOPlayer.playDelayPrompt = function() {
	if(com.cmm.mmc.app.gameState.GameVOPlayer._ignoreAlternatePrompt) com.cmm.mmc.app.gameState.GameVOPlayer._playAlternatePrompt = false;
	if(com.cmm.common.audio.SoundPlayerRemote.isValidFile("gameDelay" + com.cmm.mmc.app.gameState.GameVOPlayer._index) && !com.cmm.mmc.app.gameState.GameVOPlayer._playAlternatePrompt && !com.cmm.mmc.app.gameState.GameVOPlayer._ballLaunched) {
		if(com.cmm.mmc.app.gameState.GameVOPlayer._index == 1) {
			com.cmm.common.audio.SoundPlayerRemote.play("gameDelay" + com.cmm.mmc.app.gameState.GameVOPlayer._index);
			com.cmm.mmc.app.gameState.GameVOPlayer.highlightPieces();
		} else com.cmm.common.audio.SoundPlayerRemote.play("gameDelay" + com.cmm.mmc.app.gameState.GameVOPlayer._index);
		com.cmm.mmc.app.gameState.GameVOPlayer._playAlternatePrompt = true;
		if(com.cmm.mmc.app.gameState.GameVOPlayer._highlightArrowsTimer == null) {
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightArrowsTimer = new haxe.Timer(1000);
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightArrowsTimer.run = com.cmm.mmc.app.gameState.GameVOPlayer.highlightArrowBtns;
			com.cmm.mmc.app.gameState.GameVOPlayer._inputReceived = false;
		}
		if(com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer == null && com.cmm.mmc.app.gameState.GameVOPlayer._index == 3) {
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer = new haxe.Timer(1000);
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer.run = com.cmm.mmc.app.gameState.GameVOPlayer.highlightLaunchBtn;
		}
	} else if(com.cmm.common.audio.SoundPlayerRemote.isValidFile("gameDelay5") && com.cmm.mmc.app.gameState.GameVOPlayer._playAlternatePrompt && !com.cmm.mmc.app.gameState.GameVOPlayer._ballLaunched) {
		com.cmm.common.audio.SoundPlayerRemote.play("gameDelay5");
		var tutorial = js.Boot.__cast(com.cmm.common.app.SceneManager.get_currentScene().getChildByName("mc_tutorial") , com.cmm.common.display.MovieClip);
		tutorial.gotoAndStop("coaster_tab_arrow");
		com.cmm.mmc.app.gameState.GameVOPlayer._playAlternatePrompt = false;
		if(com.cmm.mmc.app.gameState.GameVOPlayer._highlightArrowsTimer == null) {
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightArrowsTimer = new haxe.Timer(1000);
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightArrowsTimer.run = com.cmm.mmc.app.gameState.GameVOPlayer.highlightArrowBtns;
			com.cmm.mmc.app.gameState.GameVOPlayer._inputReceived = false;
		}
	} else com.cmm.common.utils.DelayPrompt.start();
}
com.cmm.mmc.app.gameState.GameVOPlayer.audioCallBack = function(sound) {
	if(sound.filename == "MMC_13") {
		com.cmm.common.audio.SoundPlayerRemote.stopChannel("vo");
		com.cmm.common.audio.SoundPlayerRemote.play("gameDelay" + com.cmm.mmc.app.gameState.GameVOPlayer._index + "a");
		com.cmm.mmc.app.gameState.GameVOPlayer.unhighlightPieces();
	} else if(sound.filename == "MMC_6a") {
		var tutorial = js.Boot.__cast(com.cmm.common.app.SceneManager.get_currentScene().getChildByName("mc_tutorial") , com.cmm.common.display.MovieClip);
		tutorial.gotoAndStop("hide");
		com.cmm.common.utils.DelayPrompt.start();
	} else com.cmm.common.utils.DelayPrompt.start();
}
com.cmm.mmc.app.gameState.GameVOPlayer.highlightPieces = function() {
	var scene = com.cmm.common.app.SceneManager.get_currentScene();
	var piecesScroller = js.Boot.__cast(scene.getChildByName("mc_piecesScroller") , com.cmm.common.display.MovieClip);
	var coastersScroller = js.Boot.__cast(scene.getChildByName("mc_coastersScroller") , com.cmm.common.display.MovieClip);
	var piecesSwitch1 = js.Boot.__cast(piecesScroller.getChildByName("btn_piecesSwitch") , com.cmm.common.display.MovieClipButton);
	var piecesSwitch2 = js.Boot.__cast(coastersScroller.getChildByName("btn_piecesSwitch") , com.cmm.common.display.MovieClipButton);
	var coastersSwitch1 = js.Boot.__cast(piecesScroller.getChildByName("btn_coastersSwitch") , com.cmm.common.display.MovieClipButton);
	var coastersSwitch2 = js.Boot.__cast(coastersScroller.getChildByName("btn_coastersSwitch") , com.cmm.common.display.MovieClipButton);
	if(scene.getChildIndex(piecesScroller) < scene.getChildIndex(coastersScroller)) {
		piecesSwitch1.disable();
		coastersSwitch1.enable();
		coastersSwitch2.enable();
		scene.swapChildren(piecesScroller,coastersScroller);
		com.cmm.mmc.app.gameState.GameVOPlayer._ignoreAlternatePrompt = false;
	}
	var _g = 1;
	while(_g < 25) {
		var i = _g++;
		var piece = js.Boot.__cast(piecesScroller.getChildByName("btn_piece" + i) , com.cmm.common.display.MovieClip);
		piece.gotoAndStop("down");
	}
}
com.cmm.mmc.app.gameState.GameVOPlayer.unhighlightPieces = function() {
	var scene = com.cmm.common.app.SceneManager.get_currentScene();
	var piecesScroller = js.Boot.__cast(scene.getChildByName("mc_piecesScroller") , com.cmm.common.display.MovieClip);
	var _g = 1;
	while(_g < 25) {
		var i = _g++;
		var piece = js.Boot.__cast(piecesScroller.getChildByName("btn_piece" + i) , com.cmm.common.display.MovieClip);
		piece.gotoAndStop("up");
	}
}
com.cmm.mmc.app.gameState.GameVOPlayer.playPlacementVO = function(pieceNumber,totalPieces) {
	if(pieceNumber >= 13 && pieceNumber <= 16) {
		if(com.cmm.mmc.app.gameState.GameVOPlayer._springCount == 0) com.cmm.common.audio.SoundPlayerRemote.play("MMC_23"); else if(com.cmm.mmc.app.gameState.GameVOPlayer._springCount % 10 == 0) com.cmm.common.audio.SoundPlayerRemote.play("MMC_24");
		com.cmm.mmc.app.gameState.GameVOPlayer._springCount++;
	} else if(pieceNumber >= 17 && pieceNumber <= 20) {
		if(com.cmm.mmc.app.gameState.GameVOPlayer._boostCount == 0) com.cmm.common.audio.SoundPlayerRemote.play("MMC_21"); else if(com.cmm.mmc.app.gameState.GameVOPlayer._boostCount % 10 == 0) com.cmm.common.audio.SoundPlayerRemote.play("MMC_22");
		com.cmm.mmc.app.gameState.GameVOPlayer._boostCount++;
	} else if(totalPieces % 5 == 3) com.cmm.common.audio.SoundPlayerRemote.play(com.cmm.mmc.app.gameState.GameVOPlayer.placementVO.getNextItem());
}
com.cmm.mmc.app.gameState.GameVOPlayer.setRandomVOArrays = function() {
	if(com.cmm.mmc.app.gameState.GameVOPlayer.bounceVO == null) {
		com.cmm.mmc.app.gameState.GameVOPlayer.placementVO = new com.cmm.common.data.RandomNoRepeatArray(["MMC_15","MMC_16","MMC_17","MMC_18","MMC_19","MMC_20"]);
		com.cmm.mmc.app.gameState.GameVOPlayer.bounceVO = new com.cmm.common.data.RandomNoRepeatArray(["bounce1","bounce2","bounce3","bounce4","bounce5","bounce6"]);
		com.cmm.mmc.app.gameState.GameVOPlayer.springVO = new com.cmm.common.data.RandomNoRepeatArray(["spring1","spring2","spring3","spring4","spring5","spring6"]);
		com.cmm.mmc.app.gameState.GameVOPlayer.yellowHitVO = new com.cmm.common.data.RandomNoRepeatArray(["hitYellow"]);
		com.cmm.mmc.app.gameState.GameVOPlayer.specialHatVO = new com.cmm.common.data.RandomNoRepeatArray(["specialHat1","specialHat2","specialHat3"]);
		com.cmm.mmc.app.gameState.GameVOPlayer.specialHornVO = new com.cmm.common.data.RandomNoRepeatArray(["specialHorn1","specialHorn2","specialHorn3"]);
		com.cmm.mmc.app.gameState.GameVOPlayer.specialStarVO = new com.cmm.common.data.RandomNoRepeatArray(["specialStar1","specialStar2","specialStar3"]);
		com.cmm.mmc.app.gameState.GameVOPlayer.shortRunVO = new com.cmm.common.data.RandomNoRepeatArray(["shortRunCompleteVO1","shortRunCompleteVO2","shortRunCompleteVO3"]);
		com.cmm.mmc.app.gameState.GameVOPlayer.longRunVO = new com.cmm.common.data.RandomNoRepeatArray(["longRunCompleteVO1","longRunCompleteVO2","longRunCompleteVO3","longRunCompleteVO4","longRunCompleteVO5","longRunCompleteVO6"]);
	}
}
com.cmm.mmc.app.gameState.GameVOPlayer.playCollisionAudio = function(pieceNumber) {
	var audioStr = "";
	var ballVelocity = com.cmm.mmc.app.gameState.BodyComponent.getFrom(com.cmm.mmc.app.gameState.PhysicsController._ball).getVelocity();
	var velocityY = ballVelocity.get_y();
	if((pieceNumber >= 1 && pieceNumber <= 12 || pieceNumber == 21 || pieceNumber == 22) && velocityY <= -20 && !com.cmm.mmc.app.gameState.GameVOPlayer._bouncePlaying) {
		audioStr = com.cmm.mmc.app.gameState.GameVOPlayer.bounceVO.getNextItem();
		com.cmm.mmc.app.gameState.GameVOPlayer._bouncePlaying = true;
		haxe.Timer.delay(com.cmm.mmc.app.gameState.GameVOPlayer.bounceFinished,250);
	} else if(pieceNumber >= 13 && pieceNumber <= 16) audioStr = com.cmm.mmc.app.gameState.GameVOPlayer.springVO.getNextItem(); else if(pieceNumber >= 17 && pieceNumber <= 20) audioStr = com.cmm.mmc.app.gameState.GameVOPlayer.yellowHitVO.getNextItem(); else if(pieceNumber == 23) audioStr = com.cmm.mmc.app.gameState.GameVOPlayer.specialHatVO.getNextItem(); else if(pieceNumber == 24) audioStr = com.cmm.mmc.app.gameState.GameVOPlayer.specialHornVO.getNextItem(); else if(pieceNumber == 25) audioStr = com.cmm.mmc.app.gameState.GameVOPlayer.specialStarVO.getNextItem();
	if(audioStr != "") com.cmm.common.audio.SoundPlayerRemote.play(audioStr);
}
com.cmm.mmc.app.gameState.GameVOPlayer.bounceFinished = function() {
	com.cmm.mmc.app.gameState.GameVOPlayer._bouncePlaying = false;
}
com.cmm.mmc.app.gameState.GameVOPlayer.ballRetieved = function(playVO) {
	var timeElapsed = Std["int"](haxe.Timer.stamp() - com.cmm.mmc.app.gameState.GameVOPlayer._startTime);
	if(timeElapsed < 3 && playVO) com.cmm.common.audio.SoundPlayerRemote.play(com.cmm.mmc.app.gameState.GameVOPlayer.shortRunVO.getNextItem(),com.cmm.mmc.app.gameState.GameVOPlayer.playShortReset); else if(playVO) com.cmm.common.audio.SoundPlayerRemote.play(com.cmm.mmc.app.gameState.GameVOPlayer.longRunVO.getNextItem(),com.cmm.mmc.app.gameState.GameVOPlayer.playLongReset);
	com.cmm.mmc.app.gameState.GameVOPlayer._ballLaunched = false;
	com.cmm.mmc.app.gameState.GameVOPlayer._resetVOCounter = 1;
	com.cmm.common.utils.DelayPrompt.reset();
	com.cmm.mmc.app.gameState.GameVOPlayer._resetTimer.stop();
}
com.cmm.mmc.app.gameState.GameVOPlayer.playShortReset = function() {
	if(com.cmm.mmc.app.gameState.GameVOPlayer._resetVOCounter == 1) com.cmm.common.audio.SoundPlayerRemote.play("shortRunResetVO1",com.cmm.mmc.app.gameState.GameVOPlayer.playShortReset); else if(com.cmm.mmc.app.gameState.GameVOPlayer._resetVOCounter == 2) {
		com.cmm.common.audio.SoundPlayerRemote.play("shortRunResetVO2");
		if(com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer == null) {
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer = new haxe.Timer(1000);
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer.run = com.cmm.mmc.app.gameState.GameVOPlayer.highlightLaunchBtn;
		}
	}
	com.cmm.mmc.app.gameState.GameVOPlayer._resetVOCounter++;
}
com.cmm.mmc.app.gameState.GameVOPlayer.playLongReset = function() {
	if(com.cmm.mmc.app.gameState.GameVOPlayer._resetVOCounter == 1) {
		com.cmm.common.audio.SoundPlayerRemote.play("longRunResetVO1",com.cmm.mmc.app.gameState.GameVOPlayer.playLongReset);
		if(com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer == null) {
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer = new haxe.Timer(1000);
			com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer.run = com.cmm.mmc.app.gameState.GameVOPlayer.highlightLaunchBtn;
		}
	} else if(com.cmm.mmc.app.gameState.GameVOPlayer._resetVOCounter == 2) com.cmm.common.audio.SoundPlayerRemote.play("longRunResetVO2");
	com.cmm.mmc.app.gameState.GameVOPlayer._resetVOCounter++;
}
com.cmm.mmc.app.gameState.GameVOPlayer.highlightLaunchBtn = function() {
	var launcherBtn = js.Boot.__cast(com.cmm.common.app.SceneManager.get_currentScene().getChildByName("btn_launcher") , com.cmm.common.display.MovieClip);
	if(launcherBtn.get_currentFrame() == 1) launcherBtn.gotoAndStop("over"); else if(launcherBtn.get_currentFrame() != 1) {
		launcherBtn.gotoAndStop("up");
		com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer.stop();
		com.cmm.mmc.app.gameState.GameVOPlayer._highlightHandleTimer = null;
	}
}
com.cmm.mmc.app.gameState.GameVOPlayer.highlightArrowBtns = function() {
	var backwardScrollBtn = js.Boot.__cast(com.cmm.common.app.SceneManager.get_currentScene().getChildByName("mc_piecesScroller").getChildByName("arrows").getChildByName("btn_backwardScroll") , com.cmm.common.display.MovieClip);
	var forwardScrollBtn = js.Boot.__cast(com.cmm.common.app.SceneManager.get_currentScene().getChildByName("mc_piecesScroller").getChildByName("arrows").getChildByName("btn_forwardScroll") , com.cmm.common.display.MovieClip);
	if(backwardScrollBtn.get_currentFrameLabel() == "up" && backwardScrollBtn.get_currentFrameLabel() != "disabled") backwardScrollBtn.gotoAndStop("down"); else if(backwardScrollBtn.get_currentFrameLabel() == "down" && backwardScrollBtn.get_currentFrameLabel() != "disabled") backwardScrollBtn.gotoAndStop("up");
	if(forwardScrollBtn.get_currentFrameLabel() == "up" && forwardScrollBtn.get_currentFrameLabel() != "disabled") forwardScrollBtn.gotoAndStop("down"); else if(forwardScrollBtn.get_currentFrameLabel() == "down" && forwardScrollBtn.get_currentFrameLabel() != "disabled") forwardScrollBtn.gotoAndStop("up");
	if(com.cmm.mmc.app.gameState.GameVOPlayer._inputReceived == true) {
		com.cmm.mmc.app.gameState.GameVOPlayer._highlightArrowsTimer.stop();
		com.cmm.mmc.app.gameState.GameVOPlayer._highlightArrowsTimer = null;
		com.cmm.mmc.app.gameState.GameVOPlayer._inputReceived = false;
		if(backwardScrollBtn.get_currentFrameLabel() != "disabled") backwardScrollBtn.gotoAndStop("up");
		if(forwardScrollBtn.get_currentFrameLabel() != "disabled") forwardScrollBtn.gotoAndStop("up");
	}
}
com.cmm.mmc.app.gameState.GameVOPlayer.prototype = {
	__class__: com.cmm.mmc.app.gameState.GameVOPlayer
}
com.cmm.mmc.app.gameState.HelpBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.mmc.app.gameState.HelpBtn"] = com.cmm.mmc.app.gameState.HelpBtn;
com.cmm.mmc.app.gameState.HelpBtn.__name__ = ["com","cmm","mmc","app","gameState","HelpBtn"];
com.cmm.mmc.app.gameState.HelpBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.mmc.app.gameState.HelpBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("show_help"));
	}
	,__class__: com.cmm.mmc.app.gameState.HelpBtn
});
com.cmm.mmc.app.gameState.LauncherBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.mmc.app.gameState.LauncherBtn"] = com.cmm.mmc.app.gameState.LauncherBtn;
com.cmm.mmc.app.gameState.LauncherBtn.__name__ = ["com","cmm","mmc","app","gameState","LauncherBtn"];
com.cmm.mmc.app.gameState.LauncherBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.mmc.app.gameState.LauncherBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	playVO: function() {
		this._voTimer = null;
		if(this._over == true && !com.cmm.mmc.app.gameState.GameVOPlayer._ballLaunched) {
			if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this._ownerSprite.get_instanceName() + "VO")) com.cmm.common.audio.SoundPlayerRemote.play(this._ownerSprite.get_instanceName() + "VO"); else if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this.id + "VO")) com.cmm.common.audio.SoundPlayerRemote.play(this.id + "VO");
		}
	}
	,onPointerOver: function() {
		this._over = true;
		if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this._ownerSprite.get_instanceName() + "RO")) com.cmm.common.audio.SoundPlayerRemote.play(this._ownerSprite.get_instanceName() + "RO"); else if(com.cmm.common.audio.SoundPlayerRemote.isValidFile(this.id + "RO")) com.cmm.common.audio.SoundPlayerRemote.play(this.id + "RO");
		this._voTimer = haxe.Timer.delay($bind(this,this.playVO),1000);
	}
	,onPointerDown: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerDown.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("launcher_click"));
	}
	,__class__: com.cmm.mmc.app.gameState.LauncherBtn
});
com.cmm.mmc.app.gameState.NoBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.mmc.app.gameState.NoBtn"] = com.cmm.mmc.app.gameState.NoBtn;
com.cmm.mmc.app.gameState.NoBtn.__name__ = ["com","cmm","mmc","app","gameState","NoBtn"];
com.cmm.mmc.app.gameState.NoBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.mmc.app.gameState.NoBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("no_click"));
	}
	,__class__: com.cmm.mmc.app.gameState.NoBtn
});
var nape = {}
nape.callbacks = {}
nape.callbacks.CbType = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.callbacks.ZPP_CbType();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.callbacks.CbType"] = nape.callbacks.CbType;
nape.callbacks.CbType.__name__ = ["nape","callbacks","CbType"];
nape.callbacks.CbType.get_ANY_BODY = function() {
	return zpp_nape.callbacks.ZPP_CbType.ANY_BODY;
}
nape.callbacks.CbType.get_ANY_CONSTRAINT = function() {
	return zpp_nape.callbacks.ZPP_CbType.ANY_CONSTRAINT;
}
nape.callbacks.CbType.get_ANY_SHAPE = function() {
	return zpp_nape.callbacks.ZPP_CbType.ANY_SHAPE;
}
nape.callbacks.CbType.get_ANY_COMPOUND = function() {
	return zpp_nape.callbacks.ZPP_CbType.ANY_COMPOUND;
}
nape.callbacks.CbType.prototype = {
	toString: function() {
		return this == nape.callbacks.CbType.get_ANY_BODY()?"ANY_BODY":this == nape.callbacks.CbType.get_ANY_SHAPE()?"ANY_SHAPE":this == nape.callbacks.CbType.get_ANY_COMPOUND()?"ANY_COMPOUND":this == nape.callbacks.CbType.get_ANY_CONSTRAINT()?"ANY_CONSTRAINT":"CbType#" + this.get_id();
	}
	,get_id: function() {
		return this.zpp_inner.id;
	}
	,__class__: nape.callbacks.CbType
}
var zpp_nape = {}
zpp_nape.callbacks = {}
zpp_nape.callbacks.ZPP_CbType = function() {
	this.conlisteners = null;
	this.bodylisteners = null;
	this.listeners = null;
	this.cbsets = null;
	this.id = 0;
	this.userData = null;
	this.outer = null;
	this.id = zpp_nape.ZPP_ID.CbType();
	this.listeners = new zpp_nape.util.ZNPList_ZPP_InteractionListener();
	this.bodylisteners = new zpp_nape.util.ZNPList_ZPP_BodyListener();
	this.conlisteners = new zpp_nape.util.ZNPList_ZPP_ConstraintListener();
	this.constraints = new zpp_nape.util.ZNPList_ZPP_Constraint();
	this.interactors = new zpp_nape.util.ZNPList_ZPP_Interactor();
	this.cbsets = new zpp_nape.util.ZNPList_ZPP_CbSet();
};
$hxClasses["zpp_nape.callbacks.ZPP_CbType"] = zpp_nape.callbacks.ZPP_CbType;
zpp_nape.callbacks.ZPP_CbType.__name__ = ["zpp_nape","callbacks","ZPP_CbType"];
zpp_nape.callbacks.ZPP_CbType.setlt = function(a,b) {
	return a.id < b.id;
}
zpp_nape.callbacks.ZPP_CbType.prototype = {
	invalidateconstraint: function() {
		var cx_ite = this.cbsets.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.invalidate_conlisteners();
			cx_ite = cx_ite.next;
		}
	}
	,removeconstraint: function(x) {
		this.conlisteners.remove(x);
		this.invalidateconstraint();
	}
	,addconstraint: function(x) {
		var pre = null;
		var cx_ite = this.conlisteners.begin();
		while(cx_ite != null) {
			var j = cx_ite.elem();
			if(zpp_nape.callbacks.ZPP_Listener.setlt(x,j)) break;
			pre = cx_ite;
			cx_ite = cx_ite.next;
		}
		this.conlisteners.inlined_insert(pre,x);
		this.invalidateconstraint();
	}
	,invalidatebody: function() {
		var cx_ite = this.cbsets.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.invalidate_bodylisteners();
			cx_ite = cx_ite.next;
		}
	}
	,removebody: function(x) {
		this.bodylisteners.remove(x);
		this.invalidatebody();
	}
	,addbody: function(x) {
		var pre = null;
		var cx_ite = this.bodylisteners.begin();
		while(cx_ite != null) {
			var j = cx_ite.elem();
			if(zpp_nape.callbacks.ZPP_Listener.setlt(x,j)) break;
			pre = cx_ite;
			cx_ite = cx_ite.next;
		}
		this.bodylisteners.inlined_insert(pre,x);
		this.invalidatebody();
	}
	,invalidateint: function() {
		var cx_ite = this.cbsets.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.invalidate_listeners();
			cx_ite = cx_ite.next;
		}
	}
	,removeint: function(x) {
		this.listeners.remove(x);
		this.invalidateint();
	}
	,addint: function(x) {
		var pre = null;
		var cx_ite = this.listeners.begin();
		while(cx_ite != null) {
			var j = cx_ite.elem();
			if(zpp_nape.callbacks.ZPP_Listener.setlt(x,j)) break;
			pre = cx_ite;
			cx_ite = cx_ite.next;
		}
		this.listeners.inlined_insert(pre,x);
		this.invalidateint();
	}
	,remInteractor: function(intx) {
		this.interactors.remove(intx);
	}
	,remConstraint: function(con) {
		this.constraints.remove(con);
	}
	,addInteractor: function(intx) {
		this.interactors.add(intx);
	}
	,addConstraint: function(con) {
		this.constraints.add(con);
	}
	,__class__: zpp_nape.callbacks.ZPP_CbType
}
zpp_nape.ZPP_ID = function() { }
$hxClasses["zpp_nape.ZPP_ID"] = zpp_nape.ZPP_ID;
zpp_nape.ZPP_ID.__name__ = ["zpp_nape","ZPP_ID"];
zpp_nape.ZPP_ID.Constraint = function() {
	return zpp_nape.ZPP_ID._Constraint++;
}
zpp_nape.ZPP_ID.Interactor = function() {
	return zpp_nape.ZPP_ID._Interactor++;
}
zpp_nape.ZPP_ID.CbType = function() {
	return zpp_nape.ZPP_ID._CbType++;
}
zpp_nape.ZPP_ID.CbSet = function() {
	return zpp_nape.ZPP_ID._CbSet++;
}
zpp_nape.ZPP_ID.Listener = function() {
	return zpp_nape.ZPP_ID._Listener++;
}
zpp_nape.util = {}
zpp_nape.util.ZNPList_ZPP_InteractionListener = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_InteractionListener"] = zpp_nape.util.ZNPList_ZPP_InteractionListener;
zpp_nape.util.ZNPList_ZPP_InteractionListener.__name__ = ["zpp_nape","util","ZNPList_ZPP_InteractionListener"];
zpp_nape.util.ZNPList_ZPP_InteractionListener.prototype = {
	empty: function() {
		return this.begin() == null;
	}
	,inlined_clear: function() {
		if(true) {
			while(!this.empty()) this.inlined_pop();
			this.pushmod = true;
		}
	}
	,clear: function() {
		this.inlined_clear();
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_InteractionListener(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_InteractionListener(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_InteractionListener.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_InteractionListener
}
zpp_nape.util.ZNPList_ZPP_BodyListener = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_BodyListener"] = zpp_nape.util.ZNPList_ZPP_BodyListener;
zpp_nape.util.ZNPList_ZPP_BodyListener.__name__ = ["zpp_nape","util","ZNPList_ZPP_BodyListener"];
zpp_nape.util.ZNPList_ZPP_BodyListener.prototype = {
	empty: function() {
		return this.begin() == null;
	}
	,inlined_clear: function() {
		if(true) {
			while(!this.empty()) this.inlined_pop();
			this.pushmod = true;
		}
	}
	,clear: function() {
		this.inlined_clear();
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_BodyListener.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_BodyListener.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_BodyListener.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_BodyListener.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_BodyListener.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_BodyListener(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_BodyListener.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_BodyListener.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_BodyListener
}
zpp_nape.util.ZNPList_ZPP_ConstraintListener = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_ConstraintListener"] = zpp_nape.util.ZNPList_ZPP_ConstraintListener;
zpp_nape.util.ZNPList_ZPP_ConstraintListener.__name__ = ["zpp_nape","util","ZNPList_ZPP_ConstraintListener"];
zpp_nape.util.ZNPList_ZPP_ConstraintListener.prototype = {
	empty: function() {
		return this.begin() == null;
	}
	,inlined_clear: function() {
		if(true) {
			while(!this.empty()) this.inlined_pop();
			this.pushmod = true;
		}
	}
	,clear: function() {
		this.inlined_clear();
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_ConstraintListener.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_ConstraintListener.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_ConstraintListener.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_ConstraintListener.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_ConstraintListener.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_ConstraintListener(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_ConstraintListener.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_ConstraintListener.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_ConstraintListener
}
zpp_nape.util.ZNPList_ZPP_Constraint = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Constraint"] = zpp_nape.util.ZNPList_ZPP_Constraint;
zpp_nape.util.ZNPList_ZPP_Constraint.__name__ = ["zpp_nape","util","ZNPList_ZPP_Constraint"];
zpp_nape.util.ZNPList_ZPP_Constraint.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,erase: function(pre) {
		return this.inlined_erase(pre);
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Constraint(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Constraint(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Constraint.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Constraint
}
zpp_nape.util.ZNPList_ZPP_Interactor = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Interactor"] = zpp_nape.util.ZNPList_ZPP_Interactor;
zpp_nape.util.ZNPList_ZPP_Interactor.__name__ = ["zpp_nape","util","ZNPList_ZPP_Interactor"];
zpp_nape.util.ZNPList_ZPP_Interactor.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_clear: function() {
		if(true) {
			while(!this.empty()) this.inlined_pop();
			this.pushmod = true;
		}
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Interactor.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Interactor.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Interactor.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Interactor.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Interactor.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Interactor(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Interactor.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Interactor.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Interactor
}
zpp_nape.util.ZNPList_ZPP_CbSet = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_CbSet"] = zpp_nape.util.ZNPList_ZPP_CbSet;
zpp_nape.util.ZNPList_ZPP_CbSet.__name__ = ["zpp_nape","util","ZNPList_ZPP_CbSet"];
zpp_nape.util.ZNPList_ZPP_CbSet.prototype = {
	front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_CbSet.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_CbSet.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_CbSet.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_CbSet.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_CbSet.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_CbSet(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_CbSet.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_CbSet.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_CbSet
}
com.cmm.mmc.app.gameState.PhysicsController = function() { }
$hxClasses["com.cmm.mmc.app.gameState.PhysicsController"] = com.cmm.mmc.app.gameState.PhysicsController;
com.cmm.mmc.app.gameState.PhysicsController.__name__ = ["com","cmm","mmc","app","gameState","PhysicsController"];
com.cmm.mmc.app.gameState.PhysicsController.start = function() {
	com.cmm.mmc.app.gameState.PhysicsController._scene = com.cmm.common.app.SceneManager.get_currentScene();
	com.cmm.mmc.app.gameState.PhysicsController._space = new com.cmm.mmc.app.gameState.SpaceComponent();
	com.cmm.mmc.app.gameState.PhysicsController._world = new flambe.Entity().add(com.cmm.mmc.app.gameState.PhysicsController._space);
	flambe.System.root.addChild(com.cmm.mmc.app.gameState.PhysicsController._world);
	com.cmm.mmc.app.gameState.PhysicsController._ballLayer = js.Boot.__cast(com.cmm.mmc.app.gameState.PhysicsController._scene.getChildByName("mc_ballLayer") , com.cmm.common.display.MovieClip);
	com.cmm.mmc.app.gameState.PhysicsController._pieces = new Array();
	com.cmm.mmc.app.gameState.PhysicsController._bodies = new Array();
	com.cmm.mmc.app.gameState.PhysicsController.addWall(com.cmm.mmc.app.gameState.PhysicsController._world,0,10,Main.DEFAULT_WIDTH,-200);
	com.cmm.mmc.app.gameState.PhysicsController.addWall(com.cmm.mmc.app.gameState.PhysicsController._world,975,0,200,Main.DEFAULT_HEIGHT);
	com.cmm.mmc.app.gameState.PhysicsController.addWall(com.cmm.mmc.app.gameState.PhysicsController._world,0,590,Main.DEFAULT_WIDTH,200);
	com.cmm.mmc.app.gameState.PhysicsController.addWall(com.cmm.mmc.app.gameState.PhysicsController._world,210,0,-200,Main.DEFAULT_HEIGHT);
	com.cmm.mmc.app.gameState.PhysicsController._interactionListener = new nape.callbacks.InteractionListener(nape.callbacks.CbEvent.get_BEGIN(),nape.callbacks.InteractionType.get_COLLISION(),com.cmm.mmc.app.gameState.PhysicsController._pieceCollision,com.cmm.mmc.app.gameState.PhysicsController._space._ballCollision,com.cmm.mmc.app.gameState.PhysicsController.ballCollidedWithPiece);
	com.cmm.mmc.app.gameState.PhysicsController._space._space.get_listeners().add(com.cmm.mmc.app.gameState.PhysicsController._interactionListener);
	com.cmm.mmc.app.gameState.PhysicsController._preListener = new nape.callbacks.PreListener(nape.callbacks.InteractionType.get_COLLISION(),com.cmm.mmc.app.gameState.PhysicsController._animationCollision,com.cmm.mmc.app.gameState.PhysicsController._space._ballCollision,com.cmm.mmc.app.gameState.PhysicsController.ballCollidedWithAnimation);
	com.cmm.mmc.app.gameState.PhysicsController._space._space.get_listeners().add(com.cmm.mmc.app.gameState.PhysicsController._preListener);
}
com.cmm.mmc.app.gameState.PhysicsController.addWall = function(world,x,y,width,height,visible) {
	if(visible == null) visible = false;
	var space = com.cmm.mmc.app.gameState.SpaceComponent.getFrom(world);
	var body = new nape.phys.Body(nape.phys.BodyType.get_STATIC());
	body.get_shapes().add(new nape.shape.Polygon(nape.shape.Polygon.rect(x,y,width,height),com.cmm.mmc.app.customTools.CustomMaterial.border()));
	body.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsController._pieceCollision);
	space.addBody(body);
	if(visible) {
		var entity = new flambe.Entity().add(new flambe.display.FillSprite(2105376,width,height).setXY(x,y));
		world.addChild(entity);
	}
}
com.cmm.mmc.app.gameState.PhysicsController.addBall = function() {
	if(com.cmm.mmc.app.gameState.PhysicsController._ball != null) com.cmm.mmc.app.gameState.PhysicsController.removeBall();
	com.cmm.mmc.app.gameState.PhysicsController._ball = com.cmm.mmc.app.gameState.PhysicsController._space.addBall(290,60);
	com.cmm.mmc.app.gameState.PhysicsController._ballLayer.addChild(com.cmm.common.display.MovieClip.getFrom(com.cmm.mmc.app.gameState.PhysicsController._ball));
}
com.cmm.mmc.app.gameState.PhysicsController.removeBall = function() {
	if(com.cmm.mmc.app.gameState.PhysicsController._ball != null) {
		com.cmm.mmc.app.gameState.PhysicsController._ball.dispose();
		com.cmm.mmc.app.gameState.PhysicsController._ball = null;
	}
}
com.cmm.mmc.app.gameState.PhysicsController.addPiece = function(x,y,number) {
	com.cmm.mmc.app.gameState.PhysicsController.addPieceActual(com.cmm.mmc.app.gameState.PhysicsController._space,x,y,number);
}
com.cmm.mmc.app.gameState.PhysicsController.addPieceActual = function(space,x,y,number) {
	var body = new nape.phys.Body();
	body = com.cmm.mmc.app.gameState.PhysicsData.createBody("piece" + number,com.cmm.common.utils.LibraryTools.createMovieClip("mc_piece" + number));
	body.set_position(new nape.geom.Vec2(x,y));
	body.set_type(nape.phys.BodyType.get_STATIC());
	body.setShapeMaterials(com.cmm.mmc.app.customTools.CustomMaterial.track());
	body.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsController._pieceCollision);
	var body2 = new nape.phys.Body();
	body2 = com.cmm.mmc.app.gameState.PhysicsData.createBody("piece" + number,com.cmm.common.utils.LibraryTools.createMovieClip("mc_piece" + number));
	body2.set_position(new nape.geom.Vec2(x,y));
	body2.set_type(nape.phys.BodyType.get_STATIC());
	body2.setShapeMaterials(com.cmm.mmc.app.customTools.CustomMaterial.track());
	if(number >= 13 && number <= 16) {
		var springiness = 250;
		body.setShapeMaterials(com.cmm.mmc.app.customTools.CustomMaterial.spring());
		if(number == 13) {
			body.get_surfaceVel().set_x(com.cmm.mmc.app.gameState.PhysicsController.get_physicsSettings().springUp.surfaceVelocityX);
			body.get_surfaceVel().set_y(com.cmm.mmc.app.gameState.PhysicsController.get_physicsSettings().springUp.surfaceVelocityY);
		} else if(number == 14) {
			body.get_surfaceVel().set_x(com.cmm.mmc.app.gameState.PhysicsController.get_physicsSettings().springRight.surfaceVelocityX);
			body.get_surfaceVel().set_y(com.cmm.mmc.app.gameState.PhysicsController.get_physicsSettings().springRight.surfaceVelocityY);
		} else if(number == 15) {
			body.get_surfaceVel().set_x(com.cmm.mmc.app.gameState.PhysicsController.get_physicsSettings().springDown.surfaceVelocityX);
			body.get_surfaceVel().set_y(com.cmm.mmc.app.gameState.PhysicsController.get_physicsSettings().springDown.surfaceVelocityY);
		} else if(number == 16) {
			body.get_surfaceVel().set_x(com.cmm.mmc.app.gameState.PhysicsController.get_physicsSettings().springLeft.surfaceVelocityX);
			body.get_surfaceVel().set_y(com.cmm.mmc.app.gameState.PhysicsController.get_physicsSettings().springLeft.surfaceVelocityY);
		}
		body2 = com.cmm.mmc.app.gameState.PhysicsData.createBody("piece" + number + "a",com.cmm.common.utils.LibraryTools.createMovieClip("mc_piece" + number));
		body2.set_position(new nape.geom.Vec2(x,y));
		body2.set_type(nape.phys.BodyType.get_STATIC());
		body2.setShapeMaterials(com.cmm.mmc.app.customTools.CustomMaterial.track());
	}
	if(number >= 17 && number <= 20) {
		var conveyorSpeed = 400;
		body.setShapeMaterials(com.cmm.mmc.app.customTools.CustomMaterial.conveyor());
		body2 = com.cmm.mmc.app.gameState.PhysicsData.createBody("piece" + number + "a",com.cmm.common.utils.LibraryTools.createMovieClip("mc_piece" + number));
		body2.set_position(new nape.geom.Vec2(x,y));
		body2.set_type(nape.phys.BodyType.get_STATIC());
		body2.setShapeMaterials(com.cmm.mmc.app.customTools.CustomMaterial.track());
	}
	if(number >= 23 && number <= 25) {
		body.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsController._animationCollision);
		var filter = new nape.dynamics.InteractionFilter();
		filter.set_collisionMask(0);
		body2.setShapeFilters(filter);
	}
	space.addBody(body);
	com.cmm.mmc.app.gameState.PhysicsController._bodies.push(body);
	space.addBody(body2);
	com.cmm.mmc.app.gameState.PhysicsController._bodies.push(body2);
}
com.cmm.mmc.app.gameState.PhysicsController.removePiece = function(i) {
	com.cmm.mmc.app.gameState.PhysicsController._bodies[i].set_space(null);
	com.cmm.mmc.app.gameState.PhysicsController._space._space.get_bodies().remove(com.cmm.mmc.app.gameState.PhysicsController._bodies[i]);
	HxOverrides.remove(com.cmm.mmc.app.gameState.PhysicsController._bodies,com.cmm.mmc.app.gameState.PhysicsController._bodies[i]);
	com.cmm.mmc.app.gameState.PhysicsController._bodies[i].set_space(null);
	com.cmm.mmc.app.gameState.PhysicsController._space._space.get_bodies().remove(com.cmm.mmc.app.gameState.PhysicsController._bodies[i]);
	HxOverrides.remove(com.cmm.mmc.app.gameState.PhysicsController._bodies,com.cmm.mmc.app.gameState.PhysicsController._bodies[i]);
}
com.cmm.mmc.app.gameState.PhysicsController.ballCollidedWithPiece = function(collision) {
	var bodyFound = false;
	var _g1 = 0, _g = com.cmm.mmc.app.gameState.PhysicsController._bodies.length;
	while(_g1 < _g) {
		var i = _g1++;
		if(com.cmm.mmc.app.gameState.PhysicsController._bodies[i].get_id() == collision.get_int1().get_id()) {
			bodyFound = true;
			com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("ball_piece_collision",i));
		}
	}
	if(bodyFound == false) com.cmm.mmc.app.gameState.GameVOPlayer.playCollisionAudio(1);
}
com.cmm.mmc.app.gameState.PhysicsController.ballCollidedWithAnimation = function(cb) {
	return nape.callbacks.PreFlag.get_IGNORE();
}
com.cmm.mmc.app.gameState.PhysicsController.finish = function() {
	com.cmm.mmc.app.gameState.PhysicsController._space = null;
	com.cmm.mmc.app.gameState.PhysicsController._world = null;
}
com.cmm.mmc.app.gameState.PhysicsController.get_physicsSettings = function() {
	if(com.cmm.mmc.app.gameState.PhysicsController._physicsSettings == null) com.cmm.mmc.app.gameState.PhysicsController._physicsSettings = com.cmm.common.io.LoadMaster.getJSON("config","PhysicsSettings.json");
	return com.cmm.mmc.app.gameState.PhysicsController._physicsSettings;
}
com.cmm.mmc.app.gameState.PhysicsData = function() { }
$hxClasses["com.cmm.mmc.app.gameState.PhysicsData"] = com.cmm.mmc.app.gameState.PhysicsData;
com.cmm.mmc.app.gameState.PhysicsData.__name__ = ["com","cmm","mmc","app","gameState","PhysicsData"];
com.cmm.mmc.app.gameState.PhysicsData.createBody = function(name,graphic) {
	var xret = com.cmm.mmc.app.gameState.PhysicsData.lookup(name);
	if(graphic == null) return xret.body.copy();
	var ret = xret.body.copy();
	graphic.setXY(0,0);
	var bounds = flambe.display.Sprite.getBounds(graphic.owner);
	var offset = nape.geom.Vec2.get(bounds.x - xret.anchor.get_x(),bounds.y - xret.anchor.get_y());
	ret.get_userData().graphic = graphic;
	ret.get_userData().graphicUpdate = function(b) {
		var gp = b.localPointToWorld(offset);
		b.get_userData().graphic.x = gp.get_x();
		b.get_userData().graphic.y = gp.get_y();
		b.get_userData().graphic.rotation = b.get_rotation() * 180 / Math.PI % 360;
	};
	return ret;
}
com.cmm.mmc.app.gameState.PhysicsData.registerCbType = function(name,cbType) {
	if(com.cmm.mmc.app.gameState.PhysicsData.types == null) com.cmm.mmc.app.gameState.PhysicsData.types = new Hash();
	com.cmm.mmc.app.gameState.PhysicsData.types.set(name,cbType);
}
com.cmm.mmc.app.gameState.PhysicsData.material = function(name) {
	if(name == "default") return new nape.phys.Material(); else {
		if(com.cmm.mmc.app.gameState.PhysicsData.materials == null || !com.cmm.mmc.app.gameState.PhysicsData.materials.exists(name)) throw "Error: Material with name '" + name + "' has not been registered";
		return com.cmm.mmc.app.gameState.PhysicsData.materials.get(name);
	}
}
com.cmm.mmc.app.gameState.PhysicsData.filter = function(name) {
	if(name == "default") return new nape.dynamics.InteractionFilter(); else {
		if(com.cmm.mmc.app.gameState.PhysicsData.filters == null || !com.cmm.mmc.app.gameState.PhysicsData.filters.exists(name)) throw "Error: InteractionFilter with name '" + name + "' has not been registered";
		return com.cmm.mmc.app.gameState.PhysicsData.filters.get(name);
	}
}
com.cmm.mmc.app.gameState.PhysicsData.fprop = function(name) {
	if(name == "default") return new nape.phys.FluidProperties(); else {
		if(com.cmm.mmc.app.gameState.PhysicsData.fprops == null || !com.cmm.mmc.app.gameState.PhysicsData.fprops.exists(name)) throw "Error: FluidProperties with name '" + name + "' has not been registered";
		return com.cmm.mmc.app.gameState.PhysicsData.fprops.get(name);
	}
}
com.cmm.mmc.app.gameState.PhysicsData.cbtype = function(name) {
	if(name == "null") return null; else {
		if(com.cmm.mmc.app.gameState.PhysicsData.types == null || !com.cmm.mmc.app.gameState.PhysicsData.types.exists(name)) throw "Error: CbType with name '" + name + "' has not been registered";
		return com.cmm.mmc.app.gameState.PhysicsData.types.get(name);
	}
}
com.cmm.mmc.app.gameState.PhysicsData.lookup = function(name) {
	if(com.cmm.mmc.app.gameState.PhysicsData.bodies == null) com.cmm.mmc.app.gameState.PhysicsData.init();
	if(!com.cmm.mmc.app.gameState.PhysicsData.bodies.exists(name)) throw "Error: Body with name '" + name + "' does not exist";
	return com.cmm.mmc.app.gameState.PhysicsData.bodies.get(name);
}
com.cmm.mmc.app.gameState.PhysicsData.init = function() {
	com.cmm.mmc.app.gameState.PhysicsData.bodies = new Hash();
	var cbType = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType);
	var body = new nape.phys.Body();
	body.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType1 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s = new nape.shape.Polygon([nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(0,6),nape.geom.Vec2.weak(0,93),nape.geom.Vec2.weak(6,99),nape.geom.Vec2.weak(20,93),nape.geom.Vec2.weak(20,6),nape.geom.Vec2.weak(14,0)],mat,filt);
	s.set_body(body);
	s.set_fluidEnabled(false);
	s.set_fluidProperties(prop);
	s.get_cbTypes().add(cbType1);
	var s1 = new nape.shape.Polygon([nape.geom.Vec2.weak(14,99),nape.geom.Vec2.weak(20,93),nape.geom.Vec2.weak(6,99)],mat,filt);
	s1.set_body(body);
	s1.set_fluidEnabled(false);
	s1.set_fluidProperties(prop);
	s1.get_cbTypes().add(cbType1);
	var anchor = false?body.get_localCOM().copy():nape.geom.Vec2.get(10,49.5);
	body.translateShapes(nape.geom.Vec2.weak(-anchor.get_x(),-anchor.get_y()));
	body.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece2",{ body : body, anchor : anchor});
	var cbType2 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType2);
	var body1 = new nape.phys.Body();
	body1.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat1 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt1 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop1 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType3 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s2 = new nape.shape.Polygon([nape.geom.Vec2.weak(60,54),nape.geom.Vec2.weak(60,45),nape.geom.Vec2.weak(15,0),nape.geom.Vec2.weak(7,0),nape.geom.Vec2.weak(0,7),nape.geom.Vec2.weak(0,13),nape.geom.Vec2.weak(46,60),nape.geom.Vec2.weak(54,60)],mat1,filt1);
	s2.set_body(body1);
	s2.set_fluidEnabled(false);
	s2.set_fluidProperties(prop1);
	s2.get_cbTypes().add(cbType3);
	var anchor1 = false?body1.get_localCOM().copy():nape.geom.Vec2.get(10.17,9.2599998);
	body1.translateShapes(nape.geom.Vec2.weak(-anchor1.get_x(),-anchor1.get_y()));
	body1.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece11",{ body : body1, anchor : anchor1});
	var cbType4 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType4);
	var body2 = new nape.phys.Body();
	body2.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat2 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt2 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop2 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType5 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s3 = new nape.shape.Polygon([nape.geom.Vec2.weak(97,0),nape.geom.Vec2.weak(5,0),nape.geom.Vec2.weak(5,7),nape.geom.Vec2.weak(97,7)],mat2,filt2);
	s3.set_body(body2);
	s3.set_fluidEnabled(false);
	s3.set_fluidProperties(prop2);
	s3.get_cbTypes().add(cbType5);
	var anchor2 = false?body2.get_localCOM().copy():nape.geom.Vec2.get(50,42.35000016);
	body2.translateShapes(nape.geom.Vec2.weak(-anchor2.get_x(),-anchor2.get_y()));
	body2.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece13",{ body : body2, anchor : anchor2});
	var cbType6 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType6);
	var body3 = new nape.phys.Body();
	body3.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat3 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt3 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop3 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType7 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s4 = new nape.shape.Polygon([nape.geom.Vec2.weak(90,20),nape.geom.Vec2.weak(90,0),nape.geom.Vec2.weak(10,0),nape.geom.Vec2.weak(10,20)],mat3,filt3);
	s4.set_body(body3);
	s4.set_fluidEnabled(false);
	s4.set_fluidProperties(prop3);
	s4.get_cbTypes().add(cbType7);
	var anchor3 = false?body3.get_localCOM().copy():nape.geom.Vec2.get(50.5,10);
	body3.translateShapes(nape.geom.Vec2.weak(-anchor3.get_x(),-anchor3.get_y()));
	body3.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece17",{ body : body3, anchor : anchor3});
	var cbType8 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType8);
	var body4 = new nape.phys.Body();
	body4.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat4 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt4 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop4 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType9 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s5 = new nape.shape.Polygon([nape.geom.Vec2.weak(101,6),nape.geom.Vec2.weak(95,0),nape.geom.Vec2.weak(85,0),nape.geom.Vec2.weak(0,85),nape.geom.Vec2.weak(16,100),nape.geom.Vec2.weak(101,15)],mat4,filt4);
	s5.set_body(body4);
	s5.set_fluidEnabled(false);
	s5.set_fluidProperties(prop4);
	s5.get_cbTypes().add(cbType9);
	var s6 = new nape.shape.Polygon([nape.geom.Vec2.weak(7,100),nape.geom.Vec2.weak(16,100),nape.geom.Vec2.weak(0,85),nape.geom.Vec2.weak(0,93)],mat4,filt4);
	s6.set_body(body4);
	s6.set_fluidEnabled(false);
	s6.set_fluidProperties(prop4);
	s6.get_cbTypes().add(cbType9);
	var anchor4 = false?body4.get_localCOM().copy():nape.geom.Vec2.get(50.5,50);
	body4.translateShapes(nape.geom.Vec2.weak(-anchor4.get_x(),-anchor4.get_y()));
	body4.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece21",{ body : body4, anchor : anchor4});
	var cbType10 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType10);
	var body5 = new nape.phys.Body();
	body5.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat5 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt5 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop5 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType11 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s7 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,15),nape.geom.Vec2.weak(7,20),nape.geom.Vec2.weak(93,20),nape.geom.Vec2.weak(93,0),nape.geom.Vec2.weak(7,0),nape.geom.Vec2.weak(0,6)],mat5,filt5);
	s7.set_body(body5);
	s7.set_fluidEnabled(false);
	s7.set_fluidProperties(prop5);
	s7.get_cbTypes().add(cbType11);
	var s8 = new nape.shape.Polygon([nape.geom.Vec2.weak(99,15),nape.geom.Vec2.weak(99,6),nape.geom.Vec2.weak(93,0),nape.geom.Vec2.weak(93,20)],mat5,filt5);
	s8.set_body(body5);
	s8.set_fluidEnabled(false);
	s8.set_fluidProperties(prop5);
	s8.get_cbTypes().add(cbType11);
	var anchor5 = false?body5.get_localCOM().copy():nape.geom.Vec2.get(49.5,10);
	body5.translateShapes(nape.geom.Vec2.weak(-anchor5.get_x(),-anchor5.get_y()));
	body5.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece1",{ body : body5, anchor : anchor5});
	var cbType12 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType12);
	var body6 = new nape.phys.Body();
	body6.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat6 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt6 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop6 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType13 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s9 = new nape.shape.Polygon([nape.geom.Vec2.weak(99,94),nape.geom.Vec2.weak(99,84),nape.geom.Vec2.weak(93,80),nape.geom.Vec2.weak(77,78),nape.geom.Vec2.weak(8,100),nape.geom.Vec2.weak(92,100)],mat6,filt6);
	s9.set_body(body6);
	s9.set_fluidEnabled(false);
	s9.set_fluidProperties(prop6);
	s9.get_cbTypes().add(cbType13);
	var s10 = new nape.shape.Polygon([nape.geom.Vec2.weak(14,0),nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(0,6),nape.geom.Vec2.weak(21,19),nape.geom.Vec2.weak(20,6)],mat6,filt6);
	s10.set_body(body6);
	s10.set_fluidEnabled(false);
	s10.set_fluidProperties(prop6);
	s10.get_cbTypes().add(cbType13);
	var s11 = new nape.shape.Polygon([nape.geom.Vec2.weak(21,19),nape.geom.Vec2.weak(0,6),nape.geom.Vec2.weak(0,94),nape.geom.Vec2.weak(24,34)],mat6,filt6);
	s11.set_body(body6);
	s11.set_fluidEnabled(false);
	s11.set_fluidProperties(prop6);
	s11.get_cbTypes().add(cbType13);
	var s12 = new nape.shape.Polygon([nape.geom.Vec2.weak(24,34),nape.geom.Vec2.weak(0,94),nape.geom.Vec2.weak(30,47)],mat6,filt6);
	s12.set_body(body6);
	s12.set_fluidEnabled(false);
	s12.set_fluidProperties(prop6);
	s12.get_cbTypes().add(cbType13);
	var s13 = new nape.shape.Polygon([nape.geom.Vec2.weak(30,47),nape.geom.Vec2.weak(0,94),nape.geom.Vec2.weak(38,59)],mat6,filt6);
	s13.set_body(body6);
	s13.set_fluidEnabled(false);
	s13.set_fluidProperties(prop6);
	s13.get_cbTypes().add(cbType13);
	var s14 = new nape.shape.Polygon([nape.geom.Vec2.weak(38,59),nape.geom.Vec2.weak(0,94),nape.geom.Vec2.weak(8,100),nape.geom.Vec2.weak(49,68)],mat6,filt6);
	s14.set_body(body6);
	s14.set_fluidEnabled(false);
	s14.set_fluidProperties(prop6);
	s14.get_cbTypes().add(cbType13);
	var s15 = new nape.shape.Polygon([nape.geom.Vec2.weak(49,68),nape.geom.Vec2.weak(8,100),nape.geom.Vec2.weak(61,74)],mat6,filt6);
	s15.set_body(body6);
	s15.set_fluidEnabled(false);
	s15.set_fluidProperties(prop6);
	s15.get_cbTypes().add(cbType13);
	var s16 = new nape.shape.Polygon([nape.geom.Vec2.weak(77,78),nape.geom.Vec2.weak(61,74),nape.geom.Vec2.weak(8,100)],mat6,filt6);
	s16.set_body(body6);
	s16.set_fluidEnabled(false);
	s16.set_fluidProperties(prop6);
	s16.get_cbTypes().add(cbType13);
	var anchor6 = false?body6.get_localCOM().copy():nape.geom.Vec2.get(9.78000012,89.65);
	body6.translateShapes(nape.geom.Vec2.weak(-anchor6.get_x(),-anchor6.get_y()));
	body6.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece3",{ body : body6, anchor : anchor6});
	var cbType14 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType14);
	var body7 = new nape.phys.Body();
	body7.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat7 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt7 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop7 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType15 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s17 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,14),nape.geom.Vec2.weak(6,19),nape.geom.Vec2.weak(16,21),nape.geom.Vec2.weak(54,0),nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(0,6)],mat7,filt7);
	s17.set_body(body7);
	s17.set_fluidEnabled(false);
	s17.set_fluidProperties(prop7);
	s17.get_cbTypes().add(cbType15);
	var s18 = new nape.shape.Polygon([nape.geom.Vec2.weak(47,60),nape.geom.Vec2.weak(53,60),nape.geom.Vec2.weak(60,54),nape.geom.Vec2.weak(60,6),nape.geom.Vec2.weak(38,45),nape.geom.Vec2.weak(41,54)],mat7,filt7);
	s18.set_body(body7);
	s18.set_fluidEnabled(false);
	s18.set_fluidProperties(prop7);
	s18.get_cbTypes().add(cbType15);
	var s19 = new nape.shape.Polygon([nape.geom.Vec2.weak(38,45),nape.geom.Vec2.weak(60,6),nape.geom.Vec2.weak(54,0),nape.geom.Vec2.weak(34,37)],mat7,filt7);
	s19.set_body(body7);
	s19.set_fluidEnabled(false);
	s19.set_fluidProperties(prop7);
	s19.get_cbTypes().add(cbType15);
	var s20 = new nape.shape.Polygon([nape.geom.Vec2.weak(34,37),nape.geom.Vec2.weak(54,0),nape.geom.Vec2.weak(29,31)],mat7,filt7);
	s20.set_body(body7);
	s20.set_fluidEnabled(false);
	s20.set_fluidProperties(prop7);
	s20.get_cbTypes().add(cbType15);
	var s21 = new nape.shape.Polygon([nape.geom.Vec2.weak(29,31),nape.geom.Vec2.weak(54,0),nape.geom.Vec2.weak(23,25)],mat7,filt7);
	s21.set_body(body7);
	s21.set_fluidEnabled(false);
	s21.set_fluidProperties(prop7);
	s21.get_cbTypes().add(cbType15);
	var s22 = new nape.shape.Polygon([nape.geom.Vec2.weak(23,25),nape.geom.Vec2.weak(54,0),nape.geom.Vec2.weak(16,21)],mat7,filt7);
	s22.set_body(body7);
	s22.set_fluidEnabled(false);
	s22.set_fluidProperties(prop7);
	s22.get_cbTypes().add(cbType15);
	var anchor7 = false?body7.get_localCOM().copy():nape.geom.Vec2.get(49.6999998,10.05);
	body7.translateShapes(nape.geom.Vec2.weak(-anchor7.get_x(),-anchor7.get_y()));
	body7.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece10",{ body : body7, anchor : anchor7});
	var cbType16 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType16);
	var body8 = new nape.phys.Body();
	body8.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat8 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt8 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop8 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType17 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s23 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,54),nape.geom.Vec2.weak(6,60),nape.geom.Vec2.weak(13,60),nape.geom.Vec2.weak(60,14),nape.geom.Vec2.weak(45,0),nape.geom.Vec2.weak(0,45)],mat8,filt8);
	s23.set_body(body8);
	s23.set_fluidEnabled(false);
	s23.set_fluidProperties(prop8);
	s23.get_cbTypes().add(cbType17);
	var s24 = new nape.shape.Polygon([nape.geom.Vec2.weak(60,5),nape.geom.Vec2.weak(55,0),nape.geom.Vec2.weak(45,0),nape.geom.Vec2.weak(60,14)],mat8,filt8);
	s24.set_body(body8);
	s24.set_fluidEnabled(false);
	s24.set_fluidProperties(prop8);
	s24.get_cbTypes().add(cbType17);
	var anchor8 = false?body8.get_localCOM().copy():nape.geom.Vec2.get(49.4899998,9.6100002);
	body8.translateShapes(nape.geom.Vec2.weak(-anchor8.get_x(),-anchor8.get_y()));
	body8.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece12",{ body : body8, anchor : anchor8});
	var cbType18 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType18);
	var body9 = new nape.phys.Body();
	body9.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat9 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt9 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop9 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType19 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s25 = new nape.shape.Polygon([nape.geom.Vec2.weak(51,97),nape.geom.Vec2.weak(51,4),nape.geom.Vec2.weak(44,4),nape.geom.Vec2.weak(44,97)],mat9,filt9);
	s25.set_body(body9);
	s25.set_fluidEnabled(false);
	s25.set_fluidProperties(prop9);
	s25.get_cbTypes().add(cbType19);
	var anchor9 = false?body9.get_localCOM().copy():nape.geom.Vec2.get(10.24999989,50);
	body9.translateShapes(nape.geom.Vec2.weak(-anchor9.get_x(),-anchor9.get_y()));
	body9.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece14",{ body : body9, anchor : anchor9});
	var cbType20 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType20);
	var body10 = new nape.phys.Body();
	body10.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat10 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt10 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop10 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType21 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s26 = new nape.shape.Polygon([nape.geom.Vec2.weak(3,51),nape.geom.Vec2.weak(95,51),nape.geom.Vec2.weak(95,44),nape.geom.Vec2.weak(3,44)],mat10,filt10);
	s26.set_body(body10);
	s26.set_fluidEnabled(false);
	s26.set_fluidProperties(prop10);
	s26.get_cbTypes().add(cbType21);
	var anchor10 = false?body10.get_localCOM().copy():nape.geom.Vec2.get(50,10.09);
	body10.translateShapes(nape.geom.Vec2.weak(-anchor10.get_x(),-anchor10.get_y()));
	body10.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece15",{ body : body10, anchor : anchor10});
	var cbType22 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType22);
	var body11 = new nape.phys.Body();
	body11.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat11 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt11 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop11 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType23 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s27 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,3),nape.geom.Vec2.weak(0,95),nape.geom.Vec2.weak(7,95),nape.geom.Vec2.weak(7,3)],mat11,filt11);
	s27.set_body(body11);
	s27.set_fluidEnabled(false);
	s27.set_fluidProperties(prop11);
	s27.get_cbTypes().add(cbType23);
	var anchor11 = false?body11.get_localCOM().copy():nape.geom.Vec2.get(40.9,50);
	body11.translateShapes(nape.geom.Vec2.weak(-anchor11.get_x(),-anchor11.get_y()));
	body11.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece16",{ body : body11, anchor : anchor11});
	var cbType24 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType24);
	var body12 = new nape.phys.Body();
	body12.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat12 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt12 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop12 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType25 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s28 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,90),nape.geom.Vec2.weak(20,90),nape.geom.Vec2.weak(20,10),nape.geom.Vec2.weak(0,10)],mat12,filt12);
	s28.set_body(body12);
	s28.set_fluidEnabled(false);
	s28.set_fluidProperties(prop12);
	s28.get_cbTypes().add(cbType25);
	var anchor12 = false?body12.get_localCOM().copy():nape.geom.Vec2.get(10,50.5);
	body12.translateShapes(nape.geom.Vec2.weak(-anchor12.get_x(),-anchor12.get_y()));
	body12.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece18",{ body : body12, anchor : anchor12});
	var cbType26 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType26);
	var body13 = new nape.phys.Body();
	body13.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat13 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt13 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop13 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType27 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s29 = new nape.shape.Polygon([nape.geom.Vec2.weak(100,95),nape.geom.Vec2.weak(100,85),nape.geom.Vec2.weak(15,0),nape.geom.Vec2.weak(7,0),nape.geom.Vec2.weak(0,16),nape.geom.Vec2.weak(85,101),nape.geom.Vec2.weak(93,101)],mat13,filt13);
	s29.set_body(body13);
	s29.set_fluidEnabled(false);
	s29.set_fluidProperties(prop13);
	s29.get_cbTypes().add(cbType27);
	var s30 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,7),nape.geom.Vec2.weak(0,16),nape.geom.Vec2.weak(7,0)],mat13,filt13);
	s30.set_body(body13);
	s30.set_fluidEnabled(false);
	s30.set_fluidProperties(prop13);
	s30.get_cbTypes().add(cbType27);
	var anchor13 = false?body13.get_localCOM().copy():nape.geom.Vec2.get(50,50.5);
	body13.translateShapes(nape.geom.Vec2.weak(-anchor13.get_x(),-anchor13.get_y()));
	body13.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece22",{ body : body13, anchor : anchor13});
	var cbType28 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType28);
	var body14 = new nape.phys.Body();
	body14.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat14 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt14 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop14 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType29 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s31 = new nape.shape.Polygon([nape.geom.Vec2.weak(5,0),nape.geom.Vec2.weak(4,0),nape.geom.Vec2.weak(4,8),nape.geom.Vec2.weak(5,1)],mat14,filt14);
	s31.set_body(body14);
	s31.set_fluidEnabled(false);
	s31.set_fluidProperties(prop14);
	s31.get_cbTypes().add(cbType29);
	var s32 = new nape.shape.Polygon([nape.geom.Vec2.weak(97,0),nape.geom.Vec2.weak(97,1),nape.geom.Vec2.weak(98,8),nape.geom.Vec2.weak(98,0)],mat14,filt14);
	s32.set_body(body14);
	s32.set_fluidEnabled(false);
	s32.set_fluidProperties(prop14);
	s32.get_cbTypes().add(cbType29);
	var s33 = new nape.shape.Polygon([nape.geom.Vec2.weak(100,37),nape.geom.Vec2.weak(94,31),nape.geom.Vec2.weak(39,31),nape.geom.Vec2.weak(6,51),nape.geom.Vec2.weak(94,51),nape.geom.Vec2.weak(100,45)],mat14,filt14);
	s33.set_body(body14);
	s33.set_fluidEnabled(false);
	s33.set_fluidProperties(prop14);
	s33.get_cbTypes().add(cbType29);
	var s34 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,45),nape.geom.Vec2.weak(6,51),nape.geom.Vec2.weak(39,31),nape.geom.Vec2.weak(6,31),nape.geom.Vec2.weak(0,37)],mat14,filt14);
	s34.set_body(body14);
	s34.set_fluidEnabled(false);
	s34.set_fluidProperties(prop14);
	s34.get_cbTypes().add(cbType29);
	var s35 = new nape.shape.Polygon([nape.geom.Vec2.weak(62,31),nape.geom.Vec2.weak(62,8),nape.geom.Vec2.weak(39,8),nape.geom.Vec2.weak(39,31)],mat14,filt14);
	s35.set_body(body14);
	s35.set_fluidEnabled(false);
	s35.set_fluidProperties(prop14);
	s35.get_cbTypes().add(cbType29);
	var s36 = new nape.shape.Polygon([nape.geom.Vec2.weak(98,8),nape.geom.Vec2.weak(97,1),nape.geom.Vec2.weak(5,1),nape.geom.Vec2.weak(4,8)],mat14,filt14);
	s36.set_body(body14);
	s36.set_fluidEnabled(false);
	s36.set_fluidProperties(prop14);
	s36.get_cbTypes().add(cbType29);
	var anchor14 = false?body14.get_localCOM().copy():nape.geom.Vec2.get(50,42.35000016);
	body14.translateShapes(nape.geom.Vec2.weak(-anchor14.get_x(),-anchor14.get_y()));
	body14.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece13a",{ body : body14, anchor : anchor14});
	var cbType30 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType30);
	var body15 = new nape.phys.Body();
	body15.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat15 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt15 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop15 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType31 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s37 = new nape.shape.Polygon([nape.geom.Vec2.weak(51,97),nape.geom.Vec2.weak(50,97),nape.geom.Vec2.weak(43,98),nape.geom.Vec2.weak(51,98)],mat15,filt15);
	s37.set_body(body15);
	s37.set_fluidEnabled(false);
	s37.set_fluidProperties(prop15);
	s37.get_cbTypes().add(cbType31);
	var s38 = new nape.shape.Polygon([nape.geom.Vec2.weak(51,5),nape.geom.Vec2.weak(51,4),nape.geom.Vec2.weak(43,4),nape.geom.Vec2.weak(50,5)],mat15,filt15);
	s38.set_body(body15);
	s38.set_fluidEnabled(false);
	s38.set_fluidProperties(prop15);
	s38.get_cbTypes().add(cbType31);
	var s39 = new nape.shape.Polygon([nape.geom.Vec2.weak(14,100),nape.geom.Vec2.weak(20,94),nape.geom.Vec2.weak(20,39),nape.geom.Vec2.weak(0,6),nape.geom.Vec2.weak(0,94),nape.geom.Vec2.weak(6,100)],mat15,filt15);
	s39.set_body(body15);
	s39.set_fluidEnabled(false);
	s39.set_fluidProperties(prop15);
	s39.get_cbTypes().add(cbType31);
	var s40 = new nape.shape.Polygon([nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(0,6),nape.geom.Vec2.weak(20,39),nape.geom.Vec2.weak(20,6),nape.geom.Vec2.weak(14,0)],mat15,filt15);
	s40.set_body(body15);
	s40.set_fluidEnabled(false);
	s40.set_fluidProperties(prop15);
	s40.get_cbTypes().add(cbType31);
	var s41 = new nape.shape.Polygon([nape.geom.Vec2.weak(20,62),nape.geom.Vec2.weak(43,62),nape.geom.Vec2.weak(43,39),nape.geom.Vec2.weak(20,39)],mat15,filt15);
	s41.set_body(body15);
	s41.set_fluidEnabled(false);
	s41.set_fluidProperties(prop15);
	s41.get_cbTypes().add(cbType31);
	var s42 = new nape.shape.Polygon([nape.geom.Vec2.weak(43,98),nape.geom.Vec2.weak(50,97),nape.geom.Vec2.weak(50,5),nape.geom.Vec2.weak(43,4)],mat15,filt15);
	s42.set_body(body15);
	s42.set_fluidEnabled(false);
	s42.set_fluidProperties(prop15);
	s42.get_cbTypes().add(cbType31);
	var anchor15 = false?body15.get_localCOM().copy():nape.geom.Vec2.get(10.24999989,50);
	body15.translateShapes(nape.geom.Vec2.weak(-anchor15.get_x(),-anchor15.get_y()));
	body15.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece14a",{ body : body15, anchor : anchor15});
	var cbType32 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType32);
	var body16 = new nape.phys.Body();
	body16.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat16 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt16 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop16 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType33 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s43 = new nape.shape.Polygon([nape.geom.Vec2.weak(95,51),nape.geom.Vec2.weak(96,51),nape.geom.Vec2.weak(96,43),nape.geom.Vec2.weak(95,50)],mat16,filt16);
	s43.set_body(body16);
	s43.set_fluidEnabled(false);
	s43.set_fluidProperties(prop16);
	s43.get_cbTypes().add(cbType33);
	var s44 = new nape.shape.Polygon([nape.geom.Vec2.weak(3,51),nape.geom.Vec2.weak(3,50),nape.geom.Vec2.weak(2,43),nape.geom.Vec2.weak(2,51)],mat16,filt16);
	s44.set_body(body16);
	s44.set_fluidEnabled(false);
	s44.set_fluidProperties(prop16);
	s44.get_cbTypes().add(cbType33);
	var s45 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,14),nape.geom.Vec2.weak(6,20),nape.geom.Vec2.weak(61,20),nape.geom.Vec2.weak(94,0),nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(0,6)],mat16,filt16);
	s45.set_body(body16);
	s45.set_fluidEnabled(false);
	s45.set_fluidProperties(prop16);
	s45.get_cbTypes().add(cbType33);
	var s46 = new nape.shape.Polygon([nape.geom.Vec2.weak(100,6),nape.geom.Vec2.weak(94,0),nape.geom.Vec2.weak(61,20),nape.geom.Vec2.weak(94,20),nape.geom.Vec2.weak(100,14)],mat16,filt16);
	s46.set_body(body16);
	s46.set_fluidEnabled(false);
	s46.set_fluidProperties(prop16);
	s46.get_cbTypes().add(cbType33);
	var s47 = new nape.shape.Polygon([nape.geom.Vec2.weak(38,20),nape.geom.Vec2.weak(38,43),nape.geom.Vec2.weak(61,43),nape.geom.Vec2.weak(61,20)],mat16,filt16);
	s47.set_body(body16);
	s47.set_fluidEnabled(false);
	s47.set_fluidProperties(prop16);
	s47.get_cbTypes().add(cbType33);
	var s48 = new nape.shape.Polygon([nape.geom.Vec2.weak(2,43),nape.geom.Vec2.weak(3,50),nape.geom.Vec2.weak(95,50),nape.geom.Vec2.weak(96,43)],mat16,filt16);
	s48.set_body(body16);
	s48.set_fluidEnabled(false);
	s48.set_fluidProperties(prop16);
	s48.get_cbTypes().add(cbType33);
	var anchor16 = false?body16.get_localCOM().copy():nape.geom.Vec2.get(50,10.09000014);
	body16.translateShapes(nape.geom.Vec2.weak(-anchor16.get_x(),-anchor16.get_y()));
	body16.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece15a",{ body : body16, anchor : anchor16});
	var cbType34 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType34);
	var body17 = new nape.phys.Body();
	body17.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat17 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt17 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop17 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType35 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s49 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,3),nape.geom.Vec2.weak(1,3),nape.geom.Vec2.weak(8,2),nape.geom.Vec2.weak(0,2)],mat17,filt17);
	s49.set_body(body17);
	s49.set_fluidEnabled(false);
	s49.set_fluidProperties(prop17);
	s49.get_cbTypes().add(cbType35);
	var s50 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,95),nape.geom.Vec2.weak(0,96),nape.geom.Vec2.weak(8,96),nape.geom.Vec2.weak(1,95)],mat17,filt17);
	s50.set_body(body17);
	s50.set_fluidEnabled(false);
	s50.set_fluidProperties(prop17);
	s50.get_cbTypes().add(cbType35);
	var s51 = new nape.shape.Polygon([nape.geom.Vec2.weak(37,0),nape.geom.Vec2.weak(31,6),nape.geom.Vec2.weak(31,61),nape.geom.Vec2.weak(51,94),nape.geom.Vec2.weak(51,6),nape.geom.Vec2.weak(45,0)],mat17,filt17);
	s51.set_body(body17);
	s51.set_fluidEnabled(false);
	s51.set_fluidProperties(prop17);
	s51.get_cbTypes().add(cbType35);
	var s52 = new nape.shape.Polygon([nape.geom.Vec2.weak(45,100),nape.geom.Vec2.weak(51,94),nape.geom.Vec2.weak(31,61),nape.geom.Vec2.weak(31,94),nape.geom.Vec2.weak(37,100)],mat17,filt17);
	s52.set_body(body17);
	s52.set_fluidEnabled(false);
	s52.set_fluidProperties(prop17);
	s52.get_cbTypes().add(cbType35);
	var s53 = new nape.shape.Polygon([nape.geom.Vec2.weak(31,38),nape.geom.Vec2.weak(8,38),nape.geom.Vec2.weak(8,61),nape.geom.Vec2.weak(31,61)],mat17,filt17);
	s53.set_body(body17);
	s53.set_fluidEnabled(false);
	s53.set_fluidProperties(prop17);
	s53.get_cbTypes().add(cbType35);
	var s54 = new nape.shape.Polygon([nape.geom.Vec2.weak(8,2),nape.geom.Vec2.weak(1,3),nape.geom.Vec2.weak(1,95),nape.geom.Vec2.weak(8,96)],mat17,filt17);
	s54.set_body(body17);
	s54.set_fluidEnabled(false);
	s54.set_fluidProperties(prop17);
	s54.get_cbTypes().add(cbType35);
	var anchor17 = false?body17.get_localCOM().copy():nape.geom.Vec2.get(40.89999978,50);
	body17.translateShapes(nape.geom.Vec2.weak(-anchor17.get_x(),-anchor17.get_y()));
	body17.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece16a",{ body : body17, anchor : anchor17});
	var cbType36 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType36);
	var body18 = new nape.phys.Body();
	body18.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat18 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt18 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop18 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType37 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s55 = new nape.shape.Polygon([nape.geom.Vec2.weak(91,20),nape.geom.Vec2.weak(91,0),nape.geom.Vec2.weak(11,0),nape.geom.Vec2.weak(11,20)],mat18,filt18);
	s55.set_body(body18);
	s55.set_fluidEnabled(false);
	s55.set_fluidProperties(prop18);
	s55.get_cbTypes().add(cbType37);
	var anchor18 = false?body18.get_localCOM().copy():nape.geom.Vec2.get(50.5,10);
	body18.translateShapes(nape.geom.Vec2.weak(-anchor18.get_x(),-anchor18.get_y()));
	body18.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece19",{ body : body18, anchor : anchor18});
	var cbType38 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType38);
	var body19 = new nape.phys.Body();
	body19.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat19 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt19 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop19 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType39 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s56 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,90),nape.geom.Vec2.weak(20,90),nape.geom.Vec2.weak(20,11),nape.geom.Vec2.weak(0,11)],mat19,filt19);
	s56.set_body(body19);
	s56.set_fluidEnabled(false);
	s56.set_fluidProperties(prop19);
	s56.get_cbTypes().add(cbType39);
	var anchor19 = false?body19.get_localCOM().copy():nape.geom.Vec2.get(10,50.5);
	body19.translateShapes(nape.geom.Vec2.weak(-anchor19.get_x(),-anchor19.get_y()));
	body19.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece20",{ body : body19, anchor : anchor19});
	var cbType40 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType40);
	var body20 = new nape.phys.Body();
	body20.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat20 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt20 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop20 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType41 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s57 = new nape.shape.Polygon([nape.geom.Vec2.weak(14,100),nape.geom.Vec2.weak(20,94),nape.geom.Vec2.weak(20,89),nape.geom.Vec2.weak(0,89),nape.geom.Vec2.weak(0,94),nape.geom.Vec2.weak(6,100)],mat20,filt20);
	s57.set_body(body20);
	s57.set_fluidEnabled(false);
	s57.set_fluidProperties(prop20);
	s57.get_cbTypes().add(cbType41);
	var mat21 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt21 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop21 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType42 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s58 = new nape.shape.Polygon([nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(0,6),nape.geom.Vec2.weak(0,11),nape.geom.Vec2.weak(20,11),nape.geom.Vec2.weak(20,6),nape.geom.Vec2.weak(14,0)],mat21,filt21);
	s58.set_body(body20);
	s58.set_fluidEnabled(false);
	s58.set_fluidProperties(prop21);
	s58.get_cbTypes().add(cbType42);
	var anchor20 = false?body20.get_localCOM().copy():nape.geom.Vec2.get(10,50.5);
	body20.translateShapes(nape.geom.Vec2.weak(-anchor20.get_x(),-anchor20.get_y()));
	body20.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece20a",{ body : body20, anchor : anchor20});
	var cbType43 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType43);
	var body21 = new nape.phys.Body();
	body21.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat22 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt22 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop22 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType44 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s59 = new nape.shape.Polygon([nape.geom.Vec2.weak(1,14),nape.geom.Vec2.weak(7,20),nape.geom.Vec2.weak(11,20),nape.geom.Vec2.weak(11,0),nape.geom.Vec2.weak(7,0),nape.geom.Vec2.weak(1,6)],mat22,filt22);
	s59.set_body(body21);
	s59.set_fluidEnabled(false);
	s59.set_fluidProperties(prop22);
	s59.get_cbTypes().add(cbType44);
	var mat23 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt23 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop23 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType45 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s60 = new nape.shape.Polygon([nape.geom.Vec2.weak(100,5),nape.geom.Vec2.weak(95,0),nape.geom.Vec2.weak(91,0),nape.geom.Vec2.weak(91,20),nape.geom.Vec2.weak(95,20),nape.geom.Vec2.weak(100,15)],mat23,filt23);
	s60.set_body(body21);
	s60.set_fluidEnabled(false);
	s60.set_fluidProperties(prop23);
	s60.get_cbTypes().add(cbType45);
	var anchor21 = false?body21.get_localCOM().copy():nape.geom.Vec2.get(50.5,10);
	body21.translateShapes(nape.geom.Vec2.weak(-anchor21.get_x(),-anchor21.get_y()));
	body21.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece19a",{ body : body21, anchor : anchor21});
	var cbType46 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType46);
	var body22 = new nape.phys.Body();
	body22.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat24 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt24 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop24 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType47 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s61 = new nape.shape.Polygon([nape.geom.Vec2.weak(14,100),nape.geom.Vec2.weak(20,94),nape.geom.Vec2.weak(20,90),nape.geom.Vec2.weak(0,90),nape.geom.Vec2.weak(0,94),nape.geom.Vec2.weak(6,100)],mat24,filt24);
	s61.set_body(body22);
	s61.set_fluidEnabled(false);
	s61.set_fluidProperties(prop24);
	s61.get_cbTypes().add(cbType47);
	var mat25 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt25 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop25 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType48 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s62 = new nape.shape.Polygon([nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(0,6),nape.geom.Vec2.weak(0,11),nape.geom.Vec2.weak(20,11),nape.geom.Vec2.weak(20,6),nape.geom.Vec2.weak(14,0)],mat25,filt25);
	s62.set_body(body22);
	s62.set_fluidEnabled(false);
	s62.set_fluidProperties(prop25);
	s62.get_cbTypes().add(cbType48);
	var anchor22 = false?body22.get_localCOM().copy():nape.geom.Vec2.get(10,50.5);
	body22.translateShapes(nape.geom.Vec2.weak(-anchor22.get_x(),-anchor22.get_y()));
	body22.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece18a",{ body : body22, anchor : anchor22});
	var cbType49 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType49);
	var body23 = new nape.phys.Body();
	body23.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat26 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt26 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop26 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType50 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s63 = new nape.shape.Polygon([nape.geom.Vec2.weak(1,5),nape.geom.Vec2.weak(1,15),nape.geom.Vec2.weak(6,20),nape.geom.Vec2.weak(10,20),nape.geom.Vec2.weak(10,0),nape.geom.Vec2.weak(6,0)],mat26,filt26);
	s63.set_body(body23);
	s63.set_fluidEnabled(false);
	s63.set_fluidProperties(prop26);
	s63.get_cbTypes().add(cbType50);
	var mat27 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt27 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop27 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType51 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s64 = new nape.shape.Polygon([nape.geom.Vec2.weak(100,5),nape.geom.Vec2.weak(94,0),nape.geom.Vec2.weak(90,0),nape.geom.Vec2.weak(90,20),nape.geom.Vec2.weak(94,20),nape.geom.Vec2.weak(100,15)],mat27,filt27);
	s64.set_body(body23);
	s64.set_fluidEnabled(false);
	s64.set_fluidProperties(prop27);
	s64.get_cbTypes().add(cbType51);
	var anchor23 = false?body23.get_localCOM().copy():nape.geom.Vec2.get(50.5,10);
	body23.translateShapes(nape.geom.Vec2.weak(-anchor23.get_x(),-anchor23.get_y()));
	body23.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece17a",{ body : body23, anchor : anchor23});
	var cbType52 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType52);
	var body24 = new nape.phys.Body();
	body24.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat28 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt28 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop28 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType53 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s65 = new nape.shape.Polygon([nape.geom.Vec2.weak(8,63),nape.geom.Vec2.weak(10,72),nape.geom.Vec2.weak(13,76),nape.geom.Vec2.weak(23,76),nape.geom.Vec2.weak(39,66),nape.geom.Vec2.weak(12,55)],mat28,filt28);
	s65.set_body(body24);
	s65.set_fluidEnabled(false);
	s65.set_fluidProperties(prop28);
	s65.get_cbTypes().add(cbType53);
	var s66 = new nape.shape.Polygon([nape.geom.Vec2.weak(12,55),nape.geom.Vec2.weak(39,66),nape.geom.Vec2.weak(42,61),nape.geom.Vec2.weak(43,50),nape.geom.Vec2.weak(12,30),nape.geom.Vec2.weak(10,38)],mat28,filt28);
	s66.set_body(body24);
	s66.set_fluidEnabled(false);
	s66.set_fluidProperties(prop28);
	s66.get_cbTypes().add(cbType53);
	var s67 = new nape.shape.Polygon([nape.geom.Vec2.weak(56,4),nape.geom.Vec2.weak(54,0),nape.geom.Vec2.weak(25,13),nape.geom.Vec2.weak(42,13)],mat28,filt28);
	s67.set_body(body24);
	s67.set_fluidEnabled(false);
	s67.set_fluidProperties(prop28);
	s67.get_cbTypes().add(cbType53);
	var s68 = new nape.shape.Polygon([nape.geom.Vec2.weak(42,13),nape.geom.Vec2.weak(25,13),nape.geom.Vec2.weak(11,16),nape.geom.Vec2.weak(41,39)],mat28,filt28);
	s68.set_body(body24);
	s68.set_fluidEnabled(false);
	s68.set_fluidProperties(prop28);
	s68.get_cbTypes().add(cbType53);
	var s69 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,11),nape.geom.Vec2.weak(11,16),nape.geom.Vec2.weak(25,13),nape.geom.Vec2.weak(0,8)],mat28,filt28);
	s69.set_body(body24);
	s69.set_fluidEnabled(false);
	s69.set_fluidProperties(prop28);
	s69.get_cbTypes().add(cbType53);
	var s70 = new nape.shape.Polygon([nape.geom.Vec2.weak(41,39),nape.geom.Vec2.weak(11,16),nape.geom.Vec2.weak(12,21),nape.geom.Vec2.weak(43,50)],mat28,filt28);
	s70.set_body(body24);
	s70.set_fluidEnabled(false);
	s70.set_fluidProperties(prop28);
	s70.get_cbTypes().add(cbType53);
	var s71 = new nape.shape.Polygon([nape.geom.Vec2.weak(12,30),nape.geom.Vec2.weak(43,50),nape.geom.Vec2.weak(12,21)],mat28,filt28);
	s71.set_body(body24);
	s71.set_fluidEnabled(false);
	s71.set_fluidProperties(prop28);
	s71.get_cbTypes().add(cbType53);
	var anchor24 = true?body24.get_localCOM().copy():nape.geom.Vec2.get(25.25000022,62.0099998);
	body24.translateShapes(nape.geom.Vec2.weak(-anchor24.get_x(),-anchor24.get_y()));
	body24.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece23",{ body : body24, anchor : anchor24});
	var cbType54 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType54);
	var body25 = new nape.phys.Body();
	body25.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat29 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt29 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop29 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType55 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s72 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,68),nape.geom.Vec2.weak(0,73),nape.geom.Vec2.weak(14,92),nape.geom.Vec2.weak(20,79),nape.geom.Vec2.weak(9,69),nape.geom.Vec2.weak(5,68)],mat29,filt29);
	s72.set_body(body25);
	s72.set_fluidEnabled(false);
	s72.set_fluidProperties(prop29);
	s72.get_cbTypes().add(cbType55);
	var s73 = new nape.shape.Polygon([nape.geom.Vec2.weak(84,95),nape.geom.Vec2.weak(90,95),nape.geom.Vec2.weak(102,78),nape.geom.Vec2.weak(83,87)],mat29,filt29);
	s73.set_body(body25);
	s73.set_fluidEnabled(false);
	s73.set_fluidProperties(prop29);
	s73.get_cbTypes().add(cbType55);
	var s74 = new nape.shape.Polygon([nape.geom.Vec2.weak(83,87),nape.geom.Vec2.weak(102,78),nape.geom.Vec2.weak(87,72),nape.geom.Vec2.weak(75,72)],mat29,filt29);
	s74.set_body(body25);
	s74.set_fluidEnabled(false);
	s74.set_fluidProperties(prop29);
	s74.get_cbTypes().add(cbType55);
	var s75 = new nape.shape.Polygon([nape.geom.Vec2.weak(102,70),nape.geom.Vec2.weak(87,72),nape.geom.Vec2.weak(102,78)],mat29,filt29);
	s75.set_body(body25);
	s75.set_fluidEnabled(false);
	s75.set_fluidProperties(prop29);
	s75.get_cbTypes().add(cbType55);
	var s76 = new nape.shape.Polygon([nape.geom.Vec2.weak(67,3),nape.geom.Vec2.weak(58,0),nape.geom.Vec2.weak(41,0),nape.geom.Vec2.weak(53,25),nape.geom.Vec2.weak(67,9)],mat29,filt29);
	s76.set_body(body25);
	s76.set_fluidEnabled(false);
	s76.set_fluidProperties(prop29);
	s76.get_cbTypes().add(cbType55);
	var s77 = new nape.shape.Polygon([nape.geom.Vec2.weak(41,8),nape.geom.Vec2.weak(47,13),nape.geom.Vec2.weak(41,0)],mat29,filt29);
	s77.set_body(body25);
	s77.set_fluidEnabled(false);
	s77.set_fluidProperties(prop29);
	s77.get_cbTypes().add(cbType55);
	var s78 = new nape.shape.Polygon([nape.geom.Vec2.weak(20,88),nape.geom.Vec2.weak(20,79),nape.geom.Vec2.weak(14,92)],mat29,filt29);
	s78.set_body(body25);
	s78.set_fluidEnabled(false);
	s78.set_fluidProperties(prop29);
	s78.get_cbTypes().add(cbType55);
	var s79 = new nape.shape.Polygon([nape.geom.Vec2.weak(9,69),nape.geom.Vec2.weak(20,79),nape.geom.Vec2.weak(34,71),nape.geom.Vec2.weak(25,69)],mat29,filt29);
	s79.set_body(body25);
	s79.set_fluidEnabled(false);
	s79.set_fluidProperties(prop29);
	s79.get_cbTypes().add(cbType55);
	var s80 = new nape.shape.Polygon([nape.geom.Vec2.weak(25,69),nape.geom.Vec2.weak(34,71),nape.geom.Vec2.weak(30,66)],mat29,filt29);
	s80.set_body(body25);
	s80.set_fluidEnabled(false);
	s80.set_fluidProperties(prop29);
	s80.get_cbTypes().add(cbType55);
	var s81 = new nape.shape.Polygon([nape.geom.Vec2.weak(65,33),nape.geom.Vec2.weak(53,30),nape.geom.Vec2.weak(47,30),nape.geom.Vec2.weak(34,71),nape.geom.Vec2.weak(70,68),nape.geom.Vec2.weak(73,63),nape.geom.Vec2.weak(75,51),nape.geom.Vec2.weak(73,42)],mat29,filt29);
	s81.set_body(body25);
	s81.set_fluidEnabled(false);
	s81.set_fluidProperties(prop29);
	s81.get_cbTypes().add(cbType55);
	var s82 = new nape.shape.Polygon([nape.geom.Vec2.weak(64,74),nape.geom.Vec2.weak(70,68),nape.geom.Vec2.weak(34,71),nape.geom.Vec2.weak(40,75),nape.geom.Vec2.weak(47,77),nape.geom.Vec2.weak(55,77)],mat29,filt29);
	s82.set_body(body25);
	s82.set_fluidEnabled(false);
	s82.set_fluidProperties(prop29);
	s82.get_cbTypes().add(cbType55);
	var s83 = new nape.shape.Polygon([nape.geom.Vec2.weak(36,34),nape.geom.Vec2.weak(30,40),nape.geom.Vec2.weak(27,46),nape.geom.Vec2.weak(30,66),nape.geom.Vec2.weak(34,71),nape.geom.Vec2.weak(47,30)],mat29,filt29);
	s83.set_body(body25);
	s83.set_fluidEnabled(false);
	s83.set_fluidProperties(prop29);
	s83.get_cbTypes().add(cbType55);
	var s84 = new nape.shape.Polygon([nape.geom.Vec2.weak(87,72),nape.geom.Vec2.weak(73,63),nape.geom.Vec2.weak(70,68),nape.geom.Vec2.weak(75,72)],mat29,filt29);
	s84.set_body(body25);
	s84.set_fluidEnabled(false);
	s84.set_fluidProperties(prop29);
	s84.get_cbTypes().add(cbType55);
	var s85 = new nape.shape.Polygon([nape.geom.Vec2.weak(27,60),nape.geom.Vec2.weak(30,66),nape.geom.Vec2.weak(27,46)],mat29,filt29);
	s85.set_body(body25);
	s85.set_fluidEnabled(false);
	s85.set_fluidProperties(prop29);
	s85.get_cbTypes().add(cbType55);
	var s86 = new nape.shape.Polygon([nape.geom.Vec2.weak(53,30),nape.geom.Vec2.weak(53,25),nape.geom.Vec2.weak(47,13),nape.geom.Vec2.weak(47,30)],mat29,filt29);
	s86.set_body(body25);
	s86.set_fluidEnabled(false);
	s86.set_fluidProperties(prop29);
	s86.get_cbTypes().add(cbType55);
	var anchor25 = true?body25.get_localCOM().copy():nape.geom.Vec2.get(51.26999997,52.8992395);
	body25.translateShapes(nape.geom.Vec2.weak(-anchor25.get_x(),-anchor25.get_y()));
	body25.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece24",{ body : body25, anchor : anchor25});
	var cbType56 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType56);
	var body26 = new nape.phys.Body();
	body26.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat30 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt30 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop30 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType57 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s87 = new nape.shape.Polygon([nape.geom.Vec2.weak(6,43),nape.geom.Vec2.weak(23,38),nape.geom.Vec2.weak(37,27),nape.geom.Vec2.weak(46,16),nape.geom.Vec2.weak(14,14),nape.geom.Vec2.weak(10,26)],mat30,filt30);
	s87.set_body(body26);
	s87.set_fluidEnabled(false);
	s87.set_fluidProperties(prop30);
	s87.get_cbTypes().add(cbType57);
	var s88 = new nape.shape.Polygon([nape.geom.Vec2.weak(23,0),nape.geom.Vec2.weak(14,14),nape.geom.Vec2.weak(31,15)],mat30,filt30);
	s88.set_body(body26);
	s88.set_fluidEnabled(false);
	s88.set_fluidProperties(prop30);
	s88.get_cbTypes().add(cbType57);
	var s89 = new nape.shape.Polygon([nape.geom.Vec2.weak(40,44),nape.geom.Vec2.weak(37,27),nape.geom.Vec2.weak(23,38)],mat30,filt30);
	s89.set_body(body26);
	s89.set_fluidEnabled(false);
	s89.set_fluidProperties(prop30);
	s89.get_cbTypes().add(cbType57);
	var s90 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,15),nape.geom.Vec2.weak(10,26),nape.geom.Vec2.weak(14,14)],mat30,filt30);
	s90.set_body(body26);
	s90.set_fluidEnabled(false);
	s90.set_fluidProperties(prop30);
	s90.get_cbTypes().add(cbType57);
	var anchor26 = true?body26.get_localCOM().copy():nape.geom.Vec2.get(23,25.19);
	body26.translateShapes(nape.geom.Vec2.weak(-anchor26.get_x(),-anchor26.get_y()));
	body26.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece25",{ body : body26, anchor : anchor26});
	var cbType58 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType58);
	var body27 = new nape.phys.Body();
	body27.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat31 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt31 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop31 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType59 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s91 = new nape.shape.Polygon([nape.geom.Vec2.weak(60,14),nape.geom.Vec2.weak(60,6),nape.geom.Vec2.weak(54,0),nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(38,25),nape.geom.Vec2.weak(54,18)],mat31,filt31);
	s91.set_body(body27);
	s91.set_fluidEnabled(false);
	s91.set_fluidProperties(prop31);
	s91.get_cbTypes().add(cbType59);
	var s92 = new nape.shape.Polygon([nape.geom.Vec2.weak(14,60),nape.geom.Vec2.weak(19,54),nape.geom.Vec2.weak(22,43),nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(0,6),nape.geom.Vec2.weak(0,54),nape.geom.Vec2.weak(6,60)],mat31,filt31);
	s92.set_body(body27);
	s92.set_fluidEnabled(false);
	s92.set_fluidProperties(prop31);
	s92.get_cbTypes().add(cbType59);
	var s93 = new nape.shape.Polygon([nape.geom.Vec2.weak(22,43),nape.geom.Vec2.weak(26,36),nape.geom.Vec2.weak(6,0)],mat31,filt31);
	s93.set_body(body27);
	s93.set_fluidEnabled(false);
	s93.set_fluidProperties(prop31);
	s93.get_cbTypes().add(cbType59);
	var s94 = new nape.shape.Polygon([nape.geom.Vec2.weak(26,36),nape.geom.Vec2.weak(31,31),nape.geom.Vec2.weak(6,0)],mat31,filt31);
	s94.set_body(body27);
	s94.set_fluidEnabled(false);
	s94.set_fluidProperties(prop31);
	s94.get_cbTypes().add(cbType59);
	var s95 = new nape.shape.Polygon([nape.geom.Vec2.weak(31,31),nape.geom.Vec2.weak(38,25),nape.geom.Vec2.weak(6,0)],mat31,filt31);
	s95.set_body(body27);
	s95.set_fluidEnabled(false);
	s95.set_fluidProperties(prop31);
	s95.get_cbTypes().add(cbType59);
	var anchor27 = false?body27.get_localCOM().copy():nape.geom.Vec2.get(10.11,10.4599998);
	body27.translateShapes(nape.geom.Vec2.weak(-anchor27.get_x(),-anchor27.get_y()));
	body27.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece7",{ body : body27, anchor : anchor27});
	var cbType60 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType60);
	var body28 = new nape.phys.Body();
	body28.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat32 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt32 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop32 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType61 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s96 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,46),nape.geom.Vec2.weak(0,54),nape.geom.Vec2.weak(6,60),nape.geom.Vec2.weak(54,60),nape.geom.Vec2.weak(16,38),nape.geom.Vec2.weak(6,41)],mat32,filt32);
	s96.set_body(body28);
	s96.set_fluidEnabled(false);
	s96.set_fluidProperties(prop32);
	s96.get_cbTypes().add(cbType61);
	var s97 = new nape.shape.Polygon([nape.geom.Vec2.weak(55,0),nape.geom.Vec2.weak(45,0),nape.geom.Vec2.weak(41,5),nape.geom.Vec2.weak(39,14),nape.geom.Vec2.weak(60,54),nape.geom.Vec2.weak(60,6)],mat32,filt32);
	s97.set_body(body28);
	s97.set_fluidEnabled(false);
	s97.set_fluidProperties(prop32);
	s97.get_cbTypes().add(cbType61);
	var s98 = new nape.shape.Polygon([nape.geom.Vec2.weak(39,14),nape.geom.Vec2.weak(35,23),nape.geom.Vec2.weak(60,54)],mat32,filt32);
	s98.set_body(body28);
	s98.set_fluidEnabled(false);
	s98.set_fluidProperties(prop32);
	s98.get_cbTypes().add(cbType61);
	var s99 = new nape.shape.Polygon([nape.geom.Vec2.weak(35,23),nape.geom.Vec2.weak(29,29),nape.geom.Vec2.weak(54,60),nape.geom.Vec2.weak(60,54)],mat32,filt32);
	s99.set_body(body28);
	s99.set_fluidEnabled(false);
	s99.set_fluidProperties(prop32);
	s99.get_cbTypes().add(cbType61);
	var s100 = new nape.shape.Polygon([nape.geom.Vec2.weak(29,29),nape.geom.Vec2.weak(23,34),nape.geom.Vec2.weak(54,60)],mat32,filt32);
	s100.set_body(body28);
	s100.set_fluidEnabled(false);
	s100.set_fluidProperties(prop32);
	s100.get_cbTypes().add(cbType61);
	var s101 = new nape.shape.Polygon([nape.geom.Vec2.weak(23,34),nape.geom.Vec2.weak(16,38),nape.geom.Vec2.weak(54,60)],mat32,filt32);
	s101.set_body(body28);
	s101.set_fluidEnabled(false);
	s101.set_fluidProperties(prop32);
	s101.get_cbTypes().add(cbType61);
	var anchor28 = false?body28.get_localCOM().copy():nape.geom.Vec2.get(50.1799998,49.5499998);
	body28.translateShapes(nape.geom.Vec2.weak(-anchor28.get_x(),-anchor28.get_y()));
	body28.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece8",{ body : body28, anchor : anchor28});
	var cbType62 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType62);
	var body29 = new nape.phys.Body();
	body29.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat33 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt33 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop33 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType63 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s102 = new nape.shape.Polygon([nape.geom.Vec2.weak(60,46),nape.geom.Vec2.weak(54,41),nape.geom.Vec2.weak(44,39),nape.geom.Vec2.weak(6,60),nape.geom.Vec2.weak(54,60),nape.geom.Vec2.weak(60,54)],mat33,filt33);
	s102.set_body(body29);
	s102.set_fluidEnabled(false);
	s102.set_fluidProperties(prop33);
	s102.get_cbTypes().add(cbType63);
	var s103 = new nape.shape.Polygon([nape.geom.Vec2.weak(13,0),nape.geom.Vec2.weak(7,0),nape.geom.Vec2.weak(0,6),nape.geom.Vec2.weak(0,54),nape.geom.Vec2.weak(22,15),nape.geom.Vec2.weak(19,6)],mat33,filt33);
	s103.set_body(body29);
	s103.set_fluidEnabled(false);
	s103.set_fluidProperties(prop33);
	s103.get_cbTypes().add(cbType63);
	var s104 = new nape.shape.Polygon([nape.geom.Vec2.weak(22,15),nape.geom.Vec2.weak(0,54),nape.geom.Vec2.weak(6,60),nape.geom.Vec2.weak(26,23)],mat33,filt33);
	s104.set_body(body29);
	s104.set_fluidEnabled(false);
	s104.set_fluidProperties(prop33);
	s104.get_cbTypes().add(cbType63);
	var s105 = new nape.shape.Polygon([nape.geom.Vec2.weak(26,23),nape.geom.Vec2.weak(6,60),nape.geom.Vec2.weak(31,29)],mat33,filt33);
	s105.set_body(body29);
	s105.set_fluidEnabled(false);
	s105.set_fluidProperties(prop33);
	s105.get_cbTypes().add(cbType63);
	var s106 = new nape.shape.Polygon([nape.geom.Vec2.weak(31,29),nape.geom.Vec2.weak(6,60),nape.geom.Vec2.weak(37,35)],mat33,filt33);
	s106.set_body(body29);
	s106.set_fluidEnabled(false);
	s106.set_fluidProperties(prop33);
	s106.get_cbTypes().add(cbType63);
	var s107 = new nape.shape.Polygon([nape.geom.Vec2.weak(37,35),nape.geom.Vec2.weak(6,60),nape.geom.Vec2.weak(44,39)],mat33,filt33);
	s107.set_body(body29);
	s107.set_fluidEnabled(false);
	s107.set_fluidProperties(prop33);
	s107.get_cbTypes().add(cbType63);
	var anchor29 = false?body29.get_localCOM().copy():nape.geom.Vec2.get(10.4599998,50.22);
	body29.translateShapes(nape.geom.Vec2.weak(-anchor29.get_x(),-anchor29.get_y()));
	body29.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece9",{ body : body29, anchor : anchor29});
	var cbType64 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType64);
	var body30 = new nape.phys.Body();
	body30.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat34 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt34 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop34 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType65 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s108 = new nape.shape.Polygon([nape.geom.Vec2.weak(15,99),nape.geom.Vec2.weak(20,93),nape.geom.Vec2.weak(21,80),nape.geom.Vec2.weak(0,93),nape.geom.Vec2.weak(6,99)],mat34,filt34);
	s108.set_body(body30);
	s108.set_fluidEnabled(false);
	s108.set_fluidProperties(prop34);
	s108.get_cbTypes().add(cbType65);
	var s109 = new nape.shape.Polygon([nape.geom.Vec2.weak(100,14),nape.geom.Vec2.weak(100,7),nape.geom.Vec2.weak(94,0),nape.geom.Vec2.weak(7,0),nape.geom.Vec2.weak(77,21),nape.geom.Vec2.weak(94,20)],mat34,filt34);
	s109.set_body(body30);
	s109.set_fluidEnabled(false);
	s109.set_fluidProperties(prop34);
	s109.get_cbTypes().add(cbType65);
	var s110 = new nape.shape.Polygon([nape.geom.Vec2.weak(21,80),nape.geom.Vec2.weak(24,65),nape.geom.Vec2.weak(0,7),nape.geom.Vec2.weak(0,93)],mat34,filt34);
	s110.set_body(body30);
	s110.set_fluidEnabled(false);
	s110.set_fluidProperties(prop34);
	s110.get_cbTypes().add(cbType65);
	var s111 = new nape.shape.Polygon([nape.geom.Vec2.weak(24,65),nape.geom.Vec2.weak(30,52),nape.geom.Vec2.weak(0,7)],mat34,filt34);
	s111.set_body(body30);
	s111.set_fluidEnabled(false);
	s111.set_fluidProperties(prop34);
	s111.get_cbTypes().add(cbType65);
	var s112 = new nape.shape.Polygon([nape.geom.Vec2.weak(30,52),nape.geom.Vec2.weak(38,40),nape.geom.Vec2.weak(0,7)],mat34,filt34);
	s112.set_body(body30);
	s112.set_fluidEnabled(false);
	s112.set_fluidProperties(prop34);
	s112.get_cbTypes().add(cbType65);
	var s113 = new nape.shape.Polygon([nape.geom.Vec2.weak(38,40),nape.geom.Vec2.weak(49,31),nape.geom.Vec2.weak(7,0),nape.geom.Vec2.weak(0,7)],mat34,filt34);
	s113.set_body(body30);
	s113.set_fluidEnabled(false);
	s113.set_fluidProperties(prop34);
	s113.get_cbTypes().add(cbType65);
	var s114 = new nape.shape.Polygon([nape.geom.Vec2.weak(49,31),nape.geom.Vec2.weak(62,25),nape.geom.Vec2.weak(7,0)],mat34,filt34);
	s114.set_body(body30);
	s114.set_fluidEnabled(false);
	s114.set_fluidProperties(prop34);
	s114.get_cbTypes().add(cbType65);
	var s115 = new nape.shape.Polygon([nape.geom.Vec2.weak(77,21),nape.geom.Vec2.weak(7,0),nape.geom.Vec2.weak(62,25)],mat34,filt34);
	s115.set_body(body30);
	s115.set_fluidEnabled(false);
	s115.set_fluidProperties(prop34);
	s115.get_cbTypes().add(cbType65);
	var anchor30 = false?body30.get_localCOM().copy():nape.geom.Vec2.get(10.38,9.74000015999999);
	body30.translateShapes(nape.geom.Vec2.weak(-anchor30.get_x(),-anchor30.get_y()));
	body30.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece4",{ body : body30, anchor : anchor30});
	var cbType66 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType66);
	var body31 = new nape.phys.Body();
	body31.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat35 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt35 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop35 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType67 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s116 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,15),nape.geom.Vec2.weak(6,20),nape.geom.Vec2.weak(22,22),nape.geom.Vec2.weak(91,0),nape.geom.Vec2.weak(6,0),nape.geom.Vec2.weak(0,6)],mat35,filt35);
	s116.set_body(body31);
	s116.set_fluidEnabled(false);
	s116.set_fluidProperties(prop35);
	s116.get_cbTypes().add(cbType67);
	var s117 = new nape.shape.Polygon([nape.geom.Vec2.weak(85,100),nape.geom.Vec2.weak(93,100),nape.geom.Vec2.weak(99,94),nape.geom.Vec2.weak(78,81),nape.geom.Vec2.weak(79,94)],mat35,filt35);
	s117.set_body(body31);
	s117.set_fluidEnabled(false);
	s117.set_fluidProperties(prop35);
	s117.get_cbTypes().add(cbType67);
	var s118 = new nape.shape.Polygon([nape.geom.Vec2.weak(78,81),nape.geom.Vec2.weak(99,94),nape.geom.Vec2.weak(99,6),nape.geom.Vec2.weak(75,66)],mat35,filt35);
	s118.set_body(body31);
	s118.set_fluidEnabled(false);
	s118.set_fluidProperties(prop35);
	s118.get_cbTypes().add(cbType67);
	var s119 = new nape.shape.Polygon([nape.geom.Vec2.weak(75,66),nape.geom.Vec2.weak(99,6),nape.geom.Vec2.weak(69,53)],mat35,filt35);
	s119.set_body(body31);
	s119.set_fluidEnabled(false);
	s119.set_fluidProperties(prop35);
	s119.get_cbTypes().add(cbType67);
	var s120 = new nape.shape.Polygon([nape.geom.Vec2.weak(69,53),nape.geom.Vec2.weak(99,6),nape.geom.Vec2.weak(61,41)],mat35,filt35);
	s120.set_body(body31);
	s120.set_fluidEnabled(false);
	s120.set_fluidProperties(prop35);
	s120.get_cbTypes().add(cbType67);
	var s121 = new nape.shape.Polygon([nape.geom.Vec2.weak(61,41),nape.geom.Vec2.weak(99,6),nape.geom.Vec2.weak(91,0),nape.geom.Vec2.weak(50,32)],mat35,filt35);
	s121.set_body(body31);
	s121.set_fluidEnabled(false);
	s121.set_fluidProperties(prop35);
	s121.get_cbTypes().add(cbType67);
	var s122 = new nape.shape.Polygon([nape.geom.Vec2.weak(50,32),nape.geom.Vec2.weak(91,0),nape.geom.Vec2.weak(38,26)],mat35,filt35);
	s122.set_body(body31);
	s122.set_fluidEnabled(false);
	s122.set_fluidProperties(prop35);
	s122.get_cbTypes().add(cbType67);
	var s123 = new nape.shape.Polygon([nape.geom.Vec2.weak(22,22),nape.geom.Vec2.weak(38,26),nape.geom.Vec2.weak(91,0)],mat35,filt35);
	s123.set_body(body31);
	s123.set_fluidEnabled(false);
	s123.set_fluidProperties(prop35);
	s123.get_cbTypes().add(cbType67);
	var anchor31 = false?body31.get_localCOM().copy():nape.geom.Vec2.get(89.44999965,10.39);
	body31.translateShapes(nape.geom.Vec2.weak(-anchor31.get_x(),-anchor31.get_y()));
	body31.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece6",{ body : body31, anchor : anchor31});
	var cbType68 = new nape.callbacks.CbType();
	com.cmm.mmc.app.gameState.PhysicsData.registerCbType("collision1",cbType68);
	var body32 = new nape.phys.Body();
	body32.get_cbTypes().add(com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1"));
	var mat36 = com.cmm.mmc.app.gameState.PhysicsData.material("default");
	var filt36 = com.cmm.mmc.app.gameState.PhysicsData.filter("default");
	var prop36 = com.cmm.mmc.app.gameState.PhysicsData.fprop("default");
	var cbType69 = com.cmm.mmc.app.gameState.PhysicsData.cbtype("collision1");
	var s124 = new nape.shape.Polygon([nape.geom.Vec2.weak(0,93),nape.geom.Vec2.weak(6,99),nape.geom.Vec2.weak(93,99),nape.geom.Vec2.weak(23,77),nape.geom.Vec2.weak(6,79),nape.geom.Vec2.weak(0,85)],mat36,filt36);
	s124.set_body(body32);
	s124.set_fluidEnabled(false);
	s124.set_fluidProperties(prop36);
	s124.get_cbTypes().add(cbType69);
	var s125 = new nape.shape.Polygon([nape.geom.Vec2.weak(85,0),nape.geom.Vec2.weak(80,5),nape.geom.Vec2.weak(79,18),nape.geom.Vec2.weak(100,5),nape.geom.Vec2.weak(94,0)],mat36,filt36);
	s125.set_body(body32);
	s125.set_fluidEnabled(false);
	s125.set_fluidProperties(prop36);
	s125.get_cbTypes().add(cbType69);
	var s126 = new nape.shape.Polygon([nape.geom.Vec2.weak(79,18),nape.geom.Vec2.weak(76,33),nape.geom.Vec2.weak(100,92),nape.geom.Vec2.weak(100,5)],mat36,filt36);
	s126.set_body(body32);
	s126.set_fluidEnabled(false);
	s126.set_fluidProperties(prop36);
	s126.get_cbTypes().add(cbType69);
	var s127 = new nape.shape.Polygon([nape.geom.Vec2.weak(76,33),nape.geom.Vec2.weak(70,46),nape.geom.Vec2.weak(100,92)],mat36,filt36);
	s127.set_body(body32);
	s127.set_fluidEnabled(false);
	s127.set_fluidProperties(prop36);
	s127.get_cbTypes().add(cbType69);
	var s128 = new nape.shape.Polygon([nape.geom.Vec2.weak(70,46),nape.geom.Vec2.weak(62,58),nape.geom.Vec2.weak(100,92)],mat36,filt36);
	s128.set_body(body32);
	s128.set_fluidEnabled(false);
	s128.set_fluidProperties(prop36);
	s128.get_cbTypes().add(cbType69);
	var s129 = new nape.shape.Polygon([nape.geom.Vec2.weak(62,58),nape.geom.Vec2.weak(51,67),nape.geom.Vec2.weak(93,99),nape.geom.Vec2.weak(100,92)],mat36,filt36);
	s129.set_body(body32);
	s129.set_fluidEnabled(false);
	s129.set_fluidProperties(prop36);
	s129.get_cbTypes().add(cbType69);
	var s130 = new nape.shape.Polygon([nape.geom.Vec2.weak(51,67),nape.geom.Vec2.weak(39,73),nape.geom.Vec2.weak(93,99)],mat36,filt36);
	s130.set_body(body32);
	s130.set_fluidEnabled(false);
	s130.set_fluidProperties(prop36);
	s130.get_cbTypes().add(cbType69);
	var s131 = new nape.shape.Polygon([nape.geom.Vec2.weak(23,77),nape.geom.Vec2.weak(93,99),nape.geom.Vec2.weak(39,73)],mat36,filt36);
	s131.set_body(body32);
	s131.set_fluidEnabled(false);
	s131.set_fluidProperties(prop36);
	s131.get_cbTypes().add(cbType69);
	var anchor32 = false?body32.get_localCOM().copy():nape.geom.Vec2.get(89.76,89.35999974);
	body32.translateShapes(nape.geom.Vec2.weak(-anchor32.get_x(),-anchor32.get_y()));
	body32.get_position().setxy(0,0);
	com.cmm.mmc.app.gameState.PhysicsData.bodies.set("piece5",{ body : body32, anchor : anchor32});
}
com.cmm.mmc.app.gameState.PresetCoasterBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.mmc.app.gameState.PresetCoasterBtn"] = com.cmm.mmc.app.gameState.PresetCoasterBtn;
com.cmm.mmc.app.gameState.PresetCoasterBtn.__name__ = ["com","cmm","mmc","app","gameState","PresetCoasterBtn"];
com.cmm.mmc.app.gameState.PresetCoasterBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.mmc.app.gameState.PresetCoasterBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("create_coaster",com.cmm.common.utils.StringUtil.returnNumbers(this._ownerSprite.get_instanceName())));
	}
	,__class__: com.cmm.mmc.app.gameState.PresetCoasterBtn
});
com.cmm.mmc.app.gameState.SpaceComponent = function() {
	this._step = 1 / 30;
	this._accumulator = 0.0;
	this._physicsSettings = com.cmm.common.io.LoadMaster.getJSON("config","PhysicsSettings.json");
	this._space = new nape.space.Space(new nape.geom.Vec2(0,this._physicsSettings.world.gravity));
	this._ballCollision = new nape.callbacks.CbType();
};
$hxClasses["com.cmm.mmc.app.gameState.SpaceComponent"] = com.cmm.mmc.app.gameState.SpaceComponent;
com.cmm.mmc.app.gameState.SpaceComponent.__name__ = ["com","cmm","mmc","app","gameState","SpaceComponent"];
com.cmm.mmc.app.gameState.SpaceComponent.getFrom = function(entity) {
	return entity.getComponent("SpaceComponent_9");
}
com.cmm.mmc.app.gameState.SpaceComponent.__super__ = flambe.Component;
com.cmm.mmc.app.gameState.SpaceComponent.prototype = $extend(flambe.Component.prototype,{
	addBall: function(x,y) {
		var body = new nape.phys.Body();
		body.get_shapes().add(new nape.shape.Circle(21,null,com.cmm.mmc.app.customTools.CustomMaterial.ball()));
		body.set_position(new nape.geom.Vec2(x,y));
		body.set_velocity(new nape.geom.Vec2(this._physicsSettings.ball.initialVelocityX,this._physicsSettings.ball.initialVelocityY));
		body.get_cbTypes().add(this._ballCollision);
		var entity = this.addBody(body);
		var mc = com.cmm.common.utils.LibraryTools.createMovieClip("mc_ball");
		entity.add(mc);
		return entity;
	}
	,addBody: function(body) {
		body.set_space(this._space);
		return new flambe.Entity().add(new com.cmm.mmc.app.gameState.BodyComponent(body));
	}
	,onUpdate: function(dt) {
		if(dt > .05) dt = .05;
		this._accumulator += dt * 2;
		while(this._accumulator > this._step) {
			this._space.step(this._step,8,3);
			this._accumulator -= this._step;
		}
	}
	,get_name: function() {
		return "SpaceComponent_9";
	}
	,__class__: com.cmm.mmc.app.gameState.SpaceComponent
});
com.cmm.mmc.app.gameState.SwitchBtn = function(pid,paramObject) {
	this._added = false;
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.mmc.app.gameState.SwitchBtn"] = com.cmm.mmc.app.gameState.SwitchBtn;
com.cmm.mmc.app.gameState.SwitchBtn.__name__ = ["com","cmm","mmc","app","gameState","SwitchBtn"];
com.cmm.mmc.app.gameState.SwitchBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.mmc.app.gameState.SwitchBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		var name = this._ownerSprite.get_instanceName();
		var gameStage = js.Boot.__cast(this._ownerSprite.get_parent().get_parent() , com.cmm.common.display.MovieClip);
		var pieces = js.Boot.__cast(gameStage.getChildByName("mc_piecesScroller") , com.cmm.common.display.MovieClip);
		var coasters = js.Boot.__cast(gameStage.getChildByName("mc_coastersScroller") , com.cmm.common.display.MovieClip);
		var piecesSwitch1 = js.Boot.__cast(pieces.getChildByName("btn_piecesSwitch") , com.cmm.common.display.MovieClipButton);
		var piecesSwitch2 = js.Boot.__cast(coasters.getChildByName("btn_piecesSwitch") , com.cmm.common.display.MovieClipButton);
		var coastersSwitch1 = js.Boot.__cast(pieces.getChildByName("btn_coastersSwitch") , com.cmm.common.display.MovieClipButton);
		var coastersSwitch2 = js.Boot.__cast(coasters.getChildByName("btn_coastersSwitch") , com.cmm.common.display.MovieClipButton);
		if(name == "btn_coastersSwitch" && gameStage.getChildIndex(coasters) < gameStage.getChildIndex(pieces)) {
			piecesSwitch1.enable();
			piecesSwitch2.enable();
			coastersSwitch2.disable();
			gameStage.swapChildren(pieces,coasters);
			com.cmm.mmc.app.gameState.GameVOPlayer._ignoreAlternatePrompt = true;
		} else if(name == "btn_piecesSwitch" && gameStage.getChildIndex(pieces) < gameStage.getChildIndex(coasters)) {
			piecesSwitch1.disable();
			coastersSwitch1.enable();
			coastersSwitch2.enable();
			gameStage.swapChildren(pieces,coasters);
			com.cmm.mmc.app.gameState.GameVOPlayer._ignoreAlternatePrompt = false;
		}
	}
	,onAdded: function() {
		com.cmm.common.components.btn.GenericBtn.prototype.onAdded.call(this);
		var name = this._ownerSprite.get_instanceName();
		if(name == "btn_piecesSwitch" && !this._added) {
			var button = js.Boot.__cast(this._ownerSprite , com.cmm.common.display.MovieClipButton);
			button.disable();
			this._added = true;
		}
	}
	,__class__: com.cmm.mmc.app.gameState.SwitchBtn
});
com.cmm.mmc.app.gameState.TimelineScrollThumb = function(pid,paramObject) {
	this._dragging = false;
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
	this._dist = paramObject.dist;
	this._axis = paramObject.axis;
	this._targetName = this.params.target;
};
$hxClasses["com.cmm.mmc.app.gameState.TimelineScrollThumb"] = com.cmm.mmc.app.gameState.TimelineScrollThumb;
com.cmm.mmc.app.gameState.TimelineScrollThumb.__name__ = ["com","cmm","mmc","app","gameState","TimelineScrollThumb"];
com.cmm.mmc.app.gameState.TimelineScrollThumb.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.mmc.app.gameState.TimelineScrollThumb.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	stopDrag: function(e) {
		this._dragconnex.dispose();
		this._moveconnex.dispose();
		this._dragging = false;
		this._timeline.get_onComplete().emit();
	}
	,onPointerDown: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerDown.call(this,e);
		this._dragging = true;
		this._startPoint = new flambe.math.Point(flambe.System.get_pointer().get_x(),flambe.System.get_pointer().get_y());
		this._startFrame = this._timeline.get_currentFrame();
		this._moveconnex = flambe.System.get_pointer().move.connect($bind(this,this.updatePoistion));
		this._dragconnex = flambe.System.get_pointer().up.connect($bind(this,this.stopDrag));
	}
	,updatePoistion: function(e) {
		var percent = 0.0;
		if(this._dragging) {
			var pointDiff;
			if(this._axis == "x") pointDiff = flambe.System.get_pointer().get_x() - this._startPoint.x; else pointDiff = flambe.System.get_pointer().get_y() - this._startPoint.y;
			percent = pointDiff / this._dist;
			var frame = Std["int"](this._startFrame + this._timeline.get_totalFrames() / 2 * percent);
			if(frame <= 0) this._timeline.gotoAndStop(1); else if(frame > this._timeline.get_totalFrames() / 2) this._timeline.gotoAndStop(this._timeline.get_totalFrames() / 2); else if(frame > 0 && frame <= this._timeline.get_totalFrames() / 2) this._timeline.gotoAndStop(frame);
		}
	}
	,onAdded: function() {
		com.cmm.common.components.btn.GenericBtn.prototype.onAdded.call(this);
		if(this._axis == "x") this._pos = this._ownerSprite.localToGlobal().x; else this._pos = this._ownerSprite.localToGlobal().y;
		this._timeline = this._ownerSprite.get_parent();
	}
	,__class__: com.cmm.mmc.app.gameState.TimelineScrollThumb
});
com.cmm.mmc.app.gameState.TrackPiece = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.mmc.app.gameState.TrackPiece"] = com.cmm.mmc.app.gameState.TrackPiece;
com.cmm.mmc.app.gameState.TrackPiece.__name__ = ["com","cmm","mmc","app","gameState","TrackPiece"];
com.cmm.mmc.app.gameState.TrackPiece.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.mmc.app.gameState.TrackPiece.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerOut: function() {
		flambe.System.get_mouse().set_cursor(flambe.input.MouseCursor.Default);
	}
	,onPointerOver: function() {
		flambe.System.get_mouse().set_cursor(flambe.input.MouseCursor.Button);
	}
	,onPointerUp: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerUp.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("piece_up",this._ownerSprite.get_instanceName()));
	}
	,onPointerDown: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerDown.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("piece_down",this._ownerSprite.get_instanceName()));
	}
	,onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("piece_click",this._ownerSprite.get_instanceName()));
	}
	,onAdded: function() {
		com.cmm.common.components.btn.GenericBtn.prototype.onAdded.call(this);
		var mc1 = this._ownerSprite;
		mc1.gotoAndStop(1);
		if(Type.getClass(mc1.getChildByName("graphic")) == com.cmm.common.display.MovieClip) {
			var mc2 = js.Boot.__cast(mc1.getChildByName("graphic") , com.cmm.common.display.MovieClip);
			mc2.gotoAndStop(1);
			var _g1 = 0, _g = mc2.get_numChildren();
			while(_g1 < _g) {
				var i = _g1++;
				if(Type.getClass(mc2.getChildAt(i)) == com.cmm.common.display.MovieClip) {
					var mc3 = js.Boot.__cast(mc2.getChildAt(i) , com.cmm.common.display.MovieClip);
					mc3.gotoAndStop(1);
				}
			}
		}
	}
	,__class__: com.cmm.mmc.app.gameState.TrackPiece
});
com.cmm.mmc.app.gameState.YesBtn = function(pid,paramObject) {
	com.cmm.common.components.btn.GenericBtn.call(this,pid,paramObject);
};
$hxClasses["com.cmm.mmc.app.gameState.YesBtn"] = com.cmm.mmc.app.gameState.YesBtn;
com.cmm.mmc.app.gameState.YesBtn.__name__ = ["com","cmm","mmc","app","gameState","YesBtn"];
com.cmm.mmc.app.gameState.YesBtn.__super__ = com.cmm.common.components.btn.GenericBtn;
com.cmm.mmc.app.gameState.YesBtn.prototype = $extend(com.cmm.common.components.btn.GenericBtn.prototype,{
	onPointerClick: function(e) {
		com.cmm.common.components.btn.GenericBtn.prototype.onPointerClick.call(this,e);
		com.cmm.common.event.EDispatcher.dispatchEvent(new com.cmm.common.event.Event("yes_click"));
	}
	,__class__: com.cmm.mmc.app.gameState.YesBtn
});
flambe.Disposer = function() {
	this._disposables = [];
};
$hxClasses["flambe.Disposer"] = flambe.Disposer;
flambe.Disposer.__name__ = ["flambe","Disposer"];
flambe.Disposer.getFrom = function(entity) {
	return entity.getComponent("Disposer_3");
}
flambe.Disposer.__super__ = flambe.Component;
flambe.Disposer.prototype = $extend(flambe.Component.prototype,{
	freeDisposables: function() {
		var snapshot = this._disposables;
		this._disposables = [];
		var _g = 0;
		while(_g < snapshot.length) {
			var disposable = snapshot[_g];
			++_g;
			disposable.dispose();
		}
	}
	,dispose: function() {
		flambe.Component.prototype.dispose.call(this);
		this.freeDisposables();
	}
	,onRemoved: function() {
		this.freeDisposables();
	}
	,connect1: function(signal,listener) {
		this.add(signal.connect(listener));
		return this;
	}
	,connect0: function(signal,listener) {
		this.add(signal.connect(listener));
		return this;
	}
	,add: function(disposable) {
		this._disposables.push(disposable);
		return this;
	}
	,get_name: function() {
		return "Disposer_3";
	}
	,__class__: flambe.Disposer
});
flambe.util.PackageLog = function() { }
$hxClasses["flambe.util.PackageLog"] = flambe.util.PackageLog;
flambe.util.PackageLog.__name__ = ["flambe","util","PackageLog"];
flambe.platform = {}
flambe.platform.Platform = function() { }
$hxClasses["flambe.platform.Platform"] = flambe.platform.Platform;
flambe.platform.Platform.__name__ = ["flambe","platform","Platform"];
flambe.platform.Platform.prototype = {
	__class__: flambe.platform.Platform
}
flambe.platform.html = {}
flambe.platform.html.HtmlPlatform = window.marbleous = function() {
};
$hxClasses["flambe.platform.html.HtmlPlatform"] = flambe.platform.html.HtmlPlatform;
flambe.platform.html.HtmlPlatform.__name__ = ["flambe","platform","html","HtmlPlatform"];
flambe.platform.html.HtmlPlatform.__interfaces__ = [flambe.platform.Platform];
flambe.platform.html.HtmlPlatform.prototype = {
	createRenderer: function(canvas) {
		return new flambe.platform.html.CanvasRenderer(canvas);
	}
	,getY: function(event,bounds) {
		return this._stage.scaleFactor * (event.clientY - bounds.top);
	}
	,getX: function(event,bounds) {
		return this._stage.scaleFactor * (event.clientX - bounds.left);
	}
	,getRenderer: function() {
		return this._renderer;
	}
	,getAccelerometer: function() {
		if(this._accelerometer == null) this._accelerometer = new flambe.platform.html.HtmlAccelerometer();
		return this._accelerometer;
	}
	,getExternal: function() {
		if(this._external == null) this._external = new flambe.platform.html.HtmlExternal();
		return this._external;
	}
	,getWeb: function() {
		if(this._web == null) this._web = new flambe.platform.html.HtmlWeb(this._container);
		return this._web;
	}
	,getKeyboard: function() {
		var _g = this;
		if(this._keyboard == null) {
			this._keyboard = new flambe.platform.BasicKeyboard();
			var onKey = function(event) {
				switch(event.type) {
				case "keydown":
					if(_g._keyboard.submitDown(event.keyCode)) event.preventDefault();
					break;
				case "keyup":
					_g._keyboard.submitUp(event.keyCode);
					break;
				}
			};
			this._canvas.addEventListener("keydown",onKey,false);
			this._canvas.addEventListener("keyup",onKey,false);
		}
		return this._keyboard;
	}
	,getTouch: function() {
		return this._touch;
	}
	,getMouse: function() {
		return this._mouse;
	}
	,getPointer: function() {
		return this._pointer;
	}
	,update: function(now) {
		var dt = (now - this._lastUpdate) / 1000;
		if(this._checkDT && dt < flambe.System.FPS / 1000) return;
		this._lastUpdate = now;
		if(flambe.System.hidden.get__()) return;
		if (window.springroll && window.springroll.isPaused) return;
		if(this._skipFrame) {
			this._skipFrame = false;
			return;
		}
		haxe.updateTimers(dt);
		this.mainLoop.update(dt);
		this.mainLoop.render(this._renderer);
	}
	,getTime: function() {
		return flambe.platform.html.HtmlUtil.now() / 1000;
	}
	,createLogHandler: function(tag) {
		if(flambe.platform.html.HtmlLogHandler.isSupported()) return new flambe.platform.html.HtmlLogHandler(tag);
		return null;
	}
	,getLocale: function() {
		var locale = js.Lib.window.navigator.language;
		if(locale == null) locale = js.Lib.window.navigator.userLanguage;
		return locale;
	}
	,getStorage: function() {
		if(this._storage == null) {
			var localStorage = null;
			try {
				localStorage = js.Lib.window.localStorage;
			} catch( error ) {
			}
			if(localStorage != null) this._storage = new flambe.platform.html.HtmlStorage(localStorage); else {
				flambe.Log.warn("localStorage is unavailable, falling back to unpersisted storage");
				this._storage = new flambe.platform.DummyStorage();
			}
		}
		return this._storage;
	}
	,getStage: function() {
		return this._stage;
	}
	,loadAssetPack: function(manifest) {
		return new flambe.platform.html.HtmlAssetPackLoader(this,manifest).promise;
	}
	,init: function() {
		var _g = this;
		flambe.Log.info("Initializing HTML platform");
		var canvas = null;
		try {
			canvas = document.getElementById("content-canvas");
		} catch( error ) {
		}
		flambe.util.Assert.that(canvas != null,"Could not find a Flambe canvas! Are you embedding with flambe.js?");
		canvas.setAttribute("tabindex","0");
		canvas.style.outlineStyle = "none";
		canvas.setAttribute("moz-opaque","true");
		this._stage = new flambe.platform.html.HtmlStage(canvas);
		this._pointer = new flambe.platform.BasicPointer();
		this._mouse = new flambe.platform.html.HtmlMouse(this._pointer,canvas);
		this._renderer = this.createRenderer(canvas);
		flambe.System.hasGPU.set__(true);
		this.mainLoop = new flambe.platform.MainLoop();
		this._canvas = canvas;
		this._container = canvas.parentNode;
		this._container.style.overflow = "hidden";
		this._container.style.position = "relative";
		this._container.style.msTouchAction = "none";
		var lastTouchTime = 0;
		var onMouse = function (event) {
			if(event.timeStamp - lastTouchTime < 1000) return;
			var bounds = canvas.getBoundingClientRect();
			var x = _g.getX(event,bounds);
			var y = _g.getY(event,bounds);

			if (window.springroll && window.springroll.isPaused) {
				return;
			}

			switch(event.type) {
			case "mousedown":
				if(event.target == canvas) {
					event.preventDefault();
					_g._mouse.submitDown(x,y,event.button);
					event.target.focus();
				}
				break;
			case "mousemove":
				_g._mouse.submitMove(x,y);
				break;
			case "mouseup":
				_g._mouse.submitUp(x,y,event.button);
				break;
			case "mousewheel":case "DOMMouseScroll":
				var velocity = event.type == "mousewheel"?event.wheelDelta / 40:-event.detail;
				if(_g._mouse.submitScroll(x,y,velocity)) event.preventDefault();
				break;
			}
		};
		window.addEventListener("mousedown",onMouse,false);
		window.addEventListener("mousemove",onMouse,false);
		window.addEventListener("mouseup",onMouse,false);
		canvas.addEventListener("mousewheel",onMouse,false);
		canvas.addEventListener("DOMMouseScroll",onMouse,false);
		var standardTouch = typeof(js.Lib.window.ontouchstart) != "undefined";
		var msTouch = 'msMaxTouchPoints' in window.navigator && (window.navigator.msMaxTouchPoints > 1);
		if(standardTouch || msTouch) {
			var basicTouch = new flambe.platform.BasicTouch(this._pointer,msTouch?window.navigator.msMaxTouchPoints:4);
			this._touch = basicTouch;
			var onTouch = function(event) {
				var changedTouches = standardTouch?event.changedTouches:[event];
				var bounds = event.target.getBoundingClientRect();
				lastTouchTime = event.timeStamp;

				if (window.springroll && window.springroll.isPaused) {
					return;
				}
	
				switch(event.type) {
				case "touchstart":case "MSPointerDown":
					event.preventDefault();
					if(flambe.platform.html.HtmlUtil.SHOULD_HIDE_MOBILE_BROWSER) flambe.platform.html.HtmlUtil.hideMobileBrowser();
					var _g1 = 0;
					while(_g1 < changedTouches.length) {
						var touch = changedTouches[_g1];
						++_g1;
						var x = _g.getX(touch,bounds);
						var y = _g.getY(touch,bounds);
						var id = Std["int"](standardTouch?touch.identifier:touch.pointerId);
						basicTouch.submitDown(id,x,y);
					}
					break;
				case "touchmove":case "MSPointerMove":
					event.preventDefault();
					var _g1 = 0;
					while(_g1 < changedTouches.length) {
						var touch = changedTouches[_g1];
						++_g1;
						var x = _g.getX(touch,bounds);
						var y = _g.getY(touch,bounds);
						var id = Std["int"](standardTouch?touch.identifier:touch.pointerId);
						basicTouch.submitMove(id,x,y);
					}
					break;
				case "touchend":case "touchcancel":case "MSPointerUp":
					var _g1 = 0;
					while(_g1 < changedTouches.length) {
						var touch = changedTouches[_g1];
						++_g1;
						var x = _g.getX(touch,bounds);
						var y = _g.getY(touch,bounds);
						var id = Std["int"](standardTouch?touch.identifier:touch.pointerId);
						basicTouch.submitUp(id,x,y);
					}
					break;
				}
			};
			if(standardTouch) {
				canvas.addEventListener("touchstart",onTouch,false);
				canvas.addEventListener("touchmove",onTouch,false);
				canvas.addEventListener("touchend",onTouch,false);
				canvas.addEventListener("touchcancel",onTouch,false);
			} else {
				canvas.addEventListener("MSPointerDown",onTouch,false);
				canvas.addEventListener("MSPointerMove",onTouch,false);
				canvas.addEventListener("MSPointerUp",onTouch,false);
			}
		} else this._touch = new flambe.platform.DummyTouch();
		var oldErrorHandler = js.Lib.window.onerror;
		js.Lib.window.onerror = function(message,url,line) {
			flambe.System.uncaughtError.emit(message);
			return oldErrorHandler != null?oldErrorHandler(message,url,line):false;
		};
		var hiddenApi = flambe.platform.html.HtmlUtil.loadExtension("hidden",js.Lib.document);
		if(hiddenApi.value != null) {
			var onVisibilityChanged = function() {
				flambe.System.hidden.set__(Reflect.field(js.Lib.document,hiddenApi.field));
			};
			onVisibilityChanged();
			js.Lib.document.addEventListener(hiddenApi.prefix + "visibilitychange",onVisibilityChanged,false);
		} else {
			var onPageTransitionChange = function(event) {
				flambe.System.hidden.set__(event.type == "pagehide");
			};
			js.Lib.window.addEventListener("pageshow",onPageTransitionChange,false);
			js.Lib.window.addEventListener("pagehide",onPageTransitionChange,false);
		}
		flambe.System.hidden.get_changed().connect(function(hidden,_) {
			console.log("Hidden changed: " + Std.string(hidden));
			if(!hidden) _g._skipFrame = true;
		});
		this._skipFrame = false;
		this._lastUpdate = flambe.platform.html.HtmlUtil.now();
		var requestAnimationFrame = flambe.platform.html.HtmlUtil.loadExtension("requestAnimationFrame").value;
		if(requestAnimationFrame != null) {
			var performance = js.Lib.window.performance;
			var hasPerfNow = performance != null && flambe.platform.html.HtmlUtil.polyfill("now",performance);
			if(hasPerfNow) this._lastUpdate = performance.now(); else flambe.Log.warn("No monotonic timer support, falling back to the system date");
			var updateFrame = null;
			updateFrame = function(now) {
				_g.update(hasPerfNow?performance.now():now);
				requestAnimationFrame(updateFrame,canvas);
			};
			requestAnimationFrame(updateFrame,canvas);
		} else {
			flambe.Log.warn("No requestAnimationFrame support, falling back to setInterval");
			js.Lib.window.setInterval(function() {
				_g.update(flambe.platform.html.HtmlUtil.now());
			},1000 / flambe.System.FPS);
		}
	}
	,__class__: flambe.platform.html.HtmlPlatform
}
flambe.util.Value = function(value,listener) {
	this._value = value;
	if(listener != null) this._changed = new flambe.util.Signal2(listener);
};
$hxClasses["flambe.util.Value"] = flambe.util.Value;
flambe.util.Value.__name__ = ["flambe","util","Value"];
flambe.util.Value.prototype = {
	toString: function() {
		return this._value;
	}
	,get_changed: function() {
		if(this._changed == null) this._changed = new flambe.util.Signal2();
		return this._changed;
	}
	,set__: function(newValue) {
		var oldValue = this._value;
		if(newValue != oldValue) {
			this._value = newValue;
			if(this._changed != null) this._changed.emit(newValue,oldValue);
		}
		return newValue;
	}
	,get__: function() {
		return this._value;
	}
	,watch: function(listener) {
		listener(this._value,this._value);
		return this.get_changed().connect(listener);
	}
	,__class__: flambe.util.Value
}
flambe.util.SignalConnection = function(signal,listener) {
	this._internal_next = null;
	this._signal = signal;
	this._internal_listener = listener;
	this.stayInList = true;
};
$hxClasses["flambe.util.SignalConnection"] = flambe.util.SignalConnection;
flambe.util.SignalConnection.__name__ = ["flambe","util","SignalConnection"];
flambe.util.SignalConnection.__interfaces__ = [flambe.util.Disposable];
flambe.util.SignalConnection.prototype = {
	dispose: function() {
		if(this._signal != null) {
			this._signal._internal_disconnect(this);
			this._signal = null;
		}
	}
	,once: function() {
		this.stayInList = false;
		return this;
	}
	,__class__: flambe.util.SignalConnection
}
flambe.util.SignalBase = function(listener) {
	this._head = listener != null?new flambe.util.SignalConnection(this,listener):null;
	this._deferredTasks = null;
};
$hxClasses["flambe.util.SignalBase"] = flambe.util.SignalBase;
flambe.util.SignalBase.__name__ = ["flambe","util","SignalBase"];
flambe.util.SignalBase.prototype = {
	dispatching: function() {
		return this._head == flambe.util.SignalBase.DISPATCHING_SENTINEL;
	}
	,listRemove: function(conn) {
		var prev = null, p = this._head;
		while(p != null) {
			if(p == conn) {
				var next = p._internal_next;
				if(prev == null) this._head = next; else prev._internal_next = next;
				return;
			}
			prev = p;
			p = p._internal_next;
		}
	}
	,listAdd: function(conn,prioritize) {
		if(prioritize) {
			conn._internal_next = this._head;
			this._head = conn;
		} else {
			var tail = null, p = this._head;
			while(p != null) {
				tail = p;
				p = p._internal_next;
			}
			if(tail != null) tail._internal_next = conn; else this._head = conn;
		}
	}
	,didEmit: function(head) {
		this._head = head;
		while(this._deferredTasks != null) {
			this._deferredTasks.fn();
			this._deferredTasks = this._deferredTasks.next;
		}
	}
	,willEmit: function() {
		flambe.util.Assert.that(!this.dispatching(),"Cannot emit while already emitting!");
		var snapshot = this._head;
		this._head = flambe.util.SignalBase.DISPATCHING_SENTINEL;
		return snapshot;
	}
	,defer: function(fn) {
		var tail = null, p = this._deferredTasks;
		while(p != null) {
			tail = p;
			p = p.next;
		}
		var task = new flambe.util._SignalBase.Task(fn);
		if(tail != null) tail.next = task; else this._deferredTasks = task;
	}
	,emit2: function(arg1,arg2) {
		var head = this.willEmit();
		var p = head;
		while(p != null) {
			p._internal_listener(arg1,arg2);
			if(!p.stayInList) p.dispose();
			p = p._internal_next;
		}
		this.didEmit(head);
	}
	,emit1: function(arg1) {
		var head = this.willEmit();
		var p = head;
		while(p != null) {
			p._internal_listener(arg1);
			if(!p.stayInList) p.dispose();
			p = p._internal_next;
		}
		this.didEmit(head);
	}
	,emit0: function() {
		var head = this.willEmit();
		var p = head;
		while(p != null) {
			p._internal_listener();
			if(!p.stayInList) p.dispose();
			p = p._internal_next;
		}
		this.didEmit(head);
	}
	,_internal_disconnect: function(conn) {
		var _g = this;
		if(this.dispatching()) this.defer(function() {
			_g.listRemove(conn);
		}); else this.listRemove(conn);
	}
	,connectImpl: function(listener,prioritize) {
		var _g = this;
		var conn = new flambe.util.SignalConnection(this,listener);
		if(this.dispatching()) this.defer(function() {
			_g.listAdd(conn,prioritize);
		}); else this.listAdd(conn,prioritize);
		return conn;
	}
	,hasListeners: function() {
		return this._head != null;
	}
	,__class__: flambe.util.SignalBase
}
flambe.util.Signal2 = function(listener) {
	flambe.util.SignalBase.call(this,listener);
};
$hxClasses["flambe.util.Signal2"] = flambe.util.Signal2;
flambe.util.Signal2.__name__ = ["flambe","util","Signal2"];
flambe.util.Signal2.__super__ = flambe.util.SignalBase;
flambe.util.Signal2.prototype = $extend(flambe.util.SignalBase.prototype,{
	emit: function(arg1,arg2) {
		this.emit2(arg1,arg2);
	}
	,connect: function(listener,prioritize) {
		if(prioritize == null) prioritize = false;
		return this.connectImpl(listener,prioritize);
	}
	,__class__: flambe.util.Signal2
});
flambe.util.Signal1 = function(listener) {
	flambe.util.SignalBase.call(this,listener);
};
$hxClasses["flambe.util.Signal1"] = flambe.util.Signal1;
flambe.util.Signal1.__name__ = ["flambe","util","Signal1"];
flambe.util.Signal1.__super__ = flambe.util.SignalBase;
flambe.util.Signal1.prototype = $extend(flambe.util.SignalBase.prototype,{
	emit: function(arg1) {
		this.emit1(arg1);
	}
	,connect: function(listener,prioritize) {
		if(prioritize == null) prioritize = false;
		return this.connectImpl(listener,prioritize);
	}
	,__class__: flambe.util.Signal1
});
flambe.animation = {}
flambe.animation.AnimatedFloat = function(value,listener) {
	flambe.util.Value.call(this,value,listener);
};
$hxClasses["flambe.animation.AnimatedFloat"] = flambe.animation.AnimatedFloat;
flambe.animation.AnimatedFloat.__name__ = ["flambe","animation","AnimatedFloat"];
flambe.animation.AnimatedFloat.__super__ = flambe.util.Value;
flambe.animation.AnimatedFloat.prototype = $extend(flambe.util.Value.prototype,{
	set_behavior: function(behavior) {
		this._behavior = behavior;
		this.update(0);
		return behavior;
	}
	,update: function(dt) {
		if(this._behavior != null) {
			flambe.util.Value.prototype.set__.call(this,this._behavior.update(dt));
			if(this._behavior.isComplete()) this._behavior = null;
		}
	}
	,set__: function(value) {
		this._behavior = null;
		return flambe.util.Value.prototype.set__.call(this,value);
	}
	,__class__: flambe.animation.AnimatedFloat
});
flambe.System = function() { }
$hxClasses["flambe.System"] = flambe.System;
flambe.System.__name__ = ["flambe","System"];
flambe.System.init = function() {
	if(!flambe.System._calledInit) {
		flambe.System._platform.init();
		flambe.System._calledInit = true;
	}
}
flambe.System.loadAssetPack = function(manifest) {
	flambe.System.assertCalledInit();
	return flambe.System._platform.loadAssetPack(manifest);
}
flambe.System.createLogger = function(tag) {
	return new flambe.util.Logger(flambe.System._platform.createLogHandler(tag));
}
flambe.System.get_stage = function() {
	flambe.System.assertCalledInit();
	return flambe.System._platform.getStage();
}
flambe.System.get_storage = function() {
	flambe.System.assertCalledInit();
	return flambe.System._platform.getStorage();
}
flambe.System.get_pointer = function() {
	flambe.System.assertCalledInit();
	return flambe.System._platform.getPointer();
}
flambe.System.get_mouse = function() {
	flambe.System.assertCalledInit();
	return flambe.System._platform.getMouse();
}
flambe.System.get_touch = function() {
	flambe.System.assertCalledInit();
	return flambe.System._platform.getTouch();
}
flambe.System.assertCalledInit = function() {
	flambe.util.Assert.that(flambe.System._calledInit,"You must call System.init() first");
}
flambe.util.Logger = function(handler) {
	this._handler = handler;
};
$hxClasses["flambe.util.Logger"] = flambe.util.Logger;
flambe.util.Logger.__name__ = ["flambe","util","Logger"];
flambe.util.Logger.prototype = {
	log: function(level,text,args) {
		if(this._handler == null) return;
		if(text == null) text = "";
		if(args != null) text = flambe.util.Strings.withFields(text,args);
		this._handler.log(level,text);
	}
	,warn: function(text,args) {
		this.log(flambe.util.LogLevel.Warn,text,args);
	}
	,info: function(text,args) {
		this.log(flambe.util.LogLevel.Info,text,args);
	}
	,__class__: flambe.util.Logger
}
flambe.Log = function() { }
$hxClasses["flambe.Log"] = flambe.Log;
flambe.Log.__name__ = ["flambe","Log"];
flambe.Log.info = function(text,args) {
	flambe.Log.logger.info(text,args);
}
flambe.Log.warn = function(text,args) {
	flambe.Log.logger.warn(text,args);
}
flambe.Log.__super__ = flambe.util.PackageLog;
flambe.Log.prototype = $extend(flambe.util.PackageLog.prototype,{
	__class__: flambe.Log
});
flambe.SpeedAdjuster = function(scale) {
	if(scale == null) scale = 1;
	this._internal_realDt = 0;
	this.scale = new flambe.animation.AnimatedFloat(scale);
};
$hxClasses["flambe.SpeedAdjuster"] = flambe.SpeedAdjuster;
flambe.SpeedAdjuster.__name__ = ["flambe","SpeedAdjuster"];
flambe.SpeedAdjuster.getFrom = function(entity) {
	return entity.getComponent("SpeedAdjuster_10");
}
flambe.SpeedAdjuster.__super__ = flambe.Component;
flambe.SpeedAdjuster.prototype = $extend(flambe.Component.prototype,{
	onUpdate: function(dt) {
		if(this._internal_realDt > 0) {
			dt = this._internal_realDt;
			this._internal_realDt = 0;
		}
		this.scale.update(dt);
	}
	,get_name: function() {
		return "SpeedAdjuster_10";
	}
	,__class__: flambe.SpeedAdjuster
});
flambe.animation.Behavior = function() { }
$hxClasses["flambe.animation.Behavior"] = flambe.animation.Behavior;
flambe.animation.Behavior.__name__ = ["flambe","animation","Behavior"];
flambe.animation.Behavior.prototype = {
	__class__: flambe.animation.Behavior
}
flambe.animation.Binding = function() { }
$hxClasses["flambe.animation.Binding"] = flambe.animation.Binding;
flambe.animation.Binding.__name__ = ["flambe","animation","Binding"];
flambe.animation.Binding.__interfaces__ = [flambe.animation.Behavior];
flambe.animation.Binding.prototype = {
	isComplete: function() {
		return false;
	}
	,update: function(dt) {
		var value = this._target.get__();
		if(this._fn != null) return this._fn(value); else return value;
	}
	,__class__: flambe.animation.Binding
}
flambe.asset = {}
flambe.asset.AssetFormat = $hxClasses["flambe.asset.AssetFormat"] = { __ename__ : ["flambe","asset","AssetFormat"], __constructs__ : ["WEBP","JXR","PNG","JPG","GIF","MP3","M4A","OGG","WAV","Data"] }
flambe.asset.AssetFormat.WEBP = ["WEBP",0];
flambe.asset.AssetFormat.WEBP.toString = $estr;
flambe.asset.AssetFormat.WEBP.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetFormat.JXR = ["JXR",1];
flambe.asset.AssetFormat.JXR.toString = $estr;
flambe.asset.AssetFormat.JXR.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetFormat.PNG = ["PNG",2];
flambe.asset.AssetFormat.PNG.toString = $estr;
flambe.asset.AssetFormat.PNG.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetFormat.JPG = ["JPG",3];
flambe.asset.AssetFormat.JPG.toString = $estr;
flambe.asset.AssetFormat.JPG.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetFormat.GIF = ["GIF",4];
flambe.asset.AssetFormat.GIF.toString = $estr;
flambe.asset.AssetFormat.GIF.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetFormat.MP3 = ["MP3",5];
flambe.asset.AssetFormat.MP3.toString = $estr;
flambe.asset.AssetFormat.MP3.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetFormat.M4A = ["M4A",6];
flambe.asset.AssetFormat.M4A.toString = $estr;
flambe.asset.AssetFormat.M4A.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetFormat.OGG = ["OGG",7];
flambe.asset.AssetFormat.OGG.toString = $estr;
flambe.asset.AssetFormat.OGG.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetFormat.WAV = ["WAV",8];
flambe.asset.AssetFormat.WAV.toString = $estr;
flambe.asset.AssetFormat.WAV.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetFormat.Data = ["Data",9];
flambe.asset.AssetFormat.Data.toString = $estr;
flambe.asset.AssetFormat.Data.__enum__ = flambe.asset.AssetFormat;
flambe.asset.AssetEntry = function(name,url,format,bytes) {
	this.name = name;
	this.url = url;
	this.format = format;
	this.bytes = bytes;
};
$hxClasses["flambe.asset.AssetEntry"] = flambe.asset.AssetEntry;
flambe.asset.AssetEntry.__name__ = ["flambe","asset","AssetEntry"];
flambe.asset.AssetEntry.prototype = {
	__class__: flambe.asset.AssetEntry
}
flambe.asset.AssetPack = function() { }
$hxClasses["flambe.asset.AssetPack"] = flambe.asset.AssetPack;
flambe.asset.AssetPack.__name__ = ["flambe","asset","AssetPack"];
flambe.asset.AssetPack.prototype = {
	__class__: flambe.asset.AssetPack
}
var js = {}
js.Boot = function() { }
$hxClasses["js.Boot"] = js.Boot;
js.Boot.__name__ = ["js","Boot"];
js.Boot.isClass = function(o) {
	return o.__name__;
}
js.Boot.isEnum = function(e) {
	return e.__ename__;
}
js.Boot.getClass = function(o) {
	return o.__class__;
}
js.Boot.__string_rec = function(o,s) {
	if(o == null) return "null";
	if(s.length >= 5) return "<...>";
	var t = typeof(o);
	if(t == "function" && (js.Boot.isClass(o) || js.Boot.isEnum(o))) t = "object";
	switch(t) {
	case "object":
		if(o instanceof Array) {
			if(o.__enum__) {
				if(o.length == 2) return o[0];
				var str = o[0] + "(";
				s += "\t";
				var _g1 = 2, _g = o.length;
				while(_g1 < _g) {
					var i = _g1++;
					if(i != 2) str += "," + js.Boot.__string_rec(o[i],s); else str += js.Boot.__string_rec(o[i],s);
				}
				return str + ")";
			}
			var l = o.length;
			var i;
			var str = "[";
			s += "\t";
			var _g = 0;
			while(_g < l) {
				var i1 = _g++;
				str += (i1 > 0?",":"") + js.Boot.__string_rec(o[i1],s);
			}
			str += "]";
			return str;
		}
		var tostr;
		try {
			tostr = o.toString;
		} catch( e ) {
			return "???";
		}
		if(tostr != null && tostr != Object.toString) {
			var s2 = o.toString();
			if(s2 != "[object Object]") return s2;
		}
		var k = null;
		var str = "{\n";
		s += "\t";
		var hasp = o.hasOwnProperty != null;
		for( var k in o ) { ;
		if(hasp && !o.hasOwnProperty(k)) {
			continue;
		}
		if(k == "prototype" || k == "__class__" || k == "__super__" || k == "__interfaces__" || k == "__properties__") {
			continue;
		}
		if(str.length != 2) str += ", \n";
		str += s + k + " : " + js.Boot.__string_rec(o[k],s);
		}
		s = s.substring(1);
		str += "\n" + s + "}";
		return str;
	case "function":
		return "<function>";
	case "string":
		return o;
	default:
		return String(o);
	}
}
js.Boot.__interfLoop = function(cc,cl) {
	if(cc == null) return false;
	if(cc == cl) return true;
	var intf = cc.__interfaces__;
	if(intf != null) {
		var _g1 = 0, _g = intf.length;
		while(_g1 < _g) {
			var i = _g1++;
			var i1 = intf[i];
			if(i1 == cl || js.Boot.__interfLoop(i1,cl)) return true;
		}
	}
	return js.Boot.__interfLoop(cc.__super__,cl);
}
js.Boot.__instanceof = function(o,cl) {
	try {
		if(o instanceof cl) {
			if(cl == Array) return o.__enum__ == null;
			return true;
		}
		if(js.Boot.__interfLoop(js.Boot.getClass(o),cl)) return true;
	} catch( e ) {
		if(cl == null) return false;
	}
	switch(cl) {
	case Int:
		return Math.ceil(o%2147483648.0) === o;
	case Float:
		return typeof(o) == "number";
	case Bool:
		return o === true || o === false;
	case String:
		return typeof(o) == "string";
	case Dynamic:
		return true;
	default:
		if(o == null) return false;
		if(cl == Class && o.__name__ != null) return true; else null;
		if(cl == Enum && o.__ename__ != null) return true; else null;
		return o.__enum__ == cl;
	}
}
js.Boot.__cast = function(o,t) {
	if(js.Boot.__instanceof(o,t)) return o; else throw "Cannot cast " + Std.string(o) + " to " + Std.string(t);
}
flambe.util.Strings = function() { }
$hxClasses["flambe.util.Strings"] = flambe.util.Strings;
flambe.util.Strings.__name__ = ["flambe","util","Strings"];
flambe.util.Strings.getFileExtension = function(fileName) {
	var dot = fileName.lastIndexOf(".");
	return dot > 0?HxOverrides.substr(fileName,dot + 1,null):null;
}
flambe.util.Strings.removeFileExtension = function(fileName) {
	var dot = fileName.lastIndexOf(".");
	return dot > 0?HxOverrides.substr(fileName,0,dot):fileName;
}
flambe.util.Strings.getUrlExtension = function(url) {
	var question = url.lastIndexOf("?");
	if(question >= 0) url = HxOverrides.substr(url,0,question);
	var slash = url.lastIndexOf("/");
	if(slash >= 0) url = HxOverrides.substr(url,slash + 1,null);
	return flambe.util.Strings.getFileExtension(url);
}
flambe.util.Strings.joinPath = function(base,relative) {
	if(StringTools.fastCodeAt(base,base.length - 1) != 47) base += "/";
	return base + relative;
}
flambe.util.Strings.withFields = function(message,fields) {
	var ll = fields.length;
	if(ll > 0) {
		message += message.length > 0?" [":"[";
		var ii = 0;
		while(ii < ll) {
			if(ii > 0) message += ", ";
			var name = fields[ii];
			var value = fields[ii + 1];
			if(Std["is"](value,Error)) {
				var stack = value.stack;
				if(stack != null) value = stack;
			}
			message += name + "=" + Std.string(value);
			ii += 2;
		}
		message += "]";
	}
	return message;
}
js.Lib = function() { }
$hxClasses["js.Lib"] = js.Lib;
js.Lib.__name__ = ["js","Lib"];
flambe.asset.Manifest = function() {
	this._entries = [];
};
$hxClasses["flambe.asset.Manifest"] = flambe.asset.Manifest;
flambe.asset.Manifest.__name__ = ["flambe","asset","Manifest"];
flambe.asset.Manifest.build = function(packName,required) {
	if(required == null) required = true;
	var manifest = flambe.asset.Manifest._buildManifest.get(packName);
	if(manifest == null) {
		if(required) throw flambe.util.Strings.withFields("Missing asset pack",["name",packName]);
		return null;
	}
	return manifest.clone();
}
flambe.asset.Manifest.inferFormat = function(url) {
	var extension = flambe.util.Strings.getUrlExtension(url);
	if(extension != null) switch(extension.toLowerCase()) {
	case "gif":
		return flambe.asset.AssetFormat.GIF;
	case "jpg":case "jpeg":
		return flambe.asset.AssetFormat.JPG;
	case "jxr":
		return flambe.asset.AssetFormat.JXR;
	case "png":
		return flambe.asset.AssetFormat.PNG;
	case "webp":
		return flambe.asset.AssetFormat.WEBP;
	case "m4a":
		return flambe.asset.AssetFormat.M4A;
	case "mp3":
		return flambe.asset.AssetFormat.MP3;
	case "ogg":
		return flambe.asset.AssetFormat.OGG;
	case "wav":
		return flambe.asset.AssetFormat.WAV;
	} else flambe.Log.warn("No file extension for asset, it will be loaded as data",["url",url]);
	return flambe.asset.AssetFormat.Data;
}
flambe.asset.Manifest.createBuildManifests = function() {
	var macroData = new Hash();
	macroData.set("primary", [
		{ name: "vo/MMC_13b.mp3", md5: "0900cb3342c0903d9874a45e3e2a861f", bytes: 35006
		},
		{ name: "vo/MMC_13b.ogg", md5: "818a128b43f7791641722a40403070e3", bytes: 69327
		},
		{ name: "vo/MMC_4a.ogg", md5: "bebb731e75553fa3fea8cd0feec736f9", bytes: 16092
		},
		{ name: "vo/MMC_4a.mp3", md5: "ac97d6844a6b5a0d0bb68744fae972a1", bytes: 7578
		},
		{ name: "vo/MMC_36.ogg", md5: "a4144f776e216af4a44253dc7002c13b", bytes: 43442
		},
		{ name: "vo/MMC_36.mp3", md5: "e23151ce07fa728e455d49fc5ed62a81", bytes: 22154
		},
		{ name: "vo/MMC_31.ogg", md5: "6247cb61b150df9d96dffe3deb6d5795", bytes: 37294
		},
		{ name: "vo/MMC_31.mp3", md5: "c17a20e00543b8983509e71b025dbe68", bytes: 18863
		},
		{ name: "vo/MMC_43.ogg", md5: "0042177bafb50ce4591087e7a9e0e433", bytes: 13383
		},
		{ name: "vo/MMC_43.mp3", md5: "ab9b3c2d842c5b96deb7c4d85134364a", bytes: 6481
		},
		{ name: "vo/MMC_12alt.ogg", md5: "63e5bbf751e8fad341f0eae3c053f255", bytes: 18243
		},
		{ name: "vo/MMC_12alt.mp3", md5: "31dfc4b4abc2949cb5ee669f4572bb87", bytes: 8988
		},
		{ name: "vo/MMC_38.ogg", md5: "ab6feff88e76c3e147ef08e7a3c0da17", bytes: 44452
		},
		{ name: "vo/MMC_38.mp3", md5: "683548c98a71ddab975bf214f02ed6a0", bytes: 21997
		},
		{ name: "vo/MMC_44.ogg", md5: "5777ae114ac1219d8ba134770b461339", bytes: 24141
		},
		{ name: "vo/MMC_44.mp3", md5: "657c946d55756054fe9e604f0828da20", bytes: 12123
		},
		{ name: "vo/MMC_29.mp3", md5: "a0a7bc6a605d7a757029182a87da5f71", bytes: 16355
		},
		{ name: "vo/MMC_29.ogg", md5: "27c6063fac84c6a926c3148379ca653c", bytes: 32658
		},
		{ name: "vo/MMC_52.mp3", md5: "82c63c5f507fe03e29b3e32072eb8802", bytes: 18706
		},
		{ name: "vo/MMC_52.ogg", md5: "33b5615f9d5ee7677f9a9be0ea3e5fc8", bytes: 38004
		},
		{ name: "vo/MMC_7.mp3", md5: "c90448e89799acdfb117472a4c7e1aa1", bytes: 8362
		},
		{ name: "vo/MMC_7.ogg", md5: "f75c6007008f2359799aaebe1d466334", bytes: 16728
		},
		{ name: "vo/MMC_38a.ogg", md5: "1a2464f01f063a2ace56e7a69288cfcc", bytes: 45146
		},
		{ name: "vo/MMC_38a.mp3", md5: "bc763bb2556e740c20ab4bad1853465b", bytes: 22154
		},
		{ name: "vo/MMC_9.mp3", md5: "98db0d60d101b865faae0c2a6e0db7c0", bytes: 6481
		},
		{ name: "vo/MMC_20.mp3", md5: "9302dcb11254b1875d5852cf4c54d546", bytes: 17609
		},
		{ name: "vo/MMC_20.ogg", md5: "70b3ca2bdfaa1237cf3b3a12d69d77bc", bytes: 35892
		},
		{ name: "vo/MMC_9.ogg", md5: "6263b4fb422f2e7933144d6633717783", bytes: 13351
		},
		{ name: "vo/MMC_42a.ogg", md5: "f98a62cdea685d6a94e28e21f4a57c3f", bytes: 72544
		},
		{ name: "vo/MMC_6b.ogg", md5: "52a047a9d858c83b7756565126adae8a", bytes: 62490
		},
		{ name: "vo/MMC_42a.mp3", md5: "7661b55cd88fb2a4ccd57d7261c184f5", bytes: 36260
		},
		{ name: "vo/MMC_6b.mp3", md5: "7748c8c15969346d02c7b309a040f77c", bytes: 30618
		},
		{ name: "vo/MMC_27.mp3", md5: "e352b06751197db3be56970c1e53215b", bytes: 16668
		},
		{ name: "vo/MMC_27.ogg", md5: "d7550b8c5082161678b212a32f73553f", bytes: 33648
		},
		{ name: "vo/MMC_12.ogg", md5: "382b29321ae24ad318bd7bb8acda922b", bytes: 16541
		},
		{ name: "vo/MMC_12.mp3", md5: "77433df6b8f92626aed2183e9509da4d", bytes: 8518
		},
		{ name: "vo/MMC_15.ogg", md5: "b34470ef1118168640fe669fa8edefb5", bytes: 33775
		},
		{ name: "vo/MMC_15.mp3", md5: "4956c475258f50f9068c8de2cdec0e35", bytes: 16825
		},
		{ name: "vo/MMC_2b.mp3", md5: "bc026449edb9ab331c0d2cebaebfdae0", bytes: 25759
		},
		{ name: "vo/MMC_2b.ogg", md5: "d0a9ff57f26fa46b3b7c729b29ef0244", bytes: 52153
		},
		{ name: "vo/MMC_39.ogg", md5: "2dd5049744c39bf3df8c175e04d62109", bytes: 22313
		},
		{ name: "vo/MMC_39.mp3", md5: "dc9f60f6dfceee7692f36182365f2f53", bytes: 10869
		},
		{ name: "vo/MMC_30.ogg", md5: "cb17e9bc91ec447860b1345c98721b4f", bytes: 41310
		},
		{ name: "vo/MMC_30.mp3", md5: "33137ef1836b6986488e2f6635db1d42", bytes: 21057
		},
		{ name: "vo/MMC_37.ogg", md5: "d0222dead8181fed6c18aa4d2b87008a", bytes: 48848
		},
		{ name: "vo/MMC_37.mp3", md5: "7d3a05f81a0b84532ca2eb9552d24b2f", bytes: 24348
		},
		{ name: "vo/MMC_5a.mp3", md5: "e4c30e3894e1630752ad45ea6a43236c", bytes: 11496
		},
		{ name: "vo/MMC_5a.ogg", md5: "b8853d798a18eaa9b441711104fd483a", bytes: 24165
		},
		{ name: "vo/MMC_14.ogg", md5: "cdc0279d76ef3a6fd714c061f0e8c181", bytes: 65550
		},
		{ name: "vo/MMC_14.mp3", md5: "7b4b06695dbc1aa91de91c7bac1f5810", bytes: 32655
		},
		{ name: "vo/MMC_13.ogg", md5: "3dcc0445c1fb079f88870a5f3228ff2c", bytes: 87388
		},
		{ name: "vo/MMC_13.mp3", md5: "b30e6f11625c0d67b2f4bd4bff0ef517", bytes: 43313
		},
		{ name: "vo/MMC_26.mp3", md5: "310d328a342afaa1229cc14cc8763774", bytes: 20744
		},
		{ name: "vo/MMC_26.ogg", md5: "81c9940555d0d674953f68a5e6151235", bytes: 40083
		},
		{ name: "vo/MMC_21.mp3", md5: "e5636712a7a63120de0c7d05345e1080", bytes: 24348
		},
		{ name: "vo/MMC_8.mp3", md5: "d8dddc8cf8cdca46f4dfccbb21aaba06", bytes: 6637
		},
		{ name: "vo/MMC_8.ogg", md5: "7979a8e882e3c9f5f2be59e240e144d7", bytes: 14045
		},
		{ name: "vo/MMC_21.ogg", md5: "5abc2b1eee8c560eed590c1dd1795398", bytes: 49736
		},
		{ name: "vo/MMC_6.mp3", md5: "ad396d3c327726ad440f4c42b8b1f15b", bytes: 43313
		},
		{ name: "vo/MMC_6.ogg", md5: "a8ee4d066cbd0a538c01b2cd9b825a64", bytes: 86499
		},
		{ name: "vo/MMC_1.mp3", md5: "dae3a6f9ddfa79e502e159de95ac783a", bytes: 20117
		},
		{ name: "vo/MMC_28.mp3", md5: "2a4ef04a39fad27994983354e75b1a7c", bytes: 17922
		},
		{ name: "vo/MMC_28.ogg", md5: "5605e640a83b3d081639240124519a7e", bytes: 35337
		},
		{ name: "vo/MMC_1.ogg", md5: "6a9eac99db821eabc0b7e23a710917cb", bytes: 40688
		},
		{ name: "vo/MMC_1a.ogg", md5: "1a91fb397229e24562ab28555af5e103", bytes: 18991
		},
		{ name: "vo/MMC_1a.mp3", md5: "618250efa8f63dfafb506fe208894b6c", bytes: 9302
		},
		{ name: "vo/MMC_19.ogg", md5: "b70592ec9451443e0118281c3cbf361c", bytes: 20403
		},
		{ name: "vo/MMC_19.mp3", md5: "167893261dc4581d89d8af36128cb508", bytes: 9772
		},
		{ name: "vo/MMC_10.ogg", md5: "2287c0256447eb823a0e0b0d4628df08", bytes: 16003
		},
		{ name: "vo/MMC_10.mp3", md5: "3f2e243a28443001ca7098adc756334f", bytes: 7735
		},
		{ name: "vo/MMC_17.ogg", md5: "4dc2d7edcc0df7ad35561bea9274ff82", bytes: 28872
		},
		{ name: "vo/MMC_17.mp3", md5: "2c2fa5d457b0b1e59751a322a13e7db0", bytes: 13847
		},
		{ name: "vo/MMC_22.mp3", md5: "392be640564799215be052eaaa9ec2c6", bytes: 14004
		},
		{ name: "vo/MMC_22.ogg", md5: "92aaaf49bc208a750865bc7c7838c82f", bytes: 28699
		},
		{ name: "vo/MMC_25.mp3", md5: "87be10bb19b5a70c7c20299c31c8dc6b", bytes: 9615
		},
		{ name: "vo/MMC_25.ogg", md5: "5099d84963fdd1e238a22ded689044fa", bytes: 19500
		},
		{ name: "vo/MMC_2.mp3", md5: "42292bfc78b064679670788f8ec7caf3", bytes: 37201
		},
		{ name: "vo/MMC_2.ogg", md5: "056f47a4471e138b3a05e0a8888a0d00", bytes: 74945
		},
		{ name: "vo/MMC_50.mp3", md5: "8dec84197b1f757d895bc1b0e0a4dcc3", bytes: 8675
		},
		{ name: "vo/MMC_50.ogg", md5: "f241a377339d440fdd4e0b8e76651942", bytes: 18151
		},
		{ name: "vo/MMC_5.mp3", md5: "514dccff8463ede7fcbc3a8dee9ee12a", bytes: 30148
		},
		{ name: "vo/MMC_5.ogg", md5: "e74a134f5c65f6e7ca100b46bf67c6df", bytes: 60895
		},
		{ name: "vo/MMC_41.ogg", md5: "a7779c2feff5a03be392c7058db3442a", bytes: 33417
		},
		{ name: "vo/MMC_41.mp3", md5: "69b582a6e8e1fdaa27c66c39b64053da", bytes: 16668
		},
		{ name: "vo/MMC_46.ogg", md5: "86b5985f5437144b3ee010c6965d3cd4", bytes: 33304
		},
		{ name: "vo/MMC_46.mp3", md5: "76bae2c2e2b61e4fd7ed73a5db2aa08d", bytes: 15885
		},
		{ name: "vo/MMC_34.ogg", md5: "583bd853493f6402bc5fc973f8bbc039", bytes: 30539
		},
		{ name: "vo/MMC_34.mp3", md5: "8a98b4685bd233c4b103b76c4df3e8b1", bytes: 15258
		},
		{ name: "vo/MMC_48.ogg", md5: "b3178b3f38912e9fff8e7f60138f7d6c", bytes: 55889
		},
		{ name: "vo/MMC_48.mp3", md5: "d95cdee54daabd98ec3a4e5848be8516", bytes: 27483
		},
		{ name: "vo/MMC_33.ogg", md5: "608f398575158380826a2b04914844e7", bytes: 32012
		},
		{ name: "vo/MMC_33.mp3", md5: "d335f21d29340d523dc3862de6272dfa", bytes: 15728
		},
		{ name: "vo/MMC_51.mp3", md5: "e2086c217ee4373ce4603eb11c5615f4", bytes: 28424
		},
		{ name: "vo/MMC_51.ogg", md5: "5a5901c3530fb5aa796413234201585b", bytes: 57648
		},
		{ name: "vo/MMC_4.mp3", md5: "54fdb31e676bc7970295137ab40b49e6", bytes: 41433
		},
		{ name: "vo/MMC_4.ogg", md5: "9687716a9d4e2c49b3bcf6fa759c70f9", bytes: 84572
		},
		{ name: "vo/MMC_3.mp3", md5: "3487b4333dae4ad4ee5865c8234e6e96", bytes: 45821
		},
		{ name: "vo/MMC_3.ogg", md5: "71c6dcefea1c3345e93df383600d6a01", bytes: 92790
		},
		{ name: "vo/MMC_6a.ogg", md5: "dfabd073cf10326ef150b13d70d870f0", bytes: 78061
		},
		{ name: "vo/MMC_42b.ogg", md5: "b82719a572b85c4c6ac64b8ba61f3e99", bytes: 52859
		},
		{ name: "vo/MMC_6a.mp3", md5: "163265ca91840d87603f7a212f0606f5", bytes: 38611
		},
		{ name: "vo/MMC_42b.mp3", md5: "803d8aede245ae63429f5957a004a5b0", bytes: 26543
		},
		{ name: "vo/MMC_24.mp3", md5: "9781b6f6e003f5a1599d1b42396e901a", bytes: 9772
		},
		{ name: "vo/MMC_24.ogg", md5: "3ece58f1ca6b9ca7f5dfbfe31d4bcc69", bytes: 19977
		},
		{ name: "vo/MMC_23.mp3", md5: "68275f28ddcfb32a2f83ff0a31fb5ae9", bytes: 20900
		},
		{ name: "vo/MMC_23.ogg", md5: "47f47cc5b1bcb128f61016c33fe251db", bytes: 42243
		},
		{ name: "vo/MMC_16.ogg", md5: "a74efab11cad78d33ffdafcff2b31b8b", bytes: 35296
		},
		{ name: "vo/MMC_16.mp3", md5: "df43cfeff38d108dcf988554f3a2e5ee", bytes: 17609
		},
		{ name: "vo/MMC_11.ogg", md5: "edb1a148fe8df79c87c329a83823fabf", bytes: 20305
		},
		{ name: "vo/MMC_11.mp3", md5: "73f17552a9ff363f9fea948692a1b6a4", bytes: 10399
		},
		{ name: "vo/MMC_2a.mp3", md5: "5cfc8e27453aef49bfb8b1d0b372a9ad", bytes: 27013
		},
		{ name: "vo/MMC_2a.ogg", md5: "1e9c4c52787203db755dc344a19048d2", bytes: 56163
		},
		{ name: "vo/MMC_18.ogg", md5: "81f5a9fb825f9e7bc40d14dd0c46352a", bytes: 36646
		},
		{ name: "vo/MMC_18.mp3", md5: "b1ca55bc078f0880fd4789b3e3292db9", bytes: 17766
		},
		{ name: "vo/MMC_13a.mp3", md5: "bac2d3fda1c5207d778485e0c3d12e54", bytes: 25132
		},
		{ name: "vo/MMC_13a.ogg", md5: "45b812ed863e019745119fa1804fc80b", bytes: 50991
		},
		{ name: "vo/MMC_4b.ogg", md5: "9094a4cefae4eb41fcceb8e0d29a1846", bytes: 10928
		},
		{ name: "vo/MMC_4b.mp3", md5: "db4201fdf8d72a2bc3fd8cb2fb233007", bytes: 4913
		},
		{ name: "vo/MMC_32.ogg", md5: "93f0ef90255700951ef2d834e252c1e7", bytes: 54133
		},
		{ name: "vo/MMC_32.mp3", md5: "e42ca30fa7d43ce4f0f23541ee1e7430", bytes: 25759
		},
		{ name: "vo/MMC_35.ogg", md5: "40590b6f25b04e895c4d6286f5cc66e4", bytes: 22097
		},
		{ name: "vo/MMC_35.mp3", md5: "89e200be1649362d1309ddeea00e9d81", bytes: 11183
		},
		{ name: "vo/MMC_49.ogg", md5: "62e37957afbb2ecb030d1212f4b75f49", bytes: 17367
		},
		{ name: "vo/MMC_49.mp3", md5: "c4cb9a071fa44f381831faffbf07c39e", bytes: 8675
		},
		{ name: "vo/MMC_47.ogg", md5: "7078cdd13a8f52e0148685e7643911ac", bytes: 27734
		},
		{ name: "vo/MMC_47.mp3", md5: "9e22382b5995a51129caba323517d5de", bytes: 13847
		},
		{ name: "vo/MMC_40.ogg", md5: "a9ba0477760f363360589de7ff398c97", bytes: 17217
		},
		{ name: "vo/MMC_40.mp3", md5: "1248070f1413768f46e113235e316f85", bytes: 8518
		},
		{ name: "tutorial/MMC_6.ogg", md5: "a8ee4d066cbd0a538c01b2cd9b825a64", bytes: 86499
		},
		{ name: "tutorial/MMC_6.mp3", md5: "ad396d3c327726ad440f4c42b8b1f15b", bytes: 43313
		},
		{ name: "tutorial/MMC_2a.ogg", md5: "1e9c4c52787203db755dc344a19048d2", bytes: 56163
		},
		{ name: "tutorial/MMC_2a.mp3", md5: "5cfc8e27453aef49bfb8b1d0b372a9ad", bytes: 27013
		},
		{ name: "tutorial/MMC_2.ogg", md5: "056f47a4471e138b3a05e0a8888a0d00", bytes: 74945
		},
		{ name: "tutorial/MMC_2.mp3", md5: "42292bfc78b064679670788f8ec7caf3", bytes: 37201
		},
		{ name: "tutorial/MMC_5.ogg", md5: "e74a134f5c65f6e7ca100b46bf67c6df", bytes: 60895
		},
		{ name: "tutorial/MMC_5.mp3", md5: "514dccff8463ede7fcbc3a8dee9ee12a", bytes: 30148
		},
		{ name: "tutorial/MMC_4.ogg", md5: "9687716a9d4e2c49b3bcf6fa759c70f9", bytes: 84572
		},
		{ name: "tutorial/MMC_4.mp3", md5: "54fdb31e676bc7970295137ab40b49e6", bytes: 41433
		},
		{ name: "tutorial/MMC_3.ogg", md5: "71c6dcefea1c3345e93df383600d6a01", bytes: 92790
		},
		{ name: "tutorial/MMC_3.mp3", md5: "3487b4333dae4ad4ee5865c8234e6e96", bytes: 45821
		},
		{ name: "sfx/spring1.ogg", md5: "e4571b6f10dfab18779c0e87b3278cfe", bytes: 20065
		},
		{ name: "sfx/spring1.mp3", md5: "fa9b93c196cdaa7dfd3441d97c005d2b", bytes: 12280
		},
		{ name: "sfx/specialStar3.mp3", md5: "edd86abc23753f617b384af5d6e4b790", bytes: 19020
		},
		{ name: "sfx/specialStar3.ogg", md5: "e2f64513d4246328f7143a1dcc96d915", bytes: 33957
		},
		{ name: "sfx/spring6.ogg", md5: "bb52a50f2019784d8aeeb5938dbf32ff", bytes: 23528
		},
		{ name: "sfx/spring6.mp3", md5: "871823c1397af40dc190412c7b404e32", bytes: 14944
		},
		{ name: "sfx/suckBack1.ogg", md5: "ca0eec19cb8b0244ebc5c7a0b124d9a9", bytes: 24631
		},
		{ name: "sfx/suckBack1.mp3", md5: "a59f0f307403d14c3fbd649fb7e9d6e6", bytes: 12907
		},
		{ name: "sfx/bounce1.mp3", md5: "bf31fccd708107c650be33a19b80a50c", bytes: 12280
		},
		{ name: "sfx/bounce1.ogg", md5: "55d19fb6c6ae48d0b2f687e3e8e6cc59", bytes: 23131
		},
		{ name: "sfx/bounce6.mp3", md5: "d486f5fe5f360a720f9922e43cf0bda8", bytes: 12280
		},
		{ name: "sfx/bounce6.ogg", md5: "674d19f04b15b3991ef947004343513e", bytes: 21081
		},
		{ name: "sfx/specialHat1.ogg", md5: "711468f4919b0994b764652748f8b625", bytes: 22495
		},
		{ name: "sfx/specialHat1.mp3", md5: "f4e8744e94f897724843f75e94c30e27", bytes: 14161
		},
		{ name: "sfx/introStretch5.ogg", md5: "98d2dc3311192052d6f0c2c8261684dc", bytes: 11367
		},
		{ name: "sfx/introStretch5.mp3", md5: "8c47b96e7258b0c4d92023dca5b5eb48", bytes: 5227
		},
		{ name: "sfx/introStretch2.ogg", md5: "401329c626557b35d1850b7df57e6a15", bytes: 12392
		},
		{ name: "sfx/introStretch2.mp3", md5: "3261297cf82ef8c1e1889705fe00ce96", bytes: 5384
		},
		{ name: "sfx/hitYellow.mp3", md5: "1d9b6a819c3872356fccb03cf266496b", bytes: 13847
		},
		{ name: "sfx/hitYellow.ogg", md5: "4aff578b4d6d9171d542ff32d8c1b735", bytes: 23476
		},
		{ name: "sfx/specialHorn1.mp3", md5: "7993ce161f090f7a51f22954efe54e5d", bytes: 22938
		},
		{ name: "sfx/specialHorn1.ogg", md5: "c23bee7d90276280ad62dd0c190d80e0", bytes: 41154
		},
		{ name: "sfx/slide.mp3", md5: "532305d695cb1f5988c55a4c67e5dbb2", bytes: 13220
		},
		{ name: "sfx/slide.ogg", md5: "d726d4d255f263b2e5d517c03908dec4", bytes: 22275
		},
		{ name: "sfx/click2.ogg", md5: "5b680715b24e65d82e4a000f3fa9f7ff", bytes: 13316
		},
		{ name: "sfx/click2.mp3", md5: "bb558b9fef810cbcc71ad186e0ad2ecf", bytes: 7421
		},
		{ name: "sfx/specialStar2.mp3", md5: "8f7470a7e6e88d3aa7aadb0c0344f59f", bytes: 14944
		},
		{ name: "sfx/specialStar2.ogg", md5: "4be689c1d262124c49ff5dbd6aac0ea2", bytes: 31105
		},
		{ name: "sfx/introStretch3.ogg", md5: "8ee161d6ab1b5711dd060366a24e3e68", bytes: 15319
		},
		{ name: "sfx/introStretch3.mp3", md5: "77743d1c04be78d98bf8bff6553040b6", bytes: 7264
		},
		{ name: "sfx/introSuckUp2.ogg", md5: "93b228b52987fd6cdfaeaf555fd18612", bytes: 19435
		},
		{ name: "sfx/introSuckUp2.mp3", md5: "1cac269306e393c949e788d82634f247", bytes: 9772
		},
		{ name: "sfx/introBallReveal.mp3", md5: "b66c811ccc89f82d9af533a7dae1b179", bytes: 3973
		},
		{ name: "sfx/introBallReveal.ogg", md5: "9af7f1cf5c6be2dfd3dfb1946fc870ab", bytes: 8632
		},
		{ name: "sfx/introStretch4.ogg", md5: "17943c65ba296effd0fcf7d449324538", bytes: 18174
		},
		{ name: "sfx/introStretch4.mp3", md5: "659ff2dddc22a8fa6f07056fc575936e", bytes: 8832
		},
		{ name: "sfx/example.mp3", md5: "a444deb7763eb626b37e766e94139e0b", bytes: 10086
		},
		{ name: "sfx/introSuckUp1.ogg", md5: "ac48a37b1aa044fc3125666975694bb1", bytes: 25424
		},
		{ name: "sfx/specialHat3.ogg", md5: "3f03569b9b20d4f9be6a0ba280a765bd", bytes: 27779
		},
		{ name: "sfx/introSuckUp1.mp3", md5: "565985998cee18b1e4ec64186cd17e1d", bytes: 13064
		},
		{ name: "sfx/specialHat3.mp3", md5: "12735ca6475cf9ef3769aff3bd520b42", bytes: 14004
		},
		{ name: "sfx/introStretch7.ogg", md5: "d30d0e61b8d697b59954b8df42f6a714", bytes: 9571
		},
		{ name: "sfx/introStretch7.mp3", md5: "6ca563749ed123a0baa2a36657e1d296", bytes: 4757
		},
		{ name: "sfx/bounce3.mp3", md5: "57f7dd407d438634fb45a6dd0d9ebb74", bytes: 12280
		},
		{ name: "sfx/bounce3.ogg", md5: "4bb03631455edb957fa29bbb6c7ceb7d", bytes: 22445
		},
		{ name: "sfx/bounce4.mp3", md5: "13e8523e2f98dfbc066ada04e9da4b6e", bytes: 12280
		},
		{ name: "sfx/bounce4.ogg", md5: "b16b58434cf7621d5c1e4cc8844aea88", bytes: 22869
		},
		{ name: "sfx/introStretch9.ogg", md5: "66e142b6be0513c84eecb286e51cbfc6", bytes: 10280
		},
		{ name: "sfx/introStretch9.mp3", md5: "48618b8cd2121ca06d9ceba3599dd60c", bytes: 4913
		},
		{ name: "sfx/specialHorn2.mp3", md5: "532fdc0d40a1954e8494d9d523a7c084", bytes: 27640
		},
		{ name: "sfx/specialHorn2.ogg", md5: "082d0ba55293c73257dff74c4a64dd08", bytes: 53304
		},
		{ name: "sfx/click1.ogg", md5: "44e3491d6e912dbed14c6ac0f6a33ba5", bytes: 10321
		},
		{ name: "sfx/click1.mp3", md5: "973ac3dc3439b20cfa68e77559d7f1a9", bytes: 5384
		},
		{ name: "sfx/spring3.ogg", md5: "66c81412ab4d3fed877925cc869789f8", bytes: 20013
		},
		{ name: "sfx/spring3.mp3", md5: "97d5559c2e0b19226ac7f72de4990300", bytes: 12280
		},
		{ name: "sfx/specialStar1.mp3", md5: "59f8c9959511a23c3fd99c205cef71d1", bytes: 13220
		},
		{ name: "sfx/specialStar1.ogg", md5: "d5465f1a0c3b7cd27fab277c1eb07d7a", bytes: 26496
		},
		{ name: "sfx/spring4.ogg", md5: "3ffbd165143f9eda5d2dc47d890b31f4", bytes: 22212
		},
		{ name: "sfx/spring4.mp3", md5: "a2ec35953937c320712038943b377990", bytes: 12280
		},
		{ name: "sfx/bounce5.mp3", md5: "01177505b85dd83327e1c0c494c7acb6", bytes: 12280
		},
		{ name: "sfx/bounce5.ogg", md5: "4694f4d1d74295978583d7c6fa178616", bytes: 22072
		},
		{ name: "sfx/introStretch8.ogg", md5: "99559a1d1f58b9d3d4520f844d35c728", bytes: 10571
		},
		{ name: "sfx/introStretch8.mp3", md5: "82c89c576cc4fd6300a6edadbde85f15", bytes: 4913
		},
		{ name: "sfx/bounce2.mp3", md5: "1584a8769790105167e7427078314558", bytes: 12280
		},
		{ name: "sfx/bounce2.ogg", md5: "ee9ac56141a27e1ba2a8e546640567fd", bytes: 21116
		},
		{ name: "sfx/introStretch1.ogg", md5: "f825a31c76b28410b378c6351291d154", bytes: 8697
		},
		{ name: "sfx/introStretch1.mp3", md5: "0a967fe0fcd23064c6018e9dc94acdee", bytes: 3816
		},
		{ name: "sfx/specialHat2.ogg", md5: "902dd1c63139fe45da40a67ab126f5a3", bytes: 26852
		},
		{ name: "sfx/specialHat2.mp3", md5: "99274111e0e9866080286bf505945d10", bytes: 14317
		},
		{ name: "sfx/introStretch6.ogg", md5: "35d9591e2630b9df65c828449f3971b7", bytes: 11201
		},
		{ name: "sfx/introStretch6.mp3", md5: "825e764c96c7d992e904dcf7de93de30", bytes: 5070
		},
		{ name: "sfx/spring5.ogg", md5: "f31693a5a5e1b6975fa74fdf164ca64e", bytes: 17748
		},
		{ name: "sfx/spring5.mp3", md5: "e87e89e4570b8743b1c978d68acd7c05", bytes: 9929
		},
		{ name: "sfx/spring2.ogg", md5: "6f779cf6fc85079b73ba27fe2dd2b3f3", bytes: 20375
		},
		{ name: "sfx/spring2.mp3", md5: "972c5fb20675f1af7c883a7b96d9b9b6", bytes: 12280
		},
		{ name: "sfx/introSeatBelt.mp3", md5: "114b6ae7e55f148afb1d4cb70c3b1e0a", bytes: 4130
		},
		{ name: "sfx/introSeatBelt.ogg", md5: "fc892a4c121a48739cf264b5356fc3ca", bytes: 9336
		},
		{ name: "sfx/introDoorClose.ogg", md5: "63871e50b79c6d15fd2e736f120f543c", bytes: 11814
		},
		{ name: "sfx/introDoorClose.mp3", md5: "1b4a51147ea18c681d2feea059317e77", bytes: 5227
		},
		{ name: "sfx/suckBack2.ogg", md5: "e8fa44e03a2e81cda99fcea139232755", bytes: 10910
		},
		{ name: "sfx/suckBack2.mp3", md5: "d3fb3b6e91f250e89f95e1e3622b9e53", bytes: 8362
		},
		{ name: "sfx/specialHorn3.mp3", md5: "8231b704659c73fe7bb3ecea3225c850", bytes: 21214
		},
		{ name: "sfx/specialHorn3.ogg", md5: "5bfe5b05ee58070d53f6f879758cdca4", bytes: 31956
		},
		{ name: "music/loop.ogg", md5: "d4816eae7e861f24058722fcb6bcdf36", bytes: 1066554
		},
		{ name: "music/loop.mp3", md5: "2eba6c2cb421efb86b3b75d881dee1ae", bytes: 529348
		},
		{ name: "music/sting.mp3", md5: "1224bf0311f03b7a67b80632f49f3413", bytes: 23408
		},
		{ name: "music/sting.ogg", md5: "2d763fab16d10fd545c278106b3a9482", bytes: 42906
		},
		{ name: "library/MMC_Game/game-background.jpg"
		},
		{ name: "library/MMC_Game/toolbox.png"
		},
		{ name: "library/MMC_Game/atlas3.png", md5: "af6fdd2b40e74d5033fd6e9e7913336d", bytes: 252545
		},
		{ name: "library/MMC_Game/atlas4.png", md5: "96f1dc40170b7757ae22a77f7bc769a7", bytes: 1730
		},
		{ name: "library/MMC_Game/atlas2.png", md5: "8dffb8966ef6a8da282a68e67b2fe219", bytes: 390765
		},
		{ name: "library/MMC_Game/atlas1.png", md5: "25ed4a732fc1f12a0344d0042649d4f4", bytes: 409210
		},
		{ name: "library/MMC_Game/atlas0.png", md5: "390592310b1faf1c82faa1716932f862", bytes: 92538
		},
		{ name: "library/MMC_Game/library.json", md5: "a14373180870f64085911a3bae58a823", bytes: 256924
		},
		{ name: "library/MMC_Scenes/backdrop.png"
		},
		{ name: "library/MMC_Scenes/backdropball.png"
		},
		{ name: "library/MMC_Scenes/scene-background.jpg"
		},
		{ name: "library/MMC_Scenes/slidein.png"
		},
		{ name: "library/MMC_Scenes/title.jpg"
		},
		{ name: "library/MMC_Scenes/yellowmarble.png"
		},
		{ name: "library/MMC_Scenes/atlas4.png", md5: "4a736200ed19f529dc546f00cae07d4b", bytes: 313313
		},
		{ name: "library/MMC_Scenes/atlas3.png", md5: "d4397ddd12032b48e88a34a8d91dedd7", bytes: 320985
		},
		{ name: "library/MMC_Scenes/atlas2.png", md5: "6e6358572a1e105cbbfa6e35176c65aa", bytes: 264314
		},
		{ name: "library/MMC_Scenes/atlas5.png", md5: "3d0f05ce17e349122441f5a2b1380770", bytes: 155537
		},
		{ name: "library/MMC_Scenes/atlas1.png", md5: "844f7d2993a8e35aa932d05b67a896b9", bytes: 405561
		},
		{ name: "library/MMC_Scenes/atlas0.png", md5: "dc567c1348a0173aaac608307e158444", bytes: 265035
		},
		{ name: "library/MMC_Scenes/library.json", md5: "9de914a8ad9fe0d65a4a5017f22da4ae", bytes: 67262
		}
	]);
	macroData.set("config",[{ name : "Coaster7.json", md5 : "37771a3ef6f1fbd6089b716899a270fd", bytes : 2928},{ name : "strings.xml", md5 : "8206d0b273c6b0781043bb94d2f3c82e", bytes : 454},{ name : "Coaster3.json", md5 : "4c18caef1c45eca0d8b7ce69366f9eaf", bytes : 1523},{ name : "config.xml", md5 : "806bc2711ff3d5386726fc9f8261444d", bytes : 62},{ name : "scenes.json", md5 : "213ca254c76291faf4491caf7e0ece2d", bytes : 49},{ name : "Coaster6.json", md5 : "87362238893c5af890eebe0e3f7ec3b3", bytes : 3874},{ name : "Coaster2.json", md5 : "946ede76170f07f42116fa6d4d7e9c7e", bytes : 2793},{ name : "Coaster4.json", md5 : "861650cc8f6dedc6f2dae5f6841cdd6d", bytes : 3319},{ name : "Coaster5.json", md5 : "1fb9da3756b2c57444984cf081585626", bytes : 1893},{ name : "PhysicsSettings.json", md5 : "f153c611b3535f033f914d66f2744ddd", bytes : 1680},{ name : "Coaster1.json", md5 : "f360476ac6dde6e1a06af7b14dcf4d5b", bytes : 35},{ name : "strings.json", md5 : "ccf298fa0830f5f3a693058e160b7467", bytes : 12135},{ name : "soundFiles.xml", md5 : "fc108aa0885600566da42c71b5784d7b", bytes : 287},{ name : "PhysicsSettingsBackup.json", md5 : "da5d7aa16fd83e8cfb95ece0aa101e03", bytes : 1422}]);
	macroData.set("loader",[{ name : "library/MMC_Loader/library.json", md5 : "7dac65758e12efb758b65b5c036e95bb", bytes : 5407},{ name : "library/MMC_Loader/atlas0.png", md5 : "2a779211c53b6304a48b8cec530b76f3", bytes : 7113}]);
	macroData.set("preload",[{ name : "library/MMC_Preloader/library.json", md5 : "bedae0e34a770d9369e437454e2cf422", bytes : 4626},{ name : "library/MMC_Preloader/atlas0.png", md5 : "ebeff5c4416dfd9acf0584918334ad90", bytes : 694}]);
	var manifests = new Hash();
	var $it0 = macroData.keys();
	while( $it0.hasNext() ) {
		var packName = $it0.next();
		var manifest = new flambe.asset.Manifest();
		manifest.set_relativeBasePath("assets");
		var _g = 0, _g1 = macroData.get(packName);
		while(_g < _g1.length) {
			var asset = _g1[_g];
			++_g;
			var name = asset.name;
			var type = name.substring(name.lastIndexOf('.'));
			if (SMALL_ASSETS && (type === '.png' || type === '.jpg')) {
				var path = packName + "/" + name.substring(0, name.lastIndexOf('/')) + '/small' + name.substring(name.lastIndexOf('/')) + "?v=" + Std.string(asset.md5);
			} else {
				var path = packName + "/" + name + "?v=" + Std.string(asset.md5);
			}
			var format = flambe.asset.Manifest.inferFormat(name);
			if(format != flambe.asset.AssetFormat.Data) name = flambe.util.Strings.removeFileExtension(name);
			manifest.add(name,path,asset.bytes,format);
		}
		manifests.set(packName,manifest);
	}
	return manifests;
}
flambe.asset.Manifest.prototype = {
	set_externalBasePath: function(basePath) {
		this._externalBasePath = basePath;
		if(basePath != null) flambe.util.Assert.that(StringTools.startsWith(basePath,"http://") || StringTools.startsWith(basePath,"https://"),"externalBasePath must be on an external domain, starting with http(s)://");
		return basePath;
	}
	,get_externalBasePath: function() {
		return this._externalBasePath;
	}
	,set_relativeBasePath: function(basePath) {
		this._relativeBasePath = basePath;
		if(basePath != null) flambe.util.Assert.that(!StringTools.startsWith(basePath,"http://") && !StringTools.startsWith(basePath,"https://"),"relativeBasePath must be a relative path on the same domain, NOT starting with http(s)://");
		return basePath;
	}
	,get_relativeBasePath: function() {
		return this._relativeBasePath;
	}
	,getFullURL: function(entry) {
		var restricted = this.get_externalBasePath() != null && flambe.asset.Manifest._supportsCrossOrigin?this.get_externalBasePath():this.get_relativeBasePath();
		var unrestricted = this.get_externalBasePath() != null?this.get_externalBasePath():this.get_relativeBasePath();
		var base = unrestricted;
		if(entry.format == flambe.asset.AssetFormat.Data) base = restricted;
		return base != null?flambe.util.Strings.joinPath(base,entry.url):entry.url;
	}
	,clone: function() {
		var copy = new flambe.asset.Manifest();
		copy.set_relativeBasePath(this.get_relativeBasePath());
		copy.set_externalBasePath(this.get_externalBasePath());
		copy._entries = this._entries.slice();
		return copy;
	}
	,iterator: function() {
		return HxOverrides.iter(this._entries);
	}
	,add: function(name,url,bytes,format) {
		if(bytes == null) bytes = 0;
		if(format == null) format = flambe.asset.Manifest.inferFormat(url);
		var entry = new flambe.asset.AssetEntry(name,url,format,bytes);
		this._entries.push(entry);
		return entry;
	}
	,__class__: flambe.asset.Manifest
}
flambe.display.BlendMode = $hxClasses["flambe.display.BlendMode"] = { __ename__ : ["flambe","display","BlendMode"], __constructs__ : ["Normal","Add","CopyExperimental"] }
flambe.display.BlendMode.Normal = ["Normal",0];
flambe.display.BlendMode.Normal.toString = $estr;
flambe.display.BlendMode.Normal.__enum__ = flambe.display.BlendMode;
flambe.display.BlendMode.Add = ["Add",1];
flambe.display.BlendMode.Add.toString = $estr;
flambe.display.BlendMode.Add.__enum__ = flambe.display.BlendMode;
flambe.display.BlendMode.CopyExperimental = ["CopyExperimental",2];
flambe.display.BlendMode.CopyExperimental.toString = $estr;
flambe.display.BlendMode.CopyExperimental.__enum__ = flambe.display.BlendMode;
flambe.display.FillSprite = function(color,width,height) {
	flambe.display.Sprite.call(this);
	this.color = color;
	this.width = new flambe.animation.AnimatedFloat(width);
	this.height = new flambe.animation.AnimatedFloat(height);
};
$hxClasses["flambe.display.FillSprite"] = flambe.display.FillSprite;
flambe.display.FillSprite.__name__ = ["flambe","display","FillSprite"];
flambe.display.FillSprite.__super__ = flambe.display.Sprite;
flambe.display.FillSprite.prototype = $extend(flambe.display.Sprite.prototype,{
	onUpdate: function(dt) {
		flambe.display.Sprite.prototype.onUpdate.call(this,dt);
		this.width.update(dt);
		this.height.update(dt);
	}
	,getNaturalHeight: function() {
		return this.height.get__();
	}
	,getNaturalWidth: function() {
		return this.width.get__();
	}
	,draw: function(g) {
		g.fillRect(this.color,0,0,this.width.get__(),this.height.get__());
	}
	,__class__: flambe.display.FillSprite
});
flambe.display.Graphics = function() { }
$hxClasses["flambe.display.Graphics"] = flambe.display.Graphics;
flambe.display.Graphics.__name__ = ["flambe","display","Graphics"];
flambe.display.Graphics.prototype = {
	__class__: flambe.display.Graphics
}
flambe.display.ImageSprite = function(texture) {
	flambe.display.Sprite.call(this);
	this.texture = texture;
};
$hxClasses["flambe.display.ImageSprite"] = flambe.display.ImageSprite;
flambe.display.ImageSprite.__name__ = ["flambe","display","ImageSprite"];
flambe.display.ImageSprite.__super__ = flambe.display.Sprite;
flambe.display.ImageSprite.prototype = $extend(flambe.display.Sprite.prototype,{
	getNaturalHeight: function() {
		return this.texture.get_height();
	}
	,getNaturalWidth: function() {
		return this.texture.get_width();
	}
	,draw: function(g) {
		g.drawImage(this.texture,0,0);
	}
	,__class__: flambe.display.ImageSprite
});
flambe.display.Orientation = $hxClasses["flambe.display.Orientation"] = { __ename__ : ["flambe","display","Orientation"], __constructs__ : ["Portrait","Landscape"] }
flambe.display.Orientation.Portrait = ["Portrait",0];
flambe.display.Orientation.Portrait.toString = $estr;
flambe.display.Orientation.Portrait.__enum__ = flambe.display.Orientation;
flambe.display.Orientation.Landscape = ["Landscape",1];
flambe.display.Orientation.Landscape.toString = $estr;
flambe.display.Orientation.Landscape.__enum__ = flambe.display.Orientation;
flambe.display.Stage = function() { }
$hxClasses["flambe.display.Stage"] = flambe.display.Stage;
flambe.display.Stage.__name__ = ["flambe","display","Stage"];
flambe.display.Stage.prototype = {
	__class__: flambe.display.Stage
}
flambe.display.Texture = function() { }
$hxClasses["flambe.display.Texture"] = flambe.display.Texture;
flambe.display.Texture.__name__ = ["flambe","display","Texture"];
flambe.display.Texture.prototype = {
	__class__: flambe.display.Texture
}
flambe.external = {}
flambe.external.External = function() { }
$hxClasses["flambe.external.External"] = flambe.external.External;
flambe.external.External.__name__ = ["flambe","external","External"];
flambe.external.External.prototype = {
	__class__: flambe.external.External
}
flambe.input = {}
flambe.input.Accelerometer = function() { }
$hxClasses["flambe.input.Accelerometer"] = flambe.input.Accelerometer;
flambe.input.Accelerometer.__name__ = ["flambe","input","Accelerometer"];
flambe.input.Accelerometer.prototype = {
	__class__: flambe.input.Accelerometer
}
flambe.input.AccelerometerOrientation = function() {
	this._internal_update(0,0,0);
};
$hxClasses["flambe.input.AccelerometerOrientation"] = flambe.input.AccelerometerOrientation;
flambe.input.AccelerometerOrientation.__name__ = ["flambe","input","AccelerometerOrientation"];
flambe.input.AccelerometerOrientation.prototype = {
	_internal_update: function(pitch,roll,azimuth) {
		this.pitch = pitch;
		this.roll = roll;
		this.azimuth = azimuth;
	}
	,__class__: flambe.input.AccelerometerOrientation
}
flambe.input.Key = $hxClasses["flambe.input.Key"] = { __ename__ : ["flambe","input","Key"], __constructs__ : ["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","Number0","Number1","Number2","Number3","Number4","Number5","Number6","Number7","Number8","Number9","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadAdd","NumpadDecimal","NumpadDivide","NumpadEnter","NumpadMultiply","NumpadSubtract","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","F13","F14","F15","Left","Up","Right","Down","Alt","Backquote","Backslash","Backspace","CapsLock","Comma","Command","Control","Delete","End","Enter","Equals","Escape","Home","Insert","LeftBracket","Minus","PageDown","PageUp","Period","Quote","RightBracket","Semicolon","Shift","Slash","Space","Tab","Menu","Search","Unknown"] }
flambe.input.Key.A = ["A",0];
flambe.input.Key.A.toString = $estr;
flambe.input.Key.A.__enum__ = flambe.input.Key;
flambe.input.Key.B = ["B",1];
flambe.input.Key.B.toString = $estr;
flambe.input.Key.B.__enum__ = flambe.input.Key;
flambe.input.Key.C = ["C",2];
flambe.input.Key.C.toString = $estr;
flambe.input.Key.C.__enum__ = flambe.input.Key;
flambe.input.Key.D = ["D",3];
flambe.input.Key.D.toString = $estr;
flambe.input.Key.D.__enum__ = flambe.input.Key;
flambe.input.Key.E = ["E",4];
flambe.input.Key.E.toString = $estr;
flambe.input.Key.E.__enum__ = flambe.input.Key;
flambe.input.Key.F = ["F",5];
flambe.input.Key.F.toString = $estr;
flambe.input.Key.F.__enum__ = flambe.input.Key;
flambe.input.Key.G = ["G",6];
flambe.input.Key.G.toString = $estr;
flambe.input.Key.G.__enum__ = flambe.input.Key;
flambe.input.Key.H = ["H",7];
flambe.input.Key.H.toString = $estr;
flambe.input.Key.H.__enum__ = flambe.input.Key;
flambe.input.Key.I = ["I",8];
flambe.input.Key.I.toString = $estr;
flambe.input.Key.I.__enum__ = flambe.input.Key;
flambe.input.Key.J = ["J",9];
flambe.input.Key.J.toString = $estr;
flambe.input.Key.J.__enum__ = flambe.input.Key;
flambe.input.Key.K = ["K",10];
flambe.input.Key.K.toString = $estr;
flambe.input.Key.K.__enum__ = flambe.input.Key;
flambe.input.Key.L = ["L",11];
flambe.input.Key.L.toString = $estr;
flambe.input.Key.L.__enum__ = flambe.input.Key;
flambe.input.Key.M = ["M",12];
flambe.input.Key.M.toString = $estr;
flambe.input.Key.M.__enum__ = flambe.input.Key;
flambe.input.Key.N = ["N",13];
flambe.input.Key.N.toString = $estr;
flambe.input.Key.N.__enum__ = flambe.input.Key;
flambe.input.Key.O = ["O",14];
flambe.input.Key.O.toString = $estr;
flambe.input.Key.O.__enum__ = flambe.input.Key;
flambe.input.Key.P = ["P",15];
flambe.input.Key.P.toString = $estr;
flambe.input.Key.P.__enum__ = flambe.input.Key;
flambe.input.Key.Q = ["Q",16];
flambe.input.Key.Q.toString = $estr;
flambe.input.Key.Q.__enum__ = flambe.input.Key;
flambe.input.Key.R = ["R",17];
flambe.input.Key.R.toString = $estr;
flambe.input.Key.R.__enum__ = flambe.input.Key;
flambe.input.Key.S = ["S",18];
flambe.input.Key.S.toString = $estr;
flambe.input.Key.S.__enum__ = flambe.input.Key;
flambe.input.Key.T = ["T",19];
flambe.input.Key.T.toString = $estr;
flambe.input.Key.T.__enum__ = flambe.input.Key;
flambe.input.Key.U = ["U",20];
flambe.input.Key.U.toString = $estr;
flambe.input.Key.U.__enum__ = flambe.input.Key;
flambe.input.Key.V = ["V",21];
flambe.input.Key.V.toString = $estr;
flambe.input.Key.V.__enum__ = flambe.input.Key;
flambe.input.Key.W = ["W",22];
flambe.input.Key.W.toString = $estr;
flambe.input.Key.W.__enum__ = flambe.input.Key;
flambe.input.Key.X = ["X",23];
flambe.input.Key.X.toString = $estr;
flambe.input.Key.X.__enum__ = flambe.input.Key;
flambe.input.Key.Y = ["Y",24];
flambe.input.Key.Y.toString = $estr;
flambe.input.Key.Y.__enum__ = flambe.input.Key;
flambe.input.Key.Z = ["Z",25];
flambe.input.Key.Z.toString = $estr;
flambe.input.Key.Z.__enum__ = flambe.input.Key;
flambe.input.Key.Number0 = ["Number0",26];
flambe.input.Key.Number0.toString = $estr;
flambe.input.Key.Number0.__enum__ = flambe.input.Key;
flambe.input.Key.Number1 = ["Number1",27];
flambe.input.Key.Number1.toString = $estr;
flambe.input.Key.Number1.__enum__ = flambe.input.Key;
flambe.input.Key.Number2 = ["Number2",28];
flambe.input.Key.Number2.toString = $estr;
flambe.input.Key.Number2.__enum__ = flambe.input.Key;
flambe.input.Key.Number3 = ["Number3",29];
flambe.input.Key.Number3.toString = $estr;
flambe.input.Key.Number3.__enum__ = flambe.input.Key;
flambe.input.Key.Number4 = ["Number4",30];
flambe.input.Key.Number4.toString = $estr;
flambe.input.Key.Number4.__enum__ = flambe.input.Key;
flambe.input.Key.Number5 = ["Number5",31];
flambe.input.Key.Number5.toString = $estr;
flambe.input.Key.Number5.__enum__ = flambe.input.Key;
flambe.input.Key.Number6 = ["Number6",32];
flambe.input.Key.Number6.toString = $estr;
flambe.input.Key.Number6.__enum__ = flambe.input.Key;
flambe.input.Key.Number7 = ["Number7",33];
flambe.input.Key.Number7.toString = $estr;
flambe.input.Key.Number7.__enum__ = flambe.input.Key;
flambe.input.Key.Number8 = ["Number8",34];
flambe.input.Key.Number8.toString = $estr;
flambe.input.Key.Number8.__enum__ = flambe.input.Key;
flambe.input.Key.Number9 = ["Number9",35];
flambe.input.Key.Number9.toString = $estr;
flambe.input.Key.Number9.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad0 = ["Numpad0",36];
flambe.input.Key.Numpad0.toString = $estr;
flambe.input.Key.Numpad0.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad1 = ["Numpad1",37];
flambe.input.Key.Numpad1.toString = $estr;
flambe.input.Key.Numpad1.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad2 = ["Numpad2",38];
flambe.input.Key.Numpad2.toString = $estr;
flambe.input.Key.Numpad2.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad3 = ["Numpad3",39];
flambe.input.Key.Numpad3.toString = $estr;
flambe.input.Key.Numpad3.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad4 = ["Numpad4",40];
flambe.input.Key.Numpad4.toString = $estr;
flambe.input.Key.Numpad4.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad5 = ["Numpad5",41];
flambe.input.Key.Numpad5.toString = $estr;
flambe.input.Key.Numpad5.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad6 = ["Numpad6",42];
flambe.input.Key.Numpad6.toString = $estr;
flambe.input.Key.Numpad6.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad7 = ["Numpad7",43];
flambe.input.Key.Numpad7.toString = $estr;
flambe.input.Key.Numpad7.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad8 = ["Numpad8",44];
flambe.input.Key.Numpad8.toString = $estr;
flambe.input.Key.Numpad8.__enum__ = flambe.input.Key;
flambe.input.Key.Numpad9 = ["Numpad9",45];
flambe.input.Key.Numpad9.toString = $estr;
flambe.input.Key.Numpad9.__enum__ = flambe.input.Key;
flambe.input.Key.NumpadAdd = ["NumpadAdd",46];
flambe.input.Key.NumpadAdd.toString = $estr;
flambe.input.Key.NumpadAdd.__enum__ = flambe.input.Key;
flambe.input.Key.NumpadDecimal = ["NumpadDecimal",47];
flambe.input.Key.NumpadDecimal.toString = $estr;
flambe.input.Key.NumpadDecimal.__enum__ = flambe.input.Key;
flambe.input.Key.NumpadDivide = ["NumpadDivide",48];
flambe.input.Key.NumpadDivide.toString = $estr;
flambe.input.Key.NumpadDivide.__enum__ = flambe.input.Key;
flambe.input.Key.NumpadEnter = ["NumpadEnter",49];
flambe.input.Key.NumpadEnter.toString = $estr;
flambe.input.Key.NumpadEnter.__enum__ = flambe.input.Key;
flambe.input.Key.NumpadMultiply = ["NumpadMultiply",50];
flambe.input.Key.NumpadMultiply.toString = $estr;
flambe.input.Key.NumpadMultiply.__enum__ = flambe.input.Key;
flambe.input.Key.NumpadSubtract = ["NumpadSubtract",51];
flambe.input.Key.NumpadSubtract.toString = $estr;
flambe.input.Key.NumpadSubtract.__enum__ = flambe.input.Key;
flambe.input.Key.F1 = ["F1",52];
flambe.input.Key.F1.toString = $estr;
flambe.input.Key.F1.__enum__ = flambe.input.Key;
flambe.input.Key.F2 = ["F2",53];
flambe.input.Key.F2.toString = $estr;
flambe.input.Key.F2.__enum__ = flambe.input.Key;
flambe.input.Key.F3 = ["F3",54];
flambe.input.Key.F3.toString = $estr;
flambe.input.Key.F3.__enum__ = flambe.input.Key;
flambe.input.Key.F4 = ["F4",55];
flambe.input.Key.F4.toString = $estr;
flambe.input.Key.F4.__enum__ = flambe.input.Key;
flambe.input.Key.F5 = ["F5",56];
flambe.input.Key.F5.toString = $estr;
flambe.input.Key.F5.__enum__ = flambe.input.Key;
flambe.input.Key.F6 = ["F6",57];
flambe.input.Key.F6.toString = $estr;
flambe.input.Key.F6.__enum__ = flambe.input.Key;
flambe.input.Key.F7 = ["F7",58];
flambe.input.Key.F7.toString = $estr;
flambe.input.Key.F7.__enum__ = flambe.input.Key;
flambe.input.Key.F8 = ["F8",59];
flambe.input.Key.F8.toString = $estr;
flambe.input.Key.F8.__enum__ = flambe.input.Key;
flambe.input.Key.F9 = ["F9",60];
flambe.input.Key.F9.toString = $estr;
flambe.input.Key.F9.__enum__ = flambe.input.Key;
flambe.input.Key.F10 = ["F10",61];
flambe.input.Key.F10.toString = $estr;
flambe.input.Key.F10.__enum__ = flambe.input.Key;
flambe.input.Key.F11 = ["F11",62];
flambe.input.Key.F11.toString = $estr;
flambe.input.Key.F11.__enum__ = flambe.input.Key;
flambe.input.Key.F12 = ["F12",63];
flambe.input.Key.F12.toString = $estr;
flambe.input.Key.F12.__enum__ = flambe.input.Key;
flambe.input.Key.F13 = ["F13",64];
flambe.input.Key.F13.toString = $estr;
flambe.input.Key.F13.__enum__ = flambe.input.Key;
flambe.input.Key.F14 = ["F14",65];
flambe.input.Key.F14.toString = $estr;
flambe.input.Key.F14.__enum__ = flambe.input.Key;
flambe.input.Key.F15 = ["F15",66];
flambe.input.Key.F15.toString = $estr;
flambe.input.Key.F15.__enum__ = flambe.input.Key;
flambe.input.Key.Left = ["Left",67];
flambe.input.Key.Left.toString = $estr;
flambe.input.Key.Left.__enum__ = flambe.input.Key;
flambe.input.Key.Up = ["Up",68];
flambe.input.Key.Up.toString = $estr;
flambe.input.Key.Up.__enum__ = flambe.input.Key;
flambe.input.Key.Right = ["Right",69];
flambe.input.Key.Right.toString = $estr;
flambe.input.Key.Right.__enum__ = flambe.input.Key;
flambe.input.Key.Down = ["Down",70];
flambe.input.Key.Down.toString = $estr;
flambe.input.Key.Down.__enum__ = flambe.input.Key;
flambe.input.Key.Alt = ["Alt",71];
flambe.input.Key.Alt.toString = $estr;
flambe.input.Key.Alt.__enum__ = flambe.input.Key;
flambe.input.Key.Backquote = ["Backquote",72];
flambe.input.Key.Backquote.toString = $estr;
flambe.input.Key.Backquote.__enum__ = flambe.input.Key;
flambe.input.Key.Backslash = ["Backslash",73];
flambe.input.Key.Backslash.toString = $estr;
flambe.input.Key.Backslash.__enum__ = flambe.input.Key;
flambe.input.Key.Backspace = ["Backspace",74];
flambe.input.Key.Backspace.toString = $estr;
flambe.input.Key.Backspace.__enum__ = flambe.input.Key;
flambe.input.Key.CapsLock = ["CapsLock",75];
flambe.input.Key.CapsLock.toString = $estr;
flambe.input.Key.CapsLock.__enum__ = flambe.input.Key;
flambe.input.Key.Comma = ["Comma",76];
flambe.input.Key.Comma.toString = $estr;
flambe.input.Key.Comma.__enum__ = flambe.input.Key;
flambe.input.Key.Command = ["Command",77];
flambe.input.Key.Command.toString = $estr;
flambe.input.Key.Command.__enum__ = flambe.input.Key;
flambe.input.Key.Control = ["Control",78];
flambe.input.Key.Control.toString = $estr;
flambe.input.Key.Control.__enum__ = flambe.input.Key;
flambe.input.Key.Delete = ["Delete",79];
flambe.input.Key.Delete.toString = $estr;
flambe.input.Key.Delete.__enum__ = flambe.input.Key;
flambe.input.Key.End = ["End",80];
flambe.input.Key.End.toString = $estr;
flambe.input.Key.End.__enum__ = flambe.input.Key;
flambe.input.Key.Enter = ["Enter",81];
flambe.input.Key.Enter.toString = $estr;
flambe.input.Key.Enter.__enum__ = flambe.input.Key;
flambe.input.Key.Equals = ["Equals",82];
flambe.input.Key.Equals.toString = $estr;
flambe.input.Key.Equals.__enum__ = flambe.input.Key;
flambe.input.Key.Escape = ["Escape",83];
flambe.input.Key.Escape.toString = $estr;
flambe.input.Key.Escape.__enum__ = flambe.input.Key;
flambe.input.Key.Home = ["Home",84];
flambe.input.Key.Home.toString = $estr;
flambe.input.Key.Home.__enum__ = flambe.input.Key;
flambe.input.Key.Insert = ["Insert",85];
flambe.input.Key.Insert.toString = $estr;
flambe.input.Key.Insert.__enum__ = flambe.input.Key;
flambe.input.Key.LeftBracket = ["LeftBracket",86];
flambe.input.Key.LeftBracket.toString = $estr;
flambe.input.Key.LeftBracket.__enum__ = flambe.input.Key;
flambe.input.Key.Minus = ["Minus",87];
flambe.input.Key.Minus.toString = $estr;
flambe.input.Key.Minus.__enum__ = flambe.input.Key;
flambe.input.Key.PageDown = ["PageDown",88];
flambe.input.Key.PageDown.toString = $estr;
flambe.input.Key.PageDown.__enum__ = flambe.input.Key;
flambe.input.Key.PageUp = ["PageUp",89];
flambe.input.Key.PageUp.toString = $estr;
flambe.input.Key.PageUp.__enum__ = flambe.input.Key;
flambe.input.Key.Period = ["Period",90];
flambe.input.Key.Period.toString = $estr;
flambe.input.Key.Period.__enum__ = flambe.input.Key;
flambe.input.Key.Quote = ["Quote",91];
flambe.input.Key.Quote.toString = $estr;
flambe.input.Key.Quote.__enum__ = flambe.input.Key;
flambe.input.Key.RightBracket = ["RightBracket",92];
flambe.input.Key.RightBracket.toString = $estr;
flambe.input.Key.RightBracket.__enum__ = flambe.input.Key;
flambe.input.Key.Semicolon = ["Semicolon",93];
flambe.input.Key.Semicolon.toString = $estr;
flambe.input.Key.Semicolon.__enum__ = flambe.input.Key;
flambe.input.Key.Shift = ["Shift",94];
flambe.input.Key.Shift.toString = $estr;
flambe.input.Key.Shift.__enum__ = flambe.input.Key;
flambe.input.Key.Slash = ["Slash",95];
flambe.input.Key.Slash.toString = $estr;
flambe.input.Key.Slash.__enum__ = flambe.input.Key;
flambe.input.Key.Space = ["Space",96];
flambe.input.Key.Space.toString = $estr;
flambe.input.Key.Space.__enum__ = flambe.input.Key;
flambe.input.Key.Tab = ["Tab",97];
flambe.input.Key.Tab.toString = $estr;
flambe.input.Key.Tab.__enum__ = flambe.input.Key;
flambe.input.Key.Menu = ["Menu",98];
flambe.input.Key.Menu.toString = $estr;
flambe.input.Key.Menu.__enum__ = flambe.input.Key;
flambe.input.Key.Search = ["Search",99];
flambe.input.Key.Search.toString = $estr;
flambe.input.Key.Search.__enum__ = flambe.input.Key;
flambe.input.Key.Unknown = function(keyCode) { var $x = ["Unknown",100,keyCode]; $x.__enum__ = flambe.input.Key; $x.toString = $estr; return $x; }
flambe.input.Keyboard = function() { }
$hxClasses["flambe.input.Keyboard"] = flambe.input.Keyboard;
flambe.input.Keyboard.__name__ = ["flambe","input","Keyboard"];
flambe.input.Keyboard.prototype = {
	__class__: flambe.input.Keyboard
}
flambe.input.KeyboardEvent = function() {
	this._internal_init(0,null);
};
$hxClasses["flambe.input.KeyboardEvent"] = flambe.input.KeyboardEvent;
flambe.input.KeyboardEvent.__name__ = ["flambe","input","KeyboardEvent"];
flambe.input.KeyboardEvent.prototype = {
	_internal_init: function(id,key) {
		this.id = id;
		this.key = key;
	}
	,__class__: flambe.input.KeyboardEvent
}
flambe.input.Mouse = function() { }
$hxClasses["flambe.input.Mouse"] = flambe.input.Mouse;
flambe.input.Mouse.__name__ = ["flambe","input","Mouse"];
flambe.input.Mouse.prototype = {
	__class__: flambe.input.Mouse
}
flambe.input.MouseButton = $hxClasses["flambe.input.MouseButton"] = { __ename__ : ["flambe","input","MouseButton"], __constructs__ : ["Left","Middle","Right","Unknown"] }
flambe.input.MouseButton.Left = ["Left",0];
flambe.input.MouseButton.Left.toString = $estr;
flambe.input.MouseButton.Left.__enum__ = flambe.input.MouseButton;
flambe.input.MouseButton.Middle = ["Middle",1];
flambe.input.MouseButton.Middle.toString = $estr;
flambe.input.MouseButton.Middle.__enum__ = flambe.input.MouseButton;
flambe.input.MouseButton.Right = ["Right",2];
flambe.input.MouseButton.Right.toString = $estr;
flambe.input.MouseButton.Right.__enum__ = flambe.input.MouseButton;
flambe.input.MouseButton.Unknown = function(buttonCode) { var $x = ["Unknown",3,buttonCode]; $x.__enum__ = flambe.input.MouseButton; $x.toString = $estr; return $x; }
flambe.input.MouseCursor = $hxClasses["flambe.input.MouseCursor"] = { __ename__ : ["flambe","input","MouseCursor"], __constructs__ : ["Default","Button","None"] }
flambe.input.MouseCursor.Default = ["Default",0];
flambe.input.MouseCursor.Default.toString = $estr;
flambe.input.MouseCursor.Default.__enum__ = flambe.input.MouseCursor;
flambe.input.MouseCursor.Button = ["Button",1];
flambe.input.MouseCursor.Button.toString = $estr;
flambe.input.MouseCursor.Button.__enum__ = flambe.input.MouseCursor;
flambe.input.MouseCursor.None = ["None",2];
flambe.input.MouseCursor.None.toString = $estr;
flambe.input.MouseCursor.None.__enum__ = flambe.input.MouseCursor;
flambe.input.MouseEvent = function() {
	this._internal_init(0,0,0,null);
};
$hxClasses["flambe.input.MouseEvent"] = flambe.input.MouseEvent;
flambe.input.MouseEvent.__name__ = ["flambe","input","MouseEvent"];
flambe.input.MouseEvent.prototype = {
	_internal_init: function(id,viewX,viewY,button) {
		this.id = id;
		this.viewX = viewX;
		this.viewY = viewY;
		this.button = button;
	}
	,clone: function() {
		var event = new flambe.input.MouseEvent();
		event._internal_init(this.id,this.viewX,this.viewY,this.button);
		return event;
	}
	,__class__: flambe.input.MouseEvent
}
flambe.input.Pointer = function() { }
$hxClasses["flambe.input.Pointer"] = flambe.input.Pointer;
flambe.input.Pointer.__name__ = ["flambe","input","Pointer"];
flambe.input.Pointer.prototype = {
	__class__: flambe.input.Pointer
}
flambe.input.EventSource = $hxClasses["flambe.input.EventSource"] = { __ename__ : ["flambe","input","EventSource"], __constructs__ : ["Mouse","Touch"] }
flambe.input.EventSource.Mouse = function(event) { var $x = ["Mouse",0,event]; $x.__enum__ = flambe.input.EventSource; $x.toString = $estr; return $x; }
flambe.input.EventSource.Touch = function(point) { var $x = ["Touch",1,point]; $x.__enum__ = flambe.input.EventSource; $x.toString = $estr; return $x; }
flambe.input.PointerEvent = function() {
	this._internal_init(0,0,0,null,null);
};
$hxClasses["flambe.input.PointerEvent"] = flambe.input.PointerEvent;
flambe.input.PointerEvent.__name__ = ["flambe","input","PointerEvent"];
flambe.input.PointerEvent.prototype = {
	_internal_init: function(id,viewX,viewY,hit,source) {
		this.id = id;
		this.viewX = viewX;
		this.viewY = viewY;
		this.hit = hit;
		this.source = source;
		this._internal_stopped = false;
	}
	,clone: function() {
		var sourceCopy = null;
		var $e = (this.source);
		switch( $e[1] ) {
		case 0:
			var event = $e[2];
			sourceCopy = flambe.input.EventSource.Mouse(event.clone());
			break;
		default:
			sourceCopy = this.source;
		}
		var event = new flambe.input.PointerEvent();
		event._internal_init(this.id,this.viewX,this.viewY,this.hit,sourceCopy);
		return event;
	}
	,__class__: flambe.input.PointerEvent
}
flambe.input.Touch = function() { }
$hxClasses["flambe.input.Touch"] = flambe.input.Touch;
flambe.input.Touch.__name__ = ["flambe","input","Touch"];
flambe.input.Touch.prototype = {
	__class__: flambe.input.Touch
}
flambe.input.TouchPoint = function(id) {
	this.id = id;
	this._internal_source = flambe.input.EventSource.Touch(this);
};
$hxClasses["flambe.input.TouchPoint"] = flambe.input.TouchPoint;
flambe.input.TouchPoint.__name__ = ["flambe","input","TouchPoint"];
flambe.input.TouchPoint.prototype = {
	_internal_init: function(viewX,viewY) {
		this.viewX = viewX;
		this.viewY = viewY;
	}
	,__class__: flambe.input.TouchPoint
}
flambe.math.FMath = function() { }
$hxClasses["flambe.math.FMath"] = flambe.math.FMath;
flambe.math.FMath.__name__ = ["flambe","math","FMath"];
flambe.math.FMath.toRadians = function(degrees) {
	return degrees * 3.141592653589793 / 180;
}
flambe.math.FMath.toDegrees = function(radians) {
	return radians * 180 / 3.141592653589793;
}
flambe.math.FMath.clamp = function(value,min,max) {
	return value < min?min:value > max?max:value;
}
flambe.math.Matrix = function() {
	this.identity();
};
$hxClasses["flambe.math.Matrix"] = flambe.math.Matrix;
flambe.math.Matrix.__name__ = ["flambe","math","Matrix"];
flambe.math.Matrix.multiply = function(lhs,rhs,result) {
	if(result == null) result = new flambe.math.Matrix();
	var a = lhs.m00 * rhs.m00 + lhs.m01 * rhs.m10;
	var b = lhs.m00 * rhs.m01 + lhs.m01 * rhs.m11;
	var c = lhs.m00 * rhs.m02 + lhs.m01 * rhs.m12 + lhs.m02;
	result.m00 = a;
	result.m01 = b;
	result.m02 = c;
	a = lhs.m10 * rhs.m00 + lhs.m11 * rhs.m10;
	b = lhs.m10 * rhs.m01 + lhs.m11 * rhs.m11;
	c = lhs.m10 * rhs.m02 + lhs.m11 * rhs.m12 + lhs.m12;
	result.m10 = a;
	result.m11 = b;
	result.m12 = c;
	return result;
}
flambe.math.Matrix.prototype = {
	toString: function() {
		return this.m00 + " " + this.m01 + " " + this.m02 + " \\ " + this.m10 + " " + this.m11 + " " + this.m12;
	}
	,clone: function(result) {
		if(result == null) result = new flambe.math.Matrix();
		result.set(this.m00,this.m10,this.m01,this.m11,this.m02,this.m12);
		return result;
	}
	,inverseTransform: function(x,y,result) {
		var det = this.determinant();
		if(det == 0) return false;
		x -= this.m02;
		y -= this.m12;
		result.x = (x * this.m11 - y * this.m01) / det;
		result.y = (y * this.m00 - x * this.m10) / det;
		return true;
	}
	,determinant: function() {
		return this.m00 * this.m11 - this.m01 * this.m10;
	}
	,transform: function(x,y,result) {
		if(result == null) result = new flambe.math.Point();
		result.x = x * this.m00 + y * this.m01 + this.m02;
		result.y = x * this.m10 + y * this.m11 + this.m12;
		return result;
	}
	,translate: function(x,y) {
		this.m02 += this.m00 * x + this.m01 * y;
		this.m12 += this.m11 * y + this.m10 * x;
	}
	,compose: function(x,y,scaleX,scaleY,rotation) {
		var sin = Math.sin(rotation);
		var cos = Math.cos(rotation);
		this.set(cos * scaleX,sin * scaleX,-sin * scaleY,cos * scaleY,x,y);
	}
	,identity: function() {
		this.set(1,0,0,1,0,0);
	}
	,set: function(m00,m10,m01,m11,m02,m12) {
		this.m00 = m00;
		this.m01 = m01;
		this.m02 = m02;
		this.m10 = m10;
		this.m11 = m11;
		this.m12 = m12;
	}
	,__class__: flambe.math.Matrix
}
flambe.math.Rectangle = function(x,y,width,height) {
	if(height == null) height = 0;
	if(width == null) width = 0;
	if(y == null) y = 0;
	if(x == null) x = 0;
	this.set(x,y,width,height);
};
$hxClasses["flambe.math.Rectangle"] = flambe.math.Rectangle;
flambe.math.Rectangle.__name__ = ["flambe","math","Rectangle"];
flambe.math.Rectangle.prototype = {
	toString: function() {
		return "(" + this.x + "," + this.y + " " + this.width + "x" + this.height + ")";
	}
	,contains: function(x,y) {
		x -= this.x;
		y -= this.y;
		return x >= 0 && y >= 0 && x <= this.width && y <= this.height;
	}
	,set: function(x,y,width,height) {
		this.x = x;
		this.y = y;
		this.width = width;
		this.height = height;
	}
	,__class__: flambe.math.Rectangle
}
flambe.platform.BasicAssetPackLoader = function(platform,manifest) {
	var _g = this;
	if(manifest == null) return;
	this._platform = platform;
	this.promise = new flambe.util.Promise();
	this._bytesLoaded = new Hash();
	this._pack = new flambe.platform._BasicAssetPackLoader.BasicAssetPack(manifest);
	var entries = Lambda.array(manifest);
	if(entries.length == 0) this.handleSuccess(); else {
		var groups = new Hash();
		var _g1 = 0;
		while(_g1 < entries.length) {
			var entry = entries[_g1];
			++_g1;
			var group = groups.get(entry.name);
			if(group == null) {
				group = [];
				groups.set(entry.name,group);
			}
			group.push(entry);
		}
		this._assetsRemaining = Lambda.count(groups);
		var $it0 = groups.iterator();
		while( $it0.hasNext() ) {
			var group = $it0.next();
			var group1 = [group];
			this.pickBestEntry(group1[0],(function(group1) {
				return function(bestEntry) {
					if(bestEntry != null) {
						var url = manifest.getFullURL(bestEntry);
						try {
							_g.loadEntry(url,bestEntry);
						} catch( error ) {
							_g.handleError(bestEntry,"Unexpected error: " + Std.string(error));
						}
						var _g1 = _g.promise;
						_g1.set_total(_g1.get_total() + bestEntry.bytes);
					} else {
						var badEntry = group1[0][0];
						if(flambe.platform.BasicAssetPackLoader.isAudio(badEntry.format)) {
							flambe.Log.warn("Could not find a supported audio format to load",["name",badEntry.name]);
							_g.handleLoad(badEntry,flambe.platform.DummySound.getInstance());
						} else _g.handleError(badEntry,"Could not find a supported format to load");
					}
				};
			})(group1));
		}
	}
};
$hxClasses["flambe.platform.BasicAssetPackLoader"] = flambe.platform.BasicAssetPackLoader;
flambe.platform.BasicAssetPackLoader.__name__ = ["flambe","platform","BasicAssetPackLoader"];
flambe.platform.BasicAssetPackLoader.isAudio = function(format) {
	switch( (format)[1] ) {
	case 5:
	case 6:
	case 7:
	case 8:
		return true;
	default:
		return false;
	}
}
flambe.platform.BasicAssetPackLoader.prototype = {
	handleTextureError: function(entry) {
		this.handleError(entry,"Failed to create texture. Is the GPU context unavailable?");
	}
	,handleError: function(entry,message) {
		flambe.Log.warn("Error loading asset pack",["error",message,"url",entry.url]);
		this.promise.error.emit(flambe.util.Strings.withFields(message,["url",entry.url]));
	}
	,handleSuccess: function() {
		this.promise.set_result(this._pack);
	}
	,handleProgress: function(entry,bytesLoaded) {
		this._bytesLoaded.set(entry.name,bytesLoaded);
		var bytesTotal = 0;
		var $it0 = this._bytesLoaded.iterator();
		while( $it0.hasNext() ) {
			var bytes = $it0.next();
			bytesTotal += bytes;
		}
		this.promise.set_progress(bytesTotal);
	}
	,handleLoad: function(entry,asset) {
		this.handleProgress(entry,entry.bytes);
		var name = entry.name;
		switch( (entry.format)[1] ) {
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
			this._pack.textures.set(name,asset);
			break;
		case 5:
		case 6:
		case 7:
		case 8:
			this._pack.sounds.set(name,asset);
			break;
		case 9:
			this._pack.files.set(name,asset);
			break;
		}
		this._assetsRemaining -= 1;
		if(this._assetsRemaining <= 0) this.handleSuccess();
	}
	,getAssetFormats: function(fn) {
		flambe.util.Assert.fail();
	}
	,loadEntry: function(url,entry) {
		flambe.util.Assert.fail();
	}
	,pickBestEntry: function(entries,fn) {
		var onFormatsAvailable = function(formats) {
			var _g = 0;
			while(_g < formats.length) {
				var format = formats[_g];
				++_g;
				var _g1 = 0;
				while(_g1 < entries.length) {
					var entry = entries[_g1];
					++_g1;
					if(entry.format == format) {
						fn(entry);
						return;
					}
				}
			}
			fn(null);
		};
		this.getAssetFormats(onFormatsAvailable);
	}
	,__class__: flambe.platform.BasicAssetPackLoader
}
flambe.platform._BasicAssetPackLoader = {}
flambe.platform._BasicAssetPackLoader.BasicAssetPack = function(manifest) {
	this._manifest = manifest;
	this.textures = new Hash();
	this.sounds = new Hash();
	this.files = new Hash();
};
$hxClasses["flambe.platform._BasicAssetPackLoader.BasicAssetPack"] = flambe.platform._BasicAssetPackLoader.BasicAssetPack;
flambe.platform._BasicAssetPackLoader.BasicAssetPack.__name__ = ["flambe","platform","_BasicAssetPackLoader","BasicAssetPack"];
flambe.platform._BasicAssetPackLoader.BasicAssetPack.__interfaces__ = [flambe.asset.AssetPack];
flambe.platform._BasicAssetPackLoader.BasicAssetPack.warnOnExtension = function(path) {
	var ext = flambe.util.Strings.getFileExtension(path);
	if(ext != null && ext.length == 3) flambe.Log.warn("Requested asset \"" + path + "\" should not have a file extension," + " did you mean \"" + flambe.util.Strings.removeFileExtension(path) + "\"?");
}
flambe.platform._BasicAssetPackLoader.BasicAssetPack.prototype = {
	get_manifest: function() {
		return this._manifest;
	}
	,getFile: function(name,required) {
		if(required == null) required = true;
		var file = this.files.get(name);
		if(file == null && required) throw flambe.util.Strings.withFields("Missing file",["name",name]);
		return file;
	}
	,getSound: function(name,required) {
		if(required == null) required = true;
		flambe.platform._BasicAssetPackLoader.BasicAssetPack.warnOnExtension(name);
		var sound = this.sounds.get(name);
		if(sound == null && required) throw flambe.util.Strings.withFields("Missing sound",["name",name]);
		return sound;
	}
	,getTexture: function(name,required) {
		if(required == null) required = true;
		flambe.platform._BasicAssetPackLoader.BasicAssetPack.warnOnExtension(name);
		var texture = this.textures.get(name);
		if(texture == null && required) throw flambe.util.Strings.withFields("Missing texture",["name",name]);
		return texture;
	}
	,__class__: flambe.platform._BasicAssetPackLoader.BasicAssetPack
}
flambe.platform.BasicKeyboard = function() {
	this.down = new flambe.util.Signal1();
	this.up = new flambe.util.Signal1();
	this.backButton = new flambe.util.Signal0();
	this._keyStates = new IntHash();
};
$hxClasses["flambe.platform.BasicKeyboard"] = flambe.platform.BasicKeyboard;
flambe.platform.BasicKeyboard.__name__ = ["flambe","platform","BasicKeyboard"];
flambe.platform.BasicKeyboard.__interfaces__ = [flambe.input.Keyboard];
flambe.platform.BasicKeyboard.prototype = {
	submitUp: function(keyCode) {
		if(this.isCodeDown(keyCode)) {
			this._keyStates.remove(keyCode);
			flambe.platform.BasicKeyboard._sharedEvent._internal_init(flambe.platform.BasicKeyboard._sharedEvent.id + 1,flambe.platform.KeyCodes.toKey(keyCode));
			this.up.emit(flambe.platform.BasicKeyboard._sharedEvent);
		}
	}
	,submitDown: function(keyCode) {
		if(keyCode == 16777238) {
			if(this.backButton.hasListeners()) {
				this.backButton.emit();
				return true;
			}
			return false;
		}
		if(!this.isCodeDown(keyCode)) {
			this._keyStates.set(keyCode,true);
			flambe.platform.BasicKeyboard._sharedEvent._internal_init(flambe.platform.BasicKeyboard._sharedEvent.id + 1,flambe.platform.KeyCodes.toKey(keyCode));
			this.down.emit(flambe.platform.BasicKeyboard._sharedEvent);
		}
		return true;
	}
	,isCodeDown: function(keyCode) {
		return this._keyStates.exists(keyCode);
	}
	,isDown: function(key) {
		return this.isCodeDown(flambe.platform.KeyCodes.toKeyCode(key));
	}
	,get_supported: function() {
		return true;
	}
	,__class__: flambe.platform.BasicKeyboard
}
flambe.platform.BasicMouse = function(pointer) {
	this._pointer = pointer;
	this._source = flambe.input.EventSource.Mouse(flambe.platform.BasicMouse._sharedEvent);
	this.down = new flambe.util.Signal1();
	this.move = new flambe.util.Signal1();
	this.up = new flambe.util.Signal1();
	this.scroll = new flambe.util.Signal1();
	this._x = 0;
	this._y = 0;
	this._cursor = flambe.input.MouseCursor.Default;
	this._buttonStates = new IntHash();
};
$hxClasses["flambe.platform.BasicMouse"] = flambe.platform.BasicMouse;
flambe.platform.BasicMouse.__name__ = ["flambe","platform","BasicMouse"];
flambe.platform.BasicMouse.__interfaces__ = [flambe.input.Mouse];
flambe.platform.BasicMouse.prototype = {
	prepare: function(viewX,viewY,button) {
		this._x = viewX;
		this._y = viewY;
		flambe.platform.BasicMouse._sharedEvent._internal_init(flambe.platform.BasicMouse._sharedEvent.id + 1,viewX,viewY,button);
	}
	,isCodeDown: function(buttonCode) {
		return this._buttonStates.exists(buttonCode);
	}
	,submitScroll: function(viewX,viewY,velocity) {
		this._x = viewX;
		this._y = viewY;
		if(!this.scroll.hasListeners()) return false;
		this.scroll.emit(velocity);
		return true;
	}
	,submitUp: function(viewX,viewY,buttonCode) {
		if(this.isCodeDown(buttonCode)) {
			this._buttonStates.remove(buttonCode);
			this.prepare(viewX,viewY,flambe.platform.MouseCodes.toButton(buttonCode));
			this._pointer.submitUp(viewX,viewY,this._source);
			this.up.emit(flambe.platform.BasicMouse._sharedEvent);
		}
	}
	,submitMove: function(viewX,viewY) {
		this.prepare(viewX,viewY,null);
		this._pointer.submitMove(viewX,viewY,this._source);
		this.move.emit(flambe.platform.BasicMouse._sharedEvent);
	}
	,submitDown: function(viewX,viewY,buttonCode) {
		if(!this.isCodeDown(buttonCode)) {
			this._buttonStates.set(buttonCode,true);
			this.prepare(viewX,viewY,flambe.platform.MouseCodes.toButton(buttonCode));
			this._pointer.submitDown(viewX,viewY,this._source);
			this.down.emit(flambe.platform.BasicMouse._sharedEvent);
		}
	}
	,isDown: function(button) {
		return this.isCodeDown(flambe.platform.MouseCodes.toButtonCode(button));
	}
	,set_cursor: function(cursor) {
		return this._cursor = cursor;
	}
	,get_cursor: function() {
		return this._cursor;
	}
	,get_y: function() {
		return this._y;
	}
	,get_x: function() {
		return this._x;
	}
	,get_supported: function() {
		return true;
	}
	,__class__: flambe.platform.BasicMouse
}
flambe.platform.BasicPointer = function(x,y,isDown) {
	if(isDown == null) isDown = false;
	if(y == null) y = 0;
	if(x == null) x = 0;
	this.down = new flambe.util.Signal1();
	this.move = new flambe.util.Signal1();
	this.up = new flambe.util.Signal1();
	this._x = x;
	this._y = y;
	this._isDown = isDown;
};
$hxClasses["flambe.platform.BasicPointer"] = flambe.platform.BasicPointer;
flambe.platform.BasicPointer.__name__ = ["flambe","platform","BasicPointer"];
flambe.platform.BasicPointer.__interfaces__ = [flambe.input.Pointer];
flambe.platform.BasicPointer.prototype = {
	prepare: function(viewX,viewY,hit,source) {
		this._x = viewX;
		this._y = viewY;
		flambe.platform.BasicPointer._sharedEvent._internal_init(flambe.platform.BasicPointer._sharedEvent.id + 1,viewX,viewY,hit,source);
	}
	,submitUp: function(viewX,viewY,source) {
		if(!this._isDown) return;
		this._isDown = false;
		var chain = [];
		var hit = flambe.display.Sprite.hitTest(flambe.System.root,viewX,viewY);
		if(hit != null) {
			var entity = hit.owner;
			do {
				var sprite = flambe.display.Sprite.getFrom(entity);
				if(sprite != null) chain.push(sprite);
				entity = entity.parent;
			} while(entity != null);
		}
		this.prepare(viewX,viewY,hit,source);
		var _g = 0;
		while(_g < chain.length) {
			var sprite = chain[_g];
			++_g;
			var signal = sprite._internal_pointerUp;
			if(signal != null) {
				signal.emit(flambe.platform.BasicPointer._sharedEvent);
				if(flambe.platform.BasicPointer._sharedEvent._internal_stopped) return;
			}
		}
		this.up.emit(flambe.platform.BasicPointer._sharedEvent);
	}
	,submitMove: function(viewX,viewY,source) {
		var chain = [];
		var hit = flambe.display.Sprite.hitTest(flambe.System.root,viewX,viewY);
		if(hit != null) {
			var entity = hit.owner;
			do {
				var sprite = flambe.display.Sprite.getFrom(entity);
				if(sprite != null) chain.push(sprite);
				entity = entity.parent;
			} while(entity != null);
		}
		this.prepare(viewX,viewY,hit,source);
		var _g = 0;
		while(_g < chain.length) {
			var sprite = chain[_g];
			++_g;
			var signal = sprite._internal_pointerMove;
			if(signal != null) {
				signal.emit(flambe.platform.BasicPointer._sharedEvent);
				if(flambe.platform.BasicPointer._sharedEvent._internal_stopped) return;
			}
		}
		this.move.emit(flambe.platform.BasicPointer._sharedEvent);
	}
	,submitDown: function(viewX,viewY,source) {
		if(this._isDown) return;
		this._isDown = true;
		var chain = [];
		var hit = flambe.display.Sprite.hitTest(flambe.System.root,viewX,viewY);
		if(hit != null) {
			var entity = hit.owner;
			do {
				var sprite = flambe.display.Sprite.getFrom(entity);
				if(sprite != null) chain.push(sprite);
				entity = entity.parent;
			} while(entity != null);
		}
		this.prepare(viewX,viewY,hit,source);
		var _g = 0;
		while(_g < chain.length) {
			var sprite = chain[_g];
			++_g;
			var signal = sprite._internal_pointerDown;
			if(signal != null) {
				signal.emit(flambe.platform.BasicPointer._sharedEvent);
				if(flambe.platform.BasicPointer._sharedEvent._internal_stopped) return;
			}
		}
		this.down.emit(flambe.platform.BasicPointer._sharedEvent);
	}
	,isDown: function() {
		return this._isDown;
	}
	,get_y: function() {
		return this._y;
	}
	,get_x: function() {
		return this._x;
	}
	,get_supported: function() {
		return true;
	}
	,__class__: flambe.platform.BasicPointer
}
flambe.platform.BasicTouch = function(pointer,maxPoints) {
	if(maxPoints == null) maxPoints = 4;
	this._pointer = pointer;
	this._maxPoints = maxPoints;
	this._pointMap = new IntHash();
	this._points = [];
	this.down = new flambe.util.Signal1();
	this.move = new flambe.util.Signal1();
	this.up = new flambe.util.Signal1();
};
$hxClasses["flambe.platform.BasicTouch"] = flambe.platform.BasicTouch;
flambe.platform.BasicTouch.__name__ = ["flambe","platform","BasicTouch"];
flambe.platform.BasicTouch.__interfaces__ = [flambe.input.Touch];
flambe.platform.BasicTouch.prototype = {
	submitUp: function(id,viewX,viewY) {
		var point = this._pointMap.get(id);
		if(point != null) {
			point._internal_init(viewX,viewY);
			this._pointMap.remove(id);
			HxOverrides.remove(this._points,point);
			if(this._pointerTouch == point) {
				this._pointerTouch = null;
				this._pointer.submitUp(viewX,viewY,point._internal_source);
			}
			this.up.emit(point);
		}
	}
	,submitMove: function(id,viewX,viewY) {
		var point = this._pointMap.get(id);
		if(point != null) {
			point._internal_init(viewX,viewY);
			if(this._pointerTouch == point) this._pointer.submitMove(viewX,viewY,point._internal_source);
			this.move.emit(point);
		}
	}
	,submitDown: function(id,viewX,viewY) {
		if(!this._pointMap.exists(id)) {
			var point = new flambe.input.TouchPoint(id);
			point._internal_init(viewX,viewY);
			this._pointMap.set(id,point);
			this._points.push(point);
			if(this._pointerTouch == null) {
				this._pointerTouch = point;
				this._pointer.submitDown(viewX,viewY,point._internal_source);
			}
			this.down.emit(point);
		}
	}
	,get_points: function() {
		return this._points.slice();
	}
	,get_maxPoints: function() {
		return this._maxPoints;
	}
	,get_supported: function() {
		return true;
	}
	,__class__: flambe.platform.BasicTouch
}
flambe.sound = {}
flambe.sound.Sound = function() { }
$hxClasses["flambe.sound.Sound"] = flambe.sound.Sound;
flambe.sound.Sound.__name__ = ["flambe","sound","Sound"];
flambe.sound.Sound.prototype = {
	__class__: flambe.sound.Sound
}
flambe.platform.DummySound = function() {
	this._playback = new flambe.platform.DummyPlayback(this);
};
$hxClasses["flambe.platform.DummySound"] = flambe.platform.DummySound;
flambe.platform.DummySound.__name__ = ["flambe","platform","DummySound"];
flambe.platform.DummySound.__interfaces__ = [flambe.sound.Sound];
flambe.platform.DummySound.getInstance = function() {
	if(flambe.platform.DummySound._instance == null) flambe.platform.DummySound._instance = new flambe.platform.DummySound();
	return flambe.platform.DummySound._instance;
}
flambe.platform.DummySound.prototype = {
	get_duration: function() {
		return 0;
	}
	,loop: function(volume) {
		if(volume == null) volume = 1.0;
		return this._playback;
	}
	,play: function(volume) {
		if(volume == null) volume = 1.0;
		return this._playback;
	}
	,__class__: flambe.platform.DummySound
}
flambe.sound.Playback = function() { }
$hxClasses["flambe.sound.Playback"] = flambe.sound.Playback;
flambe.sound.Playback.__name__ = ["flambe","sound","Playback"];
flambe.sound.Playback.__interfaces__ = [flambe.util.Disposable];
flambe.sound.Playback.prototype = {
	__class__: flambe.sound.Playback
}
flambe.platform.DummyPlayback = function(sound) {
	this._sound = sound;
	this.volume = new flambe.animation.AnimatedFloat(0);
};
$hxClasses["flambe.platform.DummyPlayback"] = flambe.platform.DummyPlayback;
flambe.platform.DummyPlayback.__name__ = ["flambe","platform","DummyPlayback"];
flambe.platform.DummyPlayback.__interfaces__ = [flambe.sound.Playback];
flambe.platform.DummyPlayback.prototype = {
	dispose: function() {
	}
	,get_position: function() {
		return 0;
	}
	,get_ended: function() {
		return true;
	}
	,set_paused: function(paused) {
		return true;
	}
	,get_paused: function() {
		return true;
	}
	,get_sound: function() {
		return this._sound;
	}
	,__class__: flambe.platform.DummyPlayback
}
flambe.storage = {}
flambe.storage.Storage = function() { }
$hxClasses["flambe.storage.Storage"] = flambe.storage.Storage;
flambe.storage.Storage.__name__ = ["flambe","storage","Storage"];
flambe.storage.Storage.prototype = {
	__class__: flambe.storage.Storage
}
flambe.platform.DummyStorage = function() {
	this.clear();
};
$hxClasses["flambe.platform.DummyStorage"] = flambe.platform.DummyStorage;
flambe.platform.DummyStorage.__name__ = ["flambe","platform","DummyStorage"];
flambe.platform.DummyStorage.__interfaces__ = [flambe.storage.Storage];
flambe.platform.DummyStorage.prototype = {
	clear: function() {
		this._hash = new Hash();
	}
	,remove: function(key) {
		this._hash.remove(key);
	}
	,get: function(key,defaultValue) {
		return this._hash.exists(key)?this._hash.get(key):defaultValue;
	}
	,set: function(key,value) {
		this._hash.set(key,value);
		return true;
	}
	,get_supported: function() {
		return false;
	}
	,__class__: flambe.platform.DummyStorage
}
flambe.platform.DummyTouch = function() {
	this.down = new flambe.util.Signal1();
	this.move = new flambe.util.Signal1();
	this.up = new flambe.util.Signal1();
};
$hxClasses["flambe.platform.DummyTouch"] = flambe.platform.DummyTouch;
flambe.platform.DummyTouch.__name__ = ["flambe","platform","DummyTouch"];
flambe.platform.DummyTouch.__interfaces__ = [flambe.input.Touch];
flambe.platform.DummyTouch.prototype = {
	get_points: function() {
		return [];
	}
	,get_maxPoints: function() {
		return 0;
	}
	,get_supported: function() {
		return false;
	}
	,__class__: flambe.platform.DummyTouch
}
flambe.platform.EventGroup = function() {
	this._entries = [];
};
$hxClasses["flambe.platform.EventGroup"] = flambe.platform.EventGroup;
flambe.platform.EventGroup.__name__ = ["flambe","platform","EventGroup"];
flambe.platform.EventGroup.__interfaces__ = [flambe.util.Disposable];
flambe.platform.EventGroup.prototype = {
	dispose: function() {
		var _g = 0, _g1 = this._entries;
		while(_g < _g1.length) {
			var entry = _g1[_g];
			++_g;
			entry.dispatcher.removeEventListener(entry.type,entry.listener,false);
		}
		this._entries = [];
	}
	,addDisposingListener: function(dispatcher,type,listener) {
		var _g = this;
		this.addListener(dispatcher,type,function(event) {
			_g.dispose();
			listener(event);
		});
	}
	,addListener: function(dispatcher,type,listener) {
		dispatcher.addEventListener(type,listener,false);
		this._entries.push(new flambe.platform._EventGroup.Entry(dispatcher,type,listener));
	}
	,__class__: flambe.platform.EventGroup
}
flambe.platform._EventGroup = {}
flambe.platform._EventGroup.Entry = function(dispatcher,type,listener) {
	this.dispatcher = dispatcher;
	this.type = type;
	this.listener = listener;
};
$hxClasses["flambe.platform._EventGroup.Entry"] = flambe.platform._EventGroup.Entry;
flambe.platform._EventGroup.Entry.__name__ = ["flambe","platform","_EventGroup","Entry"];
flambe.platform._EventGroup.Entry.prototype = {
	__class__: flambe.platform._EventGroup.Entry
}
flambe.platform.HeavySignal1 = function(listener) {
	flambe.util.Signal1.call(this,listener);
	this.hasListenersValue = new flambe.util.Value(this.hasListeners());
};
$hxClasses["flambe.platform.HeavySignal1"] = flambe.platform.HeavySignal1;
flambe.platform.HeavySignal1.__name__ = ["flambe","platform","HeavySignal1"];
flambe.platform.HeavySignal1.__super__ = flambe.util.Signal1;
flambe.platform.HeavySignal1.prototype = $extend(flambe.util.Signal1.prototype,{
	didEmit: function(head) {
		flambe.util.Signal1.prototype.didEmit.call(this,head);
		this.hasListenersValue.set__(this.hasListeners());
	}
	,_internal_disconnect: function(conn) {
		flambe.util.Signal1.prototype._internal_disconnect.call(this,conn);
		this.hasListenersValue.set__(this.hasListeners());
	}
	,connect: function(listener,prioritize) {
		if(prioritize == null) prioritize = false;
		var connection = flambe.util.Signal1.prototype.connect.call(this,listener,prioritize);
		this.hasListenersValue.set__(this.hasListeners());
		return connection;
	}
	,__class__: flambe.platform.HeavySignal1
});
flambe.platform.KeyCodes = function() { }
$hxClasses["flambe.platform.KeyCodes"] = flambe.platform.KeyCodes;
flambe.platform.KeyCodes.__name__ = ["flambe","platform","KeyCodes"];
flambe.platform.KeyCodes.toKey = function(keyCode) {
	switch(keyCode) {
	case 65:
		return flambe.input.Key.A;
	case 66:
		return flambe.input.Key.B;
	case 67:
		return flambe.input.Key.C;
	case 68:
		return flambe.input.Key.D;
	case 69:
		return flambe.input.Key.E;
	case 70:
		return flambe.input.Key.F;
	case 71:
		return flambe.input.Key.G;
	case 72:
		return flambe.input.Key.H;
	case 73:
		return flambe.input.Key.I;
	case 74:
		return flambe.input.Key.J;
	case 75:
		return flambe.input.Key.K;
	case 76:
		return flambe.input.Key.L;
	case 77:
		return flambe.input.Key.M;
	case 78:
		return flambe.input.Key.N;
	case 79:
		return flambe.input.Key.O;
	case 80:
		return flambe.input.Key.P;
	case 81:
		return flambe.input.Key.Q;
	case 82:
		return flambe.input.Key.R;
	case 83:
		return flambe.input.Key.S;
	case 84:
		return flambe.input.Key.T;
	case 85:
		return flambe.input.Key.U;
	case 86:
		return flambe.input.Key.V;
	case 87:
		return flambe.input.Key.W;
	case 88:
		return flambe.input.Key.X;
	case 89:
		return flambe.input.Key.Y;
	case 90:
		return flambe.input.Key.Z;
	case 48:
		return flambe.input.Key.Number0;
	case 49:
		return flambe.input.Key.Number1;
	case 50:
		return flambe.input.Key.Number2;
	case 51:
		return flambe.input.Key.Number3;
	case 52:
		return flambe.input.Key.Number4;
	case 53:
		return flambe.input.Key.Number5;
	case 54:
		return flambe.input.Key.Number6;
	case 55:
		return flambe.input.Key.Number7;
	case 56:
		return flambe.input.Key.Number8;
	case 57:
		return flambe.input.Key.Number9;
	case 96:
		return flambe.input.Key.Numpad0;
	case 97:
		return flambe.input.Key.Numpad1;
	case 98:
		return flambe.input.Key.Numpad2;
	case 99:
		return flambe.input.Key.Numpad3;
	case 100:
		return flambe.input.Key.Numpad4;
	case 101:
		return flambe.input.Key.Numpad5;
	case 102:
		return flambe.input.Key.Numpad6;
	case 103:
		return flambe.input.Key.Numpad7;
	case 104:
		return flambe.input.Key.Numpad8;
	case 105:
		return flambe.input.Key.Numpad9;
	case 107:
		return flambe.input.Key.NumpadAdd;
	case 110:
		return flambe.input.Key.NumpadDecimal;
	case 111:
		return flambe.input.Key.NumpadDivide;
	case 108:
		return flambe.input.Key.NumpadEnter;
	case 106:
		return flambe.input.Key.NumpadMultiply;
	case 109:
		return flambe.input.Key.NumpadSubtract;
	case 112:
		return flambe.input.Key.F1;
	case 113:
		return flambe.input.Key.F2;
	case 114:
		return flambe.input.Key.F3;
	case 115:
		return flambe.input.Key.F4;
	case 116:
		return flambe.input.Key.F5;
	case 117:
		return flambe.input.Key.F6;
	case 118:
		return flambe.input.Key.F7;
	case 119:
		return flambe.input.Key.F8;
	case 120:
		return flambe.input.Key.F9;
	case 121:
		return flambe.input.Key.F10;
	case 122:
		return flambe.input.Key.F11;
	case 123:
		return flambe.input.Key.F12;
	case 37:
		return flambe.input.Key.Left;
	case 38:
		return flambe.input.Key.Up;
	case 39:
		return flambe.input.Key.Right;
	case 40:
		return flambe.input.Key.Down;
	case 18:
		return flambe.input.Key.Alt;
	case 192:
		return flambe.input.Key.Backquote;
	case 220:
		return flambe.input.Key.Backslash;
	case 8:
		return flambe.input.Key.Backspace;
	case 20:
		return flambe.input.Key.CapsLock;
	case 188:
		return flambe.input.Key.Comma;
	case 15:
		return flambe.input.Key.Command;
	case 17:
		return flambe.input.Key.Control;
	case 46:
		return flambe.input.Key.Delete;
	case 35:
		return flambe.input.Key.End;
	case 13:
		return flambe.input.Key.Enter;
	case 187:
		return flambe.input.Key.Equals;
	case 27:
		return flambe.input.Key.Escape;
	case 36:
		return flambe.input.Key.Home;
	case 45:
		return flambe.input.Key.Insert;
	case 219:
		return flambe.input.Key.LeftBracket;
	case 189:
		return flambe.input.Key.Minus;
	case 34:
		return flambe.input.Key.PageDown;
	case 33:
		return flambe.input.Key.PageUp;
	case 190:
		return flambe.input.Key.Period;
	case 222:
		return flambe.input.Key.Quote;
	case 221:
		return flambe.input.Key.RightBracket;
	case 186:
		return flambe.input.Key.Semicolon;
	case 16:
		return flambe.input.Key.Shift;
	case 191:
		return flambe.input.Key.Slash;
	case 32:
		return flambe.input.Key.Space;
	case 9:
		return flambe.input.Key.Tab;
	case 16777234:
		return flambe.input.Key.Menu;
	case 16777247:
		return flambe.input.Key.Search;
	}
	return flambe.input.Key.Unknown(keyCode);
}
flambe.platform.KeyCodes.toKeyCode = function(key) {
	var $e = (key);
	switch( $e[1] ) {
	case 0:
		return 65;
	case 1:
		return 66;
	case 2:
		return 67;
	case 3:
		return 68;
	case 4:
		return 69;
	case 5:
		return 70;
	case 6:
		return 71;
	case 7:
		return 72;
	case 8:
		return 73;
	case 9:
		return 74;
	case 10:
		return 75;
	case 11:
		return 76;
	case 12:
		return 77;
	case 13:
		return 78;
	case 14:
		return 79;
	case 15:
		return 80;
	case 16:
		return 81;
	case 17:
		return 82;
	case 18:
		return 83;
	case 19:
		return 84;
	case 20:
		return 85;
	case 21:
		return 86;
	case 22:
		return 87;
	case 23:
		return 88;
	case 24:
		return 89;
	case 25:
		return 90;
	case 26:
		return 48;
	case 27:
		return 49;
	case 28:
		return 50;
	case 29:
		return 51;
	case 30:
		return 52;
	case 31:
		return 53;
	case 32:
		return 54;
	case 33:
		return 55;
	case 34:
		return 56;
	case 35:
		return 57;
	case 36:
		return 96;
	case 37:
		return 97;
	case 38:
		return 98;
	case 39:
		return 99;
	case 40:
		return 100;
	case 41:
		return 101;
	case 42:
		return 102;
	case 43:
		return 103;
	case 44:
		return 104;
	case 45:
		return 105;
	case 46:
		return 107;
	case 47:
		return 110;
	case 48:
		return 111;
	case 49:
		return 108;
	case 50:
		return 106;
	case 51:
		return 109;
	case 52:
		return 112;
	case 53:
		return 113;
	case 54:
		return 114;
	case 55:
		return 115;
	case 56:
		return 116;
	case 57:
		return 117;
	case 58:
		return 118;
	case 59:
		return 119;
	case 60:
		return 120;
	case 61:
		return 121;
	case 62:
		return 122;
	case 63:
		return 123;
	case 64:
		return 124;
	case 65:
		return 125;
	case 66:
		return 126;
	case 67:
		return 37;
	case 68:
		return 38;
	case 69:
		return 39;
	case 70:
		return 40;
	case 71:
		return 18;
	case 72:
		return 192;
	case 73:
		return 220;
	case 74:
		return 8;
	case 75:
		return 20;
	case 76:
		return 188;
	case 77:
		return 15;
	case 78:
		return 17;
	case 79:
		return 46;
	case 80:
		return 35;
	case 81:
		return 13;
	case 82:
		return 187;
	case 83:
		return 27;
	case 84:
		return 36;
	case 85:
		return 45;
	case 86:
		return 219;
	case 87:
		return 189;
	case 88:
		return 34;
	case 89:
		return 33;
	case 90:
		return 190;
	case 91:
		return 222;
	case 92:
		return 221;
	case 93:
		return 186;
	case 94:
		return 16;
	case 95:
		return 191;
	case 96:
		return 32;
	case 97:
		return 9;
	case 98:
		return 16777234;
	case 99:
		return 16777247;
	case 100:
		var keyCode = $e[2];
		return keyCode;
	}
}
flambe.platform.MainLoop = function() {
	this._tickables = [];
};
$hxClasses["flambe.platform.MainLoop"] = flambe.platform.MainLoop;
flambe.platform.MainLoop.__name__ = ["flambe","platform","MainLoop"];
flambe.platform.MainLoop.updateEntity = function(entity,dt) {
	var speed = flambe.SpeedAdjuster.getFrom(entity);
	if(speed != null) {
		speed._internal_realDt = dt;
		dt *= speed.scale.get__();
		if(dt <= 0) {
			speed.onUpdate(dt);
			return;
		}
	}
	var p = entity.firstComponent;
	while(p != null) {
		var next = p.next;
		p.onUpdate(dt);
		p = next;
	}
	var p1 = entity.firstChild;
	while(p1 != null) {
		var next = p1.next;
		flambe.platform.MainLoop.updateEntity(p1,dt);
		p1 = next;
	}
}
flambe.platform.MainLoop.prototype = {
	addTickable: function(t) {
		this._tickables.push(t);
	}
	,render: function(renderer) {
		var graphics = renderer.willRender();
		if(graphics != null) {
			flambe.display.Sprite.render(flambe.System.root,graphics);
			renderer.didRender();
		}
	}
	,update: function(dt) {
		if(dt <= 0) {
			flambe.Log.warn("Zero or negative time elapsed since the last frame!",["dt",dt]);
			return;
		}
		if(dt > 1) dt = 1;
		var ii = 0;
		while(ii < this._tickables.length) {
			var t = this._tickables[ii];
			if(t == null || t.update(dt)) this._tickables.splice(ii,1); else ++ii;
		}
		flambe.System.volume.update(dt);
		flambe.platform.MainLoop.updateEntity(flambe.System.root,dt);
	}
	,__class__: flambe.platform.MainLoop
}
flambe.platform.ManifestBuilder = function() { }
$hxClasses["flambe.platform.ManifestBuilder"] = flambe.platform.ManifestBuilder;
flambe.platform.ManifestBuilder.__name__ = ["flambe","platform","ManifestBuilder"];
flambe.platform.MouseCodes = function() { }
$hxClasses["flambe.platform.MouseCodes"] = flambe.platform.MouseCodes;
flambe.platform.MouseCodes.__name__ = ["flambe","platform","MouseCodes"];
flambe.platform.MouseCodes.toButton = function(buttonCode) {
	switch(buttonCode) {
	case 0:
		return flambe.input.MouseButton.Left;
	case 1:
		return flambe.input.MouseButton.Middle;
	case 2:
		return flambe.input.MouseButton.Right;
	}
	return flambe.input.MouseButton.Unknown(buttonCode);
}
flambe.platform.MouseCodes.toButtonCode = function(button) {
	var $e = (button);
	switch( $e[1] ) {
	case 0:
		return 0;
	case 1:
		return 1;
	case 2:
		return 2;
	case 3:
		var buttonCode = $e[2];
		return buttonCode;
	}
}
flambe.platform.Renderer = function() { }
$hxClasses["flambe.platform.Renderer"] = flambe.platform.Renderer;
flambe.platform.Renderer.__name__ = ["flambe","platform","Renderer"];
flambe.platform.Renderer.prototype = {
	__class__: flambe.platform.Renderer
}
flambe.platform.Tickable = function() { }
$hxClasses["flambe.platform.Tickable"] = flambe.platform.Tickable;
flambe.platform.Tickable.__name__ = ["flambe","platform","Tickable"];
flambe.platform.Tickable.prototype = {
	__class__: flambe.platform.Tickable
}
flambe.platform.html.CanvasGraphics = function(canvas) {
	this._firstDraw = false;
	this._canvasCtx = canvas.getContext("2d");
};
$hxClasses["flambe.platform.html.CanvasGraphics"] = flambe.platform.html.CanvasGraphics;
flambe.platform.html.CanvasGraphics.__name__ = ["flambe","platform","html","CanvasGraphics"];
flambe.platform.html.CanvasGraphics.__interfaces__ = [flambe.display.Graphics];
flambe.platform.html.CanvasGraphics.prototype = {
	willRender: function() {
		this._firstDraw = true;
	}
	,applyScissor: function(x,y,width,height) {
		this._canvasCtx.beginPath();
		this._canvasCtx.rect(Std["int"](x),Std["int"](y),Std["int"](width),Std["int"](height));
		this._canvasCtx.clip();
	}
	,setBlendMode: function(blendMode) {
		var op;
		switch( (blendMode)[1] ) {
		case 0:
			op = "source-over";
			break;
		case 1:
			op = "lighter";
			break;
		case 2:
			op = "source-over";
			break;
		}
		this._canvasCtx.globalCompositeOperation = op;
	}
	,setAlpha: function(alpha) {
		this._canvasCtx.globalAlpha = alpha;
	}
	,multiplyAlpha: function(factor) {
		this._canvasCtx.globalAlpha *= factor;
	}
	,fillRect: function(color,x,y,width,height) {
		if(this._firstDraw) {
			this._firstDraw = false;
			this._canvasCtx.globalCompositeOperation = "copy";
			this.fillRect(color,x,y,width,height);
			this._canvasCtx.globalCompositeOperation = "source-over";
			return;
		}
		this._canvasCtx.fillStyle = "#" + ("00000" + color.toString(16)).slice(-6);
		this._canvasCtx.fillRect(Std["int"](x),Std["int"](y),Std["int"](width),Std["int"](height));
	}
	,drawPattern: function(texture,x,y,width,height) {
		if(this._firstDraw) {
			this._firstDraw = false;
			this._canvasCtx.globalCompositeOperation = "copy";
			this.drawPattern(texture,x,y,width,height);
			this._canvasCtx.globalCompositeOperation = "source-over";
			return;
		}
		var texture1 = texture;
		if(texture1.pattern == null) texture1.pattern = this._canvasCtx.createPattern(texture1.image,"repeat");
		this._canvasCtx.fillStyle = texture1.pattern;
		this._canvasCtx.fillRect(Std["int"](x),Std["int"](y),Std["int"](width),Std["int"](height));
	}
	,drawSubImage: function(texture,destX,destY,sourceX,sourceY,sourceW,sourceH) {
		if(this._firstDraw) {
			this._firstDraw = false;
			this._canvasCtx.globalCompositeOperation = "copy";
			this.drawSubImage(texture,destX,destY,sourceX,sourceY,sourceW,sourceH);
			this._canvasCtx.globalCompositeOperation = "source-over";
			return;
		}
		var texture1 = texture;

		if (SMALL_ASSETS) {
			this._canvasCtx.drawImage(texture1.image, Std["int"](sourceX) / 2, Std["int"](sourceY) / 2, Std["int"](sourceW) / 2, Std["int"](sourceH) / 2, Std["int"](destX), Std["int"](destY), Std["int"](sourceW), Std["int"](sourceH));
		} else {
			this._canvasCtx.drawImage(texture1.image, Std["int"](sourceX), Std["int"](sourceY), Std["int"](sourceW), Std["int"](sourceH), Std["int"](destX), Std["int"](destY), Std["int"](sourceW), Std["int"](sourceH));
		}
	}
	,drawImage: function(texture,x,y) {
		if(this._firstDraw) {
			this._firstDraw = false;
			this._canvasCtx.globalCompositeOperation = "copy";
			this.drawImage(texture,x,y);
			this._canvasCtx.globalCompositeOperation = "source-over";
			return;
		}
		var texture1 = texture;
		this._canvasCtx.drawImage(texture1.image,Std["int"](x),Std["int"](y));
	}
	,restore: function() {
		this._canvasCtx.restore();
	}
	,transform: function(m00,m10,m01,m11,m02,m12) {
		this._canvasCtx.transform(m00,m10,m01,m11,Std["int"](m02),Std["int"](m12));
	}
	,rotate: function(rotation) {
		this._canvasCtx.rotate(flambe.math.FMath.toRadians(rotation));
	}
	,scale: function(x,y) {
		this._canvasCtx.scale(x,y);
	}
	,translate: function(x,y) {
		this._canvasCtx.translate(Std["int"](x),Std["int"](y));
	}
	,save: function() {
		this._canvasCtx.save();
	}
	,__class__: flambe.platform.html.CanvasGraphics
}
flambe.platform.html.CanvasRenderer = function(canvas) {
	this._graphics = new flambe.platform.html.CanvasGraphics(canvas);
};
$hxClasses["flambe.platform.html.CanvasRenderer"] = flambe.platform.html.CanvasRenderer;
flambe.platform.html.CanvasRenderer.__name__ = ["flambe","platform","html","CanvasRenderer"];
flambe.platform.html.CanvasRenderer.__interfaces__ = [flambe.platform.Renderer];
flambe.platform.html.CanvasRenderer.prototype = {
	didRender: function() {
	}
	,willRender: function() {
		this._graphics.willRender();
		return this._graphics;
	}
	,createEmptyTexture: function(width,height) {
		return new flambe.platform.html.CanvasTexture(flambe.platform.html.HtmlUtil.createEmptyCanvas(width,height));
	}
	,createTexture: function(image) {
		return new flambe.platform.html.CanvasTexture(flambe.platform.html.CanvasRenderer.CANVAS_TEXTURES?flambe.platform.html.HtmlUtil.createCanvas(image):image);
	}
	,__class__: flambe.platform.html.CanvasRenderer
}
flambe.platform.html.CanvasTexture = function(image) {
	this._graphics = null;
	this.image = image;
};
$hxClasses["flambe.platform.html.CanvasTexture"] = flambe.platform.html.CanvasTexture;
flambe.platform.html.CanvasTexture.__name__ = ["flambe","platform","html","CanvasTexture"];
flambe.platform.html.CanvasTexture.__interfaces__ = [flambe.display.Texture];
flambe.platform.html.CanvasTexture.prototype = {
	getContext2d: function() {
		if(!Std["is"](this.image,HTMLCanvasElement)) this.image = flambe.platform.html.HtmlUtil.createCanvas(this.image);
		return this.image.getContext("2d");
	}
	,get_graphics: function() {
		if(this._graphics == null) {
			this.getContext2d();
			this._graphics = new flambe.platform.html._CanvasTexture.InternalGraphics(this);
		}
		return this._graphics;
	}
	,get_height: function() {
		return this.image.height;
	}
	,get_width: function() {
		return this.image.width;
	}
	,dirtyContents: function() {
		this.pattern = null;
	}
	,writePixels: function(pixels,x,y,sourceW,sourceH) {
		var ctx2d = this.getContext2d();
		var imageData = ctx2d.createImageData(sourceW,sourceH);
		var data = imageData.data;
		if(data.set != null) data.set(pixels.getData()); else {
			var size = 4 * sourceW * sourceH;
			var _g = 0;
			while(_g < size) {
				var ii = _g++;
				data[ii] = pixels.get(ii);
			}
		}
		ctx2d.putImageData(imageData,x,y);
		this.dirtyContents();
	}
	,readPixels: function(x,y,width,height) {
		return haxe.io.Bytes.ofData(this.getContext2d().getImageData(x,y,width,height).data);
	}
	,__class__: flambe.platform.html.CanvasTexture
}
flambe.platform.html._CanvasTexture = {}
flambe.platform.html._CanvasTexture.InternalGraphics = function(renderTarget) {
	flambe.platform.html.CanvasGraphics.call(this,renderTarget.image);
	this._renderTarget = renderTarget;
};
$hxClasses["flambe.platform.html._CanvasTexture.InternalGraphics"] = flambe.platform.html._CanvasTexture.InternalGraphics;
flambe.platform.html._CanvasTexture.InternalGraphics.__name__ = ["flambe","platform","html","_CanvasTexture","InternalGraphics"];
flambe.platform.html._CanvasTexture.InternalGraphics.__super__ = flambe.platform.html.CanvasGraphics;
flambe.platform.html._CanvasTexture.InternalGraphics.prototype = $extend(flambe.platform.html.CanvasGraphics.prototype,{
	fillRect: function(color,x,y,width,height) {
		flambe.platform.html.CanvasGraphics.prototype.fillRect.call(this,color,x,y,width,height);
		this._renderTarget.dirtyContents();
	}
	,drawPattern: function(texture,x,y,width,height) {
		flambe.platform.html.CanvasGraphics.prototype.drawPattern.call(this,texture,x,y,width,height);
		this._renderTarget.dirtyContents();
	}
	,drawSubImage: function(texture,destX,destY,sourceX,sourceY,sourceW,sourceH) {
		flambe.platform.html.CanvasGraphics.prototype.drawSubImage.call(this,texture,destX,destY,sourceX,sourceY,sourceW,sourceH);
		this._renderTarget.dirtyContents();
	}
	,drawImage: function(texture,x,y) {
		flambe.platform.html.CanvasGraphics.prototype.drawImage.call(this,texture,x,y);
		this._renderTarget.dirtyContents();
	}
	,__class__: flambe.platform.html._CanvasTexture.InternalGraphics
});
flambe.platform.html.HtmlAccelerometer = function() {
	var _g = this;
	this.orientationUpdate = this._orientationUpdate = new flambe.platform.HeavySignal1();
	if(this.get_orientationSupported()) {
		this._orientation = new flambe.input.AccelerometerOrientation();
		this._orientationUpdate.hasListenersValue.get_changed().connect(function(hasListeners,_) {
			if(hasListeners) {
				_g._orientationEventGroup = new flambe.platform.EventGroup();
				_g._orientationEventGroup.addListener(js.Lib.window,"deviceorientation",$bind(_g,_g.handleAccelerometerOrientation));
			} else {
				_g._orientationEventGroup.dispose();
				_g._orientationEventGroup = null;
			}
		});
	}
};
$hxClasses["flambe.platform.html.HtmlAccelerometer"] = flambe.platform.html.HtmlAccelerometer;
flambe.platform.html.HtmlAccelerometer.__name__ = ["flambe","platform","html","HtmlAccelerometer"];
flambe.platform.html.HtmlAccelerometer.__interfaces__ = [flambe.input.Accelerometer];
flambe.platform.html.HtmlAccelerometer.prototype = {
	handleAccelerometerOrientation: function(event) {
		switch(js.Lib.window.orientation) {
		case -90:
			this._orientation._internal_update(event.gamma,-event.beta,event.alpha);
			break;
		case 0:
			this._orientation._internal_update(event.beta,event.gamma,event.alpha);
			break;
		case 90:
			this._orientation._internal_update(-event.gamma,event.beta,event.alpha);
			break;
		case 180:
			this._orientation._internal_update(-event.beta,-event.gamma,event.alpha);
			break;
		}
		this.orientationUpdate.emit(this._orientation);
	}
	,get_orientationSupported: function() {
		return js.Lib.window.DeviceOrientationEvent != null;
	}
	,__class__: flambe.platform.html.HtmlAccelerometer
}
flambe.platform.html.HtmlAssetPackLoader = function(platform,manifest) {
	flambe.platform.BasicAssetPackLoader.call(this,platform,manifest);
};
$hxClasses["flambe.platform.html.HtmlAssetPackLoader"] = flambe.platform.html.HtmlAssetPackLoader;
flambe.platform.html.HtmlAssetPackLoader.__name__ = ["flambe","platform","html","HtmlAssetPackLoader"];
flambe.platform.html.HtmlAssetPackLoader.detectImageFormats = function(fn) {
	var formats = [flambe.asset.AssetFormat.PNG,flambe.asset.AssetFormat.JPG,flambe.asset.AssetFormat.GIF];
	var formatTests = 2;
	var checkRemaining = function() {
		--formatTests;
		if(formatTests == 0) fn(formats);
	};
	var webp = new Image();
	webp.onload = webp.onerror = function() {
		if(webp.width == 1) formats.unshift(flambe.asset.AssetFormat.WEBP);
		checkRemaining();
	};
	webp.src = "data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==";
	var jxr = new Image();
	jxr.onload = jxr.onerror = function() {
		if(jxr.width == 1) formats.unshift(flambe.asset.AssetFormat.JXR);
		checkRemaining();
	};
	jxr.src = "data:image/vnd.ms-photo;base64,SUm8AQgAAAAFAAG8AQAQAAAASgAAAIC8BAABAAAAAQAAAIG8BAABAAAAAQAAAMC8BAABAAAAWgAAAMG8BAABAAAAHwAAAAAAAAAkw91vA07+S7GFPXd2jckNV01QSE9UTwAZAYBxAAAAABP/gAAEb/8AAQAAAQAAAA==";
}
flambe.platform.html.HtmlAssetPackLoader.detectAudioFormats = function() {
	var element = js.Lib.document.createElement("audio");
	if(element == null || element.canPlayType == null) {
		flambe.Log.warn("Audio is not supported at all in this browser!");
		return [];
	}
	var blacklist = new EReg("\\b(iPhone|iPod|iPad|Android)\\b","");
	var userAgent = js.Lib.window.navigator.userAgent;
	if(!flambe.platform.html.WebAudioSound.get_supported() && blacklist.match(userAgent)) {
		flambe.Log.warn("HTML5 audio is blacklisted for this browser",["userAgent",userAgent]);
		return [];
	}
	var types = [];
	if(userAgent.indexOf("Firefox") > -1) types = [{ format : flambe.asset.AssetFormat.M4A, mimeType : "audio/mp4; codecs=mp4a"},{ format : flambe.asset.AssetFormat.OGG, mimeType : "audio/ogg; codecs=vorbis"},{ format : flambe.asset.AssetFormat.WAV, mimeType : "audio/wav"}]; else types = [{ format : flambe.asset.AssetFormat.M4A, mimeType : "audio/mp4; codecs=mp4a"},{ format : flambe.asset.AssetFormat.MP3, mimeType : "audio/mpeg"},{ format : flambe.asset.AssetFormat.OGG, mimeType : "audio/ogg; codecs=vorbis"},{ format : flambe.asset.AssetFormat.WAV, mimeType : "audio/wav"}];
	var result = [];
	var _g = 0;
	while(_g < types.length) {
		var type = types[_g];
		++_g;
		var canPlayType = "";
		try {
			canPlayType = element.canPlayType(type.mimeType);
		} catch( _ ) {
		}
		if(canPlayType != "") result.push(type.format);
	}
	return result;
}
flambe.platform.html.HtmlAssetPackLoader.supportsBlob = function() {
	if(flambe.platform.html.HtmlAssetPackLoader._detectBlobSupport) {
		flambe.platform.html.HtmlAssetPackLoader._detectBlobSupport = false;
		var xhr = new XMLHttpRequest();
		xhr.open("GET",".",true);
		xhr.responseType = "blob";
		if(xhr.responseType != "blob") return false;
		flambe.platform.html.HtmlAssetPackLoader._URL = flambe.platform.html.HtmlUtil.loadExtension("URL").value;
	}
	return flambe.platform.html.HtmlAssetPackLoader._URL != null && flambe.platform.html.HtmlAssetPackLoader._URL.createObjectURL != null;
}
flambe.platform.html.HtmlAssetPackLoader.get_detectBlobSupport = function() {
	return flambe.platform.html.HtmlAssetPackLoader._detectBlobSupport;
}
flambe.platform.html.HtmlAssetPackLoader.set_detectBlobSupport = function(value) {
	return flambe.platform.html.HtmlAssetPackLoader._detectBlobSupport = value;
}
flambe.platform.html.HtmlAssetPackLoader.__super__ = flambe.platform.BasicAssetPackLoader;
flambe.platform.html.HtmlAssetPackLoader.prototype = $extend(flambe.platform.BasicAssetPackLoader.prototype,{
	sendRequest: function(url,entry,responseType,onLoad) {
		var _g = this;
		var xhr = new XMLHttpRequest();
		var lastActivity = 0.0;
		var start = function() {
			lastActivity = flambe.platform.html.HtmlUtil.now();
			xhr.open("GET",url,true);
			xhr.responseType = responseType;
			if(xhr.responseType == "") xhr.responseType = "arraybuffer";
			xhr.send();
		};
		var interval = 0;
		if(typeof(xhr.onprogress) != "undefined") {
			var attempts = 4;
			xhr.onprogress = function(event) {
				lastActivity = flambe.platform.html.HtmlUtil.now();
				_g.handleProgress(entry,event.loaded);
			};
			interval = js.Lib.window.setInterval(function() {
				if(xhr.readyState >= 1 && flambe.platform.html.HtmlUtil.now() - lastActivity > 5000) {
					xhr.abort();
					if(attempts > 0) {
						flambe.Log.warn("Retrying stalled asset request",["url",entry.url]);
						start();
					} else {
						js.Lib.window.clearInterval(interval);
						_g.handleError(entry,"Request timed out");
					}
				}
			},1000);
		}
		xhr.onload = function(_) {
			js.Lib.window.clearInterval(interval);
			var response = xhr.response;
			if(response == null) response = xhr.responseText; else if(responseType == "blob" && xhr.responseType == "arraybuffer") response = new Blob([xhr.response]);
			onLoad(response);
		};
		xhr.onerror = function(_) {
			js.Lib.window.clearInterval(interval);
			_g.handleError(entry,"Failed to load asset: error #" + Std.string(xhr.status));
		};
		start();
		return xhr;
	}
	,getAssetFormats: function(fn) {
		if(flambe.platform.html.HtmlAssetPackLoader._supportedFormats == null) {
			flambe.platform.html.HtmlAssetPackLoader._supportedFormats = new flambe.util.Promise();
			flambe.platform.html.HtmlAssetPackLoader.detectImageFormats(function(imageFormats) {
				flambe.platform.html.HtmlAssetPackLoader._supportedFormats.set_result(imageFormats.concat(flambe.platform.html.HtmlAssetPackLoader.detectAudioFormats()).concat([flambe.asset.AssetFormat.Data]));
			});
		}
		flambe.platform.html.HtmlAssetPackLoader._supportedFormats.get(fn);
	}
	,loadEntry: function(url,entry) {
		var _g = this;
		switch( (entry.format)[1] ) {
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
			var image = new Image();
			var events = new flambe.platform.EventGroup();
			events.addDisposingListener(image,"load",function(_) {
				if(image.width > 1024 || image.height > 1024) flambe.Log.warn("Images larger than 1024px on a side will prevent GPU acceleration" + " on some platforms (iOS)",["url",url,"width",image.width,"height",image.height]);
				if(flambe.platform.html.HtmlAssetPackLoader.supportsBlob()) flambe.platform.html.HtmlAssetPackLoader._URL.revokeObjectURL(image.src);
				var texture = _g._platform.getRenderer().createTexture(image);
				if(texture != null) _g.handleLoad(entry,texture); else _g.handleTextureError(entry);
			});
			events.addDisposingListener(image,"error",function(_) {
				_g.handleError(entry,"Failed to load image");
			});
			if(flambe.platform.html.HtmlAssetPackLoader.supportsBlob()) this.sendRequest(url,entry,"blob",function(blob) {
				image.src = flambe.platform.html.HtmlAssetPackLoader._URL.createObjectURL(blob);
			}); else image.src = url;
			break;
		case 5:
		case 6:
		case 7:
		case 8:
			if(flambe.platform.html.WebAudioSound.get_supported()) this.sendRequest(url,entry,"arraybuffer",function(buffer) {
				flambe.platform.html.WebAudioSound.ctx.decodeAudioData(buffer,function(decoded) {
					_g.handleLoad(entry,new flambe.platform.html.WebAudioSound(decoded));
				},function() {
					flambe.Log.warn("Couldn't decode Web Audio, ignoring this asset",["url",url]);
					_g.handleLoad(entry,flambe.platform.DummySound.getInstance());
				});
			}); else {
				var audio = js.Lib.document.createElement("audio");
				audio.preload = "auto";
				var ref = ++flambe.platform.html.HtmlAssetPackLoader._mediaRefCount;
				if(flambe.platform.html.HtmlAssetPackLoader._mediaElements == null) flambe.platform.html.HtmlAssetPackLoader._mediaElements = new IntHash();
				flambe.platform.html.HtmlAssetPackLoader._mediaElements.set(ref,audio);
				var events = new flambe.platform.EventGroup();
				events.addDisposingListener(audio,"canplaythrough",function(_) {
					flambe.platform.html.HtmlAssetPackLoader._mediaElements.remove(ref);
					_g.handleLoad(entry,new flambe.platform.html.HtmlSound(audio));
				});
				events.addDisposingListener(audio,"error",function(_) {
					flambe.platform.html.HtmlAssetPackLoader._mediaElements.remove(ref);
					var code = audio.error.code;
					if(code == 3 || code == 4) {
						flambe.Log.warn("Couldn't decode HTML5 audio, ignoring this asset",["url",url,"code",code]);
						_g.handleLoad(entry,flambe.platform.DummySound.getInstance());
					} else _g.handleError(entry,"Failed to load audio: " + Std.string(audio.error.code));
				});
				events.addListener(audio,"progress",function(_) {
					if(audio.buffered.length > 0 && audio.duration > 0) {
						var progress = audio.buffered.end(0) / audio.duration;
						_g.handleProgress(entry,Std["int"](progress * entry.bytes));
					}
				});
				audio.src = url;
				audio.load();
			}
			break;
		case 9:
			this.sendRequest(url,entry,"text",function(text) {
				_g.handleLoad(entry,text);
			});
			break;
		default:
			flambe.util.Assert.fail("Unsupported format",["format",entry.format]);
			return;
		}
	}
	,__class__: flambe.platform.html.HtmlAssetPackLoader
});
flambe.platform.html.HtmlExternal = function() {
};
$hxClasses["flambe.platform.html.HtmlExternal"] = flambe.platform.html.HtmlExternal;
flambe.platform.html.HtmlExternal.__name__ = ["flambe","platform","html","HtmlExternal"];
flambe.platform.html.HtmlExternal.__interfaces__ = [flambe.external.External];
flambe.platform.html.HtmlExternal.prototype = {
	bind: function(name,fn) {
		Reflect.setField(js.Lib.window,name,fn);
	}
	,call: function(name,params) {
		if(params == null) params = [];
		var method = Reflect.field(js.Lib.window,name);
		return Reflect.callMethod(null,method,params);
	}
	,get_supported: function() {
		return true;
	}
	,__class__: flambe.platform.html.HtmlExternal
}
flambe.util.LogHandler = function() { }
$hxClasses["flambe.util.LogHandler"] = flambe.util.LogHandler;
flambe.util.LogHandler.__name__ = ["flambe","util","LogHandler"];
flambe.util.LogHandler.prototype = {
	__class__: flambe.util.LogHandler
}
flambe.platform.html.HtmlLogHandler = function(tag) {
	this._tagPrefix = tag + ": ";
};
$hxClasses["flambe.platform.html.HtmlLogHandler"] = flambe.platform.html.HtmlLogHandler;
flambe.platform.html.HtmlLogHandler.__name__ = ["flambe","platform","html","HtmlLogHandler"];
flambe.platform.html.HtmlLogHandler.__interfaces__ = [flambe.util.LogHandler];
flambe.platform.html.HtmlLogHandler.isSupported = function() {
	return typeof console == "object" && console.info != null;
}
flambe.platform.html.HtmlLogHandler.prototype = {
	log: function(level,message) {
		message = this._tagPrefix + message;
		switch( (level)[1] ) {
		case 0:
			console.info(message);
			break;
		case 1:
			console.warn(message);
			break;
		case 2:
			console.error(message);
			break;
		}
	}
	,__class__: flambe.platform.html.HtmlLogHandler
}
flambe.platform.html.HtmlMouse = function(pointer,canvas) {
	flambe.platform.BasicMouse.call(this,pointer);
	this._canvas = canvas;
};
$hxClasses["flambe.platform.html.HtmlMouse"] = flambe.platform.html.HtmlMouse;
flambe.platform.html.HtmlMouse.__name__ = ["flambe","platform","html","HtmlMouse"];
flambe.platform.html.HtmlMouse.__super__ = flambe.platform.BasicMouse;
flambe.platform.html.HtmlMouse.prototype = $extend(flambe.platform.BasicMouse.prototype,{
	set_cursor: function(cursor) {
		var name;
		switch( (cursor)[1] ) {
		case 0:
			name = "";
			break;
		case 1:
			name = "pointer";
			break;
		case 2:
			name = "none";
			break;
		}
		this._canvas.style.cursor = name;
		return flambe.platform.BasicMouse.prototype.set_cursor.call(this,cursor);
	}
	,__class__: flambe.platform.html.HtmlMouse
});
flambe.platform.html.HtmlSound = function(audioElement) {
	this.audioElement = audioElement;
};
$hxClasses["flambe.platform.html.HtmlSound"] = flambe.platform.html.HtmlSound;
flambe.platform.html.HtmlSound.__name__ = ["flambe","platform","html","HtmlSound"];
flambe.platform.html.HtmlSound.__interfaces__ = [flambe.sound.Sound];
flambe.platform.html.HtmlSound.prototype = {
	get_duration: function() {
		return this.audioElement.duration;
	}
	,loop: function(volume) {
		if(volume == null) volume = 1.0;
		return new flambe.platform.html._HtmlSound.HtmlPlayback(this,volume,true);
	}
	,play: function(volume) {
		if(volume == null) volume = 1.0;
		return new flambe.platform.html._HtmlSound.HtmlPlayback(this,volume,false);
	}
	,__class__: flambe.platform.html.HtmlSound
}
flambe.platform.html._HtmlSound = {}
flambe.platform.html._HtmlSound.HtmlPlayback = function(sound,volume,loop) {
	this._disposed = false;
	var _g = this;
	this._sound = sound;
	this._tickableAdded = false;
	this._clonedElement = js.Lib.document.createElement("audio");
	this._clonedElement.loop = loop;
	this._clonedElement.src = sound.audioElement.src;
	this.volume = new flambe.animation.AnimatedFloat(volume,function(_,_1) {
		_g.updateVolume();
	});
	this.updateVolume();
	this._disposed = false;
	this.playAudio();
};
$hxClasses["flambe.platform.html._HtmlSound.HtmlPlayback"] = flambe.platform.html._HtmlSound.HtmlPlayback;
flambe.platform.html._HtmlSound.HtmlPlayback.__name__ = ["flambe","platform","html","_HtmlSound","HtmlPlayback"];
flambe.platform.html._HtmlSound.HtmlPlayback.__interfaces__ = [flambe.platform.Tickable,flambe.sound.Playback];
flambe.platform.html._HtmlSound.HtmlPlayback.prototype = {
	updateVolume: function() {
		this._clonedElement.volume = flambe.System.volume.get__() * this.volume.get__();
	}
	,playAudio: function() {
		var _g = this;
		this._clonedElement.play();
		if(!this._tickableAdded) {
			flambe.platform.html.HtmlPlatform.instance.mainLoop.addTickable(this);
			this._tickableAdded = true;
			this._volumeBinding = flambe.System.volume.get_changed().connect(function(_,_1) {
				_g.updateVolume();
			});
			this._hideBinding = flambe.System.hidden.get_changed().connect(function(hidden,_) {
				if(hidden) {
					_g._wasPaused = _g.get_paused();
					_g.set_paused(true);
				} else _g.set_paused(_g._wasPaused);
			});
		}
	}
	,dispose: function() {
		this._disposed = true;
		this.set_paused(true);
	}
	,update: function(dt) {
		this.volume.update(dt);
		if(this.get_ended() || this.get_paused()) {
			this._tickableAdded = false;
			this._volumeBinding.dispose();
			this._hideBinding.dispose();
			return true;
		}
		return false;
	}
	,get_position: function() {
		return this._clonedElement.currentTime;
	}
	,get_ended: function() {
		return this._disposed || this._clonedElement.ended;
	}
	,set_paused: function(paused) {
		if(this._clonedElement.paused != paused) {
			if(paused) this._clonedElement.pause(); else this.playAudio();
		}
		return paused;
	}
	,get_paused: function() {
		return this._clonedElement.paused;
	}
	,get_sound: function() {
		return this._sound;
	}
	,__class__: flambe.platform.html._HtmlSound.HtmlPlayback
}
flambe.platform.html.HtmlStage = function(canvas) {
	var _g = this;
	this._canvas = canvas;
	this.resize = new flambe.util.Signal0();
	this.scaleFactor = flambe.platform.html.HtmlStage.computeScaleFactor();
	if(this.scaleFactor != 1) {
		flambe.Log.info("Reversing device DPI scaling",["scaleFactor",this.scaleFactor]);
		flambe.platform.html.HtmlUtil.setVendorStyle(this._canvas,"transform-origin","top left");
		flambe.platform.html.HtmlUtil.setVendorStyle(this._canvas,"transform","scale(" + 1 / this.scaleFactor + ")");
	}
	if(flambe.platform.html.HtmlUtil.SHOULD_HIDE_MOBILE_BROWSER) {
		window.addEventListener("orientationchange",function() {
			flambe.platform.html.HtmlUtil.callLater($bind(_g,_g.hideMobileBrowser),200);
		},false);
		this.hideMobileBrowser();
	}
	window.addEventListener("resize",$bind(this,this.onWindowResize),false);
	this.onWindowResize();
	this.orientation = new flambe.util.Value(null);
	if(window.orientation != null) {
		window.addEventListener("orientationchange",$bind(this,this.onOrientationChange),false);
		this.onOrientationChange();
	}
	this.fullscreen = new flambe.util.Value(false);
	flambe.platform.html.HtmlUtil.addVendorListener(js.Lib.document,"fullscreenchange",function(_) {
		_g.updateFullscreen();
	},false);
	flambe.platform.html.HtmlUtil.addVendorListener(js.Lib.document,"fullscreenerror",function(_) {
		flambe.Log.warn("Error when requesting fullscreen");
	},false);
	this.updateFullscreen();
};
$hxClasses["flambe.platform.html.HtmlStage"] = flambe.platform.html.HtmlStage;
flambe.platform.html.HtmlStage.__name__ = ["flambe","platform","html","HtmlStage"];
flambe.platform.html.HtmlStage.__interfaces__ = [flambe.display.Stage];
flambe.platform.html.HtmlStage.computeScaleFactor = function() {
	var devicePixelRatio = window.devicePixelRatio;
	if(devicePixelRatio == null) devicePixelRatio = 1;
	var canvas = js.Lib.document.createElement("canvas");
	var ctx = canvas.getContext("2d");
	var backingStorePixelRatio = flambe.platform.html.HtmlUtil.loadExtension("backingStorePixelRatio",ctx).value;
	if(backingStorePixelRatio == null) backingStorePixelRatio = 1;
	var scale = devicePixelRatio / backingStorePixelRatio;
	var screenWidth = screen.width;
	var screenHeight = screen.height;
	if(scale * screenWidth > 1024 || scale * screenHeight > 1024) return 1;
	return scale;
}
flambe.platform.html.HtmlStage.prototype = {
	updateFullscreen: function() {
		var state = flambe.platform.html.HtmlUtil.loadFirstExtension(["fullscreen","fullScreen","isFullScreen"],js.Lib.document).value;
		this.fullscreen.set__(state == true);
	}
	,onOrientationChange: function() {
		var value = flambe.platform.html.HtmlUtil.orientation(window.orientation);
		this.orientation.set__(value);
	}
	,hideMobileBrowser: function() {
		var _g = this;
		var mobileAddressBar = 100;
		var htmlStyle = js.Lib.document.documentElement.style;
		htmlStyle.height = js.Lib.window.innerHeight + mobileAddressBar + "px";
		htmlStyle.width = js.Lib.window.innerWidth + "px";
		htmlStyle.overflow = "visible";
		flambe.platform.html.HtmlUtil.callLater(function() {
			flambe.platform.html.HtmlUtil.hideMobileBrowser();
			flambe.platform.html.HtmlUtil.callLater(function() {
				htmlStyle.height = js.Lib.window.innerHeight + "px";
				_g.onWindowResize();
			},100);
		});
	}
	,resizeCanvas: function (width, height) {
		var scaledWidth = this.scaleFactor * width;
		var scaledHeight = this.scaleFactor * height;
		if (this._canvas.width == scaledWidth && this._canvas.height == scaledHeight) {
			return false;
		}
		this._canvas.width = scaledWidth;
		this._canvas.height = scaledHeight;
		this.resize.emit();
		return true;
	}
	,onWindowResize: function () {
		var container = this._canvas.parentNode;
		var rect = container.getBoundingClientRect();
		this.resizeCanvas(rect.width, rect.height);
	}
	,requestFullscreen: function(enable) {
		if(enable == null) enable = true;
		if(enable) {
			var documentElement = js.Lib.document.documentElement;
			var requestFullscreen = flambe.platform.html.HtmlUtil.loadFirstExtension(["requestFullscreen","requestFullScreen"],documentElement).value;
			if(requestFullscreen != null) Reflect.callMethod(documentElement,requestFullscreen,[]);
		} else {
			var cancelFullscreen = flambe.platform.html.HtmlUtil.loadFirstExtension(["cancelFullscreen","cancelFullScreen"],js.Lib.document).value;
			if(cancelFullscreen != null) Reflect.callMethod(js.Lib.document,cancelFullscreen,[]);
		}
	}
	,unlockOrientation: function() {
	}
	,lockOrientation: function(orient) {
	}
	,get_fullscreenSupported: function() {
		return flambe.platform.html.HtmlUtil.loadFirstExtension(["fullscreenEnabled","fullScreenEnabled"],js.Lib.document).value == true;
	}
	,get_height: function() {
		return this._canvas.height;
	}
	,get_width: function() {
		return this._canvas.width;
	}
	,__class__: flambe.platform.html.HtmlStage
}
flambe.platform.html.HtmlStorage = function(storage) {
	this._storage = storage;
};
$hxClasses["flambe.platform.html.HtmlStorage"] = flambe.platform.html.HtmlStorage;
flambe.platform.html.HtmlStorage.__name__ = ["flambe","platform","html","HtmlStorage"];
flambe.platform.html.HtmlStorage.__interfaces__ = [flambe.storage.Storage];
flambe.platform.html.HtmlStorage.prototype = {
	clear: function() {
		try {
			this._storage.clear();
		} catch( error ) {
			flambe.Log.warn("localStorage.clear failed",["message",error.message]);
		}
	}
	,remove: function(key) {
		try {
			this._storage.removeItem("flambe:" + key);
		} catch( error ) {
			flambe.Log.warn("localStorage.removeItem failed",["message",error.message]);
		}
	}
	,get: function(key,defaultValue) {
		var encoded = null;
		try {
			encoded = this._storage.getItem("flambe:" + key);
		} catch( error ) {
			flambe.Log.warn("localStorage.getItem failed",["message",error.message]);
		}
		if(encoded != null) try {
			return haxe.Unserializer.run(encoded);
		} catch( error ) {
			flambe.Log.warn("Storage unserialization failed",["message",error]);
		}
		return defaultValue;
	}
	,set: function(key,value) {
		var encoded;
		try {
			var serializer = new haxe.Serializer();
			serializer.useCache = true;
			serializer.useEnumIndex = false;
			serializer.serialize(value);
			encoded = serializer.toString();
		} catch( error ) {
			flambe.Log.warn("Storage serialization failed",["message",error]);
			return false;
		}
		try {
			this._storage.setItem("flambe:" + key,encoded);
		} catch( error ) {
			flambe.Log.warn("localStorage.setItem failed",["message",error.message]);
			return false;
		}
		return true;
	}
	,get_supported: function() {
		return true;
	}
	,__class__: flambe.platform.html.HtmlStorage
}
flambe.platform.html.HtmlUtil = function() { }
$hxClasses["flambe.platform.html.HtmlUtil"] = flambe.platform.html.HtmlUtil;
flambe.platform.html.HtmlUtil.__name__ = ["flambe","platform","html","HtmlUtil"];
flambe.platform.html.HtmlUtil.callLater = function(func,delay) {
	if(delay == null) delay = 0;
	js.Lib.window.setTimeout(func,delay);
}
flambe.platform.html.HtmlUtil.hideMobileBrowser = function() {
	js.Lib.window.scrollTo(1,0);
}
flambe.platform.html.HtmlUtil.loadExtension = function(name,obj) {
	if(obj == null) obj = js.Lib.window;
	var extension = Reflect.field(obj,name);
	if(extension != null) return { prefix : "", field : name, value : extension};
	var capitalized = name.charAt(0).toUpperCase() + HxOverrides.substr(name,1,null);
	var _g = 0, _g1 = flambe.platform.html.HtmlUtil.VENDOR_PREFIXES;
	while(_g < _g1.length) {
		var prefix = _g1[_g];
		++_g;
		var field = prefix + capitalized;
		var extension1 = Reflect.field(obj,field);
		if(extension1 != null) return { prefix : prefix, field : field, value : extension1};
	}
	return { prefix : null, field : null, value : null};
}
flambe.platform.html.HtmlUtil.loadFirstExtension = function(names,obj) {
	var _g = 0;
	while(_g < names.length) {
		var name = names[_g];
		++_g;
		var extension = flambe.platform.html.HtmlUtil.loadExtension(name,obj);
		if(extension.field != null) return extension;
	}
	return { prefix : null, field : null, value : null};
}
flambe.platform.html.HtmlUtil.polyfill = function(name,obj) {
	if(obj == null) obj = js.Lib.window;
	var value = flambe.platform.html.HtmlUtil.loadExtension(name,obj).value;
	if(value == null) return false;
	Reflect.setField(obj,name,value);
	return true;
}
flambe.platform.html.HtmlUtil.setVendorStyle = function(element,name,value) {
	var style = element.style;
	var _g = 0, _g1 = flambe.platform.html.HtmlUtil.VENDOR_PREFIXES;
	while(_g < _g1.length) {
		var prefix = _g1[_g];
		++_g;
		style.setProperty("-" + prefix + "-" + name,value);
	}
	style.setProperty(name,value);
}
flambe.platform.html.HtmlUtil.addVendorListener = function(dispatcher,type,listener,useCapture) {
	var _g = 0, _g1 = flambe.platform.html.HtmlUtil.VENDOR_PREFIXES;
	while(_g < _g1.length) {
		var prefix = _g1[_g];
		++_g;
		dispatcher.addEventListener(prefix + type,listener,useCapture);
	}
	dispatcher.addEventListener(type,listener,useCapture);
}
flambe.platform.html.HtmlUtil.orientation = function(angle) {
	switch(angle) {
	case -90:case 90:
		return flambe.display.Orientation.Landscape;
	default:
		return flambe.display.Orientation.Portrait;
	}
}
flambe.platform.html.HtmlUtil.now = function() {
	return Date.now();
}
flambe.platform.html.HtmlUtil.createEmptyCanvas = function(width,height) {
	var canvas = js.Lib.document.createElement("canvas");
	canvas.width = width;
	canvas.height = height;
	return canvas;
}
flambe.platform.html.HtmlUtil.createCanvas = function(source) {
	var canvas = flambe.platform.html.HtmlUtil.createEmptyCanvas(source.width,source.height);
	var ctx = canvas.getContext("2d");
	ctx.save();
	ctx.globalCompositeOperation = "copy";
	ctx.drawImage(source,0,0);
	ctx.restore();
	return canvas;
}
flambe.web = {}
flambe.web.Web = function() { }
$hxClasses["flambe.web.Web"] = flambe.web.Web;
flambe.web.Web.__name__ = ["flambe","web","Web"];
flambe.web.Web.prototype = {
	__class__: flambe.web.Web
}
flambe.platform.html.HtmlWeb = function(container) {
	this._container = container;
};
$hxClasses["flambe.platform.html.HtmlWeb"] = flambe.platform.html.HtmlWeb;
flambe.platform.html.HtmlWeb.__name__ = ["flambe","platform","html","HtmlWeb"];
flambe.platform.html.HtmlWeb.__interfaces__ = [flambe.web.Web];
flambe.platform.html.HtmlWeb.prototype = {
	openBrowser: function(url) {
		js.Lib.window.open(url,"_blank");
	}
	,createView: function(x,y,width,height) {
		var iframe = js.Lib.document.createElement("iframe");
		iframe.style.position = "absolute";
		iframe.style.border = "0";
		iframe.scrolling = "no";
		this._container.appendChild(iframe);
		var view = new flambe.platform.html.HtmlWebView(iframe,x,y,width,height);
		flambe.platform.html.HtmlPlatform.instance.mainLoop.addTickable(view);
		return view;
	}
	,get_supported: function() {
		return true;
	}
	,__class__: flambe.platform.html.HtmlWeb
}
flambe.web.WebView = function() { }
$hxClasses["flambe.web.WebView"] = flambe.web.WebView;
flambe.web.WebView.__name__ = ["flambe","web","WebView"];
flambe.web.WebView.__interfaces__ = [flambe.util.Disposable];
flambe.web.WebView.prototype = {
	__class__: flambe.web.WebView
}
flambe.platform.html.HtmlWebView = function(iframe,x,y,width,height) {
	var _g = this;
	this.iframe = iframe;
	var onBoundsChanged = function(_,_1) {
		_g.updateBounds();
	};
	this.x = new flambe.animation.AnimatedFloat(x,onBoundsChanged);
	this.y = new flambe.animation.AnimatedFloat(y,onBoundsChanged);
	this.width = new flambe.animation.AnimatedFloat(width,onBoundsChanged);
	this.height = new flambe.animation.AnimatedFloat(height,onBoundsChanged);
	this.updateBounds();
	this.url = new flambe.util.Value(null,function(url,_) {
		_g.loadUrl(url);
	});
	this.error = new flambe.util.Signal1();
};
$hxClasses["flambe.platform.html.HtmlWebView"] = flambe.platform.html.HtmlWebView;
flambe.platform.html.HtmlWebView.__name__ = ["flambe","platform","html","HtmlWebView"];
flambe.platform.html.HtmlWebView.__interfaces__ = [flambe.platform.Tickable,flambe.web.WebView];
flambe.platform.html.HtmlWebView.prototype = {
	loadUrl: function(url) {
		if(this.iframe == null) return;
		this.iframe.src = url;
	}
	,updateBounds: function() {
		if(this.iframe == null) return;
		this.iframe.style.left = this.x.get__() + "px";
		this.iframe.style.top = this.y.get__() + "px";
		this.iframe.width = this.width.get__();
		this.iframe.height = this.height.get__();
	}
	,update: function(dt) {
		this.x.update(dt);
		this.y.update(dt);
		this.width.update(dt);
		this.height.update(dt);
		return this.iframe == null;
	}
	,dispose: function() {
		if(this.iframe == null) return;
		this.iframe.parentNode.removeChild(this.iframe);
		this.iframe = null;
	}
	,__class__: flambe.platform.html.HtmlWebView
}
flambe.platform.html.WebAudioSound = function(buffer) {
	this.buffer = buffer;
};
$hxClasses["flambe.platform.html.WebAudioSound"] = flambe.platform.html.WebAudioSound;
flambe.platform.html.WebAudioSound.__name__ = ["flambe","platform","html","WebAudioSound"];
flambe.platform.html.WebAudioSound.__interfaces__ = [flambe.sound.Sound];
flambe.platform.html.WebAudioSound.start = function(node,time) {
	if(node.start != null) node.start(time); else node.noteOn(time);
}
flambe.platform.html.WebAudioSound.get_supported = function() {
	if(flambe.platform.html.WebAudioSound._detectSupport) {
		flambe.platform.html.WebAudioSound._detectSupport = false;
		var AudioContext = flambe.platform.html.HtmlUtil.loadExtension("AudioContext").value;
		if(AudioContext != null) {
			flambe.platform.html.WebAudioSound.ctx = new AudioContext();
			flambe.platform.html.WebAudioSound.gain = flambe.platform.html.WebAudioSound.ctx.createGain != null?flambe.platform.html.WebAudioSound.ctx.createGain():flambe.platform.html.WebAudioSound.ctx.createGainNode();
			flambe.platform.html.WebAudioSound.gain.connect(flambe.platform.html.WebAudioSound.ctx.destination);
			flambe.System.volume.watch(function(volume,_) {
				flambe.platform.html.WebAudioSound.gain.gain.value = volume;
			});
		}
	}
	return flambe.platform.html.WebAudioSound.ctx != null;
}
flambe.platform.html.WebAudioSound.prototype = {
	get_duration: function() {
		return this.buffer.duration;
	}
	,loop: function(volume) {
		if(volume == null) volume = 1.0;
		return new flambe.platform.html._WebAudioSound.WebAudioPlayback(this,volume,true);
	}
	,play: function(volume) {
		if(volume == null) volume = 1.0;
		return new flambe.platform.html._WebAudioSound.WebAudioPlayback(this,volume,false);
	}
	,__class__: flambe.platform.html.WebAudioSound
}
flambe.platform.html._WebAudioSound = {}
flambe.platform.html._WebAudioSound.WebAudioPlayback = function(sound,volume,loop) {
	this._ended = false;
	var _g = this;
	this._sound = sound;
	this._head = flambe.platform.html.WebAudioSound.gain;
	this._sourceNode = flambe.platform.html.WebAudioSound.ctx.createBufferSource();
	this._sourceNode.buffer = sound.buffer;
	this._sourceNode.loop = loop;
	this._sourceNode.onended = function() {
		_g._ended = true;
	};
	try {
		this._sourceNode.noteOn(0);
	} catch( err ) {
		flambe.platform.html.WebAudioSound.start(this._sourceNode,0);
	}
	this.playAudio();
	this.volume = new flambe.animation.AnimatedFloat(volume,function(v,_) {
		_g.setVolume(v);
	});
	if(volume != 1) this.setVolume(volume);
};
$hxClasses["flambe.platform.html._WebAudioSound.WebAudioPlayback"] = flambe.platform.html._WebAudioSound.WebAudioPlayback;
flambe.platform.html._WebAudioSound.WebAudioPlayback.__name__ = ["flambe","platform","html","_WebAudioSound","WebAudioPlayback"];
flambe.platform.html._WebAudioSound.WebAudioPlayback.__interfaces__ = [flambe.platform.Tickable,flambe.sound.Playback];
flambe.platform.html._WebAudioSound.WebAudioPlayback.prototype = {
	playAudio: function() {
		var _g = this;
		this._sourceNode.connect(this._head);
		this._startedAt = flambe.platform.html.WebAudioSound.ctx.currentTime;
		this._pausedAt = -1;
		if(!this._tickableAdded) {
			flambe.platform.html.HtmlPlatform.instance.mainLoop.addTickable(this);
			this._tickableAdded = true;
			this._hideBinding = flambe.System.hidden.get_changed().connect(function(hidden,_) {
				if(hidden) {
					_g._wasPaused = _g.get_paused();
					_g.set_paused(true);
				} else _g.set_paused(_g._wasPaused);
			});
		}
	}
	,insertNode: function(head) {
		if(!this.get_paused()) {
			this._sourceNode.disconnect();
			this._sourceNode.connect(head);
		}
		head.connect(this._head);
		this._head = head;
	}
	,setVolume: function(volume) {
		if(this._gainNode == null) {
			this._gainNode = flambe.platform.html.WebAudioSound.ctx.createGain != null?flambe.platform.html.WebAudioSound.ctx.createGain():flambe.platform.html.WebAudioSound.ctx.createGainNode();
			this.insertNode(this._gainNode);
		}
		this._gainNode.gain.value = volume;
	}
	,dispose: function() {
		this.set_paused(true);
		this._ended = true;
	}
	,update: function(dt) {
		this.volume.update(dt);
		if(this.get_ended() || this.get_paused()) {
			this._tickableAdded = false;
			this._hideBinding.dispose();
			return true;
		}
		return false;
	}
	,get_position: function() {
		if(this.get_ended()) return this._sound.get_duration(); else if(this.get_paused()) return this._pausedAt; else {
			var elapsed = flambe.platform.html.WebAudioSound.ctx.currentTime - this._startedAt;
			return elapsed % this._sound.get_duration();
		}
	}
	,get_ended: function() {
		return this._ended || this._sourceNode.playbackState == 3;
	}
	,set_paused: function(paused) {
		if(paused != this.get_paused()) {
			if(paused) {
				this._sourceNode.disconnect();
				this._pausedAt = this.get_position();
			} else this.playAudio();
		}
		return paused;
	}
	,get_paused: function() {
		return this._pausedAt >= 0;
	}
	,get_sound: function() {
		return this._sound;
	}
	,__class__: flambe.platform.html._WebAudioSound.WebAudioPlayback
}
flambe.scene = {}
flambe.scene.Director = function() {
	this._height = -1;
	this._width = -1;
	this._transitor = null;
	this.scenes = [];
	this.occludedScenes = [];
	this._root = new flambe.Entity();
};
$hxClasses["flambe.scene.Director"] = flambe.scene.Director;
flambe.scene.Director.__name__ = ["flambe","scene","Director"];
flambe.scene.Director.getFrom = function(entity) {
	return entity.getComponent("Director_0");
}
flambe.scene.Director.__super__ = flambe.Component;
flambe.scene.Director.prototype = $extend(flambe.Component.prototype,{
	get_height: function() {
		return this._height < 0?flambe.System.get_stage().get_height():this._height;
	}
	,get_width: function() {
		return this._width < 0?flambe.System.get_stage().get_width():this._width;
	}
	,completeTransition: function() {
		if(this._transitor != null) {
			this._transitor.complete();
			this._transitor = null;
			this.invalidateVisibility();
		}
	}
	,invalidateVisibility: function() {
		var ii = this.scenes.length;
		while(ii > 0) {
			var scene = this.scenes[--ii];
			var comp = flambe.scene.Scene.getFrom(scene);
			if(comp == null || comp.opaque) break;
		}
		this.occludedScenes = this.scenes.length > 0?this.scenes.slice(ii,this.scenes.length - 1):[];
		var scene = this.get_topScene();
		if(scene != null) this.show(scene);
	}
	,show: function(scene) {
		var events = flambe.scene.Scene.getFrom(scene);
		if(events != null) events.shown.emit();
	}
	,get_topScene: function() {
		var ll = this.scenes.length;
		return ll > 0?this.scenes[ll - 1]:null;
	}
	,onUpdate: function(dt) {
		if(this._transitor != null && this._transitor.update(dt)) this.completeTransition();
	}
	,onRemoved: function() {
		this.completeTransition();
		var _g = 0, _g1 = this.scenes;
		while(_g < _g1.length) {
			var scene = _g1[_g];
			++_g;
			scene.dispose();
		}
		this.scenes = [];
		this.occludedScenes = [];
		this._root.dispose();
	}
	,onAdded: function() {
		this.owner.addChild(this._root);
	}
	,get_name: function() {
		return "Director_0";
	}
	,__class__: flambe.scene.Director
});
flambe.scene._Director = {}
flambe.scene._Director.Transitor = function() { }
$hxClasses["flambe.scene._Director.Transitor"] = flambe.scene._Director.Transitor;
flambe.scene._Director.Transitor.__name__ = ["flambe","scene","_Director","Transitor"];
flambe.scene._Director.Transitor.prototype = {
	complete: function() {
		this._transition.complete();
		this._onComplete();
	}
	,update: function(dt) {
		return this._transition.update(dt);
	}
	,__class__: flambe.scene._Director.Transitor
}
flambe.scene.Scene = function(opaque) {
	if(opaque == null) opaque = true;
	this.opaque = opaque;
	this.shown = new flambe.util.Signal0();
	this.hidden = new flambe.util.Signal0();
};
$hxClasses["flambe.scene.Scene"] = flambe.scene.Scene;
flambe.scene.Scene.__name__ = ["flambe","scene","Scene"];
flambe.scene.Scene.getFrom = function(entity) {
	return entity.getComponent("Scene_11");
}
flambe.scene.Scene.__super__ = flambe.Component;
flambe.scene.Scene.prototype = $extend(flambe.Component.prototype,{
	get_name: function() {
		return "Scene_11";
	}
	,__class__: flambe.scene.Scene
});
flambe.scene.Transition = function() { }
$hxClasses["flambe.scene.Transition"] = flambe.scene.Transition;
flambe.scene.Transition.__name__ = ["flambe","scene","Transition"];
flambe.scene.Transition.prototype = {
	complete: function() {
	}
	,update: function(dt) {
		return true;
	}
	,__class__: flambe.scene.Transition
}
flambe.swf.BitmapSprite = function(symbol) {
	flambe.display.Sprite.call(this);
	this.symbol = symbol;
	this.anchorX.set__(symbol.anchorX);
	this.anchorY.set__(symbol.anchorY);
};
$hxClasses["flambe.swf.BitmapSprite"] = flambe.swf.BitmapSprite;
flambe.swf.BitmapSprite.__name__ = ["flambe","swf","BitmapSprite"];
flambe.swf.BitmapSprite.__super__ = flambe.display.Sprite;
flambe.swf.BitmapSprite.prototype = $extend(flambe.display.Sprite.prototype,{
	getNaturalHeight: function() {
		return this.symbol.height;
	}
	,getNaturalWidth: function() {
		return this.symbol.width;
	}
	,draw: function(g) {
		g.drawSubImage(this.symbol.atlas,0,0,this.symbol.x,this.symbol.y,this.symbol.width,this.symbol.height);
	}
	,__class__: flambe.swf.BitmapSprite
});
flambe.swf.BitmapSymbol = function() { }
$hxClasses["flambe.swf.BitmapSymbol"] = flambe.swf.BitmapSymbol;
flambe.swf.BitmapSymbol.__name__ = ["flambe","swf","BitmapSymbol"];
flambe.swf.BitmapSymbol.__interfaces__ = [flambe.swf.Symbol];
flambe.swf.BitmapSymbol.prototype = {
	get_name: function() {
		return this._name;
	}
	,createSprite: function() {
		return new flambe.swf.BitmapSprite(this);
	}
	,__class__: flambe.swf.BitmapSymbol
}
flambe.util.Arrays = function() { }
$hxClasses["flambe.util.Arrays"] = flambe.util.Arrays;
flambe.util.Arrays.__name__ = ["flambe","util","Arrays"];
flambe.util.Arrays.create = function(length) {
	return new Array(length);
}
flambe.util.Assert = function() { }
$hxClasses["flambe.util.Assert"] = flambe.util.Assert;
flambe.util.Assert.__name__ = ["flambe","util","Assert"];
flambe.util.Assert.that = function(condition,message,fields) {
	if(!condition) flambe.util.Assert.fail(message,fields);
}
flambe.util.Assert.fail = function(message,fields) {
	var error = "Assertion failed!";
	if(message != null) error += " " + message;
	if(fields != null) error = flambe.util.Strings.withFields(error,fields);
	throw error;
}
flambe.util.BitSets = function() { }
$hxClasses["flambe.util.BitSets"] = flambe.util.BitSets;
flambe.util.BitSets.__name__ = ["flambe","util","BitSets"];
flambe.util.BitSets.add = function(bits,mask) {
	return bits | mask;
}
flambe.util.BitSets.remove = function(bits,mask) {
	return bits & ~mask;
}
flambe.util.BitSets.contains = function(bits,mask) {
	return (bits & mask) != 0;
}
flambe.util.BitSets.containsAll = function(bits,mask) {
	return (bits & mask) == mask;
}
flambe.util.BitSets.set = function(bits,mask,enabled) {
	return enabled?flambe.util.BitSets.add(bits,mask):flambe.util.BitSets.remove(bits,mask);
}
flambe.util.LogLevel = $hxClasses["flambe.util.LogLevel"] = { __ename__ : ["flambe","util","LogLevel"], __constructs__ : ["Info","Warn","Error"] }
flambe.util.LogLevel.Info = ["Info",0];
flambe.util.LogLevel.Info.toString = $estr;
flambe.util.LogLevel.Info.__enum__ = flambe.util.LogLevel;
flambe.util.LogLevel.Warn = ["Warn",1];
flambe.util.LogLevel.Warn.toString = $estr;
flambe.util.LogLevel.Warn.__enum__ = flambe.util.LogLevel;
flambe.util.LogLevel.Error = ["Error",2];
flambe.util.LogLevel.Error.toString = $estr;
flambe.util.LogLevel.Error.__enum__ = flambe.util.LogLevel;
flambe.util.Promise = function() {
	this.success = new flambe.util.Signal1();
	this.error = new flambe.util.Signal1();
	this.progressChanged = new flambe.util.Signal0();
	this.hasResult = false;
	this._progress = 0;
	this._total = 0;
};
$hxClasses["flambe.util.Promise"] = flambe.util.Promise;
flambe.util.Promise.__name__ = ["flambe","util","Promise"];
flambe.util.Promise.prototype = {
	get_total: function() {
		return this._total;
	}
	,set_total: function(total) {
		if(this._total != total) {
			this._total = total;
			this.progressChanged.emit();
		}
		return total;
	}
	,set_progress: function(progress) {
		if(this._progress != progress) {
			this._progress = progress;
			this.progressChanged.emit();
		}
		return progress;
	}
	,get_progress: function() {
		return this._progress;
	}
	,get: function(fn) {
		if(this.hasResult) {
			fn(this._result);
			return null;
		}
		return this.success.connect(fn).once();
	}
	,set_result: function(result) {
		if(this.hasResult) throw "Promise result already assigned";
		this._result = result;
		this.hasResult = true;
		this.success.emit(result);
		return result;
	}
	,get_result: function() {
		if(!this.hasResult) throw "Promise result not yet available";
		return this._result;
	}
	,__class__: flambe.util.Promise
}
flambe.util.Signal0 = function(listener) {
	flambe.util.SignalBase.call(this,listener);
};
$hxClasses["flambe.util.Signal0"] = flambe.util.Signal0;
flambe.util.Signal0.__name__ = ["flambe","util","Signal0"];
flambe.util.Signal0.__super__ = flambe.util.SignalBase;
flambe.util.Signal0.prototype = $extend(flambe.util.SignalBase.prototype,{
	emit: function() {
		this.emit0();
	}
	,connect: function(listener,prioritize) {
		if(prioritize == null) prioritize = false;
		return this.connectImpl(listener,prioritize);
	}
	,__class__: flambe.util.Signal0
});
flambe.util._SignalBase = {}
flambe.util._SignalBase.Task = function(fn) {
	this.next = null;
	this.fn = fn;
};
$hxClasses["flambe.util._SignalBase.Task"] = flambe.util._SignalBase.Task;
flambe.util._SignalBase.Task.__name__ = ["flambe","util","_SignalBase","Task"];
flambe.util._SignalBase.Task.prototype = {
	__class__: flambe.util._SignalBase.Task
}
var haxe = {}
haxe.Json = function() {
};
$hxClasses["haxe.Json"] = haxe.Json;
haxe.Json.__name__ = ["haxe","Json"];
haxe.Json.parse = function(text) {
	return new haxe.Json().doParse(text);
}
haxe.Json.prototype = {
	parseString: function() {
		var start = this.pos;
		var buf = new StringBuf();
		while(true) {
			var c = this.nextChar();
			if(c == 34) break;
			if(c == 92) {
				buf.addSub(this.str,start,this.pos - start - 1);
				c = this.nextChar();
				switch(c) {
				case 114:
					buf.addChar(13);
					break;
				case 110:
					buf.addChar(10);
					break;
				case 116:
					buf.addChar(9);
					break;
				case 98:
					buf.addChar(8);
					break;
				case 102:
					buf.addChar(12);
					break;
				case 47:case 92:case 34:
					buf.addChar(c);
					break;
				case 117:
					var uc = Std.parseInt("0x" + HxOverrides.substr(this.str,this.pos,4));
					this.pos += 4;
					buf.addChar(uc);
					break;
				default:
					throw "Invalid escape sequence \\" + String.fromCharCode(c) + " at position " + (this.pos - 1);
				}
				start = this.pos;
			} else if(StringTools.isEOF(c)) throw "Unclosed string";
		}
		buf.addSub(this.str,start,this.pos - start - 1);
		return buf.toString();
	}
	,parseRec: function() {
		while(true) {
			var c = this.nextChar();
			switch(c) {
			case 32:case 13:case 10:case 9:
				break;
			case 123:
				var obj = { }, field = null, comma = null;
				while(true) {
					var c1 = this.nextChar();
					switch(c1) {
					case 32:case 13:case 10:case 9:
						break;
					case 125:
						if(field != null || comma == false) this.invalidChar();
						return obj;
					case 58:
						if(field == null) this.invalidChar();
						Reflect.setField(obj,field,this.parseRec());
						field = null;
						comma = true;
						break;
					case 44:
						if(comma) comma = false; else this.invalidChar();
						break;
					case 34:
						if(comma) this.invalidChar();
						field = this.parseString();
						break;
					default:
						this.invalidChar();
					}
				}
				break;
			case 91:
				var arr = [], comma = null;
				while(true) {
					var c1 = this.nextChar();
					switch(c1) {
					case 32:case 13:case 10:case 9:
						break;
					case 93:
						if(comma == false) this.invalidChar();
						return arr;
					case 44:
						if(comma) comma = false; else this.invalidChar();
						break;
					default:
						if(comma) this.invalidChar();
						this.pos--;
						arr.push(this.parseRec());
						comma = true;
					}
				}
				break;
			case 116:
				var save = this.pos;
				if(this.nextChar() != 114 || this.nextChar() != 117 || this.nextChar() != 101) {
					this.pos = save;
					this.invalidChar();
				}
				return true;
			case 102:
				var save = this.pos;
				if(this.nextChar() != 97 || this.nextChar() != 108 || this.nextChar() != 115 || this.nextChar() != 101) {
					this.pos = save;
					this.invalidChar();
				}
				return false;
			case 110:
				var save = this.pos;
				if(this.nextChar() != 117 || this.nextChar() != 108 || this.nextChar() != 108) {
					this.pos = save;
					this.invalidChar();
				}
				return null;
			case 34:
				return this.parseString();
			case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 45:
				this.pos--;
				if(!this.reg_float.match(HxOverrides.substr(this.str,this.pos,null))) throw "Invalid float at position " + this.pos;
				var v = this.reg_float.matched(0);
				this.pos += v.length;
				var f = Std.parseFloat(v);
				var i = Std["int"](f);
				return i == f?i:f;
			default:
				this.invalidChar();
			}
		}
	}
	,nextChar: function() {
		return StringTools.fastCodeAt(this.str,this.pos++);
	}
	,invalidChar: function() {
		this.pos--;
		throw "Invalid char " + StringTools.fastCodeAt(this.str,this.pos) + " at position " + this.pos;
	}
	,doParse: function(str) {
		this.reg_float = new EReg("^-?(0|[1-9][0-9]*)(\\.[0-9]+)?([eE][+-]?[0-9]+)?","");
		this.str = str;
		this.pos = 0;
		return this.parseRec();
	}
	,__class__: haxe.Json
}
haxe.Serializer = function() {
	this.buf = new StringBuf();
	this.cache = new Array();
	this.useCache = haxe.Serializer.USE_CACHE;
	this.useEnumIndex = haxe.Serializer.USE_ENUM_INDEX;
	this.shash = new Hash();
	this.scount = 0;
};
$hxClasses["haxe.Serializer"] = haxe.Serializer;
haxe.Serializer.__name__ = ["haxe","Serializer"];
haxe.Serializer.prototype = {
	serialize: function(v) {
		var $e = (Type["typeof"](v));
		switch( $e[1] ) {
		case 0:
			this.buf.add("n");
			break;
		case 1:
			if(v == 0) {
				this.buf.add("z");
				return;
			}
			this.buf.add("i");
			this.buf.add(v);
			break;
		case 2:
			if(Math.isNaN(v)) this.buf.add("k"); else if(!Math.isFinite(v)) this.buf.add(v < 0?"m":"p"); else {
				this.buf.add("d");
				this.buf.add(v);
			}
			break;
		case 3:
			this.buf.add(v?"t":"f");
			break;
		case 6:
			var c = $e[2];
			if(c == String) {
				this.serializeString(v);
				return;
			}
			if(this.useCache && this.serializeRef(v)) return;
			switch(c) {
			case Array:
				var ucount = 0;
				this.buf.add("a");
				var l = v.length;
				var _g = 0;
				while(_g < l) {
					var i = _g++;
					if(v[i] == null) ucount++; else {
						if(ucount > 0) {
							if(ucount == 1) this.buf.add("n"); else {
								this.buf.add("u");
								this.buf.add(ucount);
							}
							ucount = 0;
						}
						this.serialize(v[i]);
					}
				}
				if(ucount > 0) {
					if(ucount == 1) this.buf.add("n"); else {
						this.buf.add("u");
						this.buf.add(ucount);
					}
				}
				this.buf.add("h");
				break;
			case List:
				this.buf.add("l");
				var v1 = v;
				var $it0 = v1.iterator();
				while( $it0.hasNext() ) {
					var i = $it0.next();
					this.serialize(i);
				}
				this.buf.add("h");
				break;
			case Date:
				var d = v;
				this.buf.add("v");
				this.buf.add(HxOverrides.dateStr(d));
				break;
			case Hash:
				this.buf.add("b");
				var v1 = v;
				var $it1 = v1.keys();
				while( $it1.hasNext() ) {
					var k = $it1.next();
					this.serializeString(k);
					this.serialize(v1.get(k));
				}
				this.buf.add("h");
				break;
			case IntHash:
				this.buf.add("q");
				var v1 = v;
				var $it2 = v1.keys();
				while( $it2.hasNext() ) {
					var k = $it2.next();
					this.buf.add(":");
					this.buf.add(k);
					this.serialize(v1.get(k));
				}
				this.buf.add("h");
				break;
			case haxe.io.Bytes:
				var v1 = v;
				var i = 0;
				var max = v1.length - 2;
				var charsBuf = new StringBuf();
				var b64 = haxe.Serializer.BASE64;
				while(i < max) {
					var b1 = v1.get(i++);
					var b2 = v1.get(i++);
					var b3 = v1.get(i++);
					charsBuf.add(b64.charAt(b1 >> 2));
					charsBuf.add(b64.charAt((b1 << 4 | b2 >> 4) & 63));
					charsBuf.add(b64.charAt((b2 << 2 | b3 >> 6) & 63));
					charsBuf.add(b64.charAt(b3 & 63));
				}
				if(i == max) {
					var b1 = v1.get(i++);
					var b2 = v1.get(i++);
					charsBuf.add(b64.charAt(b1 >> 2));
					charsBuf.add(b64.charAt((b1 << 4 | b2 >> 4) & 63));
					charsBuf.add(b64.charAt(b2 << 2 & 63));
				} else if(i == max + 1) {
					var b1 = v1.get(i++);
					charsBuf.add(b64.charAt(b1 >> 2));
					charsBuf.add(b64.charAt(b1 << 4 & 63));
				}
				var chars = charsBuf.toString();
				this.buf.add("s");
				this.buf.add(chars.length);
				this.buf.add(":");
				this.buf.add(chars);
				break;
			default:
				this.cache.pop();
				if(v.hxSerialize != null) {
					this.buf.add("C");
					this.serializeString(Type.getClassName(c));
					this.cache.push(v);
					v.hxSerialize(this);
					this.buf.add("g");
				} else {
					this.buf.add("c");
					this.serializeString(Type.getClassName(c));
					this.cache.push(v);
					this.serializeFields(v);
				}
			}
			break;
		case 4:
			if(this.useCache && this.serializeRef(v)) return;
			this.buf.add("o");
			this.serializeFields(v);
			break;
		case 7:
			var e = $e[2];
			if(this.useCache && this.serializeRef(v)) return;
			this.cache.pop();
			this.buf.add(this.useEnumIndex?"j":"w");
			this.serializeString(Type.getEnumName(e));
			if(this.useEnumIndex) {
				this.buf.add(":");
				this.buf.add(v[1]);
			} else this.serializeString(v[0]);
			this.buf.add(":");
			var l = v.length;
			this.buf.add(l - 2);
			var _g = 2;
			while(_g < l) {
				var i = _g++;
				this.serialize(v[i]);
			}
			this.cache.push(v);
			break;
		case 5:
			throw "Cannot serialize function";
			break;
		default:
			throw "Cannot serialize " + Std.string(v);
		}
	}
	,serializeFields: function(v) {
		var _g = 0, _g1 = Reflect.fields(v);
		while(_g < _g1.length) {
			var f = _g1[_g];
			++_g;
			this.serializeString(f);
			this.serialize(Reflect.field(v,f));
		}
		this.buf.add("g");
	}
	,serializeRef: function(v) {
		var vt = typeof(v);
		var _g1 = 0, _g = this.cache.length;
		while(_g1 < _g) {
			var i = _g1++;
			var ci = this.cache[i];
			if(typeof(ci) == vt && ci == v) {
				this.buf.add("r");
				this.buf.add(i);
				return true;
			}
		}
		this.cache.push(v);
		return false;
	}
	,serializeString: function(s) {
		var x = this.shash.get(s);
		if(x != null) {
			this.buf.add("R");
			this.buf.add(x);
			return;
		}
		this.shash.set(s,this.scount++);
		this.buf.add("y");
		s = StringTools.urlEncode(s);
		this.buf.add(s.length);
		this.buf.add(":");
		this.buf.add(s);
	}
	,toString: function() {
		return this.buf.toString();
	}
	,__class__: haxe.Serializer
}
haxe.__timers = [];
haxe.updateTimers = function (delta) {
	var timers = haxe.__timers,
		i = timers.length;

	while (i--) {
		timers[i].update(delta);
	}
};
haxe.Timer = function(time_ms) {
	this.time_ms = time_ms;
	this.currentTime = 0;
	haxe.__timers.push(this);
};
$hxClasses["haxe.Timer"] = haxe.Timer;
haxe.Timer.__name__ = ["haxe","Timer"];
haxe.Timer.delay = function(f,time_ms) {
	var t = new haxe.Timer(time_ms);
	t.run = function() {
		t.stop();
		f();
	};
	return t;
}
haxe.Timer.stamp = function() {
	return new Date().getTime() / 1000;
}
haxe.Timer.prototype = {
	run: function() {
	}
	,stop: function() {
		var i = haxe.__timers.indexOf(this);

		if (i >= 0) {
			haxe.__timers.splice(i, 1);
		}
	}
	,update: function (delta) {
		this.currentTime += delta * 1000;
		if (this.currentTime >= this.time_ms) {
			this.run();
			this.currentTime -= this.time_ms;
		}
	}
	,__class__: haxe.Timer
}
haxe.Unserializer = function(buf) {
	this.buf = buf;
	this.length = buf.length;
	this.pos = 0;
	this.scache = new Array();
	this.cache = new Array();
	var r = haxe.Unserializer.DEFAULT_RESOLVER;
	if(r == null) {
		r = Type;
		haxe.Unserializer.DEFAULT_RESOLVER = r;
	}
	this.setResolver(r);
};
$hxClasses["haxe.Unserializer"] = haxe.Unserializer;
haxe.Unserializer.__name__ = ["haxe","Unserializer"];
haxe.Unserializer.initCodes = function() {
	var codes = new Array();
	var _g1 = 0, _g = haxe.Unserializer.BASE64.length;
	while(_g1 < _g) {
		var i = _g1++;
		codes[StringTools.fastCodeAt(haxe.Unserializer.BASE64,i)] = i;
	}
	return codes;
}
haxe.Unserializer.run = function(v) {
	return new haxe.Unserializer(v).unserialize();
}
haxe.Unserializer.prototype = {
	unserialize: function() {
		switch(this.get(this.pos++)) {
		case 110:
			return null;
		case 116:
			return true;
		case 102:
			return false;
		case 122:
			return 0;
		case 105:
			return this.readDigits();
		case 100:
			var p1 = this.pos;
			while(true) {
				var c = this.get(this.pos);
				if(c >= 43 && c < 58 || c == 101 || c == 69) this.pos++; else break;
			}
			return Std.parseFloat(HxOverrides.substr(this.buf,p1,this.pos - p1));
		case 121:
			var len = this.readDigits();
			if(this.get(this.pos++) != 58 || this.length - this.pos < len) throw "Invalid string length";
			var s = HxOverrides.substr(this.buf,this.pos,len);
			this.pos += len;
			s = StringTools.urlDecode(s);
			this.scache.push(s);
			return s;
		case 107:
			return Math.NaN;
		case 109:
			return Math.NEGATIVE_INFINITY;
		case 112:
			return Math.POSITIVE_INFINITY;
		case 97:
			var buf = this.buf;
			var a = new Array();
			this.cache.push(a);
			while(true) {
				var c = this.get(this.pos);
				if(c == 104) {
					this.pos++;
					break;
				}
				if(c == 117) {
					this.pos++;
					var n = this.readDigits();
					a[a.length + n - 1] = null;
				} else a.push(this.unserialize());
			}
			return a;
		case 111:
			var o = { };
			this.cache.push(o);
			this.unserializeObject(o);
			return o;
		case 114:
			var n = this.readDigits();
			if(n < 0 || n >= this.cache.length) throw "Invalid reference";
			return this.cache[n];
		case 82:
			var n = this.readDigits();
			if(n < 0 || n >= this.scache.length) throw "Invalid string reference";
			return this.scache[n];
		case 120:
			throw this.unserialize();
			break;
		case 99:
			var name = this.unserialize();
			var cl = this.resolver.resolveClass(name);
			if(cl == null) throw "Class not found " + name;
			var o = Type.createEmptyInstance(cl);
			this.cache.push(o);
			this.unserializeObject(o);
			return o;
		case 119:
			var name = this.unserialize();
			var edecl = this.resolver.resolveEnum(name);
			if(edecl == null) throw "Enum not found " + name;
			var e = this.unserializeEnum(edecl,this.unserialize());
			this.cache.push(e);
			return e;
		case 106:
			var name = this.unserialize();
			var edecl = this.resolver.resolveEnum(name);
			if(edecl == null) throw "Enum not found " + name;
			this.pos++;
			var index = this.readDigits();
			var tag = Type.getEnumConstructs(edecl)[index];
			if(tag == null) throw "Unknown enum index " + name + "@" + index;
			var e = this.unserializeEnum(edecl,tag);
			this.cache.push(e);
			return e;
		case 108:
			var l = new List();
			this.cache.push(l);
			var buf = this.buf;
			while(this.get(this.pos) != 104) l.add(this.unserialize());
			this.pos++;
			return l;
		case 98:
			var h = new Hash();
			this.cache.push(h);
			var buf = this.buf;
			while(this.get(this.pos) != 104) {
				var s = this.unserialize();
				h.set(s,this.unserialize());
			}
			this.pos++;
			return h;
		case 113:
			var h = new IntHash();
			this.cache.push(h);
			var buf = this.buf;
			var c = this.get(this.pos++);
			while(c == 58) {
				var i = this.readDigits();
				h.set(i,this.unserialize());
				c = this.get(this.pos++);
			}
			if(c != 104) throw "Invalid IntHash format";
			return h;
		case 118:
			var d = HxOverrides.strDate(HxOverrides.substr(this.buf,this.pos,19));
			this.cache.push(d);
			this.pos += 19;
			return d;
		case 115:
			var len = this.readDigits();
			var buf = this.buf;
			if(this.get(this.pos++) != 58 || this.length - this.pos < len) throw "Invalid bytes length";
			var codes = haxe.Unserializer.CODES;
			if(codes == null) {
				codes = haxe.Unserializer.initCodes();
				haxe.Unserializer.CODES = codes;
			}
			var i = this.pos;
			var rest = len & 3;
			var size = (len >> 2) * 3 + (rest >= 2?rest - 1:0);
			var max = i + (len - rest);
			var bytes = haxe.io.Bytes.alloc(size);
			var bpos = 0;
			while(i < max) {
				var c1 = codes[StringTools.fastCodeAt(buf,i++)];
				var c2 = codes[StringTools.fastCodeAt(buf,i++)];
				bytes.set(bpos++,c1 << 2 | c2 >> 4);
				var c3 = codes[StringTools.fastCodeAt(buf,i++)];
				bytes.set(bpos++,c2 << 4 | c3 >> 2);
				var c4 = codes[StringTools.fastCodeAt(buf,i++)];
				bytes.set(bpos++,c3 << 6 | c4);
			}
			if(rest >= 2) {
				var c1 = codes[StringTools.fastCodeAt(buf,i++)];
				var c2 = codes[StringTools.fastCodeAt(buf,i++)];
				bytes.set(bpos++,c1 << 2 | c2 >> 4);
				if(rest == 3) {
					var c3 = codes[StringTools.fastCodeAt(buf,i++)];
					bytes.set(bpos++,c2 << 4 | c3 >> 2);
				}
			}
			this.pos += len;
			this.cache.push(bytes);
			return bytes;
		case 67:
			var name = this.unserialize();
			var cl = this.resolver.resolveClass(name);
			if(cl == null) throw "Class not found " + name;
			var o = Type.createEmptyInstance(cl);
			this.cache.push(o);
			o.hxUnserialize(this);
			if(this.get(this.pos++) != 103) throw "Invalid custom data";
			return o;
		default:
		}
		this.pos--;
		throw "Invalid char " + this.buf.charAt(this.pos) + " at position " + this.pos;
	}
	,unserializeEnum: function(edecl,tag) {
		if(this.get(this.pos++) != 58) throw "Invalid enum format";
		var nargs = this.readDigits();
		if(nargs == 0) return Type.createEnum(edecl,tag);
		var args = new Array();
		while(nargs-- > 0) args.push(this.unserialize());
		return Type.createEnum(edecl,tag,args);
	}
	,unserializeObject: function(o) {
		while(true) {
			if(this.pos >= this.length) throw "Invalid object";
			if(this.get(this.pos) == 103) break;
			var k = this.unserialize();
			if(!Std["is"](k,String)) throw "Invalid object key";
			var v = this.unserialize();
			Reflect.setField(o,k,v);
		}
		this.pos++;
	}
	,readDigits: function() {
		var k = 0;
		var s = false;
		var fpos = this.pos;
		while(true) {
			var c = this.get(this.pos);
			if(StringTools.isEOF(c)) break;
			if(c == 45) {
				if(this.pos != fpos) break;
				s = true;
				this.pos++;
				continue;
			}
			if(c < 48 || c > 57) break;
			k = k * 10 + (c - 48);
			this.pos++;
		}
		if(s) k *= -1;
		return k;
	}
	,get: function(p) {
		return StringTools.fastCodeAt(this.buf,p);
	}
	,setResolver: function(r) {
		if(r == null) this.resolver = { resolveClass : function(_) {
			return null;
		}, resolveEnum : function(_) {
			return null;
		}}; else this.resolver = r;
	}
	,__class__: haxe.Unserializer
}
haxe.io = {}
haxe.io.Bytes = function(length,b) {
	this.length = length;
	this.b = b;
};
$hxClasses["haxe.io.Bytes"] = haxe.io.Bytes;
haxe.io.Bytes.__name__ = ["haxe","io","Bytes"];
haxe.io.Bytes.alloc = function(length) {
	var a = new Array();
	var _g = 0;
	while(_g < length) {
		var i = _g++;
		a.push(0);
	}
	return new haxe.io.Bytes(length,a);
}
haxe.io.Bytes.ofData = function(b) {
	return new haxe.io.Bytes(b.length,b);
}
haxe.io.Bytes.prototype = {
	getData: function() {
		return this.b;
	}
	,set: function(pos,v) {
		this.b[pos] = v & 255;
	}
	,get: function(pos) {
		return this.b[pos];
	}
	,__class__: haxe.io.Bytes
}
haxe.xml = {}
haxe.xml.Parser = function() { }
$hxClasses["haxe.xml.Parser"] = haxe.xml.Parser;
haxe.xml.Parser.__name__ = ["haxe","xml","Parser"];
haxe.xml.Parser.parse = function(str) {
	var doc = Xml.createDocument();
	haxe.xml.Parser.doParse(str,0,doc);
	return doc;
}
haxe.xml.Parser.doParse = function(str,p,parent) {
	if(p == null) p = 0;
	var xml = null;
	var state = 1;
	var next = 1;
	var aname = null;
	var start = 0;
	var nsubs = 0;
	var nbrackets = 0;
	var c = StringTools.fastCodeAt(str,p);
	while(!StringTools.isEOF(c)) {
		switch(state) {
		case 0:
			switch(c) {
			case 10:case 13:case 9:case 32:
				break;
			default:
				state = next;
				continue;
			}
			break;
		case 1:
			switch(c) {
			case 60:
				state = 0;
				next = 2;
				break;
			default:
				start = p;
				state = 13;
				continue;
			}
			break;
		case 13:
			if(c == 60) {
				var child = Xml.createPCData(HxOverrides.substr(str,start,p - start));
				parent.addChild(child);
				nsubs++;
				state = 0;
				next = 2;
			}
			break;
		case 17:
			if(c == 93 && StringTools.fastCodeAt(str,p + 1) == 93 && StringTools.fastCodeAt(str,p + 2) == 62) {
				var child = Xml.createCData(HxOverrides.substr(str,start,p - start));
				parent.addChild(child);
				nsubs++;
				p += 2;
				state = 1;
			}
			break;
		case 2:
			switch(c) {
			case 33:
				if(StringTools.fastCodeAt(str,p + 1) == 91) {
					p += 2;
					if(HxOverrides.substr(str,p,6).toUpperCase() != "CDATA[") throw "Expected <![CDATA[";
					p += 5;
					state = 17;
					start = p + 1;
				} else if(StringTools.fastCodeAt(str,p + 1) == 68 || StringTools.fastCodeAt(str,p + 1) == 100) {
					if(HxOverrides.substr(str,p + 2,6).toUpperCase() != "OCTYPE") throw "Expected <!DOCTYPE";
					p += 8;
					state = 16;
					start = p + 1;
				} else if(StringTools.fastCodeAt(str,p + 1) != 45 || StringTools.fastCodeAt(str,p + 2) != 45) throw "Expected <!--"; else {
					p += 2;
					state = 15;
					start = p + 1;
				}
				break;
			case 63:
				state = 14;
				start = p;
				break;
			case 47:
				if(parent == null) throw "Expected node name";
				start = p + 1;
				state = 0;
				next = 10;
				break;
			default:
				state = 3;
				start = p;
				continue;
			}
			break;
		case 3:
			if(!haxe.xml.Parser.isValidChar(c)) {
				if(p == start) throw "Expected node name";
				xml = Xml.createElement(HxOverrides.substr(str,start,p - start));
				parent.addChild(xml);
				state = 0;
				next = 4;
				continue;
			}
			break;
		case 4:
			switch(c) {
			case 47:
				state = 11;
				nsubs++;
				break;
			case 62:
				state = 9;
				nsubs++;
				break;
			default:
				state = 5;
				start = p;
				continue;
			}
			break;
		case 5:
			if(!haxe.xml.Parser.isValidChar(c)) {
				var tmp;
				if(start == p) throw "Expected attribute name";
				tmp = HxOverrides.substr(str,start,p - start);
				aname = tmp;
				if(xml.exists(aname)) throw "Duplicate attribute";
				state = 0;
				next = 6;
				continue;
			}
			break;
		case 6:
			switch(c) {
			case 61:
				state = 0;
				next = 7;
				break;
			default:
				throw "Expected =";
			}
			break;
		case 7:
			switch(c) {
			case 34:case 39:
				state = 8;
				start = p;
				break;
			default:
				throw "Expected \"";
			}
			break;
		case 8:
			if(c == StringTools.fastCodeAt(str,start)) {
				var val = HxOverrides.substr(str,start + 1,p - start - 1);
				xml.set(aname,val);
				state = 0;
				next = 4;
			}
			break;
		case 9:
			p = haxe.xml.Parser.doParse(str,p,xml);
			start = p;
			state = 1;
			break;
		case 11:
			switch(c) {
			case 62:
				state = 1;
				break;
			default:
				throw "Expected >";
			}
			break;
		case 12:
			switch(c) {
			case 62:
				if(nsubs == 0) parent.addChild(Xml.createPCData(""));
				return p;
			default:
				throw "Expected >";
			}
			break;
		case 10:
			if(!haxe.xml.Parser.isValidChar(c)) {
				if(start == p) throw "Expected node name";
				var v = HxOverrides.substr(str,start,p - start);
				if(v != parent.getNodeName()) throw "Expected </" + parent.getNodeName() + ">";
				state = 0;
				next = 12;
				continue;
			}
			break;
		case 15:
			if(c == 45 && StringTools.fastCodeAt(str,p + 1) == 45 && StringTools.fastCodeAt(str,p + 2) == 62) {
				parent.addChild(Xml.createComment(HxOverrides.substr(str,start,p - start)));
				p += 2;
				state = 1;
			}
			break;
		case 16:
			if(c == 91) nbrackets++; else if(c == 93) nbrackets--; else if(c == 62 && nbrackets == 0) {
				parent.addChild(Xml.createDocType(HxOverrides.substr(str,start,p - start)));
				state = 1;
			}
			break;
		case 14:
			if(c == 63 && StringTools.fastCodeAt(str,p + 1) == 62) {
				p++;
				var str1 = HxOverrides.substr(str,start + 1,p - start - 2);
				parent.addChild(Xml.createProlog(str1));
				state = 1;
			}
			break;
		}
		c = StringTools.fastCodeAt(str,++p);
	}
	if(state == 1) {
		start = p;
		state = 13;
	}
	if(state == 13) {
		if(p != start || nsubs == 0) parent.addChild(Xml.createPCData(HxOverrides.substr(str,start,p - start)));
		return p;
	}
	throw "Unexpected end";
}
haxe.xml.Parser.isValidChar = function(c) {
	return c >= 97 && c <= 122 || c >= 65 && c <= 90 || c >= 48 && c <= 57 || c == 58 || c == 46 || c == 95 || c == 45;
}
nape.Config = function() {
};
$hxClasses["nape.Config"] = nape.Config;
nape.Config.__name__ = ["nape","Config"];
nape.Config.prototype = {
	__class__: nape.Config
}
nape.callbacks.Callback = function() {
	this.zpp_inner = null;
	if(!zpp_nape.callbacks.ZPP_Callback.internal) throw "Error: Callback cannot be instantiated derp!";
};
$hxClasses["nape.callbacks.Callback"] = nape.callbacks.Callback;
nape.callbacks.Callback.__name__ = ["nape","callbacks","Callback"];
nape.callbacks.Callback.prototype = {
	toString: function() {
		return "";
	}
	,get_listener: function() {
		return this.zpp_inner.listener.outer;
	}
	,__class__: nape.callbacks.Callback
}
nape.callbacks.BodyCallback = function() {
	nape.callbacks.Callback.call(this);
};
$hxClasses["nape.callbacks.BodyCallback"] = nape.callbacks.BodyCallback;
nape.callbacks.BodyCallback.__name__ = ["nape","callbacks","BodyCallback"];
nape.callbacks.BodyCallback.__super__ = nape.callbacks.Callback;
nape.callbacks.BodyCallback.prototype = $extend(nape.callbacks.Callback.prototype,{
	toString: function() {
		var ret = "Cb:";
		ret += ["WAKE","SLEEP"][this.zpp_inner.event - zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE];
		ret += ":" + this.get_body().toString();
		ret += " : listener: " + Std.string(this.get_listener());
		return ret;
	}
	,get_body: function() {
		return this.zpp_inner.body.outer;
	}
	,__class__: nape.callbacks.BodyCallback
});
nape.callbacks.Listener = function() {
	this.zpp_inner = null;
	if(!zpp_nape.callbacks.ZPP_Listener.internal) throw "Error: Cannot instantiate Listener derp!";
};
$hxClasses["nape.callbacks.Listener"] = nape.callbacks.Listener;
nape.callbacks.Listener.__name__ = ["nape","callbacks","Listener"];
nape.callbacks.Listener.prototype = {
	toString: function() {
		var event = ["BEGIN","END","WAKE","SLEEP","BREAK","PRE","ONGOING"][this.zpp_inner.event];
		if(this.zpp_inner.type == zpp_nape.util.ZPP_Flags.id_ListenerType_BODY) {
			var body = this.zpp_inner.body;
			return "BodyListener{" + event + "::" + Std.string(body.outer_zn.get_options()) + "}";
		} else if(this.zpp_inner.type == zpp_nape.util.ZPP_Flags.id_ListenerType_CONSTRAINT) {
			var con = this.zpp_inner.constraint;
			return "ConstraintListener{" + event + "::" + Std.string(con.outer_zn.get_options()) + "}";
		} else {
			var con = this.zpp_inner.interaction;
			var itype = (function($this) {
				var $r;
				switch(con.itype) {
				case zpp_nape.util.ZPP_Flags.id_InteractionType_COLLISION:
					$r = "COLLISION";
					break;
				case zpp_nape.util.ZPP_Flags.id_InteractionType_SENSOR:
					$r = "SENSOR";
					break;
				case zpp_nape.util.ZPP_Flags.id_InteractionType_FLUID:
					$r = "FLUID";
					break;
				default:
					$r = "ALL";
				}
				return $r;
			}(this));
			return (this.zpp_inner.type == zpp_nape.util.ZPP_Flags.id_ListenerType_INTERACTION?"InteractionListener{" + event + "#" + itype + "::" + Std.string(con.outer_zni.get_options1()) + ":" + Std.string(con.outer_zni.get_options2()) + "}":"PreListener{" + itype + "::" + Std.string(con.outer_znp.get_options1()) + ":" + Std.string(con.outer_znp.get_options2()) + "}") + " precedence=" + this.zpp_inner.precedence;
		}
	}
	,get_space: function() {
		return this.zpp_inner.space == null?null:this.zpp_inner.space.outer;
	}
	,get_precedence: function() {
		return this.zpp_inner.precedence;
	}
	,get_event: function() {
		return [nape.callbacks.CbEvent.get_BEGIN(),nape.callbacks.CbEvent.get_END(),nape.callbacks.CbEvent.get_WAKE(),nape.callbacks.CbEvent.get_SLEEP(),nape.callbacks.CbEvent.get_BREAK(),nape.callbacks.CbEvent.get_PRE(),nape.callbacks.CbEvent.get_ONGOING()][this.zpp_inner.event];
	}
	,__class__: nape.callbacks.Listener
}
nape.callbacks.BodyListener = function() {
	this.zpp_inner_zn = null;
};
$hxClasses["nape.callbacks.BodyListener"] = nape.callbacks.BodyListener;
nape.callbacks.BodyListener.__name__ = ["nape","callbacks","BodyListener"];
nape.callbacks.BodyListener.__super__ = nape.callbacks.Listener;
nape.callbacks.BodyListener.prototype = $extend(nape.callbacks.Listener.prototype,{
	get_handler: function() {
		return this.zpp_inner_zn.handler;
	}
	,get_options: function() {
		return this.zpp_inner_zn.options.outer;
	}
	,__class__: nape.callbacks.BodyListener
});
nape.callbacks.CbEvent = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "CbEvent" + " derp!";
};
$hxClasses["nape.callbacks.CbEvent"] = nape.callbacks.CbEvent;
nape.callbacks.CbEvent.__name__ = ["nape","callbacks","CbEvent"];
nape.callbacks.CbEvent.get_BEGIN = function() {
	if(zpp_nape.util.ZPP_Flags.CbEvent_BEGIN == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.CbEvent_BEGIN = new nape.callbacks.CbEvent();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.CbEvent_BEGIN;
}
nape.callbacks.CbEvent.get_ONGOING = function() {
	if(zpp_nape.util.ZPP_Flags.CbEvent_ONGOING == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.CbEvent_ONGOING = new nape.callbacks.CbEvent();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.CbEvent_ONGOING;
}
nape.callbacks.CbEvent.get_END = function() {
	if(zpp_nape.util.ZPP_Flags.CbEvent_END == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.CbEvent_END = new nape.callbacks.CbEvent();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.CbEvent_END;
}
nape.callbacks.CbEvent.get_WAKE = function() {
	if(zpp_nape.util.ZPP_Flags.CbEvent_WAKE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.CbEvent_WAKE = new nape.callbacks.CbEvent();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.CbEvent_WAKE;
}
nape.callbacks.CbEvent.get_SLEEP = function() {
	if(zpp_nape.util.ZPP_Flags.CbEvent_SLEEP == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.CbEvent_SLEEP = new nape.callbacks.CbEvent();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.CbEvent_SLEEP;
}
nape.callbacks.CbEvent.get_BREAK = function() {
	if(zpp_nape.util.ZPP_Flags.CbEvent_BREAK == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.CbEvent_BREAK = new nape.callbacks.CbEvent();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.CbEvent_BREAK;
}
nape.callbacks.CbEvent.get_PRE = function() {
	if(zpp_nape.util.ZPP_Flags.CbEvent_PRE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.CbEvent_PRE = new nape.callbacks.CbEvent();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.CbEvent_PRE;
}
nape.callbacks.CbEvent.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.callbacks.CbEvent.get_PRE()) return "PRE"; else if(this == nape.callbacks.CbEvent.get_BEGIN()) return "BEGIN"; else if(this == nape.callbacks.CbEvent.get_ONGOING()) return "ONGOING"; else if(this == nape.callbacks.CbEvent.get_END()) return "END"; else if(this == nape.callbacks.CbEvent.get_WAKE()) return "WAKE"; else if(this == nape.callbacks.CbEvent.get_SLEEP()) return "SLEEP"; else if(this == nape.callbacks.CbEvent.get_BREAK()) return "BREAK"; else return "";
	}
	,__class__: nape.callbacks.CbEvent
}
nape.callbacks.CbTypeIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_CbTypeList.internal) throw "Error: Cannot instantiate " + "CbType" + "Iterator derp!";
};
$hxClasses["nape.callbacks.CbTypeIterator"] = nape.callbacks.CbTypeIterator;
nape.callbacks.CbTypeIterator.__name__ = ["nape","callbacks","CbTypeIterator"];
nape.callbacks.CbTypeIterator.get = function(list) {
	var ret = nape.callbacks.CbTypeIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_CbTypeList.internal = true;
		var ret1 = new nape.callbacks.CbTypeIterator();
		zpp_nape.util.ZPP_CbTypeList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.callbacks.CbTypeIterator.zpp_pool;
		nape.callbacks.CbTypeIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.callbacks.CbTypeIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.callbacks.CbTypeIterator.zpp_pool;
			nape.callbacks.CbTypeIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.callbacks.CbTypeIterator
}
nape.callbacks.CbTypeList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_CbTypeList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.callbacks.CbTypeList"] = nape.callbacks.CbTypeList;
nape.callbacks.CbTypeList.__name__ = ["nape","callbacks","CbTypeList"];
nape.callbacks.CbTypeList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.callbacks.CbTypeIterator.get(this);
	}
	,empty: function() {
		if(false) return this.get_length() == 0; else return this.zpp_inner.inner.empty();
	}
	,add: function(obj) {
		return this.zpp_inner.reverse_flag?this.push(obj):this.unshift(obj);
	}
	,unshift: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "CbType" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			} else this.zpp_inner.inner.add(obj.zpp_inner);
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,push: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "CbType" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) this.zpp_inner.inner.add(obj.zpp_inner); else {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			}
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().outer;
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.callbacks.CbTypeList
}
nape.callbacks.ConstraintCallback = function() {
	nape.callbacks.Callback.call(this);
};
$hxClasses["nape.callbacks.ConstraintCallback"] = nape.callbacks.ConstraintCallback;
nape.callbacks.ConstraintCallback.__name__ = ["nape","callbacks","ConstraintCallback"];
nape.callbacks.ConstraintCallback.__super__ = nape.callbacks.Callback;
nape.callbacks.ConstraintCallback.prototype = $extend(nape.callbacks.Callback.prototype,{
	toString: function() {
		var ret = "Cb:";
		ret += ["WAKE","SLEEP","BREAK"][this.zpp_inner.event - zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE];
		ret += ":" + this.get_constraint().toString();
		ret += " : listener: " + Std.string(this.get_listener());
		return ret;
	}
	,get_constraint: function() {
		return this.zpp_inner.constraint.outer;
	}
	,__class__: nape.callbacks.ConstraintCallback
});
nape.callbacks.ConstraintListener = function() {
	this.zpp_inner_zn = null;
};
$hxClasses["nape.callbacks.ConstraintListener"] = nape.callbacks.ConstraintListener;
nape.callbacks.ConstraintListener.__name__ = ["nape","callbacks","ConstraintListener"];
nape.callbacks.ConstraintListener.__super__ = nape.callbacks.Listener;
nape.callbacks.ConstraintListener.prototype = $extend(nape.callbacks.Listener.prototype,{
	get_handler: function() {
		return this.zpp_inner_zn.handler;
	}
	,get_options: function() {
		return this.zpp_inner_zn.options.outer;
	}
	,__class__: nape.callbacks.ConstraintListener
});
nape.callbacks.InteractionCallback = function() {
	nape.callbacks.Callback.call(this);
};
$hxClasses["nape.callbacks.InteractionCallback"] = nape.callbacks.InteractionCallback;
nape.callbacks.InteractionCallback.__name__ = ["nape","callbacks","InteractionCallback"];
nape.callbacks.InteractionCallback.__super__ = nape.callbacks.Callback;
nape.callbacks.InteractionCallback.prototype = $extend(nape.callbacks.Callback.prototype,{
	toString: function() {
		var ret = "Cb:";
		ret += ["BEGIN","END","","","","","ONGOING"][this.zpp_inner.event];
		ret += ":" + this.get_int1().toString() + "/" + this.get_int2().toString();
		ret += " : " + this.get_arbiters().toString();
		ret += " : listener: " + Std.string(this.get_listener());
		return ret;
	}
	,get_arbiters: function() {
		return this.zpp_inner.wrap_arbiters;
	}
	,get_int2: function() {
		return this.zpp_inner.int2.outer_i;
	}
	,get_int1: function() {
		return this.zpp_inner.int1.outer_i;
	}
	,__class__: nape.callbacks.InteractionCallback
});
nape.callbacks.InteractionListener = function(event,interactionType,options1,options2,handler,precedence) {
	if(precedence == null) precedence = 0;
	this.zpp_inner_zn = null;
	zpp_nape.callbacks.ZPP_Listener.internal = true;
	nape.callbacks.Listener.call(this);
	zpp_nape.callbacks.ZPP_Listener.internal = false;
	if(handler == null) throw "Error: InteractionListener::handler cannot be null";
	if(event == null) throw "Error: CbEvent cannot be null for InteractionListener";
	var xevent = -1;
	if(event == nape.callbacks.CbEvent.get_BEGIN()) xevent = zpp_nape.util.ZPP_Flags.id_CbEvent_BEGIN; else if(event == nape.callbacks.CbEvent.get_END()) xevent = zpp_nape.util.ZPP_Flags.id_CbEvent_END; else if(event == nape.callbacks.CbEvent.get_ONGOING()) xevent = zpp_nape.util.ZPP_Flags.id_CbEvent_ONGOING; else throw "Error: CbEvent '" + event.toString() + "' is not a valid event type for InteractionListener";
	this.zpp_inner_zn = new zpp_nape.callbacks.ZPP_InteractionListener(zpp_nape.callbacks.ZPP_OptionType.argument(options1),zpp_nape.callbacks.ZPP_OptionType.argument(options2),xevent,zpp_nape.util.ZPP_Flags.id_ListenerType_INTERACTION);
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner.outer = this;
	this.zpp_inner_zn.outer_zni = this;
	this.zpp_inner.precedence = precedence;
	this.zpp_inner_zn.handleri = handler;
	this.set_interactionType(interactionType);
};
$hxClasses["nape.callbacks.InteractionListener"] = nape.callbacks.InteractionListener;
nape.callbacks.InteractionListener.__name__ = ["nape","callbacks","InteractionListener"];
nape.callbacks.InteractionListener.__super__ = nape.callbacks.Listener;
nape.callbacks.InteractionListener.prototype = $extend(nape.callbacks.Listener.prototype,{
	get_allowSleepingCallbacks: function() {
		return this.zpp_inner_zn.allowSleepingCallbacks;
	}
	,get_handler: function() {
		return this.zpp_inner_zn.handleri;
	}
	,set_interactionType: function(interactionType) {
		if(interactionType == null) throw "Error: Cannot set listener interaction type to null";
		if(this.get_interactionType() != interactionType) {
			var xtype = interactionType == nape.callbacks.InteractionType.get_COLLISION()?zpp_nape.util.ZPP_Flags.id_InteractionType_COLLISION:interactionType == nape.callbacks.InteractionType.get_SENSOR()?zpp_nape.util.ZPP_Flags.id_InteractionType_SENSOR:interactionType == nape.callbacks.InteractionType.get_FLUID()?zpp_nape.util.ZPP_Flags.id_InteractionType_FLUID:zpp_nape.util.ZPP_Flags.id_InteractionType_ANY;
			this.zpp_inner_zn.setInteractionType(xtype);
		}
		return this.get_interactionType();
	}
	,get_interactionType: function() {
		var ret = this.zpp_inner_zn.itype;
		return ret == zpp_nape.util.ZPP_Flags.id_InteractionType_COLLISION?nape.callbacks.InteractionType.get_COLLISION():ret == zpp_nape.util.ZPP_Flags.id_InteractionType_SENSOR?nape.callbacks.InteractionType.get_SENSOR():ret == zpp_nape.util.ZPP_Flags.id_InteractionType_FLUID?nape.callbacks.InteractionType.get_FLUID():ret == zpp_nape.util.ZPP_Flags.id_InteractionType_ANY?nape.callbacks.InteractionType.get_ANY():null;
	}
	,get_options2: function() {
		return this.zpp_inner_zn.options2.outer;
	}
	,get_options1: function() {
		return this.zpp_inner_zn.options1.outer;
	}
	,__class__: nape.callbacks.InteractionListener
});
nape.callbacks.InteractionType = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "InteractionType" + " derp!";
};
$hxClasses["nape.callbacks.InteractionType"] = nape.callbacks.InteractionType;
nape.callbacks.InteractionType.__name__ = ["nape","callbacks","InteractionType"];
nape.callbacks.InteractionType.get_COLLISION = function() {
	if(zpp_nape.util.ZPP_Flags.InteractionType_COLLISION == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.InteractionType_COLLISION = new nape.callbacks.InteractionType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.InteractionType_COLLISION;
}
nape.callbacks.InteractionType.get_SENSOR = function() {
	if(zpp_nape.util.ZPP_Flags.InteractionType_SENSOR == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.InteractionType_SENSOR = new nape.callbacks.InteractionType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.InteractionType_SENSOR;
}
nape.callbacks.InteractionType.get_FLUID = function() {
	if(zpp_nape.util.ZPP_Flags.InteractionType_FLUID == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.InteractionType_FLUID = new nape.callbacks.InteractionType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.InteractionType_FLUID;
}
nape.callbacks.InteractionType.get_ANY = function() {
	if(zpp_nape.util.ZPP_Flags.InteractionType_ANY == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.InteractionType_ANY = new nape.callbacks.InteractionType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.InteractionType_ANY;
}
nape.callbacks.InteractionType.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.callbacks.InteractionType.get_COLLISION()) return "COLLISION"; else if(this == nape.callbacks.InteractionType.get_SENSOR()) return "SENSOR"; else if(this == nape.callbacks.InteractionType.get_FLUID()) return "FLUID"; else if(this == nape.callbacks.InteractionType.get_ANY()) return "ANY"; else return "";
	}
	,__class__: nape.callbacks.InteractionType
}
nape.callbacks.ListenerIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_ListenerList.internal) throw "Error: Cannot instantiate " + "Listener" + "Iterator derp!";
};
$hxClasses["nape.callbacks.ListenerIterator"] = nape.callbacks.ListenerIterator;
nape.callbacks.ListenerIterator.__name__ = ["nape","callbacks","ListenerIterator"];
nape.callbacks.ListenerIterator.get = function(list) {
	var ret = nape.callbacks.ListenerIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_ListenerList.internal = true;
		var ret1 = new nape.callbacks.ListenerIterator();
		zpp_nape.util.ZPP_ListenerList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.callbacks.ListenerIterator.zpp_pool;
		nape.callbacks.ListenerIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.callbacks.ListenerIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.callbacks.ListenerIterator.zpp_pool;
			nape.callbacks.ListenerIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.callbacks.ListenerIterator
}
nape.callbacks.ListenerList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_ListenerList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.callbacks.ListenerList"] = nape.callbacks.ListenerList;
nape.callbacks.ListenerList.__name__ = ["nape","callbacks","ListenerList"];
nape.callbacks.ListenerList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.callbacks.ListenerIterator.get(this);
	}
	,empty: function() {
		if(false) return this.get_length() == 0; else return this.zpp_inner.inner.empty();
	}
	,remove: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Listener" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var ret;
		ret = false;
		var cx_ite = this.zpp_inner.inner.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(x == obj.zpp_inner) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(ret) {
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(obj);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.remove(obj.zpp_inner);
			this.zpp_inner.invalidate();
		}
		return ret;
	}
	,add: function(obj) {
		return this.zpp_inner.reverse_flag?this.push(obj):this.unshift(obj);
	}
	,unshift: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Listener" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			} else this.zpp_inner.inner.add(obj.zpp_inner);
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,push: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Listener" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) this.zpp_inner.inner.add(obj.zpp_inner); else {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			}
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().outer;
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.callbacks.ListenerList
}
nape.callbacks.ListenerType = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "ListenerType" + " derp!";
};
$hxClasses["nape.callbacks.ListenerType"] = nape.callbacks.ListenerType;
nape.callbacks.ListenerType.__name__ = ["nape","callbacks","ListenerType"];
nape.callbacks.ListenerType.get_BODY = function() {
	if(zpp_nape.util.ZPP_Flags.ListenerType_BODY == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ListenerType_BODY = new nape.callbacks.ListenerType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ListenerType_BODY;
}
nape.callbacks.ListenerType.get_CONSTRAINT = function() {
	if(zpp_nape.util.ZPP_Flags.ListenerType_CONSTRAINT == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ListenerType_CONSTRAINT = new nape.callbacks.ListenerType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ListenerType_CONSTRAINT;
}
nape.callbacks.ListenerType.get_INTERACTION = function() {
	if(zpp_nape.util.ZPP_Flags.ListenerType_INTERACTION == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ListenerType_INTERACTION = new nape.callbacks.ListenerType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ListenerType_INTERACTION;
}
nape.callbacks.ListenerType.get_PRE = function() {
	if(zpp_nape.util.ZPP_Flags.ListenerType_PRE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ListenerType_PRE = new nape.callbacks.ListenerType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ListenerType_PRE;
}
nape.callbacks.ListenerType.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.callbacks.ListenerType.get_BODY()) return "BODY"; else if(this == nape.callbacks.ListenerType.get_CONSTRAINT()) return "CONSTRAINT"; else if(this == nape.callbacks.ListenerType.get_INTERACTION()) return "INTERACTION"; else if(this == nape.callbacks.ListenerType.get_PRE()) return "PRE"; else return "";
	}
	,__class__: nape.callbacks.ListenerType
}
nape.callbacks.OptionType = function(includes,excludes) {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.callbacks.ZPP_OptionType();
	this.zpp_inner.outer = this;
	if(includes != null) this.including(includes);
	if(excludes != null) this.excluding(excludes);
};
$hxClasses["nape.callbacks.OptionType"] = nape.callbacks.OptionType;
nape.callbacks.OptionType.__name__ = ["nape","callbacks","OptionType"];
nape.callbacks.OptionType.prototype = {
	toString: function() {
		var inc = this.get_includes().toString();
		var exc = this.get_excludes().toString();
		return "@{" + inc + " excluding " + exc + "}";
	}
	,excluding: function(excludes) {
		this.zpp_inner.append(this.zpp_inner.excludes,excludes);
		return this;
	}
	,including: function(includes) {
		this.zpp_inner.append(this.zpp_inner.includes,includes);
		return this;
	}
	,get_excludes: function() {
		if(this.zpp_inner.wrap_excludes == null) this.zpp_inner.setup_excludes();
		return this.zpp_inner.wrap_excludes;
	}
	,get_includes: function() {
		if(this.zpp_inner.wrap_includes == null) this.zpp_inner.setup_includes();
		return this.zpp_inner.wrap_includes;
	}
	,__class__: nape.callbacks.OptionType
}
nape.callbacks.PreCallback = function() {
	nape.callbacks.Callback.call(this);
};
$hxClasses["nape.callbacks.PreCallback"] = nape.callbacks.PreCallback;
nape.callbacks.PreCallback.__name__ = ["nape","callbacks","PreCallback"];
nape.callbacks.PreCallback.__super__ = nape.callbacks.Callback;
nape.callbacks.PreCallback.prototype = $extend(nape.callbacks.Callback.prototype,{
	toString: function() {
		var ret = "Cb:PRE:";
		ret += ":" + this.get_int1().toString() + "/" + this.get_int2().toString();
		ret += " : " + this.get_arbiter().toString();
		ret += " : listnener: " + Std.string(this.get_listener());
		return ret;
	}
	,get_int2: function() {
		return this.zpp_inner.int2.outer_i;
	}
	,get_int1: function() {
		return this.zpp_inner.int1.outer_i;
	}
	,get_arbiter: function() {
		return this.zpp_inner.pre_arbiter.wrapper();
	}
	,__class__: nape.callbacks.PreCallback
});
nape.callbacks.PreFlag = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "PreFlag" + " derp!";
};
$hxClasses["nape.callbacks.PreFlag"] = nape.callbacks.PreFlag;
nape.callbacks.PreFlag.__name__ = ["nape","callbacks","PreFlag"];
nape.callbacks.PreFlag.get_ACCEPT = function() {
	if(zpp_nape.util.ZPP_Flags.PreFlag_ACCEPT == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.PreFlag_ACCEPT = new nape.callbacks.PreFlag();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.PreFlag_ACCEPT;
}
nape.callbacks.PreFlag.get_IGNORE = function() {
	if(zpp_nape.util.ZPP_Flags.PreFlag_IGNORE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.PreFlag_IGNORE = new nape.callbacks.PreFlag();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.PreFlag_IGNORE;
}
nape.callbacks.PreFlag.get_ACCEPT_ONCE = function() {
	if(zpp_nape.util.ZPP_Flags.PreFlag_ACCEPT_ONCE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.PreFlag_ACCEPT_ONCE = new nape.callbacks.PreFlag();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.PreFlag_ACCEPT_ONCE;
}
nape.callbacks.PreFlag.get_IGNORE_ONCE = function() {
	if(zpp_nape.util.ZPP_Flags.PreFlag_IGNORE_ONCE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.PreFlag_IGNORE_ONCE = new nape.callbacks.PreFlag();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.PreFlag_IGNORE_ONCE;
}
nape.callbacks.PreFlag.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.callbacks.PreFlag.get_ACCEPT()) return "ACCEPT"; else if(this == nape.callbacks.PreFlag.get_IGNORE()) return "IGNORE"; else if(this == nape.callbacks.PreFlag.get_ACCEPT_ONCE()) return "ACCEPT_ONCE"; else if(this == nape.callbacks.PreFlag.get_IGNORE_ONCE()) return "IGNORE_ONCE"; else return "";
	}
	,__class__: nape.callbacks.PreFlag
}
nape.callbacks.PreListener = function(interactionType,options1,options2,handler,precedence,pure) {
	if(pure == null) pure = false;
	if(precedence == null) precedence = 0;
	this.zpp_inner_zn = null;
	zpp_nape.callbacks.ZPP_Listener.internal = true;
	nape.callbacks.Listener.call(this);
	zpp_nape.callbacks.ZPP_Listener.internal = false;
	if(handler == null) throw "Error: PreListener must take a handler!";
	this.zpp_inner_zn = new zpp_nape.callbacks.ZPP_InteractionListener(zpp_nape.callbacks.ZPP_OptionType.argument(options1),zpp_nape.callbacks.ZPP_OptionType.argument(options2),zpp_nape.util.ZPP_Flags.id_CbEvent_PRE,zpp_nape.util.ZPP_Flags.id_ListenerType_PRE);
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner.outer = this;
	this.zpp_inner_zn.outer_znp = this;
	this.zpp_inner.precedence = precedence;
	this.zpp_inner_zn.pure = pure;
	this.zpp_inner_zn.handlerp = handler;
	this.set_interactionType(interactionType);
};
$hxClasses["nape.callbacks.PreListener"] = nape.callbacks.PreListener;
nape.callbacks.PreListener.__name__ = ["nape","callbacks","PreListener"];
nape.callbacks.PreListener.__super__ = nape.callbacks.Listener;
nape.callbacks.PreListener.prototype = $extend(nape.callbacks.Listener.prototype,{
	set_interactionType: function(interactionType) {
		if(interactionType == null) throw "Error: Cannot set listener interaction type to null";
		if(this.get_interactionType() != interactionType) {
			var xtype = interactionType == nape.callbacks.InteractionType.get_COLLISION()?zpp_nape.util.ZPP_Flags.id_InteractionType_COLLISION:interactionType == nape.callbacks.InteractionType.get_SENSOR()?zpp_nape.util.ZPP_Flags.id_InteractionType_SENSOR:interactionType == nape.callbacks.InteractionType.get_FLUID()?zpp_nape.util.ZPP_Flags.id_InteractionType_FLUID:zpp_nape.util.ZPP_Flags.id_InteractionType_ANY;
			this.zpp_inner_zn.setInteractionType(xtype);
		}
		return this.get_interactionType();
	}
	,get_interactionType: function() {
		var ret = this.zpp_inner_zn.itype;
		return ret == zpp_nape.util.ZPP_Flags.id_InteractionType_COLLISION?nape.callbacks.InteractionType.get_COLLISION():ret == zpp_nape.util.ZPP_Flags.id_InteractionType_SENSOR?nape.callbacks.InteractionType.get_SENSOR():ret == zpp_nape.util.ZPP_Flags.id_InteractionType_FLUID?nape.callbacks.InteractionType.get_FLUID():ret == zpp_nape.util.ZPP_Flags.id_InteractionType_ANY?nape.callbacks.InteractionType.get_ANY():null;
	}
	,get_pure: function() {
		return this.zpp_inner_zn.pure;
	}
	,get_handler: function() {
		return this.zpp_inner_zn.handlerp;
	}
	,get_options2: function() {
		return this.zpp_inner_zn.options2.outer;
	}
	,get_options1: function() {
		return this.zpp_inner_zn.options1.outer;
	}
	,__class__: nape.callbacks.PreListener
});
nape.constraint = {}
nape.constraint.Constraint = function() {
	this.zpp_inner.insert_cbtype(nape.callbacks.CbType.get_ANY_CONSTRAINT().zpp_inner);
	throw "Error: Constraint cannot be instantiated derp!";
};
$hxClasses["nape.constraint.Constraint"] = nape.constraint.Constraint;
nape.constraint.Constraint.__name__ = ["nape","constraint","Constraint"];
nape.constraint.Constraint.prototype = {
	toString: function() {
		return "{Constraint}";
	}
	,get_cbTypes: function() {
		if(this.zpp_inner.wrap_cbTypes == null) this.zpp_inner.setupcbTypes();
		return this.zpp_inner.wrap_cbTypes;
	}
	,visitBodies: function(lambda) {
	}
	,bodyImpulse: function(body) {
		return null;
	}
	,impulse: function() {
		return null;
	}
	,set_removeOnBreak: function(removeOnBreak) {
		this.zpp_inner.removeOnBreak = removeOnBreak;
		return this.get_removeOnBreak();
	}
	,get_removeOnBreak: function() {
		return this.zpp_inner.removeOnBreak;
	}
	,set_breakUnderError: function(breakUnderError) {
		if(this.get_breakUnderError() != breakUnderError) {
			this.zpp_inner.breakUnderError = breakUnderError;
			this.zpp_inner.wake();
		}
		return this.get_breakUnderError();
	}
	,get_breakUnderError: function() {
		return this.zpp_inner.breakUnderError;
	}
	,set_breakUnderForce: function(breakUnderForce) {
		if(this.get_breakUnderForce() != breakUnderForce) {
			this.zpp_inner.breakUnderForce = breakUnderForce;
			this.zpp_inner.wake();
		}
		return this.get_breakUnderForce();
	}
	,get_breakUnderForce: function() {
		return this.zpp_inner.breakUnderForce;
	}
	,set_maxError: function(maxError) {
		if(maxError != maxError) throw "Error: Constraint::maxError cannot be NaN";
		if(maxError < 0) throw "Error: Constraint::maxError must be >=0";
		if(this.get_maxError() != maxError) {
			this.zpp_inner.maxError = maxError;
			this.zpp_inner.wake();
		}
		return this.get_maxError();
	}
	,get_maxError: function() {
		return this.zpp_inner.maxError;
	}
	,set_maxForce: function(maxForce) {
		if(maxForce != maxForce) throw "Error: Constraint::maxForce cannot be NaN";
		if(maxForce < 0) throw "Error: Constraint::maxForce must be >=0";
		if(this.get_maxForce() != maxForce) {
			this.zpp_inner.maxForce = maxForce;
			this.zpp_inner.wake();
		}
		return this.get_maxForce();
	}
	,get_maxForce: function() {
		return this.zpp_inner.maxForce;
	}
	,set_damping: function(damping) {
		if(damping != damping) throw "Error: Constraint::Damping cannot be Nan";
		if(damping < 0) throw "Error: Constraint::Damping must be >=0";
		if(this.get_damping() != damping) {
			this.zpp_inner.damping = damping;
			if(!this.zpp_inner.stiff) this.zpp_inner.wake();
		}
		return this.get_damping();
	}
	,get_damping: function() {
		return this.zpp_inner.damping;
	}
	,set_frequency: function(frequency) {
		if(frequency != frequency) throw "Error: Constraint::Frequency cannot be NaN";
		if(frequency <= 0) throw "Error: Constraint::Frequency must be >0";
		if(this.get_frequency() != frequency) {
			this.zpp_inner.frequency = frequency;
			if(!this.zpp_inner.stiff) this.zpp_inner.wake();
		}
		return this.get_frequency();
	}
	,get_frequency: function() {
		return this.zpp_inner.frequency;
	}
	,set_stiff: function(stiff) {
		if(this.get_stiff() != stiff) {
			this.zpp_inner.stiff = stiff;
			this.zpp_inner.wake();
		}
		return this.get_stiff();
	}
	,get_stiff: function() {
		return this.zpp_inner.stiff;
	}
	,set_ignore: function(ignore) {
		if(this.get_ignore() != ignore) {
			this.zpp_inner.ignore = ignore;
			this.zpp_inner.wake();
		}
		return this.get_ignore();
	}
	,get_ignore: function() {
		return this.zpp_inner.ignore;
	}
	,set_active: function(active) {
		if(this.get_active() != active) {
			if(this.zpp_inner.component != null) this.zpp_inner.component.woken = false;
			this.zpp_inner.clearcache();
			if(active) {
				this.zpp_inner.active = active;
				this.zpp_inner.activate();
				if(this.zpp_inner.space != null) {
					if(this.zpp_inner.component != null) this.zpp_inner.component.sleeping = true;
					this.zpp_inner.space.wake_constraint(this.zpp_inner,true);
				}
			} else {
				if(this.zpp_inner.space != null) {
					this.zpp_inner.wake();
					this.zpp_inner.space.live_constraints.remove(this.zpp_inner);
				}
				this.zpp_inner.active = active;
				this.zpp_inner.deactivate();
			}
		}
		return this.get_active();
	}
	,get_active: function() {
		return this.zpp_inner.active;
	}
	,get_space: function() {
		return this.zpp_inner.space == null?null:this.zpp_inner.space.outer;
	}
	,get_compound: function() {
		return this.zpp_inner.compound == null?null:this.zpp_inner.compound.outer;
	}
	,__class__: nape.constraint.Constraint
}
nape.constraint.AngleJoint = function(body1,body2,jointMin,jointMax,ratio) {
	if(ratio == null) ratio = 1.0;
	this.zpp_inner_zn = null;
	this.zpp_inner_zn = new zpp_nape.constraint.ZPP_AngleJoint();
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner.outer = this;
	this.zpp_inner_zn.outer_zn = this;
	try {
		nape.constraint.Constraint.call(this);
	} catch( e ) {
	}
	this.set_body1(body1);
	this.set_body2(body2);
	this.set_jointMin(jointMin);
	this.set_jointMax(jointMax);
	this.set_ratio(ratio);
};
$hxClasses["nape.constraint.AngleJoint"] = nape.constraint.AngleJoint;
nape.constraint.AngleJoint.__name__ = ["nape","constraint","AngleJoint"];
nape.constraint.AngleJoint.__super__ = nape.constraint.Constraint;
nape.constraint.AngleJoint.prototype = $extend(nape.constraint.Constraint.prototype,{
	visitBodies: function(lambda) {
		if(lambda == null) throw "Error: Cannot apply null lambda to bodies";
		if(this.get_body1() != null) lambda(this.get_body1());
		if(this.get_body2() != null && this.get_body2() != this.get_body1()) lambda(this.get_body2());
	}
	,bodyImpulse: function(body) {
		if(body == null) throw "Error: Cannot evaluate impulse on null body";
		if(body != this.get_body1() && body != this.get_body2()) throw "Error: Body is not linked to this constraint";
		if(!this.get_active()) return nape.geom.Vec3.get(0,0,0); else return this.zpp_inner_zn.bodyImpulse(body.zpp_inner);
	}
	,impulse: function() {
		var ret = new nape.geom.MatMN(1,1);
		ret.setx(0,0,this.zpp_inner_zn.jAcc);
		return ret;
	}
	,set_ratio: function(ratio) {
		this.zpp_inner.immutable_midstep("AngleJoint::ratio");
		if(ratio != ratio) throw "Error: AngleJoint::ratio cannot be NaN";
		if(this.get_ratio() != ratio) {
			this.zpp_inner_zn.ratio = ratio;
			this.zpp_inner.wake();
		}
		return this.get_ratio();
	}
	,get_ratio: function() {
		return this.zpp_inner_zn.ratio;
	}
	,set_jointMax: function(jointMax) {
		this.zpp_inner.immutable_midstep("AngleJoint::jointMax");
		if(jointMax != jointMax) throw "Error: AngleJoint::jointMax cannot be NaN";
		if(this.get_jointMax() != jointMax) {
			this.zpp_inner_zn.jointMax = jointMax;
			this.zpp_inner.wake();
		}
		return this.get_jointMax();
	}
	,get_jointMax: function() {
		return this.zpp_inner_zn.jointMax;
	}
	,set_jointMin: function(jointMin) {
		this.zpp_inner.immutable_midstep("AngleJoint::jointMin");
		if(jointMin != jointMin) throw "Error: AngleJoint::jointMin cannot be NaN";
		if(this.get_jointMin() != jointMin) {
			this.zpp_inner_zn.jointMin = jointMin;
			this.zpp_inner.wake();
		}
		return this.get_jointMin();
	}
	,get_jointMin: function() {
		return this.zpp_inner_zn.jointMin;
	}
	,set_body2: function(body2) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body2");
		var inbody2 = body2 == null?null:body2.zpp_inner;
		if(inbody2 != this.zpp_inner_zn.b2) {
			if(this.zpp_inner_zn.b2 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b1 != this.zpp_inner_zn.b2) {
					if(this.zpp_inner_zn.b2 != null) this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b2.wake();
			}
			this.zpp_inner_zn.b2 = inbody2;
			if(this.get_space() != null && inbody2 != null && this.zpp_inner_zn.b1 != inbody2) {
				if(inbody2 != null) inbody2.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody2 != null) inbody2.wake();
			}
		}
		return this.get_body2();
	}
	,get_body2: function() {
		return this.zpp_inner_zn.b2 == null?null:this.zpp_inner_zn.b2.outer;
	}
	,set_body1: function(body1) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body1");
		var inbody1 = body1 == null?null:body1.zpp_inner;
		if(inbody1 != this.zpp_inner_zn.b1) {
			if(this.zpp_inner_zn.b1 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b2 != this.zpp_inner_zn.b1) {
					if(this.zpp_inner_zn.b1 != null) this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b1.wake();
			}
			this.zpp_inner_zn.b1 = inbody1;
			if(this.get_space() != null && inbody1 != null && this.zpp_inner_zn.b2 != inbody1) {
				if(inbody1 != null) inbody1.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody1 != null) inbody1.wake();
			}
		}
		return this.get_body1();
	}
	,get_body1: function() {
		return this.zpp_inner_zn.b1 == null?null:this.zpp_inner_zn.b1.outer;
	}
	,__class__: nape.constraint.AngleJoint
});
nape.constraint.ConstraintIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_ConstraintList.internal) throw "Error: Cannot instantiate " + "Constraint" + "Iterator derp!";
};
$hxClasses["nape.constraint.ConstraintIterator"] = nape.constraint.ConstraintIterator;
nape.constraint.ConstraintIterator.__name__ = ["nape","constraint","ConstraintIterator"];
nape.constraint.ConstraintIterator.get = function(list) {
	var ret = nape.constraint.ConstraintIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_ConstraintList.internal = true;
		var ret1 = new nape.constraint.ConstraintIterator();
		zpp_nape.util.ZPP_ConstraintList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.constraint.ConstraintIterator.zpp_pool;
		nape.constraint.ConstraintIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.constraint.ConstraintIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.constraint.ConstraintIterator.zpp_pool;
			nape.constraint.ConstraintIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.constraint.ConstraintIterator
}
nape.constraint.ConstraintList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_ConstraintList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.constraint.ConstraintList"] = nape.constraint.ConstraintList;
nape.constraint.ConstraintList.__name__ = ["nape","constraint","ConstraintList"];
nape.constraint.ConstraintList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.constraint.ConstraintIterator.get(this);
	}
	,empty: function() {
		if(false) return this.get_length() == 0; else return this.zpp_inner.inner.empty();
	}
	,remove: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Constraint" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var ret;
		ret = false;
		var cx_ite = this.zpp_inner.inner.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(x == obj.zpp_inner) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(ret) {
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(obj);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.remove(obj.zpp_inner);
			this.zpp_inner.invalidate();
		}
		return ret;
	}
	,add: function(obj) {
		return this.zpp_inner.reverse_flag?this.push(obj):this.unshift(obj);
	}
	,unshift: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Constraint" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			} else this.zpp_inner.inner.add(obj.zpp_inner);
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,push: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Constraint" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) this.zpp_inner.inner.add(obj.zpp_inner); else {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			}
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().outer;
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.constraint.ConstraintList
}
nape.constraint.DistanceJoint = function(body1,body2,anchor1,anchor2,jointMin,jointMax) {
	this.zpp_inner_zn = null;
	this.zpp_inner_zn = new zpp_nape.constraint.ZPP_DistanceJoint();
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner.outer = this;
	this.zpp_inner_zn.outer_zn = this;
	try {
		nape.constraint.Constraint.call(this);
	} catch( e ) {
	}
	this.set_body1(body1);
	this.set_body2(body2);
	this.set_anchor1(anchor1);
	this.set_anchor2(anchor2);
	this.set_jointMin(jointMin);
	this.set_jointMax(jointMax);
};
$hxClasses["nape.constraint.DistanceJoint"] = nape.constraint.DistanceJoint;
nape.constraint.DistanceJoint.__name__ = ["nape","constraint","DistanceJoint"];
nape.constraint.DistanceJoint.__super__ = nape.constraint.Constraint;
nape.constraint.DistanceJoint.prototype = $extend(nape.constraint.Constraint.prototype,{
	visitBodies: function(lambda) {
		if(this.get_body1() != null) lambda(this.get_body1());
		if(this.get_body2() != null && this.get_body2() != this.get_body1()) lambda(this.get_body2());
	}
	,bodyImpulse: function(body) {
		if(body == null) throw "Error: Cannot evaluate impulse on null body";
		if(body != this.get_body1() && body != this.get_body2()) throw "Error: Body is not linked to this constraint";
		if(!this.get_active()) return nape.geom.Vec3.get(); else return this.zpp_inner_zn.bodyImpulse(body.zpp_inner);
	}
	,impulse: function() {
		var ret = new nape.geom.MatMN(1,1);
		ret.setx(0,0,this.zpp_inner_zn.jAcc);
		return ret;
	}
	,set_jointMax: function(jointMax) {
		this.zpp_inner.immutable_midstep("DistanceJoint::jointMax");
		if(jointMax != jointMax) throw "Error: DistanceJoint::jointMax cannot be NaN";
		if(jointMax < 0) throw "Error: DistanceJoint::jointMax must be >= 0";
		if(this.get_jointMax() != jointMax) {
			this.zpp_inner_zn.jointMax = jointMax;
			this.zpp_inner.wake();
		}
		return this.get_jointMax();
	}
	,get_jointMax: function() {
		return this.zpp_inner_zn.jointMax;
	}
	,set_jointMin: function(jointMin) {
		this.zpp_inner.immutable_midstep("DistanceJoint::jointMin");
		if(jointMin != jointMin) throw "Error: DistanceJoint::jointMin cannot be NaN";
		if(jointMin < 0) throw "Error: DistanceJoint::jointMin must be >= 0";
		if(this.get_jointMin() != jointMin) {
			this.zpp_inner_zn.jointMin = jointMin;
			this.zpp_inner.wake();
		}
		return this.get_jointMin();
	}
	,get_jointMin: function() {
		return this.zpp_inner_zn.jointMin;
	}
	,set_anchor2: function(anchor2) {
		if(anchor2 != null && anchor2.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor2 == null) throw "Error: Constraint::" + "anchor2" + " cannot be null";
		this.get_anchor2().set(anchor2);
		return this.get_anchor2();
	}
	,get_anchor2: function() {
		if(this.zpp_inner_zn.wrap_a2 == null) this.zpp_inner_zn.setup_a2();
		return this.zpp_inner_zn.wrap_a2;
	}
	,set_anchor1: function(anchor1) {
		if(anchor1 != null && anchor1.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor1 == null) throw "Error: Constraint::" + "anchor1" + " cannot be null";
		this.get_anchor1().set(anchor1);
		return this.get_anchor1();
	}
	,get_anchor1: function() {
		if(this.zpp_inner_zn.wrap_a1 == null) this.zpp_inner_zn.setup_a1();
		return this.zpp_inner_zn.wrap_a1;
	}
	,set_body2: function(body2) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body2");
		var inbody2 = body2 == null?null:body2.zpp_inner;
		if(inbody2 != this.zpp_inner_zn.b2) {
			if(this.zpp_inner_zn.b2 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b1 != this.zpp_inner_zn.b2) {
					if(this.zpp_inner_zn.b2 != null) this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b2.wake();
			}
			this.zpp_inner_zn.b2 = inbody2;
			if(this.get_space() != null && inbody2 != null && this.zpp_inner_zn.b1 != inbody2) {
				if(inbody2 != null) inbody2.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody2 != null) inbody2.wake();
			}
		}
		return this.get_body2();
	}
	,get_body2: function() {
		return this.zpp_inner_zn.b2 == null?null:this.zpp_inner_zn.b2.outer;
	}
	,set_body1: function(body1) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body1");
		var inbody1 = body1 == null?null:body1.zpp_inner;
		if(inbody1 != this.zpp_inner_zn.b1) {
			if(this.zpp_inner_zn.b1 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b2 != this.zpp_inner_zn.b1) {
					if(this.zpp_inner_zn.b1 != null) this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b1.wake();
			}
			this.zpp_inner_zn.b1 = inbody1;
			if(this.get_space() != null && inbody1 != null && this.zpp_inner_zn.b2 != inbody1) {
				if(inbody1 != null) inbody1.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody1 != null) inbody1.wake();
			}
		}
		return this.get_body1();
	}
	,get_body1: function() {
		return this.zpp_inner_zn.b1 == null?null:this.zpp_inner_zn.b1.outer;
	}
	,__class__: nape.constraint.DistanceJoint
});
nape.constraint.LineJoint = function(body1,body2,anchor1,anchor2,direction,jointMin,jointMax) {
	this.zpp_inner_zn = null;
	this.zpp_inner_zn = new zpp_nape.constraint.ZPP_LineJoint();
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner.outer = this;
	this.zpp_inner_zn.outer_zn = this;
	try {
		nape.constraint.Constraint.call(this);
	} catch( e ) {
	}
	this.set_body1(body1);
	this.set_body2(body2);
	this.set_anchor1(anchor1);
	this.set_anchor2(anchor2);
	this.set_direction(direction);
	this.set_jointMin(jointMin);
	this.set_jointMax(jointMax);
};
$hxClasses["nape.constraint.LineJoint"] = nape.constraint.LineJoint;
nape.constraint.LineJoint.__name__ = ["nape","constraint","LineJoint"];
nape.constraint.LineJoint.__super__ = nape.constraint.Constraint;
nape.constraint.LineJoint.prototype = $extend(nape.constraint.Constraint.prototype,{
	visitBodies: function(lambda) {
		if(this.get_body1() != null) lambda(this.get_body1());
		if(this.get_body2() != null && this.get_body2() != this.get_body1()) lambda(this.get_body2());
	}
	,bodyImpulse: function(body) {
		if(body == null) throw "Error: Cannot evaluate impulse on null body";
		if(body != this.get_body1() && body != this.get_body2()) throw "Error: Body is not linked to this constraint";
		if(!this.get_active()) return nape.geom.Vec3.get(); else return this.zpp_inner_zn.bodyImpulse(body.zpp_inner);
	}
	,impulse: function() {
		var ret = new nape.geom.MatMN(2,1);
		ret.setx(0,0,this.zpp_inner_zn.jAccx);
		ret.setx(1,0,this.zpp_inner_zn.jAccy);
		return ret;
	}
	,set_jointMax: function(jointMax) {
		this.zpp_inner.immutable_midstep("LineJoint::jointMax");
		if(jointMax != jointMax) throw "Error: AngleJoint::jointMax cannot be NaN";
		if(this.get_jointMax() != jointMax) {
			this.zpp_inner_zn.jointMax = jointMax;
			this.zpp_inner.wake();
		}
		return this.get_jointMax();
	}
	,get_jointMax: function() {
		return this.zpp_inner_zn.jointMax;
	}
	,set_jointMin: function(jointMin) {
		this.zpp_inner.immutable_midstep("LineJoint::jointMin");
		if(jointMin != jointMin) throw "Error: AngleJoint::jointMin cannot be NaN";
		if(this.get_jointMin() != jointMin) {
			this.zpp_inner_zn.jointMin = jointMin;
			this.zpp_inner.wake();
		}
		return this.get_jointMin();
	}
	,get_jointMin: function() {
		return this.zpp_inner_zn.jointMin;
	}
	,set_direction: function(direction) {
		if(direction != null && direction.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(direction == null) throw "Error: Constraint::" + "direction" + " cannot be null";
		this.get_direction().set(direction);
		return this.get_direction();
	}
	,get_direction: function() {
		if(this.zpp_inner_zn.wrap_n == null) this.zpp_inner_zn.setup_n();
		return this.zpp_inner_zn.wrap_n;
	}
	,set_anchor2: function(anchor2) {
		if(anchor2 != null && anchor2.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor2 == null) throw "Error: Constraint::" + "anchor2" + " cannot be null";
		this.get_anchor2().set(anchor2);
		return this.get_anchor2();
	}
	,get_anchor2: function() {
		if(this.zpp_inner_zn.wrap_a2 == null) this.zpp_inner_zn.setup_a2();
		return this.zpp_inner_zn.wrap_a2;
	}
	,set_anchor1: function(anchor1) {
		if(anchor1 != null && anchor1.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor1 == null) throw "Error: Constraint::" + "anchor1" + " cannot be null";
		this.get_anchor1().set(anchor1);
		return this.get_anchor1();
	}
	,get_anchor1: function() {
		if(this.zpp_inner_zn.wrap_a1 == null) this.zpp_inner_zn.setup_a1();
		return this.zpp_inner_zn.wrap_a1;
	}
	,set_body2: function(body2) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body2");
		var inbody2 = body2 == null?null:body2.zpp_inner;
		if(inbody2 != this.zpp_inner_zn.b2) {
			if(this.zpp_inner_zn.b2 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b1 != this.zpp_inner_zn.b2) {
					if(this.zpp_inner_zn.b2 != null) this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b2.wake();
			}
			this.zpp_inner_zn.b2 = inbody2;
			if(this.get_space() != null && inbody2 != null && this.zpp_inner_zn.b1 != inbody2) {
				if(inbody2 != null) inbody2.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody2 != null) inbody2.wake();
			}
		}
		return this.get_body2();
	}
	,get_body2: function() {
		return this.zpp_inner_zn.b2 == null?null:this.zpp_inner_zn.b2.outer;
	}
	,set_body1: function(body1) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body1");
		var inbody1 = body1 == null?null:body1.zpp_inner;
		if(inbody1 != this.zpp_inner_zn.b1) {
			if(this.zpp_inner_zn.b1 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b2 != this.zpp_inner_zn.b1) {
					if(this.zpp_inner_zn.b1 != null) this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b1.wake();
			}
			this.zpp_inner_zn.b1 = inbody1;
			if(this.get_space() != null && inbody1 != null && this.zpp_inner_zn.b2 != inbody1) {
				if(inbody1 != null) inbody1.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody1 != null) inbody1.wake();
			}
		}
		return this.get_body1();
	}
	,get_body1: function() {
		return this.zpp_inner_zn.b1 == null?null:this.zpp_inner_zn.b1.outer;
	}
	,__class__: nape.constraint.LineJoint
});
nape.constraint.MotorJoint = function(body1,body2,rate,ratio) {
	if(ratio == null) ratio = 1.0;
	if(rate == null) rate = 0.0;
	this.zpp_inner_zn = null;
	this.zpp_inner_zn = new zpp_nape.constraint.ZPP_MotorJoint();
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner.outer = this;
	this.zpp_inner_zn.outer_zn = this;
	try {
		nape.constraint.Constraint.call(this);
	} catch( e ) {
	}
	this.set_body1(body1);
	this.set_body2(body2);
	this.set_rate(rate);
	this.set_ratio(ratio);
};
$hxClasses["nape.constraint.MotorJoint"] = nape.constraint.MotorJoint;
nape.constraint.MotorJoint.__name__ = ["nape","constraint","MotorJoint"];
nape.constraint.MotorJoint.__super__ = nape.constraint.Constraint;
nape.constraint.MotorJoint.prototype = $extend(nape.constraint.Constraint.prototype,{
	visitBodies: function(lambda) {
		if(this.get_body1() != null) lambda(this.get_body1());
		if(this.get_body2() != null && this.get_body2() != this.get_body1()) lambda(this.get_body2());
	}
	,bodyImpulse: function(body) {
		if(body == null) throw "Error: Cannot evaluate impulse on null body";
		if(body != this.get_body1() && body != this.get_body2()) throw "Error: Body is not linked to this constraint";
		if(!this.get_active()) return nape.geom.Vec3.get(); else return this.zpp_inner_zn.bodyImpulse(body.zpp_inner);
	}
	,impulse: function() {
		var ret = new nape.geom.MatMN(1,1);
		ret.setx(0,0,this.zpp_inner_zn.jAcc);
		return ret;
	}
	,set_rate: function(rate) {
		this.zpp_inner.immutable_midstep("MotorJoint::rate");
		if(rate != rate) throw "Error: MotorJoint::rate cannot be NaN";
		if(this.get_rate() != rate) {
			this.zpp_inner_zn.rate = rate;
			this.zpp_inner.wake();
		}
		return this.get_rate();
	}
	,get_rate: function() {
		return this.zpp_inner_zn.rate;
	}
	,set_ratio: function(ratio) {
		this.zpp_inner.immutable_midstep("MotorJoint::ratio");
		if(ratio != ratio) throw "Error: MotorJoint::ratio cannot be NaN";
		if(this.get_ratio() != ratio) {
			this.zpp_inner_zn.ratio = ratio;
			this.zpp_inner.wake();
		}
		return this.get_ratio();
	}
	,get_ratio: function() {
		return this.zpp_inner_zn.ratio;
	}
	,set_body2: function(body2) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body2");
		var inbody2 = body2 == null?null:body2.zpp_inner;
		if(inbody2 != this.zpp_inner_zn.b2) {
			if(this.zpp_inner_zn.b2 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b1 != this.zpp_inner_zn.b2) {
					if(this.zpp_inner_zn.b2 != null) this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b2.wake();
			}
			this.zpp_inner_zn.b2 = inbody2;
			if(this.get_space() != null && inbody2 != null && this.zpp_inner_zn.b1 != inbody2) {
				if(inbody2 != null) inbody2.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody2 != null) inbody2.wake();
			}
		}
		return this.get_body2();
	}
	,get_body2: function() {
		return this.zpp_inner_zn.b2 == null?null:this.zpp_inner_zn.b2.outer;
	}
	,set_body1: function(body1) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body1");
		var inbody1 = body1 == null?null:body1.zpp_inner;
		if(inbody1 != this.zpp_inner_zn.b1) {
			if(this.zpp_inner_zn.b1 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b2 != this.zpp_inner_zn.b1) {
					if(this.zpp_inner_zn.b1 != null) this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b1.wake();
			}
			this.zpp_inner_zn.b1 = inbody1;
			if(this.get_space() != null && inbody1 != null && this.zpp_inner_zn.b2 != inbody1) {
				if(inbody1 != null) inbody1.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody1 != null) inbody1.wake();
			}
		}
		return this.get_body1();
	}
	,get_body1: function() {
		return this.zpp_inner_zn.b1 == null?null:this.zpp_inner_zn.b1.outer;
	}
	,__class__: nape.constraint.MotorJoint
});
nape.constraint.PivotJoint = function(body1,body2,anchor1,anchor2) {
	this.zpp_inner_zn = null;
	this.zpp_inner_zn = new zpp_nape.constraint.ZPP_PivotJoint();
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner.outer = this;
	this.zpp_inner_zn.outer_zn = this;
	try {
		nape.constraint.Constraint.call(this);
	} catch( e ) {
	}
	this.set_body1(body1);
	this.set_body2(body2);
	this.set_anchor1(anchor1);
	this.set_anchor2(anchor2);
};
$hxClasses["nape.constraint.PivotJoint"] = nape.constraint.PivotJoint;
nape.constraint.PivotJoint.__name__ = ["nape","constraint","PivotJoint"];
nape.constraint.PivotJoint.__super__ = nape.constraint.Constraint;
nape.constraint.PivotJoint.prototype = $extend(nape.constraint.Constraint.prototype,{
	visitBodies: function(lambda) {
		if(this.get_body1() != null) lambda(this.get_body1());
		if(this.get_body2() != null && this.get_body2() != this.get_body1()) lambda(this.get_body2());
	}
	,bodyImpulse: function(body) {
		if(body == null) throw "Error: Cannot evaluate impulse on null body";
		if(body != this.get_body1() && body != this.get_body2()) throw "Error: Body is not linked to this constraint";
		if(!this.get_active()) return nape.geom.Vec3.get(); else return this.zpp_inner_zn.bodyImpulse(body.zpp_inner);
	}
	,impulse: function() {
		var ret = new nape.geom.MatMN(2,1);
		ret.setx(0,0,this.zpp_inner_zn.jAccx);
		ret.setx(1,0,this.zpp_inner_zn.jAccy);
		return ret;
	}
	,set_anchor2: function(anchor2) {
		if(anchor2 != null && anchor2.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor2 == null) throw "Error: Constraint::" + "anchor2" + " cannot be null";
		this.get_anchor2().set(anchor2);
		return this.get_anchor2();
	}
	,get_anchor2: function() {
		if(this.zpp_inner_zn.wrap_a2 == null) this.zpp_inner_zn.setup_a2();
		return this.zpp_inner_zn.wrap_a2;
	}
	,set_anchor1: function(anchor1) {
		if(anchor1 != null && anchor1.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor1 == null) throw "Error: Constraint::" + "anchor1" + " cannot be null";
		this.get_anchor1().set(anchor1);
		return this.get_anchor1();
	}
	,get_anchor1: function() {
		if(this.zpp_inner_zn.wrap_a1 == null) this.zpp_inner_zn.setup_a1();
		return this.zpp_inner_zn.wrap_a1;
	}
	,set_body2: function(body2) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body2");
		var inbody2 = body2 == null?null:body2.zpp_inner;
		if(inbody2 != this.zpp_inner_zn.b2) {
			if(this.zpp_inner_zn.b2 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b1 != this.zpp_inner_zn.b2) {
					if(this.zpp_inner_zn.b2 != null) this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b2.wake();
			}
			this.zpp_inner_zn.b2 = inbody2;
			if(this.get_space() != null && inbody2 != null && this.zpp_inner_zn.b1 != inbody2) {
				if(inbody2 != null) inbody2.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody2 != null) inbody2.wake();
			}
		}
		return this.get_body2();
	}
	,get_body2: function() {
		return this.zpp_inner_zn.b2 == null?null:this.zpp_inner_zn.b2.outer;
	}
	,set_body1: function(body1) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body1");
		var inbody1 = body1 == null?null:body1.zpp_inner;
		if(inbody1 != this.zpp_inner_zn.b1) {
			if(this.zpp_inner_zn.b1 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b2 != this.zpp_inner_zn.b1) {
					if(this.zpp_inner_zn.b1 != null) this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b1.wake();
			}
			this.zpp_inner_zn.b1 = inbody1;
			if(this.get_space() != null && inbody1 != null && this.zpp_inner_zn.b2 != inbody1) {
				if(inbody1 != null) inbody1.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody1 != null) inbody1.wake();
			}
		}
		return this.get_body1();
	}
	,get_body1: function() {
		return this.zpp_inner_zn.b1 == null?null:this.zpp_inner_zn.b1.outer;
	}
	,__class__: nape.constraint.PivotJoint
});
nape.constraint.PulleyJoint = function(body1,body2,body3,body4,anchor1,anchor2,anchor3,anchor4,jointMin,jointMax,ratio) {
	if(ratio == null) ratio = 1.0;
	this.zpp_inner_zn = null;
	this.zpp_inner_zn = new zpp_nape.constraint.ZPP_PulleyJoint();
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner.outer = this;
	this.zpp_inner_zn.outer_zn = this;
	try {
		nape.constraint.Constraint.call(this);
	} catch( e ) {
	}
	this.set_body1(body1);
	this.set_body2(body2);
	this.set_body3(body3);
	this.set_body4(body4);
	this.set_anchor1(anchor1);
	this.set_anchor2(anchor2);
	this.set_anchor3(anchor3);
	this.set_anchor4(anchor4);
	this.set_ratio(ratio);
	this.set_jointMin(jointMin);
	this.set_jointMax(jointMax);
};
$hxClasses["nape.constraint.PulleyJoint"] = nape.constraint.PulleyJoint;
nape.constraint.PulleyJoint.__name__ = ["nape","constraint","PulleyJoint"];
nape.constraint.PulleyJoint.__super__ = nape.constraint.Constraint;
nape.constraint.PulleyJoint.prototype = $extend(nape.constraint.Constraint.prototype,{
	visitBodies: function(lambda) {
		if(this.get_body1() != null) lambda(this.get_body1());
		if(this.get_body2() != null && this.get_body2() != this.get_body1()) lambda(this.get_body2());
		if(this.get_body3() != null && this.get_body3() != this.get_body1() && this.get_body3() != this.get_body2()) lambda(this.get_body3());
		if(this.get_body4() != null && this.get_body4() != this.get_body1() && this.get_body4() != this.get_body2() && this.get_body4() != this.get_body3()) lambda(this.get_body4());
	}
	,bodyImpulse: function(body) {
		if(body == null) throw "Error: Cannot evaluate impulse on null body";
		if(body != this.get_body1() && body != this.get_body2() && body != this.get_body3() && body != this.get_body4()) throw "Error: Body is not linked to this constraint";
		if(!this.get_active()) return nape.geom.Vec3.get(); else return this.zpp_inner_zn.bodyImpulse(body.zpp_inner);
	}
	,impulse: function() {
		var ret = new nape.geom.MatMN(1,1);
		ret.setx(0,0,this.zpp_inner_zn.jAcc);
		return ret;
	}
	,set_ratio: function(ratio) {
		this.zpp_inner.immutable_midstep("PulleyJoint::ratio");
		if(ratio != ratio) throw "Error: PulleyJoint::ratio cannot be NaN";
		if(this.get_ratio() != ratio) {
			this.zpp_inner_zn.ratio = ratio;
			this.zpp_inner.wake();
		}
		return this.get_ratio();
	}
	,get_ratio: function() {
		return this.zpp_inner_zn.ratio;
	}
	,set_jointMax: function(jointMax) {
		this.zpp_inner.immutable_midstep("PulleyJoint::jointMax");
		if(jointMax != jointMax) throw "Error: PulleyJoint::jointMax cannot be NaN";
		if(jointMax < 0) throw "Error: PulleyJoint::jointMax must be >= 0";
		if(this.get_jointMax() != jointMax) {
			this.zpp_inner_zn.jointMax = jointMax;
			this.zpp_inner.wake();
		}
		return this.get_jointMax();
	}
	,get_jointMax: function() {
		return this.zpp_inner_zn.jointMax;
	}
	,set_jointMin: function(jointMin) {
		this.zpp_inner.immutable_midstep("PulleyJoint::jointMin");
		if(jointMin != jointMin) throw "Error: PulleyJoint::jointMin cannot be NaN";
		if(jointMin < 0) throw "Error: PulleyJoint::jointMin must be >= 0";
		if(this.get_jointMin() != jointMin) {
			this.zpp_inner_zn.jointMin = jointMin;
			this.zpp_inner.wake();
		}
		return this.get_jointMin();
	}
	,get_jointMin: function() {
		return this.zpp_inner_zn.jointMin;
	}
	,set_anchor4: function(anchor4) {
		if(anchor4 != null && anchor4.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor4 == null) throw "Error: Constraint::" + "anchor4" + " cannot be null";
		this.get_anchor4().set(anchor4);
		return this.get_anchor4();
	}
	,get_anchor4: function() {
		if(this.zpp_inner_zn.wrap_a4 == null) this.zpp_inner_zn.setup_a4();
		return this.zpp_inner_zn.wrap_a4;
	}
	,set_anchor3: function(anchor3) {
		if(anchor3 != null && anchor3.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor3 == null) throw "Error: Constraint::" + "anchor3" + " cannot be null";
		this.get_anchor3().set(anchor3);
		return this.get_anchor3();
	}
	,get_anchor3: function() {
		if(this.zpp_inner_zn.wrap_a3 == null) this.zpp_inner_zn.setup_a3();
		return this.zpp_inner_zn.wrap_a3;
	}
	,set_anchor2: function(anchor2) {
		if(anchor2 != null && anchor2.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor2 == null) throw "Error: Constraint::" + "anchor2" + " cannot be null";
		this.get_anchor2().set(anchor2);
		return this.get_anchor2();
	}
	,get_anchor2: function() {
		if(this.zpp_inner_zn.wrap_a2 == null) this.zpp_inner_zn.setup_a2();
		return this.zpp_inner_zn.wrap_a2;
	}
	,set_anchor1: function(anchor1) {
		if(anchor1 != null && anchor1.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(anchor1 == null) throw "Error: Constraint::" + "anchor1" + " cannot be null";
		this.get_anchor1().set(anchor1);
		return this.get_anchor1();
	}
	,get_anchor1: function() {
		if(this.zpp_inner_zn.wrap_a1 == null) this.zpp_inner_zn.setup_a1();
		return this.zpp_inner_zn.wrap_a1;
	}
	,set_body4: function(body4) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body4");
		var inbody4 = body4 == null?null:body4.zpp_inner;
		if(inbody4 != this.zpp_inner_zn.b4) {
			if(this.zpp_inner_zn.b4 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b1 != this.zpp_inner_zn.b4 && this.zpp_inner_zn.b2 != this.zpp_inner_zn.b4 && this.zpp_inner_zn.b3 != this.zpp_inner_zn.b4) {
					if(this.zpp_inner_zn.b4 != null) this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b4.wake();
			}
			this.zpp_inner_zn.b4 = inbody4;
			if(this.get_space() != null && inbody4 != null && this.zpp_inner_zn.b1 != inbody4 && this.zpp_inner_zn.b2 != inbody4 && this.zpp_inner_zn.b3 != inbody4) {
				if(inbody4 != null) inbody4.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody4 != null) inbody4.wake();
			}
		}
		return this.get_body4();
	}
	,get_body4: function() {
		return this.zpp_inner_zn.b4 == null?null:this.zpp_inner_zn.b4.outer;
	}
	,set_body3: function(body3) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body3");
		var inbody3 = body3 == null?null:body3.zpp_inner;
		if(inbody3 != this.zpp_inner_zn.b3) {
			if(this.zpp_inner_zn.b3 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b1 != this.zpp_inner_zn.b3 && this.zpp_inner_zn.b2 != this.zpp_inner_zn.b3 && this.zpp_inner_zn.b4 != this.zpp_inner_zn.b3) {
					if(this.zpp_inner_zn.b3 != null) this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b3.wake();
			}
			this.zpp_inner_zn.b3 = inbody3;
			if(this.get_space() != null && inbody3 != null && this.zpp_inner_zn.b1 != inbody3 && this.zpp_inner_zn.b2 != inbody3 && this.zpp_inner_zn.b4 != inbody3) {
				if(inbody3 != null) inbody3.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody3 != null) inbody3.wake();
			}
		}
		return this.get_body3();
	}
	,get_body3: function() {
		return this.zpp_inner_zn.b3 == null?null:this.zpp_inner_zn.b3.outer;
	}
	,set_body2: function(body2) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body2");
		var inbody2 = body2 == null?null:body2.zpp_inner;
		if(inbody2 != this.zpp_inner_zn.b2) {
			if(this.zpp_inner_zn.b2 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b1 != this.zpp_inner_zn.b2 && this.zpp_inner_zn.b3 != this.zpp_inner_zn.b2 && this.zpp_inner_zn.b4 != this.zpp_inner_zn.b2) {
					if(this.zpp_inner_zn.b2 != null) this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b2.wake();
			}
			this.zpp_inner_zn.b2 = inbody2;
			if(this.get_space() != null && inbody2 != null && this.zpp_inner_zn.b1 != inbody2 && this.zpp_inner_zn.b3 != inbody2 && this.zpp_inner_zn.b4 != inbody2) {
				if(inbody2 != null) inbody2.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody2 != null) inbody2.wake();
			}
		}
		return this.get_body2();
	}
	,get_body2: function() {
		return this.zpp_inner_zn.b2 == null?null:this.zpp_inner_zn.b2.outer;
	}
	,set_body1: function(body1) {
		this.zpp_inner.immutable_midstep("Constraint::" + "body1");
		var inbody1 = body1 == null?null:body1.zpp_inner;
		if(inbody1 != this.zpp_inner_zn.b1) {
			if(this.zpp_inner_zn.b1 != null) {
				if(this.get_space() != null && this.zpp_inner_zn.b2 != this.zpp_inner_zn.b1 && this.zpp_inner_zn.b3 != this.zpp_inner_zn.b1 && this.zpp_inner_zn.b4 != this.zpp_inner_zn.b1) {
					if(this.zpp_inner_zn.b1 != null) this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner);
				}
				if(this.get_active() && this.get_space() != null) this.zpp_inner_zn.b1.wake();
			}
			this.zpp_inner_zn.b1 = inbody1;
			if(this.get_space() != null && inbody1 != null && this.zpp_inner_zn.b2 != inbody1 && this.zpp_inner_zn.b3 != inbody1 && this.zpp_inner_zn.b4 != inbody1) {
				if(inbody1 != null) inbody1.constraints.add(this.zpp_inner);
			}
			if(this.get_active() && this.get_space() != null) {
				this.zpp_inner.wake();
				if(inbody1 != null) inbody1.wake();
			}
		}
		return this.get_body1();
	}
	,get_body1: function() {
		return this.zpp_inner_zn.b1 == null?null:this.zpp_inner_zn.b1.outer;
	}
	,__class__: nape.constraint.PulleyJoint
});
nape.constraint.UserConstraint = function() {
	this.zpp_inner_zn = null;
};
$hxClasses["nape.constraint.UserConstraint"] = nape.constraint.UserConstraint;
nape.constraint.UserConstraint.__name__ = ["nape","constraint","UserConstraint"];
nape.constraint.UserConstraint.__super__ = nape.constraint.Constraint;
nape.constraint.UserConstraint.prototype = $extend(nape.constraint.Constraint.prototype,{
	visitBodies: function(lambda) {
		var i = 0;
		var nbodies = this.zpp_inner_zn.bodies.length;
		while(i < nbodies) {
			var b = this.zpp_inner_zn.bodies[i];
			if(b.body != null) {
				var found = false;
				var _g = i + 1;
				while(_g < nbodies) {
					var j = _g++;
					var c = this.zpp_inner_zn.bodies[j];
					if(c.body == b.body) {
						found = true;
						break;
					}
				}
				if(!found) lambda(b.body.outer);
			}
			i++;
		}
	}
	,bodyImpulse: function(body) {
		if(body == null) throw "Error: Cannot evaluate impulse on null body";
		var found = false;
		var _g = 0, _g1 = this.zpp_inner_zn.bodies;
		while(_g < _g1.length) {
			var b = _g1[_g];
			++_g;
			if(b.body == body.zpp_inner) {
				found = true;
				break;
			}
		}
		if(!found) throw "Error: Body is not linked to this constraint";
		if(!this.get_active()) return nape.geom.Vec3.get(); else return this.zpp_inner_zn.bodyImpulse(body.zpp_inner);
	}
	,impulse: function() {
		var ret = new nape.geom.MatMN(this.zpp_inner_zn.dim,1);
		var _g1 = 0, _g = this.zpp_inner_zn.dim;
		while(_g1 < _g) {
			var i = _g1++;
			ret.setx(i,0,this.zpp_inner_zn.jAcc[i]);
		}
		return ret;
	}
	,__impulse: function(imp,body,out) {
		throw "Error: UserConstraint::__impulse must be overriden";
	}
	,__clamp: function(jAcc) {
	}
	,__eff_mass: function(eff) {
		throw "Error: UserConstraint::__eff_mass must be overriden";
	}
	,__velocity: function(err) {
		throw "Error: Userconstraint::__velocity must be overriden";
	}
	,__position: function(err) {
		throw "Error: UserConstraint::__position must be overriden";
	}
	,__prepare: function() {
	}
	,__draw: function(debug) {
	}
	,__validate: function() {
	}
	,__broken: function() {
	}
	,__copy: function() {
		throw "Error: UserConstraint::__copy must be overriden";
		return null;
	}
	,__class__: nape.constraint.UserConstraint
});
nape.constraint.WeldJoint = function() {
	this.zpp_inner_zn = null;
};
$hxClasses["nape.constraint.WeldJoint"] = nape.constraint.WeldJoint;
nape.constraint.WeldJoint.__name__ = ["nape","constraint","WeldJoint"];
nape.constraint.WeldJoint.__super__ = nape.constraint.Constraint;
nape.constraint.WeldJoint.prototype = $extend(nape.constraint.Constraint.prototype,{
	visitBodies: function(lambda) {
		if(this.get_body1() != null) lambda(this.get_body1());
		if(this.get_body2() != null && this.get_body2() != this.get_body1()) lambda(this.get_body2());
	}
	,bodyImpulse: function(body) {
		if(body == null) throw "Error: Cannot evaluate impulse on null body";
		if(body != this.get_body1() && body != this.get_body2()) throw "Error: Body is not linked to this constraint";
		if(!this.get_active()) return nape.geom.Vec3.get(); else return this.zpp_inner_zn.bodyImpulse(body.zpp_inner);
	}
	,impulse: function() {
		var ret = new nape.geom.MatMN(3,1);
		ret.setx(0,0,this.zpp_inner_zn.jAccx);
		ret.setx(1,0,this.zpp_inner_zn.jAccy);
		ret.setx(1,0,this.zpp_inner_zn.jAccz);
		return ret;
	}
	,get_phase: function() {
		return this.zpp_inner_zn.phase;
	}
	,get_anchor2: function() {
		if(this.zpp_inner_zn.wrap_a2 == null) this.zpp_inner_zn.setup_a2();
		return this.zpp_inner_zn.wrap_a2;
	}
	,get_anchor1: function() {
		if(this.zpp_inner_zn.wrap_a1 == null) this.zpp_inner_zn.setup_a1();
		return this.zpp_inner_zn.wrap_a1;
	}
	,get_body2: function() {
		return this.zpp_inner_zn.b2 == null?null:this.zpp_inner_zn.b2.outer;
	}
	,get_body1: function() {
		return this.zpp_inner_zn.b1 == null?null:this.zpp_inner_zn.b1.outer;
	}
	,__class__: nape.constraint.WeldJoint
});
nape.dynamics = {}
nape.dynamics.Arbiter = function() {
	this.zpp_inner = null;
	if(!zpp_nape.dynamics.ZPP_Arbiter.internal) throw "Error: Cannot instantiate Arbiter derp!";
};
$hxClasses["nape.dynamics.Arbiter"] = nape.dynamics.Arbiter;
nape.dynamics.Arbiter.__name__ = ["nape","dynamics","Arbiter"];
nape.dynamics.Arbiter.prototype = {
	toString: function() {
		var ret = this.isCollisionArbiter()?"CollisionArbiter":this.isFluidArbiter()?"FluidArbiter":"SensorArbiter";
		if(this.zpp_inner.cleared) return ret + "(object-pooled)"; else return ret + "(" + this.get_shape1().toString() + "|" + this.get_shape2().toString() + ")" + (this.isCollisionArbiter()?"[" + ["SD","DD"][this.zpp_inner.colarb.stat?0:1] + "]":"") + "<-" + this.get_state().toString();
	}
	,totalImpulse: function(body,freshOnly) {
		if(freshOnly == null) freshOnly = false;
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		if(body != null && body != this.get_body1() && body != this.get_body2()) throw "Error: Arbiter does not relate to body";
		return nape.geom.Vec3.get(0,0,0);
	}
	,get_state: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		return (function($this) {
			var $r;
			switch($this.zpp_inner.immState) {
			case zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT | zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS:
				$r = nape.callbacks.PreFlag.get_ACCEPT();
				break;
			case zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT:
				$r = nape.callbacks.PreFlag.get_ACCEPT_ONCE();
				break;
			case zpp_nape.util.ZPP_Flags.id_ImmState_IGNORE | zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS:
				$r = nape.callbacks.PreFlag.get_IGNORE();
				break;
			default:
				$r = nape.callbacks.PreFlag.get_IGNORE_ONCE();
			}
			return $r;
		}(this));
	}
	,get_body2: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		return this.zpp_inner.ws1.id > this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer;
	}
	,get_body1: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		return this.zpp_inner.ws1.id > this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer;
	}
	,get_shape2: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		return this.zpp_inner.ws1.id > this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer;
	}
	,get_shape1: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		return this.zpp_inner.ws1.id > this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer;
	}
	,get_collisionArbiter: function() {
		return this.isCollisionArbiter()?this.zpp_inner.colarb.outer_zn:null;
	}
	,isFluidArbiter: function() {
		return this.zpp_inner.type == zpp_nape.dynamics.ZPP_Arbiter.FLUID;
	}
	,isCollisionArbiter: function() {
		return this.zpp_inner.type == zpp_nape.dynamics.ZPP_Arbiter.COL;
	}
	,__class__: nape.dynamics.Arbiter
}
nape.dynamics.ArbiterIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_ArbiterList.internal) throw "Error: Cannot instantiate " + "Arbiter" + "Iterator derp!";
};
$hxClasses["nape.dynamics.ArbiterIterator"] = nape.dynamics.ArbiterIterator;
nape.dynamics.ArbiterIterator.__name__ = ["nape","dynamics","ArbiterIterator"];
nape.dynamics.ArbiterIterator.get = function(list) {
	var ret = nape.dynamics.ArbiterIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_ArbiterList.internal = true;
		var ret1 = new nape.dynamics.ArbiterIterator();
		zpp_nape.util.ZPP_ArbiterList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.dynamics.ArbiterIterator.zpp_pool;
		nape.dynamics.ArbiterIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.dynamics.ArbiterIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.dynamics.ArbiterIterator.zpp_pool;
			nape.dynamics.ArbiterIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.dynamics.ArbiterIterator
}
nape.dynamics.ArbiterList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_ArbiterList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.dynamics.ArbiterList"] = nape.dynamics.ArbiterList;
nape.dynamics.ArbiterList.__name__ = ["nape","dynamics","ArbiterList"];
nape.dynamics.ArbiterList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_vm();
		return nape.dynamics.ArbiterIterator.get(this);
	}
	,empty: function() {
		return this.get_length() == 0;
	}
	,clear: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Arbiter" + "List is immutable";
		if(this.zpp_inner.reverse_flag) while(!this.empty()) this.pop(); else while(!this.empty()) this.shift();
	}
	,remove: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Arbiter" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_vm();
		var ret;
		ret = false;
		var cx_ite = this.zpp_inner.inner.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(x == obj.zpp_inner) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(ret) {
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(obj);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.remove(obj.zpp_inner);
			this.zpp_inner.invalidate();
		}
		return ret;
	}
	,shift: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Arbiter" + "List is immutable";
		this.zpp_inner.modify_test();
		if(this.empty()) throw "Error: Cannot remove from empty list";
		this.zpp_vm();
		var ret = null;
		if(this.zpp_inner.reverse_flag) {
			if(this.zpp_inner.at_ite != null && this.zpp_inner.at_ite.next == null) this.zpp_inner.at_ite = null;
			var ite = this.get_length() == 1?null:this.zpp_inner.inner.iterator_at(this.get_length() - 2);
			ret = ite == null?this.zpp_inner.inner.front():ite.next.elem();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.erase(ite);
		} else {
			ret = this.zpp_inner.inner.front();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.pop();
		}
		this.zpp_inner.invalidate();
		var retx = ret.wrapper();
		return retx;
	}
	,pop: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Arbiter" + "List is immutable";
		this.zpp_inner.modify_test();
		if(this.empty()) throw "Error: Cannot remove from empty list";
		this.zpp_vm();
		var ret = null;
		if(this.zpp_inner.reverse_flag) {
			ret = this.zpp_inner.inner.front();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.pop();
		} else {
			if(this.zpp_inner.at_ite != null && this.zpp_inner.at_ite.next == null) this.zpp_inner.at_ite = null;
			var ite = this.get_length() == 1?null:this.zpp_inner.inner.iterator_at(this.get_length() - 2);
			ret = ite == null?this.zpp_inner.inner.front():ite.next.elem();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.erase(ite);
		}
		this.zpp_inner.invalidate();
		var retx = ret.wrapper();
		return retx;
	}
	,unshift: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Arbiter" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_vm();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			} else this.zpp_inner.inner.add(obj.zpp_inner);
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,push: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Arbiter" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_vm();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) this.zpp_inner.inner.add(obj.zpp_inner); else {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			}
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,at: function(index) {
		this.zpp_vm();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!true) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(x.active) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(x.active) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().wrapper();
	}
	,zpp_vm: function() {
		this.zpp_inner.valmod();
	}
	,zpp_gl: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(true) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(i.active) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,get_length: function() {
		return this.zpp_gl();
	}
	,__class__: nape.dynamics.ArbiterList
}
nape.dynamics.ArbiterType = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "ArbiterType" + " derp!";
};
$hxClasses["nape.dynamics.ArbiterType"] = nape.dynamics.ArbiterType;
nape.dynamics.ArbiterType.__name__ = ["nape","dynamics","ArbiterType"];
nape.dynamics.ArbiterType.get_COLLISION = function() {
	if(zpp_nape.util.ZPP_Flags.ArbiterType_COLLISION == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ArbiterType_COLLISION = new nape.dynamics.ArbiterType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ArbiterType_COLLISION;
}
nape.dynamics.ArbiterType.get_SENSOR = function() {
	if(zpp_nape.util.ZPP_Flags.ArbiterType_SENSOR == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ArbiterType_SENSOR = new nape.dynamics.ArbiterType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ArbiterType_SENSOR;
}
nape.dynamics.ArbiterType.get_FLUID = function() {
	if(zpp_nape.util.ZPP_Flags.ArbiterType_FLUID == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ArbiterType_FLUID = new nape.dynamics.ArbiterType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ArbiterType_FLUID;
}
nape.dynamics.ArbiterType.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.dynamics.ArbiterType.get_COLLISION()) return "COLLISION"; else if(this == nape.dynamics.ArbiterType.get_SENSOR()) return "SENSOR"; else if(this == nape.dynamics.ArbiterType.get_FLUID()) return "FLUID"; else return "";
	}
	,__class__: nape.dynamics.ArbiterType
}
nape.dynamics.CollisionArbiter = function() {
	if(!zpp_nape.dynamics.ZPP_Arbiter.internal) throw "Error: Cannot instantiate CollisionArbiter derp!";
	nape.dynamics.Arbiter.call(this);
};
$hxClasses["nape.dynamics.CollisionArbiter"] = nape.dynamics.CollisionArbiter;
nape.dynamics.CollisionArbiter.__name__ = ["nape","dynamics","CollisionArbiter"];
nape.dynamics.CollisionArbiter.__super__ = nape.dynamics.Arbiter;
nape.dynamics.CollisionArbiter.prototype = $extend(nape.dynamics.Arbiter.prototype,{
	get_rollingFriction: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		var colarb = this.zpp_inner.colarb;
		colarb.validate_props();
		return colarb.rfric;
	}
	,get_staticFriction: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		var colarb = this.zpp_inner.colarb;
		colarb.validate_props();
		return colarb.stat_fric;
	}
	,get_dynamicFriction: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		var colarb = this.zpp_inner.colarb;
		colarb.validate_props();
		return colarb.dyn_fric;
	}
	,get_elasticity: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		var colarb = this.zpp_inner.colarb;
		colarb.validate_props();
		return colarb.restitution;
	}
	,totalImpulse: function(body,freshOnly) {
		if(freshOnly == null) freshOnly = false;
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		if(body != null && body != this.get_body1() && body != this.get_body2()) throw "Error: Arbiter does not relate to body";
		var retx = 0;
		var rety = 0;
		var retz = 0;
		var colarb = this.zpp_inner.colarb;
		if(!freshOnly || colarb.oc1.fresh) {
			var imp = colarb.oc1.wrapper().totalImpulse(body);
			var t = 1;
			var t1 = t;
			retx += imp.get_x() * t1;
			rety += imp.get_y() * t1;
			retz += imp.get_z() * t;
			imp.dispose();
		}
		if(colarb.hc2) {
			if(!freshOnly || colarb.oc2.fresh) {
				var imp = colarb.oc2.wrapper().totalImpulse(body);
				var t = 1;
				var t1 = t;
				retx += imp.get_x() * t1;
				rety += imp.get_y() * t1;
				retz += imp.get_z() * t;
				imp.dispose();
			}
		}
		return nape.geom.Vec3.get(retx,rety,retz);
	}
	,__class__: nape.dynamics.CollisionArbiter
});
nape.dynamics.Contact = function() {
	this.zpp_inner = null;
	if(!zpp_nape.dynamics.ZPP_Contact.internal) throw "Error: Cannot instantiate Contact derp!";
};
$hxClasses["nape.dynamics.Contact"] = nape.dynamics.Contact;
nape.dynamics.Contact.__name__ = ["nape","dynamics","Contact"];
nape.dynamics.Contact.prototype = {
	toString: function() {
		if(this.zpp_inner.arbiter == null || this.zpp_inner.arbiter.cleared) return "{object-pooled}"; else return "{Contact}";
	}
	,totalImpulse: function(body) {
		if(this.zpp_inner.inactiveme()) throw "Error: Contact not currently in use";
		var colarb = this.zpp_inner.arbiter.colarb;
		var cin = this.zpp_inner.inner;
		var jnAcc = cin.jnAcc;
		var jtAcc = cin.jtAcc;
		var jrAcc = colarb.jrAcc;
		if(body == null) return nape.geom.Vec3.get(colarb.nx * jnAcc - colarb.ny * jtAcc,colarb.ny * jnAcc + colarb.nx * jtAcc,jrAcc); else {
			if(body != colarb.b1.outer && body != colarb.b2.outer) throw "Error: Contact does not relate to the given body";
			var jx = colarb.nx * jnAcc - colarb.ny * jtAcc;
			var jy = colarb.ny * jnAcc + colarb.nx * jtAcc;
			if(body == colarb.b1.outer) return nape.geom.Vec3.get(-jx,-jy,-(jy * cin.r1x - jx * cin.r1y) - jrAcc); else return nape.geom.Vec3.get(jx,jy,jy * cin.r2x - jx * cin.r2y + jrAcc);
		}
	}
	,__class__: nape.dynamics.Contact
}
nape.dynamics.ContactIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_ContactList.internal) throw "Error: Cannot instantiate " + "Contact" + "Iterator derp!";
};
$hxClasses["nape.dynamics.ContactIterator"] = nape.dynamics.ContactIterator;
nape.dynamics.ContactIterator.__name__ = ["nape","dynamics","ContactIterator"];
nape.dynamics.ContactIterator.get = function(list) {
	var ret = nape.dynamics.ContactIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_ContactList.internal = true;
		var ret1 = new nape.dynamics.ContactIterator();
		zpp_nape.util.ZPP_ContactList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.dynamics.ContactIterator.zpp_pool;
		nape.dynamics.ContactIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.dynamics.ContactIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.dynamics.ContactIterator.zpp_pool;
			nape.dynamics.ContactIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.dynamics.ContactIterator
}
nape.dynamics.ContactList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_ContactList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.dynamics.ContactList"] = nape.dynamics.ContactList;
nape.dynamics.ContactList.__name__ = ["nape","dynamics","ContactList"];
nape.dynamics.ContactList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.dynamics.ContactIterator.get(this);
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!true) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(x.active && x.arbiter.active) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(x.active && x.arbiter.active) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().wrapper();
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(true) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(i.active && i.arbiter.active) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.dynamics.ContactList
}
nape.dynamics.FluidArbiter = function() {
	if(!zpp_nape.dynamics.ZPP_Arbiter.internal) throw "Error: Cannot instantiate FluidArbiter derp!";
	nape.dynamics.Arbiter.call(this);
};
$hxClasses["nape.dynamics.FluidArbiter"] = nape.dynamics.FluidArbiter;
nape.dynamics.FluidArbiter.__name__ = ["nape","dynamics","FluidArbiter"];
nape.dynamics.FluidArbiter.__super__ = nape.dynamics.Arbiter;
nape.dynamics.FluidArbiter.prototype = $extend(nape.dynamics.Arbiter.prototype,{
	totalImpulse: function(body,freshOnly) {
		if(freshOnly == null) freshOnly = false;
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		if(body != null && body != this.get_body1() && body != this.get_body2()) throw "Error: Arbiter does not relate to body";
		var tmp = this.buoyancyImpulse(body);
		var ret = this.dragImpulse(body);
		var _g = ret;
		_g.set_x(_g.get_x() + tmp.get_x());
		var _g = ret;
		_g.set_y(_g.get_y() + tmp.get_y());
		var _g = ret;
		_g.set_z(_g.get_z() + tmp.get_z());
		tmp.dispose();
		return ret;
	}
	,dragImpulse: function(body) {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		if(body != null && body != this.get_body1() && body != this.get_body2()) throw "Error: Arbiter does not relate to body";
		var farb = this.zpp_inner.fluidarb;
		var scale = body == null || body.zpp_inner == this.zpp_inner.b2?1:-1;
		return nape.geom.Vec3.get(farb.dampx * scale,farb.dampy * scale,farb.adamp * scale);
	}
	,buoyancyImpulse: function(body) {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		if(body != null && body != this.get_body1() && body != this.get_body2()) throw "Error: Arbiter does not relate to body";
		var farb = this.zpp_inner.fluidarb;
		if(body == null) return nape.geom.Vec3.get(farb.buoyx,farb.buoyy,0); else if(body.zpp_inner == this.zpp_inner.b2) return nape.geom.Vec3.get(farb.buoyx,farb.buoyy,farb.buoyy * farb.r2x - farb.buoyx * farb.r2y); else return nape.geom.Vec3.get(-farb.buoyx,-farb.buoyy,-(farb.buoyy * farb.r1x - farb.buoyx * farb.r1y));
	}
	,get_overlap: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		return this.zpp_inner.fluidarb.overlap;
	}
	,get_position: function() {
		if(this.zpp_inner.inactiveme()) throw "Error: Arbiter not currently in use";
		if(this.zpp_inner.fluidarb.wrap_position == null) this.zpp_inner.fluidarb.getposition();
		return this.zpp_inner.fluidarb.wrap_position;
	}
	,__class__: nape.dynamics.FluidArbiter
});
nape.dynamics.InteractionFilter = function(collisionGroup,collisionMask,sensorGroup,sensorMask,fluidGroup,fluidMask) {
	if(fluidMask == null) fluidMask = -1;
	if(fluidGroup == null) fluidGroup = 1;
	if(sensorMask == null) sensorMask = -1;
	if(sensorGroup == null) sensorGroup = 1;
	if(collisionMask == null) collisionMask = -1;
	if(collisionGroup == null) collisionGroup = 1;
	this.zpp_inner = null;
	if(zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool == null) this.zpp_inner = new zpp_nape.dynamics.ZPP_InteractionFilter(); else {
		this.zpp_inner = zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool;
		zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool = this.zpp_inner.next;
		this.zpp_inner.next = null;
	}
	this.zpp_inner.alloc();
	this.zpp_inner.outer = this;
	this.set_collisionGroup(collisionGroup);
	this.set_collisionMask(collisionMask);
	this.set_sensorGroup(sensorGroup);
	this.set_sensorMask(sensorMask);
	this.set_fluidGroup(fluidGroup);
	this.set_fluidMask(fluidMask);
};
$hxClasses["nape.dynamics.InteractionFilter"] = nape.dynamics.InteractionFilter;
nape.dynamics.InteractionFilter.__name__ = ["nape","dynamics","InteractionFilter"];
nape.dynamics.InteractionFilter.prototype = {
	set_fluidMask: function(fluidMask) {
		if(this.get_fluidMask() != fluidMask) {
			this.zpp_inner.fluidMask = fluidMask;
			this.zpp_inner.invalidate();
		}
		return this.get_fluidMask();
	}
	,get_fluidMask: function() {
		return this.zpp_inner.fluidMask;
	}
	,set_fluidGroup: function(fluidGroup) {
		if(this.get_fluidGroup() != fluidGroup) {
			this.zpp_inner.fluidGroup = fluidGroup;
			this.zpp_inner.invalidate();
		}
		return this.get_fluidGroup();
	}
	,get_fluidGroup: function() {
		return this.zpp_inner.fluidGroup;
	}
	,set_sensorMask: function(sensorMask) {
		if(this.get_sensorMask() != sensorMask) {
			this.zpp_inner.sensorMask = sensorMask;
			this.zpp_inner.invalidate();
		}
		return this.get_sensorMask();
	}
	,get_sensorMask: function() {
		return this.zpp_inner.sensorMask;
	}
	,set_sensorGroup: function(sensorGroup) {
		if(this.get_sensorGroup() != sensorGroup) {
			this.zpp_inner.sensorGroup = sensorGroup;
			this.zpp_inner.invalidate();
		}
		return this.get_sensorGroup();
	}
	,get_sensorGroup: function() {
		return this.zpp_inner.sensorGroup;
	}
	,set_collisionMask: function(collisionMask) {
		if(this.get_collisionMask() != collisionMask) {
			this.zpp_inner.collisionMask = collisionMask;
			this.zpp_inner.invalidate();
		}
		return this.get_collisionMask();
	}
	,get_collisionMask: function() {
		return this.zpp_inner.collisionMask;
	}
	,set_collisionGroup: function(collisionGroup) {
		if(this.get_collisionGroup() != collisionGroup) {
			this.zpp_inner.collisionGroup = collisionGroup;
			this.zpp_inner.invalidate();
		}
		return this.get_collisionGroup();
	}
	,get_collisionGroup: function() {
		return this.zpp_inner.collisionGroup;
	}
	,__class__: nape.dynamics.InteractionFilter
}
nape.dynamics.InteractionGroup = function() {
	this.zpp_inner = null;
};
$hxClasses["nape.dynamics.InteractionGroup"] = nape.dynamics.InteractionGroup;
nape.dynamics.InteractionGroup.__name__ = ["nape","dynamics","InteractionGroup"];
nape.dynamics.InteractionGroup.prototype = {
	toString: function() {
		var ret = "InteractionGroup";
		if(this.get_ignore()) ret += ":ignore";
		return ret;
	}
	,get_ignore: function() {
		return this.zpp_inner.ignore;
	}
	,get_group: function() {
		return this.zpp_inner.group == null?null:this.zpp_inner.group.outer;
	}
	,__class__: nape.dynamics.InteractionGroup
}
nape.dynamics.InteractionGroupIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_InteractionGroupList.internal) throw "Error: Cannot instantiate " + "InteractionGroup" + "Iterator derp!";
};
$hxClasses["nape.dynamics.InteractionGroupIterator"] = nape.dynamics.InteractionGroupIterator;
nape.dynamics.InteractionGroupIterator.__name__ = ["nape","dynamics","InteractionGroupIterator"];
nape.dynamics.InteractionGroupIterator.get = function(list) {
	var ret = nape.dynamics.InteractionGroupIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_InteractionGroupList.internal = true;
		var ret1 = new nape.dynamics.InteractionGroupIterator();
		zpp_nape.util.ZPP_InteractionGroupList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.dynamics.InteractionGroupIterator.zpp_pool;
		nape.dynamics.InteractionGroupIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.dynamics.InteractionGroupIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.dynamics.InteractionGroupIterator.zpp_pool;
			nape.dynamics.InteractionGroupIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.dynamics.InteractionGroupIterator
}
nape.dynamics.InteractionGroupList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_InteractionGroupList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.dynamics.InteractionGroupList"] = nape.dynamics.InteractionGroupList;
nape.dynamics.InteractionGroupList.__name__ = ["nape","dynamics","InteractionGroupList"];
nape.dynamics.InteractionGroupList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.dynamics.InteractionGroupIterator.get(this);
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().outer;
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.dynamics.InteractionGroupList
}
nape.geom = {}
nape.geom.AABB = function(x,y,width,height) {
	if(height == null) height = 0;
	if(width == null) width = 0;
	if(y == null) y = 0;
	if(x == null) x = 0;
	this.zpp_inner = null;
	if(x != x || y != y) throw "Error: AABB position cannot be NaN";
	if(width != width || height != height) throw "Error: AABB dimensions cannot be NaN";
	this.zpp_inner = zpp_nape.geom.ZPP_AABB.get(x,y,x + width,y + height);
	this.zpp_inner.outer = this;
};
$hxClasses["nape.geom.AABB"] = nape.geom.AABB;
nape.geom.AABB.__name__ = ["nape","geom","AABB"];
nape.geom.AABB.prototype = {
	toString: function() {
		this.zpp_inner.validate();
		return this.zpp_inner.toString();
	}
	,get_height: function() {
		this.zpp_inner.validate();
		return this.zpp_inner.height();
	}
	,get_width: function() {
		this.zpp_inner.validate();
		return this.zpp_inner.width();
	}
	,get_y: function() {
		this.zpp_inner.validate();
		return this.zpp_inner.miny;
	}
	,get_x: function() {
		this.zpp_inner.validate();
		return this.zpp_inner.minx;
	}
	,get_max: function() {
		return this.zpp_inner.getmax();
	}
	,get_min: function() {
		return this.zpp_inner.getmin();
	}
	,__class__: nape.geom.AABB
}
nape.geom.ConvexResult = function() {
	this.zpp_inner = null;
};
$hxClasses["nape.geom.ConvexResult"] = nape.geom.ConvexResult;
nape.geom.ConvexResult.__name__ = ["nape","geom","ConvexResult"];
nape.geom.ConvexResult.prototype = {
	toString: function() {
		this.zpp_inner.disposed();
		return "{ shape: " + Std.string(this.get_shape()) + " toi: " + this.get_toi() + " }";
	}
	,get_shape: function() {
		this.zpp_inner.disposed();
		return this.zpp_inner.shape;
	}
	,get_toi: function() {
		this.zpp_inner.disposed();
		return this.zpp_inner.toiDistance;
	}
	,__class__: nape.geom.ConvexResult
}
nape.geom.ConvexResultIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_ConvexResultList.internal) throw "Error: Cannot instantiate " + "ConvexResult" + "Iterator derp!";
};
$hxClasses["nape.geom.ConvexResultIterator"] = nape.geom.ConvexResultIterator;
nape.geom.ConvexResultIterator.__name__ = ["nape","geom","ConvexResultIterator"];
nape.geom.ConvexResultIterator.get = function(list) {
	var ret = nape.geom.ConvexResultIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_ConvexResultList.internal = true;
		var ret1 = new nape.geom.ConvexResultIterator();
		zpp_nape.util.ZPP_ConvexResultList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.geom.ConvexResultIterator.zpp_pool;
		nape.geom.ConvexResultIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.geom.ConvexResultIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.geom.ConvexResultIterator.zpp_pool;
			nape.geom.ConvexResultIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.geom.ConvexResultIterator
}
nape.geom.ConvexResultList = function() {
	this.zpp_inner = null;
};
$hxClasses["nape.geom.ConvexResultList"] = nape.geom.ConvexResultList;
nape.geom.ConvexResultList.__name__ = ["nape","geom","ConvexResultList"];
nape.geom.ConvexResultList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.geom.ConvexResultIterator.get(this);
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem();
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.geom.ConvexResultList
}
nape.geom.GeomPoly = function(vertices) {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.geom.ZPP_GeomPoly(this);
	if(vertices != null) {
		if(Std["is"](vertices,Array)) {
			var lv = vertices;
			var _g = 0;
			while(_g < lv.length) {
				var vite = lv[_g];
				++_g;
				if(vite == null) throw "Error: Array<Vec2> contains null objects";
				if(!Std["is"](vite,nape.geom.Vec2)) throw "Error: Array<Vec2> contains non Vec2 objects";
				var v = vite;
				if(v != null && v.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
				this.zpp_inner.vertices = (function($this) {
					var $r;
					var obj = zpp_nape.geom.ZPP_GeomVert.get(v.get_x(),v.get_y());
					if($this.zpp_inner.vertices == null) $this.zpp_inner.vertices = obj.prev = obj.next = obj; else {
						obj.prev = $this.zpp_inner.vertices;
						obj.next = $this.zpp_inner.vertices.next;
						$this.zpp_inner.vertices.next.prev = obj;
						$this.zpp_inner.vertices.next = obj;
					}
					$r = obj;
					return $r;
				}(this));
			}
		} else if(false) {
		} else if(Std["is"](vertices,nape.geom.Vec2List)) {
			var lv = vertices;
			var $it0 = lv.iterator();
			while( $it0.hasNext() ) {
				var v = $it0.next();
				if(v == null) throw "Error: Vec2List contains null objects";
				if(v != null && v.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
				this.zpp_inner.vertices = (function($this) {
					var $r;
					var obj = zpp_nape.geom.ZPP_GeomVert.get(v.get_x(),v.get_y());
					if($this.zpp_inner.vertices == null) $this.zpp_inner.vertices = obj.prev = obj.next = obj; else {
						obj.prev = $this.zpp_inner.vertices;
						obj.next = $this.zpp_inner.vertices.next;
						$this.zpp_inner.vertices.next.prev = obj;
						$this.zpp_inner.vertices.next = obj;
					}
					$r = obj;
					return $r;
				}(this));
			}
		} else if(Std["is"](vertices,nape.geom.GeomPoly)) {
			var lv = vertices;
			if(lv != null && lv.zpp_disp) throw "Error: " + "GeomPoly" + " has been disposed and cannot be used!";
			var verts = lv.zpp_inner.vertices;
			if(verts != null) {
				var vite = verts;
				do {
					var v = nape.geom.Vec2.get(vite.x,vite.y);
					vite = vite.next;
					this.zpp_inner.vertices = (function($this) {
						var $r;
						var obj = zpp_nape.geom.ZPP_GeomVert.get(v.get_x(),v.get_y());
						if($this.zpp_inner.vertices == null) $this.zpp_inner.vertices = obj.prev = obj.next = obj; else {
							obj.prev = $this.zpp_inner.vertices;
							obj.next = $this.zpp_inner.vertices.next;
							$this.zpp_inner.vertices.next.prev = obj;
							$this.zpp_inner.vertices.next = obj;
						}
						$r = obj;
						return $r;
					}(this));
					v.dispose();
				} while(vite != verts);
			}
		} else throw "Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>";
		this.skipForward(1);
		if(Std["is"](vertices,Array)) {
			var lv = vertices;
			var i = 0;
			while(i < lv.length) {
				var cur = lv[i];
				if(cur.zpp_inner.weak?(function($this) {
					var $r;
					cur.dispose();
					$r = true;
					return $r;
				}(this)):false) {
					lv.splice(i,1);
					continue;
				}
				i++;
			}
		} else if(false) {
		} else if(Std["is"](vertices,nape.geom.Vec2List)) {
			var lv = vertices;
			if(lv.zpp_inner._validate != null) lv.zpp_inner._validate();
			var ins = lv.zpp_inner.inner;
			var pre = null;
			var cur = ins.begin();
			while(cur != null) {
				var x = cur.elem();
				if(x.outer.zpp_inner.weak) {
					cur = ins.erase(pre);
					if(x.outer.zpp_inner.weak) {
						x.outer.dispose();
						true;
					} else false;
				} else {
					pre = cur;
					cur = cur.next;
				}
			}
		}
	}
};
$hxClasses["nape.geom.GeomPoly"] = nape.geom.GeomPoly;
nape.geom.GeomPoly.__name__ = ["nape","geom","GeomPoly"];
nape.geom.GeomPoly.prototype = {
	toString: function() {
		var ret = "GeomPoly[";
		var F = this.zpp_inner.vertices;
		var L = this.zpp_inner.vertices;
		if(F != null) {
			var nite = F;
			do {
				var v = nite;
				if(v != this.zpp_inner.vertices) ret += ",";
				ret += "{" + v.x + "," + v.y + "}";
				nite = nite.next;
			} while(nite != L);
		}
		return ret + "]";
	}
	,skipForward: function(times) {
		if(this != null && this.zpp_disp) throw "Error: " + "GeomPoly" + " has been disposed and cannot be used!";
		if(!(this.zpp_inner.vertices == null)) {
			if(times > 0) while(times-- > 0) this.zpp_inner.vertices = this.zpp_inner.vertices.next; else if(times < 0) while(times++ < 0) this.zpp_inner.vertices = this.zpp_inner.vertices.prev;
		}
		return this;
	}
	,__class__: nape.geom.GeomPoly
}
nape.geom.GeomPolyIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_GeomPolyList.internal) throw "Error: Cannot instantiate " + "GeomPoly" + "Iterator derp!";
};
$hxClasses["nape.geom.GeomPolyIterator"] = nape.geom.GeomPolyIterator;
nape.geom.GeomPolyIterator.__name__ = ["nape","geom","GeomPolyIterator"];
nape.geom.GeomPolyIterator.get = function(list) {
	var ret = nape.geom.GeomPolyIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_GeomPolyList.internal = true;
		var ret1 = new nape.geom.GeomPolyIterator();
		zpp_nape.util.ZPP_GeomPolyList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.geom.GeomPolyIterator.zpp_pool;
		nape.geom.GeomPolyIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.geom.GeomPolyIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.geom.GeomPolyIterator.zpp_pool;
			nape.geom.GeomPolyIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.geom.GeomPolyIterator
}
nape.geom.GeomPolyList = function() {
	this.zpp_inner = null;
};
$hxClasses["nape.geom.GeomPolyList"] = nape.geom.GeomPolyList;
nape.geom.GeomPolyList.__name__ = ["nape","geom","GeomPolyList"];
nape.geom.GeomPolyList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.geom.GeomPolyIterator.get(this);
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().outer;
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.geom.GeomPolyList
}
nape.geom.Mat23 = function(a,b,c,d,tx,ty) {
	if(ty == null) ty = 0.0;
	if(tx == null) tx = 0.0;
	if(d == null) d = 1.0;
	if(c == null) c = 0.0;
	if(b == null) b = 0.0;
	if(a == null) a = 1.0;
	this.zpp_inner = null;
	this.zpp_inner = zpp_nape.geom.ZPP_Mat23.get();
	this.zpp_inner.outer = this;
	this.set_a(a);
	this.set_b(b);
	this.set_tx(tx);
	this.set_c(c);
	this.set_d(d);
	this.set_ty(ty);
};
$hxClasses["nape.geom.Mat23"] = nape.geom.Mat23;
nape.geom.Mat23.__name__ = ["nape","geom","Mat23"];
nape.geom.Mat23.prototype = {
	equiorthogonal: function() {
		if(this.singular()) return false; else {
			var x = this.get_a() * this.get_b() + this.get_c() * this.get_d();
			if(x * x < nape.Config.epsilon) {
				var y = this.get_a() * this.get_a() + this.get_b() * this.get_b() - this.get_c() * this.get_c() - this.get_d() * this.get_d();
				return y * y < nape.Config.epsilon;
			} else return false;
		}
	}
	,toString: function() {
		return "{ a: " + this.get_a() + " b: " + this.get_b() + " c: " + this.get_c() + " d: " + this.get_d() + " tx: " + this.get_tx() + " ty: " + this.get_ty() + " }";
	}
	,singular: function() {
		var norm = this.get_a() * this.get_a() + this.get_b() * this.get_b() + this.get_c() * this.get_c() + this.get_d() * this.get_d();
		var limit = this.get_determinant();
		if(limit < 0) limit = -limit;
		return norm > nape.Config.illConditionedThreshold * limit;
	}
	,get_determinant: function() {
		return this.get_a() * this.get_d() - this.get_b() * this.get_c();
	}
	,set_ty: function(ty) {
		if(ty != ty) throw "Error: Mat23::" + "ty" + " cannot be NaN";
		this.zpp_inner.ty = ty;
		this.zpp_inner.invalidate();
		return this.get_ty();
	}
	,get_ty: function() {
		return this.zpp_inner.ty;
	}
	,set_tx: function(tx) {
		if(tx != tx) throw "Error: Mat23::" + "tx" + " cannot be NaN";
		this.zpp_inner.tx = tx;
		this.zpp_inner.invalidate();
		return this.get_tx();
	}
	,get_tx: function() {
		return this.zpp_inner.tx;
	}
	,set_d: function(d) {
		if(d != d) throw "Error: Mat23::" + "d" + " cannot be NaN";
		this.zpp_inner.d = d;
		this.zpp_inner.invalidate();
		return this.get_d();
	}
	,get_d: function() {
		return this.zpp_inner.d;
	}
	,set_c: function(c) {
		if(c != c) throw "Error: Mat23::" + "c" + " cannot be NaN";
		this.zpp_inner.c = c;
		this.zpp_inner.invalidate();
		return this.get_c();
	}
	,get_c: function() {
		return this.zpp_inner.c;
	}
	,set_b: function(b) {
		if(b != b) throw "Error: Mat23::" + "b" + " cannot be NaN";
		this.zpp_inner.b = b;
		this.zpp_inner.invalidate();
		return this.get_b();
	}
	,get_b: function() {
		return this.zpp_inner.b;
	}
	,set_a: function(a) {
		if(a != a) throw "Error: Mat23::" + "a" + " cannot be NaN";
		this.zpp_inner.a = a;
		this.zpp_inner.invalidate();
		return this.get_a();
	}
	,get_a: function() {
		return this.zpp_inner.a;
	}
	,__class__: nape.geom.Mat23
}
nape.geom.MatMN = function(rows,cols) {
	this.zpp_inner = null;
	if(rows <= 0 || cols <= 0) throw "Error: MatMN::dimensions cannot be < 1";
	this.zpp_inner = new zpp_nape.geom.ZPP_MatMN(rows,cols);
	this.zpp_inner.outer = this;
};
$hxClasses["nape.geom.MatMN"] = nape.geom.MatMN;
nape.geom.MatMN.__name__ = ["nape","geom","MatMN"];
nape.geom.MatMN.prototype = {
	toString: function() {
		var ret = "{ ";
		var fst = true;
		var _g1 = 0, _g = this.get_rows();
		while(_g1 < _g) {
			var i = _g1++;
			if(!fst) ret += "; ";
			fst = false;
			var _g3 = 0, _g2 = this.get_cols();
			while(_g3 < _g2) {
				var j = _g3++;
				ret += this.x(i,j) + " ";
			}
		}
		ret += "}";
		return ret;
	}
	,setx: function(row,col,x) {
		if(row < 0 || col < 0 || row >= this.get_rows() || col >= this.get_cols()) throw "Error: MatMN indices out of range";
		return this.zpp_inner.x[row * this.get_cols() + col] = x;
	}
	,x: function(row,col) {
		if(row < 0 || col < 0 || row >= this.get_rows() || col >= this.get_cols()) throw "Error: MatMN indices out of range";
		return this.zpp_inner.x[row * this.get_cols() + col];
	}
	,get_cols: function() {
		return this.zpp_inner.n;
	}
	,get_rows: function() {
		return this.zpp_inner.m;
	}
	,__class__: nape.geom.MatMN
}
nape.geom.Ray = function() {
	this.zpp_inner = null;
};
$hxClasses["nape.geom.Ray"] = nape.geom.Ray;
nape.geom.Ray.__name__ = ["nape","geom","Ray"];
nape.geom.Ray.prototype = {
	get_maxDistance: function() {
		return this.zpp_inner.maxdist;
	}
	,get_direction: function() {
		return this.zpp_inner.direction;
	}
	,get_origin: function() {
		return this.zpp_inner.origin;
	}
	,__class__: nape.geom.Ray
}
nape.geom.RayResult = function() {
	this.zpp_inner = null;
	if(!zpp_nape.geom.ZPP_ConvexRayResult.internal) throw "Error: RayResult cannot be instantiated derp!";
};
$hxClasses["nape.geom.RayResult"] = nape.geom.RayResult;
nape.geom.RayResult.__name__ = ["nape","geom","RayResult"];
nape.geom.RayResult.prototype = {
	toString: function() {
		this.zpp_inner.disposed();
		return "{ shape: " + Std.string(this.get_shape()) + " distance: " + this.get_distance() + " ?inner: " + Std.string(this.get_inner()) + " }";
	}
	,dispose: function() {
		this.zpp_inner.disposed();
		this.zpp_inner.free();
	}
	,get_shape: function() {
		this.zpp_inner.disposed();
		return this.zpp_inner.shape;
	}
	,get_inner: function() {
		this.zpp_inner.disposed();
		return this.zpp_inner.inner;
	}
	,get_distance: function() {
		this.zpp_inner.disposed();
		return this.zpp_inner.toiDistance;
	}
	,__class__: nape.geom.RayResult
}
nape.geom.RayResultIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_RayResultList.internal) throw "Error: Cannot instantiate " + "RayResult" + "Iterator derp!";
};
$hxClasses["nape.geom.RayResultIterator"] = nape.geom.RayResultIterator;
nape.geom.RayResultIterator.__name__ = ["nape","geom","RayResultIterator"];
nape.geom.RayResultIterator.get = function(list) {
	var ret = nape.geom.RayResultIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_RayResultList.internal = true;
		var ret1 = new nape.geom.RayResultIterator();
		zpp_nape.util.ZPP_RayResultList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.geom.RayResultIterator.zpp_pool;
		nape.geom.RayResultIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.geom.RayResultIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.geom.RayResultIterator.zpp_pool;
			nape.geom.RayResultIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.geom.RayResultIterator
}
nape.geom.RayResultList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_RayResultList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.geom.RayResultList"] = nape.geom.RayResultList;
nape.geom.RayResultList.__name__ = ["nape","geom","RayResultList"];
nape.geom.RayResultList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.geom.RayResultIterator.get(this);
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem();
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.geom.RayResultList
}
nape.geom.Vec2 = function(x,y) {
	if(y == null) y = 0;
	if(x == null) x = 0;
	this.zpp_pool = null;
	this.zpp_inner = null;
	if(x != x || y != y) throw "Error: Vec2 components cannot be NaN";
	this.zpp_inner = zpp_nape.geom.ZPP_Vec2.get(x,y);
	this.zpp_inner.outer = this;
};
$hxClasses["nape.geom.Vec2"] = nape.geom.Vec2;
nape.geom.Vec2.__name__ = ["nape","geom","Vec2"];
nape.geom.Vec2.weak = function(x,y) {
	if(y == null) y = 0;
	if(x == null) x = 0;
	return nape.geom.Vec2.get(x,y,true);
}
nape.geom.Vec2.get = function(x,y,weak) {
	if(weak == null) weak = false;
	if(y == null) y = 0;
	if(x == null) x = 0;
	if(x != x || y != y) throw "Error: Vec2 components cannot be NaN";
	var ret;
	if(zpp_nape.util.ZPP_PubPool.poolVec2 == null) ret = new nape.geom.Vec2(); else {
		ret = zpp_nape.util.ZPP_PubPool.poolVec2;
		zpp_nape.util.ZPP_PubPool.poolVec2 = ret.zpp_pool;
		ret.zpp_pool = null;
		ret.zpp_disp = false;
		if(ret == zpp_nape.util.ZPP_PubPool.nextVec2) zpp_nape.util.ZPP_PubPool.nextVec2 = null;
	}
	if(ret.zpp_inner == null) {
		ret.zpp_inner = zpp_nape.geom.ZPP_Vec2.get(x,y);
		ret.zpp_inner.outer = ret;
	} else ret.setxy(x,y);
	ret.zpp_inner.weak = weak;
	return ret;
}
nape.geom.Vec2.prototype = {
	toString: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.validate();
		return this.zpp_inner.toString();
	}
	,get_angle: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(this.get_x() == this.get_y() && this.get_x() == 0) return 0.0; else return Math.atan2(this.get_y(),this.get_x());
	}
	,setxy: function(x,y) {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.immutable();
		if(x != x || y != y) throw "Error: Vec2 components cannot be NaN";
		if(!(this.get_x() == x && this.get_y() == y)) {
			this.zpp_inner.x = x;
			this.zpp_inner.y = y;
			this.zpp_inner.invalidate();
		}
		return this;
	}
	,set: function(vector) {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(vector != null && vector.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.immutable();
		if(vector == null) throw "Error: Cannot assign null Vec2";
		var ret = this.setxy(vector.get_x(),vector.get_y());
		if(vector.zpp_inner.weak) {
			vector.dispose();
			true;
		} else false;
		return ret;
	}
	,lsq: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		return this.get_x() * this.get_x() + this.get_y() * this.get_y();
	}
	,get_length: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		return Math.sqrt(this.get_x() * this.get_x() + this.get_y() * this.get_y());
	}
	,set_y: function(y) {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.immutable();
		if(this.get_y() != y) {
			if(y != y) throw "Error: Vec2::" + "y" + " cannot be NaN";
			this.zpp_inner.y = y;
			this.zpp_inner.invalidate();
		}
		return this.get_y();
	}
	,get_y: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.validate();
		return this.zpp_inner.y;
	}
	,set_x: function(x) {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.immutable();
		if(this.get_x() != x) {
			if(x != x) throw "Error: Vec2::" + "x" + " cannot be NaN";
			this.zpp_inner.x = x;
			this.zpp_inner.invalidate();
		}
		return this.get_x();
	}
	,get_x: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.validate();
		return this.zpp_inner.x;
	}
	,copy: function(weak) {
		if(weak == null) weak = false;
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		return nape.geom.Vec2.get(this.get_x(),this.get_y(),weak);
	}
	,dispose: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.immutable();
		if(this.zpp_inner._inuse) throw "Error: This Vec2 is not disposable";
		var inner = this.zpp_inner;
		this.zpp_inner.outer = null;
		this.zpp_inner = null;
		var o = this;
		o.zpp_pool = null;
		if(zpp_nape.util.ZPP_PubPool.nextVec2 != null) zpp_nape.util.ZPP_PubPool.nextVec2.zpp_pool = o; else zpp_nape.util.ZPP_PubPool.poolVec2 = o;
		zpp_nape.util.ZPP_PubPool.nextVec2 = o;
		o.zpp_disp = true;
		var o = inner;
		o.free();
		o.next = zpp_nape.geom.ZPP_Vec2.zpp_pool;
		zpp_nape.geom.ZPP_Vec2.zpp_pool = o;
	}
	,__class__: nape.geom.Vec2
}
nape.geom.Vec2Iterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_Vec2List.internal) throw "Error: Cannot instantiate " + "Vec2" + "Iterator derp!";
};
$hxClasses["nape.geom.Vec2Iterator"] = nape.geom.Vec2Iterator;
nape.geom.Vec2Iterator.__name__ = ["nape","geom","Vec2Iterator"];
nape.geom.Vec2Iterator.get = function(list) {
	var ret = nape.geom.Vec2Iterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_Vec2List.internal = true;
		var ret1 = new nape.geom.Vec2Iterator();
		zpp_nape.util.ZPP_Vec2List.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.geom.Vec2Iterator.zpp_pool;
		nape.geom.Vec2Iterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.geom.Vec2Iterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.geom.Vec2Iterator.zpp_pool;
			nape.geom.Vec2Iterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.geom.Vec2Iterator
}
nape.geom.Vec2List = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_Vec2List();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.geom.Vec2List"] = nape.geom.Vec2List;
nape.geom.Vec2List.__name__ = ["nape","geom","Vec2List"];
nape.geom.Vec2List.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_vm();
		return nape.geom.Vec2Iterator.get(this);
	}
	,empty: function() {
		return this.get_length() == 0;
	}
	,clear: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		if(this.zpp_inner.reverse_flag) while(!this.empty()) this.pop(); else while(!this.empty()) this.shift();
	}
	,remove: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_vm();
		var ret;
		ret = false;
		var cx_ite = this.zpp_inner.inner.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(x == obj.zpp_inner) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(ret) {
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(obj);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.remove(obj.zpp_inner);
			this.zpp_inner.invalidate();
		}
		return ret;
	}
	,shift: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		if(this.empty()) throw "Error: Cannot remove from empty list";
		this.zpp_vm();
		var ret = null;
		if(this.zpp_inner.reverse_flag) {
			if(this.zpp_inner.at_ite != null && this.zpp_inner.at_ite.next == null) this.zpp_inner.at_ite = null;
			var ite = this.get_length() == 1?null:this.zpp_inner.inner.iterator_at(this.get_length() - 2);
			ret = ite == null?this.zpp_inner.inner.front():ite.next.elem();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.erase(ite);
		} else {
			ret = this.zpp_inner.inner.front();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.pop();
		}
		this.zpp_inner.invalidate();
		var retx = ret.wrapper();
		return retx;
	}
	,pop: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		if(this.empty()) throw "Error: Cannot remove from empty list";
		this.zpp_vm();
		var ret = null;
		if(this.zpp_inner.reverse_flag) {
			ret = this.zpp_inner.inner.front();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.pop();
		} else {
			if(this.zpp_inner.at_ite != null && this.zpp_inner.at_ite.next == null) this.zpp_inner.at_ite = null;
			var ite = this.get_length() == 1?null:this.zpp_inner.inner.iterator_at(this.get_length() - 2);
			ret = ite == null?this.zpp_inner.inner.front():ite.next.elem();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.erase(ite);
		}
		this.zpp_inner.invalidate();
		var retx = ret.wrapper();
		return retx;
	}
	,unshift: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_vm();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			} else this.zpp_inner.inner.add(obj.zpp_inner);
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,push: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_vm();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) this.zpp_inner.inner.add(obj.zpp_inner); else {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			}
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,at: function(index) {
		this.zpp_vm();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().wrapper();
	}
	,zpp_vm: function() {
		this.zpp_inner.valmod();
	}
	,zpp_gl: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,get_length: function() {
		return this.zpp_gl();
	}
	,__class__: nape.geom.Vec2List
}
nape.geom.Vec3 = function(x,y,z) {
	if(z == null) z = 0;
	if(y == null) y = 0;
	if(x == null) x = 0;
	this.zpp_pool = null;
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.geom.ZPP_Vec3();
	this.zpp_inner.outer = this;
	this.set_x(x);
	this.set_y(y);
	this.set_z(z);
};
$hxClasses["nape.geom.Vec3"] = nape.geom.Vec3;
nape.geom.Vec3.__name__ = ["nape","geom","Vec3"];
nape.geom.Vec3.get = function(x,y,z) {
	if(z == null) z = 0;
	if(y == null) y = 0;
	if(x == null) x = 0;
	var ret;
	if(zpp_nape.util.ZPP_PubPool.poolVec3 == null) ret = new nape.geom.Vec3(); else {
		ret = zpp_nape.util.ZPP_PubPool.poolVec3;
		zpp_nape.util.ZPP_PubPool.poolVec3 = ret.zpp_pool;
		ret.zpp_pool = null;
		ret.zpp_disp = false;
		if(ret == zpp_nape.util.ZPP_PubPool.nextVec3) zpp_nape.util.ZPP_PubPool.nextVec3 = null;
	}
	ret.setxyz(x,y,z);
	ret.zpp_inner.immutable = false;
	ret.zpp_inner._validate = null;
	return ret;
}
nape.geom.Vec3.prototype = {
	toString: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		return "{ x: " + this.get_x() + " y: " + this.get_y() + " z: " + this.get_z() + " }";
	}
	,setxyz: function(x,y,z) {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		this.set_x(x);
		this.set_y(y);
		this.set_z(z);
		return this;
	}
	,get_length: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		return Math.sqrt(this.get_x() * this.get_x() + this.get_y() * this.get_y() + this.get_z() * this.get_z());
	}
	,dispose: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		if(this.zpp_inner.immutable) throw "Error: This Vec3 is not disposable";
		var o = this;
		o.zpp_pool = null;
		if(zpp_nape.util.ZPP_PubPool.nextVec3 != null) zpp_nape.util.ZPP_PubPool.nextVec3.zpp_pool = o; else zpp_nape.util.ZPP_PubPool.poolVec3 = o;
		zpp_nape.util.ZPP_PubPool.nextVec3 = o;
		o.zpp_disp = true;
	}
	,set_z: function(z) {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		if(this.zpp_inner.immutable) throw "Error: Vec3 is immutable";
		this.zpp_inner.z = z;
		return this.get_z();
	}
	,get_z: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		this.zpp_inner.validate();
		return this.zpp_inner.z;
	}
	,set_y: function(y) {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		if(this.zpp_inner.immutable) throw "Error: Vec3 is immutable";
		this.zpp_inner.y = y;
		return this.get_y();
	}
	,get_y: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		this.zpp_inner.validate();
		return this.zpp_inner.y;
	}
	,set_x: function(x) {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		if(this.zpp_inner.immutable) throw "Error: Vec3 is immutable";
		this.zpp_inner.x = x;
		return this.get_x();
	}
	,get_x: function() {
		if(this != null && this.zpp_disp) throw "Error: " + "Vec3" + " has been disposed and cannot be used!";
		this.zpp_inner.validate();
		return this.zpp_inner.x;
	}
	,__class__: nape.geom.Vec3
}
nape.geom.Winding = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "Winding" + " derp!";
};
$hxClasses["nape.geom.Winding"] = nape.geom.Winding;
nape.geom.Winding.__name__ = ["nape","geom","Winding"];
nape.geom.Winding.get_UNDEFINED = function() {
	if(zpp_nape.util.ZPP_Flags.Winding_UNDEFINED == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.Winding_UNDEFINED = new nape.geom.Winding();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.Winding_UNDEFINED;
}
nape.geom.Winding.get_CLOCKWISE = function() {
	if(zpp_nape.util.ZPP_Flags.Winding_CLOCKWISE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.Winding_CLOCKWISE = new nape.geom.Winding();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.Winding_CLOCKWISE;
}
nape.geom.Winding.get_ANTICLOCKWISE = function() {
	if(zpp_nape.util.ZPP_Flags.Winding_ANTICLOCKWISE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.Winding_ANTICLOCKWISE = new nape.geom.Winding();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.Winding_ANTICLOCKWISE;
}
nape.geom.Winding.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.geom.Winding.get_UNDEFINED()) return "UNDEFINED"; else if(this == nape.geom.Winding.get_CLOCKWISE()) return "CLOCKWISE"; else if(this == nape.geom.Winding.get_ANTICLOCKWISE()) return "ANTICLOCKWISE"; else return "";
	}
	,__class__: nape.geom.Winding
}
nape.phys = {}
nape.phys.Interactor = function() {
	this.zpp_inner_i = null;
	throw "Error: Cannot instantiate an Interactor, only Shape/Body/Compound";
};
$hxClasses["nape.phys.Interactor"] = nape.phys.Interactor;
nape.phys.Interactor.__name__ = ["nape","phys","Interactor"];
nape.phys.Interactor.prototype = {
	toString: function() {
		return "";
	}
	,get_cbTypes: function() {
		if(this.zpp_inner_i.wrap_cbTypes == null) this.zpp_inner_i.setupcbTypes();
		return this.zpp_inner_i.wrap_cbTypes;
	}
	,get_group: function() {
		return this.zpp_inner_i.group == null?null:this.zpp_inner_i.group.outer;
	}
	,isCompound: function() {
		return this.zpp_inner_i.icompound != null;
	}
	,isBody: function() {
		return this.zpp_inner_i.ibody != null;
	}
	,isShape: function() {
		return this.zpp_inner_i.ishape != null;
	}
	,get_userData: function() {
		if(this.zpp_inner_i.userData == null) this.zpp_inner_i.userData = { };
		return this.zpp_inner_i.userData;
	}
	,get_id: function() {
		return this.zpp_inner_i.id;
	}
	,__class__: nape.phys.Interactor
}
nape.phys.Body = function(type,position) {
	this.zpp_inner = null;
	try {
		nape.phys.Interactor.call(this);
	} catch( e ) {
	}
	this.zpp_inner = new zpp_nape.phys.ZPP_Body();
	this.zpp_inner.outer = this;
	this.zpp_inner.outer_i = this;
	this.zpp_inner_i = this.zpp_inner;
	if(position != null) {
		if(position != null && position.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.posx = position.get_x();
		this.zpp_inner.posy = position.get_y();
	} else {
		this.zpp_inner.posx = 0;
		this.zpp_inner.posy = 0;
	}
	this.set_type(type == null?nape.phys.BodyType.get_DYNAMIC():type);
	if(position != null) {
		if(position.zpp_inner.weak) {
			position.dispose();
			true;
		} else false;
	}
	this.zpp_inner_i.insert_cbtype(nape.callbacks.CbType.get_ANY_BODY().zpp_inner);
};
$hxClasses["nape.phys.Body"] = nape.phys.Body;
nape.phys.Body.__name__ = ["nape","phys","Body"];
nape.phys.Body.__super__ = nape.phys.Interactor;
nape.phys.Body.prototype = $extend(nape.phys.Interactor.prototype,{
	toString: function() {
		return (this.zpp_inner.world?"(space::world":"(" + (this.isDynamic()?"dynamic":this.isStatic()?"static":"kinematic")) + ")#" + this.get_id();
	}
	,get_localCOM: function() {
		if(this.zpp_inner.world) throw "Error: Space::world has no " + "localCOM";
		if(this.zpp_inner.wrap_localCOM == null) {
			this.zpp_inner.wrap_localCOM = nape.geom.Vec2.get(this.zpp_inner.localCOMx,this.zpp_inner.localCOMy);
			this.zpp_inner.wrap_localCOM.zpp_inner._inuse = true;
			this.zpp_inner.wrap_localCOM.zpp_inner._immutable = true;
			this.zpp_inner.wrap_localCOM.zpp_inner._validate = ($_=this.zpp_inner,$bind($_,$_.getlocalCOM));
		}
		return this.zpp_inner.wrap_localCOM;
	}
	,setShapeFilters: function(filter) {
		this.zpp_inner.immutable_midstep("Body::setShapeFilters()");
		if(this.zpp_inner.world) throw "Error: Space::world is immutable";
		var cx_ite = this.zpp_inner.shapes.begin();
		while(cx_ite != null) {
			var s = cx_ite.elem();
			s.outer.set_filter(filter);
			cx_ite = cx_ite.next;
		}
		return this;
	}
	,setShapeMaterials: function(material) {
		this.zpp_inner.immutable_midstep("Body::setShapeMaterials()");
		if(this.zpp_inner.world) throw "Error: Space::world is immutable";
		var cx_ite = this.zpp_inner.shapes.begin();
		while(cx_ite != null) {
			var s = cx_ite.elem();
			s.outer.set_material(material);
			cx_ite = cx_ite.next;
		}
		return this;
	}
	,translateShapes: function(translation) {
		this.zpp_inner.immutable_midstep("Body::translateShapes()");
		if(translation != null && translation.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(this.zpp_inner.world) throw "Error: Space::world is immutable";
		if(translation == null) throw "Error: Cannot displace by null Vec2";
		var weak = translation.zpp_inner.weak;
		translation.zpp_inner.weak = false;
		var cx_ite = this.zpp_inner.shapes.begin();
		while(cx_ite != null) {
			var s = cx_ite.elem();
			s.outer.translate(translation);
			cx_ite = cx_ite.next;
		}
		translation.zpp_inner.weak = weak;
		if(translation.zpp_inner.weak) {
			translation.dispose();
			true;
		} else false;
		return this;
	}
	,localPointToWorld: function(point,weak) {
		if(weak == null) weak = false;
		if(point != null && point.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(point == null) throw "Error: Cannot transform null Vec2";
		this.zpp_inner.validate_axis();
		var tempx = 0.0;
		var tempy = 0.0;
		tempx = this.zpp_inner.axisy * point.get_x() - this.zpp_inner.axisx * point.get_y();
		tempy = point.get_x() * this.zpp_inner.axisx + point.get_y() * this.zpp_inner.axisy;
		if(point.zpp_inner.weak) {
			point.dispose();
			true;
		} else false;
		return nape.geom.Vec2.get(tempx + this.zpp_inner.posx,tempy + this.zpp_inner.posy,weak);
	}
	,get_inertia: function() {
		if(this.zpp_inner.world) throw "Error: Space::world has no inertia";
		this.zpp_inner.validate_inertia();
		if(this.zpp_inner.inertiaMode == zpp_nape.util.ZPP_Flags.id_InertiaMode_DEFAULT && this.get_shapes().empty()) throw "Error: Given current inertia mode flag, Body::inertia only makes sense if Body contains Shapes";
		return this.zpp_inner.cinertia;
	}
	,get_inertiaMode: function() {
		return [nape.phys.InertiaMode.get_DEFAULT(),nape.phys.InertiaMode.get_FIXED()][this.zpp_inner.inertiaMode];
	}
	,get_gravMassScale: function() {
		this.zpp_inner.validate_gravMassScale();
		if(this.zpp_inner.shapes.empty()) {
			if(this.zpp_inner.massMode == zpp_nape.util.ZPP_Flags.id_MassMode_DEFAULT && this.zpp_inner.gravMassMode != zpp_nape.util.ZPP_Flags.id_GravMassMode_SCALED) throw "Error: Given current mass/gravMass modes; Body::gravMassScale only makes sense if it contains Shapes";
		}
		return this.zpp_inner.gravMassScale;
	}
	,get_gravMass: function() {
		if(this.zpp_inner.world) throw "Error: Space::world has no gravMass";
		this.zpp_inner.validate_gravMass();
		if(this.zpp_inner.shapes.empty()) {
			if(this.zpp_inner.massMode == zpp_nape.util.ZPP_Flags.id_MassMode_DEFAULT && this.zpp_inner.gravMassMode != zpp_nape.util.ZPP_Flags.id_GravMassMode_FIXED) throw "Error: Given current mass/gravMass modes; Body::gravMass only makes sense if it contains Shapes";
		}
		return this.zpp_inner.gravMass;
	}
	,get_gravMassMode: function() {
		return [nape.phys.GravMassMode.get_DEFAULT(),nape.phys.GravMassMode.get_FIXED(),nape.phys.GravMassMode.get_SCALED()][this.zpp_inner.massMode];
	}
	,get_mass: function() {
		if(this.zpp_inner.world) throw "Error: Space::world has no mass";
		this.zpp_inner.validate_mass();
		if(this.zpp_inner.massMode == zpp_nape.util.ZPP_Flags.id_MassMode_DEFAULT && this.zpp_inner.shapes.empty()) throw "Error: Given current mass mode, Body::mass only makes sense if it contains shapes";
		return this.zpp_inner.cmass;
	}
	,get_massMode: function() {
		return [nape.phys.MassMode.get_DEFAULT(),nape.phys.MassMode.get_FIXED()][this.zpp_inner.massMode];
	}
	,get_allowRotation: function() {
		return !this.zpp_inner.norotate;
	}
	,get_allowMovement: function() {
		return !this.zpp_inner.nomove;
	}
	,get_torque: function() {
		return this.zpp_inner.torque;
	}
	,get_kinAngVel: function() {
		return this.zpp_inner.kinangvel;
	}
	,get_angularVel: function() {
		return this.zpp_inner.angvel;
	}
	,get_rotation: function() {
		return this.zpp_inner.rot;
	}
	,get_force: function() {
		if(this.zpp_inner.wrap_force == null) this.zpp_inner.setupForce();
		return this.zpp_inner.wrap_force;
	}
	,get_surfaceVel: function() {
		if(this.zpp_inner.wrap_svel == null) this.zpp_inner.setupsvel();
		return this.zpp_inner.wrap_svel;
	}
	,get_kinematicVel: function() {
		if(this.zpp_inner.wrap_kinvel == null) this.zpp_inner.setupkinvel();
		return this.zpp_inner.wrap_kinvel;
	}
	,set_velocity: function(velocity) {
		if(velocity != null && velocity.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(velocity == null) throw "Error: Body::" + "velocity" + " cannot be null";
		this.get_velocity().set(velocity);
		return this.get_velocity();
	}
	,get_velocity: function() {
		if(this.zpp_inner.wrap_vel == null) this.zpp_inner.setupVelocity();
		return this.zpp_inner.wrap_vel;
	}
	,set_position: function(position) {
		if(position != null && position.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(position == null) throw "Error: Body::" + "position" + " cannot be null";
		this.get_position().set(position);
		return this.get_position();
	}
	,get_position: function() {
		if(this.zpp_inner.wrap_pos == null) this.zpp_inner.setupPosition();
		return this.zpp_inner.wrap_pos;
	}
	,copy: function() {
		if(this.zpp_inner.world) throw "Error: Space::world cannot be copied";
		return this.zpp_inner.copy();
	}
	,get_isSleeping: function() {
		if(this.zpp_inner.space == null) throw "Error: isSleeping makes no sense if the object is not contained within a Space";
		return this.zpp_inner.component.sleeping;
	}
	,set_space: function(space) {
		if(this.zpp_inner.compound != null) throw "Error: Cannot set the space of a Body belonging to a Compound, only the root Compound space can be set";
		this.zpp_inner.immutable_midstep("Body::space");
		if(this.zpp_inner.world) throw "Error: Space::world is immutable";
		if(this.get_space() != space) {
			if(this.get_space() != null) this.zpp_inner.component.woken = false;
			if(this.get_space() != null) this.get_space().get_bodies().remove(this);
			if(space != null) space.get_bodies().add(this);
		}
		return this.get_space();
	}
	,get_space: function() {
		return this.zpp_inner.space == null?null:this.zpp_inner.space.outer;
	}
	,get_compound: function() {
		return this.zpp_inner.compound == null?null:this.zpp_inner.compound.outer;
	}
	,get_shapes: function() {
		return this.zpp_inner.wrap_shapes;
	}
	,isDynamic: function() {
		return this.zpp_inner.isDynamic();
	}
	,isStatic: function() {
		return this.zpp_inner.isStatic();
	}
	,get_disableCCD: function() {
		return this.zpp_inner.disableCCD;
	}
	,get_isBullet: function() {
		return this.zpp_inner.bulletEnabled;
	}
	,set_type: function(type) {
		this.zpp_inner.immutable_midstep("Body::type");
		if(this.zpp_inner.world) throw "Error: Space::world is immutable";
		if(this.get_type() != type) {
			if(type == null) throw "Error: Cannot use null BodyType";
			var ntype = type == nape.phys.BodyType.get_DYNAMIC()?zpp_nape.util.ZPP_Flags.id_BodyType_DYNAMIC:type == nape.phys.BodyType.get_KINEMATIC()?zpp_nape.util.ZPP_Flags.id_BodyType_KINEMATIC:zpp_nape.util.ZPP_Flags.id_BodyType_STATIC;
			if(ntype == zpp_nape.util.ZPP_Flags.id_BodyType_STATIC && this.zpp_inner.space != null) {
				this.zpp_inner.velx = 0;
				this.zpp_inner.vely = 0;
				this.zpp_inner.angvel = 0;
			}
			this.zpp_inner.invalidate_type();
			if(this.zpp_inner.space != null) this.zpp_inner.space.transmitType(this.zpp_inner,ntype); else this.zpp_inner.type = ntype;
		}
		return this.get_type();
	}
	,get_type: function() {
		return [null,nape.phys.BodyType.get_STATIC(),nape.phys.BodyType.get_DYNAMIC(),nape.phys.BodyType.get_KINEMATIC()][this.zpp_inner.type];
	}
	,__class__: nape.phys.Body
});
nape.phys.BodyIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_BodyList.internal) throw "Error: Cannot instantiate " + "Body" + "Iterator derp!";
};
$hxClasses["nape.phys.BodyIterator"] = nape.phys.BodyIterator;
nape.phys.BodyIterator.__name__ = ["nape","phys","BodyIterator"];
nape.phys.BodyIterator.get = function(list) {
	var ret = nape.phys.BodyIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_BodyList.internal = true;
		var ret1 = new nape.phys.BodyIterator();
		zpp_nape.util.ZPP_BodyList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.phys.BodyIterator.zpp_pool;
		nape.phys.BodyIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.phys.BodyIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.phys.BodyIterator.zpp_pool;
			nape.phys.BodyIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.phys.BodyIterator
}
nape.phys.BodyList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_BodyList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.phys.BodyList"] = nape.phys.BodyList;
nape.phys.BodyList.__name__ = ["nape","phys","BodyList"];
nape.phys.BodyList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.phys.BodyIterator.get(this);
	}
	,empty: function() {
		if(false) return this.get_length() == 0; else return this.zpp_inner.inner.empty();
	}
	,clear: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Body" + "List is immutable";
		if(this.zpp_inner.reverse_flag) while(!this.empty()) this.pop(); else while(!this.empty()) this.shift();
	}
	,remove: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Body" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var ret;
		ret = false;
		var cx_ite = this.zpp_inner.inner.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(x == obj.zpp_inner) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(ret) {
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(obj);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.remove(obj.zpp_inner);
			this.zpp_inner.invalidate();
		}
		return ret;
	}
	,add: function(obj) {
		return this.zpp_inner.reverse_flag?this.push(obj):this.unshift(obj);
	}
	,shift: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Body" + "List is immutable";
		this.zpp_inner.modify_test();
		if(this.empty()) throw "Error: Cannot remove from empty list";
		this.zpp_inner.valmod();
		var ret = null;
		if(this.zpp_inner.reverse_flag) {
			if(this.zpp_inner.at_ite != null && this.zpp_inner.at_ite.next == null) this.zpp_inner.at_ite = null;
			var ite = this.get_length() == 1?null:this.zpp_inner.inner.iterator_at(this.get_length() - 2);
			ret = ite == null?this.zpp_inner.inner.front():ite.next.elem();
			var retx = ret.outer;
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.erase(ite);
		} else {
			ret = this.zpp_inner.inner.front();
			var retx = ret.outer;
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.pop();
		}
		this.zpp_inner.invalidate();
		var retx = ret.outer;
		return retx;
	}
	,pop: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Body" + "List is immutable";
		this.zpp_inner.modify_test();
		if(this.empty()) throw "Error: Cannot remove from empty list";
		this.zpp_inner.valmod();
		var ret = null;
		if(this.zpp_inner.reverse_flag) {
			ret = this.zpp_inner.inner.front();
			var retx = ret.outer;
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.pop();
		} else {
			if(this.zpp_inner.at_ite != null && this.zpp_inner.at_ite.next == null) this.zpp_inner.at_ite = null;
			var ite = this.get_length() == 1?null:this.zpp_inner.inner.iterator_at(this.get_length() - 2);
			ret = ite == null?this.zpp_inner.inner.front():ite.next.elem();
			var retx = ret.outer;
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.erase(ite);
		}
		this.zpp_inner.invalidate();
		var retx = ret.outer;
		return retx;
	}
	,unshift: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Body" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			} else this.zpp_inner.inner.add(obj.zpp_inner);
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,push: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Body" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) this.zpp_inner.inner.add(obj.zpp_inner); else {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			}
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().outer;
	}
	,has: function(obj) {
		this.zpp_inner.valmod();
		return this.zpp_inner.inner.has(obj.zpp_inner);
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.phys.BodyList
}
nape.phys.BodyType = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "BodyType" + " derp!";
};
$hxClasses["nape.phys.BodyType"] = nape.phys.BodyType;
nape.phys.BodyType.__name__ = ["nape","phys","BodyType"];
nape.phys.BodyType.get_STATIC = function() {
	if(zpp_nape.util.ZPP_Flags.BodyType_STATIC == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.BodyType_STATIC = new nape.phys.BodyType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.BodyType_STATIC;
}
nape.phys.BodyType.get_DYNAMIC = function() {
	if(zpp_nape.util.ZPP_Flags.BodyType_DYNAMIC == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.BodyType_DYNAMIC = new nape.phys.BodyType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.BodyType_DYNAMIC;
}
nape.phys.BodyType.get_KINEMATIC = function() {
	if(zpp_nape.util.ZPP_Flags.BodyType_KINEMATIC == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.BodyType_KINEMATIC = new nape.phys.BodyType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.BodyType_KINEMATIC;
}
nape.phys.BodyType.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.phys.BodyType.get_STATIC()) return "STATIC"; else if(this == nape.phys.BodyType.get_DYNAMIC()) return "DYNAMIC"; else if(this == nape.phys.BodyType.get_KINEMATIC()) return "KINEMATIC"; else return "";
	}
	,__class__: nape.phys.BodyType
}
nape.phys.Compound = function() {
	this.zpp_inner = null;
};
$hxClasses["nape.phys.Compound"] = nape.phys.Compound;
nape.phys.Compound.__name__ = ["nape","phys","Compound"];
nape.phys.Compound.__super__ = nape.phys.Interactor;
nape.phys.Compound.prototype = $extend(nape.phys.Interactor.prototype,{
	toString: function() {
		return "Compound" + this.get_id();
	}
	,get_space: function() {
		return this.zpp_inner.space == null?null:this.zpp_inner.space.outer;
	}
	,get_compound: function() {
		return this.zpp_inner.compound == null?null:this.zpp_inner.compound.outer;
	}
	,get_compounds: function() {
		return this.zpp_inner.wrap_compounds;
	}
	,get_constraints: function() {
		return this.zpp_inner.wrap_constraints;
	}
	,get_bodies: function() {
		return this.zpp_inner.wrap_bodies;
	}
	,__class__: nape.phys.Compound
});
nape.phys.CompoundIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_CompoundList.internal) throw "Error: Cannot instantiate " + "Compound" + "Iterator derp!";
};
$hxClasses["nape.phys.CompoundIterator"] = nape.phys.CompoundIterator;
nape.phys.CompoundIterator.__name__ = ["nape","phys","CompoundIterator"];
nape.phys.CompoundIterator.get = function(list) {
	var ret = nape.phys.CompoundIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_CompoundList.internal = true;
		var ret1 = new nape.phys.CompoundIterator();
		zpp_nape.util.ZPP_CompoundList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.phys.CompoundIterator.zpp_pool;
		nape.phys.CompoundIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.phys.CompoundIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.phys.CompoundIterator.zpp_pool;
			nape.phys.CompoundIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.phys.CompoundIterator
}
nape.phys.CompoundList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_CompoundList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.phys.CompoundList"] = nape.phys.CompoundList;
nape.phys.CompoundList.__name__ = ["nape","phys","CompoundList"];
nape.phys.CompoundList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.phys.CompoundIterator.get(this);
	}
	,empty: function() {
		if(false) return this.get_length() == 0; else return this.zpp_inner.inner.empty();
	}
	,remove: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Compound" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var ret;
		ret = false;
		var cx_ite = this.zpp_inner.inner.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(x == obj.zpp_inner) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(ret) {
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(obj);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.remove(obj.zpp_inner);
			this.zpp_inner.invalidate();
		}
		return ret;
	}
	,add: function(obj) {
		return this.zpp_inner.reverse_flag?this.push(obj):this.unshift(obj);
	}
	,unshift: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Compound" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			} else this.zpp_inner.inner.add(obj.zpp_inner);
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,push: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Compound" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) this.zpp_inner.inner.add(obj.zpp_inner); else {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			}
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().outer;
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.phys.CompoundList
}
nape.phys.FluidProperties = function(density,viscosity) {
	if(viscosity == null) viscosity = 1;
	if(density == null) density = 1;
	this.zpp_inner = null;
	if(zpp_nape.phys.ZPP_FluidProperties.zpp_pool == null) this.zpp_inner = new zpp_nape.phys.ZPP_FluidProperties(); else {
		this.zpp_inner = zpp_nape.phys.ZPP_FluidProperties.zpp_pool;
		zpp_nape.phys.ZPP_FluidProperties.zpp_pool = this.zpp_inner.next;
		this.zpp_inner.next = null;
	}
	this.zpp_inner.alloc();
	this.zpp_inner.outer = this;
	this.set_density(density);
	this.set_viscosity(viscosity);
};
$hxClasses["nape.phys.FluidProperties"] = nape.phys.FluidProperties;
nape.phys.FluidProperties.__name__ = ["nape","phys","FluidProperties"];
nape.phys.FluidProperties.prototype = {
	toString: function() {
		return "{ density: " + this.get_density() + " viscosity: " + this.get_viscosity() + " gravity: " + Std.string(this.get_gravity()) + " }";
	}
	,get_gravity: function() {
		return this.zpp_inner.wrap_gravity;
	}
	,set_viscosity: function(viscosity) {
		if(viscosity != this.get_viscosity()) {
			if(viscosity != viscosity) throw "Error: FluidProperties::" + "viscosity" + " cannot be NaN";
			if("viscosity" != "density" && viscosity < 0) throw "Error: FluidProperties::" + "viscosity" + " (" + viscosity + ") must be >= 0";
			this.zpp_inner.viscosity = viscosity / ("viscosity" == "density"?1000:1);
			this.zpp_inner.invalidate();
		}
		return this.get_viscosity();
	}
	,get_viscosity: function() {
		return this.zpp_inner.viscosity * ("viscosity" == "density"?1000:1);
	}
	,set_density: function(density) {
		if(density != this.get_density()) {
			if(density != density) throw "Error: FluidProperties::" + "density" + " cannot be NaN";
			if("density" != "density" && density < 0) throw "Error: FluidProperties::" + "density" + " (" + density + ") must be >= 0";
			this.zpp_inner.density = density / ("density" == "density"?1000:1);
			this.zpp_inner.invalidate();
		}
		return this.get_density();
	}
	,get_density: function() {
		return this.zpp_inner.density * ("density" == "density"?1000:1);
	}
	,__class__: nape.phys.FluidProperties
}
nape.phys.GravMassMode = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "GravMassMode" + " derp!";
};
$hxClasses["nape.phys.GravMassMode"] = nape.phys.GravMassMode;
nape.phys.GravMassMode.__name__ = ["nape","phys","GravMassMode"];
nape.phys.GravMassMode.get_DEFAULT = function() {
	if(zpp_nape.util.ZPP_Flags.GravMassMode_DEFAULT == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.GravMassMode_DEFAULT = new nape.phys.GravMassMode();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.GravMassMode_DEFAULT;
}
nape.phys.GravMassMode.get_FIXED = function() {
	if(zpp_nape.util.ZPP_Flags.GravMassMode_FIXED == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.GravMassMode_FIXED = new nape.phys.GravMassMode();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.GravMassMode_FIXED;
}
nape.phys.GravMassMode.get_SCALED = function() {
	if(zpp_nape.util.ZPP_Flags.GravMassMode_SCALED == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.GravMassMode_SCALED = new nape.phys.GravMassMode();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.GravMassMode_SCALED;
}
nape.phys.GravMassMode.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.phys.GravMassMode.get_DEFAULT()) return "DEFAULT"; else if(this == nape.phys.GravMassMode.get_FIXED()) return "FIXED"; else if(this == nape.phys.GravMassMode.get_SCALED()) return "SCALED"; else return "";
	}
	,__class__: nape.phys.GravMassMode
}
nape.phys.InertiaMode = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "InertiaMode" + " derp!";
};
$hxClasses["nape.phys.InertiaMode"] = nape.phys.InertiaMode;
nape.phys.InertiaMode.__name__ = ["nape","phys","InertiaMode"];
nape.phys.InertiaMode.get_DEFAULT = function() {
	if(zpp_nape.util.ZPP_Flags.InertiaMode_DEFAULT == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.InertiaMode_DEFAULT = new nape.phys.InertiaMode();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.InertiaMode_DEFAULT;
}
nape.phys.InertiaMode.get_FIXED = function() {
	if(zpp_nape.util.ZPP_Flags.InertiaMode_FIXED == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.InertiaMode_FIXED = new nape.phys.InertiaMode();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.InertiaMode_FIXED;
}
nape.phys.InertiaMode.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.phys.InertiaMode.get_DEFAULT()) return "DEFAULT"; else if(this == nape.phys.InertiaMode.get_FIXED()) return "FIXED"; else return "";
	}
	,__class__: nape.phys.InertiaMode
}
nape.phys.InteractorIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_InteractorList.internal) throw "Error: Cannot instantiate " + "Interactor" + "Iterator derp!";
};
$hxClasses["nape.phys.InteractorIterator"] = nape.phys.InteractorIterator;
nape.phys.InteractorIterator.__name__ = ["nape","phys","InteractorIterator"];
nape.phys.InteractorIterator.get = function(list) {
	var ret = nape.phys.InteractorIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_InteractorList.internal = true;
		var ret1 = new nape.phys.InteractorIterator();
		zpp_nape.util.ZPP_InteractorList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.phys.InteractorIterator.zpp_pool;
		nape.phys.InteractorIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.phys.InteractorIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.phys.InteractorIterator.zpp_pool;
			nape.phys.InteractorIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.phys.InteractorIterator
}
nape.phys.InteractorList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_InteractorList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.phys.InteractorList"] = nape.phys.InteractorList;
nape.phys.InteractorList.__name__ = ["nape","phys","InteractorList"];
nape.phys.InteractorList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.phys.InteractorIterator.get(this);
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().outer_i;
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.phys.InteractorList
}
nape.phys.MassMode = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "MassMode" + " derp!";
};
$hxClasses["nape.phys.MassMode"] = nape.phys.MassMode;
nape.phys.MassMode.__name__ = ["nape","phys","MassMode"];
nape.phys.MassMode.get_DEFAULT = function() {
	if(zpp_nape.util.ZPP_Flags.MassMode_DEFAULT == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.MassMode_DEFAULT = new nape.phys.MassMode();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.MassMode_DEFAULT;
}
nape.phys.MassMode.get_FIXED = function() {
	if(zpp_nape.util.ZPP_Flags.MassMode_FIXED == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.MassMode_FIXED = new nape.phys.MassMode();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.MassMode_FIXED;
}
nape.phys.MassMode.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.phys.MassMode.get_DEFAULT()) return "DEFAULT"; else if(this == nape.phys.MassMode.get_FIXED()) return "FIXED"; else return "";
	}
	,__class__: nape.phys.MassMode
}
nape.phys.Material = function(elasticity,dynamicFriction,staticFriction,density,rollingFriction) {
	if(rollingFriction == null) rollingFriction = 0.001;
	if(density == null) density = 1;
	if(staticFriction == null) staticFriction = 2.0;
	if(dynamicFriction == null) dynamicFriction = 1.0;
	if(elasticity == null) elasticity = 0.0;
	this.zpp_inner = null;
	if(zpp_nape.phys.ZPP_Material.zpp_pool == null) this.zpp_inner = new zpp_nape.phys.ZPP_Material(); else {
		this.zpp_inner = zpp_nape.phys.ZPP_Material.zpp_pool;
		zpp_nape.phys.ZPP_Material.zpp_pool = this.zpp_inner.next;
		this.zpp_inner.next = null;
	}
	this.zpp_inner.alloc();
	this.zpp_inner.outer = this;
	this.set_elasticity(elasticity);
	this.set_dynamicFriction(dynamicFriction);
	this.set_staticFriction(staticFriction);
	this.set_density(density);
	this.set_rollingFriction(rollingFriction);
};
$hxClasses["nape.phys.Material"] = nape.phys.Material;
nape.phys.Material.__name__ = ["nape","phys","Material"];
nape.phys.Material.prototype = {
	toString: function() {
		return "{ elasticity: " + this.get_elasticity() + " dynamicFriction: " + this.get_dynamicFriction() + " staticFriction: " + this.get_staticFriction() + " density: " + this.get_density() + " rollingFriction: " + this.get_rollingFriction() + " }";
	}
	,set_rollingFriction: function(rollingFriction) {
		if(rollingFriction != this.get_rollingFriction()) {
			if(rollingFriction != rollingFriction) throw "Error: Material::" + "rollingFriction" + " cannot be NaN";
			if("rollingFriction" == "density" && rollingFriction < 0) throw "Error: Material::density must be positive";
			if("rollingFriction" != "elasticity" && rollingFriction < 0) throw "Error: Material::" + "rollingFriction" + " cannot be negative";
			this.zpp_inner.rollingFriction = rollingFriction / ("rollingFriction" == "density"?1000:1);
			this.zpp_inner.invalidate(zpp_nape.phys.ZPP_Material.WAKE | zpp_nape.phys.ZPP_Material.ARBITERS);
		}
		return this.get_rollingFriction();
	}
	,get_rollingFriction: function() {
		return this.zpp_inner.rollingFriction * ("rollingFriction" == "density"?1000:1);
	}
	,set_density: function(density) {
		if(density != this.get_density()) {
			if(density != density) throw "Error: Material::" + "density" + " cannot be NaN";
			if("density" == "density" && density < 0) throw "Error: Material::density must be positive";
			if("density" != "elasticity" && density < 0) throw "Error: Material::" + "density" + " cannot be negative";
			this.zpp_inner.density = density / ("density" == "density"?1000:1);
			this.zpp_inner.invalidate(zpp_nape.phys.ZPP_Material.WAKE | zpp_nape.phys.ZPP_Material.PROPS);
		}
		return this.get_density();
	}
	,get_density: function() {
		return this.zpp_inner.density * ("density" == "density"?1000:1);
	}
	,set_staticFriction: function(staticFriction) {
		if(staticFriction != this.get_staticFriction()) {
			if(staticFriction != staticFriction) throw "Error: Material::" + "staticFriction" + " cannot be NaN";
			if("staticFriction" == "density" && staticFriction < 0) throw "Error: Material::density must be positive";
			if("staticFriction" != "elasticity" && staticFriction < 0) throw "Error: Material::" + "staticFriction" + " cannot be negative";
			this.zpp_inner.staticFriction = staticFriction / ("staticFriction" == "density"?1000:1);
			this.zpp_inner.invalidate(zpp_nape.phys.ZPP_Material.WAKE | zpp_nape.phys.ZPP_Material.ARBITERS);
		}
		return this.get_staticFriction();
	}
	,get_staticFriction: function() {
		return this.zpp_inner.staticFriction * ("staticFriction" == "density"?1000:1);
	}
	,set_dynamicFriction: function(dynamicFriction) {
		if(dynamicFriction != this.get_dynamicFriction()) {
			if(dynamicFriction != dynamicFriction) throw "Error: Material::" + "dynamicFriction" + " cannot be NaN";
			if("dynamicFriction" == "density" && dynamicFriction < 0) throw "Error: Material::density must be positive";
			if("dynamicFriction" != "elasticity" && dynamicFriction < 0) throw "Error: Material::" + "dynamicFriction" + " cannot be negative";
			this.zpp_inner.dynamicFriction = dynamicFriction / ("dynamicFriction" == "density"?1000:1);
			this.zpp_inner.invalidate(zpp_nape.phys.ZPP_Material.WAKE | zpp_nape.phys.ZPP_Material.ANGDRAG | zpp_nape.phys.ZPP_Material.ARBITERS);
		}
		return this.get_dynamicFriction();
	}
	,get_dynamicFriction: function() {
		return this.zpp_inner.dynamicFriction * ("dynamicFriction" == "density"?1000:1);
	}
	,set_elasticity: function(elasticity) {
		if(elasticity != this.get_elasticity()) {
			if(elasticity != elasticity) throw "Error: Material::" + "elasticity" + " cannot be NaN";
			if("elasticity" == "density" && elasticity < 0) throw "Error: Material::density must be positive";
			if("elasticity" != "elasticity" && elasticity < 0) throw "Error: Material::" + "elasticity" + " cannot be negative";
			this.zpp_inner.elasticity = elasticity / ("elasticity" == "density"?1000:1);
			this.zpp_inner.invalidate(zpp_nape.phys.ZPP_Material.WAKE | zpp_nape.phys.ZPP_Material.ARBITERS);
		}
		return this.get_elasticity();
	}
	,get_elasticity: function() {
		return this.zpp_inner.elasticity * ("elasticity" == "density"?1000:1);
	}
	,__class__: nape.phys.Material
}
nape.shape = {}
nape.shape.Shape = function() {
	this.zpp_inner = null;
	try {
		nape.phys.Interactor.call(this);
	} catch( e ) {
	}
	throw "Error: Shape cannot be instantiated derp!";
};
$hxClasses["nape.shape.Shape"] = nape.shape.Shape;
nape.shape.Shape.__name__ = ["nape","shape","Shape"];
nape.shape.Shape.__super__ = nape.phys.Interactor;
nape.shape.Shape.prototype = $extend(nape.phys.Interactor.prototype,{
	toString: function() {
		var ret = this.isCircle()?"Circle":"Polygon";
		return ret + "#" + this.get_id();
	}
	,copy: function() {
		return this.zpp_inner.copy();
	}
	,transform: function(matrix) {
		this.zpp_inner.immutable_midstep("Shape::transform()");
		if(this.zpp_inner.body != null && this.zpp_inner.body.space != null && this.zpp_inner.body.isStatic()) throw "Error: Cannot modify Shape belonging to a static Object once inside a Space";
		if(matrix == null) throw "Error: Cannot transform Shape by null matrix";
		if(matrix.singular()) throw "Error: Cannot transform Shape by a singular matrix";
		if(this.isCircle()) {
			if(matrix.equiorthogonal()) this.zpp_inner.circle.__transform(matrix); else throw "Error: Cannot transform Circle by a non equiorthogonal matrix";
		} else this.zpp_inner.polygon.__transform(matrix);
		return this;
	}
	,translate: function(translation) {
		this.zpp_inner.immutable_midstep("Shape::translate()");
		if(translation != null && translation.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		if(this.zpp_inner.body != null && this.zpp_inner.body.space != null && this.zpp_inner.body.isStatic()) throw "Error: Cannot modify Shape belonging to a static Object once inside a Space";
		if(translation == null) throw "Error: Cannot displace Shape by null Vec2";
		if(translation.lsq() > 0) {
			if(this.isCircle()) this.zpp_inner.circle.__translate(translation.get_x(),translation.get_y()); else this.zpp_inner.polygon.__translate(translation.get_x(),translation.get_y());
		}
		if(translation.zpp_inner.weak) {
			translation.dispose();
			true;
		} else false;
		return this;
	}
	,get_sensorEnabled: function() {
		return this.zpp_inner.sensorEnabled;
	}
	,set_fluidEnabled: function(fluidEnabled) {
		this.zpp_inner.immutable_midstep("Shape::fluidEnabled");
		this.zpp_inner.fluidEnabled = fluidEnabled;
		if(fluidEnabled && this.zpp_inner.fluidProperties == null) this.set_fluidProperties(new nape.phys.FluidProperties());
		this.zpp_inner.wake();
		return this.get_fluidEnabled();
	}
	,get_fluidEnabled: function() {
		return this.zpp_inner.fluidEnabled;
	}
	,set_fluidProperties: function(fluidProperties) {
		if(fluidProperties == null) throw "Error: Cannot assign null as Shape fluidProperties, disable fluids by setting fluidEnabled to false";
		this.zpp_inner.setFluid(fluidProperties.zpp_inner);
		return this.get_fluidProperties();
	}
	,get_fluidProperties: function() {
		this.zpp_inner.immutable_midstep("Shape::fluidProperties");
		if(this.zpp_inner.fluidProperties == null) this.zpp_inner.setFluid(new nape.phys.FluidProperties().zpp_inner);
		return this.zpp_inner.fluidProperties.wrapper();
	}
	,set_filter: function(filter) {
		this.zpp_inner.immutable_midstep("Shape::filter");
		if(filter == null) throw "Error: Cannot assign null as Shape filter";
		this.zpp_inner.setFilter(filter.zpp_inner);
		return this.get_filter();
	}
	,get_filter: function() {
		return this.zpp_inner.filter.wrapper();
	}
	,set_material: function(material) {
		this.zpp_inner.immutable_midstep("Shape::material");
		if(material == null) throw "Error: Cannot assign null as Shape material";
		this.zpp_inner.setMaterial(material.zpp_inner);
		return this.get_material();
	}
	,get_material: function() {
		return this.zpp_inner.material.wrapper();
	}
	,get_localCOM: function() {
		if(this.zpp_inner.wrap_localCOM == null) {
			if(this.isCircle()) this.zpp_inner.circle.setupLocalCOM(); else this.zpp_inner.polygon.setupLocalCOM();
		}
		return this.zpp_inner.wrap_localCOM;
	}
	,set_body: function(body) {
		this.zpp_inner.immutable_midstep("Shape::body");
		if(this.get_body() != body) {
			if(this.zpp_inner.body != null) this.get_body().get_shapes().remove(this);
			if(body != null) body.get_shapes().add(this);
		}
		return this.get_body();
	}
	,get_body: function() {
		return this.zpp_inner.body != null?this.zpp_inner.body.outer:null;
	}
	,isPolygon: function() {
		return this.zpp_inner.isPolygon();
	}
	,isCircle: function() {
		return this.zpp_inner.isCircle();
	}
	,__class__: nape.shape.Shape
});
nape.shape.Circle = function(radius,localCOM,material,filter) {
	this.zpp_inner_zn = null;
	try {
		nape.shape.Shape.call(this);
	} catch( e ) {
	}
	this.zpp_inner_zn = new zpp_nape.shape.ZPP_Circle();
	this.zpp_inner_zn.outer = this;
	this.zpp_inner_zn.outer_zn = this;
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner_i = this.zpp_inner;
	this.zpp_inner_i.outer_i = this;
	this.set_radius(radius);
	if(localCOM == null) {
		this.zpp_inner.localCOMx = 0;
		this.zpp_inner.localCOMy = 0;
	} else {
		if(localCOM != null && localCOM.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
		this.zpp_inner.localCOMx = localCOM.get_x();
		this.zpp_inner.localCOMy = localCOM.get_y();
		if(localCOM.zpp_inner.weak) {
			localCOM.dispose();
			true;
		} else false;
	}
	if(material == null) {
		if(zpp_nape.phys.ZPP_Material.zpp_pool == null) this.zpp_inner.material = new zpp_nape.phys.ZPP_Material(); else {
			this.zpp_inner.material = zpp_nape.phys.ZPP_Material.zpp_pool;
			zpp_nape.phys.ZPP_Material.zpp_pool = this.zpp_inner.material.next;
			this.zpp_inner.material.next = null;
		}
		this.zpp_inner.material.alloc();
	} else this.set_material(material);
	if(filter == null) {
		if(zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool == null) this.zpp_inner.filter = new zpp_nape.dynamics.ZPP_InteractionFilter(); else {
			this.zpp_inner.filter = zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool;
			zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool = this.zpp_inner.filter.next;
			this.zpp_inner.filter.next = null;
		}
		this.zpp_inner.filter.alloc();
	} else this.set_filter(filter);
	this.zpp_inner_i.insert_cbtype(nape.callbacks.CbType.get_ANY_SHAPE().zpp_inner);
};
$hxClasses["nape.shape.Circle"] = nape.shape.Circle;
nape.shape.Circle.__name__ = ["nape","shape","Circle"];
nape.shape.Circle.__super__ = nape.shape.Shape;
nape.shape.Circle.prototype = $extend(nape.shape.Shape.prototype,{
	set_radius: function(radius) {
		this.zpp_inner.immutable_midstep("Circle::radius");
		if(this.zpp_inner.body != null && this.zpp_inner.body.isStatic() && this.zpp_inner.body.space != null) throw "Error: Cannot modifiy radius of Circle contained in static object once added to space";
		if(radius != this.get_radius()) {
			if(radius != radius) throw "Error: Circle::radius cannot be NaN";
			if(radius < nape.Config.epsilon) throw "Error: Circle::radius (" + radius + ") must be > Config.epsilon";
			if(radius > 1e100) throw "Error: Circle::radius (" + radius + ") must be < PR(Const).FMAX";
			this.zpp_inner_zn.radius = radius;
			this.zpp_inner_zn.invalidate_radius();
		}
		return this.get_radius();
	}
	,get_radius: function() {
		return this.zpp_inner_zn.radius;
	}
	,__class__: nape.shape.Circle
});
nape.shape.Edge = function() {
	this.zpp_inner = null;
	if(!zpp_nape.shape.ZPP_Edge.internal) throw "Error: Cannot instantiate an Edge derp!";
};
$hxClasses["nape.shape.Edge"] = nape.shape.Edge;
nape.shape.Edge.__name__ = ["nape","shape","Edge"];
nape.shape.Edge.prototype = {
	toString: function() {
		if(this.zpp_inner.polygon == null) return "Edge(object-pooled)"; else if(this.zpp_inner.polygon.body == null) {
			this.zpp_inner.polygon.validate_laxi();
			return "{ localNormal : " + ("{ x: " + this.zpp_inner.lnormx + " y: " + this.zpp_inner.lnormy + " }") + " }";
		} else {
			this.zpp_inner.polygon.validate_gaxi();
			return "{ localNormal : " + ("{ x: " + this.zpp_inner.lnormx + " y: " + this.zpp_inner.lnormy + " }") + " worldNormal : " + ("{ x: " + this.zpp_inner.gnormx + " y: " + this.zpp_inner.gnormy + " }") + " }";
		}
	}
	,__class__: nape.shape.Edge
}
nape.shape.EdgeIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_EdgeList.internal) throw "Error: Cannot instantiate " + "Edge" + "Iterator derp!";
};
$hxClasses["nape.shape.EdgeIterator"] = nape.shape.EdgeIterator;
nape.shape.EdgeIterator.__name__ = ["nape","shape","EdgeIterator"];
nape.shape.EdgeIterator.get = function(list) {
	var ret = nape.shape.EdgeIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_EdgeList.internal = true;
		var ret1 = new nape.shape.EdgeIterator();
		zpp_nape.util.ZPP_EdgeList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.shape.EdgeIterator.zpp_pool;
		nape.shape.EdgeIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.shape.EdgeIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.shape.EdgeIterator.zpp_pool;
			nape.shape.EdgeIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.shape.EdgeIterator
}
nape.shape.EdgeList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_EdgeList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.shape.EdgeList"] = nape.shape.EdgeList;
nape.shape.EdgeList.__name__ = ["nape","shape","EdgeList"];
nape.shape.EdgeList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.shape.EdgeIterator.get(this);
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = index == this.get_length() - 1?index:this.get_length() - 2 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().wrapper();
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.shape.EdgeList
}
nape.shape.Polygon = function(localVerts,material,filter) {
	this.zpp_inner_zn = null;
	try {
		nape.shape.Shape.call(this);
	} catch( e ) {
	}
	if(localVerts == null) throw "Error: localVerts cannot be null";
	this.zpp_inner_zn = new zpp_nape.shape.ZPP_Polygon();
	this.zpp_inner_zn.outer = this;
	this.zpp_inner_zn.outer_zn = this;
	this.zpp_inner = this.zpp_inner_zn;
	this.zpp_inner_i = this.zpp_inner;
	this.zpp_inner_i.outer_i = this;
	if(Std["is"](localVerts,Array)) {
		var lv = localVerts;
		var _g = 0;
		while(_g < lv.length) {
			var vite = lv[_g];
			++_g;
			if(vite == null) throw "Error: Array<Vec2> contains null objects";
			if(!Std["is"](vite,nape.geom.Vec2)) throw "Error: Array<Vec2> contains non Vec2 objects";
			var x = vite;
			if(x != null && x.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
			this.get_localVerts().push(x.copy());
		}
	} else if(false) {
	} else if(Std["is"](localVerts,nape.geom.Vec2List)) {
		var lv = localVerts;
		var $it0 = lv.iterator();
		while( $it0.hasNext() ) {
			var x = $it0.next();
			if(x == null) throw "Error: Vec2List contains null objects";
			if(x != null && x.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
			this.get_localVerts().push(x.copy());
		}
	} else if(Std["is"](localVerts,nape.geom.GeomPoly)) {
		var lv = localVerts;
		if(lv != null && lv.zpp_disp) throw "Error: " + "GeomPoly" + " has been disposed and cannot be used!";
		var verts = lv.zpp_inner.vertices;
		if(verts != null) {
			var vite = verts;
			do {
				var x = nape.geom.Vec2.get(vite.x,vite.y);
				vite = vite.next;
				this.get_localVerts().push(x.copy());
				x.dispose();
			} while(vite != verts);
		}
	} else throw "Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>";
	if(Std["is"](localVerts,Array)) {
		var lv = localVerts;
		var i = 0;
		while(i < lv.length) {
			var cur = lv[i];
			if(cur.zpp_inner.weak?(function($this) {
				var $r;
				cur.dispose();
				$r = true;
				return $r;
			}(this)):false) {
				lv.splice(i,1);
				continue;
			}
			i++;
		}
	} else if(false) {
	} else if(Std["is"](localVerts,nape.geom.Vec2List)) {
		var lv = localVerts;
		if(lv.zpp_inner._validate != null) lv.zpp_inner._validate();
		var ins = lv.zpp_inner.inner;
		var pre = null;
		var cur = ins.begin();
		while(cur != null) {
			var x = cur.elem();
			if(x.outer.zpp_inner.weak) {
				cur = ins.erase(pre);
				if(x.outer.zpp_inner.weak) {
					x.outer.dispose();
					true;
				} else false;
			} else {
				pre = cur;
				cur = cur.next;
			}
		}
	}
	if(material == null) {
		if(zpp_nape.phys.ZPP_Material.zpp_pool == null) this.zpp_inner.material = new zpp_nape.phys.ZPP_Material(); else {
			this.zpp_inner.material = zpp_nape.phys.ZPP_Material.zpp_pool;
			zpp_nape.phys.ZPP_Material.zpp_pool = this.zpp_inner.material.next;
			this.zpp_inner.material.next = null;
		}
		this.zpp_inner.material.alloc();
	} else this.set_material(material);
	if(filter == null) {
		if(zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool == null) this.zpp_inner.filter = new zpp_nape.dynamics.ZPP_InteractionFilter(); else {
			this.zpp_inner.filter = zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool;
			zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool = this.zpp_inner.filter.next;
			this.zpp_inner.filter.next = null;
		}
		this.zpp_inner.filter.alloc();
	} else this.set_filter(filter);
	this.zpp_inner_i.insert_cbtype(nape.callbacks.CbType.get_ANY_SHAPE().zpp_inner);
};
$hxClasses["nape.shape.Polygon"] = nape.shape.Polygon;
nape.shape.Polygon.__name__ = ["nape","shape","Polygon"];
nape.shape.Polygon.rect = function(x,y,width,height,weak) {
	if(weak == null) weak = false;
	if(x != x || y != y || width != width || height != height) throw "Error: Polygon.rect cannot accept NaN arguments";
	return [nape.geom.Vec2.get(x,y,weak),nape.geom.Vec2.get(x + width,y,weak),nape.geom.Vec2.get(x + width,y + height,weak),nape.geom.Vec2.get(x,y + height,weak)];
}
nape.shape.Polygon.__super__ = nape.shape.Shape;
nape.shape.Polygon.prototype = $extend(nape.shape.Shape.prototype,{
	get_localVerts: function() {
		if(this.zpp_inner_zn.wrap_lverts == null) this.zpp_inner_zn.getlverts();
		return this.zpp_inner_zn.wrap_lverts;
	}
	,__class__: nape.shape.Polygon
});
nape.shape.ShapeIterator = function() {
	this.zpp_next = null;
	this.zpp_critical = false;
	this.zpp_i = 0;
	this.zpp_inner = null;
	if(!zpp_nape.util.ZPP_ShapeList.internal) throw "Error: Cannot instantiate " + "Shape" + "Iterator derp!";
};
$hxClasses["nape.shape.ShapeIterator"] = nape.shape.ShapeIterator;
nape.shape.ShapeIterator.__name__ = ["nape","shape","ShapeIterator"];
nape.shape.ShapeIterator.get = function(list) {
	var ret = nape.shape.ShapeIterator.zpp_pool == null?(function($this) {
		var $r;
		zpp_nape.util.ZPP_ShapeList.internal = true;
		var ret1 = new nape.shape.ShapeIterator();
		zpp_nape.util.ZPP_ShapeList.internal = false;
		$r = ret1;
		return $r;
	}(this)):(function($this) {
		var $r;
		var r = nape.shape.ShapeIterator.zpp_pool;
		nape.shape.ShapeIterator.zpp_pool = r.zpp_next;
		$r = r;
		return $r;
	}(this));
	ret.zpp_i = 0;
	ret.zpp_inner = list;
	ret.zpp_critical = false;
	return ret;
}
nape.shape.ShapeIterator.prototype = {
	next: function() {
		this.zpp_critical = false;
		return this.zpp_inner.at(this.zpp_i++);
	}
	,hasNext: function() {
		this.zpp_inner.zpp_inner.valmod();
		var length = this.zpp_inner.get_length();
		this.zpp_critical = true;
		if(this.zpp_i < length) return true; else {
			this.zpp_next = nape.shape.ShapeIterator.zpp_pool;
			nape.shape.ShapeIterator.zpp_pool = this;
			this.zpp_inner = null;
			return false;
		}
	}
	,__class__: nape.shape.ShapeIterator
}
nape.shape.ShapeList = function() {
	this.zpp_inner = null;
	this.zpp_inner = new zpp_nape.util.ZPP_ShapeList();
	this.zpp_inner.outer = this;
};
$hxClasses["nape.shape.ShapeList"] = nape.shape.ShapeList;
nape.shape.ShapeList.__name__ = ["nape","shape","ShapeList"];
nape.shape.ShapeList.prototype = {
	toString: function() {
		var ret = "[";
		var fst = true;
		var $it0 = this.iterator();
		while( $it0.hasNext() ) {
			var i = $it0.next();
			if(!fst) ret += ",";
			ret += i == null?"NULL":i.toString();
			fst = false;
		}
		return ret + "]";
	}
	,iterator: function() {
		this.zpp_inner.valmod();
		return nape.shape.ShapeIterator.get(this);
	}
	,empty: function() {
		if(false) return this.get_length() == 0; else return this.zpp_inner.inner.empty();
	}
	,remove: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Shape" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var ret;
		ret = false;
		var cx_ite = this.zpp_inner.inner.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(x == obj.zpp_inner) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(ret) {
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(obj);
			if(!this.zpp_inner.dontremove) this.zpp_inner.inner.remove(obj.zpp_inner);
			this.zpp_inner.invalidate();
		}
		return ret;
	}
	,add: function(obj) {
		return this.zpp_inner.reverse_flag?this.push(obj):this.unshift(obj);
	}
	,unshift: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Shape" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			} else this.zpp_inner.inner.add(obj.zpp_inner);
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,push: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Shape" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_inner.valmod();
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) this.zpp_inner.inner.add(obj.zpp_inner); else {
				if(this.zpp_inner.push_ite == null) this.zpp_inner.push_ite = this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length() - 1);
				this.zpp_inner.push_ite = this.zpp_inner.inner.insert(this.zpp_inner.push_ite,obj.zpp_inner);
			}
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,at: function(index) {
		this.zpp_inner.valmod();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(!false) {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = index;
				this.zpp_inner.at_ite = this.zpp_inner.inner.iterator_at(index);
			} else while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
			}
		} else {
			if(index < this.zpp_inner.at_index || this.zpp_inner.at_ite == null) {
				this.zpp_inner.at_index = 0;
				this.zpp_inner.at_ite = this.zpp_inner.inner.begin();
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
			while(this.zpp_inner.at_index != index) {
				this.zpp_inner.at_index++;
				this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				while(true) {
					var x = this.zpp_inner.at_ite.elem();
					if(true) break;
					this.zpp_inner.at_ite = this.zpp_inner.at_ite.next;
				}
			}
		}
		return this.zpp_inner.at_ite.elem().outer;
	}
	,get_length: function() {
		this.zpp_inner.valmod();
		if(this.zpp_inner.zip_length) {
			this.zpp_inner.zip_length = false;
			if(false) {
				this.zpp_inner.user_length = 0;
				var cx_ite = this.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(true) this.zpp_inner.user_length++;
					cx_ite = cx_ite.next;
				}
			} else this.zpp_inner.user_length = this.zpp_inner.inner.length;
		}
		return this.zpp_inner.user_length;
	}
	,__class__: nape.shape.ShapeList
}
nape.shape.ShapeType = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "ShapeType" + " derp!";
};
$hxClasses["nape.shape.ShapeType"] = nape.shape.ShapeType;
nape.shape.ShapeType.__name__ = ["nape","shape","ShapeType"];
nape.shape.ShapeType.get_CIRCLE = function() {
	if(zpp_nape.util.ZPP_Flags.ShapeType_CIRCLE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ShapeType_CIRCLE = new nape.shape.ShapeType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ShapeType_CIRCLE;
}
nape.shape.ShapeType.get_POLYGON = function() {
	if(zpp_nape.util.ZPP_Flags.ShapeType_POLYGON == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ShapeType_POLYGON = new nape.shape.ShapeType();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ShapeType_POLYGON;
}
nape.shape.ShapeType.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.shape.ShapeType.get_CIRCLE()) return "CIRCLE"; else if(this == nape.shape.ShapeType.get_POLYGON()) return "POLYGON"; else return "";
	}
	,__class__: nape.shape.ShapeType
}
nape.shape.ValidationResult = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "ValidationResult" + " derp!";
};
$hxClasses["nape.shape.ValidationResult"] = nape.shape.ValidationResult;
nape.shape.ValidationResult.__name__ = ["nape","shape","ValidationResult"];
nape.shape.ValidationResult.get_VALID = function() {
	if(zpp_nape.util.ZPP_Flags.ValidationResult_VALID == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ValidationResult_VALID = new nape.shape.ValidationResult();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ValidationResult_VALID;
}
nape.shape.ValidationResult.get_DEGENERATE = function() {
	if(zpp_nape.util.ZPP_Flags.ValidationResult_DEGENERATE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ValidationResult_DEGENERATE = new nape.shape.ValidationResult();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ValidationResult_DEGENERATE;
}
nape.shape.ValidationResult.get_CONCAVE = function() {
	if(zpp_nape.util.ZPP_Flags.ValidationResult_CONCAVE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ValidationResult_CONCAVE = new nape.shape.ValidationResult();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ValidationResult_CONCAVE;
}
nape.shape.ValidationResult.get_SELF_INTERSECTING = function() {
	if(zpp_nape.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING = new nape.shape.ValidationResult();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING;
}
nape.shape.ValidationResult.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.shape.ValidationResult.get_VALID()) return "VALID"; else if(this == nape.shape.ValidationResult.get_DEGENERATE()) return "DEGENERATE"; else if(this == nape.shape.ValidationResult.get_CONCAVE()) return "CONCAVE"; else if(this == nape.shape.ValidationResult.get_SELF_INTERSECTING()) return "SELF_INTERSECTING"; else return "";
	}
	,__class__: nape.shape.ValidationResult
}
nape.space = {}
nape.space.Broadphase = function() {
	if(!zpp_nape.util.ZPP_Flags.internal) throw "Error: Cannot instantiate " + "Broadphase" + " derp!";
};
$hxClasses["nape.space.Broadphase"] = nape.space.Broadphase;
nape.space.Broadphase.__name__ = ["nape","space","Broadphase"];
nape.space.Broadphase.get_DYNAMIC_AABB_TREE = function() {
	if(zpp_nape.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE = new nape.space.Broadphase();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE;
}
nape.space.Broadphase.get_SWEEP_AND_PRUNE = function() {
	if(zpp_nape.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE == null) {
		zpp_nape.util.ZPP_Flags.internal = true;
		zpp_nape.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE = new nape.space.Broadphase();
		zpp_nape.util.ZPP_Flags.internal = false;
	}
	return zpp_nape.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE;
}
nape.space.Broadphase.prototype = {
	toString: function() {
		if(false) return ""; else if(this == nape.space.Broadphase.get_DYNAMIC_AABB_TREE()) return "DYNAMIC_AABB_TREE"; else if(this == nape.space.Broadphase.get_SWEEP_AND_PRUNE()) return "SWEEP_AND_PRUNE"; else return "";
	}
	,__class__: nape.space.Broadphase
}
nape.space.Space = function(gravity,broadphase) {
	this.zpp_inner = null;
	if(gravity != null && gravity.zpp_disp) throw "Error: " + "Vec2" + " has been disposed and cannot be used!";
	this.zpp_inner = new zpp_nape.space.ZPP_Space(gravity == null?null:gravity.zpp_inner,broadphase);
	this.zpp_inner.outer = this;
	if(gravity != null) {
		if(gravity.zpp_inner.weak) {
			gravity.dispose();
			true;
		} else false;
	}
};
$hxClasses["nape.space.Space"] = nape.space.Space;
nape.space.Space.__name__ = ["nape","space","Space"];
nape.space.Space.prototype = {
	step: function(deltaTime,velocityIterations,positionIterations) {
		if(positionIterations == null) positionIterations = 10;
		if(velocityIterations == null) velocityIterations = 10;
		if(deltaTime != deltaTime) throw "Error: deltaTime cannot be NaN";
		if(deltaTime <= 0) throw "Error: deltaTime must be strictly positive";
		if(velocityIterations <= 0) throw "Error: must use atleast one velocity iteration";
		if(positionIterations <= 0) throw "Error: must use atleast one position iteration";
		this.zpp_inner.step(deltaTime,velocityIterations,positionIterations);
	}
	,get_listeners: function() {
		return this.zpp_inner.wrap_listeners;
	}
	,get_constraints: function() {
		return this.zpp_inner.wrap_constraints;
	}
	,get_bodies: function() {
		return this.zpp_inner.wrap_bodies;
	}
	,get_compounds: function() {
		return this.zpp_inner.wrap_compounds;
	}
	,get_worldLinearDrag: function() {
		return this.zpp_inner.global_lin_drag;
	}
	,get_worldAngularDrag: function() {
		return this.zpp_inner.global_ang_drag;
	}
	,get_sortContacts: function() {
		return this.zpp_inner.sortcontacts;
	}
	,get_gravity: function() {
		if(this.zpp_inner.wrap_gravity == null) this.zpp_inner.getgravity();
		return this.zpp_inner.wrap_gravity;
	}
	,__class__: nape.space.Space
}
zpp_nape.ZPP_Const = function() { }
$hxClasses["zpp_nape.ZPP_Const"] = zpp_nape.ZPP_Const;
zpp_nape.ZPP_Const.__name__ = ["zpp_nape","ZPP_Const"];
zpp_nape.ZPP_Const.POSINF = function() {
	return Math.POSITIVE_INFINITY;
}
zpp_nape.ZPP_Const.NEGINF = function() {
	return Math.NEGATIVE_INFINITY;
}
zpp_nape.callbacks.ZPP_Callback = function() {
	this.constraint = null;
	this.body = null;
	this.pre_swapped = false;
	this.pre_arbiter = null;
	this.wrap_arbiters = null;
	this.set = null;
	this.int2 = null;
	this.int1 = null;
	this.length = 0;
	this.prev = null;
	this.next = null;
	this.listener = null;
	this.event = 0;
	this.outer_int = null;
	this.outer_con = null;
	this.outer_body = null;
	this.length = 0;
};
$hxClasses["zpp_nape.callbacks.ZPP_Callback"] = zpp_nape.callbacks.ZPP_Callback;
zpp_nape.callbacks.ZPP_Callback.__name__ = ["zpp_nape","callbacks","ZPP_Callback"];
zpp_nape.callbacks.ZPP_Callback.prototype = {
	genarbs: function() {
		if(this.wrap_arbiters == null) this.wrap_arbiters = zpp_nape.util.ZPP_ArbiterList.get(this.set.arbiters,true); else this.wrap_arbiters.zpp_inner.inner = this.set.arbiters;
		this.wrap_arbiters.zpp_inner.zip_length = true;
		this.wrap_arbiters.zpp_inner.at_ite = null;
	}
	,alloc: function() {
	}
	,free: function() {
		this.int1 = this.int2 = null;
		this.body = null;
		this.constraint = null;
		this.listener = null;
		if(this.wrap_arbiters != null) this.wrap_arbiters.zpp_inner.inner = null;
		this.set = null;
	}
	,empty: function() {
		return this.next == null;
	}
	,pop: function() {
		var ret = this.next;
		this.next = ret.next;
		if(this.next == null) this.prev = null; else this.next.prev = null;
		this.length--;
		return ret;
	}
	,push: function(obj) {
		if(this.prev != null) this.prev.next = obj; else this.next = obj;
		obj.prev = this.prev;
		obj.next = null;
		this.prev = obj;
		this.length++;
	}
	,wrapper_int: function() {
		if(this.outer_int == null) {
			zpp_nape.callbacks.ZPP_Callback.internal = true;
			this.outer_int = new nape.callbacks.InteractionCallback();
			zpp_nape.callbacks.ZPP_Callback.internal = false;
			this.outer_int.zpp_inner = this;
		}
		this.genarbs();
		return this.outer_int;
	}
	,wrapper_con: function() {
		if(this.outer_con == null) {
			zpp_nape.callbacks.ZPP_Callback.internal = true;
			this.outer_con = new nape.callbacks.ConstraintCallback();
			zpp_nape.callbacks.ZPP_Callback.internal = false;
			this.outer_con.zpp_inner = this;
		}
		return this.outer_con;
	}
	,wrapper_body: function() {
		if(this.outer_body == null) {
			zpp_nape.callbacks.ZPP_Callback.internal = true;
			this.outer_body = new nape.callbacks.BodyCallback();
			zpp_nape.callbacks.ZPP_Callback.internal = false;
			this.outer_body.zpp_inner = this;
		}
		return this.outer_body;
	}
	,__class__: zpp_nape.callbacks.ZPP_Callback
}
zpp_nape.callbacks.ZPP_CbSet = function() {
	this.constraints = null;
	this.interactors = null;
	this.zip_conlisteners = false;
	this.conlisteners = null;
	this.zip_bodylisteners = false;
	this.bodylisteners = null;
	this.zip_listeners = false;
	this.listeners = null;
	this.cbpairs = null;
	this.manager = null;
	this.id = 0;
	this.next = null;
	this.count = 0;
	this.cbTypes = null;
	this.cbTypes = new zpp_nape.util.ZNPList_ZPP_CbType();
	this.listeners = new zpp_nape.util.ZNPList_ZPP_InteractionListener();
	this.zip_listeners = true;
	this.bodylisteners = new zpp_nape.util.ZNPList_ZPP_BodyListener();
	this.zip_bodylisteners = true;
	this.conlisteners = new zpp_nape.util.ZNPList_ZPP_ConstraintListener();
	this.zip_conlisteners = true;
	this.constraints = new zpp_nape.util.ZNPList_ZPP_Constraint();
	this.interactors = new zpp_nape.util.ZNPList_ZPP_Interactor();
	this.id = zpp_nape.ZPP_ID.CbSet();
	this.cbpairs = new zpp_nape.util.ZNPList_ZPP_CbSetPair();
};
$hxClasses["zpp_nape.callbacks.ZPP_CbSet"] = zpp_nape.callbacks.ZPP_CbSet;
zpp_nape.callbacks.ZPP_CbSet.__name__ = ["zpp_nape","callbacks","ZPP_CbSet"];
zpp_nape.callbacks.ZPP_CbSet.setlt = function(a,b) {
	var i = a.cbTypes.begin();
	var j = b.cbTypes.begin();
	while(i != null && j != null) {
		var ca = i.elem();
		var cb = j.elem();
		if(zpp_nape.callbacks.ZPP_CbType.setlt(ca,cb)) return true;
		if(zpp_nape.callbacks.ZPP_CbType.setlt(cb,ca)) return false; else {
			i = i.next;
			j = j.next;
		}
	}
	return j != null && i == null;
}
zpp_nape.callbacks.ZPP_CbSet.get = function(cbTypes) {
	var ret;
	if(zpp_nape.callbacks.ZPP_CbSet.zpp_pool == null) ret = new zpp_nape.callbacks.ZPP_CbSet(); else {
		ret = zpp_nape.callbacks.ZPP_CbSet.zpp_pool;
		zpp_nape.callbacks.ZPP_CbSet.zpp_pool = ret.next;
		ret.next = null;
	}
	ret.alloc();
	var ite = null;
	var cx_ite = cbTypes.begin();
	while(cx_ite != null) {
		var cb = cx_ite.elem();
		ite = ret.cbTypes.insert(ite,cb);
		cb.cbsets.add(ret);
		cx_ite = cx_ite.next;
	}
	return ret;
}
zpp_nape.callbacks.ZPP_CbSet.empty_intersection = function(a,b) {
	return a.manager.pair(a,b).empty_intersection();
}
zpp_nape.callbacks.ZPP_CbSet.single_intersection = function(a,b,i) {
	return a.manager.pair(a,b).single_intersection(i);
}
zpp_nape.callbacks.ZPP_CbSet.find_all = function(a,b,event,cb) {
	a.manager.pair(a,b).forall(event,cb);
}
zpp_nape.callbacks.ZPP_CbSet.prototype = {
	alloc: function() {
	}
	,free: function() {
		this.listeners.clear();
		this.zip_listeners = true;
		this.bodylisteners.clear();
		this.zip_bodylisteners = true;
		this.conlisteners.clear();
		this.zip_conlisteners = true;
		while(!this.cbTypes.empty()) {
			var cb = this.cbTypes.pop_unsafe();
			cb.cbsets.remove(this);
		}
	}
	,remInteractor: function(intx) {
		this.interactors.remove(intx);
	}
	,remConstraint: function(con) {
		this.constraints.remove(con);
	}
	,addInteractor: function(intx) {
		this.interactors.add(intx);
	}
	,addConstraint: function(con) {
		this.constraints.add(con);
	}
	,validate: function() {
		this.validate_listeners();
		this.validate_bodylisteners();
		this.validate_conlisteners();
	}
	,realvalidate_conlisteners: function() {
		this.conlisteners.clear();
		var cx_ite = this.cbTypes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			var npre = null;
			var nite = this.conlisteners.begin();
			var cite = cb.conlisteners.begin();
			while(cite != null) {
				var cx = cite.elem();
				if(nite != null && nite.elem() == cx) {
					cite = cite.next;
					npre = nite;
					nite = nite.next;
				} else if(nite == null || zpp_nape.callbacks.ZPP_Listener.setlt(cx,nite.elem())) {
					if(!cx.options.excluded(this.cbTypes) && this.manager.valid_listener(cx)) npre = this.conlisteners.inlined_insert(npre,cx);
					cite = cite.next;
				} else {
					npre = nite;
					nite = nite.next;
				}
			}
			cx_ite = cx_ite.next;
		}
	}
	,validate_conlisteners: function() {
		if(this.zip_conlisteners) {
			this.zip_conlisteners = false;
			this.realvalidate_conlisteners();
		}
	}
	,invalidate_conlisteners: function() {
		this.zip_conlisteners = true;
	}
	,realvalidate_bodylisteners: function() {
		this.bodylisteners.clear();
		var cx_ite = this.cbTypes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			var npre = null;
			var nite = this.bodylisteners.begin();
			var cite = cb.bodylisteners.begin();
			while(cite != null) {
				var cx = cite.elem();
				if(nite != null && nite.elem() == cx) {
					cite = cite.next;
					npre = nite;
					nite = nite.next;
				} else if(nite == null || zpp_nape.callbacks.ZPP_Listener.setlt(cx,nite.elem())) {
					if(!cx.options.excluded(this.cbTypes) && this.manager.valid_listener(cx)) npre = this.bodylisteners.inlined_insert(npre,cx);
					cite = cite.next;
				} else {
					npre = nite;
					nite = nite.next;
				}
			}
			cx_ite = cx_ite.next;
		}
	}
	,validate_bodylisteners: function() {
		if(this.zip_bodylisteners) {
			this.zip_bodylisteners = false;
			this.realvalidate_bodylisteners();
		}
	}
	,invalidate_bodylisteners: function() {
		this.zip_bodylisteners = true;
	}
	,realvalidate_listeners: function() {
		this.listeners.clear();
		var cx_ite = this.cbTypes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			var npre = null;
			var nite = this.listeners.begin();
			var cite = cb.listeners.begin();
			while(cite != null) {
				var cx = cite.elem();
				if(nite != null && nite.elem() == cx) {
					cite = cite.next;
					npre = nite;
					nite = nite.next;
				} else if(nite == null || zpp_nape.callbacks.ZPP_Listener.setlt(cx,nite.elem())) {
					if(true && this.manager.valid_listener(cx)) npre = this.listeners.inlined_insert(npre,cx);
					cite = cite.next;
				} else {
					npre = nite;
					nite = nite.next;
				}
			}
			cx_ite = cx_ite.next;
		}
	}
	,validate_listeners: function() {
		if(this.zip_listeners) {
			this.zip_listeners = false;
			this.realvalidate_listeners();
		}
	}
	,invalidate_listeners: function() {
		this.zip_listeners = true;
		this.invalidate_pairs();
	}
	,invalidate_pairs: function() {
		var cx_ite = this.cbpairs.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.invalidate();
			cx_ite = cx_ite.next;
		}
	}
	,decrement: function() {
		return --this.count == 0;
	}
	,increment: function() {
		this.count++;
	}
	,__class__: zpp_nape.callbacks.ZPP_CbSet
}
zpp_nape.callbacks.ZPP_CbSetPair = function() {
	this.listeners = null;
	this.zip_listeners = false;
	this.next = null;
	this.b = null;
	this.a = null;
	this.listeners = new zpp_nape.util.ZNPList_ZPP_InteractionListener();
};
$hxClasses["zpp_nape.callbacks.ZPP_CbSetPair"] = zpp_nape.callbacks.ZPP_CbSetPair;
zpp_nape.callbacks.ZPP_CbSetPair.__name__ = ["zpp_nape","callbacks","ZPP_CbSetPair"];
zpp_nape.callbacks.ZPP_CbSetPair.get = function(a,b) {
	var ret;
	if(zpp_nape.callbacks.ZPP_CbSetPair.zpp_pool == null) ret = new zpp_nape.callbacks.ZPP_CbSetPair(); else {
		ret = zpp_nape.callbacks.ZPP_CbSetPair.zpp_pool;
		zpp_nape.callbacks.ZPP_CbSetPair.zpp_pool = ret.next;
		ret.next = null;
	}
	ret.alloc();
	if(zpp_nape.callbacks.ZPP_CbSet.setlt(a,b)) {
		ret.a = a;
		ret.b = b;
	} else {
		ret.a = b;
		ret.b = a;
	}
	return ret;
}
zpp_nape.callbacks.ZPP_CbSetPair.setlt = function(x,y) {
	return zpp_nape.callbacks.ZPP_CbSet.setlt(x.a,y.a) || x.a == y.a && zpp_nape.callbacks.ZPP_CbSet.setlt(x.b,y.b);
}
zpp_nape.callbacks.ZPP_CbSetPair.prototype = {
	forall: function(event,cb) {
		var cx_ite = this.listeners.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(x.event == event) cb(x);
			cx_ite = cx_ite.next;
		}
	}
	,single_intersection: function(i) {
		var ite = this.listeners.begin();
		return ite != null && ite.elem() == i && ite.next == null;
	}
	,empty_intersection: function() {
		return this.listeners.empty();
	}
	,__validate: function() {
		this.listeners.clear();
		var aite = this.a.listeners.begin();
		var bite = this.b.listeners.begin();
		while(aite != null && bite != null) {
			var ax = aite.elem();
			var bx = bite.elem();
			if(ax == bx) {
				if(this.compatible(ax)) this.listeners.add(ax);
				aite = aite.next;
				bite = bite.next;
			} else if(zpp_nape.callbacks.ZPP_Listener.setlt(ax,bx)) aite = aite.next; else bite = bite.next;
		}
	}
	,validate: function() {
		if(this.zip_listeners) {
			this.zip_listeners = false;
			this.__validate();
		}
	}
	,invalidate: function() {
		this.zip_listeners = true;
	}
	,compatible: function(i) {
		return i.options1.compatible(this.a.cbTypes) && i.options2.compatible(this.b.cbTypes) || i.options2.compatible(this.a.cbTypes) && i.options1.compatible(this.b.cbTypes);
	}
	,alloc: function() {
		this.zip_listeners = true;
	}
	,free: function() {
		this.a = this.b = null;
		this.listeners.clear();
	}
	,__class__: zpp_nape.callbacks.ZPP_CbSetPair
}
zpp_nape.callbacks.ZPP_Listener = function() {
	this.space = null;
	this.interaction = null;
	this.constraint = null;
	this.body = null;
	this.precedence = 0;
	this.event = 0;
	this.type = 0;
	this.id = 0;
	this.outer = null;
	this.id = zpp_nape.ZPP_ID.Listener();
};
$hxClasses["zpp_nape.callbacks.ZPP_Listener"] = zpp_nape.callbacks.ZPP_Listener;
zpp_nape.callbacks.ZPP_Listener.__name__ = ["zpp_nape","callbacks","ZPP_Listener"];
zpp_nape.callbacks.ZPP_Listener.setlt = function(a,b) {
	return a.precedence > b.precedence || a.precedence == b.precedence && a.id > b.id;
}
zpp_nape.callbacks.ZPP_Listener.prototype = {
	removedFromSpace: function() {
	}
	,addedToSpace: function() {
	}
	,invalidate_precedence: function() {
	}
	,swapEvent: function(event) {
	}
	,__class__: zpp_nape.callbacks.ZPP_Listener
}
zpp_nape.callbacks.ZPP_BodyListener = function() {
	this.handler = null;
	this.options = null;
	this.outer_zn = null;
};
$hxClasses["zpp_nape.callbacks.ZPP_BodyListener"] = zpp_nape.callbacks.ZPP_BodyListener;
zpp_nape.callbacks.ZPP_BodyListener.__name__ = ["zpp_nape","callbacks","ZPP_BodyListener"];
zpp_nape.callbacks.ZPP_BodyListener.__super__ = zpp_nape.callbacks.ZPP_Listener;
zpp_nape.callbacks.ZPP_BodyListener.prototype = $extend(zpp_nape.callbacks.ZPP_Listener.prototype,{
	swapEvent: function(newev) {
		if(newev != zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE && newev != zpp_nape.util.ZPP_Flags.id_CbEvent_SLEEP) throw "Error: BodyListener event must be either WAKE or SLEEP only";
		this.removedFromSpace();
		this.event = newev;
		this.addedToSpace();
	}
	,invalidate_precedence: function() {
		if(this.space != null) {
			this.removedFromSpace();
			this.addedToSpace();
		}
	}
	,cbtype_change: function(cb,included,added) {
		this.removedFromSpace();
		this.options.effect_change(cb,included,added);
		this.addedToSpace();
	}
	,removedFromSpace: function() {
		var cx_ite = this.options.includes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.removebody(this);
			cx_ite = cx_ite.next;
		}
		this.options.handler = null;
	}
	,addedToSpace: function() {
		this.options.handler = $bind(this,this.cbtype_change);
		var cx_ite = this.options.includes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.addbody(this);
			cx_ite = cx_ite.next;
		}
	}
	,__class__: zpp_nape.callbacks.ZPP_BodyListener
});
zpp_nape.callbacks.ZPP_ConstraintListener = function() {
	this.handler = null;
	this.options = null;
	this.outer_zn = null;
};
$hxClasses["zpp_nape.callbacks.ZPP_ConstraintListener"] = zpp_nape.callbacks.ZPP_ConstraintListener;
zpp_nape.callbacks.ZPP_ConstraintListener.__name__ = ["zpp_nape","callbacks","ZPP_ConstraintListener"];
zpp_nape.callbacks.ZPP_ConstraintListener.__super__ = zpp_nape.callbacks.ZPP_Listener;
zpp_nape.callbacks.ZPP_ConstraintListener.prototype = $extend(zpp_nape.callbacks.ZPP_Listener.prototype,{
	swapEvent: function(newev) {
		if(newev != zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE && newev != zpp_nape.util.ZPP_Flags.id_CbEvent_SLEEP && newev != zpp_nape.util.ZPP_Flags.id_CbEvent_BREAK) throw "Error: ConstraintListener event must be either WAKE or SLEEP only";
		this.removedFromSpace();
		this.event = newev;
		this.addedToSpace();
	}
	,invalidate_precedence: function() {
		if(this.space != null) {
			this.removedFromSpace();
			this.addedToSpace();
		}
	}
	,cbtype_change: function(cb,included,added) {
		this.removedFromSpace();
		this.options.effect_change(cb,included,added);
		this.addedToSpace();
	}
	,removedFromSpace: function() {
		var cx_ite = this.options.includes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.removeconstraint(this);
			cx_ite = cx_ite.next;
		}
		this.options.handler = null;
	}
	,addedToSpace: function() {
		this.options.handler = $bind(this,this.cbtype_change);
		var cx_ite = this.options.includes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.addconstraint(this);
			cx_ite = cx_ite.next;
		}
	}
	,__class__: zpp_nape.callbacks.ZPP_ConstraintListener
});
zpp_nape.util.ZNPList_ZPP_CbType = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_CbType"] = zpp_nape.util.ZNPList_ZPP_CbType;
zpp_nape.util.ZNPList_ZPP_CbType.__name__ = ["zpp_nape","util","ZNPList_ZPP_CbType"];
zpp_nape.util.ZNPList_ZPP_CbType.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,inlined_has: function(obj) {
		var ret;
		ret = false;
		var cx_ite = this.begin();
		while(cx_ite != null) {
			var npite = cx_ite.elem();
			if(npite == obj) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		return ret;
	}
	,has: function(obj) {
		return this.inlined_has(obj);
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_clear: function() {
		if(true) {
			while(!this.empty()) this.inlined_pop();
			this.pushmod = true;
		}
	}
	,clear: function() {
		this.inlined_clear();
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_CbType(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_CbType(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_CbType.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_CbType
}
zpp_nape.callbacks.ZPP_InteractionListener = function(options1,options2,event,type) {
	this.handlerp = null;
	this.pure = false;
	this.allowSleepingCallbacks = false;
	this.handleri = null;
	this.options2 = null;
	this.options1 = null;
	this.itype = 0;
	this.outer_znp = null;
	this.outer_zni = null;
	zpp_nape.callbacks.ZPP_Listener.call(this);
	this.type = type;
	this.interaction = this;
	this.event = event;
	this.options1 = options1.zpp_inner;
	this.options2 = options2.zpp_inner;
	this.allowSleepingCallbacks = false;
};
$hxClasses["zpp_nape.callbacks.ZPP_InteractionListener"] = zpp_nape.callbacks.ZPP_InteractionListener;
zpp_nape.callbacks.ZPP_InteractionListener.__name__ = ["zpp_nape","callbacks","ZPP_InteractionListener"];
zpp_nape.callbacks.ZPP_InteractionListener.__super__ = zpp_nape.callbacks.ZPP_Listener;
zpp_nape.callbacks.ZPP_InteractionListener.prototype = $extend(zpp_nape.callbacks.ZPP_Listener.prototype,{
	swapEvent: function(newev) {
		if(this.type == zpp_nape.util.ZPP_Flags.id_ListenerType_PRE) throw "Error: PreListener event can only be PRE"; else if(newev != zpp_nape.util.ZPP_Flags.id_CbEvent_BEGIN && newev != zpp_nape.util.ZPP_Flags.id_CbEvent_END && newev != zpp_nape.util.ZPP_Flags.id_CbEvent_ONGOING) throw "Error: InteractionListener event must be either BEGIN, END, ONGOING";
		this.removedFromSpace();
		this.event = newev;
		this.addedToSpace();
	}
	,cbtype_change: function(options,cb,included,added) {
		this.space.revoke_listener(this);
		this.removedFromSpace();
		options.effect_change(cb,included,added);
		this.addedToSpace();
		this.space.unrevoke_listener(this);
	}
	,cbtype_change2: function(cb,included,added) {
		this.cbtype_change(this.options2,cb,included,added);
	}
	,cbtype_change1: function(cb,included,added) {
		this.cbtype_change(this.options1,cb,included,added);
	}
	,invalidate_precedence: function() {
		var _g = this;
		if(this.space != null) {
			var pre = this.type == zpp_nape.util.ZPP_Flags.id_ListenerType_PRE;
			this.with_union(function(cb) {
				cb.removeint(_g);
				cb.addint(_g);
				if(pre) {
					var cx_ite = cb.interactors.begin();
					while(cx_ite != null) {
						var i = cx_ite.elem();
						i.wake();
						cx_ite = cx_ite.next;
					}
				}
			});
		}
	}
	,removedFromSpace: function() {
		var _g = this;
		this.with_uniquesets(false);
		var pre = this.type == zpp_nape.util.ZPP_Flags.id_ListenerType_PRE;
		this.with_union(function(cb) {
			cb.removeint(_g);
			if(pre) {
				var cx_ite = cb.interactors.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					i.wake();
					cx_ite = cx_ite.next;
				}
			}
		});
		this.options1.handler = null;
		this.options2.handler = null;
	}
	,addedToSpace: function() {
		var _g = this;
		var pre = this.type == zpp_nape.util.ZPP_Flags.id_ListenerType_PRE;
		this.with_union(function(cb) {
			cb.addint(_g);
			if(pre) {
				var cx_ite = cb.interactors.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					i.wake();
					cx_ite = cx_ite.next;
				}
			}
		});
		this.options1.handler = $bind(this,this.cbtype_change1);
		this.options2.handler = $bind(this,this.cbtype_change2);
		this.with_uniquesets(true);
	}
	,with_union: function(lambda) {
		var ite1 = this.options1.includes.begin();
		var ite2 = this.options2.includes.begin();
		while(ite1 != null && ite2 != null) {
			var cb1 = ite1.elem();
			var cb2 = ite2.elem();
			if(cb1 == cb2) {
				lambda(cb1);
				ite1 = ite1.next;
				ite2 = ite2.next;
			} else if(zpp_nape.callbacks.ZPP_CbType.setlt(cb1,cb2)) {
				lambda(cb1);
				ite1 = ite1.next;
			} else {
				lambda(cb2);
				ite2 = ite2.next;
			}
		}
		while(ite1 != null) {
			lambda(ite1.elem());
			ite1 = ite1.next;
		}
		while(ite2 != null) {
			lambda(ite2.elem());
			ite2 = ite2.next;
		}
	}
	,with_uniquesets: function(fresh) {
		var _g = this;
		var set;
		if(zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool == null) set = new zpp_nape.util.ZPP_Set_ZPP_CbSetPair(); else {
			set = zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool;
			zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool = set.next;
			set.next = null;
		}
		set.alloc();
		set.lt = zpp_nape.callbacks.ZPP_CbSetPair.setlt;
		this.CbTypeset(this.options1.includes,this.options2.includes,function(a,b) {
			_g.CbSetset(a.cbsets,b.cbsets,function(a1,b1) {
				a1.validate();
				b1.validate();
				if(zpp_nape.callbacks.ZPP_CbSet.single_intersection(a1,b1,_g)) set.try_insert(zpp_nape.callbacks.ZPP_CbSetPair.get(a1,b1));
			});
		});
		set.clear_with(function(pair) {
			if(fresh) _g.space.freshListenerType(pair.a,pair.b); else _g.space.nullListenerType(pair.a,pair.b);
			var o = pair;
			o.free();
			o.next = zpp_nape.callbacks.ZPP_CbSetPair.zpp_pool;
			zpp_nape.callbacks.ZPP_CbSetPair.zpp_pool = o;
		});
		var o = set;
		o.free();
		o.next = zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool;
		zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool = o;
	}
	,CbTypeset: function(A,B,lambda) {
		var U = zpp_nape.callbacks.ZPP_InteractionListener.UCbType;
		var V = zpp_nape.callbacks.ZPP_InteractionListener.VCbType;
		var W = zpp_nape.callbacks.ZPP_InteractionListener.WCbType;
		var aite = A.begin();
		var bite = B.begin();
		while(aite != null && bite != null) {
			var a = aite.elem();
			var b = bite.elem();
			if(a == b) {
				W.inlined_add(a);
				aite = aite.next;
				bite = bite.next;
			} else if(zpp_nape.callbacks.ZPP_CbType.setlt(a,b)) {
				U.inlined_add(a);
				aite = aite.next;
			} else {
				V.inlined_add(b);
				bite = bite.next;
			}
		}
		while(aite != null) {
			U.inlined_add(aite.elem());
			aite = aite.next;
		}
		while(bite != null) {
			V.inlined_add(bite.elem());
			bite = bite.next;
		}
		while(!U.empty()) {
			var x = U.pop_unsafe();
			var cx_ite = B.begin();
			while(cx_ite != null) {
				var y = cx_ite.elem();
				lambda(x,y);
				cx_ite = cx_ite.next;
			}
		}
		while(!V.empty()) {
			var x = V.pop_unsafe();
			var cx_ite = W.begin();
			while(cx_ite != null) {
				var y = cx_ite.elem();
				lambda(x,y);
				cx_ite = cx_ite.next;
			}
		}
		while(!W.empty()) {
			var x = W.pop_unsafe();
			lambda(x,x);
			var cx_ite = W.begin();
			while(cx_ite != null) {
				var y = cx_ite.elem();
				lambda(x,y);
				cx_ite = cx_ite.next;
			}
		}
	}
	,CbSetset: function(A,B,lambda) {
		var U = zpp_nape.callbacks.ZPP_InteractionListener.UCbSet;
		var V = zpp_nape.callbacks.ZPP_InteractionListener.VCbSet;
		var W = zpp_nape.callbacks.ZPP_InteractionListener.WCbSet;
		var aite = A.begin();
		var bite = B.begin();
		while(aite != null && bite != null) {
			var a = aite.elem();
			var b = bite.elem();
			if(a == b) {
				W.inlined_add(a);
				aite = aite.next;
				bite = bite.next;
			} else if(zpp_nape.callbacks.ZPP_CbSet.setlt(a,b)) {
				U.inlined_add(a);
				aite = aite.next;
			} else {
				V.inlined_add(b);
				bite = bite.next;
			}
		}
		while(aite != null) {
			U.inlined_add(aite.elem());
			aite = aite.next;
		}
		while(bite != null) {
			V.inlined_add(bite.elem());
			bite = bite.next;
		}
		while(!U.empty()) {
			var x = U.pop_unsafe();
			var cx_ite = B.begin();
			while(cx_ite != null) {
				var y = cx_ite.elem();
				lambda(x,y);
				cx_ite = cx_ite.next;
			}
		}
		while(!V.empty()) {
			var x = V.pop_unsafe();
			var cx_ite = W.begin();
			while(cx_ite != null) {
				var y = cx_ite.elem();
				lambda(x,y);
				cx_ite = cx_ite.next;
			}
		}
		while(!W.empty()) {
			var x = W.pop_unsafe();
			lambda(x,x);
			var cx_ite = W.begin();
			while(cx_ite != null) {
				var y = cx_ite.elem();
				lambda(x,y);
				cx_ite = cx_ite.next;
			}
		}
	}
	,wake: function() {
		this.with_union(function(cb) {
			var cx_ite = cb.interactors.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				i.wake();
				cx_ite = cx_ite.next;
			}
		});
	}
	,setInteractionType: function(itype) {
		this.itype = itype;
	}
	,__class__: zpp_nape.callbacks.ZPP_InteractionListener
});
zpp_nape.callbacks.ZPP_OptionType = function() {
	this.wrap_excludes = null;
	this.wrap_includes = null;
	this.excludes = null;
	this.includes = null;
	this.handler = null;
	this.outer = null;
	this.includes = new zpp_nape.util.ZNPList_ZPP_CbType();
	this.excludes = new zpp_nape.util.ZNPList_ZPP_CbType();
};
$hxClasses["zpp_nape.callbacks.ZPP_OptionType"] = zpp_nape.callbacks.ZPP_OptionType;
zpp_nape.callbacks.ZPP_OptionType.__name__ = ["zpp_nape","callbacks","ZPP_OptionType"];
zpp_nape.callbacks.ZPP_OptionType.argument = function(val) {
	return val == null?new nape.callbacks.OptionType():Std["is"](val,nape.callbacks.OptionType)?val:new nape.callbacks.OptionType().including(val);
}
zpp_nape.callbacks.ZPP_OptionType.prototype = {
	append: function(list,val) {
		if(val == null) throw "Error: Cannot append null, only CbType and CbType list values";
		if(Std["is"](val,nape.callbacks.CbType)) {
			var cb = val;
			this.append_type(list,cb.zpp_inner);
		} else if(Std["is"](val,nape.callbacks.CbTypeList)) {
			var cbs = val;
			var $it0 = cbs.iterator();
			while( $it0.hasNext() ) {
				var cb = $it0.next();
				this.append_type(list,cb.zpp_inner);
			}
		} else if(false) {
		} else if(Std["is"](val,Array)) {
			var cbs = val;
			var _g = 0;
			while(_g < cbs.length) {
				var cb = cbs[_g];
				++_g;
				if(!Std["is"](cb,nape.callbacks.CbType)) throw "Error: Cannot append non-CbType or CbType list value";
				var cbx = cb;
				this.append_type(list,cbx.zpp_inner);
			}
		} else throw "Error: Cannot append non-CbType or CbType list value";
	}
	,set: function(options) {
		if(options != this) {
			while(!this.includes.empty()) this.append_type(this.excludes,this.includes.front());
			while(!this.excludes.empty()) this.append_type(this.includes,this.excludes.front());
			var cx_ite = options.excludes.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				this.append_type(this.excludes,i);
				cx_ite = cx_ite.next;
			}
			var cx_ite = options.includes.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				this.append_type(this.includes,i);
				cx_ite = cx_ite.next;
			}
		}
		return this;
	}
	,append_type: function(list,val) {
		if(list == this.includes) {
			if(!this.includes.has(val)) {
				if(!this.excludes.has(val)) {
					if(this.handler != null) this.handler(val,true,true); else this.effect_change(val,true,true);
				} else if(this.handler != null) this.handler(val,false,false); else this.effect_change(val,false,false);
			}
		} else if(!this.excludes.has(val)) {
			if(!this.includes.has(val)) {
				if(this.handler != null) this.handler(val,false,true); else this.effect_change(val,false,true);
			} else if(this.handler != null) this.handler(val,true,false); else this.effect_change(val,true,false);
		}
	}
	,effect_change: function(val,included,added) {
		if(included) {
			if(added) {
				var pre = null;
				var cx_ite = this.includes.begin();
				while(cx_ite != null) {
					var j = cx_ite.elem();
					if(zpp_nape.callbacks.ZPP_CbType.setlt(val,j)) break;
					pre = cx_ite;
					cx_ite = cx_ite.next;
				}
				this.includes.inlined_insert(pre,val);
			} else this.includes.remove(val);
		} else if(added) {
			var pre = null;
			var cx_ite = this.excludes.begin();
			while(cx_ite != null) {
				var j = cx_ite.elem();
				if(zpp_nape.callbacks.ZPP_CbType.setlt(val,j)) break;
				pre = cx_ite;
				cx_ite = cx_ite.next;
			}
			this.excludes.inlined_insert(pre,val);
		} else this.excludes.remove(val);
	}
	,nonemptyintersection: function(xs,ys) {
		var ret = false;
		var xite = xs.begin();
		var eite = ys.begin();
		while(eite != null && xite != null) {
			var ex = eite.elem();
			var xi = xite.elem();
			if(ex == xi) {
				ret = true;
				break;
			} else if(zpp_nape.callbacks.ZPP_CbType.setlt(ex,xi)) eite = eite.next; else xite = xite.next;
		}
		return ret;
	}
	,compatible: function(xs) {
		return this.included(xs) && !this.excluded(xs);
	}
	,included: function(xs) {
		return this.nonemptyintersection(xs,this.includes);
	}
	,excluded: function(xs) {
		return this.nonemptyintersection(xs,this.excludes);
	}
	,setup_excludes: function() {
		this.wrap_excludes = zpp_nape.util.ZPP_CbTypeList.get(this.excludes,true);
	}
	,setup_includes: function() {
		this.wrap_includes = zpp_nape.util.ZPP_CbTypeList.get(this.includes,true);
	}
	,__class__: zpp_nape.callbacks.ZPP_OptionType
}
zpp_nape.constraint = {}
zpp_nape.constraint.ZPP_Constraint = function() {
	this.pre_dt = 0.0;
	this.wrap_cbTypes = null;
	this.cbSet = null;
	this.cbTypes = null;
	this.__velocity = false;
	this.ignore = false;
	this.component = null;
	this.removeOnBreak = false;
	this.breakUnderError = false;
	this.breakUnderForce = false;
	this.maxError = 0.0;
	this.maxForce = 0.0;
	this.damping = 0.0;
	this.frequency = 0.0;
	this.stiff = false;
	this.active = false;
	this.space = null;
	this.compound = null;
	this.userData = null;
	this.id = 0;
	this.outer = null;
	this.__velocity = false;
	this.id = zpp_nape.ZPP_ID.Constraint();
	this.stiff = true;
	this.active = true;
	this.ignore = false;
	this.frequency = 10;
	this.damping = 1;
	this.maxForce = zpp_nape.ZPP_Const.POSINF();
	this.maxError = zpp_nape.ZPP_Const.POSINF();
	this.breakUnderForce = false;
	this.removeOnBreak = true;
	this.pre_dt = -1.0;
	this.cbTypes = new zpp_nape.util.ZNPList_ZPP_CbType();
};
$hxClasses["zpp_nape.constraint.ZPP_Constraint"] = zpp_nape.constraint.ZPP_Constraint;
zpp_nape.constraint.ZPP_Constraint.__name__ = ["zpp_nape","constraint","ZPP_Constraint"];
zpp_nape.constraint.ZPP_Constraint.prototype = {
	copyto: function(ret) {
		var me = this.outer;
		var $it0 = me.get_cbTypes().iterator();
		while( $it0.hasNext() ) {
			var cb = $it0.next();
			ret.get_cbTypes().add(cb);
		}
		ret.set_removeOnBreak(me.get_removeOnBreak());
		ret.set_breakUnderError(me.get_breakUnderError());
		ret.set_breakUnderForce(me.get_breakUnderForce());
		ret.set_maxError(me.get_maxError());
		ret.set_maxForce(me.get_maxForce());
		ret.set_damping(me.get_damping());
		ret.set_frequency(me.get_frequency());
		ret.set_stiff(me.get_stiff());
		ret.set_ignore(me.get_ignore());
		ret.set_active(me.get_active());
	}
	,copy: function(dict,todo) {
		return null;
	}
	,draw: function(g) {
	}
	,wake: function() {
		if(this.space != null) this.space.wake_constraint(this);
	}
	,applyImpulsePos: function() {
		return false;
	}
	,applyImpulseVel: function() {
		return false;
	}
	,preStep: function(dt) {
		return false;
	}
	,warmStart: function() {
	}
	,broken: function() {
	}
	,pair_exists: function(id,di) {
		return false;
	}
	,forest: function() {
	}
	,wake_connected: function() {
	}
	,validate: function() {
	}
	,clearcache: function() {
	}
	,inactiveBodies: function() {
	}
	,activeBodies: function() {
	}
	,inactiveOrOutSpace: function() {
		this.dealloc_cbSet();
		var o = this.component;
		o.free();
		o.next = zpp_nape.space.ZPP_Component.zpp_pool;
		zpp_nape.space.ZPP_Component.zpp_pool = o;
		this.component = null;
	}
	,activeInSpace: function() {
		this.alloc_cbSet();
		if(zpp_nape.space.ZPP_Component.zpp_pool == null) this.component = new zpp_nape.space.ZPP_Component(); else {
			this.component = zpp_nape.space.ZPP_Component.zpp_pool;
			zpp_nape.space.ZPP_Component.zpp_pool = this.component.next;
			this.component.next = null;
		}
		this.component.alloc();
		this.component.isBody = false;
		this.component.constraint = this;
	}
	,removedFromSpace: function() {
		if(this.active) this.inactiveOrOutSpace();
		this.inactiveBodies();
		var cx_ite = this.cbTypes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.remConstraint(this);
			cx_ite = cx_ite.next;
		}
	}
	,addedToSpace: function() {
		if(this.active) this.activeInSpace();
		this.activeBodies();
		var cx_ite = this.cbTypes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.addConstraint(this);
			cx_ite = cx_ite.next;
		}
	}
	,deactivate: function() {
		if(this.space != null) this.inactiveOrOutSpace();
	}
	,activate: function() {
		if(this.space != null) this.activeInSpace();
	}
	,dealloc_cbSet: function() {
		if(this.cbSet != null) {
			this.cbSet.remConstraint(this);
			if(this.cbSet.decrement()) {
				this.space.cbsets.remove(this.cbSet);
				var o = this.cbSet;
				o.free();
				o.next = zpp_nape.callbacks.ZPP_CbSet.zpp_pool;
				zpp_nape.callbacks.ZPP_CbSet.zpp_pool = o;
			}
			this.cbSet = null;
		}
	}
	,alloc_cbSet: function() {
		if((this.cbSet = this.space.cbsets.get(this.cbTypes)) != null) {
			this.cbSet.increment();
			this.cbSet.addConstraint(this);
		}
	}
	,insert_cbtype: function(cb) {
		if(!this.cbTypes.has(cb)) {
			if(this.space != null) {
				this.dealloc_cbSet();
				cb.addConstraint(this);
			}
			var pre = null;
			var cx_ite = this.cbTypes.begin();
			while(cx_ite != null) {
				var j = cx_ite.elem();
				if(zpp_nape.callbacks.ZPP_CbType.setlt(cb,j)) break;
				pre = cx_ite;
				cx_ite = cx_ite.next;
			}
			this.cbTypes.inlined_insert(pre,cb);
			if(this.space != null) {
				this.alloc_cbSet();
				this.wake();
			}
		}
	}
	,wrap_cbTypes_adder: function(cb) {
		this.insert_cbtype(cb.zpp_inner);
		return false;
	}
	,wrap_cbTypes_subber: function(pcb) {
		var cb = pcb.zpp_inner;
		if(this.cbTypes.has(cb)) {
			if(this.space != null) {
				this.dealloc_cbSet();
				cb.remConstraint(this);
			}
			this.cbTypes.remove(cb);
			if(this.space != null) {
				this.alloc_cbSet();
				this.wake();
			}
		}
	}
	,immutable_cbTypes: function() {
		this.immutable_midstep("Constraint::cbTypes");
	}
	,setupcbTypes: function() {
		this.wrap_cbTypes = zpp_nape.util.ZPP_CbTypeList.get(this.cbTypes);
		this.wrap_cbTypes.zpp_inner.adder = $bind(this,this.wrap_cbTypes_adder);
		this.wrap_cbTypes.zpp_inner.subber = $bind(this,this.wrap_cbTypes_subber);
		this.wrap_cbTypes.zpp_inner.dontremove = true;
		this.wrap_cbTypes.zpp_inner._modifiable = $bind(this,this.immutable_cbTypes);
	}
	,immutable_midstep: function(name) {
		if(this.space != null && this.space.midstep) throw "Error: Constraint::" + name + " cannot be set during space step()";
	}
	,__class__: zpp_nape.constraint.ZPP_Constraint
}
zpp_nape.constraint.ZPP_AngleJoint = function() {
	this.stepped = false;
	this.bias = 0.0;
	this.gamma = 0.0;
	this.jMax = 0.0;
	this.jAcc = 0.0;
	this.kMass = 0.0;
	this.b2 = null;
	this.b1 = null;
	this.scale = 0.0;
	this.equal = false;
	this.slack = false;
	this.jointMax = 0.0;
	this.jointMin = 0.0;
	this.ratio = 0.0;
	this.outer_zn = null;
	zpp_nape.constraint.ZPP_Constraint.call(this);
	this.ratio = 1;
	this.jAcc = 0;
	this.slack = false;
	this.jMax = zpp_nape.ZPP_Const.POSINF();
	this.stepped = false;
};
$hxClasses["zpp_nape.constraint.ZPP_AngleJoint"] = zpp_nape.constraint.ZPP_AngleJoint;
zpp_nape.constraint.ZPP_AngleJoint.__name__ = ["zpp_nape","constraint","ZPP_AngleJoint"];
zpp_nape.constraint.ZPP_AngleJoint.__super__ = zpp_nape.constraint.ZPP_Constraint;
zpp_nape.constraint.ZPP_AngleJoint.prototype = $extend(zpp_nape.constraint.ZPP_Constraint.prototype,{
	draw: function(g) {
	}
	,applyImpulsePos: function() {
		var E;
		var j;
		var slack;
		E = (function($this) {
			var $r;
			var C = $this.ratio * $this.b2.rot - $this.b1.rot;
			if($this.equal) {
				C -= $this.jointMax;
				slack = false;
				$this.scale = 1.0;
			} else if(C < $this.jointMin) {
				C = $this.jointMin - C;
				$this.scale = -1.0;
				slack = false;
			} else if(C > $this.jointMax) {
				C -= $this.jointMax;
				$this.scale = 1.0;
				slack = false;
			} else {
				$this.scale = 0.0;
				C = 0;
				slack = true;
			}
			$r = C;
			return $r;
		}(this));
		if(!slack) {
			if(this.breakUnderError && E * E > this.maxError * this.maxError) return true;
			E *= 0.5;
			j = -E * this.kMass;
			if(this.equal || j < 0) {
				if(true) {
					this.b1.delta_rot(-this.scale * j * this.b1.iinertia);
					this.b2.delta_rot(this.ratio * this.scale * j * this.b2.iinertia);
				} else {
					this.b1.angvel -= this.scale * this.b1.iinertia * j;
					this.b2.angvel += this.ratio * this.scale * this.b2.iinertia * j;
				}
			}
		}
		return false;
	}
	,applyImpulseVel: function() {
		if(this.slack) return false;
		var E = this.scale * (this.ratio * (this.b2.angvel + this.b2.kinangvel) - this.b1.angvel - this.b1.kinangvel);
		var j = this.kMass * (this.bias - E) - this.jAcc * this.gamma;
		var jOld = this.jAcc;
		this.jAcc += j;
		if(!this.equal && this.jAcc > 0) this.jAcc = 0;
		if(this.breakUnderForce && (this.jAcc > this.jMax || this.jAcc < -this.jMax)) return true;
		if(!this.stiff) {
			if(this.jAcc > this.jMax) this.jAcc = this.jMax; else if(this.jAcc < -this.jMax) this.jAcc = -this.jMax;
		}
		j = this.jAcc - jOld;
		if(false) {
			this.b1.delta_rot(-this.scale * j * this.b1.iinertia);
			this.b2.delta_rot(this.ratio * this.scale * j * this.b2.iinertia);
		} else {
			this.b1.angvel -= this.scale * this.b1.iinertia * j;
			this.b2.angvel += this.ratio * this.scale * this.b2.iinertia * j;
		}
		return false;
	}
	,warmStart: function() {
		if(!this.slack) {
			if(false) {
				this.b1.delta_rot(-this.scale * this.jAcc * this.b1.iinertia);
				this.b2.delta_rot(this.ratio * this.scale * this.jAcc * this.b2.iinertia);
			} else {
				this.b1.angvel -= this.scale * this.b1.iinertia * this.jAcc;
				this.b2.angvel += this.ratio * this.scale * this.b2.iinertia * this.jAcc;
			}
		}
	}
	,preStep: function(dt) {
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		this.stepped = true;
		this.equal = this.jointMin == this.jointMax;
		var C = (function($this) {
			var $r;
			var C1 = $this.ratio * $this.b2.rot - $this.b1.rot;
			if($this.equal) {
				C1 -= $this.jointMax;
				$this.slack = false;
				$this.scale = 1.0;
			} else if(C1 < $this.jointMin) {
				C1 = $this.jointMin - C1;
				$this.scale = -1.0;
				$this.slack = false;
			} else if(C1 > $this.jointMax) {
				C1 -= $this.jointMax;
				$this.scale = 1.0;
				$this.slack = false;
			} else {
				$this.scale = 0.0;
				C1 = 0;
				$this.slack = true;
			}
			$r = C1;
			return $r;
		}(this));
		if(!this.slack) {
			this.kMass = this.b1.sinertia + this.ratio * this.ratio * this.b2.sinertia;
			if(this.kMass != 0) this.kMass = 1 / this.kMass; else this.jAcc = 0;
			if(!this.stiff) {
				if(this.breakUnderError && C * C > this.maxError * this.maxError) return true;
				var biasCoef;
				this.kMass *= (function($this) {
					var $r;
					var omega = 2 * Math.PI * $this.frequency;
					$this.gamma = 1 / (dt * omega * (2 * $this.damping + omega * dt));
					var ig = 1 / (1 + $this.gamma);
					biasCoef = dt * omega * omega * $this.gamma;
					$this.gamma *= ig;
					$r = ig;
					return $r;
				}(this));
				this.bias = -C * biasCoef;
				if(this.bias < -this.maxError) this.bias = -this.maxError; else if(this.bias > this.maxError) this.bias = this.maxError;
			} else {
				this.bias = 0;
				this.gamma = 0;
			}
			this.jAcc *= dtratio;
			this.jMax = this.maxForce * dt;
		}
		return false;
	}
	,clearcache: function() {
		this.jAcc = 0;
		this.pre_dt = -1.0;
		this.slack = false;
	}
	,pair_exists: function(id,di) {
		return this.b1.id == id && this.b2.id == di || this.b1.id == di && this.b2.id == id;
	}
	,forest: function() {
		if(this.b1.isDynamic()) {
			var xr = this.b1.component == this.b1.component.parent?this.b1.component:(function($this) {
				var $r;
				var obj = $this.b1.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
		if(this.b2.isDynamic()) {
			var xr = this.b2.component == this.b2.component.parent?this.b2.component:(function($this) {
				var $r;
				var obj = $this.b2.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
	}
	,wake_connected: function() {
		if(this.b1 != null && this.b1.isDynamic()) this.b1.wake();
		if(this.b2 != null && this.b2.isDynamic()) this.b2.wake();
	}
	,validate: function() {
		if(this.b1 == null || this.b2 == null) throw "Error: AngleJoint cannot be simulated null bodies";
		if(this.b1 == this.b2) throw "Error: AngleJoint cannot be simulated with body1 == body2";
		if(this.b1.space != this.space || this.b2.space != this.space) throw "Error: Constraints must have each body within the same space to which the constraint has been assigned";
		if(this.jointMin > this.jointMax) throw "Error: AngleJoint must have jointMin <= jointMax";
		if(!this.b1.isDynamic() && !this.b2.isDynamic()) throw "Error: Constraints cannot have both bodies non-dynamic";
	}
	,copy: function(dict,todo) {
		var ret = new nape.constraint.AngleJoint(null,null,this.jointMin,this.jointMax,this.ratio);
		this.copyto(ret);
		if(dict != null && this.b1 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b1.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b1 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b1.id,function(b1) {
				ret.zpp_inner_zn.b1 = b1.zpp_inner;
			}));
		}
		if(dict != null && this.b2 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b2.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b2 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b2.id,function(b1) {
				ret.zpp_inner_zn.b2 = b1.zpp_inner;
			}));
		}
		return ret;
	}
	,inactiveBodies: function() {
		if(this.b1 != null) this.b1.constraints.remove(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.remove(this);
		}
	}
	,activeBodies: function() {
		if(this.b1 != null) this.b1.constraints.add(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.add(this);
		}
	}
	,bodyImpulse: function(b) {
		if(this.stepped) {
			if(b == this.b1) return nape.geom.Vec3.get(0,0,-this.scale * this.jAcc); else return nape.geom.Vec3.get(0,0,this.ratio * this.scale * this.jAcc);
		} else return nape.geom.Vec3.get(0,0,0);
	}
	,__class__: zpp_nape.constraint.ZPP_AngleJoint
});
zpp_nape.constraint.ZPP_CopyHelper = function() {
	this.cb = null;
	this.bc = null;
	this.id = 0;
};
$hxClasses["zpp_nape.constraint.ZPP_CopyHelper"] = zpp_nape.constraint.ZPP_CopyHelper;
zpp_nape.constraint.ZPP_CopyHelper.__name__ = ["zpp_nape","constraint","ZPP_CopyHelper"];
zpp_nape.constraint.ZPP_CopyHelper.todo = function(id,cb) {
	var ret = new zpp_nape.constraint.ZPP_CopyHelper();
	ret.id = id;
	ret.cb = cb;
	return ret;
}
zpp_nape.constraint.ZPP_CopyHelper.prototype = {
	__class__: zpp_nape.constraint.ZPP_CopyHelper
}
zpp_nape.constraint.ZPP_DistanceJoint = function() {
	this.stepped = false;
	this.bias = 0.0;
	this.gamma = 0.0;
	this.jMax = 0.0;
	this.jAcc = 0.0;
	this.kMass = 0.0;
	this.wrap_a2 = null;
	this.a2rely = 0.0;
	this.a2relx = 0.0;
	this.a2localy = 0.0;
	this.a2localx = 0.0;
	this.b2 = null;
	this.wrap_a1 = null;
	this.a1rely = 0.0;
	this.a1relx = 0.0;
	this.a1localy = 0.0;
	this.a1localx = 0.0;
	this.b1 = null;
	this.cx2 = 0.0;
	this.cx1 = 0.0;
	this.ny = 0.0;
	this.nx = 0.0;
	this.equal = false;
	this.slack = false;
	this.jointMax = 0.0;
	this.jointMin = 0.0;
	this.outer_zn = null;
	zpp_nape.constraint.ZPP_Constraint.call(this);
	this.a1localx = 0;
	this.a1localy = 0;
	this.a1relx = 0;
	this.a1rely = 0;
	this.a2localx = 0;
	this.a2localy = 0;
	this.a2relx = 0;
	this.a2rely = 0;
	this.jAcc = 0;
	this.jMax = zpp_nape.ZPP_Const.POSINF();
	this.stepped = false;
	this.cx1 = this.cx2 = 0;
};
$hxClasses["zpp_nape.constraint.ZPP_DistanceJoint"] = zpp_nape.constraint.ZPP_DistanceJoint;
zpp_nape.constraint.ZPP_DistanceJoint.__name__ = ["zpp_nape","constraint","ZPP_DistanceJoint"];
zpp_nape.constraint.ZPP_DistanceJoint.__super__ = zpp_nape.constraint.ZPP_Constraint;
zpp_nape.constraint.ZPP_DistanceJoint.prototype = $extend(zpp_nape.constraint.ZPP_Constraint.prototype,{
	draw: function(g) {
	}
	,applyImpulsePos: function() {
		var E;
		var j;
		var r1x = 0.0;
		var r1y = 0.0;
		r1x = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		r1y = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		var r2x = 0.0;
		var r2y = 0.0;
		r2x = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		r2y = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		var slack;
		var nx = 0.0;
		var ny = 0.0;
		E = (function($this) {
			var $r;
			nx = $this.b2.posx + r2x - ($this.b1.posx + r1x);
			ny = $this.b2.posy + r2y - ($this.b1.posy + r1y);
			var C = nx * nx + ny * ny;
			if(C < nape.Config.epsilon) {
				nx = 0;
				ny = 0;
				C = 0;
				slack = true;
			} else {
				C = zpp_nape.util.ZPP_Math.sqrt(C);
				var t = 1.0 / C;
				nx *= t;
				ny *= t;
				if($this.equal) {
					C -= $this.jointMax;
					slack = false;
				} else if(C < $this.jointMin) {
					C = $this.jointMin - C;
					nx = -nx;
					ny = -ny;
					slack = false;
				} else if(C > $this.jointMax) {
					C -= $this.jointMax;
					slack = false;
				} else {
					nx = 0;
					ny = 0;
					C = 0;
					slack = true;
				}
			}
			$r = C;
			return $r;
		}(this));
		if(!slack) {
			if(this.breakUnderError && E * E > this.maxError * this.maxError) return true;
			if(E * E < nape.Config.constraintLinearSlop * nape.Config.constraintLinearSlop) return false;
			E *= 0.5;
			if(E * E > 6) {
				var k = this.b1.smass + this.b2.smass;
				if(k > nape.Config.epsilon) {
					k = 0.75 / k;
					j = -E * k;
					if(this.equal || j < 0) {
						var t = j * this.b1.imass;
						this.b1.posx -= nx * t;
						this.b1.posy -= ny * t;
						var t = j * this.b2.imass;
						this.b2.posx += nx * t;
						this.b2.posy += ny * t;
						E = (function($this) {
							var $r;
							nx = $this.b2.posx + r2x - ($this.b1.posx + r1x);
							ny = $this.b2.posy + r2y - ($this.b1.posy + r1y);
							var C = nx * nx + ny * ny;
							if(C < nape.Config.epsilon) {
								nx = 0;
								ny = 0;
								C = 0;
								slack = true;
							} else {
								C = zpp_nape.util.ZPP_Math.sqrt(C);
								var t = 1.0 / C;
								nx *= t;
								ny *= t;
								if($this.equal) {
									C -= $this.jointMax;
									slack = false;
								} else if(C < $this.jointMin) {
									C = $this.jointMin - C;
									nx = -nx;
									ny = -ny;
									slack = false;
								} else if(C > $this.jointMax) {
									C -= $this.jointMax;
									slack = false;
								} else {
									nx = 0;
									ny = 0;
									C = 0;
									slack = true;
								}
							}
							$r = C;
							return $r;
						}(this));
						E *= 0.5;
					}
				}
			}
			var cx1, cx2;
			var k = (function($this) {
				var $r;
				cx1 = ny * r1x - nx * r1y;
				cx2 = ny * r2x - nx * r2y;
				$r = $this.b1.smass + $this.b2.smass + cx1 * cx1 * $this.b1.sinertia + cx2 * cx2 * $this.b2.sinertia;
				return $r;
			}(this));
			if(k != 0) k = 1 / k;
			j = -E * k;
			if(this.equal || j < 0) {
				if(true) {
					var t = this.b1.imass * j;
					this.b1.posx -= nx * t;
					this.b1.posy -= ny * t;
					var t = this.b2.imass * j;
					this.b2.posx += nx * t;
					this.b2.posy += ny * t;
					this.b1.delta_rot(-cx1 * this.b1.iinertia * j);
					this.b2.delta_rot(cx2 * this.b2.iinertia * j);
				} else {
					var t = this.b1.imass * j;
					this.b1.velx -= nx * t;
					this.b1.vely -= ny * t;
					var t = this.b2.imass * j;
					this.b2.velx += nx * t;
					this.b2.vely += ny * t;
					this.b1.angvel -= cx1 * this.b1.iinertia * j;
					this.b2.angvel += cx2 * this.b2.iinertia * j;
				}
			}
		}
		return false;
	}
	,applyImpulseVel: function() {
		if(this.slack) return false;
		var E = this.nx * (this.b2.velx + this.b2.kinvelx - this.b1.velx - this.b1.kinvelx) + this.ny * (this.b2.vely + this.b2.kinvely - this.b1.vely - this.b1.kinvely) + (this.b2.angvel + this.b2.kinangvel) * this.cx2 - (this.b1.angvel + this.b1.kinangvel) * this.cx1;
		var j = this.kMass * (this.bias - E) - this.jAcc * this.gamma;
		var jOld = this.jAcc;
		this.jAcc += j;
		if(!this.equal && this.jAcc > 0) this.jAcc = 0;
		if(this.breakUnderForce && this.jAcc < -this.jMax) return true;
		if(!this.stiff) {
			if(this.jAcc < -this.jMax) this.jAcc = -this.jMax;
		}
		j = this.jAcc - jOld;
		if(false) {
			var t = this.b1.imass * j;
			this.b1.posx -= this.nx * t;
			this.b1.posy -= this.ny * t;
			var t = this.b2.imass * j;
			this.b2.posx += this.nx * t;
			this.b2.posy += this.ny * t;
			this.b1.delta_rot(-this.cx1 * this.b1.iinertia * j);
			this.b2.delta_rot(this.cx2 * this.b2.iinertia * j);
		} else {
			var t = this.b1.imass * j;
			this.b1.velx -= this.nx * t;
			this.b1.vely -= this.ny * t;
			var t = this.b2.imass * j;
			this.b2.velx += this.nx * t;
			this.b2.vely += this.ny * t;
			this.b1.angvel -= this.cx1 * this.b1.iinertia * j;
			this.b2.angvel += this.cx2 * this.b2.iinertia * j;
		}
		return false;
	}
	,warmStart: function() {
		if(!this.slack) {
			if(false) {
				var t = this.b1.imass * this.jAcc;
				this.b1.posx -= this.nx * t;
				this.b1.posy -= this.ny * t;
				var t = this.b2.imass * this.jAcc;
				this.b2.posx += this.nx * t;
				this.b2.posy += this.ny * t;
				this.b1.delta_rot(-this.cx1 * this.b1.iinertia * this.jAcc);
				this.b2.delta_rot(this.cx2 * this.b2.iinertia * this.jAcc);
			} else {
				var t = this.b1.imass * this.jAcc;
				this.b1.velx -= this.nx * t;
				this.b1.vely -= this.ny * t;
				var t = this.b2.imass * this.jAcc;
				this.b2.velx += this.nx * t;
				this.b2.vely += this.ny * t;
				this.b1.angvel -= this.cx1 * this.b1.iinertia * this.jAcc;
				this.b2.angvel += this.cx2 * this.b2.iinertia * this.jAcc;
			}
		}
	}
	,preStep: function(dt) {
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		this.stepped = true;
		this.equal = this.jointMin == this.jointMax;
		this.a1relx = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		this.a1rely = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		this.a2relx = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		this.a2rely = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		var C = (function($this) {
			var $r;
			$this.nx = $this.b2.posx + $this.a2relx - ($this.b1.posx + $this.a1relx);
			$this.ny = $this.b2.posy + $this.a2rely - ($this.b1.posy + $this.a1rely);
			var C1 = $this.nx * $this.nx + $this.ny * $this.ny;
			if(C1 < nape.Config.epsilon) {
				$this.nx = 0;
				$this.ny = 0;
				C1 = 0;
				$this.slack = true;
			} else {
				C1 = zpp_nape.util.ZPP_Math.sqrt(C1);
				var t = 1.0 / C1;
				$this.nx *= t;
				$this.ny *= t;
				if($this.equal) {
					C1 -= $this.jointMax;
					$this.slack = false;
				} else if(C1 < $this.jointMin) {
					C1 = $this.jointMin - C1;
					$this.nx = -$this.nx;
					$this.ny = -$this.ny;
					$this.slack = false;
				} else if(C1 > $this.jointMax) {
					C1 -= $this.jointMax;
					$this.slack = false;
				} else {
					$this.nx = 0;
					$this.ny = 0;
					C1 = 0;
					$this.slack = true;
				}
			}
			$r = C1;
			return $r;
		}(this));
		if(!this.slack) {
			this.kMass = (function($this) {
				var $r;
				$this.cx1 = $this.ny * $this.a1relx - $this.nx * $this.a1rely;
				$this.cx2 = $this.ny * $this.a2relx - $this.nx * $this.a2rely;
				$r = $this.b1.smass + $this.b2.smass + $this.cx1 * $this.cx1 * $this.b1.sinertia + $this.cx2 * $this.cx2 * $this.b2.sinertia;
				return $r;
			}(this));
			if(this.kMass != 0) this.kMass = 1 / this.kMass; else this.jAcc = 0;
			if(!this.stiff) {
				if(this.breakUnderError && C * C > this.maxError * this.maxError) return true;
				var biasCoef;
				this.kMass *= (function($this) {
					var $r;
					var omega = 2 * Math.PI * $this.frequency;
					$this.gamma = 1 / (dt * omega * (2 * $this.damping + omega * dt));
					var ig = 1 / (1 + $this.gamma);
					biasCoef = dt * omega * omega * $this.gamma;
					$this.gamma *= ig;
					$r = ig;
					return $r;
				}(this));
				this.bias = -C * biasCoef;
				if(this.bias < -this.maxError) this.bias = -this.maxError; else if(this.bias > this.maxError) this.bias = this.maxError;
			} else {
				this.bias = 0;
				this.gamma = 0;
			}
			this.jAcc *= dtratio;
			this.jMax = this.maxForce * dt;
		}
		return false;
	}
	,clearcache: function() {
		this.jAcc = 0;
		this.pre_dt = -1.0;
	}
	,pair_exists: function(id,di) {
		return this.b1.id == id && this.b2.id == di || this.b1.id == di && this.b2.id == id;
	}
	,forest: function() {
		if(this.b1.isDynamic()) {
			var xr = this.b1.component == this.b1.component.parent?this.b1.component:(function($this) {
				var $r;
				var obj = $this.b1.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
		if(this.b2.isDynamic()) {
			var xr = this.b2.component == this.b2.component.parent?this.b2.component:(function($this) {
				var $r;
				var obj = $this.b2.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
	}
	,wake_connected: function() {
		if(this.b1 != null && this.b1.isDynamic()) this.b1.wake();
		if(this.b2 != null && this.b2.isDynamic()) this.b2.wake();
	}
	,validate: function() {
		if(this.b1 == null || this.b2 == null) throw "Error: DistanceJoint cannot be simulated null bodies";
		if(this.b1 == this.b2) throw "Error: DistanceJoint cannot be simulated with body1 == body2";
		if(this.b1.space != this.space || this.b2.space != this.space) throw "Error: Constraints must have each body within the same space to which the constraint has been assigned";
		if(this.jointMin > this.jointMax) throw "Error: DistanceJoint must have jointMin <= jointMax";
		if(!this.b1.isDynamic() && !this.b2.isDynamic()) throw "Error: Constraints cannot have both bodies non-dynamic";
	}
	,copy: function(dict,todo) {
		var ret = new nape.constraint.DistanceJoint(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.jointMin,this.jointMax);
		this.copyto(ret);
		if(dict != null && this.b1 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b1.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b1 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b1.id,function(b1) {
				ret.zpp_inner_zn.b1 = b1.zpp_inner;
			}));
		}
		if(dict != null && this.b2 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b2.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b2 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b2.id,function(b1) {
				ret.zpp_inner_zn.b2 = b1.zpp_inner;
			}));
		}
		return ret;
	}
	,setup_a2: function() {
		this.wrap_a2 = nape.geom.Vec2.get(this.a2localx,this.a2localy);
		this.wrap_a2.zpp_inner._inuse = true;
		this.wrap_a2.zpp_inner._validate = $bind(this,this.validate_a2);
		this.wrap_a2.zpp_inner._invalidate = $bind(this,this.invalidate_a2);
	}
	,invalidate_a2: function(x) {
		this.immutable_midstep("Constraint::" + "a2");
		this.a2localx = x.x;
		this.a2localy = x.y;
		this.wake();
	}
	,validate_a2: function() {
		this.wrap_a2.zpp_inner.x = this.a2localx;
		this.wrap_a2.zpp_inner.y = this.a2localy;
	}
	,setup_a1: function() {
		this.wrap_a1 = nape.geom.Vec2.get(this.a1localx,this.a1localy);
		this.wrap_a1.zpp_inner._inuse = true;
		this.wrap_a1.zpp_inner._validate = $bind(this,this.validate_a1);
		this.wrap_a1.zpp_inner._invalidate = $bind(this,this.invalidate_a1);
	}
	,invalidate_a1: function(x) {
		this.immutable_midstep("Constraint::" + "a1");
		this.a1localx = x.x;
		this.a1localy = x.y;
		this.wake();
	}
	,validate_a1: function() {
		this.wrap_a1.zpp_inner.x = this.a1localx;
		this.wrap_a1.zpp_inner.y = this.a1localy;
	}
	,inactiveBodies: function() {
		if(this.b1 != null) this.b1.constraints.remove(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.remove(this);
		}
	}
	,activeBodies: function() {
		if(this.b1 != null) this.b1.constraints.add(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.add(this);
		}
	}
	,bodyImpulse: function(b) {
		if(this.stepped) {
			if(b == this.b1) return nape.geom.Vec3.get(-this.jAcc * this.nx,-this.jAcc * this.ny,-this.cx1 * this.jAcc); else return nape.geom.Vec3.get(this.jAcc * this.nx,this.jAcc * this.ny,this.cx2 * this.jAcc);
		} else return nape.geom.Vec3.get(0,0,0);
	}
	,__class__: zpp_nape.constraint.ZPP_DistanceJoint
});
zpp_nape.constraint.ZPP_LineJoint = function() {
	this.biasy = 0.0;
	this.biasx = 0.0;
	this.jAccy = 0.0;
	this.jAccx = 0.0;
	this.kMassc = 0.0;
	this.kMassb = 0.0;
	this.kMassa = 0.0;
	this.wrap_n = null;
	this.nrely = 0.0;
	this.nrelx = 0.0;
	this.nlocaly = 0.0;
	this.nlocalx = 0.0;
	this.wrap_a2 = null;
	this.a2rely = 0.0;
	this.a2relx = 0.0;
	this.a2localy = 0.0;
	this.a2localx = 0.0;
	this.wrap_a1 = null;
	this.a1rely = 0.0;
	this.a1relx = 0.0;
	this.a1localy = 0.0;
	this.a1localx = 0.0;
	this.cx2 = 0.0;
	this.cx1 = 0.0;
	this.dot2 = 0.0;
	this.dot1 = 0.0;
	this.equal = false;
	this.jointMax = 0.0;
	this.jointMin = 0.0;
	this.scale = 0.0;
	this.outer_zn = null;
	zpp_nape.constraint.ZPP_Constraint.call(this);
	this.a1localx = 0;
	this.a1localy = 0;
	this.a1relx = 0;
	this.a1rely = 0;
	this.a2localx = 0;
	this.a2localy = 0;
	this.a2relx = 0;
	this.a2rely = 0;
	this.nlocalx = 0;
	this.nlocaly = 0;
	this.nrelx = 0;
	this.nrely = 0;
	this.jAccx = 0;
	this.jAccy = 0;
	this.jMax = zpp_nape.ZPP_Const.POSINF();
	this.jointMin = zpp_nape.ZPP_Const.NEGINF();
	this.jointMax = zpp_nape.ZPP_Const.POSINF();
	this.stepped = false;
};
$hxClasses["zpp_nape.constraint.ZPP_LineJoint"] = zpp_nape.constraint.ZPP_LineJoint;
zpp_nape.constraint.ZPP_LineJoint.__name__ = ["zpp_nape","constraint","ZPP_LineJoint"];
zpp_nape.constraint.ZPP_LineJoint.__super__ = zpp_nape.constraint.ZPP_Constraint;
zpp_nape.constraint.ZPP_LineJoint.prototype = $extend(zpp_nape.constraint.ZPP_Constraint.prototype,{
	draw: function(g) {
	}
	,applyImpulsePos: function() {
		var nx = 0.0;
		var ny = 0.0;
		nx = this.b1.axisy * this.nlocalx - this.b1.axisx * this.nlocaly;
		ny = this.nlocalx * this.b1.axisx + this.nlocaly * this.b1.axisy;
		var r1x = 0.0;
		var r1y = 0.0;
		r1x = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		r1y = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		var r2x = 0.0;
		var r2y = 0.0;
		r2x = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		r2y = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		var dx = 0.0;
		var dy = 0.0;
		var scale;
		var Ex = 0.0;
		var Ey = 0.0;
		dx = this.b2.posx + r2x - this.b1.posx - r1x;
		dy = this.b2.posy + r2y - this.b1.posy - r1y;
		Ex = dy * nx - dx * ny;
		Ey = nx * dx + ny * dy;
		if(this.equal) {
			Ey -= this.jointMin;
			scale = 1.0;
		} else if(Ey > this.jointMax) {
			Ey -= this.jointMax;
			scale = 1.0;
		} else if(Ey < this.jointMin) {
			Ey = this.jointMin - Ey;
			scale = -1.0;
		} else {
			Ey = 0;
			scale = 0;
		}
		if(this.breakUnderError && Ex * Ex + Ey * Ey > this.maxError * this.maxError) return true;
		if(Ex * Ex + Ey * Ey < nape.Config.constraintLinearSlop * nape.Config.constraintLinearSlop) return false;
		var Jx = 0.0;
		var Jy = 0.0;
		var t = 0.5;
		Ex *= t;
		Ey *= t;
		if(Ex * Ex + Ey * Ey > 6) {
			var k = this.b1.smass + this.b2.smass;
			if(k > nape.Config.epsilon) {
				k = 0.8 / k;
				var Jx1 = k * (ny * Ex - scale * nx * Ey);
				var Jy1 = k * (nx * Ex * scale - ny * Ex);
				var t = this.b1.imass;
				this.b1.posx -= Jx1 * t;
				this.b1.posy -= Jy1 * t;
				var t = this.b2.imass;
				this.b2.posx += Jx1 * t;
				this.b2.posy += Jy1 * t;
				dx = this.b2.posx + r2x - this.b1.posx - r1x;
				dy = this.b2.posy + r2y - this.b1.posy - r1y;
				Ex = dy * nx - dx * ny;
				Ey = nx * dx + ny * dy;
				if(this.equal) {
					Ey -= this.jointMin;
					scale = 1.0;
				} else if(Ey > this.jointMax) {
					Ey -= this.jointMax;
					scale = 1.0;
				} else if(Ey < this.jointMin) {
					Ey = this.jointMin - Ey;
					scale = -1.0;
				} else {
					Ey = 0;
					scale = 0;
				}
				var t = 0.5;
				Ex *= t;
				Ey *= t;
			}
		}
		var dot1, dot2, cx1, cx2;
		var Ka = 0.0;
		var Kb = 0.0;
		var Kc = 0.0;
		var drx = 0.0;
		var dry = 0.0;
		drx = dx + r1x;
		dry = dy + r1y;
		dot1 = nx * drx + ny * dry;
		cx1 = dry * nx - drx * ny;
		dot2 = nx * r2x + ny * r2y;
		cx2 = r2y * nx - r2x * ny;
		Ka = this.b1.smass + this.b2.smass + dot1 * dot1 * this.b1.sinertia + dot2 * dot2 * this.b2.sinertia;
		Kb = -scale * (dot1 * cx1 * this.b1.sinertia + dot2 * cx2 * this.b2.sinertia);
		Kc = scale * scale * (this.b1.smass + this.b2.smass + cx1 * cx1 * this.b1.sinertia + cx2 * cx2 * this.b2.sinertia);
		Jx = -Ex;
		Jy = -Ey;
		var det = Ka * Kc - Kb * Kb;
		if(det != det) Jx = Jy = 0; else if(det == 0) {
			if(Ka != 0) Jx /= Ka; else Jx = 0;
			if(Kc != 0) Jy /= Kc; else Jy = 0;
		} else {
			det = 1 / det;
			var t = det * (Kc * Jx - Kb * Jy);
			Jy = det * (Ka * Jy - Kb * Jx);
			Jx = t;
		}
		if(Jy > 0) Jy = 0;
		var J2x = scale * nx * Jy - ny * Jx;
		var J2y = nx * Jx + scale * ny * Jy;
		if(true) {
			var t = this.b1.imass;
			this.b1.posx -= J2x * t;
			this.b1.posy -= J2y * t;
			var t = this.b2.imass;
			this.b2.posx += J2x * t;
			this.b2.posy += J2y * t;
			this.b1.delta_rot((scale * cx1 * Jy - dot1 * Jx) * this.b1.iinertia);
			this.b2.delta_rot((dot2 * Jx - scale * cx2 * Jy) * this.b2.iinertia);
		} else {
			var t = this.b1.imass;
			this.b1.velx -= J2x * t;
			this.b1.vely -= J2y * t;
			var t = this.b2.imass;
			this.b2.velx += J2x * t;
			this.b2.vely += J2y * t;
			this.b1.angvel += (scale * cx1 * Jy - dot1 * Jx) * this.b1.iinertia;
			this.b2.angvel += (dot2 * Jx - scale * cx2 * Jy) * this.b2.iinertia;
		}
		return false;
	}
	,applyImpulseVel: function() {
		var Ex = 0.0;
		var Ey = 0.0;
		var dvx = 0.0;
		var dvy = 0.0;
		dvx = this.b2.velx - this.b1.velx;
		dvy = this.b2.vely - this.b1.vely;
		dvx += this.b2.kinvelx - this.b1.kinvelx;
		dvy += this.b2.kinvely - this.b1.kinvely;
		Ex = dvy * this.nrelx - dvx * this.nrely + (this.b2.angvel + this.b2.kinangvel) * this.dot2 - (this.b1.angvel + this.b1.kinangvel) * this.dot1;
		Ey = this.scale * (this.nrelx * dvx + this.nrely * dvy - (this.b2.angvel + this.b2.kinangvel) * this.cx2 + (this.b1.angvel + this.b1.kinangvel) * this.cx1);
		var Jx = 0.0;
		var Jy = 0.0;
		Jx = this.biasx - Ex;
		Jy = this.biasy - Ey;
		var t = this.kMassa * Jx + this.kMassb * Jy;
		Jy = this.kMassb * Jx + this.kMassc * Jy;
		Jx = t;
		var t = this.gamma;
		Jx -= this.jAccx * t;
		Jy -= this.jAccy * t;
		var jOldx = 0.0;
		var jOldy = 0.0;
		jOldx = this.jAccx;
		jOldy = this.jAccy;
		var t = 1.0;
		this.jAccx += Jx * t;
		this.jAccy += Jy * t;
		if(this.jAccy > 0) this.jAccy = 0;
		if(this.breakUnderForce) {
			if(this.jAccx * this.jAccx + this.jAccy * this.jAccy > this.jMax * this.jMax) return true;
		} else if(!this.stiff) {
			var t = this.jMax;
			var ls = this.jAccx * this.jAccx + this.jAccy * this.jAccy;
			if(ls > t * t) {
				var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
				this.jAccx *= t1;
				this.jAccy *= t1;
			}
		}
		Jx = this.jAccx - jOldx;
		Jy = this.jAccy - jOldy;
		var J2x = this.scale * this.nrelx * Jy - this.nrely * Jx;
		var J2y = this.nrelx * Jx + this.scale * this.nrely * Jy;
		if(false) {
			var t = this.b1.imass;
			this.b1.posx -= J2x * t;
			this.b1.posy -= J2y * t;
			var t = this.b2.imass;
			this.b2.posx += J2x * t;
			this.b2.posy += J2y * t;
			this.b1.delta_rot((this.scale * this.cx1 * Jy - this.dot1 * Jx) * this.b1.iinertia);
			this.b2.delta_rot((this.dot2 * Jx - this.scale * this.cx2 * Jy) * this.b2.iinertia);
		} else {
			var t = this.b1.imass;
			this.b1.velx -= J2x * t;
			this.b1.vely -= J2y * t;
			var t = this.b2.imass;
			this.b2.velx += J2x * t;
			this.b2.vely += J2y * t;
			this.b1.angvel += (this.scale * this.cx1 * Jy - this.dot1 * Jx) * this.b1.iinertia;
			this.b2.angvel += (this.dot2 * Jx - this.scale * this.cx2 * Jy) * this.b2.iinertia;
		}
		return false;
	}
	,warmStart: function() {
		var J2x = this.scale * this.nrelx * this.jAccy - this.nrely * this.jAccx;
		var J2y = this.nrelx * this.jAccx + this.scale * this.nrely * this.jAccy;
		if(false) {
			var t = this.b1.imass;
			this.b1.posx -= J2x * t;
			this.b1.posy -= J2y * t;
			var t = this.b2.imass;
			this.b2.posx += J2x * t;
			this.b2.posy += J2y * t;
			this.b1.delta_rot((this.scale * this.cx1 * this.jAccy - this.dot1 * this.jAccx) * this.b1.iinertia);
			this.b2.delta_rot((this.dot2 * this.jAccx - this.scale * this.cx2 * this.jAccy) * this.b2.iinertia);
		} else {
			var t = this.b1.imass;
			this.b1.velx -= J2x * t;
			this.b1.vely -= J2y * t;
			var t = this.b2.imass;
			this.b2.velx += J2x * t;
			this.b2.vely += J2y * t;
			this.b1.angvel += (this.scale * this.cx1 * this.jAccy - this.dot1 * this.jAccx) * this.b1.iinertia;
			this.b2.angvel += (this.dot2 * this.jAccx - this.scale * this.cx2 * this.jAccy) * this.b2.iinertia;
		}
	}
	,preStep: function(dt) {
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		this.equal = this.jointMin == this.jointMax;
		this.stepped = true;
		this.validate_norm();
		this.a1relx = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		this.a1rely = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		this.nrelx = this.b1.axisy * this.nlocalx - this.b1.axisx * this.nlocaly;
		this.nrely = this.nlocalx * this.b1.axisx + this.nlocaly * this.b1.axisy;
		this.a2relx = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		this.a2rely = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		var dx = 0.0;
		var dy = 0.0;
		var Cx = 0.0;
		var Cy = 0.0;
		dx = this.b2.posx + this.a2relx - this.b1.posx - this.a1relx;
		dy = this.b2.posy + this.a2rely - this.b1.posy - this.a1rely;
		Cx = dy * this.nrelx - dx * this.nrely;
		Cy = this.nrelx * dx + this.nrely * dy;
		if(this.equal) {
			Cy -= this.jointMin;
			this.scale = 1.0;
		} else if(Cy > this.jointMax) {
			Cy -= this.jointMax;
			this.scale = 1.0;
		} else if(Cy < this.jointMin) {
			Cy = this.jointMin - Cy;
			this.scale = -1.0;
		} else {
			Cy = 0;
			this.scale = 0;
		}
		var drx = 0.0;
		var dry = 0.0;
		drx = dx + this.a1relx;
		dry = dy + this.a1rely;
		this.dot1 = this.nrelx * drx + this.nrely * dry;
		this.cx1 = dry * this.nrelx - drx * this.nrely;
		this.dot2 = this.nrelx * this.a2relx + this.nrely * this.a2rely;
		this.cx2 = this.a2rely * this.nrelx - this.a2relx * this.nrely;
		this.kMassa = this.b1.smass + this.b2.smass + this.dot1 * this.dot1 * this.b1.sinertia + this.dot2 * this.dot2 * this.b2.sinertia;
		this.kMassb = -this.scale * (this.dot1 * this.cx1 * this.b1.sinertia + this.dot2 * this.cx2 * this.b2.sinertia);
		this.kMassc = this.scale * this.scale * (this.b1.smass + this.b2.smass + this.cx1 * this.cx1 * this.b1.sinertia + this.cx2 * this.cx2 * this.b2.sinertia);
		var flag = (function($this) {
			var $r;
			var det = $this.kMassa * $this.kMassc - $this.kMassb * $this.kMassb;
			$r = det != det?(function($this) {
				var $r;
				$this.kMassa = $this.kMassb = $this.kMassc = 0;
				$r = 3;
				return $r;
			}($this)):det == 0?(function($this) {
				var $r;
				var flag1 = 0;
				if($this.kMassa != 0) $this.kMassa = 1 / $this.kMassa; else {
					$this.kMassa = 0;
					flag1 |= 1;
				}
				if($this.kMassc != 0) $this.kMassc = 1 / $this.kMassc; else {
					$this.kMassc = 0;
					flag1 |= 2;
				}
				$this.kMassb = 0;
				$r = flag1;
				return $r;
			}($this)):(function($this) {
				var $r;
				det = 1 / det;
				var t = $this.kMassc * det;
				$this.kMassc = $this.kMassa * det;
				$this.kMassa = t;
				$this.kMassb *= -det;
				$r = 0;
				return $r;
			}($this));
			return $r;
		}(this));
		if((flag & 1) != 0) this.jAccx = 0;
		if((flag & 2) != 0) this.jAccy = 0;
		if(!this.stiff) {
			if(this.breakUnderError && Cx * Cx + Cy * Cy > this.maxError * this.maxError) return true;
			var biasCoef;
			var X = (function($this) {
				var $r;
				var omega = 2 * Math.PI * $this.frequency;
				$this.gamma = 1 / (dt * omega * (2 * $this.damping + omega * dt));
				var ig = 1 / (1 + $this.gamma);
				biasCoef = dt * omega * omega * $this.gamma;
				$this.gamma *= ig;
				$r = ig;
				return $r;
			}(this));
			this.kMassa *= X;
			this.kMassb *= X;
			this.kMassc *= X;
			this.biasx = Cx;
			this.biasy = Cy;
			var t = -biasCoef;
			this.biasx *= t;
			this.biasy *= t;
			var t = this.maxError;
			var ls = this.biasx * this.biasx + this.biasy * this.biasy;
			if(ls > t * t) {
				var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
				this.biasx *= t1;
				this.biasy *= t1;
			}
		} else {
			this.gamma = 0;
			this.biasx = 0;
			this.biasy = 0;
		}
		var t = dtratio;
		this.jAccx *= t;
		this.jAccy *= t;
		this.jMax = this.maxForce * dt;
		return false;
	}
	,clearcache: function() {
		this.jAccx = 0;
		this.jAccy = 0;
		this.pre_dt = -1.0;
	}
	,pair_exists: function(id,di) {
		return this.b1.id == id && this.b2.id == di || this.b1.id == di && this.b2.id == id;
	}
	,forest: function() {
		if(this.b1.isDynamic()) {
			var xr = this.b1.component == this.b1.component.parent?this.b1.component:(function($this) {
				var $r;
				var obj = $this.b1.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
		if(this.b2.isDynamic()) {
			var xr = this.b2.component == this.b2.component.parent?this.b2.component:(function($this) {
				var $r;
				var obj = $this.b2.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
	}
	,wake_connected: function() {
		if(this.b1 != null && this.b1.isDynamic()) this.b1.wake();
		if(this.b2 != null && this.b2.isDynamic()) this.b2.wake();
	}
	,validate: function() {
		if(this.b1 == null || this.b2 == null) throw "Error: AngleJoint cannot be simulated null bodies";
		if(this.b1 == this.b2) throw "Error: DistanceJoint cannot be simulated with body1 == body2";
		if(this.b1.space != this.space || this.b2.space != this.space) throw "Error: Constraints must have each body within the same space to which the constraint has been assigned";
		if(this.jointMin > this.jointMax) throw "Error: DistanceJoint must have jointMin <= jointMax";
		if(this.nlocalx * this.nlocalx + this.nlocaly * this.nlocaly < nape.Config.epsilon) throw "Error: DistanceJoint direction must be non-degenerate";
		if(!this.b1.isDynamic() && !this.b2.isDynamic()) throw "Error: Constraints cannot have both bodies non-dynamic";
	}
	,copy: function(dict,todo) {
		var ret = new nape.constraint.LineJoint(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_direction(),this.jointMin,this.jointMax);
		this.copyto(ret);
		if(dict != null && this.b1 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b1.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b1 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b1.id,function(b1) {
				ret.zpp_inner_zn.b1 = b1.zpp_inner;
			}));
		}
		if(dict != null && this.b2 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b2.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b2 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b2.id,function(b1) {
				ret.zpp_inner_zn.b2 = b1.zpp_inner;
			}));
		}
		return ret;
	}
	,validate_norm: function() {
		if(this.zip_n) {
			this.zip_n = false;
			var d = this.nlocalx * this.nlocalx + this.nlocaly * this.nlocaly;
			var imag = 1.0 / Math.sqrt(d);
			var t = imag;
			this.nlocalx *= t;
			this.nlocaly *= t;
		}
	}
	,setup_n: function() {
		this.wrap_n = nape.geom.Vec2.get(this.nlocalx,this.nlocaly);
		this.wrap_n.zpp_inner._inuse = true;
		this.wrap_n.zpp_inner._validate = $bind(this,this.validate_n);
		this.wrap_n.zpp_inner._invalidate = $bind(this,this.invalidate_n);
	}
	,invalidate_n: function(x) {
		this.immutable_midstep("Constraint::" + "n");
		this.nlocalx = x.x;
		this.nlocaly = x.y;
		this.zip_n = true;
		this.wake();
	}
	,validate_n: function() {
		this.wrap_n.zpp_inner.x = this.nlocalx;
		this.wrap_n.zpp_inner.y = this.nlocaly;
	}
	,setup_a2: function() {
		this.wrap_a2 = nape.geom.Vec2.get(this.a2localx,this.a2localy);
		this.wrap_a2.zpp_inner._inuse = true;
		this.wrap_a2.zpp_inner._validate = $bind(this,this.validate_a2);
		this.wrap_a2.zpp_inner._invalidate = $bind(this,this.invalidate_a2);
	}
	,invalidate_a2: function(x) {
		this.immutable_midstep("Constraint::" + "a2");
		this.a2localx = x.x;
		this.a2localy = x.y;
		this.wake();
	}
	,validate_a2: function() {
		this.wrap_a2.zpp_inner.x = this.a2localx;
		this.wrap_a2.zpp_inner.y = this.a2localy;
	}
	,setup_a1: function() {
		this.wrap_a1 = nape.geom.Vec2.get(this.a1localx,this.a1localy);
		this.wrap_a1.zpp_inner._inuse = true;
		this.wrap_a1.zpp_inner._validate = $bind(this,this.validate_a1);
		this.wrap_a1.zpp_inner._invalidate = $bind(this,this.invalidate_a1);
	}
	,invalidate_a1: function(x) {
		this.immutable_midstep("Constraint::" + "a1");
		this.a1localx = x.x;
		this.a1localy = x.y;
		this.wake();
	}
	,validate_a1: function() {
		this.wrap_a1.zpp_inner.x = this.a1localx;
		this.wrap_a1.zpp_inner.y = this.a1localy;
	}
	,inactiveBodies: function() {
		if(this.b1 != null) this.b1.constraints.remove(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.remove(this);
		}
	}
	,activeBodies: function() {
		if(this.b1 != null) this.b1.constraints.add(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.add(this);
		}
	}
	,bodyImpulse: function(b) {
		if(this.stepped) {
			var jx = this.scale * this.nrelx * this.jAccy - this.nrely * this.jAccx;
			var jy = this.nrelx * this.jAccx + this.scale * this.nrely * this.jAccy;
			if(b == this.b1) return nape.geom.Vec3.get(-jx,-jy,this.scale * this.cx1 * jy - this.dot1 * jx); else return nape.geom.Vec3.get(jx,jy,this.scale * this.cx1 * jy - this.dot1 * jx);
		} else return nape.geom.Vec3.get(0,0,0);
	}
	,__class__: zpp_nape.constraint.ZPP_LineJoint
});
zpp_nape.constraint.ZPP_MotorJoint = function() {
	this.stepped = false;
	this.jMax = 0.0;
	this.jAcc = 0.0;
	this.kMass = 0.0;
	this.b2 = null;
	this.b1 = null;
	this.rate = 0.0;
	this.ratio = 0.0;
	this.outer_zn = null;
	zpp_nape.constraint.ZPP_Constraint.call(this);
	this.jAcc = 0;
	this.stepped = false;
	this.__velocity = true;
};
$hxClasses["zpp_nape.constraint.ZPP_MotorJoint"] = zpp_nape.constraint.ZPP_MotorJoint;
zpp_nape.constraint.ZPP_MotorJoint.__name__ = ["zpp_nape","constraint","ZPP_MotorJoint"];
zpp_nape.constraint.ZPP_MotorJoint.__super__ = zpp_nape.constraint.ZPP_Constraint;
zpp_nape.constraint.ZPP_MotorJoint.prototype = $extend(zpp_nape.constraint.ZPP_Constraint.prototype,{
	applyImpulsePos: function() {
		return false;
	}
	,applyImpulseVel: function() {
		var E = this.ratio * (this.b2.angvel + this.b2.kinangvel) - this.b1.angvel - this.b1.kinangvel - this.rate;
		var j = -this.kMass * E;
		var jOld = this.jAcc;
		this.jAcc += j;
		if(this.breakUnderForce) {
			if(this.jAcc > this.jMax || this.jAcc < -this.jMax) return true;
		} else if(this.jAcc < -this.jMax) this.jAcc = -this.jMax; else if(this.jAcc > this.jMax) this.jAcc = this.jMax;
		j = this.jAcc - jOld;
		this.b1.angvel -= this.b1.iinertia * j;
		this.b2.angvel += this.ratio * this.b2.iinertia * j;
		return false;
	}
	,warmStart: function() {
		this.b1.angvel -= this.b1.iinertia * this.jAcc;
		this.b2.angvel += this.ratio * this.b2.iinertia * this.jAcc;
	}
	,preStep: function(dt) {
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		this.stepped = true;
		this.kMass = this.b1.sinertia + this.ratio * this.ratio * this.b2.sinertia;
		this.kMass = 1.0 / this.kMass;
		this.jAcc *= dtratio;
		this.jMax = this.maxForce * dt;
		return false;
	}
	,clearcache: function() {
		this.jAcc = 0;
		this.pre_dt = -1.0;
	}
	,pair_exists: function(id,di) {
		return this.b1.id == id && this.b2.id == di || this.b1.id == di && this.b2.id == id;
	}
	,forest: function() {
		if(this.b1.isDynamic()) {
			var xr = this.b1.component == this.b1.component.parent?this.b1.component:(function($this) {
				var $r;
				var obj = $this.b1.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
		if(this.b2.isDynamic()) {
			var xr = this.b2.component == this.b2.component.parent?this.b2.component:(function($this) {
				var $r;
				var obj = $this.b2.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
	}
	,wake_connected: function() {
		if(this.b1 != null && this.b1.isDynamic()) this.b1.wake();
		if(this.b2 != null && this.b2.isDynamic()) this.b2.wake();
	}
	,validate: function() {
		if(this.b1 == null || this.b2 == null) throw "Error: AngleJoint cannot be simulated null bodies";
		if(this.b1 == this.b2) throw "Error: MotorJoint cannot be simulated with body1 == body2";
		if(this.b1.space != this.space || this.b2.space != this.space) throw "Error: Constraints must have each body within the same space to which the constraint has been assigned";
		if(!this.b1.isDynamic() && !this.b2.isDynamic()) throw "Error: Constraints cannot have both bodies non-dynamic";
	}
	,copy: function(dict,todo) {
		var ret = new nape.constraint.MotorJoint(null,null,this.rate,this.ratio);
		this.copyto(ret);
		if(dict != null && this.b1 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b1.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b1 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b1.id,function(b1) {
				ret.zpp_inner_zn.b1 = b1.zpp_inner;
			}));
		}
		if(dict != null && this.b2 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b2.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b2 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b2.id,function(b1) {
				ret.zpp_inner_zn.b2 = b1.zpp_inner;
			}));
		}
		return ret;
	}
	,inactiveBodies: function() {
		if(this.b1 != null) this.b1.constraints.remove(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.remove(this);
		}
	}
	,activeBodies: function() {
		if(this.b1 != null) this.b1.constraints.add(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.add(this);
		}
	}
	,bodyImpulse: function(b) {
		if(this.stepped) {
			if(b == this.b1) return nape.geom.Vec3.get(0,0,-this.jAcc); else return nape.geom.Vec3.get(0,0,this.ratio * this.jAcc);
		} else return nape.geom.Vec3.get(0,0,0);
	}
	,__class__: zpp_nape.constraint.ZPP_MotorJoint
});
zpp_nape.constraint.ZPP_PivotJoint = function() {
	this.stepped = false;
	this.biasy = 0.0;
	this.biasx = 0.0;
	this.gamma = 0.0;
	this.jMax = 0.0;
	this.jAccy = 0.0;
	this.jAccx = 0.0;
	this.kMassc = 0.0;
	this.kMassb = 0.0;
	this.kMassa = 0.0;
	this.wrap_a2 = null;
	this.a2rely = 0.0;
	this.a2relx = 0.0;
	this.a2localy = 0.0;
	this.a2localx = 0.0;
	this.b2 = null;
	this.wrap_a1 = null;
	this.a1rely = 0.0;
	this.a1relx = 0.0;
	this.a1localy = 0.0;
	this.a1localx = 0.0;
	this.b1 = null;
	this.outer_zn = null;
	zpp_nape.constraint.ZPP_Constraint.call(this);
	this.stepped = false;
	this.jAccx = 0;
	this.jAccy = 0;
	this.jMax = zpp_nape.ZPP_Const.POSINF();
	this.a1localx = 0;
	this.a1localy = 0;
	this.a1relx = 0;
	this.a1rely = 0;
	this.a2localx = 0;
	this.a2localy = 0;
	this.a2relx = 0;
	this.a2rely = 0;
};
$hxClasses["zpp_nape.constraint.ZPP_PivotJoint"] = zpp_nape.constraint.ZPP_PivotJoint;
zpp_nape.constraint.ZPP_PivotJoint.__name__ = ["zpp_nape","constraint","ZPP_PivotJoint"];
zpp_nape.constraint.ZPP_PivotJoint.__super__ = zpp_nape.constraint.ZPP_Constraint;
zpp_nape.constraint.ZPP_PivotJoint.prototype = $extend(zpp_nape.constraint.ZPP_Constraint.prototype,{
	draw: function(g) {
	}
	,applyImpulsePos: function() {
		var r1x = 0.0;
		var r1y = 0.0;
		r1x = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		r1y = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		var r2x = 0.0;
		var r2y = 0.0;
		r2x = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		r2y = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		var Ex = 0.0;
		var Ey = 0.0;
		Ex = this.b2.posx + r2x - (this.b1.posx + r1x);
		Ey = this.b2.posy + r2y - (this.b1.posy + r1y);
		if(this.breakUnderError && Ex * Ex + Ey * Ey > this.maxError * this.maxError) return true;
		if(Ex * Ex + Ey * Ey < nape.Config.constraintLinearSlop * nape.Config.constraintLinearSlop) return false;
		var t = 0.5;
		Ex *= t;
		Ey *= t;
		var Jx = 0.0;
		var Jy = 0.0;
		if(Ex * Ex + Ey * Ey > 6) {
			var k = this.b1.smass + this.b2.smass;
			if(k > nape.Config.epsilon) {
				k = 0.75 / k;
				Jx = -Ex * k;
				Jy = -Ey * k;
				var t = 20;
				var ls = Jx * Jx + Jy * Jy;
				if(ls > t * t) {
					var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
					Jx *= t1;
					Jy *= t1;
				}
				var t = this.b1.imass;
				this.b1.posx -= Jx * t;
				this.b1.posy -= Jy * t;
				var t = this.b2.imass;
				this.b2.posx += Jx * t;
				this.b2.posy += Jy * t;
				Ex = this.b2.posx + r2x - (this.b1.posx + r1x);
				Ey = this.b2.posy + r2y - (this.b1.posy + r1y);
				var t = 0.5;
				Ex *= t;
				Ey *= t;
			}
		}
		var Ka = 0.0;
		var Kb = 0.0;
		var Kc = 0.0;
		var m = this.b1.smass + this.b2.smass;
		Ka = m;
		Kb = 0;
		Kc = m;
		if(this.b1.sinertia != 0) {
			var X = r1x * this.b1.sinertia;
			var Y = r1y * this.b1.sinertia;
			Ka += Y * r1y;
			Kb += -Y * r1x;
			Kc += X * r1x;
		}
		if(this.b2.sinertia != 0) {
			var X = r2x * this.b2.sinertia;
			var Y = r2y * this.b2.sinertia;
			Ka += Y * r2y;
			Kb += -Y * r2x;
			Kc += X * r2x;
		}
		Jx = -Ex;
		Jy = -Ey;
		var t = 6;
		var ls = Jx * Jx + Jy * Jy;
		if(ls > t * t) {
			var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
			Jx *= t1;
			Jy *= t1;
		}
		var det = Ka * Kc - Kb * Kb;
		if(det != det) Jx = Jy = 0; else if(det == 0) {
			if(Ka != 0) Jx /= Ka; else Jx = 0;
			if(Kc != 0) Jy /= Kc; else Jy = 0;
		} else {
			det = 1 / det;
			var t = det * (Kc * Jx - Kb * Jy);
			Jy = det * (Ka * Jy - Kb * Jx);
			Jx = t;
		}
		if(true) {
			var t = this.b1.imass;
			this.b1.posx -= Jx * t;
			this.b1.posy -= Jy * t;
			var t = this.b2.imass;
			this.b2.posx += Jx * t;
			this.b2.posy += Jy * t;
			this.b1.delta_rot(-(Jy * r1x - Jx * r1y) * this.b1.iinertia);
			this.b2.delta_rot((Jy * r2x - Jx * r2y) * this.b2.iinertia);
		} else {
			var t = this.b1.imass;
			this.b1.velx -= Jx * t;
			this.b1.vely -= Jy * t;
			var t = this.b2.imass;
			this.b2.velx += Jx * t;
			this.b2.vely += Jy * t;
			this.b1.angvel -= (Jy * r1x - Jx * r1y) * this.b1.iinertia;
			this.b2.angvel += (Jy * r2x - Jx * r2y) * this.b2.iinertia;
		}
		return false;
	}
	,applyImpulseVel: function() {
		var Ex = 0.0;
		var Ey = 0.0;
		Ex = this.b2.velx + this.b2.kinvelx - this.a2rely * (this.b2.angvel + this.b2.kinangvel) - (this.b1.velx + this.b1.kinvelx - this.a1rely * (this.b1.angvel + this.b1.kinangvel));
		Ey = this.b2.vely + this.b2.kinvely + this.a2relx * (this.b2.angvel + this.b2.kinangvel) - (this.b1.vely + this.b1.kinvely + this.a1relx * (this.b1.angvel + this.b1.kinangvel));
		var Jx = 0.0;
		var Jy = 0.0;
		Jx = this.biasx - Ex;
		Jy = this.biasy - Ey;
		var t = this.kMassa * Jx + this.kMassb * Jy;
		Jy = this.kMassb * Jx + this.kMassc * Jy;
		Jx = t;
		var t = this.gamma;
		Jx -= this.jAccx * t;
		Jy -= this.jAccy * t;
		var jOldx = 0.0;
		var jOldy = 0.0;
		jOldx = this.jAccx;
		jOldy = this.jAccy;
		var t = 1.0;
		this.jAccx += Jx * t;
		this.jAccy += Jy * t;
		if(this.breakUnderForce) {
			if(this.jAccx * this.jAccx + this.jAccy * this.jAccy > this.jMax * this.jMax) return true;
		} else if(!this.stiff) {
			var t = this.jMax;
			var ls = this.jAccx * this.jAccx + this.jAccy * this.jAccy;
			if(ls > t * t) {
				var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
				this.jAccx *= t1;
				this.jAccy *= t1;
			}
		}
		Jx = this.jAccx - jOldx;
		Jy = this.jAccy - jOldy;
		if(false) {
			var t = this.b1.imass;
			this.b1.posx -= Jx * t;
			this.b1.posy -= Jy * t;
			var t = this.b2.imass;
			this.b2.posx += Jx * t;
			this.b2.posy += Jy * t;
			this.b1.delta_rot(-(Jy * this.a1relx - Jx * this.a1rely) * this.b1.iinertia);
			this.b2.delta_rot((Jy * this.a2relx - Jx * this.a2rely) * this.b2.iinertia);
		} else {
			var t = this.b1.imass;
			this.b1.velx -= Jx * t;
			this.b1.vely -= Jy * t;
			var t = this.b2.imass;
			this.b2.velx += Jx * t;
			this.b2.vely += Jy * t;
			this.b1.angvel -= (Jy * this.a1relx - Jx * this.a1rely) * this.b1.iinertia;
			this.b2.angvel += (Jy * this.a2relx - Jx * this.a2rely) * this.b2.iinertia;
		}
		return false;
	}
	,warmStart: function() {
		if(false) {
			var t = this.b1.imass;
			this.b1.posx -= this.jAccx * t;
			this.b1.posy -= this.jAccy * t;
			var t = this.b2.imass;
			this.b2.posx += this.jAccx * t;
			this.b2.posy += this.jAccy * t;
			this.b1.delta_rot(-(this.jAccy * this.a1relx - this.jAccx * this.a1rely) * this.b1.iinertia);
			this.b2.delta_rot((this.jAccy * this.a2relx - this.jAccx * this.a2rely) * this.b2.iinertia);
		} else {
			var t = this.b1.imass;
			this.b1.velx -= this.jAccx * t;
			this.b1.vely -= this.jAccy * t;
			var t = this.b2.imass;
			this.b2.velx += this.jAccx * t;
			this.b2.vely += this.jAccy * t;
			this.b1.angvel -= (this.jAccy * this.a1relx - this.jAccx * this.a1rely) * this.b1.iinertia;
			this.b2.angvel += (this.jAccy * this.a2relx - this.jAccx * this.a2rely) * this.b2.iinertia;
		}
	}
	,preStep: function(dt) {
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		this.stepped = true;
		this.a1relx = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		this.a1rely = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		this.a2relx = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		this.a2rely = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		var m = this.b1.smass + this.b2.smass;
		this.kMassa = m;
		this.kMassb = 0;
		this.kMassc = m;
		if(this.b1.sinertia != 0) {
			var X = this.a1relx * this.b1.sinertia;
			var Y = this.a1rely * this.b1.sinertia;
			this.kMassa += Y * this.a1rely;
			this.kMassb += -Y * this.a1relx;
			this.kMassc += X * this.a1relx;
		}
		if(this.b2.sinertia != 0) {
			var X = this.a2relx * this.b2.sinertia;
			var Y = this.a2rely * this.b2.sinertia;
			this.kMassa += Y * this.a2rely;
			this.kMassb += -Y * this.a2relx;
			this.kMassc += X * this.a2relx;
		}
		var flag = (function($this) {
			var $r;
			var det = $this.kMassa * $this.kMassc - $this.kMassb * $this.kMassb;
			$r = det != det?(function($this) {
				var $r;
				$this.kMassa = $this.kMassb = $this.kMassc = 0;
				$r = 3;
				return $r;
			}($this)):det == 0?(function($this) {
				var $r;
				var flag1 = 0;
				if($this.kMassa != 0) $this.kMassa = 1 / $this.kMassa; else {
					$this.kMassa = 0;
					flag1 |= 1;
				}
				if($this.kMassc != 0) $this.kMassc = 1 / $this.kMassc; else {
					$this.kMassc = 0;
					flag1 |= 2;
				}
				$this.kMassb = 0;
				$r = flag1;
				return $r;
			}($this)):(function($this) {
				var $r;
				det = 1 / det;
				var t = $this.kMassc * det;
				$this.kMassc = $this.kMassa * det;
				$this.kMassa = t;
				$this.kMassb *= -det;
				$r = 0;
				return $r;
			}($this));
			return $r;
		}(this));
		if((flag & 1) != 0) this.jAccx = 0;
		if((flag & 2) != 0) this.jAccy = 0;
		if(!this.stiff) {
			var biasCoef;
			var X = (function($this) {
				var $r;
				var omega = 2 * Math.PI * $this.frequency;
				$this.gamma = 1 / (dt * omega * (2 * $this.damping + omega * dt));
				var ig = 1 / (1 + $this.gamma);
				biasCoef = dt * omega * omega * $this.gamma;
				$this.gamma *= ig;
				$r = ig;
				return $r;
			}(this));
			this.kMassa *= X;
			this.kMassb *= X;
			this.kMassc *= X;
			this.biasx = this.b2.posx + this.a2relx - (this.b1.posx + this.a1relx);
			this.biasy = this.b2.posy + this.a2rely - (this.b1.posy + this.a1rely);
			if(this.breakUnderError && this.biasx * this.biasx + this.biasy * this.biasy > this.maxError * this.maxError) return true;
			var t = -biasCoef;
			this.biasx *= t;
			this.biasy *= t;
			var t = this.maxError;
			var ls = this.biasx * this.biasx + this.biasy * this.biasy;
			if(ls > t * t) {
				var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
				this.biasx *= t1;
				this.biasy *= t1;
			}
		} else {
			this.biasx = 0;
			this.biasy = 0;
			this.gamma = 0;
		}
		var t = dtratio;
		this.jAccx *= t;
		this.jAccy *= t;
		this.jMax = this.maxForce * dt;
		return false;
	}
	,clearcache: function() {
		this.jAccx = 0;
		this.jAccy = 0;
		this.pre_dt = -1.0;
	}
	,pair_exists: function(id,di) {
		return this.b1.id == id && this.b2.id == di || this.b1.id == di && this.b2.id == id;
	}
	,forest: function() {
		if(this.b1.isDynamic()) {
			var xr = this.b1.component == this.b1.component.parent?this.b1.component:(function($this) {
				var $r;
				var obj = $this.b1.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
		if(this.b2.isDynamic()) {
			var xr = this.b2.component == this.b2.component.parent?this.b2.component:(function($this) {
				var $r;
				var obj = $this.b2.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
	}
	,wake_connected: function() {
		if(this.b1 != null && this.b1.isDynamic()) this.b1.wake();
		if(this.b2 != null && this.b2.isDynamic()) this.b2.wake();
	}
	,validate: function() {
		if(this.b1 == null || this.b2 == null) throw "Error: PivotJoint cannot be simulated null bodies";
		if(this.b1 == this.b2) throw "Error: PivotJoint cannot be simulated with body1 == body2 (body1=body2=" + this.b1.outer.toString() + ")";
		if(this.b1.space != this.space || this.b2.space != this.space) throw "Error: Constraints must have each body within the same space to which the constraint has been assigned (body1=" + this.b1.outer.toString() + ", body2=" + this.b2.outer.toString() + ")";
		if(!this.b1.isDynamic() && !this.b2.isDynamic()) throw "Error: Constraints cannot have both bodies non-dynamic (body1=" + this.b1.outer.toString() + ", body2=" + this.b2.outer.toString() + ")";
	}
	,copy: function(dict,todo) {
		var ret = new nape.constraint.PivotJoint(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());
		this.copyto(ret);
		if(dict != null && this.b1 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b1.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b1 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b1.id,function(b1) {
				ret.zpp_inner_zn.b1 = b1.zpp_inner;
			}));
		}
		if(dict != null && this.b2 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b2.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b2 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b2.id,function(b1) {
				ret.zpp_inner_zn.b2 = b1.zpp_inner;
			}));
		}
		return ret;
	}
	,setup_a2: function() {
		this.wrap_a2 = nape.geom.Vec2.get(this.a2localx,this.a2localy);
		this.wrap_a2.zpp_inner._inuse = true;
		this.wrap_a2.zpp_inner._validate = $bind(this,this.validate_a2);
		this.wrap_a2.zpp_inner._invalidate = $bind(this,this.invalidate_a2);
	}
	,invalidate_a2: function(x) {
		this.immutable_midstep("Constraint::" + "a2");
		this.a2localx = x.x;
		this.a2localy = x.y;
		this.wake();
	}
	,validate_a2: function() {
		this.wrap_a2.zpp_inner.x = this.a2localx;
		this.wrap_a2.zpp_inner.y = this.a2localy;
	}
	,setup_a1: function() {
		this.wrap_a1 = nape.geom.Vec2.get(this.a1localx,this.a1localy);
		this.wrap_a1.zpp_inner._inuse = true;
		this.wrap_a1.zpp_inner._validate = $bind(this,this.validate_a1);
		this.wrap_a1.zpp_inner._invalidate = $bind(this,this.invalidate_a1);
	}
	,invalidate_a1: function(x) {
		this.immutable_midstep("Constraint::" + "a1");
		this.a1localx = x.x;
		this.a1localy = x.y;
		this.wake();
	}
	,validate_a1: function() {
		this.wrap_a1.zpp_inner.x = this.a1localx;
		this.wrap_a1.zpp_inner.y = this.a1localy;
	}
	,inactiveBodies: function() {
		if(this.b1 != null) this.b1.constraints.remove(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.remove(this);
		}
	}
	,activeBodies: function() {
		if(this.b1 != null) this.b1.constraints.add(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.add(this);
		}
	}
	,bodyImpulse: function(b) {
		if(this.stepped) {
			if(b == this.b1) return nape.geom.Vec3.get(-this.jAccx,-this.jAccy,-(this.jAccy * this.a1relx - this.jAccx * this.a1rely)); else return nape.geom.Vec3.get(this.jAccx,this.jAccy,this.jAccy * this.a2relx - this.jAccx * this.a2rely);
		} else return nape.geom.Vec3.get(0,0,0);
	}
	,__class__: zpp_nape.constraint.ZPP_PivotJoint
});
zpp_nape.constraint.ZPP_PulleyJoint = function() {
	this.stepped = false;
	this.bias = 0.0;
	this.gamma = 0.0;
	this.jMax = 0.0;
	this.jAcc = 0.0;
	this.kMass = 0.0;
	this.wrap_a4 = null;
	this.a4rely = 0.0;
	this.a4relx = 0.0;
	this.a4localy = 0.0;
	this.a4localx = 0.0;
	this.b4 = null;
	this.wrap_a3 = null;
	this.a3rely = 0.0;
	this.a3relx = 0.0;
	this.a3localy = 0.0;
	this.a3localx = 0.0;
	this.b3 = null;
	this.wrap_a2 = null;
	this.a2rely = 0.0;
	this.a2relx = 0.0;
	this.a2localy = 0.0;
	this.a2localx = 0.0;
	this.b2 = null;
	this.wrap_a1 = null;
	this.a1rely = 0.0;
	this.a1relx = 0.0;
	this.a1localy = 0.0;
	this.a1localx = 0.0;
	this.b1 = null;
	this.cx4 = 0.0;
	this.cx3 = 0.0;
	this.cx2 = 0.0;
	this.cx1 = 0.0;
	this.n34y = 0.0;
	this.n34x = 0.0;
	this.n12y = 0.0;
	this.n12x = 0.0;
	this.equal = false;
	this.slack = false;
	this.jointMax = 0.0;
	this.jointMin = 0.0;
	this.ratio = 1.0;
	this.outer_zn = null;
	zpp_nape.constraint.ZPP_Constraint.call(this);
	this.a1localx = 0;
	this.a1localy = 0;
	this.a1relx = 0;
	this.a1rely = 0;
	this.a2localx = 0;
	this.a2localy = 0;
	this.a2relx = 0;
	this.a2rely = 0;
	this.a3localx = 0;
	this.a3localy = 0;
	this.a3relx = 0;
	this.a3rely = 0;
	this.a4localx = 0;
	this.a4localy = 0;
	this.a4relx = 0;
	this.a4rely = 0;
	this.n12x = 1;
	this.n12y = 0;
	this.n34x = 1;
	this.n34y = 0;
	this.jAcc = 0;
	this.jMax = zpp_nape.ZPP_Const.POSINF();
	this.stepped = false;
	this.cx1 = this.cx2 = this.cx3 = this.cx4 = 0;
};
$hxClasses["zpp_nape.constraint.ZPP_PulleyJoint"] = zpp_nape.constraint.ZPP_PulleyJoint;
zpp_nape.constraint.ZPP_PulleyJoint.__name__ = ["zpp_nape","constraint","ZPP_PulleyJoint"];
zpp_nape.constraint.ZPP_PulleyJoint.__super__ = zpp_nape.constraint.ZPP_Constraint;
zpp_nape.constraint.ZPP_PulleyJoint.prototype = $extend(zpp_nape.constraint.ZPP_Constraint.prototype,{
	draw: function(g) {
	}
	,applyImpulsePos: function() {
		var E;
		var j;
		var r1x = 0.0;
		var r1y = 0.0;
		r1x = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		r1y = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		var r2x = 0.0;
		var r2y = 0.0;
		r2x = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		r2y = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		var r3x = 0.0;
		var r3y = 0.0;
		r3x = this.b3.axisy * this.a3localx - this.b3.axisx * this.a3localy;
		r3y = this.a3localx * this.b3.axisx + this.a3localy * this.b3.axisy;
		var r4x = 0.0;
		var r4y = 0.0;
		r4x = this.b4.axisy * this.a4localx - this.b4.axisx * this.a4localy;
		r4y = this.a4localx * this.b4.axisx + this.a4localy * this.b4.axisy;
		var slack;
		var n12x = 0.0;
		var n12y = 0.0;
		var n34x = 0.0;
		var n34y = 0.0;
		n12x = this.n12x;
		n12y = this.n12y;
		n34x = this.n34x;
		n34y = this.n34y;
		E = (function($this) {
			var $r;
			var t12x = 0.0;
			var t12y = 0.0;
			var t34x = 0.0;
			var t34y = 0.0;
			t12x = $this.b2.posx + r2x - ($this.b1.posx + r1x);
			t12y = $this.b2.posy + r2y - ($this.b1.posy + r1y);
			t34x = $this.b4.posx + r4x - ($this.b3.posx + r3x);
			t34y = $this.b4.posy + r4y - ($this.b3.posy + r3y);
			var C12 = zpp_nape.util.ZPP_Math.sqrt(t12x * t12x + t12y * t12y);
			var C34 = zpp_nape.util.ZPP_Math.sqrt(t34x * t34x + t34y * t34y);
			if(C12 != 0) {
				var t = 1.0 / C12;
				n12x = t12x * t;
				n12y = t12y * t;
			}
			if(C34 != 0) {
				var t = 1.0 / C34;
				n34x = t34x * t;
				n34y = t34y * t;
				var t = $this.ratio;
				n34x *= t;
				n34y *= t;
			} else {
				var t = $this.ratio / zpp_nape.util.ZPP_Math.sqrt(n34x * n34x + n34y * n34y);
				n34x *= t;
				n34y *= t;
			}
			var C = C12 + $this.ratio * C34;
			if($this.equal) {
				C -= $this.jointMax;
				slack = false;
			} else if(C < $this.jointMin) {
				C = $this.jointMin - C;
				n12x = -n12x;
				n12y = -n12y;
				n34x = -n34x;
				n34y = -n34y;
				slack = false;
			} else if(C > $this.jointMax) {
				C -= $this.jointMax;
				slack = false;
			} else {
				n12x = 0;
				n12y = 0;
				n34x = 0;
				n34y = 0;
				C = 0;
				slack = true;
			}
			$r = C;
			return $r;
		}(this));
		if(!slack) {
			if(this.breakUnderError && E * E > this.maxError * this.maxError) return true;
			if(E * E < nape.Config.constraintLinearSlop * nape.Config.constraintLinearSlop) return false;
			E *= 0.5;
			if(E * E > 6) {
				var k = this.b1.smass + this.b2.smass;
				if(k > nape.Config.epsilon) {
					k = 0.75 / k;
					j = -E * k;
					if(this.equal || j < 0) {
						var t = j * this.b1.imass;
						this.b1.posx -= n12x * t;
						this.b1.posy -= n12y * t;
						var t = j * this.b2.imass;
						this.b2.posx += n12x * t;
						this.b2.posy += n12y * t;
						var t = j * this.b3.imass;
						this.b3.posx -= n34x * t;
						this.b3.posy -= n34y * t;
						var t = j * this.b4.imass;
						this.b4.posx += n34x * t;
						this.b4.posy += n34y * t;
						E = (function($this) {
							var $r;
							var t12x = 0.0;
							var t12y = 0.0;
							var t34x = 0.0;
							var t34y = 0.0;
							t12x = $this.b2.posx + r2x - ($this.b1.posx + r1x);
							t12y = $this.b2.posy + r2y - ($this.b1.posy + r1y);
							t34x = $this.b4.posx + r4x - ($this.b3.posx + r3x);
							t34y = $this.b4.posy + r4y - ($this.b3.posy + r3y);
							var C12 = zpp_nape.util.ZPP_Math.sqrt(t12x * t12x + t12y * t12y);
							var C34 = zpp_nape.util.ZPP_Math.sqrt(t34x * t34x + t34y * t34y);
							if(C12 != 0) {
								var t = 1.0 / C12;
								n12x = t12x * t;
								n12y = t12y * t;
							}
							if(C34 != 0) {
								var t = 1.0 / C34;
								n34x = t34x * t;
								n34y = t34y * t;
								var t = $this.ratio;
								n34x *= t;
								n34y *= t;
							} else {
								var t = $this.ratio / zpp_nape.util.ZPP_Math.sqrt(n34x * n34x + n34y * n34y);
								n34x *= t;
								n34y *= t;
							}
							var C = C12 + $this.ratio * C34;
							if($this.equal) {
								C -= $this.jointMax;
								slack = false;
							} else if(C < $this.jointMin) {
								C = $this.jointMin - C;
								n12x = -n12x;
								n12y = -n12y;
								n34x = -n34x;
								n34y = -n34y;
								slack = false;
							} else if(C > $this.jointMax) {
								C -= $this.jointMax;
								slack = false;
							} else {
								n12x = 0;
								n12y = 0;
								n34x = 0;
								n34y = 0;
								C = 0;
								slack = true;
							}
							$r = C;
							return $r;
						}(this));
						E *= 0.5;
					}
				}
			}
			var cx1, cx2, cx3, cx4;
			var k = (function($this) {
				var $r;
				cx1 = n12y * r1x - n12x * r1y;
				cx2 = n12y * r2x - n12x * r2y;
				cx3 = n34y * r3x - n34x * r3y;
				cx4 = n34y * r4x - n34x * r4y;
				var ratioSq = $this.ratio * $this.ratio;
				var K = $this.b1.smass + $this.b2.smass + ratioSq * ($this.b3.smass + $this.b4.smass) + $this.b1.sinertia * cx1 * cx1 + $this.b2.sinertia * cx2 * cx2 + $this.b3.sinertia * cx3 * cx3 + $this.b4.sinertia * cx4 * cx4;
				if($this.b1 == $this.b4) K -= 2 * ((n12x * n34x + n12y * n34y) * $this.b1.smass + cx1 * cx4 * $this.b1.sinertia);
				if($this.b1 == $this.b3) K += 2 * ((n12x * n34x + n12y * n34y) * $this.b1.smass + cx1 * cx3 * $this.b1.sinertia);
				if($this.b2 == $this.b3) K -= 2 * ((n12x * n34x + n12y * n34y) * $this.b2.smass + cx2 * cx3 * $this.b2.sinertia);
				if($this.b2 == $this.b4) K += 2 * ((n12x * n34x + n12y * n34y) * $this.b2.smass + cx2 * cx4 * $this.b2.sinertia);
				$r = K;
				return $r;
			}(this));
			if(k != 0) k = 1 / k;
			j = -E * k;
			if(this.equal || j < 0) {
				if(true) {
					var t = this.b1.imass * j;
					this.b1.posx -= n12x * t;
					this.b1.posy -= n12y * t;
					var t = this.b2.imass * j;
					this.b2.posx += n12x * t;
					this.b2.posy += n12y * t;
					var t = this.b3.imass * j;
					this.b3.posx -= n34x * t;
					this.b3.posy -= n34y * t;
					var t = this.b4.imass * j;
					this.b4.posx += n34x * t;
					this.b4.posy += n34y * t;
					this.b1.delta_rot(-cx1 * this.b1.iinertia * j);
					this.b2.delta_rot(cx2 * this.b2.iinertia * j);
					this.b3.delta_rot(-cx3 * this.b3.iinertia * j);
					this.b4.delta_rot(cx4 * this.b4.iinertia * j);
				} else {
					var t = this.b1.imass * j;
					this.b1.velx -= n12x * t;
					this.b1.vely -= n12y * t;
					var t = this.b2.imass * j;
					this.b2.velx += n12x * t;
					this.b2.vely += n12y * t;
					var t = this.b3.imass * j;
					this.b3.velx -= n34x * t;
					this.b3.vely -= n34y * t;
					var t = this.b4.imass * j;
					this.b4.velx += n34x * t;
					this.b4.vely += n34y * t;
					this.b1.angvel -= cx1 * this.b1.iinertia * j;
					this.b2.angvel += cx2 * this.b2.iinertia * j;
					this.b3.angvel -= cx3 * this.b3.iinertia * j;
					this.b4.angvel += cx4 * this.b4.iinertia * j;
				}
			}
		}
		return false;
	}
	,applyImpulseVel: function() {
		if(this.slack) return false;
		var E = this.n12x * (this.b2.velx + this.b2.kinvelx - this.b1.velx - this.b1.kinvelx) + this.n12y * (this.b2.vely + this.b2.kinvely - this.b1.vely - this.b1.kinvely) + this.n34x * (this.b4.velx + this.b4.kinvelx - this.b3.velx - this.b3.kinvelx) + this.n34y * (this.b4.vely + this.b4.kinvely - this.b3.vely - this.b3.kinvely) + (this.b2.angvel + this.b2.kinangvel) * this.cx2 - (this.b1.angvel + this.b1.kinangvel) * this.cx1 + (this.b4.angvel + this.b4.kinangvel) * this.cx4 - (this.b3.angvel + this.b3.kinangvel) * this.cx3;
		var j = this.kMass * (this.bias - E) - this.jAcc * this.gamma;
		var jOld = this.jAcc;
		this.jAcc += j;
		if(!this.equal && this.jAcc > 0) this.jAcc = 0;
		if(this.breakUnderForce && this.jAcc < -this.jMax) return true;
		if(!this.stiff) {
			if(this.jAcc < -this.jMax) this.jAcc = -this.jMax;
		}
		j = this.jAcc - jOld;
		if(false) {
			var t = this.b1.imass * j;
			this.b1.posx -= this.n12x * t;
			this.b1.posy -= this.n12y * t;
			var t = this.b2.imass * j;
			this.b2.posx += this.n12x * t;
			this.b2.posy += this.n12y * t;
			var t = this.b3.imass * j;
			this.b3.posx -= this.n34x * t;
			this.b3.posy -= this.n34y * t;
			var t = this.b4.imass * j;
			this.b4.posx += this.n34x * t;
			this.b4.posy += this.n34y * t;
			this.b1.delta_rot(-this.cx1 * this.b1.iinertia * j);
			this.b2.delta_rot(this.cx2 * this.b2.iinertia * j);
			this.b3.delta_rot(-this.cx3 * this.b3.iinertia * j);
			this.b4.delta_rot(this.cx4 * this.b4.iinertia * j);
		} else {
			var t = this.b1.imass * j;
			this.b1.velx -= this.n12x * t;
			this.b1.vely -= this.n12y * t;
			var t = this.b2.imass * j;
			this.b2.velx += this.n12x * t;
			this.b2.vely += this.n12y * t;
			var t = this.b3.imass * j;
			this.b3.velx -= this.n34x * t;
			this.b3.vely -= this.n34y * t;
			var t = this.b4.imass * j;
			this.b4.velx += this.n34x * t;
			this.b4.vely += this.n34y * t;
			this.b1.angvel -= this.cx1 * this.b1.iinertia * j;
			this.b2.angvel += this.cx2 * this.b2.iinertia * j;
			this.b3.angvel -= this.cx3 * this.b3.iinertia * j;
			this.b4.angvel += this.cx4 * this.b4.iinertia * j;
		}
		return false;
	}
	,warmStart: function() {
		if(!this.slack) {
			if(false) {
				var t = this.b1.imass * this.jAcc;
				this.b1.posx -= this.n12x * t;
				this.b1.posy -= this.n12y * t;
				var t = this.b2.imass * this.jAcc;
				this.b2.posx += this.n12x * t;
				this.b2.posy += this.n12y * t;
				var t = this.b3.imass * this.jAcc;
				this.b3.posx -= this.n34x * t;
				this.b3.posy -= this.n34y * t;
				var t = this.b4.imass * this.jAcc;
				this.b4.posx += this.n34x * t;
				this.b4.posy += this.n34y * t;
				this.b1.delta_rot(-this.cx1 * this.b1.iinertia * this.jAcc);
				this.b2.delta_rot(this.cx2 * this.b2.iinertia * this.jAcc);
				this.b3.delta_rot(-this.cx3 * this.b3.iinertia * this.jAcc);
				this.b4.delta_rot(this.cx4 * this.b4.iinertia * this.jAcc);
			} else {
				var t = this.b1.imass * this.jAcc;
				this.b1.velx -= this.n12x * t;
				this.b1.vely -= this.n12y * t;
				var t = this.b2.imass * this.jAcc;
				this.b2.velx += this.n12x * t;
				this.b2.vely += this.n12y * t;
				var t = this.b3.imass * this.jAcc;
				this.b3.velx -= this.n34x * t;
				this.b3.vely -= this.n34y * t;
				var t = this.b4.imass * this.jAcc;
				this.b4.velx += this.n34x * t;
				this.b4.vely += this.n34y * t;
				this.b1.angvel -= this.cx1 * this.b1.iinertia * this.jAcc;
				this.b2.angvel += this.cx2 * this.b2.iinertia * this.jAcc;
				this.b3.angvel -= this.cx3 * this.b3.iinertia * this.jAcc;
				this.b4.angvel += this.cx4 * this.b4.iinertia * this.jAcc;
			}
		}
	}
	,preStep: function(dt) {
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		this.stepped = true;
		this.equal = this.jointMin == this.jointMax;
		this.a1relx = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		this.a1rely = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		this.a2relx = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		this.a2rely = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		this.a3relx = this.b3.axisy * this.a3localx - this.b3.axisx * this.a3localy;
		this.a3rely = this.a3localx * this.b3.axisx + this.a3localy * this.b3.axisy;
		this.a4relx = this.b4.axisy * this.a4localx - this.b4.axisx * this.a4localy;
		this.a4rely = this.a4localx * this.b4.axisx + this.a4localy * this.b4.axisy;
		var C = (function($this) {
			var $r;
			var t12x = 0.0;
			var t12y = 0.0;
			var t34x = 0.0;
			var t34y = 0.0;
			t12x = $this.b2.posx + $this.a2relx - ($this.b1.posx + $this.a1relx);
			t12y = $this.b2.posy + $this.a2rely - ($this.b1.posy + $this.a1rely);
			t34x = $this.b4.posx + $this.a4relx - ($this.b3.posx + $this.a3relx);
			t34y = $this.b4.posy + $this.a4rely - ($this.b3.posy + $this.a3rely);
			var C12 = zpp_nape.util.ZPP_Math.sqrt(t12x * t12x + t12y * t12y);
			var C34 = zpp_nape.util.ZPP_Math.sqrt(t34x * t34x + t34y * t34y);
			if(C12 != 0) {
				var t = 1.0 / C12;
				$this.n12x = t12x * t;
				$this.n12y = t12y * t;
			}
			if(C34 != 0) {
				var t = 1.0 / C34;
				$this.n34x = t34x * t;
				$this.n34y = t34y * t;
				var t = $this.ratio;
				$this.n34x *= t;
				$this.n34y *= t;
			} else {
				var t = $this.ratio / zpp_nape.util.ZPP_Math.sqrt($this.n34x * $this.n34x + $this.n34y * $this.n34y);
				$this.n34x *= t;
				$this.n34y *= t;
			}
			var C1 = C12 + $this.ratio * C34;
			if($this.equal) {
				C1 -= $this.jointMax;
				$this.slack = false;
			} else if(C1 < $this.jointMin) {
				C1 = $this.jointMin - C1;
				$this.n12x = -$this.n12x;
				$this.n12y = -$this.n12y;
				$this.n34x = -$this.n34x;
				$this.n34y = -$this.n34y;
				$this.slack = false;
			} else if(C1 > $this.jointMax) {
				C1 -= $this.jointMax;
				$this.slack = false;
			} else {
				$this.n12x = 0;
				$this.n12y = 0;
				$this.n34x = 0;
				$this.n34y = 0;
				C1 = 0;
				$this.slack = true;
			}
			$r = C1;
			return $r;
		}(this));
		if(!this.slack) {
			this.kMass = (function($this) {
				var $r;
				$this.cx1 = $this.n12y * $this.a1relx - $this.n12x * $this.a1rely;
				$this.cx2 = $this.n12y * $this.a2relx - $this.n12x * $this.a2rely;
				$this.cx3 = $this.n34y * $this.a3relx - $this.n34x * $this.a3rely;
				$this.cx4 = $this.n34y * $this.a4relx - $this.n34x * $this.a4rely;
				var ratioSq = $this.ratio * $this.ratio;
				var K = $this.b1.smass + $this.b2.smass + ratioSq * ($this.b3.smass + $this.b4.smass) + $this.b1.sinertia * $this.cx1 * $this.cx1 + $this.b2.sinertia * $this.cx2 * $this.cx2 + $this.b3.sinertia * $this.cx3 * $this.cx3 + $this.b4.sinertia * $this.cx4 * $this.cx4;
				if($this.b1 == $this.b4) K -= 2 * (($this.n12x * $this.n34x + $this.n12y * $this.n34y) * $this.b1.smass + $this.cx1 * $this.cx4 * $this.b1.sinertia);
				if($this.b1 == $this.b3) K += 2 * (($this.n12x * $this.n34x + $this.n12y * $this.n34y) * $this.b1.smass + $this.cx1 * $this.cx3 * $this.b1.sinertia);
				if($this.b2 == $this.b3) K -= 2 * (($this.n12x * $this.n34x + $this.n12y * $this.n34y) * $this.b2.smass + $this.cx2 * $this.cx3 * $this.b2.sinertia);
				if($this.b2 == $this.b4) K += 2 * (($this.n12x * $this.n34x + $this.n12y * $this.n34y) * $this.b2.smass + $this.cx2 * $this.cx4 * $this.b2.sinertia);
				$r = K;
				return $r;
			}(this));
			if(this.kMass != 0) this.kMass = 1 / this.kMass; else this.jAcc = 0;
			if(!this.stiff) {
				if(this.breakUnderError && C * C > this.maxError * this.maxError) return true;
				var biasCoef;
				this.kMass *= (function($this) {
					var $r;
					var omega = 2 * Math.PI * $this.frequency;
					$this.gamma = 1 / (dt * omega * (2 * $this.damping + omega * dt));
					var ig = 1 / (1 + $this.gamma);
					biasCoef = dt * omega * omega * $this.gamma;
					$this.gamma *= ig;
					$r = ig;
					return $r;
				}(this));
				this.bias = -C * biasCoef;
				if(this.bias < -this.maxError) this.bias = -this.maxError; else if(this.bias > this.maxError) this.bias = this.maxError;
			} else {
				this.bias = 0;
				this.gamma = 0;
			}
			this.jAcc *= dtratio;
			this.jMax = this.maxForce * dt;
		}
		return false;
	}
	,clearcache: function() {
		this.jAcc = 0;
		this.pre_dt = -1.0;
	}
	,pair_exists: function(id,di) {
		return this.b1.id == id && (this.b2.id == di || this.b3.id == di || this.b4.id == di) || this.b2.id == id && (this.b3.id == di || this.b4.id == di || this.b1.id == di) || this.b3.id == id && (this.b4.id == di || this.b1.id == di || this.b2.id == di) || this.b4.id == id && (this.b1.id == di || this.b2.id == di || this.b3.id == di);
	}
	,forest: function() {
		if(this.b1.isDynamic()) {
			var xr = this.b1.component == this.b1.component.parent?this.b1.component:(function($this) {
				var $r;
				var obj = $this.b1.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
		if(this.b2.isDynamic()) {
			var xr = this.b2.component == this.b2.component.parent?this.b2.component:(function($this) {
				var $r;
				var obj = $this.b2.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
		if(this.b3.isDynamic()) {
			var xr = this.b3.component == this.b3.component.parent?this.b3.component:(function($this) {
				var $r;
				var obj = $this.b3.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
		if(this.b4.isDynamic()) {
			var xr = this.b4.component == this.b4.component.parent?this.b4.component:(function($this) {
				var $r;
				var obj = $this.b4.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
	}
	,wake_connected: function() {
		if(this.b1 != null && this.b1.isDynamic()) this.b1.wake();
		if(this.b2 != null && this.b2.isDynamic()) this.b2.wake();
		if(this.b3 != null && this.b3.isDynamic()) this.b3.wake();
		if(this.b4 != null && this.b4.isDynamic()) this.b4.wake();
	}
	,validate: function() {
		if(this.b1 == null || this.b2 == null || this.b3 == null || this.b4 == null) throw "Error: PulleyJoint cannot be simulated with null bodies";
		if(this.b1 == this.b2 || this.b3 == this.b4) throw "Error: PulleyJoint cannot have body1==body2 or body3==body4";
		if(this.b1.space != this.space || this.b2.space != this.space || this.b3.space != this.space || this.b4.space != this.space) throw "Error: Constraints must have each body within the same space to which the constraint has been assigned";
		if(this.jointMin > this.jointMax) throw "Error: PulleyJoint must have jointMin <= jointMax";
		if(!this.b1.isDynamic() && !this.b2.isDynamic()) throw "Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic";
		if(!this.b3.isDynamic() && !this.b4.isDynamic()) throw "Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic";
	}
	,copy: function(dict,todo) {
		var ret = new nape.constraint.PulleyJoint(null,null,null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_anchor3(),this.outer_zn.get_anchor4(),this.jointMin,this.jointMax,this.ratio);
		this.copyto(ret);
		if(dict != null && this.b1 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b1.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b1 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b1.id,function(b1) {
				ret.zpp_inner_zn.b1 = b1.zpp_inner;
			}));
		}
		if(dict != null && this.b2 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b2.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b2 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b2.id,function(b1) {
				ret.zpp_inner_zn.b2 = b1.zpp_inner;
			}));
		}
		if(dict != null && this.b3 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b3.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b3 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b3.id,function(b1) {
				ret.zpp_inner_zn.b3 = b1.zpp_inner;
			}));
		}
		if(dict != null && this.b4 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b4.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b4 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b4.id,function(b1) {
				ret.zpp_inner_zn.b4 = b1.zpp_inner;
			}));
		}
		return ret;
	}
	,setup_a4: function() {
		this.wrap_a4 = nape.geom.Vec2.get(this.a4localx,this.a4localy);
		this.wrap_a4.zpp_inner._inuse = true;
		this.wrap_a4.zpp_inner._validate = $bind(this,this.validate_a4);
		this.wrap_a4.zpp_inner._invalidate = $bind(this,this.invalidate_a4);
	}
	,invalidate_a4: function(x) {
		this.immutable_midstep("Constraint::" + "a4");
		this.a4localx = x.x;
		this.a4localy = x.y;
		this.wake();
	}
	,validate_a4: function() {
		this.wrap_a4.zpp_inner.x = this.a4localx;
		this.wrap_a4.zpp_inner.y = this.a4localy;
	}
	,setup_a3: function() {
		this.wrap_a3 = nape.geom.Vec2.get(this.a3localx,this.a3localy);
		this.wrap_a3.zpp_inner._inuse = true;
		this.wrap_a3.zpp_inner._validate = $bind(this,this.validate_a3);
		this.wrap_a3.zpp_inner._invalidate = $bind(this,this.invalidate_a3);
	}
	,invalidate_a3: function(x) {
		this.immutable_midstep("Constraint::" + "a3");
		this.a3localx = x.x;
		this.a3localy = x.y;
		this.wake();
	}
	,validate_a3: function() {
		this.wrap_a3.zpp_inner.x = this.a3localx;
		this.wrap_a3.zpp_inner.y = this.a3localy;
	}
	,setup_a2: function() {
		this.wrap_a2 = nape.geom.Vec2.get(this.a2localx,this.a2localy);
		this.wrap_a2.zpp_inner._inuse = true;
		this.wrap_a2.zpp_inner._validate = $bind(this,this.validate_a2);
		this.wrap_a2.zpp_inner._invalidate = $bind(this,this.invalidate_a2);
	}
	,invalidate_a2: function(x) {
		this.immutable_midstep("Constraint::" + "a2");
		this.a2localx = x.x;
		this.a2localy = x.y;
		this.wake();
	}
	,validate_a2: function() {
		this.wrap_a2.zpp_inner.x = this.a2localx;
		this.wrap_a2.zpp_inner.y = this.a2localy;
	}
	,setup_a1: function() {
		this.wrap_a1 = nape.geom.Vec2.get(this.a1localx,this.a1localy);
		this.wrap_a1.zpp_inner._inuse = true;
		this.wrap_a1.zpp_inner._validate = $bind(this,this.validate_a1);
		this.wrap_a1.zpp_inner._invalidate = $bind(this,this.invalidate_a1);
	}
	,invalidate_a1: function(x) {
		this.immutable_midstep("Constraint::" + "a1");
		this.a1localx = x.x;
		this.a1localy = x.y;
		this.wake();
	}
	,validate_a1: function() {
		this.wrap_a1.zpp_inner.x = this.a1localx;
		this.wrap_a1.zpp_inner.y = this.a1localy;
	}
	,inactiveBodies: function() {
		if(this.b1 != null) this.b1.constraints.remove(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.remove(this);
		}
		if(this.b3 != this.b1 && this.b3 != this.b2) {
			if(this.b3 != null) this.b3.constraints.remove(this);
		}
		if(this.b4 != this.b1 && this.b4 != this.b2 && this.b4 != this.b3) {
			if(this.b4 != null) this.b4.constraints.remove(this);
		}
	}
	,activeBodies: function() {
		if(this.b1 != null) this.b1.constraints.add(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.add(this);
		}
		if(this.b3 != this.b1 && this.b3 != this.b2) {
			if(this.b3 != null) this.b3.constraints.add(this);
		}
		if(this.b4 != this.b1 && this.b4 != this.b2 && this.b4 != this.b3) {
			if(this.b4 != null) this.b4.constraints.add(this);
		}
	}
	,bodyImpulse: function(b) {
		if(this.stepped) {
			var ret = nape.geom.Vec3.get();
			if(b == this.b1) {
				var _g = ret;
				_g.set_x(_g.get_x() - this.jAcc * this.n12x);
				var _g = ret;
				_g.set_y(_g.get_y() - this.jAcc * this.n12y);
				var _g = ret;
				_g.set_z(_g.get_z() - this.cx1 * this.jAcc);
			}
			if(b == this.b2) {
				var _g = ret;
				_g.set_x(_g.get_x() + this.jAcc * this.n12x);
				var _g = ret;
				_g.set_y(_g.get_y() + this.jAcc * this.n12y);
				var _g = ret;
				_g.set_z(_g.get_z() + this.cx2 * this.jAcc);
			}
			if(b == this.b3) {
				var _g = ret;
				_g.set_x(_g.get_x() - this.jAcc * this.n34x);
				var _g = ret;
				_g.set_y(_g.get_y() - this.jAcc * this.n34y);
				var _g = ret;
				_g.set_z(_g.get_z() - this.cx3 * this.jAcc);
			}
			if(b == this.b4) {
				var _g = ret;
				_g.set_x(_g.get_x() + this.jAcc * this.n34x);
				var _g = ret;
				_g.set_y(_g.get_y() + this.jAcc * this.n34y);
				var _g = ret;
				_g.set_z(_g.get_z() + this.cx4 * this.jAcc);
			}
			return ret;
		} else return nape.geom.Vec3.get(0,0,0);
	}
	,__class__: zpp_nape.constraint.ZPP_PulleyJoint
});
zpp_nape.constraint.ZPP_UserConstraint = function() {
	this.jOld = null;
	this.J = null;
	this.vec3 = null;
	this.Keff = null;
	this.jMax = 0.0;
	this.velonly = false;
	this.gamma = 0.0;
	this.soft = 0.0;
	this.y = null;
	this.L = null;
	this.stepped = false;
	this.bias = null;
	this.jAcc = null;
	this.dim = 0;
	this.bodies = null;
	this.outer_zn = null;
};
$hxClasses["zpp_nape.constraint.ZPP_UserConstraint"] = zpp_nape.constraint.ZPP_UserConstraint;
zpp_nape.constraint.ZPP_UserConstraint.__name__ = ["zpp_nape","constraint","ZPP_UserConstraint"];
zpp_nape.constraint.ZPP_UserConstraint.__super__ = zpp_nape.constraint.ZPP_Constraint;
zpp_nape.constraint.ZPP_UserConstraint.prototype = $extend(zpp_nape.constraint.ZPP_Constraint.prototype,{
	draw: function(g) {
		this.outer_zn.__draw(g);
	}
	,applyImpulsePos: function() {
		if(this.velonly) return false;
		this.outer_zn.__prepare();
		this.outer_zn.__position(this.J);
		var lj = this.lsq(this.J);
		if(this.breakUnderError && lj > this.maxError * this.maxError) return true; else if(lj < nape.Config.constraintLinearSlop * nape.Config.constraintLinearSlop) return false;
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var i = _g1++;
			this.J[i] *= -1;
		}
		this.outer_zn.__eff_mass(this.Keff);
		this.transform(this.solve(this.Keff),this.J);
		this.outer_zn.__clamp(this.J);
		var _g = 0, _g1 = this.bodies;
		while(_g < _g1.length) {
			var bs = _g1[_g];
			++_g;
			var b = bs.body;
			this.outer_zn.__impulse(this.J,b.outer,this.vec3);
			var t = b.imass;
			b.posx += this.vec3.get_x() * t;
			b.posy += this.vec3.get_y() * t;
			b.delta_rot(this.vec3.get_z() * b.iinertia);
		}
		return false;
	}
	,applyImpulseVel: function() {
		this.outer_zn.__velocity(this.J);
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var i = _g1++;
			this.J[i] = this.bias[i] - this.J[i];
		}
		this.transform(this.L,this.J);
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var i = _g1++;
			this.jOld[i] = this.jAcc[i];
			this.jAcc[i] += this.J[i] = this.J[i] * this.soft - this.jAcc[i] * this.gamma;
		}
		this.outer_zn.__clamp(this.jAcc);
		if((this.breakUnderForce || !this.stiff) && this.lsq(this.jAcc) > this.jMax * this.jMax) {
			if(this.breakUnderForce) return true; else if(!this.stiff) this._clamp(this.jAcc,this.jMax);
		}
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var i = _g1++;
			this.J[i] = this.jAcc[i] - this.jOld[i];
		}
		var _g = 0, _g1 = this.bodies;
		while(_g < _g1.length) {
			var bs = _g1[_g];
			++_g;
			var b = bs.body;
			this.outer_zn.__impulse(this.J,b.outer,this.vec3);
			var t = b.imass;
			b.velx += this.vec3.get_x() * t;
			b.vely += this.vec3.get_y() * t;
			b.angvel += this.vec3.get_z() * b.iinertia;
		}
		return false;
	}
	,warmStart: function() {
		var _g = 0, _g1 = this.bodies;
		while(_g < _g1.length) {
			var bs = _g1[_g];
			++_g;
			var b = bs.body;
			this.outer_zn.__impulse(this.jAcc,b.outer,this.vec3);
			var t = b.imass;
			b.velx += this.vec3.get_x() * t;
			b.vely += this.vec3.get_y() * t;
			b.angvel += this.vec3.get_z() * b.iinertia;
		}
	}
	,preStep: function(dt) {
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		this.stepped = true;
		this.outer_zn.__prepare();
		this.outer_zn.__eff_mass(this.Keff);
		this.L = this.solve(this.Keff);
		if(!this.stiff && !this.velonly) {
			var biasCoef;
			this.soft = (function($this) {
				var $r;
				var omega = 2 * Math.PI * $this.frequency;
				$this.gamma = 1 / (dt * omega * (2 * $this.damping + omega * dt));
				var ig = 1 / (1 + $this.gamma);
				biasCoef = dt * omega * omega * $this.gamma;
				$this.gamma *= ig;
				$r = ig;
				return $r;
			}(this));
			this.outer_zn.__position(this.bias);
			if(this.breakUnderError && this.lsq(this.bias) > this.maxError * this.maxError) return true;
			var _g1 = 0, _g = this.dim;
			while(_g1 < _g) {
				var i = _g1++;
				this.bias[i] *= -biasCoef;
			}
			this._clamp(this.bias,this.maxError);
		} else {
			var _g1 = 0, _g = this.dim;
			while(_g1 < _g) {
				var i = _g1++;
				this.bias[i] = 0.0;
			}
			this.gamma = 0.0;
			this.soft = 1.0;
		}
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var i = _g1++;
			this.jAcc[i] *= dtratio;
		}
		this.jMax = this.maxForce * dt;
		return false;
	}
	,transform: function(L,x) {
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var i = _g1++;
			var sum = x[i];
			var lii = L[i * this.dim + i];
			if(lii != 0) {
				var _g2 = 0;
				while(_g2 < i) {
					var k = _g2++;
					sum -= L[i * this.dim + k] * this.y[k];
				}
				this.y[i] = sum / lii;
			} else this.y[i] = 0.0;
		}
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var ix = _g1++;
			var i = this.dim - 1 - ix;
			var lii = L[i * this.dim + i];
			if(lii != 0) {
				var sum = this.y[i];
				var _g3 = i + 1, _g2 = this.dim;
				while(_g3 < _g2) {
					var k = _g3++;
					sum -= L[k * this.dim + i] * x[k];
				}
				x[i] = sum / lii;
			} else x[i] = 0.0;
		}
	}
	,solve: function(m) {
		var ind = 0;
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var j = _g1++;
			var sum = 0.0;
			var _g3 = 0, _g2 = j - 1;
			while(_g3 < _g2) {
				var k = _g3++;
				sum += this.L[j * this.dim + k] * this.L[j * this.dim + k];
			}
			var rec = Math.sqrt(m[ind++] - sum);
			this.L[j * this.dim + j] = rec;
			if(rec != 0) {
				rec = 1.0 / rec;
				var _g3 = j + 1, _g2 = this.dim;
				while(_g3 < _g2) {
					var i = _g3++;
					var sum1 = 0.0;
					var _g5 = 0, _g4 = j - 1;
					while(_g5 < _g4) {
						var k = _g5++;
						sum1 += this.L[i * this.dim + k] * this.L[j * this.dim + k];
					}
					this.L[i * this.dim + j] = rec * (m[ind++] - sum1);
				}
			} else {
				var _g3 = j + 1, _g2 = this.dim;
				while(_g3 < _g2) {
					var i = _g3++;
					this.L[i * this.dim + j] = 0.0;
				}
				ind += this.dim - j - 1;
			}
		}
		return this.L;
	}
	,_clamp: function(v,max) {
		var x = this.lsq(v);
		if(x > max * max) {
			var scale = max / Math.sqrt(x);
			var _g1 = 0, _g = this.dim;
			while(_g1 < _g) {
				var i = _g1++;
				v[i] *= scale;
			}
		}
	}
	,lsq: function(v) {
		var sum = 0.0;
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var i = _g1++;
			sum += v[i] * v[i];
		}
		return sum;
	}
	,clearcache: function() {
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var i = _g1++;
			this.jAcc[i] = 0.0;
		}
		this.pre_dt = -1.0;
	}
	,broken: function() {
		this.outer_zn.__broken();
	}
	,pair_exists: function(id,di) {
		var ret = false;
		var bl = Std["int"](this.bodies.length);
		var _g = 0;
		while(_g < bl) {
			var bi = _g++;
			var b = this.bodies[bi].body;
			var _g1 = bi + 1;
			while(_g1 < bl) {
				var ci = _g1++;
				var c = this.bodies[ci].body;
				if(b.id == id && c.id == di || b.id == di && c.id == id) {
					ret = true;
					break;
				}
			}
			if(ret) break;
		}
		return ret;
	}
	,forest: function() {
		var _g = 0, _g1 = this.bodies;
		while(_g < _g1.length) {
			var b = _g1[_g];
			++_g;
			if(b.body.isDynamic()) {
				var xr = b.body.component == b.body.component.parent?b.body.component:(function($this) {
					var $r;
					var obj = b.body.component;
					var stack = null;
					while(obj != obj.parent) {
						var nxt = obj.parent;
						obj.parent = stack;
						stack = obj;
						obj = nxt;
					}
					while(stack != null) {
						var nxt = stack.parent;
						stack.parent = obj;
						stack = nxt;
					}
					$r = obj;
					return $r;
				}(this));
				var yr = this.component == this.component.parent?this.component:(function($this) {
					var $r;
					var obj = $this.component;
					var stack = null;
					while(obj != obj.parent) {
						var nxt = obj.parent;
						obj.parent = stack;
						stack = obj;
						obj = nxt;
					}
					while(stack != null) {
						var nxt = stack.parent;
						stack.parent = obj;
						stack = nxt;
					}
					$r = obj;
					return $r;
				}(this));
				if(xr != yr) {
					if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
						yr.parent = xr;
						xr.rank++;
					}
				}
			}
		}
	}
	,wake_connected: function() {
		var _g = 0, _g1 = this.bodies;
		while(_g < _g1.length) {
			var b = _g1[_g];
			++_g;
			if(b.body.isDynamic()) b.body.wake();
		}
	}
	,validate: function() {
		var _g = 0, _g1 = this.bodies;
		while(_g < _g1.length) {
			var b = _g1[_g];
			++_g;
			if(b.body.space != this.space) throw "Error: Constraints must have each body within the same sapce to which the constraint has been assigned";
		}
		this.outer_zn.__validate();
	}
	,copy: function(dict,todo) {
		var ret = this.outer_zn.__copy();
		this.copyto(ret);
		throw "not done yet";
		return ret;
	}
	,inactiveBodies: function() {
		var _g = 0, _g1 = this.bodies;
		while(_g < _g1.length) {
			var b = _g1[_g];
			++_g;
			if(b.body != null) b.body.constraints.remove(this);
		}
	}
	,activeBodies: function() {
		var _g = 0, _g1 = this.bodies;
		while(_g < _g1.length) {
			var b = _g1[_g];
			++_g;
			if(b.body != null) b.body.constraints.add(this);
		}
	}
	,bodyImpulse: function(b) {
		var _g1 = 0, _g = this.dim;
		while(_g1 < _g) {
			var i = _g1++;
			this.J[i] = this.jAcc[i];
		}
		var ret = nape.geom.Vec3.get(0,0,0);
		if(this.stepped) this.outer_zn.__impulse(this.J,b.outer,ret);
		return ret;
	}
	,__class__: zpp_nape.constraint.ZPP_UserConstraint
});
zpp_nape.constraint.ZPP_UserBody = function() {
	this.body = null;
};
$hxClasses["zpp_nape.constraint.ZPP_UserBody"] = zpp_nape.constraint.ZPP_UserBody;
zpp_nape.constraint.ZPP_UserBody.__name__ = ["zpp_nape","constraint","ZPP_UserBody"];
zpp_nape.constraint.ZPP_UserBody.prototype = {
	__class__: zpp_nape.constraint.ZPP_UserBody
}
zpp_nape.constraint.ZPP_WeldJoint = function() {
	this.stepped = false;
	this.biasz = 0.0;
	this.biasy = 0.0;
	this.biasx = 0.0;
	this.gamma = 0.0;
	this.jMax = 0.0;
	this.jAccz = 0.0;
	this.jAccy = 0.0;
	this.jAccx = 0.0;
	this.kMassf = 0.0;
	this.kMasse = 0.0;
	this.kMassc = 0.0;
	this.kMassd = 0.0;
	this.kMassb = 0.0;
	this.kMassa = 0.0;
	this.phase = 0.0;
	this.wrap_a2 = null;
	this.a2rely = 0.0;
	this.a2relx = 0.0;
	this.a2localy = 0.0;
	this.a2localx = 0.0;
	this.b2 = null;
	this.wrap_a1 = null;
	this.a1rely = 0.0;
	this.a1relx = 0.0;
	this.a1localy = 0.0;
	this.a1localx = 0.0;
	this.b1 = null;
	this.outer_zn = null;
};
$hxClasses["zpp_nape.constraint.ZPP_WeldJoint"] = zpp_nape.constraint.ZPP_WeldJoint;
zpp_nape.constraint.ZPP_WeldJoint.__name__ = ["zpp_nape","constraint","ZPP_WeldJoint"];
zpp_nape.constraint.ZPP_WeldJoint.__super__ = zpp_nape.constraint.ZPP_Constraint;
zpp_nape.constraint.ZPP_WeldJoint.prototype = $extend(zpp_nape.constraint.ZPP_Constraint.prototype,{
	draw: function(g) {
	}
	,applyImpulsePos: function() {
		var r1x = 0.0;
		var r1y = 0.0;
		r1x = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		r1y = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		var r2x = 0.0;
		var r2y = 0.0;
		r2x = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		r2y = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		var Ex = 0.0;
		var Ey = 0.0;
		var Ez = 0.0;
		Ex = this.b2.posx + r2x - (this.b1.posx + r1x);
		Ey = this.b2.posy + r2y - (this.b1.posy + r1y);
		Ez = this.b2.rot - this.b1.rot - this.phase;
		var Jx = 0.0;
		var Jy = 0.0;
		var Jz = 0.0;
		if(this.breakUnderError && Ex * Ex + Ey * Ey + Ez * Ez > this.maxError * this.maxError) return true;
		var cont = true;
		if(Ex * Ex + Ey * Ey < nape.Config.constraintLinearSlop * nape.Config.constraintLinearSlop) {
			cont = false;
			Ex = 0;
			Ey = 0;
		}
		if(zpp_nape.util.ZPP_Math.sqr(Ez) < zpp_nape.util.ZPP_Math.sqr(nape.Config.constraintAngularSlop)) {
			if(!cont) return false; else Ez = 0;
		}
		var t = 0.5;
		var t1 = t;
		Ex *= t1;
		Ey *= t1;
		Ez *= t;
		if(Ex * Ex + Ey * Ey > 6) {
			var k = this.b1.smass + this.b2.smass;
			if(k > nape.Config.epsilon) {
				k = 0.75 / k;
				Jx = -Ex * k;
				Jy = -Ey * k;
				var t = 20;
				var ls = Jx * Jx + Jy * Jy;
				if(ls > t * t) {
					var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
					Jx *= t1;
					Jy *= t1;
				}
				var t = this.b1.imass;
				this.b1.posx -= Jx * t;
				this.b1.posy -= Jy * t;
				var t = this.b2.imass;
				this.b2.posx += Jx * t;
				this.b2.posy += Jy * t;
				Ex = this.b2.posx + r2x - (this.b1.posx + r1x);
				Ey = this.b2.posy + r2y - (this.b1.posy + r1y);
				Ez = this.b2.rot - this.b1.rot - this.phase;
				var t = 0.5;
				var t1 = t;
				Ex *= t1;
				Ey *= t1;
				Ez *= t;
			}
		}
		var Ka = 0.0;
		var Kb = 0.0;
		var Kd = 0.0;
		var Kc = 0.0;
		var Ke = 0.0;
		var Kf = 0.0;
		var m = this.b1.smass + this.b2.smass;
		Ka = m;
		Kb = 0;
		Kd = m;
		Kc = 0;
		Ke = 0;
		Kf = 0;
		if(this.b1.sinertia != 0) {
			var X = r1x * this.b1.sinertia;
			var Y = r1y * this.b1.sinertia;
			Ka += Y * r1y;
			Kb += -Y * r1x;
			Kd += X * r1x;
			Kc += -Y;
			Ke += X;
			Kf += this.b1.sinertia;
		}
		if(this.b2.sinertia != 0) {
			var X = r2x * this.b2.sinertia;
			var Y = r2y * this.b2.sinertia;
			Ka += Y * r2y;
			Kb += -Y * r2x;
			Kd += X * r2x;
			Kc += -Y;
			Ke += X;
			Kf += this.b2.sinertia;
		}
		Jx = -Ex;
		Jy = -Ey;
		Jz = -Ez;
		var t = 6;
		var ls = Jx * Jx + Jy * Jy;
		if(ls > t * t) {
			var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
			Jx *= t1;
			Jy *= t1;
		}
		zpp_nape.util.ZPP_Math.clamp2(Jz,0.25);
		var det = Ka * (Kd * Kf - Ke * Ke) + Kb * (Kc * Ke - Kb * Kf) + Kc * (Kb * Ke - Kc * Kd);
		if(det != det) Jx = Jy = Jz = 0; else if(det == 0) {
			if(Ka != 0) Jx /= Ka; else Jx = 0;
			if(Kd != 0) Jy /= Kd; else Jy = 0;
			if(Kf != 0) Jz /= Kf; else Jz = 0;
		} else {
			det = 1 / det;
			var B = Ke * Kc - Kb * Kf;
			var C = Kb * Ke - Kc * Kd;
			var E = Kb * Kc - Ka * Ke;
			var X = det * (Jx * (Kd * Kf - Ke * Ke) + Jy * B + Jz * C);
			var Y = det * (Jx * B + Jy * (Ka * Kf - Kc * Kc) + Jz * E);
			Jz = det * (Jx * C + Jy * E + Jz * (Ka * Kd - Kb * Kb));
			Jx = X;
			Jy = Y;
		}
		if(true) {
			var t = this.b1.imass;
			this.b1.posx -= Jx * t;
			this.b1.posy -= Jy * t;
			var t = this.b2.imass;
			this.b2.posx += Jx * t;
			this.b2.posy += Jy * t;
			this.b1.delta_rot(-(Jy * r1x - Jx * r1y + Jz) * this.b1.iinertia);
			this.b2.delta_rot((Jy * r2x - Jx * r2y + Jz) * this.b2.iinertia);
		} else {
			var t = this.b1.imass;
			this.b1.velx -= Jx * t;
			this.b1.vely -= Jy * t;
			var t = this.b2.imass;
			this.b2.velx += Jx * t;
			this.b2.vely += Jy * t;
			this.b1.angvel -= (Jy * r1x - Jx * r1y + Jz) * this.b1.iinertia;
			this.b2.angvel += (Jy * r2x - Jx * r2y + Jz) * this.b2.iinertia;
		}
		return false;
	}
	,applyImpulseVel: function() {
		var Ex = 0.0;
		var Ey = 0.0;
		var Ez = 0.0;
		Ex = this.b2.velx + this.b2.kinvelx - this.a2rely * (this.b2.angvel + this.b2.kinangvel) - (this.b1.velx + this.b1.kinvelx - this.a1rely * (this.b1.angvel + this.b1.kinangvel));
		Ey = this.b2.vely + this.b2.kinvely + this.a2relx * (this.b2.angvel + this.b2.kinangvel) - (this.b1.vely + this.b1.kinvely + this.a1relx * (this.b1.angvel + this.b1.kinangvel));
		Ez = this.b2.angvel + this.b2.kinangvel - this.b1.angvel - this.b1.kinangvel;
		var Jx = 0.0;
		var Jy = 0.0;
		var Jz = 0.0;
		Jx = this.biasx - Ex;
		Jy = this.biasy - Ey;
		Jz = this.biasz - Ez;
		var X = this.kMassa * Jx + this.kMassb * Jy + this.kMassc * Jz;
		var Y = this.kMassb * Jx + this.kMassd * Jy + this.kMasse * Jz;
		Jz = this.kMassc * Jx + this.kMasse * Jy + this.kMassf * Jz;
		Jx = X;
		Jy = Y;
		var t = this.gamma;
		var t1 = t;
		Jx -= this.jAccx * t1;
		Jy -= this.jAccy * t1;
		Jz -= this.jAccz * t;
		var jOldx = 0.0;
		var jOldy = 0.0;
		var jOldz = 0.0;
		jOldx = this.jAccx;
		jOldy = this.jAccy;
		jOldz = this.jAccz;
		var t = 1;
		var t1 = t;
		this.jAccx += Jx * t1;
		this.jAccy += Jy * t1;
		this.jAccz += Jz * t;
		if(this.breakUnderForce) {
			if(this.jAccx * this.jAccx + this.jAccy * this.jAccy + this.jAccz * this.jAccz > this.jMax * this.jMax) return true;
		} else if(!this.stiff) {
			var t = this.jMax;
			var ls = this.jAccx * this.jAccx + this.jAccy * this.jAccy + this.jAccz * this.jAccz;
			if(ls > t * t) {
				var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
				var t2 = t1;
				this.jAccx *= t2;
				this.jAccy *= t2;
				this.jAccz *= t1;
			}
		}
		Jx = this.jAccx - jOldx;
		Jy = this.jAccy - jOldy;
		Jz = this.jAccz - jOldz;
		if(false) {
			var t = this.b1.imass;
			this.b1.posx -= Jx * t;
			this.b1.posy -= Jy * t;
			var t = this.b2.imass;
			this.b2.posx += Jx * t;
			this.b2.posy += Jy * t;
			this.b1.delta_rot(-(Jy * this.a1relx - Jx * this.a1rely + Jz) * this.b1.iinertia);
			this.b2.delta_rot((Jy * this.a2relx - Jx * this.a2rely + Jz) * this.b2.iinertia);
		} else {
			var t = this.b1.imass;
			this.b1.velx -= Jx * t;
			this.b1.vely -= Jy * t;
			var t = this.b2.imass;
			this.b2.velx += Jx * t;
			this.b2.vely += Jy * t;
			this.b1.angvel -= (Jy * this.a1relx - Jx * this.a1rely + Jz) * this.b1.iinertia;
			this.b2.angvel += (Jy * this.a2relx - Jx * this.a2rely + Jz) * this.b2.iinertia;
		}
		return false;
	}
	,warmStart: function() {
		if(false) {
			var t = this.b1.imass;
			this.b1.posx -= this.jAccx * t;
			this.b1.posy -= this.jAccy * t;
			var t = this.b2.imass;
			this.b2.posx += this.jAccx * t;
			this.b2.posy += this.jAccy * t;
			this.b1.delta_rot(-(this.jAccy * this.a1relx - this.jAccx * this.a1rely + this.jAccz) * this.b1.iinertia);
			this.b2.delta_rot((this.jAccy * this.a2relx - this.jAccx * this.a2rely + this.jAccz) * this.b2.iinertia);
		} else {
			var t = this.b1.imass;
			this.b1.velx -= this.jAccx * t;
			this.b1.vely -= this.jAccy * t;
			var t = this.b2.imass;
			this.b2.velx += this.jAccx * t;
			this.b2.vely += this.jAccy * t;
			this.b1.angvel -= (this.jAccy * this.a1relx - this.jAccx * this.a1rely + this.jAccz) * this.b1.iinertia;
			this.b2.angvel += (this.jAccy * this.a2relx - this.jAccx * this.a2rely + this.jAccz) * this.b2.iinertia;
		}
	}
	,preStep: function(dt) {
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		this.stepped = true;
		this.a1relx = this.b1.axisy * this.a1localx - this.b1.axisx * this.a1localy;
		this.a1rely = this.a1localx * this.b1.axisx + this.a1localy * this.b1.axisy;
		this.a2relx = this.b2.axisy * this.a2localx - this.b2.axisx * this.a2localy;
		this.a2rely = this.a2localx * this.b2.axisx + this.a2localy * this.b2.axisy;
		var m = this.b1.smass + this.b2.smass;
		this.kMassa = m;
		this.kMassb = 0;
		this.kMassd = m;
		this.kMassc = 0;
		this.kMasse = 0;
		this.kMassf = 0;
		if(this.b1.sinertia != 0) {
			var X = this.a1relx * this.b1.sinertia;
			var Y = this.a1rely * this.b1.sinertia;
			this.kMassa += Y * this.a1rely;
			this.kMassb += -Y * this.a1relx;
			this.kMassd += X * this.a1relx;
			this.kMassc += -Y;
			this.kMasse += X;
			this.kMassf += this.b1.sinertia;
		}
		if(this.b2.sinertia != 0) {
			var X = this.a2relx * this.b2.sinertia;
			var Y = this.a2rely * this.b2.sinertia;
			this.kMassa += Y * this.a2rely;
			this.kMassb += -Y * this.a2relx;
			this.kMassd += X * this.a2relx;
			this.kMassc += -Y;
			this.kMasse += X;
			this.kMassf += this.b2.sinertia;
		}
		var flag = (function($this) {
			var $r;
			var det = $this.kMassa * ($this.kMassd * $this.kMassf - $this.kMasse * $this.kMasse) + $this.kMassb * ($this.kMassc * $this.kMasse - $this.kMassb * $this.kMassf) + $this.kMassc * ($this.kMassb * $this.kMasse - $this.kMassc * $this.kMassd);
			$r = det != det?(function($this) {
				var $r;
				{
					$this.kMassa = 0;
					$this.kMassb = 0;
					$this.kMassd = 0;
					$this.kMassc = 0;
					$this.kMasse = 0;
					$this.kMassf = 0;
				}
				$r = 7;
				return $r;
			}($this)):det == 0?(function($this) {
				var $r;
				var flag1 = 0;
				if($this.kMassa != 0) $this.kMassa = 1 / $this.kMassa; else {
					$this.kMassa = 0;
					flag1 |= 1;
				}
				if($this.kMassd != 0) $this.kMassd = 1 / $this.kMassd; else {
					$this.kMassd = 0;
					flag1 |= 2;
				}
				if($this.kMassf != 0) $this.kMassf = 1 / $this.kMassf; else {
					$this.kMassf = 0;
					flag1 |= 4;
				}
				$this.kMassb = $this.kMassc = $this.kMasse = 0.0;
				$r = flag1;
				return $r;
			}($this)):(function($this) {
				var $r;
				det = 1 / det;
				var A = det * ($this.kMassd * $this.kMassf - $this.kMasse * $this.kMasse);
				var B = det * ($this.kMasse * $this.kMassc - $this.kMassb * $this.kMassf);
				var D = det * ($this.kMassa * $this.kMassf - $this.kMassc * $this.kMassc);
				var C = det * ($this.kMassb * $this.kMasse - $this.kMassc * $this.kMassd);
				var E = det * ($this.kMassb * $this.kMassc - $this.kMassa * $this.kMasse);
				var F = det * ($this.kMassa * $this.kMassd - $this.kMassb * $this.kMassb);
				{
					$this.kMassa = A;
					$this.kMassb = B;
					$this.kMassd = D;
					$this.kMassc = C;
					$this.kMasse = E;
					$this.kMassf = F;
				}
				$r = 0;
				return $r;
			}($this));
			return $r;
		}(this));
		if((flag & 1) != 0) this.jAccx = 0;
		if((flag & 2) != 0) this.jAccy = 0;
		if((flag & 4) != 0) this.jAccz = 0;
		if(!this.stiff) {
			var biasCoef;
			var X = (function($this) {
				var $r;
				var omega = 2 * Math.PI * $this.frequency;
				$this.gamma = 1 / (dt * omega * (2 * $this.damping + omega * dt));
				var ig = 1 / (1 + $this.gamma);
				biasCoef = dt * omega * omega * $this.gamma;
				$this.gamma *= ig;
				$r = ig;
				return $r;
			}(this));
			this.kMassa *= X;
			this.kMassb *= X;
			this.kMassd *= X;
			this.kMassc *= X;
			this.kMasse *= X;
			this.kMassf *= X;
			this.biasx = this.b2.posx + this.a2relx - (this.b1.posx + this.a1relx);
			this.biasy = this.b2.posy + this.a2rely - (this.b1.posy + this.a1rely);
			this.biasz = this.b2.rot - this.b1.rot - this.phase;
			if(this.breakUnderError && this.biasx * this.biasx + this.biasy * this.biasy + this.biasz * this.biasz > this.maxError * this.maxError) return true;
			var t = -biasCoef;
			var t1 = t;
			this.biasx *= t1;
			this.biasy *= t1;
			this.biasz *= t;
			var t = this.maxError;
			var ls = this.biasx * this.biasx + this.biasy * this.biasy + this.biasz * this.biasz;
			if(ls > t * t) {
				var t1 = t * zpp_nape.util.ZPP_Math.invsqrt(ls);
				var t2 = t1;
				this.biasx *= t2;
				this.biasy *= t2;
				this.biasz *= t1;
			}
		} else {
			this.biasx = 0;
			this.biasy = 0;
			this.biasz = 0;
			this.gamma = 0;
		}
		var t = dtratio;
		var t1 = t;
		this.jAccx *= t1;
		this.jAccy *= t1;
		this.jAccz *= t;
		this.jMax = this.maxForce * dt;
		return false;
	}
	,clearcache: function() {
		this.jAccx = 0;
		this.jAccy = 0;
		this.jAccz = 0;
		this.pre_dt = -1.0;
	}
	,pair_exists: function(id,di) {
		return this.b1.id == id && this.b2.id == di || this.b1.id == di && this.b2.id == id;
	}
	,forest: function() {
		if(this.b1.isDynamic()) {
			var xr = this.b1.component == this.b1.component.parent?this.b1.component:(function($this) {
				var $r;
				var obj = $this.b1.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
		if(this.b2.isDynamic()) {
			var xr = this.b2.component == this.b2.component.parent?this.b2.component:(function($this) {
				var $r;
				var obj = $this.b2.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			var yr = this.component == this.component.parent?this.component:(function($this) {
				var $r;
				var obj = $this.component;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(xr != yr) {
				if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
					yr.parent = xr;
					xr.rank++;
				}
			}
		}
	}
	,wake_connected: function() {
		if(this.b1 != null && this.b1.isDynamic()) this.b1.wake();
		if(this.b2 != null && this.b2.isDynamic()) this.b2.wake();
	}
	,validate: function() {
		if(this.b1 == null || this.b2 == null) throw "Error: AngleJoint cannot be simulated null bodies";
		if(this.b1 == this.b2) throw "Error: WeldJoint cannot be simulated with body1 == body2";
		if(this.b1.space != this.space || this.b2.space != this.space) throw "Error: Constraints must have each body within the same space to which the constraint has been assigned";
		if(!this.b1.isDynamic() && !this.b2.isDynamic()) throw "Error: Constraints cannot have both bodies non-dynamic";
	}
	,copy: function(dict,todo) {
		var ret = new nape.constraint.PivotJoint(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());
		this.copyto(ret);
		if(dict != null && this.b1 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b1.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b1 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b1.id,function(b1) {
				ret.zpp_inner_zn.b1 = b1.zpp_inner;
			}));
		}
		if(dict != null && this.b2 != null) {
			var b = null;
			var _g = 0;
			while(_g < dict.length) {
				var idc = dict[_g];
				++_g;
				if(idc.id == this.b2.id) {
					b = idc.bc;
					break;
				}
			}
			if(b != null) ret.zpp_inner_zn.b2 = b.zpp_inner; else todo.push(zpp_nape.constraint.ZPP_CopyHelper.todo(this.b2.id,function(b1) {
				ret.zpp_inner_zn.b2 = b1.zpp_inner;
			}));
		}
		return ret;
	}
	,setup_a2: function() {
		this.wrap_a2 = nape.geom.Vec2.get(this.a2localx,this.a2localy);
		this.wrap_a2.zpp_inner._inuse = true;
		this.wrap_a2.zpp_inner._validate = $bind(this,this.validate_a2);
		this.wrap_a2.zpp_inner._invalidate = $bind(this,this.invalidate_a2);
	}
	,invalidate_a2: function(x) {
		this.immutable_midstep("Constraint::" + "a2");
		this.a2localx = x.x;
		this.a2localy = x.y;
		this.wake();
	}
	,validate_a2: function() {
		this.wrap_a2.zpp_inner.x = this.a2localx;
		this.wrap_a2.zpp_inner.y = this.a2localy;
	}
	,setup_a1: function() {
		this.wrap_a1 = nape.geom.Vec2.get(this.a1localx,this.a1localy);
		this.wrap_a1.zpp_inner._inuse = true;
		this.wrap_a1.zpp_inner._validate = $bind(this,this.validate_a1);
		this.wrap_a1.zpp_inner._invalidate = $bind(this,this.invalidate_a1);
	}
	,invalidate_a1: function(x) {
		this.immutable_midstep("Constraint::" + "a1");
		this.a1localx = x.x;
		this.a1localy = x.y;
		this.wake();
	}
	,validate_a1: function() {
		this.wrap_a1.zpp_inner.x = this.a1localx;
		this.wrap_a1.zpp_inner.y = this.a1localy;
	}
	,inactiveBodies: function() {
		if(this.b1 != null) this.b1.constraints.remove(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.remove(this);
		}
	}
	,activeBodies: function() {
		if(this.b1 != null) this.b1.constraints.add(this);
		if(this.b2 != this.b1) {
			if(this.b2 != null) this.b2.constraints.add(this);
		}
	}
	,bodyImpulse: function(b) {
		if(this.stepped) {
			if(b == this.b1) return nape.geom.Vec3.get(-this.jAccx,-this.jAccy,-(this.jAccy * this.a1relx - this.jAccx * this.a1rely + this.jAccz)); else return nape.geom.Vec3.get(this.jAccx,this.jAccy,this.jAccy * this.a2relx - this.jAccx * this.a2rely + this.jAccz);
		} else return nape.geom.Vec3.get(0,0,0);
	}
	,__class__: zpp_nape.constraint.ZPP_WeldJoint
});
zpp_nape.dynamics = {}
zpp_nape.dynamics.ZPP_Arbiter = function() {
	this.sensorarb = null;
	this.fluidarb = null;
	this.colarb = null;
	this.type = 0;
	this.pair = null;
	this.ws2 = null;
	this.ws1 = null;
	this.b2 = null;
	this.b1 = null;
	this.invalidated = false;
	this.immState = 0;
	this.fresh = false;
	this.continuous = false;
	this.presentable = false;
	this.intchange = false;
	this.present = 0;
	this.sleeping = false;
	this.cleared = false;
	this.active = false;
	this.endGenerated = 0;
	this.sleep_stamp = 0;
	this.up_stamp = 0;
	this.stamp = 0;
	this.di = 0;
	this.id = 0;
	this.outer = null;
};
$hxClasses["zpp_nape.dynamics.ZPP_Arbiter"] = zpp_nape.dynamics.ZPP_Arbiter;
zpp_nape.dynamics.ZPP_Arbiter.__name__ = ["zpp_nape","dynamics","ZPP_Arbiter"];
zpp_nape.dynamics.ZPP_Arbiter.prototype = {
	sup_retire: function() {
		if(!this.cleared) {
			this.b1.arbiters.inlined_remove(this);
			this.b2.arbiters.inlined_remove(this);
			if(this.pair != null) {
				this.pair.arb = null;
				this.pair = null;
			}
		}
		this.b1 = this.b2 = null;
		this.active = false;
		this.intchange = false;
	}
	,sup_assign: function(s1,s2,id,di) {
		this.b1 = s1.body;
		this.ws1 = s1;
		this.b2 = s2.body;
		this.ws2 = s2;
		this.id = id;
		this.di = di;
		this.b1.arbiters.inlined_add(this);
		this.b2.arbiters.inlined_add(this);
		this.active = true;
		this.present = 0;
		this.cleared = false;
		this.sleeping = false;
		this.fresh = false;
		this.presentable = false;
	}
	,lazyRetire: function(s,b) {
		this.cleared = true;
		if(b == null || this.b2 == b) this.b1.arbiters.inlined_remove(this);
		if(b == null || this.b1 == b) this.b2.arbiters.inlined_remove(this);
		if(this.pair != null) {
			this.pair.arb = null;
			this.pair = null;
		}
		this.active = false;
		s.f_arbiters.modified = true;
	}
	,acting: function() {
		return this.active && (this.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT) != 0;
	}
	,inactiveme: function() {
		return !this.active;
	}
	,wrapper: function() {
		if(this.outer == null) {
			zpp_nape.dynamics.ZPP_Arbiter.internal = true;
			if(this.type == zpp_nape.dynamics.ZPP_Arbiter.COL) {
				this.colarb.outer_zn = new nape.dynamics.CollisionArbiter();
				this.outer = this.colarb.outer_zn;
			} else if(this.type == zpp_nape.dynamics.ZPP_Arbiter.FLUID) {
				this.fluidarb.outer_zn = new nape.dynamics.FluidArbiter();
				this.outer = this.fluidarb.outer_zn;
			} else this.outer = new nape.dynamics.Arbiter();
			this.outer.zpp_inner = this;
			zpp_nape.dynamics.ZPP_Arbiter.internal = false;
		}
		return this.outer;
	}
	,__class__: zpp_nape.dynamics.ZPP_Arbiter
}
zpp_nape.dynamics.ZPP_SensorArbiter = function() {
	this.next = null;
	zpp_nape.dynamics.ZPP_Arbiter.call(this);
	this.type = zpp_nape.dynamics.ZPP_Arbiter.SENSOR;
	this.sensorarb = this;
};
$hxClasses["zpp_nape.dynamics.ZPP_SensorArbiter"] = zpp_nape.dynamics.ZPP_SensorArbiter;
zpp_nape.dynamics.ZPP_SensorArbiter.__name__ = ["zpp_nape","dynamics","ZPP_SensorArbiter"];
zpp_nape.dynamics.ZPP_SensorArbiter.__super__ = zpp_nape.dynamics.ZPP_Arbiter;
zpp_nape.dynamics.ZPP_SensorArbiter.prototype = $extend(zpp_nape.dynamics.ZPP_Arbiter.prototype,{
	makeimmutable: function() {
	}
	,makemutable: function() {
	}
	,retire: function() {
		this.sup_retire();
		var o = this;
		o.free();
		o.next = zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool;
		zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool = o;
	}
	,assign: function(s1,s2,id,di) {
		this.sup_assign(s1,s2,id,di);
	}
	,free: function() {
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.dynamics.ZPP_SensorArbiter
});
zpp_nape.dynamics.ZPP_FluidArbiter = function() {
	this.pre_dt = 0.0;
	this.mutable = false;
	this.wrap_position = null;
	this.buoyy = 0.0;
	this.buoyx = 0.0;
	this.ny = 0.0;
	this.nx = 0.0;
	this.lgamma = 0.0;
	this.dampy = 0.0;
	this.dampx = 0.0;
	this.vMassc = 0.0;
	this.vMassb = 0.0;
	this.vMassa = 0.0;
	this.agamma = 0.0;
	this.adamp = 0.0;
	this.wMass = 0.0;
	this.nodrag = false;
	this.r2y = 0.0;
	this.r2x = 0.0;
	this.r1y = 0.0;
	this.r1x = 0.0;
	this.overlap = 0.0;
	this.centroidy = 0.0;
	this.centroidx = 0.0;
	this.next = null;
	this.outer_zn = null;
	zpp_nape.dynamics.ZPP_Arbiter.call(this);
	this.type = zpp_nape.dynamics.ZPP_Arbiter.FLUID;
	this.fluidarb = this;
	this.buoyx = 0;
	this.buoyy = 0;
	this.pre_dt = -1.0;
};
$hxClasses["zpp_nape.dynamics.ZPP_FluidArbiter"] = zpp_nape.dynamics.ZPP_FluidArbiter;
zpp_nape.dynamics.ZPP_FluidArbiter.__name__ = ["zpp_nape","dynamics","ZPP_FluidArbiter"];
zpp_nape.dynamics.ZPP_FluidArbiter.__super__ = zpp_nape.dynamics.ZPP_Arbiter;
zpp_nape.dynamics.ZPP_FluidArbiter.prototype = $extend(zpp_nape.dynamics.ZPP_Arbiter.prototype,{
	applyImpulseVel: function() {
		if(!this.nodrag) {
			var w1 = this.b1.angvel + this.b1.kinangvel;
			var w2 = this.b2.angvel + this.b2.kinangvel;
			var jx = this.b1.velx + this.b1.kinvelx - this.r1y * w1 - (this.b2.velx + this.b2.kinvelx - this.r2y * w2);
			var jy = this.b1.vely + this.b1.kinvely + this.r1x * w1 - (this.b2.vely + this.b2.kinvely + this.r2x * w2);
			var t = this.vMassa * jx + this.vMassb * jy;
			jy = this.vMassb * jx + this.vMassc * jy;
			jx = t;
			var t = this.lgamma;
			jx -= this.dampx * t;
			jy -= this.dampy * t;
			var t = 1.0;
			this.dampx += jx * t;
			this.dampy += jy * t;
			var t = this.b1.imass;
			this.b1.velx -= jx * t;
			this.b1.vely -= jy * t;
			var t = this.b2.imass;
			this.b2.velx += jx * t;
			this.b2.vely += jy * t;
			this.b1.angvel -= this.b1.iinertia * (jy * this.r1x - jx * this.r1y);
			this.b2.angvel += this.b2.iinertia * (jy * this.r2x - jx * this.r2y);
			var j_damp = (w1 - w2) * this.wMass - this.adamp * this.agamma;
			this.adamp += j_damp;
			this.b1.angvel -= j_damp * this.b1.iinertia;
			this.b2.angvel += j_damp * this.b2.iinertia;
		}
	}
	,warmStart: function() {
		var t = this.b1.imass;
		this.b1.velx -= this.dampx * t;
		this.b1.vely -= this.dampy * t;
		var t = this.b2.imass;
		this.b2.velx += this.dampx * t;
		this.b2.vely += this.dampy * t;
		this.b1.angvel -= this.b1.iinertia * (this.dampy * this.r1x - this.dampx * this.r1y);
		this.b2.angvel += this.b2.iinertia * (this.dampy * this.r2x - this.dampx * this.r2y);
		this.b1.angvel -= this.adamp * this.b1.iinertia;
		this.b2.angvel += this.adamp * this.b2.iinertia;
	}
	,preStep: function(s,dt) {
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		this.r1x = this.centroidx - this.b1.posx;
		this.r1y = this.centroidy - this.b1.posy;
		this.r2x = this.centroidx - this.b2.posx;
		this.r2y = this.centroidy - this.b2.posy;
		var g1x = 0.0;
		var g1y = 0.0;
		if(this.ws1.fluidEnabled && this.ws1.fluidProperties.wrap_gravity != null) {
			g1x = this.ws1.fluidProperties.gravityx;
			g1y = this.ws1.fluidProperties.gravityy;
		} else {
			g1x = s.gravityx;
			g1y = s.gravityy;
		}
		var g2x = 0.0;
		var g2y = 0.0;
		if(this.ws2.fluidEnabled && this.ws2.fluidProperties.wrap_gravity != null) {
			g2x = this.ws2.fluidProperties.gravityx;
			g2y = this.ws2.fluidProperties.gravityy;
		} else {
			g2x = s.gravityx;
			g2y = s.gravityy;
		}
		var buoyx = 0;
		var buoyy = 0;
		if(this.ws1.fluidEnabled && this.ws2.fluidEnabled) {
			var mass1 = this.overlap * this.ws1.fluidProperties.density;
			var mass2 = this.overlap * this.ws2.fluidProperties.density;
			if(mass1 > mass2) {
				var t = mass1 + mass2;
				buoyx -= g1x * t;
				buoyy -= g1y * t;
			} else if(mass1 < mass2) {
				var t = mass1 + mass2;
				buoyx += g2x * t;
				buoyy += g2y * t;
			} else {
				var gx = 0.0;
				var gy = 0.0;
				gx = g1x + g2x;
				gy = g1y + g2y;
				var t = 0.5;
				gx *= t;
				gy *= t;
				if(this.ws1.worldCOMx * gx + this.ws1.worldCOMy * gy > this.ws2.worldCOMx * gx + this.ws2.worldCOMy * gy) {
					var t = mass1 + mass2;
					buoyx -= gx * t;
					buoyy -= gy * t;
				} else {
					var t = mass1 + mass2;
					buoyx += gx * t;
					buoyy += gy * t;
				}
			}
		} else if(this.ws1.fluidEnabled) {
			var mass = this.overlap * this.ws1.fluidProperties.density;
			var t = mass;
			buoyx -= g1x * t;
			buoyy -= g1y * t;
		} else if(this.ws2.fluidEnabled) {
			var mass = this.overlap * this.ws2.fluidProperties.density;
			var t = mass;
			buoyx += g2x * t;
			buoyy += g2y * t;
		}
		var t = dt;
		buoyx *= t;
		buoyy *= t;
		this.buoyx = buoyx;
		this.buoyy = buoyy;
		if(this.b1.isDynamic()) {
			var t = this.b1.imass;
			this.b1.velx -= buoyx * t;
			this.b1.vely -= buoyy * t;
			this.b1.angvel -= (buoyy * this.r1x - buoyx * this.r1y) * this.b1.iinertia;
		}
		if(this.b2.isDynamic()) {
			var t = this.b2.imass;
			this.b2.velx += buoyx * t;
			this.b2.vely += buoyy * t;
			this.b2.angvel += (buoyy * this.r2x - buoyx * this.r2y) * this.b2.iinertia;
		}
		if((!this.ws1.fluidEnabled || this.ws1.fluidProperties.viscosity == 0) && (!this.ws2.fluidEnabled || this.ws2.fluidProperties.viscosity == 0)) {
			this.nodrag = true;
			this.dampx = 0;
			this.dampy = 0;
			this.adamp = 0;
		} else {
			this.nodrag = false;
			var tViscosity = 0.0;
			if(this.ws1.fluidEnabled) {
				this.ws2.validate_angDrag();
				tViscosity += this.ws1.fluidProperties.viscosity * this.ws2.angDrag * this.overlap / this.ws2.area;
			}
			if(this.ws2.fluidEnabled) {
				this.ws1.validate_angDrag();
				tViscosity += this.ws2.fluidProperties.viscosity * this.ws1.angDrag * this.overlap / this.ws1.area;
			}
			if(tViscosity != 0) {
				var iSum = this.b1.sinertia + this.b2.sinertia;
				if(iSum != 0) this.wMass = 1 / iSum; else this.wMass = 0.0;
				var biasCoef;
				tViscosity *= 0.0004;
				this.wMass *= (function($this) {
					var $r;
					var omega = 2 * Math.PI * tViscosity;
					$this.agamma = 1 / (dt * omega * (2 * 1 + omega * dt));
					var ig = 1 / (1 + $this.agamma);
					biasCoef = dt * omega * omega * $this.agamma;
					$this.agamma *= ig;
					$r = ig;
					return $r;
				}(this));
			} else {
				this.wMass = 0.0;
				this.agamma = 0.0;
			}
			var vrnx = this.b2.velx + this.b2.kinvelx - this.r2y * (this.b2.angvel + this.b2.kinangvel) - (this.b1.velx + this.b1.kinvelx - this.r1y * (this.b2.angvel + this.b2.kinangvel));
			var vrny = this.b2.vely + this.b2.kinvely + this.r2x * (this.b2.angvel + this.b2.kinangvel) - (this.b1.vely + this.b1.kinvely + this.r1x * (this.b1.angvel + this.b1.kinangvel));
			if(vrnx * vrnx + vrny * vrny < nape.Config.epsilon * nape.Config.epsilon) {
			} else {
				var d = vrnx * vrnx + vrny * vrny;
				var imag = zpp_nape.util.ZPP_Math.invsqrt(d);
				var t = imag;
				vrnx *= t;
				vrny *= t;
				this.nx = vrnx;
				this.ny = vrny;
			}
			var tViscosity1 = 0.0;
			if(this.ws1.fluidEnabled) {
				var f = -this.ws1.fluidProperties.viscosity * this.overlap / this.ws2.area;
				if(this.ws2.type == zpp_nape.util.ZPP_Flags.id_ShapeType_CIRCLE) tViscosity1 -= f * this.ws2.circle.radius * nape.Config.fluidLinearDrag / (2 * this.ws2.circle.radius * Math.PI); else {
					var poly = this.ws2.polygon;
					var bord = 0.0;
					var acc = 0.0;
					var cx_ite = poly.edges.begin();
					while(cx_ite != null) {
						var ex = cx_ite.elem();
						bord += ex.length;
						var fact = f * ex.length * (ex.gnormx * this.nx + ex.gnormy * this.ny);
						if(fact > 0) fact = fact *= -nape.Config.fluidVacuumDrag;
						acc -= fact * 0.5 * nape.Config.fluidLinearDrag;
						cx_ite = cx_ite.next;
					}
					tViscosity1 += acc / bord;
				}
			}
			if(this.ws2.fluidEnabled) {
				var f = -this.ws2.fluidProperties.viscosity * this.overlap / this.ws1.area;
				if(this.ws1.type == zpp_nape.util.ZPP_Flags.id_ShapeType_CIRCLE) tViscosity1 -= f * this.ws1.circle.radius * nape.Config.fluidLinearDrag / (2 * this.ws1.circle.radius * Math.PI); else {
					var poly = this.ws1.polygon;
					var bord = 0.0;
					var acc = 0.0;
					var cx_ite = poly.edges.begin();
					while(cx_ite != null) {
						var ex = cx_ite.elem();
						bord += ex.length;
						var fact = f * ex.length * (ex.gnormx * this.nx + ex.gnormy * this.ny);
						if(fact > 0) fact = fact *= -nape.Config.fluidVacuumDrag;
						acc -= fact * 0.5 * nape.Config.fluidLinearDrag;
						cx_ite = cx_ite.next;
					}
					tViscosity1 += acc / bord;
				}
			}
			if(tViscosity1 != 0) {
				var m = this.b1.smass + this.b2.smass;
				var Ka = 0.0;
				var Kb = 0.0;
				var Kc = 0.0;
				Ka = m;
				Kb = 0;
				Kc = m;
				if(this.b1.sinertia != 0) {
					var X = this.r1x * this.b1.sinertia;
					var Y = this.r1y * this.b1.sinertia;
					Ka += Y * this.r1y;
					Kb += -Y * this.r1x;
					Kc += X * this.r1x;
				}
				if(this.b2.sinertia != 0) {
					var X = this.r2x * this.b2.sinertia;
					var Y = this.r2y * this.b2.sinertia;
					Ka += Y * this.r2y;
					Kb += -Y * this.r2x;
					Kc += X * this.r2x;
				}
				var det = Ka * Kc - Kb * Kb;
				if(det != det) {
					Ka = Kb = Kc = 0;
					3;
				} else if(det == 0) {
					var flag = 0;
					if(Ka != 0) Ka = 1 / Ka; else {
						Ka = 0;
						flag |= 1;
					}
					if(Kc != 0) Kc = 1 / Kc; else {
						Kc = 0;
						flag |= 2;
					}
					Kb = 0;
					flag;
				} else {
					det = 1 / det;
					var t = Kc * det;
					Kc = Ka * det;
					Ka = t;
					Kb *= -det;
					0;
				}
				this.vMassa = Ka;
				this.vMassb = Kb;
				this.vMassc = Kc;
				var biasCoef;
				var X = (function($this) {
					var $r;
					var omega = 2 * Math.PI * tViscosity1;
					$this.lgamma = 1 / (dt * omega * (2 * 1 + omega * dt));
					var ig = 1 / (1 + $this.lgamma);
					biasCoef = dt * omega * omega * $this.lgamma;
					$this.lgamma *= ig;
					$r = ig;
					return $r;
				}(this));
				this.vMassa *= X;
				this.vMassb *= X;
				this.vMassc *= X;
			} else {
				this.vMassa = 0;
				this.vMassb = 0;
				this.vMassc = 0;
				this.lgamma = 0.0;
			}
		}
		var t = dtratio;
		this.dampx *= t;
		this.dampy *= t;
		this.adamp *= dtratio;
	}
	,inject: function(area,cx,cy) {
		this.overlap = area;
		this.centroidx = cx;
		this.centroidy = cy;
	}
	,makeimmutable: function() {
		this.mutable = false;
		if(this.wrap_position != null) this.wrap_position.zpp_inner._immutable = true;
	}
	,makemutable: function() {
		this.mutable = true;
		if(this.wrap_position != null) this.wrap_position.zpp_inner._immutable = false;
	}
	,retire: function() {
		this.sup_retire();
		var o = this;
		o.free();
		o.next = zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool;
		zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool = o;
		this.pre_dt = -1.0;
	}
	,assign: function(s1,s2,id,di) {
		this.sup_assign(s1,s2,id,di);
		this.nx = 0;
		this.ny = 1;
		this.dampx = 0;
		this.dampy = 0;
		this.adamp = 0.0;
	}
	,getposition: function() {
		this.wrap_position = nape.geom.Vec2.get();
		this.wrap_position.zpp_inner._inuse = true;
		this.wrap_position.zpp_inner._immutable = !this.mutable;
		this.wrap_position.zpp_inner._validate = $bind(this,this.position_validate);
		this.wrap_position.zpp_inner._invalidate = $bind(this,this.position_invalidate);
	}
	,position_invalidate: function(x) {
		this.centroidx = x.x;
		this.centroidy = x.y;
	}
	,position_validate: function() {
		if(this.inactiveme()) throw "Error: Arbiter not currently in use";
		this.wrap_position.zpp_inner.x = this.centroidx;
		this.wrap_position.zpp_inner.y = this.centroidy;
	}
	,free: function() {
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.dynamics.ZPP_FluidArbiter
});
zpp_nape.dynamics.ZPP_ColArbiter = function() {
	this.pre_dt = 0.0;
	this.mutable = false;
	this.stat = false;
	this.next = null;
	this.hpc2 = false;
	this.hc2 = false;
	this.oc2 = null;
	this.c2 = null;
	this.oc1 = null;
	this.c1 = null;
	this.__ref_vertex = 0;
	this.__ref_edge2 = null;
	this.__ref_edge1 = null;
	this.biasCoef = 0.0;
	this.rev = false;
	this.radius = 0.0;
	this.lproj = 0.0;
	this.lnormy = 0.0;
	this.lnormx = 0.0;
	this.surfacey = 0.0;
	this.surfacex = 0.0;
	this.k2y = 0.0;
	this.k2x = 0.0;
	this.k1y = 0.0;
	this.k1x = 0.0;
	this.rt2b = 0.0;
	this.rn2b = 0.0;
	this.rt2a = 0.0;
	this.rn2a = 0.0;
	this.rt1b = 0.0;
	this.rn1b = 0.0;
	this.rt1a = 0.0;
	this.rn1a = 0.0;
	this.jrAcc = 0.0;
	this.rMass = 0.0;
	this.Kc = 0.0;
	this.Kb = 0.0;
	this.Ka = 0.0;
	this.kMassc = 0.0;
	this.kMassb = 0.0;
	this.kMassa = 0.0;
	this.wrap_normal = null;
	this.ny = 0.0;
	this.nx = 0.0;
	this.innards = null;
	this.wrap_contacts = null;
	this.contacts = null;
	this.s2 = null;
	this.s1 = null;
	this.userdef_rfric = false;
	this.userdef_restitution = false;
	this.userdef_stat_fric = false;
	this.userdef_dyn_fric = false;
	this.rfric = 0.0;
	this.restitution = 0.0;
	this.stat_fric = 0.0;
	this.dyn_fric = 0.0;
	this.outer_zn = null;
	zpp_nape.dynamics.ZPP_Arbiter.call(this);
	this.pre_dt = -1.0;
	this.contacts = new zpp_nape.dynamics.ZPP_Contact();
	this.innards = new zpp_nape.dynamics.ZPP_IContact();
	this.type = zpp_nape.dynamics.ZPP_Arbiter.COL;
	this.colarb = this;
};
$hxClasses["zpp_nape.dynamics.ZPP_ColArbiter"] = zpp_nape.dynamics.ZPP_ColArbiter;
zpp_nape.dynamics.ZPP_ColArbiter.__name__ = ["zpp_nape","dynamics","ZPP_ColArbiter"];
zpp_nape.dynamics.ZPP_ColArbiter.__super__ = zpp_nape.dynamics.ZPP_Arbiter;
zpp_nape.dynamics.ZPP_ColArbiter.prototype = $extend(zpp_nape.dynamics.ZPP_Arbiter.prototype,{
	applyImpulsePos: function() {
		if(this.ptype == 2) {
			var c = this.c1;
			var dx = 0.0;
			var dy = 0.0;
			var r2x = 0.0;
			var r2y = 0.0;
			r2x = this.b2.axisy * c.lr2x - this.b2.axisx * c.lr2y;
			r2y = c.lr2x * this.b2.axisx + c.lr2y * this.b2.axisy;
			var t = 1.0;
			r2x += this.b2.posx * t;
			r2y += this.b2.posy * t;
			var r1x = 0.0;
			var r1y = 0.0;
			r1x = this.b1.axisy * c.lr1x - this.b1.axisx * c.lr1y;
			r1y = c.lr1x * this.b1.axisx + c.lr1y * this.b1.axisy;
			var t = 1.0;
			r1x += this.b1.posx * t;
			r1y += this.b1.posy * t;
			var dx1 = 0.0;
			var dy1 = 0.0;
			dx1 = r2x - r1x;
			dy1 = r2y - r1y;
			var dl = zpp_nape.util.ZPP_Math.sqrt(dx1 * dx1 + dy1 * dy1);
			var r = this.radius - nape.Config.collisionSlop;
			var err = dl - r;
			if(dx1 * this.nx + dy1 * this.ny < 0) {
				dx1 = -dx1;
				dy1 = -dy1;
				err -= this.radius;
			}
			if(err < 0) {
				if(dl < nape.Config.epsilon) {
					if(this.b1.smass != 0.0) this.b1.posx += nape.Config.epsilon * 10; else this.b2.posx += nape.Config.epsilon * 10;
				} else {
					var t = 1.0 / dl;
					dx1 *= t;
					dy1 *= t;
					var px = 0.5 * (r1x + r2x);
					var py = 0.5 * (r1y + r2y);
					var pen = dl - r;
					r1x = px - this.b1.posx;
					r1y = py - this.b1.posy;
					r2x = px - this.b2.posx;
					r2y = py - this.b2.posy;
					var rn1 = dy1 * r1x - dx1 * r1y;
					var rn2 = dy1 * r2x - dx1 * r2y;
					var K = this.b2.smass + rn2 * rn2 * this.b2.sinertia + this.b1.smass + rn1 * rn1 * this.b1.sinertia;
					if(K != 0) {
						var jn = -this.biasCoef * pen / K;
						var Jx = 0.0;
						var Jy = 0.0;
						var t = jn;
						Jx = dx1 * t;
						Jy = dy1 * t;
						var t = this.b1.imass;
						this.b1.posx -= Jx * t;
						this.b1.posy -= Jy * t;
						this.b1.delta_rot(-rn1 * this.b1.iinertia * jn);
						var t = this.b2.imass;
						this.b2.posx += Jx * t;
						this.b2.posy += Jy * t;
						this.b2.delta_rot(rn2 * this.b2.iinertia * jn);
					}
				}
			}
		} else {
			var gnormx = 0.0;
			var gnormy = 0.0;
			var gproj;
			var clip1x = 0.0;
			var clip1y = 0.0;
			var clip2x = 0;
			var clip2y = 0;
			if(this.ptype == 0) {
				gnormx = this.b1.axisy * this.lnormx - this.b1.axisx * this.lnormy;
				gnormy = this.lnormx * this.b1.axisx + this.lnormy * this.b1.axisy;
				gproj = this.lproj + (gnormx * this.b1.posx + gnormy * this.b1.posy);
				clip1x = this.b2.axisy * this.c1.lr1x - this.b2.axisx * this.c1.lr1y;
				clip1y = this.c1.lr1x * this.b2.axisx + this.c1.lr1y * this.b2.axisy;
				var t = 1.0;
				clip1x += this.b2.posx * t;
				clip1y += this.b2.posy * t;
				if(this.hpc2) {
					clip2x = this.b2.axisy * this.c2.lr1x - this.b2.axisx * this.c2.lr1y;
					clip2y = this.c2.lr1x * this.b2.axisx + this.c2.lr1y * this.b2.axisy;
					var t = 1.0;
					clip2x += this.b2.posx * t;
					clip2y += this.b2.posy * t;
				}
			} else {
				gnormx = this.b2.axisy * this.lnormx - this.b2.axisx * this.lnormy;
				gnormy = this.lnormx * this.b2.axisx + this.lnormy * this.b2.axisy;
				gproj = this.lproj + (gnormx * this.b2.posx + gnormy * this.b2.posy);
				clip1x = this.b1.axisy * this.c1.lr1x - this.b1.axisx * this.c1.lr1y;
				clip1y = this.c1.lr1x * this.b1.axisx + this.c1.lr1y * this.b1.axisy;
				var t = 1.0;
				clip1x += this.b1.posx * t;
				clip1y += this.b1.posy * t;
				if(this.hpc2) {
					clip2x = this.b1.axisy * this.c2.lr1x - this.b1.axisx * this.c2.lr1y;
					clip2y = this.c2.lr1x * this.b1.axisx + this.c2.lr1y * this.b1.axisy;
					var t = 1.0;
					clip2x += this.b1.posx * t;
					clip2y += this.b1.posy * t;
				}
			}
			var err1 = clip1x * gnormx + clip1y * gnormy - gproj - this.radius;
			err1 += nape.Config.collisionSlop;
			var err2 = 0.0;
			if(this.hpc2) {
				err2 = clip2x * gnormx + clip2y * gnormy - gproj - this.radius;
				err2 += nape.Config.collisionSlop;
			}
			if(err1 < 0 || err2 < 0) {
				if(this.rev) {
					gnormx = -gnormx;
					gnormy = -gnormy;
				}
				var c1r1x = 0.0;
				var c1r1y = 0.0;
				c1r1x = clip1x - this.b1.posx;
				c1r1y = clip1y - this.b1.posy;
				var c1r2x = 0.0;
				var c1r2y = 0.0;
				c1r2x = clip1x - this.b2.posx;
				c1r2y = clip1y - this.b2.posy;
				var c2r1x = 0;
				var c2r1y = 0;
				var c2r2x = 0;
				var c2r2y = 0;
				if(this.hpc2) {
					c2r1x = clip2x - this.b1.posx;
					c2r1y = clip2y - this.b1.posy;
					c2r2x = clip2x - this.b2.posx;
					c2r2y = clip2y - this.b2.posy;
					var rn1a = gnormy * c1r1x - gnormx * c1r1y;
					var rn1b = gnormy * c1r2x - gnormx * c1r2y;
					var rn2a = gnormy * c2r1x - gnormx * c2r1y;
					var rn2b = gnormy * c2r2x - gnormx * c2r2y;
					var mass_sum = this.b1.smass + this.b2.smass;
					this.kMassa = mass_sum + this.b1.sinertia * rn1a * rn1a + this.b2.sinertia * rn1b * rn1b;
					this.kMassb = mass_sum + this.b1.sinertia * rn1a * rn2a + this.b2.sinertia * rn1b * rn2b;
					this.kMassc = mass_sum + this.b1.sinertia * rn2a * rn2a + this.b2.sinertia * rn2b * rn2b;
					var Ka = 0.0;
					var Kb = 0.0;
					var Kc = 0.0;
					Ka = this.kMassa;
					Kb = this.kMassb;
					Kc = this.kMassc;
					var bx = err1 * this.biasCoef;
					var by = err2 * this.biasCoef;
					do {
						var xx = 0.0;
						var xy = 0.0;
						xx = bx;
						xy = by;
						xx = -xx;
						xy = -xy;
						var det = this.kMassa * this.kMassc - this.kMassb * this.kMassb;
						if(det != det) xx = xy = 0; else if(det == 0) {
							if(this.kMassa != 0) xx /= this.kMassa; else xx = 0;
							if(this.kMassc != 0) xy /= this.kMassc; else xy = 0;
						} else {
							det = 1 / det;
							var t = det * (this.kMassc * xx - this.kMassb * xy);
							xy = det * (this.kMassa * xy - this.kMassb * xx);
							xx = t;
						}
						if(xx >= 0 && xy >= 0) {
							var t = (xx + xy) * this.b1.imass;
							this.b1.posx -= gnormx * t;
							this.b1.posy -= gnormy * t;
							this.b1.delta_rot(-this.b1.iinertia * (rn1a * xx + rn2a * xy));
							var t = (xx + xy) * this.b2.imass;
							this.b2.posx += gnormx * t;
							this.b2.posy += gnormy * t;
							this.b2.delta_rot(this.b2.iinertia * (rn1b * xx + rn2b * xy));
							break;
						}
						xx = -bx / Ka;
						xy = 0;
						var vn2 = Kb * xx + by;
						if(xx >= 0 && vn2 >= 0) {
							var t = (xx + xy) * this.b1.imass;
							this.b1.posx -= gnormx * t;
							this.b1.posy -= gnormy * t;
							this.b1.delta_rot(-this.b1.iinertia * (rn1a * xx + rn2a * xy));
							var t = (xx + xy) * this.b2.imass;
							this.b2.posx += gnormx * t;
							this.b2.posy += gnormy * t;
							this.b2.delta_rot(this.b2.iinertia * (rn1b * xx + rn2b * xy));
							break;
						}
						xx = 0;
						xy = -by / Kc;
						var vn1 = Kb * xy + bx;
						if(xy >= 0 && vn1 >= 0) {
							var t = (xx + xy) * this.b1.imass;
							this.b1.posx -= gnormx * t;
							this.b1.posy -= gnormy * t;
							this.b1.delta_rot(-this.b1.iinertia * (rn1a * xx + rn2a * xy));
							var t = (xx + xy) * this.b2.imass;
							this.b2.posx += gnormx * t;
							this.b2.posy += gnormy * t;
							this.b2.delta_rot(this.b2.iinertia * (rn1b * xx + rn2b * xy));
							break;
						}
					} while(false);
				} else {
					var rn1 = gnormy * c1r1x - gnormx * c1r1y;
					var rn2 = gnormy * c1r2x - gnormx * c1r2y;
					var K = this.b2.smass + rn2 * rn2 * this.b2.sinertia + this.b1.smass + rn1 * rn1 * this.b1.sinertia;
					if(K != 0) {
						var jn = -this.biasCoef * err1 / K;
						var Jx = 0.0;
						var Jy = 0.0;
						var t = jn;
						Jx = gnormx * t;
						Jy = gnormy * t;
						var t = this.b1.imass;
						this.b1.posx -= Jx * t;
						this.b1.posy -= Jy * t;
						this.b1.delta_rot(-rn1 * this.b1.iinertia * jn);
						var t = this.b2.imass;
						this.b2.posx += Jx * t;
						this.b2.posy += Jy * t;
						this.b2.delta_rot(rn2 * this.b2.iinertia * jn);
					}
				}
			}
		}
	}
	,applyImpulseVel: function() {
		var jx;
		var jy;
		var j;
		var jMax;
		var jOld;
		var cjAcc;
		var v1x = this.k1x + this.b2.velx - this.c1.r2y * this.b2.angvel - (this.b1.velx - this.c1.r1y * this.b1.angvel);
		var v1y = this.k1y + this.b2.vely + this.c1.r2x * this.b2.angvel - (this.b1.vely + this.c1.r1x * this.b1.angvel);
		j = (v1y * this.nx - v1x * this.ny + this.surfacex) * this.c1.tMass;
		jMax = this.c1.friction * this.c1.jnAcc;
		jOld = this.c1.jtAcc;
		cjAcc = jOld - j;
		if(cjAcc > jMax) cjAcc = jMax; else if(cjAcc < -jMax) cjAcc = -jMax;
		j = cjAcc - jOld;
		this.c1.jtAcc = cjAcc;
		jx = -this.ny * j;
		jy = this.nx * j;
		this.b2.velx += jx * this.b2.imass;
		this.b2.vely += jy * this.b2.imass;
		this.b1.velx -= jx * this.b1.imass;
		this.b1.vely -= jy * this.b1.imass;
		this.b2.angvel += this.rt1b * j * this.b2.iinertia;
		this.b1.angvel -= this.rt1a * j * this.b1.iinertia;
		if(this.hc2) {
			var v2x = this.k2x + this.b2.velx - this.c2.r2y * this.b2.angvel - (this.b1.velx - this.c2.r1y * this.b1.angvel);
			var v2y = this.k2y + this.b2.vely + this.c2.r2x * this.b2.angvel - (this.b1.vely + this.c2.r1x * this.b1.angvel);
			j = (v2y * this.nx - v2x * this.ny + this.surfacex) * this.c2.tMass;
			jMax = this.c2.friction * this.c2.jnAcc;
			jOld = this.c2.jtAcc;
			cjAcc = jOld - j;
			if(cjAcc > jMax) cjAcc = jMax; else if(cjAcc < -jMax) cjAcc = -jMax;
			j = cjAcc - jOld;
			this.c2.jtAcc = cjAcc;
			jx = -this.ny * j;
			jy = this.nx * j;
			this.b2.velx += jx * this.b2.imass;
			this.b2.vely += jy * this.b2.imass;
			this.b1.velx -= jx * this.b1.imass;
			this.b1.vely -= jy * this.b1.imass;
			this.b2.angvel += this.rt2b * j * this.b2.iinertia;
			this.b1.angvel -= this.rt2a * j * this.b1.iinertia;
			v1x = this.k1x + this.b2.velx - this.c1.r2y * this.b2.angvel - (this.b1.velx - this.c1.r1y * this.b1.angvel);
			v1y = this.k1y + this.b2.vely + this.c1.r2x * this.b2.angvel - (this.b1.vely + this.c1.r1x * this.b1.angvel);
			v2x = this.k2x + this.b2.velx - this.c2.r2y * this.b2.angvel - (this.b1.velx - this.c2.r1y * this.b1.angvel);
			v2y = this.k2y + this.b2.vely + this.c2.r2x * this.b2.angvel - (this.b1.vely + this.c2.r1x * this.b1.angvel);
			var ax = this.c1.jnAcc;
			var ay = this.c2.jnAcc;
			var jnx = v1x * this.nx + v1y * this.ny + this.surfacey + this.c1.bounce - (this.Ka * ax + this.Kb * ay);
			var jny = v2x * this.nx + v2y * this.ny + this.surfacey + this.c2.bounce - (this.Kb * ax + this.Kc * ay);
			var xx = -(this.kMassa * jnx + this.kMassb * jny);
			var xy = -(this.kMassb * jnx + this.kMassc * jny);
			if(xx >= 0 && xy >= 0) {
				jnx = xx - ax;
				jny = xy - ay;
				this.c1.jnAcc = xx;
				this.c2.jnAcc = xy;
			} else {
				xx = -this.c1.nMass * jnx;
				if(xx >= 0 && this.Kb * xx + jny >= 0) {
					jnx = xx - ax;
					jny = -ay;
					this.c1.jnAcc = xx;
					this.c2.jnAcc = 0;
				} else {
					xy = -this.c2.nMass * jny;
					if(xy >= 0 && this.Kb * xy + jnx >= 0) {
						jnx = -ax;
						jny = xy - ay;
						this.c1.jnAcc = 0;
						this.c2.jnAcc = xy;
					} else if(jnx >= 0 && jny >= 0) {
						jnx = -ax;
						jny = -ay;
						this.c1.jnAcc = this.c2.jnAcc = 0;
					} else {
						jnx = 0;
						jny = 0;
					}
				}
			}
			j = jnx + jny;
			jx = this.nx * j;
			jy = this.ny * j;
			this.b2.velx += jx * this.b2.imass;
			this.b2.vely += jy * this.b2.imass;
			this.b1.velx -= jx * this.b1.imass;
			this.b1.vely -= jy * this.b1.imass;
			this.b2.angvel += (this.rn1b * jnx + this.rn2b * jny) * this.b2.iinertia;
			this.b1.angvel -= (this.rn1a * jnx + this.rn2a * jny) * this.b1.iinertia;
		} else {
			if(this.radius != 0.0) {
				var dw = this.b2.angvel - this.b1.angvel;
				j = dw * this.rMass;
				jMax = this.rfric * this.c1.jnAcc;
				jOld = this.jrAcc;
				this.jrAcc -= j;
				if(this.jrAcc > jMax) this.jrAcc = jMax; else if(this.jrAcc < -jMax) this.jrAcc = -jMax;
				j = this.jrAcc - jOld;
				this.b2.angvel += j * this.b2.iinertia;
				this.b1.angvel -= j * this.b1.iinertia;
			}
			v1x = this.k1x + this.b2.velx - this.c1.r2y * this.b2.angvel - (this.b1.velx - this.c1.r1y * this.b1.angvel);
			v1y = this.k1y + this.b2.vely + this.c1.r2x * this.b2.angvel - (this.b1.vely + this.c1.r1x * this.b1.angvel);
			j = (this.c1.bounce + (this.nx * v1x + this.ny * v1y) + this.surfacey) * this.c1.nMass;
			jOld = this.c1.jnAcc;
			cjAcc = jOld - j;
			if(cjAcc < 0.0) cjAcc = 0.0;
			j = cjAcc - jOld;
			this.c1.jnAcc = cjAcc;
			jx = this.nx * j;
			jy = this.ny * j;
			this.b2.velx += jx * this.b2.imass;
			this.b2.vely += jy * this.b2.imass;
			this.b1.velx -= jx * this.b1.imass;
			this.b1.vely -= jy * this.b1.imass;
			this.b2.angvel += this.rn1b * j * this.b2.iinertia;
			this.b1.angvel -= this.rn1a * j * this.b1.iinertia;
		}
	}
	,warmStart: function() {
		var jx = this.nx * this.c1.jnAcc - this.ny * this.c1.jtAcc;
		var jy = this.ny * this.c1.jnAcc + this.nx * this.c1.jtAcc;
		var t = this.b1.imass;
		this.b1.velx -= jx * t;
		this.b1.vely -= jy * t;
		this.b1.angvel -= this.b1.iinertia * (jy * this.c1.r1x - jx * this.c1.r1y);
		var t = this.b2.imass;
		this.b2.velx += jx * t;
		this.b2.vely += jy * t;
		this.b2.angvel += this.b2.iinertia * (jy * this.c1.r2x - jx * this.c1.r2y);
		if(this.hc2) {
			var jx = this.nx * this.c2.jnAcc - this.ny * this.c2.jtAcc;
			var jy = this.ny * this.c2.jnAcc + this.nx * this.c2.jtAcc;
			var t = this.b1.imass;
			this.b1.velx -= jx * t;
			this.b1.vely -= jy * t;
			this.b1.angvel -= this.b1.iinertia * (jy * this.c2.r1x - jx * this.c2.r1y);
			var t = this.b2.imass;
			this.b2.velx += jx * t;
			this.b2.vely += jy * t;
			this.b2.angvel += this.b2.iinertia * (jy * this.c2.r2x - jx * this.c2.r2y);
		}
		this.b2.angvel += this.jrAcc * this.b2.iinertia;
		this.b1.angvel -= this.jrAcc * this.b1.iinertia;
	}
	,preStep: function(dt) {
		this.validate_props();
		if(this.pre_dt == -1.0) this.pre_dt = dt;
		var dtratio = dt / this.pre_dt;
		this.pre_dt = dt;
		var mass_sum = this.b1.smass + this.b2.smass;
		this.hc2 = false;
		var fst = true;
		var statType = !this.b1.isDynamic() || !this.b2.isDynamic();
		var bias = statType?this.continuous?nape.Config.contactContinuousStaticBiasCoef:nape.Config.contactStaticBiasCoef:this.continuous?nape.Config.contactContinuousBiasCoef:nape.Config.contactBiasCoef;
		this.biasCoef = bias;
		this.continuous = false;
		var pre = null;
		var prei = null;
		var cx_itei = this.innards.begin();
		var cx_ite = this.contacts.begin();
		while(cx_ite != null) {
			var c = cx_ite.elem();
			if(c.stamp + nape.Config.arbiterExpirationDelay < this.stamp) {
				cx_ite = this.contacts.inlined_erase(pre);
				cx_itei = this.innards.inlined_erase(prei);
				var o = c;
				o.free();
				o.next = zpp_nape.dynamics.ZPP_Contact.zpp_pool;
				zpp_nape.dynamics.ZPP_Contact.zpp_pool = o;
				continue;
			}
			var ci = c.inner;
			var pact = c.active;
			c.active = c.stamp == this.stamp;
			if(c.active) {
				if(fst) {
					fst = false;
					this.c1 = ci;
					this.oc1 = c;
				} else {
					this.hc2 = true;
					this.c2 = ci;
					this.oc2 = c;
				}
				ci.r2x = c.px - this.b2.posx;
				ci.r2y = c.py - this.b2.posy;
				ci.r1x = c.px - this.b1.posx;
				ci.r1y = c.py - this.b1.posy;
				var kt = mass_sum + this.b2.sinertia * zpp_nape.util.ZPP_Math.sqr(ci.r2x * this.nx + ci.r2y * this.ny);
				kt += this.b1.sinertia * zpp_nape.util.ZPP_Math.sqr(ci.r1x * this.nx + ci.r1y * this.ny);
				ci.tMass = kt < nape.Config.epsilon * nape.Config.epsilon?0:1.0 / kt;
				var nt = mass_sum + this.b2.sinertia * zpp_nape.util.ZPP_Math.sqr(this.ny * ci.r2x - this.nx * ci.r2y);
				nt += this.b1.sinertia * zpp_nape.util.ZPP_Math.sqr(this.ny * ci.r1x - this.nx * ci.r1y);
				ci.nMass = nt < nape.Config.epsilon * nape.Config.epsilon?0:1.0 / nt;
				var vrx = 0.0;
				var vry = 0.0;
				var ang = this.b2.angvel + this.b2.kinangvel;
				vrx = this.b2.velx + this.b2.kinvelx - ci.r2y * ang;
				vry = this.b2.vely + this.b2.kinvely + ci.r2x * ang;
				ang = this.b1.angvel + this.b1.kinangvel;
				vrx -= this.b1.velx + this.b1.kinvelx - ci.r1y * ang;
				vry -= this.b1.vely + this.b1.kinvely + ci.r1x * ang;
				var vdot = this.nx * vrx + this.ny * vry;
				c.elasticity = this.restitution;
				ci.bounce = vdot * c.elasticity;
				if(ci.bounce > -nape.Config.elasticThreshold) ci.bounce = 0;
				vdot = vry * this.nx - vrx * this.ny;
				var thr = nape.Config.staticFrictionThreshold;
				if(vdot * vdot > thr * thr) ci.friction = this.dyn_fric; else ci.friction = this.stat_fric;
				ci.jnAcc *= dtratio;
				ci.jtAcc *= dtratio;
			}
			if(pact != c.active) this.contacts.modified = true;
			pre = cx_ite;
			prei = cx_itei;
			cx_itei = cx_itei.next;
			cx_ite = cx_ite.next;
		}
		if(this.hc2) {
			this.hpc2 = true;
			if(this.oc1.posOnly) {
				var tmp = this.c1;
				this.c1 = this.c2;
				this.c2 = tmp;
				var tmp2 = this.oc1;
				this.oc1 = this.oc2;
				this.oc2 = tmp2;
				this.hc2 = false;
			} else if(this.oc2.posOnly) this.hc2 = false;
			if(this.oc1.posOnly) fst = true;
		} else this.hpc2 = false;
		this.jrAcc *= dtratio;
		if(!fst) {
			this.rn1a = this.ny * this.c1.r1x - this.nx * this.c1.r1y;
			this.rt1a = this.c1.r1x * this.nx + this.c1.r1y * this.ny;
			this.rn1b = this.ny * this.c1.r2x - this.nx * this.c1.r2y;
			this.rt1b = this.c1.r2x * this.nx + this.c1.r2y * this.ny;
			this.k1x = this.b2.kinvelx - this.c1.r2y * this.b2.kinangvel - (this.b1.kinvelx - this.c1.r1y * this.b1.kinangvel);
			this.k1y = this.b2.kinvely + this.c1.r2x * this.b2.kinangvel - (this.b1.kinvely + this.c1.r1x * this.b1.kinangvel);
		}
		if(this.hc2) {
			this.rn2a = this.ny * this.c2.r1x - this.nx * this.c2.r1y;
			this.rt2a = this.c2.r1x * this.nx + this.c2.r1y * this.ny;
			this.rn2b = this.ny * this.c2.r2x - this.nx * this.c2.r2y;
			this.rt2b = this.c2.r2x * this.nx + this.c2.r2y * this.ny;
			this.k2x = this.b2.kinvelx - this.c2.r2y * this.b2.kinangvel - (this.b1.kinvelx - this.c2.r1y * this.b1.kinangvel);
			this.k2y = this.b2.kinvely + this.c2.r2x * this.b2.kinangvel - (this.b1.kinvely + this.c2.r1x * this.b1.kinangvel);
			this.kMassa = mass_sum + this.b1.sinertia * this.rn1a * this.rn1a + this.b2.sinertia * this.rn1b * this.rn1b;
			this.kMassb = mass_sum + this.b1.sinertia * this.rn1a * this.rn2a + this.b2.sinertia * this.rn1b * this.rn2b;
			this.kMassc = mass_sum + this.b1.sinertia * this.rn2a * this.rn2a + this.b2.sinertia * this.rn2b * this.rn2b;
			var norm = this.kMassa * this.kMassa + 2 * this.kMassb * this.kMassb + this.kMassc * this.kMassc;
			if(norm < nape.Config.illConditionedThreshold * (this.kMassa * this.kMassc - this.kMassb * this.kMassb)) {
				this.Ka = this.kMassa;
				this.Kb = this.kMassb;
				this.Kc = this.kMassc;
				var det = this.kMassa * this.kMassc - this.kMassb * this.kMassb;
				if(det != det) {
					this.kMassa = this.kMassb = this.kMassc = 0;
					3;
				} else if(det == 0) {
					var flag = 0;
					if(this.kMassa != 0) this.kMassa = 1 / this.kMassa; else {
						this.kMassa = 0;
						flag |= 1;
					}
					if(this.kMassc != 0) this.kMassc = 1 / this.kMassc; else {
						this.kMassc = 0;
						flag |= 2;
					}
					this.kMassb = 0;
					flag;
				} else {
					det = 1 / det;
					var t = this.kMassc * det;
					this.kMassc = this.kMassa * det;
					this.kMassa = t;
					this.kMassb *= -det;
					0;
				}
			} else {
				this.hc2 = false;
				if(this.oc2.dist < this.oc1.dist) {
					var t = this.c1;
					this.c1 = this.c2;
					this.c2 = t;
				}
				this.oc2.active = false;
				this.contacts.modified = true;
			}
		}
		this.surfacex = this.b2.svelx;
		this.surfacey = this.b2.svely;
		var t = 1.0;
		this.surfacex += this.b1.svelx * t;
		this.surfacey += this.b1.svely * t;
		this.surfacex = -this.surfacex;
		this.surfacey = -this.surfacey;
		this.rMass = this.b1.sinertia + this.b2.sinertia;
		if(this.rMass != 0) this.rMass = 1 / this.rMass;
		return fst;
	}
	,cleanupContacts: function() {
		var fst = true;
		var pre = null;
		var prei = null;
		var cx_itei = this.innards.begin();
		this.hc2 = false;
		var cx_ite = this.contacts.begin();
		while(cx_ite != null) {
			var c = cx_ite.elem();
			if(c.stamp + nape.Config.arbiterExpirationDelay < this.stamp) {
				cx_ite = this.contacts.inlined_erase(pre);
				cx_itei = this.innards.inlined_erase(prei);
				var o = c;
				o.free();
				o.next = zpp_nape.dynamics.ZPP_Contact.zpp_pool;
				zpp_nape.dynamics.ZPP_Contact.zpp_pool = o;
				continue;
			}
			var ci = c.inner;
			var pact = c.active;
			c.active = c.stamp == this.stamp;
			if(c.active) {
				if(fst) {
					fst = false;
					this.c1 = ci;
					this.oc1 = c;
				} else {
					this.hc2 = true;
					this.c2 = ci;
					this.oc2 = c;
				}
			}
			if(pact != c.active) this.contacts.modified = true;
			pre = cx_ite;
			prei = cx_itei;
			cx_itei = cx_itei.next;
			cx_ite = cx_ite.next;
		}
		if(this.hc2) {
			this.hpc2 = true;
			if(this.oc1.posOnly) {
				var tmp = this.c1;
				this.c1 = this.c2;
				this.c2 = tmp;
				var tmp2 = this.oc1;
				this.oc1 = this.oc2;
				this.oc2 = tmp2;
				this.hc2 = false;
			} else if(this.oc2.posOnly) this.hc2 = false;
			if(this.oc1.posOnly) fst = true;
		} else this.hpc2 = false;
		return fst;
	}
	,setupcontacts: function() {
		this.wrap_contacts = zpp_nape.util.ZPP_ContactList.get(this.contacts,true);
		this.wrap_contacts.zpp_inner.immutable = !this.mutable;
		this.wrap_contacts.zpp_inner.adder = $bind(this,this.contacts_adder);
		this.wrap_contacts.zpp_inner.dontremove = true;
		this.wrap_contacts.zpp_inner.subber = $bind(this,this.contacts_subber);
	}
	,contacts_subber: function(x) {
		var pre = null;
		var prei = null;
		var cx_itei = this.innards.begin();
		var cx_ite = this.contacts.begin();
		while(cx_ite != null) {
			var c = cx_ite.elem();
			if(c == x.zpp_inner) {
				this.contacts.erase(pre);
				this.innards.erase(prei);
				var o = c;
				o.free();
				o.next = zpp_nape.dynamics.ZPP_Contact.zpp_pool;
				zpp_nape.dynamics.ZPP_Contact.zpp_pool = o;
				break;
			}
			pre = cx_ite;
			prei = cx_itei;
			cx_itei = cx_itei.next;
			cx_ite = cx_ite.next;
		}
	}
	,contacts_adder: function(x) {
		throw "Error: Cannot add new contacts, information required is far too specific and detailed :)";
		return false;
	}
	,makeimmutable: function() {
		this.mutable = false;
		if(this.wrap_normal != null) this.wrap_normal.zpp_inner._immutable = true;
		if(this.wrap_contacts != null) this.wrap_contacts.zpp_inner.immutable = true;
	}
	,makemutable: function() {
		this.mutable = true;
		if(this.wrap_normal != null) this.wrap_normal.zpp_inner._immutable = false;
		if(this.wrap_contacts != null) this.wrap_contacts.zpp_inner.immutable = false;
	}
	,retire: function() {
		this.sup_retire();
		while(!this.contacts.empty()) {
			var o = this.contacts.inlined_pop_unsafe();
			o.free();
			o.next = zpp_nape.dynamics.ZPP_Contact.zpp_pool;
			zpp_nape.dynamics.ZPP_Contact.zpp_pool = o;
			this.innards.inlined_pop();
		}
		var o = this;
		o.free();
		o.next = zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool;
		zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool = o;
		this.pre_dt = -1.0;
	}
	,validate_props: function() {
		if(this.invalidated) {
			this.invalidated = false;
			this.calcProperties();
		}
	}
	,calcProperties: function() {
		if(!this.userdef_restitution) {
			if(this.s1.material.elasticity <= zpp_nape.ZPP_Const.NEGINF() || this.s2.material.elasticity <= zpp_nape.ZPP_Const.NEGINF()) this.restitution = 0; else if(this.s1.material.elasticity >= zpp_nape.ZPP_Const.POSINF() || this.s2.material.elasticity >= zpp_nape.ZPP_Const.POSINF()) this.restitution = 1; else this.restitution = (this.s1.material.elasticity + this.s2.material.elasticity) / 2;
			if(this.restitution < 0) this.restitution = 0;
			if(this.restitution > 1) this.restitution = 1;
		}
		if(!this.userdef_dyn_fric) this.dyn_fric = zpp_nape.util.ZPP_Math.sqrt(this.s1.material.dynamicFriction * this.s2.material.dynamicFriction);
		if(!this.userdef_stat_fric) this.stat_fric = zpp_nape.util.ZPP_Math.sqrt(this.s1.material.staticFriction * this.s2.material.staticFriction);
		if(!this.userdef_rfric) this.rfric = zpp_nape.util.ZPP_Math.sqrt(this.s1.material.rollingFriction * this.s2.material.rollingFriction);
	}
	,assign: function(s1,s2,id,di) {
		this.sup_assign(s1,s2,id,di);
		this.s1 = s1;
		this.s2 = s2;
		this.calcProperties();
	}
	,injectContact: function(px,py,nx,ny,dist,hash,posOnly) {
		if(posOnly == null) posOnly = false;
		var c = null;
		var cx_ite = this.contacts.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			if(hash == cur.hash) {
				c = cur;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(c == null) {
			if(zpp_nape.dynamics.ZPP_Contact.zpp_pool == null) c = new zpp_nape.dynamics.ZPP_Contact(); else {
				c = zpp_nape.dynamics.ZPP_Contact.zpp_pool;
				zpp_nape.dynamics.ZPP_Contact.zpp_pool = c.next;
				c.next = null;
			}
			c.alloc();
			var ci = c.inner;
			ci.jnAcc = ci.jtAcc = 0;
			c.hash = hash;
			c.fresh = true;
			c.arbiter = this;
			this.jrAcc = 0;
			this.contacts.inlined_add(c);
			this.innards.add(ci);
		} else c.fresh = false;
		c.px = px;
		c.py = py;
		this.nx = nx;
		this.ny = ny;
		c.dist = dist;
		c.stamp = this.stamp;
		c.posOnly = posOnly;
		return c;
	}
	,free: function() {
		this.userdef_dyn_fric = false;
		this.userdef_stat_fric = false;
		this.userdef_restitution = false;
		this.userdef_rfric = false;
		this.__ref_edge1 = this.__ref_edge2 = null;
	}
	,alloc: function() {
	}
	,getnormal: function() {
		this.wrap_normal = nape.geom.Vec2.get(0,0);
		this.wrap_normal.zpp_inner._immutable = true;
		this.wrap_normal.zpp_inner._inuse = true;
		this.wrap_normal.zpp_inner._validate = $bind(this,this.normal_validate);
	}
	,normal_validate: function() {
		if(this.cleared) throw "Error: Arbiter not currently in use";
		this.wrap_normal.zpp_inner.x = this.nx;
		this.wrap_normal.zpp_inner.y = this.ny;
	}
	,__class__: zpp_nape.dynamics.ZPP_ColArbiter
});
zpp_nape.dynamics.ZPP_Contact = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this._inuse = false;
	this.next = null;
	this.elasticity = 0.0;
	this.dist = 0.0;
	this.fresh = false;
	this.hash = 0;
	this.stamp = 0;
	this.posOnly = false;
	this.active = false;
	this.inner = null;
	this.arbiter = null;
	this.wrap_position = null;
	this.py = 0.0;
	this.px = 0.0;
	this.outer = null;
	this.inner = new zpp_nape.dynamics.ZPP_IContact();
};
$hxClasses["zpp_nape.dynamics.ZPP_Contact"] = zpp_nape.dynamics.ZPP_Contact;
zpp_nape.dynamics.ZPP_Contact.__name__ = ["zpp_nape","dynamics","ZPP_Contact"];
zpp_nape.dynamics.ZPP_Contact.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.next = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		old.elem()._inuse = false;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,erase: function(pre) {
		return this.inlined_erase(pre);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.next = ret.next;
		ret.elem()._inuse = false;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			o._inuse = true;
			$r = o;
			return $r;
		}(this));
		temp.next = this.begin();
		this.next = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,begin: function() {
		return this.next;
	}
	,elem: function() {
		return this;
	}
	,alloc: function() {
	}
	,free: function() {
		this.arbiter = null;
	}
	,inactiveme: function() {
		return !(this.active && this.arbiter != null && !this.arbiter.inactiveme());
	}
	,getposition: function() {
		var me = this;
		this.wrap_position = nape.geom.Vec2.get();
		this.wrap_position.zpp_inner._inuse = true;
		this.wrap_position.zpp_inner._immutable = true;
		this.wrap_position.zpp_inner._validate = $bind(this,this.position_validate);
	}
	,position_validate: function() {
		if(this.inactiveme()) throw "Error: Contact not currently in use";
		this.wrap_position.zpp_inner.x = this.px;
		this.wrap_position.zpp_inner.y = this.py;
	}
	,wrapper: function() {
		if(this.outer == null) {
			zpp_nape.dynamics.ZPP_Contact.internal = true;
			this.outer = new nape.dynamics.Contact();
			zpp_nape.dynamics.ZPP_Contact.internal = false;
			this.outer.zpp_inner = this;
		}
		return this.outer;
	}
	,__class__: zpp_nape.dynamics.ZPP_Contact
}
zpp_nape.dynamics.ZPP_IContact = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this._inuse = false;
	this.next = null;
	this.lr2y = 0.0;
	this.lr2x = 0.0;
	this.lr1y = 0.0;
	this.lr1x = 0.0;
	this.jtAcc = 0.0;
	this.jnAcc = 0.0;
	this.friction = 0.0;
	this.bounce = 0.0;
	this.tMass = 0.0;
	this.nMass = 0.0;
	this.r2y = 0.0;
	this.r2x = 0.0;
	this.r1y = 0.0;
	this.r1x = 0.0;
};
$hxClasses["zpp_nape.dynamics.ZPP_IContact"] = zpp_nape.dynamics.ZPP_IContact;
zpp_nape.dynamics.ZPP_IContact.__name__ = ["zpp_nape","dynamics","ZPP_IContact"];
zpp_nape.dynamics.ZPP_IContact.prototype = {
	empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.next = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		old.elem()._inuse = false;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,erase: function(pre) {
		return this.inlined_erase(pre);
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.next = ret.next;
		ret.elem()._inuse = false;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			o._inuse = true;
			$r = o;
			return $r;
		}(this));
		temp.next = this.begin();
		this.next = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.next;
	}
	,elem: function() {
		return this;
	}
	,__class__: zpp_nape.dynamics.ZPP_IContact
}
zpp_nape.dynamics.ZPP_InteractionFilter = function() {
	this.fluidMask = 0;
	this.fluidGroup = 0;
	this.sensorMask = 0;
	this.sensorGroup = 0;
	this.collisionMask = 0;
	this.collisionGroup = 0;
	this.wrap_shapes = null;
	this.shapes = null;
	this.outer = null;
	this.userData = null;
	this.next = null;
	this.feature_cons();
	this.collisionGroup = this.sensorGroup = this.fluidGroup = 1;
	this.collisionMask = this.sensorMask = this.fluidMask = -1;
};
$hxClasses["zpp_nape.dynamics.ZPP_InteractionFilter"] = zpp_nape.dynamics.ZPP_InteractionFilter;
zpp_nape.dynamics.ZPP_InteractionFilter.__name__ = ["zpp_nape","dynamics","ZPP_InteractionFilter"];
zpp_nape.dynamics.ZPP_InteractionFilter.prototype = {
	invalidate: function() {
		var cx_ite = this.shapes.begin();
		while(cx_ite != null) {
			var s = cx_ite.elem();
			s.invalidate_filter();
			cx_ite = cx_ite.next;
		}
	}
	,shouldFlow: function(x) {
		return (this.fluidMask & x.fluidGroup) != 0 && (x.fluidMask & this.fluidGroup) != 0;
	}
	,shouldSense: function(x) {
		return (this.sensorMask & x.sensorGroup) != 0 && (x.sensorMask & this.sensorGroup) != 0;
	}
	,shouldCollide: function(x) {
		return (this.collisionMask & x.collisionGroup) != 0 && (x.collisionMask & this.collisionGroup) != 0;
	}
	,remShape: function(shape) {
		this.shapes.remove(shape);
	}
	,addShape: function(shape) {
		this.shapes.add(shape);
	}
	,feature_cons: function() {
		this.shapes = new zpp_nape.util.ZNPList_ZPP_Shape();
	}
	,alloc: function() {
	}
	,free: function() {
		this.outer = null;
	}
	,wrapper: function() {
		if(this.outer == null) {
			this.outer = new nape.dynamics.InteractionFilter();
			var o = this.outer.zpp_inner;
			o.free();
			o.next = zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool;
			zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool = o;
			this.outer.zpp_inner = this;
		}
		return this.outer;
	}
	,__class__: zpp_nape.dynamics.ZPP_InteractionFilter
}
zpp_nape.dynamics.ZPP_InteractionGroup = function() {
	this.depth = 0;
	this.wrap_interactors = null;
	this.interactors = null;
	this.wrap_groups = null;
	this.groups = null;
	this.group = null;
	this.ignore = false;
	this.outer = null;
};
$hxClasses["zpp_nape.dynamics.ZPP_InteractionGroup"] = zpp_nape.dynamics.ZPP_InteractionGroup;
zpp_nape.dynamics.ZPP_InteractionGroup.__name__ = ["zpp_nape","dynamics","ZPP_InteractionGroup"];
zpp_nape.dynamics.ZPP_InteractionGroup.prototype = {
	remInteractor: function(intx,flag) {
		if(flag == null) flag = -1;
		this.interactors.remove(intx);
	}
	,addInteractor: function(intx) {
		this.interactors.add(intx);
	}
	,remGroup: function(group) {
		this.groups.remove(group);
		group.depth = 0;
	}
	,addGroup: function(group) {
		this.groups.add(group);
		group.depth = this.depth + 1;
	}
	,invalidate: function(force) {
		if(force == null) force = false;
		if(!(force || this.ignore)) return;
		var cx_ite = this.interactors.begin();
		while(cx_ite != null) {
			var b = cx_ite.elem();
			if(b.isBody()) b.ibody.wake(); else if(b.isShape()) b.ishape.body.wake(); else b.icompound.wake();
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.groups.begin();
		while(cx_ite != null) {
			var g = cx_ite.elem();
			g.invalidate(force);
			cx_ite = cx_ite.next;
		}
	}
	,setGroup: function(group) {
		if(this.group != group) {
			if(this.group != null) {
				this.group.remGroup(this);
				this.group.invalidate(true);
			}
			this.group = group;
			if(group != null) {
				group.addGroup(this);
				group.invalidate(true);
			} else this.invalidate(true);
		}
	}
	,__class__: zpp_nape.dynamics.ZPP_InteractionGroup
}
zpp_nape.dynamics.ZPP_SpaceArbiterList = function() {
	this.at_index_3 = 0;
	this.at_index_2 = 0;
	this.at_index_1 = 0;
	this.at_index_0 = 0;
	this.ite_3 = null;
	this.ite_2 = null;
	this.ite_1 = null;
	this.ite_0 = null;
	this.lengths = null;
	this.zip_length = false;
	this._length = 0;
	this.space = null;
	nape.dynamics.ArbiterList.call(this);
	this.at_index_0 = 0;
	this.at_index_1 = 0;
	this.at_index_2 = 0;
	this.at_index_3 = 0;
	this.zip_length = true;
	this._length = 0;
	this.lengths = new Array();
	var _g = 0;
	while(_g < 4) {
		var i = _g++;
		this.lengths.push(0);
	}
};
$hxClasses["zpp_nape.dynamics.ZPP_SpaceArbiterList"] = zpp_nape.dynamics.ZPP_SpaceArbiterList;
zpp_nape.dynamics.ZPP_SpaceArbiterList.__name__ = ["zpp_nape","dynamics","ZPP_SpaceArbiterList"];
zpp_nape.dynamics.ZPP_SpaceArbiterList.__super__ = nape.dynamics.ArbiterList;
zpp_nape.dynamics.ZPP_SpaceArbiterList.prototype = $extend(nape.dynamics.ArbiterList.prototype,{
	at: function(index) {
		this.zpp_vm();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		var ret = null;
		var accum_length = 0;
		if(ret == null) {
			if(index < accum_length + this.lengths[0]) {
				var offset = index - accum_length;
				if(offset < this.at_index_0 || this.ite_0 == null) {
					this.at_index_0 = 0;
					this.ite_0 = this.space.c_arbiters_true.begin();
					while(true) {
						var x = this.ite_0.elem();
						if(x.active) break;
						this.ite_0 = this.ite_0.next;
					}
				}
				while(this.at_index_0 != offset) {
					this.at_index_0++;
					this.ite_0 = this.ite_0.next;
					while(true) {
						var x = this.ite_0.elem();
						if(x.active) break;
						this.ite_0 = this.ite_0.next;
					}
				}
				ret = this.ite_0.elem().wrapper();
			} else accum_length += this.lengths[0];
		}
		if(ret == null) {
			if(index < accum_length + this.lengths[1]) {
				var offset = index - accum_length;
				if(offset < this.at_index_1 || this.ite_1 == null) {
					this.at_index_1 = 0;
					this.ite_1 = this.space.c_arbiters_false.begin();
					while(true) {
						var x = this.ite_1.elem();
						if(x.active) break;
						this.ite_1 = this.ite_1.next;
					}
				}
				while(this.at_index_1 != offset) {
					this.at_index_1++;
					this.ite_1 = this.ite_1.next;
					while(true) {
						var x = this.ite_1.elem();
						if(x.active) break;
						this.ite_1 = this.ite_1.next;
					}
				}
				ret = this.ite_1.elem().wrapper();
			} else accum_length += this.lengths[1];
		}
		if(ret == null) {
			if(index < accum_length + this.lengths[2]) {
				var offset = index - accum_length;
				if(offset < this.at_index_2 || this.ite_2 == null) {
					this.at_index_2 = 0;
					this.ite_2 = this.space.f_arbiters.begin();
					while(true) {
						var x = this.ite_2.elem();
						if(x.active) break;
						this.ite_2 = this.ite_2.next;
					}
				}
				while(this.at_index_2 != offset) {
					this.at_index_2++;
					this.ite_2 = this.ite_2.next;
					while(true) {
						var x = this.ite_2.elem();
						if(x.active) break;
						this.ite_2 = this.ite_2.next;
					}
				}
				ret = this.ite_2.elem().wrapper();
			} else accum_length += this.lengths[2];
		}
		if(ret == null) {
			if(index < accum_length + this.lengths[3]) {
				var offset = index - accum_length;
				if(offset < this.at_index_3 || this.ite_3 == null) {
					this.at_index_3 = 0;
					this.ite_3 = this.space.s_arbiters.begin();
					while(true) {
						var x = this.ite_3.elem();
						if(x.active) break;
						this.ite_3 = this.ite_3.next;
					}
				}
				while(this.at_index_3 != offset) {
					this.at_index_3++;
					this.ite_3 = this.ite_3.next;
					while(true) {
						var x = this.ite_3.elem();
						if(x.active) break;
						this.ite_3 = this.ite_3.next;
					}
				}
				ret = this.ite_3.elem().wrapper();
			} else accum_length += this.lengths[3];
		}
		return ret;
	}
	,clear: function() {
		throw "Error: ArbiterList is immutable";
	}
	,remove: function(obj) {
		throw "Error: ArbiterList is immutable";
		return false;
	}
	,shift: function() {
		throw "Error: ArbiterList is immutable";
		return null;
	}
	,unshift: function(obj) {
		throw "Error: ArbiterList is immutable";
		return false;
	}
	,pop: function() {
		throw "Error: ArbiterList is immutable";
		return null;
	}
	,push: function(obj) {
		throw "Error: ArbiterList is immutable";
		return false;
	}
	,zpp_vm: function() {
		var modified = false;
		if(this.space.c_arbiters_true.modified) {
			modified = true;
			this.space.c_arbiters_true.modified = false;
		}
		if(this.space.c_arbiters_false.modified) {
			modified = true;
			this.space.c_arbiters_false.modified = false;
		}
		if(this.space.f_arbiters.modified) {
			modified = true;
			this.space.f_arbiters.modified = false;
		}
		if(this.space.s_arbiters.modified) {
			modified = true;
			this.space.s_arbiters.modified = false;
		}
		if(modified) {
			this.zip_length = true;
			this._length = 0;
			this.ite_0 = null;
			this.ite_1 = null;
			this.ite_2 = null;
			this.ite_3 = null;
		}
	}
	,zpp_gl: function() {
		this.zpp_vm();
		if(this.zip_length) {
			this._length = 0;
			var ind = 0;
			var len = 0;
			var cx_ite = this.space.c_arbiters_true.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				if(i.active) len++;
				cx_ite = cx_ite.next;
			}
			this.lengths[ind++] = len;
			this._length += len;
			var len = 0;
			var cx_ite = this.space.c_arbiters_false.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				if(i.active) len++;
				cx_ite = cx_ite.next;
			}
			this.lengths[ind++] = len;
			this._length += len;
			var len = 0;
			var cx_ite = this.space.f_arbiters.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				if(i.active) len++;
				cx_ite = cx_ite.next;
			}
			this.lengths[ind++] = len;
			this._length += len;
			var len = 0;
			var cx_ite = this.space.s_arbiters.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				if(i.active) len++;
				cx_ite = cx_ite.next;
			}
			this.lengths[ind++] = len;
			this._length += len;
			this.zip_length = false;
		}
		return this._length;
	}
	,__class__: zpp_nape.dynamics.ZPP_SpaceArbiterList
});
zpp_nape.geom = {}
zpp_nape.geom.ZPP_AABB = function() {
	this.wrap_max = null;
	this.maxy = 0.0;
	this.maxx = 0.0;
	this.wrap_min = null;
	this.miny = 0.0;
	this.minx = 0.0;
	this.next = null;
	this.outer = null;
	this._immutable = false;
	this._validate = null;
	this._invalidate = null;
};
$hxClasses["zpp_nape.geom.ZPP_AABB"] = zpp_nape.geom.ZPP_AABB;
zpp_nape.geom.ZPP_AABB.__name__ = ["zpp_nape","geom","ZPP_AABB"];
zpp_nape.geom.ZPP_AABB.get = function(minx,miny,maxx,maxy) {
	var ret;
	if(zpp_nape.geom.ZPP_AABB.zpp_pool == null) ret = new zpp_nape.geom.ZPP_AABB(); else {
		ret = zpp_nape.geom.ZPP_AABB.zpp_pool;
		zpp_nape.geom.ZPP_AABB.zpp_pool = ret.next;
		ret.next = null;
	}
	ret.alloc();
	ret.minx = minx;
	ret.miny = miny;
	ret.maxx = maxx;
	ret.maxy = maxy;
	return ret;
}
zpp_nape.geom.ZPP_AABB.prototype = {
	toString: function() {
		return "{ x: " + this.minx + " y: " + this.miny + " w: " + this.width() + " h: " + this.height() + " }";
	}
	,setExpand: function(a,fatten) {
		this.minx = a.minx - fatten;
		this.miny = a.miny - fatten;
		this.maxx = a.maxx + fatten;
		this.maxy = a.maxy + fatten;
	}
	,setCombine: function(a,b) {
		this.minx = a.minx < b.minx?a.minx:b.minx;
		this.miny = a.miny < b.miny?a.miny:b.miny;
		this.maxx = a.maxx > b.maxx?a.maxx:b.maxx;
		this.maxy = a.maxy > b.maxy?a.maxy:b.maxy;
	}
	,containsPoint: function(v) {
		return v.x >= this.minx && v.x <= this.maxx && v.y >= this.miny && v.y <= this.maxy;
	}
	,contains: function(x) {
		return x.minx >= this.minx && x.miny >= this.miny && x.maxx <= this.maxx && x.maxy <= this.maxy;
	}
	,combine: function(x) {
		if(x.minx < this.minx) this.minx = x.minx;
		if(x.maxx > this.maxx) this.maxx = x.maxx;
		if(x.miny < this.miny) this.miny = x.miny;
		if(x.maxy > this.maxy) this.maxy = x.maxy;
	}
	,intersect: function(x) {
		return x.miny <= this.maxy && this.miny <= x.maxy && x.minx <= this.maxx && this.minx <= x.maxx;
	}
	,intersectY: function(x) {
		return !(x.miny > this.maxy || this.miny > x.maxy);
	}
	,mod_max: function(max) {
		if(max.x != this.maxx || max.y != this.maxy) {
			this.maxx = max.x;
			this.maxy = max.y;
			this.invalidate();
		}
	}
	,dom_max: function() {
		this.validate();
		this.wrap_max.zpp_inner.x = this.maxx;
		this.wrap_max.zpp_inner.y = this.maxy;
	}
	,getmax: function() {
		if(this.wrap_max == null) {
			this.wrap_max = nape.geom.Vec2.get(this.maxx,this.maxy);
			this.wrap_max.zpp_inner._inuse = true;
			if(this._immutable) this.wrap_max.zpp_inner._immutable = true; else this.wrap_max.zpp_inner._invalidate = $bind(this,this.mod_max);
			this.wrap_max.zpp_inner._validate = $bind(this,this.dom_max);
		}
		return this.wrap_max;
	}
	,mod_min: function(min) {
		if(min.x != this.minx || min.y != this.miny) {
			this.minx = min.x;
			this.miny = min.y;
			this.invalidate();
		}
	}
	,dom_min: function() {
		this.validate();
		this.wrap_min.zpp_inner.x = this.minx;
		this.wrap_min.zpp_inner.y = this.miny;
	}
	,getmin: function() {
		if(this.wrap_min == null) {
			this.wrap_min = nape.geom.Vec2.get(this.minx,this.miny);
			this.wrap_min.zpp_inner._inuse = true;
			if(this._immutable) this.wrap_min.zpp_inner._immutable = true; else this.wrap_min.zpp_inner._invalidate = $bind(this,this.mod_min);
			this.wrap_min.zpp_inner._validate = $bind(this,this.dom_min);
		}
		return this.wrap_min;
	}
	,perimeter: function() {
		return (this.width() + this.height()) * 2;
	}
	,height: function() {
		return this.maxy - this.miny;
	}
	,width: function() {
		return this.maxx - this.minx;
	}
	,free: function() {
		if(this.outer != null) {
			this.outer.zpp_inner = null;
			this.outer = null;
		}
		this.wrap_min = this.wrap_max = null;
		this._invalidate = null;
		this._validate = null;
	}
	,alloc: function() {
	}
	,wrapper: function() {
		if(this.outer == null) {
			this.outer = new nape.geom.AABB();
			var o = this.outer.zpp_inner;
			o.free();
			o.next = zpp_nape.geom.ZPP_AABB.zpp_pool;
			zpp_nape.geom.ZPP_AABB.zpp_pool = o;
			this.outer.zpp_inner = this;
		}
		return this.outer;
	}
	,invalidate: function() {
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._validate != null) this._validate();
	}
	,__class__: zpp_nape.geom.ZPP_AABB
}
zpp_nape.util.ZNPList_ZPP_Vec2 = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Vec2"] = zpp_nape.util.ZNPList_ZPP_Vec2;
zpp_nape.util.ZNPList_ZPP_Vec2.__name__ = ["zpp_nape","util","ZNPList_ZPP_Vec2"];
zpp_nape.util.ZNPList_ZPP_Vec2.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_clear: function() {
		if(true) {
			while(!this.empty()) this.inlined_pop();
			this.pushmod = true;
		}
	}
	,clear: function() {
		this.inlined_clear();
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,erase: function(pre) {
		return this.inlined_erase(pre);
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Vec2(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Vec2(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Vec2.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Vec2
}
zpp_nape.geom.ZPP_Collide = function() { }
$hxClasses["zpp_nape.geom.ZPP_Collide"] = zpp_nape.geom.ZPP_Collide;
zpp_nape.geom.ZPP_Collide.__name__ = ["zpp_nape","geom","ZPP_Collide"];
zpp_nape.geom.ZPP_Collide.circleContains = function(c,p) {
	var dx = 0.0;
	var dy = 0.0;
	dx = p.x - c.worldCOMx;
	dy = p.y - c.worldCOMy;
	return dx * dx + dy * dy < c.radius * c.radius;
}
zpp_nape.geom.ZPP_Collide.polyContains = function(s,p) {
	var retvar;
	retvar = true;
	var cx_ite = s.edges.begin();
	while(cx_ite != null) {
		var a = cx_ite.elem();
		if(a.gnormx * p.x + a.gnormy * p.y <= a.gprojection) {
			cx_ite = cx_ite.next;
			continue;
		} else {
			retvar = false;
			break;
		}
		cx_ite = cx_ite.next;
	}
	return retvar;
}
zpp_nape.geom.ZPP_Collide.containTest = function(s1,s2) {
	if(s1.aabb.contains(s2.aabb)) return s1.isCircle()?s2.isCircle()?(function($this) {
		var $r;
		var minDist = s1.circle.radius + -s2.circle.radius;
		var px = 0.0;
		var py = 0.0;
		{
			px = s2.circle.worldCOMx - s1.circle.worldCOMx;
			py = s2.circle.worldCOMy - s1.circle.worldCOMy;
		}
		var distSqr = px * px + py * py;
		$r = distSqr <= minDist * minDist;
		return $r;
	}(this)):(function($this) {
		var $r;
		var retvar;
		{
			retvar = true;
			var cx_ite = s2.polygon.gverts.begin();
			while(cx_ite != null) {
				var p = cx_ite.elem();
				if((function($this) {
					var $r;
					var minDist = s1.circle.radius + 0;
					var px = 0.0;
					var py = 0.0;
					{
						px = p.x - s1.circle.worldCOMx;
						py = p.y - s1.circle.worldCOMy;
					}
					var distSqr = px * px + py * py;
					$r = distSqr <= minDist * minDist;
					return $r;
				}($this))) {
					cx_ite = cx_ite.next;
					continue;
				} else {
					retvar = false;
					break;
				}
				cx_ite = cx_ite.next;
			}
		}
		$r = retvar;
		return $r;
	}(this)):s2.isCircle()?(function($this) {
		var $r;
		var retvar;
		{
			retvar = true;
			var cx_ite = s1.polygon.edges.begin();
			while(cx_ite != null) {
				var a = cx_ite.elem();
				if(a.gnormx * s2.circle.worldCOMx + a.gnormy * s2.circle.worldCOMy + s2.circle.radius <= a.gprojection) {
					cx_ite = cx_ite.next;
					continue;
				} else {
					retvar = false;
					break;
				}
				cx_ite = cx_ite.next;
			}
		}
		$r = retvar;
		return $r;
	}(this)):(function($this) {
		var $r;
		var retvar;
		{
			retvar = true;
			var cx_ite = s1.polygon.edges.begin();
			while(cx_ite != null) {
				var a = cx_ite.elem();
				if((function($this) {
					var $r;
					var max = -1e100;
					{
						var cx_ite1 = s2.polygon.gverts.begin();
						while(cx_ite1 != null) {
							var v = cx_ite1.elem();
							var k = a.gnormx * v.x + a.gnormy * v.y;
							if(k > max) max = k;
							cx_ite1 = cx_ite1.next;
						}
					}
					$r = max <= a.gprojection;
					return $r;
				}($this))) {
					cx_ite = cx_ite.next;
					continue;
				} else {
					retvar = false;
					break;
				}
				cx_ite = cx_ite.next;
			}
		}
		$r = retvar;
		return $r;
	}(this)); else return false;
}
zpp_nape.geom.ZPP_Collide.contactCollide = function(s1,s2,arb,rev) {
	if(s2.isPolygon()) {
		if(s1.isPolygon()) {
			var cont = true;
			var max = -1e100;
			var maxmin = -1e100;
			var maxi = -1;
			var axis1 = null;
			var axis2 = null;
			var cx_ite = s1.polygon.edges.begin();
			while(cx_ite != null) {
				var ax = cx_ite.elem();
				var min = 1e100;
				var cx_ite1 = s2.polygon.gverts.begin();
				while(cx_ite1 != null) {
					var v = cx_ite1.elem();
					var k = ax.gnormx * v.x + ax.gnormy * v.y;
					if(k < min) min = k;
					if(min - ax.gprojection <= max) break;
					cx_ite1 = cx_ite1.next;
				}
				min -= ax.gprojection;
				if(min >= 0) {
					cont = false;
					break;
				}
				if(min > max) {
					max = min;
					axis1 = ax;
					maxi = 1;
				}
				cx_ite = cx_ite.next;
			}
			if(cont) {
				var cx_ite = s2.polygon.edges.begin();
				while(cx_ite != null) {
					var ax = cx_ite.elem();
					var min = 1e100;
					var cx_ite1 = s1.polygon.gverts.begin();
					while(cx_ite1 != null) {
						var v = cx_ite1.elem();
						var k = ax.gnormx * v.x + ax.gnormy * v.y;
						if(k < min) min = k;
						if(min - ax.gprojection <= max) break;
						cx_ite1 = cx_ite1.next;
					}
					min -= ax.gprojection;
					if(min >= 0) {
						cont = false;
						break;
					}
					if(min > max) {
						max = min;
						axis2 = ax;
						maxi = 2;
					}
					cx_ite = cx_ite.next;
				}
				if(!cont) return false; else {
					var q1, q2, ax, scale;
					if(maxi == 1) {
						q1 = s1.polygon;
						q2 = s2.polygon;
						ax = axis1;
						scale = 1.0;
					} else {
						q1 = s2.polygon;
						q2 = s1.polygon;
						ax = axis2;
						scale = -1.0;
					}
					var ay = null;
					var min = 1e100;
					var cx_ite = q2.edges.begin();
					while(cx_ite != null) {
						var axis = cx_ite.elem();
						var k = ax.gnormx * axis.gnormx + ax.gnormy * axis.gnormy;
						if(k < min) {
							min = k;
							ay = axis;
						}
						cx_ite = cx_ite.next;
					}
					var c0x = 0.0;
					var c0y = 0.0;
					c0x = ay.gp0.x;
					c0y = ay.gp0.y;
					var c1x = 0.0;
					var c1y = 0.0;
					c1x = ay.gp1.x;
					c1y = ay.gp1.y;
					var dvx = 0.0;
					var dvy = 0.0;
					dvx = c1x - c0x;
					dvy = c1y - c0y;
					var d0 = ax.gnormy * c0x - ax.gnormx * c0y;
					var d1 = ax.gnormy * c1x - ax.gnormx * c1y;
					var den = 1 / (d1 - d0);
					var t = (-ax.tp1 - d0) * den;
					if(t > nape.Config.epsilon) {
						var t1 = t;
						c0x += dvx * t1;
						c0y += dvy * t1;
					}
					var t1 = (-ax.tp0 - d1) * den;
					if(t1 < -nape.Config.epsilon) {
						var t2 = t1;
						c1x += dvx * t2;
						c1y += dvy * t2;
					}
					var nx = 0.0;
					var ny = 0.0;
					var t2 = scale;
					nx = ax.gnormx * t2;
					ny = ax.gnormy * t2;
					arb.lnormx = ax.lnormx;
					arb.lnormy = ax.lnormy;
					arb.lproj = ax.lprojection;
					arb.radius = 0;
					arb.rev = rev != (scale == -1);
					arb.ptype = arb.rev?1:0;
					var c0d = c0x * ax.gnormx + c0y * ax.gnormy - ax.gprojection;
					var c1d = c1x * ax.gnormx + c1y * ax.gnormy - ax.gprojection;
					if(c0d > 0 && c1d > 0) return false; else {
						if(rev) {
							nx = -nx;
							ny = -ny;
						}
						var con = arb.injectContact(c0x - ax.gnormx * c0d * 0.5,c0y - ax.gnormy * c0d * 0.5,nx,ny,c0d,arb.rev?1:0,c0d > 0);
						var t2 = 1.0;
						c0x -= q2.body.posx * t2;
						c0y -= q2.body.posy * t2;
						con.inner.lr1x = c0x * q2.body.axisy + c0y * q2.body.axisx;
						con.inner.lr1y = c0y * q2.body.axisy - c0x * q2.body.axisx;
						con = arb.injectContact(c1x - ax.gnormx * c1d * 0.5,c1y - ax.gnormy * c1d * 0.5,nx,ny,c1d,arb.rev?0:1,c1d > 0);
						var t2 = 1.0;
						c1x -= q2.body.posx * t2;
						c1y -= q2.body.posy * t2;
						con.inner.lr1x = c1x * q2.body.axisy + c1y * q2.body.axisx;
						con.inner.lr1y = c1y * q2.body.axisy - c1x * q2.body.axisx;
						if(maxi == 1) {
							arb.__ref_edge1 = ax;
							arb.__ref_edge2 = ay;
						} else {
							arb.__ref_edge2 = ax;
							arb.__ref_edge1 = ay;
						}
						return true;
					}
				}
			} else return false;
		} else {
			var max = -1e100;
			var minmax = -1e100;
			var cont = true;
			var a0 = null, vi = null;
			var vite = s2.polygon.gverts.begin();
			var cx_ite = s2.polygon.edges.begin();
			while(cx_ite != null) {
				var a = cx_ite.elem();
				var dist = a.gnormx * s1.circle.worldCOMx + a.gnormy * s1.circle.worldCOMy - a.gprojection - s1.circle.radius;
				if(dist > 0) {
					cont = false;
					break;
				}
				if(dist > max) {
					max = dist;
					a0 = a;
					vi = vite;
				}
				vite = vite.next;
				cx_ite = cx_ite.next;
			}
			if(cont) {
				var v0 = vi.elem();
				var v1 = vi.next == null?s2.polygon.gverts.front():vi.next.elem();
				var dt = s1.circle.worldCOMy * a0.gnormx - s1.circle.worldCOMx * a0.gnormy;
				if(dt <= v0.y * a0.gnormx - v0.x * a0.gnormy) {
					var co = (function($this) {
						var $r;
						var minDist = s1.circle.radius + 0;
						var px = 0.0;
						var py = 0.0;
						{
							px = v0.x - s1.circle.worldCOMx;
							py = v0.y - s1.circle.worldCOMy;
						}
						var distSqr = px * px + py * py;
						$r = distSqr > minDist * minDist?null:distSqr < nape.Config.epsilon * nape.Config.epsilon?arb.injectContact(s1.circle.worldCOMx,s1.circle.worldCOMy,1,0,-minDist,0):(function($this) {
							var $r;
							var invDist = zpp_nape.util.ZPP_Math.invsqrt(distSqr);
							var dist = invDist < nape.Config.epsilon?1e100:1.0 / invDist;
							var df = 0.5 + (s1.circle.radius - 0.5 * minDist) * invDist;
							$r = rev?arb.injectContact(s1.circle.worldCOMx + px * df,s1.circle.worldCOMy + py * df,-px * invDist,-py * invDist,dist - minDist,0):arb.injectContact(s1.circle.worldCOMx + px * df,s1.circle.worldCOMy + py * df,px * invDist,py * invDist,dist - minDist,0);
							return $r;
						}($this));
						return $r;
					}(this));
					if(co != null) {
						var con = co.inner;
						arb.ptype = 2;
						var vx = 0.0;
						var vy = 0.0;
						vx = v0.x - s2.polygon.body.posx;
						vy = v0.y - s2.polygon.body.posy;
						arb.__ref_edge1 = a0;
						arb.__ref_vertex = -1;
						if(rev) {
							con.lr1x = vx * s2.polygon.body.axisy + vy * s2.polygon.body.axisx;
							con.lr1y = vy * s2.polygon.body.axisy - vx * s2.polygon.body.axisx;
							con.lr2x = s1.circle.localCOMx;
							con.lr2y = s1.circle.localCOMy;
						} else {
							con.lr2x = vx * s2.polygon.body.axisy + vy * s2.polygon.body.axisx;
							con.lr2y = vy * s2.polygon.body.axisy - vx * s2.polygon.body.axisx;
							con.lr1x = s1.circle.localCOMx;
							con.lr1y = s1.circle.localCOMy;
						}
						arb.radius = s1.circle.radius;
					}
					return co != null;
				} else if(dt >= v1.y * a0.gnormx - v1.x * a0.gnormy) {
					var co = (function($this) {
						var $r;
						var minDist = s1.circle.radius + 0;
						var px = 0.0;
						var py = 0.0;
						{
							px = v1.x - s1.circle.worldCOMx;
							py = v1.y - s1.circle.worldCOMy;
						}
						var distSqr = px * px + py * py;
						$r = distSqr > minDist * minDist?null:distSqr < nape.Config.epsilon * nape.Config.epsilon?arb.injectContact(s1.circle.worldCOMx,s1.circle.worldCOMy,1,0,-minDist,0):(function($this) {
							var $r;
							var invDist = zpp_nape.util.ZPP_Math.invsqrt(distSqr);
							var dist = invDist < nape.Config.epsilon?1e100:1.0 / invDist;
							var df = 0.5 + (s1.circle.radius - 0.5 * minDist) * invDist;
							$r = rev?arb.injectContact(s1.circle.worldCOMx + px * df,s1.circle.worldCOMy + py * df,-px * invDist,-py * invDist,dist - minDist,0):arb.injectContact(s1.circle.worldCOMx + px * df,s1.circle.worldCOMy + py * df,px * invDist,py * invDist,dist - minDist,0);
							return $r;
						}($this));
						return $r;
					}(this));
					if(co != null) {
						var con = co.inner;
						arb.ptype = 2;
						var vx = 0.0;
						var vy = 0.0;
						vx = v1.x - s2.polygon.body.posx;
						vy = v1.y - s2.polygon.body.posy;
						arb.__ref_edge1 = a0;
						arb.__ref_vertex = 1;
						if(rev) {
							con.lr1x = vx * s2.polygon.body.axisy + vy * s2.polygon.body.axisx;
							con.lr1y = vy * s2.polygon.body.axisy - vx * s2.polygon.body.axisx;
							con.lr2x = s1.circle.localCOMx;
							con.lr2y = s1.circle.localCOMy;
						} else {
							con.lr2x = vx * s2.polygon.body.axisy + vy * s2.polygon.body.axisx;
							con.lr2y = vy * s2.polygon.body.axisy - vx * s2.polygon.body.axisx;
							con.lr1x = s1.circle.localCOMx;
							con.lr1y = s1.circle.localCOMy;
						}
						arb.radius = s1.circle.radius;
					}
					return co != null;
				} else {
					var nx = 0.0;
					var ny = 0.0;
					var t = s1.circle.radius + max * 0.5;
					nx = a0.gnormx * t;
					ny = a0.gnormy * t;
					var px = 0.0;
					var py = 0.0;
					px = s1.circle.worldCOMx - nx;
					py = s1.circle.worldCOMy - ny;
					var con = rev?arb.injectContact(px,py,a0.gnormx,a0.gnormy,max,0):arb.injectContact(px,py,-a0.gnormx,-a0.gnormy,max,0);
					arb.ptype = rev?0:1;
					arb.lnormx = a0.lnormx;
					arb.lnormy = a0.lnormy;
					arb.rev = !rev;
					arb.lproj = a0.lprojection;
					arb.radius = s1.circle.radius;
					con.inner.lr1x = s1.circle.localCOMx;
					con.inner.lr1y = s1.circle.localCOMy;
					arb.__ref_edge1 = a0;
					arb.__ref_vertex = 0;
					return true;
				}
			} else return false;
		}
	} else {
		var co = (function($this) {
			var $r;
			var minDist = s1.circle.radius + s2.circle.radius;
			var px = 0.0;
			var py = 0.0;
			{
				px = s2.circle.worldCOMx - s1.circle.worldCOMx;
				py = s2.circle.worldCOMy - s1.circle.worldCOMy;
			}
			var distSqr = px * px + py * py;
			$r = distSqr > minDist * minDist?null:distSqr < nape.Config.epsilon * nape.Config.epsilon?arb.injectContact(s1.circle.worldCOMx,s1.circle.worldCOMy,1,0,-minDist,0):(function($this) {
				var $r;
				var invDist = zpp_nape.util.ZPP_Math.invsqrt(distSqr);
				var dist = invDist < nape.Config.epsilon?1e100:1.0 / invDist;
				var df = 0.5 + (s1.circle.radius - 0.5 * minDist) * invDist;
				$r = rev?arb.injectContact(s1.circle.worldCOMx + px * df,s1.circle.worldCOMy + py * df,-px * invDist,-py * invDist,dist - minDist,0):arb.injectContact(s1.circle.worldCOMx + px * df,s1.circle.worldCOMy + py * df,px * invDist,py * invDist,dist - minDist,0);
				return $r;
			}($this));
			return $r;
		}(this));
		if(co != null) {
			var con = co.inner;
			if(rev) {
				con.lr1x = s2.circle.localCOMx;
				con.lr1y = s2.circle.localCOMy;
				con.lr2x = s1.circle.localCOMx;
				con.lr2y = s1.circle.localCOMy;
			} else {
				con.lr1x = s1.circle.localCOMx;
				con.lr1y = s1.circle.localCOMy;
				con.lr2x = s2.circle.localCOMx;
				con.lr2y = s2.circle.localCOMy;
			}
			arb.radius = s1.circle.radius + s2.circle.radius;
			arb.ptype = 2;
			return true;
		} else return false;
	}
}
zpp_nape.geom.ZPP_Collide.testCollide_safe = function(s1,s2) {
	if(s2.isCircle()) {
		var t = s1;
		s1 = s2;
		s2 = t;
	}
	return zpp_nape.geom.ZPP_Collide.testCollide(s1,s2);
}
zpp_nape.geom.ZPP_Collide.testCollide = function(s1,s2) {
	if(s2.isPolygon()) return s1.isPolygon()?(function($this) {
		var $r;
		var cont = true;
		{
			var cx_ite = s1.polygon.edges.begin();
			while(cx_ite != null) {
				var ax = cx_ite.elem();
				var min = 1e100;
				var cx_ite1 = s2.polygon.gverts.begin();
				while(cx_ite1 != null) {
					var v = cx_ite1.elem();
					var k = ax.gnormx * v.x + ax.gnormy * v.y;
					if(k < min) min = k;
					cx_ite1 = cx_ite1.next;
				}
				min -= ax.gprojection;
				if(min > 0) {
					cont = false;
					break;
				}
				cx_ite = cx_ite.next;
			}
		}
		$r = cont?(function($this) {
			var $r;
			{
				var cx_ite = s2.polygon.edges.begin();
				while(cx_ite != null) {
					var ax = cx_ite.elem();
					var min = 1e100;
					var cx_ite1 = s1.polygon.gverts.begin();
					while(cx_ite1 != null) {
						var v = cx_ite1.elem();
						var k = ax.gnormx * v.x + ax.gnormy * v.y;
						if(k < min) min = k;
						cx_ite1 = cx_ite1.next;
					}
					min -= ax.gprojection;
					if(min > 0) {
						cont = false;
						break;
					}
					cx_ite = cx_ite.next;
				}
			}
			$r = cont;
			return $r;
		}($this)):false;
		return $r;
	}(this)):(function($this) {
		var $r;
		var a0 = null, vi = null;
		var cont = true;
		var max = -1e100;
		var vite = s2.polygon.gverts.begin();
		{
			var cx_ite = s2.polygon.edges.begin();
			while(cx_ite != null) {
				var a = cx_ite.elem();
				var dist = a.gnormx * s1.circle.worldCOMx + a.gnormy * s1.circle.worldCOMy - a.gprojection - s1.circle.radius;
				if(dist > 0) {
					cont = false;
					break;
				}
				if(dist > max) {
					max = dist;
					a0 = a;
					vi = vite;
				}
				vite = vite.next;
				cx_ite = cx_ite.next;
			}
		}
		$r = cont?(function($this) {
			var $r;
			var v0 = vi.elem();
			var v1 = vi.next == null?s2.polygon.gverts.front():vi.next.elem();
			var dt = s1.circle.worldCOMy * a0.gnormx - s1.circle.worldCOMx * a0.gnormy;
			$r = dt <= v0.y * a0.gnormx - v0.x * a0.gnormy?(function($this) {
				var $r;
				var minDist = s1.circle.radius + 0;
				var px = 0.0;
				var py = 0.0;
				{
					px = v0.x - s1.circle.worldCOMx;
					py = v0.y - s1.circle.worldCOMy;
				}
				var distSqr = px * px + py * py;
				$r = distSqr <= minDist * minDist;
				return $r;
			}($this)):dt >= v1.y * a0.gnormx - v1.x * a0.gnormy?(function($this) {
				var $r;
				var minDist = s1.circle.radius + 0;
				var px = 0.0;
				var py = 0.0;
				{
					px = v1.x - s1.circle.worldCOMx;
					py = v1.y - s1.circle.worldCOMy;
				}
				var distSqr = px * px + py * py;
				$r = distSqr <= minDist * minDist;
				return $r;
			}($this)):true;
			return $r;
		}($this)):false;
		return $r;
	}(this)); else return (function($this) {
		var $r;
		var minDist = s1.circle.radius + s2.circle.radius;
		var px = 0.0;
		var py = 0.0;
		{
			px = s2.circle.worldCOMx - s1.circle.worldCOMx;
			py = s2.circle.worldCOMy - s1.circle.worldCOMy;
		}
		var distSqr = px * px + py * py;
		$r = distSqr <= minDist * minDist;
		return $r;
	}(this));
}
zpp_nape.geom.ZPP_Collide.flowCollide = function(s1,s2,arb) {
	if(s2.isPolygon()) return s1.isPolygon()?(function($this) {
		var $r;
		var out1 = new Array();
		var out2 = new Array();
		var cont = true;
		var total = true;
		{
			var cx_ite = s1.polygon.edges.begin();
			while(cx_ite != null) {
				var ax = cx_ite.elem();
				var min = 1e100;
				var ind = 0;
				var cx_ite1 = s2.polygon.gverts.begin();
				while(cx_ite1 != null) {
					var v = cx_ite1.elem();
					var k = ax.gnormx * v.x + ax.gnormy * v.y;
					if(k < min) min = k;
					if(k >= ax.gprojection + nape.Config.epsilon) {
						out2[ind] = true;
						total = false;
					}
					ind++;
					cx_ite1 = cx_ite1.next;
				}
				min -= ax.gprojection;
				if(min > 0) {
					cont = false;
					break;
				}
				cx_ite = cx_ite.next;
			}
		}
		$r = total?(function($this) {
			var $r;
			s2.polygon.validate_worldCOM();
			arb.inject(s2.polygon.area,s2.polygon.worldCOMx,s2.polygon.worldCOMy);
			$r = true;
			return $r;
		}($this)):cont?(function($this) {
			var $r;
			total = true;
			{
				var cx_ite = s2.polygon.edges.begin();
				while(cx_ite != null) {
					var ax = cx_ite.elem();
					var min = 1e100;
					var ind = 0;
					var cx_ite1 = s1.polygon.gverts.begin();
					while(cx_ite1 != null) {
						var v = cx_ite1.elem();
						var k = ax.gnormx * v.x + ax.gnormy * v.y;
						if(k < min) min = k;
						if(k >= ax.gprojection + nape.Config.epsilon) {
							out1[ind] = true;
							total = false;
						}
						ind++;
						cx_ite1 = cx_ite1.next;
					}
					min -= ax.gprojection;
					if(min > 0) {
						cont = false;
						break;
					}
					cx_ite = cx_ite.next;
				}
			}
			$r = total?(function($this) {
				var $r;
				s1.polygon.validate_worldCOM();
				arb.inject(s1.polygon.area,s1.polygon.worldCOMx,s1.polygon.worldCOMy);
				$r = true;
				return $r;
			}($this)):cont?(function($this) {
				var $r;
				while(!zpp_nape.geom.ZPP_Collide.flowpoly.empty()) {
					var p = zpp_nape.geom.ZPP_Collide.flowpoly.pop_unsafe();
					if(!p._inuse) {
						var o = p;
						o.free();
						o.next = zpp_nape.geom.ZPP_Vec2.zpp_pool;
						zpp_nape.geom.ZPP_Vec2.zpp_pool = o;
					}
				}
				var fst_vert = null;
				var poly1 = false;
				var ite1 = s1.polygon.gverts.begin();
				var ind1 = 0;
				var ite2 = s2.polygon.gverts.begin();
				var ind2 = 0;
				{
					var _g1 = 0, _g = s2.polygon.edgeCnt;
					while(_g1 < _g) {
						var i = _g1++;
						if(!out2[i]) {
							ind2 = i;
							break;
						} else ite2 = ite2.next;
					}
				}
				if(ite2 == null) {
					ite2 = s2.polygon.gverts.begin();
					poly1 = true;
					var _g1 = 0, _g = s1.polygon.edgeCnt;
					while(_g1 < _g) {
						var i = _g1++;
						if(!out1[i]) {
							ind1 = i;
							break;
						} else ite1 = ite1.next;
					}
					if(ite1 == null) ite1 = s1.polygon.gverts.begin(); else {
						zpp_nape.geom.ZPP_Collide.flowpoly.add(ite1.elem());
						fst_vert = zpp_nape.geom.ZPP_Collide.flowpoly.front();
					}
				} else {
					zpp_nape.geom.ZPP_Collide.flowpoly.add(ite2.elem());
					fst_vert = zpp_nape.geom.ZPP_Collide.flowpoly.front();
				}
				var cnt = 1;
				if(zpp_nape.geom.ZPP_Collide.flowpoly.empty()) {
					var cx_cont = true;
					var cx_itei = s1.polygon.gverts.begin();
					var u = cx_itei.elem();
					var cx_itej = cx_itei.next;
					while(cx_itej != null) {
						var v = cx_itej.elem();
						var min = 2.0;
						var cx_cont1 = true;
						var cx_itei1 = s2.polygon.gverts.begin();
						var a = cx_itei1.elem();
						var cx_itej1 = cx_itei1.next;
						while(cx_itej1 != null) {
							var b = cx_itej1.elem();
							var t = 0.0;
							if((function($this) {
								var $r;
								var _sx = 0.0;
								var _sy = 0.0;
								{
									_sx = u.x - a.x;
									_sy = u.y - a.y;
								}
								var _vx = 0.0;
								var _vy = 0.0;
								{
									_vx = v.x - u.x;
									_vy = v.y - u.y;
								}
								var _qx = 0.0;
								var _qy = 0.0;
								{
									_qx = b.x - a.x;
									_qy = b.y - a.y;
								}
								var den = _vy * _qx - _vx * _qy;
								$r = den * den > nape.Config.epsilon * nape.Config.epsilon?(function($this) {
									var $r;
									den = 1 / den;
									var txx = (_qy * _sx - _qx * _sy) * den;
									$r = txx > nape.Config.epsilon && txx < 1 - nape.Config.epsilon?(function($this) {
										var $r;
										var sxx = (_vy * _sx - _vx * _sy) * den;
										$r = sxx > nape.Config.epsilon && sxx < 1 - nape.Config.epsilon?(function($this) {
											var $r;
											t = txx;
											$r = true;
											return $r;
										}($this)):false;
										return $r;
									}($this)):false;
									return $r;
								}($this)):false;
								return $r;
							}($this))) {
								if(t < min) {
									min = t;
									ite2 = cx_itei1;
								}
							}
							cx_itei1 = cx_itej1;
							a = b;
							cx_itej1 = cx_itej1.next;
						}
						if(cx_cont1) do {
							cx_itej1 = s2.polygon.gverts.begin();
							var b = cx_itej1.elem();
							var t = 0.0;
							if((function($this) {
								var $r;
								var _sx = 0.0;
								var _sy = 0.0;
								{
									_sx = u.x - a.x;
									_sy = u.y - a.y;
								}
								var _vx = 0.0;
								var _vy = 0.0;
								{
									_vx = v.x - u.x;
									_vy = v.y - u.y;
								}
								var _qx = 0.0;
								var _qy = 0.0;
								{
									_qx = b.x - a.x;
									_qy = b.y - a.y;
								}
								var den = _vy * _qx - _vx * _qy;
								$r = den * den > nape.Config.epsilon * nape.Config.epsilon?(function($this) {
									var $r;
									den = 1 / den;
									var txx = (_qy * _sx - _qx * _sy) * den;
									$r = txx > nape.Config.epsilon && txx < 1 - nape.Config.epsilon?(function($this) {
										var $r;
										var sxx = (_vy * _sx - _vx * _sy) * den;
										$r = sxx > nape.Config.epsilon && sxx < 1 - nape.Config.epsilon?(function($this) {
											var $r;
											t = txx;
											$r = true;
											return $r;
										}($this)):false;
										return $r;
									}($this)):false;
									return $r;
								}($this)):false;
								return $r;
							}($this))) {
								if(t < min) {
									min = t;
									ite2 = cx_itei1;
								}
							}
						} while(false);
						if(min != 2.0) {
							var cx = 0.0;
							var cy = 0.0;
							var T = min;
							cx = u.x + (v.x - u.x) * T;
							cy = u.y + (v.y - u.y) * T;
							fst_vert = zpp_nape.geom.ZPP_Vec2.get(cx,cy);
							zpp_nape.geom.ZPP_Collide.flowpoly.add(fst_vert);
							poly1 = true;
							ite1 = cx_itei;
							cx_cont = false;
							break;
						}
						cx_itei = cx_itej;
						u = v;
						cx_itej = cx_itej.next;
					}
					if(cx_cont) do {
						cx_itej = s1.polygon.gverts.begin();
						var v = cx_itej.elem();
						var min = 2.0;
						var cx_cont1 = true;
						var cx_itei1 = s2.polygon.gverts.begin();
						var a = cx_itei1.elem();
						var cx_itej1 = cx_itei1.next;
						while(cx_itej1 != null) {
							var b = cx_itej1.elem();
							var t = 0.0;
							if((function($this) {
								var $r;
								var _sx = 0.0;
								var _sy = 0.0;
								{
									_sx = u.x - a.x;
									_sy = u.y - a.y;
								}
								var _vx = 0.0;
								var _vy = 0.0;
								{
									_vx = v.x - u.x;
									_vy = v.y - u.y;
								}
								var _qx = 0.0;
								var _qy = 0.0;
								{
									_qx = b.x - a.x;
									_qy = b.y - a.y;
								}
								var den = _vy * _qx - _vx * _qy;
								$r = den * den > nape.Config.epsilon * nape.Config.epsilon?(function($this) {
									var $r;
									den = 1 / den;
									var txx = (_qy * _sx - _qx * _sy) * den;
									$r = txx > nape.Config.epsilon && txx < 1 - nape.Config.epsilon?(function($this) {
										var $r;
										var sxx = (_vy * _sx - _vx * _sy) * den;
										$r = sxx > nape.Config.epsilon && sxx < 1 - nape.Config.epsilon?(function($this) {
											var $r;
											t = txx;
											$r = true;
											return $r;
										}($this)):false;
										return $r;
									}($this)):false;
									return $r;
								}($this)):false;
								return $r;
							}($this))) {
								if(t < min) {
									min = t;
									ite2 = cx_itei1;
								}
							}
							cx_itei1 = cx_itej1;
							a = b;
							cx_itej1 = cx_itej1.next;
						}
						if(cx_cont1) do {
							cx_itej1 = s2.polygon.gverts.begin();
							var b = cx_itej1.elem();
							var t = 0.0;
							if((function($this) {
								var $r;
								var _sx = 0.0;
								var _sy = 0.0;
								{
									_sx = u.x - a.x;
									_sy = u.y - a.y;
								}
								var _vx = 0.0;
								var _vy = 0.0;
								{
									_vx = v.x - u.x;
									_vy = v.y - u.y;
								}
								var _qx = 0.0;
								var _qy = 0.0;
								{
									_qx = b.x - a.x;
									_qy = b.y - a.y;
								}
								var den = _vy * _qx - _vx * _qy;
								$r = den * den > nape.Config.epsilon * nape.Config.epsilon?(function($this) {
									var $r;
									den = 1 / den;
									var txx = (_qy * _sx - _qx * _sy) * den;
									$r = txx > nape.Config.epsilon && txx < 1 - nape.Config.epsilon?(function($this) {
										var $r;
										var sxx = (_vy * _sx - _vx * _sy) * den;
										$r = sxx > nape.Config.epsilon && sxx < 1 - nape.Config.epsilon?(function($this) {
											var $r;
											t = txx;
											$r = true;
											return $r;
										}($this)):false;
										return $r;
									}($this)):false;
									return $r;
								}($this)):false;
								return $r;
							}($this))) {
								if(t < min) {
									min = t;
									ite2 = cx_itei1;
								}
							}
						} while(false);
						if(min != 2.0) {
							var cx = 0.0;
							var cy = 0.0;
							var T = min;
							cx = u.x + (v.x - u.x) * T;
							cy = u.y + (v.y - u.y) * T;
							fst_vert = zpp_nape.geom.ZPP_Vec2.get(cx,cy);
							zpp_nape.geom.ZPP_Collide.flowpoly.add(fst_vert);
							poly1 = true;
							ite1 = cx_itei;
							break;
						}
					} while(false);
					cnt = 2;
				}
				while(true) if(poly1) {
					ite1 = ite1.next;
					ind1++;
					if(ite1 == null) {
						ite1 = s1.polygon.gverts.begin();
						ind1 = 0;
					}
					if(!out1[ind1]) {
						var ex = ite1.elem();
						if(fst_vert != null && zpp_nape.geom.ZPP_VecMath.vec_dsq(ex.x,ex.y,fst_vert.x,fst_vert.y) < nape.Config.epsilon) break;
						zpp_nape.geom.ZPP_Collide.flowpoly.add(ex);
						if(fst_vert == null) fst_vert = zpp_nape.geom.ZPP_Collide.flowpoly.front();
						cnt = 1;
					} else {
						var a = zpp_nape.geom.ZPP_Collide.flowpoly.front();
						var b = ite1.elem();
						var u = ite2.elem();
						var itm = ite2.next;
						if(itm == null) itm = s2.polygon.gverts.begin();
						var max = -1.0;
						var itmo = null;
						var indo = 0;
						var icnt = 0;
						var beg_ite = itm;
						var cx_ite = itm;
						do {
							var v = cx_ite.elem();
							var t = 0.0;
							if((function($this) {
								var $r;
								var _sx = 0.0;
								var _sy = 0.0;
								{
									_sx = u.x - a.x;
									_sy = u.y - a.y;
								}
								var _vx = 0.0;
								var _vy = 0.0;
								{
									_vx = v.x - u.x;
									_vy = v.y - u.y;
								}
								var _qx = 0.0;
								var _qy = 0.0;
								{
									_qx = b.x - a.x;
									_qy = b.y - a.y;
								}
								var den = _vy * _qx - _vx * _qy;
								$r = den * den > nape.Config.epsilon * nape.Config.epsilon?(function($this) {
									var $r;
									den = 1 / den;
									var txx = (_qy * _sx - _qx * _sy) * den;
									$r = txx > nape.Config.epsilon && txx < 1 - nape.Config.epsilon?(function($this) {
										var $r;
										var sxx = (_vy * _sx - _vx * _sy) * den;
										$r = sxx > nape.Config.epsilon && sxx < 1 - nape.Config.epsilon?(function($this) {
											var $r;
											t = txx;
											$r = true;
											return $r;
										}($this)):false;
										return $r;
									}($this)):false;
									return $r;
								}($this)):false;
								return $r;
							}($this))) {
								if(t >= max) {
									itmo = ite2;
									indo = ind2;
									if(++icnt == cnt) {
										max = t;
										cx_ite = beg_ite;
										break;
									} else max = t;
								}
							}
							u = v;
							ite2 = cx_ite;
							ind2++;
							if(ind2 >= s2.polygon.edgeCnt) ind2 = 0;
							cx_ite = cx_ite.next;
							if(cx_ite == null) cx_ite = s2.polygon.gverts.begin();
						} while(false);
						while(cx_ite != beg_ite) {
							var v = cx_ite.elem();
							var t = 0.0;
							if((function($this) {
								var $r;
								var _sx = 0.0;
								var _sy = 0.0;
								{
									_sx = u.x - a.x;
									_sy = u.y - a.y;
								}
								var _vx = 0.0;
								var _vy = 0.0;
								{
									_vx = v.x - u.x;
									_vy = v.y - u.y;
								}
								var _qx = 0.0;
								var _qy = 0.0;
								{
									_qx = b.x - a.x;
									_qy = b.y - a.y;
								}
								var den = _vy * _qx - _vx * _qy;
								$r = den * den > nape.Config.epsilon * nape.Config.epsilon?(function($this) {
									var $r;
									den = 1 / den;
									var txx = (_qy * _sx - _qx * _sy) * den;
									$r = txx > nape.Config.epsilon && txx < 1 - nape.Config.epsilon?(function($this) {
										var $r;
										var sxx = (_vy * _sx - _vx * _sy) * den;
										$r = sxx > nape.Config.epsilon && sxx < 1 - nape.Config.epsilon?(function($this) {
											var $r;
											t = txx;
											$r = true;
											return $r;
										}($this)):false;
										return $r;
									}($this)):false;
									return $r;
								}($this)):false;
								return $r;
							}($this))) {
								if(t >= max) {
									itmo = ite2;
									indo = ind2;
									if(++icnt == cnt) {
										max = t;
										cx_ite = beg_ite;
										break;
									} else max = t;
								}
							}
							u = v;
							ite2 = cx_ite;
							ind2++;
							if(ind2 >= s2.polygon.edgeCnt) ind2 = 0;
							cx_ite = cx_ite.next;
							if(cx_ite == null) cx_ite = s2.polygon.gverts.begin();
						}
						if(itmo == null) break;
						var u1 = itmo.elem();
						var itm2 = itmo.next;
						if(itm2 == null) itm2 = s2.polygon.gverts.begin();
						var v = itm2.elem();
						var cx = 0.0;
						var cy = 0.0;
						var T = max;
						cx = u1.x + (v.x - u1.x) * T;
						cy = u1.y + (v.y - u1.y) * T;
						if(fst_vert != null && zpp_nape.geom.ZPP_VecMath.vec_dsq(cx,cy,fst_vert.x,fst_vert.y) < nape.Config.epsilon) break;
						zpp_nape.geom.ZPP_Collide.flowpoly.add(zpp_nape.geom.ZPP_Vec2.get(cx,cy));
						if(fst_vert == null) fst_vert = zpp_nape.geom.ZPP_Collide.flowpoly.front();
						ite2 = itmo;
						ind2 = indo;
						poly1 = !poly1;
						cnt = 2;
					}
				} else {
					ite2 = ite2.next;
					ind2++;
					if(ite2 == null) {
						ite2 = s2.polygon.gverts.begin();
						ind2 = 0;
					}
					if(!out2[ind2]) {
						var ex = ite2.elem();
						if(fst_vert != null && zpp_nape.geom.ZPP_VecMath.vec_dsq(ex.x,ex.y,fst_vert.x,fst_vert.y) < nape.Config.epsilon) break;
						zpp_nape.geom.ZPP_Collide.flowpoly.add(ex);
						if(fst_vert == null) fst_vert = zpp_nape.geom.ZPP_Collide.flowpoly.front();
						cnt = 1;
					} else {
						var a = zpp_nape.geom.ZPP_Collide.flowpoly.front();
						var b = ite2.elem();
						var u = ite1.elem();
						var itm = ite1.next;
						if(itm == null) itm = s1.polygon.gverts.begin();
						var max = -1.0;
						var itmo = null;
						var indo = 0;
						var icnt = 0;
						var beg_ite = itm;
						var cx_ite = itm;
						do {
							var v = cx_ite.elem();
							var t = 0.0;
							if((function($this) {
								var $r;
								var _sx = 0.0;
								var _sy = 0.0;
								{
									_sx = u.x - a.x;
									_sy = u.y - a.y;
								}
								var _vx = 0.0;
								var _vy = 0.0;
								{
									_vx = v.x - u.x;
									_vy = v.y - u.y;
								}
								var _qx = 0.0;
								var _qy = 0.0;
								{
									_qx = b.x - a.x;
									_qy = b.y - a.y;
								}
								var den = _vy * _qx - _vx * _qy;
								$r = den * den > nape.Config.epsilon * nape.Config.epsilon?(function($this) {
									var $r;
									den = 1 / den;
									var txx = (_qy * _sx - _qx * _sy) * den;
									$r = txx > nape.Config.epsilon && txx < 1 - nape.Config.epsilon?(function($this) {
										var $r;
										var sxx = (_vy * _sx - _vx * _sy) * den;
										$r = sxx > nape.Config.epsilon && sxx < 1 - nape.Config.epsilon?(function($this) {
											var $r;
											t = txx;
											$r = true;
											return $r;
										}($this)):false;
										return $r;
									}($this)):false;
									return $r;
								}($this)):false;
								return $r;
							}($this))) {
								if(t >= max) {
									itmo = ite1;
									indo = ind1;
									if(++icnt == cnt) {
										max = t;
										cx_ite = beg_ite;
										break;
									} else max = t;
								}
							}
							u = v;
							ite1 = cx_ite;
							ind1++;
							if(ind1 >= s1.polygon.edgeCnt) ind1 = 0;
							cx_ite = cx_ite.next;
							if(cx_ite == null) cx_ite = s1.polygon.gverts.begin();
						} while(false);
						while(cx_ite != beg_ite) {
							var v = cx_ite.elem();
							var t = 0.0;
							if((function($this) {
								var $r;
								var _sx = 0.0;
								var _sy = 0.0;
								{
									_sx = u.x - a.x;
									_sy = u.y - a.y;
								}
								var _vx = 0.0;
								var _vy = 0.0;
								{
									_vx = v.x - u.x;
									_vy = v.y - u.y;
								}
								var _qx = 0.0;
								var _qy = 0.0;
								{
									_qx = b.x - a.x;
									_qy = b.y - a.y;
								}
								var den = _vy * _qx - _vx * _qy;
								$r = den * den > nape.Config.epsilon * nape.Config.epsilon?(function($this) {
									var $r;
									den = 1 / den;
									var txx = (_qy * _sx - _qx * _sy) * den;
									$r = txx > nape.Config.epsilon && txx < 1 - nape.Config.epsilon?(function($this) {
										var $r;
										var sxx = (_vy * _sx - _vx * _sy) * den;
										$r = sxx > nape.Config.epsilon && sxx < 1 - nape.Config.epsilon?(function($this) {
											var $r;
											t = txx;
											$r = true;
											return $r;
										}($this)):false;
										return $r;
									}($this)):false;
									return $r;
								}($this)):false;
								return $r;
							}($this))) {
								if(t >= max) {
									itmo = ite1;
									indo = ind1;
									if(++icnt == cnt) {
										max = t;
										cx_ite = beg_ite;
										break;
									} else max = t;
								}
							}
							u = v;
							ite1 = cx_ite;
							ind1++;
							if(ind1 >= s1.polygon.edgeCnt) ind1 = 0;
							cx_ite = cx_ite.next;
							if(cx_ite == null) cx_ite = s1.polygon.gverts.begin();
						}
						if(itmo == null) break;
						var u1 = itmo.elem();
						var itm2 = itmo.next;
						if(itm2 == null) itm2 = s1.polygon.gverts.begin();
						var v = itm2.elem();
						var cx = 0.0;
						var cy = 0.0;
						var T = max;
						cx = u1.x + (v.x - u1.x) * T;
						cy = u1.y + (v.y - u1.y) * T;
						if(fst_vert != null && zpp_nape.geom.ZPP_VecMath.vec_dsq(cx,cy,fst_vert.x,fst_vert.y) < nape.Config.epsilon) break;
						zpp_nape.geom.ZPP_Collide.flowpoly.add(zpp_nape.geom.ZPP_Vec2.get(cx,cy));
						if(fst_vert == null) fst_vert = zpp_nape.geom.ZPP_Collide.flowpoly.front();
						ite1 = itmo;
						ind1 = indo;
						poly1 = !poly1;
						cnt = 2;
					}
				}
				$r = zpp_nape.geom.ZPP_Collide.flowpoly.begin() != null && zpp_nape.geom.ZPP_Collide.flowpoly.begin().next != null && zpp_nape.geom.ZPP_Collide.flowpoly.begin().next.next != null?(function($this) {
					var $r;
					var area = 0.0;
					var COMx = 0.0;
					var COMy = 0.0;
					{
						COMx = 0;
						COMy = 0;
						area = 0.0;
						var cx_ite = zpp_nape.geom.ZPP_Collide.flowpoly.begin();
						var u = cx_ite.elem();
						cx_ite = cx_ite.next;
						var v = cx_ite.elem();
						cx_ite = cx_ite.next;
						while(cx_ite != null) {
							var w = cx_ite.elem();
							area += v.x * (w.y - u.y);
							var cf = w.y * v.x - w.x * v.y;
							COMx += (v.x + w.x) * cf;
							COMy += (v.y + w.y) * cf;
							u = v;
							v = w;
							cx_ite = cx_ite.next;
						}
						cx_ite = zpp_nape.geom.ZPP_Collide.flowpoly.begin();
						var w = cx_ite.elem();
						area += v.x * (w.y - u.y);
						var cf = w.y * v.x - w.x * v.y;
						COMx += (v.x + w.x) * cf;
						COMy += (v.y + w.y) * cf;
						u = v;
						v = w;
						cx_ite = cx_ite.next;
						var w1 = cx_ite.elem();
						area += v.x * (w1.y - u.y);
						var cf = w1.y * v.x - w1.x * v.y;
						COMx += (v.x + w1.x) * cf;
						COMy += (v.y + w1.y) * cf;
						area *= 0.5;
						var ia = 1 / (6 * area);
						var t = ia;
						COMx *= t;
						COMy *= t;
					}
					arb.inject(-area,COMx,COMy);
					$r = true;
					return $r;
				}($this)):false;
				return $r;
			}($this)):false;
			return $r;
		}($this)):false;
		return $r;
	}(this)):(function($this) {
		var $r;
		var inte = new Array();
		var total = true;
		var a0 = null, vi = null;
		var max = -1e100;
		var cont = true;
		var vite = s2.polygon.gverts.begin();
		var ind = 0;
		{
			var cx_ite = s2.polygon.edges.begin();
			while(cx_ite != null) {
				var a = cx_ite.elem();
				var dist = a.gnormx * s1.circle.worldCOMx + a.gnormy * s1.circle.worldCOMy;
				if(dist > a.gprojection + s1.circle.radius) {
					cont = false;
					break;
				} else if(dist + s1.circle.radius > a.gprojection + nape.Config.epsilon) {
					total = false;
					inte[ind] = true;
				}
				dist -= a.gprojection + s1.circle.radius;
				if(dist > max) {
					max = dist;
					a0 = a;
					vi = vite;
				}
				vite = vite.next;
				ind++;
				cx_ite = cx_ite.next;
			}
		}
		$r = cont?total?(function($this) {
			var $r;
			arb.inject(s1.circle.area,s1.circle.worldCOMx,s1.circle.worldCOMy);
			$r = true;
			return $r;
		}($this)):(function($this) {
			var $r;
			var v0 = vi.elem();
			var v1 = vi.next == null?s2.polygon.gverts.front():vi.next.elem();
			var dt = s1.circle.worldCOMy * a0.gnormx - s1.circle.worldCOMx * a0.gnormy;
			$r = dt <= v0.y * a0.gnormx - v0.x * a0.gnormy?(function($this) {
				var $r;
				var minDist = s1.circle.radius + 0;
				var px = 0.0;
				var py = 0.0;
				{
					px = v0.x - s1.circle.worldCOMx;
					py = v0.y - s1.circle.worldCOMy;
				}
				var distSqr = px * px + py * py;
				$r = distSqr <= minDist * minDist;
				return $r;
			}($this)):dt >= v1.y * a0.gnormx - v1.x * a0.gnormy?(function($this) {
				var $r;
				var minDist = s1.circle.radius + 0;
				var px = 0.0;
				var py = 0.0;
				{
					px = v1.x - s1.circle.worldCOMx;
					py = v1.y - s1.circle.worldCOMy;
				}
				var distSqr = px * px + py * py;
				$r = distSqr <= minDist * minDist;
				return $r;
			}($this)):true?(function($this) {
				var $r;
				var ins = new Array();
				var ind1 = 0;
				var total1 = true;
				var vi1 = null;
				var vind = 0;
				{
					var cx_ite = s2.polygon.gverts.begin();
					while(cx_ite != null) {
						var v = cx_ite.elem();
						var dist = zpp_nape.geom.ZPP_VecMath.vec_dsq(v.x,v.y,s1.circle.worldCOMx,s1.circle.worldCOMy);
						if(!(ins[ind1] = dist <= s1.circle.radius * s1.circle.radius)) total1 = false; else {
							vind = ind1;
							vi1 = cx_ite;
						}
						ind1++;
						cx_ite = cx_ite.next;
					}
				}
				$r = total1?(function($this) {
					var $r;
					s2.polygon.validate_worldCOM();
					arb.inject(s2.polygon.area,s2.polygon.worldCOMx,s2.polygon.worldCOMy);
					$r = true;
					return $r;
				}($this)):(function($this) {
					var $r;
					while(!zpp_nape.geom.ZPP_Collide.flowpoly.empty()) {
						var p = zpp_nape.geom.ZPP_Collide.flowpoly.pop_unsafe();
						if(!p._inuse) {
							var o = p;
							o.free();
							o.next = zpp_nape.geom.ZPP_Vec2.zpp_pool;
							zpp_nape.geom.ZPP_Vec2.zpp_pool = o;
						}
					}
					zpp_nape.geom.ZPP_Collide.flowsegs.clear();
					var fst_vert = null;
					var state = 1;
					if(vi1 == null) {
						vi1 = s2.polygon.gverts.begin();
						state = 2;
					} else zpp_nape.geom.ZPP_Collide.flowpoly.add(fst_vert = vi1.elem());
					while(state != 0) if(state == 1) {
						vi1 = vi1.next;
						if(vi1 == null) vi1 = s2.polygon.gverts.begin();
						vind++;
						if(vind >= s2.polygon.edgeCnt) vind = 0;
						if(ins[vind]) {
							if(zpp_nape.geom.ZPP_VecMath.vec_dsq(fst_vert.x,fst_vert.y,vi1.elem().x,vi1.elem().y) < nape.Config.epsilon) break;
							zpp_nape.geom.ZPP_Collide.flowpoly.add(vi1.elem());
						} else {
							var u = zpp_nape.geom.ZPP_Collide.flowpoly.front();
							var v = vi1.elem();
							var tval = (function($this) {
								var $r;
								var vx = 0.0;
								var vy = 0.0;
								{
									vx = v.x - u.x;
									vy = v.y - u.y;
								}
								var qx = 0.0;
								var qy = 0.0;
								{
									qx = u.x - s1.circle.worldCOMx;
									qy = u.y - s1.circle.worldCOMy;
								}
								var A = vx * vx + vy * vy;
								var B = 2 * (qx * vx + qy * vy);
								var C = qx * qx + qy * qy - s1.circle.radius * s1.circle.radius;
								var D = Math.sqrt(B * B - 4 * A * C);
								A = 1 / (2 * A);
								var t = (-B - D) * A;
								$r = t < nape.Config.epsilon?(-B + D) * A:t;
								return $r;
							}($this));
							var cx = 0.0;
							var cy = 0.0;
							var T = tval;
							cx = u.x + (v.x - u.x) * T;
							cy = u.y + (v.y - u.y) * T;
							if(zpp_nape.geom.ZPP_VecMath.vec_dsq(fst_vert.x,fst_vert.y,cx,cy) < nape.Config.epsilon) break;
							zpp_nape.geom.ZPP_Collide.flowpoly.add(zpp_nape.geom.ZPP_Vec2.get(cx,cy));
							state = 2;
						}
					} else if(state == 2) {
						var vi2 = vi1.next;
						if(vi2 == null) vi2 = s2.polygon.gverts.begin();
						var u = vi1.elem();
						state = 0;
						var beg_ite = vi2;
						var cx_ite = vi2;
						do {
							var v = cx_ite.elem();
							var vind2 = vind + 1;
							if(vind2 == s2.polygon.edgeCnt) vind2 = 0;
							if(inte[vind]) {
								if(ins[vind2]) {
									var tval = (function($this) {
										var $r;
										var vx = 0.0;
										var vy = 0.0;
										{
											vx = v.x - u.x;
											vy = v.y - u.y;
										}
										var qx = 0.0;
										var qy = 0.0;
										{
											qx = u.x - s1.circle.worldCOMx;
											qy = u.y - s1.circle.worldCOMy;
										}
										var A = vx * vx + vy * vy;
										var B = 2 * (qx * vx + qy * vy);
										var C = qx * qx + qy * qy - s1.circle.radius * s1.circle.radius;
										var D = Math.sqrt(B * B - 4 * A * C);
										A = 1 / (2 * A);
										var t = (-B - D) * A;
										$r = t < nape.Config.epsilon?(-B + D) * A:t;
										return $r;
									}($this));
									var cx = 0.0;
									var cy = 0.0;
									var T = tval;
									cx = u.x + (v.x - u.x) * T;
									cy = u.y + (v.y - u.y) * T;
									if(zpp_nape.geom.ZPP_VecMath.vec_dsq(fst_vert.x,fst_vert.y,cx,cy) < nape.Config.epsilon) {
										state = 0;
										cx_ite = beg_ite;
										break;
									}
									var cp = zpp_nape.geom.ZPP_Vec2.get(cx,cy);
									zpp_nape.geom.ZPP_Collide.flowsegs.add(zpp_nape.geom.ZPP_Collide.flowpoly.front());
									zpp_nape.geom.ZPP_Collide.flowsegs.add(cp);
									zpp_nape.geom.ZPP_Collide.flowpoly.add(cp);
									state = 1;
									cx_ite = beg_ite;
									break;
								} else {
									var t0 = 0.0;
									var t1 = 0.0;
									var two = (function($this) {
										var $r;
										var vx = 0.0;
										var vy = 0.0;
										{
											vx = v.x - u.x;
											vy = v.y - u.y;
										}
										var qx = 0.0;
										var qy = 0.0;
										{
											qx = u.x - s1.circle.worldCOMx;
											qy = u.y - s1.circle.worldCOMy;
										}
										var A = vx * vx + vy * vy;
										var B = 2 * (qx * vx + qy * vy);
										var C = qx * qx + qy * qy - s1.circle.radius * s1.circle.radius;
										var D = B * B - 4 * A * C;
										$r = D * D < nape.Config.epsilon?(function($this) {
											var $r;
											if(D < 0) t0 = 10.0; else t0 = t1 = -B / (2 * A);
											$r = false;
											return $r;
										}($this)):(function($this) {
											var $r;
											D = Math.sqrt(D);
											A = 1 / (2 * A);
											t0 = (-B - D) * A;
											t1 = (-B + D) * A;
											$r = true;
											return $r;
										}($this));
										return $r;
									}($this));
									if(t0 < 1 - nape.Config.epsilon && t1 > nape.Config.epsilon) {
										var cx = 0.0;
										var cy = 0.0;
										var T = t0;
										cx = u.x + (v.x - u.x) * T;
										cy = u.y + (v.y - u.y) * T;
										if(fst_vert != null && zpp_nape.geom.ZPP_VecMath.vec_dsq(fst_vert.x,fst_vert.y,cx,cy) < nape.Config.epsilon) {
											state = 0;
											cx_ite = beg_ite;
											break;
										}
										var cp = zpp_nape.geom.ZPP_Vec2.get(cx,cy);
										if(!zpp_nape.geom.ZPP_Collide.flowpoly.empty()) {
											zpp_nape.geom.ZPP_Collide.flowsegs.add(zpp_nape.geom.ZPP_Collide.flowpoly.front());
											zpp_nape.geom.ZPP_Collide.flowsegs.add(cp);
										}
										zpp_nape.geom.ZPP_Collide.flowpoly.add(cp);
										if(fst_vert == null) fst_vert = zpp_nape.geom.ZPP_Collide.flowpoly.front();
										if(two) {
											var cx1 = 0.0;
											var cy1 = 0.0;
											var T = t1;
											cx1 = u.x + (v.x - u.x) * T;
											cy1 = u.y + (v.y - u.y) * T;
											zpp_nape.geom.ZPP_Collide.flowpoly.add(zpp_nape.geom.ZPP_Vec2.get(cx1,cy1));
										}
									}
								}
							}
							u = v;
							vi1 = cx_ite;
							vind = vind2;
							cx_ite = cx_ite.next;
							if(cx_ite == null) cx_ite = s2.polygon.gverts.begin();
						} while(false);
						while(cx_ite != beg_ite) {
							var v = cx_ite.elem();
							var vind2 = vind + 1;
							if(vind2 == s2.polygon.edgeCnt) vind2 = 0;
							if(inte[vind]) {
								if(ins[vind2]) {
									var tval = (function($this) {
										var $r;
										var vx = 0.0;
										var vy = 0.0;
										{
											vx = v.x - u.x;
											vy = v.y - u.y;
										}
										var qx = 0.0;
										var qy = 0.0;
										{
											qx = u.x - s1.circle.worldCOMx;
											qy = u.y - s1.circle.worldCOMy;
										}
										var A = vx * vx + vy * vy;
										var B = 2 * (qx * vx + qy * vy);
										var C = qx * qx + qy * qy - s1.circle.radius * s1.circle.radius;
										var D = Math.sqrt(B * B - 4 * A * C);
										A = 1 / (2 * A);
										var t = (-B - D) * A;
										$r = t < nape.Config.epsilon?(-B + D) * A:t;
										return $r;
									}($this));
									var cx = 0.0;
									var cy = 0.0;
									var T = tval;
									cx = u.x + (v.x - u.x) * T;
									cy = u.y + (v.y - u.y) * T;
									if(zpp_nape.geom.ZPP_VecMath.vec_dsq(fst_vert.x,fst_vert.y,cx,cy) < nape.Config.epsilon) {
										state = 0;
										cx_ite = beg_ite;
										break;
									}
									var cp = zpp_nape.geom.ZPP_Vec2.get(cx,cy);
									zpp_nape.geom.ZPP_Collide.flowsegs.add(zpp_nape.geom.ZPP_Collide.flowpoly.front());
									zpp_nape.geom.ZPP_Collide.flowsegs.add(cp);
									zpp_nape.geom.ZPP_Collide.flowpoly.add(cp);
									state = 1;
									cx_ite = beg_ite;
									break;
								} else {
									var t0 = 0.0;
									var t1 = 0.0;
									var two = (function($this) {
										var $r;
										var vx = 0.0;
										var vy = 0.0;
										{
											vx = v.x - u.x;
											vy = v.y - u.y;
										}
										var qx = 0.0;
										var qy = 0.0;
										{
											qx = u.x - s1.circle.worldCOMx;
											qy = u.y - s1.circle.worldCOMy;
										}
										var A = vx * vx + vy * vy;
										var B = 2 * (qx * vx + qy * vy);
										var C = qx * qx + qy * qy - s1.circle.radius * s1.circle.radius;
										var D = B * B - 4 * A * C;
										$r = D * D < nape.Config.epsilon?(function($this) {
											var $r;
											if(D < 0) t0 = 10.0; else t0 = t1 = -B / (2 * A);
											$r = false;
											return $r;
										}($this)):(function($this) {
											var $r;
											D = Math.sqrt(D);
											A = 1 / (2 * A);
											t0 = (-B - D) * A;
											t1 = (-B + D) * A;
											$r = true;
											return $r;
										}($this));
										return $r;
									}($this));
									if(t0 < 1 - nape.Config.epsilon && t1 > nape.Config.epsilon) {
										var cx = 0.0;
										var cy = 0.0;
										var T = t0;
										cx = u.x + (v.x - u.x) * T;
										cy = u.y + (v.y - u.y) * T;
										if(fst_vert != null && zpp_nape.geom.ZPP_VecMath.vec_dsq(fst_vert.x,fst_vert.y,cx,cy) < nape.Config.epsilon) {
											state = 0;
											cx_ite = beg_ite;
											break;
										}
										var cp = zpp_nape.geom.ZPP_Vec2.get(cx,cy);
										if(!zpp_nape.geom.ZPP_Collide.flowpoly.empty()) {
											zpp_nape.geom.ZPP_Collide.flowsegs.add(zpp_nape.geom.ZPP_Collide.flowpoly.front());
											zpp_nape.geom.ZPP_Collide.flowsegs.add(cp);
										}
										zpp_nape.geom.ZPP_Collide.flowpoly.add(cp);
										if(fst_vert == null) fst_vert = zpp_nape.geom.ZPP_Collide.flowpoly.front();
										if(two) {
											var cx1 = 0.0;
											var cy1 = 0.0;
											var T = t1;
											cx1 = u.x + (v.x - u.x) * T;
											cy1 = u.y + (v.y - u.y) * T;
											zpp_nape.geom.ZPP_Collide.flowpoly.add(zpp_nape.geom.ZPP_Vec2.get(cx1,cy1));
										}
									}
								}
							}
							u = v;
							vi1 = cx_ite;
							vind = vind2;
							cx_ite = cx_ite.next;
							if(cx_ite == null) cx_ite = s2.polygon.gverts.begin();
						}
					}
					$r = zpp_nape.geom.ZPP_Collide.flowpoly.begin() == null?false:zpp_nape.geom.ZPP_Collide.flowpoly.begin().next == null?(function($this) {
						var $r;
						var all = true;
						{
							var cx_ite = s2.polygon.edges.begin();
							while(cx_ite != null) {
								var e = cx_ite.elem();
								var dist = e.gnormx * s1.circle.worldCOMx + e.gnormy * s1.circle.worldCOMy;
								if(dist > e.gprojection) {
									all = false;
									break;
								}
								cx_ite = cx_ite.next;
							}
						}
						$r = all?(function($this) {
							var $r;
							arb.inject(s1.circle.area,s1.circle.worldCOMx,s1.circle.worldCOMy);
							$r = true;
							return $r;
						}($this)):false;
						return $r;
					}($this)):(function($this) {
						var $r;
						var COMx = 0;
						var COMy = 0;
						{
						}
						{
						}
						var area = 0.0;
						if(zpp_nape.geom.ZPP_Collide.flowpoly.begin().next.next != null) {
							var parea = 0.0;
							var pCOMx = 0.0;
							var pCOMy = 0.0;
							pCOMx = 0;
							pCOMy = 0;
							parea = 0.0;
							var cx_ite = zpp_nape.geom.ZPP_Collide.flowpoly.begin();
							var u = cx_ite.elem();
							cx_ite = cx_ite.next;
							var v = cx_ite.elem();
							cx_ite = cx_ite.next;
							while(cx_ite != null) {
								var w = cx_ite.elem();
								parea += v.x * (w.y - u.y);
								var cf = w.y * v.x - w.x * v.y;
								pCOMx += (v.x + w.x) * cf;
								pCOMy += (v.y + w.y) * cf;
								u = v;
								v = w;
								cx_ite = cx_ite.next;
							}
							cx_ite = zpp_nape.geom.ZPP_Collide.flowpoly.begin();
							var w = cx_ite.elem();
							parea += v.x * (w.y - u.y);
							var cf = w.y * v.x - w.x * v.y;
							pCOMx += (v.x + w.x) * cf;
							pCOMy += (v.y + w.y) * cf;
							u = v;
							v = w;
							cx_ite = cx_ite.next;
							var w1 = cx_ite.elem();
							parea += v.x * (w1.y - u.y);
							var cf = w1.y * v.x - w1.x * v.y;
							pCOMx += (v.x + w1.x) * cf;
							pCOMy += (v.y + w1.y) * cf;
							parea *= 0.5;
							var ia = 1 / (6 * parea);
							var t = ia;
							pCOMx *= t;
							pCOMy *= t;
							var t = -parea;
							COMx += pCOMx * t;
							COMy += pCOMy * t;
							area -= parea;
						} else {
							zpp_nape.geom.ZPP_Collide.flowsegs.add(zpp_nape.geom.ZPP_Collide.flowpoly.front());
							zpp_nape.geom.ZPP_Collide.flowsegs.add(zpp_nape.geom.ZPP_Collide.flowpoly.begin().next.elem());
						}
						while(!zpp_nape.geom.ZPP_Collide.flowsegs.empty()) {
							var u = zpp_nape.geom.ZPP_Collide.flowsegs.pop_unsafe();
							var v = zpp_nape.geom.ZPP_Collide.flowsegs.pop_unsafe();
							var dx = 0.0;
							var dy = 0.0;
							dx = v.x - u.x;
							dy = v.y - u.y;
							var nx = 0.0;
							var ny = 0.0;
							nx = dx;
							ny = dy;
							var d = nx * nx + ny * ny;
							var imag = zpp_nape.util.ZPP_Math.invsqrt(d);
							var t = imag;
							nx *= t;
							ny *= t;
							var t = nx;
							nx = -ny;
							ny = t;
							var cx = 0.0;
							var cy = 0.0;
							cx = u.x + v.x;
							cy = u.y + v.y;
							var t = 1.0 / 2;
							cx *= t;
							cy *= t;
							var t = 1.0;
							cx -= s1.circle.worldCOMx * t;
							cy -= s1.circle.worldCOMy * t;
							var xd = nx * cx + ny * cy;
							var carea = 0.0;
							var ccom = 0.0;
							var X = xd;
							var cos = X / s1.circle.radius;
							var sin = Math.sqrt(1 - cos * cos);
							var theta = Math.acos(cos);
							carea = s1.circle.radius * (s1.circle.radius * theta - X * sin);
							ccom = 2 / 3 * s1.circle.radius * sin * sin * sin / (theta - cos * sin);
							cx = s1.circle.worldCOMx;
							cy = s1.circle.worldCOMy;
							var t = ccom;
							cx += nx * t;
							cy += ny * t;
							var t = carea;
							COMx += cx * t;
							COMy += cy * t;
							area += carea;
						}
						{
							var t = 1.0 / area;
							COMx *= t;
							COMy *= t;
						}
						arb.inject(area,COMx,COMy);
						$r = true;
						return $r;
					}($this));
					return $r;
				}($this));
				return $r;
			}($this)):false;
			return $r;
		}($this)):false;
		return $r;
	}(this)); else return (function($this) {
		var $r;
		var c1 = s1.circle;
		var c2 = s2.circle;
		var deltax = 0.0;
		var deltay = 0.0;
		{
			deltax = c2.worldCOMx - c1.worldCOMx;
			deltay = c2.worldCOMy - c1.worldCOMy;
		}
		var cr = c1.radius + c2.radius;
		var ds = deltax * deltax + deltay * deltay;
		$r = ds > cr * cr?false:ds < nape.Config.epsilon * nape.Config.epsilon?(function($this) {
			var $r;
			if(c1.radius < c2.radius) arb.inject(c1.area,c1.worldCOMx,c1.worldCOMy); else arb.inject(c2.area,c2.worldCOMx,c2.worldCOMy);
			$r = true;
			return $r;
		}($this)):(function($this) {
			var $r;
			var d = Math.sqrt(ds);
			var id = 1 / d;
			var x1 = 0.5 * (d - (c2.radius * c2.radius - c1.radius * c1.radius) * id);
			if(x1 <= -c1.radius) arb.inject(c1.area,c1.worldCOMx,c1.worldCOMy); else {
				var x2 = d - x1;
				if(x2 <= -c2.radius) arb.inject(c2.area,c2.worldCOMx,c2.worldCOMy); else {
					var area1 = 0.0;
					var y1 = 0.0;
					var area2 = 0.0;
					var y2 = 0.0;
					var X = x1;
					var cos = X / c1.radius;
					var sin = Math.sqrt(1 - cos * cos);
					var theta = Math.acos(cos);
					area1 = c1.radius * (c1.radius * theta - X * sin);
					y1 = 2 / 3 * c1.radius * sin * sin * sin / (theta - cos * sin);
					var X = x2;
					var cos = X / c2.radius;
					var sin = Math.sqrt(1 - cos * cos);
					var theta = Math.acos(cos);
					area2 = c2.radius * (c2.radius * theta - X * sin);
					y2 = 2 / 3 * c2.radius * sin * sin * sin / (theta - cos * sin);
					var tarea = area1 + area2;
					var ya = (y1 * area1 + (d - y2) * area2) / tarea * id;
					arb.inject(tarea,c1.worldCOMx + deltax * ya,c1.worldCOMy + deltay * ya);
				}
			}
			$r = true;
			return $r;
		}($this));
		return $r;
	}(this));
}
zpp_nape.geom.ZPP_ConvexRayResult = function() {
	this.toiDistance = 0.0;
	this.next = null;
	this.inner = false;
	this.ray = null;
	this.position = null;
	this.convex = null;
	this.shape = null;
	this.normal = null;
};
$hxClasses["zpp_nape.geom.ZPP_ConvexRayResult"] = zpp_nape.geom.ZPP_ConvexRayResult;
zpp_nape.geom.ZPP_ConvexRayResult.__name__ = ["zpp_nape","geom","ZPP_ConvexRayResult"];
zpp_nape.geom.ZPP_ConvexRayResult.getRay = function(normal,time,inner,shape) {
	var ret;
	if(zpp_nape.geom.ZPP_ConvexRayResult.rayPool == null) {
		zpp_nape.geom.ZPP_ConvexRayResult.internal = true;
		ret = new nape.geom.RayResult();
		ret.zpp_inner = new zpp_nape.geom.ZPP_ConvexRayResult();
		ret.zpp_inner.ray = ret;
		zpp_nape.geom.ZPP_ConvexRayResult.internal = false;
	} else {
		ret = zpp_nape.geom.ZPP_ConvexRayResult.rayPool.ray;
		zpp_nape.geom.ZPP_ConvexRayResult.rayPool = zpp_nape.geom.ZPP_ConvexRayResult.rayPool.next;
		ret.zpp_inner.next = null;
	}
	var zinner = ret.zpp_inner;
	zinner.normal = normal;
	normal.zpp_inner._immutable = true;
	zinner.toiDistance = time;
	zinner.inner = inner;
	zinner.shape = shape;
	return ret;
}
zpp_nape.geom.ZPP_ConvexRayResult.prototype = {
	free: function() {
		this.normal.zpp_inner._immutable = false;
		this.normal.dispose();
		if(this.position != null) {
			this.position.zpp_inner._immutable = false;
			this.position.dispose();
		}
		this.shape = null;
		this.toiDistance = 0.0;
		if(this.convex != null) {
			this.next = zpp_nape.geom.ZPP_ConvexRayResult.convexPool;
			zpp_nape.geom.ZPP_ConvexRayResult.convexPool = this;
		} else {
			this.next = zpp_nape.geom.ZPP_ConvexRayResult.rayPool;
			zpp_nape.geom.ZPP_ConvexRayResult.rayPool = this;
		}
	}
	,disposed: function() {
		if(this.next != null) throw "Error: This object has been disposed of and cannot be used";
	}
	,__class__: zpp_nape.geom.ZPP_ConvexRayResult
}
zpp_nape.geom.ZPP_GeomVert = function() {
	this.forced = false;
	this.next = null;
	this.prev = null;
	this.y = 0.0;
	this.x = 0.0;
};
$hxClasses["zpp_nape.geom.ZPP_GeomVert"] = zpp_nape.geom.ZPP_GeomVert;
zpp_nape.geom.ZPP_GeomVert.__name__ = ["zpp_nape","geom","ZPP_GeomVert"];
zpp_nape.geom.ZPP_GeomVert.get = function(x,y) {
	var ret;
	if(zpp_nape.geom.ZPP_GeomVert.zpp_pool == null) ret = new zpp_nape.geom.ZPP_GeomVert(); else {
		ret = zpp_nape.geom.ZPP_GeomVert.zpp_pool;
		zpp_nape.geom.ZPP_GeomVert.zpp_pool = ret.next;
		ret.next = null;
	}
	ret.alloc();
	ret.x = x;
	ret.y = y;
	return ret;
}
zpp_nape.geom.ZPP_GeomVert.prototype = {
	alloc: function() {
		this.forced = false;
	}
	,__class__: zpp_nape.geom.ZPP_GeomVert
}
zpp_nape.geom.ZPP_GeomPoly = function(outer) {
	this.vertices = null;
	this.outer = null;
	this.outer = outer;
};
$hxClasses["zpp_nape.geom.ZPP_GeomPoly"] = zpp_nape.geom.ZPP_GeomPoly;
zpp_nape.geom.ZPP_GeomPoly.__name__ = ["zpp_nape","geom","ZPP_GeomPoly"];
zpp_nape.geom.ZPP_GeomPoly.prototype = {
	__class__: zpp_nape.geom.ZPP_GeomPoly
}
zpp_nape.geom.ZPP_Mat23 = function() {
	this.next = null;
	this._invalidate = null;
	this.ty = 0.0;
	this.tx = 0.0;
	this.d = 0.0;
	this.c = 0.0;
	this.b = 0.0;
	this.a = 0.0;
	this.outer = null;
};
$hxClasses["zpp_nape.geom.ZPP_Mat23"] = zpp_nape.geom.ZPP_Mat23;
zpp_nape.geom.ZPP_Mat23.__name__ = ["zpp_nape","geom","ZPP_Mat23"];
zpp_nape.geom.ZPP_Mat23.get = function() {
	var ret;
	if(zpp_nape.geom.ZPP_Mat23.zpp_pool == null) ret = new zpp_nape.geom.ZPP_Mat23(); else {
		ret = zpp_nape.geom.ZPP_Mat23.zpp_pool;
		zpp_nape.geom.ZPP_Mat23.zpp_pool = ret.next;
		ret.next = null;
	}
	ret.alloc();
	return ret;
}
zpp_nape.geom.ZPP_Mat23.prototype = {
	alloc: function() {
	}
	,invalidate: function() {
		if(this._invalidate != null) this._invalidate();
	}
	,__class__: zpp_nape.geom.ZPP_Mat23
}
zpp_nape.geom.ZPP_MatMN = function(m,n) {
	this.x = null;
	this.n = 0;
	this.m = 0;
	this.outer = null;
	this.m = m;
	this.n = n;
	this.x = new Array();
	var _g1 = 0, _g = m * n;
	while(_g1 < _g) {
		var i = _g1++;
		this.x.push(0.0);
	}
};
$hxClasses["zpp_nape.geom.ZPP_MatMN"] = zpp_nape.geom.ZPP_MatMN;
zpp_nape.geom.ZPP_MatMN.__name__ = ["zpp_nape","geom","ZPP_MatMN"];
zpp_nape.geom.ZPP_MatMN.prototype = {
	__class__: zpp_nape.geom.ZPP_MatMN
}
zpp_nape.geom.ZPP_Ray = function() {
	this.zip_dir = false;
	this.absnormaly = 0.0;
	this.absnormalx = 0.0;
	this.normaly = 0.0;
	this.normalx = 0.0;
	this.idiry = 0.0;
	this.idirx = 0.0;
	this.diry = 0.0;
	this.dirx = 0.0;
	this.originy = 0.0;
	this.originx = 0.0;
	this.userData = null;
	this.maxdist = 0.0;
	this.direction = null;
	this.origin = null;
};
$hxClasses["zpp_nape.geom.ZPP_Ray"] = zpp_nape.geom.ZPP_Ray;
zpp_nape.geom.ZPP_Ray.__name__ = ["zpp_nape","geom","ZPP_Ray"];
zpp_nape.geom.ZPP_Ray.prototype = {
	polysect2: function(p,inner,list) {
		var min = zpp_nape.ZPP_Const.POSINF();
		var max = -1.0;
		var edge = null;
		var edgemax = null;
		var ei = p.edges.begin();
		var cx_cont = true;
		var cx_itei = p.gverts.begin();
		var u = cx_itei.elem();
		var cx_itej = cx_itei.next;
		while(cx_itej != null) {
			var v = cx_itej.elem();
			var e = ei.elem();
			if(inner || e.gnormx * this.dirx + e.gnormy * this.diry < 0) {
				var _vx = 0.0;
				var _vy = 0.0;
				_vx = v.x - u.x;
				_vy = v.y - u.y;
				var _sx = 0.0;
				var _sy = 0.0;
				_sx = u.x - this.originx;
				_sy = u.y - this.originy;
				var den = _vy * this.dirx - _vx * this.diry;
				if(den * den > nape.Config.epsilon) {
					den = 1 / den;
					var sxx = (_vy * _sx - _vx * _sy) * den;
					if(sxx > 0 && sxx <= this.maxdist && (sxx < min || sxx > max)) {
						var txx = (this.diry * _sx - this.dirx * _sy) * den;
						if(txx > -nape.Config.epsilon && txx < 1 + nape.Config.epsilon) {
							if(sxx < min) {
								min = sxx;
								edge = ei.elem();
							}
							if(sxx > max) {
								max = sxx;
								edgemax = ei.elem();
							}
						}
					}
				}
			}
			ei = ei.next;
			cx_itei = cx_itej;
			u = v;
			cx_itej = cx_itej.next;
		}
		if(cx_cont) do {
			cx_itej = p.gverts.begin();
			var v = cx_itej.elem();
			var e = ei.elem();
			if(inner || e.gnormx * this.dirx + e.gnormy * this.diry < 0) {
				var _vx = 0.0;
				var _vy = 0.0;
				_vx = v.x - u.x;
				_vy = v.y - u.y;
				var _sx = 0.0;
				var _sy = 0.0;
				_sx = u.x - this.originx;
				_sy = u.y - this.originy;
				var den = _vy * this.dirx - _vx * this.diry;
				if(den * den > nape.Config.epsilon) {
					den = 1 / den;
					var sxx = (_vy * _sx - _vx * _sy) * den;
					if(sxx > 0 && sxx <= this.maxdist && (sxx < min || sxx > max)) {
						var txx = (this.diry * _sx - this.dirx * _sy) * den;
						if(txx > -nape.Config.epsilon && txx < 1 + nape.Config.epsilon) {
							if(sxx < min) {
								min = sxx;
								edge = ei.elem();
							}
							if(sxx > max) {
								max = sxx;
								edgemax = ei.elem();
							}
						}
					}
				}
			}
			ei = ei.next;
		} while(false);
		if(edge != null) {
			var nx = 0.0;
			var ny = 0.0;
			nx = edge.gnormx;
			ny = edge.gnormy;
			var inner1 = nx * this.dirx + ny * this.diry > 0;
			if(inner1) {
				nx = -nx;
				ny = -ny;
			}
			var ret = zpp_nape.geom.ZPP_ConvexRayResult.getRay(nape.geom.Vec2.get(nx,ny),min,inner1,p.outer);
			var pre = null;
			var cx_ite = list.zpp_inner.inner.begin();
			while(cx_ite != null) {
				var j = cx_ite.elem();
				if(ret.get_distance() < j.get_distance()) break;
				pre = cx_ite;
				cx_ite = cx_ite.next;
			}
			list.zpp_inner.inner.inlined_insert(pre,ret);
		}
		if(edgemax != null && edge != edgemax) {
			var nx = 0.0;
			var ny = 0.0;
			nx = edgemax.gnormx;
			ny = edgemax.gnormy;
			var inner1 = nx * this.dirx + ny * this.diry > 0;
			if(inner1) {
				nx = -nx;
				ny = -ny;
			}
			var ret = zpp_nape.geom.ZPP_ConvexRayResult.getRay(nape.geom.Vec2.get(nx,ny),max,inner1,p.outer);
			var pre = null;
			var cx_ite = list.zpp_inner.inner.begin();
			while(cx_ite != null) {
				var j = cx_ite.elem();
				if(ret.get_distance() < j.get_distance()) break;
				pre = cx_ite;
				cx_ite = cx_ite.next;
			}
			list.zpp_inner.inner.inlined_insert(pre,ret);
		}
	}
	,polysect: function(p,inner,mint) {
		var min = mint;
		var edge = null;
		var ei = p.edges.begin();
		var cx_cont = true;
		var cx_itei = p.gverts.begin();
		var u = cx_itei.elem();
		var cx_itej = cx_itei.next;
		while(cx_itej != null) {
			var v = cx_itej.elem();
			var e = ei.elem();
			if(inner || e.gnormx * this.dirx + e.gnormy * this.diry < 0) {
				var _vx = 0.0;
				var _vy = 0.0;
				_vx = v.x - u.x;
				_vy = v.y - u.y;
				var _sx = 0.0;
				var _sy = 0.0;
				_sx = u.x - this.originx;
				_sy = u.y - this.originy;
				var den = _vy * this.dirx - _vx * this.diry;
				if(den * den > nape.Config.epsilon) {
					den = 1 / den;
					var sxx = (_vy * _sx - _vx * _sy) * den;
					if(sxx > 0 && sxx < min && sxx <= this.maxdist) {
						var txx = (this.diry * _sx - this.dirx * _sy) * den;
						if(txx > -nape.Config.epsilon && txx < 1 + nape.Config.epsilon) {
							min = sxx;
							edge = ei.elem();
						}
					}
				}
			}
			ei = ei.next;
			cx_itei = cx_itej;
			u = v;
			cx_itej = cx_itej.next;
		}
		if(cx_cont) do {
			cx_itej = p.gverts.begin();
			var v = cx_itej.elem();
			var e = ei.elem();
			if(inner || e.gnormx * this.dirx + e.gnormy * this.diry < 0) {
				var _vx = 0.0;
				var _vy = 0.0;
				_vx = v.x - u.x;
				_vy = v.y - u.y;
				var _sx = 0.0;
				var _sy = 0.0;
				_sx = u.x - this.originx;
				_sy = u.y - this.originy;
				var den = _vy * this.dirx - _vx * this.diry;
				if(den * den > nape.Config.epsilon) {
					den = 1 / den;
					var sxx = (_vy * _sx - _vx * _sy) * den;
					if(sxx > 0 && sxx < min && sxx <= this.maxdist) {
						var txx = (this.diry * _sx - this.dirx * _sy) * den;
						if(txx > -nape.Config.epsilon && txx < 1 + nape.Config.epsilon) {
							min = sxx;
							edge = ei.elem();
						}
					}
				}
			}
			ei = ei.next;
		} while(false);
		if(edge != null) {
			var nx = 0.0;
			var ny = 0.0;
			nx = edge.gnormx;
			ny = edge.gnormy;
			var inner1 = nx * this.dirx + ny * this.diry > 0;
			if(inner1) {
				nx = -nx;
				ny = -ny;
			}
			return zpp_nape.geom.ZPP_ConvexRayResult.getRay(nape.geom.Vec2.get(nx,ny),min,inner1,p.outer);
		} else return null;
	}
	,circlesect2: function(c,inner,list) {
		c.validate_worldCOM();
		var acx = 0.0;
		var acy = 0.0;
		acx = this.originx - c.worldCOMx;
		acy = this.originy - c.worldCOMy;
		var A = this.dirx * this.dirx + this.diry * this.diry;
		var B = 2 * (acx * this.dirx + acy * this.diry);
		var C = acx * acx + acy * acy - c.radius * c.radius;
		var det = B * B - 4 * A * C;
		if(det == 0) {
			var t = -B / 2 * A;
			if((!inner || C > 0) && t > 0 && t <= this.maxdist) {
				var nx = 0.0;
				var ny = 0.0;
				nx = this.originx;
				ny = this.originy;
				var t1 = t;
				nx += this.dirx * t1;
				ny += this.diry * t1;
				var t1 = 1.0;
				nx -= c.worldCOMx * t1;
				ny -= c.worldCOMy * t1;
				var d = nx * nx + ny * ny;
				var imag = 1.0 / Math.sqrt(d);
				var t1 = imag;
				nx *= t1;
				ny *= t1;
				if(C <= 0) {
					nx = -nx;
					ny = -ny;
				}
				var res = zpp_nape.geom.ZPP_ConvexRayResult.getRay(nape.geom.Vec2.get(nx,ny),t,C <= 0,c.outer);
				var pre = null;
				var cx_ite = list.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var j = cx_ite.elem();
					if(res.get_distance() < j.get_distance()) break;
					pre = cx_ite;
					cx_ite = cx_ite.next;
				}
				list.zpp_inner.inner.inlined_insert(pre,res);
			}
		} else {
			det = Math.sqrt(det);
			A = 1 / (2 * A);
			var t0 = (-B - det) * A;
			var t1 = (-B + det) * A;
			if(t0 > 0 && t0 <= this.maxdist) {
				var nx = 0.0;
				var ny = 0.0;
				nx = this.originx;
				ny = this.originy;
				var t = t0;
				nx += this.dirx * t;
				ny += this.diry * t;
				var t = 1.0;
				nx -= c.worldCOMx * t;
				ny -= c.worldCOMy * t;
				var d = nx * nx + ny * ny;
				var imag = 1.0 / Math.sqrt(d);
				var t = imag;
				nx *= t;
				ny *= t;
				if(false) {
					nx = -nx;
					ny = -ny;
				}
				var res = zpp_nape.geom.ZPP_ConvexRayResult.getRay(nape.geom.Vec2.get(nx,ny),t0,false,c.outer);
				var pre = null;
				var cx_ite = list.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var j = cx_ite.elem();
					if(res.get_distance() < j.get_distance()) break;
					pre = cx_ite;
					cx_ite = cx_ite.next;
				}
				list.zpp_inner.inner.inlined_insert(pre,res);
			}
			if(t1 > 0 && t1 <= this.maxdist && inner) {
				var nx = 0.0;
				var ny = 0.0;
				nx = this.originx;
				ny = this.originy;
				var t = t1;
				nx += this.dirx * t;
				ny += this.diry * t;
				var t = 1.0;
				nx -= c.worldCOMx * t;
				ny -= c.worldCOMy * t;
				var d = nx * nx + ny * ny;
				var imag = 1.0 / Math.sqrt(d);
				var t = imag;
				nx *= t;
				ny *= t;
				if(true) {
					nx = -nx;
					ny = -ny;
				}
				var res = zpp_nape.geom.ZPP_ConvexRayResult.getRay(nape.geom.Vec2.get(nx,ny),t1,true,c.outer);
				var pre = null;
				var cx_ite = list.zpp_inner.inner.begin();
				while(cx_ite != null) {
					var j = cx_ite.elem();
					if(res.get_distance() < j.get_distance()) break;
					pre = cx_ite;
					cx_ite = cx_ite.next;
				}
				list.zpp_inner.inner.inlined_insert(pre,res);
			}
		}
	}
	,circlesect: function(c,inner,mint) {
		c.validate_worldCOM();
		var acx = 0.0;
		var acy = 0.0;
		acx = this.originx - c.worldCOMx;
		acy = this.originy - c.worldCOMy;
		var A = this.dirx * this.dirx + this.diry * this.diry;
		var B = 2 * (acx * this.dirx + acy * this.diry);
		var C = acx * acx + acy * acy - c.radius * c.radius;
		var det = B * B - 4 * A * C;
		if(det == 0) {
			var t = -B / 2 * A;
			if((!inner || C > 0) && t > 0 && t < mint && t <= this.maxdist) {
				var nx = 0.0;
				var ny = 0.0;
				nx = this.originx;
				ny = this.originy;
				var t1 = t;
				nx += this.dirx * t1;
				ny += this.diry * t1;
				var t1 = 1.0;
				nx -= c.worldCOMx * t1;
				ny -= c.worldCOMy * t1;
				var d = nx * nx + ny * ny;
				var imag = 1.0 / Math.sqrt(d);
				var t1 = imag;
				nx *= t1;
				ny *= t1;
				if(C <= 0) {
					nx = -nx;
					ny = -ny;
				}
				return zpp_nape.geom.ZPP_ConvexRayResult.getRay(nape.geom.Vec2.get(nx,ny),t,C <= 0,c.outer);
			} else return null;
		} else {
			det = Math.sqrt(det);
			A = 1 / (2 * A);
			var t0 = (-B - det) * A;
			var t1 = (-B + det) * A;
			if(t0 > 0) {
				if(t0 < mint && t0 <= this.maxdist) {
					var nx = 0.0;
					var ny = 0.0;
					nx = this.originx;
					ny = this.originy;
					var t = t0;
					nx += this.dirx * t;
					ny += this.diry * t;
					var t = 1.0;
					nx -= c.worldCOMx * t;
					ny -= c.worldCOMy * t;
					var d = nx * nx + ny * ny;
					var imag = 1.0 / Math.sqrt(d);
					var t = imag;
					nx *= t;
					ny *= t;
					if(false) {
						nx = -nx;
						ny = -ny;
					}
					return zpp_nape.geom.ZPP_ConvexRayResult.getRay(nape.geom.Vec2.get(nx,ny),t0,false,c.outer);
				} else return null;
			} else if(t1 > 0 && inner) {
				if(t1 < mint && t1 <= this.maxdist) {
					var nx = 0.0;
					var ny = 0.0;
					nx = this.originx;
					ny = this.originy;
					var t = t1;
					nx += this.dirx * t;
					ny += this.diry * t;
					var t = 1.0;
					nx -= c.worldCOMx * t;
					ny -= c.worldCOMy * t;
					var d = nx * nx + ny * ny;
					var imag = 1.0 / Math.sqrt(d);
					var t = imag;
					nx *= t;
					ny *= t;
					if(true) {
						nx = -nx;
						ny = -ny;
					}
					return zpp_nape.geom.ZPP_ConvexRayResult.getRay(nape.geom.Vec2.get(nx,ny),t1,true,c.outer);
				} else return null;
			} else return null;
		}
	}
	,aabbsect: function(a) {
		var cx = this.originx >= a.minx && this.originx <= a.maxx;
		var cy = this.originy >= a.miny && this.originy <= a.maxy;
		if(cx && cy) return 0.0; else {
			var ret = -1.0;
			do {
				if(this.dirx >= 0 && this.originx >= a.maxx) break;
				if(this.dirx <= 0 && this.originx <= a.minx) break;
				if(this.diry >= 0 && this.originy >= a.maxy) break;
				if(this.diry <= 0 && this.originy <= a.miny) break;
				if(this.dirx > 0) {
					var t = (a.minx - this.originx) * this.idirx;
					if(t >= 0 && t <= this.maxdist) {
						var y = this.originy + t * this.diry;
						if(y >= a.miny && y <= a.maxy) {
							ret = t;
							break;
						}
					}
				} else if(this.dirx < 0) {
					var t = (a.maxx - this.originx) * this.idirx;
					if(t >= 0 && t <= this.maxdist) {
						var y = this.originy + t * this.diry;
						if(y >= a.miny && y <= a.maxy) {
							ret = t;
							break;
						}
					}
				}
				if(this.diry > 0) {
					var t = (a.miny - this.originy) * this.idiry;
					if(t >= 0 && t <= this.maxdist) {
						var x = this.originx + t * this.dirx;
						if(x >= a.minx && x <= a.maxx) {
							ret = t;
							break;
						}
					}
				} else if(this.diry < 0) {
					var t = (a.maxy - this.originy) * this.idiry;
					if(t >= 0 && t <= this.maxdist) {
						var x = this.originx + t * this.dirx;
						if(x >= a.minx && x <= a.maxx) {
							ret = t;
							break;
						}
					}
				}
			} while(false);
			return ret;
		}
	}
	,aabbtest: function(a) {
		var dot1 = this.normalx * (this.originx - 0.5 * (a.minx + a.maxx)) + this.normaly * (this.originy - 0.5 * (a.miny + a.maxy));
		var dot2 = this.absnormalx * 0.5 * (a.maxx - a.minx) + this.absnormaly * 0.5 * (a.maxy - a.miny);
		return (function($this) {
			var $r;
			var x = dot1;
			$r = x < 0?-x:x;
			return $r;
		}(this)) < dot2;
	}
	,rayAABB: function() {
		var x0 = this.originx;
		var x1 = x0;
		var y0 = this.originy;
		var y1 = y0;
		if(this.maxdist >= zpp_nape.ZPP_Const.POSINF()) {
			if(this.dirx > 0) x1 = zpp_nape.ZPP_Const.POSINF(); else if(this.dirx < 0) x1 = zpp_nape.ZPP_Const.NEGINF();
			if(this.diry > 0) y1 = zpp_nape.ZPP_Const.POSINF(); else if(this.diry < 0) y1 = zpp_nape.ZPP_Const.NEGINF();
		} else {
			x1 += this.maxdist * this.dirx;
			y1 += this.maxdist * this.diry;
		}
		if(x1 < x0) {
			var t = x0;
			x0 = x1;
			x1 = t;
		}
		if(y1 < y0) {
			var t = y0;
			y0 = y1;
			y1 = t;
		}
		var rayab = zpp_nape.geom.ZPP_AABB.get(x0,y0,x1,y1);
		return rayab;
	}
	,validate_dir: function() {
		if(this.zip_dir) {
			this.zip_dir = false;
			if(this.dirx * this.dirx + this.diry * this.diry < nape.Config.epsilon) throw "Error: Ray::direction is degenerate";
			var d = this.dirx * this.dirx + this.diry * this.diry;
			var imag = 1.0 / Math.sqrt(d);
			var t = imag;
			this.dirx *= t;
			this.diry *= t;
			this.idirx = 1 / this.dirx;
			this.idiry = 1 / this.diry;
			this.normalx = -this.diry;
			this.normaly = this.dirx;
			this.absnormalx = (function($this) {
				var $r;
				var x = $this.normalx;
				$r = x < 0?-x:x;
				return $r;
			}(this));
			this.absnormaly = (function($this) {
				var $r;
				var x = $this.normaly;
				$r = x < 0?-x:x;
				return $r;
			}(this));
		}
	}
	,invalidate_dir: function() {
		this.zip_dir = true;
	}
	,__class__: zpp_nape.geom.ZPP_Ray
}
zpp_nape.geom.ZPP_ToiEvent = function() {
	this.kinematic = false;
	this.failed = false;
	this.slipped = false;
	this.axis = null;
	this.c2 = null;
	this.c1 = null;
	this.frozen2 = false;
	this.frozen1 = false;
	this.arbiter = null;
	this.s2 = null;
	this.s1 = null;
	this.toi = 0.0;
	this.next = null;
	this.c1 = new zpp_nape.geom.ZPP_Vec2();
	this.c2 = new zpp_nape.geom.ZPP_Vec2();
	this.axis = new zpp_nape.geom.ZPP_Vec2();
};
$hxClasses["zpp_nape.geom.ZPP_ToiEvent"] = zpp_nape.geom.ZPP_ToiEvent;
zpp_nape.geom.ZPP_ToiEvent.__name__ = ["zpp_nape","geom","ZPP_ToiEvent"];
zpp_nape.geom.ZPP_ToiEvent.prototype = {
	free: function() {
	}
	,alloc: function() {
		this.failed = false;
		this.s1 = this.s2 = null;
		this.arbiter = null;
	}
	,__class__: zpp_nape.geom.ZPP_ToiEvent
}
zpp_nape.geom.ZPP_SweepDistance = function() { }
$hxClasses["zpp_nape.geom.ZPP_SweepDistance"] = zpp_nape.geom.ZPP_SweepDistance;
zpp_nape.geom.ZPP_SweepDistance.__name__ = ["zpp_nape","geom","ZPP_SweepDistance"];
zpp_nape.geom.ZPP_SweepDistance.dynamicSweep = function(toi,timeStep,lowerBound,negRadius,userAPI) {
	if(userAPI == null) userAPI = false;
	var s1 = toi.s1;
	var s2 = toi.s2;
	var b1 = s1.body;
	var b2 = s2.body;
	var deltax = 0.0;
	var deltay = 0.0;
	deltax = b2.velx - b1.velx;
	deltay = b2.vely - b1.vely;
	var ang1 = b1.angvel;
	if(ang1 < 0) ang1 = -ang1;
	var ang2 = b2.angvel;
	if(ang2 < 0) ang2 = -ang2;
	var angBias = s1.sweepCoef * ang1 + s2.sweepCoef * ang2;
	if(!userAPI && !toi.kinematic && deltax * deltax + deltay * deltay < nape.Config.dynamicSweepLinearThreshold * nape.Config.dynamicSweepLinearThreshold && angBias < nape.Config.dynamicSweepAngularThreshold) {
		toi.toi = -1;
		toi.failed = true;
		return;
	}
	var c1 = toi.c1;
	var c2 = toi.c2;
	var axis = toi.axis;
	var curTOI = lowerBound;
	var curIter = 0;
	while(true) {
		b1.sweepIntegrate(curTOI * timeStep);
		b1.sweepValidate(s1);
		b2.sweepIntegrate(curTOI * timeStep);
		b2.sweepValidate(s2);
		var sep = zpp_nape.geom.ZPP_SweepDistance.distance(s1,s2,c1,c2,axis) + negRadius;
		var dot = deltax * axis.x + deltay * axis.y;
		if(sep < nape.Config.distanceThresholdCCD) {
			if(userAPI) break;
			var d1x = 0.0;
			var d1y = 0.0;
			d1x = c1.x - b1.posx;
			d1y = c1.y - b1.posy;
			var d2x = 0.0;
			var d2y = 0.0;
			d2x = c2.x - b2.posx;
			d2y = c2.y - b2.posy;
			var proj = dot - b1.sweep_angvel * (axis.y * d1x - axis.x * d1y) + b2.sweep_angvel * (axis.y * d2x - axis.x * d2y);
			if(proj > 0) toi.slipped = true;
			if(proj <= 0 || sep < nape.Config.distanceThresholdCCD * 0.5) break;
		}
		var denom = (angBias - dot) * timeStep;
		if(denom <= 0) {
			curTOI = -1;
			break;
		}
		var delta = sep / denom;
		if(delta < 1e-6) delta = 1e-6;
		curTOI += delta;
		if(curTOI >= 1) {
			curTOI = 1;
			b1.sweepIntegrate(curTOI * timeStep);
			b1.sweepValidate(s1);
			b2.sweepIntegrate(curTOI * timeStep);
			b2.sweepValidate(s2);
			var sep1 = zpp_nape.geom.ZPP_SweepDistance.distance(s1,s2,c1,c2,axis) + negRadius;
			var dot1 = deltax * axis.x + deltay * axis.y;
			if(sep1 < nape.Config.distanceThresholdCCD) {
				if(userAPI) break;
				var d1x = 0.0;
				var d1y = 0.0;
				d1x = c1.x - b1.posx;
				d1y = c1.y - b1.posy;
				var d2x = 0.0;
				var d2y = 0.0;
				d2x = c2.x - b2.posx;
				d2y = c2.y - b2.posy;
				var proj = dot1 - b1.sweep_angvel * (axis.y * d1x - axis.x * d1y) + b2.sweep_angvel * (axis.y * d2x - axis.x * d2y);
				if(proj > 0) toi.slipped = true;
				if(proj <= 0 || sep1 < nape.Config.distanceThresholdCCD * 0.5) break;
			}
			curTOI = -1;
			break;
		}
		if(++curIter >= 40) {
			if(sep > negRadius) toi.failed = true;
			break;
		}
	}
	toi.toi = curTOI;
}
zpp_nape.geom.ZPP_SweepDistance.staticSweep = function(toi,timeStep,lowerBound,negRadius) {
	var s1 = toi.s1;
	var s2 = toi.s2;
	var b1 = s1.body;
	var b2 = s2.body;
	var deltax = 0.0;
	var deltay = 0.0;
	deltax = -b1.velx;
	deltay = -b1.vely;
	var ang1 = b1.sweep_angvel;
	if(ang1 < 0) ang1 = -ang1;
	var angBias = s1.sweepCoef * ang1;
	var c1 = toi.c1;
	var c2 = toi.c2;
	var axis = toi.axis;
	var curTOI = lowerBound;
	var curIter = 0;
	while(true) {
		b1.sweepIntegrate(curTOI * timeStep);
		b1.sweepValidate(s1);
		var sep = zpp_nape.geom.ZPP_SweepDistance.distance(s1,s2,c1,c2,axis) + negRadius;
		var dot = deltax * axis.x + deltay * axis.y;
		if(sep < nape.Config.distanceThresholdCCD) {
			var d1x = 0.0;
			var d1y = 0.0;
			d1x = c1.x - b1.posx;
			d1y = c1.y - b1.posy;
			var proj = dot - b1.sweep_angvel * (axis.y * d1x - axis.x * d1y);
			if(proj > 0) toi.slipped = true;
			if(proj <= 0 || sep < nape.Config.distanceThresholdCCD * 0.5) break;
		}
		var denom = (angBias - dot) * timeStep;
		if(denom <= 0) {
			curTOI = -1;
			break;
		}
		var delta = sep / denom;
		if(delta < 1e-6) delta = 1e-6;
		curTOI += delta;
		if(curTOI >= 1) {
			curTOI = 1;
			b1.sweepIntegrate(curTOI * timeStep);
			b1.sweepValidate(s1);
			var sep1 = zpp_nape.geom.ZPP_SweepDistance.distance(s1,s2,c1,c2,axis) + negRadius;
			var dot1 = deltax * axis.x + deltay * axis.y;
			if(sep1 < nape.Config.distanceThresholdCCD) {
				var d1x = 0.0;
				var d1y = 0.0;
				d1x = c1.x - b1.posx;
				d1y = c1.y - b1.posy;
				var proj = dot1 - b1.sweep_angvel * (axis.y * d1x - axis.x * d1y);
				if(proj > 0) toi.slipped = true;
				if(proj <= 0 || sep1 < nape.Config.distanceThresholdCCD * 0.5) break;
			}
			curTOI = -1;
			break;
		}
		if(++curIter >= 40) {
			if(sep > negRadius) toi.failed = true;
			break;
		}
	}
	toi.toi = curTOI;
}
zpp_nape.geom.ZPP_SweepDistance.distance = function(s1,s2,w1,w2,axis,upperBound) {
	if(upperBound == null) upperBound = 1e100;
	if(s1.isCircle() && s2.isCircle()) {
		var c1 = s1.circle;
		var c2 = s2.circle;
		var dist;
		var nx = 0.0;
		var ny = 0.0;
		nx = c2.worldCOMx - c1.worldCOMx;
		ny = c2.worldCOMy - c1.worldCOMy;
		var len = zpp_nape.util.ZPP_Math.sqrt(nx * nx + ny * ny);
		dist = len - (c1.radius + c2.radius);
		if(dist < upperBound) {
			if(len == 0) {
				nx = 1;
				ny = 0;
			} else {
				var t = 1.0 / len;
				nx *= t;
				ny *= t;
			}
			var t = c1.radius;
			w1.x = c1.worldCOMx + nx * t;
			w1.y = c1.worldCOMy + ny * t;
			var t = -c2.radius;
			w2.x = c2.worldCOMx + nx * t;
			w2.y = c2.worldCOMy + ny * t;
			axis.x = nx;
			axis.y = ny;
		}
		return dist;
	} else {
		var swapped = false;
		if(s1.isCircle() && s2.isPolygon()) {
			var tmp = s1;
			s1 = s2;
			s2 = tmp;
			var tmp2 = w1;
			w1 = w2;
			w2 = tmp2;
			swapped = true;
		}
		if(s1.isPolygon() && s2.isCircle()) {
			var poly = s1.polygon;
			var circle = s2.circle;
			var best = -1e100;
			var a0 = null;
			var cx_ite = poly.edges.begin();
			while(cx_ite != null) {
				var a = cx_ite.elem();
				var dist = a.gnormx * circle.worldCOMx + a.gnormy * circle.worldCOMy - a.gprojection - circle.radius;
				if(dist > upperBound) {
					best = dist;
					break;
				}
				if(dist > 0) {
					if(dist > best) {
						best = dist;
						a0 = a;
					}
				} else if(best < 0 && dist > best) {
					best = dist;
					a0 = a;
				}
				cx_ite = cx_ite.next;
			}
			if(best < upperBound) {
				var v0 = a0.gp0;
				var v1 = a0.gp1;
				var dt = circle.worldCOMy * a0.gnormx - circle.worldCOMx * a0.gnormy;
				if(dt <= v0.y * a0.gnormx - v0.x * a0.gnormy) {
					var nx = 0.0;
					var ny = 0.0;
					nx = circle.worldCOMx - v0.x;
					ny = circle.worldCOMy - v0.y;
					var len = zpp_nape.util.ZPP_Math.sqrt(nx * nx + ny * ny);
					best = len - (0 + circle.radius);
					if(best < upperBound) {
						if(len == 0) {
							nx = 1;
							ny = 0;
						} else {
							var t = 1.0 / len;
							nx *= t;
							ny *= t;
						}
						var t = 0;
						w1.x = v0.x + nx * t;
						w1.y = v0.y + ny * t;
						var t = -circle.radius;
						w2.x = circle.worldCOMx + nx * t;
						w2.y = circle.worldCOMy + ny * t;
						axis.x = nx;
						axis.y = ny;
					}
				} else if(dt >= v1.y * a0.gnormx - v1.x * a0.gnormy) {
					var nx = 0.0;
					var ny = 0.0;
					nx = circle.worldCOMx - v1.x;
					ny = circle.worldCOMy - v1.y;
					var len = zpp_nape.util.ZPP_Math.sqrt(nx * nx + ny * ny);
					best = len - (0 + circle.radius);
					if(best < upperBound) {
						if(len == 0) {
							nx = 1;
							ny = 0;
						} else {
							var t = 1.0 / len;
							nx *= t;
							ny *= t;
						}
						var t = 0;
						w1.x = v1.x + nx * t;
						w1.y = v1.y + ny * t;
						var t = -circle.radius;
						w2.x = circle.worldCOMx + nx * t;
						w2.y = circle.worldCOMy + ny * t;
						axis.x = nx;
						axis.y = ny;
					}
				} else {
					var t = -circle.radius;
					w2.x = circle.worldCOMx + a0.gnormx * t;
					w2.y = circle.worldCOMy + a0.gnormy * t;
					var t = -best;
					w1.x = w2.x + a0.gnormx * t;
					w1.y = w2.y + a0.gnormy * t;
					axis.x = a0.gnormx;
					axis.y = a0.gnormy;
				}
			}
			if(swapped) {
				axis.x = -axis.x;
				axis.y = -axis.y;
			}
			return best;
		} else {
			var p1 = s1.polygon;
			var p2 = s2.polygon;
			var best = -1e100;
			var a1 = null;
			var a2 = null;
			var besti = 0;
			var cx_ite = p1.edges.begin();
			while(cx_ite != null) {
				var a = cx_ite.elem();
				var min = 1e100;
				var cx_ite1 = p2.gverts.begin();
				while(cx_ite1 != null) {
					var v = cx_ite1.elem();
					var k = a.gnormx * v.x + a.gnormy * v.y;
					if(k < min) min = k;
					cx_ite1 = cx_ite1.next;
				}
				min -= a.gprojection;
				if(min > upperBound) {
					best = min;
					break;
				}
				if(min > 0) {
					if(min > best) {
						best = min;
						a1 = a;
						besti = 1;
					}
				} else if(best < 0 && min > best) {
					best = min;
					a1 = a;
					besti = 1;
				}
				cx_ite = cx_ite.next;
			}
			if(best < upperBound) {
				var cx_ite = p2.edges.begin();
				while(cx_ite != null) {
					var a = cx_ite.elem();
					var min = 1e100;
					var cx_ite1 = p1.gverts.begin();
					while(cx_ite1 != null) {
						var v = cx_ite1.elem();
						var k = a.gnormx * v.x + a.gnormy * v.y;
						if(k < min) min = k;
						cx_ite1 = cx_ite1.next;
					}
					min -= a.gprojection;
					if(min > upperBound) {
						best = min;
						break;
					}
					if(min > 0) {
						if(min > best) {
							best = min;
							a2 = a;
							besti = 2;
						}
					} else if(best < 0 && min > best) {
						best = min;
						a2 = a;
						besti = 2;
					}
					cx_ite = cx_ite.next;
				}
				if(best < upperBound) {
					var q1, q2;
					var ax;
					if(besti == 1) {
						q1 = p1;
						q2 = p2;
						ax = a1;
					} else {
						q1 = p2;
						q2 = p1;
						ax = a2;
						var tmp = w1;
						w1 = w2;
						w2 = tmp;
						swapped = !swapped;
					}
					var ay = null;
					var min = 1e100;
					var cx_ite = q2.edges.begin();
					while(cx_ite != null) {
						var a = cx_ite.elem();
						var k = ax.gnormx * a.gnormx + ax.gnormy * a.gnormy;
						if(k < min) {
							min = k;
							ay = a;
						}
						cx_ite = cx_ite.next;
					}
					if(swapped) {
						axis.x = -ax.gnormx;
						axis.y = -ax.gnormy;
					} else {
						axis.x = ax.gnormx;
						axis.y = ax.gnormy;
					}
					if(best >= 0) {
						var v0 = ax.gp0;
						var v1 = ax.gp1;
						var q0 = ay.gp0;
						var q11 = ay.gp1;
						var vx = 0.0;
						var vy = 0.0;
						var qx = 0.0;
						var qy = 0.0;
						vx = v1.x - v0.x;
						vy = v1.y - v0.y;
						qx = q11.x - q0.x;
						qy = q11.y - q0.y;
						var vdot = 1 / (vx * vx + vy * vy);
						var qdot = 1 / (qx * qx + qy * qy);
						var t1 = -(vx * (v0.x - q0.x) + vy * (v0.y - q0.y)) * vdot;
						var t2 = -(vx * (v0.x - q11.x) + vy * (v0.y - q11.y)) * vdot;
						var s11 = -(qx * (q0.x - v0.x) + qy * (q0.y - v0.y)) * qdot;
						var s21 = -(qx * (q0.x - v1.x) + qy * (q0.y - v1.y)) * qdot;
						if(t1 < 0) t1 = 0; else if(t1 > 1) t1 = 1;
						if(t2 < 0) t2 = 0; else if(t2 > 1) t2 = 1;
						if(s11 < 0) s11 = 0; else if(s11 > 1) s11 = 1;
						if(s21 < 0) s21 = 0; else if(s21 > 1) s21 = 1;
						var f1x = 0.0;
						var f1y = 0.0;
						var t = t1;
						f1x = v0.x + vx * t;
						f1y = v0.y + vy * t;
						var f2x = 0.0;
						var f2y = 0.0;
						var t = t2;
						f2x = v0.x + vx * t;
						f2y = v0.y + vy * t;
						var g1x = 0.0;
						var g1y = 0.0;
						var t = s11;
						g1x = q0.x + qx * t;
						g1y = q0.y + qy * t;
						var g2x = 0.0;
						var g2y = 0.0;
						var t = s21;
						g2x = q0.x + qx * t;
						g2y = q0.y + qy * t;
						var d1 = zpp_nape.geom.ZPP_VecMath.vec_dsq(f1x,f1y,q0.x,q0.y);
						var d2 = zpp_nape.geom.ZPP_VecMath.vec_dsq(f2x,f2y,q11.x,q11.y);
						var e1 = zpp_nape.geom.ZPP_VecMath.vec_dsq(g1x,g1y,v0.x,v0.y);
						var e2 = zpp_nape.geom.ZPP_VecMath.vec_dsq(g2x,g2y,v1.x,v1.y);
						var minfx = 0.0;
						var minfy = 0.0;
						var minq = null;
						if(d1 < d2) {
							minfx = f1x;
							minfy = f1y;
							minq = q0;
						} else {
							minfx = f2x;
							minfy = f2y;
							minq = q11;
							d1 = d2;
						}
						var mingx = 0.0;
						var mingy = 0.0;
						var minv = null;
						if(e1 < e2) {
							mingx = g1x;
							mingy = g1y;
							minv = v0;
						} else {
							mingx = g2x;
							mingy = g2y;
							minv = v1;
							e1 = e2;
						}
						if(d1 < e1) {
							w1.x = minfx;
							w1.y = minfy;
							w2.x = minq.x;
							w2.y = minq.y;
							best = Math.sqrt(d1);
						} else {
							w2.x = mingx;
							w2.y = mingy;
							w1.x = minv.x;
							w1.y = minv.y;
							best = Math.sqrt(e1);
						}
						if(best != 0) {
							axis.x = w2.x - w1.x;
							axis.y = w2.y - w1.y;
							var t = 1.0 / best;
							axis.x *= t;
							axis.y *= t;
							if(swapped) {
								axis.x = -axis.x;
								axis.y = -axis.y;
							}
						}
						return best;
					} else {
						var c0x = 0.0;
						var c0y = 0.0;
						c0x = ay.gp0.x;
						c0y = ay.gp0.y;
						var c1x = 0.0;
						var c1y = 0.0;
						c1x = ay.gp1.x;
						c1y = ay.gp1.y;
						var dvx = 0.0;
						var dvy = 0.0;
						dvx = c1x - c0x;
						dvy = c1y - c0y;
						var d0 = ax.gnormy * c0x - ax.gnormx * c0y;
						var d1 = ax.gnormy * c1x - ax.gnormx * c1y;
						var den = 1 / (d1 - d0);
						var t = (-ax.tp1 - d0) * den;
						if(t > nape.Config.epsilon) {
							var t1 = t;
							c0x += dvx * t1;
							c0y += dvy * t1;
						}
						var t1 = (-ax.tp0 - d1) * den;
						if(t1 < -nape.Config.epsilon) {
							var t2 = t1;
							c1x += dvx * t2;
							c1y += dvy * t2;
						}
						var c0d = c0x * ax.gnormx + c0y * ax.gnormy - ax.gprojection;
						var c1d = c1x * ax.gnormx + c1y * ax.gnormy - ax.gprojection;
						if(c0d < c1d) {
							w2.x = c0x;
							w2.y = c0y;
							var t2 = -c0d;
							w1.x = w2.x + ax.gnormx * t2;
							w1.y = w2.y + ax.gnormy * t2;
							return c0d;
						} else {
							w2.x = c1x;
							w2.y = c1y;
							var t2 = -c1d;
							w1.x = w2.x + ax.gnormx * t2;
							w1.y = w2.y + ax.gnormy * t2;
							return c1d;
						}
					}
				} else return upperBound;
			} else return upperBound;
		}
	}
}
zpp_nape.geom.ZPP_Vec2 = function() {
	this.y = 0.0;
	this.x = 0.0;
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this._inuse = false;
	this.next = null;
	this.weak = false;
	this.outer = null;
	this._isimmutable = null;
	this._immutable = false;
	this._validate = null;
	this._invalidate = null;
};
$hxClasses["zpp_nape.geom.ZPP_Vec2"] = zpp_nape.geom.ZPP_Vec2;
zpp_nape.geom.ZPP_Vec2.__name__ = ["zpp_nape","geom","ZPP_Vec2"];
zpp_nape.geom.ZPP_Vec2.get = function(x,y,immutable) {
	if(immutable == null) immutable = false;
	var ret;
	if(zpp_nape.geom.ZPP_Vec2.zpp_pool == null) ret = new zpp_nape.geom.ZPP_Vec2(); else {
		ret = zpp_nape.geom.ZPP_Vec2.zpp_pool;
		zpp_nape.geom.ZPP_Vec2.zpp_pool = ret.next;
		ret.next = null;
	}
	ret.alloc();
	ret._immutable = immutable;
	ret.x = x;
	ret.y = y;
	return ret;
}
zpp_nape.geom.ZPP_Vec2.prototype = {
	toString: function() {
		return "{ x: " + this.x + " y: " + this.y + " }";
	}
	,iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,size: function() {
		return this.length;
	}
	,empty: function() {
		return this.begin() == null;
	}
	,reverse: function() {
		var cur = this.begin();
		var pre = null;
		while(cur != null) {
			var nx = cur.next;
			cur.next = pre;
			this.next = cur;
			pre = cur;
			cur = nx;
		}
		this.modified = true;
		this.pushmod = true;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.next = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		old.elem()._inuse = false;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,erase: function(pre) {
		return this.inlined_erase(pre);
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.next = ret.next;
		ret.elem()._inuse = false;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			o._inuse = true;
			$r = o;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.next = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			o._inuse = true;
			$r = o;
			return $r;
		}(this));
		temp.next = this.begin();
		this.next = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.next;
	}
	,elem: function() {
		return this;
	}
	,alloc: function() {
		this.weak = false;
	}
	,free: function() {
		if(this.outer != null) {
			this.outer.zpp_inner = null;
			this.outer = null;
		}
		this._isimmutable = null;
		this._validate = null;
		this._invalidate = null;
	}
	,wrapper: function() {
		if(this.outer == null) {
			this.outer = new nape.geom.Vec2();
			var o = this.outer.zpp_inner;
			o.free();
			o.next = zpp_nape.geom.ZPP_Vec2.zpp_pool;
			zpp_nape.geom.ZPP_Vec2.zpp_pool = o;
			this.outer.zpp_inner = this;
		}
		return this.outer;
	}
	,immutable: function() {
		if(this._immutable) throw "Error: Vec2 is immutable";
		if(this._isimmutable != null) this._isimmutable();
	}
	,invalidate: function() {
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._validate != null) this._validate();
	}
	,__class__: zpp_nape.geom.ZPP_Vec2
}
zpp_nape.geom.ZPP_Vec3 = function() {
	this._validate = null;
	this.immutable = false;
	this.z = 0.0;
	this.y = 0.0;
	this.x = 0.0;
	this.outer = null;
	this.immutable = false;
	this._validate = null;
};
$hxClasses["zpp_nape.geom.ZPP_Vec3"] = zpp_nape.geom.ZPP_Vec3;
zpp_nape.geom.ZPP_Vec3.__name__ = ["zpp_nape","geom","ZPP_Vec3"];
zpp_nape.geom.ZPP_Vec3.prototype = {
	validate: function() {
		if(this._validate != null) this._validate();
	}
	,__class__: zpp_nape.geom.ZPP_Vec3
}
zpp_nape.geom.ZPP_VecMath = function() { }
$hxClasses["zpp_nape.geom.ZPP_VecMath"] = zpp_nape.geom.ZPP_VecMath;
zpp_nape.geom.ZPP_VecMath.__name__ = ["zpp_nape","geom","ZPP_VecMath"];
zpp_nape.geom.ZPP_VecMath.vec_dsq = function(ax,ay,bx,by) {
	var dx = 0.0;
	var dy = 0.0;
	dx = ax - bx;
	dy = ay - by;
	return dx * dx + dy * dy;
}
zpp_nape.phys = {}
zpp_nape.phys.ZPP_Interactor = function() {
	this.wrap_cbTypes = null;
	this.cbSet = null;
	this.cbTypes = null;
	this.group = null;
	this.cbsets = null;
	this.icompound = null;
	this.ibody = null;
	this.ishape = null;
	this.userData = null;
	this.id = 0;
	this.outer_i = null;
	this.id = zpp_nape.ZPP_ID.Interactor();
	this.cbsets = new zpp_nape.util.ZNPList_ZPP_CallbackSet();
	this.cbTypes = new zpp_nape.util.ZNPList_ZPP_CbType();
};
$hxClasses["zpp_nape.phys.ZPP_Interactor"] = zpp_nape.phys.ZPP_Interactor;
zpp_nape.phys.ZPP_Interactor.__name__ = ["zpp_nape","phys","ZPP_Interactor"];
zpp_nape.phys.ZPP_Interactor.get = function(i1,i2) {
	var id = i1.id < i2.id?i1.id:i2.id;
	var di = i1.id < i2.id?i2.id:i1.id;
	var xs = i1.cbsets.length < i2.cbsets.length?i1.cbsets:i2.cbsets;
	var ret = null;
	var cx_ite = xs.begin();
	while(cx_ite != null) {
		var x = cx_ite.elem();
		if(x.id == id && x.di == di) {
			ret = x;
			break;
		}
		cx_ite = cx_ite.next;
	}
	return ret;
}
zpp_nape.phys.ZPP_Interactor.int_callback = function(set,x,cb) {
	var o1 = set.int1;
	var o2 = set.int2;
	if(x.options1.compatible(o1.cbTypes) && x.options2.compatible(o2.cbTypes)) {
		cb.int1 = o1;
		cb.int2 = o2;
	} else {
		cb.int1 = o2;
		cb.int2 = o1;
	}
}
zpp_nape.phys.ZPP_Interactor.prototype = {
	copyto: function(ret) {
		ret.zpp_inner_i.group = this.group;
		var $it0 = this.outer_i.get_cbTypes().iterator();
		while( $it0.hasNext() ) {
			var cb = $it0.next();
			ret.get_cbTypes().add(cb);
		}
		if(this.userData != null) ret.zpp_inner_i.userData = Reflect.copy(this.userData);
	}
	,lookup_group: function() {
		var cur = this;
		while(cur != null && cur.group == null) if(cur.isShape()) cur = cur.ishape.body; else if(cur.isCompound()) cur = cur.icompound.compound; else cur = cur.ibody.compound;
		return cur == null?null:cur.group;
	}
	,immutable_midstep: function(n) {
		if(this.isBody()) this.ibody.__immutable_midstep(n); else if(this.isShape()) this.ishape.__immutable_midstep(n); else this.icompound.__imutable_midstep(n);
	}
	,setGroup: function(group) {
		if(this.group != group) {
			var inspace = this.getSpace() != null;
			if(inspace && this.group != null) this.group.remInteractor(this);
			this.group = group;
			if(inspace && group != null) group.addInteractor(this);
			if(inspace) {
				if(this.isShape()) this.ishape.body.wake(); else if(this.isBody()) this.ibody.wake(); else this.icompound.wake();
			}
		}
	}
	,dealloc_cbSet: function() {
		var space = this.getSpace();
		if(this.cbSet != null) {
			this.cbSet.remInteractor(this);
			space.nullInteractorType(this);
			if(this.cbSet.decrement()) {
				space.cbsets.remove(this.cbSet);
				var o = this.cbSet;
				o.free();
				o.next = zpp_nape.callbacks.ZPP_CbSet.zpp_pool;
				zpp_nape.callbacks.ZPP_CbSet.zpp_pool = o;
			}
			this.cbSet = null;
		}
	}
	,alloc_cbSet: function() {
		var space = this.getSpace();
		if((this.cbSet = space.cbsets.get(this.cbTypes)) != null) {
			this.cbSet.increment();
			this.cbSet.addInteractor(this);
			this.cbSet.validate();
			space.freshInteractorType(this);
		}
	}
	,insert_cbtype: function(cb) {
		if(!this.cbTypes.has(cb)) {
			var space = this.getSpace();
			if(space != null) {
				this.dealloc_cbSet();
				cb.addInteractor(this);
			}
			var pre = null;
			var cx_ite = this.cbTypes.begin();
			while(cx_ite != null) {
				var j = cx_ite.elem();
				if(zpp_nape.callbacks.ZPP_CbType.setlt(cb,j)) break;
				pre = cx_ite;
				cx_ite = cx_ite.next;
			}
			this.cbTypes.inlined_insert(pre,cb);
			if(space != null) {
				this.alloc_cbSet();
				this.wake();
			}
		}
	}
	,wrap_cbTypes_adder: function(cb) {
		this.insert_cbtype(cb.zpp_inner);
		return false;
	}
	,wrap_cbTypes_subber: function(pcb) {
		var cb = pcb.zpp_inner;
		if(this.cbTypes.has(cb)) {
			var space = this.getSpace();
			if(space != null) {
				this.dealloc_cbSet();
				cb.remInteractor(this);
			}
			this.cbTypes.remove(cb);
			if(space != null) {
				this.alloc_cbSet();
				this.wake();
			}
		}
	}
	,immutable_cbTypes: function() {
		this.immutable_midstep("Interactor::cbTypes");
	}
	,setupcbTypes: function() {
		this.wrap_cbTypes = zpp_nape.util.ZPP_CbTypeList.get(this.cbTypes);
		this.wrap_cbTypes.zpp_inner.adder = $bind(this,this.wrap_cbTypes_adder);
		this.wrap_cbTypes.zpp_inner.subber = $bind(this,this.wrap_cbTypes_subber);
		this.wrap_cbTypes.zpp_inner.dontremove = true;
		this.wrap_cbTypes.zpp_inner._modifiable = $bind(this,this.immutable_cbTypes);
	}
	,getSpace: function() {
		return this.isShape()?this.ishape.body == null?null:this.ishape.body.space:this.isBody()?this.ibody.space:this.icompound.space;
	}
	,wake: function() {
		if(this.isShape()) {
			var body = this.ishape.body;
			if(body != null && body.space != null) body.space.non_inlined_wake(body);
			true;
		} else if(this.isBody()) {
			if(this.ibody.space != null) this.ibody.space.non_inlined_wake(this.ibody); else false;
		} else {
			if(this.icompound.space != null) this.icompound.space.wakeCompound(this.icompound);
			true;
		}
	}
	,__iremovedFromSpace: function() {
		if(this.group != null) this.group.remInteractor(this);
		var cx_ite = this.cbTypes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.remInteractor(this);
			cx_ite = cx_ite.next;
		}
		this.dealloc_cbSet();
	}
	,__iaddedToSpace: function() {
		if(this.group != null) this.group.addInteractor(this);
		var cx_ite = this.cbTypes.begin();
		while(cx_ite != null) {
			var cb = cx_ite.elem();
			cb.addInteractor(this);
			cx_ite = cx_ite.next;
		}
		this.alloc_cbSet();
	}
	,isCompound: function() {
		return this.icompound != null;
	}
	,isBody: function() {
		return this.ibody != null;
	}
	,isShape: function() {
		return this.ishape != null;
	}
	,__class__: zpp_nape.phys.ZPP_Interactor
}
zpp_nape.phys.ZPP_Body = function() {
	this.wrap_worldCOM = null;
	this.wrap_localCOM = null;
	this.zip_worldCOM = false;
	this.worldCOMy = 0.0;
	this.worldCOMx = 0.0;
	this.zip_localCOM = false;
	this.localCOMy = 0.0;
	this.localCOMx = 0.0;
	this.zip_aabb = false;
	this.aabb = null;
	this.norotate = false;
	this.sinertia = 0.0;
	this.iinertia = 0.0;
	this.cinertia = 0.0;
	this.zip_inertia = false;
	this.inertia = 0.0;
	this.inertiaMode = 0;
	this.zip_gravMassScale = false;
	this.gravMassScale = 0.0;
	this.gravMassMode = 0;
	this.zip_gravMass = false;
	this.gravMass = 0.0;
	this.nomove = false;
	this.cmass = 0.0;
	this.smass = 0.0;
	this.imass = 0.0;
	this.massMode = 0;
	this.zip_mass = false;
	this.mass = 0.0;
	this.zip_axis = false;
	this.axisy = 0.0;
	this.axisx = 0.0;
	this.rot = 0.0;
	this.pre_rot = 0.0;
	this.kinangvel = 0.0;
	this.torque = 0.0;
	this.angvel = 0.0;
	this.wrapcvel = null;
	this.wrap_svel = null;
	this.svely = 0.0;
	this.svelx = 0.0;
	this.wrap_kinvel = null;
	this.kinvely = 0.0;
	this.kinvelx = 0.0;
	this.wrap_force = null;
	this.forcey = 0.0;
	this.forcex = 0.0;
	this.wrap_vel = null;
	this.vely = 0.0;
	this.velx = 0.0;
	this.wrap_pos = null;
	this.posy = 0.0;
	this.posx = 0.0;
	this.pre_posy = 0.0;
	this.pre_posx = 0.0;
	this.disableCCD = false;
	this.bulletEnabled = false;
	this.bullet = false;
	this.sweepRadius = 0.0;
	this.sweepFrozen = false;
	this.sweep_angvel = 0.0;
	this.sweepTime = 0.0;
	this.component = null;
	this.wrap_constraints = null;
	this.constraints = null;
	this.wrap_arbiters = null;
	this.arbiters = null;
	this.space = null;
	this.wrap_shapes = null;
	this.shapes = null;
	this.compound = null;
	this.type = 0;
	this.world = false;
	this.outer = null;
	zpp_nape.phys.ZPP_Interactor.call(this);
	this.ibody = this;
	this.world = false;
	this.bulletEnabled = false;
	this.sweepTime = 0;
	this.sweep_angvel = 0;
	this.norotate = this.nomove = false;
	this.disableCCD = false;
	this.posx = 0;
	this.posy = 0;
	this.rot = 0;
	this.axisx = 0;
	this.axisy = 1;
	this.svelx = 0;
	this.svely = 0;
	this.velx = 0;
	this.vely = 0;
	this.kinvelx = 0;
	this.kinvely = 0;
	this.forcex = 0;
	this.forcey = 0;
	this.torque = this.angvel = this.kinangvel = 0;
	this.pre_posx = zpp_nape.ZPP_Const.POSINF();
	this.pre_posy = zpp_nape.ZPP_Const.POSINF();
	this.pre_rot = zpp_nape.ZPP_Const.POSINF();
	this.localCOMx = 0;
	this.localCOMy = 0;
	this.worldCOMx = 0;
	this.worldCOMy = 0;
	this.zip_aabb = true;
	this.aabb = zpp_nape.geom.ZPP_AABB.get(0,0,0,0);
	this.aabb._immutable = true;
	var me = this;
	this.aabb._validate = $bind(this,this.aabb_validate);
	this.massMode = zpp_nape.util.ZPP_Flags.id_MassMode_DEFAULT;
	this.gravMassMode = zpp_nape.util.ZPP_Flags.id_GravMassMode_DEFAULT;
	this.gravMassScale = 1.0;
	this.inertiaMode = zpp_nape.util.ZPP_Flags.id_InertiaMode_DEFAULT;
	this.arbiters = new zpp_nape.util.ZNPList_ZPP_Arbiter();
	this.constraints = new zpp_nape.util.ZNPList_ZPP_Constraint();
	this.shapes = new zpp_nape.util.ZNPList_ZPP_Shape();
	this.wrap_shapes = zpp_nape.util.ZPP_ShapeList.get(this.shapes);
	this.wrap_shapes.zpp_inner.adder = $bind(this,this.shapes_adder);
	this.wrap_shapes.zpp_inner.subber = $bind(this,this.shapes_subber);
	this.wrap_shapes.zpp_inner._invalidate = $bind(this,this.shapes_invalidate);
	this.wrap_shapes.zpp_inner._modifiable = $bind(this,this.shapes_modifiable);
	this.kinematicDelaySleep = false;
};
$hxClasses["zpp_nape.phys.ZPP_Body"] = zpp_nape.phys.ZPP_Body;
zpp_nape.phys.ZPP_Body.__name__ = ["zpp_nape","phys","ZPP_Body"];
zpp_nape.phys.ZPP_Body.__static = function() {
	var ret = new nape.phys.Body(nape.phys.BodyType.get_STATIC());
	var si = ret.zpp_inner;
	si.world = true;
	si.wrap_shapes.zpp_inner.immutable = true;
	si.smass = si.imass = si.cmass = si.mass = si.gravMass = 0.0;
	si.sinertia = si.iinertia = si.cinertia = si.inertia = 0.0;
	si.cbTypes.clear();
	return ret;
}
zpp_nape.phys.ZPP_Body.__super__ = zpp_nape.phys.ZPP_Interactor;
zpp_nape.phys.ZPP_Body.prototype = $extend(zpp_nape.phys.ZPP_Interactor.prototype,{
	copy: function() {
		var ret = new nape.phys.Body().zpp_inner;
		ret.type = this.type;
		ret.bulletEnabled = this.bulletEnabled;
		ret.disableCCD = this.disableCCD;
		var cx_ite = this.shapes.begin();
		while(cx_ite != null) {
			var s = cx_ite.elem();
			ret.outer.get_shapes().add(s.outer.copy());
			cx_ite = cx_ite.next;
		}
		ret.posx = this.posx;
		ret.posy = this.posy;
		ret.velx = this.velx;
		ret.vely = this.vely;
		ret.forcex = this.forcex;
		ret.forcey = this.forcey;
		ret.rot = this.rot;
		ret.angvel = this.angvel;
		ret.torque = this.torque;
		ret.kinvelx = this.kinvelx;
		ret.kinvely = this.kinvely;
		ret.kinangvel = this.kinangvel;
		ret.svelx = this.svelx;
		ret.svely = this.svely;
		if(!this.zip_axis) {
			ret.axisx = this.axisx;
			ret.axisy = this.axisy;
		} else ret.invalidate_rot();
		ret.rot = this.rot;
		ret.massMode = this.massMode;
		ret.gravMassMode = this.gravMassMode;
		ret.inertiaMode = this.inertiaMode;
		if(!this.zip_mass) ret.mass = this.mass; else ret.invalidate_mass();
		if(!this.zip_gravMass) ret.gravMass = this.gravMass; else ret.invalidate_gravMass();
		if(!this.zip_gravMassScale) ret.gravMassScale = this.gravMassScale; else ret.invalidate_gravMassScale();
		if(!this.zip_inertia) ret.inertia = this.inertia; else ret.invalidate_inertia();
		if(!this.zip_aabb) {
			ret.aabb.minx = this.aabb.minx;
			ret.aabb.miny = this.aabb.miny;
			ret.aabb.maxx = this.aabb.maxx;
			ret.aabb.maxy = this.aabb.maxy;
		} else ret.invalidate_aabb();
		if(!this.zip_localCOM) {
			ret.localCOMx = this.localCOMx;
			ret.localCOMy = this.localCOMy;
		} else ret.invalidate_localCOM();
		if(!this.zip_worldCOM) {
			ret.worldCOMx = this.worldCOMx;
			ret.worldCOMy = this.worldCOMy;
		} else ret.invalidate_worldCOM();
		this.copyto(ret.outer);
		return ret.outer;
	}
	,removedFromSpace: function() {
		while(!this.arbiters.empty()) {
			var arb = this.arbiters.pop_unsafe();
			arb.lazyRetire(this.space,this);
		}
		var o = this.component;
		o.free();
		o.next = zpp_nape.space.ZPP_Component.zpp_pool;
		zpp_nape.space.ZPP_Component.zpp_pool = o;
		this.component = null;
		this.__iremovedFromSpace();
	}
	,addedToSpace: function() {
		if(zpp_nape.space.ZPP_Component.zpp_pool == null) this.component = new zpp_nape.space.ZPP_Component(); else {
			this.component = zpp_nape.space.ZPP_Component.zpp_pool;
			zpp_nape.space.ZPP_Component.zpp_pool = this.component.next;
			this.component.next = null;
		}
		this.component.alloc();
		this.component.isBody = true;
		this.component.body = this;
		this.__iaddedToSpace();
	}
	,shapes_modifiable: function() {
		this.immutable_midstep("Body::shapes");
		if(this.isStatic() && this.space != null) throw "Error: Cannot modifiy shapes of static object once added to Space";
	}
	,shapes_invalidate: function(_) {
		this.invalidate_shapes();
	}
	,shapes_subber: function(s) {
		if(this.space != null) this.space.removed_shape(s.zpp_inner);
		s.zpp_inner.body = null;
		s.zpp_inner.removedFromBody();
	}
	,shapes_adder: function(s) {
		if(s.zpp_inner.body != this) {
			if(s.zpp_inner.body != null) s.zpp_inner.body.wrap_shapes.remove(s);
			s.zpp_inner.body = this;
			s.zpp_inner.addedToBody();
			if(this.space != null) this.space.added_shape(s.zpp_inner);
			if(s.zpp_inner.isPolygon()) {
				s.zpp_inner.polygon.invalidate_gaxi();
				s.zpp_inner.polygon.invalidate_gverts();
			}
			return true;
		} else return false;
	}
	,aabb_validate: function() {
		if(this.shapes.empty()) throw "Error: bounds only makes sense when Body has shapes";
		this.validate_aabb();
	}
	,__immutable_midstep: function(name) {
		if(this.space != null && this.space.midstep) throw "Error: " + name + " cannot be set during a space step()";
	}
	,getworldCOM: function() {
		if(this.shapes.empty()) throw "Error: worldCOM only makes sense when Body has Shapes";
		this.validate_worldCOM();
	}
	,getlocalCOM: function() {
		if(this.shapes.empty()) throw "Error: localCOM only makes sense when Body has Shapes";
		this.validate_localCOM();
	}
	,validate_worldCOM: function() {
		if(this.zip_worldCOM) {
			this.zip_worldCOM = false;
			this.validate_localCOM();
			this.validate_axis();
			this.worldCOMx = this.posx + (this.axisy * this.localCOMx - this.axisx * this.localCOMy);
			this.worldCOMy = this.posy + (this.localCOMx * this.axisx + this.localCOMy * this.axisy);
			if(this.wrap_worldCOM != null) {
				this.wrap_worldCOM.zpp_inner.x = this.worldCOMx;
				this.wrap_worldCOM.zpp_inner.y = this.worldCOMy;
			}
		}
	}
	,validate_localCOM: function() {
		if(this.zip_localCOM) {
			this.zip_localCOM = false;
			var tempx = 0;
			var tempy = 0;
			var msum = 0.0;
			var cx_ite = this.shapes.begin();
			while(cx_ite != null) {
				var s = cx_ite.elem();
				s.validate_localCOM();
				s.validate_area_inertia();
				var t = s.area * s.material.density;
				tempx += s.localCOMx * t;
				tempy += s.localCOMy * t;
				msum += s.area * s.material.density;
				cx_ite = cx_ite.next;
			}
			if(msum != 0) {
				var t = 1.0 / msum;
				this.localCOMx = tempx * t;
				this.localCOMy = tempy * t;
			}
			if(this.wrap_localCOM != null) {
				this.wrap_localCOM.zpp_inner.x = this.localCOMx;
				this.wrap_localCOM.zpp_inner.y = this.localCOMy;
			}
			if(this.zip_mass && this.massMode == zpp_nape.util.ZPP_Flags.id_MassMode_DEFAULT) {
				this.zip_mass = false;
				this.cmass = msum;
				if(this.isDynamic()) {
					this.mass = this.cmass;
					this.imass = this.smass = 1.0 / this.mass;
				} else {
					this.mass = zpp_nape.ZPP_Const.POSINF();
					this.imass = this.smass = 0.0;
				}
			}
		}
	}
	,invalidate_worldCOM: function() {
		this.zip_worldCOM = true;
	}
	,invalidate_localCOM: function() {
		this.zip_localCOM = true;
		this.invalidate_worldCOM();
	}
	,invalidate_aabb: function() {
		this.zip_aabb = true;
	}
	,validate_aabb: function() {
		if(this.shapes.empty()) throw "Error: Body bounds only makes sense if it contains shapes";
		if(this.zip_aabb) {
			this.zip_aabb = false;
			this.aabb.minx = zpp_nape.ZPP_Const.POSINF();
			this.aabb.miny = zpp_nape.ZPP_Const.POSINF();
			this.aabb.maxx = zpp_nape.ZPP_Const.NEGINF();
			this.aabb.maxy = zpp_nape.ZPP_Const.NEGINF();
			var cx_ite = this.shapes.begin();
			while(cx_ite != null) {
				var s = cx_ite.elem();
				s.validate_aabb();
				this.aabb.combine(s.aabb);
				cx_ite = cx_ite.next;
			}
		}
	}
	,invalidate_wake: function() {
		this.wake();
	}
	,validate_inertia: function() {
		var exist = false;
		if(this.zip_inertia || this.inertiaMode == zpp_nape.util.ZPP_Flags.id_InertiaMode_DEFAULT && exist) {
			this.zip_inertia = false;
			if(this.inertiaMode == zpp_nape.util.ZPP_Flags.id_InertiaMode_DEFAULT) {
				this.cinertia = 0;
				var cx_ite = this.shapes.begin();
				while(cx_ite != null) {
					var s = cx_ite.elem();
					s.refmaterial.density = s.material.density;
					s.validate_area_inertia();
					this.cinertia += s.inertia * s.area * s.material.density;
					cx_ite = cx_ite.next;
				}
			}
			if(this.isDynamic() && !this.norotate) {
				this.inertia = this.cinertia;
				this.sinertia = this.iinertia = 1.0 / this.inertia;
			} else {
				this.inertia = zpp_nape.ZPP_Const.POSINF();
				this.sinertia = this.iinertia = 0;
			}
			if(exist) this.invalidate_inertia();
		}
	}
	,invalidate_inertia: function() {
		this.zip_inertia = true;
		this.wake();
	}
	,validate_gravMassScale: function() {
		if(this.zip_gravMassScale) {
			this.zip_gravMassScale = false;
			if(this.gravMassMode == zpp_nape.util.ZPP_Flags.id_GravMassMode_DEFAULT) this.gravMassScale = 1.0; else if(this.gravMassMode == zpp_nape.util.ZPP_Flags.id_GravMassMode_FIXED) {
				this.validate_mass();
				this.gravMassScale = this.gravMass / this.cmass;
			}
		}
	}
	,invalidate_gravMassScale: function() {
		if(this.gravMassMode != zpp_nape.util.ZPP_Flags.id_GravMassMode_SCALED) this.zip_gravMassScale = true; else this.invalidate_gravMass();
	}
	,validate_gravMass: function() {
		if(this.zip_gravMass) {
			this.zip_gravMass = false;
			this.validate_mass();
			if(this.gravMassMode == zpp_nape.util.ZPP_Flags.id_GravMassMode_DEFAULT) {
				this.validate_mass();
				this.gravMass = this.cmass;
			} else if(this.gravMassMode == zpp_nape.util.ZPP_Flags.id_GravMassMode_SCALED) {
				this.validate_mass();
				this.gravMass = this.cmass * this.gravMassScale;
			}
		}
	}
	,invalidate_gravMass: function() {
		if(this.gravMassMode != zpp_nape.util.ZPP_Flags.id_GravMassMode_FIXED) this.zip_gravMass = true;
		if(this.gravMassMode != zpp_nape.util.ZPP_Flags.id_GravMassMode_SCALED) this.zip_gravMassScale = true;
		this.wake();
	}
	,validate_mass: function() {
		var exist = false;
		if(this.zip_mass || this.massMode == zpp_nape.util.ZPP_Flags.id_MassMode_DEFAULT && exist) {
			this.zip_mass = false;
			if(this.massMode == zpp_nape.util.ZPP_Flags.id_MassMode_DEFAULT) {
				this.cmass = 0;
				var cx_ite = this.shapes.begin();
				while(cx_ite != null) {
					var s = cx_ite.elem();
					s.refmaterial.density = s.material.density;
					s.validate_area_inertia();
					this.cmass += s.area * s.material.density;
					cx_ite = cx_ite.next;
				}
			}
			if(this.isDynamic() && !this.nomove) {
				this.mass = this.cmass;
				this.imass = this.smass = 1.0 / this.mass;
			} else {
				this.mass = zpp_nape.ZPP_Const.POSINF();
				this.imass = this.smass = 0.0;
			}
			if(exist) this.invalidate_inertia();
		}
	}
	,invalidate_mass: function() {
		this.zip_mass = true;
		this.invalidate_gravMass();
	}
	,delta_rot: function(dr) {
		this.rot += dr;
		if(dr * dr > 0.0001) this.quick_validate_axis(); else {
			var d2 = dr * dr;
			var p = 1 - 0.5 * d2;
			var m = 1 - d2 * d2 / 8;
			var nx = (p * this.axisx + dr * this.axisy) * m;
			this.axisy = (p * this.axisy - dr * this.axisx) * m;
			this.axisx = nx;
		}
	}
	,quick_validate_axis: function() {
		this.axisx = Math.sin(this.rot);
		this.axisy = Math.cos(this.rot);
	}
	,validate_axis: function() {
		if(this.zip_axis) {
			this.zip_axis = false;
			this.quick_validate_axis();
		}
	}
	,invalidate_rot: function() {
		this.zip_axis = true;
		var cx_ite = this.shapes.begin();
		while(cx_ite != null) {
			var s = cx_ite.elem();
			if(s.type == zpp_nape.util.ZPP_Flags.id_ShapeType_POLYGON) {
				s.polygon.invalidate_gverts();
				s.polygon.invalidate_gaxi();
			}
			s.invalidate_worldCOM();
			cx_ite = cx_ite.next;
		}
		this.invalidate_worldCOM();
	}
	,setup_cvel: function() {
		var me = this;
		this.wrapcvel = nape.geom.Vec3.get();
		this.wrapcvel.zpp_inner.immutable = true;
		this.wrapcvel.zpp_inner._validate = $bind(this,this.cvel_validate);
	}
	,cvel_validate: function() {
		this.wrapcvel.zpp_inner.x = this.velx + this.kinvelx;
		this.wrapcvel.zpp_inner.y = this.vely + this.kinvely;
		this.wrapcvel.zpp_inner.z = this.angvel + this.kinangvel;
	}
	,setupForce: function() {
		this.wrap_force = nape.geom.Vec2.get(this.forcex,this.forcey);
		this.wrap_force.zpp_inner._inuse = true;
		if(this.world) this.wrap_force.zpp_inner._immutable = true; else {
			this.wrap_force.zpp_inner._invalidate = $bind(this,this.force_invalidate);
			this.wrap_force.zpp_inner._validate = $bind(this,this.force_validate);
		}
	}
	,setupsvel: function() {
		this.wrap_svel = nape.geom.Vec2.get(this.svelx,this.svely);
		this.wrap_svel.zpp_inner._inuse = true;
		if(this.world) this.wrap_svel.zpp_inner._immutable = true; else {
			this.wrap_svel.zpp_inner._invalidate = $bind(this,this.svel_invalidate);
			this.wrap_svel.zpp_inner._validate = $bind(this,this.svel_validate);
		}
	}
	,setupkinvel: function() {
		this.wrap_kinvel = nape.geom.Vec2.get(this.kinvelx,this.kinvely);
		this.wrap_kinvel.zpp_inner._inuse = true;
		if(this.world) this.wrap_kinvel.zpp_inner._immutable = true; else {
			this.wrap_kinvel.zpp_inner._invalidate = $bind(this,this.kinvel_invalidate);
			this.wrap_kinvel.zpp_inner._validate = $bind(this,this.kinvel_validate);
		}
	}
	,setupVelocity: function() {
		this.wrap_vel = nape.geom.Vec2.get(this.velx,this.vely);
		this.wrap_vel.zpp_inner._inuse = true;
		if(this.world) this.wrap_vel.zpp_inner._immutable = true; else {
			this.wrap_vel.zpp_inner._invalidate = $bind(this,this.vel_invalidate);
			this.wrap_vel.zpp_inner._validate = $bind(this,this.vel_validate);
		}
	}
	,setupPosition: function() {
		this.wrap_pos = nape.geom.Vec2.get(this.posx,this.posy);
		this.wrap_pos.zpp_inner._inuse = true;
		if(this.world) this.wrap_pos.zpp_inner._immutable = true; else {
			this.wrap_pos.zpp_inner._invalidate = $bind(this,this.pos_invalidate);
			this.wrap_pos.zpp_inner._validate = $bind(this,this.pos_validate);
		}
	}
	,force_validate: function() {
		this.wrap_force.zpp_inner.x = this.forcex;
		this.wrap_force.zpp_inner.y = this.forcey;
	}
	,force_invalidate: function(force) {
		if(!this.isDynamic()) throw "Error: Non-dynamic body cannot have force applied.";
		this.forcex = force.x;
		this.forcey = force.y;
		this.invalidate_wake();
	}
	,svel_validate: function() {
		this.wrap_svel.zpp_inner.x = this.svelx;
		this.wrap_svel.zpp_inner.y = this.svely;
	}
	,svel_invalidate: function(vel) {
		this.svelx = vel.x;
		this.svely = vel.y;
		this.invalidate_wake();
	}
	,kinvel_validate: function() {
		this.wrap_kinvel.zpp_inner.x = this.kinvelx;
		this.wrap_kinvel.zpp_inner.y = this.kinvely;
	}
	,kinvel_invalidate: function(vel) {
		this.kinvelx = vel.x;
		this.kinvely = vel.y;
		this.invalidate_wake();
	}
	,vel_validate: function() {
		this.wrap_vel.zpp_inner.x = this.velx;
		this.wrap_vel.zpp_inner.y = this.vely;
	}
	,vel_invalidate: function(vel) {
		if(this.isStatic()) throw "Error: Static body cannot have its velocity set.";
		this.velx = vel.x;
		this.vely = vel.y;
		this.invalidate_wake();
	}
	,pos_validate: function() {
		this.wrap_pos.zpp_inner.x = this.posx;
		this.wrap_pos.zpp_inner.y = this.posy;
	}
	,pos_invalidate: function(pos) {
		this.immutable_midstep("Body::position");
		if(this.isStatic() && this.space != null) throw "Error: Cannot move a static object once inside a Space";
		if(!(this.posx == pos.x && this.posy == pos.y)) {
			this.posx = pos.x;
			this.posy = pos.y;
			this.invalidate_pos();
			this.wake();
		}
	}
	,invalidate_pos: function() {
		var cx_ite = this.shapes.begin();
		while(cx_ite != null) {
			var s = cx_ite.elem();
			if(s.type == zpp_nape.util.ZPP_Flags.id_ShapeType_POLYGON) {
				s.polygon.invalidate_gverts();
				s.polygon.invalidate_gaxi();
			}
			s.invalidate_worldCOM();
			cx_ite = cx_ite.next;
		}
		this.invalidate_worldCOM();
	}
	,sweepValidate: function(s) {
		if(s.isCircle()) {
			s.worldCOMx = this.posx + (this.axisy * s.localCOMx - this.axisx * s.localCOMy);
			s.worldCOMy = this.posy + (s.localCOMx * this.axisx + s.localCOMy * this.axisy);
		} else {
			var p = s.polygon;
			var li = p.lverts.begin();
			var cx_ite = p.gverts.begin();
			while(cx_ite != null) {
				var g = cx_ite.elem();
				var l = li.elem();
				li = li.next;
				g.x = this.posx + (this.axisy * l.x - this.axisx * l.y);
				g.y = this.posy + (l.x * this.axisx + l.y * this.axisy);
				cx_ite = cx_ite.next;
			}
			var ite = p.edges.begin();
			var cx_ite = p.gverts.begin();
			var u = cx_ite.elem();
			cx_ite = cx_ite.next;
			while(cx_ite != null) {
				var v = cx_ite.elem();
				var e = ite.elem();
				ite = ite.next;
				e.gnormx = this.axisy * e.lnormx - this.axisx * e.lnormy;
				e.gnormy = e.lnormx * this.axisx + e.lnormy * this.axisy;
				e.gprojection = this.posx * e.gnormx + this.posy * e.gnormy + e.lprojection;
				e.tp0 = u.y * e.gnormx - u.x * e.gnormy;
				e.tp1 = v.y * e.gnormx - v.x * e.gnormy;
				u = v;
				cx_ite = cx_ite.next;
			}
			var v = p.gverts.front();
			var e = ite.elem();
			ite = ite.next;
			e.gnormx = this.axisy * e.lnormx - this.axisx * e.lnormy;
			e.gnormy = e.lnormx * this.axisx + e.lnormy * this.axisy;
			e.gprojection = this.posx * e.gnormx + this.posy * e.gnormy + e.lprojection;
			e.tp0 = u.y * e.gnormx - u.x * e.gnormy;
			e.tp1 = v.y * e.gnormx - v.x * e.gnormy;
		}
	}
	,sweepIntegrate: function(dt) {
		var delta = dt - this.sweepTime;
		if(delta != 0) {
			this.sweepTime = dt;
			var t = delta;
			this.posx += this.velx * t;
			this.posy += this.vely * t;
			if(this.angvel != 0) this.delta_rot(this.sweep_angvel * delta);
		}
	}
	,refreshArbiters: function() {
		var cx_ite = this.arbiters.begin();
		while(cx_ite != null) {
			var arb = cx_ite.elem();
			arb.invalidated = true;
			cx_ite = cx_ite.next;
		}
	}
	,atRest: function(dt) {
		if(!this.isDynamic()) return this.component.sleeping; else {
			var linSq = nape.Config.linearSleepThreshold;
			linSq *= linSq;
			var cansleep = this.velx * this.velx + this.vely * this.vely > linSq?false:zpp_nape.geom.ZPP_VecMath.vec_dsq(this.posx,this.posy,this.pre_posx,this.pre_posy) > 0.25 * linSq * dt * dt?false:(function($this) {
				var $r;
				var dx = 0.0;
				var dy = 0.0;
				{
					dx = $this.aabb.maxx - $this.aabb.minx;
					dy = $this.aabb.maxy - $this.aabb.miny;
				}
				var idl = dx * dx + dy * dy;
				var angSq = nape.Config.angularSleepThreshold;
				angSq *= angSq;
				$r = 4 * $this.angvel * $this.angvel * idl > angSq?false:(function($this) {
					var $r;
					var dr = $this.rot - $this.pre_rot;
					$r = dr * dr * idl > angSq * dt * dt?false:true;
					return $r;
				}($this));
				return $r;
			}(this));
			if(!cansleep) this.component.waket = this.space.stamp;
			return this.component.waket + nape.Config.sleepDelay < this.space.stamp;
		}
	}
	,invalidate_shapes: function() {
		this.invalidate_aabb();
		this.invalidate_localCOM();
		this.invalidate_mass();
		this.invalidate_inertia();
	}
	,invalidate_type: function() {
		this.invalidate_mass();
		this.invalidate_inertia();
	}
	,isKinematic: function() {
		return this.type == zpp_nape.util.ZPP_Flags.id_BodyType_KINEMATIC;
	}
	,isDynamic: function() {
		return this.type == zpp_nape.util.ZPP_Flags.id_BodyType_DYNAMIC;
	}
	,isStatic: function() {
		return this.type == zpp_nape.util.ZPP_Flags.id_BodyType_STATIC;
	}
	,__class__: zpp_nape.phys.ZPP_Body
});
zpp_nape.phys.ZPP_Compound = function() {
	this.space = null;
	this.compound = null;
	this.depth = 0;
	this.wrap_compounds = null;
	this.wrap_constraints = null;
	this.wrap_bodies = null;
	this.compounds = null;
	this.constraints = null;
	this.bodies = null;
	this.outer = null;
};
$hxClasses["zpp_nape.phys.ZPP_Compound"] = zpp_nape.phys.ZPP_Compound;
zpp_nape.phys.ZPP_Compound.__name__ = ["zpp_nape","phys","ZPP_Compound"];
zpp_nape.phys.ZPP_Compound.__super__ = zpp_nape.phys.ZPP_Interactor;
zpp_nape.phys.ZPP_Compound.prototype = $extend(zpp_nape.phys.ZPP_Interactor.prototype,{
	removedFromSpace: function() {
		this.__iremovedFromSpace();
	}
	,addedToSpace: function() {
		this.__iaddedToSpace();
	}
	,__imutable_midstep: function(name) {
		if(this.space != null && this.space.midstep) throw "Error: " + name + " cannot be set during space step()";
	}
	,__class__: zpp_nape.phys.ZPP_Compound
});
zpp_nape.phys.ZPP_FluidProperties = function() {
	this.wrap_gravity = null;
	this.gravityy = 0.0;
	this.gravityx = 0.0;
	this.density = 0.0;
	this.viscosity = 0.0;
	this.wrap_shapes = null;
	this.shapes = null;
	this.outer = null;
	this.userData = null;
	this.next = null;
	this.feature_cons();
	this.density = this.viscosity = 1;
	this.wrap_gravity = null;
	this.gravityx = 0;
	this.gravityy = 0;
};
$hxClasses["zpp_nape.phys.ZPP_FluidProperties"] = zpp_nape.phys.ZPP_FluidProperties;
zpp_nape.phys.ZPP_FluidProperties.__name__ = ["zpp_nape","phys","ZPP_FluidProperties"];
zpp_nape.phys.ZPP_FluidProperties.prototype = {
	invalidate: function() {
		var cx_ite = this.shapes.begin();
		while(cx_ite != null) {
			var shape = cx_ite.elem();
			shape.invalidate_fluidprops();
			cx_ite = cx_ite.next;
		}
	}
	,getgravity: function() {
		this.wrap_gravity = nape.geom.Vec2.get(this.gravityx,this.gravityy);
		this.wrap_gravity.zpp_inner._inuse = true;
		this.wrap_gravity.zpp_inner._invalidate = $bind(this,this.gravity_invalidate);
		this.wrap_gravity.zpp_inner._validate = $bind(this,this.gravity_validate);
	}
	,gravity_validate: function() {
		this.wrap_gravity.zpp_inner.x = this.gravityx;
		this.wrap_gravity.zpp_inner.y = this.gravityy;
	}
	,gravity_invalidate: function(x) {
		this.gravityx = x.x;
		this.gravityy = x.y;
		this.invalidate();
	}
	,remShape: function(shape) {
		this.shapes.remove(shape);
	}
	,addShape: function(shape) {
		this.shapes.add(shape);
	}
	,feature_cons: function() {
		this.shapes = new zpp_nape.util.ZNPList_ZPP_Shape();
	}
	,alloc: function() {
	}
	,free: function() {
		this.outer = null;
	}
	,wrapper: function() {
		if(this.outer == null) {
			this.outer = new nape.phys.FluidProperties();
			var o = this.outer.zpp_inner;
			o.free();
			o.next = zpp_nape.phys.ZPP_FluidProperties.zpp_pool;
			zpp_nape.phys.ZPP_FluidProperties.zpp_pool = o;
			this.outer.zpp_inner = this;
		}
		return this.outer;
	}
	,__class__: zpp_nape.phys.ZPP_FluidProperties
}
zpp_nape.phys.ZPP_Material = function() {
	this.rollingFriction = 0.0;
	this.elasticity = 0.0;
	this.density = 0.0;
	this.staticFriction = 0.0;
	this.dynamicFriction = 0.0;
	this.wrap_shapes = null;
	this.shapes = null;
	this.outer = null;
	this.userData = null;
	this.next = null;
	this.feature_cons();
	this.elasticity = 0;
	this.dynamicFriction = 1;
	this.staticFriction = 2;
	this.density = 0.001;
	this.rollingFriction = 0.01;
};
$hxClasses["zpp_nape.phys.ZPP_Material"] = zpp_nape.phys.ZPP_Material;
zpp_nape.phys.ZPP_Material.__name__ = ["zpp_nape","phys","ZPP_Material"];
zpp_nape.phys.ZPP_Material.prototype = {
	invalidate: function(x) {
		var cx_ite = this.shapes.begin();
		while(cx_ite != null) {
			var s = cx_ite.elem();
			s.invalidate_material(x);
			cx_ite = cx_ite.next;
		}
	}
	,set: function(x) {
		this.dynamicFriction = x.dynamicFriction;
		this.staticFriction = x.staticFriction;
		this.density = x.density;
		this.elasticity = x.elasticity;
		this.rollingFriction = x.rollingFriction;
	}
	,remShape: function(shape) {
		this.shapes.remove(shape);
	}
	,addShape: function(shape) {
		this.shapes.add(shape);
	}
	,feature_cons: function() {
		this.shapes = new zpp_nape.util.ZNPList_ZPP_Shape();
	}
	,alloc: function() {
	}
	,free: function() {
		this.outer = null;
	}
	,wrapper: function() {
		if(this.outer == null) {
			this.outer = new nape.phys.Material();
			var o = this.outer.zpp_inner;
			o.free();
			o.next = zpp_nape.phys.ZPP_Material.zpp_pool;
			zpp_nape.phys.ZPP_Material.zpp_pool = o;
			this.outer.zpp_inner = this;
		}
		return this.outer;
	}
	,__class__: zpp_nape.phys.ZPP_Material
}
zpp_nape.shape = {}
zpp_nape.shape.ZPP_Shape = function(type) {
	this.zip_aabb = false;
	this.aabb = null;
	this.pairs = null;
	this.node = null;
	this.sweep = null;
	this.sensorEnabled = false;
	this.fluidEnabled = false;
	this.fluidProperties = null;
	this.filter = null;
	this.material = null;
	this.refmaterial = null;
	this.polygon = null;
	this.circle = null;
	this.sweepCoef = 0.0;
	this.zip_sweepRadius = false;
	this.sweepRadius = 0.0;
	this.wrap_worldCOM = null;
	this.wrap_localCOM = null;
	this.zip_worldCOM = false;
	this.worldCOMy = 0.0;
	this.worldCOMx = 0.0;
	this.zip_localCOM = false;
	this.localCOMy = 0.0;
	this.localCOMx = 0.0;
	this.zip_angDrag = false;
	this.angDrag = 0.0;
	this.inertia = 0.0;
	this.zip_area_inertia = false;
	this.area = 0.0;
	this.type = 0;
	this.body = null;
	this.outer = null;
	zpp_nape.phys.ZPP_Interactor.call(this);
	this.pairs = new zpp_nape.util.ZNPList_ZPP_AABBPair();
	this.ishape = this;
	this.type = type;
	this.aabb = zpp_nape.geom.ZPP_AABB.get(0,0,0,0);
	this.aabb._immutable = true;
	var me = this;
	this.aabb._validate = $bind(this,this.aabb_validate);
	this.zip_area_inertia = this.zip_angDrag = this.zip_localCOM = this.zip_sweepRadius = true;
	this.localCOMx = 0;
	this.localCOMy = 0;
	this.worldCOMx = 0;
	this.worldCOMy = 0;
	this.fluidEnabled = false;
	this.sensorEnabled = false;
	this.fluidProperties = null;
	this.body = null;
	this.refmaterial = new zpp_nape.phys.ZPP_Material();
	this.sweepRadius = this.sweepCoef = 0;
};
$hxClasses["zpp_nape.shape.ZPP_Shape"] = zpp_nape.shape.ZPP_Shape;
zpp_nape.shape.ZPP_Shape.__name__ = ["zpp_nape","shape","ZPP_Shape"];
zpp_nape.shape.ZPP_Shape.__super__ = zpp_nape.phys.ZPP_Interactor;
zpp_nape.shape.ZPP_Shape.prototype = $extend(zpp_nape.phys.ZPP_Interactor.prototype,{
	copy: function() {
		var ret = null;
		if(this.isCircle()) ret = this.circle.__copy(); else ret = this.polygon.__copy();
		if(!this.zip_area_inertia) {
			ret.area = this.area;
			ret.inertia = this.inertia;
		} else ret.invalidate_area_inertia();
		if(!this.zip_sweepRadius) {
			ret.sweepRadius = this.sweepRadius;
			ret.sweepCoef = this.sweepCoef;
		} else ret.invalidate_sweepRadius();
		if(!this.zip_angDrag) ret.angDrag = this.angDrag; else ret.invalidate_angDrag();
		if(!this.zip_aabb) {
			ret.aabb.minx = this.aabb.minx;
			ret.aabb.miny = this.aabb.miny;
			ret.aabb.maxx = this.aabb.maxx;
			ret.aabb.maxy = this.aabb.maxy;
		} else ret.invalidate_aabb();
		var o = ret.material;
		o.free();
		o.next = zpp_nape.phys.ZPP_Material.zpp_pool;
		zpp_nape.phys.ZPP_Material.zpp_pool = o;
		var o = ret.filter;
		o.free();
		o.next = zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool;
		zpp_nape.dynamics.ZPP_InteractionFilter.zpp_pool = o;
		ret.material = this.material;
		ret.filter = this.filter;
		if(this.fluidProperties != null) ret.fluidProperties = this.fluidProperties;
		ret.fluidEnabled = this.fluidEnabled;
		ret.sensorEnabled = this.sensorEnabled;
		if(this.userData != null) ret.userData = Reflect.copy(this.userData);
		this.copyto(ret.outer);
		return ret.outer;
	}
	,removedFromSpace: function() {
		this.__iremovedFromSpace();
		this.material.remShape(this);
		this.filter.remShape(this);
		if(this.fluidProperties != null) this.fluidProperties.remShape(this);
	}
	,addedToSpace: function() {
		this.__iaddedToSpace();
		this.material.addShape(this);
		this.filter.addShape(this);
		if(this.fluidProperties != null) this.fluidProperties.addShape(this);
	}
	,removedFromBody: function() {
	}
	,addedToBody: function() {
		this.invalidate_worldCOM();
		this.invalidate_aabb();
	}
	,__immutable_midstep: function(name) {
		if(this.body != null && this.body.space != null && this.body.space.midstep) throw "Error: " + name + " cannot be set during a space step()";
	}
	,setFluid: function(fluid) {
		if(this.fluidProperties != fluid) {
			if(this.body != null && this.body.space != null) {
				if(this.fluidProperties != null) this.fluidProperties.remShape(this);
			}
			this.fluidProperties = fluid;
			if(this.body != null && this.body.space != null) fluid.addShape(this);
			if(this.fluidEnabled) this.wake();
		}
	}
	,setFilter: function(filter) {
		if(this.filter != filter) {
			if(this.body != null && this.body.space != null) {
				if(this.filter != null) this.filter.remShape(this);
			}
			this.filter = filter;
			if(this.body != null && this.body.space != null) filter.addShape(this);
			this.wake();
		}
	}
	,setMaterial: function(material) {
		if(this.material != material) {
			if(this.body != null && this.body.space != null) {
				if(this.material != null) this.material.remShape(this);
			}
			this.material = material;
			if(this.body != null && this.body.space != null) material.addShape(this);
			this.wake();
			if(this.body != null) this.body.refreshArbiters();
		}
	}
	,aabb_validate: function() {
		if(this.body == null) throw "Error: bounds only makes sense when Shape belongs to a Body";
		this.validate_aabb();
	}
	,invalidate_fluidprops: function() {
		if(this.fluidEnabled) this.wake();
	}
	,invalidate_filter: function() {
		this.wake();
	}
	,invalidate_material: function(flags) {
		if((flags & zpp_nape.phys.ZPP_Material.WAKE) != 0) this.wake();
		if((flags & zpp_nape.phys.ZPP_Material.ARBITERS) != 0) {
			if(this.body != null) this.body.refreshArbiters();
		}
		if((flags & zpp_nape.phys.ZPP_Material.PROPS) != 0) {
			if(this.body != null) {
				this.body.invalidate_localCOM();
				this.body.invalidate_mass();
				this.body.invalidate_inertia();
			}
		}
		if((flags & zpp_nape.phys.ZPP_Material.ANGDRAG) != 0) this.invalidate_angDrag();
		this.refmaterial.set(this.material);
	}
	,invalidate_worldCOM: function() {
		this.zip_worldCOM = true;
		this.invalidate_aabb();
	}
	,invalidate_localCOM: function() {
		this.zip_localCOM = true;
		this.invalidate_area_inertia();
		if(this.isCircle()) this.invalidate_sweepRadius();
		this.invalidate_angDrag();
		this.invalidate_worldCOM();
		if(this.body != null) this.body.invalidate_localCOM();
	}
	,invalidate_angDrag: function() {
		this.zip_angDrag = true;
	}
	,invalidate_area_inertia: function() {
		this.zip_area_inertia = true;
		if(this.body != null) {
			this.body.invalidate_localCOM();
			this.body.invalidate_mass();
			this.body.invalidate_inertia();
		}
	}
	,getworldCOM: function() {
		if(this.body == null) throw "Error: worldCOM only makes sense when Shape belongs to a Body";
		this.validate_worldCOM();
		this.wrap_worldCOM.zpp_inner.x = this.worldCOMx;
		this.wrap_worldCOM.zpp_inner.y = this.worldCOMy;
	}
	,validate_worldCOM: function() {
		if(this.zip_worldCOM) {
			if(this.body != null) {
				this.zip_worldCOM = false;
				this.validate_localCOM();
				this.body.validate_axis();
				this.worldCOMx = this.body.posx + (this.body.axisy * this.localCOMx - this.body.axisx * this.localCOMy);
				this.worldCOMy = this.body.posy + (this.localCOMx * this.body.axisx + this.localCOMy * this.body.axisy);
			}
		}
	}
	,validate_localCOM: function() {
		if(this.zip_localCOM) {
			this.zip_localCOM = false;
			if(this.isPolygon()) this.polygon.__validate_localCOM();
		}
	}
	,validate_angDrag: function() {
		if(this.zip_angDrag || this.refmaterial.dynamicFriction != this.material.dynamicFriction) {
			this.zip_angDrag = false;
			this.refmaterial.dynamicFriction = this.material.dynamicFriction;
			if(this.isCircle()) this.circle.__validate_angDrag(); else this.polygon.__validate_angDrag();
		}
	}
	,validate_area_inertia: function() {
		if(this.zip_area_inertia) {
			this.zip_area_inertia = false;
			if(this.isCircle()) this.circle.__validate_area_inertia(); else this.polygon.__validate_area_inertia();
		}
	}
	,invalidate_aabb: function() {
		this.zip_aabb = true;
		if(this.body != null) this.body.invalidate_aabb();
	}
	,force_validate_aabb: function() {
		if(this.isCircle()) this.circle._force_validate_aabb(); else this.polygon._force_validate_aabb();
	}
	,validate_aabb: function() {
		if(this.zip_aabb) {
			if(this.body != null) {
				this.zip_aabb = false;
				if(this.isCircle()) this.circle.__validate_aabb(); else this.polygon.__validate_aabb();
			}
		}
	}
	,validate_sweepRadius: function() {
		if(this.zip_sweepRadius) {
			this.zip_sweepRadius = false;
			if(this.isCircle()) this.circle.__validate_sweepRadius(); else this.polygon.__validate_sweepRadius();
		}
	}
	,invalidate_sweepRadius: function() {
		this.zip_sweepRadius = true;
	}
	,isPolygon: function() {
		return this.type == zpp_nape.util.ZPP_Flags.id_ShapeType_POLYGON;
	}
	,isCircle: function() {
		return this.type == zpp_nape.util.ZPP_Flags.id_ShapeType_CIRCLE;
	}
	,__class__: zpp_nape.shape.ZPP_Shape
});
zpp_nape.shape.ZPP_Circle = function() {
	this.radius = 0.0;
	this.outer_zn = null;
	zpp_nape.shape.ZPP_Shape.call(this,zpp_nape.util.ZPP_Flags.id_ShapeType_CIRCLE);
	this.circle = this;
	this.zip_localCOM = false;
};
$hxClasses["zpp_nape.shape.ZPP_Circle"] = zpp_nape.shape.ZPP_Circle;
zpp_nape.shape.ZPP_Circle.__name__ = ["zpp_nape","shape","ZPP_Circle"];
zpp_nape.shape.ZPP_Circle.__super__ = zpp_nape.shape.ZPP_Shape;
zpp_nape.shape.ZPP_Circle.prototype = $extend(zpp_nape.shape.ZPP_Shape.prototype,{
	__copy: function() {
		var ret = new nape.shape.Circle(this.radius).zpp_inner_zn;
		ret.localCOMx = this.localCOMx;
		ret.localCOMy = this.localCOMy;
		ret.zip_localCOM = false;
		return ret;
	}
	,__transform: function(m) {
		var det = m.get_a() * m.get_d() - m.get_b() * m.get_c();
		if(det < 0) det = -det;
		this.radius *= Math.sqrt(det);
		var t = m.get_a() * this.localCOMx + m.get_b() * this.localCOMy + m.get_tx();
		this.localCOMy = m.get_c() * this.localCOMx + m.get_d() * this.localCOMy + m.get_ty();
		this.localCOMx = t;
		this.invalidate_radius();
		this.invalidate_localCOM();
	}
	,__translate: function(x,y) {
		var t = 1.0;
		this.localCOMx += x * t;
		this.localCOMy += y * t;
		this.invalidate_localCOM();
	}
	,__validate_angDrag: function() {
		var lc = this.localCOMx * this.localCOMx + this.localCOMy * this.localCOMy;
		var r2 = this.radius * this.radius;
		var skin = this.material.dynamicFriction * nape.Config.fluidAngularDragFriction;
		this.angDrag = (lc + 2 * r2) * skin + 0.5 * nape.Config.fluidAngularDrag * (1 + nape.Config.fluidVacuumDrag) * lc;
		this.angDrag /= 2 * (lc + 0.5 * r2);
	}
	,__validate_area_inertia: function() {
		var r2 = this.radius * this.radius;
		this.area = r2 * Math.PI;
		this.inertia = r2 * 0.5 + (this.localCOMx * this.localCOMx + this.localCOMy * this.localCOMy);
	}
	,__validate_sweepRadius: function() {
		this.sweepCoef = Math.sqrt(this.localCOMx * this.localCOMx + this.localCOMy * this.localCOMy);
		this.sweepRadius = this.sweepCoef + this.radius;
	}
	,_force_validate_aabb: function() {
		this.worldCOMx = this.body.posx + (this.body.axisy * this.localCOMx - this.body.axisx * this.localCOMy);
		this.worldCOMy = this.body.posy + (this.localCOMx * this.body.axisx + this.localCOMy * this.body.axisy);
		this.aabb.minx = this.worldCOMx - this.radius;
		this.aabb.miny = this.worldCOMy - this.radius;
		this.aabb.maxx = this.worldCOMx + this.radius;
		this.aabb.maxy = this.worldCOMy + this.radius;
	}
	,__validate_aabb: function() {
		this.validate_worldCOM();
		var rx = this.radius;
		var ry = this.radius;
		this.aabb.minx = this.worldCOMx - rx;
		this.aabb.miny = this.worldCOMy - ry;
		this.aabb.maxx = this.worldCOMx + rx;
		this.aabb.maxy = this.worldCOMy + ry;
	}
	,setupLocalCOM: function() {
		var me = this;
		this.wrap_localCOM = nape.geom.Vec2.get(this.localCOMx,this.localCOMy);
		this.wrap_localCOM.zpp_inner._inuse = true;
		this.wrap_localCOM.zpp_inner._validate = $bind(this,this.localCOM_validate);
		this.wrap_localCOM.zpp_inner._invalidate = $bind(this,this.localCOM_invalidate);
		this.wrap_localCOM.zpp_inner._isimmutable = $bind(this,this.localCOM_immutable);
	}
	,localCOM_immutable: function() {
		if(this.body != null && this.body.isStatic() && this.body.space != null) throw "Error: Cannot modify localCOM of Circle added to a static Body whilst within a Space";
	}
	,localCOM_invalidate: function(x) {
		this.localCOMx = x.x;
		this.localCOMy = x.y;
		this.invalidate_localCOM();
		if(this.body != null) this.body.wake();
	}
	,localCOM_validate: function() {
		this.wrap_localCOM.zpp_inner.x = this.localCOMx;
		this.wrap_localCOM.zpp_inner.y = this.localCOMy;
	}
	,invalidate_radius: function() {
		this.invalidate_area_inertia();
		this.invalidate_angDrag();
		this.invalidate_aabb();
		if(this.body != null) this.body.wake();
	}
	,__class__: zpp_nape.shape.ZPP_Circle
});
zpp_nape.shape.ZPP_Edge = function() {
	this.tp1 = 0.0;
	this.tp0 = 0.0;
	this.gp1 = null;
	this.lp1 = null;
	this.gp0 = null;
	this.lp0 = null;
	this.gprojection = 0.0;
	this.lprojection = 0.0;
	this.length = 0.0;
	this.wrap_gnorm = null;
	this.gnormy = 0.0;
	this.gnormx = 0.0;
	this.wrap_lnorm = null;
	this.lnormy = 0.0;
	this.lnormx = 0.0;
	this.outer = null;
	this.polygon = null;
	this.next = null;
	this.lnormx = 0;
	this.lnormy = 0;
	this.gnormx = 0;
	this.gnormy = 0;
	this.length = 0;
	this.lprojection = 0;
	this.gprojection = 0;
};
$hxClasses["zpp_nape.shape.ZPP_Edge"] = zpp_nape.shape.ZPP_Edge;
zpp_nape.shape.ZPP_Edge.__name__ = ["zpp_nape","shape","ZPP_Edge"];
zpp_nape.shape.ZPP_Edge.prototype = {
	getgnorm: function() {
		this.wrap_gnorm = nape.geom.Vec2.get(this.gnormx,this.gnormy);
		this.wrap_gnorm.zpp_inner._immutable = true;
		this.wrap_gnorm.zpp_inner._validate = $bind(this,this.gnorm_validate);
	}
	,getlnorm: function() {
		this.wrap_lnorm = nape.geom.Vec2.get(this.lnormx,this.lnormy);
		this.wrap_lnorm.zpp_inner._immutable = true;
		this.wrap_lnorm.zpp_inner._validate = $bind(this,this.lnorm_validate);
	}
	,gnorm_validate: function() {
		if(this.polygon == null) throw "Error: Edge not currently in use";
		if(this.polygon.body == null) throw "Error: Edge worldNormal only makes sense if the parent Polygon is contained within a rigid body";
		this.polygon.validate_gaxi();
		this.wrap_gnorm.zpp_inner.x = this.gnormx;
		this.wrap_gnorm.zpp_inner.y = this.gnormy;
	}
	,lnorm_validate: function() {
		if(this.polygon == null) throw "Error: Edge not currently in use";
		this.polygon.validate_laxi();
		this.wrap_lnorm.zpp_inner.x = this.lnormx;
		this.wrap_lnorm.zpp_inner.y = this.lnormy;
	}
	,wrapper: function() {
		if(this.outer == null) {
			zpp_nape.shape.ZPP_Edge.internal = true;
			this.outer = new nape.shape.Edge();
			zpp_nape.shape.ZPP_Edge.internal = false;
			this.outer.zpp_inner = this;
		}
		return this.outer;
	}
	,alloc: function() {
	}
	,free: function() {
		this.polygon = null;
	}
	,__class__: zpp_nape.shape.ZPP_Edge
}
zpp_nape.shape.ZPP_Polygon = function() {
	this.zip_sanitation = false;
	this.zip_valid = false;
	this.zip_gaxi = false;
	this.zip_gverts = false;
	this.zip_laxi = false;
	this.zip_lverts = false;
	this.reverse_flag = false;
	this.edgeCnt = 0;
	this.wrap_edges = null;
	this.edges = null;
	this.wrap_gverts = null;
	this.gverts = null;
	this.wrap_lverts = null;
	this.lverts = null;
	this.outer_zn = null;
	zpp_nape.shape.ZPP_Shape.call(this,zpp_nape.util.ZPP_Flags.id_ShapeType_POLYGON);
	this.polygon = this;
	this.lverts = new zpp_nape.geom.ZPP_Vec2();
	this.gverts = new zpp_nape.geom.ZPP_Vec2();
	this.edges = new zpp_nape.util.ZNPList_ZPP_Edge();
	this.edgeCnt = 0;
};
$hxClasses["zpp_nape.shape.ZPP_Polygon"] = zpp_nape.shape.ZPP_Polygon;
zpp_nape.shape.ZPP_Polygon.__name__ = ["zpp_nape","shape","ZPP_Polygon"];
zpp_nape.shape.ZPP_Polygon.__super__ = zpp_nape.shape.ZPP_Shape;
zpp_nape.shape.ZPP_Polygon.prototype = $extend(zpp_nape.shape.ZPP_Shape.prototype,{
	__copy: function() {
		var ret = new nape.shape.Polygon(this.outer_zn.get_localVerts()).zpp_inner_zn;
		return ret;
	}
	,__transform: function(mat) {
		var cx_ite = this.lverts.begin();
		while(cx_ite != null) {
			var p = cx_ite.elem();
			var t = mat.get_a() * p.x + mat.get_b() * p.y + mat.get_tx();
			p.y = mat.get_c() * p.x + mat.get_d() * p.y + mat.get_ty();
			p.x = t;
			cx_ite = cx_ite.next;
		}
		this.invalidate_lverts();
	}
	,__translate: function(dx,dy) {
		var cx_ite = this.lverts.begin();
		while(cx_ite != null) {
			var p = cx_ite.elem();
			var t = 1.0;
			p.x += dx * t;
			p.y += dy * t;
			cx_ite = cx_ite.next;
		}
		this.invalidate_lverts();
	}
	,setupLocalCOM: function() {
		this.wrap_localCOM = nape.geom.Vec2.get(this.localCOMx,this.localCOMy);
		this.wrap_localCOM.zpp_inner._inuse = true;
		this.wrap_localCOM.zpp_inner._validate = $bind(this,this.localCOM_validate);
		this.wrap_localCOM.zpp_inner._invalidate = $bind(this,this.localCOM_invalidate);
	}
	,localCOM_invalidate: function(x) {
		this.validate_localCOM();
		var delx = 0;
		var dely = 0;
		delx = x.x - this.localCOMx;
		dely = x.y - this.localCOMy;
		var cx_ite = this.lverts.begin();
		while(cx_ite != null) {
			var p = cx_ite.elem();
			var t = 1.0;
			p.x += delx * t;
			p.y += dely * t;
			cx_ite = cx_ite.next;
		}
		this.invalidate_lverts();
	}
	,localCOM_validate: function() {
		if(this.lverts.empty()) throw "Error: An empty polygon does not have any meaningful localCOM";
		this.validate_localCOM();
	}
	,__validate_localCOM: function() {
		if(this.lverts.empty()) throw "Error: An empty polygon has no meaningful localCOM";
		if(this.lverts.begin().next == null) {
			this.localCOMx = this.lverts.front().x;
			this.localCOMy = this.lverts.front().y;
		} else if(this.lverts.begin().next.next == null) {
			this.localCOMx = this.lverts.front().x;
			this.localCOMy = this.lverts.front().y;
			var t = 1.0;
			this.localCOMx += this.lverts.begin().next.elem().x * t;
			this.localCOMy += this.lverts.begin().next.elem().y * t;
			var t = 0.5;
			this.localCOMx *= t;
			this.localCOMy *= t;
		} else {
			this.localCOMx = 0;
			this.localCOMy = 0;
			var area = 0.0;
			var cx_ite = this.lverts.begin();
			var u = cx_ite.elem();
			cx_ite = cx_ite.next;
			var v = cx_ite.elem();
			cx_ite = cx_ite.next;
			while(cx_ite != null) {
				var w = cx_ite.elem();
				area += v.x * (w.y - u.y);
				var cf = w.y * v.x - w.x * v.y;
				this.localCOMx += (v.x + w.x) * cf;
				this.localCOMy += (v.y + w.y) * cf;
				u = v;
				v = w;
				cx_ite = cx_ite.next;
			}
			cx_ite = this.lverts.begin();
			var w = cx_ite.elem();
			area += v.x * (w.y - u.y);
			var cf = w.y * v.x - w.x * v.y;
			this.localCOMx += (v.x + w.x) * cf;
			this.localCOMy += (v.y + w.y) * cf;
			u = v;
			v = w;
			cx_ite = cx_ite.next;
			var w1 = cx_ite.elem();
			area += v.x * (w1.y - u.y);
			var cf = w1.y * v.x - w1.x * v.y;
			this.localCOMx += (v.x + w1.x) * cf;
			this.localCOMy += (v.y + w1.y) * cf;
			area = 1 / (3 * area);
			var t = area;
			this.localCOMx *= t;
			this.localCOMy *= t;
		}
	}
	,__validate_angDrag: function() {
		if(this.lverts.size() < 3) throw "Error: Polygon's with less than 3 vertices have no meaningful angDrag";
		this.validate_area_inertia();
		this.validate_laxi();
		var accum = 0.0;
		var ei = this.edges.begin();
		var perim = 0.0;
		var cx_cont = true;
		var cx_itei = this.lverts.begin();
		var u = cx_itei.elem();
		var cx_itej = cx_itei.next;
		while(cx_itej != null) {
			var v = cx_itej.elem();
			var edge = ei.elem();
			ei = ei.next;
			perim += edge.length;
			var dx = 0.0;
			var dy = 0.0;
			dx = v.x - u.x;
			dy = v.y - u.y;
			accum += edge.length * nape.Config.fluidAngularDragFriction * this.material.dynamicFriction * edge.lprojection * edge.lprojection;
			var t = -(u.y * edge.lnormx - u.x * edge.lnormy) / (dy * edge.lnormx - dx * edge.lnormy);
			if(t > 0) {
				var ta = t > 1?1:t;
				var cx = 0.0;
				var cy = 0.0;
				cx = u.x;
				cy = u.y;
				var t1 = ta;
				cx += dx * t1;
				cy += dy * t1;
				var dota = edge.lnormy * u.x - edge.lnormx * u.y;
				var dotb = edge.lnormy * cx - edge.lnormx * cy;
				var dots = (dotb * dotb * dotb - dota * dota * dota) / (3 * (dotb - dota));
				accum += dots * ta * edge.length * nape.Config.fluidAngularDrag;
			}
			if(t < 1) {
				var tb = t < 0?0:t;
				var cx = 0.0;
				var cy = 0.0;
				cx = u.x;
				cy = u.y;
				var t1 = tb;
				cx += dx * t1;
				cy += dy * t1;
				var dota = edge.lnormy * cx - edge.lnormx * cy;
				var dotb = edge.lnormy * v.x - edge.lnormx * v.y;
				var dots = (dotb * dotb * dotb - dota * dota * dota) / (3 * (dotb - dota));
				accum += dots * nape.Config.fluidVacuumDrag * (1 - tb) * edge.length * nape.Config.fluidAngularDrag;
			}
			cx_itei = cx_itej;
			u = v;
			cx_itej = cx_itej.next;
		}
		if(cx_cont) do {
			cx_itej = this.lverts.begin();
			var v = cx_itej.elem();
			var edge = ei.elem();
			ei = ei.next;
			perim += edge.length;
			var dx = 0.0;
			var dy = 0.0;
			dx = v.x - u.x;
			dy = v.y - u.y;
			accum += edge.length * nape.Config.fluidAngularDragFriction * this.material.dynamicFriction * edge.lprojection * edge.lprojection;
			var t = -(u.y * edge.lnormx - u.x * edge.lnormy) / (dy * edge.lnormx - dx * edge.lnormy);
			if(t > 0) {
				var ta = t > 1?1:t;
				var cx = 0.0;
				var cy = 0.0;
				cx = u.x;
				cy = u.y;
				var t1 = ta;
				cx += dx * t1;
				cy += dy * t1;
				var dota = edge.lnormy * u.x - edge.lnormx * u.y;
				var dotb = edge.lnormy * cx - edge.lnormx * cy;
				var dots = (dotb * dotb * dotb - dota * dota * dota) / (3 * (dotb - dota));
				accum += dots * ta * edge.length * nape.Config.fluidAngularDrag;
			}
			if(t < 1) {
				var tb = t < 0?0:t;
				var cx = 0.0;
				var cy = 0.0;
				cx = u.x;
				cy = u.y;
				var t1 = tb;
				cx += dx * t1;
				cy += dy * t1;
				var dota = edge.lnormy * cx - edge.lnormx * cy;
				var dotb = edge.lnormy * v.x - edge.lnormx * v.y;
				var dots = (dotb * dotb * dotb - dota * dota * dota) / (3 * (dotb - dota));
				accum += dots * nape.Config.fluidVacuumDrag * (1 - tb) * edge.length * nape.Config.fluidAngularDrag;
			}
		} while(false);
		this.angDrag = accum / (this.inertia * perim);
	}
	,__validate_area_inertia: function() {
		if(this.lverts.begin() == null || this.lverts.begin().next == null || this.lverts.begin().next.next == null) {
			this.area = 0;
			this.inertia = 0;
		} else {
			this.area = 0.0;
			var s1 = 0.0;
			var s2 = 0.0;
			var cx_ite = this.lverts.begin();
			var u = cx_ite.elem();
			cx_ite = cx_ite.next;
			var v = cx_ite.elem();
			cx_ite = cx_ite.next;
			while(cx_ite != null) {
				var w = cx_ite.elem();
				var a = v.y * u.x - v.x * u.y;
				var b = v.x * v.x + v.y * v.y + (v.x * u.x + v.y * u.y) + (u.x * u.x + u.y * u.y);
				s1 += a * b;
				s2 += a;
				this.area += v.x * (w.y - u.y);
				u = v;
				v = w;
				cx_ite = cx_ite.next;
			}
			cx_ite = this.lverts.begin();
			var w = cx_ite.elem();
			var a = v.y * u.x - v.x * u.y;
			var b = v.x * v.x + v.y * v.y + (v.x * u.x + v.y * u.y) + (u.x * u.x + u.y * u.y);
			s1 += a * b;
			s2 += a;
			this.area += v.x * (w.y - u.y);
			u = v;
			v = w;
			cx_ite = cx_ite.next;
			var w1 = cx_ite.elem();
			var a = v.y * u.x - v.x * u.y;
			var b = v.x * v.x + v.y * v.y + (v.x * u.x + v.y * u.y) + (u.x * u.x + u.y * u.y);
			s1 += a * b;
			s2 += a;
			this.area += v.x * (w1.y - u.y);
			this.inertia = s1 / (6 * s2);
			this.area *= 0.5;
			if(this.area < 0) {
				this.area = -this.area;
				this.reverse_vertices();
			}
		}
	}
	,__validate_sweepRadius: function() {
		var maxRadius = 0.0;
		var minRadius = 0.0;
		this.validate_laxi();
		var cx_ite = this.lverts.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			var r = x.x * x.x + x.y * x.y;
			if(r > maxRadius) maxRadius = r;
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.edges.begin();
		while(cx_ite != null) {
			var e = cx_ite.elem();
			if(e.lprojection < minRadius) {
				minRadius = e.lprojection;
				if(minRadius < 0) break;
			}
			cx_ite = cx_ite.next;
		}
		if(minRadius < 0) minRadius = 0;
		this.sweepRadius = Math.sqrt(maxRadius);
		this.sweepCoef = this.sweepRadius - minRadius;
	}
	,_force_validate_aabb: function() {
		var li = this.lverts.begin();
		var p0 = this.gverts.front();
		var l = li.elem();
		li = li.next;
		p0.x = this.body.posx + (this.body.axisy * l.x - this.body.axisx * l.y);
		p0.y = this.body.posy + (l.x * this.body.axisx + l.y * this.body.axisy);
		this.aabb.minx = p0.x;
		this.aabb.miny = p0.y;
		this.aabb.maxx = p0.x;
		this.aabb.maxy = p0.y;
		var cx_ite = this.gverts.begin().next;
		while(cx_ite != null) {
			var p = cx_ite.elem();
			var l1 = li.elem();
			li = li.next;
			p.x = this.body.posx + (this.body.axisy * l1.x - this.body.axisx * l1.y);
			p.y = this.body.posy + (l1.x * this.body.axisx + l1.y * this.body.axisy);
			if(p.x < this.aabb.minx) this.aabb.minx = p.x;
			if(p.x > this.aabb.maxx) this.aabb.maxx = p.x;
			if(p.y < this.aabb.miny) this.aabb.miny = p.y;
			if(p.y > this.aabb.maxy) this.aabb.maxy = p.y;
			cx_ite = cx_ite.next;
		}
	}
	,__validate_aabb: function() {
		this.validate_gverts();
		if(this.lverts.empty()) throw "Error: An empty polygon has no meaningful bounds";
		var p0 = this.gverts.front();
		this.aabb.minx = p0.x;
		this.aabb.miny = p0.y;
		this.aabb.maxx = p0.x;
		this.aabb.maxy = p0.y;
		var cx_ite = this.gverts.begin().next;
		while(cx_ite != null) {
			var p = cx_ite.elem();
			if(p.x < this.aabb.minx) this.aabb.minx = p.x;
			if(p.x > this.aabb.maxx) this.aabb.maxx = p.x;
			if(p.y < this.aabb.miny) this.aabb.miny = p.y;
			if(p.y > this.aabb.maxy) this.aabb.maxy = p.y;
			cx_ite = cx_ite.next;
		}
	}
	,validate_gaxi: function() {
		if(this.zip_gaxi) {
			if(this.body != null) {
				this.zip_gaxi = false;
				this.validate_laxi();
				this.body.validate_axis();
				this.validate_gverts();
				var ite = this.edges.begin();
				var cx_ite = this.gverts.begin();
				var u = cx_ite.elem();
				cx_ite = cx_ite.next;
				while(cx_ite != null) {
					var v = cx_ite.elem();
					var e = ite.elem();
					ite = ite.next;
					e.gp0 = u;
					e.gp1 = v;
					e.gnormx = this.body.axisy * e.lnormx - this.body.axisx * e.lnormy;
					e.gnormy = e.lnormx * this.body.axisx + e.lnormy * this.body.axisy;
					e.gprojection = this.body.posx * e.gnormx + this.body.posy * e.gnormy + e.lprojection;
					if(e.wrap_gnorm != null) {
						e.wrap_gnorm.zpp_inner.x = e.gnormx;
						e.wrap_gnorm.zpp_inner.y = e.gnormy;
					}
					e.tp0 = e.gp0.y * e.gnormx - e.gp0.x * e.gnormy;
					e.tp1 = e.gp1.y * e.gnormx - e.gp1.x * e.gnormy;
					u = v;
					cx_ite = cx_ite.next;
				}
				var v = this.gverts.front();
				var e = ite.elem();
				ite = ite.next;
				e.gp0 = u;
				e.gp1 = v;
				e.gnormx = this.body.axisy * e.lnormx - this.body.axisx * e.lnormy;
				e.gnormy = e.lnormx * this.body.axisx + e.lnormy * this.body.axisy;
				e.gprojection = this.body.posx * e.gnormx + this.body.posy * e.gnormy + e.lprojection;
				if(e.wrap_gnorm != null) {
					e.wrap_gnorm.zpp_inner.x = e.gnormx;
					e.wrap_gnorm.zpp_inner.y = e.gnormy;
				}
				e.tp0 = e.gp0.y * e.gnormx - e.gp0.x * e.gnormy;
				e.tp1 = e.gp1.y * e.gnormx - e.gp1.x * e.gnormy;
			}
		}
	}
	,validate_gverts: function() {
		if(this.zip_gverts) {
			if(this.body != null) {
				this.zip_gverts = false;
				this.validate_lverts();
				this.body.validate_axis();
				var li = this.lverts.begin();
				var cx_ite = this.gverts.begin();
				while(cx_ite != null) {
					var g = cx_ite.elem();
					var l = li.elem();
					li = li.next;
					g.x = this.body.posx + (this.body.axisy * l.x - this.body.axisx * l.y);
					g.y = this.body.posy + (l.x * this.body.axisx + l.y * this.body.axisy);
					cx_ite = cx_ite.next;
				}
			}
		}
	}
	,validate_laxi: function() {
		if(this.zip_laxi) {
			this.zip_laxi = false;
			this.validate_lverts();
			var ite = this.edges.begin();
			var cx_ite = this.lverts.begin();
			var u = cx_ite.elem();
			cx_ite = cx_ite.next;
			while(cx_ite != null) {
				var v = cx_ite.elem();
				var edge = ite.elem();
				ite = ite.next;
				edge.lp0 = u;
				edge.lp1 = v;
				var dx = 0.0;
				var dy = 0.0;
				dx = u.x - v.x;
				dy = u.y - v.y;
				var l = Math.sqrt(dx * dx + dy * dy);
				edge.length = l;
				var t = 1.0 / l;
				dx *= t;
				dy *= t;
				var t = dx;
				dx = -dy;
				dy = t;
				edge.lprojection = dx * u.x + dy * u.y;
				edge.lnormx = dx;
				edge.lnormy = dy;
				if(edge.wrap_lnorm != null) {
					edge.wrap_lnorm.zpp_inner.x = dx;
					edge.wrap_lnorm.zpp_inner.y = dy;
				}
				u = v;
				cx_ite = cx_ite.next;
			}
			var v = this.lverts.front();
			var edge = ite.elem();
			ite = ite.next;
			edge.lp0 = u;
			edge.lp1 = v;
			var dx = 0.0;
			var dy = 0.0;
			dx = u.x - v.x;
			dy = u.y - v.y;
			var l = Math.sqrt(dx * dx + dy * dy);
			edge.length = l;
			var t = 1.0 / l;
			dx *= t;
			dy *= t;
			var t = dx;
			dx = -dy;
			dy = t;
			edge.lprojection = dx * u.x + dy * u.y;
			edge.lnormx = dx;
			edge.lnormy = dy;
			if(edge.wrap_lnorm != null) {
				edge.wrap_lnorm.zpp_inner.x = dx;
				edge.wrap_lnorm.zpp_inner.y = dy;
			}
		}
	}
	,reverse_vertices: function() {
		this.lverts.reverse();
		this.gverts.reverse();
		this.edges.reverse();
		var ite = this.edges.iterator_at(this.edgeCnt - 1);
		var elem = this.edges.pop_unsafe();
		this.edges.insert(ite,elem);
		this.reverse_flag = !this.reverse_flag;
		if(this.wrap_lverts != null) this.wrap_lverts.zpp_inner.reverse_flag = this.reverse_flag;
		if(this.wrap_gverts != null) this.wrap_gverts.zpp_inner.reverse_flag = this.reverse_flag;
		if(this.wrap_edges != null) this.wrap_edges.zpp_inner.reverse_flag = this.reverse_flag;
	}
	,splice_collinear_real: function() {
		if(this.lverts.begin() == null) return;
		if(this.lverts.begin().next == null) return;
		if(this.lverts.begin().next.next == null) return;
		var pre = null;
		var cur = this.lverts.begin();
		while(cur != null) {
			var nxt = cur.next == null?this.lverts.begin():cur.next;
			var u = cur.elem();
			var v = nxt.elem();
			if(zpp_nape.geom.ZPP_VecMath.vec_dsq(u.x,u.y,v.x,v.y) < nape.Config.epsilon * nape.Config.epsilon) {
				this.cleanup_lvert(cur.elem());
				cur = this.lverts.erase(pre);
			} else {
				pre = cur;
				cur = cur.next;
			}
		}
		if(this.lverts.empty()) return;
		var removed;
		do {
			removed = false;
			var pre1 = this.lverts.begin();
			while(pre1 != null) {
				var cur1 = pre1.next == null?this.lverts.begin():pre1.next;
				var nxt = cur1.next == null?this.lverts.begin():cur1.next;
				var u = pre1.elem();
				var v = cur1.elem();
				var w = nxt.elem();
				var ax = 0.0;
				var ay = 0.0;
				ax = v.x - u.x;
				ay = v.y - u.y;
				var bx = 0.0;
				var by = 0.0;
				bx = w.x - v.x;
				by = w.y - v.y;
				var crs = by * ax - bx * ay;
				if(crs * crs >= nape.Config.epsilon * nape.Config.epsilon) pre1 = pre1.next; else {
					this.cleanup_lvert(cur1.elem());
					this.lverts.erase(pre1.next == null?null:pre1);
					removed = true;
					pre1 = pre1.next;
				}
			}
		} while(removed);
	}
	,splice_collinear: function() {
		if(this.zip_sanitation) {
			this.zip_sanitation = false;
			this.splice_collinear_real();
		}
	}
	,cleanup_lvert: function(x) {
		var ite = null;
		var ite2 = null;
		var cx_ite = this.lverts.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			if(i == x) break; else {
				ite = ite == null?this.gverts.begin():ite.next;
				ite2 = ite2 == null?this.edges.begin():ite2.next;
			}
			cx_ite = cx_ite.next;
		}
		var rem = ite == null?this.gverts.front():ite.next.elem();
		this.gverts.erase(ite);
		var o = rem;
		o.free();
		o.next = zpp_nape.geom.ZPP_Vec2.zpp_pool;
		zpp_nape.geom.ZPP_Vec2.zpp_pool = o;
		if(this.edgeCnt == 2) {
			var rem1 = this.edges.pop_unsafe();
			var o = rem1;
			o.free();
			o.next = zpp_nape.shape.ZPP_Edge.zpp_pool;
			zpp_nape.shape.ZPP_Edge.zpp_pool = o;
			rem1 = this.edges.pop_unsafe();
			var o = rem1;
			o.free();
			o.next = zpp_nape.shape.ZPP_Edge.zpp_pool;
			zpp_nape.shape.ZPP_Edge.zpp_pool = o;
			this.edgeCnt = 0;
		} else if(this.edgeCnt != 0) {
			var rem1 = ite2 == null?this.edges.front():ite2.next.elem();
			this.edges.erase(ite2);
			var o = rem1;
			o.free();
			o.next = zpp_nape.shape.ZPP_Edge.zpp_pool;
			zpp_nape.shape.ZPP_Edge.zpp_pool = o;
			this.edgeCnt--;
		}
	}
	,validate_lverts: function() {
		if(this.zip_lverts) {
			this.zip_lverts = false;
			if(this.lverts.size() > 2) {
				this.validate_area_inertia();
				if(this.area < 0) {
					this.reverse_vertices();
					this.area = -this.area;
				}
			}
		}
	}
	,valid: function() {
		if(this.zip_valid) {
			this.zip_valid = false;
			this.splice_collinear();
			if(this.lverts.size() < 3) return this.validation = nape.shape.ValidationResult.get_DEGENERATE(); else {
				this.validate_lverts();
				this.validate_area_inertia();
				if(this.area < nape.Config.epsilon) return this.validation = nape.shape.ValidationResult.get_DEGENERATE(); else {
					var neg = false;
					var pos = false;
					var cx_cont = true;
					var cx_ite = this.lverts.begin();
					var u = cx_ite.elem();
					cx_ite = cx_ite.next;
					var v = cx_ite.elem();
					cx_ite = cx_ite.next;
					while(cx_ite != null) {
						var w = cx_ite.elem();
						var ax = 0.0;
						var ay = 0.0;
						ax = w.x - v.x;
						ay = w.y - v.y;
						var bx = 0.0;
						var by = 0.0;
						bx = v.x - u.x;
						by = v.y - u.y;
						var dot = by * ax - bx * ay;
						if(dot > nape.Config.epsilon) pos = true; else if(dot < -nape.Config.epsilon) neg = true;
						if(pos && neg) {
							cx_cont = false;
							break;
						}
						u = v;
						v = w;
						cx_ite = cx_ite.next;
					}
					if(cx_cont) {
						cx_ite = this.lverts.begin();
						var w = cx_ite.elem();
						do {
							var ax = 0.0;
							var ay = 0.0;
							ax = w.x - v.x;
							ay = w.y - v.y;
							var bx = 0.0;
							var by = 0.0;
							bx = v.x - u.x;
							by = v.y - u.y;
							var dot = by * ax - bx * ay;
							if(dot > nape.Config.epsilon) pos = true; else if(dot < -nape.Config.epsilon) neg = true;
							if(pos && neg) {
								cx_cont = false;
								break;
							}
						} while(false);
						if(cx_cont) {
							u = v;
							v = w;
							cx_ite = cx_ite.next;
							var w1 = cx_ite.elem();
							do {
								var ax = 0.0;
								var ay = 0.0;
								ax = w1.x - v.x;
								ay = w1.y - v.y;
								var bx = 0.0;
								var by = 0.0;
								bx = v.x - u.x;
								by = v.y - u.y;
								var dot = by * ax - bx * ay;
								if(dot > nape.Config.epsilon) pos = true; else if(dot < -nape.Config.epsilon) neg = true;
								if(pos && neg) break;
							} while(false);
						}
					}
					if(pos && neg) return this.validation = nape.shape.ValidationResult.get_CONCAVE(); else {
						var cont = true;
						var cx_cont = true;
						var cx_ite = this.lverts.begin();
						var u = cx_ite.elem();
						cx_ite = cx_ite.next;
						while(cx_ite != null) {
							var v = cx_ite.elem();
							if(!cont) {
								cx_cont = false;
								break;
							}
							var cx_cont1 = true;
							var cx_ite1 = this.lverts.begin();
							var a = cx_ite1.elem();
							cx_ite1 = cx_ite1.next;
							while(cx_ite1 != null) {
								var b = cx_ite1.elem();
								if(u == a || u == b || v == a || v == b) {
									a = b;
									cx_ite1 = cx_ite1.next;
									continue;
								}
								var sx = 0.0;
								var sy = 0.0;
								sx = u.x - a.x;
								sy = u.y - a.y;
								var vx = 0.0;
								var vy = 0.0;
								vx = v.x - u.x;
								vy = v.y - u.y;
								var qx = 0.0;
								var qy = 0.0;
								qx = b.x - a.x;
								qy = b.y - a.y;
								var den = vy * qx - vx * qy;
								if(den * den > nape.Config.epsilon) {
									den = 1 / den;
									var t = (qy * sx - qx * sy) * den;
									if(t > nape.Config.epsilon && t < 1 - nape.Config.epsilon) {
										var s = (vy * sx - vx * sy) * den;
										if(s > nape.Config.epsilon && s < 1 - nape.Config.epsilon) {
											cont = false;
											cx_cont1 = false;
											break;
										}
									}
								}
								a = b;
								cx_ite1 = cx_ite1.next;
							}
							if(cx_cont1) do {
								var b = this.lverts.front();
								if(u == a || u == b || v == a || v == b) break;
								var sx = 0.0;
								var sy = 0.0;
								sx = u.x - a.x;
								sy = u.y - a.y;
								var vx = 0.0;
								var vy = 0.0;
								vx = v.x - u.x;
								vy = v.y - u.y;
								var qx = 0.0;
								var qy = 0.0;
								qx = b.x - a.x;
								qy = b.y - a.y;
								var den = vy * qx - vx * qy;
								if(den * den > nape.Config.epsilon) {
									den = 1 / den;
									var t = (qy * sx - qx * sy) * den;
									if(t > nape.Config.epsilon && t < 1 - nape.Config.epsilon) {
										var s = (vy * sx - vx * sy) * den;
										if(s > nape.Config.epsilon && s < 1 - nape.Config.epsilon) {
											cont = false;
											break;
										}
									}
								}
							} while(false);
							u = v;
							cx_ite = cx_ite.next;
						}
						if(cx_cont) do {
							var v = this.lverts.front();
							if(!cont) break;
							var cx_cont1 = true;
							var cx_ite1 = this.lverts.begin();
							var a = cx_ite1.elem();
							cx_ite1 = cx_ite1.next;
							while(cx_ite1 != null) {
								var b = cx_ite1.elem();
								if(u == a || u == b || v == a || v == b) {
									a = b;
									cx_ite1 = cx_ite1.next;
									continue;
								}
								var sx = 0.0;
								var sy = 0.0;
								sx = u.x - a.x;
								sy = u.y - a.y;
								var vx = 0.0;
								var vy = 0.0;
								vx = v.x - u.x;
								vy = v.y - u.y;
								var qx = 0.0;
								var qy = 0.0;
								qx = b.x - a.x;
								qy = b.y - a.y;
								var den = vy * qx - vx * qy;
								if(den * den > nape.Config.epsilon) {
									den = 1 / den;
									var t = (qy * sx - qx * sy) * den;
									if(t > nape.Config.epsilon && t < 1 - nape.Config.epsilon) {
										var s = (vy * sx - vx * sy) * den;
										if(s > nape.Config.epsilon && s < 1 - nape.Config.epsilon) {
											cont = false;
											cx_cont1 = false;
											break;
										}
									}
								}
								a = b;
								cx_ite1 = cx_ite1.next;
							}
							if(cx_cont1) do {
								var b = this.lverts.front();
								if(u == a || u == b || v == a || v == b) break;
								var sx = 0.0;
								var sy = 0.0;
								sx = u.x - a.x;
								sy = u.y - a.y;
								var vx = 0.0;
								var vy = 0.0;
								vx = v.x - u.x;
								vy = v.y - u.y;
								var qx = 0.0;
								var qy = 0.0;
								qx = b.x - a.x;
								qy = b.y - a.y;
								var den = vy * qx - vx * qy;
								if(den * den > nape.Config.epsilon) {
									den = 1 / den;
									var t = (qy * sx - qx * sy) * den;
									if(t > nape.Config.epsilon && t < 1 - nape.Config.epsilon) {
										var s = (vy * sx - vx * sy) * den;
										if(s > nape.Config.epsilon && s < 1 - nape.Config.epsilon) {
											cont = false;
											break;
										}
									}
								}
							} while(false);
						} while(false);
						if(!cont) return this.validation = nape.shape.ValidationResult.get_SELF_INTERSECTING(); else return this.validation = nape.shape.ValidationResult.get_VALID();
					}
				}
			}
		} else return this.validation;
	}
	,invalidate_gaxi: function() {
		this.zip_gaxi = true;
	}
	,invalidate_gverts: function() {
		this.invalidate_aabb();
		this.zip_gverts = true;
	}
	,invalidate_laxi: function() {
		this.invalidate_gaxi();
		this.invalidate_sweepRadius();
		this.zip_laxi = true;
	}
	,invalidate_lverts: function() {
		this.invalidate_laxi();
		this.invalidate_area_inertia();
		this.invalidate_angDrag();
		this.invalidate_localCOM();
		this.invalidate_gverts();
		this.zip_lverts = true;
		this.zip_valid = true;
		this.zip_sanitation = true;
		if(this.body != null) this.body.wake();
	}
	,getedges: function() {
		var me = this;
		this.wrap_edges = zpp_nape.util.ZPP_EdgeList.get(this.edges,true);
		this.wrap_edges.zpp_inner.reverse_flag = this.reverse_flag;
		this.wrap_edges.zpp_inner._validate = $bind(this,this.edges_validate);
	}
	,getgverts: function() {
		var me = this;
		this.wrap_gverts = zpp_nape.util.ZPP_MixVec2List.get(this.gverts,true);
		this.wrap_gverts.zpp_inner.reverse_flag = this.reverse_flag;
		this.wrap_gverts.zpp_inner._validate = $bind(this,this.gverts_validate);
	}
	,getlverts: function() {
		var me = this;
		this.wrap_lverts = zpp_nape.util.ZPP_MixVec2List.get(this.lverts);
		this.wrap_lverts.zpp_inner.post_adder = $bind(this,this.lverts_post_adder);
		this.wrap_lverts.zpp_inner.subber = $bind(this,this.lverts_subber);
		this.wrap_lverts.zpp_inner._invalidate = $bind(this,this.lverts_invalidate);
		this.wrap_lverts.zpp_inner._validate = $bind(this,this.lverts_validate);
		this.wrap_lverts.zpp_inner._modifiable = $bind(this,this.lverts_modifiable);
		this.wrap_lverts.zpp_inner.reverse_flag = this.reverse_flag;
	}
	,edges_validate: function() {
		this.validate_lverts();
	}
	,gverts_validate: function() {
		this.validate_gverts();
	}
	,lverts_modifiable: function() {
		this.immutable_midstep("Polygon::localVerts");
		if(this.body != null && this.body.isStatic() && this.body.space != null) throw "Error: Cannot modifiy shapes of static object once added to Space";
	}
	,lverts_validate: function() {
		this.validate_lverts();
	}
	,lverts_invalidate: function(_) {
		this.invalidate_lverts();
	}
	,lverts_subber: function(x) {
		this.cleanup_lvert(x.zpp_inner);
	}
	,lverts_post_adder: function(x) {
		x.zpp_inner._invalidate = $bind(this,this.lverts_pa_invalidate);
		x.zpp_inner._isimmutable = $bind(this,this.lverts_pa_immutable);
		var ite = null;
		var ite2 = null;
		var cx_ite = this.lverts.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			if(i == x.zpp_inner) break; else {
				ite = ite == null?this.gverts.begin():ite.next;
				ite2 = ite2 == null?this.edges.begin():ite2.next;
			}
			cx_ite = cx_ite.next;
		}
		var vec = zpp_nape.geom.ZPP_Vec2.get(0,0,true);
		this.gverts.insert(ite,vec);
		if(this.lverts.begin().next != null) {
			if(this.lverts.begin().next.next == null) {
				var ed;
				if(zpp_nape.shape.ZPP_Edge.zpp_pool == null) ed = new zpp_nape.shape.ZPP_Edge(); else {
					ed = zpp_nape.shape.ZPP_Edge.zpp_pool;
					zpp_nape.shape.ZPP_Edge.zpp_pool = ed.next;
					ed.next = null;
				}
				ed.alloc();
				ed.polygon = this;
				this.edges.add(ed);
				var ed1;
				if(zpp_nape.shape.ZPP_Edge.zpp_pool == null) ed1 = new zpp_nape.shape.ZPP_Edge(); else {
					ed1 = zpp_nape.shape.ZPP_Edge.zpp_pool;
					zpp_nape.shape.ZPP_Edge.zpp_pool = ed1.next;
					ed1.next = null;
				}
				ed1.alloc();
				ed1.polygon = this;
				this.edges.add(ed1);
				this.edgeCnt += 2;
			} else {
				var ed;
				if(zpp_nape.shape.ZPP_Edge.zpp_pool == null) ed = new zpp_nape.shape.ZPP_Edge(); else {
					ed = zpp_nape.shape.ZPP_Edge.zpp_pool;
					zpp_nape.shape.ZPP_Edge.zpp_pool = ed.next;
					ed.next = null;
				}
				ed.alloc();
				ed.polygon = this;
				this.edges.insert(ite2,ed);
				this.edgeCnt++;
			}
		}
		vec._validate = $bind(this,this.gverts_pa_validate);
	}
	,gverts_pa_validate: function() {
		if(this.body == null) throw "Error: World vertex only makes sense when Polygon is contained in a rigid body";
		this.validate_gverts();
	}
	,lverts_pa_immutable: function() {
		if(this.body != null && this.body.isStatic() && this.body.space != null) throw "Error: Cannot modify local vertex of Polygon added to a static body whilst within a Space";
	}
	,lverts_pa_invalidate: function(x) {
		this.invalidate_lverts();
	}
	,__class__: zpp_nape.shape.ZPP_Polygon
});
zpp_nape.space = {}
zpp_nape.space.ZPP_Broadphase = function() {
	this.circShape = null;
	this.matrix = null;
	this.aabbShape = null;
	this.dynab = null;
	this.sweep = null;
	this.is_sweep = false;
	this.space = null;
};
$hxClasses["zpp_nape.space.ZPP_Broadphase"] = zpp_nape.space.ZPP_Broadphase;
zpp_nape.space.ZPP_Broadphase.__name__ = ["zpp_nape","space","ZPP_Broadphase"];
zpp_nape.space.ZPP_Broadphase.prototype = {
	rayMultiCast: function(ray,inner,filter,output) {
		return null;
	}
	,rayCast: function(ray,inner,filter) {
		return null;
	}
	,bodiesInShape: function(shape,containment,filter,output) {
		return null;
	}
	,shapesInShape: function(shape,containment,filter,output) {
		return null;
	}
	,validateShape: function(s) {
		if(s.isPolygon()) s.polygon.validate_gaxi();
		s.validate_aabb();
		s.validate_worldCOM();
	}
	,bodiesInCircle: function(x,y,r,containment,filter,output) {
		return null;
	}
	,shapesInCircle: function(x,y,r,containment,filter,output) {
		return null;
	}
	,updateCircShape: function(x,y,r) {
		if(this.circShape == null) {
			var body = new nape.phys.Body(nape.phys.BodyType.get_STATIC());
			body.get_shapes().add(this.circShape = new nape.shape.Circle(r,nape.geom.Vec2.get(x,y)));
		} else {
			var ci = this.circShape.zpp_inner.circle;
			var ss = r / ci.radius;
			if(this.matrix == null) this.matrix = new nape.geom.Mat23();
			this.matrix.set_a(this.matrix.set_d(ss));
			this.matrix.set_b(this.matrix.set_c(0));
			this.matrix.set_tx(x - ss * ci.localCOMx);
			this.matrix.set_ty(y - ss * ci.localCOMy);
			this.circShape.transform(this.matrix);
		}
		this.circShape.zpp_inner.validate_aabb();
	}
	,bodiesInAABB: function(aabb,strict,containment,filter,output) {
		return null;
	}
	,shapesInAABB: function(aabb,strict,containment,filter,output) {
		return null;
	}
	,updateAABBShape: function(aabb) {
		if(this.aabbShape == null) {
			var body = new nape.phys.Body(nape.phys.BodyType.get_STATIC());
			body.get_shapes().add(this.aabbShape = new nape.shape.Polygon(nape.shape.Polygon.rect(aabb.minx,aabb.miny,aabb.width(),aabb.height())));
		} else {
			var ab = this.aabbShape.zpp_inner.aabb;
			var sx = aabb.width() / ab.width();
			var sy = aabb.height() / ab.height();
			if(this.matrix == null) this.matrix = new nape.geom.Mat23();
			this.matrix.set_a(sx);
			this.matrix.set_b(this.matrix.set_c(0));
			this.matrix.set_d(sy);
			this.matrix.set_tx(aabb.minx - sx * ab.minx);
			this.matrix.set_ty(aabb.miny - sy * ab.miny);
			this.aabbShape.transform(this.matrix);
		}
		this.aabbShape.zpp_inner.validate_aabb();
		this.aabbShape.zpp_inner.polygon.validate_gaxi();
	}
	,bodiesUnderPoint: function(x,y,filter,output) {
		return null;
	}
	,shapesUnderPoint: function(x,y,filter,output) {
		return null;
	}
	,clear: function() {
	}
	,broadphase: function(space,discrete) {
	}
	,sync: function(shape) {
		if(this.is_sweep) this.sweep.__sync(shape); else this.dynab.__sync(shape);
	}
	,remove: function(shape) {
		if(this.is_sweep) this.sweep.__remove(shape); else this.dynab.__remove(shape);
	}
	,insert: function(shape) {
		if(this.is_sweep) this.sweep.__insert(shape); else this.dynab.__insert(shape);
	}
	,__class__: zpp_nape.space.ZPP_Broadphase
}
zpp_nape.space.ZPP_AABBNode = function() {
	this.first_sync = false;
	this.synced = false;
	this.snext = null;
	this.moved = false;
	this.mnext = null;
	this.next = null;
	this.rayt = 0.0;
	this.height = 0;
	this.child2 = null;
	this.child1 = null;
	this.parent = null;
	this.dyn = false;
	this.shape = null;
	this.aabb = null;
	this.height = -1;
};
$hxClasses["zpp_nape.space.ZPP_AABBNode"] = zpp_nape.space.ZPP_AABBNode;
zpp_nape.space.ZPP_AABBNode.__name__ = ["zpp_nape","space","ZPP_AABBNode"];
zpp_nape.space.ZPP_AABBNode.prototype = {
	isLeaf: function() {
		return this.child1 == null;
	}
	,free: function() {
		this.height = -1;
		var o = this.aabb;
		o.free();
		o.next = zpp_nape.geom.ZPP_AABB.zpp_pool;
		zpp_nape.geom.ZPP_AABB.zpp_pool = o;
		this.child1 = this.child2 = this.parent = null;
		this.next = null;
		this.snext = null;
		this.mnext = null;
	}
	,alloc: function() {
		if(zpp_nape.geom.ZPP_AABB.zpp_pool == null) this.aabb = new zpp_nape.geom.ZPP_AABB(); else {
			this.aabb = zpp_nape.geom.ZPP_AABB.zpp_pool;
			zpp_nape.geom.ZPP_AABB.zpp_pool = this.aabb.next;
			this.aabb.next = null;
		}
		this.aabb.alloc();
		this.moved = false;
		this.synced = false;
		this.first_sync = false;
	}
	,__class__: zpp_nape.space.ZPP_AABBNode
}
zpp_nape.space.ZPP_AABBPair = function() {
	this.next = null;
	this.arb = null;
	this.di = 0;
	this.id = 0;
	this.sleeping = false;
	this.first = false;
	this.n2 = null;
	this.n1 = null;
};
$hxClasses["zpp_nape.space.ZPP_AABBPair"] = zpp_nape.space.ZPP_AABBPair;
zpp_nape.space.ZPP_AABBPair.__name__ = ["zpp_nape","space","ZPP_AABBPair"];
zpp_nape.space.ZPP_AABBPair.prototype = {
	free: function() {
		this.n1 = this.n2 = null;
		this.sleeping = false;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.space.ZPP_AABBPair
}
zpp_nape.space.ZPP_AABBTree = function() {
	this.root = null;
};
$hxClasses["zpp_nape.space.ZPP_AABBTree"] = zpp_nape.space.ZPP_AABBTree;
zpp_nape.space.ZPP_AABBTree.__name__ = ["zpp_nape","space","ZPP_AABBTree"];
zpp_nape.space.ZPP_AABBTree.prototype = {
	balance: function(a) {
		if(a.isLeaf() || a.height < 2) return a; else {
			var b = a.child1;
			var c = a.child2;
			var balance = c.height - b.height;
			if(balance > 1) {
				var f = c.child1;
				var g = c.child2;
				c.child1 = a;
				c.parent = a.parent;
				a.parent = c;
				if(c.parent != null) {
					if(c.parent.child1 == a) c.parent.child1 = c; else c.parent.child2 = c;
				} else this.root = c;
				if(f.height > g.height) {
					c.child2 = f;
					a.child2 = g;
					g.parent = a;
					a.aabb.setCombine(b.aabb,g.aabb);
					c.aabb.setCombine(a.aabb,f.aabb);
					a.height = 1 + (function($this) {
						var $r;
						var x = b.height;
						var y = g.height;
						$r = x > y?x:y;
						return $r;
					}(this));
					c.height = 1 + (function($this) {
						var $r;
						var x = a.height;
						var y = f.height;
						$r = x > y?x:y;
						return $r;
					}(this));
				} else {
					c.child2 = g;
					a.child2 = f;
					f.parent = a;
					a.aabb.setCombine(b.aabb,f.aabb);
					c.aabb.setCombine(a.aabb,g.aabb);
					a.height = 1 + (function($this) {
						var $r;
						var x = b.height;
						var y = f.height;
						$r = x > y?x:y;
						return $r;
					}(this));
					c.height = 1 + (function($this) {
						var $r;
						var x = a.height;
						var y = g.height;
						$r = x > y?x:y;
						return $r;
					}(this));
				}
				return c;
			} else if(balance < -1) {
				var f = b.child1;
				var g = b.child2;
				b.child1 = a;
				b.parent = a.parent;
				a.parent = b;
				if(b.parent != null) {
					if(b.parent.child1 == a) b.parent.child1 = b; else b.parent.child2 = b;
				} else this.root = b;
				if(f.height > g.height) {
					b.child2 = f;
					a.child1 = g;
					g.parent = a;
					a.aabb.setCombine(c.aabb,g.aabb);
					b.aabb.setCombine(a.aabb,f.aabb);
					a.height = 1 + (function($this) {
						var $r;
						var x = c.height;
						var y = g.height;
						$r = x > y?x:y;
						return $r;
					}(this));
					b.height = 1 + (function($this) {
						var $r;
						var x = a.height;
						var y = f.height;
						$r = x > y?x:y;
						return $r;
					}(this));
				} else {
					b.child2 = g;
					a.child1 = f;
					f.parent = a;
					a.aabb.setCombine(c.aabb,f.aabb);
					b.aabb.setCombine(a.aabb,g.aabb);
					a.height = 1 + (function($this) {
						var $r;
						var x = c.height;
						var y = f.height;
						$r = x > y?x:y;
						return $r;
					}(this));
					b.height = 1 + (function($this) {
						var $r;
						var x = a.height;
						var y = g.height;
						$r = x > y?x:y;
						return $r;
					}(this));
				}
				return b;
			} else return a;
		}
	}
	,inlined_removeLeaf: function(leaf) {
		if(leaf == this.root) {
			this.root = null;
			return;
		} else {
			var parent = leaf.parent;
			var gparent = parent.parent;
			var sibling = parent.child1 == leaf?parent.child2:parent.child1;
			if(gparent != null) {
				if(gparent.child1 == parent) gparent.child1 = sibling; else gparent.child2 = sibling;
				sibling.parent = gparent;
				var o = parent;
				o.free();
				o.next = zpp_nape.space.ZPP_AABBNode.zpp_pool;
				zpp_nape.space.ZPP_AABBNode.zpp_pool = o;
				var node = gparent;
				while(node != null) {
					node = this.balance(node);
					var child1 = node.child1;
					var child2 = node.child2;
					node.aabb.setCombine(child1.aabb,child2.aabb);
					node.height = 1 + (function($this) {
						var $r;
						var x = child1.height;
						var y = child2.height;
						$r = x > y?x:y;
						return $r;
					}(this));
					node = node.parent;
				}
			} else {
				this.root = sibling;
				sibling.parent = null;
				var o = parent;
				o.free();
				o.next = zpp_nape.space.ZPP_AABBNode.zpp_pool;
				zpp_nape.space.ZPP_AABBNode.zpp_pool = o;
			}
		}
	}
	,removeLeaf: function(leaf) {
		this.inlined_removeLeaf(leaf);
	}
	,inlined_insertLeaf: function(leaf) {
		if(this.root == null) {
			this.root = leaf;
			this.root.parent = null;
		} else {
			var leafaabb = leaf.aabb;
			var node = this.root;
			while(!node.isLeaf()) {
				var child1 = node.child1;
				var child2 = node.child2;
				var area = node.aabb.perimeter();
				zpp_nape.space.ZPP_AABBTree.tmpaabb.setCombine(node.aabb,leafaabb);
				var carea = zpp_nape.space.ZPP_AABBTree.tmpaabb.perimeter();
				var cost = 2 * carea;
				var icost = 2 * (carea - area);
				var cost1 = (function($this) {
					var $r;
					zpp_nape.space.ZPP_AABBTree.tmpaabb.setCombine(leafaabb,child1.aabb);
					$r = child1.isLeaf()?zpp_nape.space.ZPP_AABBTree.tmpaabb.perimeter() + icost:(function($this) {
						var $r;
						var oarea = child1.aabb.perimeter();
						var narea = zpp_nape.space.ZPP_AABBTree.tmpaabb.perimeter();
						$r = narea - oarea + icost;
						return $r;
					}($this));
					return $r;
				}(this));
				var cost2 = (function($this) {
					var $r;
					zpp_nape.space.ZPP_AABBTree.tmpaabb.setCombine(leafaabb,child2.aabb);
					$r = child2.isLeaf()?zpp_nape.space.ZPP_AABBTree.tmpaabb.perimeter() + icost:(function($this) {
						var $r;
						var oarea = child2.aabb.perimeter();
						var narea = zpp_nape.space.ZPP_AABBTree.tmpaabb.perimeter();
						$r = narea - oarea + icost;
						return $r;
					}($this));
					return $r;
				}(this));
				if(cost < cost1 && cost < cost2) break; else node = cost1 < cost2?child1:child2;
			}
			var sibling = node;
			var oparent = sibling.parent;
			var nparent;
			if(zpp_nape.space.ZPP_AABBNode.zpp_pool == null) nparent = new zpp_nape.space.ZPP_AABBNode(); else {
				nparent = zpp_nape.space.ZPP_AABBNode.zpp_pool;
				zpp_nape.space.ZPP_AABBNode.zpp_pool = nparent.next;
				nparent.next = null;
			}
			nparent.alloc();
			nparent.parent = oparent;
			nparent.aabb.setCombine(leafaabb,sibling.aabb);
			nparent.height = sibling.height + 1;
			if(oparent != null) {
				if(oparent.child1 == sibling) oparent.child1 = nparent; else oparent.child2 = nparent;
				nparent.child1 = sibling;
				nparent.child2 = leaf;
				sibling.parent = nparent;
				leaf.parent = nparent;
			} else {
				nparent.child1 = sibling;
				nparent.child2 = leaf;
				sibling.parent = nparent;
				leaf.parent = nparent;
				this.root = nparent;
			}
			node = leaf.parent;
			while(node != null) {
				node = this.balance(node);
				var child1 = node.child1;
				var child2 = node.child2;
				node.height = 1 + (function($this) {
					var $r;
					var x = child1.height;
					var y = child2.height;
					$r = x > y?x:y;
					return $r;
				}(this));
				node.aabb.setCombine(child1.aabb,child2.aabb);
				node = node.parent;
			}
		}
	}
	,clear: function() {
		if(this.root == null) return;
		var stack = null;
		this.root.next = stack;
		stack = this.root;
		while(stack != null) {
			var node = (function($this) {
				var $r;
				{
				}
				var ret = stack;
				stack = ret.next;
				ret.next = null;
				$r = ret;
				return $r;
			}(this));
			if(node.isLeaf()) {
				node.shape.node = null;
				node.shape.removedFromSpace();
				node.shape = null;
			} else {
				if(node.child1 != null) {
					node.child1.next = stack;
					stack = node.child1;
				}
				if(node.child2 != null) {
					node.child2.next = stack;
					stack = node.child2;
				}
			}
			var o = node;
			o.free();
			o.next = zpp_nape.space.ZPP_AABBNode.zpp_pool;
			zpp_nape.space.ZPP_AABBNode.zpp_pool = o;
		}
		this.root = null;
	}
	,__class__: zpp_nape.space.ZPP_AABBTree
}
zpp_nape.space.ZPP_DynAABBPhase = function(space) {
	this.openlist = null;
	this.failed = null;
	this.treeStack2 = null;
	this.treeStack = null;
	this.moves = null;
	this.syncs = null;
	this.pairs = null;
	this.dtree = null;
	this.stree = null;
	this.space = space;
	this.is_sweep = false;
	this.dynab = this;
	this.stree = new zpp_nape.space.ZPP_AABBTree();
	this.dtree = new zpp_nape.space.ZPP_AABBTree();
};
$hxClasses["zpp_nape.space.ZPP_DynAABBPhase"] = zpp_nape.space.ZPP_DynAABBPhase;
zpp_nape.space.ZPP_DynAABBPhase.__name__ = ["zpp_nape","space","ZPP_DynAABBPhase"];
zpp_nape.space.ZPP_DynAABBPhase.__super__ = zpp_nape.space.ZPP_Broadphase;
zpp_nape.space.ZPP_DynAABBPhase.prototype = $extend(zpp_nape.space.ZPP_Broadphase.prototype,{
	rayMultiCast: function(ray,inner,filter,output) {
		if(this.openlist == null) this.openlist = new zpp_nape.util.ZNPList_ZPP_AABBNode();
		this.sync_broadphase();
		ray.validate_dir();
		var inf = ray.maxdist >= zpp_nape.ZPP_Const.POSINF();
		var ret = output == null?new nape.geom.RayResultList():output;
		if(this.dtree.root != null) {
			if(ray.aabbtest(this.dtree.root.aabb)) {
				if(inf) this.openlist.add(this.dtree.root); else {
					var t = ray.aabbsect(this.dtree.root.aabb);
					if(t >= 0 && t < ray.maxdist) this.openlist.add(this.dtree.root);
				}
			}
		}
		if(this.stree.root != null) {
			if(ray.aabbtest(this.stree.root.aabb)) {
				if(inf) this.openlist.add(this.stree.root); else {
					var t = ray.aabbsect(this.stree.root.aabb);
					if(t >= 0 && t < ray.maxdist) this.openlist.add(this.stree.root);
				}
			}
		}
		while(!this.openlist.empty()) {
			var cnode = this.openlist.pop_unsafe();
			if(cnode.isLeaf()) {
				var shape = cnode.shape;
				if(filter == null || shape.filter.shouldCollide(filter)) {
					if(shape.isCircle()) ray.circlesect2(shape.circle,inner,ret); else if(ray.aabbtest(shape.aabb)) ray.polysect2(shape.polygon,inner,ret);
				}
			} else {
				if(cnode.child1 != null) {
					if(ray.aabbtest(cnode.child1.aabb)) {
						if(inf) this.openlist.add(cnode.child1); else {
							var t = ray.aabbsect(cnode.child1.aabb);
							if(t >= 0 && t < ray.maxdist) this.openlist.add(cnode.child1);
						}
					}
				}
				if(cnode.child2 != null) {
					if(ray.aabbtest(cnode.child2.aabb)) {
						if(inf) this.openlist.add(cnode.child2); else {
							var t = ray.aabbsect(cnode.child2.aabb);
							if(t >= 0 && t < ray.maxdist) this.openlist.add(cnode.child2);
						}
					}
				}
			}
		}
		this.openlist.clear();
		return ret;
	}
	,rayCast: function(ray,inner,filter) {
		if(this.openlist == null) this.openlist = new zpp_nape.util.ZNPList_ZPP_AABBNode();
		this.sync_broadphase();
		ray.validate_dir();
		var mint = ray.maxdist;
		if(this.dtree.root != null) {
			if(ray.aabbtest(this.dtree.root.aabb)) {
				var t = ray.aabbsect(this.dtree.root.aabb);
				if(t >= 0 && t < mint) {
					this.dtree.root.rayt = t;
					var pre = null;
					var cx_ite = this.openlist.begin();
					while(cx_ite != null) {
						var j = cx_ite.elem();
						if(this.dtree.root.rayt < j.rayt) break;
						pre = cx_ite;
						cx_ite = cx_ite.next;
					}
					this.openlist.inlined_insert(pre,this.dtree.root);
				}
			}
		}
		if(this.stree.root != null) {
			if(ray.aabbtest(this.stree.root.aabb)) {
				var t = ray.aabbsect(this.stree.root.aabb);
				if(t >= 0 && t < mint) {
					this.stree.root.rayt = t;
					var pre = null;
					var cx_ite = this.openlist.begin();
					while(cx_ite != null) {
						var j = cx_ite.elem();
						if(this.stree.root.rayt < j.rayt) break;
						pre = cx_ite;
						cx_ite = cx_ite.next;
					}
					this.openlist.inlined_insert(pre,this.stree.root);
				}
			}
		}
		var minres = null;
		while(!this.openlist.empty()) {
			var cnode = this.openlist.pop_unsafe();
			if(cnode.rayt >= mint) break;
			if(cnode.isLeaf()) {
				var shape = cnode.shape;
				if(filter == null || shape.filter.shouldCollide(filter)) {
					var result = shape.isCircle()?ray.circlesect(shape.circle,inner,mint):ray.aabbtest(shape.aabb)?ray.polysect(shape.polygon,inner,mint):null;
					if(result != null) {
						mint = result.get_distance();
						if(minres != null) minres.dispose();
						minres = result;
					}
				}
			} else {
				if(cnode.child1 != null) {
					if(ray.aabbtest(cnode.child1.aabb)) {
						var t = ray.aabbsect(cnode.child1.aabb);
						if(t >= 0 && t < mint) {
							cnode.child1.rayt = t;
							var pre = null;
							var cx_ite = this.openlist.begin();
							while(cx_ite != null) {
								var j = cx_ite.elem();
								if(cnode.child1.rayt < j.rayt) break;
								pre = cx_ite;
								cx_ite = cx_ite.next;
							}
							this.openlist.inlined_insert(pre,cnode.child1);
						}
					}
				}
				if(cnode.child2 != null) {
					if(ray.aabbtest(cnode.child2.aabb)) {
						var t = ray.aabbsect(cnode.child2.aabb);
						if(t >= 0 && t < mint) {
							cnode.child2.rayt = t;
							var pre = null;
							var cx_ite = this.openlist.begin();
							while(cx_ite != null) {
								var j = cx_ite.elem();
								if(cnode.child2.rayt < j.rayt) break;
								pre = cx_ite;
								cx_ite = cx_ite.next;
							}
							this.openlist.inlined_insert(pre,cnode.child2);
						}
					}
				}
			}
		}
		this.openlist.clear();
		return minres;
	}
	,bodiesInShape: function(shp,containment,filter,output) {
		this.sync_broadphase();
		this.validateShape(shp);
		var ab = shp.aabb;
		var ret = output == null?new nape.phys.BodyList():output;
		if(this.failed == null) this.failed = new nape.phys.BodyList();
		if(this.stree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.stree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						var body = node.shape.body.outer;
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(containment) {
								if(!this.failed.has(body)) {
									var col = zpp_nape.geom.ZPP_Collide.containTest(shp,node.shape);
									if(!ret.has(body) && col) ret.push(body); else if(!col) {
										ret.remove(body);
										this.failed.push(body);
									}
								}
							} else if(!ret.has(body) && zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,shp)) ret.push(body);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		if(this.dtree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.dtree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						var body = node.shape.body.outer;
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(containment) {
								if(!this.failed.has(body)) {
									var col = zpp_nape.geom.ZPP_Collide.containTest(shp,node.shape);
									if(!ret.has(body) && col) ret.push(body); else if(!col) {
										ret.remove(body);
										this.failed.push(body);
									}
								}
							} else if(!ret.has(body) && zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,shp)) ret.push(body);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		this.failed.clear();
		return ret;
	}
	,shapesInShape: function(shp,containment,filter,output) {
		this.sync_broadphase();
		this.validateShape(shp);
		var ab = shp.aabb;
		var ret = output == null?new nape.shape.ShapeList():output;
		if(this.stree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.stree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(containment) {
								if(zpp_nape.geom.ZPP_Collide.containTest(shp,node.shape)) ret.push(node.shape.outer);
							} else if(zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,shp)) ret.push(node.shape.outer);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		if(this.dtree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.dtree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(containment) {
								if(zpp_nape.geom.ZPP_Collide.containTest(shp,node.shape)) ret.push(node.shape.outer);
							} else if(zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,shp)) ret.push(node.shape.outer);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		return ret;
	}
	,bodiesInCircle: function(x,y,r,containment,filter,output) {
		this.sync_broadphase();
		this.updateCircShape(x,y,r);
		var ab = this.circShape.zpp_inner.aabb;
		var ret = output == null?new nape.phys.BodyList():output;
		if(this.failed == null) this.failed = new nape.phys.BodyList();
		if(this.stree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.stree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						var body = node.shape.body.outer;
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(containment) {
								if(!this.failed.has(body)) {
									var col = zpp_nape.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,node.shape);
									if(!ret.has(body) && col) ret.push(body); else if(!col) {
										ret.remove(body);
										this.failed.push(body);
									}
								}
							} else if(!ret.has(body) && zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,this.circShape.zpp_inner)) ret.push(body);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		if(this.dtree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.dtree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						var body = node.shape.body.outer;
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(containment) {
								if(!this.failed.has(body)) {
									var col = zpp_nape.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,node.shape);
									if(!ret.has(body) && col) ret.push(body); else if(!col) {
										ret.remove(body);
										this.failed.push(body);
									}
								}
							} else if(!ret.has(body) && zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,this.circShape.zpp_inner)) ret.push(body);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		this.failed.clear();
		return ret;
	}
	,shapesInCircle: function(x,y,r,containment,filter,output) {
		this.sync_broadphase();
		this.updateCircShape(x,y,r);
		var ab = this.circShape.zpp_inner.aabb;
		var ret = output == null?new nape.shape.ShapeList():output;
		if(this.stree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.stree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(containment) {
								if(zpp_nape.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,node.shape)) ret.push(node.shape.outer);
							} else if(zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,this.circShape.zpp_inner)) ret.push(node.shape.outer);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		if(this.dtree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.dtree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(containment) {
								if(zpp_nape.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,node.shape)) ret.push(node.shape.outer);
							} else if(zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,this.circShape.zpp_inner)) ret.push(node.shape.outer);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		return ret;
	}
	,bodiesInAABB: function(aabb,strict,containment,filter,output) {
		this.sync_broadphase();
		this.updateAABBShape(aabb);
		var ab = this.aabbShape.zpp_inner.aabb;
		var ret = output == null?new nape.phys.BodyList():output;
		if(this.failed == null) this.failed = new nape.phys.BodyList();
		if(this.stree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.stree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(ab.contains(node.aabb)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							var body = node.shape.body.outer;
							if(!ret.has(body)) ret.push(body);
						}
					} else {
						if(this.treeStack2 == null) this.treeStack2 = new zpp_nape.util.ZNPList_ZPP_AABBNode();
						this.treeStack2.add(node);
						while(!this.treeStack2.empty()) {
							var node1 = this.treeStack2.pop_unsafe();
							if(node1.isLeaf()) {
								if(filter == null || node1.shape.filter.shouldCollide(filter)) {
									var body = node1.shape.body.outer;
									if(!ret.has(body)) ret.push(body);
								}
							} else {
								if(node1.child1 != null) this.treeStack2.add(node1.child1);
								if(node1.child2 != null) this.treeStack2.add(node1.child2);
							}
						}
					}
				} else if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						var body = node.shape.body.outer;
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(strict) {
								if(containment) {
									if(!this.failed.has(body)) {
										var col = zpp_nape.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,node.shape);
										if(!ret.has(body) && col) ret.push(body); else if(!col) {
											ret.remove(body);
											this.failed.push(body);
										}
									}
								} else if(!ret.has(body) && zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,this.aabbShape.zpp_inner)) ret.push(body);
							} else if(containment) {
								if(!this.failed.has(body)) {
									var col = ab.contains(node.shape.aabb);
									if(!ret.has(body) && col) ret.push(body); else if(!col) {
										ret.remove(body);
										this.failed.push(body);
									}
								}
							} else if(!ret.has(body) && ab.contains(node.shape.aabb)) ret.push(body);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		if(this.dtree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.dtree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(ab.contains(node.aabb)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							var body = node.shape.body.outer;
							if(!ret.has(body)) ret.push(body);
						}
					} else {
						if(this.treeStack2 == null) this.treeStack2 = new zpp_nape.util.ZNPList_ZPP_AABBNode();
						this.treeStack2.add(node);
						while(!this.treeStack2.empty()) {
							var node1 = this.treeStack2.pop_unsafe();
							if(node1.isLeaf()) {
								if(filter == null || node1.shape.filter.shouldCollide(filter)) {
									var body = node1.shape.body.outer;
									if(!ret.has(body)) ret.push(body);
								}
							} else {
								if(node1.child1 != null) this.treeStack2.add(node1.child1);
								if(node1.child2 != null) this.treeStack2.add(node1.child2);
							}
						}
					}
				} else if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						var body = node.shape.body.outer;
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(strict) {
								if(containment) {
									if(!this.failed.has(body)) {
										var col = zpp_nape.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,node.shape);
										if(!ret.has(body) && col) ret.push(body); else if(!col) {
											ret.remove(body);
											this.failed.push(body);
										}
									}
								} else if(!ret.has(body) && zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,this.aabbShape.zpp_inner)) ret.push(body);
							} else if(containment) {
								if(!this.failed.has(body)) {
									var col = ab.contains(node.shape.aabb);
									if(!ret.has(body) && col) ret.push(body); else if(!col) {
										ret.remove(body);
										this.failed.push(body);
									}
								}
							} else if(!ret.has(body) && ab.contains(node.shape.aabb)) ret.push(body);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		this.failed.clear();
		return ret;
	}
	,shapesInAABB: function(aabb,strict,containment,filter,output) {
		this.sync_broadphase();
		this.updateAABBShape(aabb);
		var ab = this.aabbShape.zpp_inner.aabb;
		var ret = output == null?new nape.shape.ShapeList():output;
		if(this.stree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.stree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(ab.contains(node.aabb)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) ret.push(node.shape.outer);
					} else {
						if(this.treeStack2 == null) this.treeStack2 = new zpp_nape.util.ZNPList_ZPP_AABBNode();
						this.treeStack2.add(node);
						while(!this.treeStack2.empty()) {
							var node1 = this.treeStack2.pop_unsafe();
							if(node1.isLeaf()) {
								if(filter == null || node1.shape.filter.shouldCollide(filter)) ret.push(node1.shape.outer);
							} else {
								if(node1.child1 != null) this.treeStack2.add(node1.child1);
								if(node1.child2 != null) this.treeStack2.add(node1.child2);
							}
						}
					}
				} else if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(strict) {
								if(containment) {
									if(zpp_nape.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,node.shape)) ret.push(node.shape.outer);
								} else if(ab.contains(node.shape.aabb)) ret.push(node.shape.outer); else if(zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,this.aabbShape.zpp_inner)) ret.push(node.shape.outer);
							} else if(!containment || ab.contains(node.shape.aabb)) ret.push(node.shape.outer);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		if(this.dtree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.dtree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(ab.contains(node.aabb)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) ret.push(node.shape.outer);
					} else {
						if(this.treeStack2 == null) this.treeStack2 = new zpp_nape.util.ZNPList_ZPP_AABBNode();
						this.treeStack2.add(node);
						while(!this.treeStack2.empty()) {
							var node1 = this.treeStack2.pop_unsafe();
							if(node1.isLeaf()) {
								if(filter == null || node1.shape.filter.shouldCollide(filter)) ret.push(node1.shape.outer);
							} else {
								if(node1.child1 != null) this.treeStack2.add(node1.child1);
								if(node1.child2 != null) this.treeStack2.add(node1.child2);
							}
						}
					}
				} else if(node.aabb.intersect(ab)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(strict) {
								if(containment) {
									if(zpp_nape.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,node.shape)) ret.push(node.shape.outer);
								} else if(ab.contains(node.shape.aabb)) ret.push(node.shape.outer); else if(zpp_nape.geom.ZPP_Collide.testCollide_safe(node.shape,this.aabbShape.zpp_inner)) ret.push(node.shape.outer);
							} else if(!containment || ab.contains(node.shape.aabb)) ret.push(node.shape.outer);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		return ret;
	}
	,bodiesUnderPoint: function(x,y,filter,output) {
		this.sync_broadphase();
		var v = zpp_nape.geom.ZPP_Vec2.get(x,y);
		var ret = output == null?new nape.phys.BodyList():output;
		if(this.stree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.stree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.containsPoint(v)) {
					if(node.isLeaf()) {
						var body = node.shape.body.outer;
						if(!ret.has(body)) {
							if(filter == null || node.shape.filter.shouldCollide(filter)) {
								if(node.shape.isCircle()) {
									if(zpp_nape.geom.ZPP_Collide.circleContains(node.shape.circle,v)) ret.push(body);
								} else if(zpp_nape.geom.ZPP_Collide.polyContains(node.shape.polygon,v)) ret.push(body);
							}
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		if(this.dtree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.dtree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.containsPoint(v)) {
					if(node.isLeaf()) {
						var body = node.shape.body.outer;
						if(!ret.has(body)) {
							if(filter == null || node.shape.filter.shouldCollide(filter)) {
								if(node.shape.isCircle()) {
									if(zpp_nape.geom.ZPP_Collide.circleContains(node.shape.circle,v)) ret.push(body);
								} else if(zpp_nape.geom.ZPP_Collide.polyContains(node.shape.polygon,v)) ret.push(body);
							}
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		var o = v;
		o.free();
		o.next = zpp_nape.geom.ZPP_Vec2.zpp_pool;
		zpp_nape.geom.ZPP_Vec2.zpp_pool = o;
		return ret;
	}
	,shapesUnderPoint: function(x,y,filter,output) {
		this.sync_broadphase();
		var v = zpp_nape.geom.ZPP_Vec2.get(x,y);
		var ret = output == null?new nape.shape.ShapeList():output;
		if(this.stree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.stree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.containsPoint(v)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(node.shape.isCircle()) {
								if(zpp_nape.geom.ZPP_Collide.circleContains(node.shape.circle,v)) ret.push(node.shape.outer);
							} else if(zpp_nape.geom.ZPP_Collide.polyContains(node.shape.polygon,v)) ret.push(node.shape.outer);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		if(this.dtree.root != null) {
			if(this.treeStack == null) this.treeStack = new zpp_nape.util.ZNPList_ZPP_AABBNode();
			this.treeStack.add(this.dtree.root);
			while(!this.treeStack.empty()) {
				var node = this.treeStack.pop_unsafe();
				if(node.aabb.containsPoint(v)) {
					if(node.isLeaf()) {
						if(filter == null || node.shape.filter.shouldCollide(filter)) {
							if(node.shape.isCircle()) {
								if(zpp_nape.geom.ZPP_Collide.circleContains(node.shape.circle,v)) ret.push(node.shape.outer);
							} else if(zpp_nape.geom.ZPP_Collide.polyContains(node.shape.polygon,v)) ret.push(node.shape.outer);
						}
					} else {
						if(node.child1 != null) this.treeStack.add(node.child1);
						if(node.child2 != null) this.treeStack.add(node.child2);
					}
				}
			}
		}
		var o = v;
		o.free();
		o.next = zpp_nape.geom.ZPP_Vec2.zpp_pool;
		zpp_nape.geom.ZPP_Vec2.zpp_pool = o;
		return ret;
	}
	,clear: function() {
		while(this.syncs != null) {
			var next = this.syncs.snext;
			this.syncs.snext = null;
			if(this.syncs.first_sync) {
				this.syncs.shape.node = null;
				this.syncs.shape.removedFromSpace();
				this.syncs.shape = null;
			}
			this.syncs = next;
		}
		while(this.moves != null) {
			var next = this.moves.mnext;
			this.moves.mnext = null;
			if(this.moves.first_sync) {
				this.moves.shape.node = null;
				this.moves.shape.removedFromSpace();
				this.moves.shape = null;
			}
			this.moves = next;
		}
		while(this.pairs != null) {
			var nxt = this.pairs.next;
			if(this.pairs.arb != null) this.pairs.arb.pair = null;
			this.pairs.arb = null;
			this.pairs.n1.shape.pairs.inlined_remove(this.pairs);
			this.pairs.n2.shape.pairs.inlined_remove(this.pairs);
			var o = this.pairs;
			o.free();
			o.next = zpp_nape.space.ZPP_AABBPair.zpp_pool;
			zpp_nape.space.ZPP_AABBPair.zpp_pool = o;
			this.pairs = nxt;
		}
		this.dtree.clear();
		this.stree.clear();
	}
	,broadphase: function(space,discrete) {
		var node = this.syncs;
		while(node != null) {
			var shape = node.shape;
			if(!node.first_sync) {
				var tree = node.dyn?this.dtree:this.stree;
				tree.inlined_removeLeaf(node);
			} else node.first_sync = false;
			var aabb = node.aabb;
			if(!space.continuous) shape.validate_aabb();
			aabb.setExpand(shape.aabb,3.0);
			var tree = (node.dyn = this.dyn(shape))?this.dtree:this.stree;
			tree.inlined_insertLeaf(node);
			node.synced = false;
			node = node.snext;
		}
		while(this.syncs != null) {
			var leaf = (function($this) {
				var $r;
				{
				}
				var ret = $this.syncs;
				$this.syncs = ret.snext;
				ret.snext = null;
				$r = ret;
				return $r;
			}(this));
			if("syncs" != "moves" && leaf.moved) continue;
			leaf.moved = false;
			var lshape = leaf.shape;
			var lbody = lshape.body;
			if(lbody.component.sleeping) continue;
			var ab = leaf.aabb;
			var stack = null;
			if(this.dtree.root != null) {
				this.dtree.root.next = stack;
				stack = this.dtree.root;
			}
			while(stack != null) {
				var node1 = (function($this) {
					var $r;
					{
					}
					var ret = stack;
					stack = ret.next;
					ret.next = null;
					$r = ret;
					return $r;
				}(this));
				if(node1 == leaf) continue;
				if(node1.isLeaf()) {
					var shape = node1.shape;
					if(shape.body != lshape.body && !(shape.body.isStatic() && lshape.body.isStatic())) {
						if(ab.intersect(node1.aabb)) {
							var id;
							var di;
							if(lshape.id < shape.id) {
								id = lshape.id;
								di = shape.id;
							} else {
								id = shape.id;
								di = lshape.id;
							}
							var s = lshape.pairs.length < shape.pairs.length?lshape:shape;
							var p = null;
							var cx_ite = s.pairs.begin();
							while(cx_ite != null) {
								var px = cx_ite.elem();
								if(px.id == id && px.di == di) {
									p = px;
									break;
								}
								cx_ite = cx_ite.next;
							}
							if(p != null) {
								if(p.sleeping) {
									p.sleeping = false;
									p.next = this.pairs;
									this.pairs = p;
									p.first = true;
								}
								continue;
							}
							if(zpp_nape.space.ZPP_AABBPair.zpp_pool == null) p = new zpp_nape.space.ZPP_AABBPair(); else {
								p = zpp_nape.space.ZPP_AABBPair.zpp_pool;
								zpp_nape.space.ZPP_AABBPair.zpp_pool = p.next;
								p.next = null;
							}
							p.alloc();
							p.n1 = leaf;
							p.n2 = node1;
							p.id = id;
							p.di = di;
							p.next = this.pairs;
							this.pairs = p;
							p.first = true;
							lshape.pairs.inlined_add(p);
							shape.pairs.inlined_add(p);
						}
					}
				} else if(ab.intersect(node1.aabb)) {
					if(node1.child1 != null) {
						node1.child1.next = stack;
						stack = node1.child1;
					}
					if(node1.child2 != null) {
						node1.child2.next = stack;
						stack = node1.child2;
					}
				}
			}
			if(this.stree.root != null) {
				this.stree.root.next = stack;
				stack = this.stree.root;
			}
			while(stack != null) {
				var node1 = (function($this) {
					var $r;
					{
					}
					var ret = stack;
					stack = ret.next;
					ret.next = null;
					$r = ret;
					return $r;
				}(this));
				if(node1 == leaf) continue;
				if(node1.isLeaf()) {
					var shape = node1.shape;
					if(shape.body != lshape.body && !(shape.body.isStatic() && lshape.body.isStatic())) {
						if(ab.intersect(node1.aabb)) {
							var id;
							var di;
							if(lshape.id < shape.id) {
								id = lshape.id;
								di = shape.id;
							} else {
								id = shape.id;
								di = lshape.id;
							}
							var s = lshape.pairs.length < shape.pairs.length?lshape:shape;
							var p = null;
							var cx_ite = s.pairs.begin();
							while(cx_ite != null) {
								var px = cx_ite.elem();
								if(px.id == id && px.di == di) {
									p = px;
									break;
								}
								cx_ite = cx_ite.next;
							}
							if(p != null) {
								if(p.sleeping) {
									p.sleeping = false;
									p.next = this.pairs;
									this.pairs = p;
									p.first = true;
								}
								continue;
							}
							if(zpp_nape.space.ZPP_AABBPair.zpp_pool == null) p = new zpp_nape.space.ZPP_AABBPair(); else {
								p = zpp_nape.space.ZPP_AABBPair.zpp_pool;
								zpp_nape.space.ZPP_AABBPair.zpp_pool = p.next;
								p.next = null;
							}
							p.alloc();
							p.n1 = leaf;
							p.n2 = node1;
							p.id = id;
							p.di = di;
							p.next = this.pairs;
							this.pairs = p;
							p.first = true;
							lshape.pairs.inlined_add(p);
							shape.pairs.inlined_add(p);
						}
					}
				} else if(ab.intersect(node1.aabb)) {
					if(node1.child1 != null) {
						node1.child1.next = stack;
						stack = node1.child1;
					}
					if(node1.child2 != null) {
						node1.child2.next = stack;
						stack = node1.child2;
					}
				}
			}
		}
		while(this.moves != null) {
			var leaf = (function($this) {
				var $r;
				{
				}
				var ret = $this.moves;
				$this.moves = ret.mnext;
				ret.mnext = null;
				$r = ret;
				return $r;
			}(this));
			if("moves" != "moves" && leaf.moved) continue;
			leaf.moved = false;
			var lshape = leaf.shape;
			var lbody = lshape.body;
			if(lbody.component.sleeping) continue;
			var ab = leaf.aabb;
			var stack = null;
			if(this.dtree.root != null) {
				this.dtree.root.next = stack;
				stack = this.dtree.root;
			}
			while(stack != null) {
				var node1 = (function($this) {
					var $r;
					{
					}
					var ret = stack;
					stack = ret.next;
					ret.next = null;
					$r = ret;
					return $r;
				}(this));
				if(node1 == leaf) continue;
				if(node1.isLeaf()) {
					var shape = node1.shape;
					if(shape.body != lshape.body && !(shape.body.isStatic() && lshape.body.isStatic())) {
						if(ab.intersect(node1.aabb)) {
							var id;
							var di;
							if(lshape.id < shape.id) {
								id = lshape.id;
								di = shape.id;
							} else {
								id = shape.id;
								di = lshape.id;
							}
							var s = lshape.pairs.length < shape.pairs.length?lshape:shape;
							var p = null;
							var cx_ite = s.pairs.begin();
							while(cx_ite != null) {
								var px = cx_ite.elem();
								if(px.id == id && px.di == di) {
									p = px;
									break;
								}
								cx_ite = cx_ite.next;
							}
							if(p != null) {
								if(p.sleeping) {
									p.sleeping = false;
									p.next = this.pairs;
									this.pairs = p;
									p.first = true;
								}
								continue;
							}
							if(zpp_nape.space.ZPP_AABBPair.zpp_pool == null) p = new zpp_nape.space.ZPP_AABBPair(); else {
								p = zpp_nape.space.ZPP_AABBPair.zpp_pool;
								zpp_nape.space.ZPP_AABBPair.zpp_pool = p.next;
								p.next = null;
							}
							p.alloc();
							p.n1 = leaf;
							p.n2 = node1;
							p.id = id;
							p.di = di;
							p.next = this.pairs;
							this.pairs = p;
							p.first = true;
							lshape.pairs.inlined_add(p);
							shape.pairs.inlined_add(p);
						}
					}
				} else if(ab.intersect(node1.aabb)) {
					if(node1.child1 != null) {
						node1.child1.next = stack;
						stack = node1.child1;
					}
					if(node1.child2 != null) {
						node1.child2.next = stack;
						stack = node1.child2;
					}
				}
			}
			if(this.stree.root != null) {
				this.stree.root.next = stack;
				stack = this.stree.root;
			}
			while(stack != null) {
				var node1 = (function($this) {
					var $r;
					{
					}
					var ret = stack;
					stack = ret.next;
					ret.next = null;
					$r = ret;
					return $r;
				}(this));
				if(node1 == leaf) continue;
				if(node1.isLeaf()) {
					var shape = node1.shape;
					if(shape.body != lshape.body && !(shape.body.isStatic() && lshape.body.isStatic())) {
						if(ab.intersect(node1.aabb)) {
							var id;
							var di;
							if(lshape.id < shape.id) {
								id = lshape.id;
								di = shape.id;
							} else {
								id = shape.id;
								di = lshape.id;
							}
							var s = lshape.pairs.length < shape.pairs.length?lshape:shape;
							var p = null;
							var cx_ite = s.pairs.begin();
							while(cx_ite != null) {
								var px = cx_ite.elem();
								if(px.id == id && px.di == di) {
									p = px;
									break;
								}
								cx_ite = cx_ite.next;
							}
							if(p != null) {
								if(p.sleeping) {
									p.sleeping = false;
									p.next = this.pairs;
									this.pairs = p;
									p.first = true;
								}
								continue;
							}
							if(zpp_nape.space.ZPP_AABBPair.zpp_pool == null) p = new zpp_nape.space.ZPP_AABBPair(); else {
								p = zpp_nape.space.ZPP_AABBPair.zpp_pool;
								zpp_nape.space.ZPP_AABBPair.zpp_pool = p.next;
								p.next = null;
							}
							p.alloc();
							p.n1 = leaf;
							p.n2 = node1;
							p.id = id;
							p.di = di;
							p.next = this.pairs;
							this.pairs = p;
							p.first = true;
							lshape.pairs.inlined_add(p);
							shape.pairs.inlined_add(p);
						}
					}
				} else if(ab.intersect(node1.aabb)) {
					if(node1.child1 != null) {
						node1.child1.next = stack;
						stack = node1.child1;
					}
					if(node1.child2 != null) {
						node1.child2.next = stack;
						stack = node1.child2;
					}
				}
			}
		}
		var pre = null;
		var cur = this.pairs;
		while(cur != null) {
			if(!cur.first && !cur.n1.aabb.intersect(cur.n2.aabb)) {
				if(pre == null) this.pairs = cur.next; else pre.next = cur.next;
				cur.n1.shape.pairs.inlined_remove(cur);
				cur.n2.shape.pairs.inlined_remove(cur);
				var nxt = cur.next;
				if(cur.arb != null) cur.arb.pair = null;
				cur.arb = null;
				var o = cur;
				o.free();
				o.next = zpp_nape.space.ZPP_AABBPair.zpp_pool;
				zpp_nape.space.ZPP_AABBPair.zpp_pool = o;
				cur = nxt;
				continue;
			}
			var s1 = cur.n1.shape;
			var b1 = s1.body;
			var s2 = cur.n2.shape;
			var b2 = s2.body;
			if(!cur.first) {
				if((b1.component.sleeping || b1.isStatic()) && (b2.component.sleeping || b2.isStatic())) {
					cur.sleeping = true;
					if(pre == null) this.pairs = cur.next; else pre.next = cur.next;
					cur = cur.next;
					continue;
				}
			}
			cur.first = false;
			if(s1.aabb.intersect(s2.aabb)) {
				var oarb = cur.arb;
				if(discrete) cur.arb = space.narrowPhase(s1,s2,!b1.isDynamic() || !b2.isDynamic(),cur.arb,false); else cur.arb = space.continuousEvent(s1,s2,!b1.isDynamic() || !b2.isDynamic(),cur.arb,false);
				if(cur.arb == null) {
					if(oarb != null) oarb.pair = null;
				} else cur.arb.pair = cur;
			}
			pre = cur;
			cur = cur.next;
		}
	}
	,sync_broadphase: function() {
		this.space.validation();
		if(this.syncs != null) {
			if(this.moves == null) {
				var node = this.syncs;
				while(node != null) {
					var shape = node.shape;
					if(!node.first_sync) {
						var tree = node.dyn?this.dtree:this.stree;
						tree.inlined_removeLeaf(node);
					} else node.first_sync = false;
					var aabb = node.aabb;
					if(!this.space.continuous) shape.validate_aabb();
					aabb.setExpand(shape.aabb,3.0);
					var tree = (node.dyn = this.dyn(shape))?this.dtree:this.stree;
					tree.inlined_insertLeaf(node);
					node.synced = false;
					node.moved = true;
					node.mnext = node.snext;
					node.snext = null;
					node = node.mnext;
				}
				var t = this.syncs;
				this.syncs = this.moves;
				this.moves = t;
			} else while(this.syncs != null) {
				var node = (function($this) {
					var $r;
					{
					}
					var ret = $this.syncs;
					$this.syncs = ret.snext;
					ret.snext = null;
					$r = ret;
					return $r;
				}(this));
				var shape = node.shape;
				if(!node.first_sync) {
					var tree = node.dyn?this.dtree:this.stree;
					tree.inlined_removeLeaf(node);
				} else node.first_sync = false;
				var aabb = node.aabb;
				if(!this.space.continuous) shape.validate_aabb();
				aabb.setExpand(shape.aabb,3.0);
				var tree = (node.dyn = this.dyn(shape))?this.dtree:this.stree;
				tree.inlined_insertLeaf(node);
				node.synced = false;
				if(!node.moved) {
					node.moved = true;
					node.mnext = this.moves;
					this.moves = node;
				}
			}
		}
	}
	,__sync: function(shape) {
		var node = shape.node;
		if(!node.synced) {
			if(!this.space.continuous) shape.validate_aabb();
			var sync = node.dyn != this.dyn(shape) || !node.aabb.contains(shape.aabb);
			if(sync) {
				node.synced = true;
				node.snext = this.syncs;
				this.syncs = node;
			}
		}
	}
	,__remove: function(shape) {
		var node = shape.node;
		if(!node.first_sync) {
			if(node.dyn) this.dtree.removeLeaf(node); else this.stree.removeLeaf(node);
		}
		shape.node = null;
		if(node.synced) {
			var pre = null;
			var cur = this.syncs;
			while(cur != null) {
				if(cur == node) break;
				pre = cur;
				cur = cur.snext;
			}
			if(pre == null) this.syncs = cur.snext; else pre.snext = cur.snext;
			cur.snext = null;
			node.synced = false;
		}
		if(node.moved) {
			var pre = null;
			var cur = this.moves;
			while(cur != null) {
				if(cur == node) break;
				pre = cur;
				cur = cur.mnext;
			}
			if(pre == null) this.moves = cur.mnext; else pre.mnext = cur.mnext;
			cur.mnext = null;
			node.moved = false;
		}
		var pre = null;
		var cur = this.pairs;
		while(cur != null) {
			var nxt = cur.next;
			if(cur.n1 == node || cur.n2 == node) {
				if(pre == null) this.pairs = nxt; else pre.next = nxt;
				if(cur.arb != null) cur.arb.pair = null;
				cur.arb = null;
				cur.n1.shape.pairs.remove(cur);
				cur.n2.shape.pairs.remove(cur);
				var o = cur;
				o.free();
				o.next = zpp_nape.space.ZPP_AABBPair.zpp_pool;
				zpp_nape.space.ZPP_AABBPair.zpp_pool = o;
				cur = nxt;
				continue;
			}
			pre = cur;
			cur = nxt;
		}
		while(!shape.pairs.empty()) {
			var cur1 = shape.pairs.pop_unsafe();
			if(cur1.n1 == node) cur1.n2.shape.pairs.remove(cur1); else cur1.n1.shape.pairs.remove(cur1);
			if(cur1.arb != null) cur1.arb.pair = null;
			cur1.arb = null;
			var o = cur1;
			o.free();
			o.next = zpp_nape.space.ZPP_AABBPair.zpp_pool;
			zpp_nape.space.ZPP_AABBPair.zpp_pool = o;
		}
		var o = node;
		o.free();
		o.next = zpp_nape.space.ZPP_AABBNode.zpp_pool;
		zpp_nape.space.ZPP_AABBNode.zpp_pool = o;
	}
	,__insert: function(shape) {
		var node;
		if(zpp_nape.space.ZPP_AABBNode.zpp_pool == null) node = new zpp_nape.space.ZPP_AABBNode(); else {
			node = zpp_nape.space.ZPP_AABBNode.zpp_pool;
			zpp_nape.space.ZPP_AABBNode.zpp_pool = node.next;
			node.next = null;
		}
		node.alloc();
		node.shape = shape;
		shape.node = node;
		node.synced = true;
		node.first_sync = true;
		node.snext = this.syncs;
		this.syncs = node;
	}
	,dyn: function(shape) {
		if(shape.body.isStatic()) return false; else return !shape.body.component.sleeping;
	}
	,__class__: zpp_nape.space.ZPP_DynAABBPhase
});
zpp_nape.space.ZPP_Island = function() {
	this.waket = 0;
	this.sleep = false;
	this.comps = null;
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this._inuse = false;
	this.next = null;
	this.comps = new zpp_nape.util.ZNPList_ZPP_Component();
};
$hxClasses["zpp_nape.space.ZPP_Island"] = zpp_nape.space.ZPP_Island;
zpp_nape.space.ZPP_Island.__name__ = ["zpp_nape","space","ZPP_Island"];
zpp_nape.space.ZPP_Island.prototype = {
	alloc: function() {
		this.waket = 0;
	}
	,free: function() {
	}
	,front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.next = ret.next;
		ret.elem()._inuse = false;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			o._inuse = true;
			$r = o;
			return $r;
		}(this));
		temp.next = this.begin();
		this.next = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,begin: function() {
		return this.next;
	}
	,elem: function() {
		return this;
	}
	,__class__: zpp_nape.space.ZPP_Island
}
zpp_nape.space.ZPP_Component = function() {
	this.woken = false;
	this.waket = 0;
	this.sleeping = false;
	this.island = null;
	this.constraint = null;
	this.body = null;
	this.isBody = false;
	this.rank = 0;
	this.parent = null;
	this.next = null;
	this.reset();
	this.woken = false;
};
$hxClasses["zpp_nape.space.ZPP_Component"] = zpp_nape.space.ZPP_Component;
zpp_nape.space.ZPP_Component.__name__ = ["zpp_nape","space","ZPP_Component"];
zpp_nape.space.ZPP_Component.prototype = {
	reset: function() {
		this.sleeping = false;
		this.island = null;
		this.parent = this;
		this.rank = 0;
	}
	,alloc: function() {
	}
	,free: function() {
		this.body = null;
		this.constraint = null;
	}
	,__class__: zpp_nape.space.ZPP_Component
}
zpp_nape.space.ZPP_CallbackSet = function() {
	this.lazydel = false;
	this.freed = false;
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this._inuse = false;
	this.next = null;
	this.int2 = null;
	this.int1 = null;
	this.di = 0;
	this.id = 0;
	this.arbiters = new zpp_nape.util.ZNPList_ZPP_Arbiter();
};
$hxClasses["zpp_nape.space.ZPP_CallbackSet"] = zpp_nape.space.ZPP_CallbackSet;
zpp_nape.space.ZPP_CallbackSet.__name__ = ["zpp_nape","space","ZPP_CallbackSet"];
zpp_nape.space.ZPP_CallbackSet.get = function(i1,i2) {
	var ret;
	if(zpp_nape.space.ZPP_CallbackSet.zpp_pool == null) ret = new zpp_nape.space.ZPP_CallbackSet(); else {
		ret = zpp_nape.space.ZPP_CallbackSet.zpp_pool;
		zpp_nape.space.ZPP_CallbackSet.zpp_pool = ret.next;
		ret.next = null;
	}
	ret.alloc();
	if(i1.id < i2.id) {
		ret.int1 = i1;
		ret.int2 = i2;
	} else {
		ret.int1 = i2;
		ret.int2 = i1;
	}
	ret.id = ret.int1.id;
	ret.di = ret.int2.id;
	return ret;
}
zpp_nape.space.ZPP_CallbackSet.prototype = {
	sleeping: function() {
		var ret;
		ret = true;
		var cx_ite = this.arbiters.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(x.sleeping) {
				cx_ite = cx_ite.next;
				continue;
			} else {
				ret = false;
				break;
			}
			cx_ite = cx_ite.next;
		}
		return ret;
	}
	,really_empty: function() {
		return this.arbiters.empty();
	}
	,empty_arb: function(type) {
		var retvar;
		retvar = true;
		var cx_ite = this.arbiters.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if((x.type & type) == 0) {
				cx_ite = cx_ite.next;
				continue;
			} else {
				retvar = false;
				break;
			}
			cx_ite = cx_ite.next;
		}
		return retvar;
	}
	,remove_arb: function(x) {
		this.arbiters.inlined_remove(x);
	}
	,add_arb: function(x) {
		if(!this.arbiters.inlined_has(x)) {
			this.arbiters.inlined_add(x);
			return true;
		} else return false;
	}
	,alloc: function() {
		this.freed = false;
		this.lazydel = false;
		this.COLLISIONstate = zpp_nape.util.ZPP_Flags.id_PreFlag_ACCEPT;
		this.COLLISIONstamp = 0;
		this.SENSORstate = zpp_nape.util.ZPP_Flags.id_PreFlag_ACCEPT;
		this.SENSORstamp = 0;
		this.FLUIDstate = zpp_nape.util.ZPP_Flags.id_PreFlag_ACCEPT;
		this.FLUIDstamp = 0;
	}
	,free: function() {
		this.int1 = this.int2 = null;
		this.id = this.di = -1;
		this.freed = true;
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.next = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		old.elem()._inuse = false;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			o._inuse = true;
			$r = o;
			return $r;
		}(this));
		temp.next = this.begin();
		this.next = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,begin: function() {
		return this.next;
	}
	,elem: function() {
		return this;
	}
	,__class__: zpp_nape.space.ZPP_CallbackSet
}
zpp_nape.space.ZPP_CbSetManager = function(space) {
	this.space = null;
	this.cbsets = null;
	if(zpp_nape.util.ZPP_Set_ZPP_CbSet.zpp_pool == null) this.cbsets = new zpp_nape.util.ZPP_Set_ZPP_CbSet(); else {
		this.cbsets = zpp_nape.util.ZPP_Set_ZPP_CbSet.zpp_pool;
		zpp_nape.util.ZPP_Set_ZPP_CbSet.zpp_pool = this.cbsets.next;
		this.cbsets.next = null;
	}
	this.cbsets.alloc();
	this.cbsets.lt = zpp_nape.callbacks.ZPP_CbSet.setlt;
	this.space = space;
};
$hxClasses["zpp_nape.space.ZPP_CbSetManager"] = zpp_nape.space.ZPP_CbSetManager;
zpp_nape.space.ZPP_CbSetManager.__name__ = ["zpp_nape","space","ZPP_CbSetManager"];
zpp_nape.space.ZPP_CbSetManager.prototype = {
	valid_listener: function(i) {
		return i.space == this.space;
	}
	,pair: function(a,b) {
		var ret = null;
		var pairs = a.cbpairs.length < b.cbpairs.length?a.cbpairs:b.cbpairs;
		var cx_ite = pairs.begin();
		while(cx_ite != null) {
			var p = cx_ite.elem();
			if(p.a == a && p.b == b || p.a == b && p.b == a) {
				ret = p;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(ret == null) {
			ret = zpp_nape.callbacks.ZPP_CbSetPair.get(a,b);
			a.cbpairs.add(ret);
			if(b != a) b.cbpairs.add(ret);
		}
		ret.validate();
		return ret;
	}
	,validate: function() {
		if(!this.cbsets.empty()) {
			var set_ite = this.cbsets.parent;
			while(set_ite.prev != null) set_ite = set_ite.prev;
			while(set_ite != null) {
				var cb = set_ite.data;
				cb.validate();
				if(set_ite.next != null) {
					set_ite = set_ite.next;
					while(set_ite.prev != null) set_ite = set_ite.prev;
				} else {
					while(set_ite.parent != null && set_ite == set_ite.parent.next) set_ite = set_ite.parent;
					set_ite = set_ite.parent;
				}
			}
		}
	}
	,remove: function(set) {
		this.cbsets.remove(set);
		while(!set.cbpairs.empty()) {
			var pair = set.cbpairs.pop_unsafe();
			if(pair.a != pair.b) {
				if(set == pair.a) pair.b.cbpairs.remove(pair); else pair.a.cbpairs.remove(pair);
			}
			var o = pair;
			o.free();
			o.next = zpp_nape.callbacks.ZPP_CbSetPair.zpp_pool;
			zpp_nape.callbacks.ZPP_CbSetPair.zpp_pool = o;
		}
		set.manager = null;
	}
	,get: function(cbTypes) {
		if(cbTypes.empty()) return null;
		var fake;
		if(zpp_nape.callbacks.ZPP_CbSet.zpp_pool == null) fake = new zpp_nape.callbacks.ZPP_CbSet(); else {
			fake = zpp_nape.callbacks.ZPP_CbSet.zpp_pool;
			zpp_nape.callbacks.ZPP_CbSet.zpp_pool = fake.next;
			fake.next = null;
		}
		fake.alloc();
		var faketypes = fake.cbTypes;
		fake.cbTypes = cbTypes;
		var res = this.cbsets.find_weak(fake);
		var ret = res != null?res.data:(function($this) {
			var $r;
			var set = zpp_nape.callbacks.ZPP_CbSet.get(cbTypes);
			{
			}
			$this.cbsets.insert(set);
			set.manager = $this;
			$r = set;
			return $r;
		}(this));
		fake.cbTypes = faketypes;
		var o = fake;
		o.free();
		o.next = zpp_nape.callbacks.ZPP_CbSet.zpp_pool;
		zpp_nape.callbacks.ZPP_CbSet.zpp_pool = o;
		return ret;
	}
	,__class__: zpp_nape.space.ZPP_CbSetManager
}
zpp_nape.space.ZPP_Space = function(gravity,broadphase) {
	this.prelisteners = null;
	this.precb = null;
	this.continuous = false;
	this.toiEvents = null;
	this.pre_dt = 0.0;
	this.cbsets = null;
	this.callbackset_list = null;
	this.callbacks = null;
	this.wrap_listeners = null;
	this.listeners = null;
	this.islands = null;
	this.staticsleep = null;
	this.wrap_livecon = null;
	this.live_constraints = null;
	this.wrap_live = null;
	this.live = null;
	this.wrap_arbiters = null;
	this.s_arbiters = null;
	this.f_arbiters = null;
	this.c_arbiters_false = null;
	this.c_arbiters_true = null;
	this.sortcontacts = false;
	this.time = 0.0;
	this.midstep = false;
	this.stamp = 0;
	this.global_ang_drag = 0.0;
	this.global_lin_drag = 0.0;
	this.__static = null;
	this.bphase = null;
	this.kinematics = null;
	this.wrap_constraints = null;
	this.constraints = null;
	this.wrap_compounds = null;
	this.compounds = null;
	this.wrap_bodies = null;
	this.bodies = null;
	this.wrap_gravity = null;
	this.gravityy = 0.0;
	this.gravityx = 0.0;
	this.userData = null;
	this.outer = null;
	this.toiEvents = new zpp_nape.util.ZNPList_ZPP_ToiEvent();
	this.global_lin_drag = 0.015;
	this.global_ang_drag = 0.015;
	zpp_nape.callbacks.ZPP_Callback.internal = true;
	this.precb = new nape.callbacks.PreCallback();
	this.precb.zpp_inner = new zpp_nape.callbacks.ZPP_Callback();
	zpp_nape.callbacks.ZPP_Callback.internal = false;
	this.sortcontacts = true;
	this.pre_dt = 0.0;
	if(broadphase == null || broadphase == nape.space.Broadphase.get_DYNAMIC_AABB_TREE()) this.bphase = new zpp_nape.space.ZPP_DynAABBPhase(this); else if(broadphase == nape.space.Broadphase.get_SWEEP_AND_PRUNE()) this.bphase = new zpp_nape.space.ZPP_SweepPhase(this);
	this.time = 0.0;
	var me = this;
	if(gravity != null) {
		this.gravityx = gravity.x;
		this.gravityy = gravity.y;
	} else {
		this.gravityx = 0;
		this.gravityy = 0;
	}
	this.bodies = new zpp_nape.util.ZNPList_ZPP_Body();
	this.wrap_bodies = zpp_nape.util.ZPP_BodyList.get(this.bodies);
	this.wrap_bodies.zpp_inner.adder = $bind(this,this.bodies_adder);
	this.wrap_bodies.zpp_inner.subber = $bind(this,this.bodies_subber);
	this.wrap_bodies.zpp_inner._modifiable = $bind(this,this.bodies_modifiable);
	this.compounds = new zpp_nape.util.ZNPList_ZPP_Compound();
	this.wrap_compounds = zpp_nape.util.ZPP_CompoundList.get(this.compounds);
	this.wrap_compounds.zpp_inner.adder = $bind(this,this.compounds_adder);
	this.wrap_compounds.zpp_inner.subber = $bind(this,this.compounds_subber);
	this.wrap_compounds.zpp_inner._modifiable = $bind(this,this.compounds_modifiable);
	this.kinematics = new zpp_nape.util.ZNPList_ZPP_Body();
	this.c_arbiters_true = new zpp_nape.util.ZNPList_ZPP_ColArbiter();
	this.c_arbiters_false = new zpp_nape.util.ZNPList_ZPP_ColArbiter();
	this.f_arbiters = new zpp_nape.util.ZNPList_ZPP_FluidArbiter();
	this.s_arbiters = new zpp_nape.util.ZNPList_ZPP_SensorArbiter();
	this.islands = new zpp_nape.space.ZPP_Island();
	this.live = new zpp_nape.util.ZNPList_ZPP_Body();
	this.wrap_live = zpp_nape.util.ZPP_BodyList.get(this.live,true);
	this.staticsleep = new zpp_nape.util.ZNPList_ZPP_Body();
	this.constraints = new zpp_nape.util.ZNPList_ZPP_Constraint();
	this.wrap_constraints = zpp_nape.util.ZPP_ConstraintList.get(this.constraints);
	this.wrap_constraints.zpp_inner.adder = $bind(this,this.constraints_adder);
	this.wrap_constraints.zpp_inner.subber = $bind(this,this.constraints_subber);
	this.wrap_constraints.zpp_inner._modifiable = $bind(this,this.constraints_modifiable);
	this.live_constraints = new zpp_nape.util.ZNPList_ZPP_Constraint();
	this.wrap_livecon = zpp_nape.util.ZPP_ConstraintList.get(this.live_constraints,true);
	this.__static = zpp_nape.phys.ZPP_Body.__static();
	this.__static.zpp_inner.space = this;
	this.callbacks = new zpp_nape.callbacks.ZPP_Callback();
	this.midstep = false;
	this.listeners = new zpp_nape.util.ZNPList_ZPP_Listener();
	this.wrap_listeners = zpp_nape.util.ZPP_ListenerList.get(this.listeners);
	this.wrap_listeners.zpp_inner.adder = $bind(this,this.listeners_adder);
	this.wrap_listeners.zpp_inner.subber = $bind(this,this.listeners_subber);
	this.wrap_listeners.zpp_inner._modifiable = $bind(this,this.listeners_modifiable);
	this.callbackset_list = new zpp_nape.space.ZPP_CallbackSet();
	this.mrca1 = new zpp_nape.util.ZNPList_ZPP_Interactor();
	this.mrca2 = new zpp_nape.util.ZNPList_ZPP_Interactor();
	this.prelisteners = new zpp_nape.util.ZNPList_ZPP_InteractionListener();
	this.cbsets = new zpp_nape.space.ZPP_CbSetManager(this);
};
$hxClasses["zpp_nape.space.ZPP_Space"] = zpp_nape.space.ZPP_Space;
zpp_nape.space.ZPP_Space.__name__ = ["zpp_nape","space","ZPP_Space"];
zpp_nape.space.ZPP_Space.prototype = {
	inlined_MRCA_chains: function(s1,s2) {
		this.mrca1.inlined_clear();
		this.mrca2.inlined_clear();
		if(s1.cbSet != null) this.mrca1.inlined_add(s1);
		if(s1.body.cbSet != null) this.mrca1.inlined_add(s1.body);
		if(s2.cbSet != null) this.mrca2.inlined_add(s2);
		if(s2.body.cbSet != null) this.mrca2.inlined_add(s2.body);
		var c1 = s1.body.compound;
		var c2 = s2.body.compound;
		while(c1 != c2) {
			var d1 = c1 == null?0:c1.depth;
			var d2 = c2 == null?0:c2.depth;
			if(d1 < d2) {
				if(c2.cbSet != null) this.mrca2.inlined_add(c2);
				c2 = c2.compound;
			} else {
				if(c1.cbSet != null) this.mrca1.inlined_add(c1);
				c1 = c1.compound;
			}
		}
	}
	,MRCA_chains: function(s1,s2) {
		this.inlined_MRCA_chains(s1,s2);
	}
	,narrowPhase: function(s1,s2,stat,in_arb,continuous) {
		var _g = this;
		var ret = null;
		var b1 = s1.body;
		var b2 = s2.body;
		var itype = this.interactionType(s1,s2,b1,b2);
		if(itype != -1) {
			var sa, sb;
			if(s1.type > s2.type) {
				sa = s2;
				sb = s1;
			} else if(s1.type == s2.type) {
				if(s1.id < s2.id) {
					sa = s1;
					sb = s2;
				} else {
					sb = s1;
					sa = s2;
				}
			} else {
				sa = s1;
				sb = s2;
			}
			var reverse = sa == s2;
			if(itype == 0) {
				var xarb = in_arb == null?(function($this) {
					var $r;
					var ret1 = null;
					var b = b1.arbiters.length < b2.arbiters.length?b1:b2;
					{
						var cx_ite = b.arbiters.begin();
						while(cx_ite != null) {
							var arb = cx_ite.elem();
							if(arb.id == sa.id && arb.di == sb.id) {
								ret1 = arb;
								break;
							}
							cx_ite = cx_ite.next;
						}
					}
					$r = ret1;
					return $r;
				}(this)):in_arb;
				var first = xarb == null;
				var arb;
				var swapped = false;
				if(first) {
					if(zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool == null) arb = new zpp_nape.dynamics.ZPP_FluidArbiter(); else {
						arb = zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool;
						zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool = arb.next;
						arb.next = null;
					}
					arb.alloc();
				} else if(xarb.fluidarb == null) {
					xarb.lazyRetire(this,null);
					if(zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool == null) arb = new zpp_nape.dynamics.ZPP_FluidArbiter(); else {
						arb = zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool;
						zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool = arb.next;
						arb.next = null;
					}
					arb.alloc();
					arb.intchange = true;
					first = true;
					swapped = true;
				} else arb = xarb.fluidarb;
				ret = (function($this) {
					var $r;
					var inttype = zpp_nape.util.ZPP_Flags.id_InteractionType_FLUID;
					$r = first || arb.stamp != $this.stamp || continuous?(function($this) {
						var $r;
						arb.stamp = $this.stamp;
						$r = zpp_nape.geom.ZPP_Collide.flowCollide(sa,sb,arb)?(function($this) {
							var $r;
							if(first) {
								arb.assign(s1,s2,sa.id,sb.id);
								$this.f_arbiters.inlined_add(arb);
								arb.fresh = !swapped;
							} else arb.fresh = arb.up_stamp < $this.stamp - 1 || arb.endGenerated == $this.stamp && continuous;
							arb.up_stamp = arb.stamp;
							if(arb.fresh || (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) {
								arb.immState = zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT;
								var anyimpure = false;
								$this.inlined_MRCA_chains(s1,s2);
								var cx_ite = $this.mrca1.begin();
								while(cx_ite != null) {
									var i1 = cx_ite.elem();
									var cx_ite1 = $this.mrca2.begin();
									while(cx_ite1 != null) {
										var i2 = cx_ite1.elem();
										var cb1 = i1.cbSet;
										var cb2 = i2.cbSet;
										if(zpp_nape.callbacks.ZPP_CbSet.empty_intersection(cb1,cb2)) {
											cx_ite1 = cx_ite1.next;
											continue;
										}
										var callbackset = null;
										var ncallbackset = null;
										$this.prelisteners.inlined_clear();
										var lite = [null];
										zpp_nape.callbacks.ZPP_CbSet.find_all(cb1,cb2,zpp_nape.util.ZPP_Flags.id_CbEvent_PRE,(function(lite) {
											return function(listener) {
												if((listener.itype & inttype) != 0) {
													lite[0] = _g.prelisteners.inlined_insert(lite[0],listener);
													anyimpure = anyimpure || !listener.pure;
												}
											};
										})(lite));
										if($this.prelisteners.empty()) {
											cx_ite1 = cx_ite1.next;
											continue;
										}
										callbackset = zpp_nape.phys.ZPP_Interactor.get(i1,i2);
										if(callbackset == null) {
											ncallbackset = zpp_nape.space.ZPP_CallbackSet.get(i1,i2);
											$this.add_callbackset(ncallbackset);
										}
										if(callbackset == null || (callbackset.FLUIDstamp != $this.stamp || continuous) && (callbackset.FLUIDstate & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) {
											if(ncallbackset != null) callbackset = ncallbackset;
											if(callbackset != null) {
												var cx_ite2 = $this.prelisteners.begin();
												while(cx_ite2 != null) {
													var listener = cx_ite2.elem();
													if(listener.itype == zpp_nape.util.ZPP_Flags.id_InteractionType_ANY) {
														callbackset.COLLISIONstamp = $this.stamp;
														callbackset.SENSORstamp = $this.stamp;
														callbackset.FLUIDstamp = $this.stamp;
													} else callbackset.FLUIDstamp = $this.stamp;
													cx_ite2 = cx_ite2.next;
												}
											}
											arb.makemutable();
											var pact = arb.active;
											arb.active = true;
											var emptycontacts = false;
											$this.precb.zpp_inner.pre_arbiter = arb;
											$this.precb.zpp_inner.set = callbackset;
											var cx_ite2 = $this.prelisteners.begin();
											while(cx_ite2 != null) {
												var listener = cx_ite2.elem();
												$this.precb.zpp_inner.listener = listener;
												zpp_nape.phys.ZPP_Interactor.int_callback(callbackset,listener,$this.precb.zpp_inner);
												$this.precb.zpp_inner.pre_swapped = i1 != $this.precb.zpp_inner.int1;
												var ret1 = listener.handlerp($this.precb);
												if(ret1 != null) arb.immState = ret1 == nape.callbacks.PreFlag.get_ACCEPT()?zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT | zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS:ret1 == nape.callbacks.PreFlag.get_ACCEPT_ONCE()?zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT:ret1 == nape.callbacks.PreFlag.get_IGNORE()?zpp_nape.util.ZPP_Flags.id_ImmState_IGNORE | zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS:zpp_nape.util.ZPP_Flags.id_ImmState_IGNORE;
												cx_ite2 = cx_ite2.next;
											}
											arb.makeimmutable();
											arb.active = pact;
											if(callbackset != null) {
												var cx_ite2 = $this.prelisteners.begin();
												while(cx_ite2 != null) {
													var listener = cx_ite2.elem();
													if(listener.itype == zpp_nape.util.ZPP_Flags.id_InteractionType_ANY) {
														callbackset.COLLISIONstate = arb.immState;
														callbackset.SENSORstate = arb.immState;
														callbackset.FLUIDstate = arb.immState;
													} else callbackset.FLUIDstate = arb.immState;
													cx_ite2 = cx_ite2.next;
												}
											}
										} else if(callbackset == null) {
											if((arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) arb.immState = zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT;
										} else arb.immState = callbackset.FLUIDstate;
										cx_ite1 = cx_ite1.next;
									}
									cx_ite = cx_ite.next;
								}
								if(anyimpure && (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) {
									if(true) {
										if(arb.b1.isDynamic()) {
											var o = arb.b1;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
										if(arb.b1.isDynamic()) {
											var o = arb.b2;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
									} else {
										if(!arb.b1.isStatic()) {
											var o = arb.b1;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
										if(!arb.b2.isStatic()) {
											var o = arb.b2;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
									}
								}
							}
							if(true && (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT) != 0) {
								if(arb.b1.isDynamic() && arb.b1.component.sleeping) {
									var o = arb.b1;
									if(!o.world) {
										o.component.waket = $this.stamp + ($this.midstep?0:1);
										if(o.isKinematic()) o.kinematicDelaySleep = true;
										if(o.component.sleeping) $this.really_wake(o,false);
									}
								}
								if(arb.b2.isDynamic() && arb.b2.component.sleeping) {
									var o = arb.b2;
									if(!o.world) {
										o.component.waket = $this.stamp + ($this.midstep?0:1);
										if(o.isKinematic()) o.kinematicDelaySleep = true;
										if(o.component.sleeping) $this.really_wake(o,false);
									}
								}
							}
							if(arb.sleeping) {
								arb.sleeping = false;
								$this.f_arbiters.inlined_add(arb);
							}
							$r = arb;
							return $r;
						}($this)):first?(function($this) {
							var $r;
							{
								var o = arb;
								o.free();
								o.next = zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool;
								zpp_nape.dynamics.ZPP_FluidArbiter.zpp_pool = o;
							}
							$r = null;
							return $r;
						}($this)):arb;
						return $r;
					}($this)):arb;
					return $r;
				}(this));
			} else if(itype == 1) {
				var carbs = stat?this.c_arbiters_true:this.c_arbiters_false;
				var xarb = in_arb == null?(function($this) {
					var $r;
					var ret1 = null;
					var b = b1.arbiters.length < b2.arbiters.length?b1:b2;
					{
						var cx_ite = b.arbiters.begin();
						while(cx_ite != null) {
							var arb = cx_ite.elem();
							if(arb.id == sa.id && arb.di == sb.id) {
								ret1 = arb;
								break;
							}
							cx_ite = cx_ite.next;
						}
					}
					$r = ret1;
					return $r;
				}(this)):in_arb;
				var first = xarb == null;
				var arb;
				var swapped = false;
				if(first) {
					if(zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool == null) arb = new zpp_nape.dynamics.ZPP_ColArbiter(); else {
						arb = zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool;
						zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool = arb.next;
						arb.next = null;
					}
					arb.alloc();
					arb.stat = stat;
				} else if(xarb.colarb == null) {
					xarb.lazyRetire(this,null);
					if(zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool == null) arb = new zpp_nape.dynamics.ZPP_ColArbiter(); else {
						arb = zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool;
						zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool = arb.next;
						arb.next = null;
					}
					arb.alloc();
					arb.intchange = true;
					arb.stat = stat;
					first = true;
					swapped = true;
				} else {
					arb = xarb.colarb;
					reverse = sa != arb.s1;
					if(arb.stat != stat) {
						arb.stat = stat;
						if(!arb.sleeping) {
							(stat?this.c_arbiters_false:this.c_arbiters_true).remove(arb);
							carbs.add(arb);
						}
					}
				}
				ret = (function($this) {
					var $r;
					var inttype = zpp_nape.util.ZPP_Flags.id_InteractionType_COLLISION;
					$r = first || arb.stamp != $this.stamp || continuous?(function($this) {
						var $r;
						arb.stamp = $this.stamp;
						$r = zpp_nape.geom.ZPP_Collide.contactCollide(sa,sb,arb,reverse)?(function($this) {
							var $r;
							if(first) {
								arb.assign(s1,s2,sa.id,sb.id);
								carbs.inlined_add(arb);
								arb.fresh = !swapped;
							} else arb.fresh = arb.up_stamp < $this.stamp - 1 || arb.endGenerated == $this.stamp && continuous;
							arb.up_stamp = arb.stamp;
							if(arb.fresh || (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) {
								arb.immState = zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT;
								var anyimpure = false;
								$this.inlined_MRCA_chains(s1,s2);
								var cx_ite = $this.mrca1.begin();
								while(cx_ite != null) {
									var i1 = cx_ite.elem();
									var cx_ite1 = $this.mrca2.begin();
									while(cx_ite1 != null) {
										var i2 = cx_ite1.elem();
										var cb1 = i1.cbSet;
										var cb2 = i2.cbSet;
										if(zpp_nape.callbacks.ZPP_CbSet.empty_intersection(cb1,cb2)) {
											cx_ite1 = cx_ite1.next;
											continue;
										}
										var callbackset = null;
										var ncallbackset = null;
										$this.prelisteners.inlined_clear();
										var lite = [null];
										zpp_nape.callbacks.ZPP_CbSet.find_all(cb1,cb2,zpp_nape.util.ZPP_Flags.id_CbEvent_PRE,(function(lite) {
											return function(listener) {
												if((listener.itype & inttype) != 0) {
													lite[0] = _g.prelisteners.inlined_insert(lite[0],listener);
													anyimpure = anyimpure || !listener.pure;
												}
											};
										})(lite));
										if($this.prelisteners.empty()) {
											cx_ite1 = cx_ite1.next;
											continue;
										}
										callbackset = zpp_nape.phys.ZPP_Interactor.get(i1,i2);
										if(callbackset == null) {
											ncallbackset = zpp_nape.space.ZPP_CallbackSet.get(i1,i2);
											$this.add_callbackset(ncallbackset);
										}
										if(callbackset == null || (callbackset.COLLISIONstamp != $this.stamp || continuous) && (callbackset.COLLISIONstate & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) {
											if(ncallbackset != null) callbackset = ncallbackset;
											if(callbackset != null) {
												var cx_ite2 = $this.prelisteners.begin();
												while(cx_ite2 != null) {
													var listener = cx_ite2.elem();
													if(listener.itype == zpp_nape.util.ZPP_Flags.id_InteractionType_ANY) {
														callbackset.COLLISIONstamp = $this.stamp;
														callbackset.SENSORstamp = $this.stamp;
														callbackset.FLUIDstamp = $this.stamp;
													} else callbackset.COLLISIONstamp = $this.stamp;
													cx_ite2 = cx_ite2.next;
												}
											}
											arb.makemutable();
											var pact = arb.active;
											arb.active = true;
											var emptycontacts = false;
											arb.cleanupContacts();
											$this.precb.zpp_inner.pre_arbiter = arb;
											$this.precb.zpp_inner.set = callbackset;
											var cx_ite2 = $this.prelisteners.begin();
											while(cx_ite2 != null) {
												var listener = cx_ite2.elem();
												$this.precb.zpp_inner.listener = listener;
												zpp_nape.phys.ZPP_Interactor.int_callback(callbackset,listener,$this.precb.zpp_inner);
												$this.precb.zpp_inner.pre_swapped = i1 != $this.precb.zpp_inner.int1;
												var ret1 = listener.handlerp($this.precb);
												if(ret1 != null) arb.immState = ret1 == nape.callbacks.PreFlag.get_ACCEPT()?zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT | zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS:ret1 == nape.callbacks.PreFlag.get_ACCEPT_ONCE()?zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT:ret1 == nape.callbacks.PreFlag.get_IGNORE()?zpp_nape.util.ZPP_Flags.id_ImmState_IGNORE | zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS:zpp_nape.util.ZPP_Flags.id_ImmState_IGNORE;
												cx_ite2 = cx_ite2.next;
											}
											arb.makeimmutable();
											arb.active = pact;
											if(callbackset != null) {
												var cx_ite2 = $this.prelisteners.begin();
												while(cx_ite2 != null) {
													var listener = cx_ite2.elem();
													if(listener.itype == zpp_nape.util.ZPP_Flags.id_InteractionType_ANY) {
														callbackset.COLLISIONstate = arb.immState;
														callbackset.SENSORstate = arb.immState;
														callbackset.FLUIDstate = arb.immState;
													} else callbackset.COLLISIONstate = arb.immState;
													cx_ite2 = cx_ite2.next;
												}
											}
										} else if(callbackset == null) {
											if((arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) arb.immState = zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT;
										} else arb.immState = callbackset.COLLISIONstate;
										cx_ite1 = cx_ite1.next;
									}
									cx_ite = cx_ite.next;
								}
								if(anyimpure && (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) {
									if(true) {
										if(arb.b1.isDynamic()) {
											var o = arb.b1;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
										if(arb.b1.isDynamic()) {
											var o = arb.b2;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
									} else {
										if(!arb.b1.isStatic()) {
											var o = arb.b1;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
										if(!arb.b2.isStatic()) {
											var o = arb.b2;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
									}
								}
							}
							if(true && (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT) != 0) {
								if(arb.b1.isDynamic() && arb.b1.component.sleeping) {
									var o = arb.b1;
									if(!o.world) {
										o.component.waket = $this.stamp + ($this.midstep?0:1);
										if(o.isKinematic()) o.kinematicDelaySleep = true;
										if(o.component.sleeping) $this.really_wake(o,false);
									}
								}
								if(arb.b2.isDynamic() && arb.b2.component.sleeping) {
									var o = arb.b2;
									if(!o.world) {
										o.component.waket = $this.stamp + ($this.midstep?0:1);
										if(o.isKinematic()) o.kinematicDelaySleep = true;
										if(o.component.sleeping) $this.really_wake(o,false);
									}
								}
							}
							if(arb.sleeping) {
								arb.sleeping = false;
								carbs.inlined_add(arb);
							}
							$r = arb;
							return $r;
						}($this)):first?(function($this) {
							var $r;
							{
								var o = arb;
								o.free();
								o.next = zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool;
								zpp_nape.dynamics.ZPP_ColArbiter.zpp_pool = o;
							}
							$r = null;
							return $r;
						}($this)):arb;
						return $r;
					}($this)):arb;
					return $r;
				}(this));
			} else {
				var xarb = in_arb == null?(function($this) {
					var $r;
					var ret1 = null;
					var b = b1.arbiters.length < b2.arbiters.length?b1:b2;
					{
						var cx_ite = b.arbiters.begin();
						while(cx_ite != null) {
							var arb = cx_ite.elem();
							if(arb.id == sa.id && arb.di == sb.id) {
								ret1 = arb;
								break;
							}
							cx_ite = cx_ite.next;
						}
					}
					$r = ret1;
					return $r;
				}(this)):in_arb;
				var first = xarb == null;
				var arb;
				var swapped = false;
				if(first) {
					if(zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool == null) arb = new zpp_nape.dynamics.ZPP_SensorArbiter(); else {
						arb = zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool;
						zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool = arb.next;
						arb.next = null;
					}
					arb.alloc();
				} else if(xarb.sensorarb == null) {
					xarb.lazyRetire(this,null);
					if(zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool == null) arb = new zpp_nape.dynamics.ZPP_SensorArbiter(); else {
						arb = zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool;
						zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool = arb.next;
						arb.next = null;
					}
					arb.alloc();
					arb.intchange = true;
					first = true;
					swapped = true;
				} else arb = xarb.sensorarb;
				ret = (function($this) {
					var $r;
					var inttype = zpp_nape.util.ZPP_Flags.id_InteractionType_SENSOR;
					$r = first || arb.stamp != $this.stamp || continuous?(function($this) {
						var $r;
						arb.stamp = $this.stamp;
						$r = zpp_nape.geom.ZPP_Collide.testCollide(sa,sb)?(function($this) {
							var $r;
							if(first) {
								arb.assign(s1,s2,sa.id,sb.id);
								$this.s_arbiters.inlined_add(arb);
								arb.fresh = !swapped;
							} else arb.fresh = arb.up_stamp < $this.stamp - 1 || arb.endGenerated == $this.stamp && continuous;
							arb.up_stamp = arb.stamp;
							if(arb.fresh || (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) {
								arb.immState = zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT;
								var anyimpure = false;
								$this.inlined_MRCA_chains(s1,s2);
								var cx_ite = $this.mrca1.begin();
								while(cx_ite != null) {
									var i1 = cx_ite.elem();
									var cx_ite1 = $this.mrca2.begin();
									while(cx_ite1 != null) {
										var i2 = cx_ite1.elem();
										var cb1 = i1.cbSet;
										var cb2 = i2.cbSet;
										if(zpp_nape.callbacks.ZPP_CbSet.empty_intersection(cb1,cb2)) {
											cx_ite1 = cx_ite1.next;
											continue;
										}
										var callbackset = null;
										var ncallbackset = null;
										$this.prelisteners.inlined_clear();
										var lite = [null];
										zpp_nape.callbacks.ZPP_CbSet.find_all(cb1,cb2,zpp_nape.util.ZPP_Flags.id_CbEvent_PRE,(function(lite) {
											return function(listener) {
												if((listener.itype & inttype) != 0) {
													lite[0] = _g.prelisteners.inlined_insert(lite[0],listener);
													anyimpure = anyimpure || !listener.pure;
												}
											};
										})(lite));
										if($this.prelisteners.empty()) {
											cx_ite1 = cx_ite1.next;
											continue;
										}
										callbackset = zpp_nape.phys.ZPP_Interactor.get(i1,i2);
										if(callbackset == null) {
											ncallbackset = zpp_nape.space.ZPP_CallbackSet.get(i1,i2);
											$this.add_callbackset(ncallbackset);
										}
										if(callbackset == null || (callbackset.SENSORstamp != $this.stamp || continuous) && (callbackset.SENSORstate & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) {
											if(ncallbackset != null) callbackset = ncallbackset;
											if(callbackset != null) {
												var cx_ite2 = $this.prelisteners.begin();
												while(cx_ite2 != null) {
													var listener = cx_ite2.elem();
													if(listener.itype == zpp_nape.util.ZPP_Flags.id_InteractionType_ANY) {
														callbackset.COLLISIONstamp = $this.stamp;
														callbackset.SENSORstamp = $this.stamp;
														callbackset.FLUIDstamp = $this.stamp;
													} else callbackset.SENSORstamp = $this.stamp;
													cx_ite2 = cx_ite2.next;
												}
											}
											arb.makemutable();
											var pact = arb.active;
											arb.active = true;
											var emptycontacts = false;
											$this.precb.zpp_inner.pre_arbiter = arb;
											$this.precb.zpp_inner.set = callbackset;
											var cx_ite2 = $this.prelisteners.begin();
											while(cx_ite2 != null) {
												var listener = cx_ite2.elem();
												$this.precb.zpp_inner.listener = listener;
												zpp_nape.phys.ZPP_Interactor.int_callback(callbackset,listener,$this.precb.zpp_inner);
												$this.precb.zpp_inner.pre_swapped = i1 != $this.precb.zpp_inner.int1;
												var ret1 = listener.handlerp($this.precb);
												if(ret1 != null) arb.immState = ret1 == nape.callbacks.PreFlag.get_ACCEPT()?zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT | zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS:ret1 == nape.callbacks.PreFlag.get_ACCEPT_ONCE()?zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT:ret1 == nape.callbacks.PreFlag.get_IGNORE()?zpp_nape.util.ZPP_Flags.id_ImmState_IGNORE | zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS:zpp_nape.util.ZPP_Flags.id_ImmState_IGNORE;
												cx_ite2 = cx_ite2.next;
											}
											arb.makeimmutable();
											arb.active = pact;
											if(callbackset != null) {
												var cx_ite2 = $this.prelisteners.begin();
												while(cx_ite2 != null) {
													var listener = cx_ite2.elem();
													if(listener.itype == zpp_nape.util.ZPP_Flags.id_InteractionType_ANY) {
														callbackset.COLLISIONstate = arb.immState;
														callbackset.SENSORstate = arb.immState;
														callbackset.FLUIDstate = arb.immState;
													} else callbackset.SENSORstate = arb.immState;
													cx_ite2 = cx_ite2.next;
												}
											}
										} else if(callbackset == null) {
											if((arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) arb.immState = zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT;
										} else arb.immState = callbackset.SENSORstate;
										cx_ite1 = cx_ite1.next;
									}
									cx_ite = cx_ite.next;
								}
								if(anyimpure && (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS) == 0) {
									if(false) {
										if(arb.b1.isDynamic()) {
											var o = arb.b1;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
										if(arb.b1.isDynamic()) {
											var o = arb.b2;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
									} else {
										if(!arb.b1.isStatic()) {
											var o = arb.b1;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
										if(!arb.b2.isStatic()) {
											var o = arb.b2;
											if(!o.world) {
												o.component.waket = $this.stamp + ($this.midstep?0:1);
												if(o.isKinematic()) o.kinematicDelaySleep = true;
												if(o.component.sleeping) $this.really_wake(o,false);
											}
										}
									}
								}
							}
							if(false && (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT) != 0) {
								if(arb.b1.isDynamic() && arb.b1.component.sleeping) {
									var o = arb.b1;
									if(!o.world) {
										o.component.waket = $this.stamp + ($this.midstep?0:1);
										if(o.isKinematic()) o.kinematicDelaySleep = true;
										if(o.component.sleeping) $this.really_wake(o,false);
									}
								}
								if(arb.b2.isDynamic() && arb.b2.component.sleeping) {
									var o = arb.b2;
									if(!o.world) {
										o.component.waket = $this.stamp + ($this.midstep?0:1);
										if(o.isKinematic()) o.kinematicDelaySleep = true;
										if(o.component.sleeping) $this.really_wake(o,false);
									}
								}
							}
							if(arb.sleeping) {
								arb.sleeping = false;
								$this.s_arbiters.inlined_add(arb);
							}
							$r = arb;
							return $r;
						}($this)):first?(function($this) {
							var $r;
							{
								var o = arb;
								o.free();
								o.next = zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool;
								zpp_nape.dynamics.ZPP_SensorArbiter.zpp_pool = o;
							}
							$r = null;
							return $r;
						}($this)):arb;
						return $r;
					}($this)):arb;
					return $r;
				}(this));
			}
		}
		return ret;
	}
	,interactionType: function(s1,s2,b1,b2) {
		var con_ignore;
		con_ignore = false;
		var cx_ite = b1.constraints.begin();
		while(cx_ite != null) {
			var con = cx_ite.elem();
			if(con.ignore && con.pair_exists(b1.id,b2.id)) {
				con_ignore = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(!con_ignore && !this.group_ignore(s1,s2)) {
			if((s1.sensorEnabled || s2.sensorEnabled) && s1.filter.shouldSense(s2.filter)) return 2; else if((s1.fluidEnabled || s2.fluidEnabled) && s1.filter.shouldFlow(s2.filter) && !(b1.imass == 0 && b2.imass == 0 && b1.iinertia == 0 && b2.iinertia == 0)) return 0; else if(s1.filter.shouldCollide(s2.filter) && !(b1.imass == 0 && b2.imass == 0 && b1.iinertia == 0 && b2.iinertia == 0)) return 1; else return -1;
		} else return -1;
	}
	,group_ignore: function(s1,s2) {
		var g1 = s1.lookup_group();
		if(g1 == null) return false; else {
			var g2 = s2.lookup_group();
			if(g2 == null) return false; else {
				var ret = false;
				while(g1 != null && g2 != null) {
					if(g1 == g2) {
						ret = g1.ignore;
						break;
					}
					if(g1.depth < g2.depth) g2 = g2.group; else g1 = g1.group;
				}
				return ret;
			}
		}
	}
	,iteratePos: function(times) {
		var _g = 0;
		while(_g < times) {
			var i = _g++;
			var pre = null;
			var cx_ite = this.live_constraints.begin();
			while(cx_ite != null) {
				var con = cx_ite.elem();
				if(!con.__velocity && con.stiff) {
					if(con.applyImpulsePos()) {
						cx_ite = this.live_constraints.erase(pre);
						con.broken();
						this.constraintCbBreak(con);
						if(con.removeOnBreak) {
							con.component.sleeping = true;
							this.midstep = false;
							if(con.compound != null) con.compound.wrap_constraints.remove(con.outer); else this.wrap_constraints.remove(con.outer);
							this.midstep = true;
						} else con.active = false;
						con.clearcache();
						continue;
					}
				}
				pre = cx_ite;
				cx_ite = cx_ite.next;
			}
			var arbi = this.c_arbiters_false.begin();
			var fst = true;
			if(arbi == null) {
				arbi = this.c_arbiters_true.begin();
				fst = false;
			}
			while(arbi != null) {
				var arb = arbi.elem();
				if(arb.acting()) arb.applyImpulsePos();
				arbi = arbi.next;
				if(fst && arbi == null) {
					arbi = this.c_arbiters_true.begin();
					fst = false;
				}
			}
		}
	}
	,iterateVel: function(times) {
		var _g = 0;
		while(_g < times) {
			var i = _g++;
			var cx_ite = this.f_arbiters.begin();
			while(cx_ite != null) {
				var arb = cx_ite.elem();
				if(arb.acting()) arb.applyImpulseVel();
				cx_ite = cx_ite.next;
			}
			var pre = null;
			var cx_ite = this.live_constraints.begin();
			while(cx_ite != null) {
				var con = cx_ite.elem();
				if(con.applyImpulseVel()) {
					cx_ite = this.live_constraints.erase(pre);
					con.broken();
					this.constraintCbBreak(con);
					if(con.removeOnBreak) {
						con.component.sleeping = true;
						this.midstep = false;
						if(con.compound != null) con.compound.wrap_constraints.remove(con.outer); else this.wrap_constraints.remove(con.outer);
						this.midstep = true;
					} else con.active = false;
					con.clearcache();
					continue;
				}
				pre = cx_ite;
				cx_ite = cx_ite.next;
			}
			var arbi = this.c_arbiters_false.begin();
			var fst = true;
			if(arbi == null) {
				arbi = this.c_arbiters_true.begin();
				fst = false;
			}
			while(arbi != null) {
				var arb = arbi.elem();
				if(arb.acting()) arb.applyImpulseVel();
				arbi = arbi.next;
				if(fst && arbi == null) {
					arbi = this.c_arbiters_true.begin();
					fst = false;
				}
			}
		}
	}
	,warmStart: function() {
		var cx_ite = this.f_arbiters.begin();
		while(cx_ite != null) {
			var arb = cx_ite.elem();
			if(arb.acting()) arb.warmStart();
			cx_ite = cx_ite.next;
		}
		var arbi = this.c_arbiters_false.begin();
		var fst = true;
		if(arbi == null) {
			arbi = this.c_arbiters_true.begin();
			fst = false;
		}
		while(arbi != null) {
			var arb = arbi.elem();
			if(arb.acting()) arb.warmStart();
			arbi = arbi.next;
			if(fst && arbi == null) {
				arbi = this.c_arbiters_true.begin();
				fst = false;
			}
		}
		var cx_ite = this.live_constraints.begin();
		while(cx_ite != null) {
			var con = cx_ite.elem();
			con.warmStart();
			cx_ite = cx_ite.next;
		}
	}
	,prestep: function(dt) {
		var pre = null;
		var cx_ite = this.live_constraints.begin();
		while(cx_ite != null) {
			var con = cx_ite.elem();
			if(con.preStep(dt)) {
				cx_ite = this.live_constraints.erase(pre);
				con.broken();
				this.constraintCbBreak(con);
				if(con.removeOnBreak) {
					con.component.sleeping = true;
					this.midstep = false;
					if(con.compound != null) con.compound.wrap_constraints.remove(con.outer); else this.wrap_constraints.remove(con.outer);
					this.midstep = true;
				} else con.active = false;
				con.clearcache();
				continue;
			}
			pre = cx_ite;
			cx_ite = cx_ite.next;
		}
		var pre1 = null;
		var arbs = this.c_arbiters_true;
		var arbite = arbs.begin();
		var fst = this.c_arbiters_false != null;
		if(fst && arbite == null) {
			fst = false;
			arbite = this.c_arbiters_false.begin();
			arbs = this.c_arbiters_false;
			pre1 = null;
		}
		while(arbite != null) {
			var arb = arbite.elem();
			if(this.presteparb(arb,dt)) {
				arbite = arbs.inlined_erase(pre1);
				if(fst && arbite == null) {
					fst = false;
					arbite = this.c_arbiters_false.begin();
					arbs = this.c_arbiters_false;
					pre1 = null;
				}
				continue;
			}
			pre1 = arbite;
			arbite = arbite.next;
			if(fst && arbite == null) {
				fst = false;
				arbite = this.c_arbiters_false.begin();
				arbs = this.c_arbiters_false;
				pre1 = null;
			}
		}
		var pre1 = null;
		var arbs = this.f_arbiters;
		var arbite = arbs.begin();
		var fst = null != null;
		if(fst && arbite == null) {
			fst = false;
			arbite = null.begin();
			arbs = null;
			pre1 = null;
		}
		while(arbite != null) {
			var arb = arbite.elem();
			if(this.presteparb(arb,dt)) {
				arbite = arbs.inlined_erase(pre1);
				if(fst && arbite == null) {
					fst = false;
					arbite = null.begin();
					arbs = null;
					pre1 = null;
				}
				continue;
			}
			pre1 = arbite;
			arbite = arbite.next;
			if(fst && arbite == null) {
				fst = false;
				arbite = null.begin();
				arbs = null;
				pre1 = null;
			}
		}
		var pre1 = null;
		var arbs = this.s_arbiters;
		var arbite = arbs.begin();
		var fst = null != null;
		if(fst && arbite == null) {
			fst = false;
			arbite = null.begin();
			arbs = null;
			pre1 = null;
		}
		while(arbite != null) {
			var arb = arbite.elem();
			if(this.presteparb(arb,dt)) {
				arbite = arbs.inlined_erase(pre1);
				if(fst && arbite == null) {
					fst = false;
					arbite = null.begin();
					arbs = null;
					pre1 = null;
				}
				continue;
			}
			pre1 = arbite;
			arbite = arbite.next;
			if(fst && arbite == null) {
				fst = false;
				arbite = null.begin();
				arbs = null;
				pre1 = null;
			}
		}
	}
	,presteparb: function(arb,dt,cont) {
		if(cont == null) cont = false;
		var _g = this;
		if(!arb.cleared && (arb.b1.component.sleeping && arb.b2.component.sleeping)) {
			arb.sleep_stamp = this.stamp;
			arb.sleeping = true;
			return true;
		}
		if(!arb.cleared || arb.present != 0 || arb.intchange) {
			var endcb = !cont && arb.up_stamp == this.stamp - 1 && !arb.cleared && !arb.intchange;
			var begcb = arb.fresh && !arb.cleared && !arb.intchange;
			if(endcb) arb.endGenerated = this.stamp;
			if(begcb || endcb || arb.cleared || arb.intchange) {
				this.inlined_MRCA_chains(arb.ws1,arb.ws2);
				var cx_ite = this.mrca1.begin();
				while(cx_ite != null) {
					var i1 = cx_ite.elem();
					var cx_ite1 = this.mrca2.begin();
					while(cx_ite1 != null) {
						var i2 = cx_ite1.elem();
						var cb1 = i1.cbSet;
						var cb2 = i2.cbSet;
						if(zpp_nape.callbacks.ZPP_CbSet.empty_intersection(cb1,cb2)) {
							cx_ite1 = cx_ite1.next;
							continue;
						}
						var callbackset = [zpp_nape.phys.ZPP_Interactor.get(i1,i2)];
						if(begcb || arb.intchange) {
							if(callbackset[0] == null) {
								callbackset[0] = zpp_nape.space.ZPP_CallbackSet.get(i1,i2);
								this.add_callbackset(callbackset[0]);
							}
							zpp_nape.callbacks.ZPP_CbSet.find_all(cb1,cb2,zpp_nape.util.ZPP_Flags.id_CbEvent_BEGIN,(function(callbackset) {
								return function(listener) {
									if((listener.itype & arb.type) != 0 && callbackset[0].empty_arb(listener.itype)) {
										var cb = _g.push_callback(listener);
										cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_BEGIN;
										zpp_nape.phys.ZPP_Interactor.int_callback(callbackset[0],listener,cb);
										cb.set = callbackset[0];
									}
								};
							})(callbackset));
							if(callbackset[0].add_arb(arb)) arb.present++;
						} else {
							arb.present--;
							callbackset[0].remove_arb(arb);
							zpp_nape.callbacks.ZPP_CbSet.find_all(cb1,cb2,zpp_nape.util.ZPP_Flags.id_CbEvent_END,(function(callbackset) {
								return function(listener) {
									if((listener.itype & arb.type) != 0 && callbackset[0].empty_arb(listener.itype)) {
										var cb = _g.push_callback(listener);
										cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_END;
										zpp_nape.phys.ZPP_Interactor.int_callback(callbackset[0],listener,cb);
										cb.set = callbackset[0];
									}
								};
							})(callbackset));
							if(callbackset[0].really_empty()) this.remove_callbackset(callbackset[0]);
						}
						cx_ite1 = cx_ite1.next;
					}
					cx_ite = cx_ite.next;
				}
			}
			arb.fresh = false;
			arb.intchange = false;
		}
		if(arb.cleared || arb.up_stamp + (arb.type == zpp_nape.dynamics.ZPP_Arbiter.COL?nape.Config.arbiterExpirationDelay:0) < this.stamp) {
			if(arb.type == zpp_nape.dynamics.ZPP_Arbiter.SENSOR) arb.sensorarb.retire(); else if(arb.type == zpp_nape.dynamics.ZPP_Arbiter.FLUID) arb.fluidarb.retire(); else arb.colarb.retire();
			return true;
		}
		var pact = arb.active;
		arb.active = arb.presentable = arb.up_stamp == this.stamp;
		if((arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT) != 0) {
			if(arb.active && arb.type != zpp_nape.dynamics.ZPP_Arbiter.SENSOR) {
				if(arb.colarb != null) {
					if(arb.colarb.preStep(dt)) arb.active = false;
				} else arb.fluidarb.preStep(this,dt);
			}
		} else if(arb.colarb != null) {
			if(arb.colarb.cleanupContacts()) arb.active = false;
		}
		if(pact != arb.active) {
			arb.b1.arbiters.modified = true;
			arb.b2.arbiters.modified = true;
			this.c_arbiters_true.modified = this.c_arbiters_false.modified = true;
			this.s_arbiters.modified = this.f_arbiters.modified = true;
		}
		return false;
	}
	,updatePos: function(dt) {
		var MAX_VEL = 2 * Math.PI / dt;
		var cx_ite = this.live.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			cur.pre_posx = cur.posx;
			cur.pre_posy = cur.posy;
			cur.pre_rot = cur.rot;
			cur.sweepTime = 0;
			cur.sweep_angvel = cur.angvel % MAX_VEL;
			cur.sweepIntegrate(dt);
			if(!cur.disableCCD) {
				var linThreshold = nape.Config.staticCCDLinearThreshold * cur.sweepRadius;
				var angThreshold = nape.Config.staticCCDAngularThreshold;
				if((cur.velx * cur.velx + cur.vely * cur.vely) * dt * dt > linThreshold * linThreshold || cur.angvel * cur.angvel * dt * dt > angThreshold * angThreshold || cur.isKinematic()) {
					var col = [65280,65535,255,16711935,65280,65535,255,16711935];
					var angvel = cur.sweep_angvel;
					if(angvel < 0) angvel = -angvel;
					var iangvel = 1 / angvel;
					var cx_ite1 = cur.shapes.begin();
					while(cx_ite1 != null) {
						var s = cx_ite1.elem();
						var aabb = s.aabb;
						var minx = aabb.minx;
						var miny = aabb.miny;
						var maxx = aabb.maxx;
						var maxy = aabb.maxy;
						var count = Std["int"](angvel * dt * s.sweepCoef * (1 / 120));
						if(count > 8) count = 8;
						var anginc = angvel * dt / count;
						cur.sweepIntegrate(dt);
						s.force_validate_aabb();
						if(minx < aabb.minx) aabb.minx = minx; else minx = aabb.minx;
						if(miny < aabb.miny) aabb.miny = miny; else miny = aabb.miny;
						if(maxx > aabb.maxx) aabb.maxx = maxx; else maxx = aabb.maxx;
						if(maxy > aabb.maxy) aabb.maxy = maxy; else maxy = aabb.maxy;
						var _g = 1;
						while(_g < count) {
							var i = _g++;
							cur.sweepIntegrate(anginc * i * iangvel);
							s.force_validate_aabb();
							if(minx < aabb.minx) aabb.minx = minx; else minx = aabb.minx;
							if(miny < aabb.miny) aabb.miny = miny; else miny = aabb.miny;
							if(maxx > aabb.maxx) aabb.maxx = maxx; else maxx = aabb.maxx;
							if(maxy > aabb.maxy) aabb.maxy = maxy; else maxy = aabb.maxy;
						}
						this.bphase.sync(s);
						cx_ite1 = cx_ite1.next;
					}
					cur.sweepFrozen = false;
					if(cur.isDynamic() && cur.bulletEnabled) {
						var linThreshold2 = nape.Config.bulletCCDLinearThreshold * cur.sweepRadius;
						var angThreshold2 = nape.Config.bulletCCDAngularThreshold;
						if((cur.velx * cur.velx + cur.vely * cur.vely) * dt * dt > linThreshold2 * linThreshold2 || cur.angvel * cur.angvel * dt * dt > angThreshold2 * angThreshold2) cur.bullet = true;
					}
				} else {
					cur.sweepFrozen = true;
					cur.bullet = false;
				}
			} else {
				cur.sweepFrozen = true;
				cur.bullet = false;
			}
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.kinematics.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			cur.pre_posx = cur.posx;
			cur.pre_posy = cur.posy;
			cur.pre_rot = cur.rot;
			cur.sweepTime = 0;
			cur.sweep_angvel = cur.angvel % MAX_VEL;
			cur.sweepIntegrate(dt);
			if(!cur.disableCCD) {
				var linThreshold = nape.Config.staticCCDLinearThreshold * cur.sweepRadius;
				var angThreshold = nape.Config.staticCCDAngularThreshold;
				if((cur.velx * cur.velx + cur.vely * cur.vely) * dt * dt > linThreshold * linThreshold || cur.angvel * cur.angvel * dt * dt > angThreshold * angThreshold || cur.isKinematic()) {
					var col = [65280,65535,255,16711935,65280,65535,255,16711935];
					var angvel = cur.sweep_angvel;
					if(angvel < 0) angvel = -angvel;
					var iangvel = 1 / angvel;
					var cx_ite1 = cur.shapes.begin();
					while(cx_ite1 != null) {
						var s = cx_ite1.elem();
						var aabb = s.aabb;
						var minx = aabb.minx;
						var miny = aabb.miny;
						var maxx = aabb.maxx;
						var maxy = aabb.maxy;
						var count = Std["int"](angvel * dt * s.sweepCoef * (1 / 120));
						if(count > 8) count = 8;
						var anginc = angvel * dt / count;
						cur.sweepIntegrate(dt);
						s.force_validate_aabb();
						if(minx < aabb.minx) aabb.minx = minx; else minx = aabb.minx;
						if(miny < aabb.miny) aabb.miny = miny; else miny = aabb.miny;
						if(maxx > aabb.maxx) aabb.maxx = maxx; else maxx = aabb.maxx;
						if(maxy > aabb.maxy) aabb.maxy = maxy; else maxy = aabb.maxy;
						var _g = 1;
						while(_g < count) {
							var i = _g++;
							cur.sweepIntegrate(anginc * i * iangvel);
							s.force_validate_aabb();
							if(minx < aabb.minx) aabb.minx = minx; else minx = aabb.minx;
							if(miny < aabb.miny) aabb.miny = miny; else miny = aabb.miny;
							if(maxx > aabb.maxx) aabb.maxx = maxx; else maxx = aabb.maxx;
							if(maxy > aabb.maxy) aabb.maxy = maxy; else maxy = aabb.maxy;
						}
						this.bphase.sync(s);
						cx_ite1 = cx_ite1.next;
					}
					cur.sweepFrozen = false;
					if(cur.isDynamic() && cur.bulletEnabled) {
						var linThreshold2 = nape.Config.bulletCCDLinearThreshold * cur.sweepRadius;
						var angThreshold2 = nape.Config.bulletCCDAngularThreshold;
						if((cur.velx * cur.velx + cur.vely * cur.vely) * dt * dt > linThreshold2 * linThreshold2 || cur.angvel * cur.angvel * dt * dt > angThreshold2 * angThreshold2) cur.bullet = true;
					}
				} else {
					cur.sweepFrozen = true;
					cur.bullet = false;
				}
			} else {
				cur.sweepFrozen = true;
				cur.bullet = false;
			}
			cx_ite = cx_ite.next;
		}
	}
	,updateVel: function(dt) {
		var pre = null;
		var linDrag = 1 - dt * this.global_lin_drag;
		var angDrag = 1 - dt * this.global_ang_drag;
		var cx_ite = this.live.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			if(cur.smass != 0.0) {
				var time = dt * cur.imass;
				cur.velx = linDrag * cur.velx + (cur.forcex + this.gravityx * cur.gravMass) * time;
				cur.vely = linDrag * cur.vely + (cur.forcey + this.gravityy * cur.gravMass) * time;
			}
			if(cur.sinertia != 0.0) {
				var dpx = 0.0;
				var dpy = 0.0;
				dpx = cur.worldCOMx - cur.posx;
				dpy = cur.worldCOMy - cur.posy;
				var torque = cur.torque + (this.gravityy * dpx - this.gravityx * dpy) * cur.gravMass;
				cur.angvel = angDrag * cur.angvel + torque * dt * cur.iinertia;
			}
			pre = cx_ite;
			cx_ite = cx_ite.next;
		}
	}
	,validation: function() {
		this.cbsets.validate();
		var cx_ite = this.live.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			cur.sweepRadius = 0;
			var cx_ite1 = cur.shapes.begin();
			while(cx_ite1 != null) {
				var s = cx_ite1.elem();
				if(s.isPolygon()) {
					s.polygon.splice_collinear();
					var res = s.polygon.valid();
					if(res != nape.shape.ValidationResult.get_VALID()) throw "Error: Cannot simulate with an invalid Polygon : " + s.polygon.outer.toString() + " is invalid : " + res.toString();
					s.polygon.validate_gaxi();
				}
				s.validate_sweepRadius();
				if(s.sweepRadius > cur.sweepRadius) cur.sweepRadius = s.sweepRadius;
				cx_ite1 = cx_ite1.next;
			}
			cur.validate_mass();
			cur.validate_inertia();
			if(!cur.shapes.empty()) {
				cur.validate_aabb();
				cur.validate_worldCOM();
			}
			cur.validate_gravMass();
			cur.validate_axis();
			if(!cur.nomove && cur.isDynamic() && cur.mass == 0) throw "Error: Dynamic Body cannot be simulated with 0 mass unless allowMovement is false";
			if(!cur.norotate && cur.isDynamic() && cur.inertia == 0) throw "Error: Dynamic Body cannot be simulated with 0 inertia unless allowRotation is false";
			if(!false) {
				if(cur.component.woken && cur.cbSet != null) {
					var cx_ite1 = cur.cbSet.bodylisteners.begin();
					while(cx_ite1 != null) {
						var i = cx_ite1.elem();
						if(i.event != zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE) {
							cx_ite1 = cx_ite1.next;
							continue;
						}
						var cb = this.push_callback(i);
						cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE;
						cb.body = cur;
						cx_ite1 = cx_ite1.next;
					}
				}
				cur.component.woken = false;
			}
			var cx_ite1 = cur.shapes.begin();
			while(cx_ite1 != null) {
				var shape = cx_ite1.elem();
				this.bphase.sync(shape);
				cx_ite1 = cx_ite1.next;
			}
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.kinematics.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			cur.sweepRadius = 0;
			var cx_ite1 = cur.shapes.begin();
			while(cx_ite1 != null) {
				var s = cx_ite1.elem();
				if(s.isPolygon()) {
					s.polygon.splice_collinear();
					var res = s.polygon.valid();
					if(res != nape.shape.ValidationResult.get_VALID()) throw "Error: Cannot simulate with an invalid Polygon : " + s.polygon.outer.toString() + " is invalid : " + res.toString();
					s.polygon.validate_gaxi();
				}
				s.validate_sweepRadius();
				if(s.sweepRadius > cur.sweepRadius) cur.sweepRadius = s.sweepRadius;
				cx_ite1 = cx_ite1.next;
			}
			cur.validate_mass();
			cur.validate_inertia();
			if(!cur.shapes.empty()) {
				cur.validate_aabb();
				cur.validate_worldCOM();
			}
			cur.validate_gravMass();
			cur.validate_axis();
			if(!cur.nomove && cur.isDynamic() && cur.mass == 0) throw "Error: Dynamic Body cannot be simulated with 0 mass unless allowMovement is false";
			if(!cur.norotate && cur.isDynamic() && cur.inertia == 0) throw "Error: Dynamic Body cannot be simulated with 0 inertia unless allowRotation is false";
			if(!true) {
				if(cur.component.woken && cur.cbSet != null) {
					var cx_ite1 = cur.cbSet.bodylisteners.begin();
					while(cx_ite1 != null) {
						var i = cx_ite1.elem();
						if(i.event != zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE) {
							cx_ite1 = cx_ite1.next;
							continue;
						}
						var cb = this.push_callback(i);
						cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE;
						cb.body = cur;
						cx_ite1 = cx_ite1.next;
					}
				}
				cur.component.woken = false;
			}
			var cx_ite1 = cur.shapes.begin();
			while(cx_ite1 != null) {
				var shape = cx_ite1.elem();
				this.bphase.sync(shape);
				cx_ite1 = cx_ite1.next;
			}
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.live_constraints.begin();
		while(cx_ite != null) {
			var con = cx_ite.elem();
			if(con.active) {
				con.validate();
				if(con.component.woken && con.cbSet != null) {
					var cx_ite1 = con.cbSet.conlisteners.begin();
					while(cx_ite1 != null) {
						var i = cx_ite1.elem();
						if(i.event != zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE) {
							cx_ite1 = cx_ite1.next;
							continue;
						}
						var cb = this.push_callback(i);
						cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE;
						cb.constraint = con;
						cx_ite1 = cx_ite1.next;
					}
				}
				con.component.woken = false;
			}
			cx_ite = cx_ite.next;
		}
	}
	,static_validation: function(body) {
		if(!body.shapes.empty()) body.validate_aabb();
		body.validate_mass();
		body.validate_inertia();
		if(body.velx != 0 || body.vely != 0 || body.angvel != 0) throw "Error: Static body cannot have any real velocity, only kinematic or surface velocities";
		var cx_ite = body.shapes.begin();
		while(cx_ite != null) {
			var s = cx_ite.elem();
			if(s.isPolygon()) {
				s.polygon.splice_collinear();
				var res = s.polygon.valid();
				if(res != nape.shape.ValidationResult.get_VALID()) throw "Error: Cannot simulate with an invalid Polygon : " + s.polygon.outer.toString() + " is invalid : " + res.toString();
				s.polygon.validate_gaxi();
			}
			cx_ite = cx_ite.next;
		}
		body.sweepFrozen = true;
	}
	,sleepArbiters: function() {
		var pre = null;
		var arbs = this.c_arbiters_true;
		var arbite = arbs.begin();
		var fst = this.c_arbiters_false != null;
		if(fst && arbite == null) {
			fst = false;
			arbite = this.c_arbiters_false.begin();
			arbs = this.c_arbiters_false;
			pre = null;
		}
		while(arbite != null) {
			var arb = arbite.elem();
			if(arb.b1.component.sleeping && arb.b2.component.sleeping) {
				arb.sleep_stamp = this.stamp;
				arb.sleeping = true;
				arbite = arbs.inlined_erase(pre);
				if(fst && arbite == null) {
					fst = false;
					arbite = this.c_arbiters_false.begin();
					arbs = this.c_arbiters_false;
					pre = null;
				}
				continue;
			}
			pre = arbite;
			arbite = arbite.next;
			if(fst && arbite == null) {
				fst = false;
				arbite = this.c_arbiters_false.begin();
				arbs = this.c_arbiters_false;
				pre = null;
			}
		}
		var pre = null;
		var arbs = this.f_arbiters;
		var arbite = arbs.begin();
		var fst = null != null;
		if(fst && arbite == null) {
			fst = false;
			arbite = null.begin();
			arbs = null;
			pre = null;
		}
		while(arbite != null) {
			var arb = arbite.elem();
			if(arb.b1.component.sleeping && arb.b2.component.sleeping) {
				arb.sleep_stamp = this.stamp;
				arb.sleeping = true;
				arbite = arbs.inlined_erase(pre);
				if(fst && arbite == null) {
					fst = false;
					arbite = null.begin();
					arbs = null;
					pre = null;
				}
				continue;
			}
			pre = arbite;
			arbite = arbite.next;
			if(fst && arbite == null) {
				fst = false;
				arbite = null.begin();
				arbs = null;
				pre = null;
			}
		}
		var pre = null;
		var arbs = this.s_arbiters;
		var arbite = arbs.begin();
		var fst = null != null;
		if(fst && arbite == null) {
			fst = false;
			arbite = null.begin();
			arbs = null;
			pre = null;
		}
		while(arbite != null) {
			var arb = arbite.elem();
			if(arb.b1.component.sleeping && arb.b2.component.sleeping) {
				arb.sleep_stamp = this.stamp;
				arb.sleeping = true;
				arbite = arbs.inlined_erase(pre);
				if(fst && arbite == null) {
					fst = false;
					arbite = null.begin();
					arbs = null;
					pre = null;
				}
				continue;
			}
			pre = arbite;
			arbite = arbite.next;
			if(fst && arbite == null) {
				fst = false;
				arbite = null.begin();
				arbs = null;
				pre = null;
			}
		}
	}
	,doForests: function(dt) {
		var cx_ite = this.c_arbiters_false.begin();
		while(cx_ite != null) {
			var arb = cx_ite.elem();
			if(!arb.cleared && arb.up_stamp == this.stamp && (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT) != 0) {
				if(arb.b1.isDynamic() && arb.b2.isDynamic()) {
					var xr = arb.b1.component == arb.b1.component.parent?arb.b1.component:(function($this) {
						var $r;
						var obj = arb.b1.component;
						var stack = null;
						while(obj != obj.parent) {
							var nxt = obj.parent;
							obj.parent = stack;
							stack = obj;
							obj = nxt;
						}
						while(stack != null) {
							var nxt = stack.parent;
							stack.parent = obj;
							stack = nxt;
						}
						$r = obj;
						return $r;
					}(this));
					var yr = arb.b2.component == arb.b2.component.parent?arb.b2.component:(function($this) {
						var $r;
						var obj = arb.b2.component;
						var stack = null;
						while(obj != obj.parent) {
							var nxt = obj.parent;
							obj.parent = stack;
							stack = obj;
							obj = nxt;
						}
						while(stack != null) {
							var nxt = stack.parent;
							stack.parent = obj;
							stack = nxt;
						}
						$r = obj;
						return $r;
					}(this));
					if(xr != yr) {
						if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
							yr.parent = xr;
							xr.rank++;
						}
					}
				}
			}
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.f_arbiters.begin();
		while(cx_ite != null) {
			var arb = cx_ite.elem();
			if(!arb.cleared && arb.up_stamp == this.stamp && (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT) != 0) {
				if(arb.b1.isDynamic() && arb.b2.isDynamic()) {
					var xr = arb.b1.component == arb.b1.component.parent?arb.b1.component:(function($this) {
						var $r;
						var obj = arb.b1.component;
						var stack = null;
						while(obj != obj.parent) {
							var nxt = obj.parent;
							obj.parent = stack;
							stack = obj;
							obj = nxt;
						}
						while(stack != null) {
							var nxt = stack.parent;
							stack.parent = obj;
							stack = nxt;
						}
						$r = obj;
						return $r;
					}(this));
					var yr = arb.b2.component == arb.b2.component.parent?arb.b2.component:(function($this) {
						var $r;
						var obj = arb.b2.component;
						var stack = null;
						while(obj != obj.parent) {
							var nxt = obj.parent;
							obj.parent = stack;
							stack = obj;
							obj = nxt;
						}
						while(stack != null) {
							var nxt = stack.parent;
							stack.parent = obj;
							stack = nxt;
						}
						$r = obj;
						return $r;
					}(this));
					if(xr != yr) {
						if(xr.rank < yr.rank) xr.parent = yr; else if(xr.rank > yr.rank) yr.parent = xr; else {
							yr.parent = xr;
							xr.rank++;
						}
					}
				}
			}
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.live_constraints.begin();
		while(cx_ite != null) {
			var con = cx_ite.elem();
			con.forest();
			cx_ite = cx_ite.next;
		}
		while(!this.live.empty()) {
			var o = this.live.inlined_pop_unsafe();
			var oc = o.component;
			var root = oc == oc.parent?oc:(function($this) {
				var $r;
				var obj = oc;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			if(root.island == null) {
				if(zpp_nape.space.ZPP_Island.zpp_pool == null) root.island = new zpp_nape.space.ZPP_Island(); else {
					root.island = zpp_nape.space.ZPP_Island.zpp_pool;
					zpp_nape.space.ZPP_Island.zpp_pool = root.island.next;
					root.island.next = null;
				}
				root.island.alloc();
				this.islands.inlined_add(root.island);
				root.island.sleep = true;
			}
			oc.island = root.island;
			oc.island.comps.inlined_add(oc);
			var rest = o.atRest(dt);
			oc.island.sleep = oc.island.sleep && rest;
			if(oc.waket > oc.island.waket) oc.island.waket = oc.waket;
		}
		while(!this.live_constraints.empty()) {
			var o = this.live_constraints.inlined_pop_unsafe();
			var oc = o.component;
			var root = oc == oc.parent?oc:(function($this) {
				var $r;
				var obj = oc;
				var stack = null;
				while(obj != obj.parent) {
					var nxt = obj.parent;
					obj.parent = stack;
					stack = obj;
					obj = nxt;
				}
				while(stack != null) {
					var nxt = stack.parent;
					stack.parent = obj;
					stack = nxt;
				}
				$r = obj;
				return $r;
			}(this));
			oc.island = root.island;
			oc.island.comps.inlined_add(oc);
			if(oc.waket > oc.island.waket) oc.island.waket = oc.waket;
		}
		while(!this.islands.empty()) {
			var i = this.islands.inlined_pop_unsafe();
			if(i.sleep) {
				var cx_ite = i.comps.begin();
				while(cx_ite != null) {
					var c = cx_ite.elem();
					if(c.isBody) {
						var b = c.body;
						b.velx = 0;
						b.vely = 0;
						b.angvel = 0;
						c.sleeping = true;
						var cx_ite1 = b.shapes.begin();
						while(cx_ite1 != null) {
							var shape = cx_ite1.elem();
							this.bphase.sync(shape);
							cx_ite1 = cx_ite1.next;
						}
						this.bodyCbSleep(b);
					} else {
						var con = c.constraint;
						this.constraintCbSleep(con);
						c.sleeping = true;
					}
					cx_ite = cx_ite.next;
				}
			} else {
				while(!i.comps.empty()) {
					var c = i.comps.inlined_pop_unsafe();
					c.waket = i.waket;
					if(c.isBody) this.live.inlined_add(c.body); else this.live_constraints.inlined_add(c.constraint);
					c.reset();
				}
				var o = i;
				o.free();
				o.next = zpp_nape.space.ZPP_Island.zpp_pool;
				zpp_nape.space.ZPP_Island.zpp_pool = o;
			}
		}
	}
	,wake_constraint: function(con,fst) {
		if(fst == null) fst = false;
		if(con.active) {
			con.component.waket = this.stamp + (this.midstep?0:1);
			if(con.component.sleeping) {
				if(con.component.island == null) {
					con.component.sleeping = false;
					this.live_constraints.inlined_add(con);
					con.wake_connected();
					if(!fst) this.constraintCbWake(con);
				} else this.wakeIsland(con.component.island);
				return true;
			} else return false;
		} else return false;
	}
	,really_wake: function(o,fst) {
		if(fst == null) fst = false;
		if(o.component.island == null) {
			o.component.sleeping = false;
			if(o.isKinematic() || o.isStatic()) this.staticsleep.inlined_add(o); else this.live.inlined_add(o);
			var cx_ite = o.constraints.begin();
			while(cx_ite != null) {
				var con = cx_ite.elem();
				if(con.space == this) this.wake_constraint(con);
				cx_ite = cx_ite.next;
			}
			var cx_ite = o.arbiters.begin();
			while(cx_ite != null) {
				var arb = cx_ite.elem();
				if(arb.sleeping) {
					arb.sleeping = false;
					arb.up_stamp += this.stamp + (this.midstep?0:1) - arb.sleep_stamp;
					if(arb.type == zpp_nape.dynamics.ZPP_Arbiter.COL) {
						var carb = arb.colarb;
						if(carb.stat) this.c_arbiters_true.inlined_add(carb); else this.c_arbiters_false.inlined_add(carb);
					} else if(arb.type == zpp_nape.dynamics.ZPP_Arbiter.FLUID) this.f_arbiters.inlined_add(arb.fluidarb); else this.s_arbiters.inlined_add(arb.sensorarb);
				}
				if(arb.type != zpp_nape.dynamics.ZPP_Arbiter.SENSOR && !arb.cleared && arb.up_stamp >= this.stamp && (arb.immState & zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT) != 0) {
					if(arb.b1.isDynamic() && arb.b1.component.sleeping) {
						var o1 = arb.b1;
						if(!o1.world) {
							o1.component.waket = this.stamp + (this.midstep?0:1);
							if(o1.isKinematic()) o1.kinematicDelaySleep = true;
							if(o1.component.sleeping) this.really_wake(o1,false);
						}
					}
					if(arb.b2.isDynamic() && arb.b2.component.sleeping) {
						var o1 = arb.b2;
						if(!o1.world) {
							o1.component.waket = this.stamp + (this.midstep?0:1);
							if(o1.isKinematic()) o1.kinematicDelaySleep = true;
							if(o1.component.sleeping) this.really_wake(o1,false);
						}
					}
				}
				cx_ite = cx_ite.next;
			}
			if(!fst && o.isDynamic()) this.bodyCbWake(o);
			if(!fst && !this.bphase.is_sweep && !o.isStatic()) {
				var cx_ite = o.shapes.begin();
				while(cx_ite != null) {
					var shape = cx_ite.elem();
					if(shape.node != null) this.bphase.sync(shape);
					cx_ite = cx_ite.next;
				}
			}
		} else this.wakeIsland(o.component.island);
	}
	,non_inlined_wake: function(o,fst) {
		if(fst == null) fst = false;
		var o1 = o;
		if(!o1.world) {
			o1.component.waket = this.stamp + (this.midstep?0:1);
			if(o1.isKinematic()) o1.kinematicDelaySleep = true;
			if(o1.component.sleeping) this.really_wake(o1,fst);
		}
	}
	,wakeIsland: function(i) {
		while(!i.comps.empty()) {
			var c = i.comps.pop_unsafe();
			c.waket = this.stamp + (this.midstep?0:1);
			if(c.isBody) {
				var b = c.body;
				this.live.add(b);
				var cx_ite = b.arbiters.begin();
				while(cx_ite != null) {
					var arb = cx_ite.elem();
					if(arb.sleeping) {
						arb.sleeping = false;
						arb.up_stamp += this.stamp - arb.sleep_stamp;
						if(arb.type == zpp_nape.dynamics.ZPP_Arbiter.COL) {
							var carb = arb.colarb;
							if(carb.stat) this.c_arbiters_true.inlined_add(carb); else this.c_arbiters_false.inlined_add(carb);
						} else if(arb.type == zpp_nape.dynamics.ZPP_Arbiter.FLUID) this.f_arbiters.inlined_add(arb.fluidarb); else this.s_arbiters.inlined_add(arb.sensorarb);
					}
					cx_ite = cx_ite.next;
				}
				this.bodyCbWake(b);
				c.reset();
				if(!b.isStatic()) {
					var cx_ite = b.shapes.begin();
					while(cx_ite != null) {
						var shape = cx_ite.elem();
						if(shape.node != null) this.bphase.sync(shape);
						cx_ite = cx_ite.next;
					}
				}
			} else {
				var con = c.constraint;
				this.live_constraints.inlined_add(con);
				this.constraintCbWake(con);
				c.reset();
			}
		}
		var o = i;
		o.free();
		o.next = zpp_nape.space.ZPP_Island.zpp_pool;
		zpp_nape.space.ZPP_Island.zpp_pool = o;
	}
	,wakeCompound: function(x) {
		var cx_ite = x.bodies.begin();
		while(cx_ite != null) {
			var y = cx_ite.elem();
			var o = y;
			if(!o.world) {
				o.component.waket = this.stamp + (this.midstep?0:1);
				if(o.isKinematic()) o.kinematicDelaySleep = true;
				if(o.component.sleeping) this.really_wake(o,false);
			}
			cx_ite = cx_ite.next;
		}
		var cx_ite = x.constraints.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			this.wake_constraint(i);
			cx_ite = cx_ite.next;
		}
		var cx_ite = x.compounds.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			this.wakeCompound(i);
			cx_ite = cx_ite.next;
		}
	}
	,freshInteractorType: function(intx,me) {
		if(me == null) me = intx;
		if(intx.isCompound()) {
			var comp = intx.icompound;
			var cx_ite = comp.bodies.begin();
			while(cx_ite != null) {
				var body = cx_ite.elem();
				this.freshInteractorType(body,me);
				cx_ite = cx_ite.next;
			}
			var cx_ite = comp.compounds.begin();
			while(cx_ite != null) {
				var comp1 = cx_ite.elem();
				this.freshInteractorType(comp1,me);
				cx_ite = cx_ite.next;
			}
		} else {
			var xbody = intx.isBody()?intx.ibody:intx.ishape.body;
			var xshp = intx.isShape()?intx.ishape:null;
			var cx_ite = xbody.arbiters.begin();
			while(cx_ite != null) {
				var xarb = cx_ite.elem();
				if(!xarb.presentable) {
					cx_ite = cx_ite.next;
					continue;
				}
				if(xshp != null && !(xarb.ws1 == xshp || xarb.ws2 == xshp)) {
					cx_ite = cx_ite.next;
					continue;
				}
				this.MRCA_chains(xarb.ws1,xarb.ws2);
				var cx_ite1 = this.mrca1.begin();
				while(cx_ite1 != null) {
					var i1 = cx_ite1.elem();
					var cx_ite2 = this.mrca2.begin();
					while(cx_ite2 != null) {
						var i2 = cx_ite2.elem();
						if(i1 != me && i2 != me) {
							cx_ite2 = cx_ite2.next;
							continue;
						}
						var cb1 = i1.cbSet;
						var cb2 = i2.cbSet;
						cb1.validate();
						cb2.validate();
						if(!zpp_nape.callbacks.ZPP_CbSet.empty_intersection(cb1,cb2)) {
							var callbackset = zpp_nape.phys.ZPP_Interactor.get(i1,i2);
							if(callbackset == null) {
								callbackset = zpp_nape.space.ZPP_CallbackSet.get(i1,i2);
								this.add_callbackset(callbackset);
							}
							if(callbackset.add_arb(xarb)) xarb.present++;
						}
						cx_ite2 = cx_ite2.next;
					}
					cx_ite1 = cx_ite1.next;
				}
				cx_ite = cx_ite.next;
			}
		}
	}
	,freshListenerType: function(cb1,cb2) {
		var stack = new zpp_nape.util.ZNPList_ZPP_Interactor();
		var cx_ite = cb1.interactors.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			stack.add(i);
			cx_ite = cx_ite.next;
		}
		if(cb1 != cb2) {
			var cx_ite = cb2.interactors.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				stack.add(i);
				cx_ite = cx_ite.next;
			}
		}
		while(!stack.empty()) {
			var intx = stack.pop_unsafe();
			if(intx.isCompound()) {
				var comp = intx.icompound;
				var cx_ite = comp.bodies.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					stack.add(i);
					cx_ite = cx_ite.next;
				}
				var cx_ite = comp.compounds.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					stack.add(i);
					cx_ite = cx_ite.next;
				}
			} else {
				var xbody = intx.isBody()?intx.ibody:intx.ishape.body;
				var xshp = intx.isShape()?intx.ishape:null;
				var cx_ite = xbody.arbiters.begin();
				while(cx_ite != null) {
					var xarb = cx_ite.elem();
					if(!xarb.presentable) {
						cx_ite = cx_ite.next;
						continue;
					}
					if(xshp != null && !(xarb.ws1 == xshp || xarb.ws2 == xshp)) {
						cx_ite = cx_ite.next;
						continue;
					}
					this.MRCA_chains(xarb.ws1,xarb.ws2);
					var cx_ite1 = this.mrca1.begin();
					while(cx_ite1 != null) {
						var i1 = cx_ite1.elem();
						if(i1.cbSet != cb1 && i1.cbSet != cb2) {
							cx_ite1 = cx_ite1.next;
							continue;
						}
						var cx_ite2 = this.mrca2.begin();
						while(cx_ite2 != null) {
							var i2 = cx_ite2.elem();
							if(i1.cbSet == cb1 && i2.cbSet != cb2 || i1.cbSet == cb2 && i2.cbSet != cb1) {
								cx_ite2 = cx_ite2.next;
								continue;
							}
							var callbackset = zpp_nape.phys.ZPP_Interactor.get(i1,i2);
							if(callbackset == null) {
								callbackset = zpp_nape.space.ZPP_CallbackSet.get(i1,i2);
								this.add_callbackset(callbackset);
							}
							if(callbackset.add_arb(xarb)) xarb.present++;
							cx_ite2 = cx_ite2.next;
						}
						cx_ite1 = cx_ite1.next;
					}
					cx_ite = cx_ite.next;
				}
			}
		}
	}
	,nullInteractorType: function(intx,me) {
		if(me == null) me = intx;
		if(intx.isCompound()) {
			var comp = intx.icompound;
			var cx_ite = comp.bodies.begin();
			while(cx_ite != null) {
				var body = cx_ite.elem();
				this.nullInteractorType(body,me);
				cx_ite = cx_ite.next;
			}
			var cx_ite = comp.compounds.begin();
			while(cx_ite != null) {
				var comp1 = cx_ite.elem();
				this.nullInteractorType(comp1,me);
				cx_ite = cx_ite.next;
			}
		} else {
			var xbody = intx.isBody()?intx.ibody:intx.ishape.body;
			var xshp = intx.isShape()?intx.ishape:null;
			var cx_ite = xbody.arbiters.begin();
			while(cx_ite != null) {
				var xarb = cx_ite.elem();
				if(xarb.present == 0) {
					cx_ite = cx_ite.next;
					continue;
				}
				if(xshp != null && !(xarb.ws1 == xshp || xarb.ws2 == xshp)) {
					cx_ite = cx_ite.next;
					continue;
				}
				this.MRCA_chains(xarb.ws1,xarb.ws2);
				var cx_ite1 = this.mrca1.begin();
				while(cx_ite1 != null) {
					var i1 = cx_ite1.elem();
					var cx_ite2 = this.mrca2.begin();
					while(cx_ite2 != null) {
						var i2 = cx_ite2.elem();
						if(i1 != me && i2 != me) {
							cx_ite2 = cx_ite2.next;
							continue;
						}
						var callbackset = zpp_nape.phys.ZPP_Interactor.get(i1,i2);
						if(callbackset != null) {
							xarb.present--;
							callbackset.remove_arb(xarb);
							if(callbackset.really_empty()) this.remove_callbackset(callbackset);
						}
						cx_ite2 = cx_ite2.next;
					}
					cx_ite1 = cx_ite1.next;
				}
				cx_ite = cx_ite.next;
			}
		}
	}
	,nullListenerType: function(cb1,cb2) {
		var stack = new zpp_nape.util.ZNPList_ZPP_Interactor();
		var cx_ite = cb1.interactors.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			stack.add(i);
			cx_ite = cx_ite.next;
		}
		if(cb1 != cb2) {
			var cx_ite = cb2.interactors.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				stack.add(i);
				cx_ite = cx_ite.next;
			}
		}
		while(!stack.empty()) {
			var intx = stack.pop_unsafe();
			if(intx.isCompound()) {
				var comp = intx.icompound;
				var cx_ite = comp.bodies.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					stack.add(i);
					cx_ite = cx_ite.next;
				}
				var cx_ite = comp.compounds.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					stack.add(i);
					cx_ite = cx_ite.next;
				}
			} else {
				var xbody = intx.isBody()?intx.ibody:intx.ishape.body;
				var xshp = intx.isShape()?intx.ishape:null;
				var cx_ite = xbody.arbiters.begin();
				while(cx_ite != null) {
					var xarb = cx_ite.elem();
					if(xarb.present == 0) {
						cx_ite = cx_ite.next;
						continue;
					}
					if(xshp != null && !(xarb.ws1 == xshp || xarb.ws2 == xshp)) {
						cx_ite = cx_ite.next;
						continue;
					}
					this.MRCA_chains(xarb.ws1,xarb.ws2);
					var cx_ite1 = this.mrca1.begin();
					while(cx_ite1 != null) {
						var i1 = cx_ite1.elem();
						if(i1.cbSet != cb1 && i1.cbSet != cb2) {
							cx_ite1 = cx_ite1.next;
							continue;
						}
						var cx_ite2 = this.mrca2.begin();
						while(cx_ite2 != null) {
							var i2 = cx_ite2.elem();
							if(i1.cbSet == cb1 && i2.cbSet != cb2 || i1.cbSet == cb2 && i2.cbSet != cb1) {
								cx_ite2 = cx_ite2.next;
								continue;
							}
							var callbackset = zpp_nape.phys.ZPP_Interactor.get(i1,i2);
							if(callbackset != null) {
								while(!callbackset.arbiters.empty()) {
									var arb = callbackset.arbiters.pop_unsafe();
									arb.present--;
								}
								this.remove_callbackset(callbackset);
							}
							cx_ite2 = cx_ite2.next;
						}
						cx_ite1 = cx_ite1.next;
					}
					cx_ite = cx_ite.next;
				}
			}
		}
	}
	,constraintCbBreak: function(con) {
		if(con.cbSet != null) {
			var cx_ite = con.cbSet.conlisteners.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				if(i.event != zpp_nape.util.ZPP_Flags.id_CbEvent_BREAK) {
					cx_ite = cx_ite.next;
					continue;
				}
				var cb = this.push_callback(i);
				cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_BREAK;
				cb.constraint = con;
				cx_ite = cx_ite.next;
			}
		}
	}
	,constraintCbSleep: function(con) {
		if(con.cbSet != null) {
			var cx_ite = con.cbSet.conlisteners.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				if(i.event != zpp_nape.util.ZPP_Flags.id_CbEvent_SLEEP) {
					cx_ite = cx_ite.next;
					continue;
				}
				var cb = this.push_callback(i);
				cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_SLEEP;
				cb.constraint = con;
				cx_ite = cx_ite.next;
			}
		}
	}
	,constraintCbWake: function(con) {
		if(con.cbSet != null) {
			if(this.midstep) {
				var cx_ite = con.cbSet.conlisteners.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(i.event != zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE) {
						cx_ite = cx_ite.next;
						continue;
					}
					var cb = this.push_callback(i);
					cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE;
					cb.constraint = con;
					cx_ite = cx_ite.next;
				}
			} else con.component.woken = true;
		}
	}
	,bodyCbSleep: function(b) {
		if(b.isDynamic() && b.cbSet != null) {
			var cx_ite = b.cbSet.bodylisteners.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				if(i.event != zpp_nape.util.ZPP_Flags.id_CbEvent_SLEEP) {
					cx_ite = cx_ite.next;
					continue;
				}
				var cb = this.push_callback(i);
				cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_SLEEP;
				cb.body = b;
				cx_ite = cx_ite.next;
			}
		}
	}
	,bodyCbWake: function(b) {
		if(b.isDynamic() && b.cbSet != null) {
			if(this.midstep) {
				var cx_ite = b.cbSet.bodylisteners.begin();
				while(cx_ite != null) {
					var i = cx_ite.elem();
					if(i.event != zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE) {
						cx_ite = cx_ite.next;
						continue;
					}
					var cb = this.push_callback(i);
					cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE;
					cb.body = b;
					cx_ite = cx_ite.next;
				}
			} else b.component.woken = true;
		}
	}
	,continuousEvent: function(s1,s2,stat,in_arb,_) {
		if(s1.body.sweepFrozen && s2.body.sweepFrozen) return in_arb;
		if(s1.body.disableCCD || s2.body.disableCCD) return in_arb;
		if(in_arb != null && in_arb.colarb == null || this.interactionType(s1,s2,s1.body,s2.body) == 0) return in_arb;
		var b1 = s1.body;
		var b2 = s2.body;
		if(stat || b1.bullet || b2.bullet) {
			var toi;
			if(zpp_nape.geom.ZPP_ToiEvent.zpp_pool == null) toi = new zpp_nape.geom.ZPP_ToiEvent(); else {
				toi = zpp_nape.geom.ZPP_ToiEvent.zpp_pool;
				zpp_nape.geom.ZPP_ToiEvent.zpp_pool = toi.next;
				toi.next = null;
			}
			toi.alloc();
			var kin = b1.isKinematic() || b2.isKinematic();
			if(stat && !kin) {
				if(!s1.body.isDynamic()) {
					toi.s2 = s1;
					toi.s1 = s2;
				} else {
					toi.s1 = s1;
					toi.s2 = s2;
				}
				toi.kinematic = false;
				zpp_nape.geom.ZPP_SweepDistance.staticSweep(toi,this.pre_dt,0,nape.Config.collisionSlopCCD);
			} else {
				toi.s1 = s1;
				toi.s2 = s2;
				toi.kinematic = kin;
				if(toi.s1.body.sweepFrozen || toi.s2.body.sweepFrozen) {
					if(toi.s1.body.sweepFrozen) {
						var tmp = toi.s1;
						toi.s1 = toi.s2;
						toi.s2 = tmp;
						toi.frozen1 = false;
						toi.frozen2 = true;
					}
					zpp_nape.geom.ZPP_SweepDistance.staticSweep(toi,this.pre_dt,0,nape.Config.collisionSlopCCD);
				} else zpp_nape.geom.ZPP_SweepDistance.dynamicSweep(toi,this.pre_dt,0,nape.Config.collisionSlopCCD);
			}
			if(stat && toi.toi < 0 || toi.failed) {
				var o = toi;
				o.free();
				o.next = zpp_nape.geom.ZPP_ToiEvent.zpp_pool;
				zpp_nape.geom.ZPP_ToiEvent.zpp_pool = o;
			} else {
				this.toiEvents.add(toi);
				toi.frozen1 = toi.s1.body.sweepFrozen;
				toi.frozen2 = toi.s2.body.sweepFrozen;
				toi.arbiter = in_arb != null?in_arb.colarb:null;
			}
		}
		return in_arb;
	}
	,continuousCollisions: function(deltaTime) {
		var MAX_VEL = 2 * Math.PI / deltaTime;
		this.bphase.broadphase(this,false);
		var curTimeAlpha = 0.0;
		while(curTimeAlpha < 1 && !this.toiEvents.empty()) {
			var minTOI = null;
			var minTime = 2.0;
			var minKinematic = false;
			var preMin = null;
			var pre = null;
			var cx_ite = this.toiEvents.begin();
			while(cx_ite != null) {
				var toi = cx_ite.elem();
				var b1 = toi.s1.body;
				var b2 = toi.s2.body;
				if(b1.sweepFrozen && b2.sweepFrozen) {
					if(toi.toi != 0 && zpp_nape.geom.ZPP_Collide.testCollide_safe(toi.s1,toi.s2)) toi.toi = 0; else {
						cx_ite = this.toiEvents.erase(pre);
						var o = toi;
						o.free();
						o.next = zpp_nape.geom.ZPP_ToiEvent.zpp_pool;
						zpp_nape.geom.ZPP_ToiEvent.zpp_pool = o;
						continue;
					}
				}
				if(toi.frozen1 != b1.sweepFrozen || toi.frozen2 != b2.sweepFrozen) {
					if(!toi.kinematic) {
						toi.frozen1 = b1.sweepFrozen;
						toi.frozen2 = b2.sweepFrozen;
						if(toi.frozen1) {
							var tmp = toi.s1;
							toi.s1 = toi.s2;
							toi.s2 = tmp;
							toi.frozen1 = false;
							toi.frozen2 = true;
						}
						zpp_nape.geom.ZPP_SweepDistance.staticSweep(toi,deltaTime,0,nape.Config.collisionSlopCCD);
						if(toi.toi < 0) {
							cx_ite = this.toiEvents.erase(pre);
							var o = toi;
							o.free();
							o.next = zpp_nape.geom.ZPP_ToiEvent.zpp_pool;
							zpp_nape.geom.ZPP_ToiEvent.zpp_pool = o;
							continue;
						}
					} else {
						cx_ite = this.toiEvents.erase(pre);
						var o = toi;
						o.free();
						o.next = zpp_nape.geom.ZPP_ToiEvent.zpp_pool;
						zpp_nape.geom.ZPP_ToiEvent.zpp_pool = o;
						continue;
					}
				}
				if(toi.toi >= 0 && (toi.toi < minTime || !minKinematic && toi.kinematic)) {
					minTOI = toi;
					minTime = toi.toi;
					minKinematic = toi.kinematic;
					preMin = pre;
				}
				pre = cx_ite;
				cx_ite = cx_ite.next;
			}
			if(minTOI == null) break;
			this.toiEvents.erase(preMin);
			curTimeAlpha = minTOI.toi;
			var b1 = minTOI.s1.body;
			var b2 = minTOI.s2.body;
			if(!b1.sweepFrozen) {
				b1.sweepIntegrate(curTimeAlpha * deltaTime);
				b1.sweepValidate(minTOI.s1);
			}
			if(!b2.sweepFrozen) {
				b2.sweepIntegrate(curTimeAlpha * deltaTime);
				b2.sweepValidate(minTOI.s2);
			}
			var wasnull = minTOI.arbiter == null;
			var arb = this.narrowPhase(minTOI.s1,minTOI.s2,true,minTOI.arbiter,true);
			if(arb == null) {
				if(minTOI.arbiter != null && minTOI.arbiter.pair != null) {
					minTOI.arbiter.pair.arb = null;
					minTOI.arbiter.pair = null;
				}
			} else if(!this.presteparb(arb,deltaTime,true)) {
				if(arb.type == zpp_nape.dynamics.ZPP_Arbiter.COL && arb.acting()) {
					arb.colarb.warmStart();
					arb.colarb.applyImpulseVel();
					arb.colarb.applyImpulseVel();
					arb.colarb.applyImpulseVel();
					arb.colarb.applyImpulseVel();
					b1.sweep_angvel = b1.angvel % MAX_VEL;
					b2.sweep_angvel = b2.angvel % MAX_VEL;
				}
			}
			if(arb != null && arb.acting() && arb.type == zpp_nape.dynamics.ZPP_Arbiter.COL) {
				if(!b1.sweepFrozen && !b1.isKinematic()) {
					b1.sweepFrozen = true;
					if(minTOI.failed) b1.angvel = b1.sweep_angvel = 0; else if(minTOI.slipped) b1.angvel = b1.sweep_angvel *= nape.Config.angularCCDSlipScale; else b1.angvel = b1.sweep_angvel;
				}
				if(!b2.sweepFrozen && !b2.isKinematic()) {
					b2.sweepFrozen = true;
					if(minTOI.failed) b2.angvel = b2.sweep_angvel = 0; else if(minTOI.slipped) b2.angvel = b2.sweep_angvel *= nape.Config.angularCCDSlipScale; else b2.angvel = b2.sweep_angvel;
				}
			}
		}
		while(!this.toiEvents.empty()) {
			var toi = this.toiEvents.pop_unsafe();
			var o = toi;
			o.free();
			o.next = zpp_nape.geom.ZPP_ToiEvent.zpp_pool;
			zpp_nape.geom.ZPP_ToiEvent.zpp_pool = o;
		}
		var cx_ite = this.kinematics.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			cur.sweepIntegrate(deltaTime);
			cur.sweepTime = 0;
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.live.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			if(!cur.sweepFrozen) cur.sweepIntegrate(deltaTime);
			cur.sweepTime = 0;
			cx_ite = cx_ite.next;
		}
	}
	,step: function(deltaTime,velocityIterations,positionIterations) {
		var _g = this;
		if(this.midstep) throw "Error: ... REALLY?? you're going to call space.step() inside of space.step()? COME ON!!";
		this.time += deltaTime;
		this.pre_dt = deltaTime;
		this.midstep = true;
		this.stamp++;
		this.validation();
		this.bphase.broadphase(this,true);
		this.prestep(deltaTime);
		if(this.sortcontacts) {
			var xxlist = this.c_arbiters_false;
			if(!xxlist.empty() && xxlist.begin().next != null) {
				var head = xxlist.begin();
				var tail = null;
				var left = null;
				var right = null;
				var nxt = null;
				var listSize = 1;
				var numMerges, leftSize, rightSize;
				do {
					numMerges = 0;
					left = head;
					tail = head = null;
					while(left != null) {
						numMerges++;
						right = left;
						leftSize = 0;
						rightSize = listSize;
						while(right != null && leftSize < listSize) {
							leftSize++;
							right = right.next;
						}
						while(leftSize > 0 || rightSize > 0 && right != null) {
							if(leftSize == 0) {
								nxt = right;
								right = right.next;
								rightSize--;
							} else if(rightSize == 0 || right == null) {
								nxt = left;
								left = left.next;
								leftSize--;
							} else if(left.elem().active && right.elem().active?left.elem().oc1.dist < right.elem().oc1.dist:true) {
								nxt = left;
								left = left.next;
								leftSize--;
							} else {
								nxt = right;
								right = right.next;
								rightSize--;
							}
							if(tail != null) tail.next = nxt; else head = nxt;
							tail = nxt;
						}
						left = right;
					}
					tail.next = null;
					listSize <<= 1;
				} while(numMerges > 1);
				xxlist.setbegin(head);
			}
		}
		this.updateVel(deltaTime);
		this.warmStart();
		this.iterateVel(velocityIterations);
		var cx_ite = this.kinematics.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			cur.pre_posx = cur.posx;
			cur.pre_posy = cur.posy;
			cur.pre_rot = cur.rot;
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.live.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			cur.pre_posx = cur.posx;
			cur.pre_posy = cur.posy;
			cur.pre_rot = cur.rot;
			cx_ite = cx_ite.next;
		}
		this.updatePos(deltaTime);
		this.continuous = true;
		this.continuousCollisions(deltaTime);
		this.continuous = false;
		this.iteratePos(positionIterations);
		var cx_ite = this.kinematics.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			var upos = !(cur.posx == cur.pre_posx && cur.posy == cur.pre_posy);
			var urot = cur.pre_rot != cur.rot;
			if(upos) cur.invalidate_pos();
			if(urot) cur.invalidate_rot();
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.live.begin();
		while(cx_ite != null) {
			var cur = cx_ite.elem();
			var upos = !(cur.posx == cur.pre_posx && cur.posy == cur.pre_posy);
			var urot = cur.pre_rot != cur.rot;
			if(upos) cur.invalidate_pos();
			if(urot) cur.invalidate_rot();
			cx_ite = cx_ite.next;
		}
		var pre = null;
		var cx_ite = this.staticsleep.begin();
		while(cx_ite != null) {
			var b = cx_ite.elem();
			if(!b.isKinematic() || b.velx == 0 && b.vely == 0 && b.angvel == 0) {
				if(b.kinematicDelaySleep) {
					b.kinematicDelaySleep = false;
					cx_ite = cx_ite.next;
					continue;
				}
				b.component.sleeping = true;
				cx_ite = this.staticsleep.inlined_erase(pre);
				continue;
			}
			pre = cx_ite;
			cx_ite = cx_ite.next;
		}
		this.doForests(deltaTime);
		this.sleepArbiters();
		this.midstep = false;
		var pre1 = null;
		var cx_ite = this.callbackset_list.begin();
		while(cx_ite != null) {
			var set = [cx_ite.elem()];
			if(set[0].really_empty()) {
				cx_ite = this.callbackset_list.inlined_erase(pre1);
				var inf = set[0].int1.id + " " + set[0].int2.id;
				var o = set[0];
				o.free();
				o.next = zpp_nape.space.ZPP_CallbackSet.zpp_pool;
				zpp_nape.space.ZPP_CallbackSet.zpp_pool = o;
				continue;
			}
			var sleeping = [set[0].sleeping()];
			zpp_nape.callbacks.ZPP_CbSet.find_all(set[0].int1.cbSet,set[0].int2.cbSet,zpp_nape.util.ZPP_Flags.id_CbEvent_ONGOING,(function(sleeping,set) {
				return function(x) {
					if((!sleeping[0] || x.allowSleepingCallbacks) && !set[0].empty_arb(x.itype)) {
						var cb = _g.push_callback(x);
						cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_ONGOING;
						zpp_nape.phys.ZPP_Interactor.int_callback(set[0],x,cb);
						cb.set = set[0];
					}
				};
			})(sleeping,set));
			pre1 = cx_ite;
			cx_ite = cx_ite.next;
		}
		while(!this.callbacks.empty()) {
			var cb = this.callbacks.pop();
			if(cb.listener.type == zpp_nape.util.ZPP_Flags.id_ListenerType_BODY) {
				var o = cb.listener.body;
				o.handler(cb.wrapper_body());
			} else if(cb.listener.type == zpp_nape.util.ZPP_Flags.id_ListenerType_CONSTRAINT) {
				var o = cb.listener.constraint;
				o.handler(cb.wrapper_con());
			} else if(cb.listener.type == zpp_nape.util.ZPP_Flags.id_ListenerType_INTERACTION) {
				var o = cb.listener.interaction;
				o.handleri(cb.wrapper_int());
			}
			var o = cb;
			o.free();
			o.next = zpp_nape.callbacks.ZPP_Callback.zpp_pool;
			zpp_nape.callbacks.ZPP_Callback.zpp_pool = o;
		}
	}
	,push_callback: function(i) {
		var cb;
		if(zpp_nape.callbacks.ZPP_Callback.zpp_pool == null) cb = new zpp_nape.callbacks.ZPP_Callback(); else {
			cb = zpp_nape.callbacks.ZPP_Callback.zpp_pool;
			zpp_nape.callbacks.ZPP_Callback.zpp_pool = cb.next;
			cb.next = null;
		}
		cb.alloc();
		this.callbacks.push(cb);
		cb.listener = i;
		return cb;
	}
	,remBody: function(body,flag) {
		if(flag == null) flag = -1;
		if(body.isStatic()) {
			var o = body;
			if(!o.world) {
				o.component.waket = this.stamp + (this.midstep?0:1);
				if(o.isKinematic()) o.kinematicDelaySleep = true;
				if(o.component.sleeping) this.really_wake(o,true);
			}
			this.staticsleep.remove(body);
		} else if(body.isDynamic()) {
			var o = body;
			if(!o.world) {
				o.component.waket = this.stamp + (this.midstep?0:1);
				if(o.isKinematic()) o.kinematicDelaySleep = true;
				if(o.component.sleeping) this.really_wake(o,true);
			}
			this.live.remove(body);
		} else {
			if(flag != zpp_nape.util.ZPP_Flags.id_BodyType_KINEMATIC) this.kinematics.remove(body);
			var o = body;
			if(!o.world) {
				o.component.waket = this.stamp + (this.midstep?0:1);
				if(o.isKinematic()) o.kinematicDelaySleep = true;
				if(o.component.sleeping) this.really_wake(o,true);
			}
			this.staticsleep.remove(body);
		}
		var cx_ite = body.shapes.begin();
		while(cx_ite != null) {
			var shape = cx_ite.elem();
			this.removed_shape(shape,true);
			cx_ite = cx_ite.next;
		}
		body.removedFromSpace();
		body.space = null;
	}
	,addBody: function(body,flag) {
		if(flag == null) flag = -1;
		body.space = this;
		body.addedToSpace();
		body.component.sleeping = true;
		var o = body;
		if(!o.world) {
			o.component.waket = this.stamp + (this.midstep?0:1);
			if(o.isKinematic()) o.kinematicDelaySleep = true;
			if(o.component.sleeping) this.really_wake(o,true);
		}
		var cx_ite = body.shapes.begin();
		while(cx_ite != null) {
			var shape = cx_ite.elem();
			this.added_shape(shape,true);
			cx_ite = cx_ite.next;
		}
		if(body.isStatic()) {
			this.static_validation(body);
		} else if(body.isDynamic()) {
		} else {
			if(flag != zpp_nape.util.ZPP_Flags.id_BodyType_KINEMATIC) this.kinematics.add(body);
		}
	}
	,remCompound: function(x) {
		var cx_ite = x.bodies.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			this.remBody(i);
			cx_ite = cx_ite.next;
		}
		var cx_ite = x.constraints.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			this.remConstraint(i);
			cx_ite = cx_ite.next;
		}
		var cx_ite = x.compounds.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			this.remCompound(i);
			cx_ite = cx_ite.next;
		}
		x.removedFromSpace();
		x.space = null;
	}
	,addCompound: function(x) {
		x.space = this;
		x.addedToSpace();
		var cx_ite = x.bodies.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			this.addBody(i);
			cx_ite = cx_ite.next;
		}
		var cx_ite = x.constraints.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			this.addConstraint(i);
			cx_ite = cx_ite.next;
		}
		var cx_ite = x.compounds.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			this.addCompound(i);
			cx_ite = cx_ite.next;
		}
	}
	,remConstraint: function(con) {
		if(con.active) {
			this.wake_constraint(con,true);
			this.live_constraints.remove(con);
		}
		con.removedFromSpace();
		con.space = null;
	}
	,addConstraint: function(con) {
		con.space = this;
		con.addedToSpace();
		if(con.active) {
			con.component.sleeping = true;
			this.wake_constraint(con,true);
		}
	}
	,removed_shape: function(s,deleting) {
		if(deleting == null) deleting = false;
		var _g = this;
		var body = s.body;
		if(!deleting) body.wake();
		var pre = null;
		var cx_ite = body.arbiters.begin();
		while(cx_ite != null) {
			var xarb = [cx_ite.elem()];
			var rem = xarb[0].ws1 == s || xarb[0].ws2 == s;
			if(rem) {
				if(xarb[0].present != 0) {
					this.MRCA_chains(xarb[0].ws1,xarb[0].ws2);
					var cx_ite1 = this.mrca1.begin();
					while(cx_ite1 != null) {
						var i1 = cx_ite1.elem();
						var cx_ite2 = this.mrca2.begin();
						while(cx_ite2 != null) {
							var i2 = cx_ite2.elem();
							var cb1 = i1.cbSet;
							var cb2 = i2.cbSet;
							cb1.validate();
							cb2.validate();
							if(zpp_nape.callbacks.ZPP_CbSet.empty_intersection(cb1,cb2)) {
								cx_ite2 = cx_ite2.next;
								continue;
							}
							var callbackset = [zpp_nape.phys.ZPP_Interactor.get(i1,i2)];
							callbackset[0].remove_arb(xarb[0]);
							xarb[0].present--;
							zpp_nape.callbacks.ZPP_CbSet.find_all(cb1,cb2,zpp_nape.util.ZPP_Flags.id_CbEvent_END,(function(callbackset,xarb) {
								return function(listener) {
									if((listener.itype & xarb[0].type) != 0 && callbackset[0].empty_arb(listener.itype)) {
										var cb = _g.push_callback(listener);
										cb.event = zpp_nape.util.ZPP_Flags.id_CbEvent_END;
										zpp_nape.phys.ZPP_Interactor.int_callback(callbackset[0],listener,cb);
										cb.set = callbackset[0];
									}
								};
							})(callbackset,xarb));
							if(callbackset[0].really_empty()) this.remove_callbackset(callbackset[0]);
							cx_ite2 = cx_ite2.next;
						}
						cx_ite1 = cx_ite1.next;
					}
				}
				if(xarb[0].b1 != body && xarb[0].b1.isDynamic()) {
					var o = xarb[0].b1;
					if(!o.world) {
						o.component.waket = this.stamp + (this.midstep?0:1);
						if(o.isKinematic()) o.kinematicDelaySleep = true;
						if(o.component.sleeping) this.really_wake(o,false);
					}
				}
				if(xarb[0].b2 != body && xarb[0].b2.isDynamic()) {
					var o = xarb[0].b2;
					if(!o.world) {
						o.component.waket = this.stamp + (this.midstep?0:1);
						if(o.isKinematic()) o.kinematicDelaySleep = true;
						if(o.component.sleeping) this.really_wake(o,false);
					}
				}
				xarb[0].lazyRetire(this,body);
				cx_ite = body.arbiters.erase(pre);
				continue;
			}
			pre = cx_ite;
			cx_ite = cx_ite.next;
		}
		this.bphase.remove(s);
		s.removedFromSpace();
	}
	,added_shape: function(s,dontwake) {
		if(dontwake == null) dontwake = false;
		if(!dontwake) {
			var o = s.body;
			if(!o.world) {
				o.component.waket = this.stamp + (this.midstep?0:1);
				if(o.isKinematic()) o.kinematicDelaySleep = true;
				if(o.component.sleeping) this.really_wake(o,false);
			}
		}
		this.bphase.insert(s);
		s.addedToSpace();
	}
	,transmitType: function(p,new_type) {
		var o = p;
		if(!o.world) {
			o.component.waket = this.stamp + (this.midstep?0:1);
			if(o.isKinematic()) o.kinematicDelaySleep = true;
			if(o.component.sleeping) this.really_wake(o,false);
		}
		if(p.type == zpp_nape.util.ZPP_Flags.id_BodyType_DYNAMIC) this.live.remove(p); else if(p.type == zpp_nape.util.ZPP_Flags.id_BodyType_KINEMATIC) {
			this.kinematics.remove(p);
			this.staticsleep.remove(p);
		} else if(p.type == zpp_nape.util.ZPP_Flags.id_BodyType_STATIC) this.staticsleep.remove(p);
		p.type = new_type;
		if(p.type == zpp_nape.util.ZPP_Flags.id_BodyType_KINEMATIC) this.kinematics.add(p);
		if(p.type == zpp_nape.util.ZPP_Flags.id_BodyType_STATIC) this.static_validation(p);
		p.component.sleeping = true;
		var o = p;
		if(!o.world) {
			o.component.waket = this.stamp + (this.midstep?0:1);
			if(o.isKinematic()) o.kinematicDelaySleep = true;
			if(o.component.sleeping) this.really_wake(o,true);
		}
	}
	,remove_callbackset: function(cb) {
		cb.lazydel = true;
		cb.int1.cbsets.inlined_remove(cb);
		cb.int2.cbsets.inlined_remove(cb);
	}
	,add_callbackset: function(cb) {
		cb.int1.cbsets.inlined_add(cb);
		cb.int2.cbsets.inlined_add(cb);
		this.callbackset_list.inlined_add(cb);
	}
	,remListener: function(x) {
		if(x.interaction != null) this.revoke_listener(x.interaction);
		x.removedFromSpace();
		x.space = null;
	}
	,addListener: function(x) {
		x.space = this;
		x.addedToSpace();
		if(x.interaction != null) this.unrevoke_listener(x.interaction);
	}
	,unrevoke_listener: function(x) {
	}
	,revoke_listener: function(x) {
	}
	,listeners_modifiable: function() {
		if(this.midstep) throw "Error: Space::listeners cannot be set during space step()";
	}
	,listeners_subber: function(x) {
		this.remListener(x.zpp_inner);
	}
	,listeners_adder: function(x) {
		if(x.zpp_inner.space != this) {
			if(x.zpp_inner.space != null) x.zpp_inner.space.outer.get_listeners().remove(x);
			this.addListener(x.zpp_inner);
			return true;
		} else return false;
	}
	,constraints_modifiable: function() {
		if(this.midstep) throw "Error: Space::constraints cannot be set during space step()";
	}
	,constraints_subber: function(x) {
		this.remConstraint(x.zpp_inner);
	}
	,constraints_adder: function(x) {
		if(x.zpp_inner.compound != null) throw "Error: Cannot set the space of a Constraint belonging to a Compound, only the root Compound space can be set";
		if(x.zpp_inner.space != this) {
			if(x.zpp_inner.space != null) x.zpp_inner.space.outer.get_constraints().remove(x);
			this.addConstraint(x.zpp_inner);
			return true;
		} else return false;
	}
	,compounds_modifiable: function() {
		if(this.midstep) throw "Error: Space::compounds cannot be set during space step()";
	}
	,compounds_subber: function(x) {
		this.remCompound(x.zpp_inner);
	}
	,compounds_adder: function(x) {
		if(x.zpp_inner.compound != null) throw "Error: Cannot set the space of an inner Compound, only the root Compound space can be set";
		if(x.zpp_inner.space != this) {
			if(x.zpp_inner.space != null) x.zpp_inner.space.wrap_compounds.remove(x);
			this.addCompound(x.zpp_inner);
			return true;
		} else return false;
	}
	,bodies_modifiable: function() {
		if(this.midstep) throw "Error: Space::bodies cannot be set during space step()";
	}
	,bodies_subber: function(x) {
		this.remBody(x.zpp_inner);
	}
	,bodies_adder: function(x) {
		if(x.zpp_inner.compound != null) throw "Error: Cannot set the space of a Body belonging to a Compound, only the root Compound space can be set";
		if(x.zpp_inner.space != this) {
			if(x.zpp_inner.space != null) x.zpp_inner.space.outer.get_bodies().remove(x);
			this.addBody(x.zpp_inner);
			return true;
		} else return false;
	}
	,gravity_validate: function() {
		this.wrap_gravity.zpp_inner.x = this.gravityx;
		this.wrap_gravity.zpp_inner.y = this.gravityy;
	}
	,gravity_invalidate: function(x) {
		if(this.midstep) throw "Error: Space::gravity cannot be set during space step";
		this.gravityx = x.x;
		this.gravityy = x.y;
		var stack = new zpp_nape.util.ZNPList_ZPP_Compound();
		var cx_ite = this.bodies.begin();
		while(cx_ite != null) {
			var x1 = cx_ite.elem();
			var o = x1;
			if(!o.world) {
				o.component.waket = this.stamp + (this.midstep?0:1);
				if(o.isKinematic()) o.kinematicDelaySleep = true;
				if(o.component.sleeping) this.really_wake(o,false);
			}
			cx_ite = cx_ite.next;
		}
		var cx_ite = this.compounds.begin();
		while(cx_ite != null) {
			var i = cx_ite.elem();
			stack.add(i);
			cx_ite = cx_ite.next;
		}
		while(!stack.empty()) {
			var s = stack.pop_unsafe();
			var cx_ite = s.bodies.begin();
			while(cx_ite != null) {
				var x1 = cx_ite.elem();
				var o = x1;
				if(!o.world) {
					o.component.waket = this.stamp + (this.midstep?0:1);
					if(o.isKinematic()) o.kinematicDelaySleep = true;
					if(o.component.sleeping) this.really_wake(o,false);
				}
				cx_ite = cx_ite.next;
			}
			var cx_ite = s.compounds.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				stack.add(i);
				cx_ite = cx_ite.next;
			}
		}
	}
	,getgravity: function() {
		this.wrap_gravity = nape.geom.Vec2.get(this.gravityx,this.gravityy);
		this.wrap_gravity.zpp_inner._inuse = true;
		this.wrap_gravity.zpp_inner._invalidate = $bind(this,this.gravity_invalidate);
		this.wrap_gravity.zpp_inner._validate = $bind(this,this.gravity_validate);
	}
	,__class__: zpp_nape.space.ZPP_Space
}
zpp_nape.space.ZPP_SweepData = function() {
	this.aabb = null;
	this.shape = null;
	this.prev = null;
	this.next = null;
};
$hxClasses["zpp_nape.space.ZPP_SweepData"] = zpp_nape.space.ZPP_SweepData;
zpp_nape.space.ZPP_SweepData.__name__ = ["zpp_nape","space","ZPP_SweepData"];
zpp_nape.space.ZPP_SweepData.prototype = {
	gt: function(x) {
		return this.aabb.minx > x.aabb.minx;
	}
	,alloc: function() {
	}
	,free: function() {
		this.prev = null;
		this.shape = null;
		this.aabb = null;
	}
	,__class__: zpp_nape.space.ZPP_SweepData
}
zpp_nape.space.ZPP_SweepPhase = function(space) {
	this.failed = null;
	this.list = null;
	this.space = space;
	this.is_sweep = true;
	this.sweep = this;
};
$hxClasses["zpp_nape.space.ZPP_SweepPhase"] = zpp_nape.space.ZPP_SweepPhase;
zpp_nape.space.ZPP_SweepPhase.__name__ = ["zpp_nape","space","ZPP_SweepPhase"];
zpp_nape.space.ZPP_SweepPhase.__super__ = zpp_nape.space.ZPP_Broadphase;
zpp_nape.space.ZPP_SweepPhase.prototype = $extend(zpp_nape.space.ZPP_Broadphase.prototype,{
	rayMultiCast: function(ray,inner,filter,output) {
		this.sync_broadphase();
		ray.validate_dir();
		var rayab = ray.rayAABB();
		var ret = output == null?new nape.geom.RayResultList():output;
		if(ray.dirx == 0) {
			var a = this.list;
			while(a != null && a.aabb.minx <= rayab.minx) {
				if(a.aabb.intersect(rayab) && (filter == null || a.shape.filter.shouldCollide(filter))) {
					var t = ray.aabbsect(a.aabb);
					if(t >= 0) {
						if(a.shape.isCircle()) ray.circlesect2(a.shape.circle,inner,ret); else ray.polysect2(a.shape.polygon,inner,ret);
					}
				}
				a = a.next;
			}
		} else if(ray.dirx < 0) {
			var a = this.list;
			var b = null;
			while(a != null && a.aabb.minx <= rayab.maxx) {
				b = a;
				a = a.next;
			}
			a = b;
			while(a != null) {
				if(a.aabb.intersect(rayab) && (filter == null || a.shape.filter.shouldCollide(filter))) {
					var t = ray.aabbsect(a.aabb);
					if(t >= 0) {
						if(a.shape.isCircle()) ray.circlesect2(a.shape.circle,inner,ret); else ray.polysect2(a.shape.polygon,inner,ret);
					}
				}
				a = a.prev;
			}
		} else {
			var a = this.list;
			while(a != null && a.aabb.minx <= rayab.maxx) {
				if(a.aabb.intersect(rayab) && (filter == null || a.shape.filter.shouldCollide(filter))) {
					var t = ray.aabbsect(a.aabb);
					if(t >= 0) {
						if(a.shape.isCircle()) ray.circlesect2(a.shape.circle,inner,ret); else ray.polysect2(a.shape.polygon,inner,ret);
					}
				}
				a = a.next;
			}
		}
		var o = rayab;
		o.free();
		o.next = zpp_nape.geom.ZPP_AABB.zpp_pool;
		zpp_nape.geom.ZPP_AABB.zpp_pool = o;
		return ret;
	}
	,rayCast: function(ray,inner,filter) {
		this.sync_broadphase();
		ray.validate_dir();
		var rayab = ray.rayAABB();
		var mint = ray.maxdist;
		var minres = null;
		if(ray.dirx == 0) {
			var a = this.list;
			while(a != null && a.aabb.minx <= rayab.minx) {
				if(a.aabb.intersect(rayab) && (filter == null || a.shape.filter.shouldCollide(filter))) {
					var t = ray.aabbsect(a.aabb);
					if(t >= 0 && t < mint) {
						var result = a.shape.isCircle()?ray.circlesect(a.shape.circle,inner,mint):ray.polysect(a.shape.polygon,inner,mint);
						if(result != null) {
							mint = result.get_distance();
							if(minres != null) minres.dispose();
							minres = result;
						}
					}
				}
				a = a.next;
			}
		} else if(ray.dirx < 0) {
			var a = this.list;
			var b = null;
			while(a != null && a.aabb.minx <= rayab.maxx) {
				b = a;
				a = a.next;
			}
			a = b;
			while(a != null) {
				if(a.aabb.intersect(rayab) && (filter == null || a.shape.filter.shouldCollide(filter))) {
					var t = ray.aabbsect(a.aabb);
					if(t >= 0 && t < mint) {
						var result = a.shape.isCircle()?ray.circlesect(a.shape.circle,inner,mint):ray.polysect(a.shape.polygon,inner,mint);
						if(result != null) {
							mint = result.get_distance();
							if(minres != null) minres.dispose();
							minres = result;
						}
					}
				}
				a = a.prev;
			}
		} else {
			var a = this.list;
			while(a != null && a.aabb.minx <= rayab.maxx && a.aabb.minx < ray.originx + ray.dirx * mint) {
				if(a.aabb.intersect(rayab) && (filter == null || a.shape.filter.shouldCollide(filter))) {
					var t = ray.aabbsect(a.aabb);
					if(t >= 0 && t < mint) {
						var result = a.shape.isCircle()?ray.circlesect(a.shape.circle,inner,mint):ray.polysect(a.shape.polygon,inner,mint);
						if(result != null) {
							mint = result.get_distance();
							if(minres != null) minres.dispose();
							minres = result;
						}
					}
				}
				a = a.next;
			}
		}
		var o = rayab;
		o.free();
		o.next = zpp_nape.geom.ZPP_AABB.zpp_pool;
		zpp_nape.geom.ZPP_AABB.zpp_pool = o;
		return minres;
	}
	,bodiesInShape: function(shape,containment,filter,output) {
		this.sync_broadphase();
		this.validateShape(shape);
		var ab = shape.aabb;
		var ret = output == null?new nape.phys.BodyList():output;
		if(this.failed == null) this.failed = new nape.phys.BodyList();
		var a = this.list;
		while(a != null && a.aabb.maxx < ab.minx) a = a.next;
		while(a != null && a.aabb.minx <= ab.maxx) {
			if(a.aabb.intersect(ab)) {
				var shape2 = a.shape;
				var body = shape2.body.outer;
				if(filter == null || shape2.filter.shouldCollide(filter)) {
					if(containment) {
						if(!this.failed.has(body)) {
							var col = zpp_nape.geom.ZPP_Collide.containTest(shape,shape2);
							if(!ret.has(body) && col) ret.push(body); else if(!col) {
								ret.remove(body);
								this.failed.push(body);
							}
						}
					} else if(!ret.has(body) && zpp_nape.geom.ZPP_Collide.testCollide_safe(shape,shape2)) ret.push(body);
				}
			}
			a = a.next;
		}
		this.failed.clear();
		return ret;
	}
	,shapesInShape: function(shape,containment,filter,output) {
		this.sync_broadphase();
		this.validateShape(shape);
		var ab = shape.aabb;
		var ret = output == null?new nape.shape.ShapeList():output;
		var a = this.list;
		while(a != null && a.aabb.maxx < ab.minx) a = a.next;
		while(a != null && a.aabb.minx <= ab.maxx) {
			if(a.aabb.intersect(ab)) {
				var shape2 = a.shape;
				if(filter == null || shape2.filter.shouldCollide(filter)) {
					if(containment) {
						if(zpp_nape.geom.ZPP_Collide.containTest(shape,shape2)) ret.push(shape2.outer);
					} else if(zpp_nape.geom.ZPP_Collide.testCollide_safe(shape2,shape)) ret.push(shape2.outer);
				}
			}
			a = a.next;
		}
		return ret;
	}
	,bodiesInCircle: function(x,y,r,containment,filter,output) {
		this.sync_broadphase();
		this.updateCircShape(x,y,r);
		var ab = this.circShape.zpp_inner.aabb;
		var ret = output == null?new nape.phys.BodyList():output;
		if(this.failed == null) this.failed = new nape.phys.BodyList();
		var a = this.list;
		while(a != null && a.aabb.maxx < ab.minx) a = a.next;
		while(a != null && a.aabb.minx <= ab.maxx) {
			if(a.aabb.intersect(ab)) {
				var shape = a.shape;
				var body = shape.body.outer;
				if(filter == null || shape.filter.shouldCollide(filter)) {
					if(containment) {
						if(!this.failed.has(body)) {
							var col = zpp_nape.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,shape);
							if(!ret.has(body) && col) ret.push(body); else if(!col) {
								ret.remove(body);
								this.failed.push(body);
							}
						}
					} else if(!ret.has(body) && zpp_nape.geom.ZPP_Collide.testCollide_safe(shape,this.circShape.zpp_inner)) ret.push(body);
				}
			}
			a = a.next;
		}
		this.failed.clear();
		return ret;
	}
	,shapesInCircle: function(x,y,r,containment,filter,output) {
		this.sync_broadphase();
		this.updateCircShape(x,y,r);
		var ab = this.circShape.zpp_inner.aabb;
		var ret = output == null?new nape.shape.ShapeList():output;
		var a = this.list;
		while(a != null && a.aabb.maxx < ab.minx) a = a.next;
		while(a != null && a.aabb.minx <= ab.maxx) {
			if(a.aabb.intersect(ab)) {
				var shape = a.shape;
				if(filter == null || shape.filter.shouldCollide(filter)) {
					if(containment) {
						if(zpp_nape.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,shape)) ret.push(shape.outer);
					} else if(zpp_nape.geom.ZPP_Collide.testCollide_safe(shape,this.circShape.zpp_inner)) ret.push(shape.outer);
				}
			}
			a = a.next;
		}
		return ret;
	}
	,bodiesInAABB: function(aabb,strict,containment,filter,output) {
		this.sync_broadphase();
		this.updateAABBShape(aabb);
		var ab = this.aabbShape.zpp_inner.aabb;
		var ret = output == null?new nape.phys.BodyList():output;
		if(this.failed == null) this.failed = new nape.phys.BodyList();
		var a = this.list;
		while(a != null && a.aabb.maxx < ab.minx) a = a.next;
		while(a != null && a.aabb.minx <= ab.maxx) {
			var shape = a.shape;
			var body = shape.body.outer;
			if(a.aabb.intersect(ab)) {
				if(filter == null || shape.filter.shouldCollide(filter)) {
					if(strict) {
						if(containment) {
							if(!this.failed.has(body)) {
								var col = zpp_nape.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,shape);
								if(!ret.has(body) && col) ret.push(body); else if(!col) {
									ret.remove(body);
									this.failed.push(body);
								}
							}
						} else if(!ret.has(body) && zpp_nape.geom.ZPP_Collide.testCollide_safe(shape,this.aabbShape.zpp_inner)) ret.push(body);
					} else if(containment) {
						if(!this.failed.has(body)) {
							var col = ab.contains(shape.aabb);
							if(!ret.has(body) && col) ret.push(body); else if(!col) {
								ret.remove(body);
								this.failed.push(body);
							}
						}
					} else if(!ret.has(body) && ab.contains(shape.aabb)) ret.push(body);
				}
			}
			a = a.next;
		}
		this.failed.clear();
		return ret;
	}
	,shapesInAABB: function(aabb,strict,containment,filter,output) {
		this.sync_broadphase();
		this.updateAABBShape(aabb);
		var ab = this.aabbShape.zpp_inner.aabb;
		var ret = output == null?new nape.shape.ShapeList():output;
		var a = this.list;
		while(a != null && a.aabb.maxx < ab.minx) a = a.next;
		while(a != null && a.aabb.minx <= ab.maxx) {
			var shape = a.shape;
			if(filter == null || shape.filter.shouldCollide(filter)) {
				if(strict) {
					if(containment) {
						if(zpp_nape.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,shape)) ret.push(shape.outer);
					} else if(ab.contains(a.aabb)) ret.push(shape.outer); else if(a.aabb.intersect(ab)) {
						if(zpp_nape.geom.ZPP_Collide.testCollide_safe(shape,this.aabbShape.zpp_inner)) ret.push(shape.outer);
					}
				} else if(containment?ab.contains(a.aabb):a.aabb.intersect(ab)) ret.push(shape.outer);
			}
			a = a.next;
		}
		return ret;
	}
	,bodiesUnderPoint: function(x,y,filter,output) {
		this.sync_broadphase();
		var v = zpp_nape.geom.ZPP_Vec2.get(x,y);
		var ret = output == null?new nape.phys.BodyList():output;
		var a = this.list;
		while(a != null && a.aabb.minx > x) a = a.next;
		while(a != null && a.aabb.minx <= x) {
			if(a.aabb.maxx >= x && a.aabb.miny <= y && a.aabb.maxy >= y) {
				var shape = a.shape;
				var body = shape.body.outer;
				if(!ret.has(body)) {
					if(filter == null || shape.filter.shouldCollide(filter)) {
						if(shape.isCircle()) {
							if(zpp_nape.geom.ZPP_Collide.circleContains(shape.circle,v)) ret.push(body);
						} else if(zpp_nape.geom.ZPP_Collide.polyContains(shape.polygon,v)) ret.push(body);
					}
				}
			}
			a = a.next;
		}
		var o = v;
		o.free();
		o.next = zpp_nape.geom.ZPP_Vec2.zpp_pool;
		zpp_nape.geom.ZPP_Vec2.zpp_pool = o;
		return ret;
	}
	,shapesUnderPoint: function(x,y,filter,output) {
		this.sync_broadphase();
		var v = zpp_nape.geom.ZPP_Vec2.get(x,y);
		var ret = output == null?new nape.shape.ShapeList():output;
		var a = this.list;
		while(a != null && a.aabb.minx > x) a = a.next;
		while(a != null && a.aabb.minx <= x) {
			if(a.aabb.maxx >= x && a.aabb.miny <= y && a.aabb.maxy >= y) {
				var shape = a.shape;
				if(filter == null || shape.filter.shouldCollide(filter)) {
					if(shape.isCircle()) {
						if(zpp_nape.geom.ZPP_Collide.circleContains(shape.circle,v)) ret.push(shape.outer);
					} else if(zpp_nape.geom.ZPP_Collide.polyContains(shape.polygon,v)) ret.push(shape.outer);
				}
			}
			a = a.next;
		}
		var o = v;
		o.free();
		o.next = zpp_nape.geom.ZPP_Vec2.zpp_pool;
		zpp_nape.geom.ZPP_Vec2.zpp_pool = o;
		return ret;
	}
	,clear: function() {
		while(this.list != null) {
			this.list.shape.removedFromSpace();
			this.__remove(this.list.shape);
		}
	}
	,broadphase: function(space,discrete) {
		if(this.list != null) {
			this.sync_broadphase_fast();
			var d1 = this.list;
			while(d1 != null) {
				var d2 = d1.next;
				var s1 = d1.shape;
				var b1 = s1.body;
				var bottom = d1.aabb.maxx;
				while(d2 != null) {
					if(d2.aabb.minx > bottom) break;
					var s2 = d2.shape;
					var b2 = s2.body;
					if(b2 == b1) {
						d2 = d2.next;
						continue;
					}
					if(b1.isStatic() && b2.isStatic()) {
						d2 = d2.next;
						continue;
					}
					if(b1.component.sleeping && b2.component.sleeping) {
						d2 = d2.next;
						continue;
					}
					if(s1.aabb.intersectY(s2.aabb)) {
						if(discrete) space.narrowPhase(s1,s2,!b1.isDynamic() || !b2.isDynamic(),null,false); else space.continuousEvent(s1,s2,!b1.isDynamic() || !b2.isDynamic(),null,false);
					}
					d2 = d2.next;
				}
				d1 = d1.next;
			}
		}
	}
	,sync_broadphase_fast: function() {
		var a = this.list.next;
		while(a != null) {
			var n = a.next;
			var b = a.prev;
			if(a.gt(b)) {
				a = n;
				continue;
			}
			while(b.prev != null && b.prev.gt(a)) b = b.prev;
			var prev = a.prev;
			prev.next = a.next;
			if(a.next != null) a.next.prev = prev;
			if(b.prev == null) {
				a.prev = null;
				this.list = a;
				a.next = b;
				b.prev = a;
			} else {
				a.prev = b.prev;
				b.prev = a;
				a.prev.next = a;
				a.next = b;
			}
			a = n;
		}
	}
	,sync_broadphase: function() {
		this.space.validation();
		if(this.list != null) this.sync_broadphase_fast();
	}
	,__sync: function(shape) {
		if(!this.space.continuous) shape.validate_aabb();
	}
	,__remove: function(shape) {
		var dat = shape.sweep;
		if(dat.prev == null) this.list = dat.next; else dat.prev.next = dat.next;
		if(dat.next != null) dat.next.prev = dat.prev;
		shape.sweep = null;
		var o = dat;
		o.free();
		o.next = zpp_nape.space.ZPP_SweepData.zpp_pool;
		zpp_nape.space.ZPP_SweepData.zpp_pool = o;
	}
	,__insert: function(shape) {
		var dat;
		if(zpp_nape.space.ZPP_SweepData.zpp_pool == null) dat = new zpp_nape.space.ZPP_SweepData(); else {
			dat = zpp_nape.space.ZPP_SweepData.zpp_pool;
			zpp_nape.space.ZPP_SweepData.zpp_pool = dat.next;
			dat.next = null;
		}
		dat.alloc();
		shape.sweep = dat;
		dat.shape = shape;
		dat.aabb = shape.aabb;
		dat.next = this.list;
		if(this.list != null) this.list.prev = dat;
		this.list = dat;
	}
	,__class__: zpp_nape.space.ZPP_SweepPhase
});
zpp_nape.util.ZPP_Flags = function() { }
$hxClasses["zpp_nape.util.ZPP_Flags"] = zpp_nape.util.ZPP_Flags;
zpp_nape.util.ZPP_Flags.__name__ = ["zpp_nape","util","ZPP_Flags"];
zpp_nape.util.ZNPList_ZPP_Shape = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Shape"] = zpp_nape.util.ZNPList_ZPP_Shape;
zpp_nape.util.ZNPList_ZPP_Shape.__name__ = ["zpp_nape","util","ZNPList_ZPP_Shape"];
zpp_nape.util.ZNPList_ZPP_Shape.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Shape.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Shape.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Shape.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Shape(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Shape.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Shape.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Shape.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Shape(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Shape.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Shape.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Shape
}
zpp_nape.util.ZNPList_ZPP_CallbackSet = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_CallbackSet"] = zpp_nape.util.ZNPList_ZPP_CallbackSet;
zpp_nape.util.ZNPList_ZPP_CallbackSet.__name__ = ["zpp_nape","util","ZNPList_ZPP_CallbackSet"];
zpp_nape.util.ZNPList_ZPP_CallbackSet.prototype = {
	empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_CallbackSet.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_CallbackSet.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,inlined_remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_CallbackSet.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_CallbackSet(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_CallbackSet.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_CallbackSet.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_CallbackSet
}
zpp_nape.util.ZNPList_ZPP_Arbiter = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Arbiter"] = zpp_nape.util.ZNPList_ZPP_Arbiter;
zpp_nape.util.ZNPList_ZPP_Arbiter.__name__ = ["zpp_nape","util","ZNPList_ZPP_Arbiter"];
zpp_nape.util.ZNPList_ZPP_Arbiter.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,inlined_has: function(obj) {
		var ret;
		ret = false;
		var cx_ite = this.begin();
		while(cx_ite != null) {
			var npite = cx_ite.elem();
			if(npite == obj) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		return ret;
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,erase: function(pre) {
		return this.inlined_erase(pre);
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,inlined_remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Arbiter(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Arbiter(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Arbiter.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Arbiter
}
zpp_nape.util.ZNPList_ZPP_Body = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Body"] = zpp_nape.util.ZNPList_ZPP_Body;
zpp_nape.util.ZNPList_ZPP_Body.__name__ = ["zpp_nape","util","ZNPList_ZPP_Body"];
zpp_nape.util.ZNPList_ZPP_Body.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,inlined_has: function(obj) {
		var ret;
		ret = false;
		var cx_ite = this.begin();
		while(cx_ite != null) {
			var npite = cx_ite.elem();
			if(npite == obj) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		return ret;
	}
	,has: function(obj) {
		return this.inlined_has(obj);
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,erase: function(pre) {
		return this.inlined_erase(pre);
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Body(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Body(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Body.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Body
}
zpp_nape.util.ZNPList_ZPP_Compound = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Compound"] = zpp_nape.util.ZNPList_ZPP_Compound;
zpp_nape.util.ZNPList_ZPP_Compound.__name__ = ["zpp_nape","util","ZNPList_ZPP_Compound"];
zpp_nape.util.ZNPList_ZPP_Compound.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Compound(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Compound(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Compound.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Compound
}
zpp_nape.util.ZNPList_ZPP_CbSetPair = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_CbSetPair"] = zpp_nape.util.ZNPList_ZPP_CbSetPair;
zpp_nape.util.ZNPList_ZPP_CbSetPair.__name__ = ["zpp_nape","util","ZNPList_ZPP_CbSetPair"];
zpp_nape.util.ZNPList_ZPP_CbSetPair.prototype = {
	front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_CbSetPair.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_CbSetPair.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_CbSetPair.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_CbSetPair.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_CbSetPair.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_CbSetPair(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_CbSetPair.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_CbSetPair.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_CbSetPair
}
zpp_nape.util.ZNPList_ZPP_AABBPair = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_AABBPair"] = zpp_nape.util.ZNPList_ZPP_AABBPair;
zpp_nape.util.ZNPList_ZPP_AABBPair.__name__ = ["zpp_nape","util","ZNPList_ZPP_AABBPair"];
zpp_nape.util.ZNPList_ZPP_AABBPair.prototype = {
	front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_AABBPair.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_AABBPair.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,inlined_remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_AABBPair.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_AABBPair.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_AABBPair.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_AABBPair(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_AABBPair.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_AABBPair.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_AABBPair
}
zpp_nape.util.ZNPList_ZPP_Edge = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Edge"] = zpp_nape.util.ZNPList_ZPP_Edge;
zpp_nape.util.ZNPList_ZPP_Edge.__name__ = ["zpp_nape","util","ZNPList_ZPP_Edge"];
zpp_nape.util.ZNPList_ZPP_Edge.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,reverse: function() {
		var cur = this.begin();
		var pre = null;
		while(cur != null) {
			var nx = cur.next;
			cur.next = pre;
			this.head = cur;
			pre = cur;
			cur = nx;
		}
		this.modified = true;
		this.pushmod = true;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,erase: function(pre) {
		return this.inlined_erase(pre);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Edge(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Edge(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Edge.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Edge
}
zpp_nape.util.ZNPList_ZPP_AABBNode = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_AABBNode"] = zpp_nape.util.ZNPList_ZPP_AABBNode;
zpp_nape.util.ZNPList_ZPP_AABBNode.__name__ = ["zpp_nape","util","ZNPList_ZPP_AABBNode"];
zpp_nape.util.ZNPList_ZPP_AABBNode.prototype = {
	front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_clear: function() {
		if(true) {
			while(!this.empty()) this.inlined_pop();
			this.pushmod = true;
		}
	}
	,clear: function() {
		this.inlined_clear();
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_AABBNode.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_AABBNode.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_AABBNode.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_AABBNode(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_AABBNode.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_AABBNode.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_AABBNode.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_AABBNode(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_AABBNode.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_AABBNode.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_AABBNode
}
zpp_nape.util.ZNPList_ZPP_Component = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Component"] = zpp_nape.util.ZNPList_ZPP_Component;
zpp_nape.util.ZNPList_ZPP_Component.__name__ = ["zpp_nape","util","ZNPList_ZPP_Component"];
zpp_nape.util.ZNPList_ZPP_Component.prototype = {
	front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Component.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Component.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Component.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Component(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Component.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Component.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Component
}
zpp_nape.util.ZNPList_ZPP_InteractionGroup = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_InteractionGroup"] = zpp_nape.util.ZNPList_ZPP_InteractionGroup;
zpp_nape.util.ZNPList_ZPP_InteractionGroup.__name__ = ["zpp_nape","util","ZNPList_ZPP_InteractionGroup"];
zpp_nape.util.ZNPList_ZPP_InteractionGroup.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_InteractionGroup.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_InteractionGroup.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_InteractionGroup.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_InteractionGroup(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_InteractionGroup.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_InteractionGroup.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_InteractionGroup
}
zpp_nape.util.ZNPList_ZPP_ColArbiter = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_ColArbiter"] = zpp_nape.util.ZNPList_ZPP_ColArbiter;
zpp_nape.util.ZNPList_ZPP_ColArbiter.__name__ = ["zpp_nape","util","ZNPList_ZPP_ColArbiter"];
zpp_nape.util.ZNPList_ZPP_ColArbiter.prototype = {
	empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_ColArbiter.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_ColArbiter.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_ColArbiter.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_ColArbiter(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_ColArbiter.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_ColArbiter.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,setbegin: function(i) {
		this.head = i;
		this.modified = true;
		this.pushmod = true;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_ColArbiter
}
zpp_nape.util.ZNPList_ZPP_FluidArbiter = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_FluidArbiter"] = zpp_nape.util.ZNPList_ZPP_FluidArbiter;
zpp_nape.util.ZNPList_ZPP_FluidArbiter.__name__ = ["zpp_nape","util","ZNPList_ZPP_FluidArbiter"];
zpp_nape.util.ZNPList_ZPP_FluidArbiter.prototype = {
	empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_FluidArbiter.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_FluidArbiter.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_FluidArbiter.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_FluidArbiter(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_FluidArbiter.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_FluidArbiter.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_FluidArbiter
}
zpp_nape.util.ZNPList_ZPP_SensorArbiter = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_SensorArbiter"] = zpp_nape.util.ZNPList_ZPP_SensorArbiter;
zpp_nape.util.ZNPList_ZPP_SensorArbiter.__name__ = ["zpp_nape","util","ZNPList_ZPP_SensorArbiter"];
zpp_nape.util.ZNPList_ZPP_SensorArbiter.prototype = {
	empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_SensorArbiter.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_SensorArbiter.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_SensorArbiter.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_SensorArbiter(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_SensorArbiter.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_SensorArbiter.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_SensorArbiter
}
zpp_nape.util.ZNPList_ZPP_Listener = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_Listener"] = zpp_nape.util.ZNPList_ZPP_Listener;
zpp_nape.util.ZNPList_ZPP_Listener.__name__ = ["zpp_nape","util","ZNPList_ZPP_Listener"];
zpp_nape.util.ZNPList_ZPP_Listener.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_Listener.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_Listener.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,inlined_try_remove: function(obj) {
		var pre = null;
		var cur = this.begin();
		var ret = false;
		while(cur != null) {
			if(cur.elem() == obj) {
				this.inlined_erase(pre);
				ret = true;
				break;
			}
			pre = cur;
			cur = cur.next;
		}
		return ret;
	}
	,remove: function(obj) {
		this.inlined_try_remove(obj);
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Listener.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Listener(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Listener.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Listener.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,insert: function(cur,o) {
		return this.inlined_insert(cur,o);
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_Listener.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_Listener(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_Listener.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_Listener.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_Listener
}
zpp_nape.util.ZNPList_ZPP_ToiEvent = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_ToiEvent"] = zpp_nape.util.ZNPList_ZPP_ToiEvent;
zpp_nape.util.ZNPList_ZPP_ToiEvent.__name__ = ["zpp_nape","util","ZNPList_ZPP_ToiEvent"];
zpp_nape.util.ZNPList_ZPP_ToiEvent.prototype = {
	front: function() {
		return this.begin().elem();
	}
	,empty: function() {
		return this.begin() == null;
	}
	,inlined_erase: function(pre) {
		var old;
		var ret;
		if(pre == null) {
			old = this.begin();
			ret = old.next;
			this.head = ret;
			if(this.empty()) this.pushmod = true;
		} else {
			old = pre.next;
			ret = old.next;
			pre.next = ret;
			if(ret == null) this.pushmod = true;
		}
		var o = old;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_ToiEvent.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_ToiEvent.zpp_pool = o;
		this.modified = true;
		this.length--;
		this.pushmod = true;
		return ret;
	}
	,erase: function(pre) {
		return this.inlined_erase(pre);
	}
	,inlined_pop_unsafe: function() {
		var ret = this.front();
		this.pop();
		return ret;
	}
	,pop_unsafe: function() {
		return this.inlined_pop_unsafe();
	}
	,inlined_pop: function() {
		var ret = this.begin();
		this.head = ret.next;
		var o = ret;
		o.free();
		o.next = zpp_nape.util.ZNPNode_ZPP_ToiEvent.zpp_pool;
		zpp_nape.util.ZNPNode_ZPP_ToiEvent.zpp_pool = o;
		if(this.empty()) this.pushmod = true;
		this.modified = true;
		this.length--;
	}
	,pop: function() {
		this.inlined_pop();
	}
	,inlined_add: function(o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_ZPP_ToiEvent.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_ZPP_ToiEvent(); else {
					ret = zpp_nape.util.ZNPNode_ZPP_ToiEvent.zpp_pool;
					zpp_nape.util.ZNPNode_ZPP_ToiEvent.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		temp.next = this.begin();
		this.head = temp;
		this.modified = true;
		this.length++;
		return o;
	}
	,add: function(o) {
		return this.inlined_add(o);
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_ToiEvent
}
zpp_nape.util.ZNPList_ConvexResult = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ConvexResult"] = zpp_nape.util.ZNPList_ConvexResult;
zpp_nape.util.ZNPList_ConvexResult.__name__ = ["zpp_nape","util","ZNPList_ConvexResult"];
zpp_nape.util.ZNPList_ConvexResult.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ConvexResult
}
zpp_nape.util.ZNPList_ZPP_GeomPoly = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_ZPP_GeomPoly"] = zpp_nape.util.ZNPList_ZPP_GeomPoly;
zpp_nape.util.ZNPList_ZPP_GeomPoly.__name__ = ["zpp_nape","util","ZNPList_ZPP_GeomPoly"];
zpp_nape.util.ZNPList_ZPP_GeomPoly.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_ZPP_GeomPoly
}
zpp_nape.util.ZNPList_RayResult = function() {
	this.length = 0;
	this.pushmod = false;
	this.modified = false;
	this.head = null;
};
$hxClasses["zpp_nape.util.ZNPList_RayResult"] = zpp_nape.util.ZNPList_RayResult;
zpp_nape.util.ZNPList_RayResult.__name__ = ["zpp_nape","util","ZNPList_RayResult"];
zpp_nape.util.ZNPList_RayResult.prototype = {
	iterator_at: function(ind) {
		var ret = this.begin();
		while(ind-- > 0 && ret != null) ret = ret.next;
		return ret;
	}
	,inlined_insert: function(cur,o) {
		var temp = (function($this) {
			var $r;
			var ret;
			{
				if(zpp_nape.util.ZNPNode_RayResult.zpp_pool == null) ret = new zpp_nape.util.ZNPNode_RayResult(); else {
					ret = zpp_nape.util.ZNPNode_RayResult.zpp_pool;
					zpp_nape.util.ZNPNode_RayResult.zpp_pool = ret.next;
					ret.next = null;
				}
				ret.alloc();
			}
			ret.elt = o;
			$r = ret;
			return $r;
		}(this));
		if(cur == null) {
			temp.next = this.begin();
			this.head = temp;
		} else {
			temp.next = cur.next;
			cur.next = temp;
		}
		this.pushmod = this.modified = true;
		this.length++;
		return temp;
	}
	,begin: function() {
		return this.head;
	}
	,__class__: zpp_nape.util.ZNPList_RayResult
}
zpp_nape.util.ZNPNode_ZPP_CbType = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_CbType"] = zpp_nape.util.ZNPNode_ZPP_CbType;
zpp_nape.util.ZNPNode_ZPP_CbType.__name__ = ["zpp_nape","util","ZNPNode_ZPP_CbType"];
zpp_nape.util.ZNPNode_ZPP_CbType.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_CbType
}
zpp_nape.util.ZNPNode_ZPP_Shape = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Shape"] = zpp_nape.util.ZNPNode_ZPP_Shape;
zpp_nape.util.ZNPNode_ZPP_Shape.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Shape"];
zpp_nape.util.ZNPNode_ZPP_Shape.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Shape
}
zpp_nape.util.ZNPNode_ZPP_CallbackSet = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_CallbackSet"] = zpp_nape.util.ZNPNode_ZPP_CallbackSet;
zpp_nape.util.ZNPNode_ZPP_CallbackSet.__name__ = ["zpp_nape","util","ZNPNode_ZPP_CallbackSet"];
zpp_nape.util.ZNPNode_ZPP_CallbackSet.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_CallbackSet
}
zpp_nape.util.ZNPNode_ZPP_Arbiter = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Arbiter"] = zpp_nape.util.ZNPNode_ZPP_Arbiter;
zpp_nape.util.ZNPNode_ZPP_Arbiter.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Arbiter"];
zpp_nape.util.ZNPNode_ZPP_Arbiter.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Arbiter
}
zpp_nape.util.ZNPNode_ZPP_Constraint = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Constraint"] = zpp_nape.util.ZNPNode_ZPP_Constraint;
zpp_nape.util.ZNPNode_ZPP_Constraint.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Constraint"];
zpp_nape.util.ZNPNode_ZPP_Constraint.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Constraint
}
zpp_nape.util.ZNPNode_ZPP_Body = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Body"] = zpp_nape.util.ZNPNode_ZPP_Body;
zpp_nape.util.ZNPNode_ZPP_Body.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Body"];
zpp_nape.util.ZNPNode_ZPP_Body.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Body
}
zpp_nape.util.ZNPNode_ZPP_Compound = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Compound"] = zpp_nape.util.ZNPNode_ZPP_Compound;
zpp_nape.util.ZNPNode_ZPP_Compound.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Compound"];
zpp_nape.util.ZNPNode_ZPP_Compound.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Compound
}
zpp_nape.util.ZNPNode_ZPP_InteractionListener = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_InteractionListener"] = zpp_nape.util.ZNPNode_ZPP_InteractionListener;
zpp_nape.util.ZNPNode_ZPP_InteractionListener.__name__ = ["zpp_nape","util","ZNPNode_ZPP_InteractionListener"];
zpp_nape.util.ZNPNode_ZPP_InteractionListener.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_InteractionListener
}
zpp_nape.util.ZNPNode_ZPP_CbSet = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_CbSet"] = zpp_nape.util.ZNPNode_ZPP_CbSet;
zpp_nape.util.ZNPNode_ZPP_CbSet.__name__ = ["zpp_nape","util","ZNPNode_ZPP_CbSet"];
zpp_nape.util.ZNPNode_ZPP_CbSet.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_CbSet
}
zpp_nape.util.ZNPNode_ZPP_Interactor = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Interactor"] = zpp_nape.util.ZNPNode_ZPP_Interactor;
zpp_nape.util.ZNPNode_ZPP_Interactor.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Interactor"];
zpp_nape.util.ZNPNode_ZPP_Interactor.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Interactor
}
zpp_nape.util.ZNPNode_ZPP_BodyListener = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_BodyListener"] = zpp_nape.util.ZNPNode_ZPP_BodyListener;
zpp_nape.util.ZNPNode_ZPP_BodyListener.__name__ = ["zpp_nape","util","ZNPNode_ZPP_BodyListener"];
zpp_nape.util.ZNPNode_ZPP_BodyListener.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_BodyListener
}
zpp_nape.util.ZNPNode_ZPP_CbSetPair = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_CbSetPair"] = zpp_nape.util.ZNPNode_ZPP_CbSetPair;
zpp_nape.util.ZNPNode_ZPP_CbSetPair.__name__ = ["zpp_nape","util","ZNPNode_ZPP_CbSetPair"];
zpp_nape.util.ZNPNode_ZPP_CbSetPair.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_CbSetPair
}
zpp_nape.util.ZNPNode_ZPP_ConstraintListener = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_ConstraintListener"] = zpp_nape.util.ZNPNode_ZPP_ConstraintListener;
zpp_nape.util.ZNPNode_ZPP_ConstraintListener.__name__ = ["zpp_nape","util","ZNPNode_ZPP_ConstraintListener"];
zpp_nape.util.ZNPNode_ZPP_ConstraintListener.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_ConstraintListener
}
zpp_nape.util.ZNPNode_ZPP_Vec2 = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Vec2"] = zpp_nape.util.ZNPNode_ZPP_Vec2;
zpp_nape.util.ZNPNode_ZPP_Vec2.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Vec2"];
zpp_nape.util.ZNPNode_ZPP_Vec2.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Vec2
}
zpp_nape.util.ZNPNode_ZPP_AABBPair = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_AABBPair"] = zpp_nape.util.ZNPNode_ZPP_AABBPair;
zpp_nape.util.ZNPNode_ZPP_AABBPair.__name__ = ["zpp_nape","util","ZNPNode_ZPP_AABBPair"];
zpp_nape.util.ZNPNode_ZPP_AABBPair.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_AABBPair
}
zpp_nape.util.ZNPNode_ZPP_Edge = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Edge"] = zpp_nape.util.ZNPNode_ZPP_Edge;
zpp_nape.util.ZNPNode_ZPP_Edge.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Edge"];
zpp_nape.util.ZNPNode_ZPP_Edge.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Edge
}
zpp_nape.util.ZNPNode_ZPP_AABBNode = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_AABBNode"] = zpp_nape.util.ZNPNode_ZPP_AABBNode;
zpp_nape.util.ZNPNode_ZPP_AABBNode.__name__ = ["zpp_nape","util","ZNPNode_ZPP_AABBNode"];
zpp_nape.util.ZNPNode_ZPP_AABBNode.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_AABBNode
}
zpp_nape.util.ZNPNode_ZPP_Component = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Component"] = zpp_nape.util.ZNPNode_ZPP_Component;
zpp_nape.util.ZNPNode_ZPP_Component.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Component"];
zpp_nape.util.ZNPNode_ZPP_Component.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Component
}
zpp_nape.util.ZNPNode_ZPP_InteractionGroup = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_InteractionGroup"] = zpp_nape.util.ZNPNode_ZPP_InteractionGroup;
zpp_nape.util.ZNPNode_ZPP_InteractionGroup.__name__ = ["zpp_nape","util","ZNPNode_ZPP_InteractionGroup"];
zpp_nape.util.ZNPNode_ZPP_InteractionGroup.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_InteractionGroup
}
zpp_nape.util.ZNPNode_ZPP_ColArbiter = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_ColArbiter"] = zpp_nape.util.ZNPNode_ZPP_ColArbiter;
zpp_nape.util.ZNPNode_ZPP_ColArbiter.__name__ = ["zpp_nape","util","ZNPNode_ZPP_ColArbiter"];
zpp_nape.util.ZNPNode_ZPP_ColArbiter.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_ColArbiter
}
zpp_nape.util.ZNPNode_ZPP_FluidArbiter = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_FluidArbiter"] = zpp_nape.util.ZNPNode_ZPP_FluidArbiter;
zpp_nape.util.ZNPNode_ZPP_FluidArbiter.__name__ = ["zpp_nape","util","ZNPNode_ZPP_FluidArbiter"];
zpp_nape.util.ZNPNode_ZPP_FluidArbiter.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_FluidArbiter
}
zpp_nape.util.ZNPNode_ZPP_SensorArbiter = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_SensorArbiter"] = zpp_nape.util.ZNPNode_ZPP_SensorArbiter;
zpp_nape.util.ZNPNode_ZPP_SensorArbiter.__name__ = ["zpp_nape","util","ZNPNode_ZPP_SensorArbiter"];
zpp_nape.util.ZNPNode_ZPP_SensorArbiter.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_SensorArbiter
}
zpp_nape.util.ZNPNode_ZPP_Listener = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_Listener"] = zpp_nape.util.ZNPNode_ZPP_Listener;
zpp_nape.util.ZNPNode_ZPP_Listener.__name__ = ["zpp_nape","util","ZNPNode_ZPP_Listener"];
zpp_nape.util.ZNPNode_ZPP_Listener.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_Listener
}
zpp_nape.util.ZNPNode_ZPP_ToiEvent = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_ToiEvent"] = zpp_nape.util.ZNPNode_ZPP_ToiEvent;
zpp_nape.util.ZNPNode_ZPP_ToiEvent.__name__ = ["zpp_nape","util","ZNPNode_ZPP_ToiEvent"];
zpp_nape.util.ZNPNode_ZPP_ToiEvent.prototype = {
	elem: function() {
		return this.elt;
	}
	,free: function() {
		this.elt = null;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_ToiEvent
}
zpp_nape.util.ZNPNode_ConvexResult = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ConvexResult"] = zpp_nape.util.ZNPNode_ConvexResult;
zpp_nape.util.ZNPNode_ConvexResult.__name__ = ["zpp_nape","util","ZNPNode_ConvexResult"];
zpp_nape.util.ZNPNode_ConvexResult.prototype = {
	elem: function() {
		return this.elt;
	}
	,__class__: zpp_nape.util.ZNPNode_ConvexResult
}
zpp_nape.util.ZNPNode_ZPP_GeomPoly = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_ZPP_GeomPoly"] = zpp_nape.util.ZNPNode_ZPP_GeomPoly;
zpp_nape.util.ZNPNode_ZPP_GeomPoly.__name__ = ["zpp_nape","util","ZNPNode_ZPP_GeomPoly"];
zpp_nape.util.ZNPNode_ZPP_GeomPoly.prototype = {
	elem: function() {
		return this.elt;
	}
	,__class__: zpp_nape.util.ZNPNode_ZPP_GeomPoly
}
zpp_nape.util.ZNPNode_RayResult = function() {
	this.elt = null;
	this.next = null;
};
$hxClasses["zpp_nape.util.ZNPNode_RayResult"] = zpp_nape.util.ZNPNode_RayResult;
zpp_nape.util.ZNPNode_RayResult.__name__ = ["zpp_nape","util","ZNPNode_RayResult"];
zpp_nape.util.ZNPNode_RayResult.prototype = {
	elem: function() {
		return this.elt;
	}
	,alloc: function() {
	}
	,__class__: zpp_nape.util.ZNPNode_RayResult
}
zpp_nape.util.ZPP_MixVec2List = function() {
	this.at_index = 0;
	this.at_ite = null;
	this.zip_length = false;
	this._length = 0;
	this.inner = null;
	nape.geom.Vec2List.call(this);
	this.at_ite = null;
	this.at_index = 0;
	this.zip_length = true;
	this._length = 0;
};
$hxClasses["zpp_nape.util.ZPP_MixVec2List"] = zpp_nape.util.ZPP_MixVec2List;
zpp_nape.util.ZPP_MixVec2List.__name__ = ["zpp_nape","util","ZPP_MixVec2List"];
zpp_nape.util.ZPP_MixVec2List.get = function(list,immutable) {
	if(immutable == null) immutable = false;
	var ret = new zpp_nape.util.ZPP_MixVec2List();
	ret.inner = list;
	ret.zpp_inner.immutable = immutable;
	return ret;
}
zpp_nape.util.ZPP_MixVec2List.__super__ = nape.geom.Vec2List;
zpp_nape.util.ZPP_MixVec2List.prototype = $extend(nape.geom.Vec2List.prototype,{
	clear: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		if(this.zpp_inner.reverse_flag) while(!this.empty()) this.pop(); else while(!this.empty()) this.shift();
	}
	,remove: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_vm();
		var ret;
		ret = false;
		var cx_ite = this.inner.begin();
		while(cx_ite != null) {
			var x = cx_ite.elem();
			if(obj.zpp_inner == x) {
				ret = true;
				break;
			}
			cx_ite = cx_ite.next;
		}
		if(ret) {
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(obj);
			if(!this.zpp_inner.dontremove) this.inner.remove(obj.zpp_inner);
			this.zpp_inner.invalidate();
		}
		return ret;
	}
	,shift: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		if(this.empty()) throw "Error: Cannot remove from empty list";
		this.zpp_vm();
		var ret = null;
		if(this.zpp_inner.reverse_flag) {
			if(this.at_ite != null && this.at_ite.next == null) this.at_ite = null;
			var ite = this.get_length() == 1?null:this.inner.iterator_at(this.get_length() - 2);
			ret = ite == null?this.inner.front():ite.next.elem();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.inner.erase(ite);
		} else {
			ret = this.inner.front();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.inner.pop();
		}
		this.zpp_inner.invalidate();
		var retx = ret.wrapper();
		return retx;
	}
	,pop: function() {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		if(this.empty()) throw "Error: Cannot remove from empty list";
		this.zpp_vm();
		var ret = null;
		if(this.zpp_inner.reverse_flag) {
			ret = this.inner.front();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.inner.pop();
		} else {
			if(this.at_ite != null && this.at_ite.next == null) this.at_ite = null;
			var ite = this.get_length() == 1?null:this.inner.iterator_at(this.get_length() - 2);
			ret = ite == null?this.inner.front():ite.next.elem();
			var retx = ret.wrapper();
			if(this.zpp_inner.subber != null) this.zpp_inner.subber(retx);
			if(!this.zpp_inner.dontremove) this.inner.erase(ite);
		}
		this.zpp_inner.invalidate();
		var retx = ret.wrapper();
		return retx;
	}
	,unshift: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_vm();
		if(obj.zpp_inner._inuse) throw "Error: " + "Vec2" + " is already in use";
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) {
				var ite = this.inner.iterator_at(this.get_length() - 1);
				this.inner.insert(ite,obj.zpp_inner);
			} else this.inner.add(obj.zpp_inner);
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,push: function(obj) {
		if(this.zpp_inner.immutable) throw "Error: " + "Vec2" + "List is immutable";
		this.zpp_inner.modify_test();
		this.zpp_vm();
		if(obj.zpp_inner._inuse) throw "Error: " + "Vec2" + " is already in use";
		var cont = this.zpp_inner.adder != null?this.zpp_inner.adder(obj):true;
		if(cont) {
			if(this.zpp_inner.reverse_flag) this.inner.add(obj.zpp_inner); else {
				var ite = this.inner.iterator_at(this.get_length() - 1);
				this.inner.insert(ite,obj.zpp_inner);
			}
			this.zpp_inner.invalidate();
			if(this.zpp_inner.post_adder != null) this.zpp_inner.post_adder(obj);
		}
		return cont;
	}
	,at: function(index) {
		this.zpp_vm();
		if(index < 0 || index >= this.get_length()) throw "Error: Index out of bounds";
		if(this.zpp_inner.reverse_flag) index = this.get_length() - 1 - index;
		if(index < this.at_index || this.at_ite == null) {
			this.at_index = 0;
			this.at_ite = this.inner.begin();
			while(true) {
				var x = this.at_ite.elem();
				if(true) break;
				this.at_ite = this.at_ite.next;
			}
		}
		while(this.at_index != index) {
			this.at_index++;
			this.at_ite = this.at_ite.next;
			while(true) {
				var x = this.at_ite.elem();
				if(true) break;
				this.at_ite = this.at_ite.next;
			}
		}
		return this.at_ite.elem().wrapper();
	}
	,zpp_vm: function() {
		this.zpp_inner.validate();
		if(this.inner.modified) {
			this.zip_length = true;
			this._length = 0;
			this.at_ite = null;
		}
	}
	,zpp_gl: function() {
		this.zpp_vm();
		if(this.zip_length) {
			this._length = 0;
			var cx_ite = this.inner.begin();
			while(cx_ite != null) {
				var i = cx_ite.elem();
				if(true) this._length++;
				cx_ite = cx_ite.next;
			}
			this.zip_length = false;
		}
		return this._length;
	}
	,__class__: zpp_nape.util.ZPP_MixVec2List
});
zpp_nape.util.ZPP_ConstraintList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this.dontremove = false;
	this.subber = null;
	this.post_adder = null;
	this.adder = null;
	this._modifiable = null;
	this._validate = null;
	this._invalidate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_Constraint();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_ConstraintList"] = zpp_nape.util.ZPP_ConstraintList;
zpp_nape.util.ZPP_ConstraintList.__name__ = ["zpp_nape","util","ZPP_ConstraintList"];
zpp_nape.util.ZPP_ConstraintList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.constraint.ConstraintList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_ConstraintList.prototype = {
	invalidate: function() {
		this._invalidated = true;
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,modify_test: function() {
		if(this._modifiable != null) this._modifiable();
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_ConstraintList
}
zpp_nape.util.ZPP_BodyList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this.dontremove = false;
	this.subber = null;
	this.post_adder = null;
	this.adder = null;
	this._modifiable = null;
	this._validate = null;
	this._invalidate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_Body();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_BodyList"] = zpp_nape.util.ZPP_BodyList;
zpp_nape.util.ZPP_BodyList.__name__ = ["zpp_nape","util","ZPP_BodyList"];
zpp_nape.util.ZPP_BodyList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.phys.BodyList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_BodyList.prototype = {
	invalidate: function() {
		this._invalidated = true;
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,modify_test: function() {
		if(this._modifiable != null) this._modifiable();
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_BodyList
}
zpp_nape.util.ZPP_InteractorList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this._validate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_Interactor();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_InteractorList"] = zpp_nape.util.ZPP_InteractorList;
zpp_nape.util.ZPP_InteractorList.__name__ = ["zpp_nape","util","ZPP_InteractorList"];
zpp_nape.util.ZPP_InteractorList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.phys.InteractorList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_InteractorList.prototype = {
	validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_InteractorList
}
zpp_nape.util.ZPP_CompoundList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this.dontremove = false;
	this.subber = null;
	this.post_adder = null;
	this.adder = null;
	this._modifiable = null;
	this._validate = null;
	this._invalidate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_Compound();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_CompoundList"] = zpp_nape.util.ZPP_CompoundList;
zpp_nape.util.ZPP_CompoundList.__name__ = ["zpp_nape","util","ZPP_CompoundList"];
zpp_nape.util.ZPP_CompoundList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.phys.CompoundList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_CompoundList.prototype = {
	invalidate: function() {
		this._invalidated = true;
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,modify_test: function() {
		if(this._modifiable != null) this._modifiable();
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_CompoundList
}
zpp_nape.util.ZPP_ListenerList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this.dontremove = false;
	this.subber = null;
	this.post_adder = null;
	this.adder = null;
	this._modifiable = null;
	this._validate = null;
	this._invalidate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_Listener();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_ListenerList"] = zpp_nape.util.ZPP_ListenerList;
zpp_nape.util.ZPP_ListenerList.__name__ = ["zpp_nape","util","ZPP_ListenerList"];
zpp_nape.util.ZPP_ListenerList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.callbacks.ListenerList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_ListenerList.prototype = {
	invalidate: function() {
		this._invalidated = true;
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,modify_test: function() {
		if(this._modifiable != null) this._modifiable();
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_ListenerList
}
zpp_nape.util.ZPP_CbTypeList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this.dontremove = false;
	this.subber = null;
	this.post_adder = null;
	this.adder = null;
	this._modifiable = null;
	this._validate = null;
	this._invalidate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_CbType();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_CbTypeList"] = zpp_nape.util.ZPP_CbTypeList;
zpp_nape.util.ZPP_CbTypeList.__name__ = ["zpp_nape","util","ZPP_CbTypeList"];
zpp_nape.util.ZPP_CbTypeList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.callbacks.CbTypeList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_CbTypeList.prototype = {
	invalidate: function() {
		this._invalidated = true;
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,modify_test: function() {
		if(this._modifiable != null) this._modifiable();
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_CbTypeList
}
zpp_nape.util.ZPP_Vec2List = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this.dontremove = false;
	this.subber = null;
	this.post_adder = null;
	this.adder = null;
	this._modifiable = null;
	this._validate = null;
	this._invalidate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_Vec2();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_Vec2List"] = zpp_nape.util.ZPP_Vec2List;
zpp_nape.util.ZPP_Vec2List.__name__ = ["zpp_nape","util","ZPP_Vec2List"];
zpp_nape.util.ZPP_Vec2List.prototype = {
	invalidate: function() {
		this._invalidated = true;
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,modify_test: function() {
		if(this._modifiable != null) this._modifiable();
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_Vec2List
}
zpp_nape.util.ZPP_GeomPolyList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this._validate = null;
	this._invalidated = false;
	this.inner = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_GeomPoly();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_GeomPolyList"] = zpp_nape.util.ZPP_GeomPolyList;
zpp_nape.util.ZPP_GeomPolyList.__name__ = ["zpp_nape","util","ZPP_GeomPolyList"];
zpp_nape.util.ZPP_GeomPolyList.prototype = {
	validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_GeomPolyList
}
zpp_nape.util.ZPP_RayResultList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this._validate = null;
	this._invalidated = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_RayResult();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_RayResultList"] = zpp_nape.util.ZPP_RayResultList;
zpp_nape.util.ZPP_RayResultList.__name__ = ["zpp_nape","util","ZPP_RayResultList"];
zpp_nape.util.ZPP_RayResultList.prototype = {
	validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_RayResultList
}
zpp_nape.util.ZPP_ConvexResultList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this._validate = null;
	this._invalidated = false;
	this.inner = null;
	this.inner = new zpp_nape.util.ZNPList_ConvexResult();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_ConvexResultList"] = zpp_nape.util.ZPP_ConvexResultList;
zpp_nape.util.ZPP_ConvexResultList.__name__ = ["zpp_nape","util","ZPP_ConvexResultList"];
zpp_nape.util.ZPP_ConvexResultList.prototype = {
	validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_ConvexResultList
}
zpp_nape.util.ZPP_EdgeList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this._validate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_Edge();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_EdgeList"] = zpp_nape.util.ZPP_EdgeList;
zpp_nape.util.ZPP_EdgeList.__name__ = ["zpp_nape","util","ZPP_EdgeList"];
zpp_nape.util.ZPP_EdgeList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.shape.EdgeList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_EdgeList.prototype = {
	validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_EdgeList
}
zpp_nape.util.ZPP_ShapeList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this.dontremove = false;
	this.subber = null;
	this.post_adder = null;
	this.adder = null;
	this._modifiable = null;
	this._validate = null;
	this._invalidate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_Shape();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_ShapeList"] = zpp_nape.util.ZPP_ShapeList;
zpp_nape.util.ZPP_ShapeList.__name__ = ["zpp_nape","util","ZPP_ShapeList"];
zpp_nape.util.ZPP_ShapeList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.shape.ShapeList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_ShapeList.prototype = {
	invalidate: function() {
		this._invalidated = true;
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,modify_test: function() {
		if(this._modifiable != null) this._modifiable();
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_ShapeList
}
zpp_nape.util.ZPP_InteractionGroupList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this._validate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_InteractionGroup();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_InteractionGroupList"] = zpp_nape.util.ZPP_InteractionGroupList;
zpp_nape.util.ZPP_InteractionGroupList.__name__ = ["zpp_nape","util","ZPP_InteractionGroupList"];
zpp_nape.util.ZPP_InteractionGroupList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.dynamics.InteractionGroupList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_InteractionGroupList.prototype = {
	validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_InteractionGroupList
}
zpp_nape.util.ZPP_ArbiterList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this.dontremove = false;
	this.subber = null;
	this.post_adder = null;
	this.adder = null;
	this._modifiable = null;
	this._validate = null;
	this._invalidate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.util.ZNPList_ZPP_Arbiter();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_ArbiterList"] = zpp_nape.util.ZPP_ArbiterList;
zpp_nape.util.ZPP_ArbiterList.__name__ = ["zpp_nape","util","ZPP_ArbiterList"];
zpp_nape.util.ZPP_ArbiterList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.dynamics.ArbiterList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_ArbiterList.prototype = {
	invalidate: function() {
		this._invalidated = true;
		if(this._invalidate != null) this._invalidate(this);
	}
	,validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,modify_test: function() {
		if(this._modifiable != null) this._modifiable();
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_ArbiterList
}
zpp_nape.util.ZPP_ContactList = function() {
	this.user_length = 0;
	this.zip_length = false;
	this.push_ite = null;
	this.at_ite = null;
	this.at_index = 0;
	this.reverse_flag = false;
	this.dontremove = false;
	this.subber = null;
	this.adder = null;
	this._validate = null;
	this._invalidated = false;
	this.immutable = false;
	this.inner = null;
	this.outer = null;
	this.inner = new zpp_nape.dynamics.ZPP_Contact();
	this._invalidated = true;
};
$hxClasses["zpp_nape.util.ZPP_ContactList"] = zpp_nape.util.ZPP_ContactList;
zpp_nape.util.ZPP_ContactList.__name__ = ["zpp_nape","util","ZPP_ContactList"];
zpp_nape.util.ZPP_ContactList.get = function(list,imm) {
	if(imm == null) imm = false;
	var ret = new nape.dynamics.ContactList();
	ret.zpp_inner.inner = list;
	if(imm) ret.zpp_inner.immutable = true;
	ret.zpp_inner.zip_length = true;
	return ret;
}
zpp_nape.util.ZPP_ContactList.prototype = {
	validate: function() {
		if(this._invalidated) {
			this._invalidated = false;
			if(this._validate != null) this._validate();
		}
	}
	,valmod: function() {
		this.validate();
		if(this.inner.modified) {
			if(this.inner.pushmod) this.push_ite = null;
			this.at_ite = null;
			this.inner.modified = false;
			this.inner.pushmod = false;
			this.zip_length = true;
		}
	}
	,__class__: zpp_nape.util.ZPP_ContactList
}
zpp_nape.util.ZPP_Math = function() { }
$hxClasses["zpp_nape.util.ZPP_Math"] = zpp_nape.util.ZPP_Math;
zpp_nape.util.ZPP_Math.__name__ = ["zpp_nape","util","ZPP_Math"];
zpp_nape.util.ZPP_Math.sqrt = function(x) {
	return Math.sqrt(x);
}
zpp_nape.util.ZPP_Math.invsqrt = function(x) {
	return 1.0 / zpp_nape.util.ZPP_Math.sqrt(x);
}
zpp_nape.util.ZPP_Math.sqr = function(x) {
	return x * x;
}
zpp_nape.util.ZPP_Math.clamp2 = function(x,a) {
	return zpp_nape.util.ZPP_Math.clamp(x,-a,a);
}
zpp_nape.util.ZPP_Math.clamp = function(x,a,b) {
	return x < a?a:x > b?b:x;
}
zpp_nape.util.ZPP_PubPool = function() { }
$hxClasses["zpp_nape.util.ZPP_PubPool"] = zpp_nape.util.ZPP_PubPool;
zpp_nape.util.ZPP_PubPool.__name__ = ["zpp_nape","util","ZPP_PubPool"];
zpp_nape.util.ZPP_Set_ZPP_CbSetPair = function() {
	this.colour = 0;
	this.parent = null;
	this.next = null;
	this.prev = null;
	this.data = null;
	this.swapped = null;
	this.lt = null;
};
$hxClasses["zpp_nape.util.ZPP_Set_ZPP_CbSetPair"] = zpp_nape.util.ZPP_Set_ZPP_CbSetPair;
zpp_nape.util.ZPP_Set_ZPP_CbSetPair.__name__ = ["zpp_nape","util","ZPP_Set_ZPP_CbSetPair"];
zpp_nape.util.ZPP_Set_ZPP_CbSetPair.prototype = {
	try_insert: function(obj) {
		var x = null;
		var cur = null;
		if(this.parent == null) {
			if(zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool == null) x = new zpp_nape.util.ZPP_Set_ZPP_CbSetPair(); else {
				x = zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool;
				zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool = x.next;
				x.next = null;
			}
			x.alloc();
			x.data = obj;
			this.parent = x;
		} else {
			cur = this.parent;
			while(true) if(this.lt(obj,cur.data)) {
				if(cur.prev == null) {
					if(zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool == null) x = new zpp_nape.util.ZPP_Set_ZPP_CbSetPair(); else {
						x = zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool;
						zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool = x.next;
						x.next = null;
					}
					x.alloc();
					x.data = obj;
					cur.prev = x;
					x.parent = cur;
					break;
				} else cur = cur.prev;
			} else if(this.lt(cur.data,obj)) {
				if(cur.next == null) {
					if(zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool == null) x = new zpp_nape.util.ZPP_Set_ZPP_CbSetPair(); else {
						x = zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool;
						zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool = x.next;
						x.next = null;
					}
					x.alloc();
					x.data = obj;
					cur.next = x;
					x.parent = cur;
					break;
				} else cur = cur.next;
			} else break;
		}
		if(x == null) return cur; else {
			if(x.parent == null) x.colour = 1; else {
				x.colour = 0;
				if(x.parent.colour == 0) this.__fix_dbl_red(x);
			}
			return x;
		}
	}
	,__fix_dbl_red: function(x) {
		while(true) {
			var par = x.parent;
			var g = par.parent;
			if(g == null) {
				par.colour = 1;
				break;
			}
			var n1, n2, n3, t1, t2, t3, t4;
			if(par == g.prev) {
				n3 = g;
				t4 = g.next;
				if(x == par.prev) {
					n1 = x;
					n2 = par;
					t1 = x.prev;
					t2 = x.next;
					t3 = par.next;
				} else {
					n1 = par;
					n2 = x;
					t1 = par.prev;
					t2 = x.prev;
					t3 = x.next;
				}
			} else {
				n1 = g;
				t1 = g.prev;
				if(x == par.prev) {
					n2 = x;
					n3 = par;
					t2 = x.prev;
					t3 = x.next;
					t4 = par.next;
				} else {
					n2 = par;
					n3 = x;
					t2 = par.prev;
					t3 = x.prev;
					t4 = x.next;
				}
			}
			var par1 = g.parent;
			if(par1 == null) this.parent = n2; else if(par1.prev == g) par1.prev = n2; else par1.next = n2;
			if(n2 != null) n2.parent = par1;
			n1.prev = t1;
			if(t1 != null) t1.parent = n1;
			n1.next = t2;
			if(t2 != null) t2.parent = n1;
			n2.prev = n1;
			if(n1 != null) n1.parent = n2;
			n2.next = n3;
			if(n3 != null) n3.parent = n2;
			n3.prev = t3;
			if(t3 != null) t3.parent = n3;
			n3.next = t4;
			if(t4 != null) t4.parent = n3;
			n2.colour = g.colour - 1;
			n1.colour = 1;
			n3.colour = 1;
			if(n2 == this.parent) this.parent.colour = 1; else if(n2.colour == 0 && n2.parent.colour == 0) {
				x = n2;
				continue;
			}
			break;
		}
	}
	,clear_node: function(node,lambda) {
		lambda(node.data);
		var ret = node.parent;
		if(ret != null) {
			if(node == ret.prev) ret.prev = null; else ret.next = null;
			node.parent = null;
		}
		var o = node;
		o.free();
		o.next = zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool;
		zpp_nape.util.ZPP_Set_ZPP_CbSetPair.zpp_pool = o;
		return ret;
	}
	,clear_with: function(lambda) {
		if(this.parent == null) return; else {
			var cur = this.parent;
			while(cur != null) cur = cur.prev != null?cur.prev:cur.next != null?cur.next:this.clear_node(cur,lambda);
			this.parent = null;
		}
	}
	,alloc: function() {
	}
	,free: function() {
		this.data = null;
		this.lt = null;
		this.swapped = null;
	}
	,__class__: zpp_nape.util.ZPP_Set_ZPP_CbSetPair
}
zpp_nape.util.ZPP_Set_ZPP_CbSet = function() {
	this.colour = 0;
	this.parent = null;
	this.next = null;
	this.prev = null;
	this.data = null;
	this.swapped = null;
	this.lt = null;
};
$hxClasses["zpp_nape.util.ZPP_Set_ZPP_CbSet"] = zpp_nape.util.ZPP_Set_ZPP_CbSet;
zpp_nape.util.ZPP_Set_ZPP_CbSet.__name__ = ["zpp_nape","util","ZPP_Set_ZPP_CbSet"];
zpp_nape.util.ZPP_Set_ZPP_CbSet.prototype = {
	insert: function(obj) {
		var x;
		if(zpp_nape.util.ZPP_Set_ZPP_CbSet.zpp_pool == null) x = new zpp_nape.util.ZPP_Set_ZPP_CbSet(); else {
			x = zpp_nape.util.ZPP_Set_ZPP_CbSet.zpp_pool;
			zpp_nape.util.ZPP_Set_ZPP_CbSet.zpp_pool = x.next;
			x.next = null;
		}
		x.alloc();
		x.data = obj;
		if(this.parent == null) this.parent = x; else {
			var cur = this.parent;
			while(true) if(this.lt(x.data,cur.data)) {
				if(cur.prev == null) {
					cur.prev = x;
					x.parent = cur;
					break;
				} else cur = cur.prev;
			} else if(cur.next == null) {
				cur.next = x;
				x.parent = cur;
				break;
			} else cur = cur.next;
		}
		if(x.parent == null) x.colour = 1; else {
			x.colour = 0;
			if(x.parent.colour == 0) this.__fix_dbl_red(x);
		}
		return x;
	}
	,__fix_dbl_red: function(x) {
		while(true) {
			var par = x.parent;
			var g = par.parent;
			if(g == null) {
				par.colour = 1;
				break;
			}
			var n1, n2, n3, t1, t2, t3, t4;
			if(par == g.prev) {
				n3 = g;
				t4 = g.next;
				if(x == par.prev) {
					n1 = x;
					n2 = par;
					t1 = x.prev;
					t2 = x.next;
					t3 = par.next;
				} else {
					n1 = par;
					n2 = x;
					t1 = par.prev;
					t2 = x.prev;
					t3 = x.next;
				}
			} else {
				n1 = g;
				t1 = g.prev;
				if(x == par.prev) {
					n2 = x;
					n3 = par;
					t2 = x.prev;
					t3 = x.next;
					t4 = par.next;
				} else {
					n2 = par;
					n3 = x;
					t2 = par.prev;
					t3 = x.prev;
					t4 = x.next;
				}
			}
			var par1 = g.parent;
			if(par1 == null) this.parent = n2; else if(par1.prev == g) par1.prev = n2; else par1.next = n2;
			if(n2 != null) n2.parent = par1;
			n1.prev = t1;
			if(t1 != null) t1.parent = n1;
			n1.next = t2;
			if(t2 != null) t2.parent = n1;
			n2.prev = n1;
			if(n1 != null) n1.parent = n2;
			n2.next = n3;
			if(n3 != null) n3.parent = n2;
			n3.prev = t3;
			if(t3 != null) t3.parent = n3;
			n3.next = t4;
			if(t4 != null) t4.parent = n3;
			n2.colour = g.colour - 1;
			n1.colour = 1;
			n3.colour = 1;
			if(n2 == this.parent) this.parent.colour = 1; else if(n2.colour == 0 && n2.parent.colour == 0) {
				x = n2;
				continue;
			}
			break;
		}
	}
	,__fix_neg_red: function(negred) {
		var parent = negred.parent;
		var child = parent.prev == negred?(function($this) {
			var $r;
			var nl = negred.prev;
			var nr = negred.next;
			var trl = nr.prev;
			var trr = nr.next;
			nl.colour = 0;
			negred.colour = parent.colour = 1;
			{
				negred.next = trl;
				if(trl != null) trl.parent = negred;
			}
			{
				var t = parent.data;
				parent.data = nr.data;
				nr.data = t;
			}
			if($this.swapped != null) $this.swapped(parent.data,nr.data);
			{
				nr.prev = trr;
				if(trr != null) trr.parent = nr;
			}
			{
				nr.next = parent.next;
				if(parent.next != null) parent.next.parent = nr;
			}
			{
				parent.next = nr;
				if(nr != null) nr.parent = parent;
			}
			$r = nl;
			return $r;
		}(this)):(function($this) {
			var $r;
			var nl = negred.next;
			var nr = negred.prev;
			var trl = nr.next;
			var trr = nr.prev;
			nl.colour = 0;
			negred.colour = parent.colour = 1;
			{
				negred.prev = trl;
				if(trl != null) trl.parent = negred;
			}
			{
				var t = parent.data;
				parent.data = nr.data;
				nr.data = t;
			}
			if($this.swapped != null) $this.swapped(parent.data,nr.data);
			{
				nr.next = trr;
				if(trr != null) trr.parent = nr;
			}
			{
				nr.prev = parent.prev;
				if(parent.prev != null) parent.prev.parent = nr;
			}
			{
				parent.prev = nr;
				if(nr != null) nr.parent = parent;
			}
			$r = nl;
			return $r;
		}(this));
		if(child.prev != null && child.prev.colour == 0) this.__fix_dbl_red(child.prev); else if(child.next != null && child.next.colour == 0) this.__fix_dbl_red(child.next);
	}
	,remove_node: function(cur) {
		if(cur.next != null && cur.prev != null) {
			var sm = cur.next;
			while(sm.prev != null) sm = sm.prev;
			var t = cur.data;
			cur.data = sm.data;
			sm.data = t;
			if(this.swapped != null) this.swapped(cur.data,sm.data);
			cur = sm;
		}
		var child = cur.prev == null?cur.next:cur.prev;
		if(cur.colour == 1) {
			if(cur.prev != null || cur.next != null) child.colour = 1; else if(cur.parent != null) {
				var parent = cur.parent;
				while(true) {
					parent.colour++;
					parent.prev.colour--;
					parent.next.colour--;
					var child1 = parent.prev;
					if(child1.colour == -1) {
						this.__fix_neg_red(child1);
						break;
					} else if(child1.colour == 0) {
						if(child1.prev != null && child1.prev.colour == 0) {
							this.__fix_dbl_red(child1.prev);
							break;
						}
						if(child1.next != null && child1.next.colour == 0) {
							this.__fix_dbl_red(child1.next);
							break;
						}
					}
					var child1 = parent.next;
					if(child1.colour == -1) {
						this.__fix_neg_red(child1);
						break;
					} else if(child1.colour == 0) {
						if(child1.prev != null && child1.prev.colour == 0) {
							this.__fix_dbl_red(child1.prev);
							break;
						}
						if(child1.next != null && child1.next.colour == 0) {
							this.__fix_dbl_red(child1.next);
							break;
						}
					}
					if(parent.colour == 2) {
						if(parent.parent == null) parent.colour = 1; else {
							parent = parent.parent;
							continue;
						}
					}
					break;
				}
			}
		}
		var par = cur.parent;
		if(par == null) this.parent = child; else if(par.prev == cur) par.prev = child; else par.next = child;
		if(child != null) child.parent = par;
		cur.parent = cur.prev = cur.next = null;
		var o = cur;
		o.free();
		o.next = zpp_nape.util.ZPP_Set_ZPP_CbSet.zpp_pool;
		zpp_nape.util.ZPP_Set_ZPP_CbSet.zpp_pool = o;
	}
	,remove: function(obj) {
		var node = this.find(obj);
		this.remove_node(node);
	}
	,find_weak: function(obj) {
		var cur = this.parent;
		while(cur != null) if(this.lt(obj,cur.data)) cur = cur.prev; else if(this.lt(cur.data,obj)) cur = cur.next; else break;
		return cur;
	}
	,find: function(obj) {
		var cur = this.parent;
		while(cur != null && cur.data != obj) if(this.lt(obj,cur.data)) cur = cur.prev; else cur = cur.next;
		return cur;
	}
	,empty: function() {
		return this.parent == null;
	}
	,alloc: function() {
	}
	,free: function() {
		this.data = null;
		this.lt = null;
		this.swapped = null;
	}
	,__class__: zpp_nape.util.ZPP_Set_ZPP_CbSet
}
function $iterator(o) { if( o instanceof Array ) return function() { return HxOverrides.iter(o); }; return typeof(o.iterator) == 'function' ? $bind(o,o.iterator) : o.iterator; };
var $_;
function $bind(o,m) { var f = function(){ return f.method.apply(f.scope, arguments); }; f.scope = o; f.method = m; return f; };
if(Array.prototype.indexOf) HxOverrides.remove = function(a,o) {
	var i = a.indexOf(o);
	if(i == -1) return false;
	a.splice(i,1);
	return true;
}; else null;
Math.__name__ = ["Math"];
Math.NaN = Number.NaN;
Math.NEGATIVE_INFINITY = Number.NEGATIVE_INFINITY;
Math.POSITIVE_INFINITY = Number.POSITIVE_INFINITY;
$hxClasses.Math = Math;
Math.isFinite = function(i) {
	return isFinite(i);
};
Math.isNaN = function(i) {
	return isNaN(i);
};
String.prototype.__class__ = $hxClasses.String = String;
String.__name__ = ["String"];
Array.prototype.__class__ = $hxClasses.Array = Array;
Array.__name__ = ["Array"];
Date.prototype.__class__ = $hxClasses.Date = Date;
Date.__name__ = ["Date"];
var Int = $hxClasses.Int = { __name__ : ["Int"]};
var Dynamic = $hxClasses.Dynamic = { __name__ : ["Dynamic"]};
var Float = $hxClasses.Float = Number;
Float.__name__ = ["Float"];
var Bool = $hxClasses.Bool = Boolean;
Bool.__ename__ = ["Bool"];
var Class = $hxClasses.Class = { __name__ : ["Class"]};
var Enum = { };
Xml.Element = "element";
Xml.PCData = "pcdata";
Xml.CData = "cdata";
Xml.Comment = "comment";
Xml.DocType = "doctype";
Xml.Prolog = "prolog";
Xml.Document = "document";
if(typeof document != "undefined") js.Lib.document = document;
if(typeof window != "undefined") {
	js.Lib.window = window;
	js.Lib.window.onerror = function(msg,url,line) {
		var f = js.Lib.onerror;
		if(f == null) return false;
		return f(msg,[url + ":" + line]);
	};
}
if(typeof(JSON) != "undefined") haxe.Json = JSON;
Main.DEFAULT_BG_COLOR = 0;
Main.DEFAULT_WIDTH = 982;
Main.DEFAULT_HEIGHT = 600;
Main.GLOBAL_SCALE = 1.0;
Main.GLOBAL_OFFSET = new flambe.math.Point(0,0);
Main.ASSET_SCALE = 1.0;
Main.ASSET_SCALE_INV = 0;
com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByID = new Hash();
com.cmm.common.audio.SoundPlayerRemote._soundFilesHashByFilename = new Hash();
com.cmm.common.audio.SoundPlayerRemote._soundClipChannels = new Hash();
com.cmm.common.audio.SoundPlayerRemote.path = "";
com.cmm.common.audio.SoundPlayerRemote.entity = new flambe.Entity();
com.cmm.common.audio.SoundPlayerRemote.isMuted = false;
flambe.display.Sprite._scratchPoint = new flambe.math.Point();
com.cmm.common.display.SpriteContainer._instanceNum = 0;
com.cmm.common.display.SpriteContainer._connectedGlobalPointerUp = false;
com.cmm.common.event.EDispatcher._signals = new Hash();
com.cmm.common.event.EDispatcher._signalConnections = new Hash();
com.cmm.common.io.LoadMaster._manifestHash = new Hash();
com.cmm.common.io.LoadMaster._assetPackHash = new Hash();
com.cmm.common.text.DynamicTextLibrary._txtDict = new Hash();
com.cmm.common.text.TextAlign.__meta__ = { obj : { 'final' : null}};
com.cmm.common.text.VerticalAlign.__meta__ = { obj : { 'final' : null}};
com.cmm.common.utils.DelayPrompt._triggers = new Array();
com.cmm.common.utils.browserDetect.BrowserDetect.__meta__ = { obj : { 'final' : null}};
com.cmm.common.utils.browserDetect.BrowserDetect.isMobile = false;
com.cmm.common.utils.browserDetect.BrowserDetect.browserType = "Unknown";
com.cmm.common.utils.browserDetect.BrowserDetect.browserVersion = -1;
com.cmm.common.utils.browserDetect.BrowserDetect.platformType = "Unknown";
com.cmm.common.utils.browserDetect.BrowserDetect.platformVersion = -1;
com.cmm.common.utils.browserDetect.BrowserDetect.iPhone4 = false;
com.cmm.common.utils.browserDetect.BrowserDetect.iPhoneVersion = -1;
com.cmm.mmc.app.gameState.GameVOPlayer._index = 1;
com.cmm.mmc.app.gameState.GameVOPlayer._springCount = 0;
com.cmm.mmc.app.gameState.GameVOPlayer._boostCount = 0;
com.cmm.mmc.app.gameState.GameVOPlayer._ballLaunched = false;
com.cmm.mmc.app.gameState.GameVOPlayer._playAlternatePrompt = false;
com.cmm.mmc.app.gameState.GameVOPlayer._ignoreAlternatePrompt = false;
com.cmm.mmc.app.gameState.GameVOPlayer._bouncePlaying = false;
com.cmm.mmc.app.gameState.GameVOPlayer._inputReceived = false;
zpp_nape.callbacks.ZPP_CbType.ANY_SHAPE = new nape.callbacks.CbType();
zpp_nape.callbacks.ZPP_CbType.ANY_BODY = new nape.callbacks.CbType();
zpp_nape.callbacks.ZPP_CbType.ANY_COMPOUND = new nape.callbacks.CbType();
zpp_nape.callbacks.ZPP_CbType.ANY_CONSTRAINT = new nape.callbacks.CbType();
zpp_nape.ZPP_ID._Constraint = 0;
zpp_nape.ZPP_ID._Interactor = 0;
zpp_nape.ZPP_ID._CbType = 0;
zpp_nape.ZPP_ID._CbSet = 0;
zpp_nape.ZPP_ID._Listener = 0;
com.cmm.mmc.app.gameState.PhysicsController._pieceCollision = new nape.callbacks.CbType();
com.cmm.mmc.app.gameState.PhysicsController._animationCollision = new nape.callbacks.CbType();
flambe.platform.html.HtmlPlatform.instance = new flambe.platform.html.HtmlPlatform();
flambe.util.SignalBase.DISPATCHING_SENTINEL = new flambe.util.SignalConnection(null,null);
flambe.System.FPS = 60;
flambe.System.root = new flambe.Entity();
flambe.System.uncaughtError = new flambe.util.Signal1();
flambe.System.hidden = new flambe.util.Value(false);
flambe.System.hasGPU = new flambe.util.Value(false);
flambe.System.volume = new flambe.animation.AnimatedFloat(1);
flambe.System._platform = flambe.platform.html.HtmlPlatform.instance;
flambe.System._calledInit = false;
flambe.Log.logger = flambe.System.createLogger("flambe");
flambe.asset.Manifest._buildManifest = flambe.asset.Manifest.createBuildManifests();
flambe.asset.Manifest._supportsCrossOrigin = (function() {
	var blacklist = new EReg("\\b(Android)\\b","");
	if(blacklist.match(js.Lib.window.navigator.userAgent)) return false;
	var xhr = new XMLHttpRequest();
	return xhr.withCredentials != null;
})();
flambe.platform.BasicKeyboard._sharedEvent = new flambe.input.KeyboardEvent();
flambe.platform.BasicMouse._sharedEvent = new flambe.input.MouseEvent();
flambe.platform.BasicPointer._sharedEvent = new flambe.input.PointerEvent();
flambe.platform.html.CanvasRenderer.CANVAS_TEXTURES = (function() {
	var pattern = new EReg("(iPhone|iPod|iPad)","");
	var match = pattern.match(js.Lib.window.navigator.userAgent);
	if(match) {
		var devicePixelRatio = window.devicePixelRatio;
		return devicePixelRatio == 2;
	}
	return false;
})();
flambe.platform.html.HtmlAssetPackLoader._mediaRefCount = 0;
flambe.platform.html.HtmlAssetPackLoader._detectBlobSupport = true;
flambe.platform.html.HtmlUtil.VENDOR_PREFIXES = ["webkit","moz","ms","o","khtml"];
flambe.platform.html.HtmlUtil.SHOULD_HIDE_MOBILE_BROWSER = js.Lib.window.top == js.Lib.window && new EReg("Mobile(/.*)? Safari","").match(js.Lib.window.navigator.userAgent);
flambe.platform.html.WebAudioSound._detectSupport = true;
haxe.Serializer.USE_CACHE = false;
haxe.Serializer.USE_ENUM_INDEX = false;
haxe.Serializer.BASE64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";
haxe.Unserializer.DEFAULT_RESOLVER = Type;
haxe.Unserializer.BASE64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";
nape.Config.epsilon = 1e-8;
nape.Config.fluidAngularDragFriction = 2.5;
nape.Config.fluidAngularDrag = 100;
nape.Config.fluidVacuumDrag = 0.5;
nape.Config.fluidLinearDrag = 0.5;
nape.Config.collisionSlop = 0.2;
nape.Config.collisionSlopCCD = 0.5;
nape.Config.distanceThresholdCCD = 0.05;
nape.Config.staticCCDLinearThreshold = 0.05;
nape.Config.staticCCDAngularThreshold = 0.005;
nape.Config.bulletCCDLinearThreshold = 0.125;
nape.Config.bulletCCDAngularThreshold = 0.0125;
nape.Config.dynamicSweepLinearThreshold = 17;
nape.Config.dynamicSweepAngularThreshold = 0.6;
nape.Config.angularCCDSlipScale = 0.75;
nape.Config.arbiterExpirationDelay = 6;
nape.Config.staticFrictionThreshold = 2;
nape.Config.elasticThreshold = 20;
nape.Config.sleepDelay = 60;
nape.Config.linearSleepThreshold = 0.2;
nape.Config.angularSleepThreshold = 0.4;
nape.Config.contactBiasCoef = 0.3;
nape.Config.contactStaticBiasCoef = 0.6;
nape.Config.contactContinuousBiasCoef = 0.4;
nape.Config.contactContinuousStaticBiasCoef = 0.5;
nape.Config.constraintLinearSlop = 0.1;
nape.Config.constraintAngularSlop = 1e-3;
nape.Config.illConditionedThreshold = 2e+8;
zpp_nape.callbacks.ZPP_Callback.internal = false;
zpp_nape.callbacks.ZPP_Listener.internal = false;
zpp_nape.callbacks.ZPP_InteractionListener.UCbSet = new zpp_nape.util.ZNPList_ZPP_CbSet();
zpp_nape.callbacks.ZPP_InteractionListener.VCbSet = new zpp_nape.util.ZNPList_ZPP_CbSet();
zpp_nape.callbacks.ZPP_InteractionListener.WCbSet = new zpp_nape.util.ZNPList_ZPP_CbSet();
zpp_nape.callbacks.ZPP_InteractionListener.UCbType = new zpp_nape.util.ZNPList_ZPP_CbType();
zpp_nape.callbacks.ZPP_InteractionListener.VCbType = new zpp_nape.util.ZNPList_ZPP_CbType();
zpp_nape.callbacks.ZPP_InteractionListener.WCbType = new zpp_nape.util.ZNPList_ZPP_CbType();
zpp_nape.dynamics.ZPP_Arbiter.internal = false;
zpp_nape.dynamics.ZPP_Arbiter.COL = 1;
zpp_nape.dynamics.ZPP_Arbiter.FLUID = 4;
zpp_nape.dynamics.ZPP_Arbiter.SENSOR = 2;
zpp_nape.dynamics.ZPP_Contact.internal = false;
zpp_nape.geom.ZPP_Collide.flowpoly = new zpp_nape.util.ZNPList_ZPP_Vec2();
zpp_nape.geom.ZPP_Collide.flowsegs = new zpp_nape.util.ZNPList_ZPP_Vec2();
zpp_nape.geom.ZPP_ConvexRayResult.internal = false;
zpp_nape.phys.ZPP_Material.WAKE = 1;
zpp_nape.phys.ZPP_Material.PROPS = 2;
zpp_nape.phys.ZPP_Material.ANGDRAG = 4;
zpp_nape.phys.ZPP_Material.ARBITERS = 8;
zpp_nape.shape.ZPP_Edge.internal = false;
zpp_nape.space.ZPP_AABBTree.tmpaabb = new zpp_nape.geom.ZPP_AABB();
zpp_nape.util.ZPP_Flags.internal = false;
zpp_nape.util.ZPP_Flags.id_ImmState_ACCEPT = 1;
zpp_nape.util.ZPP_Flags.id_ImmState_IGNORE = 2;
zpp_nape.util.ZPP_Flags.id_ImmState_ALWAYS = 4;
zpp_nape.util.ZPP_Flags.id_GravMassMode_DEFAULT = 0;
zpp_nape.util.ZPP_Flags.id_GravMassMode_FIXED = 1;
zpp_nape.util.ZPP_Flags.id_GravMassMode_SCALED = 2;
zpp_nape.util.ZPP_Flags.id_InertiaMode_DEFAULT = 0;
zpp_nape.util.ZPP_Flags.id_InertiaMode_FIXED = 1;
zpp_nape.util.ZPP_Flags.id_MassMode_DEFAULT = 0;
zpp_nape.util.ZPP_Flags.id_MassMode_FIXED = 1;
zpp_nape.util.ZPP_Flags.id_BodyType_STATIC = 1;
zpp_nape.util.ZPP_Flags.id_BodyType_DYNAMIC = 2;
zpp_nape.util.ZPP_Flags.id_BodyType_KINEMATIC = 3;
zpp_nape.util.ZPP_Flags.id_ListenerType_BODY = 0;
zpp_nape.util.ZPP_Flags.id_PreFlag_ACCEPT = 1;
zpp_nape.util.ZPP_Flags.id_ListenerType_CONSTRAINT = 1;
zpp_nape.util.ZPP_Flags.id_ListenerType_INTERACTION = 2;
zpp_nape.util.ZPP_Flags.id_ListenerType_PRE = 3;
zpp_nape.util.ZPP_Flags.id_CbEvent_BEGIN = 0;
zpp_nape.util.ZPP_Flags.id_InteractionType_COLLISION = 1;
zpp_nape.util.ZPP_Flags.id_CbEvent_ONGOING = 6;
zpp_nape.util.ZPP_Flags.id_InteractionType_SENSOR = 2;
zpp_nape.util.ZPP_Flags.id_CbEvent_END = 1;
zpp_nape.util.ZPP_Flags.id_InteractionType_FLUID = 4;
zpp_nape.util.ZPP_Flags.id_CbEvent_WAKE = 2;
zpp_nape.util.ZPP_Flags.id_InteractionType_ANY = 7;
zpp_nape.util.ZPP_Flags.id_CbEvent_SLEEP = 3;
zpp_nape.util.ZPP_Flags.id_CbEvent_BREAK = 4;
zpp_nape.util.ZPP_Flags.id_CbEvent_PRE = 5;
zpp_nape.util.ZPP_Flags.id_ShapeType_CIRCLE = 0;
zpp_nape.util.ZPP_Flags.id_ShapeType_POLYGON = 1;
zpp_nape.util.ZPP_ConstraintList.internal = false;
zpp_nape.util.ZPP_BodyList.internal = false;
zpp_nape.util.ZPP_InteractorList.internal = false;
zpp_nape.util.ZPP_CompoundList.internal = false;
zpp_nape.util.ZPP_ListenerList.internal = false;
zpp_nape.util.ZPP_CbTypeList.internal = false;
zpp_nape.util.ZPP_Vec2List.internal = false;
zpp_nape.util.ZPP_GeomPolyList.internal = false;
zpp_nape.util.ZPP_RayResultList.internal = false;
zpp_nape.util.ZPP_ConvexResultList.internal = false;
zpp_nape.util.ZPP_EdgeList.internal = false;
zpp_nape.util.ZPP_ShapeList.internal = false;
zpp_nape.util.ZPP_InteractionGroupList.internal = false;
zpp_nape.util.ZPP_ArbiterList.internal = false;
zpp_nape.util.ZPP_ContactList.internal = false;
Main.main();
})();
