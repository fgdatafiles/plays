(function(zg){function p(a,b){function c(){}c.prototype=a;var d=new c,e;for(e in b)d[e]=b[e];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function q(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=Gg++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var F=function(){};F.__name__=["HxOverrides"];F.cca=function(a,
b){var c=a.charCodeAt(b);return c!=c?void 0:c};F.substr=function(a,b,c){if(null==c)c=a.length;else if(0>c)if(0==b)c=a.length+c;else return"";return a.substr(b,c)};F.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};F.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var s=function(){};s.__name__=["Main"];s.main=function(){s.init()};s.loadScript=function(a,b,c,d){var e=s.getDocument().createElement("script");
e.type="text/javascript";e.async=!0;e.src=b;e.id=a;s.getDocument().body.appendChild(e);e.onload=c;e.onerror=d};s.validateBrowser=function(){var a=document.createElement("canvas");if(null==a.getContext||null==a.getContext("2d").fillText)return!1;a=window.audioContextInstance;return n.isMobile()&&null==a?!1:!0};s.validateCookies=function(){return null!=kb.getLocalStorage()&&null!=kb.getSessionStorage()?null!=navigator.cookieEnabled?navigator.cookieEnabled:!1:!1};s.init=function(){if(s.validateBrowser())if(s.validateCookies()){s.container=
s.getDocument().createElement("div");window.tabindex="0";s.container.style.position="relative";s.container.className="container";window.document.body.appendChild(s.container);var a=s.getWindow().location.href,a=s.getQueryStringValue(a,"locale");""==a&&(a="en-us");s.dataLocale=a;s.getWindow();s.getWindow();s.root=new n("tom_and_jerry_seasonal",1024,768,new Od);s.root.init();window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){a=n.isMobile()?
s.TARGET_FPS_MOBILE:s.TARGET_FPS;window.setTimeout(s.update,1E3/a)};s.update()}else window.location.href="cookies.html";else window.location.href="unsupported.html"};s.getQueryStringValue=function(a,b){var c=a.split("?");if(2>c.length)return"";for(var c=c[1].split("&"),d=0,e=c.length;d<e;){var f=d++;if($a.startsWith(c[f],b)&&(f=c[f].split("="),!(2>f.length)))return f[1]}return""};s.update=function(){s.root.fixedUpdate();s.root.update();s.root.render();s.root.postUpdate();"1"==Y.getProperty("debugDraw")&&
s.root.debugRender();window.requestAnimFrame(s.update)};s.getDocument=function(){return window.document};s.getWindow=function(){return window};s.getCanvas=function(){return s.canvas};s.getContainer=function(){return s.container};s.getBasePath=function(){for(var a=window.location.href.split("/"),b="",c=0,d=a.length-1;c<d;)var e=c++,b=b+(a[e]+"/");return b};Math.__name__=["Math"];var Ja=function(){};Ja.__name__=["Reflect"];Ja.field=function(a,b){try{return a[b]}catch(c){return null}};Ja.setProperty=
function(a,b,c){var d,e;e=a.__properties__?d=a.__properties__["set_"+b]:!1;if(e)a[d](c);else a[b]=c};Ja.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty,d;for(d in a)"__id__"!=d&&("hx__closures__"!=d&&c.call(a,d))&&b.push(d)}return b};Ja.isFunction=function(a){return"function"==typeof a?!(a.__name__||a.__ename__):!1};Ja.compareMethods=function(a,b){return a==b?!0:Ja.isFunction(a)&&Ja.isFunction(b)?a.scope==b.scope&&a.method==b.method?null!=a.method:!1:!1};var pa=function(){};
pa.__name__=["Std"];pa.string=function(a){return C.__string_rec(a,"")};pa.parseInt=function(a){var b=parseInt(a,10);0!=b||120!=F.cca(a,1)&&88!=F.cca(a,1)||(b=parseInt(a));return isNaN(b)?null:b};var kc=function(){this.b=""};kc.__name__=["StringBuf"];kc.prototype={__class__:kc};var $a=function(){};$a.__name__=["StringTools"];$a.startsWith=function(a,b){return a.length>=b.length?F.substr(a,0,b.length)==b:!1};$a.replace=function(a,b,c){return a.split(b).join(c)};var sb=function(){};sb.__name__=["Type"];
sb.getSuperClass=function(a){return a.__super__};sb.getClassName=function(a){a=a.__name__;return null==a?null:a.join(".")};var E=function(a){this.nodeType=a;this.children=[];this.attributeMap=new Pa};E.__name__=["Xml"];E.parse=function(a){return Vb.parse(a)};E.createElement=function(a){var b=new E(E.Element);if(b.nodeType!=E.Element)throw new P("Bad node type, expected Element but found "+b.nodeType);b.nodeName=a;return b};E.createPCData=function(a){var b=new E(E.PCData);if(b.nodeType==E.Document||
b.nodeType==E.Element)throw new P("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};E.createCData=function(a){var b=new E(E.CData);if(b.nodeType==E.Document||b.nodeType==E.Element)throw new P("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};E.createComment=function(a){var b=new E(E.Comment);if(b.nodeType==E.Document||b.nodeType==E.Element)throw new P("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};E.createDocType=function(a){var b=new E(E.DocType);if(b.nodeType==
E.Document||b.nodeType==E.Element)throw new P("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};E.createProcessingInstruction=function(a){var b=new E(E.ProcessingInstruction);if(b.nodeType==E.Document||b.nodeType==E.Element)throw new P("Bad node type, unexpected "+b.nodeType);b.nodeValue=a;return b};E.createDocument=function(){return new E(E.Document)};E.prototype={get:function(a){if(this.nodeType!=E.Element)throw new P("Bad node type, expected Element but found "+this.nodeType);var b=
this.attributeMap;return null!=ba[a]?b.getReserved(a):b.h[a]},set:function(a,b){if(this.nodeType!=E.Element)throw new P("Bad node type, expected Element but found "+this.nodeType);var c=this.attributeMap;null!=ba[a]?c.setReserved(a,b):c.h[a]=b},exists:function(a){if(this.nodeType!=E.Element)throw new P("Bad node type, expected Element but found "+this.nodeType);var b=this.attributeMap;return null!=ba[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},elementsNamed:function(a){if(this.nodeType!=E.Document&&
this.nodeType!=E.Element)throw new P("Bad node type, expected Element or Document but found "+this.nodeType);for(var b=[],c=0,d=this.children;c<d.length;){var e=d[c];++c;var f;if(e.nodeType==E.Element){if(e.nodeType!=E.Element)throw new P("Bad node type, expected Element but found "+e.nodeType);f=e.nodeName==a}else f=!1;f&&b.push(e)}return F.iter(b)},addChild:function(a){if(this.nodeType!=E.Document&&this.nodeType!=E.Element)throw new P("Bad node type, expected Element or Document but found "+this.nodeType);
null!=a.parent&&a.parent.removeChild(a);this.children.push(a);a.parent=this},removeChild:function(a){if(this.nodeType!=E.Document&&this.nodeType!=E.Element)throw new P("Bad node type, expected Element or Document but found "+this.nodeType);return F.remove(this.children,a)?(a.parent=null,!0):!1},__class__:E};var lb=function(){this.lowerBound=new u;this.upperBound=new u};lb.__name__=["box2D","collision","B2AABB"];lb.prototype={isValid:function(){var a=this.upperBound.y-this.lowerBound.y;return a=(a=
0<=this.upperBound.x-this.lowerBound.x&&0<=a)&&this.lowerBound.isValid()?this.upperBound.isValid():!1},getCenter:function(){return new u((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},getExtents:function(){return new u((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},contains:function(a){var b;return b=(b=(b=(b=this.lowerBound.x<=a.lowerBound.x)?this.lowerBound.y<=a.lowerBound.y:!1)?a.upperBound.x<=this.upperBound.x:!1)?a.upperBound.y<=
this.upperBound.y:!1},rayCast:function(a,b){var c=-Number.MAX_VALUE,d=Number.MAX_VALUE,e=b.p1.x,f=b.p1.y,g=b.p2.x-b.p1.x,k=b.p2.y-b.p1.y,h=Math.abs(g),m=Math.abs(k),N=a.normal;if(h<Number.MIN_VALUE){if(e<this.lowerBound.x||this.upperBound.x<e)return!1}else if(h=1/g,g=(this.lowerBound.x-e)*h,e=(this.upperBound.x-e)*h,h=-1,g>e&&(h=g,g=e,e=h,h=1),g>c&&(N.x=h,N.y=0,c=g),d=Math.min(d,e),c>d)return!1;if(m<Number.MIN_VALUE){if(f<this.lowerBound.y||this.upperBound.y<f)return!1}else if(h=1/k,g=(this.lowerBound.y-
f)*h,e=(this.upperBound.y-f)*h,h=-1,g>e&&(h=g,g=e,e=h,h=1),g>c&&(N.y=h,N.x=0,c=g),d=Math.min(d,e),c>d)return!1;a.fraction=c;return!0},testOverlap:function(a){var b=a.lowerBound.y-this.upperBound.y,c=this.lowerBound.y-a.upperBound.y;return 0<a.lowerBound.x-this.upperBound.x||0<b||0<this.lowerBound.x-a.upperBound.x||0<c?!1:!0},combine:function(a,b){this.lowerBound.x=Math.min(a.lowerBound.x,b.lowerBound.x);this.lowerBound.y=Math.min(a.lowerBound.y,b.lowerBound.y);this.upperBound.x=Math.max(a.upperBound.x,
b.upperBound.x);this.upperBound.y=Math.max(a.upperBound.y,b.upperBound.y)},__class__:lb};var u=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};u.__name__=["box2D","common","math","B2Vec2"];u.make=function(a,b){return new u(a,b)};u.prototype={setZero:function(){this.y=this.x=0},set:function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b},setV:function(a){this.x=a.x;this.y=a.y},getNegative:function(){return new u(-this.x,-this.y)},negativeSelf:function(){this.x=-this.x;this.y=-this.y},
copy:function(){return new u(this.x,this.y)},add:function(a){this.x+=a.x;this.y+=a.y},subtract:function(a){this.x-=a.x;this.y-=a.y},multiply:function(a){this.x*=a;this.y*=a},mulM:function(a){var b=this.x;this.x=a.col1.x*b+a.col2.x*this.y;this.y=a.col1.y*b+a.col2.y*this.y},mulTM:function(a){var b=r.dot(this,a.col1);this.y=r.dot(this,a.col2);this.x=b},crossVF:function(a){var b=this.x;this.x=a*this.y;this.y=-a*b},crossFV:function(a){var b=this.x;this.x=-a*this.y;this.y=a*b},minV:function(a){this.x=this.x<
a.x?this.x:a.x;this.y=this.y<a.y?this.y:a.y},maxV:function(a){this.x=this.x>a.x?this.x:a.x;this.y=this.y>a.y?this.y:a.y},abs:function(){0>this.x&&(this.x=-this.x);0>this.y&&(this.y=-this.y)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSquared:function(){return this.x*this.x+this.y*this.y},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var b=1/a;this.x*=b;this.y*=b;return a},isValid:function(){return r.isValid(this.x)?r.isValid(this.y):
!1},__class__:u};var Pd=function(){this.v=new u;this.id=new Ec};Pd.__name__=["box2D","collision","ClipVertex"];Pd.prototype={set:function(a){this.v.setV(a.v);this.id.set(a.id)},__class__:Pd};var Ec=function(){this.features=new Gf;this.features._m_id=this};Ec.__name__=["box2D","collision","B2ContactID"];Ec.prototype={set:function(a){this.set_key(a._key)},copy:function(){var a=new Ec;a.set_key(this.get_key());return a},get_key:function(){return this._key},set_key:function(a){this._key=a;this.features._referenceEdge=
this._key&255;this.features._incidentEdge=(this._key&65280)>>8&255;this.features._incidentVertex=(this._key&16711680)>>16&255;this.features._flip=(this._key&-16777216)>>24&255;return this._key},__class__:Ec,__properties__:{set_key:"set_key",get_key:"get_key"}};var Gf=function(){};Gf.__name__=["box2D","collision","Features"];Gf.prototype={get_referenceEdge:function(){return this._referenceEdge},set_referenceEdge:function(a){this._referenceEdge=a;this._m_id._key=this._m_id._key&-256|this._referenceEdge&
255;return a},get_incidentEdge:function(){return this._incidentEdge},set_incidentEdge:function(a){this._incidentEdge=a;this._m_id._key=this._m_id._key&-65281|this._incidentEdge<<8&65280;return a},get_incidentVertex:function(){return this._incidentVertex},set_incidentVertex:function(a){this._incidentVertex=a;this._m_id._key=this._m_id._key&-16711681|this._incidentVertex<<16&16711680;return a},get_flip:function(){return this._flip},set_flip:function(a){this._flip=a;this._m_id._key=this._m_id._key&16777215|
this._flip<<24&-16777216;return a},__class__:Gf,__properties__:{set_flip:"set_flip",get_flip:"get_flip",set_incidentVertex:"set_incidentVertex",get_incidentVertex:"get_incidentVertex",set_incidentEdge:"set_incidentEdge",get_incidentEdge:"get_incidentEdge",set_referenceEdge:"set_referenceEdge",get_referenceEdge:"get_referenceEdge"}};var M=function(){};M.__name__=["box2D","collision","B2Collision"];M.clipSegmentToLine=function(a,b,c,d){var e,f=0;e=b[0];var g=e.v;e=b[1];var k=e.v,h=c.x*g.x+c.y*g.y-d;
e=c.x*k.x+c.y*k.y-d;0>=h&&a[f++].set(b[0]);0>=e&&a[f++].set(b[1]);0>h*e&&(c=h/(h-e),e=a[f],e=e.v,e.x=g.x+c*(k.x-g.x),e.y=g.y+c*(k.y-g.y),e=a[f],e.id=(0<h?b[0]:b[1]).id,++f);return f};M.edgeSeparation=function(a,b,c,d,e){var f=a.m_vertices;a=a.m_normals;var g=d.m_vertexCount,k=d.m_vertices,h,m;h=b.R;m=a[c];a=h.col1.x*m.x+h.col2.x*m.y;d=h.col1.y*m.x+h.col2.y*m.y;h=e.R;var N=h.col1.x*a+h.col1.y*d;h=h.col2.x*a+h.col2.y*d;for(var x=0,l=Number.MAX_VALUE,n=0;n<g;){var r=n++;m=k[r];m=m.x*N+m.y*h;m<l&&(l=
m,x=r)}m=f[c];h=b.R;c=b.position.x+(h.col1.x*m.x+h.col2.x*m.y);b=b.position.y+(h.col1.y*m.x+h.col2.y*m.y);m=k[x];h=e.R;f=e.position.x+(h.col1.x*m.x+h.col2.x*m.y);e=e.position.y+(h.col1.y*m.x+h.col2.y*m.y);return(f-c)*a+(e-b)*d};M.findMaxSeparation=function(a,b,c,d,e){var f=b.m_vertexCount,g=b.m_normals,k,h=e.R;k=d.m_centroid;var m=e.position.x+(h.col1.x*k.x+h.col2.x*k.y),N=e.position.y+(h.col1.y*k.x+h.col2.y*k.y),h=c.R;k=b.m_centroid;for(var m=m-(c.position.x+(h.col1.x*k.x+h.col2.x*k.y)),N=N-(c.position.y+
(h.col1.y*k.x+h.col2.y*k.y)),h=m*c.R.col1.x+N*c.R.col1.y,N=m*c.R.col2.x+N*c.R.col2.y,m=0,x=-Number.MAX_VALUE,l=0;l<f;){var n=l++;k=g[n];k=k.x*h+k.y*N;k>x&&(x=k,m=n)}g=M.edgeSeparation(b,c,m,d,e);x=0<=m-1?m-1:f-1;h=M.edgeSeparation(b,c,x,d,e);l=m+1<f?m+1:0;N=M.edgeSeparation(b,c,l,d,e);if(h>g&&h>N)k=-1;else if(N>g)k=1,x=l,h=N;else return a[0]=m,g;for(;;)if(m=-1==k?0<=x-1?x-1:f-1:x+1<f?x+1:0,g=M.edgeSeparation(b,c,m,d,e),g>h)x=m,h=g;else break;a[0]=x;return h};M.findIncidentEdge=function(a,b,c,d,e,
f){var g=b.m_normals,k=e.m_vertexCount;b=e.m_vertices;e=e.m_normals;var h;h=c.R;c=g[d];var g=h.col1.x*c.x+h.col2.x*c.y,m=h.col1.y*c.x+h.col2.y*c.y;h=f.R;c=h.col1.x*g+h.col1.y*m;m=h.col2.x*g+h.col2.y*m;g=c;h=0;for(var N=Number.MAX_VALUE,x=0;x<k;){var l=x++;c=e[l];c=g*c.x+m*c.y;c<N&&(N=c,h=l)}e=h;g=e+1<k?e+1:0;k=a[0];c=b[e];h=f.R;k.v.x=f.position.x+(h.col1.x*c.x+h.col2.x*c.y);k.v.y=f.position.y+(h.col1.y*c.x+h.col2.y*c.y);k.id.features.set_referenceEdge(d);k.id.features.set_incidentEdge(e);k.id.features.set_incidentVertex(0);
k=a[1];c=b[g];h=f.R;k.v.x=f.position.x+(h.col1.x*c.x+h.col2.x*c.y);k.v.y=f.position.y+(h.col1.y*c.x+h.col2.y*c.y);k.id.features.set_referenceEdge(d);k.id.features.set_incidentEdge(g);k.id.features.set_incidentVertex(1)};M.makeClipPointVector=function(){var a=[];a[0]=new Pd;a[1]=new Pd;return a};M.collidePolygons=function(a,b,c,d,e){var f;a.m_pointCount=0;var g=b.m_radius+d.m_radius,k;M.s_edgeAO[0]=0;var h=M.findMaxSeparation(M.s_edgeAO,b,c,d,e);k=M.s_edgeAO[0];if(!(h>g)){var m;M.s_edgeBO[0]=0;var N=
M.findMaxSeparation(M.s_edgeBO,d,e,b,c);m=M.s_edgeBO[0];if(!(N>g)){N>0.98*h+0.001?(h=d,d=b,b=e,a.m_type=za.FACE_B,k=1):(h=b,b=c,c=e,m=k,a.m_type=za.FACE_A,k=0);e=M.s_incidentEdge;M.findIncidentEdge(e,h,b,m,d,c);N=h.m_vertices;d=N[m];var x;x=m+1<h.m_vertexCount?N[m+1|0]:N[0];h=M.s_localTangent;h.set(x.x-d.x,x.y-d.y);h.normalize();N=M.s_localNormal;N.x=h.y;N.y=-h.x;var l=M.s_planePoint;l.set(0.5*(d.x+x.x),0.5*(d.y+x.y));f=M.s_tangent;m=b.R;f.x=m.col1.x*h.x+m.col2.x*h.y;f.y=m.col1.y*h.x+m.col2.y*h.y;
var n=M.s_tangent2;n.x=-f.x;n.y=-f.y;h=M.s_normal;h.x=f.y;h.y=-f.x;var r=M.s_v11,p=M.s_v12;r.x=b.position.x+(m.col1.x*d.x+m.col2.x*d.y);r.y=b.position.y+(m.col1.y*d.x+m.col2.y*d.y);p.x=b.position.x+(m.col1.x*x.x+m.col2.x*x.y);p.y=b.position.y+(m.col1.y*x.x+m.col2.y*x.y);b=h.x*r.x+h.y*r.y;m=f.x*p.x+f.y*p.y+g;x=M.s_clipPoints1;d=M.s_clipPoints2;e=M.clipSegmentToLine(x,e,n,-f.x*r.x-f.y*r.y+g);if(!(2>e||(e=M.clipSegmentToLine(d,x,f,m),2>e))){a.m_localPlaneNormal.setV(N);a.m_localPoint.setV(l);N=e=0;for(l=
w.b2_maxManifoldPoints;N<l;)m=N++,f=d[m],h.x*f.v.x+h.y*f.v.y-b<=g&&(n=a.m_points[e],m=c.R,r=f.v.x-c.position.x,x=f.v.y-c.position.y,n.m_localPoint.x=r*m.col1.x+x*m.col1.y,n.m_localPoint.y=r*m.col2.x+x*m.col2.y,n.m_id.set(f.id),n.m_id.features.set_flip(k),++e);a.m_pointCount=e}}}};M.collideCircles=function(a,b,c,d,e){a.m_pointCount=0;var f,g;f=c.R;g=b.m_p;var k=c.position.x+(f.col1.x*g.x+f.col2.x*g.y);c=c.position.y+(f.col1.y*g.x+f.col2.y*g.y);f=e.R;g=d.m_p;k=e.position.x+(f.col1.x*g.x+f.col2.x*g.y)-
k;e=e.position.y+(f.col1.y*g.x+f.col2.y*g.y)-c;f=b.m_radius+d.m_radius;k*k+e*e>f*f||(a.m_type=za.CIRCLES,a.m_localPoint.setV(b.m_p),a.m_localPlaneNormal.setZero(),a.m_pointCount=1,a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0))};M.collidePolygonAndCircle=function(a,b,c,d,e){a.m_pointCount=0;var f,g,k,h=e.R;k=d.m_p;var m=e.position.y+(h.col1.y*k.x+h.col2.y*k.y);f=e.position.x+(h.col1.x*k.x+h.col2.x*k.y)-c.position.x;g=m-c.position.y;h=c.R;c=f*h.col1.x+g*h.col1.y;var h=f*h.col2.x+
g*h.col2.y,N=0;e=-Number.MAX_VALUE;var m=b.m_radius+d.m_radius,x=b.m_vertexCount,l=b.m_vertices;b=b.m_normals;for(var n=0;n<x;){var r=n++;k=l[r];f=c-k.x;g=h-k.y;k=b[r];k=k.x*f+k.y*g;if(k>m)return;k>e&&(e=k,N=r)}k=N;f=l[k];x=l[k+1<x?k+1:0];e<Number.MIN_VALUE?(a.m_pointCount=1,a.m_type=za.FACE_A,a.m_localPlaneNormal.setV(b[N]),a.m_localPoint.x=0.5*(f.x+x.x),a.m_localPoint.y=0.5*(f.y+x.y),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):(e=(c-x.x)*(f.x-x.x)+(h-x.y)*(f.y-x.y),0>=
(c-f.x)*(x.x-f.x)+(h-f.y)*(x.y-f.y)?(c-f.x)*(c-f.x)+(h-f.y)*(h-f.y)>m*m||(a.m_pointCount=1,a.m_type=za.FACE_A,a.m_localPlaneNormal.x=c-f.x,a.m_localPlaneNormal.y=h-f.y,a.m_localPlaneNormal.normalize(),a.m_localPoint.setV(f),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0)):0>=e?(c-x.x)*(c-x.x)+(h-x.y)*(h-x.y)>m*m||(a.m_pointCount=1,a.m_type=za.FACE_A,a.m_localPlaneNormal.x=c-x.x,a.m_localPlaneNormal.y=h-x.y,a.m_localPlaneNormal.normalize(),a.m_localPoint.setV(x),a.m_points[0].m_localPoint.setV(d.m_p),
a.m_points[0].m_id.set_key(0)):(N=0.5*(f.x+x.x),f=0.5*(f.y+x.y),e=(c-N)*b[k].x+(h-f)*b[k].y,e>m||(a.m_pointCount=1,a.m_type=za.FACE_A,a.m_localPlaneNormal.x=b[k].x,a.m_localPlaneNormal.y=b[k].y,a.m_localPlaneNormal.normalize(),a.m_localPoint.set(N,f),a.m_points[0].m_localPoint.setV(d.m_p),a.m_points[0].m_id.set_key(0))))};M.testOverlap=function(a,b){var c=b.lowerBound,d=a.upperBound,e=c.x-d.x,f=c.y-d.y,c=a.lowerBound,d=b.upperBound,g=c.y-d.y;return 0<e||0<f||0<c.x-d.x||0<g?!1:!0};var Hf=function(){this.position=
new u;this.velocity=new u;this.normal=new u;this.id=new Ec};Hf.__name__=["box2D","collision","B2ContactPoint"];Hf.prototype={__class__:Hf};var If=function(){this.m_v1=new ad;this.m_v2=new ad;this.m_v3=new ad;this.m_vertices=[];this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};If.__name__=["box2D","collision","B2Simplex"];If.prototype={readCache:function(a,b,c,d,e){w.b2Assert(0<=a.count&&3>=a.count);var f,g;this.m_count=a.count;for(var k=this.m_vertices,h,m=0,
N=this.m_count;m<N;)f=m++,h=k[f],h.indexA=a.indexA[f],h.indexB=a.indexB[f],f=b.getVertex(h.indexA),g=d.getVertex(h.indexB),h.wA=r.mulX(c,f),h.wB=r.mulX(e,g),h.w=r.subtractVV(h.wB,h.wA),h.a=0;1<this.m_count&&(a=a.metric,h=this.getMetric(),h<0.5*a||2*a<h||h<Number.MIN_VALUE)&&(this.m_count=0);0==this.m_count&&(h=k[0],h.indexA=0,h.indexB=0,f=b.getVertex(0),g=d.getVertex(0),h.wA=r.mulX(c,f),h.wB=r.mulX(e,g),h.w=r.subtractVV(h.wB,h.wA),this.m_count=1)},writeCache:function(a){a.metric=this.getMetric();
a.count=this.m_count|0;for(var b=this.m_vertices,c=0,d=this.m_count;c<d;){var e=c++;a.indexA[e]=b[e].indexA|0;a.indexB[e]=b[e].indexB|0}},getSearchDirection:function(){switch(this.m_count){case 1:return this.m_v1.w.getNegative();case 2:var a=r.subtractVV(this.m_v2.w,this.m_v1.w);return 0<r.crossVV(a,this.m_v1.w.getNegative())?r.crossFV(1,a):r.crossVF(a,1);default:return w.b2Assert(!1),new u}},getClosestPoint:function(){switch(this.m_count){case 0:return w.b2Assert(!1),new u;case 1:return this.m_v1.w;
case 2:return new u(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return w.b2Assert(!1),new u}},getWitnessPoints:function(a,b){switch(this.m_count){case 0:w.b2Assert(!1);break;case 1:a.setV(this.m_v1.wA);b.setV(this.m_v1.wB);break;case 2:a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;b.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;b.y=this.m_v1.a*this.m_v1.wB.y+
this.m_v2.a*this.m_v2.wB.y;break;case 3:b.x=a.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;b.y=a.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:w.b2Assert(!1)}},getMetric:function(){switch(this.m_count){case 0:return w.b2Assert(!1),0;case 1:return 0;case 2:return r.subtractVV(this.m_v1.w,this.m_v2.w).length();case 3:return r.crossVV(r.subtractVV(this.m_v2.w,this.m_v1.w),r.subtractVV(this.m_v3.w,this.m_v1.w));default:return w.b2Assert(!1),
0}},solve2:function(){var a=this.m_v1.w,b=this.m_v2.w,c=r.subtractVV(b,a),a=-(a.x*c.x+a.y*c.y);0>=a?this.m_count=this.m_v1.a=1:(b=b.x*c.x+b.y*c.y,0>=b?(this.m_count=this.m_v2.a=1,this.m_v1.set(this.m_v2)):(c=1/(b+a),this.m_v1.a=b*c,this.m_v2.a=a*c,this.m_count=2))},solve3:function(){var a=this.m_v1.w,b=this.m_v2.w,c=this.m_v3.w,d=r.subtractVV(b,a),e=r.dot(a,d),f=r.dot(b,d),e=-e,g=r.subtractVV(c,a),k=r.dot(a,g),h=r.dot(c,g),k=-k,m=r.subtractVV(c,b),N=r.dot(b,m),m=r.dot(c,m),N=-N,g=r.crossVV(d,g),d=
g*r.crossVV(b,c),c=g*r.crossVV(c,a),a=g*r.crossVV(a,b);0>=e&&0>=k?this.m_count=this.m_v1.a=1:0<f&&0<e&&0>=a?(h=1/(f+e),this.m_v1.a=f*h,this.m_v2.a=e*h,this.m_count=2):0<h&&0<k&&0>=c?(f=1/(h+k),this.m_v1.a=h*f,this.m_v3.a=k*f,this.m_count=2,this.m_v2.set(this.m_v3)):0>=f&&0>=N?(this.m_count=this.m_v2.a=1,this.m_v1.set(this.m_v2)):0>=h&&0>=m?(this.m_count=this.m_v3.a=1,this.m_v1.set(this.m_v3)):0<m&&0<N&&0>=d?(f=1/(m+N),this.m_v2.a=m*f,this.m_v3.a=N*f,this.m_count=2,this.m_v1.set(this.m_v3)):(f=1/(d+
c+a),this.m_v1.a=d*f,this.m_v2.a=c*f,this.m_v3.a=a*f,this.m_count=3)},__class__:If};var ad=function(){};ad.__name__=["box2D","collision","B2SimplexVertex"];ad.prototype={set:function(a){this.wA.setV(a.wA);this.wB.setV(a.wB);this.w.setV(a.w);this.a=a.a;this.indexA=a.indexA;this.indexB=a.indexB},__class__:ad};var mb=function(){};mb.__name__=["box2D","collision","B2Distance"];mb.distance=function(a,b,c){++mb.b2_gjkCalls;var d=c.proxyA,e=c.proxyB,f=c.transformA,g=c.transformB,k=mb.s_simplex;k.readCache(b,
d,f,e,g);var h=k.m_vertices,m=mb.s_saveA,N=mb.s_saveB,x=0;k.getClosestPoint().lengthSquared();for(var l,n=0;20>n;){x=k.m_count;l=0;for(var p=x;l<p;){var q=l++;m[q]=h[q].indexA;N[q]=h[q].indexB}switch(k.m_count){case 1:break;case 2:k.solve2();break;case 3:k.solve3();break;default:w.b2Assert(!1)}if(3==k.m_count)break;l=k.getClosestPoint();l.lengthSquared();p=k.getSearchDirection();if(p.lengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;l=h[k.m_count];l.indexA=d.getSupport(r.mulTMV(f.R,p.getNegative()))|
0;l.wA=r.mulX(f,d.getVertex(l.indexA));l.indexB=e.getSupport(r.mulTMV(g.R,p))|0;l.wB=r.mulX(g,e.getVertex(l.indexB));l.w=r.subtractVV(l.wB,l.wA);++n;++mb.b2_gjkIters;p=!1;for(q=0;q<x;){var s=q++;if(l.indexA==m[s]&&l.indexB==N[s]){p=!0;break}}if(p)break;++k.m_count}mb.b2_gjkMaxIters=r.max(mb.b2_gjkMaxIters,n)|0;k.getWitnessPoints(a.pointA,a.pointB);a.distance=r.subtractVV(a.pointA,a.pointB).length();a.iterations=n;k.writeCache(b);c.useRadii&&(b=d.m_radius,e=e.m_radius,a.distance>b+e&&a.distance>Number.MIN_VALUE?
(a.distance-=b+e,c=r.subtractVV(a.pointB,a.pointA),c.normalize(),a.pointA.x+=b*c.x,a.pointA.y+=b*c.y,a.pointB.x-=e*c.x,a.pointB.y-=e*c.y):(l=new u,l.x=0.5*(a.pointA.x+a.pointB.x),l.y=0.5*(a.pointA.y+a.pointB.y),a.pointA.x=a.pointB.x=l.x,a.pointA.y=a.pointB.y=l.y,a.distance=0))};var Jf=function(){};Jf.__name__=["box2D","collision","B2DistanceInput"];Jf.prototype={__class__:Jf};var Kf=function(){this.pointA=new u;this.pointB=new u};Kf.__name__=["box2D","collision","B2DistanceOutput"];Kf.prototype={__class__:Kf};
var Qd=function(){this.m_vertices=[]};Qd.__name__=["box2D","collision","B2DistanceProxy"];Qd.prototype={set:function(a){switch(a.getType()[1]){case 1:a=C.__cast(a,nb);this.m_vertices=[];this.m_vertices[0]=a.m_p;this.m_count=1;this.m_radius=a.m_radius;break;case 2:a=C.__cast(a,oa);this.m_vertices=a.m_vertices;this.m_count=a.m_vertexCount;this.m_radius=a.m_radius;break;default:w.b2Assert(!1)}},getSupport:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_count;d<
e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return b},getSupportVertex:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_count;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return this.m_vertices[b]},getVertexCount:function(){return this.m_count},getVertex:function(a){w.b2Assert(0<=a&&a<this.m_count);return this.m_vertices[a]},__class__:Qd};var Lf=function(){this.m_freeList=this.m_root=
null;this.m_insertionCount=this.m_path=0};Lf.__name__=["box2D","collision","B2DynamicTree"];Lf.prototype={createProxy:function(a,b){var c=this.allocateNode(),d=w.b2_aabbExtension,e=w.b2_aabbExtension;c.aabb.lowerBound.x=a.lowerBound.x-d;c.aabb.lowerBound.y=a.lowerBound.y-e;c.aabb.upperBound.x=a.upperBound.x+d;c.aabb.upperBound.y=a.upperBound.y+e;c.userData=b;this.insertLeaf(c);return c},destroyProxy:function(a){this.removeLeaf(a);this.freeNode(a)},moveProxy:function(a,b,c){w.b2Assert(a.isLeaf());
if(a.aabb.contains(b))return!1;this.removeLeaf(a);var d=w.b2_aabbExtension+w.b2_aabbMultiplier*(0<c.x?c.x:-c.x);c=w.b2_aabbExtension+w.b2_aabbMultiplier*(0<c.y?c.y:-c.y);a.aabb.lowerBound.x=b.lowerBound.x-d;a.aabb.lowerBound.y=b.lowerBound.y-c;a.aabb.upperBound.x=b.upperBound.x+d;a.aabb.upperBound.y=b.upperBound.y+c;this.insertLeaf(a);return!0},rebalance:function(a){if(null!=this.m_root)for(var b=0;b<a;){b++;for(var c=this.m_root,d=0;!1==c.isLeaf();)c=0!=(this.m_path>>d&1)?c.child2:c.child1,d=d+1&
31;++this.m_path;this.removeLeaf(c);this.insertLeaf(c)}},getFatAABB:function(a){return a.aabb},getUserData:function(a){return a.userData},query:function(a,b){if(null!=this.m_root){var c=[],d=0;for(c[d++]=this.m_root;0<d;){var e=c[--d];if(e.aabb.testOverlap(b))if(e.isLeaf()){if(!a(e))break}else c[d++]=e.child1,c[d++]=e.child2}}},rayCast:function(a,b){if(null!=this.m_root){var c=b.p1,d=b.p2,e=r.subtractVV(c,d);e.normalize();var e=r.crossFV(1,e),f=r.absV(e),g=b.maxFraction,k=new lb,h;h=c.x+g*(d.x-c.x);
g=c.y+g*(d.y-c.y);k.lowerBound.x=Math.min(c.x,h);k.lowerBound.y=Math.min(c.y,g);k.upperBound.x=Math.max(c.x,h);k.upperBound.y=Math.max(c.y,g);var m=[],l=0;for(m[l++]=this.m_root;0<l;)if(h=m[--l],!1!=h.aabb.testOverlap(k)){var g=h.aabb.getCenter(),x=h.aabb.getExtents();if(!(0<Math.abs(e.x*(c.x-g.x)+e.y*(c.y-g.y))-f.x*x.x-f.y*x.y))if(h.isLeaf()){g=new Rd;g.p1=b.p1;g.p2=b.p2;g.maxFraction=b.maxFraction;g=a(g,h);if(0==g)break;h=c.x+g*(d.x-c.x);g=c.y+g*(d.y-c.y);k.lowerBound.x=Math.min(c.x,h);k.lowerBound.y=
Math.min(c.y,g);k.upperBound.x=Math.max(c.x,h);k.upperBound.y=Math.max(c.y,g)}else m[l++]=h.child1,m[l++]=h.child2}}},allocateNode:function(){if(null!=this.m_freeList){var a=this.m_freeList;this.m_freeList=a.parent;a.parent=null;a.child1=null;a.child2=null;return a}return new bd},freeNode:function(a){a.parent=this.m_freeList;this.m_freeList=a},insertLeaf:function(a){++this.m_insertionCount;if(null==this.m_root)this.m_root=a,this.m_root.parent=null;else{var b=a.aabb.getCenter(),c=this.m_root;if(!1==
c.isLeaf())for(;;){var d=c.child1,c=c.child2,e=Math.abs((d.aabb.lowerBound.x+d.aabb.upperBound.x)/2-b.x)+Math.abs((d.aabb.lowerBound.y+d.aabb.upperBound.y)/2-b.y),f=Math.abs((c.aabb.lowerBound.x+c.aabb.upperBound.x)/2-b.x)+Math.abs((c.aabb.lowerBound.y+c.aabb.upperBound.y)/2-b.y),c=e<f?d:c;if(!1!=c.isLeaf())break}b=c.parent;d=this.allocateNode();d.parent=b;d.userData=null;d.aabb.combine(a.aabb,c.aabb);if(null!=b)for(c.parent.child1==c?b.child1=d:b.child2=d,d.child1=c,d.child2=a,c.parent=d,a.parent=
d;!b.aabb.contains(d.aabb)&&(b.aabb.combine(b.child1.aabb,b.child2.aabb),d=b,b=b.parent,null!=b););else d.child1=c,d.child2=a,c.parent=d,this.m_root=a.parent=d}},removeLeaf:function(a){if(a==this.m_root)this.m_root=null;else{var b=a.parent,c=b.parent;a=b.child1==a?b.child2:b.child1;if(null!=c)for(c.child1==b?c.child1=a:c.child2=a,a.parent=c,this.freeNode(b);null!=c;){b=c.aabb;c.aabb=new lb;c.aabb.combine(c.child1.aabb,c.child2.aabb);if(b.contains(c.aabb))break;c=c.parent}else this.m_root=a,a.parent=
null,this.freeNode(b)}},__class__:Lf};var Mf=function(){};Mf.__name__=["box2D","collision","IBroadPhase"];Mf.prototype={__class__:Mf};var Sd=function(){this.m_tree=new Lf;this.m_moveBuffer=[];this.m_pairBuffer=[];this.m_pairCount=0};Sd.__name__=["box2D","collision","B2DynamicTreeBroadPhase"];Sd.__interfaces__=[Mf];Sd.prototype={createProxy:function(a,b){var c=this.m_tree.createProxy(a,b);++this.m_proxyCount;this.bufferMove(c);return c},destroyProxy:function(a){this.unBufferMove(a);--this.m_proxyCount;
this.m_tree.destroyProxy(a)},moveProxy:function(a,b,c){this.m_tree.moveProxy(a,b,c)&&this.bufferMove(a)},testOverlap:function(a,b){var c=this.m_tree.getFatAABB(a),d=this.m_tree.getFatAABB(b);return c.testOverlap(d)},getUserData:function(a){return this.m_tree.getUserData(a)},getFatAABB:function(a){return this.m_tree.getFatAABB(a)},getProxyCount:function(){return this.m_proxyCount},updatePairs:function(a){for(var b=this,c=this.m_pairCount=0,d=this.m_moveBuffer;c<d.length;){var e=[d[c]];++c;var f=function(a){return function(c){if(c==
a[0])return!0;b.m_pairCount==b.m_pairBuffer.length&&(b.m_pairBuffer[b.m_pairCount]=new Nf);var d=b.m_pairBuffer[b.m_pairCount];c.id<a[0].id?(d.proxyA=c,d.proxyB=a[0]):(d.proxyA=a[0],d.proxyB=c);++b.m_pairCount;return!0}}(e),e=this.m_tree.getFatAABB(e[0]);this.m_tree.query(f,e)}this.m_moveBuffer=[];c=!0;for(d=0;c;)if(d>=this.m_pairCount)c=!1;else{var f=this.m_pairBuffer[d],e=this.m_tree.getUserData(f.proxyA),g=this.m_tree.getUserData(f.proxyB);a(e,g);for(++d;d<this.m_pairCount;){e=this.m_pairBuffer[d];
if(e.proxyA!=f.proxyA||e.proxyB!=f.proxyB)break;++d}}},query:function(a,b){this.m_tree.query(a,b)},rayCast:function(a,b){this.m_tree.rayCast(a,b)},validate:function(){},rebalance:function(a){this.m_tree.rebalance(a)},bufferMove:function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a},unBufferMove:function(a){F.remove(this.m_moveBuffer,a)},comparePairs:function(a,b){return 0},__class__:Sd};var bd=function(){this.aabb=new lb;this.id=bd.currentID++};bd.__name__=["box2D","collision","B2DynamicTreeNode"];
bd.prototype={isLeaf:function(){return null==this.child1},__class__:bd};var Nf=function(){};Nf.__name__=["box2D","collision","B2DynamicTreePair"];Nf.prototype={__class__:Nf};var cd=function(){this.m_pointCount=0;this.m_points=[];for(var a=0,b=w.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new Of}this.m_localPlaneNormal=new u;this.m_localPoint=new u};cd.__name__=["box2D","collision","B2Manifold"];cd.prototype={reset:function(){for(var a=0,b=w.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c].reset()}this.m_localPlaneNormal.setZero();
this.m_localPoint.setZero();this.m_type=za.CIRCLES;this.m_pointCount=0},set:function(a){this.m_pointCount=a.m_pointCount;for(var b=0,c=w.b2_maxManifoldPoints;b<c;){var d=b++;this.m_points[d].set(a.m_points[d])}this.m_localPlaneNormal.setV(a.m_localPlaneNormal);this.m_localPoint.setV(a.m_localPoint);this.m_type=a.m_type},copy:function(){var a=new cd;a.set(this);return a},__class__:cd};var Of=function(){this.m_localPoint=new u;this.m_id=new Ec;this.reset()};Of.__name__=["box2D","collision","B2ManifoldPoint"];
Of.prototype={reset:function(){this.m_localPoint.setZero();this.m_tangentImpulse=this.m_normalImpulse=0;this.m_id.set_key(0)},set:function(a){this.m_localPoint.setV(a.m_localPoint);this.m_normalImpulse=a.m_normalImpulse;this.m_tangentImpulse=a.m_tangentImpulse;this.m_id.set(a.m_id)},__class__:Of};var za={__ename__:!0,__constructs__:["CIRCLES","FACE_A","FACE_B"],CIRCLES:["CIRCLES",0]};za.CIRCLES.__enum__=za;za.FACE_A=["FACE_A",1];za.FACE_A.__enum__=za;za.FACE_B=["FACE_B",2];za.FACE_B.__enum__=za;za.__empty_constructs__=
[za.CIRCLES,za.FACE_A,za.FACE_B];var Rd=function(a,b,c){null==c&&(c=1);this.p1=new u;this.p2=new u;null!=a&&this.p1.setV(a);null!=b&&this.p2.setV(b);this.maxFraction=c};Rd.__name__=["box2D","collision","B2RayCastInput"];Rd.prototype={__class__:Rd};var Pf=function(){this.normal=new u};Pf.__name__=["box2D","collision","B2RayCastOutput"];Pf.prototype={__class__:Pf};var Qf=function(){this.m_localPoint=new u;this.m_axis=new u};Qf.__name__=["box2D","collision","B2SeparationFunction"];Qf.prototype={initialize:function(a,
b,c,d,e){this.m_proxyA=b;this.m_proxyB=d;b=a.count;w.b2Assert(0<b&&3>b);var f=new u,g=new u,k,h;if(1==b)this.m_type=Qa.POINTS,f=this.m_proxyA.getVertex(a.indexA[0]),g=this.m_proxyB.getVertex(a.indexB[0]),h=f,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=g,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*h.y),e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),this.m_axis.x=g-f,this.m_axis.y=e-c,this.m_axis.normalize();else{if(a.indexB[0]==a.indexB[1])this.m_type=
Qa.FACE_A,b=this.m_proxyA.getVertex(a.indexA[0]),d=this.m_proxyA.getVertex(a.indexA[1]),g=this.m_proxyB.getVertex(a.indexB[0]),this.m_localPoint.x=0.5*(b.x+d.x),this.m_localPoint.y=0.5*(b.y+d.y),this.m_axis=r.crossVF(r.subtractVV(d,b),1),this.m_axis.normalize(),h=this.m_axis,k=c.R,b=k.col1.x*h.x+k.col2.x*h.y,d=k.col1.y*h.x+k.col2.y*h.y,h=this.m_localPoint,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=g,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*h.y),
e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),a=(g-f)*b+(e-c)*d;else if(a.indexA[0]==a.indexA[0])this.m_type=Qa.FACE_B,k=this.m_proxyB.getVertex(a.indexB[0]),h=this.m_proxyB.getVertex(a.indexB[1]),f=this.m_proxyA.getVertex(a.indexA[0]),this.m_localPoint.x=0.5*(k.x+h.x),this.m_localPoint.y=0.5*(k.y+h.y),this.m_axis=r.crossVF(r.subtractVV(h,k),1),this.m_axis.normalize(),h=this.m_axis,k=e.R,b=k.col1.x*h.x+k.col2.x*h.y,d=k.col1.y*h.x+k.col2.y*h.y,h=this.m_localPoint,k=e.R,g=e.position.x+(k.col1.x*h.x+k.col2.x*
h.y),e=e.position.y+(k.col1.y*h.x+k.col2.y*h.y),h=f,k=c.R,f=c.position.x+(k.col1.x*h.x+k.col2.x*h.y),c=c.position.y+(k.col1.y*h.x+k.col2.y*h.y),a=(f-g)*b+(c-e)*d;else{b=this.m_proxyA.getVertex(a.indexA[0]);d=this.m_proxyA.getVertex(a.indexA[1]);k=this.m_proxyB.getVertex(a.indexB[0]);h=this.m_proxyB.getVertex(a.indexB[1]);r.mulX(c,f);f=r.mulMV(c.R,r.subtractVV(d,b));r.mulX(e,g);a=r.mulMV(e.R,r.subtractVV(h,k));e=f.x*f.x+f.y*f.y;c=a.x*a.x+a.y*a.y;var m=r.subtractVV(a,f),g=f.x*m.x+f.y*m.y,m=a.x*m.x+
a.y*m.y,f=f.x*a.x+f.y*a.y,l=e*c-f*f;a=0;0!=l&&(a=r.clamp((f*m-g*c)/l,0,1));0>(f*a+m)/c&&(a=r.clamp((f-g)/e,0,1));f=new u;f.x=b.x+a*(d.x-b.x);f.y=b.y+a*(d.y-b.y);g=new u;g.x=k.x+a*(h.x-k.x);g.y=k.y+a*(h.y-k.y);0==a||1==a?(this.m_type=Qa.FACE_B,this.m_axis=r.crossVF(r.subtractVV(h,k),1),this.m_axis.normalize(),this.m_localPoint=g):(this.m_type=Qa.FACE_A,this.m_axis=r.crossVF(r.subtractVV(d,b),1),this.m_localPoint=f)}0>a&&this.m_axis.negativeSelf()}},evaluate:function(a,b){var c,d,e;switch(this.m_type[1]){case 0:return c=
r.mulTMV(a.R,this.m_axis),d=r.mulTMV(b.R,this.m_axis.getNegative()),c=this.m_proxyA.getSupportVertex(c),d=this.m_proxyB.getSupportVertex(d),c=r.mulX(a,c),d=r.mulX(b,d),e=(d.x-c.x)*this.m_axis.x+(d.y-c.y)*this.m_axis.y;case 1:return e=r.mulMV(a.R,this.m_axis),c=r.mulX(a,this.m_localPoint),d=r.mulTMV(b.R,e.getNegative()),d=this.m_proxyB.getSupportVertex(d),d=r.mulX(b,d),e=(d.x-c.x)*e.x+(d.y-c.y)*e.y;case 2:return e=r.mulMV(b.R,this.m_axis),d=r.mulX(b,this.m_localPoint),c=r.mulTMV(a.R,e.getNegative()),
c=this.m_proxyA.getSupportVertex(c),c=r.mulX(a,c),e=(c.x-d.x)*e.x+(c.y-d.y)*e.y}},__class__:Qf};var Qa={__ename__:!0,__constructs__:["POINTS","FACE_A","FACE_B"],POINTS:["POINTS",0]};Qa.POINTS.__enum__=Qa;Qa.FACE_A=["FACE_A",1];Qa.FACE_A.__enum__=Qa;Qa.FACE_B=["FACE_B",2];Qa.FACE_B.__enum__=Qa;Qa.__empty_constructs__=[Qa.POINTS,Qa.FACE_A,Qa.FACE_B];var Rf=function(){this.indexA=[];this.indexB=[]};Rf.__name__=["box2D","collision","B2SimplexCache"];Rf.prototype={__class__:Rf};var Sf=function(){this.proxyA=
new Qd;this.proxyB=new Qd;this.sweepA=new Wb;this.sweepB=new Wb};Sf.__name__=["box2D","collision","B2TOIInput"];Sf.prototype={__class__:Sf};var zb=function(a,b){this.position=new u;this.R=new ka;null!=a&&(this.position.setV(a),this.R.setM(b))};zb.__name__=["box2D","common","math","B2Transform"];zb.prototype={initialize:function(a,b){this.position.setV(a);this.R.setM(b)},setIdentity:function(){this.position.setZero();this.R.setIdentity()},set:function(a){this.position.setV(a.position);this.R.setM(a.R)},
getAngle:function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},__class__:zb};var ka=function(){this.col1=new u(0,1);this.col2=new u(0,1)};ka.__name__=["box2D","common","math","B2Mat22"];ka.fromAngle=function(a){var b=new ka;b.set(a);return b};ka.fromVV=function(a,b){var c=new ka;c.setVV(a,b);return c};ka.prototype={set:function(a){var b=Math.cos(a);a=Math.sin(a);this.col1.x=b;this.col2.x=-a;this.col1.y=a;this.col2.y=b},setVV:function(a,b){this.col1.setV(a);this.col2.setV(b)},copy:function(){var a=
new ka;a.setM(this);return a},setM:function(a){this.col1.setV(a.col1);this.col2.setV(a.col2)},addM:function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y},setIdentity:function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1},setZero:function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0},getAngle:function(){return Math.atan2(this.col1.y,this.col1.x)},getInverse:function(a){var b=this.col1.x,c=this.col2.x,d=this.col1.y,e=this.col2.y,
f=b*e-c*d;0!=f&&(f=1/f);a.col1.x=f*e;a.col2.x=-f*c;a.col1.y=-f*d;a.col2.y=f*b;return a},solve:function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,k=d*g-e*f;0!=k&&(k=1/k);a.x=k*(g*b-e*c);a.y=k*(d*c-f*b);return a},abs:function(){this.col1.abs();this.col2.abs()},__class__:ka};var Q=function(){};Q.__name__=["box2D","collision","B2TimeOfImpact"];Q.timeOfImpact=function(a){++Q.b2_toiCalls;var b=a.proxyA,c=a.proxyB,d=a.sweepA,e=a.sweepB;w.b2Assert(d.t0==e.t0);w.b2Assert(1-d.t0>Number.MIN_VALUE);
var f=b.m_radius+c.m_radius;a=a.tolerance;var g=0,k=0,h=0;Q.s_cache.count=0;for(Q.s_distanceInput.useRadii=!1;;){d.getTransform(Q.s_xfA,g);e.getTransform(Q.s_xfB,g);Q.s_distanceInput.proxyA=b;Q.s_distanceInput.proxyB=c;Q.s_distanceInput.transformA=Q.s_xfA;Q.s_distanceInput.transformB=Q.s_xfB;mb.distance(Q.s_distanceOutput,Q.s_cache,Q.s_distanceInput);if(0>=Q.s_distanceOutput.distance){g=1;break}Q.s_fcn.initialize(Q.s_cache,b,Q.s_xfA,c,Q.s_xfB);var m=Q.s_fcn.evaluate(Q.s_xfA,Q.s_xfB);if(0>=m){g=1;
break}0==k&&(h=m>f?r.max(f-a,0.75*f):r.max(m-a,0.02*f));if(m-h<0.5*a){if(0==k){g=1;break}break}var l=g,x=g,n=1;d.getTransform(Q.s_xfA,n);e.getTransform(Q.s_xfB,n);var p=Q.s_fcn.evaluate(Q.s_xfA,Q.s_xfB);if(p>=h){g=1;break}for(var q=0;;){var u;u=0!=(q&1)?x+(h-m)*(n-x)/(p-m):0.5*(x+n);d.getTransform(Q.s_xfA,u);e.getTransform(Q.s_xfB,u);var s=Q.s_fcn.evaluate(Q.s_xfA,Q.s_xfB);if(r.abs(s-h)<0.025*a){l=u;break}s>h?(x=u,m=s):(n=u,p=s);++q;++Q.b2_toiRootIters;if(50==q)break}Q.b2_toiMaxRootIters=r.max(Q.b2_toiMaxRootIters,
q)|0;if(l<(1+100*Number.MIN_VALUE)*g)break;g=l;++k;++Q.b2_toiIters;if(1E3==k)break}Q.b2_toiMaxIters=r.max(Q.b2_toiMaxIters,k)|0;return g};var Tf=function(){this.m_normal=new u;this.m_points=[];for(var a=0,b=w.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new u}};Tf.__name__=["box2D","collision","B2WorldManifold"];Tf.prototype={initialize:function(a,b,c,d,e){if(0!=a.m_pointCount){var f,g,k,h,m,l,x;switch(a.m_type[1]){case 0:g=b.R;f=a.m_localPoint;k=b.position.x+g.col1.x*f.x+g.col2.x*f.y;h=
b.position.y+g.col1.y*f.x+g.col2.y*f.y;g=d.R;f=a.m_points[0].m_localPoint;a=d.position.x+g.col1.x*f.x+g.col2.x*f.y;f=d.position.y+g.col1.y*f.x+g.col2.y*f.y;g=a-k;d=f-h;m=g*g+d*d;m>Number.MIN_VALUE*Number.MIN_VALUE?(m=Math.sqrt(m),this.m_normal.x=g/m,this.m_normal.y=d/m):(this.m_normal.x=1,this.m_normal.y=0);g=h+c*this.m_normal.y;f-=e*this.m_normal.y;this.m_points[0].x=0.5*(k+c*this.m_normal.x+(a-e*this.m_normal.x));this.m_points[0].y=0.5*(g+f);break;case 1:g=b.R;f=a.m_localPlaneNormal;k=g.col1.x*
f.x+g.col2.x*f.y;h=g.col1.y*f.x+g.col2.y*f.y;g=b.R;f=a.m_localPoint;m=b.position.x+g.col1.x*f.x+g.col2.x*f.y;l=b.position.y+g.col1.y*f.x+g.col2.y*f.y;this.m_normal.x=k;this.m_normal.y=h;b=0;for(var n=a.m_pointCount;b<n;){var r=b++;g=d.R;f=a.m_points[r].m_localPoint;x=d.position.x+g.col1.x*f.x+g.col2.x*f.y;f=d.position.y+g.col1.y*f.x+g.col2.y*f.y;this.m_points[r].x=x+0.5*(c-(x-m)*k-(f-l)*h-e)*k;this.m_points[r].y=f+0.5*(c-(x-m)*k-(f-l)*h-e)*h}break;case 2:for(g=d.R,f=a.m_localPlaneNormal,k=g.col1.x*
f.x+g.col2.x*f.y,h=g.col1.y*f.x+g.col2.y*f.y,g=d.R,f=a.m_localPoint,m=d.position.x+g.col1.x*f.x+g.col2.x*f.y,l=d.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_normal.x=-k,this.m_normal.y=-h,d=0,n=a.m_pointCount;d<n;)r=d++,g=b.R,f=a.m_points[r].m_localPoint,x=b.position.x+g.col1.x*f.x+g.col2.x*f.y,f=b.position.y+g.col1.y*f.x+g.col2.y*f.y,this.m_points[r].x=x+0.5*(e-(x-m)*k-(f-l)*h-c)*k,this.m_points[r].y=f+0.5*(e-(x-m)*k-(f-l)*h-c)*h}}},__class__:Tf};var Aa=function(){this.m_type=ca.UNKNOWN_SHAPE;this.m_radius=
w.b2_linearSlop};Aa.__name__=["box2D","collision","shapes","B2Shape"];Aa.testOverlap=function(a,b,c,d){return!0};Aa.prototype={copy:function(){return null},set:function(a){this.m_radius=a.m_radius},getType:function(){return this.m_type},testPoint:function(a,b){return!1},rayCast:function(a,b,c){return!1},computeAABB:function(a,b){},computeMass:function(a,b){},computeSubmergedArea:function(a,b,c,d){return 0},__class__:Aa};var nb=function(a){null==a&&(a=0);Aa.call(this);this.m_p=new u;this.m_type=ca.CIRCLE_SHAPE;
this.m_radius=a};nb.__name__=["box2D","collision","shapes","B2CircleShape"];nb.__super__=Aa;nb.prototype=p(Aa.prototype,{copy:function(){var a=new nb;a.set(this);return a},set:function(a){Aa.prototype.set.call(this,a);C.__instanceof(a,nb)&&(a=C.__cast(a,nb),this.m_p.setV(a.m_p))},testPoint:function(a,b){var c=a.R,d=a.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),c=a.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y),d=b.x-d,c=b.y-c;return d*d+c*c<=this.m_radius*this.m_radius},rayCast:function(a,
b,c){var d=c.R,e=b.p1.x-(c.position.x+(d.col1.x*this.m_p.x+d.col2.x*this.m_p.y));c=b.p1.y-(c.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y));var d=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y,g=e*d+c*f,k=d*d+f*f,h=g*g-k*(e*e+c*c-this.m_radius*this.m_radius);if(0>h||k<Number.MIN_VALUE)return!1;g=-(g+Math.sqrt(h));return 0<=g&&g<=b.maxFraction*k?(g/=k,a.fraction=g,a.normal.x=e+g*d,a.normal.y=c+g*f,a.normal.normalize(),!0):!1},computeAABB:function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),
c=b.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);a.lowerBound.set(d-this.m_radius,c-this.m_radius);a.upperBound.set(d+this.m_radius,c+this.m_radius)},computeMass:function(a,b){a.mass=b*w.b2_pi*this.m_radius*this.m_radius;a.center.setV(this.m_p);a.I=a.mass*(0.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},computeSubmergedArea:function(a,b,c,d){c=r.mulX(c,this.m_p);var e=-(r.dot(a,c)-b);if(e<-this.m_radius+Number.MIN_VALUE)return 0;if(e>this.m_radius)return d.setV(c),
Math.PI*this.m_radius*this.m_radius;b=this.m_radius*this.m_radius;var f=e*e,e=b*(Math.asin(e/this.m_radius)+Math.PI/2)+e*Math.sqrt(b-f);b=-0.6666666666666666*Math.pow(b-f,1.5)/e;d.x=c.x+a.x*b;d.y=c.y+a.y*b;return e},getLocalPosition:function(){return this.m_p},setLocalPosition:function(a){this.m_p.setV(a)},getRadius:function(){return this.m_radius},setRadius:function(a){this.m_radius=a},__class__:nb});var Fc=function(a,b){Aa.call(this);this.s_supportVec=new u;this.m_v1=new u;this.m_v2=new u;this.m_coreV1=
new u;this.m_coreV2=new u;this.m_normal=new u;this.m_direction=new u;this.m_cornerDir1=new u;this.m_cornerDir2=new u;this.m_type=ca.EDGE_SHAPE;this.m_nextEdge=this.m_prevEdge=null;this.m_v1=a;this.m_v2=b;this.m_direction.set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.normalize();this.m_normal.set(this.m_direction.y,-this.m_direction.x);this.m_coreV1.set(-w.b2_toiSlop*(this.m_normal.x-this.m_direction.x)+this.m_v1.x,-w.b2_toiSlop*(this.m_normal.y-this.m_direction.y)+
this.m_v1.y);this.m_coreV2.set(-w.b2_toiSlop*(this.m_normal.x+this.m_direction.x)+this.m_v2.x,-w.b2_toiSlop*(this.m_normal.y+this.m_direction.y)+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.set(-this.m_normal.x,-this.m_normal.y)};Fc.__name__=["box2D","collision","shapes","B2EdgeShape"];Fc.__super__=Aa;Fc.prototype=p(Aa.prototype,{testPoint:function(a,b){return!1},rayCast:function(a,b,c){var d,e=b.p2.x-b.p1.x,f=b.p2.y-b.p1.y;d=c.R;var g=c.position.x+(d.col1.x*this.m_v1.x+d.col2.x*
this.m_v1.y),k=c.position.y+(d.col1.y*this.m_v1.x+d.col2.y*this.m_v1.y),h=c.position.y+(d.col1.y*this.m_v2.x+d.col2.y*this.m_v2.y)-k;c=-(c.position.x+(d.col1.x*this.m_v2.x+d.col2.x*this.m_v2.y)-g);d=100*Number.MIN_VALUE;var m=-(e*h+f*c);if(m>d){var g=b.p1.x-g,l=b.p1.y-k,k=g*h+l*c;if(0<=k&&k<=b.maxFraction*m&&(b=-e*l+f*g,-d*m<=b&&b<=m*(1+d)))return a.fraction=k/m,b=Math.sqrt(h*h+c*c),a.normal.x=h/b,a.normal.y=c/b,!0}return!1},computeAABB:function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_v1.x+
c.col2.x*this.m_v1.y),e=b.position.y+(c.col1.y*this.m_v1.x+c.col2.y*this.m_v1.y),f=b.position.x+(c.col1.x*this.m_v2.x+c.col2.x*this.m_v2.y),c=b.position.y+(c.col1.y*this.m_v2.x+c.col2.y*this.m_v2.y);d<f?(a.lowerBound.x=d,a.upperBound.x=f):(a.lowerBound.x=f,a.upperBound.x=d);e<c?(a.lowerBound.y=e,a.upperBound.y=c):(a.lowerBound.y=c,a.upperBound.y=e)},computeMass:function(a,b){a.mass=0;a.center.setV(this.m_v1);a.I=0},computeSubmergedArea:function(a,b,c,d){var e=new u(a.x*b,a.y*b),f=r.mulX(c,this.m_v1);
c=r.mulX(c,this.m_v2);var g=r.dot(a,f)-b;a=r.dot(a,c)-b;if(0<g){if(0<a)return 0;f.x=-a/(g-a)*f.x+g/(g-a)*c.x;f.y=-a/(g-a)*f.y+g/(g-a)*c.y}else 0<a&&(c.x=-a/(g-a)*f.x+g/(g-a)*c.x,c.y=-a/(g-a)*f.y+g/(g-a)*c.y);d.x=(e.x+f.x+c.x)/3;d.y=(e.y+f.y+c.y)/3;return 0.5*((f.x-e.x)*(c.y-e.y)-(f.y-e.y)*(c.x-e.x))},getLength:function(){return this.m_length},getVertex1:function(){return this.m_v1},getVertex2:function(){return this.m_v2},getCoreVertex1:function(){return this.m_coreV1},getCoreVertex2:function(){return this.m_coreV2},
getNormalVector:function(){return this.m_normal},getDirectionVector:function(){return this.m_direction},getCorner1Vector:function(){return this.m_cornerDir1},getCorner2Vector:function(){return this.m_cornerDir2},corner1IsConvex:function(){return this.m_cornerConvex1},corner2IsConvex:function(){return this.m_cornerConvex2},getFirstVertex:function(a){var b=a.R;return new u(a.position.x+(b.col1.x*this.m_coreV1.x+b.col2.x*this.m_coreV1.y),a.position.y+(b.col1.y*this.m_coreV1.x+b.col2.y*this.m_coreV1.y))},
getNextEdge:function(){return this.m_nextEdge},getPrevEdge:function(){return this.m_prevEdge},support:function(a,b,c){var d=a.R,e=a.position.x+(d.col1.x*this.m_coreV1.x+d.col2.x*this.m_coreV1.y),f=a.position.y+(d.col1.y*this.m_coreV1.x+d.col2.y*this.m_coreV1.y),g=a.position.x+(d.col1.x*this.m_coreV2.x+d.col2.x*this.m_coreV2.y);a=a.position.y+(d.col1.y*this.m_coreV2.x+d.col2.y*this.m_coreV2.y);e*b+f*c>g*b+a*c?(this.s_supportVec.x=e,this.s_supportVec.y=f):(this.s_supportVec.x=g,this.s_supportVec.y=
a);return this.s_supportVec},setPrevEdge:function(a,b,c,d){this.m_prevEdge=a;this.m_coreV1=b;this.m_cornerDir1=c;this.m_cornerConvex1=d},setNextEdge:function(a,b,c,d){this.m_nextEdge=a;this.m_coreV2=b;this.m_cornerDir2=c;this.m_cornerConvex2=d},__class__:Fc});var Td=function(){this.mass=0;this.center=new u(0,0);this.I=0};Td.__name__=["box2D","collision","shapes","B2MassData"];Td.prototype={__class__:Td};var oa=function(){Aa.call(this);this.m_type=ca.POLYGON_SHAPE;this.m_centroid=new u;this.m_vertices=
[];this.m_normals=[]};oa.__name__=["box2D","collision","shapes","B2PolygonShape"];oa.asArray=function(a,b){var c=new oa;c.setAsArray(a,b);return c};oa.asVector=function(a,b){var c=new oa;c.setAsVector(a,b);return c};oa.asBox=function(a,b){var c=new oa;c.setAsBox(a,b);return c};oa.asOrientedBox=function(a,b,c,d){null==d&&(d=0);var e=new oa;e.setAsOrientedBox(a,b,c,d);return e};oa.asEdge=function(a,b){var c=new oa;c.setAsEdge(a,b);return c};oa.computeCentroid=function(a,b){for(var c=new u,d=0,e=0;e<
b;){var f=e++,g=a[f],f=f+1<b?a[f+1|0]:a[0],k=0.5*((g.x-0)*(f.y-0)-(g.y-0)*(f.x-0)),d=d+k;c.x+=0.3333333333333333*k*(0+g.x+f.x);c.y+=0.3333333333333333*k*(0+g.y+f.y)}c.x*=1/d;c.y*=1/d;return c};oa.computeOBB=function(a,b,c){for(var d=[],e=0;e<c;){var f=e++;d[f]=b[f]}d[c]=d[0];b=Number.MAX_VALUE;e=1;for(f=c+1;e<f;){for(var g=e++,k=d[g-1|0],h=d[g].x-k.x,m=d[g].y-k.y,g=Math.sqrt(h*h+m*m),h=h/g,m=m/g,l=-m,x=h,n=g=Number.MAX_VALUE,r=-Number.MAX_VALUE,p=-Number.MAX_VALUE,u=0,q=c;u<q;){var s=u++,t=d[s].x-
k.x,w=d[s].y-k.y,s=h*t+m*w,t=l*t+x*w;s<g&&(g=s);t<n&&(n=t);s>r&&(r=s);t>p&&(p=t)}u=(r-g)*(p-n);u<0.95*b&&(b=u,a.R.col1.x=h,a.R.col1.y=m,a.R.col2.x=l,a.R.col2.y=x,h=0.5*(g+r),m=0.5*(n+p),l=a.R,a.center.x=k.x+(l.col1.x*h+l.col2.x*m),a.center.y=k.y+(l.col1.y*h+l.col2.y*m),a.extents.x=0.5*(r-g),a.extents.y=0.5*(p-n))}};oa.__super__=Aa;oa.prototype=p(Aa.prototype,{copy:function(){var a=new oa;a.set(this);return a},set:function(a){Aa.prototype.set.call(this,a);if(C.__instanceof(a,oa)){a=C.__cast(a,oa);
this.m_centroid.setV(a.m_centroid);this.m_vertexCount=a.m_vertexCount;this.reserve(this.m_vertexCount);for(var b=0,c=this.m_vertexCount;b<c;){var d=b++;this.m_vertices[d].setV(a.m_vertices[d]);this.m_normals[d].setV(a.m_normals[d])}}},setAsArray:function(a,b){null==b&&(b=0);for(var c=[],d=0;d<a.length;){var e=a[d];++d;c.push(e)}this.setAsVector(c,b)},setAsVector:function(a,b){null==b&&(b=0);0==b&&(b=a.length);w.b2Assert(2<=b);this.m_vertexCount=b|0;this.reserve(b|0);for(var c=0,d=this.m_vertexCount;c<
d;){var e=c++;this.m_vertices[e].setV(a[e])}c=0;for(d=this.m_vertexCount;c<d;){var e=c++,f=r.subtractVV(this.m_vertices[e+1<this.m_vertexCount?e+1:0],this.m_vertices[e]);w.b2Assert(f.lengthSquared()>Number.MIN_VALUE);this.m_normals[e].setV(r.crossVF(f,1));this.m_normals[e].normalize()}this.m_centroid=oa.computeCentroid(this.m_vertices,this.m_vertexCount)},setAsBox:function(a,b){this.m_vertexCount=4;this.reserve(4);this.m_vertices[0].set(-a,-b);this.m_vertices[1].set(a,-b);this.m_vertices[2].set(a,
b);this.m_vertices[3].set(-a,b);this.m_normals[0].set(0,-1);this.m_normals[1].set(1,0);this.m_normals[2].set(0,1);this.m_normals[3].set(-1,0);this.m_centroid.setZero()},setAsOrientedBox:function(a,b,c,d){null==d&&(d=0);this.m_vertexCount=4;this.reserve(4);this.m_vertices[0].set(-a,-b);this.m_vertices[1].set(a,-b);this.m_vertices[2].set(a,b);this.m_vertices[3].set(-a,b);this.m_normals[0].set(0,-1);this.m_normals[1].set(1,0);this.m_normals[2].set(0,1);this.m_normals[3].set(-1,0);this.m_centroid=c;a=
new zb;a.position=c;a.R.set(d);c=0;for(d=this.m_vertexCount;c<d;)b=c++,this.m_vertices[b]=r.mulX(a,this.m_vertices[b]),this.m_normals[b]=r.mulMV(a.R,this.m_normals[b])},setAsEdge:function(a,b){this.m_vertexCount=2;this.reserve(2);this.m_vertices[0].setV(a);this.m_vertices[1].setV(b);this.m_centroid.x=0.5*(a.x+b.x);this.m_centroid.y=0.5*(a.y+b.y);this.m_normals[0]=r.crossVF(r.subtractVV(b,a),1);this.m_normals[0].normalize();this.m_normals[1].x=-this.m_normals[0].x;this.m_normals[1].y=-this.m_normals[0].y},
testPoint:function(a,b){var c;c=a.R;for(var d=b.x-a.position.x,e=b.y-a.position.y,f=d*c.col1.x+e*c.col1.y,g=d*c.col2.x+e*c.col2.y,k=0,h=this.m_vertexCount;k<h;){var m=k++;c=this.m_vertices[m];d=f-c.x;e=g-c.y;c=this.m_normals[m];if(0<c.x*d+c.y*e)return!1}return!0},rayCast:function(a,b,c){var d=0,e=b.maxFraction,f,g,k,h;f=b.p1.x-c.position.x;g=b.p1.y-c.position.y;k=c.R;var m=f*k.col1.x+g*k.col1.y,l=f*k.col2.x+g*k.col2.y;f=b.p2.x-c.position.x;g=b.p2.y-c.position.y;k=c.R;b=f*k.col1.x+g*k.col1.y-m;k=f*
k.col2.x+g*k.col2.y-l;for(var x=-1,n=0,r=this.m_vertexCount;n<r;){var p=n++;h=this.m_vertices[p];f=h.x-m;g=h.y-l;h=this.m_normals[p];f=h.x*f+h.y*g;g=h.x*b+h.y*k;if(0==g){if(0>f)return!1}else 0>g&&f<d*g?(d=f/g,x=p):0<g&&f<e*g&&(e=f/g);if(e<d-Number.MIN_VALUE)return!1}return 0<=x?(a.fraction=d,k=c.R,h=this.m_normals[x],a.normal.x=k.col1.x*h.x+k.col2.x*h.y,a.normal.y=k.col1.y*h.x+k.col2.y*h.y,!0):!1},computeAABB:function(a,b){for(var c=b.R,d=this.m_vertices[0],e=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),
f=b.position.y+(c.col1.y*d.x+c.col2.y*d.y),g=e,k=f,h=1,m=this.m_vertexCount;h<m;){var l=h++,d=this.m_vertices[l],l=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),d=b.position.y+(c.col1.y*d.x+c.col2.y*d.y);e<l||(e=l);f<d||(f=d);g>l||(g=l);k>d||(k=d)}a.lowerBound.x=e-this.m_radius;a.lowerBound.y=f-this.m_radius;a.upperBound.x=g+this.m_radius;a.upperBound.y=k+this.m_radius},computeMass:function(a,b){if(2==this.m_vertexCount)a.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=0.5*(this.m_vertices[0].y+
this.m_vertices[1].y),a.mass=0,a.I=0;else{for(var c=0,d=0,e=0,f=0,g=0,k=this.m_vertexCount;g<k;)var h=g++,m=this.m_vertices[h],l=h+1<this.m_vertexCount?this.m_vertices[h+1|0]:this.m_vertices[0],x=m.x-0,n=m.y-0,r=l.x-0,p=l.y-0,h=x*p-n*r,u=0.5*h,e=e+u,c=c+0.3333333333333333*u*(0+m.x+l.x),d=d+0.3333333333333333*u*(0+m.y+l.y),m=x,f=f+h*(0.3333333333333333*(0.25*(m*m+r*m+r*r)+(0*m+0*r))+0+(0.3333333333333333*(0.25*(n*n+p*n+p*p)+(0*n+0*p))+0));a.mass=b*e;a.center.set(c*(1/e),d*(1/e));a.I=b*f}},computeSubmergedArea:function(a,
b,c,d){var e=r.mulTMV(c.R,a),f=b-r.dot(a,c.position),g=[],k=0;a=b=-1;for(var h=!1,m=0,l=this.m_vertexCount;m<l;){var x=m++;g[x]=r.dot(e,this.m_vertices[x])-f;var n=g[x]<-Number.MIN_VALUE;0<x&&(n?h||(b=x-1,++k):h&&(a=x-1,++k));h=n}switch(k){case 0:return h?(a=new Td,this.computeMass(a,1),d.setV(r.mulX(c,a.center)),a.mass):0;case 1:-1==b?b=this.m_vertexCount-1:a=this.m_vertexCount-1}f=(b+1)%this.m_vertexCount;e=(a+1)%this.m_vertexCount;k=(0-g[b])/(g[f]-g[b]);g=(0-g[a])/(g[e]-g[a]);b=new u(this.m_vertices[b].x*
(1-k)+this.m_vertices[f].x*k,this.m_vertices[b].y*(1-k)+this.m_vertices[f].y*k);a=new u(this.m_vertices[a].x*(1-g)+this.m_vertices[e].x*g,this.m_vertices[a].y*(1-g)+this.m_vertices[e].y*g);g=0;k=new u;for(h=this.m_vertices[f];f!=e;)f=(f+1)%this.m_vertexCount,m=f==e?a:this.m_vertices[f],l=0.5*((h.x-b.x)*(m.y-b.y)-(h.y-b.y)*(m.x-b.x)),g+=l,k.x+=l*(b.x+h.x+m.x)/3,k.y+=l*(b.y+h.y+m.y)/3,h=m;k.multiply(1/g);d.setV(r.mulX(c,k));return g},getVertexCount:function(){return this.m_vertexCount},getVertices:function(){return this.m_vertices},
getNormals:function(){return this.m_normals},getSupport:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_vertexCount;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return b},getSupportVertex:function(a){for(var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y,d=1,e=this.m_vertexCount;d<e;){var f=d++,g=this.m_vertices[f].x*a.x+this.m_vertices[f].y*a.y;g>c&&(b=f,c=g)}return this.m_vertices[b]},validate:function(){return!1},
reserve:function(a){for(var b=this.m_vertices.length;b<a;){var c=b++;this.m_vertices[c]=new u;this.m_normals[c]=new u}},__class__:oa});var ca={__ename__:!0,__constructs__:["UNKNOWN_SHAPE","CIRCLE_SHAPE","POLYGON_SHAPE","EDGE_SHAPE"],UNKNOWN_SHAPE:["UNKNOWN_SHAPE",0]};ca.UNKNOWN_SHAPE.__enum__=ca;ca.CIRCLE_SHAPE=["CIRCLE_SHAPE",1];ca.CIRCLE_SHAPE.__enum__=ca;ca.POLYGON_SHAPE=["POLYGON_SHAPE",2];ca.POLYGON_SHAPE.__enum__=ca;ca.EDGE_SHAPE=["EDGE_SHAPE",3];ca.EDGE_SHAPE.__enum__=ca;ca.__empty_constructs__=
[ca.UNKNOWN_SHAPE,ca.CIRCLE_SHAPE,ca.POLYGON_SHAPE,ca.EDGE_SHAPE];var Ud=function(a,b,c){this._r=255*r.clamp(a,0,1)|0;this._g=255*r.clamp(b,0,1)|0;this._b=255*r.clamp(c,0,1)|0};Ud.__name__=["box2D","common","B2Color"];Ud.prototype={set:function(a,b,c){this._r=255*r.clamp(a,0,1)|0;this._g=255*r.clamp(b,0,1)|0;this._b=255*r.clamp(c,0,1)|0},toHex:function(){return"#"+this.componentToHex(this._r)+this.componentToHex(this._g)+this.componentToHex(this._b)},componentToHex:function(a){a=a.toString(16);return"1"==
a.length?"0"+a:a},set_r:function(a){return this._r=255*r.clamp(a,0,1)|0},set_g:function(a){return this._g=255*r.clamp(a,0,1)|0},set_b:function(a){return this._b=255*r.clamp(a,0,1)|0},get_r:function(){return this._r},get_g:function(){return this._g},get_b:function(){return this._b},get_color:function(){return this._r<<16|this._g<<8|this._b},__class__:Ud,__properties__:{get_color:"get_color",set_b:"set_b",set_g:"set_g",set_r:"set_r"}};var w=function(){};w.__name__=["box2D","common","B2Settings"];w.b2MixFriction=
function(a,b){return Math.sqrt(a*b)};w.b2MixRestitution=function(a,b){return a>b?a:b};w.b2Assert=function(a){if(!a)throw new P("Assertion Failed");};var lc=function(a,b,c){this.col1=new Wa;this.col2=new Wa;this.col3=new Wa;null==a&&null==b&&null==c?(this.col1.setZero(),this.col2.setZero(),this.col3.setZero()):(this.col1.setV(a),this.col2.setV(b),this.col3.setV(c))};lc.__name__=["box2D","common","math","B2Mat33"];lc.prototype={setVVV:function(a,b,c){this.col1.setV(a);this.col2.setV(b);this.col3.setV(c)},
copy:function(){return new lc(this.col1,this.col2,this.col3)},setM:function(a){this.col1.setV(a.col1);this.col2.setV(a.col2);this.col3.setV(a.col3)},addM:function(a){this.col1.x+=a.col1.x;this.col1.y+=a.col1.y;this.col1.z+=a.col1.z;this.col2.x+=a.col2.x;this.col2.y+=a.col2.y;this.col2.z+=a.col2.z;this.col3.x+=a.col3.x;this.col3.y+=a.col3.y;this.col3.z+=a.col3.z},setIdentity:function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=
1},setZero:function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0},solve22:function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,k=d*g-e*f;0!=k&&(k=1/k);a.x=k*(g*b-e*c);a.y=k*(d*c-f*b);return a},solve33:function(a,b,c,d){var e=this.col1.x,f=this.col1.y,g=this.col1.z,k=this.col2.x,h=this.col2.y,m=this.col2.z,l=this.col3.x,x=this.col3.y,n=this.col3.z,r=e*(h*n-m*x)+f*(m*l-k*n)+g*(k*x-h*l);0!=r&&(r=
1/r);a.x=r*(b*(h*n-m*x)+c*(m*l-k*n)+d*(k*x-h*l));a.y=r*(e*(c*n-d*x)+f*(d*l-b*n)+g*(b*x-c*l));a.z=r*(e*(h*d-m*c)+f*(m*b-k*d)+g*(k*c-h*b));return a},__class__:lc};var r=function(){};r.__name__=["box2D","common","math","B2Math"];r.__properties__={get_MAX_VALUE:"get_MAX_VALUE",get_MIN_VALUE:"get_MIN_VALUE"};r.isValid=function(a){return isNaN(a)||-Infinity==a||Infinity==a?!1:!0};r.dot=function(a,b){return a.x*b.x+a.y*b.y};r.crossVV=function(a,b){return a.x*b.y-a.y*b.x};r.crossVF=function(a,b){return new u(b*
a.y,-b*a.x)};r.crossFV=function(a,b){return new u(-a*b.y,a*b.x)};r.mulMV=function(a,b){return new u(a.col1.x*b.x+a.col2.x*b.y,a.col1.y*b.x+a.col2.y*b.y)};r.mulTMV=function(a,b){return new u(r.dot(b,a.col1),r.dot(b,a.col2))};r.mulX=function(a,b){var c=r.mulMV(a.R,b);c.x+=a.position.x;c.y+=a.position.y;return c};r.mulXT=function(a,b){var c=r.subtractVV(b,a.position),d=c.x*a.R.col1.x+c.y*a.R.col1.y;c.y=c.x*a.R.col2.x+c.y*a.R.col2.y;c.x=d;return c};r.addVV=function(a,b){return new u(a.x+b.x,a.y+b.y)};
r.subtractVV=function(a,b){return new u(a.x-b.x,a.y-b.y)};r.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)};r.distanceSquared=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};r.mulFV=function(a,b){return new u(a*b.x,a*b.y)};r.addMM=function(a,b){return ka.fromVV(r.addVV(a.col1,b.col1),r.addVV(a.col2,b.col2))};r.mulMM=function(a,b){return ka.fromVV(r.mulMV(a,b.col1),r.mulMV(a,b.col2))};r.mulTMM=function(a,b){var c=new u(r.dot(a.col1,b.col1),r.dot(a.col2,b.col1)),d=new u(r.dot(a.col1,
b.col2),r.dot(a.col2,b.col2));return ka.fromVV(c,d)};r.abs=function(a){return 0<a?a:-a};r.absV=function(a){return new u(r.abs(a.x),r.abs(a.y))};r.absM=function(a){return ka.fromVV(r.absV(a.col1),r.absV(a.col2))};r.min=function(a,b){return a<b?a:b};r.minV=function(a,b){return new u(r.min(a.x,b.x),r.min(a.y,b.y))};r.max=function(a,b){return a>b?a:b};r.maxV=function(a,b){return new u(r.max(a.x,b.x),r.max(a.y,b.y))};r.clamp=function(a,b,c){return a<b?b:a>c?c:a};r.clampV=function(a,b,c){return r.maxV(b,
r.minV(a,c))};r.swap=function(a,b){var c=a[0];a[0]=b[0];b[0]=c};r.random=function(){return 2*Math.random()-1};r.randomRange=function(a,b){var c=Math.random();return(b-a)*c+a};r.nextPowerOfTwo=function(a){a|=a>>1&2147483647;a|=a>>2&1073741823;a|=a>>4&268435455;a|=a>>8&16777215;return(a|a>>16&65535)+1};r.isPowerOfTwo=function(a){return 0<a&&0==(a&a-1)};r.get_MIN_VALUE=function(){return Number.MIN_VALUE};r.get_MAX_VALUE=function(){return Number.MAX_VALUE};var Wb=function(){this.localCenter=new u;this.c0=
new u;this.c=new u};Wb.__name__=["box2D","common","math","B2Sweep"];Wb.prototype={set:function(a){this.localCenter.setV(a.localCenter);this.c0.setV(a.c0);this.c.setV(a.c);this.a0=a.a0;this.a=a.a;this.t0=a.t0},copy:function(){var a=new Wb;a.localCenter.setV(this.localCenter);a.c0.setV(this.c0);a.c.setV(this.c);a.a0=this.a0;a.a=this.a;a.t0=this.t0;return a},getTransform:function(a,b){a.position.x=(1-b)*this.c0.x+b*this.c.x;a.position.y=(1-b)*this.c0.y+b*this.c.y;a.R.set((1-b)*this.a0+b*this.a);var c=
a.R;a.position.x-=c.col1.x*this.localCenter.x+c.col2.x*this.localCenter.y;a.position.y-=c.col1.y*this.localCenter.x+c.col2.y*this.localCenter.y},advance:function(a){if(this.t0<a&&1-this.t0>Number.MIN_VALUE){var b=(a-this.t0)/(1-this.t0);this.c0.x=(1-b)*this.c0.x+b*this.c.x;this.c0.y=(1-b)*this.c0.y+b*this.c.y;this.a0=(1-b)*this.a0+b*this.a;this.t0=a}},__class__:Wb};var Wa=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c};Wa.__name__=["box2D","common","math",
"B2Vec3"];Wa.prototype={setZero:function(){this.x=this.y=this.z=0},set:function(a,b,c){this.x=a;this.y=b;this.z=c},setV:function(a){this.x=a.x;this.y=a.y;this.z=a.z},getNegative:function(){return new Wa(-this.x,-this.y,-this.z)},negativeSelf:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z},copy:function(){return new Wa(this.x,this.y,this.z)},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z},subtract:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z},multiply:function(a){this.x*=a;this.y*=
a;this.z*=a},__class__:Wa};var y=function(a,b){this.m_xf=new zb;this.m_sweep=new Wb;this.m_linearVelocity=new u;this.m_force=new u;this.m_flags=0;a.bullet&&(this.m_flags|=y.e_bulletFlag);a.fixedRotation&&(this.m_flags|=y.e_fixedRotationFlag);a.allowSleep&&(this.m_flags|=y.e_allowSleepFlag);a.awake&&(this.m_flags|=y.e_awakeFlag);a.active&&(this.m_flags|=y.e_activeFlag);this.m_world=b;this.m_xf.position.setV(a.position);this.m_xf.R.set(a.angle);this.m_sweep.localCenter.setZero();this.m_sweep.t0=1;this.m_sweep.a0=
this.m_sweep.a=a.angle;var c=this.m_xf.R,d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.setV(this.m_sweep.c);this.m_contactList=this.m_controllerList=this.m_jointList=null;this.m_controllerCount=0;this.m_next=this.m_prev=null;this.m_linearVelocity.setV(a.linearVelocity);this.m_angularVelocity=a.angularVelocity;this.m_linearDamping=a.linearDamping;
this.m_angularDamping=a.angularDamping;this.m_force.set(0,0);this.m_sleepTime=this.m_torque=0;this.m_type=a.type;this.m_invMass=this.m_type==y.b2_dynamicBody?this.m_mass=1:this.m_mass=0;this.m_invI=this.m_I=0;this.m_inertiaScale=a.inertiaScale;this.m_userData=a.userData;this.m_fixtureList=null;this.m_fixtureCount=0};y.__name__=["box2D","dynamics","B2Body"];y.prototype={connectEdges:function(a,b,c){var d=Math.atan2(b.getDirectionVector().y,b.getDirectionVector().x);c=Math.tan(0.5*(d-c));c=r.mulFV(c,
b.getDirectionVector());c=r.subtractVV(c,b.getNormalVector());c=r.mulFV(w.b2_toiSlop,c);c=r.addVV(c,b.getVertex1());var e=r.addVV(a.getDirectionVector(),b.getDirectionVector());e.normalize();var f=0<r.dot(a.getDirectionVector(),b.getNormalVector());a.setNextEdge(b,c,e,f);b.setPrevEdge(a,c,e,f);return d},createFixture:function(a){if(!0==this.m_world.isLocked())return null;var b=new Kb;b.create(this,this.m_xf,a);0!=(this.m_flags&y.e_activeFlag)&&b.createProxy(this.m_world.m_contactManager.m_broadPhase,
this.m_xf);b.m_next=this.m_fixtureList;this.m_fixtureList=b;++this.m_fixtureCount;b.m_body=this;0<b.m_density&&this.resetMassData();this.m_world.m_flags|=ga.e_newFixture;return b},createFixture2:function(a,b){null==b&&(b=0);var c=new Uf;c.shape=a;c.density=b;return this.createFixture(c)},DestroyFixture:function(a){if(!0!=this.m_world.isLocked()){for(var b=this.m_fixtureList,c=null;null!=b;){if(b==a){null!=c?c.m_next=a.m_next:this.m_fixtureList=a.m_next;break}c=b;b=b.m_next}for(b=this.m_contactList;null!=
b;){var c=b.contact,b=b.next,d=c.getFixtureA(),e=c.getFixtureB();a!=d&&a!=e||this.m_world.m_contactManager.destroy(c)}0!=(this.m_flags&y.e_activeFlag)&&a.destroyProxy(this.m_world.m_contactManager.m_broadPhase);a.destroy();a.m_body=null;a.m_next=null;--this.m_fixtureCount;this.resetMassData()}},setPositionAndAngle:function(a,b){var c;if(!0!=this.m_world.isLocked()){this.m_xf.R.set(b);this.m_xf.position.setV(a);c=this.m_xf.R;var d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y;
this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y;this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.setV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=b;d=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;null!=c;)c.synchronize(d,this.m_xf,this.m_xf),c=c.m_next;this.m_world.m_contactManager.findNewContacts()}},setTransform:function(a){this.setPositionAndAngle(a.position,a.getAngle())},getTransform:function(){return this.m_xf},getPosition:function(){return this.m_xf.position},
setPosition:function(a){this.setPositionAndAngle(a,this.getAngle())},getAngle:function(){return this.m_sweep.a},setAngle:function(a){this.setPositionAndAngle(this.getPosition(),a)},getWorldCenter:function(){return this.m_sweep.c},getLocalCenter:function(){return this.m_sweep.localCenter},setLinearVelocity:function(a){this.m_type!=y.b2_staticBody&&this.m_linearVelocity.setV(a)},getLinearVelocity:function(){return this.m_linearVelocity},setAngularVelocity:function(a){this.m_type!=y.b2_staticBody&&(this.m_angularVelocity=
a)},getAngularVelocity:function(){return this.m_angularVelocity},getDefinition:function(){var a=new Vd;a.type=this.getType();a.allowSleep=(this.m_flags&y.e_allowSleepFlag)==y.e_allowSleepFlag;a.angle=this.getAngle();a.angularDamping=this.m_angularDamping;a.angularVelocity=this.m_angularVelocity;a.fixedRotation=(this.m_flags&y.e_fixedRotationFlag)==y.e_fixedRotationFlag;a.bullet=(this.m_flags&y.e_bulletFlag)==y.e_bulletFlag;a.awake=(this.m_flags&y.e_awakeFlag)==y.e_awakeFlag;a.linearDamping=this.m_linearDamping;
a.linearVelocity.setV(this.getLinearVelocity());a.position=this.getPosition();a.userData=this.getUserData();return a},applyForce:function(a,b){this.m_type==y.b2_dynamicBody&&(!1==this.isAwake()&&this.setAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)},applyTorque:function(a){this.m_type==y.b2_dynamicBody&&(!1==this.isAwake()&&this.setAwake(!0),this.m_torque+=a)},applyImpulse:function(a,b){this.m_type==y.b2_dynamicBody&&(!1==this.isAwake()&&
this.setAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x))},split:function(a){for(var b=this.getLinearVelocity().copy(),c=this.getAngularVelocity(),d=this.getWorldCenter(),e=this.m_world.createBody(this.getDefinition()),f=null,g=this.m_fixtureList;null!=g;)if(a(g)){var k=g.m_next;null!=f?f.m_next=k:this.m_fixtureList=k;this.m_fixtureCount--;g.m_next=e.m_fixtureList;
e.m_fixtureList=g;e.m_fixtureCount++;g.m_body=e;g=k}else f=g,g=g.m_next;this.resetMassData();e.resetMassData();f=this.getWorldCenter();a=e.getWorldCenter();f=r.addVV(b,r.crossFV(c,r.subtractVV(f,d)));b=r.addVV(b,r.crossFV(c,r.subtractVV(a,d)));this.setLinearVelocity(f);e.setLinearVelocity(b);this.setAngularVelocity(c);e.setAngularVelocity(c);this.synchronizeFixtures();e.synchronizeFixtures();return e},merge:function(a){for(var b=a.m_fixtureList;null!=b;){var c=b.m_next;a.m_fixtureCount--;b.m_next=
this.m_fixtureList;this.m_fixtureList=b;this.m_fixtureCount++;b.m_body=a;b=c}this.m_fixtureCount=0;this.getWorldCenter();a.getWorldCenter();this.getLinearVelocity().copy();a.getLinearVelocity().copy();this.getAngularVelocity();a.getAngularVelocity();this.resetMassData();this.synchronizeFixtures()},getMass:function(){return this.m_mass},getInertia:function(){return this.m_I},getMassData:function(a){a.mass=this.m_mass;a.I=this.m_I;a.center.setV(this.m_sweep.localCenter)},setMassData:function(a){w.b2Assert(!1==
this.m_world.isLocked());if(!0!=this.m_world.isLocked()&&this.m_type==y.b2_dynamicBody){this.m_invI=this.m_I=this.m_invMass=0;this.m_mass=a.mass;0>=this.m_mass&&(this.m_mass=1);this.m_invMass=1/this.m_mass;0<a.I&&0==(this.m_flags&y.e_fixedRotationFlag)&&(this.m_I=a.I-this.m_mass*(a.center.x*a.center.x+a.center.y*a.center.y),this.m_invI=1/this.m_I);var b=this.m_sweep.c.copy();this.m_sweep.localCenter.setV(a.center);this.m_sweep.c0.setV(r.mulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.setV(this.m_sweep.c0);
this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-b.y);this.m_linearVelocity.y+=this.m_angularVelocity*(this.m_sweep.c.x-b.x)}},resetMassData:function(){this.m_invI=this.m_I=this.m_invMass=this.m_mass=0;this.m_sweep.localCenter.setZero();if(this.m_type!=y.b2_staticBody&&this.m_type!=y.b2_kinematicBody){for(var a=u.make(0,0),b=this.m_fixtureList;null!=b;)if(0!=b.m_density){var c=b.getMassData();this.m_mass+=c.mass;a.x+=c.center.x*c.mass;a.y+=c.center.y*c.mass;this.m_I+=c.I;b=b.m_next}0<
this.m_mass?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):this.m_invMass=this.m_mass=1;0<this.m_I&&0==(this.m_flags&y.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(a.x*a.x+a.y*a.y),this.m_I*=this.m_inertiaScale,w.b2Assert(0<this.m_I),this.m_invI=1/this.m_I):this.m_invI=this.m_I=0;b=this.m_sweep.c.copy();this.m_sweep.localCenter.setV(a);this.m_sweep.c0.setV(r.mulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.setV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*
-(this.m_sweep.c.y-b.y);this.m_linearVelocity.y+=this.m_angularVelocity*(this.m_sweep.c.x-b.x)}},getWorldPoint:function(a){var b=this.m_xf.R;a=new u(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return a},getWorldVector:function(a){return r.mulMV(this.m_xf.R,a)},getLocalPoint:function(a){return r.mulXT(this.m_xf,a)},getLocalVector:function(a){return r.mulTMV(this.m_xf.R,a)},getLinearVelocityFromWorldPoint:function(a){return new u(this.m_linearVelocity.x-
this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},getLinearVelocityFromLocalPoint:function(a){var b=this.m_xf.R;a=new u(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);a.x+=this.m_xf.position.x;a.y+=this.m_xf.position.y;return new u(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},getLinearDamping:function(){return this.m_linearDamping},
setLinearDamping:function(a){this.m_linearDamping=a},getAngularDamping:function(){return this.m_angularDamping},setAngularDamping:function(a){this.m_angularDamping=a},setType:function(a){if(this.m_type!=a)for(this.m_type=a,this.resetMassData(),this.m_type==y.b2_staticBody&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0,a=this.m_contactList;null!=a;)a.contact.flagForFiltering(),a=a.next},getType:function(){return this.m_type},setBullet:function(a){this.m_flags=
a?this.m_flags|y.e_bulletFlag:this.m_flags&~y.e_bulletFlag},isBullet:function(){return(this.m_flags&y.e_bulletFlag)==y.e_bulletFlag},setSleepingAllowed:function(a){a?this.m_flags|=y.e_allowSleepFlag:(this.m_flags&=~y.e_allowSleepFlag,this.setAwake(!0))},setAwake:function(a){a?(this.m_flags|=y.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~y.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},isAwake:function(){return(this.m_flags&
y.e_awakeFlag)==y.e_awakeFlag},setFixedRotation:function(a){this.m_flags=a?this.m_flags|y.e_fixedRotationFlag:this.m_flags&~y.e_fixedRotationFlag;this.resetMassData()},isFixedRotation:function(){return(this.m_flags&y.e_fixedRotationFlag)==y.e_fixedRotationFlag},setActive:function(a){if(a!=this.isActive()){var b;if(a)for(this.m_flags|=y.e_activeFlag,a=this.m_world.m_contactManager.m_broadPhase,b=this.m_fixtureList;null!=b;)b.createProxy(a,this.m_xf),b=b.m_next;else{this.m_flags&=~y.e_activeFlag;a=
this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;null!=b;)b.destroyProxy(a),b=b.m_next;for(a=this.m_contactList;null!=a;)b=a,a=a.next,this.m_world.m_contactManager.destroy(b.contact);this.m_contactList=null}}},isActive:function(){return(this.m_flags&y.e_activeFlag)==y.e_activeFlag},isSleepingAllowed:function(){return(this.m_flags&y.e_allowSleepFlag)==y.e_allowSleepFlag},getFixtureList:function(){return this.m_fixtureList},getJointList:function(){return this.m_jointList},getControllerList:function(){return this.m_controllerList},
getContactList:function(){return this.m_contactList},getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},setUserData:function(a){this.m_userData=a},getWorld:function(){return this.m_world},synchronizeFixtures:function(){var a=y.s_xf1;a.R.set(this.m_sweep.a0);var b=a.R,c=this.m_sweep.localCenter;a.position.x=this.m_sweep.c0.x-(b.col1.x*c.x+b.col2.x*c.y);a.position.y=this.m_sweep.c0.y-(b.col1.y*c.x+b.col2.y*c.y);c=this.m_world.m_contactManager.m_broadPhase;for(b=this.m_fixtureList;null!=
b;)b.synchronize(c,a,this.m_xf),b=b.m_next},synchronizeTransform:function(){this.m_xf.R.set(this.m_sweep.a);var a=this.m_xf.R,b=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*b.x+a.col2.x*b.y);this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*b.x+a.col2.y*b.y)},shouldCollide:function(a){if(this.m_type!=y.b2_dynamicBody&&a.m_type!=y.b2_dynamicBody)return!1;for(var b=this.m_jointList;null!=b;){if(b.other==a&&!1==b.joint.m_collideConnected)return!1;b=b.next}return!0},advance:function(a){this.m_sweep.advance(a);
this.m_sweep.c.setV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.synchronizeTransform()},__class__:y};var Vd=function(){this.position=new u;this.linearVelocity=new u;this.userData=null;this.angularDamping=this.linearDamping=this.angularVelocity=this.angle=0;this.awake=this.allowSleep=!0;this.bullet=this.fixedRotation=!1;this.type=y.b2_staticBody;this.active=!0;this.inertiaScale=1};Vd.__name__=["box2D","dynamics","B2BodyDef"];Vd.prototype={__class__:Vd};var dd=function(){};dd.__name__=["box2D",
"dynamics","B2ContactFilter"];dd.prototype={shouldCollide:function(a,b){var c=a.getFilterData(),d=b.getFilterData();return c.groupIndex==d.groupIndex&&0!=c.groupIndex?0<c.groupIndex:0!=(c.maskBits&d.categoryBits)&&0!=(c.categoryBits&d.maskBits)},rayCollide:function(a,b){return null==a?!0:this.shouldCollide(C.__cast(a,Kb),b)},__class__:dd};var Vf=function(){this.normalImpulses=[];this.tangentImpulses=[]};Vf.__name__=["box2D","dynamics","B2ContactImpulse"];Vf.prototype={__class__:Vf};var tb=function(){};
tb.__name__=["box2D","dynamics","B2ContactListener"];tb.prototype={beginContact:function(a){},endContact:function(a){},preSolve:function(a,b){},postSolve:function(a,b){},__class__:tb};var Wd=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=dd.b2_defaultFilter;this.m_contactListener=tb.b2_defaultListener;this.m_contactFactory=new Wf(this.m_allocator);this.m_broadPhase=new Sd};Wd.__name__=["box2D","dynamics","B2ContactManager"];Wd.prototype={addPair:function(a,b){var c=C.__cast(a,
Kb),d=C.__cast(b,Kb),e=c.getBody(),f=d.getBody();if(e!=f){for(var g=f.getContactList();null!=g;){if(g.other==e){var k=g.contact.getFixtureA(),h=g.contact.getFixtureB();if(k==c&&h==d||k==d&&h==c)return}g=g.next}!1!=f.shouldCollide(e)&&!1!=this.m_contactFilter.shouldCollide(c,d)&&(g=this.m_contactFactory.create(c,d),c=g.getFixtureA(),d=g.getFixtureB(),e=c.m_body,f=d.m_body,g.m_prev=null,g.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=g),this.m_world.m_contactList=
g,g.m_nodeA.contact=g,g.m_nodeA.other=f,g.m_nodeA.prev=null,g.m_nodeA.next=e.m_contactList,null!=e.m_contactList&&(e.m_contactList.prev=g.m_nodeA),e.m_contactList=g.m_nodeA,g.m_nodeB.contact=g,g.m_nodeB.other=e,g.m_nodeB.prev=null,g.m_nodeB.next=f.m_contactList,null!=f.m_contactList&&(f.m_contactList.prev=g.m_nodeB),f.m_contactList=g.m_nodeB,++this.m_world.m_contactCount)}},findNewContacts:function(){this.m_broadPhase.updatePairs(q(this,this.addPair))},destroy:function(a){var b=a.getFixtureA(),c=
a.getFixtureB(),b=b.getBody(),c=c.getBody();a.isTouching()&&this.m_contactListener.endContact(a);null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_world.m_contactList&&(this.m_world.m_contactList=a.m_next);null!=a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next);null!=a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev);a.m_nodeA==b.m_contactList&&(b.m_contactList=a.m_nodeA.next);null!=a.m_nodeB.prev&&(a.m_nodeB.prev.next=a.m_nodeB.next);null!=a.m_nodeB.next&&
(a.m_nodeB.next.prev=a.m_nodeB.prev);a.m_nodeB==c.m_contactList&&(c.m_contactList=a.m_nodeB.next);this.m_contactFactory.destroy(a);--this.m_contactCount},collide:function(){for(var a=this.m_world.m_contactList;null!=a;){var b=a.getFixtureA(),c=a.getFixtureB(),d=b.getBody(),e=c.getBody();if(!1==d.isAwake()&&!1==e.isAwake())a=a.getNext();else{if(0!=(a.m_flags&D.e_filterFlag)){if(!1==e.shouldCollide(d)){b=a;a=b.getNext();this.destroy(b);continue}if(!1==this.m_contactFilter.shouldCollide(b,c)){b=a;a=
b.getNext();this.destroy(b);continue}a.m_flags&=~D.e_filterFlag}!1==this.m_broadPhase.testOverlap(b.m_proxy,c.m_proxy)?(b=a,a=b.getNext(),this.destroy(b)):(a.update(this.m_contactListener),a=a.getNext())}}},__class__:Wd};var Ra=function(){this.m_xformScale=this.m_fillAlpha=this.m_alpha=this.m_lineThickness=this.m_drawScale=1;this.m_drawFlags=0};Ra.__name__=["box2D","dynamics","B2DebugDraw"];Ra.prototype={setFlags:function(a){this.m_drawFlags=a},getFlags:function(){return this.m_drawFlags},appendFlags:function(a){this.m_drawFlags|=
a},clearFlags:function(a){this.m_drawFlags&=~a},setSprite:function(a){this.m_sprite=a},getSprite:function(){return this.m_sprite},setDrawScale:function(a){this.m_drawScale=a},getDrawScale:function(){return this.m_drawScale},setLineThickness:function(a){this.m_lineThickness=a},getLineThickness:function(){return this.m_lineThickness},setAlpha:function(a){this.m_alpha=a},getAlpha:function(){return this.m_alpha},setFillAlpha:function(a){this.m_fillAlpha=a},getFillAlpha:function(){return this.m_fillAlpha},
setXFormScale:function(a){this.m_xformScale=a},getXFormScale:function(){return this.m_xformScale},drawPolygon:function(a,b,c){console.log("drawPolygon()");this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);for(c=1;c<b;){var d=c++;this.m_sprite.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale)}this.m_sprite.lineTo(a[0].x*this.m_drawScale,
a[0].y*this.m_drawScale);this.m_sprite.stroke()},drawSolidPolygon:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);c="rgba("+c.get_r()+","+c.get_g()+","+c.get_b()+","+this.m_fillAlpha;this.m_sprite.fillStyle=c+")";for(c=1;c<b;){var d=c++;this.m_sprite.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale)}this.m_sprite.lineTo(a[0].x*
this.m_drawScale,a[0].y*this.m_drawScale);this.m_sprite.stroke();this.m_sprite.fill()},drawCircle:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.arc(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale,0,2*Math.PI,!1);this.m_sprite.stroke()},drawSolidCircle:function(a,b,c,d){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=d.toHex();this.m_sprite.globalAlpha=
this.m_alpha;this.m_sprite.beginPath();c="rgba("+d.get_r()+","+d.get_g()+","+d.get_b()+","+this.m_fillAlpha;this.m_sprite.fillStyle=c+")";this.m_sprite.arc(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale,0,2*Math.PI,!1);this.m_sprite.stroke();this.m_sprite.fill()},drawSegment:function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle=c.toHex();this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a.x*this.m_drawScale,a.y*this.m_drawScale);
this.m_sprite.lineTo(b.x*this.m_drawScale,b.y*this.m_drawScale);this.m_sprite.stroke()},drawTransform:function(a){this.m_sprite.lineWidth=this.m_lineThickness;this.m_sprite.strokeStyle="#FF0000";this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.beginPath();this.m_sprite.moveTo(a.position.x*this.m_drawScale,a.position.y*this.m_drawScale);this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col1.x)*this.m_drawScale,(a.position.y+this.m_xformScale*a.R.col1.y)*this.m_drawScale);this.m_sprite.lineWidth=
this.m_lineThickness;this.m_sprite.strokeStyle="#00FF00";this.m_sprite.globalAlpha=this.m_alpha;this.m_sprite.moveTo(a.position.x*this.m_drawScale,a.position.y*this.m_drawScale);this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col2.x)*this.m_drawScale,(a.position.y+this.m_xformScale*a.R.col2.y)*this.m_drawScale);this.m_sprite.stroke()},__class__:Ra};var ed=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};ed.__name__=["box2D","dynamics","B2FilterData"];ed.prototype={copy:function(){var a=
new ed;a.categoryBits=this.categoryBits;a.maskBits=this.maskBits;a.groupIndex=this.groupIndex;return a},__class__:ed};var Kb=function(){this.m_filter=new ed;this.m_aabb=new lb;this.m_shape=this.m_next=this.m_body=this.m_userData=null;this.m_restitution=this.m_friction=this.m_density=0};Kb.__name__=["box2D","dynamics","B2Fixture"];Kb.prototype={getType:function(){return this.m_shape.getType()},getShape:function(){return this.m_shape},setSensor:function(a){if(this.m_isSensor!=a&&(this.m_isSensor=a,
null!=this.m_body))for(a=this.m_body.getContactList();null!=a;){var b=a.contact,c=b.getFixtureA(),d=b.getFixtureB();c!=this&&d!=this||b.setSensor(c.isSensor()||d.isSensor());a=a.next}},isSensor:function(){return this.m_isSensor},setFilterData:function(a){this.m_filter=a.copy();if(null==this.m_body)for(a=this.m_body.getContactList();null!=a;){var b=a.contact,c=b.getFixtureA(),d=b.getFixtureB();c!=this&&d!=this||b.flagForFiltering();a=a.next}},getFilterData:function(){return this.m_filter.copy()},getBody:function(){return this.m_body},
getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},SetUserData:function(a){this.m_userData=a},testPoint:function(a){return this.m_shape.testPoint(this.m_body.getTransform(),a)},rayCast:function(a,b){return this.m_shape.rayCast(a,b,this.m_body.getTransform())},getMassData:function(a){null==a&&(a=new Td);this.m_shape.computeMass(a,this.m_density);return a},setDensity:function(a){this.m_density=a},getDensity:function(){return this.m_density},getFriction:function(){return this.m_friction},
setFriction:function(a){this.m_friction=a},getRestitution:function(){return this.m_restitution},setRestitution:function(a){this.m_restitution=a},getAABB:function(){return this.m_aabb},create:function(a,b,c){this.m_userData=c.userData;this.m_friction=c.friction;this.m_restitution=c.restitution;this.m_body=a;this.m_next=null;this.m_filter=c.filter.copy();this.m_isSensor=c.isSensor;this.m_shape=c.shape.copy();this.m_density=c.density},destroy:function(){this.m_shape=null},createProxy:function(a,b){this.m_shape.computeAABB(this.m_aabb,
b);this.m_proxy=a.createProxy(this.m_aabb,this)},destroyProxy:function(a){null!=this.m_proxy&&(a.destroyProxy(this.m_proxy),this.m_proxy=null)},synchronize:function(a,b,c){if(null!=this.m_proxy){var d=new lb,e=new lb;this.m_shape.computeAABB(d,b);this.m_shape.computeAABB(e,c);this.m_aabb.combine(d,e);b=r.subtractVV(c.position,b.position);a.moveProxy(this.m_proxy,this.m_aabb,b)}},__class__:Kb};var Uf=function(){this.filter=new ed;this.userData=this.shape=null;this.friction=0.2;this.density=this.restitution=
0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;this.isSensor=!1};Uf.__name__=["box2D","dynamics","B2FixtureDef"];Uf.prototype={__class__:Uf};var mc=function(){this.m_bodies=[];this.m_contacts=[];this.m_joints=[]};mc.__name__=["box2D","dynamics","B2Island"];mc.prototype={initialize:function(a,b,c,d,e,f){this.m_bodyCapacity=a;this.m_contactCapacity=b;this.m_jointCapacity=c;this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;this.m_allocator=d;this.m_listener=e;
this.m_contactSolver=f;for(d=this.m_bodies.length;d<a;)e=d++,this.m_bodies[e]=null;for(a=this.m_contacts.length;a<b;)d=a++,this.m_contacts[d]=null;for(b=this.m_joints.length;b<c;)a=b++,this.m_joints[a]=null},clear:function(){this.m_jointCount=this.m_contactCount=this.m_bodyCount=0},solve:function(a,b,c){for(var d,e=0,f=this.m_bodyCount;e<f;)d=e++,d=this.m_bodies[d],d.getType()==y.b2_dynamicBody&&(d.m_linearVelocity.x+=a.dt*(b.x+d.m_invMass*d.m_force.x),d.m_linearVelocity.y+=a.dt*(b.y+d.m_invMass*
d.m_force.y),d.m_angularVelocity+=a.dt*d.m_invI*d.m_torque,d.m_linearVelocity.multiply(r.clamp(1-a.dt*d.m_linearDamping,0,1)),d.m_angularVelocity*=r.clamp(1-a.dt*d.m_angularDamping,0,1));this.m_contactSolver.initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);b=this.m_contactSolver;b.initVelocityConstraints(a);e=0;for(f=this.m_jointCount;e<f;)d=e++,d=this.m_joints[d],d.initVelocityConstraints(a);e=0;for(f=a.velocityIterations;e<f;){e++;for(var g=0,k=this.m_jointCount;g<k;)d=g++,d=this.m_joints[d],
d.solveVelocityConstraints(a);b.solveVelocityConstraints()}e=0;for(f=this.m_jointCount;e<f;)d=e++,d=this.m_joints[d],d.finalizeVelocityConstraints();b.finalizeVelocityConstraints();e=0;for(f=this.m_bodyCount;e<f;)d=e++,d=this.m_bodies[d],d.getType()!=y.b2_staticBody&&(g=a.dt*d.m_linearVelocity.x,k=a.dt*d.m_linearVelocity.y,g*g+k*k>w.b2_maxTranslationSquared&&(d.m_linearVelocity.normalize(),d.m_linearVelocity.x*=w.b2_maxTranslation*a.inv_dt,d.m_linearVelocity.y*=w.b2_maxTranslation*a.inv_dt),g=a.dt*
d.m_angularVelocity,g*g>w.b2_maxRotationSquared&&(d.m_angularVelocity=0>d.m_angularVelocity?-w.b2_maxRotation*a.inv_dt:w.b2_maxRotation*a.inv_dt),d.m_sweep.c0.setV(d.m_sweep.c),d.m_sweep.a0=d.m_sweep.a,d.m_sweep.c.x+=a.dt*d.m_linearVelocity.x,d.m_sweep.c.y+=a.dt*d.m_linearVelocity.y,d.m_sweep.a+=a.dt*d.m_angularVelocity,d.synchronizeTransform());e=0;for(f=a.positionIterations;e<f;){e++;for(var g=b.solvePositionConstraints(w.b2_contactBaumgarte),k=!0,h=0,m=this.m_jointCount;h<m;)d=h++,d=this.m_joints[d],
d=d.solvePositionConstraints(w.b2_contactBaumgarte),k=k?d:!1;if(g&&k)break}this.report(b.m_constraints);if(c){c=Number.MAX_VALUE;b=w.b2_linearSleepTolerance*w.b2_linearSleepTolerance;e=w.b2_angularSleepTolerance*w.b2_angularSleepTolerance;f=0;for(g=this.m_bodyCount;f<g;)d=f++,d=this.m_bodies[d],d.getType()!=y.b2_staticBody&&(0==(d.m_flags&y.e_allowSleepFlag)&&(c=d.m_sleepTime=0),0==(d.m_flags&y.e_allowSleepFlag)||d.m_angularVelocity*d.m_angularVelocity>e||r.dot(d.m_linearVelocity,d.m_linearVelocity)>
b?c=d.m_sleepTime=0:(d.m_sleepTime+=a.dt,c=r.min(c,d.m_sleepTime)));if(c>=w.b2_timeToSleep)for(a=0,c=this.m_bodyCount;a<c;)b=a++,d=this.m_bodies[b],d.setAwake(!1)}},solveTOI:function(a){this.m_contactSolver.initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);for(var b=this.m_contactSolver,c=0,d=this.m_jointCount;c<d;){var e=c++;this.m_joints[e].initVelocityConstraints(a)}c=0;for(d=a.velocityIterations;c<d;){c++;b.solveVelocityConstraints();for(var e=0,f=this.m_jointCount;e<f;){var g=
e++;this.m_joints[g].solveVelocityConstraints(a)}}c=0;for(d=this.m_bodyCount;c<d;)e=c++,e=this.m_bodies[e],e.getType()!=y.b2_staticBody&&(f=a.dt*e.m_linearVelocity.x,g=a.dt*e.m_linearVelocity.y,f*f+g*g>w.b2_maxTranslationSquared&&(e.m_linearVelocity.normalize(),e.m_linearVelocity.x*=w.b2_maxTranslation*a.inv_dt,e.m_linearVelocity.y*=w.b2_maxTranslation*a.inv_dt),f=a.dt*e.m_angularVelocity,f*f>w.b2_maxRotationSquared&&(e.m_angularVelocity=0>e.m_angularVelocity?-w.b2_maxRotation*a.inv_dt:w.b2_maxRotation*
a.inv_dt),e.m_sweep.c0.setV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=a.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=a.dt*e.m_linearVelocity.y,e.m_sweep.a+=a.dt*e.m_angularVelocity,e.synchronizeTransform());c=0;for(a=a.positionIterations;c<a;){c++;d=b.solvePositionConstraints(0.75);e=!0;f=0;for(g=this.m_jointCount;f<g;)var k=f++,k=this.m_joints[k].solvePositionConstraints(w.b2_contactBaumgarte),e=e?k:!1;if(d&&e)break}this.report(b.m_constraints)},report:function(a){if(null!=this.m_listener)for(var b=
0,c=this.m_contactCount;b<c;){for(var d=b++,e=this.m_contacts[d],d=a[d],f=0,g=d.pointCount;f<g;){var k=f++;mc.s_impulse.normalImpulses[k]=d.points[k].normalImpulse;mc.s_impulse.tangentImpulses[k]=d.points[k].tangentImpulse}this.m_listener.postSolve(e,mc.s_impulse)}},addBody:function(a){a.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=a},addContact:function(a){this.m_contacts[this.m_contactCount++]=a},addJoint:function(a){this.m_joints[this.m_jointCount++]=a},__class__:mc};var fd=
function(){};fd.__name__=["box2D","dynamics","B2TimeStep"];fd.prototype={set:function(a){this.dt=a.dt;this.inv_dt=a.inv_dt;this.positionIterations=a.positionIterations;this.velocityIterations=a.velocityIterations;this.warmStarting=a.warmStarting},__class__:fd};var ga=function(a,b){this.s_stack=[];this.m_contactManager=new Wd;this.m_contactSolver=new Ka;this.m_island=new mc;this.m_controllerList=this.m_jointList=this.m_contactList=this.m_bodyList=this.m_debugDraw=this.m_destructionListener=null;this.m_controllerCount=
this.m_jointCount=this.m_contactCount=this.m_bodyCount=0;ga.m_warmStarting=!0;ga.m_continuousPhysics=!0;this.m_allowSleep=b;this.m_gravity=a;this.m_inv_dt0=0;this.m_contactManager.m_world=this;var c=new Vd;this.m_groundBody=this.createBody(c)};ga.__name__=["box2D","dynamics","B2World"];ga.prototype={setDestructionListener:function(a){this.m_destructionListener=a},setContactFilter:function(a){this.m_contactManager.m_contactFilter=a},setContactListener:function(a){this.m_contactManager.m_contactListener=
a},setDebugDraw:function(a){this.m_debugDraw=a},setBroadPhase:function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;null!=c;){for(var d=c.m_fixtureList;null!=d;)d.m_proxy=a.createProxy(b.getFatAABB(d.m_proxy),d),d=d.m_next;c=c.m_next}},validate:function(){this.m_contactManager.m_broadPhase.validate()},getProxyCount:function(){return this.m_contactManager.m_broadPhase.getProxyCount()},createBody:function(a){if(!0==this.isLocked())return null;
a=new y(a,this);a.m_prev=null;a.m_next=this.m_bodyList;null!=this.m_bodyList&&(this.m_bodyList.m_prev=a);this.m_bodyList=a;++this.m_bodyCount;return a},destroyBody:function(a){if(!0!=this.isLocked()){for(var b=a.m_jointList;null!=b;){var c=b,b=b.next;null!=this.m_destructionListener&&this.m_destructionListener.sayGoodbyeJoint(c.joint);this.destroyJoint(c.joint)}for(b=a.m_controllerList;null!=b;)c=b,b=b.nextController,c.controller.removeBody(a);for(b=a.m_contactList;null!=b;)c=b,b=b.next,this.m_contactManager.destroy(c.contact);
a.m_contactList=null;for(b=a.m_fixtureList;null!=b;)c=b,b=b.m_next,null!=this.m_destructionListener&&this.m_destructionListener.sayGoodbyeFixture(c),c.destroyProxy(this.m_contactManager.m_broadPhase),c.destroy();a.m_fixtureList=null;a.m_fixtureCount=0;null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_bodyList&&(this.m_bodyList=a.m_next);--this.m_bodyCount}},createJoint:function(a){var b=ha.create(a,null);b.m_prev=null;b.m_next=this.m_jointList;null!=this.m_jointList&&
(this.m_jointList.m_prev=b);this.m_jointList=b;++this.m_jointCount;b.m_edgeA.joint=b;b.m_edgeA.other=b.m_bodyB;b.m_edgeA.prev=null;b.m_edgeA.next=b.m_bodyA.m_jointList;null!=b.m_bodyA.m_jointList&&(b.m_bodyA.m_jointList.prev=b.m_edgeA);b.m_bodyA.m_jointList=b.m_edgeA;b.m_edgeB.joint=b;b.m_edgeB.other=b.m_bodyA;b.m_edgeB.prev=null;b.m_edgeB.next=b.m_bodyB.m_jointList;null!=b.m_bodyB.m_jointList&&(b.m_bodyB.m_jointList.prev=b.m_edgeB);b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,d=a.bodyB;if(!1==a.collideConnected)for(a=
d.getContactList();null!=a;)a.other==c&&a.contact.flagForFiltering(),a=a.next;return b},destroyJoint:function(a){var b=a.m_collideConnected;null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);a==this.m_jointList&&(this.m_jointList=a.m_next);var c=a.m_bodyA,d=a.m_bodyB;c.setAwake(!0);d.setAwake(!0);null!=a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next);null!=a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev);a.m_edgeA==c.m_jointList&&(c.m_jointList=a.m_edgeA.next);
a.m_edgeA.prev=null;a.m_edgeA.next=null;null!=a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next);null!=a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev);a.m_edgeB==d.m_jointList&&(d.m_jointList=a.m_edgeB.next);a.m_edgeB.prev=null;a.m_edgeB.next=null;ha.destroy(a,null);--this.m_jointCount;if(!1==b)for(a=d.getContactList();null!=a;)a.other==c&&a.contact.flagForFiltering(),a=a.next},addController:function(a){a.m_next=this.m_controllerList;a.m_prev=null;this.m_controllerList=a;a.m_world=this;this.m_controllerCount++;
return a},removeController:function(a){null!=a.m_prev&&(a.m_prev.m_next=a.m_next);null!=a.m_next&&(a.m_next.m_prev=a.m_prev);this.m_controllerList==a&&(this.m_controllerList=a.m_next);this.m_controllerCount--},createController:function(a){if(a.m_world!=this)throw new P("Controller can only be a member of one world");a.m_next=this.m_controllerList;a.m_prev=null;null!=this.m_controllerList&&(this.m_controllerList.m_prev=a);this.m_controllerList=a;++this.m_controllerCount;a.m_world=this;return a},destroyController:function(a){a.clear();
null!=a.m_next&&(a.m_next.m_prev=a.m_prev);null!=a.m_prev&&(a.m_prev.m_next=a.m_next);a==this.m_controllerList&&(this.m_controllerList=a.m_next);--this.m_controllerCount},setWarmStarting:function(a){ga.m_warmStarting=a},setContinuousPhysics:function(a){ga.m_continuousPhysics=a},getBodyCount:function(){return this.m_bodyCount},getJointCount:function(){return this.m_jointCount},getContactCount:function(){return this.m_contactCount},setGravity:function(a){this.m_gravity=a},getGravity:function(){return this.m_gravity},
getGroundBody:function(){return this.m_groundBody},step:function(a,b,c){0!=(this.m_flags&ga.e_newFixture)&&(this.m_contactManager.findNewContacts(),this.m_flags&=~ga.e_newFixture);this.m_flags|=ga.e_locked;var d=ga.s_timestep2;d.dt=a;d.velocityIterations=b;d.positionIterations=c;d.inv_dt=0<a?1/a:0;d.dtRatio=this.m_inv_dt0*a;d.warmStarting=ga.m_warmStarting;this.m_contactManager.collide();0<d.dt&&this.solve(d);ga.m_continuousPhysics&&0<d.dt&&this.solveTOI(d);0<d.dt&&(this.m_inv_dt0=d.inv_dt);this.m_flags&=
~ga.e_locked},clearForces:function(){for(var a=this.m_bodyList;null!=a;)a.m_force.setZero(),a.m_torque=0,a=a.m_next},drawDebugData:function(){if(null!=this.m_debugDraw){var a=this.m_debugDraw.getFlags(),b,c,d;new u;new u;new u;var e;new lb;new lb;e=[new u,new u,new u,new u];var f=new Ud(0,0,0);if(0!=(a&Ra.e_shapeBit))for(b=this.m_bodyList;null!=b;){e=b.m_xf;for(c=b.getFixtureList();null!=c;)d=c.getShape(),!1==b.isActive()?f.set(0.5,0.5,0.3):b.getType()==y.b2_staticBody?f.set(0.5,0.9,0.5):b.getType()==
y.b2_kinematicBody?f.set(0.5,0.5,0.9):!1==b.isAwake()?f.set(0.6,0.6,0.6):f.set(0.9,0.7,0.7),this.drawShape(d,e,f),c=c.m_next;b=b.m_next}if(0!=(a&Ra.e_jointBit))for(b=this.m_jointList;null!=b;)this.drawJoint(b),b=b.m_next;if(0!=(a&Ra.e_controllerBit))for(b=this.m_controllerList;null!=b;)b.draw(this.m_debugDraw),b=b.m_next;if(0!=(a&Ra.e_pairBit))for(f.set(0.3,0.9,0.9),b=this.m_contactManager.m_contactList;null!=b;)d=b.getFixtureA(),c=b.getFixtureB(),d=d.getAABB().getCenter(),c=c.getAABB().getCenter(),
this.m_debugDraw.drawSegment(d,c,f),b=b.getNext();if(0!=(a&Ra.e_aabbBit))for(d=this.m_contactManager.m_broadPhase,e=[new u,new u,new u,new u],b=this.m_bodyList;null!=b;){if(!1!=b.isActive())for(c=b.getFixtureList();null!=c;){var g=d.getFatAABB(c.m_proxy);e[0].set(g.lowerBound.x,g.lowerBound.y);e[1].set(g.upperBound.x,g.lowerBound.y);e[2].set(g.upperBound.x,g.upperBound.y);e[3].set(g.lowerBound.x,g.upperBound.y);this.m_debugDraw.drawPolygon(e,4,f);c=c.getNext()}b=b.getNext()}if(0!=(a&Ra.e_centerOfMassBit))for(b=
this.m_bodyList;null!=b;)e=ga.s_xf,e.R=b.m_xf.R,e.position=b.getWorldCenter(),this.m_debugDraw.drawTransform(e),b=b.m_next}},queryAABB:function(a,b){var c=this.m_contactManager.m_broadPhase;c.query(function(b){b=c.getUserData(b);return a(b)},b)},queryShape:function(a,b,c){null==c&&(c=new zb,c.setIdentity());var d=this.m_contactManager.m_broadPhase,e=new lb;b.computeAABB(e,c);d.query(function(e){e=C.__cast(d.getUserData(e),Kb);var g=e.getShape(),k=e.getBody().getTransform();return Aa.testOverlap(b,
c,g,k)?a(e):!0},e)},queryPoint:function(a,b){var c=this.m_contactManager.m_broadPhase,d=new lb;d.lowerBound.set(b.x-w.b2_linearSlop,b.y-w.b2_linearSlop);d.upperBound.set(b.x+w.b2_linearSlop,b.y+w.b2_linearSlop);c.query(function(d){d=C.__cast(c.getUserData(d),Kb);return d.testPoint(b)?a(d):!0},d)},rayCast:function(a,b,c){var d=this.m_contactManager.m_broadPhase,e=new Pf,f=new Rd(b,c);d.rayCast(function(f,k){var h=d.getUserData(k),h=C.__cast(h,Kb);if(h.rayCast(e,f)){var m=e.fraction,l=new u((1-m)*b.x+
m*c.x,(1-m)*b.y+m*c.y);return a(h,l,e.normal,m)}return f.maxFraction},f)},rayCastOne:function(a,b){var c;this.rayCast(function(a,b,f,g){c=a;return g},a,b);return c},rayCastAll:function(a,b){var c=[];this.rayCast(function(a,b,f,g){c[c.length]=a;return 1},a,b);return c},getBodyList:function(){return this.m_bodyList},getJointList:function(){return this.m_jointList},getContactList:function(){return this.m_contactList},isLocked:function(){return 0<(this.m_flags&ga.e_locked)},solve:function(a){for(var b,
c=this.m_controllerList;null!=c;)c.step(a),c=c.m_next;var d=this.m_island;d.initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(b=this.m_bodyList;null!=b;)b.m_flags&=~y.e_islandFlag,b=b.m_next;for(c=this.m_contactList;null!=c;)c.m_flags&=~D.e_islandFlag,c=c.m_next;for(c=this.m_jointList;null!=c;)c.m_islandFlag=!1,c=c.m_next;for(var c=this.s_stack,e=this.m_bodyList;null!=e;){if(0==(e.m_flags&y.e_islandFlag)&&!1!=e.isAwake()&&
!1!=e.isActive()&&e.getType()!=y.b2_staticBody){d.clear();var f=0;c[f++]=e;for(e.m_flags|=y.e_islandFlag;0<f;)if(b=c[--f],d.addBody(b),!1==b.isAwake()&&b.setAwake(!0),b.getType()!=y.b2_staticBody){for(var g,k=b.m_contactList;null!=k;)0==(k.contact.m_flags&D.e_islandFlag)&&(!0!=k.contact.isSensor()&&!1!=k.contact.isEnabled()&&!1!=k.contact.isTouching())&&(d.addContact(k.contact),k.contact.m_flags|=D.e_islandFlag,g=k.other,0==(g.m_flags&y.e_islandFlag)&&(c[f++]=g,g.m_flags|=y.e_islandFlag)),k=k.next;
for(b=b.m_jointList;null!=b;)!0!=b.joint.m_islandFlag&&(g=b.other,!1!=g.isActive()&&(d.addJoint(b.joint),b.joint.m_islandFlag=!0,0==(g.m_flags&y.e_islandFlag)&&(c[f++]=g,g.m_flags|=y.e_islandFlag))),b=b.next}d.solve(a,this.m_gravity,this.m_allowSleep);f=0;for(g=d.m_bodyCount;f<g;)b=f++,b=d.m_bodies[b],b.getType()==y.b2_staticBody&&(b.m_flags&=~y.e_islandFlag)}e=e.m_next}a=0;for(d=c.length;a<d;){e=a++;if(null==c[e])break;c[e]=null}for(b=this.m_bodyList;null!=b;)!1!=b.isAwake()&&!1!=b.isActive()&&b.getType()!=
y.b2_staticBody&&b.synchronizeFixtures(),b=b.m_next;this.m_contactManager.findNewContacts()},solveTOI:function(a){var b,c,d,e,f=this.m_island;f.initialize(this.m_bodyCount,w.b2_maxTOIContactsPerIsland,w.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var g=ga.s_queue;for(b=this.m_bodyList;null!=b;)b.m_flags&=~y.e_islandFlag,b.m_sweep.t0=0,b=b.m_next;for(b=this.m_contactList;null!=b;)b.m_flags&=~(D.e_toiFlag|D.e_islandFlag),b=b.m_next;for(e=this.m_jointList;null!=
e;)e.m_islandFlag=!1,e=e.m_next;for(;;){e=null;var k=1;for(b=this.m_contactList;null!=b;){if(!0!=b.isSensor()&&!1!=b.isEnabled()&&!1!=b.isContinuous()){c=1;if(0!=(b.m_flags&D.e_toiFlag))c=b.m_toi;else{c=b.m_fixtureA;d=b.m_fixtureB;c=c.m_body;d=d.m_body;if(!(c.getType()==y.b2_dynamicBody&&!1!=c.isAwake()||d.getType()==y.b2_dynamicBody&&!1!=d.isAwake())){b=b.m_next;continue}var h=c.m_sweep.t0;c.m_sweep.t0<d.m_sweep.t0?(h=d.m_sweep.t0,c.m_sweep.advance(h)):d.m_sweep.t0<c.m_sweep.t0&&(h=c.m_sweep.t0,
d.m_sweep.advance(h));c=b.computeTOI(c.m_sweep,d.m_sweep);w.b2Assert(0<=c&&1>=c);0<c&&1>c&&(c=(1-c)*h+c,1<c&&(c=1));b.m_toi=c;b.m_flags|=D.e_toiFlag}Number.MIN_VALUE<c&&c<k&&(e=b,k=c)}b=b.m_next}if(null==e||1-100*Number.MIN_VALUE<k)break;c=e.m_fixtureA;d=e.m_fixtureB;c=c.m_body;d=d.m_body;ga.s_backupA.set(c.m_sweep);ga.s_backupB.set(d.m_sweep);c.advance(k);d.advance(k);e.update(this.m_contactManager.m_contactListener);e.m_flags&=~D.e_toiFlag;if(!0==e.isSensor()||!1==e.isEnabled())c.m_sweep.set(ga.s_backupA),
d.m_sweep.set(ga.s_backupB),c.synchronizeTransform(),d.synchronizeTransform();else if(!1!=e.isTouching()){b=c;b.getType()!=y.b2_dynamicBody&&(b=d);f.clear();d=c=0;g[c+d++]=b;for(b.m_flags|=y.e_islandFlag;0<d;)if(b=g[c++],--d,f.addBody(b),!1==b.isAwake()&&b.setAwake(!0),b.getType()==y.b2_dynamicBody){for(e=b.m_contactList;null!=e&&f.m_contactCount!=f.m_contactCapacity;)0==(e.contact.m_flags&D.e_islandFlag)&&(!0!=e.contact.isSensor()&&!1!=e.contact.isEnabled()&&!1!=e.contact.isTouching())&&(f.addContact(e.contact),
e.contact.m_flags|=D.e_islandFlag,h=e.other,0==(h.m_flags&y.e_islandFlag)&&(h.getType()!=y.b2_staticBody&&(h.advance(k),h.setAwake(!0)),g[c+d]=h,++d,h.m_flags|=y.e_islandFlag)),e=e.next;for(b=b.m_jointList;null!=b;)f.m_jointCount!=f.m_jointCapacity&&!0!=b.joint.m_islandFlag&&(h=b.other,!1!=h.isActive()&&(f.addJoint(b.joint),b.joint.m_islandFlag=!0,0==(h.m_flags&y.e_islandFlag)&&(h.getType()!=y.b2_staticBody&&(h.advance(k),h.setAwake(!0)),g[c+d]=h,++d,h.m_flags|=y.e_islandFlag))),b=b.next}b=ga.s_timestep;
b.warmStarting=!1;b.dt=(1-k)*a.dt;b.inv_dt=1/b.dt;b.dtRatio=0;b.velocityIterations=a.velocityIterations;b.positionIterations=a.positionIterations;f.solveTOI(b);k=0;for(c=f.m_bodyCount;k<c;)if(b=k++,b=f.m_bodies[b],b.m_flags&=~y.e_islandFlag,!1!=b.isAwake()&&b.getType()==y.b2_dynamicBody)for(b.synchronizeFixtures(),e=b.m_contactList;null!=e;)e.contact.m_flags&=~D.e_toiFlag,e=e.next;k=0;for(e=f.m_contactCount;k<e;)b=k++,b=f.m_contacts[b],b.m_flags&=~(D.e_toiFlag|D.e_islandFlag);k=0;for(b=f.m_jointCount;k<
b;)e=k++,e=f.m_joints[e],e.m_islandFlag=!1;this.m_contactManager.findNewContacts()}}},drawJoint:function(a){var b=a.getBodyA(),c=a.getBodyB(),d=b.m_xf.position,e=c.m_xf.position,f=a.getAnchorA(),g=a.getAnchorB(),k=ga.s_jointColor;switch(a.m_type[1]){case 3:this.m_debugDraw.drawSegment(f,g,k);break;case 4:b=C.__cast(a,Ab);a=b.getGroundAnchorA();b=b.getGroundAnchorB();this.m_debugDraw.drawSegment(a,f,k);this.m_debugDraw.drawSegment(b,g,k);this.m_debugDraw.drawSegment(a,b,k);break;case 5:this.m_debugDraw.drawSegment(f,
g,k);break;default:b!=this.m_groundBody&&this.m_debugDraw.drawSegment(d,f,k),this.m_debugDraw.drawSegment(f,g,k),c!=this.m_groundBody&&this.m_debugDraw.drawSegment(e,g,k)}},drawShape:function(a,b,c){switch(a.m_type[1]){case 1:a=C.__cast(a,nb);var d=r.mulX(b,a.m_p);this.m_debugDraw.drawSolidCircle(d,a.m_radius,b.R.col1,c);break;case 2:d=C.__cast(a,oa);a=d.getVertexCount();for(var d=d.getVertices(),e=[],f=0;f<a;){var g=f++;e[g]=r.mulX(b,d[g])}this.m_debugDraw.drawSolidPolygon(e,a,c);break;case 3:a=
C.__cast(a,Fc),this.m_debugDraw.drawSegment(r.mulX(b,a.getVertex1()),r.mulX(b,a.getVertex2()),c)}},__class__:ga};var D=function(){this.m_nodeA=new Xd;this.m_nodeB=new Xd;this.m_manifold=new cd;this.m_oldManifold=new cd};D.__name__=["box2D","dynamics","contacts","B2Contact"];D.prototype={getManifold:function(){return this.m_manifold},getWorldManifold:function(a){var b=this.m_fixtureA.getBody(),c=this.m_fixtureB.getBody(),d=this.m_fixtureA.getShape(),e=this.m_fixtureB.getShape();a.initialize(this.m_manifold,
b.getTransform(),d.m_radius,c.getTransform(),e.m_radius)},isTouching:function(){return(this.m_flags&D.e_touchingFlag)==D.e_touchingFlag},isContinuous:function(){return(this.m_flags&D.e_continuousFlag)==D.e_continuousFlag},setSensor:function(a){this.m_flags=a?this.m_flags|D.e_sensorFlag:this.m_flags&~D.e_sensorFlag},isSensor:function(){return(this.m_flags&D.e_sensorFlag)==D.e_sensorFlag},setEnabled:function(a){this.m_flags=a?this.m_flags|D.e_enabledFlag:this.m_flags&~D.e_enabledFlag},isEnabled:function(){return(this.m_flags&
D.e_enabledFlag)==D.e_enabledFlag},getNext:function(){return this.m_next},getFixtureA:function(){return this.m_fixtureA},getFixtureB:function(){return this.m_fixtureB},flagForFiltering:function(){this.m_flags|=D.e_filterFlag},reset:function(a,b){this.m_flags=D.e_enabledFlag;if(null==a||null==b)this.m_fixtureB=this.m_fixtureA=null;else{if(a.isSensor()||b.isSensor())this.m_flags|=D.e_sensorFlag;var c=a.getBody(),d=b.getBody();if(c.getType()!=y.b2_dynamicBody||c.isBullet()||d.getType()!=y.b2_dynamicBody||
d.isBullet())this.m_flags|=D.e_continuousFlag;this.m_fixtureA=a;this.m_fixtureB=b;this.m_manifold.m_pointCount=0;this.m_next=this.m_prev=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null}},update:function(a){var b=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=b;this.m_flags|=D.e_enabledFlag;var c=!1,b=(this.m_flags&D.e_touchingFlag)==
D.e_touchingFlag,d=this.m_fixtureA.m_body,e=this.m_fixtureB.m_body,f=this.m_fixtureA.m_aabb.testOverlap(this.m_fixtureB.m_aabb);if(0!=(this.m_flags&D.e_sensorFlag))f&&(c=this.m_fixtureA.getShape(),f=this.m_fixtureB.getShape(),d=d.getTransform(),e=e.getTransform(),c=Aa.testOverlap(c,d,f,e)),this.m_manifold.m_pointCount=0;else{d.getType()!=y.b2_dynamicBody||d.isBullet()||e.getType()!=y.b2_dynamicBody||e.isBullet()?this.m_flags|=D.e_continuousFlag:this.m_flags&=~D.e_continuousFlag;if(f){this.evaluate();
for(var c=0<this.m_manifold.m_pointCount,f=0,g=this.m_manifold.m_pointCount;f<g;){var k=f++,k=this.m_manifold.m_points[k];k.m_normalImpulse=0;k.m_tangentImpulse=0;for(var h=k.m_id,m=0,l=this.m_oldManifold.m_pointCount;m<l;){var x=m++,x=this.m_oldManifold.m_points[x];if(x.m_id.get_key()==h.get_key()){k.m_normalImpulse=x.m_normalImpulse;k.m_tangentImpulse=x.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;c!=b&&(d.setAwake(!0),e.setAwake(!0))}this.m_flags=c?this.m_flags|D.e_touchingFlag:
this.m_flags&~D.e_touchingFlag;!1==b&&!0==c&&a.beginContact(this);!0==b&&!1==c&&a.endContact(this);0==(this.m_flags&D.e_sensorFlag)&&a.preSolve(this,this.m_oldManifold)},evaluate:function(){},computeTOI:function(a,b){D.s_input.proxyA.set(this.m_fixtureA.getShape());D.s_input.proxyB.set(this.m_fixtureB.getShape());D.s_input.sweepA=a;D.s_input.sweepB=b;D.s_input.tolerance=w.b2_linearSlop;return Q.timeOfImpact(D.s_input)},__class__:D};var Xb=function(){D.call(this)};Xb.__name__=["box2D","dynamics","contacts",
"B2CircleContact"];Xb.create=function(a){return new Xb};Xb.destroy=function(a,b){};Xb.__super__=D;Xb.prototype=p(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();M.collideCircles(this.m_manifold,C.__cast(this.m_fixtureA.getShape(),nb),a.m_xf,C.__cast(this.m_fixtureB.getShape(),nb),b.m_xf)},__class__:Xb});var Yf=function(){this.localPlaneNormal=new u;this.localPoint=new u;this.normal=new u;this.normalMass=
new ka;this.K=new ka;this.points=[];for(var a=0,b=w.b2_maxManifoldPoints;a<b;){var c=a++;this.points[c]=new Xf}};Yf.__name__=["box2D","dynamics","contacts","B2ContactConstraint"];Yf.prototype={__class__:Yf};var Xf=function(){this.localPoint=new u;this.rA=new u;this.rB=new u};Xf.__name__=["box2D","dynamics","contacts","B2ContactConstraintPoint"];Xf.prototype={__class__:Xf};var Xd=function(){};Xd.__name__=["box2D","dynamics","contacts","B2ContactEdge"];Xd.prototype={__class__:Xd};var Wf=function(a){this.m_allocator=
a;this.initializeRegisters()};Wf.__name__=["box2D","dynamics","contacts","B2ContactFactory"];Wf.prototype={addType:function(a,b,c,d){var e=c[1],f=d[1];this.m_registers[e][f].createFcn=a;this.m_registers[e][f].destroyFcn=b;this.m_registers[e][f].primary=!0;c!=d&&(this.m_registers[f][e].createFcn=a,this.m_registers[f][e].destroyFcn=b,this.m_registers[f][e].primary=!1)},initializeRegisters:function(){this.m_registers=[];for(var a=0,b=ca.__empty_constructs__.length;a<b;){var c=a++;this.m_registers[c]=
[];for(var d=0,e=ca.__empty_constructs__.length;d<e;){var f=d++;this.m_registers[c][f]=new Zf}}this.addType(Xb.create,Xb.destroy,ca.CIRCLE_SHAPE,ca.CIRCLE_SHAPE);this.addType(Yb.create,Yb.destroy,ca.POLYGON_SHAPE,ca.CIRCLE_SHAPE);this.addType(Zb.create,Zb.destroy,ca.POLYGON_SHAPE,ca.POLYGON_SHAPE);this.addType($b.create,$b.destroy,ca.EDGE_SHAPE,ca.CIRCLE_SHAPE);this.addType(ac.create,ac.destroy,ca.POLYGON_SHAPE,ca.EDGE_SHAPE)},create:function(a,b){var c=a.getType(),d=b.getType(),c=this.m_registers[c[1]][d[1]];
if(null!=c.pool)return d=c.pool,c.pool=d.m_next,c.poolCount--,d.reset(a,b),d;d=c.createFcn;return null!=d?(c.primary?(d=d(this.m_allocator),d.reset(a,b)):(d=d(this.m_allocator),d.reset(b,a)),d):null},destroy:function(a){0<a.m_manifold.m_pointCount&&(a.m_fixtureA.m_body.setAwake(!0),a.m_fixtureB.m_body.setAwake(!0));var b=a.m_fixtureA.getType(),c=a.m_fixtureB.getType(),b=this.m_registers[b[1]][c[1]];b.poolCount++;a.m_next=b.pool;b.pool=a;b=b.destroyFcn;b(a,this.m_allocator)},__class__:Wf};var Zf=function(){};
Zf.__name__=["box2D","dynamics","contacts","B2ContactRegister"];Zf.prototype={__class__:Zf};var gd=function(){this.m_normal=new u;this.m_separations=[];this.m_points=[];for(var a=0,b=w.b2_maxManifoldPoints;a<b;){var c=a++;this.m_points[c]=new u}};gd.__name__=["box2D","dynamics","contacts","B2PositionSolverManifold"];gd.prototype={initialize:function(a){w.b2Assert(0<a.pointCount);var b,c,d,e,f;switch(a.type[1]){case 0:d=a.bodyA.m_xf.R;c=a.localPoint;b=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*
c.y);e=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyB.m_xf.R;c=a.points[0].localPoint;f=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);d=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);c=f-b;var g=d-e,k=c*c+g*g;k>Number.MIN_VALUE*Number.MIN_VALUE?(k=Math.sqrt(k),this.m_normal.x=c/k,this.m_normal.y=g/k):(this.m_normal.x=1,this.m_normal.y=0);this.m_points[0].x=0.5*(b+f);this.m_points[0].y=0.5*(e+d);this.m_separations[0]=c*this.m_normal.x+g*this.m_normal.y-a.radius;break;case 1:d=
a.bodyA.m_xf.R;c=a.localPlaneNormal;this.m_normal.x=d.col1.x*c.x+d.col2.x*c.y;this.m_normal.y=d.col1.y*c.x+d.col2.y*c.y;d=a.bodyA.m_xf.R;c=a.localPoint;e=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);f=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyB.m_xf.R;g=0;for(k=a.pointCount;g<k;){var h=g++;c=a.points[h].localPoint;b=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);c=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);this.m_separations[h]=(b-e)*this.m_normal.x+(c-f)*this.m_normal.y-
a.radius;this.m_points[h].x=b;this.m_points[h].y=c}break;case 2:d=a.bodyB.m_xf.R;c=a.localPlaneNormal;this.m_normal.x=d.col1.x*c.x+d.col2.x*c.y;this.m_normal.y=d.col1.y*c.x+d.col2.y*c.y;d=a.bodyB.m_xf.R;c=a.localPoint;e=a.bodyB.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y);f=a.bodyB.m_xf.position.y+(d.col1.y*c.x+d.col2.y*c.y);d=a.bodyA.m_xf.R;g=0;for(k=a.pointCount;g<k;)h=g++,c=a.points[h].localPoint,b=a.bodyA.m_xf.position.x+(d.col1.x*c.x+d.col2.x*c.y),c=a.bodyA.m_xf.position.y+(d.col1.y*c.x+d.col2.y*
c.y),this.m_separations[h]=(b-e)*this.m_normal.x+(c-f)*this.m_normal.y-a.radius,this.m_points[h].set(b,c);this.m_normal.x*=-1;this.m_normal.y*=-1}},__class__:gd};var Ka=function(){this.m_step=new fd;this.m_constraints=[]};Ka.__name__=["box2D","dynamics","contacts","B2ContactSolver"];Ka.prototype={initialize:function(a,b,c,d){var e;this.m_step.set(a);this.m_allocator=d;for(this.m_constraintCount=c;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new Yf;
for(a=0;a<c;){d=a++;e=b[d];var f=e.m_fixtureA,g=e.m_fixtureB,k=f.m_shape.m_radius,h=g.m_shape.m_radius,m=f.m_body,l=g.m_body;e=e.getManifold();var x=w.b2MixFriction(f.getFriction(),g.getFriction()),n=w.b2MixRestitution(f.getRestitution(),g.getRestitution()),r=m.m_linearVelocity.x,p=m.m_linearVelocity.y,u=l.m_linearVelocity.x,q=l.m_linearVelocity.y,s=m.m_angularVelocity,t=l.m_angularVelocity;w.b2Assert(0<e.m_pointCount);Ka.s_worldManifold.initialize(e,m.m_xf,k,l.m_xf,h);f=Ka.s_worldManifold.m_normal.x;
g=Ka.s_worldManifold.m_normal.y;d=this.m_constraints[d];d.bodyA=m;d.bodyB=l;d.manifold=e;d.normal.x=f;d.normal.y=g;d.pointCount=e.m_pointCount;d.friction=x;d.restitution=n;d.localPlaneNormal.x=e.m_localPlaneNormal.x;d.localPlaneNormal.y=e.m_localPlaneNormal.y;d.localPoint.x=e.m_localPoint.x;d.localPoint.y=e.m_localPoint.y;d.radius=k+h;d.type=e.m_type;k=0;for(h=d.pointCount;k<h;){var v=k++,n=e.m_points[v],x=d.points[v];x.normalImpulse=n.m_normalImpulse;x.tangentImpulse=n.m_tangentImpulse;x.localPoint.setV(n.m_localPoint);
var n=x.rA.x=Ka.s_worldManifold.m_points[v].x-m.m_sweep.c.x,z=x.rA.y=Ka.s_worldManifold.m_points[v].y-m.m_sweep.c.y,y=x.rB.x=Ka.s_worldManifold.m_points[v].x-l.m_sweep.c.x,v=x.rB.y=Ka.s_worldManifold.m_points[v].y-l.m_sweep.c.y,B=n*g-z*f,A=y*g-v*f,B=B*B,A=A*A;x.normalMass=1/(m.m_invMass+l.m_invMass+m.m_invI*B+l.m_invI*A);var C=m.m_mass*m.m_invMass+l.m_mass*l.m_invMass,C=C+(m.m_mass*m.m_invI*B+l.m_mass*l.m_invI*A);x.equalizedMass=1/C;A=g;C=-f;B=n*C-z*A;A=y*C-v*A;B*=B;A*=A;x.tangentMass=1/(m.m_invMass+
l.m_invMass+m.m_invI*B+l.m_invI*A);x.velocityBias=0;n=d.normal.x*(u+-t*v-r- -s*z)+d.normal.y*(q+t*y-p-s*n);n<-w.b2_velocityThreshold&&(x.velocityBias+=-d.restitution*n)}2==d.pointCount&&(q=d.points[0],u=d.points[1],e=m.m_invMass,m=m.m_invI,r=l.m_invMass,l=l.m_invI,p=q.rA.x*g-q.rA.y*f,q=q.rB.x*g-q.rB.y*f,s=u.rA.x*g-u.rA.y*f,u=u.rB.x*g-u.rB.y*f,f=e+r+m*p*p+l*q*q,g=e+r+m*s*s+l*u*u,l=e+r+m*p*s+l*q*u,f*f<100*(f*g-l*l)?(d.K.col1.set(f,l),d.K.col2.set(l,g),d.K.getInverse(d.normalMass)):d.pointCount=1)}},
initVelocityConstraints:function(a){for(var b=0,c=this.m_constraintCount;b<c;){var d=b++,d=this.m_constraints[d],e=d.bodyA,f=d.bodyB,g=e.m_invMass,k=e.m_invI,h=f.m_invMass,m=f.m_invI,l=d.normal.x,x=d.normal.y,n=x,r=-l,p;if(a.warmStarting){p=d.pointCount;for(var u=0;u<p;){var q=u++,q=d.points[q];q.normalImpulse*=a.dtRatio;q.tangentImpulse*=a.dtRatio;var s=q.normalImpulse*l+q.tangentImpulse*n,t=q.normalImpulse*x+q.tangentImpulse*r;e.m_angularVelocity-=k*(q.rA.x*t-q.rA.y*s);e.m_linearVelocity.x-=g*s;
e.m_linearVelocity.y-=g*t;f.m_angularVelocity+=m*(q.rB.x*t-q.rB.y*s);f.m_linearVelocity.x+=h*s;f.m_linearVelocity.y+=h*t}}else for(p=d.pointCount,e=0,f=p;e<f;)g=e++,g=d.points[g],g.normalImpulse=0,g.tangentImpulse=0}},solveVelocityConstraints:function(){for(var a,b,c,d,e,f,g,k,h,m,l=0,x=this.m_constraintCount;l<x;){var n=l++;d=this.m_constraints[n];var n=d.bodyA,p=d.bodyB,q=n.m_angularVelocity,u=p.m_angularVelocity,s=n.m_linearVelocity,t=p.m_linearVelocity,v=n.m_invMass,w=n.m_invI,z=p.m_invMass,B=
p.m_invI;k=d.normal.x;var y=h=d.normal.y,A=-k;m=d.friction;g=0;for(f=d.pointCount;g<f;)a=g++,a=d.points[a],b=t.x-u*a.rB.y-s.x+q*a.rA.y,c=t.y+u*a.rB.x-s.y-q*a.rA.x,b=b*y+c*A,b=a.tangentMass*-b,c=m*a.normalImpulse,c=r.clamp(a.tangentImpulse+b,-c,c),b=c-a.tangentImpulse,e=b*y,b*=A,s.x-=v*e,s.y-=v*b,q-=w*(a.rA.x*b-a.rA.y*e),t.x+=z*e,t.y+=z*b,u+=B*(a.rB.x*b-a.rB.y*e),a.tangentImpulse=c;if(1==d.pointCount)a=d.points[0],b=t.x+-u*a.rB.y-s.x- -q*a.rA.y,c=t.y+u*a.rB.x-s.y-q*a.rA.x,d=b*k+c*h,b=-a.normalMass*
(d-a.velocityBias),c=a.normalImpulse+b,0<c||(c=0),b=c-a.normalImpulse,e=b*k,b*=h,s.x-=v*e,s.y-=v*b,q-=w*(a.rA.x*b-a.rA.y*e),t.x+=z*e,t.y+=z*b,u+=B*(a.rB.x*b-a.rB.y*e),a.normalImpulse=c;else{a=d.points[0];y=d.points[1];f=a.normalImpulse;g=y.normalImpulse;e=(t.x-u*a.rB.y-s.x+q*a.rA.y)*k+(t.y+u*a.rB.x-s.y-q*a.rA.x)*h;var C=(t.x-u*y.rB.y-s.x+q*y.rA.y)*k+(t.y+u*y.rB.x-s.y-q*y.rA.x)*h;b=e-a.velocityBias;c=C-y.velocityBias;m=d.K;b-=m.col1.x*f+m.col2.x*g;for(c-=m.col1.y*f+m.col2.y*g;;){m=d.normalMass;A=-(m.col1.x*
b+m.col2.x*c);m=-(m.col1.y*b+m.col2.y*c);if(0<=A&&0<=m){f=A-f;g=m-g;d=f*k;f*=h;k*=g;h*=g;s.x-=v*(d+k);s.y-=v*(f+h);q-=w*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);t.x+=z*(d+k);t.y+=z*(f+h);u+=B*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=A;y.normalImpulse=m;break}A=-a.normalMass*b;m=0;C=d.K.col1.y*A+c;if(0<=A&&0<=C){f=A-f;g=m-g;d=f*k;f*=h;k*=g;h*=g;s.x-=v*(d+k);s.y-=v*(f+h);q-=w*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);t.x+=z*(d+k);t.y+=z*(f+h);u+=B*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=
A;y.normalImpulse=m;break}A=0;m=-y.normalMass*c;e=d.K.col2.x*m+b;if(0<=m&&0<=e){f=A-f;g=m-g;d=f*k;f*=h;k*=g;h*=g;s.x-=v*(d+k);s.y-=v*(f+h);q-=w*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);t.x+=z*(d+k);t.y+=z*(f+h);u+=B*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=A;y.normalImpulse=m;break}m=A=0;e=b;C=c;if(0<=e&&0<=C){f=A-f;g=m-g;d=f*k;f*=h;k*=g;h*=g;s.x-=v*(d+k);s.y-=v*(f+h);q-=w*(a.rA.x*f-a.rA.y*d+y.rA.x*h-y.rA.y*k);t.x+=z*(d+k);t.y+=z*(f+h);u+=B*(a.rB.x*f-a.rB.y*d+y.rB.x*h-y.rB.y*k);a.normalImpulse=
A;y.normalImpulse=m;break}break}}n.m_angularVelocity=q;p.m_angularVelocity=u}},finalizeVelocityConstraints:function(){for(var a=0,b=this.m_constraintCount;a<b;)for(var c=a++,c=this.m_constraints[c],d=c.manifold,e=0,f=c.pointCount;e<f;){var g=e++,k=d.m_points[g],g=c.points[g];k.m_normalImpulse=g.normalImpulse;k.m_tangentImpulse=g.tangentImpulse}},solvePositionConstraints:function(a){for(var b=0,c=0,d=this.m_constraintCount;c<d;){var e=c++,e=this.m_constraints[e],f=e.bodyA,g=e.bodyB,k=f.m_mass*f.m_invMass,
h=f.m_mass*f.m_invI,m=g.m_mass*g.m_invMass,l=g.m_mass*g.m_invI;Ka.s_psm.initialize(e);for(var x=Ka.s_psm.m_normal,n=0,p=e.pointCount;n<p;){var q=n++,u=e.points[q],s=Ka.s_psm.m_points[q],t=Ka.s_psm.m_separations[q],q=s.x-f.m_sweep.c.x,v=s.y-f.m_sweep.c.y,y=s.x-g.m_sweep.c.x,s=s.y-g.m_sweep.c.y;b<t||(b=t);t=r.clamp(a*(t+w.b2_linearSlop),-w.b2_maxLinearCorrection,0);t*=-u.equalizedMass;u=t*x.x;t*=x.y;f.m_sweep.c.x-=k*u;f.m_sweep.c.y-=k*t;f.m_sweep.a-=h*(q*t-v*u);f.synchronizeTransform();g.m_sweep.c.x+=
m*u;g.m_sweep.c.y+=m*t;g.m_sweep.a+=l*(y*t-s*u);g.synchronizeTransform()}}return b>-1.5*w.b2_linearSlop},__class__:Ka};var $b=function(){D.call(this)};$b.__name__=["box2D","dynamics","contacts","B2EdgeAndCircleContact"];$b.create=function(a){return new $b};$b.destroy=function(a,b){};$b.__super__=D;$b.prototype=p(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();this.b2CollideEdgeAndCircle(this.m_manifold,
C.__cast(this.m_fixtureA.getShape(),Fc),a.m_xf,C.__cast(this.m_fixtureB.getShape(),nb),b.m_xf)},b2CollideEdgeAndCircle:function(a,b,c,d,e){},__class__:$b});var Yb=function(){D.call(this)};Yb.__name__=["box2D","dynamics","contacts","B2PolyAndCircleContact"];Yb.create=function(a){return new Yb};Yb.destroy=function(a,b){};Yb.__super__=D;Yb.prototype=p(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b);w.b2Assert(a.getType()==ca.POLYGON_SHAPE);w.b2Assert(b.getType()==ca.CIRCLE_SHAPE)},
evaluate:function(){var a=this.m_fixtureA.m_body,b=this.m_fixtureB.m_body;M.collidePolygonAndCircle(this.m_manifold,C.__cast(this.m_fixtureA.getShape(),oa),a.m_xf,C.__cast(this.m_fixtureB.getShape(),nb),b.m_xf)},__class__:Yb});var ac=function(){D.call(this)};ac.__name__=["box2D","dynamics","contacts","B2PolyAndEdgeContact"];ac.create=function(a){return new ac};ac.destroy=function(a,b){};ac.__super__=D;ac.prototype=p(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b);w.b2Assert(a.getType()==
ca.POLYGON_SHAPE);w.b2Assert(b.getType()==ca.EDGE_SHAPE)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();this.b2CollidePolyAndEdge(this.m_manifold,C.__cast(this.m_fixtureA.getShape(),oa),a.m_xf,C.__cast(this.m_fixtureB.getShape(),Fc),b.m_xf)},b2CollidePolyAndEdge:function(a,b,c,d,e){},__class__:ac});var Zb=function(){D.call(this)};Zb.__name__=["box2D","dynamics","contacts","B2PolygonContact"];Zb.create=function(a){return new Zb};Zb.destroy=function(a,b){};Zb.__super__=
D;Zb.prototype=p(D.prototype,{reset:function(a,b){D.prototype.reset.call(this,a,b)},evaluate:function(){var a=this.m_fixtureA.getBody(),b=this.m_fixtureB.getBody();M.collidePolygons(this.m_manifold,C.__cast(this.m_fixtureA.getShape(),oa),a.m_xf,C.__cast(this.m_fixtureB.getShape(),oa),b.m_xf)},__class__:Zb});var ha=function(a){this.m_edgeA=new Yd;this.m_edgeB=new Yd;this.m_localCenterA=new u;this.m_localCenterB=new u;w.b2Assert(a.bodyA!=a.bodyB);this.m_type=a.type;this.m_next=this.m_prev=null;this.m_bodyA=
a.bodyA;this.m_bodyB=a.bodyB;this.m_collideConnected=a.collideConnected;this.m_islandFlag=!1;this.m_userData=a.userData};ha.__name__=["box2D","dynamics","joints","B2Joint"];ha.create=function(a,b){var c=null;switch(a.type[1]){case 1:c=new Bb(C.__cast(a,Zd));break;case 2:c=new Gc(C.__cast(a,$d));break;case 3:c=new ae(C.__cast(a,be));break;case 4:c=new Ab(C.__cast(a,ce));break;case 5:c=new de(C.__cast(a,ee));break;case 6:c=new fe(C.__cast(a,ge));break;case 7:c=new he(C.__cast(a,ie));break;case 8:c=
new je(C.__cast(a,ke));break;case 9:c=new le(C.__cast(a,me))}return c};ha.destroy=function(a,b){};ha.prototype={getType:function(){return this.m_type},getAnchorA:function(){return null},getAnchorB:function(){return null},getReactionForce:function(a){return null},getReactionTorque:function(a){return 0},getBodyA:function(){return this.m_bodyA},getBodyB:function(){return this.m_bodyB},getNext:function(){return this.m_next},getUserData:function(){return this.m_userData},setUserData:function(a){this.m_userData=
a},isActive:function(){return this.m_bodyA.isActive()?this.m_bodyB.isActive():!1},initVelocityConstraints:function(a){},solveVelocityConstraints:function(a){},finalizeVelocityConstraints:function(){},solvePositionConstraints:function(a){return!1},__class__:ha};var ae=function(a){ha.call(this,a);this.m_localAnchor1=new u;this.m_localAnchor2=new u;this.m_u=new u;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_length=a.length;this.m_frequencyHz=a.frequencyHz;
this.m_dampingRatio=a.dampingRatio;this.m_bias=this.m_gamma=this.m_impulse=0};ae.__name__=["box2D","dynamics","joints","B2DistanceJoint"];ae.__super__=ha;ae.prototype=p(ha.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new u(a*this.m_impulse*this.m_u.x,a*this.m_impulse*this.m_u.y)},getReactionTorque:function(a){return 0},getLength:function(){return this.m_length},
setLength:function(a){this.m_length=a},getFrequency:function(){return this.m_frequencyHz},setFrequency:function(a){this.m_frequencyHz=a},getDampingRatio:function(){return this.m_dampingRatio},setDampingRatio:function(a){this.m_dampingRatio=a},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchor1.x-d.m_sweep.localCenter.x,g=this.m_localAnchor1.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchor2.x-
e.m_sweep.localCenter.x,h=this.m_localAnchor2.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;this.m_u.x=e.m_sweep.c.x+k-d.m_sweep.c.x-f;this.m_u.y=e.m_sweep.c.y+h-d.m_sweep.c.y-g;c=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);c>w.b2_linearSlop?this.m_u.multiply(1/c):this.m_u.setZero();b=f*this.m_u.y-g*this.m_u.x;var m=k*this.m_u.y-h*this.m_u.x;b=d.m_invMass+d.m_invI*b*b+e.m_invMass+e.m_invI*m*m;this.m_mass=0!=b?1/b:0;if(0<this.m_frequencyHz){c-=this.m_length;
var m=2*Math.PI*this.m_frequencyHz,l=this.m_mass*m*m;this.m_gamma=a.dt*(2*this.m_mass*this.m_dampingRatio*m+a.dt*l);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_bias=c*a.dt*l*this.m_gamma;this.m_mass=b+this.m_gamma;this.m_mass=0!=this.m_mass?1/this.m_mass:0}a.warmStarting?(this.m_impulse*=a.dtRatio,a=this.m_impulse*this.m_u.x,b=this.m_impulse*this.m_u.y,d.m_linearVelocity.x-=d.m_invMass*a,d.m_linearVelocity.y-=d.m_invMass*b,d.m_angularVelocity-=d.m_invI*(f*b-g*a),e.m_linearVelocity.x+=e.m_invMass*
a,e.m_linearVelocity.y+=e.m_invMass*b,e.m_angularVelocity+=e.m_invI*(k*b-h*a)):this.m_impulse=0},solveVelocityConstraints:function(a){var b;a=this.m_bodyA;var c=this.m_bodyB;b=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=b.col1.x*d+b.col2.x*e,e=b.col1.y*d+b.col2.y*e,d=f;b=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*k,k=b.col1.y*g+b.col2.y*k,g=f,f=
-this.m_mass*(this.m_u.x*(c.m_linearVelocity.x+-c.m_angularVelocity*k-(a.m_linearVelocity.x+-a.m_angularVelocity*e))+this.m_u.y*(c.m_linearVelocity.y+c.m_angularVelocity*g-(a.m_linearVelocity.y+a.m_angularVelocity*d))+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=f;b=f*this.m_u.x;f*=this.m_u.y;a.m_linearVelocity.x-=a.m_invMass*b;a.m_linearVelocity.y-=a.m_invMass*f;a.m_angularVelocity-=a.m_invI*(d*f-e*b);c.m_linearVelocity.x+=c.m_invMass*b;c.m_linearVelocity.y+=c.m_invMass*f;c.m_angularVelocity+=
c.m_invI*(g*f-k*b)},solvePositionConstraints:function(a){var b;if(0<this.m_frequencyHz)return!0;a=this.m_bodyA;var c=this.m_bodyB;b=a.m_xf.R;var d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=b.col1.x*d+b.col2.x*e,e=b.col1.y*d+b.col2.y*e,d=f;b=c.m_xf.R;var g=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,f=b.col1.x*g+b.col2.x*k,k=b.col1.y*g+b.col2.y*k,g=f,f=c.m_sweep.c.x+g-a.m_sweep.c.x-d,h=c.m_sweep.c.y+
k-a.m_sweep.c.y-e;b=Math.sqrt(f*f+h*h);f/=b;h/=b;b-=this.m_length;b=r.clamp(b,-w.b2_maxLinearCorrection,w.b2_maxLinearCorrection);var m=-this.m_mass*b;this.m_u.set(f,h);f=m*this.m_u.x;h=m*this.m_u.y;a.m_sweep.c.x-=a.m_invMass*f;a.m_sweep.c.y-=a.m_invMass*h;a.m_sweep.a-=a.m_invI*(d*h-e*f);c.m_sweep.c.x+=c.m_invMass*f;c.m_sweep.c.y+=c.m_invMass*h;c.m_sweep.a+=c.m_invI*(g*h-k*f);a.synchronizeTransform();c.synchronizeTransform();return r.abs(b)<w.b2_linearSlop},__class__:ae});var ma=function(){this.type=
R.UNKNOWN_JOINT;this.bodyB=this.bodyA=this.userData=null;this.collideConnected=!1};ma.__name__=["box2D","dynamics","joints","B2JointDef"];ma.prototype={__class__:ma};var be=function(){ma.call(this);this.localAnchorA=new u;this.localAnchorB=new u;this.type=R.DISTANCE_JOINT;this.length=1;this.dampingRatio=this.frequencyHz=0};be.__name__=["box2D","dynamics","joints","B2DistanceJointDef"];be.__super__=ma;be.prototype=p(ma.prototype,{initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));
this.localAnchorB.setV(this.bodyB.getLocalPoint(d));a=d.x-c.x;c=d.y-c.y;this.length=Math.sqrt(a*a+c*c);this.dampingRatio=this.frequencyHz=0},__class__:be});var le=function(a){ha.call(this,a);this.m_localAnchorA=new u;this.m_localAnchorB=new u;this.m_linearMass=new ka;this.m_linearImpulse=new u;this.m_localAnchorA.setV(a.localAnchorA);this.m_localAnchorB.setV(a.localAnchorB);this.m_linearMass.setZero();this.m_angularMass=0;this.m_linearImpulse.setZero();this.m_angularImpulse=0;this.m_maxForce=a.maxForce;
this.m_maxTorque=a.maxTorque};le.__name__=["box2D","dynamics","joints","B2FrictionJoint"];le.__super__=ha;le.prototype=p(ha.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},getReactionForce:function(a){return new u(a*this.m_linearImpulse.x,a*this.m_linearImpulse.y)},getReactionTorque:function(a){return a*this.m_angularImpulse},setMaxForce:function(a){this.m_maxForce=a},getMaxForce:function(){return this.m_maxForce},
setMaxTorque:function(a){this.m_maxTorque=a},getMaxTorque:function(){return this.m_maxTorque},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchorB.x-e.m_sweep.localCenter.x,h=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;b=d.m_invMass;
c=e.m_invMass;var m=d.m_invI,l=e.m_invI,x=new ka;x.col1.x=b+c;x.col2.x=0;x.col1.y=0;x.col2.y=b+c;x.col1.x+=m*g*g;x.col2.x+=-m*f*g;x.col1.y+=-m*f*g;x.col2.y+=m*f*f;x.col1.x+=l*h*h;x.col2.x+=-l*k*h;x.col1.y+=-l*k*h;x.col2.y+=l*k*k;x.getInverse(this.m_linearMass);this.m_angularMass=m+l;0<this.m_angularMass&&(this.m_angularMass=1/this.m_angularMass);a.warmStarting?(this.m_linearImpulse.x*=a.dtRatio,this.m_linearImpulse.y*=a.dtRatio,this.m_angularImpulse*=a.dtRatio,a=this.m_linearImpulse,d.m_linearVelocity.x-=
b*a.x,d.m_linearVelocity.y-=b*a.y,d.m_angularVelocity-=m*(f*a.y-g*a.x+this.m_angularImpulse),e.m_linearVelocity.x+=c*a.x,e.m_linearVelocity.y+=c*a.y,e.m_angularVelocity+=l*(k*a.y-h*a.x+this.m_angularImpulse)):(this.m_linearImpulse.setZero(),this.m_angularImpulse=0)},solveVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB,f=d.m_linearVelocity,g=d.m_angularVelocity,k=e.m_linearVelocity,h=e.m_angularVelocity,m=d.m_invMass,l=e.m_invMass,x=d.m_invI,n=e.m_invI;b=d.m_xf.R;var p=this.m_localAnchorA.x-
d.m_sweep.localCenter.x,q=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*p+b.col2.x*q;q=b.col1.y*p+b.col2.y*q;p=c;b=e.m_xf.R;var s=this.m_localAnchorB.x-e.m_sweep.localCenter.x,t=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*s+b.col2.x*t;t=b.col1.y*s+b.col2.y*t;s=c;c=-this.m_angularMass*(h-g);var v=this.m_angularImpulse;b=a.dt*this.m_maxTorque;this.m_angularImpulse=r.clamp(this.m_angularImpulse+c,-b,b);c=this.m_angularImpulse-v;g-=x*c;h+=n*c;b=r.mulMV(this.m_linearMass,new u(-(k.x-
h*t-f.x+g*q),-(k.y+h*s-f.y-g*p)));c=this.m_linearImpulse.copy();this.m_linearImpulse.add(b);b=a.dt*this.m_maxForce;this.m_linearImpulse.lengthSquared()>b*b&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.multiply(b));b=r.subtractVV(this.m_linearImpulse,c);f.x-=m*b.x;f.y-=m*b.y;g-=x*(p*b.y-q*b.x);k.x+=l*b.x;k.y+=l*b.y;h+=n*(s*b.y-t*b.x);d.m_angularVelocity=g;e.m_angularVelocity=h},solvePositionConstraints:function(a){return!0},__class__:le});var me=function(){ma.call(this);this.localAnchorA=
new u;this.localAnchorB=new u;this.type=R.FRICTION_JOINT;this.maxTorque=this.maxForce=0};me.__name__=["box2D","dynamics","joints","B2FrictionJointDef"];me.__super__=ma;me.prototype=p(ma.prototype,{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(c))},__class__:me});var fe=function(a){ha.call(this,a);this.m_groundAnchor1=new u;this.m_groundAnchor2=new u;this.m_localAnchor1=new u;this.m_localAnchor2=
new u;this.m_J=new $f;var b=a.joint1.m_type,c=a.joint2.m_type;this.m_prismatic2=this.m_revolute2=this.m_prismatic1=this.m_revolute1=null;this.m_ground1=a.joint1.getBodyA();this.m_bodyA=a.joint1.getBodyB();b==R.REVOLUTE_JOINT?(this.m_revolute1=C.__cast(a.joint1,Bb),this.m_groundAnchor1.setV(this.m_revolute1.m_localAnchor1),this.m_localAnchor1.setV(this.m_revolute1.m_localAnchor2),b=this.m_revolute1.getJointAngle()):(this.m_prismatic1=C.__cast(a.joint1,Gc),this.m_groundAnchor1.setV(this.m_prismatic1.m_localAnchor1),
this.m_localAnchor1.setV(this.m_prismatic1.m_localAnchor2),b=this.m_prismatic1.getJointTranslation());this.m_ground2=a.joint2.getBodyA();this.m_bodyB=a.joint2.getBodyB();c==R.REVOLUTE_JOINT?(this.m_revolute2=C.__cast(a.joint2,Bb),this.m_groundAnchor2.setV(this.m_revolute2.m_localAnchor1),this.m_localAnchor2.setV(this.m_revolute2.m_localAnchor2),c=this.m_revolute2.getJointAngle()):(this.m_prismatic2=C.__cast(a.joint2,Gc),this.m_groundAnchor2.setV(this.m_prismatic2.m_localAnchor1),this.m_localAnchor2.setV(this.m_prismatic2.m_localAnchor2),
c=this.m_prismatic2.getJointTranslation());this.m_ratio=a.ratio;this.m_constant=b+this.m_ratio*c;this.m_impulse=0};fe.__name__=["box2D","dynamics","joints","B2GearJoint"];fe.__super__=ha;fe.prototype=p(ha.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new u(a*this.m_impulse*this.m_J.linearB.x,a*this.m_impulse*this.m_J.linearB.y)},getReactionTorque:function(a){var b=
this.m_bodyB.m_xf.R,c=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x,d=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y,e=b.col1.x*c+b.col2.x*d,d=b.col1.y*c+b.col2.y*d;return a*(this.m_impulse*this.m_J.angularB-e*this.m_impulse*this.m_J.linearB.y+d*this.m_impulse*this.m_J.linearB.x)},getRatio:function(){return this.m_ratio},setRatio:function(a){this.m_ratio=a},initVelocityConstraints:function(a){var b=this.m_ground1,c=this.m_ground2,d=this.m_bodyA,e=this.m_bodyB,f,g,k,h,m,l=0;this.m_J.setZero();
null!=this.m_revolute1?(this.m_J.angularA=-1,l+=d.m_invI):(h=b.m_xf.R,f=this.m_prismatic1.m_localXAxis1,b=h.col1.x*f.x+h.col2.x*f.y,f=h.col1.y*f.x+h.col2.y*f.y,h=d.m_xf.R,g=this.m_localAnchor1.x-d.m_sweep.localCenter.x,k=this.m_localAnchor1.y-d.m_sweep.localCenter.y,m=h.col1.x*g+h.col2.x*k,k=h.col1.y*g+h.col2.y*k,h=m*f-k*b,this.m_J.linearA.set(-b,-f),this.m_J.angularA=-h,l+=d.m_invMass+d.m_invI*h*h);null!=this.m_revolute2?(this.m_J.angularB=-this.m_ratio,l+=this.m_ratio*this.m_ratio*e.m_invI):(h=
c.m_xf.R,f=this.m_prismatic2.m_localXAxis1,b=h.col1.x*f.x+h.col2.x*f.y,f=h.col1.y*f.x+h.col2.y*f.y,h=e.m_xf.R,g=this.m_localAnchor2.x-e.m_sweep.localCenter.x,k=this.m_localAnchor2.y-e.m_sweep.localCenter.y,m=h.col1.x*g+h.col2.x*k,k=h.col1.y*g+h.col2.y*k,h=m*f-k*b,this.m_J.linearB.set(-this.m_ratio*b,-this.m_ratio*f),this.m_J.angularB=-this.m_ratio*h,l+=this.m_ratio*this.m_ratio*(e.m_invMass+e.m_invI*h*h));this.m_mass=0<l?1/l:0;a.warmStarting?(d.m_linearVelocity.x+=d.m_invMass*this.m_impulse*this.m_J.linearA.x,
d.m_linearVelocity.y+=d.m_invMass*this.m_impulse*this.m_J.linearA.y,d.m_angularVelocity+=d.m_invI*this.m_impulse*this.m_J.angularA,e.m_linearVelocity.x+=e.m_invMass*this.m_impulse*this.m_J.linearB.x,e.m_linearVelocity.y+=e.m_invMass*this.m_impulse*this.m_J.linearB.y,e.m_angularVelocity+=e.m_invI*this.m_impulse*this.m_J.angularB):this.m_impulse=0},solveVelocityConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=this.m_J.compute(a.m_linearVelocity,a.m_angularVelocity,b.m_linearVelocity,b.m_angularVelocity),
c=-this.m_mass*c;this.m_impulse+=c;a.m_linearVelocity.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_linearVelocity.y+=a.m_invMass*c*this.m_J.linearA.y;a.m_angularVelocity+=a.m_invI*c*this.m_J.angularA;b.m_linearVelocity.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_linearVelocity.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_angularVelocity+=b.m_invI*c*this.m_J.angularB},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c,d;c=null!=this.m_revolute1?this.m_revolute1.getJointAngle():this.m_prismatic1.getJointTranslation();
d=null!=this.m_revolute2?this.m_revolute2.getJointAngle():this.m_prismatic2.getJointTranslation();c=-this.m_mass*(this.m_constant-(c+this.m_ratio*d));a.m_sweep.c.x+=a.m_invMass*c*this.m_J.linearA.x;a.m_sweep.c.y+=a.m_invMass*c*this.m_J.linearA.y;a.m_sweep.a+=a.m_invI*c*this.m_J.angularA;b.m_sweep.c.x+=b.m_invMass*c*this.m_J.linearB.x;b.m_sweep.c.y+=b.m_invMass*c*this.m_J.linearB.y;b.m_sweep.a+=b.m_invI*c*this.m_J.angularB;a.synchronizeTransform();b.synchronizeTransform();return 0<w.b2_linearSlop},
__class__:fe});var ge=function(){ma.call(this);this.type=R.GEAR_JOINT;this.joint2=this.joint1=null;this.ratio=1};ge.__name__=["box2D","dynamics","joints","B2GearJointDef"];ge.__super__=ma;ge.prototype=p(ma.prototype,{__class__:ge});var $f=function(){this.linearA=new u;this.linearB=new u};$f.__name__=["box2D","dynamics","joints","B2Jacobian"];$f.prototype={setZero:function(){this.linearA.setZero();this.angularA=0;this.linearB.setZero();this.angularB=0},set:function(a,b,c,d){this.linearA.setV(a);this.angularA=
b;this.linearB.setV(c);this.angularB=d},compute:function(a,b,c,d){return this.linearA.x*a.x+this.linearA.y*a.y+this.angularA*b+(this.linearB.x*c.x+this.linearB.y*c.y)+this.angularB*d},__class__:$f};var Yd=function(){};Yd.__name__=["box2D","dynamics","joints","B2JointEdge"];Yd.prototype={__class__:Yd};var R={__ename__:!0,__constructs__:"UNKNOWN_JOINT REVOLUTE_JOINT PRISMATIC_JOINT DISTANCE_JOINT PULLEY_JOINT MOUSE_JOINT GEAR_JOINT LINE_JOINT WELD_JOINT FRICTION_JOINT".split(" "),UNKNOWN_JOINT:["UNKNOWN_JOINT",
0]};R.UNKNOWN_JOINT.__enum__=R;R.REVOLUTE_JOINT=["REVOLUTE_JOINT",1];R.REVOLUTE_JOINT.__enum__=R;R.PRISMATIC_JOINT=["PRISMATIC_JOINT",2];R.PRISMATIC_JOINT.__enum__=R;R.DISTANCE_JOINT=["DISTANCE_JOINT",3];R.DISTANCE_JOINT.__enum__=R;R.PULLEY_JOINT=["PULLEY_JOINT",4];R.PULLEY_JOINT.__enum__=R;R.MOUSE_JOINT=["MOUSE_JOINT",5];R.MOUSE_JOINT.__enum__=R;R.GEAR_JOINT=["GEAR_JOINT",6];R.GEAR_JOINT.__enum__=R;R.LINE_JOINT=["LINE_JOINT",7];R.LINE_JOINT.__enum__=R;R.WELD_JOINT=["WELD_JOINT",8];R.WELD_JOINT.__enum__=
R;R.FRICTION_JOINT=["FRICTION_JOINT",9];R.FRICTION_JOINT.__enum__=R;R.__empty_constructs__=[R.UNKNOWN_JOINT,R.REVOLUTE_JOINT,R.PRISMATIC_JOINT,R.DISTANCE_JOINT,R.PULLEY_JOINT,R.MOUSE_JOINT,R.GEAR_JOINT,R.LINE_JOINT,R.WELD_JOINT,R.FRICTION_JOINT];var G={__ename__:!0,__constructs__:["INACTIVE_LIMIT","AT_LOWER_LIMIT","AT_UPPER_LIMIT","EQUAL_LIMITS"],INACTIVE_LIMIT:["INACTIVE_LIMIT",0]};G.INACTIVE_LIMIT.__enum__=G;G.AT_LOWER_LIMIT=["AT_LOWER_LIMIT",1];G.AT_LOWER_LIMIT.__enum__=G;G.AT_UPPER_LIMIT=["AT_UPPER_LIMIT",
2];G.AT_UPPER_LIMIT.__enum__=G;G.EQUAL_LIMITS=["EQUAL_LIMITS",3];G.EQUAL_LIMITS.__enum__=G;G.__empty_constructs__=[G.INACTIVE_LIMIT,G.AT_LOWER_LIMIT,G.AT_UPPER_LIMIT,G.EQUAL_LIMITS];var he=function(a){ha.call(this,a);this.m_localAnchor1=new u;this.m_localAnchor2=new u;this.m_localXAxis1=new u;this.m_localYAxis1=new u;this.m_axis=new u;this.m_perp=new u;this.m_K=new ka;this.m_impulse=new u;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_localXAxis1.setV(a.localAxisA);
this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.setZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=G.INACTIVE_LIMIT;this.m_axis.setZero();this.m_perp.setZero()};he.__name__=["box2D","dynamics","joints","B2LineJoint"];
he.__super__=ha;he.prototype=p(ha.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new u(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))},getReactionTorque:function(a){return a*this.m_impulse.y},getJointTranslation:function(){var a=
this.m_bodyA,b=this.m_bodyB,c=a.getWorldPoint(this.m_localAnchor1),d=b.getWorldPoint(this.m_localAnchor2),b=d.x-c.x,c=d.y-c.y,a=a.getWorldVector(this.m_localXAxis1);return a.x*b+a.y*c},getJointSpeed:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,
f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,c=b.m_sweep.c.x+g-(a.m_sweep.c.x+d),f=b.m_sweep.c.y+k-(a.m_sweep.c.y+e),h=a.getWorldVector(this.m_localXAxis1),m=a.m_linearVelocity,l=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*h.y+f*a*h.x+(h.x*(l.x+-b*k-m.x- -a*e)+h.y*(l.y+b*g-m.y-a*d))},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableLimit=a},getLowerLimit:function(){return this.m_lowerTranslation},
getUpperLimit:function(){return this.m_upperTranslation},setLimits:function(a,b){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b},isMotorEnabled:function(){return this.m_enableMotor},enableMotor:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorForce:function(a){this.m_bodyA.setAwake(!0);
this.m_bodyB.setAwake(!0);this.m_maxMotorForce=a},getMaxMotorForce:function(){return this.m_maxMotorForce},getMotorForce:function(){return this.m_motorImpulse},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;this.m_localCenterA.setV(b.getLocalCenter());this.m_localCenterB.setV(c.getLocalCenter());var f=b.getTransform();c.getTransform();d=b.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-this.m_localCenterA.y;e=d.col1.x*g+d.col2.x*k;k=d.col1.y*
g+d.col2.y*k;g=e;d=c.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,m=this.m_localAnchor2.y-this.m_localCenterB.y;e=d.col1.x*h+d.col2.x*m;m=d.col1.y*h+d.col2.y*m;h=e;d=c.m_sweep.c.x+h-b.m_sweep.c.x-g;e=c.m_sweep.c.y+m-b.m_sweep.c.y-k;this.m_invMassA=b.m_invMass;this.m_invMassB=c.m_invMass;this.m_invIA=b.m_invI;this.m_invIB=c.m_invI;this.m_axis.setV(r.mulMV(f.R,this.m_localXAxis1));this.m_a1=(d+g)*this.m_axis.y-(e+k)*this.m_axis.x;this.m_a2=h*this.m_axis.y-m*this.m_axis.x;this.m_motorMass=
this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.setV(r.mulMV(f.R,this.m_localYAxis1));this.m_s1=(d+g)*this.m_perp.y-(e+k)*this.m_perp.x;this.m_s2=h*this.m_perp.y-m*this.m_perp.x;f=this.m_invMassA;g=this.m_invMassB;k=this.m_invIA;h=this.m_invIB;this.m_K.col1.x=f+g+k*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2;this.m_K.col1.y=k*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2;
this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=f+g+k*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*e,r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*w.b2_linearSlop?this.m_limitState=G.EQUAL_LIMITS:d<=this.m_lowerTranslation?this.m_limitState!=G.AT_LOWER_LIMIT&&(this.m_limitState=G.AT_LOWER_LIMIT,this.m_impulse.y=0):d>=this.m_upperTranslation?this.m_limitState!=G.AT_UPPER_LIMIT&&(this.m_limitState=G.AT_UPPER_LIMIT,this.m_impulse.y=0):(this.m_limitState=
G.INACTIVE_LIMIT,this.m_impulse.y=0)):this.m_limitState=G.INACTIVE_LIMIT;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y,e=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1,f=this.m_impulse.x*this.m_s2+
(this.m_motorImpulse+this.m_impulse.y)*this.m_a2,b.m_linearVelocity.x-=this.m_invMassA*a,b.m_linearVelocity.y-=this.m_invMassA*d,b.m_angularVelocity-=this.m_invIA*e,c.m_linearVelocity.x+=this.m_invMassB*a,c.m_linearVelocity.y+=this.m_invMassB*d,c.m_angularVelocity+=this.m_invIB*f):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,f=c.m_linearVelocity,g=c.m_angularVelocity,k,h,m;this.m_enableMotor&&
this.m_limitState!=G.EQUAL_LIMITS&&(m=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e)),k=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=r.clamp(this.m_motorImpulse+m,-a,a),m=this.m_motorImpulse-k,k=m*this.m_axis.x,a=m*this.m_axis.y,h=m*this.m_a1,m*=this.m_a2,d.x-=this.m_invMassA*k,d.y-=this.m_invMassA*a,e-=this.m_invIA*h,f.x+=this.m_invMassB*k,f.y+=this.m_invMassB*a,g+=this.m_invIB*m);a=this.m_perp.x*(f.x-d.x)+this.m_perp.y*
(f.y-d.y)+this.m_s2*g-this.m_s1*e;this.m_enableLimit&&this.m_limitState!=G.INACTIVE_LIMIT?(h=this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e,k=this.m_impulse.copy(),m=this.m_K.solve(new u,-a,-h),this.m_impulse.add(m),this.m_limitState==G.AT_LOWER_LIMIT?this.m_impulse.y=r.max(this.m_impulse.y,0):this.m_limitState==G.AT_UPPER_LIMIT&&(this.m_impulse.y=r.min(this.m_impulse.y,0)),a=-a-(this.m_impulse.y-k.y)*this.m_K.col2.x,this.m_impulse.x=0!=this.m_K.col1.x?a/this.m_K.col1.x+k.x:
k.x,m.x=this.m_impulse.x-k.x,m.y=this.m_impulse.y-k.y,k=m.x*this.m_perp.x+m.y*this.m_axis.x,a=m.x*this.m_perp.y+m.y*this.m_axis.y,h=m.x*this.m_s1+m.y*this.m_a1,m=m.x*this.m_s2+m.y*this.m_a2):(m=0!=this.m_K.col1.x?-a/this.m_K.col1.x:0,this.m_impulse.x+=m,k=m*this.m_perp.x,a=m*this.m_perp.y,h=m*this.m_s1,m*=this.m_s2);d.x-=this.m_invMassA*k;d.y-=this.m_invMassA*a;e-=this.m_invIA*h;f.x+=this.m_invMassB*k;f.y+=this.m_invMassB*a;g+=this.m_invIB*m;b.m_linearVelocity.setV(d);b.m_angularVelocity=e;c.m_linearVelocity.setV(f);
c.m_angularVelocity=g},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=a.m_sweep.c,d=a.m_sweep.a,e=b.m_sweep.c,f=b.m_sweep.a,g,k,h,m,l,x=0,n=0;h=!1;var p=0,q=ka.fromAngle(d);m=ka.fromAngle(f);g=q;var n=this.m_localAnchor1.x-this.m_localCenterA.x,s=this.m_localAnchor1.y-this.m_localCenterA.y;k=g.col1.x*n+g.col2.x*s;s=g.col1.y*n+g.col2.y*s;n=k;g=m;m=this.m_localAnchor2.x-this.m_localCenterB.x;l=this.m_localAnchor2.y-this.m_localCenterB.y;k=g.col1.x*m+g.col2.x*l;l=g.col1.y*m+
g.col2.y*l;m=k;g=e.x+m-c.x-n;k=e.y+l-c.y-s;if(this.m_enableLimit){this.m_axis=r.mulMV(q,this.m_localXAxis1);this.m_a1=(g+n)*this.m_axis.y-(k+s)*this.m_axis.x;this.m_a2=m*this.m_axis.y-l*this.m_axis.x;var t=this.m_axis.x*g+this.m_axis.y*k;r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*w.b2_linearSlop?(p=r.clamp(t,-w.b2_maxLinearCorrection,w.b2_maxLinearCorrection),x=r.abs(t),h=!0):t<=this.m_lowerTranslation?(p=r.clamp(t-this.m_lowerTranslation+w.b2_linearSlop,-w.b2_maxLinearCorrection,0),
x=this.m_lowerTranslation-t,h=!0):t>=this.m_upperTranslation&&(p=r.clamp(t-this.m_upperTranslation+w.b2_linearSlop,0,w.b2_maxLinearCorrection),x=t-this.m_upperTranslation,h=!0)}this.m_perp=r.mulMV(q,this.m_localYAxis1);this.m_s1=(g+n)*this.m_perp.y-(k+s)*this.m_perp.x;this.m_s2=m*this.m_perp.y-l*this.m_perp.x;q=new u;s=this.m_perp.x*g+this.m_perp.y*k;x=r.max(x,r.abs(s));n=0;h?(h=this.m_invMassA,m=this.m_invMassB,l=this.m_invIA,g=this.m_invIB,this.m_K.col1.x=h+m+l*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,
this.m_K.col1.y=l*this.m_s1*this.m_a1+g*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=h+m+l*this.m_a1*this.m_a1+g*this.m_a2*this.m_a2,this.m_K.solve(q,-s,-p)):(h=this.m_invMassA,m=this.m_invMassB,l=this.m_invIA,g=this.m_invIB,p=h+m+l*this.m_s1*this.m_s1+g*this.m_s2*this.m_s2,q.x=0!=p?-s/p:0,q.y=0);p=q.x*this.m_perp.x+q.y*this.m_axis.x;h=q.x*this.m_perp.y+q.y*this.m_axis.y;s=q.x*this.m_s1+q.y*this.m_a1;q=q.x*this.m_s2+q.y*this.m_a2;c.x-=this.m_invMassA*p;c.y-=this.m_invMassA*
h;d-=this.m_invIA*s;e.x+=this.m_invMassB*p;e.y+=this.m_invMassB*h;f+=this.m_invIB*q;a.m_sweep.a=d;b.m_sweep.a=f;a.synchronizeTransform();b.synchronizeTransform();return x<=w.b2_linearSlop?n<=w.b2_angularSlop:!1},__class__:he});var ie=function(){ma.call(this)};ie.__name__=["box2D","dynamics","joints","B2LineJointDef"];ie.__super__=ma;ie.prototype=p(ma.prototype,{b2LineJointDef:function(){this.localAnchorA=new u;this.localAnchorB=new u;this.localAxisA=new u;this.type=R.LINE_JOINT;this.localAxisA.set(1,
0);this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0},initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.localAxisA=this.bodyA.getLocalVector(d)},__class__:ie});var de=function(a){ha.call(this,a);this.K=new ka;this.K1=new ka;this.K2=new ka;this.m_localAnchor=new u;this.m_target=new u;this.m_impulse=new u;this.m_mass=new ka;this.m_C=
new u;this.m_target.setV(a.target);var b=this.m_target.x-this.m_bodyB.m_xf.position.x,c=this.m_target.y-this.m_bodyB.m_xf.position.y,d=this.m_bodyB.m_xf.R;this.m_localAnchor.x=b*d.col1.x+c*d.col1.y;this.m_localAnchor.y=b*d.col2.x+c*d.col2.y;this.m_maxForce=a.maxForce;this.m_impulse.setZero();this.m_frequencyHz=a.frequencyHz;this.m_dampingRatio=a.dampingRatio;this.m_gamma=this.m_beta=0};de.__name__=["box2D","dynamics","joints","B2MouseJoint"];de.__super__=ha;de.prototype=p(ha.prototype,{getAnchorA:function(){return this.m_target},
getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor)},getReactionForce:function(a){return new u(a*this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return 0},getTarget:function(){return this.m_target},setTarget:function(a){!1==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0);this.m_target=a},getMaxForce:function(){return this.m_maxForce},setMaxForce:function(a){this.m_maxForce=a},getFrequency:function(){return this.m_frequencyHz},setFrequency:function(a){this.m_frequencyHz=
a},getDampingRatio:function(){return this.m_dampingRatio},setDampingRatio:function(a){this.m_dampingRatio=a},initVelocityConstraints:function(a){var b=this.m_bodyB,c=b.getMass(),d=2*Math.PI*this.m_frequencyHz,e=c*d*d;this.m_gamma=a.dt*(2*c*this.m_dampingRatio*d+a.dt*e);this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0;this.m_beta=a.dt*e*this.m_gamma;var e=b.m_xf.R,c=this.m_localAnchor.x-b.m_sweep.localCenter.x,d=this.m_localAnchor.y-b.m_sweep.localCenter.y,f=e.col1.x*c+e.col2.x*d,d=e.col1.y*c+e.col2.y*
d,c=f,e=b.m_invMass,f=b.m_invI;this.K1.col1.x=e;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=e;this.K2.col1.x=f*d*d;this.K2.col2.x=-f*c*d;this.K2.col1.y=-f*c*d;this.K2.col2.y=f*c*c;this.K.setM(this.K1);this.K.addM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.getInverse(this.m_mass);this.m_C.x=b.m_sweep.c.x+c-this.m_target.x;this.m_C.y=b.m_sweep.c.y+d-this.m_target.y;b.m_angularVelocity*=0.98;this.m_impulse.x*=a.dtRatio;this.m_impulse.y*=a.dtRatio;b.m_linearVelocity.x+=
e*this.m_impulse.x;b.m_linearVelocity.y+=e*this.m_impulse.y;b.m_angularVelocity+=f*(c*this.m_impulse.y-d*this.m_impulse.x)},solveVelocityConstraints:function(a){var b=this.m_bodyB,c,d,e;c=b.m_xf.R;var f=this.m_localAnchor.x-b.m_sweep.localCenter.x,g=this.m_localAnchor.y-b.m_sweep.localCenter.y;d=c.col1.x*f+c.col2.x*g;g=c.col1.y*f+c.col2.y*g;f=d;d=b.m_linearVelocity.x+-b.m_angularVelocity*g;var k=b.m_linearVelocity.y+b.m_angularVelocity*f;c=this.m_mass;d=d+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;
e=k+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;k=-(c.col1.x*d+c.col2.x*e);e=-(c.col1.y*d+c.col2.y*e);c=this.m_impulse.x;d=this.m_impulse.y;this.m_impulse.x+=k;this.m_impulse.y+=e;a=a.dt*this.m_maxForce;this.m_impulse.lengthSquared()>a*a&&this.m_impulse.multiply(a/this.m_impulse.length());k=this.m_impulse.x-c;e=this.m_impulse.y-d;b.m_linearVelocity.x+=b.m_invMass*k;b.m_linearVelocity.y+=b.m_invMass*e;b.m_angularVelocity+=b.m_invI*(f*e-g*k)},solvePositionConstraints:function(a){return!0},
__class__:de});var ee=function(){ma.call(this);this.target=new u;this.type=R.MOUSE_JOINT;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=0.7};ee.__name__=["box2D","dynamics","joints","B2MouseJointDef"];ee.__super__=ma;ee.prototype=p(ma.prototype,{__class__:ee});var Gc=function(a){ha.call(this,a);this.m_localAnchor1=new u;this.m_localAnchor2=new u;this.m_localXAxis1=new u;this.m_localYAxis1=new u;this.m_axis=new u;this.m_perp=new u;this.m_K=new lc;this.m_impulse=new Wa;this.m_localAnchor1.setV(a.localAnchorA);
this.m_localAnchor2.setV(a.localAnchorB);this.m_localXAxis1.setV(a.localAxisA);this.m_localYAxis1.x=-this.m_localXAxis1.y;this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=a.referenceAngle;this.m_impulse.setZero();this.m_motorImpulse=this.m_motorMass=0;this.m_lowerTranslation=a.lowerTranslation;this.m_upperTranslation=a.upperTranslation;this.m_maxMotorForce=a.maxMotorForce;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=G.INACTIVE_LIMIT;
this.m_axis.setZero();this.m_perp.setZero()};Gc.__name__=["box2D","dynamics","joints","B2PrismaticJoint"];Gc.__super__=ha;Gc.prototype=p(ha.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new u(a*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),a*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*
this.m_axis.y))},getReactionTorque:function(a){return a*this.m_impulse.y},getJointTranslation:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.getWorldPoint(this.m_localAnchor1),d=b.getWorldPoint(this.m_localAnchor2),b=d.x-c.x,c=d.y-c.y,a=a.getWorldVector(this.m_localXAxis1);return a.x*b+a.y*c},getJointSpeed:function(){var a=this.m_bodyA,b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*
e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,c=b.m_sweep.c.x+g-(a.m_sweep.c.x+d),f=b.m_sweep.c.y+k-(a.m_sweep.c.y+e),h=a.getWorldVector(this.m_localXAxis1),m=a.m_linearVelocity,l=b.m_linearVelocity,a=a.m_angularVelocity,b=b.m_angularVelocity;return c*-a*h.y+f*a*h.x+(h.x*(l.x+-b*k-m.x- -a*e)+h.y*(l.y+b*g-m.y-a*d))},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_bodyA.setAwake(!0);
this.m_bodyB.setAwake(!0);this.m_enableLimit=a},getLowerLimit:function(){return this.m_lowerTranslation},getUpperLimit:function(){return this.m_upperTranslation},setLimits:function(a,b){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_lowerTranslation=a;this.m_upperTranslation=b},isMotorEnabled:function(){return this.m_enableMotor},enableMotor:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);
this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorForce:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_maxMotorForce=a},getMotorForce:function(){return this.m_motorImpulse},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;this.m_localCenterA.setV(b.getLocalCenter());this.m_localCenterB.setV(c.getLocalCenter());var f=b.getTransform();c.getTransform();d=b.m_xf.R;var g=this.m_localAnchor1.x-this.m_localCenterA.x,k=this.m_localAnchor1.y-
this.m_localCenterA.y;e=d.col1.x*g+d.col2.x*k;k=d.col1.y*g+d.col2.y*k;g=e;d=c.m_xf.R;var h=this.m_localAnchor2.x-this.m_localCenterB.x,m=this.m_localAnchor2.y-this.m_localCenterB.y;e=d.col1.x*h+d.col2.x*m;m=d.col1.y*h+d.col2.y*m;h=e;d=c.m_sweep.c.x+h-b.m_sweep.c.x-g;e=c.m_sweep.c.y+m-b.m_sweep.c.y-k;this.m_invMassA=b.m_invMass;this.m_invMassB=c.m_invMass;this.m_invIA=b.m_invI;this.m_invIB=c.m_invI;this.m_axis.setV(r.mulMV(f.R,this.m_localXAxis1));this.m_a1=(d+g)*this.m_axis.y-(e+k)*this.m_axis.x;
this.m_a2=h*this.m_axis.y-m*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass>Number.MIN_VALUE&&(this.m_motorMass=1/this.m_motorMass);this.m_perp.setV(r.mulMV(f.R,this.m_localYAxis1));this.m_s1=(d+g)*this.m_perp.y-(e+k)*this.m_perp.x;this.m_s2=h*this.m_perp.y-m*this.m_perp.x;f=this.m_invMassA;g=this.m_invMassB;k=this.m_invIA;h=this.m_invIB;this.m_K.col1.x=f+g+k*this.m_s1*this.m_s1+h*this.m_s2*this.m_s2;
this.m_K.col1.y=k*this.m_s1+h*this.m_s2;this.m_K.col1.z=k*this.m_s1*this.m_a1+h*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=k+h;this.m_K.col2.z=k*this.m_a1+h*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=f+g+k*this.m_a1*this.m_a1+h*this.m_a2*this.m_a2;this.m_enableLimit?(d=this.m_axis.x*d+this.m_axis.y*e,r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*w.b2_linearSlop?this.m_limitState=G.EQUAL_LIMITS:d<=this.m_lowerTranslation?
this.m_limitState!=G.AT_LOWER_LIMIT&&(this.m_limitState=G.AT_LOWER_LIMIT,this.m_impulse.z=0):d>=this.m_upperTranslation?this.m_limitState!=G.AT_UPPER_LIMIT&&(this.m_limitState=G.AT_UPPER_LIMIT,this.m_impulse.z=0):(this.m_limitState=G.INACTIVE_LIMIT,this.m_impulse.z=0)):this.m_limitState=G.INACTIVE_LIMIT;!1==this.m_enableMotor&&(this.m_motorImpulse=0);a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+
this.m_impulse.z)*this.m_axis.x,d=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y,e=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,f=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2,b.m_linearVelocity.x-=this.m_invMassA*a,b.m_linearVelocity.y-=this.m_invMassA*d,b.m_angularVelocity-=this.m_invIA*e,c.m_linearVelocity.x+=this.m_invMassB*a,c.m_linearVelocity.y+=this.m_invMassB*
d,c.m_angularVelocity+=this.m_invIB*f):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_linearVelocity,e=b.m_angularVelocity,f=c.m_linearVelocity,g=c.m_angularVelocity,k,h,m;this.m_enableMotor&&this.m_limitState!=G.EQUAL_LIMITS&&(m=this.m_motorMass*(this.m_motorSpeed-(this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e)),k=this.m_motorImpulse,a=a.dt*this.m_maxMotorForce,this.m_motorImpulse=r.clamp(this.m_motorImpulse+
m,-a,a),m=this.m_motorImpulse-k,k=m*this.m_axis.x,a=m*this.m_axis.y,h=m*this.m_a1,m*=this.m_a2,d.x-=this.m_invMassA*k,d.y-=this.m_invMassA*a,e-=this.m_invIA*h,f.x+=this.m_invMassB*k,f.y+=this.m_invMassB*a,g+=this.m_invIB*m);h=this.m_perp.x*(f.x-d.x)+this.m_perp.y*(f.y-d.y)+this.m_s2*g-this.m_s1*e;a=g-e;this.m_enableLimit&&this.m_limitState!=G.INACTIVE_LIMIT?(m=this.m_axis.x*(f.x-d.x)+this.m_axis.y*(f.y-d.y)+this.m_a2*g-this.m_a1*e,k=this.m_impulse.copy(),m=this.m_K.solve33(new Wa,-h,-a,-m),this.m_impulse.add(m),
this.m_limitState==G.AT_LOWER_LIMIT?this.m_impulse.z=r.max(this.m_impulse.z,0):this.m_limitState==G.AT_UPPER_LIMIT&&(this.m_impulse.z=r.min(this.m_impulse.z,0)),h=-h-(this.m_impulse.z-k.z)*this.m_K.col3.x,a=-a-(this.m_impulse.z-k.z)*this.m_K.col3.y,a=this.m_K.solve22(new u,h,a),a.x+=k.x,a.y+=k.y,this.m_impulse.x=a.x,this.m_impulse.y=a.y,m.x=this.m_impulse.x-k.x,m.y=this.m_impulse.y-k.y,m.z=this.m_impulse.z-k.z,k=m.x*this.m_perp.x+m.z*this.m_axis.x,a=m.x*this.m_perp.y+m.z*this.m_axis.y,h=m.x*this.m_s1+
m.y+m.z*this.m_a1,m=m.x*this.m_s2+m.y+m.z*this.m_a2):(m=this.m_K.solve22(new u,-h,-a),this.m_impulse.x+=m.x,this.m_impulse.y+=m.y,k=m.x*this.m_perp.x,a=m.x*this.m_perp.y,h=m.x*this.m_s1+m.y,m=m.x*this.m_s2+m.y);d.x-=this.m_invMassA*k;d.y-=this.m_invMassA*a;e-=this.m_invIA*h;f.x+=this.m_invMassB*k;f.y+=this.m_invMassB*a;g+=this.m_invIB*m;b.m_linearVelocity.setV(d);b.m_angularVelocity=e;c.m_linearVelocity.setV(f);c.m_angularVelocity=g},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,
c=a.m_sweep.c,d=a.m_sweep.a,e=b.m_sweep.c,f=b.m_sweep.a,g,k,h,m,l=0,n=0;h=!1;var p=0,q=ka.fromAngle(d),s=ka.fromAngle(f);g=q;var n=this.m_localAnchor1.x-this.m_localCenterA.x,t=this.m_localAnchor1.y-this.m_localCenterA.y;k=g.col1.x*n+g.col2.x*t;t=g.col1.y*n+g.col2.y*t;n=k;g=s;s=this.m_localAnchor2.x-this.m_localCenterB.x;m=this.m_localAnchor2.y-this.m_localCenterB.y;k=g.col1.x*s+g.col2.x*m;m=g.col1.y*s+g.col2.y*m;s=k;g=e.x+s-c.x-n;k=e.y+m-c.y-t;if(this.m_enableLimit){this.m_axis=r.mulMV(q,this.m_localXAxis1);
this.m_a1=(g+n)*this.m_axis.y-(k+t)*this.m_axis.x;this.m_a2=s*this.m_axis.y-m*this.m_axis.x;var v=this.m_axis.x*g+this.m_axis.y*k;r.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*w.b2_linearSlop?(p=r.clamp(v,-w.b2_maxLinearCorrection,w.b2_maxLinearCorrection),l=r.abs(v),h=!0):v<=this.m_lowerTranslation?(p=r.clamp(v-this.m_lowerTranslation+w.b2_linearSlop,-w.b2_maxLinearCorrection,0),l=this.m_lowerTranslation-v,h=!0):v>=this.m_upperTranslation&&(p=r.clamp(v-this.m_upperTranslation+w.b2_linearSlop,
0,w.b2_maxLinearCorrection),l=v-this.m_upperTranslation,h=!0)}this.m_perp=r.mulMV(q,this.m_localYAxis1);this.m_s1=(g+n)*this.m_perp.y-(k+t)*this.m_perp.x;this.m_s2=s*this.m_perp.y-m*this.m_perp.x;q=new Wa;t=this.m_perp.x*g+this.m_perp.y*k;s=f-d-this.m_refAngle;l=r.max(l,r.abs(t));n=r.abs(s);h?(h=this.m_invMassA,m=this.m_invMassB,g=this.m_invIA,k=this.m_invIB,this.m_K.col1.x=h+m+g*this.m_s1*this.m_s1+k*this.m_s2*this.m_s2,this.m_K.col1.y=g*this.m_s1+k*this.m_s2,this.m_K.col1.z=g*this.m_s1*this.m_a1+
k*this.m_s2*this.m_a2,this.m_K.col2.x=this.m_K.col1.y,this.m_K.col2.y=g+k,this.m_K.col2.z=g*this.m_a1+k*this.m_a2,this.m_K.col3.x=this.m_K.col1.z,this.m_K.col3.y=this.m_K.col2.z,this.m_K.col3.z=h+m+g*this.m_a1*this.m_a1+k*this.m_a2*this.m_a2,this.m_K.solve33(q,-t,-s,-p)):(h=this.m_invMassA,m=this.m_invMassB,g=this.m_invIA,k=this.m_invIB,p=g*this.m_s1+k*this.m_s2,v=g+k,this.m_K.col1.set(h+m+g*this.m_s1*this.m_s1+k*this.m_s2*this.m_s2,p,0),this.m_K.col2.set(p,v,0),p=this.m_K.solve22(new u,-t,-s),q.x=
p.x,q.y=p.y,q.z=0);p=q.x*this.m_perp.x+q.z*this.m_axis.x;h=q.x*this.m_perp.y+q.z*this.m_axis.y;t=q.x*this.m_s1+q.y+q.z*this.m_a1;q=q.x*this.m_s2+q.y+q.z*this.m_a2;c.x-=this.m_invMassA*p;c.y-=this.m_invMassA*h;d-=this.m_invIA*t;e.x+=this.m_invMassB*p;e.y+=this.m_invMassB*h;f+=this.m_invIB*q;a.m_sweep.a=d;b.m_sweep.a=f;a.synchronizeTransform();b.synchronizeTransform();return l<=w.b2_linearSlop?n<=w.b2_angularSlop:!1},__class__:Gc});var $d=function(){ma.call(this);this.localAnchorA=new u;this.localAnchorB=
new u;this.localAxisA=new u;this.type=R.PRISMATIC_JOINT;this.localAxisA.set(1,0);this.referenceAngle=0;this.enableLimit=!1;this.upperTranslation=this.lowerTranslation=0;this.enableMotor=!1;this.motorSpeed=this.maxMotorForce=0};$d.__name__=["box2D","dynamics","joints","B2PrismaticJointDef"];$d.__super__=ma;$d.prototype=p(ma.prototype,{initialize:function(a,b,c,d){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.localAxisA=this.bodyA.getLocalVector(d);
this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:$d});var Ab=function(a){ha.call(this,a);this.m_groundAnchor1=new u;this.m_groundAnchor2=new u;this.m_localAnchor1=new u;this.m_localAnchor2=new u;this.m_u1=new u;this.m_u2=new u;this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=a.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=a.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=a.groundAnchorB.x-this.m_ground.m_xf.position.x;
this.m_groundAnchor2.y=a.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.setV(a.localAnchorA);this.m_localAnchor2.setV(a.localAnchorB);this.m_ratio=a.ratio;this.m_constant=a.lengthA+this.m_ratio*a.lengthB;this.m_maxLength1=r.min(a.maxLengthA,this.m_constant-this.m_ratio*Ab.b2_minPulleyLength);this.m_maxLength2=r.min(a.maxLengthB,(this.m_constant-Ab.b2_minPulleyLength)/this.m_ratio);this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0};Ab.__name__=["box2D","dynamics","joints",
"B2PulleyJoint"];Ab.__super__=ha;Ab.prototype=p(ha.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new u(a*this.m_impulse*this.m_u2.x,a*this.m_impulse*this.m_u2.y)},getReactionTorque:function(a){return 0},getGroundAnchorA:function(){var a=this.m_ground.m_xf.position.copy();a.add(this.m_groundAnchor1);return a},getGroundAnchorB:function(){var a=
this.m_ground.m_xf.position.copy();a.add(this.m_groundAnchor2);return a},getLength1:function(){var a=this.m_bodyA.getWorldPoint(this.m_localAnchor1),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y);return Math.sqrt(b*b+a*a)},getLength2:function(){var a=this.m_bodyB.getWorldPoint(this.m_localAnchor2),b=a.x-(this.m_ground.m_xf.position.x+this.m_groundAnchor2.x),a=a.y-(this.m_ground.m_xf.position.y+this.m_groundAnchor2.y);return Math.sqrt(b*
b+a*a)},getRatio:function(){return this.m_ratio},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d=b.m_xf.R,e=this.m_localAnchor1.x-b.m_sweep.localCenter.x,f=this.m_localAnchor1.y-b.m_sweep.localCenter.y,g=d.col1.x*e+d.col2.x*f,f=d.col1.y*e+d.col2.y*f,e=g,d=c.m_xf.R,k=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y,g=d.col1.x*k+d.col2.x*h,h=d.col1.y*k+d.col2.y*h,k=g,d=c.m_sweep.c.x+k,g=c.m_sweep.c.y+h,m=this.m_ground.m_xf.position.x+
this.m_groundAnchor2.x,l=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.set(b.m_sweep.c.x+e-(this.m_ground.m_xf.position.x+this.m_groundAnchor1.x),b.m_sweep.c.y+f-(this.m_ground.m_xf.position.y+this.m_groundAnchor1.y));this.m_u2.set(d-m,g-l);d=this.m_u1.length();g=this.m_u2.length();d>w.b2_linearSlop?this.m_u1.multiply(1/d):this.m_u1.setZero();g>w.b2_linearSlop?this.m_u2.multiply(1/g):this.m_u2.setZero();0<this.m_constant-d-this.m_ratio*g?(this.m_state=G.INACTIVE_LIMIT,this.m_impulse=
0):this.m_state=G.AT_UPPER_LIMIT;d<this.m_maxLength1?(this.m_limitState1=G.INACTIVE_LIMIT,this.m_limitImpulse1=0):this.m_limitState1=G.AT_UPPER_LIMIT;g<this.m_maxLength2?(this.m_limitState2=G.INACTIVE_LIMIT,this.m_limitImpulse2=0):this.m_limitState2=G.AT_UPPER_LIMIT;d=e*this.m_u1.y-f*this.m_u1.x;g=k*this.m_u2.y-h*this.m_u2.x;this.m_limitMass1=b.m_invMass+b.m_invI*d*d;this.m_limitMass2=c.m_invMass+c.m_invI*g*g;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=
1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;a.warmStarting?(this.m_impulse*=a.dtRatio,this.m_limitImpulse1*=a.dtRatio,this.m_limitImpulse2*=a.dtRatio,a=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.x,d=(-this.m_impulse-this.m_limitImpulse1)*this.m_u1.y,g=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.x,m=(-this.m_ratio*this.m_impulse-this.m_limitImpulse2)*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*a,b.m_linearVelocity.y+=b.m_invMass*
d,b.m_angularVelocity+=b.m_invI*(e*d-f*a),c.m_linearVelocity.x+=c.m_invMass*g,c.m_linearVelocity.y+=c.m_invMass*m,c.m_angularVelocity+=c.m_invI*(k*m-h*g)):this.m_limitImpulse2=this.m_limitImpulse1=this.m_impulse=0},solveVelocityConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c=a.m_xf.R,d=this.m_localAnchor1.x-a.m_sweep.localCenter.x,e=this.m_localAnchor1.y-a.m_sweep.localCenter.y,f=c.col1.x*d+c.col2.x*e,e=c.col1.y*d+c.col2.y*e,d=f,c=b.m_xf.R,g=this.m_localAnchor2.x-b.m_sweep.localCenter.x,
k=this.m_localAnchor2.y-b.m_sweep.localCenter.y,f=c.col1.x*g+c.col2.x*k,k=c.col1.y*g+c.col2.y*k,g=f,h,m;this.m_state==G.AT_UPPER_LIMIT&&(c=a.m_linearVelocity.x+-a.m_angularVelocity*e,f=a.m_linearVelocity.y+a.m_angularVelocity*d,h=b.m_linearVelocity.x+-b.m_angularVelocity*k,m=b.m_linearVelocity.y+b.m_angularVelocity*g,c=-(this.m_u1.x*c+this.m_u1.y*f)-this.m_ratio*(this.m_u2.x*h+this.m_u2.y*m),m=this.m_pulleyMass*-c,c=this.m_impulse,this.m_impulse=r.max(0,this.m_impulse+m),m=this.m_impulse-c,c=-m*this.m_u1.x,
f=-m*this.m_u1.y,h=-this.m_ratio*m*this.m_u2.x,m=-this.m_ratio*m*this.m_u2.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*f,a.m_angularVelocity+=a.m_invI*(d*f-e*c),b.m_linearVelocity.x+=b.m_invMass*h,b.m_linearVelocity.y+=b.m_invMass*m,b.m_angularVelocity+=b.m_invI*(g*m-k*h));this.m_limitState1==G.AT_UPPER_LIMIT&&(c=a.m_linearVelocity.x+-a.m_angularVelocity*e,f=a.m_linearVelocity.y+a.m_angularVelocity*d,c=-(this.m_u1.x*c+this.m_u1.y*f),m=-this.m_limitMass1*c,c=this.m_limitImpulse1,
this.m_limitImpulse1=r.max(0,this.m_limitImpulse1+m),m=this.m_limitImpulse1-c,c=-m*this.m_u1.x,f=-m*this.m_u1.y,a.m_linearVelocity.x+=a.m_invMass*c,a.m_linearVelocity.y+=a.m_invMass*f,a.m_angularVelocity+=a.m_invI*(d*f-e*c));this.m_limitState2==G.AT_UPPER_LIMIT&&(h=b.m_linearVelocity.x+-b.m_angularVelocity*k,m=b.m_linearVelocity.y+b.m_angularVelocity*g,c=-(this.m_u2.x*h+this.m_u2.y*m),m=-this.m_limitMass2*c,c=this.m_limitImpulse2,this.m_limitImpulse2=r.max(0,this.m_limitImpulse2+m),m=this.m_limitImpulse2-
c,h=-m*this.m_u2.x,m=-m*this.m_u2.y,b.m_linearVelocity.x+=b.m_invMass*h,b.m_linearVelocity.y+=b.m_invMass*m,b.m_angularVelocity+=b.m_invI*(g*m-k*h))},solvePositionConstraints:function(a){a=this.m_bodyA;var b=this.m_bodyB,c,d=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x,e=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y,f=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x,g=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y,k,h,m,l,n,p,q,s=0;this.m_state==G.AT_UPPER_LIMIT&&(c=a.m_xf.R,
k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,h=this.m_localAnchor1.y-a.m_sweep.localCenter.y,n=c.col1.x*k+c.col2.x*h,h=c.col1.y*k+c.col2.y*h,k=n,c=b.m_xf.R,m=this.m_localAnchor2.x-b.m_sweep.localCenter.x,l=this.m_localAnchor2.y-b.m_sweep.localCenter.y,n=c.col1.x*m+c.col2.x*l,l=c.col1.y*m+c.col2.y*l,m=n,c=a.m_sweep.c.x+k,n=a.m_sweep.c.y+h,p=b.m_sweep.c.x+m,q=b.m_sweep.c.y+l,this.m_u1.set(c-d,n-e),this.m_u2.set(p-f,q-g),c=this.m_u1.length(),n=this.m_u2.length(),c>w.b2_linearSlop?this.m_u1.multiply(1/
c):this.m_u1.setZero(),n>w.b2_linearSlop?this.m_u2.multiply(1/n):this.m_u2.setZero(),c=this.m_constant-c-this.m_ratio*n,s=r.max(s,-c),c=r.clamp(c+w.b2_linearSlop,-w.b2_maxLinearCorrection,0),q=-this.m_pulleyMass*c,c=-q*this.m_u1.x,n=-q*this.m_u1.y,p=-this.m_ratio*q*this.m_u2.x,q=-this.m_ratio*q*this.m_u2.y,a.m_sweep.c.x+=a.m_invMass*c,a.m_sweep.c.y+=a.m_invMass*n,a.m_sweep.a+=a.m_invI*(k*n-h*c),b.m_sweep.c.x+=b.m_invMass*p,b.m_sweep.c.y+=b.m_invMass*q,b.m_sweep.a+=b.m_invI*(m*q-l*p),a.synchronizeTransform(),
b.synchronizeTransform());this.m_limitState1==G.AT_UPPER_LIMIT&&(c=a.m_xf.R,k=this.m_localAnchor1.x-a.m_sweep.localCenter.x,h=this.m_localAnchor1.y-a.m_sweep.localCenter.y,n=c.col1.x*k+c.col2.x*h,h=c.col1.y*k+c.col2.y*h,k=n,c=a.m_sweep.c.x+k,n=a.m_sweep.c.y+h,this.m_u1.set(c-d,n-e),c=this.m_u1.length(),c>w.b2_linearSlop?(this.m_u1.x*=1/c,this.m_u1.y*=1/c):this.m_u1.setZero(),c=this.m_maxLength1-c,s=r.max(s,-c),c=r.clamp(c+w.b2_linearSlop,-w.b2_maxLinearCorrection,0),q=-this.m_limitMass1*c,c=-q*this.m_u1.x,
n=-q*this.m_u1.y,a.m_sweep.c.x+=a.m_invMass*c,a.m_sweep.c.y+=a.m_invMass*n,a.m_sweep.a+=a.m_invI*(k*n-h*c),a.synchronizeTransform());this.m_limitState2==G.AT_UPPER_LIMIT&&(c=b.m_xf.R,m=this.m_localAnchor2.x-b.m_sweep.localCenter.x,l=this.m_localAnchor2.y-b.m_sweep.localCenter.y,n=c.col1.x*m+c.col2.x*l,l=c.col1.y*m+c.col2.y*l,m=n,p=b.m_sweep.c.x+m,q=b.m_sweep.c.y+l,this.m_u2.set(p-f,q-g),n=this.m_u2.length(),n>w.b2_linearSlop?(this.m_u2.x*=1/n,this.m_u2.y*=1/n):this.m_u2.setZero(),c=this.m_maxLength2-
n,s=r.max(s,-c),c=r.clamp(c+w.b2_linearSlop,-w.b2_maxLinearCorrection,0),q=-this.m_limitMass2*c,p=-q*this.m_u2.x,q=-q*this.m_u2.y,b.m_sweep.c.x+=b.m_invMass*p,b.m_sweep.c.y+=b.m_invMass*q,b.m_sweep.a+=b.m_invI*(m*q-l*p),b.synchronizeTransform());return s<w.b2_linearSlop},__class__:Ab});var ce=function(){ma.call(this);this.groundAnchorA=new u;this.groundAnchorB=new u;this.localAnchorA=new u;this.localAnchorB=new u;this.type=R.PULLEY_JOINT;this.groundAnchorA.set(-1,1);this.groundAnchorB.set(1,1);this.localAnchorA.set(-1,
0);this.localAnchorB.set(1,0);this.maxLengthB=this.lengthB=this.maxLengthA=this.lengthA=0;this.ratio=1;this.collideConnected=!0};ce.__name__=["box2D","dynamics","joints","B2PulleyJointDef"];ce.__super__=ma;ce.prototype=p(ma.prototype,{initialize:function(a,b,c,d,e,f,g){this.bodyA=a;this.bodyB=b;this.groundAnchorA.setV(c);this.groundAnchorB.setV(d);this.localAnchorA=this.bodyA.getLocalPoint(e);this.localAnchorB=this.bodyB.getLocalPoint(f);a=e.x-c.x;c=e.y-c.y;this.lengthA=Math.sqrt(a*a+c*c);c=f.x-d.x;
d=f.y-d.y;this.lengthB=Math.sqrt(c*c+d*d);this.ratio=g;g=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=g-this.ratio*Ab.b2_minPulleyLength;this.maxLengthB=(g-Ab.b2_minPulleyLength)/this.ratio},__class__:ce});var Bb=function(a){ha.call(this,a);this.K=new ka;this.K1=new ka;this.K2=new ka;this.K3=new ka;this.impulse3=new Wa;this.impulse2=new u;this.reduced=new u;this.m_localAnchor1=new u;this.m_localAnchor2=new u;this.m_impulse=new Wa;this.m_mass=new lc;this.m_localAnchor1.setV(a.localAnchorA);
this.m_localAnchor2.setV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.setZero();this.m_motorImpulse=0;this.m_lowerAngle=a.lowerAngle;this.m_upperAngle=a.upperAngle;this.m_maxMotorTorque=a.maxMotorTorque;this.m_motorSpeed=a.motorSpeed;this.m_enableLimit=a.enableLimit;this.m_enableMotor=a.enableMotor;this.m_limitState=G.INACTIVE_LIMIT};Bb.__name__=["box2D","dynamics","joints","B2RevoluteJoint"];Bb.__super__=ha;Bb.prototype=p(ha.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchor1)},
getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchor2)},getReactionForce:function(a){return new u(a*this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return a*this.m_impulse.z},getJointAngle:function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},getJointSpeed:function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},isLimitEnabled:function(){return this.m_enableLimit},enableLimit:function(a){this.m_enableLimit=
a},getLowerLimit:function(){return this.m_lowerAngle},getUpperLimit:function(){return this.m_upperAngle},setLimits:function(a,b){this.m_lowerAngle=a;this.m_upperAngle=b},isMotorEnabled:function(){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);return this.m_enableMotor},enableMotor:function(a){this.m_enableMotor=a},setMotorSpeed:function(a){this.m_bodyA.setAwake(!0);this.m_bodyB.setAwake(!0);this.m_motorSpeed=a},getMotorSpeed:function(){return this.m_motorSpeed},setMaxMotorTorque:function(a){this.m_maxMotorTorque=
a},getMotorTorque:function(){return this.m_maxMotorTorque},initVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e;d=b.m_xf.R;var f=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y;e=d.col1.x*f+d.col2.x*g;g=d.col1.y*f+d.col2.y*g;f=e;d=c.m_xf.R;var k=this.m_localAnchor2.x-c.m_sweep.localCenter.x,h=this.m_localAnchor2.y-c.m_sweep.localCenter.y;e=d.col1.x*k+d.col2.x*h;h=d.col1.y*k+d.col2.y*h;k=e;d=b.m_invMass;e=c.m_invMass;var m=b.m_invI,
l=c.m_invI;this.m_mass.col1.x=d+e+g*g*m+h*h*l;this.m_mass.col2.x=-g*f*m-h*k*l;this.m_mass.col3.x=-g*m-h*l;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=d+e+f*f*m+k*k*l;this.m_mass.col3.y=f*m+k*l;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=m+l;this.m_motorMass=1/(m+l);!1==this.m_enableMotor&&(this.m_motorImpulse=0);if(this.m_enableLimit){var n=c.m_sweep.a-b.m_sweep.a-this.m_referenceAngle;r.abs(this.m_upperAngle-this.m_lowerAngle)<2*w.b2_angularSlop?
this.m_limitState=G.EQUAL_LIMITS:n<=this.m_lowerAngle?(this.m_limitState!=G.AT_LOWER_LIMIT&&(this.m_impulse.z=0),this.m_limitState=G.AT_LOWER_LIMIT):n>=this.m_upperAngle?(this.m_limitState!=G.AT_UPPER_LIMIT&&(this.m_impulse.z=0),this.m_limitState=G.AT_UPPER_LIMIT):(this.m_limitState=G.INACTIVE_LIMIT,this.m_impulse.z=0)}else this.m_limitState=G.INACTIVE_LIMIT;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_motorImpulse*=a.dtRatio,a=this.m_impulse.x,n=this.m_impulse.y,
b.m_linearVelocity.x-=d*a,b.m_linearVelocity.y-=d*n,b.m_angularVelocity-=m*(f*n-g*a+this.m_motorImpulse+this.m_impulse.z),c.m_linearVelocity.x+=e*a,c.m_linearVelocity.y+=e*n,c.m_angularVelocity+=l*(k*n-h*a+this.m_motorImpulse+this.m_impulse.z)):(this.m_impulse.setZero(),this.m_motorImpulse=0)},solveVelocityConstraints:function(a){var b=this.m_bodyA,c=this.m_bodyB,d,e,f,g,k,h=b.m_linearVelocity,m=b.m_angularVelocity,l=c.m_linearVelocity,n=c.m_angularVelocity,q=b.m_invMass,p=c.m_invMass,s=b.m_invI,
t=c.m_invI;this.m_enableMotor&&this.m_limitState!=G.EQUAL_LIMITS&&(f=this.m_motorMass*-(n-m-this.m_motorSpeed),g=this.m_motorImpulse,a=a.dt*this.m_maxMotorTorque,this.m_motorImpulse=r.clamp(this.m_motorImpulse+f,-a,a),f=this.m_motorImpulse-g,m-=s*f,n+=t*f);if(this.m_enableLimit&&this.m_limitState!=G.INACTIVE_LIMIT){d=b.m_xf.R;f=this.m_localAnchor1.x-b.m_sweep.localCenter.x;g=this.m_localAnchor1.y-b.m_sweep.localCenter.y;e=d.col1.x*f+d.col2.x*g;g=d.col1.y*f+d.col2.y*g;f=e;d=c.m_xf.R;a=this.m_localAnchor2.x-
c.m_sweep.localCenter.x;k=this.m_localAnchor2.y-c.m_sweep.localCenter.y;e=d.col1.x*a+d.col2.x*k;k=d.col1.y*a+d.col2.y*k;a=e;e=l.x+-n*k-h.x- -m*g;var u=l.y+n*a-h.y-m*f;this.m_mass.solve33(this.impulse3,-e,-u,-(n-m));this.m_limitState==G.EQUAL_LIMITS?this.m_impulse.add(this.impulse3):this.m_limitState==G.AT_LOWER_LIMIT?(d=this.m_impulse.z+this.impulse3.z,0>d&&(this.m_mass.solve22(this.reduced,-e,-u),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=
this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0)):this.m_limitState==G.AT_UPPER_LIMIT&&(d=this.m_impulse.z+this.impulse3.z,0<d&&(this.m_mass.solve22(this.reduced,-e,-u),this.impulse3.x=this.reduced.x,this.impulse3.y=this.reduced.y,this.impulse3.z=-this.m_impulse.z,this.m_impulse.x+=this.reduced.x,this.m_impulse.y+=this.reduced.y,this.m_impulse.z=0));h.x-=q*this.impulse3.x;h.y-=q*this.impulse3.y;m-=s*(f*this.impulse3.y-g*this.impulse3.x+this.impulse3.z);l.x+=p*this.impulse3.x;l.y+=
p*this.impulse3.y;n+=t*(a*this.impulse3.y-k*this.impulse3.x+this.impulse3.z)}else d=b.m_xf.R,f=this.m_localAnchor1.x-b.m_sweep.localCenter.x,g=this.m_localAnchor1.y-b.m_sweep.localCenter.y,e=d.col1.x*f+d.col2.x*g,g=d.col1.y*f+d.col2.y*g,f=e,d=c.m_xf.R,a=this.m_localAnchor2.x-c.m_sweep.localCenter.x,k=this.m_localAnchor2.y-c.m_sweep.localCenter.y,e=d.col1.x*a+d.col2.x*k,k=d.col1.y*a+d.col2.y*k,a=e,this.m_mass.solve22(this.impulse2,-(l.x+-n*k-h.x- -m*g),-(l.y+n*a-h.y-m*f)),this.m_impulse.x+=this.impulse2.x,
this.m_impulse.y+=this.impulse2.y,h.x-=q*this.impulse2.x,h.y-=q*this.impulse2.y,m-=s*(f*this.impulse2.y-g*this.impulse2.x),l.x+=p*this.impulse2.x,l.y+=p*this.impulse2.y,n+=t*(a*this.impulse2.y-k*this.impulse2.x);b.m_linearVelocity.setV(h);b.m_angularVelocity=m;c.m_linearVelocity.setV(l);c.m_angularVelocity=n},solvePositionConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB,e=0;c=0;var f,g,k;if(this.m_enableLimit&&this.m_limitState!=G.INACTIVE_LIMIT){b=d.m_sweep.a-a.m_sweep.a-this.m_referenceAngle;
var h=0;this.m_limitState==G.EQUAL_LIMITS?(b=r.clamp(b-this.m_lowerAngle,-w.b2_maxAngularCorrection,w.b2_maxAngularCorrection),h=-this.m_motorMass*b,e=r.abs(b)):this.m_limitState==G.AT_LOWER_LIMIT?(b-=this.m_lowerAngle,e=-b,b=r.clamp(b+w.b2_angularSlop,-w.b2_maxAngularCorrection,0),h=-this.m_motorMass*b):this.m_limitState==G.AT_UPPER_LIMIT&&(e=b-=this.m_upperAngle,b=r.clamp(b-w.b2_angularSlop,0,w.b2_maxAngularCorrection),h=-this.m_motorMass*b);a.m_sweep.a-=a.m_invI*h;d.m_sweep.a+=d.m_invI*h;a.synchronizeTransform();
d.synchronizeTransform()}c=a.m_xf.R;h=this.m_localAnchor1.x-a.m_sweep.localCenter.x;b=this.m_localAnchor1.y-a.m_sweep.localCenter.y;f=c.col1.x*h+c.col2.x*b;b=c.col1.y*h+c.col2.y*b;h=f;c=d.m_xf.R;var m=this.m_localAnchor2.x-d.m_sweep.localCenter.x,l=this.m_localAnchor2.y-d.m_sweep.localCenter.y;f=c.col1.x*m+c.col2.x*l;l=c.col1.y*m+c.col2.y*l;m=f;g=d.m_sweep.c.x+m-a.m_sweep.c.x-h;k=d.m_sweep.c.y+l-a.m_sweep.c.y-b;var n=g*g+k*k;c=Math.sqrt(n);f=a.m_invMass;var q=d.m_invMass,p=a.m_invI,s=d.m_invI,t=10*
w.b2_linearSlop;n>t*t&&(n=1/(f+q),g=n*-g,k=n*-k,a.m_sweep.c.x-=0.5*f*g,a.m_sweep.c.y-=0.5*f*k,d.m_sweep.c.x+=0.5*q*g,d.m_sweep.c.y+=0.5*q*k,g=d.m_sweep.c.x+m-a.m_sweep.c.x-h,k=d.m_sweep.c.y+l-a.m_sweep.c.y-b);this.K1.col1.x=f+q;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=f+q;this.K2.col1.x=p*b*b;this.K2.col2.x=-p*h*b;this.K2.col1.y=-p*h*b;this.K2.col2.y=p*h*h;this.K3.col1.x=s*l*l;this.K3.col2.x=-s*m*l;this.K3.col1.y=-s*m*l;this.K3.col2.y=s*m*m;this.K.setM(this.K1);this.K.addM(this.K2);this.K.addM(this.K3);
this.K.solve(Bb.tImpulse,-g,-k);g=Bb.tImpulse.x;k=Bb.tImpulse.y;a.m_sweep.c.x-=a.m_invMass*g;a.m_sweep.c.y-=a.m_invMass*k;a.m_sweep.a-=a.m_invI*(h*k-b*g);d.m_sweep.c.x+=d.m_invMass*g;d.m_sweep.c.y+=d.m_invMass*k;d.m_sweep.a+=d.m_invI*(m*k-l*g);a.synchronizeTransform();d.synchronizeTransform();return c<=w.b2_linearSlop?e<=w.b2_angularSlop:!1},__class__:Bb});var Zd=function(){ma.call(this);this.localAnchorA=new u;this.localAnchorB=new u;this.type=R.REVOLUTE_JOINT;this.localAnchorA.set(0,0);this.localAnchorB.set(0,
0);this.motorSpeed=this.maxMotorTorque=this.upperAngle=this.lowerAngle=this.referenceAngle=0;this.enableMotor=this.enableLimit=!1};Zd.__name__=["box2D","dynamics","joints","B2RevoluteJointDef"];Zd.__super__=ma;Zd.prototype=p(ma.prototype,{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA=this.bodyA.getLocalPoint(c);this.localAnchorB=this.bodyB.getLocalPoint(c);this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:Zd});var je=function(a){ha.call(this,a);this.m_localAnchorA=
new u;this.m_localAnchorB=new u;this.m_impulse=new Wa;this.m_mass=new lc;this.m_localAnchorA.setV(a.localAnchorA);this.m_localAnchorB.setV(a.localAnchorB);this.m_referenceAngle=a.referenceAngle;this.m_impulse.setZero();this.m_mass=new lc};je.__name__=["box2D","dynamics","joints","B2WeldJoint"];je.__super__=ha;je.prototype=p(ha.prototype,{getAnchorA:function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},getAnchorB:function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},getReactionForce:function(a){return new u(a*
this.m_impulse.x,a*this.m_impulse.y)},getReactionTorque:function(a){return a*this.m_impulse.z},initVelocityConstraints:function(a){var b,c,d=this.m_bodyA,e=this.m_bodyB;b=d.m_xf.R;var f=this.m_localAnchorA.x-d.m_sweep.localCenter.x,g=this.m_localAnchorA.y-d.m_sweep.localCenter.y;c=b.col1.x*f+b.col2.x*g;g=b.col1.y*f+b.col2.y*g;f=c;b=e.m_xf.R;var k=this.m_localAnchorB.x-e.m_sweep.localCenter.x,h=this.m_localAnchorB.y-e.m_sweep.localCenter.y;c=b.col1.x*k+b.col2.x*h;h=b.col1.y*k+b.col2.y*h;k=c;b=d.m_invMass;
c=e.m_invMass;var m=d.m_invI,l=e.m_invI;this.m_mass.col1.x=b+c+g*g*m+h*h*l;this.m_mass.col2.x=-g*f*m-h*k*l;this.m_mass.col3.x=-g*m-h*l;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+f*f*m+k*k*l;this.m_mass.col3.y=f*m+k*l;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=m+l;a.warmStarting?(this.m_impulse.x*=a.dtRatio,this.m_impulse.y*=a.dtRatio,this.m_impulse.z*=a.dtRatio,d.m_linearVelocity.x-=b*this.m_impulse.x,d.m_linearVelocity.y-=b*this.m_impulse.y,
d.m_angularVelocity-=m*(f*this.m_impulse.y-g*this.m_impulse.x+this.m_impulse.z),e.m_linearVelocity.x+=c*this.m_impulse.x,e.m_linearVelocity.y+=c*this.m_impulse.y,e.m_angularVelocity+=l*(k*this.m_impulse.y-h*this.m_impulse.x+this.m_impulse.z)):this.m_impulse.setZero()},solveVelocityConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB,e=a.m_linearVelocity,f=a.m_angularVelocity,g=d.m_linearVelocity,k=d.m_angularVelocity,h=a.m_invMass,m=d.m_invMass,l=a.m_invI,n=d.m_invI;b=a.m_xf.R;var q=
this.m_localAnchorA.x-a.m_sweep.localCenter.x,p=this.m_localAnchorA.y-a.m_sweep.localCenter.y;c=b.col1.x*q+b.col2.x*p;p=b.col1.y*q+b.col2.y*p;q=c;b=d.m_xf.R;var s=this.m_localAnchorB.x-d.m_sweep.localCenter.x,r=this.m_localAnchorB.y-d.m_sweep.localCenter.y;c=b.col1.x*s+b.col2.x*r;r=b.col1.y*s+b.col2.y*r;s=c;b=g.x-k*r-e.x+f*p;c=g.y+k*s-e.y-f*q;var t=k-f,u=new Wa;this.m_mass.solve33(u,-b,-c,-t);this.m_impulse.add(u);e.x-=h*u.x;e.y-=h*u.y;f-=l*(q*u.y-p*u.x+u.z);g.x+=m*u.x;g.y+=m*u.y;k+=n*(s*u.y-r*u.x+
u.z);a.m_angularVelocity=f;d.m_angularVelocity=k},solvePositionConstraints:function(a){var b,c;a=this.m_bodyA;var d=this.m_bodyB;b=a.m_xf.R;var e=this.m_localAnchorA.x-a.m_sweep.localCenter.x,f=this.m_localAnchorA.y-a.m_sweep.localCenter.y;c=b.col1.x*e+b.col2.x*f;f=b.col1.y*e+b.col2.y*f;e=c;b=d.m_xf.R;var g=this.m_localAnchorB.x-d.m_sweep.localCenter.x,k=this.m_localAnchorB.y-d.m_sweep.localCenter.y;c=b.col1.x*g+b.col2.x*k;k=b.col1.y*g+b.col2.y*k;g=c;b=a.m_invMass;c=d.m_invMass;var h=a.m_invI,m=d.m_invI,
l=d.m_sweep.c.x+g-a.m_sweep.c.x-e,n=d.m_sweep.c.y+k-a.m_sweep.c.y-f,q=d.m_sweep.a-a.m_sweep.a-this.m_referenceAngle,p=10*w.b2_linearSlop,s=Math.sqrt(l*l+n*n),t=r.abs(q);s>p&&(h*=1,m*=1);this.m_mass.col1.x=b+c+f*f*h+k*k*m;this.m_mass.col2.x=-f*e*h-k*g*m;this.m_mass.col3.x=-f*h-k*m;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=b+c+e*e*h+g*g*m;this.m_mass.col3.y=e*h+g*m;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=h+m;p=new Wa;this.m_mass.solve33(p,
-l,-n,-q);a.m_sweep.c.x-=b*p.x;a.m_sweep.c.y-=b*p.y;a.m_sweep.a-=h*(e*p.y-f*p.x+p.z);d.m_sweep.c.x+=c*p.x;d.m_sweep.c.y+=c*p.y;d.m_sweep.a+=m*(g*p.y-k*p.x+p.z);a.synchronizeTransform();d.synchronizeTransform();return s<=w.b2_linearSlop?t<=w.b2_angularSlop:!1},__class__:je});var ke=function(){ma.call(this);this.localAnchorA=new u;this.localAnchorB=new u;this.type=R.WELD_JOINT;this.referenceAngle=0};ke.__name__=["box2D","dynamics","joints","B2WeldJointDef"];ke.__super__=ma;ke.prototype=p(ma.prototype,
{initialize:function(a,b,c){this.bodyA=a;this.bodyB=b;this.localAnchorA.setV(this.bodyA.getLocalPoint(c));this.localAnchorB.setV(this.bodyB.getLocalPoint(c));this.referenceAngle=this.bodyB.getAngle()-this.bodyA.getAngle()},__class__:ke});var Z={__ename__:!0,__constructs__:"Image Audio Other Javascript Css Font".split(" "),Image:["Image",0]};Z.Image.__enum__=Z;Z.Audio=["Audio",1];Z.Audio.__enum__=Z;Z.Other=["Other",2];Z.Other.__enum__=Z;Z.Javascript=["Javascript",3];Z.Javascript.__enum__=Z;Z.Css=["Css",
4];Z.Css.__enum__=Z;Z.Font=["Font",5];Z.Font.__enum__=Z;Z.__empty_constructs__=[Z.Image,Z.Audio,Z.Other,Z.Javascript,Z.Css,Z.Font];var ag=function(a,b,c,d,e){null==d&&(d=!1);this.isAbsolute=!1;this.asset=null;this.name=a;this.type=c;this.source=b;this.isAbsolute=d;this.options=e};ag.__name__=["f84","AssetLoadingInfo"];ag.prototype={__class__:ag};var Ca=function(){this._eventListeners=[]};Ca.__name__=["f84","events","EventDispatcher"];Ca.prototype={addEventListener:function(a,b){this.hasEventListener(a,
b)||this._eventListeners.push(new bg(a,b))},hasEventListener:function(a,b){for(var c=this._eventListeners.length-1;0<=c;){if(this._eventListeners[c].eventName==a&&Ja.compareMethods(this._eventListeners[c].action,b))return!0;--c}return!1},dispatchEvent:function(a){a.target=this;for(var b=this._eventListeners.length-1;0<=b;){var c=this._eventListeners[b];c.eventName==a.getType()&&c.action(a);--b}},removeAllEventListeners:function(){this._eventListeners=[]},removeEventListener:function(a,b){if(this.hasEventListener(a,
b))for(var c=this._eventListeners.length-1;0<=c;){var d=this._eventListeners[c];if(d.eventName==a&&Ja.compareMethods(d.action,b)){this._eventListeners.splice(c,1);break}--c}},__class__:Ca};var O=function(){this._instanceId=0;this._isActive=this._isUpdating=!0;this._isInitialized=this._isMarkedForDeletion=!1;this._eventListeners=[];this._instanceId=O._currentInstanceId++;this._name="GameObject"+this._instanceId;this._properties=new Pa};O.__name__=["f84","GameObject"];O.__super__=Ca;O.prototype=p(Ca.prototype,
{init:function(){this._isInitialized=!0;this.dispatchEvent(new ub("initialize"))},update:function(){!this._isInitialized&&this._isActive&&(this.init(),this.setActive(!0))},fixedUpdate:function(){},postUpdate:function(){},render:function(){},onActivate:function(){this._isActive=!0;this.dispatchEvent(new ub("activate"))},onDeactivate:function(){this._isActive=!1;this.dispatchEvent(new ub("deactivate"))},debugRender:function(){},handleMessage:function(a,b){},setProperty:function(a,b){var c=this._properties;
null!=ba[a]?c.setReserved(a,b):c.h[a]=b},getProperty:function(a){var b=this._properties;return null!=ba[a]?b.getReserved(a):b.h[a]},hasProperty:function(a){var b=this._properties;return null!=ba[a]?b.existsReserved(a):b.h.hasOwnProperty(a)},isMarkedForDeletion:function(){return this._isMarkedForDeletion},getName:function(){return this._name},setName:function(a){this._name=a},getInstanceId:function(){return this._instanceId},isActive:function(){return this._isActive},setActive:function(a){if(!this._isActive&&
a)this._isInitialized||this.init(),this.onActivate();else if(this._isActive&&!a)this.onDeactivate()},setUpdating:function(a){this._isUpdating=a},isUpdating:function(){return this._isUpdating},destroy:function(){this._isMarkedForDeletion=!0;this.setActive(!1)},onDestroy:function(){this.dispatchEvent(new ub("destroy"))},log:function(a){La.log(a)},__class__:O});var l=function(a){O.call(this);a.addComponent(this);this.setName(sb.getClassName(C.getClass(this)))};l.__name__=["f84","Component"];l.__super__=
O;l.prototype=p(O.prototype,{getEntity:function(){return this._entity},setEntity:function(a){this._entity=a},getTags:function(){return this.getEntity().getTags()},addTag:function(a){this.getEntity().addTag(a)},hasTag:function(a){return this.getEntity().hasTag(a)},removeTag:function(a){this.getEntity().removeTag(a)},getComponent:function(a){return this.getEntity().getComponent(a)},getGameState:function(){return this.getEntity().getGameState()},destroy:function(){O.prototype.destroy.call(this)},addEntity:function(a){null==
a&&(a=!0);return this.getEntity().addEntity(a)},onPause:function(){},onResume:function(){},onDestroy:function(){O.prototype.onDestroy.call(this)},__class__:l});var nc=function(a){this._prevScale=new L;this._prevRotation=new L;this._prevPosition=new L;this._cachedWorldScale=new L;this._cachedWorldRotation=new L;this._cachedWorldPosition=new L;this._worldPositionDirty=this._worldRotationDirty=this._worldScaleDirty=!0;this._isZSorted=!1;this._isVisible=!0;this._parent=null;O.call(this);this._components=
[];this._children=[];this._tags=[];this._transform=new Hc(this);this._transform.addEventListener("update",q(this,this.onTransformUpdate))};nc.__name__=["f84","Entity"];nc.instantiate=function(a){return a.addEntity()};nc.__super__=O;nc.prototype=p(O.prototype,{getTransform:function(){return this._transform},init:function(){O.prototype.init.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.init()}},isZSorted:function(){return this._isZSorted},setZSorted:function(a){this._isZSorted=
a},getGameState:function(){return this._gameState},setGameState:function(a){this._gameState=a},addTag:function(a){this._tags.push(a)},removeTag:function(a){for(var b=0,c=this._tags.length;b<c;){var d=b++;this._tags[d]==a&&this._tags.splice(d,1)}},hasTag:function(a){for(var b=0,c=this._tags.length;b<c;){var d=b++;if(this._tags[d]==a)return!0}return!1},getTags:function(){return this._tags},hasChild:function(a){for(var b=0,c=this._children.length;b<c;){var d=b++;if(this._children[d]==a)return!0}return!1},
removeChild:function(a,b){null==b&&(b=!1);for(var c=0,d=this._children.length;c<d;){var e=c++,f=this._children[e];if(f==a){f.setParent(null,b);this._children.splice(e,1);break}}},addChild:function(a,b){null==b&&(b=!1);a==this&&this.log("Cannot parent an Entity to itself.");null!=a.getParent()&&a.getParent().removeChild(a,b);this._children.push(a);a.setParent(this,b)},insertChild:function(a,b){a==this&&this.log("Cannot parent an Entity to itself.");null!=a.getParent()&&a.getParent().removeChild(a);
this._children.splice(b,0,a);a.setParent(this)},destroyAllChildren:function(){for(var a=0,b=this._children.length;a<b;){var c=a++;this._children[c].destroy()}this._children=[]},getParent:function(){return this._parent},getRootEntity:function(){return null!=this.getParent()?this.getParent():this},setParent:function(a,b){null==b&&(b=!1);if(this._parent!=a){var c=this.getPosition(),d=this.getRotation(),e=this.getScale();this._parent=a;null!=this.getParent()?this.dispatchEvent(new W("addedToParent",{parent:this.getParent()})):
this.dispatchEvent(new W("removedFromParent"));b&&(this.setPosition(c.x,c.y,c.z),this.setRotation(d.x,d.y,d.z),this.setScale(e.z,e.y,e.z));this.dispatchEvent(new W("displayUpdate"));this.dispatchEvent(new W("parentUpdate"));c=0;for(d=this._children;c<d.length;)e=d[c],++c,e.dispatchEvent(new W("parentUpdate"));this._worldScaleDirty=this._worldRotationDirty=this._worldPositionDirty=!0}},setActive:function(a){O.prototype.setActive.call(this,a)},isActive:function(){return this._isActive},isActiveInHierarchy:function(){return null!=
this.getParent()?this.isActive()?this.getParent().isActive():!1:this._isActive},getChildren:function(a){null==a&&(a=!1);if(!a)return this._children;a=this._children;for(var b=[].concat(a),c=0,d=b.length;c<d;){var e=c++;a=a.concat(b[e].getChildren(!0))}return a},findChildByName:function(a){for(var b=0,c=this._children.length;b<c;){var d=b++,d=this._children[d];if(d.getName()==a)return d;d=d.findChildByName(a);if(null!=d)return d}return null},isVisible:function(){return null!=this._parent?this._parent.isVisible()?
this._isVisible:!1:this._isVisible},setVisible:function(a){(this._isVisible=a)?this.dispatchEvent(new W("visibilityOn")):this.dispatchEvent(new W("visibilityOff"));this.dispatchEvent(new W("displayUpdate"))},onActivate:function(){O.prototype.onActivate.call(this);for(var a=0,b=this._children.length;a<b;){var c=a++;this._children[c].setActive(!0)}this.dispatchEvent(new W("displayUpdate"))},onDeactivate:function(){O.prototype.onDeactivate.call(this);for(var a=0,b=this._children.length;a<b;){var c=a++;
this._children[c].setActive(!1)}this.dispatchEvent(new W("displayUpdate"))},getPositionRef:function(){return this._transform.getPositionRef()},getPosition:function(){if(this._worldPositionDirty){this._cachedWorldPosition=this._transform.getPosition(T.World);this._worldPositionDirty=!1;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldPosition},getLocalPosition:function(){return this._transform.getPosition(T.Local)},
setLocalPosition:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setPosition(new L(a,b,c),T.Local);this.dispatchEvent(new W("displayUpdate"))},setPosition:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setPosition(new L(a,b,c),T.World);this.dispatchEvent(new W("displayUpdate"))},translate:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.translate(a,b,c);this.dispatchEvent(new W("displayUpdate"))},getRotationRef:function(){return this._transform.getRotationRef()},
getRotation:function(){if(this._worldRotationDirty){this._cachedWorldRotation=this._transform.getRotation(T.World);this._worldRotationDirty=!0;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldRotation},getLocalRotation:function(){return this._transform.getRotation(T.Local)},setLocalRotation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setRotation(a,b,c,T.Local);
this.dispatchEvent(new W("displayUpdate"))},setRotation:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._transform.setRotation(a,b,c,T.World);this.dispatchEvent(new W("displayUpdate"))},setLocalRotation2d:function(a){null==a&&(a=0);var b=this._transform.getRotation(T.Local);this._transform.setRotation(b.x,b.z,a,T.Local)},setRotation2d:function(a){null==a&&(a=0);var b=this._transform.getRotation(T.World);this._transform.setRotation(b.x,b.z,a,T.World)},rotate:function(a,b,c){this._transform.rotate(a,
b,c)},rotate2d:function(a){this._transform.rotate(0,0,a)},getScaleRef:function(){return this._transform.getScaleRef()},getScale:function(){if(this._worldScaleDirty){this._cachedWorldScale=this._transform.getScale(T.World);this._worldScaleDirty=!1;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c._worldPositionDirty=!0;c._worldRotationDirty=!0;c._worldScaleDirty=!0}}return this._cachedWorldScale},getLocalScale:function(){return this._transform.getScale(T.Local)},setScale:function(a,b,c){null==
c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._transform.setScale(a,b,c,T.World);this.dispatchEvent(new W("displayUpdate"))},setLocalScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._transform.setScale(a,b,c,T.Local);this.dispatchEvent(new W("displayUpdate"))},onPause:function(){for(var a=0,b=this._components.length;a<b;){var c=a++;this._components[c].onPause()}},onResume:function(){for(var a=0,b=this._components.length;a<b;){var c=a++;this._components[c].onResume()}},update:function(){O.prototype.update.call(this);
for(var a=this._components.length,b=a;0<b--;)a=this._components[b],a.isMarkedForDeletion()&&(a.onDestroy(),this._components.splice(b,1));a=this._components.length;for(b=0;b<a;){var c=b++,c=this._components[c];c.isActive()&&c.isUpdating()&&c.update()}},fixedUpdate:function(){O.prototype.fixedUpdate.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.fixedUpdate()}},render:function(){O.prototype.render.call(this);for(var a=0,b=this._components.length;a<
b;){var c=a++,c=this._components[c];c.isActive()&&c.render()}},postUpdate:function(){O.prototype.postUpdate.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.isUpdating()&&c.postUpdate()}},debugRender:function(){O.prototype.debugRender.call(this);for(var a=0,b=this._components.length;a<b;){var c=a++,c=this._components[c];c.isActive()&&c.debugRender()}a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=la.getDebugCamera()){var d=
la.getDebugCamera().getEntity(),b=la.getDebugCamera().getZoomScale(),c=la.getDebugCamera().getComponent(oc),d=d.getPosition();a.translate(-d.x*b+c.getContainerOffset().x,-d.y*b+c.getContainerOffset().y);a.scale(b,b)}a.beginPath();a.globalAlpha=0.65;a.lineWidth=1;a.strokeStyle="#44FF44";b=this.getPosition();a.moveTo(b.x,b.y-10);a.lineTo(b.x,b.y+10);a.moveTo(b.x-10,b.y);a.lineTo(b.x+10,b.y);a.moveTo(b.x-10,b.y-10);a.lineTo(b.x+10,b.y+10);a.moveTo(b.x+10,b.y-10);a.lineTo(b.x-10,b.y+10);a.stroke();a.restore();
n.getInstance().getLayerByName("debug").setWholeCanvasDirty(!0)},addComponent:function(a){for(var b=0,c=this._components.length;b<c;){var d=b++;if(this._components[d]==a)return null}this._components.push(a);a.setEntity(this);return a},getComponent:function(a){for(var b=0,c=this._components.length;b<c;)for(var d=b++,e=this._components[d],e=null==e?null:C.getClass(e);null!=e;){if(e==a)return this._components[d];e=sb.getSuperClass(e)}return null},getComponentWithSuperClass:function(a){for(var b=0,c=
this._components.length;b<c;){var d=b++,e=this._components[d];if(sb.getSuperClass(null==e?null:C.getClass(e))==a)return this._components[d]}return null},getComponentsInChildren:function(a){var b=[],c=this.getComponents(a);null!=c&&(b=b.concat(c));for(var c=0,d=this._children.length;c<d;){var e=c++,e=this._children[e].getComponentsInChildren(a);null!=e&&(b=b.concat(e))}return b},getComponents:function(a){if(null==a)return this._components;for(var b=[],c=0,d=this._components.length;c<d;){var e=c++,
f=this._components[e];(null==f?null:C.getClass(f))==a?b.push(this._components[e]):(f=this._components[e],sb.getSuperClass(null==f?null:C.getClass(f))==a&&b.push(this._components[e]))}return 0<b.length?b:null},handleMessage:function(a,b){for(var c=this._components.length-1;0<=c;){var d=this._components[c];d.isActive()&&d.handleMessage(a,b);--c}},isUpdating:function(){return null!=this._parent?this._isUpdating?this._parent.isUpdating():!1:this._isUpdating},destroy:function(){O.prototype.destroy.call(this);
null!=this._gameState&&this._gameState.scheduleEntityForDeletion(this);for(var a=this._components.length;0<a--;){var b=this._components[a];b.destroy();b.onDestroy()}for(a=this._children.length;0<a--;)b=this._children[a],b.destroy(),b.onDestroy();null!=this.getParent()&&this.getParent().removeChild(this)},addEntity:function(a){null==a&&(a=!0);var b=this.getGameState().addEntity();a&&this.addChild(b);return b},onTransformUpdate:function(){this._worldScaleDirty=this._worldRotationDirty=this._worldPositionDirty=
!0},setTransformsDirty:function(){this._worldScaleDirty=this._worldRotationDirty=this._worldPositionDirty=!0;for(var a=0,b=this._children;a<b.length;){var c=b[a];++a;c.setTransformsDirty()}},onDestroy:function(){O.prototype.onDestroy.call(this)},__class__:nc});var Y=function(){};Y.__name__=["f84","GameConfig"];Y.getProperty=function(a,b){var c=Y._properties;if(null!=ba[a]?!c.existsReserved(a):!c.h.hasOwnProperty(a))return b;c=Y._properties;return null!=ba[a]?c.getReserved(a):c.h[a]};Y.getBoolProperty=
function(a){a=Y.getProperty(a);return"TRUE"!=a.toUpperCase()?"1"==a:!0};Y.setProperty=function(a,b){var c=Y._properties,d=pa.string(b);null!=ba[a]?c.setReserved(a,d):c.h[a]=d};Y.parseGameConfig=function(a){for(var b=0,c=Ja.fields(a);b<c.length;){var d=c[b];++b;var e=Y._properties,f=Ja.field(a,d);null!=ba[d]?e.setReserved(d,f):e.h[d]=f}};Y.prototype={__class__:Y};var X=function(){this._activeEntities=this._entitiesToDelete=null;this._isPaused=!1;this._elapsedTime=0;this._hasInitialized=!1;O.call(this);
this._entities=[];this._activeEntities=[];this._entitiesToDelete=[];this._sceneRoot=this.addEntity()};X.__name__=["f84","GameState"];X.__super__=O;X.prototype=p(O.prototype,{getPaused:function(){return this._isPaused},init:function(){O.prototype.init.call(this)},getSceneRoot:function(){return this._sceneRoot},update:function(){O.prototype.update.call(this);for(var a=this._entitiesToDelete.length,b=0,c=a;b<c;){var d=b++,d=this._entitiesToDelete[d];d.onDestroy();F.remove(this._entities,d)}bc.clear(this._entitiesToDelete);
b=0;if(!this._isPaused){bc.clear(this._activeEntities);c=[].concat(this._entities);a=c.length;for(d=0;d<a;){var e=d++,e=c[e];null!=e&&e.isActiveInHierarchy()&&(this._activeEntities.push(e),++b,e.isUpdating()&&e.update())}this._elapsedTime+=n.getDeltaTime()}"1"==Y.getProperty("debugCheats")&&ea.getInstance().isKeyPressed(105)&&(this.log(this._entities),this.log(this._activeEntities),H.outputAssets(),this.log("Active entities: "+b))},fixedUpdate:function(){O.prototype.fixedUpdate.call(this);if(!this._isPaused)for(var a=
0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isActiveInHierarchy()&&c.fixedUpdate()}},postUpdate:function(){O.prototype.postUpdate.call(this);if(!this._isPaused)for(var a=0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isUpdating()&&c.isActiveInHierarchy()&&c.postUpdate()}},render:function(){O.prototype.render.call(this);for(var a=0,b=this._activeEntities.length;a<b;){var c=a++,c=this._activeEntities[c];c.isVisible()&&c.isActiveInHierarchy()&&
c.render()}},debugRender:function(){O.prototype.debugRender.call(this);for(var a=0,b=this._entities.length;a<b;){var c=a++,c=this._entities[c];c.isActive()&&c.isVisible()&&c.debugRender()}},addEntity:function(a){null==a&&(a=new nc);a.setGameState(this);this._entities.push(a);null!=this._sceneRoot&&this._sceneRoot.addChild(a);return a},removeEntity:function(a){F.remove(this._entities,a)},getHasEntity:function(a){return-1!=bc.indexOf(this._entities,a)},getEntities:function(){return this._entities},
findEntityByName:function(a){for(var b=0,c=this._entities.length;b<c;){var d=b++,d=this._entities[d];if(d.getName()==a)return d}return null},getEntitiesByTag:function(a,b){null==b&&(b=!0);for(var c=[],d=0,e=this._entities.length;d<e;){var f=d++,f=this._entities[f];(!b||f.isActiveInHierarchy())&&f.hasTag(a)&&c.push(f)}return c},getClosestEntityToPointByTag:function(a,b,c){null==c&&(c=!0);b=this.getEntitiesByTag(b);for(var d=-1,e=null,f=0,g=b.length;f<g;){var k=f++,k=b[k];if(!c||k.isActiveInHierarchy()){var h=
k.getPosition(),h=(new L(h.x-a.x,h.y-a.y,h.z-a.z)).getLength();if(-1==d||h<d)d=h,e=k}}return e},sortEntitiesByZ:function(){this._entities.sort(function(a,b){var c=a.getPosition(),d=b.getPosition();return c.z==d.z?a.getInstanceId()>b.getInstanceId()?1:-1:c.z<d.z?1:-1})},handleMessage:function(a,b){O.prototype.handleMessage.call(this,a,b);if(!this._isPaused)for(var c=this._activeEntities.length-1;0<=c;)this._activeEntities[c].isActive()&&this._activeEntities[c].handleMessage(a,b),--c},pause:function(){this._isPaused=
!0;for(var a=0,b=this._entities.length;a<b;){var c=a++;this._entities[c].onPause()}},resume:function(){this._isPaused=!1;for(var a=0,b=this._entities.length;a<b;){var c=a++;this._entities[c].onResume()}},bringEntityToFront:function(a,b){null==b&&(b=!1);F.remove(this._entities,a)&&this._entities.push(a);if(b)for(var c=a.getChildren(),d=0,e=c.length;d<e;){var f=d++;this.bringEntityToFront(c[f],!0)}},sendEntityToBack:function(a,b){null==b&&(b=!1);F.remove(this._entities,a)&&this._entities.splice(0,0,
a);if(b)for(var c=a.getChildren(),d=0,e=c.length;d<e;){var f=d++;this.sendEntityToBack(c[f],!0)}},insertEntityAfter:function(a,b){if(F.remove(this._entities,a)){var c=this._entities,d=bc.indexOf(this._entities,b)+1;c.splice(d,0,a)}},scheduleEntityForDeletion:function(a){this._entitiesToDelete.push(a)},destroy:function(){O.prototype.destroy.call(this);for(var a=this._entities.length-1;0<=a;)this._entities[a].destroy(),this._entities[a].onDestroy(),--a;this._isMarkedForDeletion=!0},__class__:X});var Lb=
function(a,b,c,d,e){null==e&&(e=!1);this._context2d=null;this._wholeCanvasDirty=this._renderedThisFrame=!1;this._canvasWidth=this._canvasHeight=0;this._autoClear=!0;this._backgroundColor="#000000";O.call(this);this.setName(a);this._container=s.getContainer();this._canvas=s.getDocument().createElement("canvas");this._canvas.width=b;this._canvas.height=c;this._canvasWidth=b;this._canvasHeight=c;this._canvas.setAttribute("webkitTransform","translate3d(0px, 0px, 0px);");this._canvas.style.position="absolute";
this._context2d=this._canvas.getContext("2d");e?(Lb._masterLayer=this,this._container.appendChild(this._canvas)):this._canvas.style.visibility="hidden"};Lb.__name__=["f84","Layer"];Lb.getMasterLayer=function(){return Lb._masterLayer};Lb.__super__=O;Lb.prototype=p(O.prototype,{getClearBounds:function(){return this._clearBounds},setClearBounds:function(a){this._clearBounds=a},getContext:function(){return this._context2d},getWholeCanvasDirty:function(){return this._wholeCanvasDirty},setWholeCanvasDirty:function(a){this._wholeCanvasDirty=
a;this._renderedThisFrame=!0},clear:function(a){null==a&&(a=!1);if(Lb._masterLayer!=this||a)a=this._canvas.getContext("2d"),null==this._clearBounds?a.clearRect(0,0,this._canvas.width,this._canvas.height):a.clearRect(this._clearBounds.ul.x,this._clearBounds.ul.y,this._clearBounds.wh.x,this._clearBounds.wh.y),this._wholeCanvasDirty=!1},render:function(){O.prototype.render.call(this);Da.getInstance().getWebGlEnabled()||(Da.getInstance().getRenderer().view.getContext("2d",null).setTransform(1,0,0,1,0,
0),Da.getInstance().getRenderer().view.getContext("2d",null).drawImage(this._canvas,0,0,this._canvasWidth,this._canvasHeight))},getSize:function(){return new t(this._canvasWidth,this._canvasHeight)},setSize:function(a,b){this._canvasWidth=a;this._canvasHeight=b;this._canvas.width=a;this._canvas.height=b},update:function(){O.prototype.update.call(this);this._renderedThisFrame=!1},getMaskFunction:function(){return this._maskFunction},setMaskFunction:function(a){this._maskFunction=a},getContainer:function(){return this._container},
getCanvas:function(){return this._canvas},getAutoClear:function(){return this._autoClear},setAutoClear:function(a){this._autoClear=a},destroy:function(){O.prototype.destroy.call(this);null!=this.getCanvas().parentNode&&this.getCanvas().parentNode.removeChild(this.getCanvas())},__class__:Lb});var Ic=function(a){null==a&&(a=!1);this._currentRequestsActive=0;this._minLoadTimeElapsed=!1;this._currentAssetToLoad=0;this._loadCompleted=!1;this._assetsToLoad=0;this._onCompleteCallback=null;this._assetLoadingInfo=
[];a&&(this._minLoadTimeElapsed=!0)};Ic.__name__=["f84","LoadBatch"];Ic.prototype={getLoadComplete:function(){return this._loadCompleted},addAsset:function(a,b,c,d){this._assetLoadingInfo.push(new ag(a,b,c,!1,d))},getAssetLoadingInfoByAssetName:function(a){for(var b=0,c=this._assetLoadingInfo.length;b<c;){var d=b++,d=this._assetLoadingInfo[d];if(d.name==a)return d}return null},numAssets:function(){return this._assetsToLoad},onAssetLoaded:function(a){this._assetsToLoad--;this.checkAssetsLoaded();a=
this._assetLoadingInfo.length-this._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:a,total:this._assetLoadingInfo.length});this.loadNext()},onXmlHttpRequestLoaded:function(a){},checkAssetsLoaded:function(){if(!(0<this._currentRequestsActive)){var a=this._assetLoadingInfo.length-this._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:a,total:this._assetLoadingInfo.length});this._loadCompleted||0<this._assetsToLoad||this.fireAllAssetsLoaded()}},fireAllAssetsLoaded:function(){this._minLoadTimeElapsed&&
(this._loadCompleted=!0,null!=this._onCompleteCallback&&this._onCompleteCallback())},load:function(a){this._onCompleteCallback=a;this._assetsToLoad=this._assetLoadingInfo.length;this._loadCompleted=!1;this._currentAssetToLoad=0;0==this._assetLoadingInfo.length?(a(),this._loadCompleted=!0):(this.loadNext(),n.getInstance().setDeferredActionsPaused(!1),n.getInstance().invokeAsyncDeferredAction(0.5,q(this,this.onMinLoadElapsed)))},unload:function(){for(var a=0,b=this._assetLoadingInfo.length;a<b;){var c=
a++;H.unloadAsset(this._assetLoadingInfo[c].name)}},loadNext:function(){var a=this;if(!(10<=this._currentRequestsActive||0>=this._assetsToLoad&&this._minLoadTimeElapsed)){for(var b=null;null==b&&0<this._assetsToLoad;)if(b=this._assetLoadingInfo[this._currentAssetToLoad++],null==b)this._assetsToLoad--,this.checkAssetsLoaded();else break;if(!(0>=this._assetsToLoad)){b.source=$a.replace(b.source,"${locale}",s.dataLocale);switch(b.type[1]){case 0:var c=s.getDocument().createElement("img");H.registerAsset(b.name,
c);this._currentRequestsActive++;var d=this;c.addEventListener("load",function(d){PIXI.Texture.addTextureToCache(PIXI.Texture.fromImage(c.src,!1,null!=b.options?b.options.scaleMode:PIXI.SCALE_MODES.DEFAULT),b.name);a._currentRequestsActive--;a.onAssetLoaded(d)});c.addEventListener("onerror",function(){d._assetsToLoad--;alert("file not found: "+b.source);a._currentRequestsActive--;d.checkAssetsLoaded();var c=d._assetLoadingInfo.length-d._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",
{progress:c,total:d._assetLoadingInfo.length});d.loadNext()});c.id=b.name;c.src=b.source;break;case 1:if(!n.isMobile()||v.isWebkitEnabled()||n.isCocoon()){var e=null,f=this;if(H.assetExists(b.name)){f._assetsToLoad--;f.checkAssetsLoaded();e=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:e,total:f._assetLoadingInfo.length});f.loadNext();return}var e=F.substr(b.source,b.source.length-3,3),g=-1<navigator.userAgent.toLowerCase().indexOf("firefox");
"mp3"==e&&g&&(b.source=$a.replace(b.source,"mp3","ogg"));if(!v.isWebkitEnabled()||g)e=document.createElement("audio"),e.src=b.source,e.preload=!0,e.autoplay=!1,e.id=b.name,this._currentRequestsActive++,e.addEventListener("canplay",function(){f._assetsToLoad--;a._currentRequestsActive--;f.checkAssetsLoaded();var b=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:b,total:f._assetLoadingInfo.length});f.loadNext()},!1),e.addEventListener("onerror",
function(){f._assetsToLoad--;console.log("File not found: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),e.addEventListener("stalled",function(){f._assetsToLoad--;console.log("File not found: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",
{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),e.addEventListener("suspend",function(){f._assetsToLoad--;console.log("Loading suspended: "+b.source);a._currentRequestsActive--;f.checkAssetsLoaded();var c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()}),H.registerAsset(b.name,e),e.load();else{var k=new XMLHttpRequest;k.open("GET",b.source,!0);k.responseType="arraybuffer";H.registerAsset(b.name+
"_src",b.source);this._currentRequestsActive++;k.onload=function(){v.getAudioContextInstance().decodeAudioData(k.response,function(c){H.registerAsset(b.name,c);f._assetsToLoad--;a._currentRequestsActive--;f.checkAssetsLoaded();c=f._assetLoadingInfo.length-f._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:f._assetLoadingInfo.length});f.loadNext()})};k.send()}}else H.registerAsset(b.name,b.source),this._assetsToLoad--,this.checkAssetsLoaded(),this.loadNext();break;case 2:var h=
new XMLHttpRequest,m=this;this._currentRequestsActive++;h.onload=function(){H.registerAsset(b.name,h.responseText);m._assetsToLoad--;a._currentRequestsActive--;m.checkAssetsLoaded();var c=m._assetLoadingInfo.length-m._assetsToLoad;n.getInstance().sendGlobalMessage("onFileLoaded",{progress:c,total:m._assetLoadingInfo.length});m.loadNext()};h.onerror=function(){m._assetsToLoad--;alert("File not found: "+b.source);a._currentRequestsActive--;m.checkAssetsLoaded();m.loadNext()};h.open("GET",b.source,!0);
h.send();break;case 3:e=s.getDocument().createElement("script");e.type="text/javascript";e.async=!0;e.src=b.source;e.id=b.name;s.getDocument().body.appendChild(e);this._currentRequestsActive++;e.onload=function(){a._currentRequestsActive--;a.checkAssetsLoaded();a.loadNext()};break;case 4:e=s.getDocument().createElement("link");e.rel="stylesheet";e.type="text/css";e.href=b.source;e.id=b.name;s.getDocument().head.appendChild(e);this.checkAssetsLoaded();this.loadNext();break;case 5:e='<style type="text/css"> @font-face { font-family: \''+
b.name+"'; src: url('"+b.source+"'); } </style>",s.getDocument().head.innerHTML+=e,this.checkAssetsLoaded(),this.loadNext()}this.loadNext()}}},onMinLoadElapsed:function(){this._minLoadTimeElapsed=!0;this.checkAssetsLoaded()},concatLoadBatch:function(a){for(var b=0,c=a._assetLoadingInfo.length;b<c;){var d=b++,d=a._assetLoadingInfo[d];this.hasAsset(d.name)||this._assetLoadingInfo.push(d)}},hasAsset:function(a){for(var b=0,c=this._assetLoadingInfo.length;b<c;){var d=b++;if(this._assetLoadingInfo[d].name==
a)return!0}return!1},__class__:Ic};var U=function(){};U.__name__=["f84","Localizer"];U.initStrings=function(){if(!U._isInitialized){var a=H.getAsset("strings"),a=E.parse(a);U.stringsXml=a.elementsNamed("strings").next();U._isInitialized=!0}};U.getString=function(a){try{var b=U.stringsXml.elementsNamed(a).next();if(b.nodeType!=E.Document&&b.nodeType!=E.Element)throw new P("Bad node type, expected Element or Document but found "+b.nodeType);var c=b.children[0];if(c.nodeType==E.Document||c.nodeType==
E.Element)throw new P("Bad node type, unexpected "+c.nodeType);return c.nodeValue}catch(d){throw new P("Could not find string: "+a);}};var fa=function(){O.call(this)};fa.__name__=["f84","Manager"];fa.__super__=O;fa.prototype=p(O.prototype,{__class__:fa});var Mb=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.ul=new t(a,b);this.wh=new t(c,d)};Mb.__name__=["f84","Rect2D"];Mb.prototype={getClone:function(){return new Mb(this.ul.x,this.ul.y,this.wh.x,this.wh.y)},getIntersect:function(a){return!(this.ul.x>
a.ul.x+a.wh.x||this.ul.x+this.wh.x<a.ul.x||this.ul.y>a.ul.y+a.wh.y||this.ul.y+this.wh.y<a.ul.y)},containsPoint:function(a){return a.x>this.ul.x&&a.y>this.ul.y&&a.x<this.ul.x+this.wh.x?a.y<this.ul.y+this.wh.y:!1},__class__:Mb};var n=function(a,b,c,d){this._iosAudioEnabled=!1;this._prevWidth=this._prevHeight=0;this._isUpdating=!0;this._hasFocus=!1;this._screenScale=null;this._isOrientationScreenShowing=!1;this._currentOrientation=0;this._isDeferredActionsPaused=!1;this._gameStates=this._managers=this._layers=
this._deferredActions=null;this._gameHeight=768;this._gameWidth=1024;this._gameId=a;this._gameWidth=b;this._gameHeight=c;this._screenScale=new t(1,1);this._gameStates=[];n._instance=this;this._layers=[];this._managers=[];this._deferredActions=[];this._initialState=d};n.__name__=["f84","Root"];n.getInstance=function(){return n._instance};n.getTimeScale=function(){return n._timeScale};n.setTimeScale=function(a){n._timeScale=a};n.getDeltaTime=function(){return n._fixedTimestepDelta?0.016666666666666666:
Math.min(0.1,n._currentTimeStamp-n._prevTimeStamp)*n.getTimeScale()};n.getRealDeltaTime=function(){return n._currentTimeStamp-n._prevTimeStamp};n.isAppMode=function(){return window.isStandalone};n.isPhone=function(){return-1!=navigator.userAgent.toLowerCase().indexOf("iphone")||-1!=navigator.userAgent.toLowerCase().indexOf("ipod")||-1!=navigator.userAgent.toLowerCase().indexOf("android")||-1!=navigator.userAgent.toLowerCase().indexOf("linux")?!0:!1};n.isIOS=function(){s.getWindow();var a=s.getWindow().navigator.userAgent.toLowerCase();
return-1!=a.indexOf("iphone")||-1!=a.indexOf("ipod")||-1!=a.indexOf("ipad")?!0:!1};n.isCocoon=function(){return!1};n.isMobile=function(){s.getWindow();var a=s.getWindow().navigator.userAgent.toLowerCase();return-1!=a.indexOf("iphone")||-1!=a.indexOf("ipod")||-1!=a.indexOf("ipad")||-1!=a.indexOf("android")||-1!=a.indexOf("linux")?!0:!1};n.isInternetExplorer=function(){return-1!=navigator.userAgent.toLowerCase().indexOf("msie")};n.isFirefox=function(){return-1<navigator.userAgent.toLowerCase().indexOf("firefox")};
n.isSafari=function(){return-1<navigator.userAgent.toLowerCase().indexOf("safari/")};n.getDevicePixelRatio=function(){return 1};n.prototype={getGameStates:function(){return this._gameStates},getLayers:function(){return this._layers},getGameWidth:function(){return this._gameWidth},setGameWidth:function(a){this._gameWidth=a},getGameHeight:function(){return this._gameHeight},setGameHeight:function(a){this._gameHeight=a},getGameId:function(){return this._gameId},init:function(){n._prevTimeStamp=(new Date).getTime()/
1E3;n._currentTimeStamp=(new Date).getTime()/1E3;v.init();this.addGameState(this._initialState);this._initialState.init();s.getContainer().focus();this._prevWidth=s.getWindow().innerWidth;this._prevHeight=s.getWindow().innerHeight;var a=window;a.addEventListener("orientationchange",q(this,this.onOrientationChange),!1);a.addEventListener("pageshow",q(this,this.onOrientationChange),!1);a.addEventListener("resize",q(this,this.onResizeWindow),!1);a.onfocus=q(this,this.onFocusGained);a.onblur=q(this,this.onFocusLost);
window.document.addEventListener("webkitvisibilitychange",q(this,this.onWebkitVisibilityChange),!1);a.addEventListener("pagehide",q(this,this.onFocusLost),!1);n.isMobile()&&n.isIOS()&&a.addEventListener("touchend",q(this,this.onIosTouchEnd),!1);if(n.isMobile())this.onOrientationChange();else this.setScreenScale(1,1)},update:function(){if(!this._hasFocus)this.onFocusGained();if(this._isUpdating){for(var a=0,b=this._managers.length,a=b;0<a--;)b=this._managers[a],b.isMarkedForDeletion()&&(b.onDestroy(),
this._managers.splice(a,1));b=this._managers.length;for(a=0;a<b;){var c=a++,c=this._managers[c];c.isActive()&&c.update()}v.update();for(a=b=this._gameStates.length;0<a--;)b=this._gameStates[a],b.isMarkedForDeletion()&&(b.onDestroy(),this._gameStates.splice(a,1));b=this._gameStates.length;for(a=0;a<b;)c=a++,this._gameStates[c].isActive()&&this._gameStates[c].update();for(a=this._layers.length;0<a--;)b=this._layers[a],b.isMarkedForDeletion()&&(b.onDestroy(),F.remove(this._layers,b));a=0;for(b=this._layers.length;a<
b;)c=a++,this._layers[c].update()}if(!this._isDeferredActionsPaused)for(a=this._deferredActions.length;0<a--;)b=this._deferredActions[a],null!=b&&(b.timeUntilExecute-=n.getDeltaTime(),0>=b.timeUntilExecute&&(b.params?b.actionToExecute(b.params):b.actionToExecute(),this._deferredActions.splice(a,1)))},fixedUpdate:function(){n._currentTimeStamp=(new Date).getTime()/1E3;var a=n.getDeltaTime(),a=Math.max(1,Math.floor(a/0.016666666666666666))|0;n._fixedTimestepDelta=!0;for(var b=0;b<a;){b++;for(var c=
0,d=this._managers.length;c<d;){var e=c++,e=this._managers[e];e.isActive()&&e.fixedUpdate()}c=0;for(d=this._gameStates.length;c<d;)e=c++,this._gameStates[e].isActive()&&this._gameStates[e].fixedUpdate()}n._fixedTimestepDelta=!1},postUpdate:function(){for(var a=0,b=this._managers.length;a<b;){var c=a++,c=this._managers[c];c.isActive()&&c.postUpdate()}a=0;for(b=this._gameStates.length;a<b;)c=a++,this._gameStates[c].isActive()&&this._gameStates[c].postUpdate();n._prevTimeStamp=n._currentTimeStamp},updateDivClass:function(){var a=
"container";1==this._currentOrientation&&(a+=" portrait");s.getContainer().className=a},render:function(){for(var a=this._layers.length,b=0;b<a;){var c=b++,c=this._layers[c];c.getAutoClear()&&c.getWholeCanvasDirty()&&c.clear()}b=0;for(a=this._gameStates.length;b<a;)c=b++,this._gameStates[c].isActive()&&this._gameStates[c].render();b=0;for(a=this._managers.length;b<a;)c=b++,this._managers[c].isActive()&&this._managers[c].render();a=this._layers.length;for(b=0;b<a;)c=b++,c=this._layers[c],"debug"!=
c.getName()&&c.render()},debugRender:function(){for(var a=0,b=this._gameStates.length;a<b;){var c=a++;this._gameStates[c].debugRender()}a=0;for(b=this._managers.length;a<b;)c=a++,this._managers[c].debugRender();a=0;for(b=this._layers.length;a<b;)c=a++,c=this._layers[c],"debug"==c.getName()&&c.render(),c.debugRender()},addGameState:function(a){0<=this._gameStates.indexOf(a)&&(F.remove(this._gameStates,a),this._gameStates.push(a));for(var b=0,c=this._gameStates.length;b<c;){var d=b++;if(a==this._gameStates[d])return a}this._gameStates.push(a);
return a},removeGameState:function(a){a.destroy()},addManager:function(a){this._managers.push(a);a.init()},removeManager:function(a){for(var b=0,c=this._managers.length;b<c;){var d=b++;if(this._managers[d]==a){this._managers.splice(d,1);a.destroy();break}}},getManager:function(a){for(var b=0,c=this._managers.length;b<c;){var d=b++,e=this._managers[d];if((null==e?null:C.getClass(e))==a)return this._managers[d]}return null},setDeferredActionsPaused:function(a){this._isDeferredActionsPaused=a},destroyAllDeferredActions:function(){this._deferredActions=
[]},switchToGameState:function(a,b){null!=a&&this.removeGameState(a);null!=b&&this.addGameState(b)},addLayer:function(a,b){null==b&&(b=!1);b?this._layers.splice(0,0,a):this._layers.push(a)},insertLayerAfter:function(a,b){var c=this._layers,d=this._layers.indexOf(b)+1;c.splice(d,0,a)},removeLayer:function(a){a.destroy();F.remove(this._layers,a)},getLayerByName:function(a){for(var b=0,c=this._layers.length;b<c;){var d=b++,d=this._layers[d];if(d.getName()==a)return d}return null},sendGlobalMessage:function(a,
b){for(var c=this._managers.length-1;0<=c;)this._managers[c].handleMessage(a,b),--c;for(c=this._gameStates.length-1;0<=c;)this._gameStates[c].handleMessage(a,b),--c},invokeAsyncDeferredAction:function(a,b,c){a=new ne(a,b,c);this._deferredActions.push(a);return a},destroyDeferredAction:function(a){F.remove(this._deferredActions,a)},onOrientationChange:function(){var a=this;this.invokeAsyncDeferredAction(0.35,function(){var b=!1,b=n.isMobile()?s.getWindow().innerWidth>s.getWindow().innerHeight:!0;"HORIZONTAL"==
Y.getProperty("forceOrientation")?(a._currentOrientation=0,b=!0):"VERTICAL"==Y.getProperty("forceOrientation")?(a._currentOrientation=1,b=!1):a._currentOrientation=b?0:1;a.onResizeWindow();a.sendGlobalMessage("onOrientationChanged",{isHorizontal:b})})},setScreenScale:function(a,b){this.updateDivClass();this._screenScale.x=a;this._screenScale.y=b;this.onScreenScaleUpdated()},getScreenScale:function(){return n.isAppMode()?new t(0.91*this._screenScale.x,0.91*this._screenScale.y):this._screenScale},getGameSize:function(){return new t(this._gameWidth,
this._gameHeight)},getScreenOffset:function(){var a=s.getWindow().innerWidth,b=s.getWindow().innerHeight;return new t(Math.max(0,a/2-this._gameWidth*this.getScreenScale().x/2),Math.max(0,b/2-this._gameHeight*this.getScreenScale().y/2))},getCurrentOrientation:function(){return this._currentOrientation},onWebkitVisibilityChange:function(){if(s.getDocument().webkitHidden)this.onFocusLost();else this.onFocusGained()},onFocusGained:function(){this._hasFocus||(ea.getInstance().disablePageKeyPresses(),v.resumeAllSounds(),
this._isUpdating=this._hasFocus=!0,this.sendGlobalMessage("onFocusGained"))},onFocusLost:function(){v.pauseAllSounds();this._hasFocus&&(ea.getInstance().enablePageKeyPresses(),this._isUpdating=this._hasFocus=!1,this.sendGlobalMessage("onFocusLost"))},onResizeWindow:function(){var a=1,b=a,b="1"==Y.getProperty("scaleToScreenOnDesktop");n.isMobile()||b?(b=s.getWindow(),b=a=Math.min(b.innerHeight/this._gameHeight,b.innerWidth/this._gameWidth)):a=b=1;this.sendGlobalMessage("onResizedWindow");this.setScreenScale(b,
a)},onScreenScaleUpdated:function(){var a,b;a=s.getWindow().innerWidth;b=s.getWindow().innerHeight;var c=s.getContainer(),d=n.getDevicePixelRatio();n.isMobile()&&this.hideAddressBar();c.style.width=this._gameWidth+"px";c.style.height=this._gameHeight+"px";var e=Da.getInstance();if(null!=e.getRenderer()){var f=e.getRenderer().view,g=e=0,e=this._gameWidth*this.getScreenScale().x,g=this._gameHeight*this.getScreenScale().y;f.style.width=e*d+"px";f.style.height=g*d+"px";c.style.width=e+"px";c.style.height=
g+"px";b=Math.max(0,b/2-g/2);a=Math.max(0,a/2-e/2);c.style.left=a+"px";c.style.top=b+"px"}this.sendGlobalMessage("onScreenScaleUpdated")},stopUpdates:function(){this._isUpdating=!1},resumeUpdates:function(){this._isUpdating=!0},hideAddressBar:function(){if(n.isPhone()&&!window.location.hash){var a=window.outerHeight;document.height<a&&(document.body.style.height=a+50+"px");setTimeout(function(){window.scrollTo(0,1)},50)}},requestFullscreen:function(){if(!n.isIOS()){var a=window.document,b=a.documentElement,
c=b.requestFullscreen||b.mozRequestFullScreen||b.webkitRequestFullScreen||b.msRequestFullscreen;a.fullscreenElement||(a.mozFullScreenElement||a.webkitFullscreenElement||a.msFullscreenElement)||c.call(b)}},onIosTouchEnd:function(){if(!1==this._iosAudioEnabled)try{var a=v.getAudioContextInstance(),b=a.createBuffer(1,1,22050),c=a.createBufferSource();c.buffer=b;c.connect(a.destination);c.start(0);this._iosAudioEnabled=!0;La.log("Audio enabled for iOS")}catch(d){La.log("error")}},__class__:n};var cg=
function(){this._data={};this.load()};cg.__name__=["f84","SaveData"];cg.prototype={setItem:function(a,b){this._data[a]=b;this.save()},getItem:function(a,b){if(Object.prototype.hasOwnProperty.call(this._data,a))return Ja.field(this._data,a);this.setItem(a,b);return b},save:function(){var a=n.getInstance().getGameId()+"Data";if(null!=kb.getSessionStorage())try{kb.getSessionStorage().setItem(a,JSON.stringify(this._data))}catch(b){La.log("Error saving to session storage")}if(null!=kb.getLocalStorage())try{kb.getLocalStorage().setItem(a,
JSON.stringify(this._data))}catch(c){La.log("Error saving to local storage")}},load:function(){var a=n.getInstance().getGameId()+"Data";if(null!=kb.getSessionStorage()||null!=kb.getLocalStorage()){var b=null;try{b=kb.getSessionStorage().getItem(a)}catch(c){La.log("Failed to get item from session storage")}if(null==b)try{b=kb.getLocalStorage().getItem(a)}catch(d){La.log("Failed to get item from session storage")}null!=b&&(this._data=JSON.parse(b))}},deleteAllSaveData:function(){this._data={};this.save()},
__class__:cg};var t=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=this.y=0;this.x=a;this.y=b};t.__name__=["f84","Vector2"];t.prototype={getClone:function(){return new t(this.x,this.y)},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},scaleBy:function(a,b){this.x*=a;this.y*=b},dotProduct:function(a){return this.x*a.x+this.y*a.y},getNormalized:function(){var a=this.getLength();return new t(this.x/a,this.y/a)},__class__:t};var L=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==
a&&(a=0);this.x=this.y=this.z=0;this.x=a;this.y=b;this.z=c};L.__name__=["f84","Vector3"];L.lerp=function(a,b,c){return new L(a.x+(b.x-a.x)*c,a.y+(b.y-a.y)*c,a.z+(b.z-a.z)*c)};L.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};L.prototype={add:function(a){return new L(this.x+a.x,this.y+a.y,this.z+a.z)},subtract:function(a){return new L(this.x-a.x,this.y-a.y,this.z-a.z)},scaleBy:function(a){this.x*=a;this.y*=a;this.z*=a},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},
getClone:function(){return new L(this.x,this.y,this.z)},getNormalized:function(){var a=this.getLength();return new L(this.x/a,this.y/a,this.z/a)},__class__:L};var ta=function(a,b,c){this._isMuted=!1;this._currentTime=0;this._isInitialized=!1;this._soundName=a;this._volume=b;this._loop=c;this.init()};ta.__name__=["f84","audio","SoundData"];ta.prototype={init:function(){this._isInitialized=!0},play:function(a){},resume:function(){},update:function(){this._currentTime+=n.getDeltaTime()},pause:function(){},
stop:function(){v.removeSoundFromPlayingSounds(this)},getVolume:function(){return this._volume},setVolume:function(a){this._volume=a},getMuted:function(){return this._isMuted},setMuted:function(a){this._isMuted=a},getLoop:function(){return this._loop},setLoop:function(a){this._loop=a},getSoundLength:function(){return 1},getCurrentTime:function(){return this._currentTime},setCurrentTime:function(a){this._currentTime=a},getSoundName:function(){return this._soundName},__class__:ta};var hd=function(a,
b,c){ta.call(this,a,b,c)};hd.__name__=["f84","audio","Html5SoundData"];hd.__super__=ta;hd.prototype=p(ta.prototype,{init:function(){ta.prototype.init.call(this)},play:function(a){null==a&&(a=0);var b=this;ta.prototype.play.call(this,a);this._audio=H.getAsset(this._soundName);0!=a&&this._audio.addEventListener("canplay",function(c){b._audio.currentTime=a});this._audio.play();this._audio.addEventListener("ended",q(this,this.onSoundComplete),!1);this._audio.loop=this._loop;this._audio.volume=this._volume},
resume:function(){ta.prototype.resume.call(this);this._audio.play()},pause:function(){ta.prototype.pause.call(this);this._audio.pause()},stop:function(){ta.prototype.stop.call(this);this._audio.pause()},onSoundComplete:function(a){v.removeSoundFromPlayingSounds(this)},setVolume:function(a){ta.prototype.setVolume.call(this,a);this._audio.volume=a},setMuted:function(a){ta.prototype.setMuted.call(this,a);this._audio.muted=a},__class__:hd});var v=function(){};v.__name__=["f84","audio","SoundManager"];
v.init=function(){try{v._audioContext=new AudioContext,v._isWebkitEnabled=!n.isFirefox()&&null!=v._audioContext}catch(a){console.log("Could not instantiate AudioContext.")}v._musicTrack=new id(null)};v.getAudioContextInstance=function(){return v._audioContext};v.isWebkitEnabled=function(){return v._isWebkitEnabled};v.setWebkitEnabled=function(a){v._isWebkitEnabled=a};v.isMusicMuted=function(){return v._musicMuted};v.setMusicMuted=function(a){v._musicMuted=a;null!=v._musicTrack.get()&&v._musicTrack.get().setMuted(a);
v.isWebkitEnabled()||(n.isMobile()&&a?v._musicTrack.get().pause():n.isMobile()&&!a&&v._musicTrack.get().play())};v.isSoundMuted=function(){return v._soundMuted};v.setSoundMuted=function(a){v._soundMuted=a;for(var b=0,c=v._soundsPlaying.length;b<c;){var d=b++;v._soundsPlaying[d].setMuted(a)}};v.getMasterVolume=function(){return v._masterVolume};v.setMasterVolume=function(a){v._masterVolume=a;v.setMusicVolume(v._musicVolume);v.setSoundVolume(v._soundVolume)};v.getMusicVolume=function(){return v.isMusicMuted()?
0:v._musicVolume};v.setMusicVolume=function(a){v._musicVolume=a;null!=v._musicTrack&&null!=v._musicTrack.get()&&v._musicTrack.get().setVolume(v._musicMuted?0:v.getMusicVolume()*v.getMasterVolume())};v.getSoundVolume=function(){return v.isSoundMuted()?0:v._soundVolume};v.setSoundVolume=function(a){v._soundVolume=a;a=0;for(var b=v._soundsPlaying.length;a<b;){var c=a++;v._soundsPlaying[c].setVolume(v._soundMuted?0:v.getSoundVolume()*v.getMasterVolume())}};v.playSoundByName=function(a,b,c){null==c&&(c=
!1);null==b&&(b=!1);if(!v.isWebkitEnabled()&&n.isMobile()&&!b||!H.assetExists(a))return null;a=v.isWebkitEnabled()?new jd(a,v.getSoundVolume()*v.getMasterVolume(),c):new hd(a,v.getMasterVolume()*v.getSoundVolume(),c);a.play();v._soundsPlaying.push(a);return a};v.update=function(){for(var a=0,b=v._soundsPlaying.length;a<b;){var c=a++,c=v._soundsPlaying[c];null==c?v.removeSoundFromPlayingSounds(c):c.update()}};v.onSoundComplete=function(a){v.removeSoundFromPlayingSounds(a.currentTarget)};v.removeSoundFromPlayingSounds=
function(a){F.remove(v._soundsPlaying,a)};v.addSoundToPlayingSounds=function(a){v._soundsPlaying.push(a)};v.pauseAllSounds=function(){null!=v._musicTrack.get()&&v._musicTrack.get().pause();for(var a=0,b=v._soundsPlaying.length;a<b;){var c=a++,c=v._soundsPlaying[c];null!=c&&c.pause()}};v.resumeAllSounds=function(){for(var a=v._soundsPlaying.length,b=[].concat(v._soundsPlaying),c=0;c<a;){var d=c++;b[d].resume()}null!=v._musicTrack.get()&&(v._musicTrack.get().pause(),v._musicTrack.get().resume())};v.playMusicByNameOnMobileOnly=
function(a){return n.isMobile()?v.playMusicByName(a,!0):null};v.playMusicByName=function(a,b){null==b&&(b=!0);if(n.isMobile()&&!b)return null;if(!H.assetExists(a))return La.log(a+" doesn't exist!"),null;null!=v._musicTrack.get()&&v._musicTrack.get().stop();var c;c=v.isWebkitEnabled()?new jd(a,v.getMasterVolume()*v.getMusicVolume(),!0):new hd(a,v.getMasterVolume()*v.getMusicVolume(),!0);c.play(0);v._musicTrack.set(c);v.setMusicVolume(v._musicVolume);return v._musicTrack.get()};v.stopMusic=function(){null!=
v._musicTrack.get()&&(v._musicTrack.get().stop(),v._musicTrack=new id(null))};v.stopAllSounds=function(){for(var a=v._soundsPlaying.length-1;0<=a;){var b=v._soundsPlaying[a];null!=b&&b.stop();v.removeSoundFromPlayingSounds(b);--a}v._soundsPlaying=[]};v.prototype={__class__:v};var jd=function(a,b,c){null==c&&(c=!1);null==b&&(b=1);this._audio=null;ta.call(this,a,b,c)};jd.__name__=["f84","audio","WebkitSoundData"];jd.__super__=ta;jd.prototype=p(ta.prototype,{init:function(){ta.prototype.init.call(this);
this._audioContext=v.getAudioContextInstance();this._audio=this._audioContext.createBufferSource();this._audio.buffer=H.getAsset(this._soundName);this._gainNode=null!=(Ma=this._audioContext,q(Ma,Ma.createGain))?this._audioContext.createGain():this._audioContext.createGainNode();this._audio.connect(this._gainNode,0,0);this._gainNode.connect(this._audioContext.destination,0,0);this._audio.loop=this._loop;this._audio.id=this._soundName;this.setVolume(this._volume)},play:function(a){null==a&&(a=0);ta.prototype.play.call(this,
a);this._currentTime=a;try{null!=(Ma=this._audio,q(Ma,Ma.start))?this._audio.start(this._audioContext.currentTime,a):0==a?this._audio.noteOn():this._audio.noteGrainOn(this._audioContext.currentTime,a)}catch(b){this._audio.noteOn(this._audioContext.currentTime,a,this._audio.buffer.duration-a)}},pause:function(){ta.prototype.pause.call(this);if(!(null==this._audio||null!=this._audio&&null!=this._audio.buffer&&this.getCurrentTime()>this.getSoundLength()&&!this.getLoop())){if(null!=(Ma=this._audio,q(Ma,
Ma.stop)))try{this._audio.stop(this._audioContext.currentTime)}catch(a){}else try{this._audio.noteOff(this._audioContext.currentTime)}catch(b){}v.removeSoundFromPlayingSounds(this)}},resume:function(){ta.prototype.resume.call(this);null!=this._audio&&null!=this._audio.buffer&&this.getCurrentTime()>this.getSoundLength()&&!this.getLoop()||(this.stop(),this.init(),this.play(this._currentTime),v.addSoundToPlayingSounds(this))},stop:function(){ta.prototype.stop.call(this);if(null!=this._audio){if(null!=
(Ma=this._audio,q(Ma,Ma.stop)))try{this._audio.stop(this._audioContext.currentTime)}catch(a){}else try{this._audio.noteOff(this._audioContext.currentTime)}catch(b){}this._audio=null;v.removeSoundFromPlayingSounds(this)}},getSoundLength:function(){return this._audio.buffer.duration},update:function(){ta.prototype.update.call(this);this.getCurrentTime()>this.getSoundLength()&&!this.getLoop()?v.removeSoundFromPlayingSounds(this):this.getCurrentTime()>this.getSoundLength()&&(this._currentTime-=this.getSoundLength())},
onSoundComplete:function(){},setVolume:function(a){ta.prototype.setVolume.call(this,a);if(null!=this._audio||null!=this._gainNode)this._gainNode.gain.value=this._isMuted?0:a},setMuted:function(a){ta.prototype.setMuted.call(this,a);this._gainNode.gain.value=this._isMuted?0:this._volume},__class__:jd});var oe=function(){};oe.__name__=["f84","box2d","Box2dContactListener"];oe.__super__=tb;oe.prototype=p(tb.prototype,{beginContact:function(a){tb.prototype.beginContact.call(this,a);var b=a.getFixtureA().getBody().getUserData().entity;
null!=b&&b.dispatchEvent(new Nb("beginContact",{contact:a}));b=a.getFixtureB().getBody().getUserData().entity;null!=b&&b.dispatchEvent(new Nb("beginContact",{contact:a}))},endContact:function(a){tb.prototype.endContact.call(this,a);var b=a.getFixtureA().getBody().getUserData().entity;null!=b&&b.dispatchEvent(new Nb("endContact",{contact:a}));b=a.getFixtureB().getBody().getUserData().entity;null!=b&&b.dispatchEvent(new Nb("endContact",{contact:a}))},preSolve:function(a,b){tb.prototype.preSolve.call(this,
a,b)},postSolve:function(a,b){tb.prototype.postSolve.call(this,a,b)},__class__:oe});var J=function(a){this._type=a};J.__name__=["f84","events","Event"];J.prototype={getType:function(){return this._type},__class__:J};var Nb=function(a,b){this._data=null;this._type=a;this._data=b};Nb.__name__=["f84","box2d","Box2dEvent"];Nb.__super__=J;Nb.prototype=p(J.prototype,{getData:function(){return this._data},setData:function(a){this._data=a},__class__:Nb});var cc=function(a,b,c,d){null==d&&(d=2);null==c&&(c=
6);null==b&&(b="debug");this._debugLayerName="";this._physicsScale=0.03333333333333333;this._positionIterations=2;this._velocityIterations=6;this._b2World=this._gravity=null;O.call(this);null==a&&(a=new t(0,0));this._gravity=new u(a.x,a.y);cc._instance=this;this._velocityIterations=c;this._positionIterations=d;this._debugLayerName=b;this._b2World=new ga(this._gravity,!1)};cc.__name__=["f84","box2d","Box2dManager"];cc.getInstance=function(){return cc._instance};cc.__super__=fa;cc.prototype=p(fa.prototype,
{init:function(){fa.prototype.init.call(this);this._debugDrawLayer=n.getInstance().getLayerByName(this._debugLayerName);this._debugDraw=new Ra;this._debugDraw.setSprite(this._debugDrawLayer.getCanvas().getContext("2d"));this._debugDraw.setDrawScale(30);this._debugDraw.setLineThickness(1);this._debugDraw.setAlpha(0.5);this._debugDraw.setFillAlpha(0.1);this._debugDraw.setFlags(Ra.e_shapeBit);this._b2World.setDebugDraw(this._debugDraw);this._b2World.setContactListener(new oe)},getB2World:function(){return this._b2World},
getGravity:function(){return this._gravity},setGravity:function(a){this._gravity=a;this._b2World.setGravity(a);return a},getPhysicsScale:function(){return this._physicsScale},getInversePhysicsScale:function(){return 1/this._physicsScale},setPhysicsScale:function(a){this._physicsScale=a},update:function(){fa.prototype.update.call(this);this.dispatchEvent(new pc("preUpdate"));for(var a=0,b=Math.max(1,Math.floor(n.getDeltaTime()/0.016666666666666666));a<b;)a++,this._b2World.step(0.016666666666666666,
this._velocityIterations,this._positionIterations),this._b2World.clearForces();this.dispatchEvent(new pc("update"))},getPixelToWorld:function(a,b){return new u(a*this._physicsScale,b*this._physicsScale)},getWorldToPixel:function(a,b){return new t(a/this._physicsScale,b/this._physicsScale)},debugRender:function(){fa.prototype.debugRender.call(this);this._b2World.drawDebugData();this._debugDrawLayer.setWholeCanvasDirty(!0)},__class__:cc});var pc=function(a){this._type=a};pc.__name__=["f84","box2d",
"Box2dManagerEvent"];pc.__super__=J;pc.prototype=p(J.prototype,{__class__:pc});var ia=function(a,b,c){this._loop=!0;this._length=0;this._name=a;this._animationKeyframes=[];null!=b&&(this._length=b);this._offset=new t};ia.__name__=["f84","components","Animation"];ia.parseFromXmlString=function(a,b){for(var c=E.parse(b),d=c.elementsNamed("animation").next().get("name"),d=new ia(d,c.elementsNamed("animation").next().get("length")),c=c.elementsNamed("animation").next().elementsNamed("keyframe");c.hasNext();){var e=
c.next(),e=new pe(e.get("index"),e.get("spriteIndex"),a);d.addKeyframe(e)}Na.getInstance().registerAnimation(d);return d};ia.makeLinearAnimationFromSheetBySpriteName=function(a,b,c,d,e,f,g){null==g&&(g=0);null==f&&(f=-1);null==e&&(e=!1);var k=ab.getInstance().getSpriteSheetByName(b),h=k.getNumSprites();-1==f&&(f=h);for(var m=0,l=0,n=f;l<n;){var p=l++;$a.startsWith(k.getSpriteInfoByIndex(p).getName(),c)&&++m}a=new ia(a,m*d);for(l=m=0;l<h&&!(n=l++,$a.startsWith(k.getSpriteInfoByIndex(n).getName(),c)&&
(n=new pe(g,n,b),a.addKeyframe(n),g+=d,++m,m>=f)););a.setLoop(e);Na.getInstance().registerAnimation(a);return a};ia.createAnimation=function(a,b,c,d,e){null==e&&(e=!0);null==d&&(d=1);null==Na.getInstance().getAnimationByName(a)&&(qc.parseFromXmlString(a,a,H.getAsset(b)),ia.makeLinearAnimationFromSheetBySpriteName(a,a,"",d,e).setOffset(c.x,c.y))};ia.appendAnimation=function(a,b,c,d,e){null==e&&(e=1);if(null==Na.getInstance().getAnimationByName(b))for(a=Na.getInstance().getAnimationByName(a),qc.parseFromXmlString(b,
b,H.getAsset(c)),b=ia.makeLinearAnimationFromSheetBySpriteName("tempAnim",b,"",e,!1,-1,a.getKeyframeLength()),b.setOffset(d.x,d.y),d=b.getAnimationKeyframes(),b=0,c=d.length;b<c;)e=b++,a.addKeyframe(d[e])};ia.prototype={getAnimationKeyframes:function(){return this._animationKeyframes},getKeyframeLength:function(){return this._length},getLength:function(){return this._length/30},getName:function(){return this._name},getLoop:function(){return this._loop},setLoop:function(a){this._loop=a},getOffset:function(){return this._offset},
setOffset:function(a,b){this._offset.x=a;this._offset.y=b},addKeyframe:function(a){this._animationKeyframes.push(a);var b=a.getPosition();this._length=Math.max(this._length,a.getPosition());b>this._length&&(this._length=b)},getSpriteIndexAtPosition:function(a){for(var b=this._animationKeyframes.length,c=this._animationKeyframes[0].getSpriteIndex(),d=0;d<b;){var e=d++;if(a>=this._animationKeyframes[e].getPosition()/30)c=this._animationKeyframes[e].getSpriteIndex();else break}return c},getSpriteSheetNameAtPosition:function(a){for(var b=
this._animationKeyframes.length,c=this._animationKeyframes[0].getSpriteSheetName(),d=0;d<b;){var e=d++;if(a>=this._animationKeyframes[e].getPosition()/30)c=this._animationKeyframes[e].getSpriteSheetName();else break}return c},__class__:ia};var qa=function(a,b,c,d,e){this._inactiveOneFrame=!1;this._killMessageOnMouseDown=!0;this._isMouseOver=!1;this._handPointer=!0;this._onClicked=this._onMouseDown=this._onMouseUp=this._onMouseMoved=this._onMouseOver=this._onMouseOut=null;l.call(this,a);this._boxCollision=
new Ea;this._collisionSize=b;this._collisionOffset=c;this._camera=e;this.setOnMouseDown(d)};qa.__name__=["f84","components","Button"];qa.createFromHTMLElement=function(a){return new qa(a.getEntity(),a.getSize(),new t(0,0))};qa.createFromHTMLElementID=function(a,b,c){null==c&&(c=0);b=s.getDocument().getElementById(b);var d=b.clientWidth+c,e=b.clientHeight+c;return new qa(a,new t(d,e),new t(b.offsetLeft-a.getPosition().x-c/2+d/2,b.offsetTop-a.getPosition().y-c/2+e/2))};qa.createFromEdgeHTMLElementID=
function(a,b,c,d){null==d&&(d=0);var e=s.getDocument().getElementById(b);b=pa.parseInt(e.style.width)+d;var f=pa.parseInt(e.style.height)+d,g=ob.getStylePositionOfDomElement(e).y-d/2;d=ob.getStylePositionOfDomElement(e).x-d/2;return new qa(a,new t(b,f),new t(d-a.getPosition().x+b/2,g-a.getPosition().y+f/2),c)};qa.createFromPixiSprite=function(a){return new qa(a.getEntity(),new t(a.getSprite().texture.width,a.getSprite().texture.height),null)};qa.__super__=l;qa.prototype=p(l.prototype,{setOnClicked:function(a){this._onClicked=
a},setOnMouseDown:function(a){this._onMouseDown=a},setOnMouseMoved:function(a){this._onMouseMoved=a},setOnMouseUp:function(a){this._onMouseUp=a},setOnMouseOut:function(a){this._onMouseOut=a},getKillMessageOnMouseDown:function(){return this._killMessageOnMouseDown},setKillMessageOnMouseDown:function(a){this._killMessageOnMouseDown=a},getData:function(){return this._data},getCollisionSize:function(){return this._collisionSize},setData:function(a){this._data=a},init:function(){l.prototype.init.call(this);
this._prevPosition=new t(this.getEntity().getPosition().x,this.getEntity().getPosition().y);this.updateCollision()},update:function(){l.prototype.update.call(this);this._inactiveOneFrame=!1;!1==this.getEntity().isVisible()&&(this._inactiveOneFrame=!0);if(this._isMouseOver&&this.isButtonDisabledByButtonGroup(this.getEntity()))this.onMouseOut(ea.getInstance().getMousePosition());this.updateCollision()},setOffset:function(a,b){this._collisionOffset=new t(a,b)},getOffset:function(){return this._collisionOffset},
updateCollision:function(){var a=this.getEntity().getPosition();this._boxCollision.ul.x=a.x-this._collisionSize.x/2;this._boxCollision.ul.y=a.y-this._collisionSize.y/2;this._boxCollision.wh.x=this._collisionSize.x;this._boxCollision.wh.y=this._collisionSize.y;null!=this._collisionOffset&&(this._boxCollision.ul.x+=this._collisionOffset.x,this._boxCollision.ul.y+=this._collisionOffset.y)},onMouseClick:function(a){a=a.getClone();a.x>n.getInstance().getGameSize().x||(0>a.x||a.y>n.getInstance().getGameSize().y||
0>a.y)||(null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale())),this._boxCollision.checkPointIntersect(a)&&(this.getEntity().dispatchEvent(new W("mouseClick",{button:this,entity:this.getEntity()})),null!=this._onClicked&&this._onClicked(this)))},onMouseDown:function(a){a=a.getClone();if(a.x>n.getInstance().getGameSize().x||
0>a.x||a.y>n.getInstance().getGameSize().y||0>a.y)return!1;null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));return this._boxCollision.checkPointIntersect(a)?(this.getEntity().dispatchEvent(new W("mouseDown",{button:this,entity:this.getEntity()})),null!=this._onMouseDown&&this._onMouseDown(this),n.isMobile()&&
(this._isMouseOver=!0),!0):!1},onMouseMoved:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));if(this._boxCollision.checkPointIntersect(a)){this.getEntity().dispatchEvent(new W("mouseOver",{button:this,entity:this.getEntity()}));if(!this._isMouseOver)this.onMouseOver(a);this._isMouseOver=
!0;this.getEntity().dispatchEvent(new W("mouseMove",{button:this,entity:this.getEntity()}));null!=this._onMouseMoved&&this._onMouseMoved(this)}else this._isMouseOver&&(this.onMouseOut(a),this._isMouseOver=!1)},onMouseUp:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));this._boxCollision.checkPointIntersect(a)&&
(this.getEntity().dispatchEvent(new W("mouseUp",{button:this,entity:this.getEntity()})),null!=this._onMouseUp&&this._onMouseUp(this))},onMouseOver:function(a){a=a.getClone();null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale()));this._handPointer&&(s.getDocument().body.style.cursor="pointer");this.getEntity().dispatchEvent(new W("mouseOver",
{button:this,entity:this.getEntity()}));null!=this._onMouseOver&&this._onMouseOver(this);this._isMouseOver=!0},onMouseOut:function(a){null!=a&&(a=a.getClone(),null!=this._camera&&(a.x+=this._camera.getEntity().getPosition().x*this._camera.getZoomScale(),a.y+=this._camera.getEntity().getPosition().y*this._camera.getZoomScale(),a.scaleBy(1/this._camera.getZoomScale(),1/this._camera.getZoomScale())),this._handPointer&&(s.getDocument().body.style.cursor="default"),this.getEntity().dispatchEvent(new W("mouseOut",
{button:this,entity:this.getEntity()})),null!=this._onMouseOut&&this._onMouseOut(this),this._isMouseOver=!1)},verifyTouches:function(a){var b=!1;if(null!=a&&null!=a.touches){for(var c=0,d=a.touches.length;c<d;){var e=c++,f=a.touches[e],g=n.getInstance().getScreenOffset(),e=(f.pageX-g.x)/n.getInstance().getScreenScale().x,f=(f.pageY-g.y)/n.getInstance().getScreenScale().y;this._boxCollision.checkPointIntersect(new t(e,f))&&(b=!0)}if(!b&&this._isMouseOver)this.onMouseOut(null);else if(b&&!this._isMouseOver)this.onMouseOver(null)}},
setCollisionProperties:function(a,b){this._collisionSize=a;this._collisionOffset=b},isButtonDisabledByButtonGroup:function(a){var b=a.getComponent(dc);if(null!=b&&!b.isInputEnabled())return!0;a=a.getParent();return null!=a?this.isButtonDisabledByButtonGroup(a):!1},handleMessage:function(a,b){l.prototype.handleMessage.call(this,a,b);if(!(b&&b.isDisabled||!this.getEntity().isVisible()||!this.isActive()||this.isButtonDisabledByButtonGroup(this.getEntity())||this._inactiveOneFrame))switch(a){case "mouseClick":this.onMouseClick(b);
break;case "mouseDown":this.onMouseDown(b)&&this._killMessageOnMouseDown&&(b.isDisabled=!0);break;case "mouseMove":this.onMouseMoved(b);break;case "mouseUp":this.onMouseUp(b);break;case "verifyTouches":this.verifyTouches(b)}},onActivate:function(){l.prototype.onActivate.call(this);this._inactiveOneFrame=!0},onDeactivate:function(){l.prototype.onDeactivate.call(this);this._isMouseOver&&this._handPointer&&(s.getDocument().body.style.cursor="default")},debugRender:function(){l.prototype.debugRender.call(this);
var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();if(null!=la.getDebugCamera()){var b=la.getDebugCamera().getEntity();a.translate(-b.getPosition().x,-b.getPosition().y)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(this._boxCollision.ul.x,this._boxCollision.ul.y);a.lineTo(this._boxCollision.ul.x+this._boxCollision.wh.x,this._boxCollision.ul.y);a.lineTo(this._boxCollision.ul.x+this._boxCollision.wh.x,this._boxCollision.ul.y+this._boxCollision.wh.y);
a.lineTo(this._boxCollision.ul.x,this._boxCollision.ul.y+this._boxCollision.wh.y);a.lineTo(this._boxCollision.ul.x,this._boxCollision.ul.y);a.stroke();a.restore()},destroy:function(){l.prototype.destroy.call(this);if(this._isMouseOver)this.onMouseOut(null)},__class__:qa});var la=function(a){this._offset=null;this._zoomScale=1;this._target=this._cameraBounds=this._slackMovement=null;l.call(this,a);this._offset=new t;this._lensWidth=n.getInstance().getGameSize().x;this._lensHeight=n.getInstance().getGameSize().y;
null==la._debugCamera&&(la._debugCamera=this)};la.__name__=["f84","components","Camera"];la.getDebugCamera=function(){return la._debugCamera};la.__super__=l;la.prototype=p(l.prototype,{getTarget:function(){return this._target},setTarget:function(a){null!=this._target&&this._target.removeEventListener("destroy",q(this,this.onTargetDestroy));this._target=a;null!=this._target&&this._target.addEventListener("destroy",q(this,this.onTargetDestroy))},setOffset:function(a){this._offset=a},getOffset:function(){return this._offset},
getZoomScale:function(){return this._zoomScale},setZoomScale:function(a){this._zoomScale=a},getLensSize:function(){return new t(this._lensWidth,this._lensHeight)},setLensSize:function(a,b){this._lensWidth=a;this._lensHeight=b},init:function(){l.prototype.init.call(this);this._slackMovement=this.getComponent(kd)},getSlackMovement:function(){return this._slackMovement},jumpToTarget:function(){null!=this._target&&this.getEntity().setLocalPosition(this._target.getPosition().x-this._lensWidth/this._zoomScale/
2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z)},getCenter:function(){var a=this.getEntity().getPosition();return new L(a.x-this._lensWidth/this._zoomScale/2,a.y-this._lensHeight/this._zoomScale/2,a.z)},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);null!=this._target&&(null==this._slackMovement?this.getEntity().setLocalPosition(this._target.getPosition().x-this._lensWidth/
this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z):this._slackMovement.setTarget(this._target.getPosition().x-this._lensWidth/this._zoomScale/2+this._offset.x/this._zoomScale,this._target.getPosition().y-this._lensHeight/this._zoomScale/2+this._offset.y/this._zoomScale,this.getEntity().getPosition().z));this.updateCameraBounds()},updateCameraBounds:function(){if(null!=this._cameraBounds){var a=
this.getEntity().getPosition().getClone(),b=this._lensWidth/2/this._zoomScale,c=this._lensHeight/2/this._zoomScale,d=new t(a.x+b,a.y+c),e=!1;d.x-b<this._cameraBounds.ul.x&&(d.x=this._cameraBounds.ul.x+b,e=!0);d.y-c<this._cameraBounds.ul.y&&(d.y=this._cameraBounds.ul.y+c,e=!0);d.x+b>this._cameraBounds.ul.x+this._cameraBounds.wh.x&&(d.x=this._cameraBounds.ul.x+this._cameraBounds.wh.x-b,e=!0);d.y+c>this._cameraBounds.ul.y+this._cameraBounds.wh.y&&(d.y=this._cameraBounds.ul.y+this._cameraBounds.wh.y-
c,e=!0);a.x=d.x-b;a.y=d.y-c;e&&this.getEntity().setLocalPosition(a.x,a.y,a.z)}},getPointConstrainedToCameraBounds:function(a,b){if(null!=this._cameraBounds){var c=new L(a,b),d=this._lensWidth/2/this._zoomScale,e=this._lensHeight/2/this._zoomScale,f=new t(a,b);f.x-d<this._cameraBounds.ul.x&&(f.x=this._cameraBounds.ul.x+d);f.y-e<this._cameraBounds.ul.y&&(f.y=this._cameraBounds.ul.y+e);f.x+d>this._cameraBounds.ul.x+this._cameraBounds.wh.x&&(f.x=this._cameraBounds.ul.x+this._cameraBounds.wh.x-d);c.y+
e>this._cameraBounds.ul.y+this._cameraBounds.wh.y&&(f.y=this._cameraBounds.ul.y+this._cameraBounds.wh.y-e);a=f.x;b=f.y}return new t(a,b)},getBounds:function(){return this._cameraBounds},setBounds:function(a,b,c,d){this._cameraBounds=new Mb(a,b,c-a,d-b)},getViewBounds:function(){var a=this.getEntity().getPosition();return new Mb(a.x,a.y,2*(this._lensWidth/2/this._zoomScale),2*(this._lensHeight/2/this._zoomScale))},destroyBounds:function(){this._cameraBounds=null},destroy:function(){l.prototype.destroy.call(this);
la._debugCamera==this&&(la._debugCamera=null)},onTargetDestroy:function(){this.setTarget(null)},__class__:la});var pb=function(a,b){this._offset=this._onEnter=this._onInside=this._onExit=null;l.call(this,a);this._offset=b};pb.__name__=["f84","components","Collider"];pb.__super__=l;pb.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);bb.getInstance().registerCollider(this)},getCollision:function(){return null},checkPointIntersect:function(a){return!1},update:function(){l.prototype.update.call(this)},
getRaycastPoint:function(a,b,c,d,e){bb.getInstance().dispatchEvent(new ld("raycastCheck",a,b));return-1},debugRender:function(){l.prototype.debugRender.call(this)},setOnEnter:function(a){this._onEnter=a},setOnExit:function(a){this._onExit=a},setOnInside:function(a){this._onInside=a},onEnter:function(a){this._isActive&&null!=this._onEnter&&this._onEnter(a,this)},onInside:function(a){this._isActive&&null!=this._onInside&&this._onInside(a,this)},onExit:function(a){this._isActive&&null!=this._onExit&&
this._onExit(a,this)},onDestroy:function(){l.prototype.onDestroy.call(this);bb.getInstance().removeCollider(this)},__class__:pb});var ne=function(a,b,c,d){null==d&&(d=!1);this.isPaused=this.repeating=!1;this.timeUntilExecute=a;this.actionToExecute=b;this.params=c;this.repeating=d;this.duration=a};ne.__name__=["f84","components","DeferredAction"];ne.prototype={update:function(){this.isPaused||(this.timeUntilExecute-=n.getDeltaTime())},__class__:ne};var Cb=function(a){l.call(this,a);this._deferredActions=
[]};Cb.__name__=["f84","components","DeferredActionController"];Cb.addDeferredActionToTarget=function(a,b,c,d){var e=a.getComponent(Cb);null==e&&(e=new Cb(a));e.addDeferredAction(b,c,d);return e};Cb.__super__=l;Cb.prototype=p(l.prototype,{update:function(){l.prototype.update.call(this);for(var a=this._deferredActions.length-1;0<=a;){var b=this._deferredActions[a];null==b?F.remove(this._deferredActions,b):(b.update(),0>=b.timeUntilExecute&&(b.actionToExecute(b.params),b.repeating?b.timeUntilExecute=
b.duration:F.remove(this._deferredActions,b)),--a,a>this._deferredActions.length-1&&(a=this._deferredActions.length-1))}},addDeferredAction:function(a,b,c){a=new ne(a,b,c);this._deferredActions.push(a);return a},removeDeferredAction:function(a){F.remove(this._deferredActions,a)},destroyAllDeferredActions:function(){this._deferredActions=[]},__class__:Cb});var dg=function(a,b,c,d){this._context=this._image=this._cachedSize=this._clipRect=null;this._forceRenderRequired=!1;this._skew=this._rotation=
this._spriteInfo=this._coords=null;this._alpha=1;this._maskFunction=null;this._imageName="";this.IsLargeImage=!1;l.call(this,a);this._imageName=b;this._layer=c;this._cameraPositionScale=new t(1,1);this._pivotPoint=new t;this._camera=d;this._offset=new t;this._scale=new L(1,1,1);this._skew=new t;this._rotation=new L(0,0,0);this._clipRect=null};dg.__name__=["f84","components","GameImage"];dg.__super__=l;dg.prototype=p(l.prototype,{getClipRect:function(){return this._clipRect},setClipRect:function(a){1>
a.wh.x&&(a.wh.x=1);1>a.wh.y&&(a.wh.y=1);this._clipRect=a},getCamera:function(){return this._camera},setCamera:function(a){this._camera=a},getCoords:function(){return this._coords},setCoords:function(a){this._coords=a},getRotation:function(){return this._rotation},setRotation:function(a){this._rotation=a},setSpriteInfo:function(a){this._spriteInfo=a},setImage:function(a){H.assetExists(a)&&""!=a&&(this._imageName=a,this._image=this.getImageAsset(),this._cachedSize=null)},getImageAsset:function(){return H.getAsset(this._imageName)},
getSkew:function(){return this._skew},setSkew:function(a,b){this._skew=new t(a,b)},setSource:function(a){this._imageName=a},getOffset:function(){return this._offset},setOffset:function(a,b){this._offset=new t(a,b)},centerOffsetOnEntity:function(){if(""!=this._imageName){var a=this.getSize(),a=null!=this._spriteInfo?new t(this._spriteInfo.getCoords().wh.x,this._spriteInfo.getCoords().wh.y):new t(this._image.width,this._image.height);this.setOffset(-a.x/2,-a.y/2)}},setOffsetBasedOnPivotPoint:function(a,
b){var c=this.getSize(),c=null!=this._spriteInfo?new t(this._spriteInfo.getCoords().wh.x,this._spriteInfo.getCoords().wh.y):new t(this._image.width,this._image.height);this.setOffset(-(c.x*a),-(c.y*(1-b)))},getAlpha:function(){return this._alpha},setAlpha:function(a){this._alpha=a},getPivotPoint:function(){return this._pivotPoint},setPivotPoint:function(a,b){this._pivotPoint=new t(a,b)},getLayer:function(){return this._layer},setLayer:function(a){this._layer=a;this._context=null},getImageName:function(){return this._imageName},
getSize:function(){if(null!=this._cachedSize)return this._cachedSize;null==this._image&&(this._image=this.getImageAsset());var a=this.getEntity().getScale();return null!=this._spriteInfo?this._cachedSize=new t(this._spriteInfo.getCoords().wh.x*Math.abs(a.x*this._scale.x),this._spriteInfo.getCoords().wh.y*Math.abs(a.y*this._scale.y)):""==this._imageName?new t(0,0):this._cachedSize=new t(this._image.width*Math.abs(a.x*this._scale.x),this._image.height*Math.abs(a.y*this._scale.y))},getMaskFunction:function(){return this._maskFunction},
setMaskFunction:function(a){this._maskFunction=a},setScale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._scale=new L(a,b,c)},getScale:function(){return this._scale},getCameraPositionScale:function(){return this._cameraPositionScale},setCameraPositionScale:function(a){this._cameraPositionScale=a},render:function(){l.prototype.render.call(this);if(0!=this._alpha&&(""!=this._imageName||null!=this._spriteInfo)){var a=this.getEntity(),b=a.getPosition(),c=1,d=new t(0,0),e=new t(1,1);
null!=this._camera&&(d=this._camera.getEntity(),c=this._camera.getZoomScale(),d=d.getPosition(),d=new t(-(d.x/this._cameraPositionScale.x)*e.x,-(d.y/this._cameraPositionScale.y)*e.y),d.scaleBy(c,c));null==this._context&&(this._context=this._layer.getCanvas().getContext("2d"));this._context.save();null!=this._maskFunction&&(this._context.translate(d.x/e.x*c,d.y/e.y*c),this._maskFunction(this._context,this),this._context.clip(),this._context.translate(-d.x*e.x*c,-d.y*e.y*c));var f=a.getScale().getClone();
f.x*=this._scale.x;f.y*=this._scale.y;this._context.setTransform(1,this._skew.x/f.x,this._skew.y/f.y,1,Math.floor(b.x*e.x*c+d.x)*n.getDevicePixelRatio(),Math.floor(b.y*e.y*c+d.y)*n.getDevicePixelRatio());0!=a.getRotation().z+this._rotation.z&&this._context.rotate(ja.degToRad(a.getRotation().z+this._rotation.z));this._context.scale(f.x*c,f.y*c);a=this._offset.getClone();null!=this._spriteInfo&&(a.x+=this._spriteInfo.getOffset().x,a.y+=this._spriteInfo.getOffset().y);this._context.translate(Math.floor(a.x*
e.x)*n.getDevicePixelRatio(),Math.floor(a.y*e.y)*n.getDevicePixelRatio());this._context.globalAlpha=this._alpha;this._context.scale(e.x*n.getDevicePixelRatio(),e.y*n.getDevicePixelRatio());null==this._spriteInfo&&null==this._coords?(null==this._image&&(this._image=this.getImageAsset()),null==this._clipRect?this._context.drawImage(this._image,0,0):(this._clipRect.ul.x=Math.max(0,this._clipRect.ul.x),this._clipRect.ul.y=Math.max(0,this._clipRect.ul.y),this._context.drawImage(this._image,this._clipRect.ul.x,
this._clipRect.ul.y,this._clipRect.wh.x,this._clipRect.wh.y,0,0,this._clipRect.wh.x*e.x*n.getDevicePixelRatio(),this._clipRect.wh.y*e.y*n.getDevicePixelRatio()))):null==this._spriteInfo&&null!=this._coords?(null==this._image&&(this._image=H.getAsset(this._imageName)),this._context.drawImage(this._image,this._coords.ul.x,this._coords.ul.y,this._coords.wh.x,this._coords.wh.y,0,0,this._coords.wh.x,this._coords.wh.y)):(e=this._spriteInfo.getCoords(),a=ab.getInstance().getSpriteSheetByName(this._spriteInfo.getSpriteSheetName()),
null==this._image&&(this._image=H.getAsset(a.getImageName())),this._context.drawImage(a.getImage(),e.ul.x,e.ul.y,e.wh.x,e.wh.y,0,0,e.wh.x,e.wh.y));this._layer.setWholeCanvasDirty(!0);this._context.restore()}},quickRender:function(){l.prototype.render.call(this);new t(1,1);this._context=this._layer.getCanvas().getContext("2d");null!=this._maskFunction&&(this._maskFunction(this._context,this),this._context.clip());this._context.scale(this._scale.x,this._scale.y);this._context.rotate(this._rotation.z);
if(null==this._spriteInfo&&null==this._coords)null==this._image&&(this._image=H.getAsset(this._imageName));else if(null==this._spriteInfo&&null!=this._coords)null==this._image&&(this._image=H.getAsset(this._imageName)),this._context.drawImage(this._image,Math.floor(this._coords.ul.x),Math.floor(this._coords.ul.y),Math.floor(this._coords.wh.x),Math.floor(this._coords.wh.y),this._offset.x,this._offset.y,Math.floor(this._coords.wh.x)+2,Math.floor(this._coords.wh.y)+2);else{var a=this._spriteInfo.getCoords(),
b=ab.getInstance().getSpriteSheetByName(this._spriteInfo.getSpriteSheetName());null==this._image&&(this._image=H.getAsset(b.getImageName()));this._context.drawImage(this._image,a.ul.x,a.ul.y,a.wh.x,a.wh.y,this._offset.x,this._offset.y,a.wh.x,a.wh.y)}this._context.rotate(-this._rotation.z);this._context.scale(1/this._scale.x,this._scale.y);this._layer.setWholeCanvasDirty(!0)},destroy:function(){l.prototype.destroy.call(this)},onDestroy:function(){l.prototype.onDestroy.call(this);this._camera=null},
__class__:dg});var ob=function(a,b,c,d){null==d&&(d="");null==c&&(c="");this._alwaysUpdatePosition=!1;this._className="";this._div=null;this._isDirty=!0;l.call(this,a);this._html=c;this._className=d;this._layer=b;this.updateHtml()};ob.__name__=["f84","components","HtmlElements"];ob.showElementById=function(a,b){null==b&&(b=!0);var c=ob.getChildDivById(s.getContainer(),a);null!=c?c.style.display=b?"block":"none":La.log("Could not find element with id of "+a+" to "+(b?"show":"hide"))};ob.getStylePositionOfDomElement=
function(a){for(var b=pa.parseInt(a.style.top),c=pa.parseInt(a.style.left);;)if(null!=a.parentNode&&Object.prototype.hasOwnProperty.call(a.parentNode,"style")&&"layer"!=a.parentElement.className)b+=pa.parseInt(a.parentElement.style.top),c+=pa.parseInt(a.parentElement.style.left),a=a.parentElement;else break;return new t(c,b)};ob.setElementTextById=function(a,b){var c=s.getDocument().getElementById(a);null==c?La.log("Could not find '"+a+"' on the page!"):c.innerHTML=b};ob.getChildDivById=function(a,
b){for(var c=0,d=a.children.length;c<d;){var e=c++,e=a.children[e];if(e.id==b||e.hasChildNodes()&&(e=ob.getChildDivById(e,b),null!=e))return e}return null};ob.__super__=l;ob.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this.getEntity().addEventListener("displayUpdate",q(this,this.onDisplayUpdated))},getChildElementById:function(a){return s.getDocument().getElementById(a)},setChildElementTextById:function(a,b){var c=ob.getChildDivById(this.getDiv(),a);null!=c&&(c.innerHTML=
b);this._html=this.getDiv().innerHTML},getDiv:function(){null==this._div&&this._isDirty&&this.updateHtml();return this._div},update:function(){l.prototype.update.call(this);null!=this._div&&this._isDirty&&this.updateHtml();null!=this._div&&this._alwaysUpdatePosition&&this.updatePosition();var a=this.getEntity().isVisible()?"block":"none";this._div.style.display=a},updateHtml:function(){La.log("updateHtml");null!=this._div&&null!=this._div.parentNode&&this._div.parentNode.removeChild(this._div);this._isDirty=
!1;this._div=s.getDocument().createElement("div");this._div.className=this._className;this._div.innerHTML=this._html;this._div.style.position="absolute";var a="translate(0, 0px) scale("+this.getEntity().getScale().x*n.getInstance().getScreenScale().x+","+this.getEntity().getScale().y*n.getInstance().getScreenScale().y;this._div.style.webkitTransform=a+")";a="translate(0, 0px) scale("+this.getEntity().getScale().x*n.getInstance().getScreenScale().x+","+this.getEntity().getScale().y*n.getInstance().getScreenScale().y;
this._div.style.transform=a+")";this._layer.getContainer().appendChild(this._div);this.updatePosition()},updatePosition:function(){var a=this.getEntity().getPosition().x*n.getInstance().getScreenScale().x;this._div.style.left=a-(this._center?this._div.clientWidth/2:0)+"px";a=this.getEntity().getPosition().y*n.getInstance().getScreenScale().y;this._div.style.top=a-(this._center?this._div.clientHeight/2:0)+"px"},setId:function(a){null==this._div&&this._isDirty&&this.updateHtml();this._id=a;this._div.id=
a},getId:function(){return this._id},getHtml:function(){return this._html},setHtml:function(a){this._html=a},setClassName:function(a){this._className=a},getClassName:function(){return this._className},addClassName:function(a){this._className=0<this._className.length?this._className+(" "+a):a},removeClassName:function(a){this._className=$a.replace(this._className,a,"")},forceUpdateNextFrame:function(){this._html=this._div.innerHTML},centerOnEntity:function(a){null==a&&(a=!0);this._center=a;this.updatePosition()},
getSize:function(){return new t(this._div.clientWidth*n.getInstance().getScreenScale().y,this._div.clientHeight*n.getInstance().getScreenScale().y)},destroy:function(){l.prototype.destroy.call(this);null!=this._div.parentNode&&this._layer.getContainer().removeChild(this._div)},handleMessage:function(a,b){l.prototype.handleMessage.call(this,a,b)},onDisplayUpdated:function(){},alwaysUpdatePosition:function(a){null==a&&(a=!0);this._alwaysUpdatePosition=a},__class__:ob});var vb=function(a,b,c,d,e,f,g,
k,h){null==h&&(h=0);null==k&&(k=0);null==g&&(g=!1);this._magnitudeDecayRate=0;this._half=!1;this._propertyName="";this._target=null;this._theta=this._rate=this._base=this._magnitude=0;l.call(this,a);this._base=d;this._magnitude=e;this._rate=f;this._propertyName=c;this._target=b;this._half=g;this._theta=k;this._magnitudeDecayRate=h};vb.__name__=["f84","components","PropertyOscillator"];vb.__super__=l;vb.prototype=p(l.prototype,{getMagnitude:function(){return this._magnitude},setMagnitude:function(a){this._magnitude=
a},getMagnitudeDecayRate:function(){return this._magnitudeDecayRate},setMagnitudeDecayRate:function(a){this._magnitudeDecayRate=a},getBase:function(){return this._base},setBase:function(a){this._base=a},update:function(){l.prototype.update.call(this);if(0<this._magnitude){this._magnitude-=this._magnitudeDecayRate*n.getDeltaTime();0>this._magnitude&&(this._magnitude=0);this._theta+=this._rate*n.getDeltaTime();this._theta>=(this._half?Math.PI:2*Math.PI)&&(this._theta-=this._half?Math.PI:2*Math.PI);
var a=this._base+Math.sin(this._theta)*this._magnitude;Ja.setProperty(this._target,this._propertyName,a)}},__class__:vb});var kd=function(a,b){null==b&&(b=0.5);this._slack=1;this._targetPosition=null;l.call(this,a);this._slack=b};kd.__name__=["f84","components","SlackMovement"];kd.__super__=l;kd.prototype=p(l.prototype,{getSlack:function(){return this._slack},setSlack:function(a){this._slack=a},update:function(){l.prototype.update.call(this);if(null!=this._targetPosition){var a=this._targetPosition.subtract(this.getEntity().getPosition()),
b=a.getLength();0!=b&&(a=a.getNormalized(),a.scaleBy(b*this._slack),5E-5>a.x&&-5E-5<a.x&&(a.x=0),5E-5>a.y&&-5E-5<a.y&&(a.y=0),5E-5>a.z&&-5E-5<a.z&&(a.z=0),b=this.getEntity().getPosition(),this.getEntity().setLocalPosition(b.x+a.x,b.y+a.y,b.z+a.z))}},getTarget:function(){return this._targetPosition},setTarget:function(a,b,c){this._targetPosition=new L(a,b,c)},__class__:kd});var T={__ename__:!0,__constructs__:["Local","World"],Local:["Local",0]};T.Local.__enum__=T;T.World=["World",1];T.World.__enum__=
T;T.__empty_constructs__=[T.Local,T.World];var Hc=function(a){l.call(this,a);this._localPosition=new L;this._localRotation=new L;this._localScale=new L(1,1,1)};Hc.__name__=["f84","components","Transform"];Hc.getIdentity=function(){return window.glMatrix.mat4.identity(window.glMatrix.mat4.create())};Hc.__super__=l;Hc.prototype=p(l.prototype,{getParent:function(){return null!=this.getEntity().getParent()?this.getEntity().getParent().getTransform():null},getPositionRef:function(){return this._localPosition},
getRotationRef:function(){return this._localRotation},getScaleRef:function(){return this._localScale},getPosition:function(a){if(a==T.Local)return this._localPosition.getClone();a=window.glMatrix.mat4.identity(window.glMatrix.mat4.create());for(var b=this;null!=b;){var c=window.glMatrix.mat4.create(),d=b.getRotation(T.Local),e=b.getPosition(T.Local),f=b.getScale(T.Local),c=window.glMatrix.mat4.fromRotationTranslationScale(c,window.glMatrix.quat.fromEuler(window.glMatrix.quat.create(),d.x,d.y,d.z),
window.glMatrix.vec3.fromValues(e.x,e.y,e.z),window.glMatrix.vec3.fromValues(f.x,f.y,f.z));window.glMatrix.mat4.multiply(a,c,a);b=b.getParent()}b=window.glMatrix.vec3.create();window.glMatrix.vec3.transformMat4(b,b,a);return new L(b[0],b[1],b[1])},setPosition:function(a,b){switch(b[1]){case 0:this._localPosition.x=a.x;this._localPosition.y=a.y;this._localPosition.z=a.z;break;case 1:if(this._localPosition.x=a.x,this._localPosition.y=a.y,this._localPosition.z=a.z,null!=this.getParent()){for(var c=Hc.getIdentity(),
d=this.getParent();null!=d;){var e=d.getRotation(T.Local),f=d.getPosition(T.Local),g=d.getScale(T.Local),e=window.glMatrix.quat.fromEuler(window.glMatrix.quat.create(),e.x,e.y,e.z),f=window.glMatrix.vec3.fromValues(f.x,f.y,f.z),g=window.glMatrix.vec3.fromValues(g.x,g.y,g.z),k=window.glMatrix.mat4.create(),k=window.glMatrix.mat4.fromRotationTranslationScale(k,e,f,g);window.glMatrix.mat4.multiply(c,k,c);d=d.getParent()}c=window.glMatrix.mat4.invert(window.glMatrix.mat4.create(),c);d=window.glMatrix.vec3.fromValues(this._localPosition.x,
this._localPosition.y,this._localPosition.z);d=window.glMatrix.vec3.transformMat4(d,d,c);this._localPosition.x=d[0];this._localPosition.y=d[1];this._localPosition.z=d[2]}else this.setPosition(this._localPosition,T.Local)}this.dispatchEvent(new Db("update"))},translate:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._localPosition.x+=a;this._localPosition.y+=b;this._localPosition.z+=c;this.dispatchEvent(new Db("update"))},getScale:function(a){if(a==T.Local)return this._localScale.getClone();
a=new L(1,1,1);for(var b=this;null!=b;)a.x*=b.getScale(T.Local).x,a.y*=b.getScale(T.Local).y,a.z*=b.getScale(T.Local).z,b=b.getParent();return a},setScale:function(a,b,c,d){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);switch(d[1]){case 0:this._localScale.x=a;this._localScale.y=b;this._localScale.z=c;break;case 1:for(this._localScale.x=a,this._localScale.y=b,this._localScale.z=c,a=this.getEntity().getParent();null!=a;)this._localScale.x/=a.getTransform().getScale(T.Local).x,this._localScale.y/=a.getTransform().getScale(T.Local).y,
this._localScale.z/=a.getTransform().getScale(T.Local).z,a=a.getParent()}this.dispatchEvent(new Db("update"))},scale:function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);this._localScale.x*=a;this._localScale.y*=b;this._localScale.z*=c;this.dispatchEvent(new Db("update"))},getRotation:function(a){if(a==T.Local)return this._localRotation.getClone();a=new L;for(var b=this;null!=b;)a.x+=b.getRotation(T.Local).x,a.y+=b.getRotation(T.Local).y,a.z+=b.getRotation(T.Local).z,b=b.getParent();return a},
setRotation:function(a,b,c,d){switch(d[1]){case 0:this._localRotation.x=a;this._localRotation.y=b;this._localRotation.z=c;break;case 1:null!=this.getParent()&&(this._localRotation.x=a,this._localRotation.y=b,this._localRotation.z=c,this._localRotation.x-=this.getParent().getRotation(d).x,this._localRotation.y-=this.getParent().getRotation(d).y,this._localRotation.z-=this.getParent().getRotation(d).z)}this.dispatchEvent(new Db("update"))},rotate:function(a,b,c){this._localRotation.x+=a;this._localRotation.y+=
b;this._localRotation.z+=c;this.dispatchEvent(new Db("update"))},__class__:Hc});var Db=function(a){this._type=a};Db.__name__=["f84","components","TransformEvent"];Db.__super__=J;Db.prototype=p(J.prototype,{__class__:Db});var Jc=function(a,b,c){this._currentTriggers=this._tagsToHit=null;l.call(this,a);this._tagsToHit=b;this._offset=null==c?new t:c;this._currentTriggers=[]};Jc.__name__=["f84","components","TriggerActivator"];Jc.__super__=l;Jc.prototype=p(l.prototype,{getOffset:function(){return this._offset},
setOffset:function(a,b){this._offset.x=a;this._offset.y=b},update:function(){l.prototype.update.call(this);for(var a=0,b=bb.getInstance().getColliders().length;a<b;){var c=a++,c=bb.getInstance().getColliders()[c];if(null==this._tagsToHit||this.tagsMatch(c)){var d=this.getEntity().getPosition();if(c.checkPointIntersect(new t(d.x+this._offset.x,d.y+this._offset.y)))if(!this.isCurrentlyInTrigger(c))c.onEnter(this.getEntity()),this._currentTriggers.push(c),c.getEntity().addEventListener("destroy",q(this,
this.onTriggerDestroyed));else{if(this.isCurrentlyInTrigger(c))c.onInside(this.getEntity())}else this.isCurrentlyInTrigger(c)&&(c.onExit(this.getEntity()),this.removeCurrentTrigger(c))}}},onTriggerDestroyed:function(a){a=a.target;var b=a.getComponent(pb);this.removeCurrentTrigger(b);a.removeEventListener("destroy",q(this,this.onTriggerDestroyed))},removeCurrentTrigger:function(a){for(var b=this._currentTriggers.length-1;0<=b;){var c=this._currentTriggers[b];if(c==a){c.getEntity().removeEventListener("destroy",
q(this,this.onTriggerDestroyed));this._currentTriggers.splice(b,1);break}--b}},tagsMatch:function(a){if(null==a)return!1;for(var b=0,c=this._tagsToHit.length;b<c;){var d=b++;if(a.hasTag(this._tagsToHit[d]))return!0}return!1},isCurrentlyInTrigger:function(a){for(var b=0,c=this._currentTriggers.length;b<c;){var d=b++;if(this._currentTriggers[d]==a)return!0}return!1},debugRender:function(){l.prototype.debugRender.call(this);var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();
if(null!=la.getDebugCamera()){var b=la.getDebugCamera().getEntity(),c=la.getDebugCamera().getZoomScale(),d=la.getDebugCamera().getComponent(oc);a.translate(-b.getPosition().x*c+d.getContainerOffset().x,-b.getPosition().y*c+d.getContainerOffset().y);a.scale(c,c)}b=this.getEntity().getPosition().add(new L(this._offset.x,this._offset.y));a.beginPath();a.globalAlpha=0.65;a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(b.x,b.y-4);a.lineTo(b.x,b.y+4);a.moveTo(b.x-4,b.y);a.lineTo(b.x+4,b.y);a.moveTo(b.x-
4,b.y-4);a.lineTo(b.x+4,b.y+4);a.moveTo(b.x+4,b.y-4);a.lineTo(b.x-4,b.y+4);a.stroke();a.restore()},__class__:Jc});var I=function(a){this._tweens=null;l.call(this,a);this._tweens=[]};I.__name__=["f84","components","Tweener"];I.addTweenToTarget=function(a,b,c,d,e,f,g,k,h,m){null==k&&(k=0);var l=a.getComponent(I);null==l&&(l=new I(a));l.addTween(b,c,d,e,f,g,k,h,m);return l};I.__super__=l;I.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this)},addTween:function(a,b,c,d,e,f,g,k,h){null==
g&&(g=0);a=new eg(a,b,c,d,e,f,g,k,h);this._tweens.push(a);return a},skipAll:function(){for(var a=0,b=this._tweens.length;a<b;){var c=a++;this._tweens[c].skip()}},destroyTween:function(a){F.remove(this._tweens,a)},destroyAllTweens:function(){this._tweens=[]},update:function(){l.prototype.update.call(this);for(var a=this._tweens.length-1;0<=a;){var b=this._tweens[a];b.update(n.getDeltaTime());this.getEntity().setTransformsDirty();b._isCompleted&&this._tweens.splice(a,1);--a}},__class__:I});var rc=function(a,
b){this._velocity=this._angularVelocity=this._gravity=null;l.call(this,a);this._velocity=new L;this._angularVelocity=new L;null!=b&&(this._gravity=b.getClone())};rc.__name__=["f84","components","VelocityController"];rc.__super__=l;rc.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this)},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);null!=this._gravity&&(this._velocity.x+=this._gravity.x*n.getDeltaTime(),this._velocity.y+=this._gravity.y*n.getDeltaTime(),this._velocity.z+=
this._gravity.z*n.getDeltaTime());var a=this._velocity.getClone();a.scaleBy(n.getDeltaTime());var b=this._angularVelocity.getClone();b.scaleBy(n.getDeltaTime());var c=this.getEntity().getLocalPosition();this.getEntity().getLocalRotation();this.getEntity().setLocalPosition(c.x+a.x,c.y+a.y,c.z+a.z);this.getEntity().rotate(b.x,b.y,b.z)},getXyAngleFromVector:function(a){return ja.getAngleInDegreesBetween2dVectors(a,new t(this._velocity.x,this._velocity.y))},getGravity:function(){return this._gravity.getClone()},
setGravity:function(a){this._gravity=new L(a.x,a.y,a.z)},getVelocity:function(){return this._velocity},addVelocity:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._velocity=this._velocity.add(new L(a,b,c))},setVelocity:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this._velocity=new L(a,b,c)},setVelocityX:function(a){this._velocity.x=a},setVelocityY:function(a){this._velocity.y=a},setVelocityZ:function(a){this._velocity.z=a},getVelocityX:function(){return this._velocity.x},
getVelocityY:function(){return this._velocity.y},getVelocityZ:function(){return this._velocity.z},getAngularVelocity:function(){return this._angularVelocity},setAngularVelocity:function(a){this._angularVelocity=a},__class__:rc});var cb=function(a){l.call(this,a);null!=cb._instance&&(window.console.warn("An AudioListener instance already exists. There should only be one!"),cb._instance.destroy());cb._instance=this;this._audioSources=[]};cb.__name__=["f84","components","audio","AudioListener"];cb.getInstance=
function(){return cb._instance};cb.__super__=l;cb.prototype=p(l.prototype,{registerAudioSource:function(a){-1==this._audioSources.indexOf(a)&&(this._audioSources.push(a),a.addEventListener("destroy",q(this,this.onAudioSourceDestroyed)))},removeAudioSource:function(a){F.remove(this._audioSources,a)},onAudioSourceDestroyed:function(a){a.target.removeEventListener("destroy",q(this,this.onAudioSourceDestroyed));this.removeAudioSource(a.target)},update:function(){l.prototype.update.call(this);if(!this.getGameState().getPaused())for(var a=
this.getEntity().getPosition(),b=0,c=this._audioSources.length;b<c;){var d=b++,d=this._audioSources[d],e=Math.abs(a.subtract(d.getEntity().getPosition()).getLength()),f=d.getRolloff();e<=f?(e=B.linear(1-e/f,0,1,1),d.setVolumePercent(e)):d.setVolumePercent(0)}},onPause:function(){l.prototype.onPause.call(this);for(var a=0,b=this._audioSources.length;a<b;){var c=a++;this._audioSources[c].setVolumePercent(0)}},destroy:function(){l.prototype.destroy.call(this);cb._instance=null},__class__:cb});var fg=
function(a,b,c){null==c&&(c=1);null==b&&(b=750);l.call(this,a);this._maxVolume=c;this._rolloff=b;this._volume=0};fg.__name__=["f84","components","audio","AudioSource"];fg.__super__=l;fg.prototype=p(l.prototype,{setRolloff:function(a){this._rolloff=a},getRolloff:function(){return this._rolloff},setVolumePercent:function(a){this.setVolume(this._maxVolume*a)},setVolume:function(a){a!=this._volume&&(this._volume=a,null!=this._soundData&&this._soundData.setVolume(this._volume))},play:function(a,b){null==
b&&(b=!1);null!=cb.getInstance()&&(cb.getInstance().registerAudioSource(this),v.isSoundMuted()||(this._soundData=v.playSoundByName(a,!1,b),null!=this._soundData&&this._soundData.setVolume(this._volume)))},pause:function(){null!=this._soundData&&this._soundData.pause()},resume:function(){null!=this._soundData&&this._soundData.resume()},stop:function(){null!=this._soundData&&(this._soundData.stop(),this._soundData=null)},setActive:function(a){l.prototype.setActive.call(this,a);null!=cb.getInstance()&&
(a?cb.getInstance().registerAudioSource(this):(cb.getInstance().removeAudioSource(this),this.setVolumePercent(0)))},destroy:function(){l.prototype.destroy.call(this);this.stop()},__class__:fg});var Sa=function(a,b,c,d){this._lockDelayButtonNextFrame=!1;this._inputEnabled=!0;this._action=this._instantAction=this._deferredAction=null;this._delayTime=0;l.call(this,a);this._delayTime=c;this._action=b;this._instantAction=d};Sa.__name__=["f84","components","buttons","ButtonActionDelay"];Sa.getDelayButtonLock=
function(){return Sa._delayButtonLock};Sa.__super__=l;Sa.prototype=p(l.prototype,{setOnAction:function(a){this._action=a},init:function(){l.prototype.init.call(this);this._deferredAction=new Cb(this.getEntity());this.getEntity().addEventListener("mouseDown",q(this,this.onMouseDown))},onMouseDown:function(){this._inputEnabled&&!Sa._delayButtonLock&&(this._inputEnabled=!1,this._lockDelayButtonNextFrame=!0,null!=this._instantAction&&this._instantAction(),this._deferredAction.addDeferredAction(this._delayTime,
q(this,this.onMouseDownDelayElapse)))},postUpdate:function(){l.prototype.update.call(this);this._lockDelayButtonNextFrame&&(Sa._delayButtonLock=!0);this._lockDelayButtonNextFrame=!1},onMouseDownDelayElapse:function(){this._lockDelayButtonNextFrame=Sa._delayButtonLock=!1;null!=this._action&&this._action();this._inputEnabled=!0},destroy:function(){l.prototype.destroy.call(this);0<=this._delayTime&&(Sa._delayButtonLock=!1)},__class__:Sa});var dc=function(a){this._inputEnabled=!0;l.call(this,a)};dc.__name__=
["f84","components","buttons","ButtonGroup"];dc.__super__=l;dc.prototype=p(l.prototype,{isInputEnabled:function(){return this._inputEnabled},setInputEnabled:function(a){this._inputEnabled=a},__class__:dc});var Kc=function(a,b,c,d,e){null==e&&(e=!0);this._allowOnce=!0;this._buttonMouseOverScale=this._tweener=null;this._isPulseActive=!1;l.call(this,a);this._pulseFromScale=b;this._pulseToScale=c;this._pulseDuration=d;this._allowOnce=e;this.getEntity().addEventListener("mouseDown",q(this,this.onMouseDown))};
Kc.__name__=["f84","components","buttons","ButtonMouseDownPulse"];Kc.__super__=l;Kc.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this._buttonMouseOverScale=this.getComponent(sc);this._tweener=new I(this.getEntity())},disableButton:function(){this.getEntity().removeEventListener("mouseDown",q(this,this.onMouseDown))},enableButton:function(){this.getEntity().addEventListener("mouseDown",q(this,this.onMouseDown))},onMouseDown:function(){if(!this._isPulseActive&&!Sa.getDelayButtonLock()){var a=
this.getEntity().getComponent(S);this._isPulseActive=!0;null!=this._buttonMouseOverScale&&this._buttonMouseOverScale.setActive(!1);null!=a?(this._tweener.addTween(a.getScaleRef(),"x",this._pulseFromScale,this._pulseToScale,this._pulseDuration,B.easeOutBack,0,q(this,this.onPulseComplete)),this._tweener.addTween(a.getScaleRef(),"y",this._pulseFromScale,this._pulseToScale,this._pulseDuration,B.easeOutBack,0)):(this._tweener.addTween(this.getEntity().getScaleRef(),"x",this._pulseFromScale,this._pulseToScale,
this._pulseDuration,B.easeOutBack,0,q(this,this.onPulseComplete)),this._tweener.addTween(this.getEntity().getScaleRef(),"y",this._pulseFromScale,this._pulseToScale,this._pulseDuration,B.easeOutBack,0))}},onPulseComplete:function(){this._allowOnce||(this._isPulseActive=!1,null!=this._buttonMouseOverScale&&this._buttonMouseOverScale.setActive(!0))},__class__:Kc});var tc=function(a,b,c){this._pixiSprite=null;l.call(this,a);this._defaultImageName=b;this._mouseOverImageName=c;this.getEntity().addEventListener("mouseOver",
q(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",q(this,this.onMouseOut))};tc.__name__=["f84","components","buttons","ButtonMouseOverImage"];tc.__super__=l;tc.prototype=p(l.prototype,{setDefaultImage:function(a){this._defaultImageName=a;this.updateImage(this._defaultImageName)},setMouseOverImage:function(a){this._mouseOverImageName=a;this.updateImage(this._mouseOverImageName)},init:function(){l.prototype.init.call(this);this._pixiSprite=this.getComponent(A);null!=this._pixiSprite&&
(this._pixiSprite.setImage(this._defaultImageName),this._pixiSprite.getSprite().anchor.x=0.5,this._pixiSprite.getSprite().anchor.y=0.5)},disableButton:function(){this.getEntity().removeEventListener("mouseOver",q(this,this.onMouseOver));this.getEntity().removeEventListener("mouseOut",q(this,this.onMouseOut))},enableButton:function(){this.getEntity().addEventListener("mouseOver",q(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",q(this,this.onMouseOut))},onMouseOver:function(a){this.updateImage(this._mouseOverImageName)},
onMouseOut:function(a){this.updateImage(this._defaultImageName)},updateImage:function(a){null==this._pixiSprite&&(this._pixiSprite=this.getComponent(A));null!=this._pixiSprite&&this._pixiSprite.setImage(a)},__class__:tc});var sc=function(a,b,c,d,e){null==c&&(c=0.35);null==b&&(b=1.25);this._baseScaleX=this._baseScaleY=1;this._button=this._tweener=null;l.call(this,a);this._scaleSize=b;this._scaleDuration=c;this._mouseOverEasingFunction=d;this._mouseOutEasingFunction=e;null==this._mouseOverEasingFunction&&
(this._mouseOverEasingFunction=B.linear);null==this._mouseOutEasingFunction&&(this._mouseOutEasingFunction=B.linear);this._baseScaleX=this.getEntity().getScaleRef().x;this._baseScaleY=this.getEntity().getScaleRef().y;this.getEntity().addEventListener("mouseOver",q(this,this.onMouseOver));this.getEntity().addEventListener("mouseOut",q(this,this.onMouseOut))};sc.__name__=["f84","components","buttons","ButtonMouseOverScale"];sc.__super__=l;sc.prototype=p(l.prototype,{onDeactivate:function(){l.prototype.onDeactivate.call(this);
this._tweener.setActive(!1)},onActivate:function(){l.prototype.onActivate.call(this);this._tweener.setActive(!0)},init:function(){l.prototype.init.call(this);this._tweener=new I(this.getEntity());var a=this.getEntity().getComponent(S);null!=a&&(this._baseScaleX=a.getScaleRef().x,this._baseScaleY=a.getScaleRef().y)},disableButton:function(){this.onMouseOut(null);this.getEntity().removeEventListener("mouseOver",q(this,this.onMouseOver))},enableButton:function(){this.getEntity().addEventListener("mouseOver",
q(this,this.onMouseOver))},onMouseOver:function(a){a=this.getEntity().getComponent(S);if(!Sa.getDelayButtonLock())if(this._tweener.destroyAllTweens(),null!=a){var b=a.getScaleRef().x,c=a.getScaleRef().y;this._tweener.addTween(a.getScaleRef(),"x",b,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction);this._tweener.addTween(a.getScaleRef(),"y",c,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction)}else a=this.getEntity().getScaleRef().x,b=this.getEntity().getScaleRef().y,
this._tweener.addTween(this.getEntity().getScaleRef(),"x",a,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction),this._tweener.addTween(this.getEntity().getScaleRef(),"y",b,this._scaleSize,this._scaleDuration,this._mouseOverEasingFunction)},onMouseOut:function(a){if(null!=this._tweener)if(a=this.getEntity().getComponent(S),this._tweener.destroyAllTweens(),null!=a){var b=a.getScaleRef().x,c=a.getScaleRef().y;this._tweener.addTween(a.getScaleRef(),"x",b,this._baseScaleX,this._scaleDuration,
this._mouseOutEasingFunction);this._tweener.addTween(a.getScaleRef(),"y",c,this._baseScaleY,this._scaleDuration,this._mouseOutEasingFunction)}else a=this.getEntity().getScaleRef().x,b=this.getEntity().getScaleRef().y,this._tweener.addTween(this.getEntity().getScaleRef(),"x",a,this._baseScaleX,this._scaleDuration,this._mouseOutEasingFunction),this._tweener.addTween(this.getEntity().getScaleRef(),"y",b,this._baseScaleY,this._scaleDuration,this._mouseOutEasingFunction)},__class__:sc});var Lc=function(a,
b,c){l.call(this,a);this._soundName=b;this._overSoundName=c};Lc.__name__=["f84","components","buttons","ButtonSoundPlay"];Lc.__super__=l;Lc.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this.getEntity().addEventListener("mouseDown",q(this,this.onMouseDown));this.getEntity().addEventListener("mouseOver",q(this,this.onMouseOver))},onMouseDown:function(){""!=this._soundName&&v.playSoundByName(this._soundName)},onMouseOver:function(){""!=this._soundName&&v.playSoundByName(this._overSoundName)},
destroy:function(){l.prototype.destroy.call(this);this.getEntity().removeEventListener("mouseDown",q(this,this.onMouseDown))},__class__:Lc});var Ta=function(a,b,c){pb.call(this,a,c);this._collision=b};Ta.__name__=["f84","components","colliders","BoxCollider"];Ta.__super__=pb;Ta.prototype=p(pb.prototype,{update:function(){pb.prototype.update.call(this);var a=this.getEntity().getPosition().getClone(),b=null!=this._offset?this._offset:new L,c=a.x-this._collision.wh.x/2,d=b.x*this.getEntity().getScale().x;
this._collision.ul.x=c+d;a=a.y-this._collision.wh.y/2;b=b.y*this.getEntity().getScale().y;this._collision.ul.y=a+b},checkPointIntersect:function(a){return this._collision.checkPointIntersect(a)},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);return this._collision.getRaycastPoint(a,b,c,d,e)},getBoxIntersect:function(a){var b=this._collision;a=a.getCollision();return b.getBoxIntersect(a)},debugRender:function(){pb.prototype.debugRender.call(this);var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");
a.save();if(null!=la.getDebugCamera()){var b=la.getDebugCamera().getEntity(),c=la.getDebugCamera().getZoomScale(),d=la.getDebugCamera().getComponent(oc);a.translate(-b.getPosition().x*c+d.getContainerOffset().x,-b.getPosition().y*c+d.getContainerOffset().y);a.scale(c,c)}a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(this._collision.ul.x,this._collision.ul.y);a.lineTo(this._collision.ul.x+this._collision.wh.x,this._collision.ul.y);a.lineTo(this._collision.ul.x+this._collision.wh.x,this._collision.ul.y+
this._collision.wh.y);a.lineTo(this._collision.ul.x,this._collision.ul.y+this._collision.wh.y);a.lineTo(this._collision.ul.x,this._collision.ul.y);a.stroke();a.restore()},getCollision:function(){return this._collision},__class__:Ta});var pe=function(a,b,c){this._position=this._spriteIndex=0;this._position=a;this._spriteIndex=b;this._spriteSheetName=c};pe.__name__=["f84","components","flashAnimation","AnimationKeyframe"];pe.prototype={getSpriteSheetName:function(){return this._spriteSheetName},getPosition:function(){return this._position},
getSpriteIndex:function(){return this._spriteIndex},__class__:pe};var B=function(){};B.__name__=["f84","components","tween","EasingFunctions"];B.linear=function(a,b,c,d){return b+c*(a/d)};B.easeOutExpo=function(a,b,c,d){return c*(-Math.pow(2,-10*a/d)+1)+b};B.easeInCubic=function(a,b,c,d){a/=d;return c*a*a*a+b};B.easeOutCubic=function(a,b,c,d){a/=d;--a;return c*(a*a*a+1)+b};B.easeInQuad=function(a,b,c,d){a/=d;return c*a*a+b};B.easeOutQuad=function(a,b,c,d){a/=d;return-c*a*(a-2)+b};B.easeInOutQuad=
function(a,b,c,d){a/=d/2;if(1>a)return c/2*a*a+b;--a;return-c/2*(a*(a-2)-1)+b};B.easeInOutSine=function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b};B.easeInQuint=function(a,b,c,d){a/=d;return c*a*a*a*a*a+b};B.easeOutQuint=function(a,b,c,d){a/=d;--a;return c*(a*a*a*a*a+1)+b};B.easeOutBounce=function(a,b,c,d){a/=d;return 0.36363636363636365>a?c*7.5625*a*a+b:0.7272727272727273>a?c*(7.5625*(a-=0.5454545454545454)*a+0.75)+b:0.9090909090909091>a?c*(7.5625*(a-=0.8181818181818182)*a+0.9375)+b:c*(7.5625*
(a-=0.9545454545454546)*a+0.984375)+b};B.easeInBack=function(a,b,c,d){return c*(a/=d)*a*(2.70158*a-1.70158)+b};B.easeOutBack=function(a,b,c,d){a=a/d-1;return c*(a*a*(3.70158*a+2.70158)+1)+b};B.easeInOutExpo=function(a,b,c,d){a/=d/2;if(1>a)return c/2*Math.pow(2,10*(a-1))+b;--a;return c/2*(-Math.pow(2,-10*a)+2)+b};var eg=function(a,b,c,d,e,f,g,k,h){this._elapsedTime=0;this._isCompleted=!1;this._action=this._params=null;this._change=this._delay=0;this._target=this._easingFunction=null;this._propertyName=
"";this._begin=this._end=this._duration=0;this._target=a;this._propertyName=b;this._begin=c;this._end=d;this._duration=e;this._easingFunction=f;this._delay=g;this._action=k;this._params=h};eg.__name__=["f84","components","tween","Tween"];eg.prototype={getOnUpdate:function(){return this._onUpdate},setOnUpdate:function(a){this._onUpdate=a},update:function(a){this._change=this._end-this._begin;this._elapsedTime+=a;this._elapsedTime<this._delay||(this._elapsedTime>this._duration+this._delay&&(this._elapsedTime=
this._duration+this._delay),a=0,a=this._easingFunction(this.getTransitionTimeElapsed(),this._begin,this._change,this._duration),Ja.setProperty(this._target,this._propertyName,a),null!=this._onUpdate&&this._onUpdate(),!this._isCompleted&&this.getTransitionTimeElapsed()>=this._duration&&(this._isCompleted=!0,null!=this._action&&(a=this._action,this._action=null,a(this._params))))},skip:function(){Ja.setProperty(this._target,this._propertyName,this._end);this._isCompleted=!0;this._elapsedTime=this._duration;
if(null!=this._action){var a=this._action;this._action=null;a(this._params)}},getTransitionTimeElapsed:function(){return Math.max(0,this._elapsedTime-this._delay)},__class__:eg};var W=function(a,b){this.data=null;this._type=a;this.data=b};W.__name__=["f84","events","EntityEvent"];W.__super__=J;W.prototype=p(J.prototype,{__class__:W});var bg=function(a,b){this.eventName=a;this.action=b};bg.__name__=["f84","events","EventListener"];bg.prototype={__class__:bg};var ub=function(a){this._type=a};ub.__name__=
["f84","events","GameObjectEvent"];ub.__super__=J;ub.prototype=p(J.prototype,{__class__:ub});var ld=function(a,b,c){this.start=this.end=null;this._type=a;this.start=b;this.end=c};ld.__name__=["f84","events","RaycastCheckEvent"];ld.__super__=J;ld.prototype=p(J.prototype,{__class__:ld});var Na=function(){this._animations=new Pa};Na.__name__=["f84","managers","AnimationManager"];Na.getInstance=function(){null==Na._instance&&(Na._instance=new Na);return Na._instance};Na.prototype={getAnimationByName:function(a){var b=
this._animations;return null!=ba[a]?b.getReserved(a):b.h[a]},registerAnimation:function(a){var b=this._animations,c=a.getName();null!=ba[c]?b.setReserved(c,a):b.h[c]=a},removeAnimationByName:function(a){this._animations.remove(a)},removeAllAnimations:function(){this._animations=new Pa},__class__:Na};var H=function(){};H.__name__=["f84","managers","AssetManager"];H.outputAssets=function(){La.log(H.assetList)};H.getAsset=function(a){var b=H.assetList;if(null!=ba[a]?!b.existsReserved(a):!b.h.hasOwnProperty(a))throw new P(a+
" does not exist in asset list!");b=H.assetList;return null!=ba[a]?b.getReserved(a):b.h[a]};H.assetExists=function(a){var b=H.assetList;return null!=ba[a]?b.existsReserved(a):b.h.hasOwnProperty(a)};H.unloadAsset=function(a){var b=H.assetList;null!=ba[a]?b.setReserved(a,null):b.h[a]=null;H.assetList.remove(a);a=PIXI.Texture.removeTextureFromCache(a);null!=a&&a.destroy(!0)};H.unloadLoadBatch=function(a){H.getAsset(a).unload()};H.registerAsset=function(a,b,c){null==c&&(c=!0);var d=H.assetList;(null!=
ba[a]?d.existsReserved(a):d.h.hasOwnProperty(a))&&!c||(c=H.assetList,null!=ba[a]?c.setReserved(a,b):c.h[a]=b)};H.prototype={__class__:H};var ec=function(){O.call(this);ec._instance=this};ec.__name__=["f84","managers","DebugManager"];ec.getInstance=function(){return ec._instance};ec.__super__=fa;ec.prototype=p(fa.prototype,{update:function(){fa.prototype.update.call(this);"1"==Y.getProperty("debugCheats")&&(ea.getInstance().isKeyPressed(104)&&Y.setProperty("debugDraw","1"==Y.getProperty("debugDraw")?
"0":"1"),ea.getInstance().isKeyPressed(101)&&this.dispatchEvent(new Eb("beatLevel")),ea.getInstance().isKeyPressed(102)&&this.dispatchEvent(new Eb("failLevel")),ea.getInstance().isKeyPressed(100)&&(Y.setProperty("forceOrientation","HORIZONTAL"==Y.getProperty("forceOrientation")?"VERTICAL":"HORIZONTAL"),n.getInstance().onOrientationChange()),ea.getInstance().isKeyPressed(99)&&this.outputHierarchyToWindow())},destroy:function(){fa.prototype.destroy.call(this);ec._instance=null},outputHierarchyToWindow:function(){La.log("Outputting Hierarchy to window...");
for(var a=window.document.createElement("div"),b=window.open("","_blank"),c=0,d=n.getInstance().getGameStates().length;c<d;){var e=c++,e=n.getInstance().getGameStates()[e],f=window.document.createElement("details");a.appendChild(f);f.style.color="#FF0000";var g=window.document.createElement("summary");f.appendChild(g);g.innerText=sb.getClassName(null==e?null:C.getClass(e));for(var g=0,k=e.getEntities().length;g<k;){var h=g++,h=e.getEntities()[h];null==h.getParent()&&(h=this.createDetailsElementForEntity(h),
h.style.marginLeft="10px",f.appendChild(h))}}b.document.body.appendChild(a)},createDetailsElementForEntity:function(a){var b=a.getName();if(""==b||null==b)b="Entity";var c=window.document.createElement("details");c.style.marginLeft="10px";c.style.color="#00b700";var d=window.document.createElement("summary");c.appendChild(d);for(var e=null!=a.getComponents(l)?a.getComponents(l).length:0,f=a.getChildren().length,g=a.getChildren(!0).length,k="",h=0;h<e;){var m=h++,m=a.getComponents(l)[m],n=window.document.createElement("details");
n.style.marginLeft="10px";n.style.color="#439eff";var p=window.document.createElement("summary");n.appendChild(p);var q=sb.getClassName(null==m?null:C.getClass(m));m.isActive()||(q="(INACTIVE) "+q);p.innerText=q;""!=k&&(k+=", ");p=sb.getClassName(null==m?null:C.getClass(m)).split(".");k+=p[p.length-1];c.appendChild(n);for(var p=Ja.fields(m),q=0,s=p.length;q<s;){var r=q++,t=p[r],r=window.document.createElement("details");r.style.marginLeft="10px";r.style.color="#AAAAAA";var u=window.document.createElement("summary");
r.appendChild(u);var v=Ja.field(m,t),w=v;null==w||C.getClass(w);u.innerText=t;t=window.document.createElement("span");t.style.marginLeft="10px";t.style.color="#888888";t.innerText=v;n.appendChild(r);r.appendChild(t)}}a.isActive()||(b="(INACTIVE) "+b);d.innerHTML=0<e?b+" - Children("+f+"/"+g+") <font color='#439eff'> Components("+e+": "+k+")</font>":b+" - Children("+f+"/"+g+")";for(b=0;b<f;)d=b++,d=a.getChildren()[d],d=this.createDetailsElementForEntity(d),c.appendChild(d);return c},__class__:ec});
var Eb=function(a){this._type=a};Eb.__name__=["f84","managers","DebugManagerEvent"];Eb.__super__=J;Eb.prototype=p(J.prototype,{__class__:Eb});var ea=function(){this._keysDown=this._keysPressedThisFrame=null;this._isInputDisabled=this._isLeftMouseDown=this._isRightMouseDown=!1;this._mousePosition=null;O.call(this);ea._instance=this;this._mousePosition=new t(0,0);this._keysDown=[];this._keysPressedThisFrame=[];for(var a=0;255>a;)a++,this._keysDown.push(!1),this._keysPressedThisFrame.push(!1)};ea.__name__=
["f84","managers","InputManager"];ea.getInstance=function(){return ea._instance};ea.__super__=fa;ea.prototype=p(fa.prototype,{init:function(){fa.prototype.init.call(this);s.getWindow().addEventListener("mousemove",q(this,this.onMouseMoved));s.getWindow().addEventListener("mousedown",q(this,this.onMouseDown));s.getWindow().addEventListener("mouseup",q(this,this.onMouseUp));s.getWindow().addEventListener("mouseleave",q(this,this.onMouseLeave));s.getWindow().addEventListener("mouseout",q(this,this.onMouseOut));
s.getDocument().addEventListener("keydown",q(this,this.onKeyDown));s.getDocument().addEventListener("keyup",q(this,this.onKeyUp));s.getDocument().addEventListener("keypress",q(this,this.onKeyPressed));s.getWindow().addEventListener("click",q(this,this.onMouseClick));document.addEventListener("touchstart",q(this,this.onMouseDown));document.addEventListener("touchend",q(this,this.onMouseUp));document.addEventListener("touchmove",q(this,this.onMouseMoved))},update:function(){fa.prototype.update.call(this)},
postUpdate:function(){fa.prototype.postUpdate.call(this);for(var a=0,b=this._keysPressedThisFrame.length;a<b;){var c=a++;this._keysPressedThisFrame[c]=!1}},getMousePosition:function(){var a=n.getInstance().getScreenOffset();return new t((this._mousePosition.x-a.x)/n.getInstance().getScreenScale().x,(this._mousePosition.y-a.y)/n.getInstance().getScreenScale().y)},onMouseMoved:function(a){if(!this._isInputDisabled)if(n.isMobile()){for(var b=a.changedTouches,c=0,d=b.length;c<d;){var e=c++,f=b[e],e=f.pageX-
s.getContainer().offsetParent.offsetLeft,f=f.pageY-s.getContainer().offsetParent.offsetTop;this._mousePosition.x=e;this._mousePosition.y=f;n.getInstance().sendGlobalMessage("mouseMove",this.getMousePosition())}n.getInstance().sendGlobalMessage("verifyTouches",a)}else b=a.pageX-s.getContainer().offsetParent.offsetLeft,a=a.pageY-s.getContainer().offsetParent.offsetTop,this._mousePosition.x=b,this._mousePosition.y=a,n.getInstance().sendGlobalMessage("mouseMove",this.getMousePosition())},onMouseDown:function(a){n.getInstance().hideAddressBar();
n.isMobile()&&!n.isIOS()&&n.getInstance().requestFullscreen();if(!this._isInputDisabled)if(n.isMobile()){this._isLeftMouseDown=!0;var b=a.changedTouches;a=0;for(var c=b.length;a<c;){var d=a++,e=b[d],d=e.pageX-s.getContainer().offsetParent.offsetLeft,e=e.pageY-s.getContainer().offsetParent.offsetTop;this._mousePosition.x=d;this._mousePosition.y=e;n.getInstance().sendGlobalMessage("mouseDown",this.getMousePosition())}}else 0==a.button&&(this._isLeftMouseDown=!0),2==a.button&&(this._isRightMouseDown=
!0),b=a.pageX-s.getContainer().offsetParent.offsetLeft,a=a.pageY-s.getContainer().offsetParent.offsetTop,this._mousePosition.x=b,this._mousePosition.y=a,n.getInstance().sendGlobalMessage("mouseDown",this.getMousePosition())},onMouseUp:function(a){if(!this._isInputDisabled){if(n.isMobile())this._isLeftMouseDown=!1;else{0==a.button&&(this._isLeftMouseDown=!1);2==a.button&&(this._isRightMouseDown=!1);var b;b=a.pageX-s.getContainer().offsetParent.offsetLeft;a=a.pageY-s.getContainer().offsetParent.offsetTop;
this._mousePosition.x=b;this._mousePosition.y=a}n.getInstance().sendGlobalMessage("mouseUp",this.getMousePosition())}},onMouseClick:function(a){if(!this._isInputDisabled){var b=a.pageX-s.getContainer().offsetParent.offsetLeft;a=a.pageY-s.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;n.getInstance().sendGlobalMessage("mouseClick",this.getMousePosition())}},onMouseLeave:function(a){if(!this._isInputDisabled){var b=a.pageX-s.getContainer().offsetParent.offsetLeft;
a=a.pageY-s.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;n.getInstance().sendGlobalMessage("mouseLeave",this.getMousePosition())}},onMouseOut:function(a){if(!this._isInputDisabled){var b=a.pageX-s.getContainer().offsetParent.offsetLeft;a=a.pageY-s.getContainer().offsetParent.offsetTop;this._mousePosition.x=b;this._mousePosition.y=a;n.getInstance().sendGlobalMessage("mouseOut",this.getMousePosition())}},onKeyDown:function(a){a.stopPropagation();this._isInputDisabled||
this._keysDown[a.keyCode]||(this._keysDown[a.keyCode]=!0,this._keysPressedThisFrame[a.keyCode]=!0,n.getInstance().sendGlobalMessage("keyDown",a.keyCode))},onKeyUp:function(a){this._isInputDisabled||(this._keysDown[a.keyCode]=!1,n.getInstance().sendGlobalMessage("keyUp",a.keyCode))},onKeyPressed:function(a){a.stopPropagation();this._isInputDisabled||n.getInstance().sendGlobalMessage("keyPressed",a.keyCode)},disablePageKeyPresses:function(){document.onkeydown=function(a){a.preventDefault();return!1}},
enablePageKeyPresses:function(){document.onkeydown=null},getInputDisabled:function(){return this._isInputDisabled},setInputDisabled:function(a){this._isInputDisabled=a},isKeyDown:function(a){return this._keysDown[a]},isKeyPressed:function(a){return this._keysPressedThisFrame[a]},isLeftMouseDown:function(){return this._isLeftMouseDown},isRightMouseDown:function(){return this._isRightMouseDown},__class__:ea});var bb=function(){this._colliders=this._raycastsThisFrame=null;O.call(this);bb._instance=this;
this._raycastsThisFrame=[];this._colliders=[];this._debugDrawEnabled="1"==Y.getProperty("debugDraw");this.addEventListener("raycastCheck",q(this,this.onRaycastCheck))};bb.__name__=["f84","managers","PhysicsManager"];bb.getInstance=function(){return bb._instance};bb.createBoxColliderEntity=function(a,b,c,d,e,f,g,k){null==k&&(k=!0);d=f.addEntity();d.setLocalPosition(a,b,c);a=new Ea;k=new Ta(d,a,k?new L:new L(0.5*a.wh.x,0.5*a.wh.y));if(null!=g)for(a=0,b=g.length;a<b;)c=a++,k.addTag(g[c]);return d};bb.createBoxCollider=
function(a,b,c,d,e,f,g){null==f&&(f=0);null==e&&(e=0);null==d&&(d=0);b=new Ea;a=new Ta(a,b,new L(d,e,f));if(null!=g)for(d=0,e=g.length;d<e;)f=d++,a.addTag(g[f]);return a};bb.__super__=fa;bb.prototype=p(fa.prototype,{update:function(){fa.prototype.update.call(this)},registerCollider:function(a){for(var b=0,c=this._colliders.length;b<c;){var d=b++;if(this._colliders[d]==a)return}this._colliders.push(a)},removeCollider:function(a){for(var b=0,c=this._colliders.length;b<c;){var d=b++;if(this._colliders[d]==
a){this._colliders.splice(d,1);break}}},getColliders:function(){return this._colliders},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!0);for(var f=-1,g=null,k=null,h=0,m=0,l=0,n=this._colliders.length;l<n;){var p=l++;++m;p=this._colliders[p];if(!1!=p.isActive()){if(null!=e){for(var q=!1,s=0,r=e.length;s<r;){var u=s++;if(p.hasTag(e[u])){q=!0;break}}if(!q)continue}++h;q=new t;if(d){if(s=new t,r=p.getRaycastPoint(a,b,q,d,s),-1==f&&0<r||0<r&&r<f)c.distance=r,c.collider=p,c.collisionPoint=q,k=c.normal=
s,g=q,f=r,F.remove(this._colliders,p),this._colliders.unshift(p)}else if(s=new t,r=p.getRaycastPoint(a,b,q,d,s),0<r){c.distance=r;c.collider=p;c.collisionPoint=q;k=c.normal=s;g=q;f=r;F.remove(this._colliders,p);this._colliders.unshift(p);break}}}this._raycastsThisFrame.push({start:a,end:b,hitPoint:g,normal:k});return f},render:function(){fa.prototype.render.call(this);"0"==Y.getProperty("debugDraw")&&(this._raycastsThisFrame=[])},debugRender:function(){fa.prototype.debugRender.call(this);for(var a=
0,b=this._raycastsThisFrame.length;a<b;){var c=a++,d=this._raycastsThisFrame[c],e=d.start,f=d.end,c=d.hitPoint,g=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");g.save();if(null!=la.getDebugCamera()){var k=la.getDebugCamera().getEntity(),h=la.getDebugCamera().getZoomScale(),m=la.getDebugCamera().getComponent(oc);g.translate(-k.getPosition().x*h+m.getContainerOffset().x,-k.getPosition().y*h+m.getContainerOffset().y);g.scale(h,h)}null==c?(g.beginPath(),g.globalAlpha=1,g.lineWidth=
1,g.strokeStyle="#AAAAFF",g.moveTo(e.x,e.y),g.lineTo(f.x,f.y),g.stroke()):(g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#AAAAFF",g.moveTo(e.x,e.y),g.lineTo(c.x,c.y),g.stroke(),g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#FFD526",g.moveTo(c.x,c.y),g.lineTo(f.x,f.y),g.stroke(),null!=d.normal&&(e=(new t(f.x-c.x,f.y-c.y)).getLength(),d=new t(c.x+d.normal.x*e,c.y+d.normal.y*e),g.beginPath(),g.globalAlpha=1,g.lineWidth=1,g.strokeStyle="#FF00FF",g.moveTo(c.x,c.y),g.lineTo(d.x,
d.y),g.stroke()));g.restore()}this._raycastsThisFrame=[]},destroyAllColliders:function(){for(var a=this._colliders.length-1;0<=a;)this.removeCollider(this._colliders[a]),--a;this._colliders=[]},onRaycastCheck:function(a){this._raycastsThisFrame.push({start:a.start,end:a.end})},__class__:bb});var uc=function(){this._isCurrentVoLocked=!1;this._voTrack=null;O.call(this);uc._instance=this};uc.__name__=["f84","managers","VoManager"];uc.getInstance=function(){return uc._instance};uc.__super__=fa;uc.prototype=
p(fa.prototype,{playVo:function(a,b,c,d){null==d&&(d=!1);null==c&&(c=!1);null==b&&(b=!1);if(!this._isCurrentVoLocked||b)this.stopVo(),this._voTrack=v.playSoundByName(a,c,d),b&&(n.getInstance().invokeAsyncDeferredAction(this._voTrack.getSoundLength(),q(this,this.onHighPrioritySoundElapse)),this._isCurrentVoLocked=!0)},onHighPrioritySoundElapse:function(){this._isCurrentVoLocked=!1},stopVo:function(){null!=this._voTrack&&(this._voTrack.stop(),this._voTrack=null)},__class__:uc});var V=function(a){this._updateContainerEveryFrame=
!0;var b=a.getComponent(V);null!=b&&(console.log("PixiContainer already exists on this Entity;  Deleting original"),b.destroy());l.call(this,a);this._positionOffset=new t(0,0);this._scaleModifier=new t(1,1);this._scaleOffset=new t(0,0);this._rotationOffset=0;this._container=new PIXI.Container};V.__name__=["f84","pixi","PixiContainer"];V.__super__=l;V.prototype=p(l.prototype,{getUpdateContainerEveryFrame:function(){return this._updateContainerEveryFrame},setUpdateContainerEveryFrame:function(a){this._updateContainerEveryFrame=
a},getPositionOffset:function(){return this._positionOffset},setPositionOffset:function(a){this._positionOffset=a},getScaleModifier:function(){return this._scaleModifier},setScaleModifier:function(a){this._scaleModifier=a},getScaleOffset:function(){return this._scaleOffset},setScaleOffset:function(a){this._scaleOffset=a},getRotationOffset:function(){return this._rotationOffset},setRotationOffset:function(a){this._rotationOffset=a},getContainer:function(){return this._container},onActivate:function(){l.prototype.onActivate.call(this);
null!=this._container&&(this._container.renderable=!0)},onDeactivate:function(){l.prototype.onDeactivate.call(this);null!=this._container&&(this._container.renderable=!1)},init:function(){l.prototype.init.call(this);this.updateTransforms();this.updateParenting()},updateParenting:function(){if(!this.isMarkedForDeletion()){var a=this.getEntity().getParent();if(null!=a){var b=a.getComponent(V);null==b&&(b=new V(a));0<b.getContainer().children.length?b.getContainer().addChildAt(this._container,b.getContainer().children.length):
b.getContainer().addChild(this._container);this._parentContainer=b}else 0<Da.getInstance().getStage().children.length?Da.getInstance().getStage().addChildAt(this._container,Da.getInstance().getStage().children.length):Da.getInstance().getStage().addChild(this._container)}},update:function(){l.prototype.update.call(this);this._container.visible=this.getEntity().isVisible()},render:function(){l.prototype.render.call(this);this._updateContainerEveryFrame&&(this.updateTransforms(),this.updateParenting())},
bringToFront:function(){var a=this._container.parent;null!=a&&(a.removeChild(this._container),a.addChild(this._container))},updateTransforms:function(){var a=this.getEntity().getLocalPosition(),b=this.getEntity().getLocalScale();this._container.position=new PIXI.Point(a.x+this._positionOffset.x,a.y+this._positionOffset.y);a=this.getEntity().getLocalRotation().z+this._rotationOffset;this._container.rotation=ja.degToRad(a);this._container.scale=new PIXI.Point(b.x*this._scaleModifier.x+this._scaleOffset.x,
b.y*this._scaleModifier.y+this._scaleOffset.y)},destroy:function(){l.prototype.destroy.call(this);null!=this._container.parent&&this._container.parent.removeChild(this._container)},__class__:V});var A=function(a,b,c){V.call(this,a);this._container=new PIXI.Sprite(null);this.setImage(b,c)};A.__name__=["f84","pixi","PixiSprite"];A.__super__=V;A.prototype=p(V.prototype,{getSprite:function(){return this._container},getImageId:function(){return this._imageId},getFrame:function(){return this.getSprite().texture.frame},
setImage:function(a,b){if(H.assetExists(a)){if(this._imageId!=a)if(this._currentImageElement=H.getAsset(a),null==b)this.getSprite().texture=PIXI.Texture.fromImage(this._currentImageElement.src);else{var c=PIXI.BaseTexture.fromImage(this._currentImageElement.src);this.getSprite().texture=new PIXI.Texture(c,b)}else null==b?this.getSprite().texture.noFrame=!0:(this.getSprite().texture.frame=b,this.getSprite().texture.noFrame=!1);this._imageId=a}this.updateTransforms()},update:function(){V.prototype.update.call(this)},
fixedUpdate:function(){V.prototype.fixedUpdate.call(this)},render:function(){V.prototype.render.call(this)},destroy:function(){V.prototype.destroy.call(this)},__class__:A});var ua=function(a,b){this._onAnimationComplete=null;this._position=0;this._updateScale=1;this._isPlaying=!0;A.call(this,a,"");this._currentAnimationName=b};ua.__name__=["f84","pixi","PixiAnimation"];ua.__super__=A;ua.prototype=p(A.prototype,{getAnimation:function(){return Na.getInstance().getAnimationByName(this._currentAnimationName)},
getAnimationLength:function(){return this.getAnimation().getLength()},getUpdateScale:function(){return this._updateScale},setUpdateScale:function(a){this._updateScale=a},fixedUpdate:function(){A.prototype.update.call(this);var a=this.getAnimation();if(null!=a){if(this._isPlaying){this._position+=n.getDeltaTime()*this.getUpdateScale();if(0<this._updateScale&&this._position>=a.getLength()&&(a.getLoop()?this._position-=a.getLength():(this._position=a.getLength(),this.stop()),null!=this._onAnimationComplete)){var b=
this._onAnimationComplete;this._onAnimationComplete=null;b(this.getEntity());a=Na.getInstance().getAnimationByName(this._currentAnimationName)}0>this._updateScale&&0>=this._position&&(a.getLoop()?this._position+=a.getLength():(this._position=0,this.stop()),null!=this._onAnimationComplete&&(b=this._onAnimationComplete,this._onAnimationComplete=null,b(this.getEntity()),a=Na.getInstance().getAnimationByName(this._currentAnimationName)))}if(null!=a){var b=a.getSpriteIndexAtPosition(this._position),c=
a.getSpriteSheetNameAtPosition(this._position),b=ab.getInstance().getSpriteSheetByName(c).getSpriteInfoByIndex(b),d=b.getCoords();this.setImage(c,new PIXI.Rectangle(d.ul.x,d.ul.y,d.wh.x,d.wh.y));c=a.getOffset().x/b.getCoords().wh.x;a=a.getOffset().y/b.getCoords().wh.y;d=b.getOffset().x/b.getCoords().wh.x;b=b.getOffset().y/b.getCoords().wh.y;this.getSprite().anchor.x=-c-d;this.getSprite().anchor.y=-a-b}}},setPosition:function(a){this._position=a},getPosition:function(){return this._position},setAnimation:function(a,
b,c){null==c&&(c=!1);if(this._currentAnimationName!=a||c)this._position=0;this._currentAnimationName=a;this._onAnimationComplete=b;this._isPlaying=!0},getAnimationName:function(){return this._currentAnimationName},play:function(){this._isPlaying=!0},stop:function(){this._isPlaying=!1},playing:function(){return this._isPlaying},setOnAnimationComplete:function(a){this._onAnimationComplete=a},getOnAnimationComplete:function(){return this._onAnimationComplete},__class__:ua});var oc=function(a){this._containerOffset=
new t(0,0);this._muteRotation=!1;this._layers=[];la.call(this,a)};oc.__name__=["f84","pixi","PixiCamera"];oc.__super__=la;oc.prototype=p(la.prototype,{getContainerOffset:function(){return this._containerOffset},setContainerOffset:function(a){this._containerOffset.x=a.x;this._containerOffset.y=a.y},getMuteRotation:function(){return this._muteRotation},setMuteRotation:function(a){this._muteRotation=a},addLayer:function(a,b,c,d,e,f){null==f&&(f=1);null==e&&(e=0);null==d&&(d=0);null==c&&(c=1);null==b&&
(b=1);a=new gg(a,b,c,d,e,f);this._layers.push(a);return a},removeLayer:function(a){F.remove(this._layers,a)},getLayerByContainer:function(a){for(var b=0,c=this._layers.length;b<c;){var d=b++,d=this._layers[d];if(d.pixiContainer==a)return d}return null},getLayers:function(){return this._layers},postUpdate:function(){la.prototype.postUpdate.call(this);for(var a=this.getEntity().getPosition(),b=0,c=this._layers.length;b<c;){var d=b++,e=this._zoomScale,d=this._layers[d],e=0==d.zoomModifier?1:e*d.zoomModifier;
0==d.parallaxX&&0==d.parallaxY&&(e=1);d.muteXMovement?d.pixiContainer.setPositionOffset(new t(d.pixiContainer.getPositionOffset().x,n.getInstance().getGameSize().y/2+this._containerOffset.y*d.parallaxY)):d.muteYMovement?d.pixiContainer.setPositionOffset(new t(n.getInstance().getGameSize().x/2+this._containerOffset.x*d.parallaxX,d.pixiContainer.getPositionOffset().y)):d.muteXMovement||d.muteYMovement||d.pixiContainer.setPositionOffset(new t(n.getInstance().getGameSize().x/2+this._containerOffset.x*
d.parallaxX,n.getInstance().getGameSize().y/2+this._containerOffset.y*d.parallaxY));this._muteRotation||d.pixiContainer.setRotationOffset(this.getEntity().getRotation().z);var f=Math.floor(a.x*d.parallaxX)-d.originX+n.getInstance().getGameSize().x/e/2,g=Math.floor(a.y*d.parallaxY)-d.originY+n.getInstance().getGameSize().y/e/2;d.pixiContainer.getContainer().pivot=new PIXI.Point(f,g);d.pixiContainer.setScaleModifier(new t(e,e))}},__class__:oc});var gg=function(a,b,c,d,e,f){null==f&&(f=1);this.muteXMovement=
this.muteYMovement=!1;this.zoomModifier=1;this.originX=this.originY=0;this.parallaxX=this.parallaxY=1;this.pixiContainer=a;this.parallaxX=b;this.parallaxY=c;this.originX=d;this.originY=e;this.zoomModifier=f};gg.__name__=["f84","pixi","PixiCameraLayer"];gg.prototype={__class__:gg};var Da=function(a){this._isSetup=!1;O.call(this)};Da.__name__=["f84","pixi","PixiManager"];Da.getInstance=function(){null==Da._instance&&(Da._instance=new Da,n.getInstance().addManager(Da._instance));return Da._instance};
Da.__super__=fa;Da.prototype=p(fa.prototype,{getWebGlEnabled:function(){return this._renderer.type==PIXI.RENDERER_TYPE.WEBGL},getStage:function(){return this._stage},getRenderer:function(){return this._renderer},setup:function(a){this._stage=new PIXI.Container;this._renderer=PIXI.autoDetectRenderer(n.getInstance().getGameSize().x,n.getInstance().getGameSize().y,a,!1);this._masterLayer=n.getInstance().getLayerByName("master");s.getContainer().appendChild(this._renderer.view);a=s.getDocument().createElement("div");
s.getContainer().appendChild(a);a.style.position="absolute";a.style.left="0px";a.style.top="0px";a.style.width="1024px";a.style.height="550px";this._isSetup=!0},render:function(){fa.prototype.render.call(this);this._isSetup&&(this._renderer.resize(n.getInstance().getGameSize().x,n.getInstance().getGameSize().y),this._renderer.render(this._stage))},handleMessage:function(a,b){fa.prototype.handleMessage.call(this,a,b);"onOrientationChanged"==a&&null!=this._renderer&&this._renderer.resize(n.getInstance().getGameSize().x,
n.getInstance().getGameSize().y)},__class__:Da});var hg=function(a,b,c,d){V.call(this,a);La.log("WARNING: Spine is not enabled. Set the SPINE preprocessor to enable this");a=H.getAsset(b);c=H.getAsset(c);this.generateSpine(a,c,d)};hg.__name__=["f84","pixi","PixiSpineAnimation"];hg.__super__=V;hg.prototype=p(V.prototype,{generateSpine:function(a,b,c){null!=this._spine&&(this._container.removeChild(this._spine),this._spine=null);a=JSON.parse(a);b=new PIXI.spine.core.TextureAtlas(b,function(a,b){b(PIXI.BaseTexture.fromImage(c+
a))},null);a=(new PIXI.spine.core.SkeletonJson(new PIXI.spine.core.AtlasAttachmentLoader(b))).readSkeletonData(a);this._spine=new PIXI.spine.Spine(a);this._container.addChild(this._spine);a=this._spine.getBounds();this._spine.position.set(-a.x,-a.y);this._spine.skeleton.setToSetupPose();this._spine.update(0)},setToSetupPose:function(){this._spine.skeleton.setToSetupPose()},setAnimation:function(a,b,c){null==c&&(c=0);null==b&&(b=!1);this._spine.state.setAnimation(c,a,b)},setSkinByName:function(a){this._spine.skeleton.setSkinByName(a)},
setSlotsToSetupPose:function(){this._spine.skeleton.setSlotsToSetupPose()},__class__:hg});var aa=function(a,b,c){V.call(this,a);this._container=new PIXI.Text(b,c);this.getText().anchor.x=0.5;this.getText().anchor.y=0.5};aa.__name__=["f84","pixi","PixiText"];aa.__super__=V;aa.prototype=p(V.prototype,{getText:function(){return this._container},getTextString:function(){return this.getText().text},setTextString:function(a){this.getText().text=a},init:function(){V.prototype.init.call(this)},destroy:function(){V.prototype.destroy.call(this);
this.getText().texture.baseTexture.destroy()},__class__:aa});var Mc=function(a,b,c,d,e,f,g,k){this._tint=16777215;this._width=this._height=0;V.call(this,a);this._container=new PIXI.Sprite(null);this._fromLeft=e;this._fromTop=f;this._fromRight=g;this._fromBottom=k;this._topLeft=new PIXI.Sprite(null);this._left=new PIXI.Sprite(null);this._bottomLeft=new PIXI.Sprite(null);this._top=new PIXI.Sprite(null);this._middle=new PIXI.Sprite(null);this._bottom=new PIXI.Sprite(null);this._topRight=new PIXI.Sprite(null);
this._right=new PIXI.Sprite(null);this._bottomRight=new PIXI.Sprite(null);this._container.addChild(this._topLeft);this._container.addChild(this._left);this._container.addChild(this._bottomLeft);this._container.addChild(this._top);this._container.addChild(this._middle);this._container.addChild(this._bottom);this._container.addChild(this._topRight);this._container.addChild(this._right);this._container.addChild(this._bottomRight);this.setImage(b);this.setWidth(c);this.setHeight(d)};Mc.__name__=["f84",
"pixi","SlicedSprite"];Mc.__super__=V;Mc.prototype=p(V.prototype,{getWidth:function(){return this._width},setWidth:function(a){this._width=a},getHeight:function(){return this._height},setHeight:function(a){this._height=a},getTint:function(){return this._tint},setTint:function(a){this._tint=a;this._top.tint=this._tint;this._topLeft.tint=this._tint;this._left.tint=this._tint;this._bottomLeft.tint=this._tint;this._bottom.tint=this._tint;this._bottomRight.tint=this._tint;this._right.tint=this._tint;this._topRight.tint=
this._tint;this._middle.tint=this._tint},getSprite:function(){return this._container},getImageId:function(){return this._imageId},setImage:function(a){if(H.assetExists(a)){if(this._imageId!=a){this._currentImageElement=H.getAsset(a);var b=PIXI.BaseTexture.fromImage(this._currentImageElement.src),c=b.width,b=b.height,d=PIXI.BaseTexture.fromImage(this._currentImageElement.src);this._topLeft.texture=new PIXI.Texture(d,new PIXI.Rectangle(0,0,this._fromLeft,this._fromTop));d=PIXI.BaseTexture.fromImage(this._currentImageElement.src);
this._left.texture=new PIXI.Texture(d,new PIXI.Rectangle(0,this._fromTop,this._fromLeft,b-this._fromBottom-this._fromTop));d=PIXI.BaseTexture.fromImage(this._currentImageElement.src);this._bottomLeft.texture=new PIXI.Texture(d,new PIXI.Rectangle(0,b-this._fromBottom,this._fromLeft,this._fromBottom));d=PIXI.BaseTexture.fromImage(this._currentImageElement.src);this._top.texture=new PIXI.Texture(d,new PIXI.Rectangle(this._fromLeft,0,c-this._fromRight-this._fromLeft,this._fromTop));d=PIXI.BaseTexture.fromImage(this._currentImageElement.src);
this._middle.texture=new PIXI.Texture(d,new PIXI.Rectangle(this._fromLeft,this._fromTop,c-this._fromRight-this._fromLeft,b-this._fromBottom-this._fromTop));d=PIXI.BaseTexture.fromImage(this._currentImageElement.src);this._bottom.texture=new PIXI.Texture(d,new PIXI.Rectangle(this._fromLeft,b-this._fromBottom,c-this._fromRight-this._fromLeft,this._fromBottom));d=PIXI.BaseTexture.fromImage(this._currentImageElement.src);this._topRight.texture=new PIXI.Texture(d,new PIXI.Rectangle(c-this._fromRight,0,
this._fromRight,this._fromTop));d=PIXI.BaseTexture.fromImage(this._currentImageElement.src);this._right.texture=new PIXI.Texture(d,new PIXI.Rectangle(c-this._fromRight,this._fromTop,this._fromRight,b-this._fromBottom-this._fromTop));d=PIXI.BaseTexture.fromImage(this._currentImageElement.src);this._bottomRight.texture=new PIXI.Texture(d,new PIXI.Rectangle(c-this._fromRight,b-this._fromBottom,this._fromRight,this._fromBottom))}this._imageId=a}this.updateTransforms()},onActivate:function(){V.prototype.onActivate.call(this);
this._top.renderable=!0;this._topRight.renderable=!0;this._right.renderable=!0;this._bottomRight.renderable=!0;this._bottom.renderable=!0;this._bottomLeft.renderable=!0;this._left.renderable=!0;this._topLeft.renderable=!0;this._middle.renderable=!0},onDeactivate:function(){V.prototype.onDeactivate.call(this);this._topRight.renderable=!1;this._right.renderable=!1;this._bottomRight.renderable=!1;this._bottom.renderable=!1;this._bottomLeft.renderable=!1;this._left.renderable=!1;this._topLeft.renderable=
!1;this._middle.renderable=!1},update:function(){V.prototype.update.call(this);this._top.x=0;this._top.y=0.5*-this._height+this._fromTop;this._top.anchor.x=0.5;this._top.anchor.y=1;this._top.width=this._width-this._fromLeft-this._fromRight;this._middle.x=0;this._middle.y=0;this._middle.anchor.x=0.5;this._middle.anchor.y=0.5;this._middle.width=this._width-this._fromLeft-this._fromRight;this._middle.height=this._height-this._fromTop-this._fromBottom;this._bottom.x=0;this._bottom.y=0.5*this._height-
this._fromBottom;this._bottom.anchor.x=0.5;this._bottom.anchor.y=0;this._bottom.width=this._width-this._fromLeft-this._fromRight;this._topLeft.x=0.5*-this._width+this._fromLeft;this._topLeft.y=0.5*-this._height+this._fromTop;this._topLeft.anchor.x=1;this._topLeft.anchor.y=1;this._left.x=0.5*-this._width+this._fromLeft;this._left.y=0;this._left.anchor.x=1;this._left.anchor.y=0.5;this._left.height=this._height-this._fromTop-this._fromBottom;this._bottomLeft.x=0.5*-this._width+this._fromLeft;this._bottomLeft.y=
0.5*this._height-this._fromBottom;this._bottomLeft.anchor.x=1;this._bottomLeft.anchor.y=0;this._topRight.x=0.5*this._width-this._fromRight;this._topRight.y=0.5*-this._height+this._fromTop;this._topRight.anchor.x=0;this._topRight.anchor.y=1;this._right.x=0.5*this._width-this._fromRight;this._right.y=0;this._right.anchor.x=0;this._right.anchor.y=0.5;this._right.height=this._height-this._fromTop-this._fromBottom;this._bottomRight.x=0.5*this._width-this._fromRight;this._bottomRight.y=0.5*this._height-
this._fromBottom;this._bottomRight.anchor.x=0;this._bottomRight.anchor.y=0;this._container.x=0.5*this._width;this._container.y=0.5*this._height},fixedUpdate:function(){V.prototype.fixedUpdate.call(this)},render:function(){V.prototype.render.call(this)},destroy:function(){V.prototype.destroy.call(this)},__class__:Mc});var Oa=function(a,b,c){null==c&&(c=!0);X.call(this);this._from=a;this._to=b;this._destroyFrom=c;v.playSoundByName("transition_1")};Oa.__name__=["f84","screenTransition","TransitionScreen"];
Oa.__super__=X;Oa.prototype=p(X.prototype,{onTransitionMidpoint:function(){this._destroyFrom&&this._from.destroy();n.getInstance().addGameState(this._to);this.dispatchEvent(new vc("midpoint"))},onTransitionComplete:function(){this.destroy();this.dispatchEvent(new vc("complete"))},__class__:Oa});var vc=function(a){this._type=a};vc.__name__=["f84","screenTransition","TransitionScreenEvent"];vc.__super__=J;vc.prototype=p(J.prototype,{__class__:vc});var Fb=function(){this.layers=[];this.ul=new t;this.wh=
new t};Fb.__name__=["f84","shapes","Shape"];Fb.prototype={hasLayer:function(a){for(var b=0,c=this.layers.length;b<c;){var d=b++;if(this.layers[d]==a)return!0}return!1},getClone:function(){var a=new Fb;a.ul=this.ul.getClone();a.wh=this.wh.getClone();for(var b=0,c=this.layers.length;b<c;){var d=b++;a.layers.push(this.layers[d])}return a},checkPointIntersect:function(a){return!1},getRaycastPoint:function(a,b,c,d,e){return-1},__class__:Fb};var Ea=function(){Fb.call(this)};Ea.__name__=["f84","shapes",
"BoxShape"];Ea.__super__=Fb;Ea.prototype=p(Fb.prototype,{checkPointIntersect:function(a){Fb.prototype.checkPointIntersect.call(this,a);return a.x>=this.ul.x&&a.y>=this.ul.y&&a.x<=this.ul.x+this.wh.x?a.y<=this.ul.y+this.wh.y:!1},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);e=new t;for(var f=[new t(this.ul.x,this.ul.y),new t(this.ul.x+this.wh.x,this.ul.y),new t(this.ul.x+this.wh.x,this.ul.y+this.wh.y),new t(this.ul.x,this.ul.y+this.wh.y)],g=-1,k=0,h=f.length-1;k<h;){var m=k++,m=ja.lineIntersect2D(a,
b,f[m],f[m+1],e);if(0<m)if(d){if(-1==g||m<g)c.x=e.x,c.y=e.y,g=m}else return c.x=e.x,c.y=e.y,m}a=ja.lineIntersect2D(a,b,f[0],f[f.length-1],e);if(0<a)if(d){if(-1==g||a<g)c.x=e.x,c.y=e.y,g=a}else return c.x=e.x,c.y=e.y,a;return g},getBoxIntersect:function(a){return 2*Math.abs(this.ul.x-a.ul.x)<this.wh.x+a.wh.x?2*Math.abs(this.ul.y-a.ul.y)<this.wh.y+a.wh.y:!1},getClone:function(){return null},__class__:Ea});var ig=function(){this._lowestPoint=this._highestPoint=null;Fb.call(this);this._lowestPoint=new t(999999,
999999);this._highestPoint=new t(-999999,-999999);this._points=[]};ig.__name__=["f84","shapes","PolygonShape"];ig.__super__=Fb;ig.prototype=p(Fb.prototype,{addPoint:function(a,b){this._points.push(new t(a,b));a<this._lowestPoint.x&&(this._lowestPoint.x=a);b<this._lowestPoint.y&&(this._lowestPoint.y=b);a>this._highestPoint.x&&(this._highestPoint.x=a);b>this._highestPoint.y&&(this._highestPoint.y=b)},getPoints:function(){return this._points},checkPointIntersect:function(a){for(var b=this._points.length,
c=0,d=!1,e=null,f=null;c<b;){e=this._points[c].getClone();f=this._points[(c+1)%b].getClone();e.x+=this.ul.x;e.y+=this.ul.y;f.x+=this.ul.x;f.y+=this.ul.y;if(0==c)d=0<(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y);else if(d&&0>(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y)||!d&&0<(a.y-e.y)*(f.x-e.x)-(a.x-e.x)*(f.y-e.y))return!1;++c}return!0},getRaycastPoint:function(a,b,c,d,e){null==d&&(d=!1);var f=new Mb;f.ul=this._lowestPoint.getClone();f.wh=new t(this._highestPoint.x-this._lowestPoint.x,this._highestPoint.y-this._lowestPoint.y);
f.ul.x+=this.ul.x;f.ul.y+=this.ul.y;var g=Math.abs(b.x-a.x),k=Math.abs(b.y-a.y),g=new Mb(a.x<b.x?a.x:b.x,a.y<b.y?a.y:b.y,g,k);if(!f.getIntersect(g))return-1;for(var f=new t,k=this._points,g=-1,h=0,m=k.length-1;h<m;){var l=h++,n=k[l].getClone();n.x+=this.ul.x;n.y+=this.ul.y;var p=k[l+1].getClone();p.x+=this.ul.x;p.y+=this.ul.y;l=ja.lineIntersect2D(a,b,n,p,f);if(0<l)if(d){if(-1==g||l<g)c.x=f.x,c.y=f.y,null!=e&&(g=(new t(p.y-n.y,n.x-p.x)).getNormalized(),e.x=g.x,e.y=g.y,0<(new t(b.x-a.x,b.y-a.y)).dotProduct(e)&&
(e.x*=-1,e.y*=-1)),g=l}else return c.x=f.x,c.y=f.y,null!=e&&(c=(new t(p.y-n.y,n.x-p.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new t(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),l}h=k[0].getClone();h.x+=this.ul.x;h.y+=this.ul.y;m=k[k.length-1].getClone();m.x+=this.ul.x;m.y+=this.ul.y;k=ja.lineIntersect2D(a,b,h,m,f);if(0<k)if(d){if(-1==g||k<g)c.x=f.x,c.y=f.y,null!=e&&(c=(new t(m.y-h.y,h.x-m.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new t(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),g=k}else return c.x=
f.x,c.y=f.y,null!=e&&(c=(new t(m.y-h.y,h.x-m.x)).getNormalized(),e.x=c.x,e.y=c.y,0<(new t(b.x-a.x,b.y-a.y)).dotProduct(e)&&(e.x*=-1,e.y*=-1)),k;return g},getClone:function(){return null},__class__:ig});var jg=function(a){this.soundName=a;this.subtitles=[]};jg.__name__=["f84","speechManager","Dialogue"];jg.prototype={__class__:jg};var fc=function(a,b){null==b&&(b=!0);null==a&&(a=!0);this._voTrack=this._speechMap=this._currentDeferredActions=null;O.call(this);this._speechMap=new kg;this._voiceOversEnabled=
a;this._subtitlesEnabled=b;this._currentDeferredActions=[];fc._instance=this};fc.__name__=["f84","speechManager","SpeechManager"];fc.getInstance=function(){return fc._instance};fc.__super__=fa;fc.prototype=p(fa.prototype,{getVoiceOversEnabled:function(){return this._voiceOversEnabled},setVoiceOversEnabled:function(a){this._voiceOversEnabled=a},getSubtitlesEnabled:function(){return this._subtitlesEnabled},setSubtitlesEnabled:function(a){this._subtitlesEnabled=a},init:function(){fa.prototype.init.call(this)},
setup:function(){this.parseSpeechMap()},parseSpeechMap:function(){for(var a=E.parse(H.getAsset("speechMap")).elementsNamed("speech_map").next().elementsNamed("dialogue");a.hasNext();){for(var b=a.next(),c=new jg(b.get("soundName")),b=b.elementsNamed("subtitle");b.hasNext();){var d=b.next(),d=new lg(d.get("stringId"),parseFloat(d.get("time")),parseFloat(d.get("duration")));c.subtitles.push(d)}this._speechMap.dialogue.push(c)}},stopVo:function(){null!=this._voTrack&&(this._voTrack.stop(),this._voTrack=
null)},playVo:function(a){var b=this;null!=this._voTrack&&this.stopVo();if("0"==Y.getProperty("speechMode")||"2"==Y.getProperty("speechMode"))this._voTrack=v.playSoundByName(a);if("1"==Y.getProperty("speechMode")||"2"==Y.getProperty("speechMode")){var c=this._speechMap.getDialogueBySoundName(a);if(null!=c){for(;0<this._currentDeferredActions.length;)a=this._currentDeferredActions.pop(),n.getInstance().destroyDeferredAction(a);a=0;for(var d=c.subtitles.length;a<d;){var e=a++,e=[c.subtitles[e]];this._currentDeferredActions.push(n.getInstance().invokeAsyncDeferredAction(e[0].time,
function(a){return function(){b.dispatchSubtitle(a[0])}}(e)))}}else La.log("WARNING: '"+a+"' has no subtitles.")}return this._voTrack},dispatchSubtitle:function(a){this.dispatchEvent(new md("showSubtitle",a.duration,U.getString(a.stringId)))},__class__:fc});var kg=function(){this.dialogue=[]};kg.__name__=["f84","speechManager","SpeechMap"];kg.prototype={getDialogueBySoundName:function(a){for(var b=0,c=this.dialogue.length;b<c;){var d=b++;if(this.dialogue[d].soundName==a)return this.dialogue[d]}return null},
__class__:kg};var lg=function(a,b,c){this.stringId=a;this.time=b;this.duration=c};lg.__name__=["f84","speechManager","Subtitle"];lg.prototype={__class__:lg};var md=function(a,b,c){this._duration=0;this._type=a;this._duration=b;this._subtitleText=c};md.__name__=["f84","speechManager","SubtitleEvent"];md.__super__=J;md.prototype=p(J.prototype,{getDuration:function(){return this._duration},getSubtitleText:function(){return this._subtitleText},__class__:md});var qe=function(a,b,c,d){this._name=a;this._coords=
b.getClone();this._spriteSheetName=c;null==d||isNaN(d.x)&&isNaN(d.y)?this._offset=new t:this._offset=new t(d.x,d.y)};qe.__name__=["f84","spriteSheets","SpriteInfo"];qe.prototype={getCoords:function(){return this._coords},setOffset:function(a,b){this._offset.x=a;this._offset.y=b},getOffset:function(){return this._offset},getSpriteSheetName:function(){return this._spriteSheetName},getName:function(){return this._name},__class__:qe};var qc=function(a,b){this._image=null;this._spriteInfo=[];this._spriteInfoHashTable=
new Pa;this._name=a;null==b?this._imageName=a:(this._imageName=b,this._image=H.getAsset(this._imageName))};qc.__name__=["f84","spriteSheets","SpriteSheet"];qc.parseFromXmlString=function(a,b,c){c=E.parse(c);b=new qc(a,b);for(c=c.elementsNamed("TextureAtlas").next().elementsNamed("sprite");c.hasNext();){var d=c.next(),d=new qe(d.get("n"),new Mb(parseFloat(d.get("x")),parseFloat(d.get("y")),parseFloat(d.get("w")),parseFloat(d.get("h"))),a,new t(parseFloat(d.get("oX")),parseFloat(d.get("oY"))));b.addSpriteInfo(d)}ab.getInstance().registerSpriteSheet(b);
return b};qc.prototype={getNumSprites:function(){return this._spriteInfo.length},getName:function(){return this._name},getImage:function(){return this._image},getImageName:function(){return this._imageName},addSpriteInfo:function(a){this._spriteInfo.push(a);var b=this._spriteInfoHashTable,c=a.getName();null!=ba[c]?b.setReserved(c,a):b.h[c]=a},getSpriteInfoByIndex:function(a){return this._spriteInfo[a]},getSpriteInfoByName:function(a){var b=this._spriteInfoHashTable;return null!=ba[a]?b.getReserved(a):
b.h[a]},addToAllOffsets:function(a,b){for(var c=0,d=this._spriteInfo.length;c<d;){var e=c++,e=this._spriteInfo[e];e.setOffset(e.getOffset().x+a,e.getOffset().y+b)}},__class__:qc};var ab=function(){this._spriteSheets=new Pa};ab.__name__=["f84","spriteSheets","SpriteSheetManager"];ab.getInstance=function(){null==ab._instance&&(ab._instance=new ab);return ab._instance};ab.createSpriteSheetFromGrid=function(a,b,c,d,e){var f=H.getAsset(a),g=Math.floor(f.width/c),f=Math.floor(f.height/d);b=new qc(a,b);
for(var k=0;k<f;)for(var h=k++,m=0,l=g;m<l;){var n=m++,n=new qe(a+n+"-"+h,new Mb(n*c,h*d,c,d),a,e);b.addSpriteInfo(n)}ab.getInstance().registerSpriteSheet(b)};ab.prototype={addToAllSpriteSheetOffsets:function(a,b,c){this.getSpriteSheetByName(a).addToAllOffsets(b,c)},getSpriteSheetByName:function(a){var b=this._spriteSheets;return null!=ba[a]?b.getReserved(a):b.h[a]},registerSpriteSheet:function(a){var b=this._spriteSheets,c=a.getName();null!=ba[c]?b.setReserved(c,a):b.h[c]=a},removeSpriteSheetByName:function(a){this._spriteSheets.remove(a)},
removeAllSpriteSheets:function(){this._spriteSheets=new Pa},__class__:ab};var re=function(a){l.call(this,a)};re.__name__=["f84","ui","KeepUiPanelCentered"];re.__super__=l;re.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this._uiPanel=this.getEntity().getComponent(Nc)},update:function(){l.prototype.update.call(this);var a=n.getInstance().getGameSize(),b=a.getClone();a.x*=n.getInstance().getScreenScale().x;a.y*=n.getInstance().getScreenScale().y;this.getEntity().setPosition(b.x/
2,b.y/2);this._uiPanel.setSize(new t(a.x,a.y))},__class__:re});var Ob=function(a,b){l.call(this,a);this._size=b};Ob.__name__=["f84","ui","ScaleBackgroundToWindow"];Ob.__super__=l;Ob.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);if(null==this._size){var a=this.getComponent(A);this._size=null!=a?new t(a.getSprite().texture.baseTexture.width,a.getSprite().texture.baseTexture.height):new t}this._uiElement=this.getComponent(S)},update:function(){l.prototype.update.call(this);if(n.isMobile()){var a=
n.getInstance().getScreenScale(),b=s.getWindow().innerWidth/this._size.x,c=s.getWindow().innerHeight/this._size.y,b=Math.max(b,c),b=b/a.x;null!=this._uiElement?this._uiElement.setScale(b,b):this.getEntity().setScale(b,b)}},__class__:Ob});var va={__ename__:!0,__constructs__:["Left","Center","Right"],Left:["Left",0]};va.Left.__enum__=va;va.Center=["Center",1];va.Center.__enum__=va;va.Right=["Right",2];va.Right.__enum__=va;va.__empty_constructs__=[va.Left,va.Center,va.Right];var wa={__ename__:!0,__constructs__:["Top",
"Center","Bottom"],Top:["Top",0]};wa.Top.__enum__=wa;wa.Center=["Center",1];wa.Center.__enum__=wa;wa.Bottom=["Bottom",2];wa.Bottom.__enum__=wa;wa.__empty_constructs__=[wa.Top,wa.Center,wa.Bottom];var S=function(a,b){this._updateEveryFrame=!0;this._positionDirty=this._pixelPerfect=!1;this._uiPanel=this._coords=this._size=this._scale=null;l.call(this,a);this.setUiPanel(b);this._coords=new t(0,0);this._scale=new t(1,1);this._horizontalAlignment=va.Center;this._verticalAlignment=wa.Center};S.__name__=
["f84","ui","UiElement"];S.__super__=l;S.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);if(null==this._size){var a=this.getComponent(A);null!=a?this.setSize(new t(a.getSprite().width,a.getSprite().height)):this.setSize(new t(0,0))}this.updateDisplay()},getScaleRef:function(){return this._scale},getSize:function(){return this._size},getPixelPerfect:function(){return this._pixelPerfect},setPixelPerfect:function(a){this._pixelPerfect=a},setSize:function(a){null==this._size&&(this._size=
new t);this._size.x=a.x;this._size.y=a.y},getUiPanel:function(){return this._uiPanel},setScale:function(a,b){null==b&&(b=1);null==a&&(a=1);this._scale=new t(a,b);this.updateDisplay()},setUiPanel:function(a){null!=this._uiPanel&&this._uiPanel.removeEventListener("updateDisplay",q(this,this.onUiPanelUpdateDisplay));this._uiPanel=a;this._uiPanel.addEventListener("updateDisplay",q(this,this.onUiPanelUpdateDisplay));this._uiPanel.getEntity().addChild(this.getEntity())},getHorizontalAlignment:function(){return this._horizontalAlignment},
setHorizontalAlignment:function(a){this._horizontalAlignment=a;this._positionDirty=!0},getVerticalAlignment:function(){return this._verticalAlignment},setVerticalAlignment:function(a){this._verticalAlignment=a;this._positionDirty=!0},getCoords:function(){return this._coords},getCoordsRef:function(){return this._coords},setCoords:function(a){this._coords=a},setAlignment:function(a,b){this.setHorizontalAlignment(a);this.setVerticalAlignment(b)},update:function(){l.prototype.update.call(this)},postUpdate:function(){l.prototype.postUpdate.call(this);
(this._positionDirty||this._updateEveryFrame)&&this.updateDisplay()},onUiPanelUpdateDisplay:function(){this._positionDirty=!0},updateDisplay:function(){s.getWindow();this._uiPanel.getSize();n.getInstance().getGameSize();this._uiPanel.getSize();n.getInstance().getGameSize();var a=this._uiPanel.getSize().x/2*this._coords.x,b=this._uiPanel.getSize().y/2*this._coords.y;this._pixelPerfect?this.getEntity().setLocalScale(this._scale.x,this._scale.y):this.getEntity().setLocalScale(this._scale.x/this._uiPanel.getEntity().getScale().x,
this._scale.y/this._uiPanel.getEntity().getScale().y);if(null!=this._size){var c=this._size.getClone();switch(this._horizontalAlignment[1]){case 0:a+=c.x/2/this._uiPanel.getEntity().getScale().x;break;case 2:a-=c.x/2/this._uiPanel.getEntity().getScale().x}switch(this._verticalAlignment[1]){case 0:b+=c.y/2/this._uiPanel.getEntity().getScale().y;break;case 2:b-=c.y/2/this._uiPanel.getEntity().getScale().y}}this.getEntity().setLocalPosition(a,b,0);this._positionDirty=!1},debugRender:function(){l.prototype.debugRender.call(this);
if(null!=this._size){var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();var b=this.getEntity().getPosition();a.beginPath();a.lineWidth=1;a.strokeStyle="#0000FF";a.moveTo(b.x-this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y-this._size.y/2);a.stroke();a.restore()}},__class__:S});var Nc=function(a,b){l.call(this,
a);this._size=b;this._window=s.getWindow()};Nc.__name__=["f84","ui","UiPanel"];Nc.__super__=l;Nc.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this.setSize(this._size)},getSize:function(){return this._size},setSize:function(a){this._size=a;this.updateDisplay()},updateDisplay:function(){this.dispatchEvent(new nd("updateDisplay"));this.getEntity().setLocalScale(1/n.getInstance().getScreenScale().x,1/n.getInstance().getScreenScale().y,1)},debugRender:function(){l.prototype.debugRender.call(this);
var a=n.getInstance().getLayerByName("debug").getCanvas().getContext("2d");a.save();var b=this.getEntity().getPosition();a.beginPath();a.lineWidth=1;a.strokeStyle="#FF0000";a.moveTo(b.x-this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y-this._size.y/2);a.lineTo(b.x+this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y+this._size.y/2);a.lineTo(b.x-this._size.x/2,b.y-this._size.y/2);a.stroke();a.restore()},__class__:Nc});var nd=function(a){this._type=a};nd.__name__=["f84",
"ui","UiPanelEvent"];nd.__super__=J;nd.prototype=p(J.prototype,{__class__:nd});var mg=function(a,b,c){null==c&&(c=!0);this._constrainToGameSize=!0;this._prevWidth=this._prevHeight=0;this._uiPanel=this._window=null;l.call(this,a);this._uiPanel=b;this._window=s.getWindow();this._constrainToGameSize=c};mg.__name__=["f84","ui","UiPanelSizeToWindow"];mg.__super__=l;mg.prototype=p(l.prototype,{update:function(){l.prototype.update.call(this);var a=this._window.innerWidth,b=this._window.innerHeight,c=n.getInstance().getGameSize();
c.x*=n.getInstance().getScreenScale().x;c.y*=n.getInstance().getScreenScale().y;this._constrainToGameSize&&(a>c.x&&(a=c.x),b>c.y&&(b=c.y));this._prevWidth==a&&this._prevHeight==b&&"NONE"==Y.getProperty("forceOrientation")||this._uiPanel.setSize(new t(a,b));this.getEntity().setLocalPosition(n.getInstance().getGameSize().x/2,n.getInstance().getGameSize().y/2,0);this._prevWidth=a;this._prevHeight=b},__class__:mg});var bc=function(){};bc.__name__=["f84","utilities","ArrayUtils"];bc.indexOf=function(a,
b){for(var c=0,d=a.length;c<d;){var e=c++;if(a[e]==b)return e}return-1};bc.clear=function(a){a.length=0};bc.prototype={__class__:bc};var La=function(){};La.__name__=["f84","utilities","Debug"];La.log=function(a){};La.alert=function(a){};var ja=function(){};ja.__name__=["f84","utilities","Math2"];ja.degToRad=function(a){return 0.0174532925*a};ja.radToDeg=function(a){return 57.2957795*a};ja.randomFloat=function(a,b){return a+Math.random()*(b-a)};ja.randomInt=function(a,b){return Math.floor(ja.randomFloat(a,
b))};ja.getClosestPointOnSegment=function(a,b,c){b=new t(b.x-a.x,b.y-a.y);c=(new t(c.x-a.x,c.y-a.y)).dotProduct(b)/b.dotProduct(b);0>c&&(c=0);1<c&&(c=1);c=new t(b.x*c,b.y*c);return new t(a.x+c.x,a.y+c.y)};ja.lineIntersect2D=function(a,b,c,d,e){var f=(b.x-a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x),g=(b.x-a.x)*(d.y-c.y)-(b.y-a.y)*(d.x-c.x);if(0==f||0==g)return-2;d=((a.y-c.y)*(d.x-c.x)-(a.x-c.x)*(d.y-c.y))/f;c=((a.y-c.y)*(b.x-a.x)-(a.x-c.x)*(b.y-a.y))/g;return 0<d&&1>d&&0<c&&1>c?(c=(new t(a.x-b.x,a.y-b.y)).getLength()*
d,b=new t(b.x-a.x,b.y-a.y),b.scaleBy(d,d),b=new t(a.x+b.x,a.y+b.y),e.x=b.x,e.y=b.y,c):-1};ja.clamp=function(a,b,c){return a<b?b:a>c?c:a};ja.getRotated2dVector=function(a,b){var c=ja.degToRad(b),d=Math.cos(c),c=Math.sin(c),e=new t(a.x,a.y),f=e.x*c+e.y*d;e.x=e.x*d-e.y*c;e.y=f;return e};ja.getAngleInDegreesBetween2dVectors=function(a,b){return ja.radToDeg(Math.atan2(a.x*b.y-a.y*b.x,a.dotProduct(b)))};var id=function(a){this._value=null;this._eventListeners=[];this._value=a};id.__name__=["f84","utilities",
"WatchableValue"];id.__super__=Ca;id.prototype=p(Ca.prototype,{set:function(a){var b=this._value;this._value=a;this._value!=b&&this.dispatchEvent(new od("change",this._value,b))},get:function(){return this._value},__class__:id});var od=function(a,b,c){this._type=a;this.value=b;this.oldValue=c};od.__name__=["f84","utilities","WatchableValueEvent"];od.__super__=J;od.prototype=p(J.prototype,{__class__:od});var se=function(){this._entries=null;this._entries=[]};se.__name__=["f84","weightedVector","WeightedArray"];
se.prototype={addEntry:function(a,b){var c=new ng(a,b);this._entries.push(c);return c},getRandomValue:function(a){null==a&&(a=!1);for(var b=0,c=this._entries.length,d=0;d<c;)var e=d++,b=b+this._entries[e].weight;b=ja.randomFloat(0,b);for(e=d=0;e<c;){var f=e++,g=this._entries[f],d=d+g.weight;if(d>=b)return a&&this._entries.splice(f,1),g.value}return null},clear:function(){this._entries=[]},__class__:se};var ng=function(a,b){this.weight=a;this.value=b};ng.__name__=["f84","weightedVector","WeightedArrayEntry"];
ng.prototype={__class__:ng};var fb=function(a,b){Oa.call(this,a,b)};fb.__name__=["game","FadeTransition"];fb.doTransition=function(a,b){var c=new fb(a,b);n.getInstance().addGameState(c)};fb.doMidpointTransition=function(a,b,c){a=new fb(a,b);a.addEventListener("midpoint",c);n.getInstance().addGameState(a)};fb.__super__=Oa;fb.prototype=p(Oa.prototype,{init:function(){var a=this;Oa.prototype.init.call(this);ea.getInstance().setInputDisabled(!0);var b=this.addEntity();b.setLocalPosition(512,384,0);this._pixiSprite=
new A(b,"blackSquare");this._pixiSprite.getSprite().anchor.x=0.5;this._pixiSprite.getSprite().anchor.y=0.5;b.setLocalScale(200,200,1);this._tweener=new I(b);this._tweener.addTween(this._pixiSprite.getSprite(),"alpha",0,1,0.2,B.linear,0,function(){a.onTransitionMidpoint()});this._tweener.addTween(this._pixiSprite.getSprite(),"alpha",1,0,0.2,B.linear,0.25,function(){a.onTransitionComplete()})},render:function(){Oa.prototype.render.call(this);null!=this._pixiSprite&&this._pixiSprite.bringToFront()},
update:function(){Oa.prototype.update.call(this);F.remove(n.getInstance().getGameStates(),this);n.getInstance().getGameStates().push(this)},onTransitionMidpoint:function(){Oa.prototype.onTransitionMidpoint.call(this);ea.getInstance().setInputDisabled(!1)},__class__:fb});var da=function(){this._isJerryDead=!1;this._currentLevelNumber=1;this._eventListeners=[];da._instance=this;this._saveData=new cg};da.__name__=["game","GameTracker"];da.getInstance=function(){null==da._instance&&(da._instance=new da);
return da._instance};da.getScoreSaveKeyForLevel=function(a){return"levelScore"+(null==a?"null":""+a)};da.__super__=Ca;da.prototype=p(Ca.prototype,{getSaveData:function(){return this._saveData},getIsJerryDead:function(){return this._isJerryDead},setIsJerryDead:function(a){this._isJerryDead=a},getNumLevels:function(){return z.get_instance().get_levelsConfig().numStages},getBackgroundUnlocked:function(a){a=z.get_instance().get_levelsConfig().backgroundLevelRequirements[a-1];return this.getHighestLevel()>=
a},getHighestBackgroundUnlocked:function(){for(var a=z.get_instance().get_levelsConfig().backgroundLevelRequirements.length,b=0;b<a;){var c=b++;if(!this.getBackgroundUnlocked(c+1))return c}return a},getHighestLevel:function(){return this.getSaveData().getItem("highestLevel",0)},setHighestLevel:function(a){this.getSaveData().setItem("highestLevel",Math.max(this.getHighestLevel(),a))},hasSeenTutorial:function(){return this.getSaveData().getItem("seenTutorial",!1)},setSeenTutorial:function(a){this.getSaveData().setItem("seenTutorial",
a)},setScoreForLevel:function(a,b){a>this.getScoreForLevel(b)&&this.getSaveData().setItem(da.getScoreSaveKeyForLevel(b),a)},getScoreForLevel:function(a){return this.getSaveData().getItem(da.getScoreSaveKeyForLevel(a),0)},setScoreForCurrentLevel:function(a){this.setScoreForLevel(a,this._currentLevelNumber)},setCurrentLevelNumber:function(a){this._currentLevelNumber=a},getCurrentLevelNumber:function(){return this._currentLevelNumber},getHasBeatenGame:function(){return this.getSaveData().getItem("hasBeatenGame",
!1)},setHasBeatenGame:function(a){this.getSaveData().setItem("hasBeatenGame",a)},getHasStartedGame:function(){return this.getSaveData().getItem("hasStartedGame",!1)},setHasStartedGame:function(a){this.getSaveData().setItem("hasStartedGame",a)},addHighScore:function(a){var b=this.getHighScores();b.push(a);b.sort(function(a,b){return a>b?-1:a<b?1:0});a=[];for(var c=0,d=Math.min(z.get_instance().get_leaderboardConfig().numEntries,b.length)|0;c<d;){var e=c++;a.push(b[e])}this._saveData.setItem("highScores",
a.join(","))},getHighScores:function(){for(var a=this._saveData.getItem("highScores",""),a=(null==a?"null":""+a).split(","),b=[],c=0,d=z.get_instance().get_leaderboardConfig().numEntries;c<d;){var e=c++;e>a.length||""==a[e]||null==a[e]?b.push(0):b.push(pa.parseInt(a[e]))}return b},__class__:da});var Fa=function(a,b){Oa.call(this,a,b)};Fa.__name__=["game","TomAndJerryTransition"];Fa.doTransition=function(a,b){var c=z.get_instance().get_flowConfig().forceSimpleTransition?new fb(a,b):new Fa(a,b);n.getInstance().addGameState(c)};
Fa.doMidpointTransition=function(a,b,c){a=z.get_instance().get_flowConfig().forceSimpleTransition?new fb(a,b):new Fa(a,b);a.addEventListener("midpoint",c);n.getInstance().addGameState(a)};Fa.__super__=Oa;Fa.prototype=p(Oa.prototype,{init:function(){var a=this;Oa.prototype.init.call(this);ea.getInstance().setInputDisabled(!0);this._uiPanel=ya.createFullscreenUiPanel(this);this._pixiSprite=new V(this._uiPanel.getEntity());var b=this._uiPanel.addEntity();new S(b,this._uiPanel);new Ob(b,new t(1024,576));
this._left=b.addEntity();var c=new A(this._left,"wreathLeft");c.getSprite().anchor.x=1;c.getSprite().anchor.y=0.5;this._right=b.addEntity();b=new A(this._right,"wreathRight");b.getSprite().anchor.x=0;b.getSprite().anchor.y=0.5;this._tweener=new I(this._uiPanel.getEntity());this._tweener.addTween(this._left.getPositionRef(),"x",-1024,279,0.5,B.easeOutQuad,0,function(){a.onTransitionMidpoint()});this._tweener.addTween(this._right.getPositionRef(),"x",1024,-279,0.5,B.easeOutQuad,0);this._tweener.addTween(this._left.getPositionRef(),
"x",279,-1024,0.5,B.easeInQuad,1,function(){a.onTransitionComplete()});this._tweener.addTween(this._right.getPositionRef(),"x",-279,1024,0.5,B.easeInQuad,1)},render:function(){Oa.prototype.render.call(this);null!=this._pixiSprite&&this._pixiSprite.bringToFront()},update:function(){Oa.prototype.update.call(this);F.remove(n.getInstance().getGameStates(),this);n.getInstance().getGameStates().push(this)},onTransitionMidpoint:function(){Oa.prototype.onTransitionMidpoint.call(this);ea.getInstance().setInputDisabled(!1)},
__class__:Fa});var Od=function(){X.call(this)};Od.__name__=["game","boot","BootState"];Od.__super__=X;Od.prototype=p(X.prototype,{init:function(){X.prototype.init.call(this);this._root=n.getInstance();var a=new bb;this._root.addManager(a);a=new ea;this._root.addManager(a);var b=new ec;this._root.addManager(b);b=new uc;this._root.addManager(b);b=new fc;this._root.addManager(b);a.disablePageKeyPresses();this.initLayers();this.getAssetsList()},getAssetsList:function(){var a=new Ic;a.addAsset("assetList",
"asset_list.js",Z.Other);a.addAsset("strings","./locale/${locale}/strings.xml",Z.Other);a.addAsset("globalGameConfig","game_config.js",Z.Other);a.addAsset("gameConfig","./locale/${locale}/game_config.js",Z.Other);a.addAsset("styleCss","./locale/${locale}/css/style.css",Z.Css);a.addAsset("speechMap","./media/xml/speech_map.xml",Z.Other);a.addAsset("ipadOrientationImage","./media/images/system/orientation_ipad.png",Z.Image);a.addAsset("iphoneOrientationImage","./media/images/system/orientation_iphone.png",
Z.Image);a.load(q(this,this.onAssetListLoaded))},onAssetListLoaded:function(){Y.parseGameConfig(JSON.parse(H.getAsset("globalGameConfig")));Y.parseGameConfig(JSON.parse(H.getAsset("gameConfig")));if(n.isMobile()){var a=new te(n.getInstance().getGameWidth(),n.getInstance().getGameHeight());this._root.addManager(a)}n.getInstance().setGameWidth(Y.getProperty("gameWidth",1024));n.getInstance().setGameHeight(Y.getProperty("gameHeight",768));U.initStrings();fc.getInstance().setup();for(var a=JSON.parse(H.getAsset("assetList")),
b=0,c=a.loadBatches.length;b<c;){for(var d=b++,e=new Ic,d=a.loadBatches[d],f=0,g=d.assets.length;f<g;){var k=f++,k=d.assets[k],h=k.source.split("."),l=Z.Other;switch(h[h.length-1]){case "css":l=Z.Css;break;case "eot":case "ttf":case "woff":l=Z.Font;break;case "jpeg":case "jpg":case "png":l=Z.Image;break;case "js":l=Z.Other;break;case "mp3":case "wav":l=Z.Audio}e.addAsset(k.name,k.source,l)}H.registerAsset(d.name,e)}H.getAsset("loadScreenBatchPreload").load(q(this,this.onLoadScreenPreloadComplete))},
onLoadScreenPreloadComplete:function(){Da.getInstance().setup({backgroundColor:0});var a=H.getAsset("loadBatchPreload");this._loadingScreen=new Oc(a,!1);this._root.addGameState(this._loadingScreen);this._root.onResizeWindow();a.load(q(this,this.onPreloadComplete));if(n.isMobile()||"NONE"!=Y.getProperty("forceOrientation"))a=new ue,this._root.addGameState(a)},onPreloadComplete:function(){this.destroy();n.getInstance().addGameState(new Pb)},initLayers:function(){this._root.addLayer(new Lb("debug",n.getInstance().getGameWidth()|
0,n.getInstance().getGameHeight()|0))},__class__:Od});var gb=function(){this._eventListeners=[]};gb.__name__=["game","commands","Command"];gb.__super__=Ca;gb.prototype=p(Ca.prototype,{execute:function(){},onComplete:function(){this.dispatchEvent(new pd("complete"))},__class__:gb});var pd=function(a){this._type="complete"};pd.__name__=["game","commands","CommandEvent"];pd.__super__=J;pd.prototype=p(J.prototype,{__class__:pd});var qd=function(){this._eventListeners=[];this._sequence=[];this._commandsLeft=
[]};qd.__name__=["game","commands","CommandSequence"];qd.__super__=Ca;qd.prototype=p(Ca.prototype,{clear:function(){for(var a=0,b=this._commandsLeft.length;a<b;){var c=a++;this._commandsLeft[c].removeEventListener("complete",q(this,this.onCommandComplete))}this._commandsLeft=[];this._sequence=[]},addParallel:function(a){this._sequence.push(a)},addSequential:function(a){for(var b=0,c=a.length;b<c;){var d=b++;this.addCommand(a[d])}},addCommand:function(a){this._sequence.push([a])},execute:function(){console.log(this._sequence);
0<this._commandsLeft.length&&(console.log("Warning: Previous sequence never finished!"),console.log(this._commandsLeft),this._commandsLeft=[]);this.executeNextSequence()},executeNextSequence:function(){console.log("Executing Sequence...");if(0<this._sequence.length){var a=this._sequence[0];this._sequence.splice(0,1);this.executeSequence(a)}else this.dispatchEvent(new rd("complete"))},executeSequence:function(a){for(var b=0,c=a.length;b<c;){var d=b++,d=a[d];this._commandsLeft.push(d);d.addEventListener("complete",
q(this,this.onCommandComplete))}if(0==this._commandsLeft.length)this.executeNextSequence();else for(a=this._commandsLeft.length-1;0<=a;)this._commandsLeft[a].execute(),--a},onCommandComplete:function(a){a=a.target;console.log("Command Complete: "+sb.getClassName(null==a?null:C.getClass(a)));a.removeEventListener("complete",q(this,this.onCommandComplete));F.remove(this._commandsLeft,a);if(0==this._commandsLeft.length)this.onSequenceComplete()},onSequenceComplete:function(){console.log("onSequenceComplete()");
this.executeNextSequence()},__class__:qd});var rd=function(a){this._type=a};rd.__name__=["game","commands","CommandSequenceEvent"];rd.__super__=J;rd.prototype=p(J.prototype,{__class__:rd});var Qb=function(a,b){this._eventListeners=[];this._duration=b;this._deferredActionController=a};Qb.__name__=["game","commands","DelayCommand"];Qb.__super__=gb;Qb.prototype=p(gb.prototype,{execute:function(){gb.prototype.execute.call(this);this._deferredActionController.addDeferredAction(this._duration,q(this,this.onDelayElapse))},
onDelayElapse:function(){this.onComplete()},__class__:Qb});var og=function(a){this._eventListeners=[];this._text=a};og.__name__=["game","commands","LogCommand"];og.__super__=gb;og.prototype=p(gb.prototype,{execute:function(){gb.prototype.execute.call(this);console.log(this._text);this.onComplete()},__class__:og});var Pc=function(){};Pc.__name__=["game","dodgeGame","CharacterFactory"];Pc.createPlayer=function(a,b,c,d){a=a.addEntity();a.addTag("player");a.setLocalPosition(c,d);c=new Xa(a);c.set_characterConfig(z.get_instance().get_playerCharacterConfig());
c.get_damageStateMachine().setState(new ve(c));new sd(a,c);new td(a,c,b.get_gameplayContainer().get_items(),z.get_instance().get_playerConfig().itemCollectRadius);b=new Ea;b.wh=new t(100,100);new Ta(a,b);new Jc(a,["obstacle","tom"]);b=a.addEntity();new ua(b,"");(new Gb(a,"jerry")).playAnimation("Run");b=a.addEntity();(new ua(b,"jerryRunSmoke")).getSprite().alpha=0;da.getInstance().setIsJerryDead(!1);return a};Pc.createPlayerGhost=function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=new Ea;b.wh=
new t(100,100);new Ta(a,b);new Jc(a,["obstacle","tom"]);b=a.addEntity();b=new A(b,"player");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=a.addEntity(!0);b.setLocalPosition(0,-55);new aa(b,U.getString(n.isMobile()?"GAMEPLAY_TAP_TO_START":"GAMEPLAY_CLICK_TO_START"),{fontFamily:"curse_casualregular",fill:"#FFFFFF",fontSize:26});return a};Pc.createTom=function(a,b,c){a=a.addEntity();a.addTag("tom");a.setLocalPosition(b,c);new db(a);b=new Xa(a);b.set_characterConfig(z.get_instance().get_tomCharacterConfig());
b.get_damageStateMachine().setState(new we(b));b=new xe(a,b);b.get_stackStateMachine().pushState(new ye(b));b=new Ea;b.wh=new t(100,50);b=new Ta(a,b);new Jc(a,["trap"]);c=new gc(a);b.setOnEnter(q(c,c.onEnter));b.setOnExit(q(c,c.onExit));b=a.addEntity();new ua(b,"");b=new Gb(a,"tom");b.set_noUpDown(!0);b.set_noFlip(!0);b.playAnimation("Run");return a};var De=function(a){this._perfectRound=!0;l.call(this,a);this._commandSequence=new qd;this._deferredActionController=new Cb(this.getEntity());this._gameStats=
new ze;this._gameStats.set_numLives(z.get_instance().get_playerConfig().initialLives);this._gameStats.addEventListener("levelUp",q(this,this.onLevelUp));this._powerupController=new Ae(this.getEntity(),this);this._uiPanel=ya.createFullscreenUiPanel(this.getGameState());a=this.addEntity();new Ob(a,new t(1024,572));this._gameplayContainer=new Be(a,this);new S(a,this._uiPanel);a=this.addEntity();this._hud=new Ce(a,this);this._hud.addEventListener(hc.SHOW_MENU,q(this,this.onPauseButtonClick))};De.__name__=
["game","dodgeGame","DodgeGameController"];De.__super__=l;De.prototype=p(l.prototype,{get_deferredActionController:function(){return this._deferredActionController},get_itemSpawners:function(){return this._itemSpawners},get_hud:function(){return this._hud},get_uiPanel:function(){return this._uiPanel},get_gameStats:function(){return this._gameStats},get_gameplayContainer:function(){return this._gameplayContainer},get_powerupController:function(){return this._powerupController},get_perfectRound:function(){return this._perfectRound},
set_perfectRound:function(a){return this._perfectRound=a},init:function(){l.prototype.init.call(this);this.initAnimations();this.prepareGameplay();this._itemSpawners=[];var a=this.addEntity(),a=new Qc(a,this,[new Ee,new Fe,new Ge]);a.set_minNumItems(z.get_instance().get_levelsConfig().minNumCollectiblesPresent);a.set_minTimeUntilItemSpawn(z.get_instance().get_levelsConfig().minTimeUntilCollectibleSpawn);a.set_maxTimeUntilItemSpawn(z.get_instance().get_levelsConfig().maxTimeUntilCollectibleSpawn);
a.set_firstItemSpawnTimeOffset(z.get_instance().get_levelsConfig().firstCollectibleSpawnTimeOffset);a.set_minDistanceFromOtherSpawns(z.get_instance().get_levelsConfig().minSpawnDistanceFromOtherCollectibles);this._itemSpawners.push(a);a=this.addEntity();a=new Qc(a,this,[new He]);a.set_minNumItems(z.get_instance().get_levelsConfig().minNumPowerupsPresent);a.set_minTimeUntilItemSpawn(z.get_instance().get_levelsConfig().minTimeUntilPowerupSpawn);a.set_maxTimeUntilItemSpawn(z.get_instance().get_levelsConfig().maxTimeUntilPowerupSpawn);
a.set_firstItemSpawnTimeOffset(z.get_instance().get_levelsConfig().firstPowerupSpawnTimeOffset);this._itemSpawners.push(a);this.disableItemSpawners()},initAnimations:function(){ia.createAnimation("tomFrontRun","tomFrontRunXml",new t(-112,-120),1,!0);ia.createAnimation("tomSideRun","tomSideRunXml",new t(-112,-120),1,!0);ia.createAnimation("tomBackRun","tomBackRunXml",new t(-112,-120),1,!0);ia.createAnimation("tomDizzy","tomDizzyXml",new t(-111,-183),2,!0);ia.createAnimation("jerryFrontRun","jerryFrontRunXml",
new t(-29,-37),1,!0);ia.createAnimation("jerrySideRun","jerrySideRunXml",new t(-29,-37),1,!0);ia.createAnimation("jerryBackRun","jerryBackRunXml",new t(-29,-37),1,!0);ia.createAnimation("jerryHit","jerryHitXml",new t(-29,-37),2,!0);ia.createAnimation("jerryFrontPickup","jerryFrontPickupXml",new t(-29,-37),1,!0);ia.createAnimation("jerrySidePickup","jerrySidePickupXml",new t(-29,-37),1,!0);ia.createAnimation("jerryBackPickup","jerryBackPickupXml",new t(-29,-37),1,!0);ia.createAnimation("jerryRunSmoke",
"jerryRunSmokeXml",new t(0,0),1,!0);ia.createAnimation("gingerbreadman","gingerbreadmanXml",new t(-33,-80),2,!0);ia.createAnimation("carDown","carDownXml",new t(-43,-61),2,!0);ia.createAnimation("carUp","carUpXml",new t(-43,-61),2,!0);ia.createAnimation("santaBoxIdle","santaBoxIdleXml",new t(-90,-160),2,!0);ia.createAnimation("santaBoxActivated","santaBoxActivatedXml",new t(-90,-160),2,!1);ia.createAnimation("dogSpike","dogSpikeXml",new t(-104,-61),4,!0);ia.createAnimation("objectiveBurst","objectiveBurstXml",
new t(-62,-43),1,!0);ia.createAnimation("jerryRunSmoke","jerryRunSmokeXml",new t(-12,-12),10,!0);ia.createAnimation("gingerbreadmanSlingshotTop","gingerbreadmanSlingshotTopXml",new t(-66,-69),2,!1);ia.createAnimation("gingerbreadmanSlingshotBottom","gingerbreadmanSlingshotBottomXml",new t(-86,-82),2,!1)},enableItemSpawners:function(){for(var a=0,b=this._itemSpawners.length;a<b;){var c=a++;this._itemSpawners[c].setActive(!0)}},disableItemSpawners:function(){for(var a=0,b=this._itemSpawners.length;a<
b;){var c=a++;this._itemSpawners[c].setActive(!1)}},onPlayerDeath:function(){this._gameStats.set_numCollectiblesStreak(0);var a=this._gameStats,b=a.get_numLives();a.set_numLives(b-1);if(0>=this._gameStats.get_numLives())this.onPlayerLivesDeplete();else this.startPlayerGhostSpawn();this.enableItemSpawners()},prepareGameplay:function(){var a=this._gameplayContainer.getRandomEmptySpace();this._hud.getButtonGroup().setInputEnabled(!1);this._commandSequence.addCommand(new Qb(this._deferredActionController,
0.5*z.get_instance().get_flowConfig().enterGameplayDelay));this._commandSequence.addCommand(new Ie(this));this._commandSequence.addCommand(new Qb(this._deferredActionController,0.5*z.get_instance().get_flowConfig().enterGameplayDelay));this._commandSequence.addParallel([new Rc(this),new Sc(this,0,0),new ud(this,a.x,a.y),new vd(this,this._gameStats)]);this._commandSequence.execute()},startPlayerGhostSpawn:function(){this._commandSequence.addParallel([new Qb(this._deferredActionController,z.get_instance().get_flowConfig().delayBeforeRespawn)]);
this._commandSequence.addParallel([new Sc(this,0,0),new Rc(this)]);this._commandSequence.execute()},onPlayerLivesDeplete:function(){this._commandSequence.addParallel([new Qb(this._deferredActionController,z.get_instance().get_flowConfig().delayBeforeLevelComplete)]);this._commandSequence.addParallel([new Je(this),new Ke(this)]);this._commandSequence.execute()},respawnPlayer:function(a,b){this.dispatchEvent(new wd("startPlayerRespawn"));this._commandSequence.addParallel([new Le(this,a,b,!0)]);this._commandSequence.execute()},
nextRound:function(){this.disableItemSpawners();var a=da.getInstance().getHighestLevel(),b=this.get_gameStats().get_currentLevel()-1;this.get_gameStats().get_currentLevel();for(var c=-1,d=z.get_instance().get_levelsConfig().backgroundLevelRequirements,e=0,f=d.length;e<f;){var g=e++,k=d[g];if(!(k<a)&&b==k){c=g+1;this.get_gameStats().get_backgroundsUnlocked().push(g+1);break}}this._commandSequence.addParallel([new Qb(this._deferredActionController,z.get_instance().get_flowConfig().delayBeforeNextRound),
new xd(this,c),new Me(this)]);a=this._gameplayContainer.getRandomEmptySpace();this._commandSequence.addParallel([new Ne(this),new Oe(this),new Rc(this),new Sc(this,0,0),new ud(this,a.x,a.y),new vd(this,this._gameStats)]);this._commandSequence.execute();this._perfectRound=!0},onLevelUp:function(a){if(this._perfectRound){a=this._gameStats;var b=a.get_numPerfects();a.set_numPerfects(b+1)}this.nextRound()},earnPowerup:function(){},onPauseButtonClick:function(a){this.getGameState().pause();Tc.show(this.getGameState())},
__class__:De,__properties__:{set_perfectRound:"set_perfectRound",get_perfectRound:"get_perfectRound",get_powerupController:"get_powerupController",get_gameplayContainer:"get_gameplayContainer",get_gameStats:"get_gameStats",get_uiPanel:"get_uiPanel",get_hud:"get_hud",get_itemSpawners:"get_itemSpawners",get_deferredActionController:"get_deferredActionController"}});var wd=function(a){this._type=a};wd.__name__=["game","dodgeGame","DodgeGameControllerEvent"];wd.__super__=J;wd.prototype=p(J.prototype,
{__class__:wd});var Pe=function(){};Pe.__name__=["game","dodgeGame","EffectsFactory"];Pe.createFreezeWipeEffect=function(a,b,c,d){var e=a.addEntity();a=e.addEntity();b=new A(a,"freezeWipe");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;I.addTweenToTarget(a,a.getPositionRef(),"y",-600,600,0.35,B.linear);a=e.addEntity();b=new A(a,"freezeOverlay");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;I.addTweenToTarget(a,b.getSprite(),"alpha",0,1,0.2*d,B.linear);I.addTweenToTarget(a,b.getSprite(),
"alpha",1,0,0.2*d,B.linear,0.8*d,function(){e.destroy()});return e};Pe.prototype={__class__:Pe};var Qe=function(a){l.call(this,a)};Qe.__name__=["game","dodgeGame","FollowCursor"];Qe.__super__=l;Qe.prototype=p(l.prototype,{update:function(){l.prototype.update.call(this);var a=ea.getInstance().getMousePosition();this.getEntity().setPosition(a.x,a.y)},__class__:Qe});var ze=function(){this._numPerfects=0;this._backgroundsUnlocked=[];this._playTime=0;this._numLives=3;this._stage=1;this._numCollectiblesStreak=
this._numPoints=0;this._eventListeners=[]};ze.__name__=["game","dodgeGame","GameStats"];ze.__super__=Ca;ze.prototype=p(Ca.prototype,{get_numCollectiblesStreak:function(){return this._numCollectiblesStreak},set_numCollectiblesStreak:function(a){return this._numCollectiblesStreak=a},get_numPoints:function(){return this._numPoints},set_numPoints:function(a){var b=this.get_currentLevel();this._numPoints=a;this.dispatchEvent(new Rb("scoreUpdate"));this.get_currentLevel()>b&&this.dispatchEvent(new Rb("levelUp"));
return this._numPoints},get_stage:function(){return this._stage},set_stage:function(a){return this._stage=a},get_numLives:function(){return this._numLives},set_numLives:function(a){this._numLives=a;this._numLives>z.get_instance().get_playerConfig().maxLives&&(this._numLives=z.get_instance().get_playerConfig().maxLives);this.dispatchEvent(new Rb("livesUpdate"));return this._numLives},get_playTime:function(){return this._playTime},set_playTime:function(a){return this._playTime=a},get_currentLevel:function(){return z.get_instance().get_playerConfig().getLevelByScore(this.get_numPoints())},
get_nextLevelScoreRequirement:function(){return z.get_instance().get_playerConfig().getScoreRequiredForLevel(this.get_currentLevel()+1)},get_backgroundsUnlocked:function(){return this._backgroundsUnlocked},get_numPerfects:function(){return this._numPerfects},set_numPerfects:function(a){return this._numPerfects=a},__class__:ze,__properties__:{set_numPerfects:"set_numPerfects",get_numPerfects:"get_numPerfects",get_backgroundsUnlocked:"get_backgroundsUnlocked",get_nextLevelScoreRequirement:"get_nextLevelScoreRequirement",
get_currentLevel:"get_currentLevel",set_playTime:"set_playTime",get_playTime:"get_playTime",set_numLives:"set_numLives",get_numLives:"get_numLives",set_stage:"set_stage",get_stage:"get_stage",set_numPoints:"set_numPoints",get_numPoints:"get_numPoints",set_numCollectiblesStreak:"set_numCollectiblesStreak",get_numCollectiblesStreak:"get_numCollectiblesStreak"}});var Rb=function(a){this._type=a};Rb.__name__=["game","dodgeGame","GameStatsEvent"];Rb.__super__=J;Rb.prototype=p(J.prototype,{__class__:Rb});
var Be=function(a,b){this._scoreMultiplier=1;l.call(this,a);this._characters=[];this._obstacles=[];this._items=[];this._objects=[];this._dodgeGameController=b;this._healthPackSpawn=new Re;this._scoreMultiplierItemSpawn=new Se;this._backgroundLayer=this.addEntity();var c=this._backgroundLayer.addEntity();this._backgroundSprite=new A(c,"background1");this._backgroundSprite.getSprite().anchor.x=0.5;this._backgroundSprite.getSprite().anchor.y=0.5;this._groundLayer=this.addEntity();this._gameplayLayer=
this.addEntity();this._overlayLayer=this.addEntity();this._levelsConfig=z.get_instance().get_levelsConfig()};Be.__name__=["game","dodgeGame","GameplayContainer"];Be.__super__=l;Be.prototype=p(l.prototype,{get_leftBound:function(){return this._levelsConfig.leftBound},get_rightBound:function(){return this._levelsConfig.rightBound},get_topBound:function(){return this._levelsConfig.topBound},get_bottomBound:function(){return this._levelsConfig.bottomBound},get_items:function(){return this._items},get_player:function(){return this._player},
get_obstacles:function(){return this._obstacles},get_groundLayer:function(){return this._groundLayer},get_gameplayLayer:function(){return this._gameplayLayer},get_overlayLayer:function(){return this._overlayLayer},setBackground:function(a){var b=this._backgroundSprite.getEntity(),c=this._backgroundLayer.addEntity();this._backgroundSprite=new A(c,a);this._backgroundSprite.getSprite().anchor.x=0.5;this._backgroundSprite.getSprite().anchor.y=0.5;I.addTweenToTarget(c,c.getScaleRef(),"x",0.98,1,0.35,B.easeOutQuad);
I.addTweenToTarget(c,c.getScaleRef(),"y",0.98,1,0.35,B.easeOutQuad);I.addTweenToTarget(c,this._backgroundSprite.getSprite(),"alpha",0,1,0.35,B.easeOutQuad,0,function(){b.destroy()})},getBackground:function(){return this._backgroundSprite.getImageId()},assignPlayer:function(a){this._player=a;this._player.addEventListener("destroy",q(this,this.onPlayerDestroy));a=this._player.getComponent(Xa);a.addEventListener("score",q(this,this.onPlayerScoreCollect));a.addEventListener("healthCollect",q(this,this.onPlayerHealthCollect));
a.addEventListener("usePowerup",q(this,this.onPlayerUsePowerup));a.addEventListener("start",q(this,this.onPlayerScoreMultiplierStart));a.addEventListener("deathStart",q(this,this.onPlayerDeathStart));a.addEventListener("end",q(this,this.onPlayerScoreMultiplierEnd));this.dispatchEvent(new ic("assign",a));this._dodgeGameController.get_hud().get_powerupsDisplay().get_buttonGroup().setInputEnabled(!0)},onPlayerDestroy:function(){this._player.removeEventListener("destroy",q(this,this.onPlayerDestroy));
var a=this._player.getComponent(Xa);a.removeEventListener("score",q(this,this.onPlayerScoreCollect));a.removeEventListener("healthCollect",q(this,this.onPlayerHealthCollect));a.removeEventListener("usePowerup",q(this,this.onPlayerUsePowerup));a.removeEventListener("start",q(this,this.onPlayerScoreMultiplierStart));a.removeEventListener("deathStart",q(this,this.onPlayerDeathStart));a.removeEventListener("end",q(this,this.onPlayerScoreMultiplierEnd));this._player=null;this.dispatchEvent(new ic("unassign",
null));this._dodgeGameController.onPlayerDeath()},onPlayerDeathStart:function(){this._dodgeGameController.get_hud().get_powerupsDisplay().get_buttonGroup().setInputEnabled(!1)},onPlayerScoreMultiplierStart:function(a){var b=this._overlayLayer.addEntity();b.setLocalPosition(this._player.getLocalPosition().x,this._player.getLocalPosition().y);new yd(b,"x2",{fontFamily:"luckiest_guyregular",fontSize:42,fill:"#F9CA05",stroke:"#000000",strokeThickness:2});this._scoreMultiplier=a.get_multiplier();this._dodgeGameController.get_hud().get_scoreDisplay().showMultiplier()},
onPlayerScoreMultiplierEnd:function(a){this._scoreMultiplier=1;this._dodgeGameController.get_hud().get_scoreDisplay().hideMultiplier()},onPlayerUsePowerup:function(){null!=this._player&&this._dodgeGameController.get_hud().get_powerupsDisplay().useCurrentPowerup()},registerCharacter:function(a){this._characters.push(a);a.addEventListener("destroy",q(this,this.onCharacterDestroy))},unregisterCharacter:function(a){a.removeEventListener("destroy",q(this,this.onCharacterDestroy));F.remove(this._characters,
a)},onCharacterDestroy:function(a){this.unregisterCharacter(a.target)},onPlayerScoreCollect:function(a){var b=Math.round(a.getScore()*this._scoreMultiplier);if(0<b){var c={fontFamily:"luckiest_guyregular",fontSize:42,fill:"#F9CA05",stroke:"#000000",strokeThickness:2};if("zh-cn"==s.dataLocale||"ja-jp"==s.dataLocale)c.fontFamily="fornumber_font";var d=this._overlayLayer.addEntity();d.setLocalPosition(a.getScoreLocation().x,a.getScoreLocation().y);new yd(d,"+"+b,c)}a=this._dodgeGameController.get_gameStats();
c=a.get_numCollectiblesStreak();a.set_numCollectiblesStreak(c+1);a=this._dodgeGameController.get_gameStats();a.set_numPoints(a.get_numPoints()+b);if(0==this._dodgeGameController.get_gameStats().get_numCollectiblesStreak()%z.get_instance().get_levelsConfig().numCollectiblesForPowerup)this.onPowerupEarn();if(0==this._dodgeGameController.get_gameStats().get_numCollectiblesStreak()%z.get_instance().get_levelsConfig().numCollectiblesForScoreMultiplier)this.onScoreMultiplierEarn();if(0==this._dodgeGameController.get_gameStats().get_numCollectiblesStreak()%
z.get_instance().get_levelsConfig().numCollectiblesForHealthPack)this.onHealthPackEarn()},onPowerupEarn:function(){this._dodgeGameController.get_powerupController().activateNextPowerup()},onScoreMultiplierEarn:function(){var a=z.get_instance().get_levelsConfig(),b=this.getRandomEmptySpace(),b=this._scoreMultiplierItemSpawn.spawn(this._gameplayLayer,b.x,b.y);new zd(b.getEntity(),a.movingItemSpeed,this.get_leftBound(),this.get_topBound(),this.get_rightBound(),this.get_bottomBound());this.registerItem(b)},
onHealthPackEarn:function(){var a=z.get_instance().get_levelsConfig(),b=this.getRandomEmptySpace(),b=this._healthPackSpawn.spawn(this._gameplayLayer,b.x,b.y);new zd(b.getEntity(),a.movingItemSpeed,this.get_leftBound(),this.get_topBound(),this.get_rightBound(),this.get_bottomBound());this.registerItem(b)},onPlayerHealthCollect:function(a){a=this._dodgeGameController.get_gameStats();a.set_numLives(a.get_numLives()+z.get_instance().get_playerConfig().healthPackLives)},registerItem:function(a){this._items.push(a);
a.addEventListener("lifetimeElapsed",q(this,this.onTimedCollectibleLifeTimeElapsed));a.addEventListener("destroy",q(this,this.onItemDestroy))},unregisterItem:function(a){a.removeEventListener("destroy",q(this,this.onItemDestroy));F.remove(this._items,a)},onItemDestroy:function(a){this.unregisterItem(a.target)},onTimedCollectibleLifeTimeElapsed:function(a){this._dodgeGameController.set_perfectRound(!1)},registerObstacle:function(a){this._obstacles.push(a);a.addEventListener("destroy",q(this,this.onItemDestroy));
a.addEventListener("generate",q(this,this.onObstacleGenerate))},unregisterObstacle:function(a){a.removeEventListener("destroy",q(this,this.onItemDestroy));a.removeEventListener("generate",q(this,this.onObstacleGenerate));F.remove(this._obstacles,a)},onObstacleGenerate:function(a){this.registerObstacle(a.get_obstacle())},registerObject:function(a){this._objects.push(a);a.addEventListener("destroy",q(this,this.onObjectDestroy))},unregisterObject:function(a){a.removeEventListener("destroy",q(this,this.onObjectDestroy));
F.remove(this._objects,a)},onObjectDestroy:function(a){this.unregisterObject(a.target)},onObstacleDestroy:function(a){this.unregisterItem(a.target)},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);this.keepCharactersInBounds()},postUpdate:function(){l.prototype.postUpdate.call(this);this.keepCharactersInBounds();this.cleanUpProjectiles()},getRandomPositionInBounds:function(){z.get_instance().get_levelsConfig();var a=ja.randomFloat(this.get_leftBound(),this.get_rightBound()),b=ja.randomFloat(this.get_topBound(),
this.get_bottomBound());return new L(a,b)},getRandomEmptySpace:function(a,b){null==b&&(b=0);null==a&&(a=0);for(var c=0,d=z.get_instance().get_levelsConfig().maxEmptySpaceFindAttempts;c<d;){c++;var e=this.getRandomPositionInBounds(),f=e.getClone();f.x+=this.getEntity().getPosition().x;f.y+=this.getEntity().getPosition().y;for(var g=!1,k=0,h=this._obstacles;k<h.length;){var l=h[k];++k;l=l.get_collider();if(l.checkPointIntersect(new t(f.x,f.y)))g=!0;else if(0<a&&0<b){var n=new Ea;n.ul.x=f.x-0.5*a;n.ul.y=
f.y-0.5*b;n.wh.x=a;n.wh.y=b;n.getBoxIntersect(l.getCollision())&&(g=!0)}}null!=this._player&&this._player.getComponent(pb).checkPointIntersect(new t(f.x,f.y))&&(g=!0);if(!g)return e}console.log("Could not find empty space!");return this.getRandomPositionInBounds()},keepCharactersInBounds:function(){for(var a=0,b=this._characters.length;a<b;){var c=a++;this.keepEntityInBounds(this._characters[c].getEntity())}},cleanUpProjectiles:function(){for(var a=0,b=this._obstacles;a<b.length;){var c=b[a];++a;
if(c.getEntity().hasTag("projectile")){var d=c.getEntity().getPosition();(0>d.x||0>d.y||d.x>n.getInstance().getGameSize().x||d.y>n.getInstance().getGameSize().y)&&c.getEntity().destroy()}}},keepEntityInBounds:function(a){var b=this.keepPositionInBounds(a.getLocalPosition().x,a.getLocalPosition().y);a.setLocalPosition(b.x,b.y)},keepPositionInBounds:function(a,b,c){null==c&&(c=!1);var d=z.get_instance().get_levelsConfig(),e=d.bottomBound-d.topBound;a=new L(a,b);c&&(a.x-=this.getEntity().getPosition().x,
a.y-=this.getEntity().getPosition().y);e=(a.y-d.topBound)/e;0>e&&(e=0);1<e&&(e=1);d=0.5*d.boundsPerspectiveWiden*e;a.x>this.get_rightBound()*this.getEntity().getScale().x+d&&(a.x=this.get_rightBound()*this.getEntity().getScale().x+d);a.x<this.get_leftBound()*this.getEntity().getScale().x-d&&(a.x=this.get_leftBound()*this.getEntity().getScale().x-d);a.y>this.get_bottomBound()*this.getEntity().getScale().y&&(a.y=this.get_bottomBound()*this.getEntity().getScale().y);a.y<this.get_topBound()*this.getEntity().getScale().y&&
(a.y=this.get_topBound()*this.getEntity().getScale().y);c&&(a.x+=this.getEntity().getPosition().x,a.y+=this.getEntity().getPosition().y);return a},removeCharacters:function(){this._player.removeEventListener("destroy",q(this,this.onPlayerDestroy));var a=this._player.getComponent(Xa);a.get_damageStateMachine().setState(new Te(a));this._player=null;this.dispatchEvent(new ic("unassign",null));for(a=this._characters.length-1;0<=a;){var b=[this._characters[a]];b[0].setActive(!1);I.addTweenToTarget(b[0].getEntity(),
b[0].getEntity().getScaleRef(),"x",1,0,0.35,B.easeInQuad);var c=b[0].getEntity(),d=b[0].getEntity().getScaleRef(),b=function(a){return function(){a[0].getEntity().destroy()}}(b);I.addTweenToTarget(c,d,"y",1,0,0.35,B.easeInQuad,null,b);--a}},removeObstacles:function(){for(var a=this._obstacles.length-1;0<=a;){var b=[this._obstacles[a]];b[0].setActive(!1);I.addTweenToTarget(b[0].getEntity(),b[0].getEntity().getScaleRef(),"x",1,0,0.35,B.easeInQuad);var c=b[0].getEntity(),d=b[0].getEntity().getScaleRef(),
b=function(a){return function(){a[0].getEntity().destroy()}}(b);I.addTweenToTarget(c,d,"y",1,0,0.35,B.easeInQuad,null,b);--a}},removeItems:function(){for(var a=this._items.length-1;0<=a;){var b=[this._items[a]];b[0].setActive(!1);I.addTweenToTarget(b[0].getEntity(),b[0].getEntity().getScaleRef(),"x",1,0,0.35,B.easeInQuad);var c=b[0].getEntity(),d=b[0].getEntity().getScaleRef(),b=function(a){return function(){a[0].getEntity().destroy()}}(b);I.addTweenToTarget(c,d,"y",1,0,0.35,B.easeInQuad,null,b);
--a}},removeObjects:function(){for(var a=this._objects.length-1;0<=a;){var b=[this._objects[a]];I.addTweenToTarget(b[0],b[0].getScaleRef(),"x",1,0,0.35,B.easeInQuad);var c=b[0],d=b[0].getScaleRef(),b=function(a){return function(){a[0].destroy()}}(b);I.addTweenToTarget(c,d,"y",1,0,0.35,B.easeInQuad,null,b);--a}},__class__:Be,__properties__:{get_overlayLayer:"get_overlayLayer",get_gameplayLayer:"get_gameplayLayer",get_groundLayer:"get_groundLayer",get_obstacles:"get_obstacles",get_player:"get_player",
get_items:"get_items",get_bottomBound:"get_bottomBound",get_topBound:"get_topBound",get_rightBound:"get_rightBound",get_leftBound:"get_leftBound"}});var Ga=function(){};Ga.__name__=["game","dodgeGame","ObstacleFactory"];Ga.createObstacleByConfig=function(a,b,c,d){var e=null;switch(a.id){case "car":e=Ga.createCar(a,b,c,d);break;case "gingerbreadMan":e=Ga.createGingerbreadMan(a,b,c,d);break;case "lowerLeftGingerbreadMan":e=Ga.createSlingshotGingerbreadMan(a,b,c,d,!1,!0);break;case "lowerRightGingerbreadMan":e=
Ga.createSlingshotGingerbreadMan(a,b,c,d,!0,!0);break;case "projectileObstacle":e=Ga.createCrate(a,b,c,d);break;case "snowman":e=Ga.createSnowman(a,b,c,d);break;case "spilledMilk":e=Ga.createSpilledMilk(a,b,c,d);break;case "staticObstacle":e=Ga.createCrate(a,b,c,d);break;case "upperLeftGingerbreadMan":e=Ga.createSlingshotGingerbreadMan(a,b,c,d,!1,!1);break;case "upperRightGingerbreadMan":e=Ga.createSlingshotGingerbreadMan(a,b,c,d,!0,!1);break;default:console.log("Obstacle by ID of "+a.id+" not found!")}e.addTag("obstacle");
return e};Ga.createCrate=function(a,b,c,d){var e=b.addEntity();e.setLocalPosition(c,d);c=new Ea;c.wh=new t(a.colliderWidth,a.colliderHeight);a=new Ta(e,c);c=new gc(e);a.setOnEnter(q(c,c.onEnter));a.setOnExit(q(c,c.onExit));a=new A(e,"sleepingDog");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;b=b.addEntity();e.addChild(b);new ua(b,"dogSpike");new qb(e);return e};Ga.createSpilledMilk=function(a,b,c,d){b=b.addEntity();b.setLocalPosition(c,d);c=new Ea;c.wh=new t(a.colliderWidth,a.colliderHeight);
a=new Ta(b,c);c=new Ue(b,z.get_instance().get_levelsConfig().spilledMilkSlowDuration);a.setOnEnter(q(c,c.onEnter));a.setOnExit(q(c,c.onExit));a=new A(b,"spilledMilk");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;new qb(b);return b};Ga.createSnowman=function(a,b,c,d){b=b.addEntity();b.setLocalPosition(c,d);new db(b);c=new Ea;c.wh=new t(a.colliderWidth,a.colliderHeight);c=new Ta(b,c);d=new Ve(b,z.get_instance().get_levelsConfig().snowmanFreezeDuration);c.setOnEnter(q(d,d.onEnter));c.setOnExit(q(d,
d.onExit));c=new A(b,"snowman");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.7;new Uc(b,a.movementSpeed,null,null);new qb(b);return b};Ga.createSlingshotGingerbreadMan=function(a,b,c,d,e,f){b=b.addEntity();b.setLocalPosition(c,d);new db(b);c=new Ea;c.wh=new t(a.colliderWidth,a.colliderHeight);new Ta(b,c);c=null;d=b.addEntity();c=f?new ua(d,"gingerbreadmanSlingshotBottom"):new ua(d,"gingerbreadmanSlingshotTop");c.setPosition(c.getAnimationLength());c.stop();(!e&&!f||e&&f)&&d.setLocalScale(-1,
1);new Ad(b,a,new t(e?-1:1,f?-1:1));new qb(b);return b};Ga.createGingerbreadMan=function(a,b,c,d){b=b.addEntity();new db(b);var e=new Ea;e.wh=new t(a.colliderWidth,a.colliderHeight);var e=new Ta(b,e),f=new gc(b);e.setOnEnter(q(f,f.onEnter));e.setOnExit(q(f,f.onExit));e=b.addEntity();new ua(e,"gingerbreadman");new qb(b);new We(b,a.movementSpeed);b.setLocalPosition(c,d);return b};Ga.createCar=function(a,b,c,d){b=b.addEntity();new db(b);var e=new Ea;e.wh=new t(a.colliderWidth,a.colliderHeight);var e=
new Ta(b,e),f=new gc(b);e.setOnEnter(q(f,f.onEnter));e.setOnExit(q(f,f.onExit));e=b.addEntity();new ua(e,"gingerbreadman");new qb(b);new Uc(b,a.movementSpeed,"carUp","carDown");b.setLocalPosition(c,d);return b};var ic=function(a,b){this._type=a;this._character=b};ic.__name__=["game","dodgeGame","PlayerAssignEvent"];ic.__super__=J;ic.prototype=p(J.prototype,{getCharacter:function(){return this._character},__class__:ic});var Ae=function(a,b){l.call(this,a);this._dodgeGameController=b;this._powerupPool=
[new Xe(this._dodgeGameController),new Ye(this._dodgeGameController)];this._powerupQueue=[];for(var c=0,d=this._powerupPool;c<d.length;){var e=d[c];++c;e.addEventListener("use",q(this,this.onPowerupUse))}};Ae.__name__=["game","dodgeGame","PowerupController"];Ae.__super__=l;Ae.prototype=p(l.prototype,{get_dodgeGameController:function(){return this._dodgeGameController},init:function(){l.prototype.init.call(this);this.fillPowerupQueue()},fillPowerupQueue:function(){for(var a=this._powerupPool.length,
b=this._powerupQueue.length,c=0,b=z.get_instance().get_playerConfig().powerupQueueSize-b;c<b;){c++;var d=ja.randomInt(0,a);this.enqueuePowerup(this._powerupPool[d])}},enqueuePowerup:function(a){this._powerupQueue.push(a);this.dispatchEvent(new wc("enqueue",a,this._powerupQueue))},dequeuePowerup:function(){var a=this._powerupQueue[0];F.remove(this._powerupQueue,a);this.dispatchEvent(new wc("dequeue",a,this._powerupQueue))},onPowerupUse:function(a){this.dequeuePowerup();this.fillPowerupQueue();this._dodgeGameController.get_hud().get_powerupsDisplay().advancePowerups()},
activateNextPowerup:function(){this.dispatchEvent(new Bd("powerupEarn"))},destroy:function(){l.prototype.destroy.call(this);for(var a=0,b=this._powerupPool;a<b.length;){var c=b[a];++a;c.removeEventListener("use",q(this,this.onPowerupUse))}},__class__:Ae,__properties__:{get_dodgeGameController:"get_dodgeGameController"}});var Bd=function(a){this._type=a};Bd.__name__=["game","dodgeGame","PowerupControllerEvent"];Bd.__super__=J;Bd.prototype=p(J.prototype,{__class__:Bd});var wc=function(a,b,c){this._type=
a;this._powerup=b;this._powerupQueue=c};wc.__name__=["game","dodgeGame","QueuePowerupEvent"];wc.__super__=J;wc.prototype=p(J.prototype,{getPowerup:function(){return this._powerup},getPowerupQueue:function(){return this._powerupQueue},__class__:wc});var Ze=function(a,b){l.call(this,a);this._dodgeGameController=b};Ze.__name__=["game","dodgeGame","RespawnButton"];Ze.__super__=l;Ze.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this._button=this.getComponent(qa);this._button.setOnMouseDown(q(this,
this.onMouseDown))},onMouseDown:function(){var a=ea.getInstance().getMousePosition();this._dodgeGameController.respawnPlayer(a.x,a.y)},__class__:Ze});var zd=function(a,b,c,d,e,f){l.call(this,a);this._velocityController=new rc(this.getEntity());this._left=c;this._right=e;this._top=d;this._bottom=f;this._speed=b};zd.__name__=["game","dodgeGame","WallBouncer"];zd.__super__=l;zd.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);var a=ja.randomFloat(0,360),a=ja.getRotated2dVector(new t(0,
-1),a).getNormalized();a.x*=this._speed;a.y*=this._speed;this._velocityController.setVelocity(a.x,a.y)},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);var a=this.getEntity().getLocalPosition(),b=this._velocityController.getVelocity();a.x>this._right&&(a.x=this._right,b.x*=-1);a.y>this._bottom&&(a.y=this._bottom,b.y*=-1);a.x<this._left&&(a.x=this._left,b.x*=-1);a.y<this._top&&(a.y=this._top,b.y*=-1);this.getEntity().setLocalPosition(a.x,a.y);this._velocityController.setVelocity(b.x,b.y)},
__class__:zd});var xe=function(a,b){l.call(this,a);this._character=b;this._stackStateMachine=new pg};xe.__name__=["game","dodgeGame","characters","AiController"];xe.__super__=l;xe.prototype=p(l.prototype,{get_character:function(){return this._character},get_stackStateMachine:function(){return this._stackStateMachine},get_target:function(){return this._target},set_target:function(a){null!=this._target&&this._target.removeEventListener("destroy",q(this,this.onTargetDestroy));a.addEventListener("destroy",
q(this,this.onTargetDestroy));return this._target=a},update:function(){l.prototype.update.call(this);this.get_stackStateMachine().onUpdate()},postUpdate:function(){l.prototype.postUpdate.call(this);this.get_stackStateMachine().onPostUpdate()},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);this.get_stackStateMachine().onFixedUpdate()},onTargetDestroy:function(a){this._target=null},__class__:xe,__properties__:{set_target:"set_target",get_target:"get_target",get_stackStateMachine:"get_stackStateMachine",
get_character:"get_character"}});var Xa=function(a){l.call(this,a);this._characterConfig=new Cd;this._stateMachine=new $e;this._damageStateMachine=new af;this._velocityController=new rc(this.getEntity());this._powerupStateMachines=[];this._stateMachine.setState(new Vc(this));this._characterModifiers=new qg};Xa.__name__=["game","dodgeGame","characters","Character"];Xa.__super__=l;Xa.prototype=p(l.prototype,{get_characterConfig:function(){return this._characterConfig},set_characterConfig:function(a){return this._characterConfig=
a},get_characterModifiers:function(){return this._characterModifiers},get_velocityController:function(){return this._velocityController},get_stateMachine:function(){return this._stateMachine},get_damageStateMachine:function(){return this._damageStateMachine},get_powerupStateMachines:function(){return this._powerupStateMachines},init:function(){l.prototype.init.call(this)},usePowerup:function(){this.dispatchEvent(new Sb("usePowerup"))},addPowerupState:function(a){for(var b=0,c=this._powerupStateMachines;b<
c.length;){var d=c[b];++b;var e=d.getState();if((null==e?null:C.getClass(e))==(null==a?null:C.getClass(a))){d.getState().onComplete();break}}b=new bf;this._powerupStateMachines.push(b);b.setState(a);b.get_eventDispatcher().addEventListener("complete",q(this,this.onPowerupStateComplete))},onPowerupStateComplete:function(a){a=a.get_stateMachine();a.get_eventDispatcher().removeEventListener("complete",q(this,this.onPowerupStateComplete));a.getState().onExit();F.remove(this._powerupStateMachines,a)},
update:function(){l.prototype.update.call(this);this._stateMachine.onUpdate();this._damageStateMachine.onUpdate();for(var a=0,b=this._powerupStateMachines;a<b.length;){var c=b[a];++a;c.onUpdate()}},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);this._stateMachine.onFixedUpdate();this._damageStateMachine.onFixedUpdate();for(var a=0,b=this._powerupStateMachines;a<b.length;){var c=b[a];++a;c.onFixedUpdate()}},postUpdate:function(){l.prototype.postUpdate.call(this);this._stateMachine.onPostUpdate();
this._damageStateMachine.onPostUpdate();for(var a=0,b=this._powerupStateMachines;a<b.length;){var c=b[a];++a;c.onPostUpdate()}},deactivateAllPowerups:function(){for(var a=0,b=this._powerupStateMachines;a<b.length;){var c=b[a];++a;c.getState().onComplete()}},destroy:function(){l.prototype.destroy.call(this);this.deactivateAllPowerups()},__class__:Xa,__properties__:{get_powerupStateMachines:"get_powerupStateMachines",get_damageStateMachine:"get_damageStateMachine",get_stateMachine:"get_stateMachine",
get_velocityController:"get_velocityController",get_characterModifiers:"get_characterModifiers",set_characterConfig:"set_characterConfig",get_characterConfig:"get_characterConfig"}});var rg=function(a,b){this.animationName=a;this.onComplete=b};rg.__name__=["game","dodgeGame","characters","CharacterAnimationQueueData"];rg.prototype={__class__:rg};var Sb=function(a){this._type=a};Sb.__name__=["game","dodgeGame","characters","CharacterEvent"];Sb.__super__=J;Sb.prototype=p(J.prototype,{__class__:Sb});
var qg=function(){this.isInvulnerable=!1;this.movementSpeedModifier=1};qg.__name__=["game","dodgeGame","characters","CharacterModifiers"];qg.prototype={__class__:qg};var Tb=function(){};Tb.__name__=["game","stateMachine","StateMachine"];Tb.prototype={getState:function(){return this._state},setState:function(a){if(null!=this._state)this._state.onExit();this._state=a;this._state.onEnter()},onUpdate:function(){if(null!=this._state)this._state.onUpdate()},onFixedUpdate:function(){if(null!=this._state)this._state.onFixedUpdate()},
onPostUpdate:function(){if(null!=this._state)this._state.onPostUpdate()},__class__:Tb};var $e=function(){};$e.__name__=["game","dodgeGame","characters","CharacterStateMachine"];$e.__super__=Tb;$e.prototype=p(Tb.prototype,{getState:function(){return this._state},handleDirectionInput:function(a){this.getState().handleDirectionInput(a)},__class__:$e});var xc=function(){this.dizzyDuration=this.slowDuration=this.freezeDuration=0;this.damage=1};xc.__name__=["game","dodgeGame","characters","DamageProperties"];
xc.prototype={__class__:xc};var af=function(){};af.__name__=["game","dodgeGame","characters","DamageStateMachine"];af.__super__=Tb;af.prototype=p(Tb.prototype,{getState:function(){return this._state},inflictDamage:function(a){this.getState().inflictDamage(a)},__class__:af});var td=function(a,b,c,d){l.call(this,a);this._items=c;this._collectionRadius=d;this._character=b};td.__name__=["game","dodgeGame","characters","ItemCollector"];td.__super__=l;td.prototype=p(l.prototype,{fixedUpdate:function(){l.prototype.fixedUpdate.call(this);
for(var a=this.getEntity().getPosition(),b=this._items.length-1;0<=b;){var c=this._items[b];if(null!=c){var d=c.getEntity().getPosition();(new L(d.x-a.x,d.y-a.y)).getLength()<=this._collectionRadius&&this.collectItem(c)}--b}},collectItem:function(a){this.dispatchEvent(new Dd("detectItem",a))},__class__:td});var Dd=function(a,b){this._type=a;this._item=b};Dd.__name__=["game","dodgeGame","characters","ItemCollectorEvent"];Dd.__super__=J;Dd.prototype=p(J.prototype,{get_item:function(){return this._item},
__class__:Dd,__properties__:{get_item:"get_item"}});var sd=function(a,b){l.call(this,a);this._character=b;this._upKey=z.get_instance().get_playerConfig().upKey;this._downKey=z.get_instance().get_playerConfig().downKey;this._leftKey=z.get_instance().get_playerConfig().leftKey;this._rightKey=z.get_instance().get_playerConfig().rightKey;this._spacebarKey=z.get_instance().get_playerConfig().spacebarKey;this._moveCommand=new yc(this._character,new L(0,0))};sd.__name__=["game","dodgeGame","characters",
"PlayerController"];sd.__super__=l;sd.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this._character.addEventListener("deathStart",q(this,this.onPlayerDeathStart))},onPlayerDeathStart:function(){this.setActive(!1)},update:function(){l.prototype.update.call(this);var a=new L;if(!n.isMobile()&&z.get_instance().get_flowConfig().touchMovementOnDesktop||n.isMobile()&&z.get_instance().get_flowConfig().touchMovementOnMobile){var b=ea.getInstance().getMousePosition(),c=this.getEntity().getPosition(),
b=new L(b.x-c.x,b.y-c.y);b.getLength()>=z.get_instance().get_playerConfig().minMouseFollowDistance&&(b=b.getNormalized(),a.x=b.x,a.y=b.y)}z.get_instance().get_playerConfig().keyboardEnabled&&(ea.getInstance().isKeyDown(this._upKey)&&(a.y-=1),ea.getInstance().isKeyDown(this._downKey)&&(a.y+=1),ea.getInstance().isKeyDown(this._leftKey)&&(a.x-=1),ea.getInstance().isKeyDown(this._rightKey)&&(a.x+=1));a=a.getNormalized();0<a.getLength()&&(this._moveCommand.get_direction().x=a.x,this._moveCommand.get_direction().y=
a.y,this._moveCommand.execute());ea.getInstance().isKeyPressed(this._spacebarKey)&&(new cf(this._character)).execute()},__class__:sd});var bf=function(){this._eventDispatcher=new Ca};bf.__name__=["game","dodgeGame","characters","PowerupStateMachine"];bf.__super__=Tb;bf.prototype=p(Tb.prototype,{get_eventDispatcher:function(){return this._eventDispatcher},getState:function(){return this._state},setState:function(a){null!=this.getState()&&a.get_eventDispatcher().removeEventListener("complete",q(this,
this.onPowerupStateComplete));Tb.prototype.setState.call(this,a);null!=a&&a.get_eventDispatcher().addEventListener("complete",q(this,this.onPowerupStateComplete))},onPowerupStateComplete:function(a){this.get_eventDispatcher().dispatchEvent(new Wc(a.getType(),a.get_state(),this))},__class__:bf,__properties__:{get_eventDispatcher:"get_eventDispatcher"}});var Xc=function(a,b,c){this._type=a;this._score=b;this._scoreLocation=c};Xc.__name__=["game","dodgeGame","characters","ScoreCollectEvent"];Xc.__super__=
J;Xc.prototype=p(J.prototype,{getScore:function(){return this._score},getScoreLocation:function(){return this._scoreLocation},__class__:Xc});var zc=function(a,b){null==b&&(b=1);this._multiplier=1;this._type=a;this._multiplier=b};zc.__name__=["game","dodgeGame","characters","ScoreMultiplierEvent"];zc.__super__=J;zc.prototype=p(J.prototype,{get_multiplier:function(){return this._multiplier},__class__:zc,__properties__:{get_multiplier:"get_multiplier"}});var db=function(a){l.call(this,a)};db.__name__=
["game","dodgeGame","characters","StunnableCharacter"];db.__super__=l;db.prototype=p(l.prototype,{stun:function(a){this.dispatchEvent(new Ed("stun",a))},__class__:db});var Ed=function(a,b){this._type=a;this._duration=b};Ed.__name__=["game","dodgeGame","characters","StunnableEvent"];Ed.__super__=J;Ed.prototype=p(J.prototype,{get_duration:function(){return this._duration},__class__:Ed,__properties__:{get_duration:"get_duration"}});var ra={__ename__:!0,__constructs__:["Right","Front","Left","Back"],
Right:["Right",0]};ra.Right.__enum__=ra;ra.Front=["Front",1];ra.Front.__enum__=ra;ra.Left=["Left",2];ra.Left.__enum__=ra;ra.Back=["Back",3];ra.Back.__enum__=ra;ra.__empty_constructs__=[ra.Right,ra.Front,ra.Left,ra.Back];var Gb=function(a,b){null==b&&(b="");this._noUpDown=this._noFlip=!1;this._direction=ra.Right;this._animationPrefix="";l.call(this,a);this._animationPrefix=b;this._animationQueue=[]};Gb.__name__=["game","dodgeGame","characters","TopDownCharacterAnimationController"];Gb.__super__=l;
Gb.prototype=p(l.prototype,{get_pixiAnimation:function(){return this._pixiAnimation},get_noFlip:function(){return this._noFlip},set_noFlip:function(a){return this._noFlip=a},get_noUpDown:function(){return this._noUpDown},set_noUpDown:function(a){return this._noUpDown=a},getDirection:function(){return this._direction},setDirection:function(a){this._direction=a},getCurrentAnimationName:function(){return this._currentAnimationName},init:function(){l.prototype.init.call(this)},playAnimation:function(a,
b,c,d){null==c&&(c=!1);if(null==this._pixiAnimation&&(this._pixiAnimation=this.getEntity().getComponentsInChildren(ua)[0],null==this._pixiAnimation))return;d=this._animationPrefix;var e=new t(1,1);switch(this._direction[1]){case 0:d+="Side";break;case 1:d+=this.get_noUpDown()?"Side":"Front";break;case 2:d+="Side";e.x=-1;break;case 3:d+=this.get_noUpDown()?"Side":"Back"}d+=a;var f=Na.getInstance().getAnimationByName(d);null==f&&(d=this._animationPrefix+a,f=Na.getInstance().getAnimationByName(d));null==
f||!c&&this._currentAnimationName==d||(this._pixiAnimation.setAnimation(d,b,c),this.get_noFlip()||this._pixiAnimation.getEntity().setLocalScale(e.x,e.y),this._currentAnimationName=a)},resetAnimationQueue:function(){this._animationQueue=[]},addAnimationToQueue:function(a,b){var c=new rg(a,b),d=this._animationQueue.length;this._animationQueue.push(c);0==d&&this.playNextAnimationInQueue()},playNextAnimationInQueue:function(){var a=this;if(0<this._animationQueue.length){var b=this._animationQueue[0];
this.playAnimation(b.animationName,function(){a._animationQueue.splice(0,1);if(null!=b.onComplete)b.onComplete();a.playNextAnimationInQueue()},!0,!1)}},stop:function(){this._pixiAnimation.stop()},play:function(){this._pixiAnimation.play()},__class__:Gb,__properties__:{set_noUpDown:"set_noUpDown",get_noUpDown:"get_noUpDown",set_noFlip:"set_noFlip",get_noFlip:"get_noFlip",get_pixiAnimation:"get_pixiAnimation"}});var Hb=function(a){this._context=a};Hb.__name__=["game","stateMachine","State"];Hb.prototype=
{getContext:function(){return this._context},onEnter:function(){},onUpdate:function(){},onFixedUpdate:function(){},onPostUpdate:function(){},onExit:function(){},__class__:Hb};var Ub=function(a){this._context=a};Ub.__name__=["game","dodgeGame","characters","aiStates","CharacterAiState"];Ub.__super__=Hb;Ub.prototype=p(Hb.prototype,{get_aiController:function(){return this.getContext()},get_character:function(){return this.get_aiController().get_character()},__class__:Ub,__properties__:{get_character:"get_character",
get_aiController:"get_aiController"}});var ye=function(a){this._context=a};ye.__name__=["game","dodgeGame","characters","aiStates","CatchPlayerState"];ye.__super__=Ub;ye.prototype=p(Ub.prototype,{onFixedUpdate:function(){Ub.prototype.onFixedUpdate.call(this);if(null==this.getContext().get_target())this.getContext().get_stackStateMachine().pushState(new df(this.getContext()));else{var a=this.getContext().getEntity().getPosition(),b=this.getContext().get_target().getPosition(),a=new L(b.x-a.x,b.y-a.y);
a.getLength()>z.get_instance().get_tomConfig().desiredTargetDistance&&(a=a.getNormalized(),(new yc(this.get_character(),a)).execute())}},__class__:ye});var df=function(a){this._context=a};df.__name__=["game","dodgeGame","characters","aiStates","LocatePlayerAiState"];df.__super__=Ub;df.prototype=p(Ub.prototype,{onFixedUpdate:function(){Ub.prototype.onFixedUpdate.call(this);var a=this.getContext().getEntity().getParent().getComponentsInChildren(sd);0<a.length&&(this.getContext().set_target(a[0].getEntity()),
this.getContext().get_stackStateMachine().popState())},__class__:df});var rb=function(a){this._eventListeners=[];this._character=a};rb.__name__=["game","dodgeGame","characters","characterCommands","CharacterCommand"];rb.__super__=gb;rb.prototype=p(gb.prototype,{get_character:function(){return this._character},set_character:function(a){return this._character=a},__class__:rb,__properties__:{set_character:"set_character",get_character:"get_character"}});var yc=function(a,b){rb.call(this,a);this._direction=
b};yc.__name__=["game","dodgeGame","characters","characterCommands","MoveCommand"];yc.__super__=rb;yc.prototype=p(rb.prototype,{get_direction:function(){return this._direction},execute:function(){rb.prototype.execute.call(this);this._character.get_stateMachine().handleDirectionInput(this._direction.getClone())},__class__:yc,__properties__:p(rb.prototype.__properties__,{get_direction:"get_direction"})});var cf=function(a){rb.call(this,a)};cf.__name__=["game","dodgeGame","characters","characterCommands",
"UsePowerupCommand"];cf.__super__=rb;cf.prototype=p(rb.prototype,{execute:function(){rb.prototype.execute.call(this);this._character.usePowerup()},__class__:cf});var na=function(a){this._context=a};na.__name__=["game","dodgeGame","characters","characterStates","CharacterState"];na.__super__=Hb;na.prototype=p(Hb.prototype,{handleDirectionInput:function(a){},__class__:na});var ef=function(a){this._context=a};ef.__name__=["game","dodgeGame","characters","characterStates","DeathState"];ef.__super__=na;
ef.prototype=p(na.prototype,{onEnter:function(){na.prototype.onEnter.call(this);v.playSoundByName("sfx_jerry_hit");v.playSoundByName("sfx_jerry_hit_drum");v.playSoundByName("sfx_jerry_hit_"+ja.randomInt(2,3));this.getContext().get_velocityController().setVelocity(0,0,0);this.getContext().deactivateAllPowerups();this.getContext().getComponent(Gb).playAnimation("Hit",q(this,this.onAnimationComplete));this.getContext().dispatchEvent(new Sb("deathStart"))},onAnimationComplete:function(){this.getContext().getEntity().destroy()},
__class__:ef});var ff=function(a,b,c){this._duration=0;this._context=a;this._duration=b;this._nextState=c};ff.__name__=["game","dodgeGame","characters","characterStates","DizzyState"];ff.__super__=na;ff.prototype=p(na.prototype,{onEnter:function(){na.prototype.onEnter.call(this);this.getContext().get_velocityController().setVelocity(0,0,0);this.getContext().getComponent(Gb).playAnimation("Dizzy")},onFixedUpdate:function(){na.prototype.onFixedUpdate.call(this);this._duration-=n.getDeltaTime();if(0>=
this._duration)this.onDurationElapse()},onDurationElapse:function(){this.getContext().get_stateMachine().setState(this._nextState)},__class__:ff});var gf=function(a){this._context=a};gf.__name__=["game","dodgeGame","characters","characterStates","FrozenState"];gf.__super__=na;gf.prototype=p(na.prototype,{onEnter:function(){na.prototype.onEnter.call(this);this._context.get_velocityController().setVelocity(0,0,0);var a=this._context.getEntity().getComponentsInChildren(ua)[0];a.stop();this._oscillator=
new vb(this._context.getEntity(),a.getEntity().getPositionRef(),"x",0,2,65);this._freezeEffect=a.getEntity().addEntity();a=new A(this._freezeEffect,"frozenEffect");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;I.addTweenToTarget(this._freezeEffect,a.getSprite(),"alpha",0,1,0.1,B.linear)},onExit:function(){var a=this;na.prototype.onExit.call(this);var b=this._freezeEffect.getComponent(A);I.addTweenToTarget(this._freezeEffect,b.getSprite(),"alpha",1,0,0.1,B.linear,0,function(){a._freezeEffect.destroy()});
b=this._context.getEntity().getComponentsInChildren(ua)[0];b.play();b.getEntity().setLocalPosition(0,0);this._oscillator.destroy()},__class__:gf});var Vc=function(a){this._context=a};Vc.__name__=["game","dodgeGame","characters","characterStates","IdleState"];Vc.__super__=na;Vc.prototype=p(na.prototype,{onEnter:function(){na.prototype.onEnter.call(this);this.getContext().get_velocityController().setVelocity(0,0,0)},handleDirectionInput:function(a){na.prototype.handleDirectionInput.call(this,a);this.getContext().get_stateMachine().setState(new hf(this.getContext(),
a))},__class__:Vc});var hf=function(a,b){this._smokeOffset=new t(0,0);this._movedLastFrame=!0;this._context=a;this._direction=b;this._animation=a.getComponent(Gb);1<a.getEntity().getComponentsInChildren(ua).length&&(this._smokeAnimation=a.getEntity().getComponentsInChildren(ua)[1])};hf.__name__=["game","dodgeGame","characters","characterStates","MoveState"];hf.__super__=na;hf.prototype=p(na.prototype,{onEnter:function(){na.prototype.onEnter.call(this);this._itemCollector=this.getContext().getComponent(td);
null!=this._itemCollector&&this._itemCollector.addEventListener("detectItem",q(this,this.onDetectItem))},onFixedUpdate:function(){na.prototype.onFixedUpdate.call(this);var a=this._direction.getClone();a.x*=this.getContext().get_characterConfig().movementSpeed*this.getContext().get_characterModifiers().movementSpeedModifier;a.y*=this.getContext().get_characterConfig().movementSpeed*this.getContext().get_characterModifiers().movementSpeedModifier;this.getContext().get_velocityController().setVelocity(a.x,
a.y);null!=this._animation&&(Math.abs(a.x)>Math.abs(a.y)?0<a.x?this._animation.setDirection(ra.Right):this._animation.setDirection(ra.Left):0<a.y?this._animation.setDirection(ra.Front):this._animation.setDirection(ra.Back),this._animation.playAnimation("Run"),null!=this._smokeAnimation&&(this._animation.getDirection()==ra.Left&&(this._smokeOffset=new t(21,-3)),this._animation.getDirection()==ra.Right&&(this._smokeOffset=new t(-41,-3)),this._animation.getDirection()==ra.Back&&(this._smokeOffset=new t(-10,
13)),this._animation.getDirection()==ra.Front&&(this._smokeOffset=new t(-10,-48)),this._smokeAnimation.getSprite().alpha=1,this._smokeAnimation.getEntity().setLocalPosition(this._smokeOffset.x,this._smokeOffset.y)),this._animation.get_noFlip()&&(a=0<a.x?1:-1,this._animation.get_pixiAnimation().getEntity().setLocalScale(a,1)))},onUpdate:function(){na.prototype.onUpdate.call(this);this._movedLastFrame||this.getContext().get_stateMachine().setState(new Vc(this.getContext()));this._movedLastFrame=!1},
onExit:function(){na.prototype.onExit.call(this);null!=this._smokeAnimation&&(this._smokeAnimation.getSprite().alpha=0);null!=this._itemCollector&&this._itemCollector.removeEventListener("detectItem",q(this,this.onDetectItem))},onDetectItem:function(a){this.getContext().get_stateMachine().setState(new jf(this.getContext(),z.get_instance().get_playerConfig().itemPickupDuration,a.get_item()))},handleDirectionInput:function(a){na.prototype.handleDirectionInput.call(this,a);0<a.getLength()&&(this._movedLastFrame=
!0,this._direction=a)},__class__:hf});var jf=function(a,b,c){this._timeLeft=0;this._context=a;this._timeLeft=b;this._item=c};jf.__name__=["game","dodgeGame","characters","characterStates","PickupItemState"];jf.__super__=na;jf.prototype=p(na.prototype,{onEnter:function(){na.prototype.onEnter.call(this);this.getContext().get_velocityController().setVelocity(0,0);this.getContext().getComponent(Gb).playAnimation("Pickup")},onFixedUpdate:function(){na.prototype.onFixedUpdate.call(this);this._timeLeft-=
n.getDeltaTime();if(0>=this._timeLeft)this.onTimeElapse()},onTimeElapse:function(){this._item.collect(this.getContext());this.getContext().get_stateMachine().setState(new Vc(this.getContext()));this.getContext().getComponent(Gb).playAnimation("Run")},__class__:jf});var hb=function(a){this._context=a};hb.__name__=["game","dodgeGame","characters","damageStates","DamageState"];hb.__super__=Hb;hb.prototype=p(Hb.prototype,{inflictDamage:function(a){},__class__:hb});var Te=function(a){this._context=a};
Te.__name__=["game","dodgeGame","characters","damageStates","NoDamageState"];Te.__super__=hb;Te.prototype=p(hb.prototype,{__class__:Te});var ve=function(a){this._context=a};ve.__name__=["game","dodgeGame","characters","damageStates","PlayerDamageState"];ve.__super__=hb;ve.prototype=p(hb.prototype,{inflictDamage:function(a){hb.prototype.inflictDamage.call(this,a);this._context.get_characterModifiers().isInvulnerable||da.getInstance().getIsJerryDead()||(0<a.damage?(this.getContext().get_stateMachine().getState().onExit(),
this.getContext().get_stateMachine().setState(new ef(this.getContext())),da.getInstance().setIsJerryDead(!0)):0<a.slowDuration?this.getContext().addPowerupState(new kf(this.getContext(),z.get_instance().get_levelsConfig().spilledMilkSlowModifier,a.slowDuration)):0<a.freezeDuration&&this.getContext().addPowerupState(new lf(this.getContext(),a.freezeDuration)))},__class__:ve});var we=function(a){this._context=a};we.__name__=["game","dodgeGame","characters","damageStates","TomDamageState"];we.__super__=
hb;we.prototype=p(hb.prototype,{onEnter:function(){hb.prototype.onEnter.call(this);this.getContext().getComponent(db).addEventListener("stun",q(this,this.onStun))},inflictDamage:function(a){hb.prototype.inflictDamage.call(this,a);0>a.damage||this.getContext().get_stateMachine().setState(new ff(this.getContext(),a.dizzyDuration,this.getContext().get_stateMachine().getState()))},onExit:function(){hb.prototype.onExit.call(this);this.getContext().getComponent(db).removeEventListener("stun",q(this,this.onStun))},
onStun:function(a){var b=new xc;b.dizzyDuration=a.get_duration();this.inflictDamage(b);v.playSoundByName("sfx_tom_stun_2")},__class__:we});var ib=function(a){this._context=a;this._eventDispatcher=new Ca};ib.__name__=["game","dodgeGame","characters","powerupStates","PowerupState"];ib.__super__=Hb;ib.prototype=p(Hb.prototype,{get_eventDispatcher:function(){return this._eventDispatcher},onComplete:function(){this.get_eventDispatcher().dispatchEvent(new Wc("complete",this))},__class__:ib,__properties__:{get_eventDispatcher:"get_eventDispatcher"}});
var lf=function(a,b){this._done=!1;this._prevTint=16777215;this._tintColor=8947967;ib.call(this,a);this._duration=b};lf.__name__=["game","dodgeGame","characters","powerupStates","FreezeDebuffState"];lf.__super__=ib;lf.prototype=p(ib.prototype,{onEnter:function(){ib.prototype.onEnter.call(this);this._prevCharacterState=this._context.get_stateMachine().getState();this._context.get_stateMachine().setState(new gf(this._context));this._done=!1},onFixedUpdate:function(){ib.prototype.onFixedUpdate.call(this);
this._duration-=n.getDeltaTime();0>=this._duration&&(this.onComplete(),this._done=!0)},onExit:function(){ib.prototype.onExit.call(this);if(this._done)this._context.get_stateMachine().setState(this._prevCharacterState);else this.onComplete()},__class__:lf});var Ha=function(a,b){this._duration=5;ib.call(this,a);this._duration=b};Ha.__name__=["game","dodgeGame","characters","powerupStates","TimedPowerupState"];Ha.__super__=ib;Ha.prototype=p(ib.prototype,{onFixedUpdate:function(){ib.prototype.onFixedUpdate.call(this);
this._duration-=n.getDeltaTime();if(0>=this._duration)this.onDurationElapse()},onDurationElapse:function(){this.onComplete()},__class__:Ha});var mf=function(a,b){Ha.call(this,a,b)};mf.__name__=["game","dodgeGame","characters","powerupStates","InvinciblePowerupState"];mf.__super__=Ha;mf.prototype=p(Ha.prototype,{onEnter:function(){Ha.prototype.onEnter.call(this);this._context.get_characterModifiers().isInvulnerable=!0},onExit:function(){Ha.prototype.onExit.call(this);this._context.get_characterModifiers().isInvulnerable=
!1},__class__:mf});var Wc=function(a,b,c){this._type=a;this._state=b;this._stateMachine=c};Wc.__name__=["game","dodgeGame","characters","powerupStates","PowerupStateEvent"];Wc.__super__=J;Wc.prototype=p(J.prototype,{get_state:function(){return this._state},get_stateMachine:function(){return this._stateMachine},__class__:Wc,__properties__:{get_stateMachine:"get_stateMachine",get_state:"get_state"}});var nf=function(a,b,c){this._multiplier=1;Ha.call(this,a,b);this._multiplier=c};nf.__name__=["game",
"dodgeGame","characters","powerupStates","ScoreMultiplierPowerupState"];nf.__super__=Ha;nf.prototype=p(Ha.prototype,{onEnter:function(){Ha.prototype.onEnter.call(this);this.getContext().dispatchEvent(new zc("start",this._multiplier))},onExit:function(){Ha.prototype.onExit.call(this);this.getContext().dispatchEvent(new zc("end"))},__class__:nf});var kf=function(a,b,c){this._speedModifier=0.5;Ha.call(this,a,c);this._speedModifier=b};kf.__name__=["game","dodgeGame","characters","powerupStates","SlowDebuffState"];
kf.__super__=Ha;kf.prototype=p(Ha.prototype,{onEnter:function(){Ha.prototype.onEnter.call(this);this.getContext().get_characterModifiers().movementSpeedModifier=this._speedModifier},onExit:function(){Ha.prototype.onExit.call(this);this.getContext().get_characterModifiers().movementSpeedModifier=1},__class__:kf});var Yc=function(a){l.call(this,a)};Yc.__name__=["game","dodgeGame","collectibles","Item"];Yc.__super__=l;Yc.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);I.addTweenToTarget(this.getEntity(),
this.getEntity().getScaleRef(),"x",0,1,0.25,B.easeOutBack);I.addTweenToTarget(this.getEntity(),this.getEntity().getScaleRef(),"y",0,1,0.25,B.easeOutBack)},collect:function(a){this.getEntity().destroy()},__class__:Yc});var Ia=function(a,b){l.call(this,a);this._lifetime=b};Ia.__name__=["game","dodgeGame","collectibles","TimedCollectible"];Ia.__super__=Yc;Ia.prototype=p(Yc.prototype,{update:function(){Yc.prototype.update.call(this);this._lifetime-=n.getDeltaTime();if(0>=this._lifetime)this.onLifetimeElapse()},
onLifetimeElapse:function(){this.dispatchEvent(new Fd("lifetimeElapsed"));this.getEntity().destroy()},__class__:Ia});var Zc=function(a,b,c){this._pointValue=10;Ia.call(this,a,b);this._pointValue=c};Zc.__name__=["game","dodgeGame","collectibles","Collectible"];Zc.__super__=Ia;Zc.prototype=p(Ia.prototype,{collect:function(a){this.createBurst(this.getEntity().getPosition());v.playSoundByName("ui_present_5");Ia.prototype.collect.call(this,a);a.dispatchEvent(new Xc("score",this._pointValue,this.getEntity().getPosition()))},
createBurst:function(a){if(null!=this.getEntity().getParent()){var b=this.getEntity().getParent().addEntity();b.setPosition(a.x,a.y);(new ua(b,"objectiveBurst")).setOnAnimationComplete(function(){b.destroy()})}},__class__:Zc});var of=function(a,b){Ia.call(this,a,b)};of.__name__=["game","dodgeGame","collectibles","HealthPack"];of.__super__=Ia;of.prototype=p(Ia.prototype,{collect:function(a){Ia.prototype.collect.call(this,a);a.dispatchEvent(new Sb("healthCollect"));v.playSoundByName("ui_cheese")},__class__:of});
var Qc=function(a,b,c){this._minDistanceFromOtherSpawns=0;this._firstItemSpawnTimeOffset=-8;this._maxTimeUntilItemSpawn=15;this._minTimeUntilItemSpawn=10;this._minNumItems=0;this._firstSpawn=!0;l.call(this,a);this._dodgeGameController=b;this._itemSpawns=c;this._itemSpawnChances=new se;a=0;for(b=this._itemSpawns.length;a<b;)c=a++,c=this._itemSpawns[c],this._itemSpawnChances.addEntry(c.get_spawnChance(),c);this._spawnedItems=[]};Qc.__name__=["game","dodgeGame","collectibles","ItemSpawner"];Qc.__super__=
l;Qc.prototype=p(l.prototype,{get_minNumItems:function(){return this._minNumItems},set_minNumItems:function(a){return this._minNumItems=a},get_minTimeUntilItemSpawn:function(){return this._minTimeUntilItemSpawn},set_minTimeUntilItemSpawn:function(a){return this._minTimeUntilItemSpawn=a},get_maxTimeUntilItemSpawn:function(){return this._maxTimeUntilItemSpawn},set_maxTimeUntilItemSpawn:function(a){return this._maxTimeUntilItemSpawn=a},get_firstItemSpawnTimeOffset:function(){return this._firstItemSpawnTimeOffset},
set_firstItemSpawnTimeOffset:function(a){return this._firstItemSpawnTimeOffset=a},get_minDistanceFromOtherSpawns:function(){return this._minDistanceFromOtherSpawns},set_minDistanceFromOtherSpawns:function(a){return this._minDistanceFromOtherSpawns=a},init:function(){l.prototype.init.call(this);this.rollNextCollectibleSpawn()},rollNextCollectibleSpawn:function(){0>this._maxTimeUntilItemSpawn||0>this._maxTimeUntilItemSpawn||(this._timeUntilNextItemSpawn=ja.randomFloat(this._minTimeUntilItemSpawn,this._maxTimeUntilItemSpawn),
this._firstSpawn&&(this._timeUntilNextItemSpawn+=this._firstItemSpawnTimeOffset))},update:function(){l.prototype.update.call(this);this._timeUntilNextItemSpawn-=n.getDeltaTime();if(0>=this._timeUntilNextItemSpawn)this.onTimeUntilItemElapse();else if(this._spawnedItems.length<this._minNumItems)this.onTimeUntilItemElapse()},onTimeUntilItemElapse:function(){if(this.isActive()){for(var a=this._dodgeGameController.get_gameplayContainer().getRandomEmptySpace(),b=this._spawnedItems.length,c=!0,d=0;100>=
d++&&c;)for(var c=!1,a=this._dodgeGameController.get_gameplayContainer().getRandomEmptySpace(),e=0,f=b;e<f;){var g=e++,g=this._spawnedItems[g].getEntity().getLocalPosition();(new L(g.x-a.x,g.y-a.y)).getLength()<=this._minDistanceFromOtherSpawns&&(c=!0)}a=this._itemSpawnChances.getRandomValue().spawn(this._dodgeGameController.get_gameplayContainer().get_gameplayLayer(),a.x,a.y);this._spawnedItems.push(a);a.addEventListener("destroy",q(this,this.onItemDestroy));this._dodgeGameController.get_gameplayContainer().registerItem(a);
this._firstSpawn=!1;this.rollNextCollectibleSpawn()}},onItemDestroy:function(a){if(this._spawnedItems.length-1<this._minNumItems)this.onTimeUntilItemElapse();F.remove(this._spawnedItems,a.target)},__class__:Qc,__properties__:{set_minDistanceFromOtherSpawns:"set_minDistanceFromOtherSpawns",get_minDistanceFromOtherSpawns:"get_minDistanceFromOtherSpawns",set_firstItemSpawnTimeOffset:"set_firstItemSpawnTimeOffset",get_firstItemSpawnTimeOffset:"get_firstItemSpawnTimeOffset",set_maxTimeUntilItemSpawn:"set_maxTimeUntilItemSpawn",
get_maxTimeUntilItemSpawn:"get_maxTimeUntilItemSpawn",set_minTimeUntilItemSpawn:"set_minTimeUntilItemSpawn",get_minTimeUntilItemSpawn:"get_minTimeUntilItemSpawn",set_minNumItems:"set_minNumItems",get_minNumItems:"get_minNumItems"}});var pf=function(a,b){Ia.call(this,a,b)};pf.__name__=["game","dodgeGame","collectibles","ScoreMultiplier"];pf.__super__=Ia;pf.prototype=p(Ia.prototype,{collect:function(a){Ia.prototype.collect.call(this,a);v.playSoundByName("ui_x2_1");a.dispatchEvent(new Xc("score",z.get_instance().get_levelsConfig().scoreMultiplierPointValue,
this.getEntity().getPosition()));a.addPowerupState(new nf(a,z.get_instance().get_levelsConfig().scoreMultiplierDuration,z.get_instance().get_levelsConfig().scoreMultiplierMultiple))},__class__:pf});var Fd=function(a){this._type=a};Fd.__name__=["game","dodgeGame","collectibles","TimedCollectibleEvent"];Fd.__super__=J;Fd.prototype=p(J.prototype,{__class__:Fd});var qf=function(a,b){Ia.call(this,a,b)};qf.__name__=["game","dodgeGame","collectibles","TrapPowerupItem"];qf.__super__=Ia;qf.prototype=p(Ia.prototype,
{__class__:qf});var eb=function(){};eb.__name__=["game","dodgeGame","collectibles","itemSpawns","ItemSpawn"];eb.prototype={get_spawnChance:function(){return 1},spawn:function(a,b,c){throw new P("Not Implemented");},__class__:eb,__properties__:{get_spawnChance:"get_spawnChance"}};var Ee=function(){};Ee.__name__=["game","dodgeGame","collectibles","itemSpawns","CollectibleItemSpawn"];Ee.__super__=eb;Ee.prototype=p(eb.prototype,{spawn:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=new Zc(a,
z.get_instance().get_levelsConfig().collectibleLifetime,z.get_instance().get_levelsConfig().basicCollectiblePointValue);c=a.addEntity();c=new A(c,"glowGreen");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;a=a.addEntity();c=new A(a,"collectible3");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;new vb(a,a.getPositionRef(),"y",-8,5,5);return b},__class__:Ee});var Re=function(){};Re.__name__=["game","dodgeGame","collectibles","itemSpawns","HealthPackItemSpawn"];Re.__super__=eb;Re.prototype=
p(eb.prototype,{spawn:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=new of(a,z.get_instance().get_levelsConfig().powerupLifetime);c=new A(a,"healthPack");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;return b},__class__:Re});var Se=function(){};Se.__name__=["game","dodgeGame","collectibles","itemSpawns","ScoreMultiplierItemSpawn"];Se.__super__=eb;Se.prototype=p(eb.prototype,{spawn:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=new pf(a,z.get_instance().get_levelsConfig().powerupLifetime);
c=a.addEntity();c=new A(c,"glowGreen");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;a=a.addEntity();a=new A(a,"scoreMultiplier");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;return b},__class__:Se});var Fe=function(){};Fe.__name__=["game","dodgeGame","collectibles","itemSpawns","SuperCollectibleItemSpawn"];Fe.__super__=eb;Fe.prototype=p(eb.prototype,{spawn:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=new Zc(a,z.get_instance().get_levelsConfig().collectibleLifetime,z.get_instance().get_levelsConfig().superCollectiblePointValue);
c=a.addEntity();c=new A(c,"glowGreen");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;a=a.addEntity();c=new A(a,"collectible1");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;new vb(a,a.getPositionRef(),"y",-8,5,5);return b},__class__:Fe});var He=function(){};He.__name__=["game","dodgeGame","collectibles","itemSpawns","TrapItemSpawn"];He.__super__=eb;He.prototype=p(eb.prototype,{spawn:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=new qf(a,z.get_instance().get_levelsConfig().powerupLifetime);
c=new A(a,"trap");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;return b},__class__:He});var Ge=function(){};Ge.__name__=["game","dodgeGame","collectibles","itemSpawns","UltraCollectibleItemSpawn"];Ge.__super__=eb;Ge.prototype=p(eb.prototype,{spawn:function(a,b,c){a=a.addEntity();a.setLocalPosition(b,c);b=new Zc(a,z.get_instance().get_levelsConfig().collectibleLifetime,z.get_instance().get_levelsConfig().ultraCollectiblePointValue);c=a.addEntity();c=new A(c,"glowGreen");c.getSprite().anchor.x=
0.5;c.getSprite().anchor.y=0.5;a=a.addEntity();c=new A(a,"collectible2");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;new vb(a,a.getPositionRef(),"y",-8,5,5);return b},__class__:Ge});var Cd=function(){this.movementSpeed=450};Cd.__name__=["game","dodgeGame","config","CharacterConfig"];Cd.prototype={parse:function(a){this.movementSpeed=a.movementSpeed},__class__:Cd};var z=function(){this._tomConfig=this._levelsConfig=this._playerConfig=this._obstacleConfigs=this._leaderboardConfig=null;z._instance=
this;this._playerConfig=new sg;this._playerConfig.parse(JSON.parse(H.getAsset("playerConfig")));this._levelsConfig=new tg;this._levelsConfig.parse(JSON.parse(H.getAsset("levelsConfig")));this._tomConfig=new ug;this._tomConfig.parse(JSON.parse(H.getAsset("tomConfig")));var a=JSON.parse(H.getAsset("character_config"));this._playerCharacterConfig=new Cd;this._playerCharacterConfig.parse(a.player);this._tomCharacterConfig=new Cd;this._tomCharacterConfig.parse(a.tom);this._flowConfig=new vg;this._flowConfig.parse(JSON.parse(H.getAsset("flow_config")));
this._obstacleConfigs=[];for(var a=JSON.parse(H.getAsset("obstacleConfig")),b=0,c=a.length;b<c;){var d=b++,e=new wg;e.parse(a[d]);this._obstacleConfigs.push(e)}this._leaderboardConfig=new xg;this._leaderboardConfig.parse(JSON.parse(H.getAsset("leaderboard_config")));console.log(this)};z.__name__=["game","dodgeGame","config","DodgeGameConfig"];z.__properties__={get_instance:"get_instance"};z.get_instance=function(){null==z._instance&&(z._instance=new z);return z._instance};z.prototype={get_flowConfig:function(){return this._flowConfig},
get_playerCharacterConfig:function(){return this._playerCharacterConfig},get_tomCharacterConfig:function(){return this._tomCharacterConfig},get_tomConfig:function(){return this._tomConfig},get_levelsConfig:function(){return this._levelsConfig},get_playerConfig:function(){return this._playerConfig},get_obstacleConfigs:function(){return this._obstacleConfigs},get_leaderboardConfig:function(){return this._leaderboardConfig},__class__:z,__properties__:{get_leaderboardConfig:"get_leaderboardConfig",get_obstacleConfigs:"get_obstacleConfigs",
get_playerConfig:"get_playerConfig",get_levelsConfig:"get_levelsConfig",get_tomConfig:"get_tomConfig",get_tomCharacterConfig:"get_tomCharacterConfig",get_playerCharacterConfig:"get_playerCharacterConfig",get_flowConfig:"get_flowConfig"}};var vg=function(){this.forceSimpleTransition=!0;this.respawnButtonSizeBuffer=100;this.skipInitialBackgroundSelect=this.skipStoryScreen=!0;this.skipBackgroundSelect=!1;this.enterGameplayDelay=this.leaveGameplayDelay=1;this.delayBeforeRespawn=this.delayBeforeLevelComplete=
this.delayBeforeNextRound=1.5;this.virtualControllerOnDesktop=this.virtualControllerOnMobile=this.trailControllerOnDesktop=this.trailControllerOnMobile=this.touchMovementOnMobile=this.touchMovementOnDesktop=!1};vg.__name__=["game","dodgeGame","config","FlowConfig"];vg.prototype={parse:function(a){this.virtualControllerOnDesktop=a.virtualControllerOnDesktop;this.virtualControllerOnMobile=a.virtualControllerOnMobile;this.trailControllerOnDesktop=a.trailControllerOnDesktop;this.trailControllerOnMobile=
a.trailControllerOnMobile;this.touchMovementOnDesktop=a.touchMovementOnDesktop;this.touchMovementOnMobile=a.touchMovementOnMobile;this.delayBeforeRespawn=a.delayBeforeRespawn;this.delayBeforeLevelComplete=a.delayBeforeLevelComplete;this.delayBeforeNextRound=a.delayBeforeNextRound;this.enterGameplayDelay=a.enterGameplayDelay;this.leaveGameplayDelay=a.leaveGameplayDelay;this.skipBackgroundSelect=a.skipBackgroundSelect;this.skipInitialBackgroundSelect=a.skipInitialBackgroundSelect;this.skipStoryScreen=
a.skipStoryScreen;this.respawnButtonSizeBuffer=a.respawnButtonSizeBuffer;this.forceSimpleTransition=a.forceSimpleTransition},__class__:vg};var xg=function(){};xg.__name__=["game","dodgeGame","config","LeaderboardConfig"];xg.prototype={parse:function(a){this.numEntries=a.numEntries;this.names=a.names;this.scores=a.scores},__class__:xg};var tg=function(){this.minNumPowerupsPresent=1;this.powerupLifetime=10;this.firstPowerupSpawnTimeOffset=-8;this.maxTimeUntilPowerupSpawn=15;this.minTimeUntilPowerupSpawn=
10;this.minSpawnDistanceFromOtherCollectibles=200;this.minNumCollectiblesPresent=1;this.collectibleLifetime=10;this.firstCollectibleSpawnTimeOffset=-8;this.maxTimeUntilCollectibleSpawn=15;this.minTimeUntilCollectibleSpawn=10;this.snowmanFreezeDuration=1.5;this.spilledMilkSlowModifier=0.5;this.spilledMilkSlowDuration=5;this.movingItemSpeed=150;this.numCollectiblesForHealthPack=10;this.numCollectiblesForScoreMultiplier=7;this.numCollectiblesForPowerup=5;this.scoreMultiplierDuration=10;this.scoreMultiplierMultiple=
2;this.scoreMultiplierPointValue=50;this.ultraCollectiblePointValue=30;this.superCollectiblePointValue=20;this.basicCollectiblePointValue=15;this.boundsPerspectiveWiden=100;this.bottomBound=250;this.topBound=-250;this.rightBound=250;this.leftBound=-250;this.numAdditionalObstaclesPerLevel=1;this.baseNumObstacles=2;this.maxEmptySpaceFindAttempts=100;this.levelsRequired=[0,15,25,35];this.numStages=4};tg.__name__=["game","dodgeGame","config","LevelsConfig"];tg.prototype={parse:function(a){this.numStages=
a.numStages;this.levelsRequired=a.levelsRequired;this.maxEmptySpaceFindAttempts=a.maxEmptySpaceFindAttempts;this.baseNumObstacles=a.baseNumObstacles;this.numAdditionalObstaclesPerLevel=a.numAdditionalObstaclesPerLevel;this.leftBound=a.leftBound;this.rightBound=a.rightBound;this.topBound=a.topBound;this.bottomBound=a.bottomBound;this.boundsPerspectiveWiden=a.boundsPerspectiveWiden;this.basicCollectiblePointValue=a.basicCollectiblePointValue;this.superCollectiblePointValue=a.superCollectiblePointValue;
this.ultraCollectiblePointValue=a.ultraCollectiblePointValue;this.scoreMultiplierPointValue=a.scoreMultiplierPointValue;this.scoreMultiplierMultiple=a.scoreMultiplierMultiple;this.scoreMultiplierDuration=a.scoreMultiplierDuration;this.numCollectiblesForPowerup=a.numCollectiblesForPowerup;this.numCollectiblesForScoreMultiplier=a.numCollectiblesForScoreMultiplier;this.numCollectiblesForHealthPack=a.numCollectiblesForHealthPack;this.movingItemSpeed=a.movingItemSpeed;this.spilledMilkSlowDuration=a.spilledMilkSlowDuration;
this.spilledMilkSlowModifier=a.spilledMilkSlowModifier;this.snowmanFreezeDuration=a.snowmanFreezeDuration;this.minTimeUntilCollectibleSpawn=a.minTimeUntilCollectibleSpawn;this.maxTimeUntilCollectibleSpawn=a.maxTimeUntilCollectibleSpawn;this.firstCollectibleSpawnTimeOffset=a.firstCollectibleSpawnTimeOffset;this.collectibleLifetime=a.collectibleLifetime;this.minNumCollectiblesPresent=a.minNumCollectiblesPresent;this.minSpawnDistanceFromOtherCollectibles=a.minSpawnDistanceFromOtherCollectibles;this.minTimeUntilPowerupSpawn=
a.minTimeUntilPowerupSpawn;this.maxTimeUntilPowerupSpawn=a.maxTimeUntilPowerupSpawn;this.firstPowerupSpawnTimeOffset=a.firstPowerupSpawnTimeOffset;this.powerupLifetime=a.powerupLifetime;this.minNumPowerupsPresent=a.minNumPowerupsPresent;this.backgroundLevelRequirements=a.backgroundLevelRequirements},__class__:tg};var wg=function(){this.hasPositionRange=!1;this.layer="gameplay"};wg.__name__=["game","dodgeGame","config","ObstacleConfig"];wg.prototype={parse:function(a){this.id=a.id;this.chanceToSpawn=
a.chanceToSpawn;this.timePerProjectileFire=a.timePerProjectileFire;this.projectileSpeed=a.projectileSpeed;this.colliderWidth=a.colliderWidth;this.colliderHeight=a.colliderHeight;null!=a.layer&&(this.layer=a.layer);null!=a.movementSpeed&&(this.movementSpeed=a.movementSpeed);null!=a.maxPerLevel&&(this.maxPerLevel=a.maxPerLevel);null!=a.positionRange&&(a=a.positionRange,this.hasPositionRange=!0,this.positionRangeMinX=a[0],this.positionRangeMinY=a[1],this.positionRangeMaxX=a[2],this.positionRangeMaxY=
a[3])},__class__:wg};var sg=function(){this.minMouseFollowDistance=15;this.stunPowerupDuration=5;this.playerGhostMobileSpeed=300;this.trapDizzyDuration=5;this.trapColliderWidth=this.trapColliderHeight=35;this.keyboardEnabled=!1;this.spacebarKey=32;this.rightKey=39;this.leftKey=37;this.downKey=40;this.upKey=38;this.powerupQueueSize=3;this.levelUpRequirementIncrementLevelCap=5;this.levelUpRequirementIncrementPerLevel=10;this.baseLevelUpRequirement=100;this.healthPackLives=1;this.itemPickupDuration=
0.25;this.itemCollectRadius=80;this.timeBeforeRespawn=1.5;this.initialLives=this.maxLives=3};sg.__name__=["game","dodgeGame","config","PlayerConfig"];sg.prototype={parse:function(a){this.initialLives=a.initialLives;this.maxLives=a.maxLives;this.timeBeforeRespawn=a.timeBeforeRespawn;this.itemCollectRadius=a.itemCollectRadius;this.itemPickupDuration=a.itemPickupDuration;this.healthPackLives=a.healthPackLives;this.baseLevelUpRequirement=a.baseLevelUpRequirement;this.levelUpRequirementIncrementPerLevel=
a.levelUpRequirementIncrementPerLevel;this.levelUpRequirementIncrementLevelCap=a.levelUpRequirementIncrementLevelCap;this.trapColliderWidth=a.trapColliderWidth;this.trapColliderHeight=a.trapColliderHeight;this.trapDizzyDuration=a.trapDizzyDuration;this.playerGhostMobileSpeed=a.playerGhostMobileSpeed;this.powerupQueueSize=a.powerupQueueSize;this.leftKey=a.leftKey;this.rightKey=a.rightKey;this.upKey=a.upKey;this.downKey=a.downKey;this.spacebarKey=a.spacebarKey;this.keyboardEnabled=a.keyboardEnabled;
this.minMouseFollowDistance=a.minMouseFollowDistance},getScoreRequiredForLevel:function(a){var b=0,c=this.baseLevelUpRequirement,d=0;for(a-=1;d<a;){var e=d++,b=b+c;e<this.levelUpRequirementIncrementLevelCap&&(c+=this.levelUpRequirementIncrementPerLevel)}return b},getLevelByScore:function(a){for(var b=0,c=0;++b,c=this.getScoreRequiredForLevel(b),a>=c;);return b-1},__class__:sg};var ug=function(){this.desiredTargetDistance=25};ug.__name__=["game","dodgeGame","config","TomConfig"];ug.prototype={parse:function(a){this.desiredTargetDistance=
a.desiredTargetDistance},__class__:ug};var K=function(a){this._eventListeners=[];this._dodgeGame=a};K.__name__=["game","dodgeGame","dodgeGameCommands","DodgeGameCommand"];K.__super__=gb;K.prototype=p(gb.prototype,{__class__:K});var Oe=function(a){K.call(this,a)};Oe.__name__=["game","dodgeGame","dodgeGameCommands","AdvanceLevelBackgroundCommand"];Oe.__super__=K;Oe.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);for(var a=this._dodgeGame.get_gameplayContainer().getBackground(),
b=[],c=0,d=z.get_instance().get_levelsConfig().backgroundLevelRequirements.length;c<d;){var e=c++;da.getInstance().getBackgroundUnlocked(e+1)&&(e="background"+(e+1),e!=a&&b.push(e))}0<b.length&&(a=ja.randomInt(0,b.length),this._dodgeGame.get_gameplayContainer().setBackground(b[a]));this.onComplete()},__class__:Oe});var Me=function(a){K.call(this,a)};Me.__name__=["game","dodgeGame","dodgeGameCommands","ClearGameplayCommand"];Me.__super__=K;Me.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);
this._dodgeGame.get_gameplayContainer().removeObstacles();this._dodgeGame.get_gameplayContainer().removeCharacters();this._dodgeGame.get_gameplayContainer().removeItems();this._dodgeGame.get_gameplayContainer().removeObjects();this.onComplete()},__class__:Me});var Je=function(a){K.call(this,a)};Je.__name__=["game","dodgeGame","dodgeGameCommands","RecordStatsCommand"];Je.__super__=K;Je.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);da.getInstance().setHighestLevel(this._dodgeGame.get_gameStats().get_currentLevel());
da.getInstance().addHighScore(this._dodgeGame.get_gameStats().get_numPoints())},__class__:Je});var rf=function(a){K.call(this,a)};rf.__name__=["game","dodgeGame","dodgeGameCommands","ReturnToTitleScreenCommand"];rf.__super__=K;rf.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);Fa.doTransition(this._dodgeGame.getGameState(),new Pb);this.onComplete()},__class__:rf});var sf=function(a,b){K.call(this,a);this._backgroundNumber=b};sf.__name__=["game","dodgeGame","dodgeGameCommands",
"ShowBackgroundUnlockedCommand"];sf.__super__=K;sf.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);this._dodgeGame.get_hud().getButtonGroup().setInputEnabled(!1);var a=this._dodgeGame.addEntity();new tf(a,this._backgroundNumber);a.addEventListener("destroy",q(this,this.onPopupDestroy))},onPopupDestroy:function(a){this.onComplete()},__class__:sf});var uf=function(a){K.call(this,a)};uf.__name__=["game","dodgeGame","dodgeGameCommands","ShowLeaderboardCommand"];uf.__super__=
K;uf.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);this._dodgeGame.get_hud().getButtonGroup().setInputEnabled(!1);var a=this._dodgeGame.addEntity();new Gd(a);a.addEventListener("destroy",q(this,this.onLeaderboardDestroy))},onLeaderboardDestroy:function(a){this.onComplete()},__class__:uf});var Ke=function(a){K.call(this,a)};Ke.__name__=["game","dodgeGame","dodgeGameCommands","ShowLevelCompleteCommand"];Ke.__super__=K;Ke.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);
this._dodgeGame.get_hud().getButtonGroup().setInputEnabled(!1);var a=this._dodgeGame.addEntity();new vf(a,this._dodgeGame);this.onComplete()},__class__:Ke});var xd=function(a,b){this._backgroundUnlocked=-1;K.call(this,a);this._backgroundUnlocked=b};xd.__name__=["game","dodgeGame","dodgeGameCommands","ShowNextLevelIntroCommand"];xd.__super__=K;xd.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);this._dodgeGame.disableItemSpawners();this._dodgeGame.get_hud().get_powerupsDisplay().get_buttonGroup().setInputEnabled(!1);
v.playSoundByName("ui_level_complete");var a=this._dodgeGame.addEntity(),b=new V(a),c=this._dodgeGame.get_uiPanel();new S(a,c);c=b.getContainer();I.addTweenToTarget(a,c,"alpha",0,1,0.4,B.easeOutQuad);var d=a.addEntity(),c=new A(d,"levelUpBanner");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;c=d.addEntity();c.setLocalPosition(0,-12);new aa(c,$a.replace(U.getString("GAMEPLAY_SCREEN_LEVEL"),"%N",pa.string(this._dodgeGame.get_gameStats().get_currentLevel())),{fontFamily:"luckiest_guyregular",
fill:"#FFFFFF",fontSize:48,stroke:0,strokeThickness:2});c=d.getPositionRef();I.addTweenToTarget(d,c,"y",-300,-12,0.4,B.easeOutBack);var e=a.addEntity();if(0<this._backgroundUnlocked){c=d.getPositionRef();I.addTweenToTarget(d,c,"y",d.getLocalPosition().y,-40,0.5,B.easeOutBack,0.8);e.setLocalPosition(0,45);c=new A(e,"roomUnlockBanner");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;c=e.addEntity();c.setLocalPosition(0,-10);var f={fontFamily:"curse_casualregular",fill:"#FFFFFF",fontSize:28};if("ja-jp"==
s.dataLocale||"pl-pl"==s.dataLocale||"ru-ru"==s.dataLocale)f.fontSize=20;var g=U.getString("GAMEPLAY_SCREEN_NEW_ROOM"),g=$a.replace(g,"%N",pa.string(this._backgroundUnlocked)),g=$a.replace(g,"%M",pa.string(z.get_instance().get_levelsConfig().backgroundLevelRequirements.length));new aa(c,g,f);e.setScale(0,0);c=e.getScaleRef();I.addTweenToTarget(e,c,"x",0,1,0.5,B.easeOutBack,0.8);c=e.getScaleRef();I.addTweenToTarget(e,c,"y",0,1,0.5,B.easeOutBack,0.8)}Cb.addDeferredActionToTarget(a,2.5,function(){var c=
e.getPositionRef();I.addTweenToTarget(e,c,"y",e.getLocalPosition().y,200,0.5,B.easeInBack);c=d.getPositionRef();I.addTweenToTarget(d,c,"y",d.getLocalPosition().y,-200,0.5,B.easeInBack);c=b.getContainer();I.addTweenToTarget(a,c,"alpha",1,0,0.5,B.easeInQuad)});this.onComplete()},onTweenComplete:function(){this._introRoot.destroy()},__class__:xd});var Ie=function(a){K.call(this,a)};Ie.__name__=["game","dodgeGame","dodgeGameCommands","ShowTutorialCommand"];Ie.__super__=K;Ie.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);
if(da.getInstance().hasSeenTutorial())this.onComplete();else{var a=this._dodgeGame.addEntity();new Hd(a);a.addEventListener("destroy",q(this,this.onHelpScreenDestroy))}},onHelpScreenDestroy:function(a){this.onComplete()},onComplete:function(){K.prototype.onComplete.call(this);da.getInstance().setSeenTutorial(!0)},__class__:Ie});var vd=function(a,b){this._popInSpacing=0.15;this._popInDuration=0.35;K.call(this,a);this._gameStats=b};vd.__name__=["game","dodgeGame","dodgeGameCommands","SpawnObstaclesCommand"];
vd.__super__=K;vd.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);this._numObstaclesSpawned=new Pa;for(var a=z.get_instance().get_levelsConfig(),b=0,a=a.baseNumObstacles+Math.floor(a.numAdditionalObstaclesPerLevel*(this._gameStats.get_currentLevel()-1));b<a;){var c=b++,d=this.getRandomObstacle(),e=null,e="ground"==d.layer?this._dodgeGame.get_gameplayContainer().get_groundLayer():this._dodgeGame.get_gameplayContainer().get_gameplayLayer(),f=new L;if(d.hasPositionRange){var g=
ja.randomFloat(d.positionRangeMinX,d.positionRangeMaxX),k=ja.randomFloat(d.positionRangeMinY,d.positionRangeMaxY);f.x=g;f.y=k}else f=this._dodgeGame.get_gameplayContainer().getRandomEmptySpace(d.colliderWidth,d.colliderHeight);e=Ga.createObstacleByConfig(d,e,f.x,f.y);e.getComponent(pb).update();this._dodgeGame.get_gameplayContainer().registerObstacle(e.getComponent(qb));I.addTweenToTarget(e,e.getScaleRef(),"x",0,e.getLocalScale().x,this._popInDuration,B.easeOutBack,c*this._popInSpacing);I.addTweenToTarget(e,
e.getScaleRef(),"y",0,e.getLocalScale().y,this._popInDuration,B.easeOutBack,c*this._popInSpacing);e.setScale(0,0);c=d.id;e=this._numObstaclesSpawned;(null!=ba[c]?e.existsReserved(c):e.h.hasOwnProperty(c))?(e=this._numObstaclesSpawned,d=c=d.id,f=this._numObstaclesSpawned,d=(null!=ba[d]?f.getReserved(d):f.h[d])+1,null!=ba[c]?e.setReserved(c,d):e.h[c]=d):(d=d.id,c=this._numObstaclesSpawned,null!=ba[d]?c.setReserved(d,1):c.h[d]=1)}this.onComplete()},getRandomObstacle:function(){for(var a=new se,b=0,c=
z.get_instance().get_obstacleConfigs().length;b<c;){var d=b++,d=z.get_instance().get_obstacleConfigs()[d],e;if(0<d.maxPerLevel){e=d.id;var f=this._numObstaclesSpawned;e=null!=ba[e]?f.existsReserved(e):f.h.hasOwnProperty(e)}else e=!1;if(e&&(e=d.id,f=this._numObstaclesSpawned,(null!=ba[e]?f.getReserved(e):f.h[e])>=d.maxPerLevel))continue;a.addEntry(d.chanceToSpawn,d)}return a.getRandomValue()},__class__:vd});var Le=function(a,b,c,d){null==d&&(d=!1);this._worldCoords=!1;K.call(this,a);this._x=b;this._y=
c;this._worldCoords=d};Le.__name__=["game","dodgeGame","dodgeGameCommands","SpawnPlayerCommand"];Le.__super__=K;Le.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);v.playSoundByName("ui_spawn");var a=Pc.createPlayer(this._dodgeGame.get_gameplayContainer().get_gameplayLayer(),this._dodgeGame,this._x,this._y);this._dodgeGame.get_gameplayContainer().assignPlayer(a);this._dodgeGame.get_gameplayContainer().registerCharacter(a.getComponent(Xa));this._dodgeGame.enableItemSpawners();
this._worldCoords&&a.setPosition(this._x,this._y);this.onComplete()},__class__:Le});var Sc=function(a,b,c){K.call(this,a);this._x=b;this._y=c};Sc.__name__=["game","dodgeGame","dodgeGameCommands","SpawnPlayerGhostCommand"];Sc.__super__=K;Sc.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);da.getInstance().setHasStartedGame(!0);this._ghost=Pc.createPlayerGhost(this._dodgeGame.get_gameplayContainer().get_gameplayLayer(),this._x,this._y);n.isMobile()?(new Uc(this._ghost,z.get_instance().get_playerConfig().playerGhostMobileSpeed,
"","")).set_scaleToDirection(!1):new Qe(this._ghost);this._dodgeGame.get_hud().getButtonGroup().setInputEnabled(!0);this._dodgeGame.addEventListener("startPlayerRespawn",q(this,this.onStartPlayerRespawn));this.onComplete()},onStartPlayerRespawn:function(a){this._dodgeGame.removeEventListener("startPlayerRespawn",q(this,this.onStartPlayerRespawn));this._ghost.destroy()},__class__:Sc});var Rc=function(a){K.call(this,a)};Rc.__name__=["game","dodgeGame","dodgeGameCommands","SpawnRespawnButtonCommand"];
Rc.__super__=K;Rc.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);this._respawnButton=this._dodgeGame.get_gameplayContainer().addEntity();var a=z.get_instance().get_levelsConfig().rightBound-z.get_instance().get_levelsConfig().leftBound+z.get_instance().get_flowConfig().respawnButtonSizeBuffer,b=z.get_instance().get_levelsConfig().bottomBound-z.get_instance().get_levelsConfig().topBound+z.get_instance().get_flowConfig().respawnButtonSizeBuffer;new qa(this._respawnButton,
new t(a,b),new t(0.5*a+z.get_instance().get_levelsConfig().leftBound,0.5*b+z.get_instance().get_levelsConfig().topBound));new Ze(this._respawnButton,this._dodgeGame);this._dodgeGame.addEventListener("startPlayerRespawn",q(this,this.onStartPlayerRespawn));this.onComplete()},onStartPlayerRespawn:function(a){this._dodgeGame.removeEventListener("startPlayerRespawn",q(this,this.onStartPlayerRespawn));this._respawnButton.destroy()},__class__:Rc});var ud=function(a,b,c){K.call(this,a);this._x=b;this._y=
c};ud.__name__=["game","dodgeGame","dodgeGameCommands","SpawnTomCommand"];ud.__super__=K;ud.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);var a=Pc.createTom(this._dodgeGame.get_gameplayContainer().get_gameplayLayer(),this._x,this._y);0<this._x&&a.getComponentsInChildren(ua)[0].getEntity().setLocalScale(-1,1);this._dodgeGame.get_gameplayContainer().registerCharacter(a.getComponent(Xa));this.onComplete()},__class__:ud});var Ne=function(a){K.call(this,a)};Ne.__name__=["game",
"dodgeGame","dodgeGameCommands","UpdateHudLevelRequirementCommand"];Ne.__super__=K;Ne.prototype=p(K.prototype,{execute:function(){K.prototype.execute.call(this);this._dodgeGame.get_hud().updateLevelRequirement()},__class__:Ne});var Ce=function(a,b){this._currentLevelRequirement=this._nextLevelRequirement=0;l.call(this,a);this._dodgeGameController=b;this._dodgeGameController.get_gameStats().addEventListener("scoreUpdate",q(this,this.onScoreUpdate));this._dodgeGameController.get_gameStats().addEventListener("livesUpdate",
q(this,this.onLivesUpdate));this._dodgeGameController.get_gameplayContainer().addEventListener("assign",q(this,this.onPlayerAssign));this._dodgeGameController.get_gameplayContainer().addEventListener("unassign",q(this,this.onPlayerUnassign));this._dodgeGameController.get_powerupController().addEventListener("enqueue",q(this,this.onEnqueuePowerup));this._dodgeGameController.get_powerupController().addEventListener("dequeue",q(this,this.onDequeuePowerup));this.construct()};Ce.__name__=["game","dodgeGame",
"hud","Hud"];Ce.__super__=l;Ce.prototype=p(l.prototype,{get_powerupsDisplay:function(){return this._powerupsDisplay},get_scoreDisplay:function(){return this._scoreDisplay},getButtonGroup:function(){return this._buttonGroup},init:function(){l.prototype.init.call(this);this.updateLevelRequirement()},updateLevelRequirement:function(){var a=z.get_instance().get_playerConfig();this._currentLevelRequirement=a.getScoreRequiredForLevel(this._dodgeGameController.get_gameStats().get_currentLevel());this._nextLevelRequirement=
a.getScoreRequiredForLevel(this._dodgeGameController.get_gameStats().get_currentLevel()+1);this.updateScore();this._levelDisplay.setCurrentLevel(this._dodgeGameController.get_gameStats().get_currentLevel())},construct:function(){this._uiPanel=ya.createFullscreenUiPanel(this.getGameState());var a=this.addEntity(),b=new A(a,"uiOverlay");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=new S(a,this._uiPanel);b.setCoords(new t(0,-1));b.setAlignment(va.Center,wa.Top);new Ob(a,new t(1024,576));a=
this.addEntity();b=new A(a,"uiOverlayFlipped");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=new S(a,this._uiPanel);b.setCoords(new t(0,1));b.setAlignment(va.Center,wa.Bottom);new Ob(a,new t(1024,576));this._buttonGroup=new dc(this._uiPanel.getEntity());a=new Ua;a.deactivateButtonOnClick=!1;a.x=0.93;a.y=-0.86;a.defaultImageName="pauseButton";this._pauseButton=sa.createButton(a,this._uiPanel.getEntity(),q(this,this.onPauseClick));a=this.addEntity();b=new S(a,this._uiPanel);b.setAlignment(va.Center,
wa.Bottom);b.setCoords(new t(0,1));b=new A(a,"scoreBar");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=a.addEntity();b.setLocalPosition(-281,7);new Mc(b,"levelBar",219,27,5,0,5,0);var c=a.addEntity();c.setLocalPosition(-280,-3);c=new A(c,"hudGifts");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;c=a.addEntity();c.setLocalPosition(170,7);var d={fontSize:24,fontFamily:"luckiest_guyregular",fill:"#FFD526"},e=c.addEntity();"pt-br"==s.dataLocale&&(d.fontSize=19);e=new aa(e,U.getString("GAMEPLAY_SCREEN_SCORE"),
d);e.getText().anchor.x=1;e.getText().anchor.y=0.5;d.fill="#FFFFFF";e=c.addEntity();e.setLocalPosition(5,0);if("zh-cn"==s.dataLocale||"ja-jp"==s.dataLocale)d.fontFamily="fornumber_font";e=new aa(e,"0",d);e.getText().anchor.x=0;e.getText().anchor.y=0.5;var f=c.addEntity();f.setLocalPosition(128,-25);f.setRotation(0,0,-20);new vb(f,f.getRotationRef(),"z",f.getRotationRef().z,9,4);d.fill="#FFD526";d.fontSize=46;d.stroke="#000000";d.strokeThickness=2;new aa(f,"x2",d);this._scoreDisplay=new wf(c,e,b,219,
f);b=this.addEntity();c=new S(b,this._uiPanel);c.setSize(new t(400,100));c.setAlignment(va.Center,wa.Top);c.setCoords(new t(0,-1));a=a.addEntity();c={fontSize:56,fontFamily:"luckiest_guyregular",fill:"#FFFFFF",stroke:"#000000",strokeThickness:2};if("zh-cn"==s.dataLocale||"ja-jp"==s.dataLocale)c.fontFamily="fornumber_font";a=new aa(a,"0",c);this._levelDisplay=new xf(b,a);this._levelDisplay.setCurrentLevel(this._dodgeGameController.get_gameStats().get_currentLevel());a=this.addEntity();b=new S(a,this._uiPanel);
b.setSize(new t(25,25));b.setAlignment(va.Left,wa.Top);b.setCoords(new t(-1,-1));a.addEntity();new A(a,"healthBar");this._livesDisplay=new yf(a,a);this._livesDisplay.setLives(this._dodgeGameController.get_gameStats().get_numLives());a=this.addEntity();b=new A(a,"powerContainer");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=new S(a,this._uiPanel);b.setAlignment(va.Center,wa.Top);b.setCoords(new t(0,-1));b=a.addEntity();b.setLocalPosition(0,-18);c={fontSize:32,fontFamily:"luckiest_guyregular",
fill:"#FFFFFF",stroke:"#000000",strokeThickness:1};if("zh-cn"==s.dataLocale||"ja-jp"==s.dataLocale)c.fontFamily="fornumber_font";b=new aa(b,"0/5",c);this._powerupsDisplay=new zf(a,this._dodgeGameController.get_powerupController(),b);this._powerupsDisplay.updateCounter(0,z.get_instance().get_levelsConfig().numCollectiblesForPowerup);a=z.get_instance().get_flowConfig();if(!n.isMobile()&&a.virtualControllerOnDesktop||n.isMobile()&&a.virtualControllerOnMobile)this._virtualController=new Af(this.getEntity(),
null);if(!n.isMobile()&&a.trailControllerOnDesktop||n.isMobile()&&a.trailControllerOnMobile)this._trailInputController=new Bf(this.getEntity(),null,this._dodgeGameController);this.updateScore()},onPlayerAssign:function(a){null!=this._virtualController&&this._virtualController.set_player(a.getCharacter());null!=this._trailInputController&&this._trailInputController.set_player(a.getCharacter())},onPlayerUnassign:function(a){null!=this._virtualController&&this._virtualController.set_player(null);null!=
this._trailInputController&&this._trailInputController.set_player(null)},onEnqueuePowerup:function(a){this._powerupsDisplay.enqueuePowerup(a.getPowerup())},onDequeuePowerup:function(a){this._powerupsDisplay.dequeuePowerup()},onScoreUpdate:function(){this.updateScore()},updateScore:function(){z.get_instance().get_playerConfig();this._scoreDisplay.setScore(this._dodgeGameController.get_gameStats().get_numPoints()-this._currentLevelRequirement,this._nextLevelRequirement-this._currentLevelRequirement);
this._powerupsDisplay.updateCounter(this._dodgeGameController.get_gameStats().get_numCollectiblesStreak()%z.get_instance().get_levelsConfig().numCollectiblesForPowerup,z.get_instance().get_levelsConfig().numCollectiblesForPowerup)},onLivesUpdate:function(){this._livesDisplay.setLives(this._dodgeGameController.get_gameStats().get_numLives())},onPauseClick:function(){this.dispatchEvent(new hc(hc.SHOW_MENU))},destroy:function(){l.prototype.destroy.call(this);null!=this._uiPanel&&this._uiPanel.getEntity().destroy()},
__class__:Ce,__properties__:{get_scoreDisplay:"get_scoreDisplay",get_powerupsDisplay:"get_powerupsDisplay"}});var hc=function(a){this._type=a};hc.__name__=["game","dodgeGame","hud","HudEvent"];hc.__super__=J;hc.prototype=p(J.prototype,{__class__:hc});var xf=function(a,b){this._lastLevel=-1;this._firstSet=!0;l.call(this,a);this._pixiText=b};xf.__name__=["game","dodgeGame","hud","LevelDisplay"];xf.__super__=l;xf.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this)},setCurrentLevel:function(a){a!=
this._lastLevel&&(this._pixiText.setTextString(null==a?"null":""+a),this._lastLevel=a,this._firstSet||(I.addTweenToTarget(this._pixiText.getEntity(),this._pixiText.getEntity().getScaleRef(),"x",0.2,1,0.25,B.easeOutBack),I.addTweenToTarget(this._pixiText.getEntity(),this._pixiText.getEntity().getScaleRef(),"y",0.2,1,0.25,B.easeOutBack)),this._firstSet=!1)},__class__:xf});var yf=function(a,b){this._firstFill=!0;this._cheeseSpacingX=34;this._cheeseStartY=35;this._cheeseStartX=105;l.call(this,a);this._cheeseContainer=
b;this._cheese=[]};yf.__name__=["game","dodgeGame","hud","LivesDisplay"];yf.__super__=l;yf.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this)},setLives:function(a){var b=this._cheese.length;if(a>b){var c=0;for(a-=b;c<a;){var d=c++,e=this._cheeseContainer.addEntity(),f=new A(e,"healthCheese");f.getSprite().anchor.x=0.5;f.getSprite().anchor.y=0.5;e.setLocalPosition(this._cheeseStartX+this._cheeseSpacingX*(b+d),this._cheeseStartY);this._cheese.push(e);this._firstFill||(I.addTweenToTarget(e,
e.getScaleRef(),"x",0,1,0.15,B.easeOutBack),I.addTweenToTarget(e,e.getScaleRef(),"y",0,1,0.15,B.easeOutBack))}this._firstFill=!1}else for(;0<=b--;)b>a-1&&(c=this._cheese[b],d=c.getComponent(A),F.remove(this._cheese,c),I.addTweenToTarget(c,c.getScaleRef(),"x",1,1.25,0.3,B.easeOutQuint),I.addTweenToTarget(c,c.getScaleRef(),"y",1,1.25,0.3,B.easeOutQuint),I.addTweenToTarget(c,d.getSprite(),"alpha",1,0,0.3,B.linear))},__class__:yf});var zf=function(a,b,c){this._powerupController=null;this._buttonAlphas=
[1,1,0.5];this._buttonScales=[1,1,0.65];this._buttonPositions=[new L(0,0),new L(-75,0),new L(-120,0)];this._spacingX=-75;this._startY=-4;this._startX=103;l.call(this,a);this._powerupButtons=[];this._powerupController=b;this._buttonGroup=new dc(this.getEntity());this._counterText=c;this._powerupController.addEventListener("powerupEarn",q(this,this.onPowerupEarn))};zf.__name__=["game","dodgeGame","hud","PowerupsDisplay"];zf.__super__=l;zf.prototype=p(l.prototype,{get_buttonGroup:function(){return this._buttonGroup},
init:function(){l.prototype.init.call(this);this.advancePowerups()},onPowerupEarn:function(a){this.earnNextPowerup()},enqueuePowerup:function(a){var b=this._powerupButtons.length;a=a.createSideButton(this.getEntity());var c=a.getComponent(V),d=this.getScaleForPowerup(b);a.setScale(d,d);c.getContainer().alpha=this.getAlphaForPowerup(b);b=this.getPositionForPowerup(b);a.setLocalPosition(b.x,b.y);a.getComponent(Ib).disableButton();this._powerupButtons.push(a)},dequeuePowerup:function(){var a=this._powerupButtons[0];
F.remove(this._powerupButtons,this._powerupButtons[0]);var b=a.getComponent(Ib);b.disableButton();var b=b.getComponent(V),c=a.getPositionRef(),d=a.getLocalPosition().x,e=a.getLocalPosition().x+50;I.addTweenToTarget(a,c,"x",d,e,0.35,B.easeInQuad);b=b.getContainer();I.addTweenToTarget(a,b,"alpha",1,0,0.35,B.linear,0,function(){a.destroy()})},getPositionForPowerup:function(a){a>this._buttonPositions.length-1&&(a=this._buttonPositions.length-1);return new L(this._startX+this._buttonPositions[a].x,this._startY+
this._buttonPositions[a].y)},getScaleForPowerup:function(a){a>this._buttonScales.length-1&&(a=this._buttonScales.length-1);return this._buttonScales[a]},getAlphaForPowerup:function(a){a>this._buttonAlphas.length-1&&(a=this._buttonAlphas.length-1);return this._buttonAlphas[a]},useCurrentPowerup:function(){this._powerupButtons[0].getComponent(Ib).use()},earnNextPowerup:function(){for(var a=0,b=this._powerupButtons.length;a<b;){var c=a++,d=this._powerupButtons[c].getComponent(Ib);if(!d.get_earned()){d.set_earned(!0);
0==c&&(d.enableButton(),null!=this._questionMark&&(I.addTweenToTarget(this._questionMark,this._questionMark.getScaleRef(),"x",1,0,0.35,B.easeInBack),I.addTweenToTarget(this._questionMark,this._questionMark.getScaleRef(),"y",1,0,0.35,B.easeInBack),(new rc(this._questionMark)).setAngularVelocity(new L(0,0,2048))));break}}},updateCounter:function(a,b){this._counterText.setTextString(a+"/"+b)},advancePowerups:function(){for(var a=0,b=this._powerupButtons.length;a<b;){var c=a++,d=this.getPositionForPowerup(c),
e=this.getScaleForPowerup(c),f=this.getAlphaForPowerup(c),g=this._powerupButtons[c],k=g.getComponent(Ib);0==c&&k.get_earned()&&k.enableButton();c=g.getComponent(V);I.addTweenToTarget(this.getEntity(),g.getPositionRef(),"x",g.getLocalPosition().x,d.x,0.35,B.easeInOutQuad);I.addTweenToTarget(this.getEntity(),g.getPositionRef(),"y",g.getLocalPosition().y,d.y,0.35,B.easeInOutQuad);I.addTweenToTarget(this.getEntity(),g.getScaleRef(),"x",g.getLocalScale().x,e,0.35,B.easeInOutQuad);I.addTweenToTarget(this.getEntity(),
g.getScaleRef(),"y",g.getLocalScale().y,e,0.35,B.easeInOutQuad);I.addTweenToTarget(this.getEntity(),c.getContainer(),"alpha",c.getContainer().alpha,f,0.35,B.easeInOutQuad)}this._questionMark=this.addEntity();this._questionMark.setLocalPosition(this.getPositionForPowerup(0).x+1,this.getPositionForPowerup(0).y-4);I.addTweenToTarget(this._questionMark,this._questionMark.getScaleRef(),"x",0,1,0.35,B.easeOutQuad);I.addTweenToTarget(this._questionMark,this._questionMark.getScaleRef(),"y",0,1,0.35,B.easeOutQuad);
a=new A(this._questionMark,"powerupQuestionMark");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5},destroy:function(){l.prototype.destroy.call(this);this._powerupController.removeEventListener("powerupEarn",q(this,this.onPowerupEarn))},__class__:zf,__properties__:{get_buttonGroup:"get_buttonGroup"}});var wf=function(a,b,c,d,e){this._maxValue=this._barWidth=this._barBaseX=this._barBaseY=0;this._scoreSpeed=20;this._displayedScore=this._targetScore=0;l.call(this,a);this._barWidth=d;this._pixiText=
b;this._slicedSprite=c.getComponentsInChildren(Mc)[0];this._barBaseX=c.getLocalPosition().x;this._barBaseY=c.getLocalPosition().y;this._scoreMultiplierTransform=e;this._scoreMultiplierTransform.setVisible(!1)};wf.__name__=["game","dodgeGame","hud","ScoreDisplay"];wf.__super__=l;wf.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this.updateDisplay()},postUpdate:function(){l.prototype.postUpdate.call(this);this._displayedScore!=this._targetScore&&(this._displayedScore+=Math.round(Math.max(1,
this._scoreSpeed*n.getDeltaTime())),this._displayedScore>=this._targetScore&&(this._displayedScore=this._targetScore),this.updateDisplay())},updateDisplay:function(){this._pixiText.setTextString(pa.string(this._displayedScore)+"/"+pa.string(this._maxValue));var a=this._barWidth*(this._displayedScore/this._maxValue),a=Math.max(8,a),a=Math.min(a,this._barWidth);this._slicedSprite.getEntity().setLocalPosition(this._barBaseX+0.5*a,this._barBaseY);this._slicedSprite.setWidth(a)},showMultiplier:function(){this._scoreMultiplierTransform.setVisible(!0);
I.addTweenToTarget(this._scoreMultiplierTransform,this._scoreMultiplierTransform.getScaleRef(),"x",0,1,0.35,B.easeOutBack);I.addTweenToTarget(this._scoreMultiplierTransform,this._scoreMultiplierTransform.getScaleRef(),"y",0,1,0.35,B.easeOutBack)},hideMultiplier:function(){this._scoreMultiplierTransform.setVisible(!1)},setScore:function(a,b){this._targetScore=a;this._maxValue=b},__class__:wf});var Bf=function(a,b,c){this._dragging=!1;this._maxPoints=150;this._spacingBetweenPoints=25;l.call(this,a);
this._dodgeGameController=c;this._trailPointEntities=[];this._trailPoints=[];this._moveCommand=new yc(b,new L);this._player=b};Bf.__name__=["game","dodgeGame","hud","TrailInputController"];Bf.__super__=l;Bf.prototype=p(l.prototype,{get_player:function(){return this._player},set_player:function(a){this._moveCommand.set_character(a);return this._player=a},init:function(){l.prototype.init.call(this);this._uiPanel=ya.createFullscreenUiPanel(this.getGameState());z.get_instance().get_levelsConfig();var a=
new Ua;a.overrideColliderSize=!0;a.overrideColliderSizeX=n.getInstance().getGameWidth();a.overrideColliderSizeY=n.getInstance().getGameHeight();a.blockClickThrough=!1;a.x=0;a.y=0;this._button=sa.createButton(a,this._uiPanel.getEntity()).getComponent(qa);this._button.setOnMouseDown(q(this,this.onMouseDown))},onMouseDown:function(){this.clearPoints();if(null!=this._player){var a=ea.getInstance().getMousePosition(),b=this._dodgeGameController.get_gameplayContainer().keepPositionInBounds(a.x,a.y,!0);
a.y==b.y&&(a.x=b.x,a.y=b.y,this.addPointsToPosition(a.x,a.y),this._dragging=!0)}},onMouseUp:function(){this._dragging=!1},onMouseMove:function(){if(this._dragging)if(null==this._player)this._dragging=!1,this.clearPoints();else{var a;a=0<this._trailPoints.length?this._trailPoints[this._trailPoints.length-1]:this._player.getEntity().getPosition();var b=ea.getInstance().getMousePosition(),c=this._dodgeGameController.get_gameplayContainer().keepPositionInBounds(b.x,b.y,!0);b.x=c.x;b.y=c.y;(new t(b.x-
a.x,b.y-a.y)).getLength()>=this._spacingBetweenPoints&&this.addPointsToPosition(b.x,b.y)}},addTrailPoint:function(a,b){if(!(this._trailPoints.length>=this._maxPoints)){var c=this._dodgeGameController.get_gameplayContainer().get_overlayLayer().addEntity(),d=new A(c,"pathDot");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;c.setPosition(a,b);this._trailPointEntities.push(c);this._trailPoints.push(new L(a,b))}},addPointsToPosition:function(a,b){var c;c=0<this._trailPoints.length?this._trailPoints[this._trailPoints.length-
1]:this._player.getEntity().getPosition();var d=new L(a-c.x,b-c.y),e=d.getLength(),e=Math.max(1,Math.ceil(e/this._spacingBetweenPoints))|0,d=d.getNormalized();d.x*=this._spacingBetweenPoints;d.y*=this._spacingBetweenPoints;var f=c.x;c=c.y;for(var g=0;g<e;)g++,f+=d.x,c+=d.y,this.addTrailPoint(f,c)},clearPoints:function(){for(var a=0,b=this._trailPointEntities;a<b.length;){var c=b[a];++a;c.destroy()}this._trailPointEntities=[];this._trailPoints=[]},update:function(){l.prototype.update.call(this);if(!this._dragging&&
ea.getInstance().isLeftMouseDown())this.onMouseDown()},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);if(null==this._player)0<this._trailPoints.length&&this.clearPoints();else if(0<this._trailPoints.length){var a=this._trailPoints[0],b=this._player.getEntity().getPosition(),a=new L(a.x-b.x,a.y-b.y);a.getLength()>=this._player.get_characterConfig().movementSpeed*n.getDeltaTime()?(a=a.getNormalized(),this._moveCommand.get_direction().x=a.x,this._moveCommand.get_direction().y=a.y,this._moveCommand.execute()):
this.removeFirstPoint()}},removeFirstPoint:function(){this._trailPointEntities[0].destroy();this._trailPointEntities.splice(0,1);this._trailPoints.splice(0,1)},handleMessage:function(a,b){l.prototype.handleMessage.call(this,a,b);switch(a){case "mouseMove":this.onMouseMove();break;case "mouseUp":this.onMouseUp()}},__class__:Bf,__properties__:{set_player:"set_player",get_player:"get_player"}});var Af=function(a,b){this._upPressed=this._downPressed=this._leftPressed=this._rightPressed=!1;l.call(this,
a);this._moveCommand=new yc(b,new L);this._player=b};Af.__name__=["game","dodgeGame","hud","VirtualController"];Af.__super__=l;Af.prototype=p(l.prototype,{get_player:function(){return this._player},set_player:function(a){this._moveCommand.set_character(a);return this._player=a},init:function(){l.prototype.init.call(this);this._uiPanel=ya.createFullscreenUiPanel(this.getGameState());var a=this.addEntity(),b=new A(a,"virtualDpad");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=new S(a,this._uiPanel);
b.setScale(1.25,1.25);b.setCoords(new t(-0.95,0.95));b.setAlignment(va.Left,wa.Bottom);b=new Ua;b.overrideColliderSize=!0;b.overrideColliderSizeX=175;b.overrideColliderSizeY=175;b.x=0;b.y=-90;this._upButton=sa.createButton(b,a).getComponent(qa);this._upButton.setOnMouseDown(q(this,this.onUpButtonDown));this._upButton.setOnMouseMoved(q(this,this.onUpButtonDown));this._upButton.setOnMouseUp(q(this,this.onUpButtonUp));this._upButton.setOnMouseOut(q(this,this.onUpButtonUp));b.x=0;b.y=90;this._downButton=
sa.createButton(b,a).getComponent(qa);this._downButton.setOnMouseDown(q(this,this.onDownButtonDown));this._downButton.setOnMouseMoved(q(this,this.onDownButtonDown));this._downButton.setOnMouseUp(q(this,this.onDownButtonUp));this._downButton.setOnMouseOut(q(this,this.onDownButtonUp));b.x=-90;b.y=0;this._leftButton=sa.createButton(b,a).getComponent(qa);this._leftButton.setOnMouseDown(q(this,this.onLeftButtonDown));this._leftButton.setOnMouseMoved(q(this,this.onLeftButtonDown));this._leftButton.setOnMouseUp(q(this,
this.onLeftButtonUp));this._leftButton.setOnMouseOut(q(this,this.onLeftButtonUp));b.x=90;b.y=0;this._rightButton=sa.createButton(b,a).getComponent(qa);this._rightButton.setOnMouseDown(q(this,this.onRightButtonDown));this._rightButton.setOnMouseMoved(q(this,this.onRightButtonDown));this._rightButton.setOnMouseUp(q(this,this.onRightButtonUp));this._rightButton.setOnMouseOut(q(this,this.onRightButtonUp))},onUpButtonDown:function(){this._upPressed=!0},onUpButtonUp:function(){this._upPressed=!1},onDownButtonDown:function(){this._downPressed=
!0},onDownButtonUp:function(){this._downPressed=!1},onLeftButtonDown:function(){this._leftPressed=!0},onLeftButtonUp:function(){this._leftPressed=!1},onRightButtonDown:function(){this._rightPressed=!0},onRightButtonUp:function(){this._rightPressed=!1},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);ea.getInstance().isLeftMouseDown()||(this._downPressed=this._upPressed=this._rightPressed=this._leftPressed=!1);if(null!=this._player){var a=new L;this._upPressed&&(a.y-=1);this._downPressed&&
(a.y+=1);this._leftPressed&&(a.x-=1);this._rightPressed&&(a.x+=1);a=a.getNormalized();0<a.getLength()&&(this._moveCommand.get_direction().x=a.x,this._moveCommand.get_direction().y=a.y,this._moveCommand.execute())}},__class__:Af,__properties__:{set_player:"set_player",get_player:"get_player"}});var Cf=function(a,b){this.name=a;this.score=b};Cf.__name__=["game","dodgeGame","leaderboard","LeaderboardEntry"];Cf.prototype={__class__:Cf};var gc=function(a){l.call(this,a)};gc.__name__=["game","dodgeGame",
"obstacles","DamagePlayerOnContact"];gc.__super__=l;gc.prototype=p(l.prototype,{onEnter:function(a){if(a.hasTag("player")){a=a.getComponent(Xa);var b=new xc;a.get_damageStateMachine().inflictDamage(b)}},onExit:function(a){},__class__:gc});var Va={__ename__:!0,__constructs__:["Left","Right"],Left:["Left",0]};Va.Left.__enum__=Va;Va.Right=["Right",1];Va.Right.__enum__=Va;Va.__empty_constructs__=[Va.Left,Va.Right];var Ya={__ename__:!0,__constructs__:["Up","Down"],Up:["Up",0]};Ya.Up.__enum__=Ya;Ya.Down=
["Down",1];Ya.Down.__enum__=Ya;Ya.__empty_constructs__=[Ya.Up,Ya.Down];var Uc=function(a,b,c,d){this._scaleToDirection=!0;this._stunDurationLeft=0;l.call(this,a);this._movementSpeed=b;this._xMin=z.get_instance().get_levelsConfig().leftBound;this._xMax=z.get_instance().get_levelsConfig().rightBound;this._yMin=z.get_instance().get_levelsConfig().topBound;this._yMax=z.get_instance().get_levelsConfig().bottomBound;this._upAnimation=c;this._downAnimation=d};Uc.__name__=["game","dodgeGame","obstacles",
"DiagonalBouncingMovement"];Uc.__super__=l;Uc.prototype=p(l.prototype,{get_scaleToDirection:function(){return this._scaleToDirection},set_scaleToDirection:function(a){return this._scaleToDirection=a},init:function(){l.prototype.init.call(this);this._animation=this.getEntity().getComponentsInChildren(ua)[0];this._horizontalDirection=0.5>ja.randomFloat(0,1)?Va.Right:Va.Left;this._verticalDirection=0.5>ja.randomFloat(0,1)?Ya.Up:Ya.Down;this.updateDirection();var a=this.getEntity().getComponent(db);null!=
a&&a.addEventListener("stun",q(this,this.onStun))},onStun:function(a){this._stunDurationLeft=a.get_duration()},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);if(0<this._stunDurationLeft)this._stunDurationLeft-=n.getDeltaTime(),0>=this._stunDurationLeft&&(this._stunDurationLeft=0);else{var a=new t;this._horizontalDirection==Va.Right?a.x=1:this._horizontalDirection==Va.Left&&(a.x=-1);this._verticalDirection==Ya.Down?a.y=1:this._verticalDirection==Ya.Up&&(a.y=-1);a=a.getNormalized();this.getEntity().translate(a.x*
this._movementSpeed*n.getDeltaTime(),a.y*this._movementSpeed*n.getDeltaTime());a=this.getEntity().getLocalPosition();this._horizontalDirection==Va.Right?a.x>=this._xMax&&(this._horizontalDirection=Va.Left,this.updateDirection()):a.x<=this._xMin&&(this._horizontalDirection=Va.Right,this.updateDirection());this._verticalDirection==Ya.Down?a.y>=this._yMax&&(this._verticalDirection=Ya.Up,this.updateDirection()):a.y<=this._yMin&&(this._verticalDirection=Ya.Down,this.updateDirection())}},updateDirection:function(){if(null!=
this._animation){if(this.get_scaleToDirection()){var a=this._horizontalDirection==Va.Left?-1:1;this._animation.getEntity().setLocalScale(a,1)}this._animation.setAnimation(this._verticalDirection==Ya.Up?this._upAnimation:this._downAnimation)}else if(a=this.getEntity().getComponentsInChildren(V)[0],this.get_scaleToDirection()){var b=this._horizontalDirection==Va.Left?-1:1;a.getEntity().setLocalScale(b,1)}},__class__:Uc,__properties__:{set_scaleToDirection:"set_scaleToDirection",get_scaleToDirection:"get_scaleToDirection"}});
var Ve=function(a,b){l.call(this,a);this._freezeDuration=b};Ve.__name__=["game","dodgeGame","obstacles","FreezePlayerOnContact"];Ve.__super__=l;Ve.prototype=p(l.prototype,{onEnter:function(a){if(a.hasTag("player")){a=a.getComponent(Xa);var b=new xc;b.damage=0;b.freezeDuration=this._freezeDuration;a.get_damageStateMachine().inflictDamage(b)}},onExit:function(a){},__class__:Ve});var Id=function(a,b){this._type=a;this._obstacle=b};Id.__name__=["game","dodgeGame","obstacles","GenerateObstacleEvent"];
Id.__super__=J;Id.prototype=p(J.prototype,{get_obstacle:function(){return this._obstacle},__class__:Id,__properties__:{get_obstacle:"get_obstacle"}});var jb={__ename__:!0,__constructs__:["Left","Right"],Left:["Left",0]};jb.Left.__enum__=jb;jb.Right=["Right",1];jb.Right.__enum__=jb;jb.__empty_constructs__=[jb.Left,jb.Right];var We=function(a,b){this._stunDurationLeft=0;l.call(this,a);this._movementSpeed=b;this._xMin=z.get_instance().get_levelsConfig().leftBound;this._xMax=z.get_instance().get_levelsConfig().rightBound};
We.__name__=["game","dodgeGame","obstacles","GingerbreadMan"];We.__super__=l;We.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this._animation=this.getEntity().getComponentsInChildren(ua)[0];this._direction=0.5>ja.randomFloat(0,1)?jb.Right:jb.Left;this.updateDirection();this.getEntity().getComponent(db).addEventListener("stun",q(this,this.onStun))},onStun:function(a){this._stunDurationLeft=a.get_duration()},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);0<this._stunDurationLeft?
(this._stunDurationLeft-=n.getDeltaTime(),0>=this._stunDurationLeft&&(this._stunDurationLeft=0)):this._direction==jb.Right?(this.getEntity().translate(this._movementSpeed*n.getDeltaTime()),this.getEntity().getLocalPosition().x>=this._xMax&&(this._direction=jb.Left,this.updateDirection())):(this.getEntity().translate(-this._movementSpeed*n.getDeltaTime()),this.getEntity().getLocalPosition().x<=this._xMin&&(this._direction=jb.Right,this.updateDirection()))},updateDirection:function(){var a=this._direction==
jb.Left?-1:1;this._animation.getEntity().setLocalScale(a,1)},__class__:We});var qb=function(a){l.call(this,a)};qb.__name__=["game","dodgeGame","obstacles","Obstacle"];qb.__super__=l;qb.prototype=p(l.prototype,{get_collider:function(){null==this._collider&&(this._collider=this.getComponent(pb));return this._collider},init:function(){l.prototype.init.call(this)},fireGenerateObstacleEvent:function(a){this.dispatchEvent(new Id("generate",a))},__class__:qb,__properties__:{get_collider:"get_collider"}});
var Ad=function(a,b,c){this._timeUntilNextShot=this._timeUntilProjectile=this._stunDurationLeft=0;l.call(this,a);this._obstacleConfig=b;this._fireDirection=c};Ad.__name__=["game","dodgeGame","obstacles","SlingshotGingerbreadMan"];Ad.__super__=l;Ad.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this._timeUntilNextShot=this._obstacleConfig.timePerProjectileFire;this._pixiAnimation=this.getEntity().getComponentsInChildren(ua)[0];this.getEntity().getComponent(db).addEventListener("stun",
q(this,this.onStun))},onStun:function(a){this._stunDurationLeft=a.get_duration();this._pixiAnimation.stop()},fixedUpdate:function(){l.prototype.fixedUpdate.call(this);if(0<this._stunDurationLeft){if(this._stunDurationLeft-=n.getDeltaTime(),0>=this._stunDurationLeft)this.onStunElapse()}else{this._timeUntilNextShot-=n.getDeltaTime();if(0>=this._timeUntilNextShot)this.onTimeUntilNextShotElapse();if(0<this._timeUntilProjectile&&(this._timeUntilProjectile-=n.getDeltaTime(),0>=this._timeUntilProjectile))this.onProjectileTimeElapse()}},
onStunElapse:function(){this._pixiAnimation.play()},onTimeUntilNextShotElapse:function(){this._pixiAnimation.setPosition(0);this._pixiAnimation.play();this._timeUntilProjectile=0.5;this._timeUntilNextShot=this._obstacleConfig.timePerProjectileFire},onProjectileTimeElapse:function(){var a=this.getEntity().getPosition(),b=this.getEntity().getParent().addEntity();b.addTag("obstacle");b.addTag("projectile");var c=new gc(b);b.setPosition(a.x,a.y);a=new A(b,"ornamentSlingshot");a.getSprite().anchor.x=0.5;
a.getSprite().anchor.y=0.5;var d=new Ea;d.wh.x=1.5*a.getSprite().width;d.wh.y=1.5*a.getSprite().height;a=new Ta(b,d);d=(new t(this._fireDirection.x,this._fireDirection.y)).getNormalized();d.x*=this._obstacleConfig.projectileSpeed;d.y*=this._obstacleConfig.projectileSpeed;var e=new rc(b);e.setVelocity(d.x,d.y);e.setAngularVelocity(new L(0,0,1080));b=new qb(b);a.setOnEnter(q(c,c.onEnter));a.setOnExit(q(c,c.onExit));this.getComponent(qb).fireGenerateObstacleEvent(b)},__class__:Ad});var Ue=function(a,
b){l.call(this,a);this._slowDuration=b};Ue.__name__=["game","dodgeGame","obstacles","SlowPlayerOnContact"];Ue.__super__=l;Ue.prototype=p(l.prototype,{onEnter:function(a){if(a.hasTag("player")){a=a.getComponent(Xa);var b=new xc;b.damage=0;b.slowDuration=this._slowDuration;a.get_damageStateMachine().inflictDamage(b)}},onExit:function(a){},__class__:Ue});var wb=function(a){this._eventListeners=[];this._dodgeGameController=a};wb.__name__=["game","dodgeGame","powerups","Powerup"];wb.__super__=Ca;wb.prototype=
p(Ca.prototype,{createSideButton:function(a){throw new P("Not implemented");},use:function(){this.dispatchEvent(new Jd("use",this))},__class__:wb});var Ye=function(a){wb.call(this,a)};Ye.__name__=["game","dodgeGame","powerups","FreezePowerup"];Ye.__super__=wb;Ye.prototype=p(wb.prototype,{createSideButton:function(a){var b=new Ua;b.defaultImageName="freezePowerup";a=sa.createButton(b,a);new Ib(a,this);return a},use:function(){wb.prototype.use.call(this);this._dodgeGameController.get_gameplayContainer().get_gameplayLayer().addEntity();
for(var a=this._dodgeGameController.get_gameplayContainer().get_gameplayLayer().getComponentsInChildren(db),b=0;b<a.length;){var c=a[b];++b;c.stun(z.get_instance().get_playerConfig().stunPowerupDuration)}a=this._dodgeGameController.get_gameplayContainer().get_player().getComponent(Xa);a.addPowerupState(new mf(a,z.get_instance().get_playerConfig().stunPowerupDuration));Pe.createFreezeWipeEffect(this._dodgeGameController.get_gameplayContainer().get_overlayLayer(),0,0,z.get_instance().get_playerConfig().stunPowerupDuration);
v.playSoundByName("sfx_cold_throw")},__class__:Ye});var Ib=function(a,b){this._unearnedColor=8947848;this._earnedColor=16777215;this._earned=!1;l.call(this,a);this._powerup=b;this._powerup.addEventListener("use",q(this,this.onPowerupUse))};Ib.__name__=["game","dodgeGame","powerups","PowerupButton"];Ib.__super__=l;Ib.prototype=p(l.prototype,{get_earned:function(){return this._earned},set_earned:function(a){null==this._pixiSprite&&(this._pixiSprite=this.getComponent(A));a?(this._pixiSprite.getSprite().tint=
this._earnedColor,this._pixiSprite.setActive(!0)):(this._pixiSprite.getSprite().tint=this._unearnedColor,this._pixiSprite.setActive(!1));return this._earned=a},init:function(){l.prototype.init.call(this);this._button=this.getComponent(qa);this._button.setOnMouseDown(q(this,this.onClick));this._pixiSprite=this.getComponent(A);this._pixiSprite.setActive(!1)},enableButton:function(){null==this._button&&(this._button=this.getComponent(qa));this._button.setActive(!0);I.addTweenToTarget(this.getEntity(),
this.getEntity().getScaleRef(),"x",0,1,0.15,B.easeOutBack);I.addTweenToTarget(this.getEntity(),this.getEntity().getScaleRef(),"y",0,1,0.15,B.easeOutBack);this._arrow=this.addEntity();this._arrow.setLocalPosition(50,-5);var a=new A(this._arrow,"powerupArrow");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;new vb(this._arrow,this._arrow.getPositionRef(),"x",50,10,4.5,!0);new vb(this._arrow,this._arrow.getScaleRef(),"x",1,0.25,4.5,!0);new vb(this._arrow,this._arrow.getScaleRef(),"y",1,0.25,4.5,
!0,Math.PI)},disableButton:function(){null==this._button&&(this._button=this.getComponent(qa));null!=this._arrow&&this._arrow.destroy();null==this._pixiSprite&&(this._pixiSprite=this.getComponent(A));this._button.setActive(!1)},use:function(){this._button.isActive()&&this._powerup.use()},onPowerupUse:function(){this.disableButton()},onClick:function(){this._powerup.use()},destroy:function(){l.prototype.destroy.call(this);this._powerup.removeEventListener("use",q(this,this.onPowerupUse))},__class__:Ib,
__properties__:{set_earned:"set_earned",get_earned:"get_earned"}});var Jd=function(a,b){this._type=a;this._powerup=b};Jd.__name__=["game","dodgeGame","powerups","PowerupEvent"];Jd.__super__=J;Jd.prototype=p(J.prototype,{getPowerup:function(){return this._powerup},__class__:Jd});var Df=function(a){l.call(this,a)};Df.__name__=["game","dodgeGame","powerups","Trap"];Df.__super__=l;Df.prototype=p(l.prototype,{onEnter:function(a){var b=this;if(a.hasTag("tom")){a=a.getComponent(Xa);var c=new xc;c.dizzyDuration=
z.get_instance().get_playerConfig().trapDizzyDuration;a.get_damageStateMachine().inflictDamage(c);v.playSoundByName("sfx_trap_activate");v.playSoundByName("sfx_tom_hit_2");a=this.getEntity().getComponentsInChildren(ua)[0];a.setAnimation("santaBoxActivated");a.setOnAnimationComplete(function(){b.getEntity().destroy()})}},onExit:function(a){},__class__:Df});var Xe=function(a){wb.call(this,a)};Xe.__name__=["game","dodgeGame","powerups","TrapPowerup"];Xe.__super__=wb;Xe.prototype=p(wb.prototype,{createSideButton:function(a){var b=
new Ua;b.defaultImageName="santaPowerup";a=sa.createButton(b,a);new Ib(a,this);return a},use:function(){wb.prototype.use.call(this);var a=this._dodgeGameController.get_gameplayContainer().get_groundLayer().addEntity();this._dodgeGameController.get_gameplayContainer().registerObject(a);a.addTag("trap");var b=a.addEntity(!0),b=new A(b,"glowRed");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=a.addEntity(!0);this._animation=new ua(b,"santaBoxIdle");var b=z.get_instance().get_playerConfig(),
c=new Ea;c.wh=new t(b.trapColliderWidth,b.trapColliderHeight);b=new Ta(a,c);this._trap=new Df(a);b.setOnEnter((Ma=this._trap,q(Ma,Ma.onEnter)));b.setOnExit((Ma=this._trap,q(Ma,Ma.onExit)));b=this._dodgeGameController.get_gameplayContainer().get_player().getPosition();a.setPosition(b.x,b.y);v.playSoundByName("sfx_trap_throw")},__class__:Xe});var Kd=function(){this._level=null;X.call(this)};Kd.__name__=["game","screens","GameplayScreen"];Kd.__super__=X;Kd.prototype=p(X.prototype,{init:function(){X.prototype.init.call(this);
var a=this.addEntity();this._level=new De(a);v.stopMusic();v.playMusicByName("mx_gameplay_1")},__class__:Kd});var Oc=function(a,b){null==b&&(b=!0);this._transitionIn=!0;this._hasTransitionedIn=this._hasCompleted=this._transitioningOut=!1;X.call(this);this._loadBatch=a;this._transitionIn=b};Oc.__name__=["game","screens","LoadingScreen"];Oc.__super__=X;Oc.prototype=p(X.prototype,{init:function(){var a=this;X.prototype.init.call(this);this._uiPanel=ya.createFullscreenUiPanel(this);this._pixiSprite=new V(this._uiPanel.getEntity());
var b=this._uiPanel.addEntity();new S(b,this._uiPanel);new Ob(b,new t(1024,576));this._left=b.addEntity();var c=new A(this._left,"wreathLeft");c.getSprite().anchor.x=1;c.getSprite().anchor.y=0.5;this._right=b.addEntity();b=new A(this._right,"wreathRight");b.getSprite().anchor.x=0;b.getSprite().anchor.y=0.5;this._tweener=new I(this._uiPanel.getEntity());this._tweener.addTween(this._left.getPositionRef(),"x",-1024,279,0.5,B.easeOutQuad,0,function(){a.onEnterComplete()});this._tweener.addTween(this._right.getPositionRef(),
"x",1024,-279,0.5,B.easeOutQuad,0);this._loadingRoot=this.addEntity();(new S(this._loadingRoot,this._uiPanel)).setScale(0,0);b=this._loadingRoot.addEntity();c=new A(b,"loadingLogo");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;c=this.addEntity();b.addChild(c);c.setLocalPosition(-158,13,0);b=new A(c,"loadingMan");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=this._loadingRoot.addEntity();b.setLocalPosition(0,90);c=new A(b,"loadingBarBG");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=
0.5;this._loadingBar=this.addEntity();b.addChild(this._loadingBar);this._loadingBar.setLocalPosition(-120,-23,0);this._loadingBar.setLocalPosition(0,0);this._slicedSprite=new Mc(this._loadingBar,"loadingBar",241,43,16,0,16,0);b=this.addEntity();new aa(b,"x",{fontFamily:"luckiest_guyregular"});b=this.addEntity();new aa(b,"x",{fontFamily:"curse_casualregular"});b=this.addEntity();new aa(b,"x",{fontFamily:"fornumber_font"});this._transitionIn||this._tweener.skipAll()},onEnterComplete:function(){var a=
this,b=this._loadingRoot.getComponent(S);this._tweener.addTween(b.getScaleRef(),"x",0,1,0.35,B.easeOutQuad);this._tweener.addTween(b.getScaleRef(),"y",0,1,0.35,B.easeOutQuad,0,function(){a._hasTransitionedIn=!0});this._transitionIn||this._tweener.skipAll()},render:function(){X.prototype.render.call(this);null!=this._pixiSprite&&this._pixiSprite.bringToFront()},update:function(){var a=this;X.prototype.update.call(this);F.remove(n.getInstance().getGameStates(),this);n.getInstance().getGameStates().push(this);
this._hasCompleted=this._loadBatch.getLoadComplete();if(this._hasTransitionedIn&&this._hasCompleted&&!this._transitioningOut){this._transitioningOut=!0;this._tweener.skipAll();this._tweener.addTween(this._left.getPositionRef(),"x",279,-1024,0.5,B.easeInQuad,0,function(){a.onExitComplete()});this._tweener.addTween(this._right.getPositionRef(),"x",-279,1024,0.5,B.easeInQuad,0);var b=this._loadingRoot.getComponent(S);this._tweener.addTween(b.getScaleRef(),"x",1,0,0.35,B.easeInQuad);this._tweener.addTween(b.getScaleRef(),
"y",1,0,0.35,B.easeInQuad);this.dispatchEvent(new Ld("complete"))}},onExitComplete:function(){this.destroy()},onFileLoaded:function(a,b){null!=this._loadingBar&&this.updateLoadingMeter(a/b)},updateLoadingMeter:function(a){null!=this._slicedSprite&&(a=241*Math.min(1,a),this._slicedSprite.setWidth(a),this._slicedSprite.getEntity().setLocalPosition(-120.5+0.5*a,0))},handleMessage:function(a,b){X.prototype.handleMessage.call(this,a,b);if("onFileLoaded"==a)this.onFileLoaded(b.progress,b.total)},__class__:Oc});
var Ld=function(a){this._type=a};Ld.__name__=["game","screens","LoadingScreenEvent"];Ld.__super__=J;Ld.prototype=p(J.prototype,{__class__:Ld});var Tc=function(a){X.call(this);this._parentState=a;this._pauseMenu=$c.show(this.getSceneRoot());this._pauseMenu.addEventListener("resume",q(this,this.onPauseMenuResume));this._pauseMenu.addEventListener("quit",q(this,this.onPauseMenuQuit))};Tc.__name__=["game","screens","MenusState"];Tc.show=function(a){a=new Tc(a);n.getInstance().addGameState(a)};Tc.__super__=
X;Tc.prototype=p(X.prototype,{onPauseMenuQuit:function(a){this.destroy();Fa.doTransition(this._parentState,new Pb)},onPauseMenuResume:function(a){var b=this;this._pauseMenu.dismiss();this._pauseMenu.addEventListener("dismissComplete",function(){b._parentState.resume();n.getInstance().removeGameState(b)})},__class__:Tc});var ue=function(){this._orientationEntity=this._div=this._image=null;X.call(this)};ue.__name__=["game","screens","OrientationState"];ue.__super__=X;ue.prototype=p(X.prototype,{init:function(){X.prototype.init.call(this);
var a=s.getWindow().innerWidth>s.getWindow().innerHeight;this.onOrientationChanged(a)},onOrientationChanged:function(a){n.isMobile()&&!n.isPhone()?a&&0==Y.getProperty("isLandscapeAllowedIPad")?this.showOrientationScreen(1):a||0!=Y.getProperty("isPortraitAllowedIPad")?this.hideOrientationScreen():this.showOrientationScreen(0):n.isMobile()&&(a&&0==Y.getProperty("isLandscapeAllowedIPhone")?this.showOrientationScreen(1):a||0!=Y.getProperty("isPortraitAllowedIPhone")?this.hideOrientationScreen():this.showOrientationScreen(0))},
showOrientationScreen:function(a){this.hideOrientationScreen(!1);n.getInstance().addGameState(this);n.getInstance().stopUpdates();ea.getInstance().setInputDisabled(!0);v.pauseAllSounds();this._div=s.getDocument().createElement("div");this._div.style.position="absolute";this._div.style.backgroundColor="#000000";this._div.style.width="100%";this._div.style.height="100%";s.getContainer().appendChild(this._div);switch(a){case 0:this._orientationEntity=this.addEntity();this._image=H.getAsset(n.isPhone()?
"iphoneOrientationImage":"ipadOrientationImage");this._div.appendChild(this._image);this._image.style.position="absolute";this._image.style.margin="auto auto auto auto";this._image.style.display="block";this._image.style.maxWidth="100%";this._image.style.maxHeight="auto";this._image.style.top="0px";this._image.style.bottom="0px";this._image.style.left="0px";this._image.style.right="0px";break;case 1:this._orientationEntity=this.addEntity(),this._image=H.getAsset(n.isPhone()?"iphoneOrientationImage":
"ipadOrientationImage"),this._div.appendChild(this._image),this._image.style.position="absolute",this._image.style.margin="auto auto auto auto",this._image.style.display="block",this._image.style.maxWidth="100%",this._image.style.maxHeight="auto",this._image.style.top="0px",this._image.style.bottom="0px",this._image.style.left="0px",this._image.style.right="0px"}},update:function(){X.prototype.update.call(this)},hideOrientationScreen:function(a){null==a&&(a=!0);null!=this._div&&(this._div.parentNode.removeChild(this._div),
this._div=null);a&&(n.getInstance().resumeUpdates(),ea.getInstance().setInputDisabled(!1),v.resumeAllSounds(),n.getInstance().hideAddressBar(),n.getInstance().onScreenScaleUpdated())},handleMessage:function(a,b){X.prototype.handleMessage.call(this,a,b);if("onOrientationChanged"==a)this.onOrientationChanged(b.isHorizontal)},__class__:ue});var Md=function(){this._currentStoryPage=0;this._nextButton=this._skipButton=null;X.call(this)};Md.__name__=["game","screens","StoryScreen"];Md.__super__=X;Md.prototype=
p(X.prototype,{init:function(){X.prototype.init.call(this);this._uiPanel=ya.createFullscreenUiPanel(this);var a=this.addEntity();new S(a,this._uiPanel);a=new A(a,"grayBg");a.getSprite().anchor.x=0.5;a.getSprite().anchor.y=0.5;a=this.addEntity();(new S(a,this._uiPanel)).setCoords(new t(0,-0.8));new aa(a,U.getString("STORY_SCREEN_HEADING"),{fontSize:"46px",fontFamily:"luckiest_guyregular"});a=this.addEntity();(new S(a,this._uiPanel)).setCoords(new t(0,-0));this._storyTextfield=new aa(a,U.getString("STORY_SCREEN_HEADING"),
{fontSize:"22px",fontFamily:"luckiest_guyregular",fill:"#000000"});this.updateStoryPage();a=new Ua;a.x=0.65;a.y=0.8;a.text=U.getString("STORY_SCREEN_NEXT");a.defaultImageName="grayButton";a.clickSoundId="ui_enter";a.deactivateButtonOnClick=!1;sa.createButton(a,this._uiPanel.getEntity(),q(this,this.onStoryNext));a=new Ua;a.x=0.8;a.y=-0.8;a.defaultImageName="graySkip";a.clickSoundId="ui_back_2";sa.createButton(a,this._uiPanel.getEntity(),q(this,this.onStorySkip))},updateStoryPage:function(){switch(this._currentStoryPage){case 0:this._storyTextfield.setTextString(U.getString("STORY_SCREEN_PAGE_"+
(this._currentStoryPage+1)));break;case 1:this._storyTextfield.setTextString(U.getString("STORY_SCREEN_PAGE_"+(this._currentStoryPage+1)));break;case 2:this._storyTextfield.setTextString(U.getString("STORY_SCREEN_PAGE_"+(this._currentStoryPage+1)))}},onStorySkip:function(){this.onLevelSelect()},onStoryPrevious:function(){this._currentStoryPage--;if(0>this._currentStoryPage)this.onTitleScreen();else this.updateStoryPage()},onTitleScreen:function(){var a=new Pb;Fa.doTransition(this,a)},onStoryNext:function(){this._currentStoryPage++;
if(3<=this._currentStoryPage)this.onLevelSelect();else this.updateStoryPage()},onLevelSelect:function(){z.get_instance().get_flowConfig().skipBackgroundSelect&&Fa.doTransition(this,new Pb)},__class__:Md});var Pb=function(){X.call(this)};Pb.__name__=["game","screens","TitleScreen"];Pb.__super__=X;Pb.prototype=p(X.prototype,{init:function(){X.prototype.init.call(this);this.createMenuScreen();v.playMusicByName("mx_menu")},createMenuScreen:function(){var a=ya.createFullscreenUiPanel(this);this._buttonGroup=
new dc(a.getEntity());var b=this.addEntity();new S(b,a);var c=new A(b,"splashBg");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;new Ob(b);var d=this.addEntity(),b=new S(d,a);b.setCoords(new t(1,-1));b.setAlignment(va.Right,wa.Top);b=this.addEntity();c=new S(b,a);c.setCoords(new t(1,1));c.setAlignment(va.Right,wa.Bottom);c=this.addEntity();a=new S(c,a);a.setCoords(new t(-1,1));a.setAlignment(va.Left,wa.Bottom);a=d.addEntity();a.setLocalPosition(-237,225);a=new A(a,"splashLogo");a.getSprite().anchor.x=
0.5;a.getSprite().anchor.y=0.5;a=new Ua;a.defaultImageName="playBtn";a.clickSoundId="ui_play";a.positionType=Za.Local;a.x=-185;a.y=-101;sa.createButton(a,b,q(this,this.onPlayButtonClicked));a.defaultImageName="leaderboardBtn";a.x=-322;a.y=-70;a.deactivateButtonOnClick=!1;this._leaderboard=sa.createButton(a,b,q(this,this.onLeaderboardClick));a.defaultImageName="restartBtn";a.clickSoundId="ui_enter";a.x=100;a.y=-70;a.deactivateButtonOnClick=!1;this._newGameButton=sa.createButton(a,c,q(this,this.onNewGameButtonClicked))},
update:function(){X.prototype.update.call(this);null!=this._newGameButton&&this._newGameButton.setVisible(da.getInstance().getHasStartedGame())},onPlayButtonClicked:function(){this._buttonGroup.setInputEnabled(!1);z.get_instance().get_flowConfig().skipStoryScreen?(z.get_instance().get_flowConfig().skipBackgroundSelect||z.get_instance().get_flowConfig().skipInitialBackgroundSelect)&&this.startLevel(1):Fa.doTransition(this,new Md)},onLeaderboardClick:function(){var a=new Gd(this.addEntity());this._buttonGroup.setInputEnabled(!1);
a.addEventListener("destroy",q(this,this.onLeaderboardDestroy))},onLeaderboardDestroy:function(a){this._buttonGroup.setInputEnabled(!0)},startLevel:function(a){var b=H.getAsset("gameplayLoad");da.getInstance().setCurrentLevelNumber(a);this._loadingScreen=new Oc(b);n.getInstance().addGameState(this._loadingScreen);a="background"+da.getInstance().getCurrentLevelNumber()+"Load";b.concatLoadBatch(H.getAsset(a));this._loadingScreen.addEventListener("complete",q(this,this.onLevelLoadComplete));b.load(null)},
onLevelLoadComplete:function(){var a=new Kd;n.getInstance().addGameState(a)},onNewGameButtonClicked:function(){Ac.show(this.getSceneRoot(),U.getString("TITLE_SCREEN_NEW_GAME_HEADER"),U.getString("TITLE_SCREEN_RESET_CONFIRM"),U.getString("TITLE_SCREEN_RESET_CONFIRM_YES"),U.getString("TITLE_SCREEN_RESET_CONFIRM_NO"),q(this,this.onResetGameYes),q(this,this.onResetGameNo));this._buttonGroup.setInputEnabled(!1)},onResetGameYes:function(){da.getInstance().getSaveData().deleteAllSaveData();da.getInstance().setHasStartedGame(!1);
Fa.doTransition(this,new Pb);this._buttonGroup.setInputEnabled(!0)},onResetGameNo:function(){this._buttonGroup.setInputEnabled(!0)},__class__:Pb});var pg=function(){this._stateStack=new Ef};pg.__name__=["game","stateMachine","StackStateMachine"];pg.prototype={get_state:function(){if(null==this._stateStack.head)return null;var a=this._stateStack;return null==a.head?null:a.head.elt},pushState:function(a){if(null!=this.get_state())this.get_state().onExit();if(null!=a){var b=this._stateStack;b.head=new yg(a,
b.head);a.onEnter()}},popState:function(){var a=null;if(null!=this._stateStack.head){var a=this._stateStack,b=a.head;null==b?a=null:(a.head=b.next,a=b.elt);a.onExit()}if(null!=this.get_state())this.get_state().onEnter();return a},onUpdate:function(){if(null!=this.get_state())this.get_state().onUpdate()},onFixedUpdate:function(){if(null!=this.get_state())this.get_state().onFixedUpdate()},onPostUpdate:function(){if(null!=this.get_state())this.get_state().onPostUpdate()},clearStack:function(){if(null!=
this.get_state())this.get_state().onExit();this._stateStack=new Ef},__class__:pg,__properties__:{get_state:"get_state"}};var yd=function(a,b,c){this._characterTimeSpacing=0.05;this._lifetime=1;this._spacing=26;l.call(this,a);this._text=b;this._defaultStyle=c;new V(this.getEntity())};yd.__name__=["game","ui","ScoreText"];yd.__super__=l;yd.prototype=p(l.prototype,{get_spacing:function(){return this._spacing},set_spacing:function(a){return this._spacing=a},init:function(){var a=this;l.prototype.init.call(this);
for(var b=this._text.length,c=0;c<b;){var d=c++,e=this.addEntity();e.setLocalPosition(0.5*-this._spacing*b+d*this._spacing,0);var f=new aa(e,F.substr(this._text,d,1),this._defaultStyle);f.getText().alpha=0;I.addTweenToTarget(e,e.getPositionRef(),"y",50,0,0.15,B.easeOutBack,d*this._characterTimeSpacing);I.addTweenToTarget(e,f.getText(),"alpha",0,1,0.1,B.easeOutQuad,d*this._characterTimeSpacing)}b=this.getEntity().getComponent(V);I.addTweenToTarget(this.getEntity(),this.getEntity().getPositionRef(),
"y",this.getEntity().getLocalPosition().y,this.getEntity().getLocalPosition().y-100,0.5,B.easeInQuad,this._lifetime);I.addTweenToTarget(this.getEntity(),b.getContainer(),"alpha",1,0,0.5,B.linear,this._lifetime,function(){a.getEntity().destroy()})},__class__:yd,__properties__:{set_spacing:"set_spacing",get_spacing:"get_spacing"}});var te=function(a,b){this._baseHeight=500;this._baseWidth=750;O.call(this);this._baseWidth=a;this._baseHeight=b};te.__name__=["game","ui","ScreenSizeToBrowserSize"];te.__super__=
fa;te.prototype=p(fa.prototype,{postUpdate:function(){fa.prototype.postUpdate.call(this);n.getDevicePixelRatio();if(1==n.getInstance().getCurrentOrientation()){var a=this._baseWidth/window.innerWidth;n.getInstance().setGameWidth(this._baseWidth);n.getInstance().setGameHeight(Math.ceil(window.innerHeight*a))}else a=this._baseHeight/window.innerHeight,n.getInstance().setGameWidth(Math.ceil(window.innerWidth*a)),n.getInstance().setGameHeight(this._baseHeight);n.getInstance().onResizeWindow()},__class__:te});
var Ff=function(a,b,c){l.call(this,a);this._soundOnImage=b;this._soundOffImage=c};Ff.__name__=["game","ui","SoundButton"];Ff.__super__=l;Ff.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);this._button=this.getEntity().getComponent(qa);this._buttonActionDelay=this.getEntity().getComponent(Sa);this._buttonMouseOverImage=this.getEntity().getComponent(tc);this._buttonActionDelay.setOnAction(q(this,this.onClick))},update:function(){l.prototype.update.call(this);this._buttonMouseOverImage.setDefaultImage(v.isMusicMuted()?
this._soundOffImage:this._soundOnImage);this._buttonMouseOverImage.setMouseOverImage(v.isMusicMuted()?this._soundOffImage:this._soundOnImage)},onClick:function(){v.setMusicMuted(!v.isMusicMuted());v.setSoundMuted(v.isMusicMuted())},__class__:Ff});var ya=function(){};ya.__name__=["game","ui","UiFactory"];ya.createFullscreenUiPanel=function(a){var b=n.getInstance().getGameSize(),c=b.getClone();b.x*=n.getInstance().getScreenScale().x;b.y*=n.getInstance().getScreenScale().y;a=a.addEntity();b=new Nc(a,
b);a.setLocalPosition(c.x/2,c.y/2,0);new re(a);return b};ya.createPulseButton=function(a,b,c,d,e,f,g,k,h,l,n,p,q,r,s,u){var v=nc.instantiate(a.getGameState());(new S(v,a)).setCoords(new t(b,c));a=new A(v,h);qa.createFromPixiSprite(a);new Kc(v,d,e,f,r);new sc(v,g,k,B.easeOutQuint,B.easeOutQuint);new Sa(v,n,p,q);new tc(v,h,l);new Lc(v,s,u);return v};ya.createPulseButtonQuick=function(a,b,c,d,e,f,g,k,h,l,n){null==l&&(l=0.35);null==h&&(h=!0);null==k&&(k="");null==g&&(g="");return ya.createPulseButton(a,
b,c,0.35,1,0.15,1.15,0.35,d,e,f,l,n,h,g,k)};ya.createPulseButtonAbsolute=function(a,b,c,d,e,f,g,k,h,l,n,p,q,r,s,t){a=nc.instantiate(a);a.setLocalPosition(b,c,0);b=new A(a,h);qa.createFromPixiSprite(b);new Kc(a,d,e,f,r);new sc(a,g,k,B.easeOutQuint,B.easeOutQuint);new Sa(a,n,p,q);new tc(a,h,l);new Lc(a,s,t);return a};ya.createPulseButtonQuickAbsolute=function(a,b,c,d,e,f,g,k,h,l,n){null==l&&(l=0.35);null==h&&(h=!0);null==k&&(k="");null==g&&(g="");return ya.createPulseButtonAbsolute(a,b,c,0.35,1,0.15,
1.15,0.35,d,e,f,l,n,h,g,k)};ya.createTextButton=function(a,b,c,d,e,f,g,k,h){null==h&&(h=!0);null==k&&(k="");null==g&&(g="");var l=e.getGameState();a=ya.createPulseButtonQuick(e,a,b,d,d,f,g,k,h,0.35);l=l.addEntity();l.setLocalPosition(0,-5,0);new aa(l,c,{fontSize:"24px",fontFamily:"luckiest_guyregular",fill:"#000000"});a.addChild(l);return a.getComponent(S)};ya.prototype={__class__:ya};var Ua=function(){this.overrideColliderSizeX=this.overrideColliderSizeY=100;this.overrideColliderSize=!1;this.blockClickThrough=
!0;this.textX=this.textY=0;this.text="";this.textStyle=null;this.clickSoundId=this.overSoundId="";this.deactivateButtonOnClick=!0;this.onClickDelay=0.35;this.defaultImageName=this.mouseOverImageName="";this.mouseOverScaleDuration=0.35;this.mouseOverScaleTo=1.15;this.mouseDownPulseDuration=0.15;this.mouseDownPulseToScale=1;this.mouseDownPulseFromScale=0.35;this.scale=1;this.positionType=Za.UiPanel;this.x=this.y=0};Ua.__name__=["game","ui","buttonFactory","ButtonConfig"];Ua.prototype={__class__:Ua};
var sa=function(){};sa.__name__=["game","ui","buttonFactory","ButtonFactory"];sa.createButton=function(a,b,c,d){var e=b.addEntity();b=b.getComponent(Nc);null!=b&&a.positionType==Za.UiPanel?(b=new S(e,b),b.setCoords(new t(a.x,a.y)),b.setScale(a.scale,a.scale)):(a.positionType==Za.World?e.setPosition(a.x,a.y):e.setLocalPosition(a.x,a.y),e.setLocalScale(a.scale,a.scale));b=new A(e,a.defaultImageName);b=qa.createFromPixiSprite(b);b.setKillMessageOnMouseDown(a.blockClickThrough);a.overrideColliderSize&&
b.setCollisionProperties(new t(a.overrideColliderSizeX,a.overrideColliderSizeY),new t);b.setData(a.data);new Kc(e,a.mouseDownPulseFromScale*a.scale,a.mouseDownPulseToScale*a.scale,a.mouseDownPulseDuration,a.deactivateButtonOnClick);new sc(e,a.mouseOverScaleTo*a.scale,a.mouseOverScaleDuration,B.easeOutQuint,B.easeOutQuint);new Sa(e,c,a.onClickDelay,d);new tc(e,a.defaultImageName,0<a.mouseOverImageName.length?a.mouseOverImageName:a.defaultImageName);new Lc(e,a.clickSoundId,a.overSoundId);0<a.text.length&&
(c=e.addEntity(),c.setLocalPosition(a.textX,a.textY),new aa(c,a.text,null==a.textStyle?{}:a.textStyle));return e};var Za={__ename__:!0,__constructs__:["Local","World","UiPanel"],Local:["Local",0]};Za.Local.__enum__=Za;Za.World=["World",1];Za.World.__enum__=Za;Za.UiPanel=["UiPanel",2];Za.UiPanel.__enum__=Za;Za.__empty_constructs__=[Za.Local,Za.World,Za.UiPanel];var Nd=function(a){l.call(this,a)};Nd.__name__=["game","ui","popups","Popup"];Nd.__super__=l;Nd.prototype=p(l.prototype,{init:function(){l.prototype.init.call(this);
this._uiPanel=ya.createFullscreenUiPanel(this.getGameState());new V(this._uiPanel.getEntity());this._buttonGroup=new dc(this._uiPanel.getEntity());this.enter()},enter:function(){this.onEnterComplete()},onEnterComplete:function(){this.dispatchEvent(new Bc("enterComplete"))},dismiss:function(){this.onDismissComplete()},onDismissComplete:function(){this.dispatchEvent(new Bc("dismissComplete"));null!=this._uiPanel&&(this._uiPanel.getEntity().destroy(),this._uiPanel=null);this.getEntity().destroy()},__class__:Nd});
var xa=function(a){l.call(this,a)};xa.__name__=["game","ui","popups","FadingPopup"];xa.__super__=Nd;xa.prototype=p(Nd.prototype,{enter:function(){var a=this,b=this._uiPanel.getComponent(V);I.addTweenToTarget(this.getEntity(),b.getContainer(),"alpha",0,1,0.1,B.linear,0,function(){a.onEnterComplete()})},dismiss:function(){var a=this;this._buttonGroup.setInputEnabled(!1);var b=this._uiPanel.getComponent(V);I.addTweenToTarget(this.getEntity(),b.getContainer(),"alpha",1,0,0.1,B.linear,0,function(){a.onDismissComplete()})},
__class__:xa});var tf=function(a,b){l.call(this,a);this._backgroundNumber=b};tf.__name__=["game","ui","popups","BackgroundUnlockedPopup"];tf.__super__=xa;tf.prototype=p(xa.prototype,{init:function(){xa.prototype.init.call(this);var a=this.addEntity(),b=new A(a,"blackSquare");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.5;a=new S(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);b=this.addEntity();new S(b,this._uiPanel);var a=this.addEntity(),c=new A(a,"popupBackground");
c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;var c=a.addEntity(),d=new A(c,"leaderboardCharacters");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;c.setLocalPosition(-321,49);b.addChild(a);new S(a,this._uiPanel);b=this.addEntity();b.setLocalPosition(20,-195,0);a.addChild(b);c={fontSize:48,fill:"#FFFFFF",stroke:"#000000",strokeThickness:2,fontFamily:"luckiest_guyregular"};if("de-de"==s.dataLocale||"es-es"==s.dataLocale||"fr-fr"==s.dataLocale||"nl-nl"==s.dataLocale||"pl-pl"==s.dataLocale||
"pt-br"==s.dataLocale||"ja-jp"==s.dataLocale||"ru-ru"==s.dataLocale||"it-it"==s.dataLocale)c.fontSize=32;new aa(b,U.getString("GAMEPLAY_SCREEN_NEW_ROOM_UNLOCKED"),c);b=a.addEntity();b=new A(b,"background"+this._backgroundNumber+"Thumb");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b=new Ua;b.x=0;b.y=169;b.defaultImageName="gameCompletePlayButton";b.clickSoundId="ui_enter";sa.createButton(b,a,q(this,this.onNextClicked))},onNextClicked:function(){v.playSoundByName("sfx_enter");this.dismiss()},
__class__:tf});var Hd=function(a){this._currentPage=0;this._titleText="HELP_SCREEN_HEADER_1 HELP_SCREEN_HEADER_2 HELP_SCREEN_HEADER_3 HELP_SCREEN_HEADER_4 HELP_SCREEN_HEADER_5 HELP_SCREEN_HEADER_6".split(" ");this._imageNamesMobile="help1Mobile help2Mobile help3Mobile help4Mobile help5Mobile help6Mobile".split(" ");this._imageNames="help1 help2 help3 help4 help5 help6".split(" ");l.call(this,a)};Hd.__name__=["game","ui","popups","HelpScreen"];Hd.__super__=xa;Hd.prototype=p(xa.prototype,{init:function(){xa.prototype.init.call(this);
var a=this.addEntity(),b=new A(a,"blackSquare");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.5;a=new S(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);a=this.addEntity();new S(a,this._uiPanel);b=this.addEntity();a.addChild(b);var c=new A(b,"popupBackground");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;b=b.addEntity();this._pageSprite=new A(b,n.isMobile()?this._imageNamesMobile[this._currentPage]:this._imageNames[this._currentPage]);this._pageSprite.getSprite().anchor.x=
0.5;this._pageSprite.getSprite().anchor.y=0.5;b.setLocalPosition(0,0);b=this.addEntity();b.setLocalPosition(0,-195,0);a.addChild(b);c={fontSize:48,fill:"#FFFFFF",stroke:"#000000",strokeThickness:2,fontFamily:"luckiest_guyregular"};if("de-de"==s.dataLocale||"fr-fr"==s.dataLocale||"nl-nl"==s.dataLocale||"ru-ru"==s.dataLocale||"it-it"==s.dataLocale)c.fontSize=36;this._pageText=new aa(b,U.getString(this._titleText[this._currentPage]),c);b=new Ua;b.clickSoundId="ui_back";b.x=20;b.y=177;b.deactivateButtonOnClick=
!1;b.defaultImageName="gameCompletePlayButton";sa.createButton(b,a,q(this,this.onNext))},onClose:function(){this.dismiss()},onNext:function(){this._currentPage++;5!=this._currentPage||n.isMobile()?null!=this._spacebarText&&this._spacebarText.destroy():(this._spacebarText=this._pageSprite.getEntity().addEntity(),this._spacebarText.setLocalPosition(0,-29),new aa(this._spacebarText,U.getString("HELP_SCREEN_SPACEBAR"),{fontFamily:"curse_casualregular",fill:"#FFFFFF",fontSize:28}));if(this._currentPage<
this._imageNames.length)this._pageSprite.setImage(n.isMobile()?this._imageNamesMobile[this._currentPage]:this._imageNames[this._currentPage]),this._pageText.setTextString(U.getString(this._titleText[this._currentPage]));else this.onClose()},__class__:Hd});var Gd=function(a){l.call(this,a)};Gd.__name__=["game","ui","popups","LeaderboardScreen"];Gd.__super__=xa;Gd.prototype=p(xa.prototype,{init:function(){xa.prototype.init.call(this);var a=this.addEntity(),b=new A(a,"blackSquare");b.getSprite().anchor.x=
0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.5;a=new S(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);b=this.addEntity();new S(b,this._uiPanel);var a=this.addEntity(),c=new A(a,"popupBackground");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;var c=a.addEntity(),d=new A(c,"leaderboardCharacters");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;c.setLocalPosition(-321,49);b.addChild(a);new S(a,this._uiPanel);b=this.addEntity();b.setLocalPosition(0,-195,0);a.addChild(b);
c={fontSize:48,fill:"#FFFFFF",stroke:"#000000",strokeThickness:2,fontFamily:"luckiest_guyregular"};if("de-de"==s.dataLocale||"es-es"==s.dataLocale||"fr-fr"==s.dataLocale||"nl-nl"==s.dataLocale||"pl-pl"==s.dataLocale||"pt-br"==s.dataLocale||"ja-jp"==s.dataLocale||"ru-ru"==s.dataLocale||"it-it"==s.dataLocale)c.fontSize=32;new aa(b,U.getString("LEADERBOARD"),c);b=[];c=0;for(d=z.get_instance().get_leaderboardConfig().numEntries;c<d;){var e=c++;b.push(new Cf(U.getString("LEADERBOARD_"+(e+1)),da.getInstance().getHighScores()[e]))}c=
z.get_instance().get_leaderboardConfig();d=0;for(e=c.names.length;d<e;){var f=d++;b.push(new Cf(U.getString(c.names[f]),c.scores[f]))}b.sort(function(a,b){return a.score>b.score?-1:a.score<b.score?1:0});c=0;for(d=b.length;c<d;)e=c++,this.addLeaderboardName(a,e+1,b[e].name,b[e].score);b=new Ua;b.x=346;b.y=186;b.defaultImageName="gameCompletePlayButton";b.clickSoundId="ui_enter";sa.createButton(b,a,q(this,this.onNextClicked))},addLeaderboardName:function(a,b,c,d){a=a.addEntity();a.setLocalPosition(-153,
-80+60*(b-1));var e=a.addEntity();e.setLocalPosition(0,0,0);var f={fontSize:42,fill:"#FFD526",fontFamily:"luckiest_guyregular"};if("zh-cn"==s.dataLocale||"ja-jp"==s.dataLocale)f.fontFamily="fornumber_font";b=new aa(e,$a.replace($a.replace(U.getString("LEADERBOARD_SCORE_FORMAT"),"%POS",null==b?"null":""+b),"%NAME",c),f);b.getText().anchor.x=0;b.getText().anchor.y=1;b=a.addEntity();b.setLocalPosition(172,0,0);c={fontSize:32,fill:"#FFFFFF",fontFamily:"luckiest_guyregular"};if("zh-cn"==s.dataLocale||
"ja-jp"==s.dataLocale)c.fontFamily="fornumber_font";b=new aa(b,U.getString("LEADERBOARD_DOTS"),c);b.getText().anchor.x=0;b.getText().anchor.y=1;a=a.addEntity();a.setLocalPosition(320,0,0);b={fontSize:42,fill:"#FFFFFF",fontFamily:"luckiest_guyregular"};if("zh-cn"==s.dataLocale||"ja-jp"==s.dataLocale)b.fontFamily="fornumber_font";d=new aa(a,null==d?"null":""+d,b);d.getText().anchor.x=0;d.getText().anchor.y=1},onNextClicked:function(){v.playSoundByName("sfx_enter");this.dismiss()},__class__:Gd});var vf=
function(a,b){this._displayedScore=this.totalScore=0;this._scoreModifier=5;this._loadingScreen=this._dodgeGame=null;l.call(this,a);this._dodgeGame=b};vf.__name__=["game","ui","popups","LevelCompleteScreen"];vf.__super__=xa;vf.prototype=p(xa.prototype,{init:function(){xa.prototype.init.call(this);var a=this.addEntity(),b=new A(a,"blackSquare");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.5;a=new S(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);b=this.addEntity();
new S(b,this._uiPanel);var a=this.addEntity(),c=new A(a,"popupBackground");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;var c=a.addEntity(),d=new A(c,"leftCharacter");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;c.setLocalPosition(-330,60);c=a.addEntity();d=new A(c,"rightCharacter");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;c.setLocalPosition(365,50);b.addChild(a);new S(a,this._uiPanel);b=this.addEntity();b.setLocalPosition(0,-195,0);a.addChild(b);c={fontSize:48,fill:"#FFFFFF",
stroke:"#000000",strokeThickness:2,fontFamily:"luckiest_guyregular"};if("zh-cn"==s.dataLocale||"ja-jp"==s.dataLocale)c.fontFamily="fornumber_font";new aa(b,U.getString("LEVEL_COMPLETE_HEADER"),c);b=a.addEntity();c=b.addEntity();d={fontSize:"48px",fontFamily:"luckiest_guyregular",fill:"#FFD526"};if("it-it"==s.dataLocale||"ja-ja"==s.dataLocale||"pt-br"==s.dataLocale)d.fontSize="36px";c=new aa(c,U.getString("LEVEL_COMPLETE_LEVEL_LABEL"),d);c.getText().anchor.x=0;d=b.addEntity();d.setLocalPosition(c.getText().width,
0,0);var e={fontSize:"48px",fontFamily:"luckiest_guyregular",fill:"#FFFFFF"};if("zh-cn"==s.dataLocale||"ja-jp"==s.dataLocale)e.fontFamily="fornumber_font";if("it-it"==s.dataLocale||"ja-ja"==s.dataLocale||"pt-br"==s.dataLocale)e.fontSize="36px";d=new aa(d,pa.string(this._dodgeGame.get_gameStats().get_currentLevel()),e);d.getText().anchor.x=0;b.setLocalPosition(-(c.getText().width+d.getText().width)/2,-98,0);b=a.addEntity();b.setLocalPosition(0,-50,0);c={fontSize:"38px",fontFamily:"curse_casualregular",
fill:"#FFFFFF"};if("it-it"==s.dataLocale||"ja-ja"==s.dataLocale||"pt-br"==s.dataLocale)c.fontSize="30px";new aa(b,$a.replace(U.getString("LEVEL_COMPLETE_PERFECT_LABEL"),"%N",pa.string(this._dodgeGame.get_gameStats().get_numPerfects())),c);b=a.addEntity();c=b.addEntity();d={fontSize:"48px",fontFamily:"luckiest_guyregular",fill:"#FFD526"};if("it-it"==s.dataLocale||"ja-ja"==s.dataLocale||"pt-br"==s.dataLocale)d.fontSize="36px";c=new aa(c,U.getString("LEVEL_COMPLETE_SCORE_LABEL"),d);c.getText().anchor.x=
0;d=b.addEntity();d.setLocalPosition(c.getText().width,0,0);e={fontSize:"48px",fontFamily:"luckiest_guyregular",fill:"#FFFFFF"};if("zh-cn"==s.dataLocale||"ja-jp"==s.dataLocale)e.fontFamily="fornumber_font";if("it-it"==s.dataLocale||"ja-ja"==s.dataLocale||"pt-br"==s.dataLocale)e.fontSize="36px";d=new aa(d,pa.string(this._dodgeGame.get_gameStats().get_numPoints()),e);d.getText().anchor.x=0;b.setLocalPosition(-(c.getText().width+d.getText().width)/2,9,0);b=da.getInstance().getScoreForLevel(da.getInstance().getCurrentLevelNumber());
this._dodgeGame.get_gameStats().get_numPoints()>b&&(b=a.addEntity(),b.setLocalPosition(202,30,0),c=new A(b,"newBestBurst"),c.getSprite().anchor.x=0.5,c.getSprite().anchor.y=0.5,b=b.addEntity(),b.setLocalPosition(2,-5),b.setRotation2d(-15),c={fontSize:"20px",fontFamily:"luckiest_guyregular",fill:"#FF0000",stroke:"#FFFFFF",strokeThickness:2,align:"center"},"en-us"!=s.dataLocale&&(c.fontSize="16px"),new aa(b,U.getString("LEVEL_COMPLETE_BEST_BURST"),c));b=new Ua;b.x=3.5;b.y=178;b.clickSoundId="ui_enter";
b.defaultImageName="gameCompletePlayButton";sa.createButton(b,a,q(this,this.onLevelCompleteNextClicked));v.stopMusic();v.playSoundByName("ui_level_complete_2");(new Cb(this.addEntity())).addDeferredAction(3.5,function(){v.playMusicByName("mx_menu")});da.getInstance().setScoreForCurrentLevel(this.totalScore)},onLevelCompleteNextClicked:function(){if(z.get_instance().get_flowConfig().skipBackgroundSelect){for(var a=new qd,b=0,c=this._dodgeGame.get_gameStats().get_backgroundsUnlocked().length;b<c;){var d=
b++;a.addCommand(new sf(this._dodgeGame,this._dodgeGame.get_gameStats().get_backgroundsUnlocked()[d]))}a.addCommand(new uf(this._dodgeGame));a.addCommand(new Qb(this._dodgeGame.get_deferredActionController(),z.get_instance().get_flowConfig().leaveGameplayDelay));a.addCommand(new rf(this._dodgeGame));a.execute()}this.dismiss()},onLevelLoadComplete:function(){this.destroy();Fa.doTransition(this._loadingScreen,new Kd)},__class__:vf});var Ac=function(a,b,c,d,e,f,g){l.call(this,a);this._headingText=b;
this._bodyText=c;this._yesText=d;this._noText=e;this._onYes=f;this._onNo=g};Ac.__name__=["game","ui","popups","MessageBoxYesNo"];Ac.show=function(a,b,c,d,e,f,g){a=a.addEntity();new Ac(a,b,c,d,e,f,g)};Ac.__super__=xa;Ac.prototype=p(xa.prototype,{init:function(){xa.prototype.init.call(this);var a=this.addEntity(),b=new A(a,"blackSquare");b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;b.getSprite().alpha=0.5;a=new S(a,this._uiPanel);a.setScale(750,500);a.setPixelPerfect(!0);b=this.addEntity();
new S(b,this._uiPanel);var a=this.addEntity(),c=new A(a,"popupBackground");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;var c=a.addEntity(),d=new A(c,"leftCharacter");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;c.setLocalPosition(-330,60);c=a.addEntity();d=new A(c,"rightCharacter");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;c.setLocalPosition(365,50);b.addChild(a);new S(a,this._uiPanel);b=this.addEntity();b.setLocalPosition(0,-65,0);new aa(b,this._bodyText,{fontSize:38,
fontFamily:"luckiest_guyregular",fill:"#FFFFFF",wordWrapWidth:500,wordWrap:!0,align:"center"});a.addChild(b);b=this.addEntity();b.setLocalPosition(0,-195,0);a.addChild(b);c={fontSize:48,fill:"#FFFFFF",stroke:"#000000",strokeThickness:2,fontFamily:"luckiest_guyregular"};if("de-de"==s.dataLocale||"es-mx"==s.dataLocale||"ja-jp"==s.dataLocale||"nl-nl"==s.dataLocale||"zh-cn"==s.dataLocale)c.fontSize=35;new aa(b,this._headingText,c);b=new Ua;b.x=-65;b.y=70;b.defaultImageName="yesButton";b.clickSoundId=
"ui_enter";sa.createButton(b,a,q(this,this.onYesClick));b.x=65;b.y=70;b.defaultImageName="quitButton";b.clickSoundId="ui_back";sa.createButton(b,a,q(this,this.onNoClick))},onYesClick:function(){var a=this;this.addEventListener("dismissComplete",function(){null!=a._onYes&&a._onYes()});this.dismiss()},onNoClick:function(){var a=this;this.addEventListener("dismissComplete",function(){null!=a._onNo&&a._onNo()});this.dismiss()},__class__:Ac});var $c=function(a){l.call(this,a)};$c.__name__=["game","ui",
"popups","PauseMenu"];$c.show=function(a){a=a.addEntity();return new $c(a)};$c.__super__=xa;$c.prototype=p(xa.prototype,{init:function(){xa.prototype.init.call(this);var a=this.addEntity(),b=new A(a,"blackSquare");b.getSprite().alpha=0.5;b.getSprite().anchor.x=0.5;b.getSprite().anchor.y=0.5;(new S(a,this._uiPanel)).setScale(1E3,1E3);a=this.addEntity();new S(a,this._uiPanel);b=this.addEntity();a.addChild(b);var c=new A(b,"popupBackground");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;var c=
b.addEntity(),d=new A(c,"leftCharacter");d.getSprite().anchor.x=0.5;d.getSprite().anchor.y=0.5;c.setLocalPosition(-330,60);b=b.addEntity();c=new A(b,"rightCharacter");c.getSprite().anchor.x=0.5;c.getSprite().anchor.y=0.5;b.setLocalPosition(365,50);b=this.addEntity();b.setLocalPosition(0,-195,0);a.addChild(b);new aa(b,U.getString("GAMEPLAY_SCREEN_PAUSE"),{fontSize:48,fill:"#FFFFFF",stroke:"#000000",strokeThickness:2,fontFamily:"luckiest_guyregular"});b=new Ua;b.x=20;b.y=177;b.defaultImageName="gameCompletePlayButton";
b.deactivateButtonOnClick=!0;b.clickSoundId="ui_enter";sa.createButton(b,a,q(this,this.onResumeClicked));b.x=25;b.y=-20;b.defaultImageName="soundOnButton";b.deactivateButtonOnClick=!1;b.clickSoundId="ui_back";this._soundButton=sa.createButton(b,a);new Ff(this._soundButton,"soundOnButton","soundOffButton");b.x=150;b.y=-5;b.defaultImageName="helpButton";b.deactivateButtonOnClick=!1;b.clickSoundId="ui_back";sa.createButton(b,a,q(this,this.onHelpClicked));b.x=-100;b.y=-15;b.defaultImageName="exitButton";
b.deactivateButtonOnClick=!1;b.clickSoundId="ui_back";sa.createButton(b,a,q(this,this.onQuitClicked))},onResumeClicked:function(){this.dispatchEvent(new Cc("resume"))},onHelpClicked:function(){var a=this;this.hideMenu();var b=this.getGameState().getSceneRoot().addEntity();(new Hd(b)).addEventListener("dismissComplete",function(){a.showMenu()})},onQuitClicked:function(){this.hideMenu();Ac.show(this.getGameState().getSceneRoot(),U.getString("GAMEPLAY_SCREEN_QUIT_CONFIRM"),U.getString("GAMEPLAY_SCREEN_QUIT_CONFIRM_TEXT"),
U.getString("GAMEPLAY_SCREEN_QUIT_CONFIRM_YES"),U.getString("GAMEPLAY_SCREEN_QUIT_CONFIRM_NO"),q(this,this.onConfirmQuitYes),q(this,this.onConfirmQuitNo))},onConfirmQuitYes:function(){this.dispatchEvent(new Cc("quit"))},onConfirmQuitNo:function(){this.showMenu()},hideMenu:function(){this._uiPanel.getEntity().setVisible(!1)},showMenu:function(){this._uiPanel.getEntity().setVisible(!0)},__class__:$c});var Cc=function(a){this._type=a};Cc.__name__=["game","ui","popups","PauseMenuEvent"];Cc.__super__=
J;Cc.prototype=p(J.prototype,{__class__:Cc});var Bc=function(a){this._type=a};Bc.__name__=["game","ui","popups","PopupEvent"];Bc.__super__=J;Bc.prototype=p(J.prototype,{__class__:Bc});var Bg=function(){};Bg.__name__=["haxe","IMap"];var yg=function(a,b){this.elt=a;this.next=b};yg.__name__=["haxe","ds","GenericCell"];yg.prototype={__class__:yg};var Ef=function(){};Ef.__name__=["haxe","ds","GenericStack"];Ef.prototype={__class__:Ef};var Pa=function(){this.h={}};Pa.__name__=["haxe","ds","StringMap"];
Pa.__interfaces__=[Bg];Pa.prototype={setReserved:function(a,b){null==this.rh&&(this.rh={});this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},existsReserved:function(a){return null==this.rh?!1:this.rh.hasOwnProperty("$"+a)},remove:function(a){if(null!=ba[a]){a="$"+a;if(null==this.rh||!this.rh.hasOwnProperty(a))return!1;delete this.rh[a]}else{if(!this.h.hasOwnProperty(a))return!1;delete this.h[a]}return!0},__class__:Pa};var Ba=function(a,b,c){this.xml=b;this.message=
a;this.position=c;this.lineNumber=1;for(a=this.positionAtLine=0;a<c;){var d=a++,d=b.charCodeAt(d);10==d?(this.lineNumber++,this.positionAtLine=0):13!=d&&this.positionAtLine++}};Ba.__name__=["haxe","xml","XmlParserException"];Ba.prototype={toString:function(){return sb.getClassName(C.getClass(this))+": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:Ba};var Vb=function(){};Vb.__name__=["haxe","xml","Parser"];Vb.parse=function(a,b){null==b&&(b=!1);var c=E.createDocument();
Vb.doParse(a,b,0,c);return c};Vb.doParse=function(a,b,c,d){null==c&&(c=0);for(var e=null,f=1,g=1,k=null,h=0,l=0,n=0,p=a.charCodeAt(c),q=new kc,r=1,s=-1;p==p;){switch(f){case 0:switch(p){case 9:case 10:case 13:case 32:break;default:f=g;continue}break;case 1:if(60==p)f=0,g=2;else{h=c;f=13;continue}break;case 2:switch(p){case 33:if(91==a.charCodeAt(c+1)){c+=2;if("CDATA["!=F.substr(a,c,6).toUpperCase())throw new P(new Ba("Expected <![CDATA[",a,c));c+=5;f=17}else if(68==a.charCodeAt(c+1)||100==a.charCodeAt(c+
1)){if("OCTYPE"!=F.substr(a,c+2,6).toUpperCase())throw new P(new Ba("Expected <!DOCTYPE",a,c));c+=8;f=16}else{if(45!=a.charCodeAt(c+1)||45!=a.charCodeAt(c+2))throw new P(new Ba("Expected \x3c!--",a,c));c+=2;f=15}h=c+1;break;case 47:if(null==d)throw new P(new Ba("Expected node name",a,c));h=c+1;f=0;g=10;break;case 63:f=14;h=c;break;default:f=3;h=c;continue}break;case 3:if(!(97<=p&&122>=p||65<=p&&90>=p||48<=p&&57>=p||58==p||46==p||95==p||45==p)){if(c==h)throw new P(new Ba("Expected node name",a,c));
e=E.createElement(F.substr(a,h,c-h));d.addChild(e);++l;f=0;g=4;continue}break;case 4:switch(p){case 47:f=11;break;case 62:f=9;break;default:f=5;h=c;continue}break;case 5:if(!(97<=p&&122>=p||65<=p&&90>=p||48<=p&&57>=p||58==p||46==p||95==p||45==p)){if(h==c)throw new P(new Ba("Expected attribute name",a,c));k=F.substr(a,h,c-h);if(e.exists(k))throw new P(new Ba("Duplicate attribute ["+k+"]",a,c));f=0;g=6;continue}break;case 6:if(61==p)f=0,g=7;else throw new P(new Ba("Expected =",a,c));break;case 7:switch(p){case 34:case 39:q=
new kc;f=8;h=c+1;s=p;break;default:throw new P(new Ba('Expected "',a,c));}break;case 8:switch(p){case 38:r=c-h;q.b+=null==r?F.substr(a,h,null):F.substr(a,h,r);f=18;r=8;h=c+1;break;case 60:case 62:if(b)throw new P(new Ba("Invalid unescaped "+String.fromCharCode(p)+" in attribute value",a,c));p==s&&(g=c-h,q.b+=null==g?F.substr(a,h,null):F.substr(a,h,g),g=q.b,q=new kc,e.set(k,g),f=0,g=4);break;default:p==s&&(g=c-h,q.b+=null==g?F.substr(a,h,null):F.substr(a,h,g),g=q.b,q=new kc,e.set(k,g),f=0,g=4)}break;
case 9:h=c=Vb.doParse(a,b,c,e);f=1;break;case 10:if(!(97<=p&&122>=p||65<=p&&90>=p||48<=p&&57>=p||58==p||46==p||95==p||45==p)){if(h==c)throw new P(new Ba("Expected node name",a,c));g=F.substr(a,h,c-h);if(d.nodeType!=E.Element)throw new P("Bad node type, expected Element but found "+d.nodeType);if(g!=d.nodeName){if(d.nodeType!=E.Element)throw new P("Bad node type, expected Element but found "+d.nodeType);throw new P(new Ba("Expected </"+d.nodeName+">",a,c));}f=0;g=12;continue}break;case 11:if(62==p)f=
1;else throw new P(new Ba("Expected >",a,c));break;case 12:if(62==p)return 0==l&&d.addChild(E.createPCData("")),c;throw new P(new Ba("Expected >",a,c));case 13:60==p?(g=c-h,q.b+=null==g?F.substr(a,h,null):F.substr(a,h,g),g=E.createPCData(q.b),q=new kc,d.addChild(g),++l,f=0,g=2):38==p&&(r=c-h,q.b+=null==r?F.substr(a,h,null):F.substr(a,h,r),f=18,r=13,h=c+1);break;case 14:63==p&&62==a.charCodeAt(c+1)&&(++c,p=F.substr(a,h+1,c-h-2),d.addChild(E.createProcessingInstruction(p)),++l,f=1);break;case 15:45==
p&&(45==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(d.addChild(E.createComment(F.substr(a,h,c-h))),++l,c+=2,f=1);break;case 16:91==p?++n:93==p?--n:62==p&&0==n&&(d.addChild(E.createDocType(F.substr(a,h,c-h))),++l,f=1);break;case 17:93==p&&(93==a.charCodeAt(c+1)&&62==a.charCodeAt(c+2))&&(p=E.createCData(F.substr(a,h,c-h)),d.addChild(p),++l,c+=2,f=1);break;case 18:if(59==p){h=F.substr(a,h,c-h);if(35==h.charCodeAt(0))h=120==h.charCodeAt(1)?pa.parseInt("0"+F.substr(h,1,h.length-1)):pa.parseInt(F.substr(h,
1,h.length-1)),q.b+=String.fromCharCode(h);else if(p=Vb.escapes,null!=ba[h]?p.existsReserved(h):p.h.hasOwnProperty(h))p=Vb.escapes,h=null!=ba[h]?p.getReserved(h):p.h[h],q.b+=pa.string(h);else{if(b)throw new P(new Ba("Undefined entity: "+h,a,c));q.b+=pa.string("&"+h+";")}h=c+1;f=r}else if(!(97<=p&&122>=p||65<=p&&90>=p||48<=p&&57>=p||58==p||46==p||95==p||45==p)&&35!=p){if(b)throw new P(new Ba("Invalid character in entity: "+String.fromCharCode(p),a,c));q.b+="&";p=c-h;q.b+=null==p?F.substr(a,h,null):
F.substr(a,h,p);h=c--;f=r}}p=a.charCodeAt(++c)}1==f&&(h=c,f=13);if(13==f){if(c!=h||0==l)b=c-h,q.b+=null==b?F.substr(a,h,null):F.substr(a,h,b),d.addChild(E.createPCData(q.b));return c}if(!b&&18==f&&13==r)return q.b+="&",b=c-h,q.b+=null==b?F.substr(a,h,null):F.substr(a,h,b),d.addChild(E.createPCData(q.b)),c;throw new P(new Ba("Unexpected end",a,c));};var P=function(a){Error.call(this);this.val=a;this.message=String(a);Error.captureStackTrace&&Error.captureStackTrace(this,P)};P.__name__=["js","_Boot",
"HaxeError"];P.wrap=function(a){return a instanceof Error?a:new P(a)};P.__super__=Error;P.prototype=p(Error.prototype,{__class__:P});var C=function(){};C.__name__=["js","Boot"];C.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;a=C.__nativeClassName(a);return null!=a?C.__resolveNativeClass(a):null};C.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&
(c="object");switch(c){case "function":return"<function>";case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+C.__string_rec(a[f],b)):c+C.__string_rec(a[f],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)f=e++,d+=(0<f?",":"")+C.__string_rec(a[f],b);return d+"]"}try{d=a.toString}catch(g){return"???"}if(null!=d&&(d!=Object.toString&&"function"==typeof d)&&(c=a.toString(),"[object Object]"!=c))return c;
c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||("prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c)||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+C.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "string":return a;default:return String(a)}};C.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||C.__interfLoop(f,b))return!0}return C.__interfLoop(a.__super__,
b)};C.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Array:return a instanceof Array?null==a.__enum__:!1;case Cg:return"boolean"==typeof a;case Hg:return!0;case Dg:return"number"==typeof a;case Ig:return"number"==typeof a?(a|0)===a:!1;case String:return"string"==typeof a;default:if(null!=a)if("function"==typeof b){if(a instanceof b||C.__interfLoop(C.getClass(a),b))return!0}else{if("object"==typeof b&&C.__isNativeObj(b)&&a instanceof b)return!0}else return!1;return b==Jg&&null!=a.__name__||
b==Kg&&null!=a.__ename__?!0:a.__enum__==b}};C.__cast=function(a,b){if(C.__instanceof(a,b))return a;throw new P("Cannot cast "+pa.string(a)+" to "+pa.string(b));};C.__nativeClassName=function(a){a=C.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};C.__isNativeObj=function(a){return null!=C.__nativeClassName(a)};C.__resolveNativeClass=function(a){return zg[a]};var kb=function(){};kb.__name__=["js","Browser"];kb.getLocalStorage=function(){try{var a=window.localStorage;
a.getItem("");return a}catch(b){return null}};kb.getSessionStorage=function(){try{var a=window.sessionStorage;a.getItem("");return a}catch(b){return null}};var Jb=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{this.a=[];for(var b=0;b<a;){var c=b++;this.a[c]=0}this.byteLength=a}};Jb.__name__=["js","html","compat","ArrayBuffer"];Jb.sliceImpl=function(a,b){var c=new Eg(this,a,null==b?null:b-a),d=new Ag(c.byteLength);(new Eg(d)).set(c);return d};Jb.prototype=
{slice:function(a,b){return new Jb(this.a.slice(a,b))},__class__:Jb};var jc=function(){};jc.__name__=["js","html","compat","Uint8Array"];jc._new=function(a,b,c){if("number"==typeof a){c=[];for(b=0;b<a;){var d=b++;c[d]=0}c.byteLength=c.length;c.byteOffset=0;c.buffer=new Jb(c)}else if(C.__instanceof(a,Jb))null==b&&(b=0),null==c&&(c=a.byteLength-b),c=0==b?a.a:a.a.slice(b,b+c),c.byteLength=c.length,c.byteOffset=b,c.buffer=a;else if(a instanceof Array&&null==a.__enum__)c=a.slice(),c.byteLength=c.length,
c.byteOffset=0,c.buffer=new Jb(c);else throw new P("TODO "+pa.string(a));c.subarray=jc._subarray;c.set=jc._set;return c};jc._set=function(a,b){if(C.__instanceof(a.buffer,Jb)){if(a.byteLength+b>this.byteLength)throw new P("set() outside of range");for(var c=0,d=a.byteLength;c<d;){var e=c++;this[e+b]=a[e]}}else if(a instanceof Array&&null==a.__enum__){if(a.length+b>this.byteLength)throw new P("set() outside of range");c=0;for(d=a.length;c<d;)e=c++,this[e+b]=a[e]}else throw new P("TODO");};jc._subarray=
function(a,b){var c=jc._new(this.slice(a,b));c.byteOffset=a;return c};var Dc={__ename__:!0,__constructs__:["Fixed","Percent"],Fixed:["Fixed",0]};Dc.Fixed.__enum__=Dc;Dc.Percent=["Percent",1];Dc.Percent.__enum__=Dc;Dc.__empty_constructs__=[Dc.Fixed,Dc.Percent];var xb={__ename__:!0,__constructs__:["Length","Fixed","Percent"],Length:["Length",0]};xb.Length.__enum__=xb;xb.Fixed=["Fixed",1];xb.Fixed.__enum__=xb;xb.Percent=["Percent",2];xb.Percent.__enum__=xb;xb.__empty_constructs__=[xb.Length,xb.Fixed,
xb.Percent];var yb={__ename__:!0,__constructs__:["Tangent","Chain","ChainScale"],Tangent:["Tangent",0]};yb.Tangent.__enum__=yb;yb.Chain=["Chain",1];yb.Chain.__enum__=yb;yb.ChainScale=["ChainScale",2];yb.ChainScale.__enum__=yb;yb.__empty_constructs__=[yb.Tangent,yb.Chain,yb.ChainScale];var Ma,Gg=0;String.prototype.__class__=String;String.__name__=["String"];Array.__name__=["Array"];Date.prototype.__class__=Date;Date.__name__=["Date"];var Ig={__name__:["Int"]},Hg={__name__:["Dynamic"]},Dg=Number;Dg.__name__=
["Float"];var Cg=Boolean;Cg.__ename__=["Bool"];var Jg={__name__:["Class"]},Kg={},ba={},Fg=Fg||{};Fg.JQuery=window.jQuery;var Ag=zg.ArrayBuffer||Jb;null==Ag.prototype.slice&&(Ag.prototype.slice=Jb.sliceImpl);var Eg=zg.Uint8Array||jc._new;s.TARGET_FPS=60;s.TARGET_FPS_MOBILE=30;s.BACKGROUND_COLOR="#000000";s.dataLocale="";E.Element=0;E.PCData=1;E.CData=2;E.Comment=3;E.DocType=4;E.ProcessingInstruction=5;E.Document=6;M.b2_nullFeature=255;M.s_incidentEdge=M.makeClipPointVector();M.s_clipPoints1=M.makeClipPointVector();
M.s_clipPoints2=M.makeClipPointVector();M.s_edgeAO=[];M.s_edgeBO=[];M.s_localTangent=new u;M.s_localNormal=new u;M.s_planePoint=new u;M.s_normal=new u;M.s_tangent=new u;M.s_tangent2=new u;M.s_v11=new u;M.s_v12=new u;M.b2CollidePolyTempVec=new u;mb.s_simplex=new If;mb.s_saveA=[];mb.s_saveB=[];bd.currentID=0;Q.b2_toiCalls=0;Q.b2_toiIters=0;Q.b2_toiMaxIters=0;Q.b2_toiRootIters=0;Q.b2_toiMaxRootIters=0;Q.s_cache=new Rf;Q.s_distanceInput=new Jf;Q.s_xfA=new zb;Q.s_xfB=new zb;Q.s_fcn=new Qf;Q.s_distanceOutput=
new Kf;Aa.e_hitCollide=1;Aa.e_missCollide=0;Aa.e_startsInsideCollide=-1;oa.s_mat=new ka;w.VERSION="2.1alpha";w.USHRT_MAX=65535;w.b2_pi=Math.PI;w.b2_maxManifoldPoints=2;w.b2_aabbExtension=0.1;w.b2_aabbMultiplier=2;w.b2_polygonRadius=2*w.b2_linearSlop;w.b2_linearSlop=0.005;w.b2_angularSlop=0.011111111111111112*w.b2_pi;w.b2_toiSlop=8*w.b2_linearSlop;w.b2_maxTOIContactsPerIsland=32;w.b2_maxTOIJointsPerIsland=32;w.b2_velocityThreshold=1;w.b2_maxLinearCorrection=0.2;w.b2_maxAngularCorrection=0.044444444444444446*
w.b2_pi;w.b2_maxTranslation=2;w.b2_maxTranslationSquared=w.b2_maxTranslation*w.b2_maxTranslation;w.b2_maxRotation=0.5*w.b2_pi;w.b2_maxRotationSquared=w.b2_maxRotation*w.b2_maxRotation;w.b2_contactBaumgarte=0.2;w.b2_timeToSleep=0.5;w.b2_linearSleepTolerance=0.01;w.b2_angularSleepTolerance=0.011111111111111112*w.b2_pi;r.b2Vec2_zero=new u(0,0);r.b2Mat22_identity=ka.fromVV(new u(1,0),new u(0,1));r.b2Transform_identity=new zb(r.b2Vec2_zero,r.b2Mat22_identity);y.s_xf1=new zb;y.e_islandFlag=1;y.e_awakeFlag=
2;y.e_allowSleepFlag=4;y.e_bulletFlag=8;y.e_fixedRotationFlag=16;y.e_activeFlag=32;y.b2_staticBody=0;y.b2_kinematicBody=1;y.b2_dynamicBody=2;dd.b2_defaultFilter=new dd;tb.b2_defaultListener=new tb;Wd.s_evalCP=new Hf;Ra.e_shapeBit=1;Ra.e_jointBit=2;Ra.e_aabbBit=4;Ra.e_pairBit=8;Ra.e_centerOfMassBit=16;Ra.e_controllerBit=32;mc.s_impulse=new Vf;ga.s_timestep2=new fd;ga.s_xf=new zb;ga.s_backupA=new Wb;ga.s_backupB=new Wb;ga.s_timestep=new fd;ga.s_queue=[];ga.s_jointColor=new Ud(0.5,0.8,0.8);ga.e_newFixture=
1;ga.e_locked=2;D.e_sensorFlag=1;D.e_continuousFlag=2;D.e_islandFlag=4;D.e_toiFlag=8;D.e_touchingFlag=16;D.e_enabledFlag=32;D.e_filterFlag=64;D.s_input=new Sf;gd.circlePointA=new u;gd.circlePointB=new u;Ka.staticFix=w.b2_maxManifoldPoints;Ka.s_worldManifold=new Tf;Ka.s_psm=new gd;Ab.b2_minPulleyLength=2;Bb.tImpulse=new u;O._currentInstanceId=0;Y._properties=new Pa;Lb._currentZIndex=0;Ic.MIN_LOAD_TIME=0.5;Ic.MAX_ACTIVE_REQUESTS=10;U._isInitialized=!1;n.ORIENTATION_HORIZONTAL=0;n.ORIENTATION_VERTICAL=
1;n.MAX_TIMESTEP=0.1;n.PHYSICS_SCALE=30;n.FIXED_TIMESTEP=0.016666666666666666;n._timeScale=1;n._devicePixelRatio=-1;n._fixedTimestepDelta=!1;n._prevTimeStamp=0;n._currentTimeStamp=0;v._masterVolume=1;v._musicVolume=0.65;v._soundVolume=1;v._musicMuted=!1;v._soundMuted=!1;v._soundsPlaying=[];v._isWebkitEnabled=!1;v._soundTimers=new Pa;Nb.BEGIN_CONTACT="beginContact";Nb.END_CONTACT="endContact";cc.PHYSICS_FPS=60;cc.TIMESTEP=0.016666666666666666;pc.PRE_UPDATE="preUpdate";pc.UPDATE="update";ia.FRAMERATE=
30;kd.EPSILON=5E-5;Db.UPDATE="update";Sa._delayButtonLock=!1;W.VISIBILITY_OFF="visibilityOff";W.VISIBILITY_ON="visibilityOn";W.DISPLAY_UPDATE="displayUpdate";W.ADDED_TO_PARENT="addedToParent";W.REMOVED_FROM_PARENT="removedFromParent";W.PARENT_UPDATE="parentUpdate";W.MOUSE_DOWN="mouseDown";W.MOUSE_UP="mouseUp";W.MOUSE_MOVE="mouseMove";W.MOUSE_OUT="mouseOut";W.MOUSE_OVER="mouseOver";W.MOUSE_CLICK="mouseClick";ub.DESTROY="destroy";ub.ACTIVATE="activate";ub.DEACTIVATE="deactivate";ub.INITIALIZE="initialize";
ld.RAYCAST_CHECK="raycastCheck";H.assetList=new Pa;Eb.BEAT_LEVEL="beatLevel";Eb.FAIL_LEVEL="failLevel";Eb.TURBO_START="turboStart";Eb.TURBO_END="turboEnd";Eb.COMIC_SNAPSHOT="comicSnapshot";vc.MIDPOINT="midpoint";vc.COMPLETE="complete";md.SHOW_SUBTITLE="showSubtitle";nd.UPDATE_DISPLAY="updateDisplay";new Pa;od.CHANGE="change";fb.TIME_SCALE=2;fb.TRANSITION_TIME=0.325;fb.FADE_TIME=7.3;fb.FADE_DURATION=0;da.NUM_LEVELS_UNLOCKED_KEY="numLevelsUnlocked";da.LEVEL_SCORE_SAVE_KEY="levelScore";da.HAS_BEATEN_GAME_KEY=
"hasBeatenGame";da.HAS_STARTED_GAME_KEY="hasStartedGame";Fa.TIME_SCALE=2;Fa.TRANSITION_TIME=0.325;Fa.FADE_TIME=7.3;Fa.FADE_DURATION=0;pd.COMPLETE="complete";rd.COMPLETE="complete";wd.START_PLAYER_RESPAWN="startPlayerRespawn";Rb.SCORE_UPDATE="scoreUpdate";Rb.LIVES_UPDATE="livesUpdate";Rb.LEVEL_UP="levelUp";ic.ASSIGN="assign";ic.UNASSIGN="unassign";Bd.POWERUP_EARN="powerupEarn";wc.ENQUEUE="enqueue";wc.DEQUEUE="dequeue";Sb.USE_POWERUP="usePowerup";Sb.HEALTH_COLLECT="healthCollect";Sb.DEATH_START="deathStart";
Dd.DETECT_ITEM="detectItem";Xc.SCORE="score";zc.START="start";zc.END="end";Ed.STUN="stun";Wc.COMPLETE="complete";Qc.MAX_SPAWN_ATTEMPTS=100;Fd.LIFETIME_ELAPSED="lifetimeElapsed";xd.EXIT_DELAY=2.5;hc.SHOW_MENU="OnMenu";hc.TOGGLE_MUSIC="onToggleMusic";Id.GENERATE="generate";Ad.PROJECTILE_FIRE_DELAY=0.5;Jd.USE="use";Oc.BAR_WIDTH=241;Ld.COMPLETE="complete";Md.NUM_STORY_PAGES=3;Cc.RESUME="resume";Cc.QUIT="quit";Bc.ENTER_COMPLETE="enterComplete";Bc.DISMISS_COMPLETE="dismissComplete";Vb.escapes=function(a){a=
new Pa;null!=ba.lt?a.setReserved("lt","<"):a.h.lt="<";null!=ba.gt?a.setReserved("gt",">"):a.h.gt=">";null!=ba.amp?a.setReserved("amp","&"):a.h.amp="&";null!=ba.quot?a.setReserved("quot",'"'):a.h.quot='"';null!=ba.apos?a.setReserved("apos","'"):a.h.apos="'";return a}(this);C.__toStr={}.toString;jc.BYTES_PER_ELEMENT=1;s.main()})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
